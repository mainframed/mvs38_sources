./  ADD  SSI=60230646,NAME=AQCTL
         MACRO                                                          10000020
         AQCTL                                                          20000020
         SVC   102 .                    TCAM CROSS-PARTITION            30000020
*                                       COMMUNICATIONS ROUTINE          40000020
         MEND                                                           50000020
./  ADD  SSI=71310499,NAME=EWTCMAP
*@LIST PUSH;                                                            00600006
*@LIST OFF ;                                                            01200006
* /*                                                                    01800006
         MACRO                                                          02400006
         EWTCMAP                                                        03000006
         SPACE 1                                                        03600006
****************************************************************        04200006
*                                                              *        04800006
*    THIS DSECT DESCRIBES THE TELECOMMUNICATIONS ACCESS METHOD *        05400006
*    DEVICE DEPENDENT SECTION OF THE ERP WORKAREA. IT IS       *        06000006
*    INVOKED BY IECDERWA IF EWTC IS SPECIFIED AS AN OPTION ON  *        06600006
*    THE MACRO CALL.                                           *        07200006
*                                                              *        07800006
*   OS/VS2 RELEASE 2,4/1/73,LEVEL=01                           *        08400006
*                                                              *        09000006
****************************************************************        09600006
         SPACE 1                                                        10200006
EWTCADDR EQU *                                                          10800006
EWTCSNS  DS    AL2                      SENSE INFORMATION               12000006
EWTCTID  DS    AL2                      TERMINAL IDENTIFICATION         12600006
*                                       CHARACTERS                      13200006
*********************************************************************** 13800006
*        START OF DEVICE DEPENDENT INFORMATION FOR OBR/SDR            * 14400006
*********************************************************************** 15000006
EWTCSIO  DS    AL2                      COUNT OF START I/O COMMANDS FOR 15600006
*                                       LINE OR STATION                 16200006
EWTCTMP  DS    AL1                      COUNT OF TEMPORARY ERRORS FOR   16800006
*                                       LINE OR STATION                 17400006
EWTCMSK  DS    AL1                      LINE OR STATION RECORDING ERROR 18000006
*                                       MASK                            18600006
EWTCTPL  DS    AL1                      TP OP-CODE OF LAST INTERRUPTED  19200006
*                                       I/O OPERATION                   19800006
EWTCTPF  DS    AL1                      TP OP-CODE OF FIRST INTERRUPTED 20400006
*                                       I/O OPERATION                   21000006
EWTCFLG  DS    AL1                      OBR/SDR FLAG BYTE               21600006
*                  BIT DEFINITIONS                                      22200006
EWTCTEM  EQU   X'80'                    TEMPORARY ERROR                 22800006
EWTCOVF  EQU   X'40'                    COUNTER OVERFLOW                23400006
EWTCEOD  EQU   X'20'                    END-OF-DAY RECORDING            24000006
EWTCSEL  EQU   X'10'                    INITIAL SELECTION ERROR         24600006
EWTCGRA  DS    AL1                      GRAPHIC RESPONSE CHARACTER      25200006
EWTCTRM  DS    CL8                      TERMINAL OR UCB NAME            25800006
EWTCSNL  DS    AL1                      SENSE OF LAST INTERRUPTED I/O   26400006
*                                       OPERATION.                      27000006
EWTCSNF  DS    AL1                      SENSE OF FIRST INTERRUPTED I/O  27600006
*                                       OPERATION.                      28200006
*********************************************************************** 28800006
*        END OF DEVICE DEPENDENT INFORMATION FOR OBR/SDR              * 29400006
*********************************************************************** 30000006
EWTCRSV1 DS    AL2                      RESERVED                        30600006
EWTCRSV2 DS    AL1                      RESERVED                        31200006
EWTCCSW  DS    XL7                      INTERRUPTED CSW                 31800006
EWTCCCW  DS    2A                       INTERRUPTED CCW.                32400006
EWTCBUFF DS    A                        ADDRESS OF TPER BUFFER FOR MDR  32600006
EWTCEND  EQU   *                                                        32800006
*                                                                       33000006
*********************************************************************** 33600006
*   0  *   EWTCSNS                     *   EWTCTID                    * 34200006
*********************************************************************** 34800006
*   4  *   EWTCSIO                     *   EWTCTMP     *   EWTCMSK    * 35400006
*********************************************************************** 36000006
*   8  *   EWTCTPL     *   EWTCTPF     *   EWTCFLG     *   EWTCGRA    * 36600006
*********************************************************************** 37200006
*  12  *                               EWTCTRM                        * 37800006
*********************************************************************** 38400006
*  16  *                                                              * 39000006
*********************************************************************** 39600006
*  20  *   EWTCSNL     *   EWTCSNF     *   EWTCRSV1                   * 40200006
*********************************************************************** 40800006
*  24  *   EWTCRSV2    *               EWTCCSW                        * 41400006
*********************************************************************** 42000006
*  28  *                                                              * 42600006
*********************************************************************** 43200006
*  32  *                               EWTCCCW                        * 43800006
*********************************************************************** 44400006
*  36  *                                                              * 45000006
*********************************************************************** 45600006
*  40  *                               EWTCBUFF                       * 45800006
*********************************************************************** 46000006
         MEND                                                           46200006
* */                                                                    46800006
*@LIST POP;                                                             47400006
*                                                                       48000006
* /************************************************************/        48600006
* /*                                                          */        49200006
* /*   THIS STRUCTURE DESCRIBES THE TELECOMMUNICATIONS ACCESS */        49800006
* /*   METHOD DEVICE DEPENDENT SECTION OF THE ERP WORKAREA. IT*/        50400006
* /*   IS INVOKED BY IECDERWA IF EWTC IS SPECIFIED AS AN      */        51000006
* /*   OPTION ON THE MACRO CALL.                              */        51600006
* /*                                                          */        52200006
* /*   OS/VS2 RELEASE2,4/1/73,LEVEL=01                        */        52800006
* /*                                                          */        53400006
* /************************************************************/        54000006
*                                                                       54600006
         DCL 1 EWTCADDR CHAR(44) BASED(ADDR(EWAIERP)) BDY(DWORD),       55200006
*            2 EWTCSNS FIXED (16),     /* SENSE INFORMATION          */ 55800006
*            2 EWTCTID FIXED (16),     /* TERMINAL IDENTIFICATION    */ 56400006
*                                      /* CHARACTERS.                */ 57000006
* /*******************************************************************/ 57600006
* /*         START OF DEVICE DEPENDENT INFORMATION FOR OBR/SDR       */ 58200006
* /*******************************************************************/ 58800006
*            2 EWTCSIO FIXED (16),     /* COUNT OF START I/O COMMANDS*/ 59400006
*                                      /* FOR LINE OR STATION        */ 60000006
*            2 EWTCTMP FIXED  (8),     /* COUNT OF TEMPORARY ERRORS  */ 60600006
*                                      /* FOR LINE OR STATION        */ 61200006
*            2 EWTCMSK FIXED  (8),     /* LINE OR STATION RECORDING  */ 61800006
*                                      /* ERROR MASK                 */ 62400006
*            2 EWTCTPL FIXED  (8),     /* TP OP-CODE OF LAST         */ 63000006
*                                      /* INTERRUPTED I/O OPERATION  */ 63600006
*            2 EWTCTPF FIXED  (8),     /* TP OP-CODE OF FIRST        */ 64200006
*                                      /* INTERRUPTED I/O OPERATION  */ 64800006
*            2 EWTCFLG FIXED  (8),     /* OBR/SDR FLAG BYTE          */ 65400006
*              3 EWTCTEM BIT(1),       /* TEMPORARY ERROR            */ 66000006
*              3 EWTCOVF BIT(1),       /* COUNTER OVERFLOW           */ 66600006
*              3 EWTCEOD BIT(1),       /* END-OF-DAY RECORDING       */ 67200006
*              3 EWTCSEL BIT(1),       /* INITIAL SELECTION ERROR    */ 67800006
*            2 EWTCGRA FIXED  (8),     /* GRAPHIC RESPONSE           */ 68400006
*                                      /* CHARACTER.                 */ 69000006
*            2 EWTCTRM CHAR   (8),     /* TERMINAL OR UCB NAME       */ 69600006
*            2 EWTCSNL FIXED  (8),     /* SENSE OF LAST INTERRUPTED  */ 70200006
*                                      /* I/O OPERATION              */ 70800006
*            2 EWTCSNF FIXED  (8),     /* SENSE OF FIRST INTERRUPTED */ 71400006
*                                      /* I/O OPERATION              */ 72000006
*            2 EWTCRSV1 FIXED (16),    /* RESERVED                   */ 72600006
* /*******************************************************************/ 73200006
* /*         END OF DEVICE DEPENDENT INFORMATION FOR OBR/SDR         */ 73800006
* /*******************************************************************/ 74400006
*            2 EWTCRSV2 FIXED  (8),    /* RESERVED                   */ 75000006
*            2 EWTCCSW  CHAR (7),      /* INTERRUPTED CSW.           */ 75600006
*            2 EWTCCCW CHAR(8),        /* INTERRUPTED CCW.           */ 76200006
             2 EWTCBUFF CHAR(4),       /* ADDRESS OF TPER BUFFER     */ 76400006
*                                      /*  FOR MDR                   */ 76600006
* /*******************************************************************/ 76800006
* /*  0  *   EWTCSNS                   *   EWTCTID                   */ 77400006
* /*******************************************************************/ 78000006
* /*  4  *   EWTCSIO                   *   EWTCTMP    *  EWTCMSK     */ 78600006
* /*******************************************************************/ 79200006
* /*  8  *   EWTCTPL    *   EWTCTPF    *   EWTCFLG    *  EWTCGRA     */ 79800006
* /*******************************************************************/ 80400006
* /* 12  *                         EWTCTRM                           */ 81000006
* /*******************************************************************/ 81600006
* /* 16  *                                                           */ 82200006
* /*******************************************************************/ 82800006
* /* 20  *   EWTCSNL    *   EWTCSNF    *   EWTCRSV1                  */ 83400006
* /*******************************************************************/ 84000006
* /* 24  *   EWTCRSV2   *          EWTCCSW                           */ 84600006
* /*******************************************************************/ 85200006
* /* 28  *                                                           */ 85800006
* /*******************************************************************/ 86400006
* /* 32  *                         EWTCCCW                           */ 87000006
* /*******************************************************************/ 87600006
* /* 36  *                                                           */ 88200006
* /*******************************************************************/ 88800006
* /* 40  *                         EWTCBUFF                          */ 89000006
* /*******************************************************************/ 89200006
*            2 EWTCEND CHAR(0);        /* END OF EWTC                */ 89400006
./  ADD  SSI=60240063,NAME=IEDCBDA
         MACRO                                                          03000010
         IEDCBDA                                                        06000010
* IEDCBDA MACRO UPDATED 4/27/72                                         09000010
*                                                                       12000010
*        THIS IS A DSECT OF THE COMMON BUFFER DATA AREA                 15000010
*                                                                       18000010
IEDCBDA  DSECT                                                          21000010
CBDAINDX DS    XL1 .                    INDEX BYTE                      24000010
CBDAADDR DS    AL3 .                    POINTER TO DATA IN THIS AREA    27000010
CBDALEN  DS    H .                      LENGTH OF DATA IN THIS AREA     30000010
CBDAUSCT DS    H .                      NO OF LCBS USING THIS AREA      33000010
CBDAFLG1 DS    XL1 .                    FLAG BYTE 1                     36000010
CBDAINUS EQU   X'01'                    DATA IN USE                     39000010
CBDAFLG2 DS    XL1 .                    FLAG BYTE 2                     42000010
         DC    H'0' .                   RESERVED                        45000010
CBDASIZE EQU   *                                                        48000010
CBDPRFSZ EQU   CBDASIZE-CBDAINDX                                        51000010
         MEND                                                           54000010
./  ADD  SSI=60240064,NAME=IEDCMB
         MACRO                                                          02000010
         IEDCMB                                                         04000010
* IEDCMB MACRO UPDATED 5/15/72                                          06000010
IEDCMB   DSECT                                                          08000010
*                                                                       10000010
*        THIS IS A DSECT OF THE MASTER QCB FOR COMMON BUFFER            12000010
*        TRANSMISSION.                                                  14000010
*                                                                       16000010
CMBFLAG1 DS    XL1 .                    FLAG BYTE                       18000010
CMBSTCB  DS    AL3 .                    ADDRESS OF FIRST STCB           20000010
CMBPRI   DS    XL1 .                    PRIORITY                        22000010
CMBLINK  DS    AL3 .                    POINTER TO NEXT STCB IN CHAIN   24000010
CMBSTVTO DS    XL1 .                    INDEX TO ENTRY IN THE SUBTASK   26000010
*                                         VECTOR TABLE                  28000010
CMBRETRN DS    AL3 .                    RESERVED                        30000010
CMBDAREA DS    H .                      NUMBER OF DATA AREAS            32000010
CMBASTCB DS    H .                      NUMBER OF AVAILABLE STCB'S      34000010
CMBFINDX DS    XL1 .                    INDEX TO FIRST DATA AREA        36000010
*                                         PREFIX                        37000010
CMBFIRST DS    AL3 .                    ADDRESS OF FIRST DATA AREA      38000010
*                                         PREFIX                        39000010
CMBLINDX DS    XL1 .                    INDEX TO LAST DATA AREA         40000010
*                                         PREFIX                        41000010
CMBLAST  DS    AL3 .                    ADDRESS OF LAST DATA AREA       42000010
*                                         PREFIX                        43000010
CMBNINDX DS    XL1 .                    INDEX TO NEXT DATA AREA         44000010
*                                         PREFIX                        45000010
CMBNEXT  DS    AL3 .                    ADDRESS OF NEXT DATA AREA       46000010
*                                         PREFIX                        47000010
         DS    H .                      RESERVED                        48000010
CMBSIZE  DS    H .                      DATA AREA SIZE                  50000010
*                                                                       52000010
*    DEC                                                                54000010
*         *******************************************************       56000010
*     0   *  FLAG1   **                  STCB                   *       58000010
*         *******************************************************       60000010
*     4   *  PRI     **                  LINK                   *       62000010
*         *******************************************************       64000010
*     8   *  STVTO   **                  RETRN                  *       66000010
*         *******************************************************       68000010
*    12   *          DAREA          **          ASTCB           *       70000010
*         *******************************************************       72000010
*    16   *  FINDX   **                  FIRST                  *       74000010
*         *******************************************************       76000010
*    20   *  LINDX   **                  LAST                   *       78000010
*         *******************************************************       80000010
*    24   *  NINDX   **                  NEXT                   *       82000010
*         *******************************************************       84000010
*    28   *                         **          SIZE            *       86000010
*         *******************************************************       88000010
         MEND                                                           90000010
./  ADD  SSI=62660112,NAME=IEDDCT
*/*                                                                     00010010
         MACRO                                                          00020010
&NAME    IEDDCT    &REG=1,&FLD=,&LEN=4                                  00030010
         LCLA      &NDX                                                 00040010
         LCLB      &KGT1,&LGT6,&L1LT0                                   00050010
         LCLC      &OPS,&MLEN                                           00060010
.*A000000-999999                                               @Y17XAYO 00070010
.*A003820-004060,005650-005850                                 @Y17XAMO 00073010
.*C001700,002600,002900,003400,003800,006500-007060            @Y17XAMO 00076010
&NDX     SETA      2                                                    00080010
&NAME    SR        &REG,&REG      CLEAR FOR IC                          00090010
         IC        &REG,TRMCHCIN  PICK UP DCT INDEX                     00100010
         BCTR      &REG,0         DECREMENT FOR MULTIPLY                00110010
         MH        &REG,AVTDCTLN  GET DCT ADDRESS OFFSET                00120010
         A         &REG,AVTCSTCS  GET ADDRESS OF DCT ENTRY              00130010
         AIF       ('&FLD' EQ '').DONE   NO MOVE ->                     00140010
         AIF       ('&LEN' GT '1').NON0LEN CHECK FOR 0 LEN SPEC         00150010
         MNOTE     0,'ZERO/ONE LENGTH MOVE SPECIFIED - NO MOVE DONE'    00160010
         AGO       .DONE  EXIT                                 @Y17XAMO 00170010
* THE FOLLOWING SEVEN LINES DETERMINE IF THE &LEN SPEC IS A SYMBOL OR   00180010
* A CONSTANT, AND IF A CONSTANT THAT THE VALUE IS SIX OR LESS.          00190010
.NON0LEN ANOP                                                           00200010
&MLEN    SETC      '&LEN'                                               00210010
&KGT1    SETB      (K'&LEN GT 1)                                        00220010
&LGT6    SETB      ('&LEN' GT '6')                                      00230010
&L1LT0   SETB      ('&LEN'(1,1) LT '0')                                 00240010
         AIF   ((&KGT1 AND &L1LT0) OR (NOT(&KGT1 OR &LGT6))).LENOK      00250010
&MLEN    SETC      '4'                                         @Y17XAMO 00260010
.LENOK   AIF       ('&FLD'(K'&FLD,1) EQ ')').BASED                      00270010
         MVC       &FLD.(&MLEN),0(&REG) MOVE THE DCT ENTRY              00280010
         AGO       .CHECK                                      @Y17XAMO 00290010
.BASED   AIF       ('&FLD'(&NDX,1) EQ '(').FOUND                        00300010
&NDX     SETA      &NDX+1                                               00310010
         AIF       (&NDX LT K'&FLD).BASED                               00320010
         MNOTE     12,'INVALID ''TO'' OPERAND SPECIFIED: &FLD'          00330010
         AGO       .DONE  EXIT                                 @Y17XAMO 00340010
.FOUND   ANOP                                                           00350010
&OPS     SETC     '&FLD'(1,&NDX).'&MLEN'.','.'&FLD'(&NDX+1,K'&FLD-&NDX) 00360010
         MVC       &OPS,0(&REG)                                         00370010
*                                MOVE THE DCT ENTRY                     00375010
.CHECK   TM        TRMSTATE,TRMPREF   IS THERE A PREFIX?       @Y17XAMO 00380010
         BNO       $DCT&SYSNDX   NO ->                         @Y17XAMO 00382010
         CLI       TRMTYPE,TRMLUNT   SNA LOGICAL UNIT?         @Y17XAMO 00384010
         BNE       $DCT&SYSNDX  NO ->                          @Y17XAMO 00386010
         ICM       &REG,7,TRMSIBPT PICK UP THE SIB ADDRESS     @Y17XAMO 00388010
         TM        SIBSTAT0-IEDSIBD(&REG),X'7C' LUTYPE 0,1,2,3 @Y17XAMO 00390010
         BNZ       $DCT&SYSNDX  NO ->                          @Y17XAMO 00392010
         TM        SIBSTAT0-IEDSIBD(&REG),X'03' LUTYPE 0 OR 3? @Y17XAMO 00394010
         BNM       #DCT&SYSNDX  YES ->                         @Y17XAMO 00396010
         TM        SIBSTAT0-IEDSIBD(&REG),X'02' IS IT LUTYPE 2 @Y17XAMO 00398010
         BO        #DCT&SYSNDX  YES ->                         @Y17XAMO 00400010
$DCT&SYSNDX LA        &REG,&FLD       PICK UP TARGET ADDRESS   @Y17XAMO 00402010
         B         @DCT&SYSNDX  SKIP AROUND 3270 BIT SETTING   @Y17XAMO 00404010
#DCT&SYSNDX LA        &REG,&FLD       PICK UP TARGET ADDRESS   @Y17XAMO 00406010
         OI        DCTBYTE1-IEDDCT(&REG),DCT3270    SET 3270 BIT        00410010
@DCT&SYSNDX DS        0H                                                00420010
         AGO       .DONE                             */                 00430010
*%IEDDCT: MACRO KEYS(REG,FLD,LEN);                                      00440010
*         DCL (REG,FLD,LEN)    CHAR;                                    00450010
*         DCL (MREG,MFLD,MLEN,SLEN) CHAR;                               00460010
*         DCL FLEN             FIXED;                                   00470010
*         MREG='?'||MACLABEL||' '||MACNAME||' '||MACKEYS||';';          00480010
*         ANS(COMMENT(MREG)) SKIP  COL(MACCOL);                         00490010
*         IF REG(1)='' THEN                                             00500010
*            ANS('/* THE ''REG'' KEYWORD MUST BE SPECIFIED */')  SKIP   00510010
*            MSG('/* THE ''REG'' KEYWORD MUST BE SPECIFIED */');        00520010
*         ELSE DO;                                                      00540010
*              MREG=REG(1);   MFLD=FLD(1);                              00550010
* ANS('/* SET UP ADDRESSABILITY TO THE DCT ENTRY */') COL(9);           00555010
* ANS(MACLABEL||MREG||'=AVTCSTCS+(TRMCHCIN-1)*AVTDCTLN;') SKIP COL(10); 00560010
*              IF MFLD¬='' THEN DO; /* MOVE REQUESTED            */     00570010
*              MLEN=LEN(1);                                             00590010
*              IF MLEN='' THEN MLEN='4';                                00600010
*              ELSE IF INDEX('0123456789',MLEN(1:1))¬=0 THEN DO;        00610010
*              FLEN=FIXED(MLEN); IF FLEN>6 THEN MLEN='4';               00620010
*              ELSE IF FLEN<2 THEN MLEN='4';                 END;       00625010
*              IF INDEX(MFLD,'(')=0 THEN SLEN='(1:'||MLEN||')';         00630010
*              ELSE SLEN='';                                            00640010
* ANS('/* MOVE THE DCT ENTRY TO THE SPECIFIED WORKAREA */') COL(9);     00645010
* ANS(MFLD||SLEN||' = '||MREG||'->IEDDCT(1:'||MLEN||');') SKIP COL(10); 00650010
* ANS('/* SET POINTER TO THE TARGET ADDRESS */') COL(9);                00651010
* ANS(MREG||'=ADDR('||MFLD||'); /*SET UP PTR*/') SKIP COL(15);          00652010
* ANS('/* IS THE DCT FOR AN LU WITH 3270 DATA STREAM */') COL(9);       00653010
* ANS('IF (TRMPREF=''1''B  & TRMTYPE=TRMLUNT & (TRMSIBPT->SIBLUTYP = '||00660010
*'''0000000''B | TRMSIBPT->SIBLUTYP=''0000010''B | TRMSIBPT->SIBLUTYP'||00663010
*' = ''0000011''B)) THEN') COL(10);                                     00666010
* ANS('/* YES - THEN SET THE DCT3270 BIT IN THE COPY MADE */') COL(9);  00669010
* ANS(MREG||'->DCT3270 = ''1''B; /* SET 3270 BIT */') SKIP COL(15);     00698010
*              END; END;                                                00710010
*%END IEDDCT;                         /*                                00720010
.DONE    ANOP                                                           00730010
         MEND                                */                         00740010
./  ADD  SSI=60240068,NAME=IEDHJN
         MACRO                                                          04000010
&NAME    IEDHJN &LABEL,&HJN                                             08000010
         LCLC  &HJA,&HJB                                                12000010
&HJA     SETC  '&SYSPARM'(1,4)                                          16000010
&HJB     SETC  '&SYSPARM'(5,4)                                          20000010
         AIF   ('&LABEL' EQ '').NOBRNCH                                 24000010
         B     &LABEL .                 BR AROUND CONSTANTS             28000010
         SPACE 2                                                        32000010
.NOBRNCH ANOP                                                           36000010
         AIF   ('&NAME' EQ '').NOLABEL                                  40000010
         DC    C'&NAME' .              MODULE IDENTIFIER                44000010
.NOLABEL ANOP                                                           48000010
         DC    X'&HJA' .                DATE OF MODIFICATION            52000010
         AIF   ('&HJN' NE 'HJN').DATE                                   56000010
         DC    X'&HJB' .                HJN OF MODIFICATION             60000010
.DATE    ANOP                                                           64000010
         AIF   ('&LABEL' EQ '').NOLBL                                   68000010
         SPACE 2                                                        72000010
&LABEL   DS    0H                                                       76000010
.NOLBL   ANOP                                                           80000010
         MEND                                                           84000010
./  ADD  SSI=62230006,NAME=IEDQMSG
         MACRO                                                          00800010
&NAME    IEDQMSG   &MSGID=,&FUNCT=,&INBUF=,&LINK=,&INCNT=,&MSG=,&RET=, X01600010
               &RETREG=R14,&PREG1=PARMREG1,&PREG0=PARMREG0,            X02400010
               &OTBUF=,&OTCNT=                                          03200010
         LCLB      &ID,&FN,&OCT,&IBF,&OBF,&MG,&LN,&RT,&ICT              04000010
         LCLC      &FLAGS,&FLAGS1,&REPCNT,&RETURN                       04800010
*                                                                       05600010
*        TOTE MESSAGE CALL MACRO                                        06400010
*                                                                       07200010
*        STATUS = VERSION 10.0                                 @Y17XAUU 08000010
*                                                                       08800010
&ID      SETB      (T'&MSGID NE 'O')                                    09600010
&FN      SETB      (T'&FUNCT NE 'O')                                    10400010
&ICT     SETB      (T'&INCNT NE 'O')                                    11200010
&IBF     SETB      (T'&INBUF NE 'O')                                    12000010
&OBF     SETB      (T'&OTBUF NE 'O')                                    12800010
&MG      SETB      (T'&MSG NE 'O')                                      13600010
&RT      SETB      (T'&RET NE 'O')                                      14400010
&LN      SETB      (T'&LINK NE 'O')                                     15200010
&OCT     SETB      (T'&OTCNT NE 'O')                                    16000010
         AIF       (&ID+&MG+&OBF GT 1).MGER010                          16800010
         AIF       (&OCT+&OBF EQ 1).MGER030                             17600010
         AIF       (&ID+&MG+&OBF EQ 0).BYP010                           18400010
         AIF       (&FN NE 1).MGER040                                   19200010
.BYP010  ANOP                                                           20000010
         AIF       (&ID+&MG+&OBF+&LN EQ 0).MGER050                      20800010
         AIF       (&RT EQ 0).BYP020                                    21600010
         AIF       (&ID+&MG+&OBF EQ 0).MGER060                          22400010
.BYP020  ANOP                                                           23200010
         AGO       .CONT010                                             24000010
.MGER010 ANOP                                                           24800010
         MNOTE 12,'ONLY ONE PARM FROM MSGID, MSG AND OTBUF ALLOWED'     25600010
         MEXIT                                                          26400010
.MGER030 ANOP                                                           27200010
         MNOTE 12,'OTBUF AND OTCNT MUST ALWAYS APPEAR TOGETHER'         28000010
         MEXIT                                                          28800010
.MGER040 ANOP                                                           29600010
         MNOTE 12,'FUNCT MUST BE SPECIFIED WITH MSGID,MSG OR OTBUF'     30400010
         MEXIT                                                          31200010
.MGER050 ANOP                                                           32000010
         MNOTE 12,'MSGID,MSG,OTBUF OR LINK MUST BE SPECIFIED'           32800010
         MEXIT                                                          33600010
.MGER060 ANOP                                                           34400010
         MNOTE 12,'RET MUST APPEAR WITH MSGID,MSG OR OTBUF'             35200010
         MEXIT                                                          36000010
.CONT010 ANOP                                                           36800010
&RETURN  SETC      '$MRT&SYSNDX'                                        37600010
         AIF   (T'&RET EQ 'O').BYP060                                   38400010
&RETURN  SETC  '&RET'                                                   39200010
.BYP060  ANOP                                                           40000010
         AIF   (&ID+&OBF+&MG EQ 0).BYP250                               40800010
         AIF   (N'&FUNCT EQ 0).BYP130                                   41600010
&REPCNT  SETC      '0'                                                  42400010
         AIF   (T'&INCNT EQ 'O').BYP120                                 43200010
&REPCNT  SETC      '&INCNT'                                             44000010
.BYP120  ANOP                                                           44800010
&FLAGS   SETC      '$&FUNCT(1)'                                         45600010
         AIF   (N'&FUNCT EQ 1).BYP180                                   46400010
         AIF   (N'&FUNCT EQ 2).BYP160                                   47200010
.BYP130  ANOP                                                           48000010
         MNOTE 12,'MISSING OR INVALID FUNCT= OPERAND'                   48800010
         MEXIT                                                          49600010
.BYP160  ANOP                                                           50400010
&FLAGS1  SETC      '$&FUNCT(2)'                                         51200010
.BYP180  ANOP                                                           52000010
&NAME    DS    0H .               TOTE MESSAGE CALL                     52800010
         LA    &PREG0,&RETURN .        GET RETURN ADDRESS               53600010
         BAL   &PREG1,$MSGLINK .        BRANCH TO LINKAGE SUBROUTINE    54400010
         AIF   (T'&MSGID EQ 'O').BYP190                                 55200010
         DC    AL2(&MSGID) .         MESSAGE IDENTIFIER                 56000010
         AGO   .BYP195                                                  56800010
.BYP190  ANOP                                                           57600010
         DC    XL2'8000' .        INDICATES MESSAGE IS SUPPLIED         58400010
* .                                 IN PARAMETER LIST                   59200010
.BYP195  ANOP                                                           60000010
         AIF   (N'&FUNCT EQ 2).BYP200                                   60800010
         DC    AL1(&FLAGS) .         FUNCTION FLAGS                     61600010
         AGO   .BYP210                                                  62400010
.BYP200  ANOP                                                           63200010
         DC    AL1(&FLAGS+&FLAGS1) .  FUNCTION FLAGS           @Y17XAUU 64000010
.BYP210  ANOP                                                           64800010
         DC    AL1(&REPCNT) .            REPLY BUFFER LENGTH            65600010
         AIF   (T'&OTBUF EQ 'O').BYP230                                 66400010
         DC    AL1(&OTCNT) .           OUT MESSAGE LENGTH               67200010
         DC    AL3(&OTBUF) .       OUT MESSAGE ADDRESS                  68000010
         AGO   .BYP240                                                  68800010
.BYP230  ANOP                                                           69600010
         AIF   (T'&MSG EQ 'O').BYP240                                   70400010
         DC    AL1($MG&SYSNDX.E-$MSG&SYSNDX.) . OUT MESSAGE LENGTH      71200010
         DC    AL3($MSG&SYSNDX.) .    OUT MESSAGE ADDRESS               72000010
$MSG&SYSNDX DC    C&MSG                                                 72800010
$MG&SYSNDX.E DS    0C                                                   73600010
.BYP240  ANOP                                                           74400010
.BYP250  ANOP                                                           75200010
         AIF   (T'&LINK EQ 'O').BYP450                                  76000010
$MSGLINK DS    0H .               LINK ROUTINE FOR TOTE MSG CALL        76800010
         AIF   ('&LINK' EQ 'XCTL').BYP350                               77600010
         LINK  EP=IEDQWK .        LINK TO TOTE MESSAGE MODULE           78400010
         LR    &RETREG,&PREG0 .          GET RETURN ADDRESS             79200010
         BR    &RETREG .              BRANCH TO RETURN POINT            80000010
         AGO   .BYP370                                                  80800010
.BYP350  ANOP                                                           81600010
         XCTL  (2,12),EP=IEDQWM2 .      GO TO TOTE TRACE MODULE  S99528 82400010
.BYP370  ANOP                                                           83200010
*                                                                       84000010
$CEC     EQU   X'80' .            CONTROL TERMINAL MESSAGE FLAG         84800010
$REP     EQU   X'40' .            C.T. MESSAGE WITH REPLY FLAG          85600010
$PRT     EQU   X'20' .            PRINTER MESSAGE FLAG                  86400010
$SRC     EQU   X'10' .            SOURCE MESSAGE FLAG          @Y17XAUU 87200010
.BYP450  ANOP                                                           88000010
$MRT&SYSNDX DS    0H .                RETURN ADDRESS                    88800010
         MEND                                                           89600010
./  ADD  SSI=72000074,NAME=IOBLOCKS
*        %GOTO PLSIOBK;           /* BILINGUAL HEADER                   00400000
         MACRO                                                          00900020
         IOBLOCKS                                                       01800020
*                                                                       02700020
*        I/O CONTROL BLOCKS  (ECB,TECB ADDRESS,IOB,DCB)                 03600022
*                                                                       03900022
*        VERSION 10.0 (TCAM,TOTE)                              @Y17XAXU 04100000
*                                                                       04500020
IOBLOCKS DSECT                                                          05400020
*                                                                       06300020
*        EVENT CONTROL BLOCK                                            07200020
*                                                                       08100020
ECBOLT   DS    F .                EVENT CONTROL BLOCK                   09000000
*                                                                       09050022
*        UNIT CONTROL BLOCK ADDRESS                                     09100022
*                                                                       09150022
OLTUCBA  DS    AL2 .              UCB ADDRESS                           09160000
*                                                                       09170022
*        TERMINAL NAME TABLE ENTRY OFFSET                               09180022
*                                                                       09190022
OLTTCOFF DS    H .                C. TNT ENTRY OFFSET          @Y17XAXU 09195000
OLTTNOFF DS    H .                REAL TNT ENTRY OFFSET        @Y17XAXU 09200000
OLTTRSID DS    H                  NETWORK ADDRESS              @Y17XAXU 09220000
*                                                                       09250022
*        TCAM RELATIVE LINE NUMBER                                      09300022
*                                                                       09350022
OLTTCRLN DS    C .                RLN                                   09400000
OLTLCBA  DS    AL3 .              LCB ADDRESS OF 3705          @Y17XAXU 09420000
*                                                                       09450022
OLTTCTNT DS    F .                C. TNT ENTRY ADDRESS         @Y17XAXU 09470000
OLTRLTNT DS    A                  REAL TNT ENTRY ADDRESS       @Y17XAXU 09500000
OLTTDLN  DS    H .                LENGTH OF TD TTE AREA        @Y17XAXU 09508000
OLTFLAG1 DS    C .                TEST DEVICE FLAG BYTE        @Y17XAXU 09516000
OLTTNTAS EQU   X'80'              TOTE TNT ENTRY ASSIGNED      @Y17XAXU 09524000
OLTPRSC  EQU   X'20'              ON=PRI TD, OFF=SEC TD        @Y17XAXU 09525000
OLTUNRD  EQU   X'10'              ON=UNREAD DATA               @Y17XAXU 09526000
*                                 OFF=NO UNREAD DATA           @Y17XAXU 09527000
OLTEX    EQU   X'08'              EXCEPTION RESPONSE           @Y17XAXU 09528000
OLTFME   EQU   X'04'              DEFINITE RESPONSE            @Y17XAXU 09529000
OLTEN    EQU   X'02'              ON=EXPEDITED,OFF=NORMAL      @Y17XAXU 09530000
         DS    C                  RESERVED                     @Y17XAXU 09532000
OLTQCBA  DS    A                  QCB ADDRESS                    S22024 09580000
OLTCCWA  DS    A                  ADDRESS OF READ CCW CHAIN      S22024 09660000
OLTBUFA  DS    A                  ADDRESS OF BUFFER CONTAINING   S22024 09700000
*                                 READ DATA                      S22024 09740000
*                                                                       09807022
*        DATA BLOCKING FIELD                                            09814022
*                                                                       09821022
OLTDTBUF DS    A .                RESPONSE BUFFER ADDRESS               09828000
OLTDTCNT DS    H .                RESPONSE BUFFER SIZE                  09835000
OLTFLAG2 DS    BL1 .              DATA BLOCKING SIZE                    09842000
*                                                                       09849022
OLTPTIMD EQU   X'80' .            POST WAITIO IMMEDIATELY               09856022
OLTMVDAT EQU   X'40' .            MOVE RESPONSE TO BUFFER               09863022
OLTLV3IO EQU   X'20' .            LAST EXIO TO DEV WAS LEVEL 3          09870022
OLTSIOAC EQU   X'10' .            EXIO TO DEVICE IS OUTSTANDING         09877022
*                                                                       09884022
         DS    CL1                RESERVED                     @ZM47554 09892010
OLTSN    DS    0F                 DEVICE SEQ NUMBER FIELD      @ZM47554 09893010
         DS    CL2                FLAGS                        @ZM47554 09894010
OLTSEQ   DS    H                  SEQUENCE NUMBER (FROM SNA TH)@ZM47554 09895010
*                                                                       09900020
*        TEST EVENT CONTROL BLOCK ADDRESS                               10800020
*                                                                       11700020
TECBADDR DS    F .                ADDRESS OF TECB                       12600000
*                                                                       13500020
*        I/O BLOCK                                                      14400020
*                                                                       15300020
IOB      DS    0F                                                       16200020
*                                                                       17100020
IOBFLG1  DS    CL1                FIRST FLAG BYTE                       18000020
IOBFLG2  DS    CL1                SECOND FLAG BYTE                      18900020
IOBSNS   DS    CL2                FIRST TWO SENSE BYTES                 19800020
IOBECBAD DS    0F                 ECB ADDRESS                           20700020
IOBECBCD DS    CL1                ECB CODE                              21600020
         DS    CL3                                                      22000022
IOBCSW   DS    0F                 CHANNEL STATUS WORD                   22500020
IOBFLG3  DS    CL1                THIRD FLAG BYTE                       23400020
IOBCSW1  DS    CL7                LAST 7 BYTES OF LAST CSW.             24300020
IOBCCWAD DS    0F                 CCW ADDRESS                           25200020
IOBSIOCD DS    CL1                START I/O CODE                        26100020
         DS    CL3                                                      26500022
IOBDCBAD DS    F                  DCB ADDRESS                           27000020
IOBREPM  DS    CL1                REPOSITION MODIFIER                   27900020
IOBRSTAD DS    CL3                RESTART ADDRESS                       28800020
IOBINCR  DS    CL2                BLOCK COUNT INCREMENT                 29700020
IOBERRCT DS    CL2                ERROR COUNTS                          30600020
IOBUCBX  DS    CL1                UCB INDEX                      S99528 30930022
IOBWORK  DS    CL3                WORK AREA                      S99528 30960022
IOBFLG4  DS    CL1                FLAGS FOR TOTE & ITS APPENDAGE S99528 30990022
IOBATTN  EQU   X'80'              ATTENTION INTERRUPT EXPECTED   S99528 31020022
IOBCSWV  EQU   X'40'              CSW SAVE AREA VALID            S99528 31050022
IOBSEC   EQU   X'20'              SECONDARY IOB                  S99528 31080022
IOBPRI   EQU   X'10'              PRIMARY IOB                    S99528 31110022
IOBATNE  EQU   X'08'              ERROR ON CE/DE BEFORE ATTN     S99528 31140022
IOBCSWNV EQU   X'04'              CSW AREA TWO INVALID           S99528 31150022
IOBCSWS  DS    CL7                CSW SAVE AREA                         31170022
*                                                                       31500020
*        DATA EXTENT BLOCK ADDRESS                                      32400022
*                                                                       33300020
         ORG   IOB+44                                                   43300022
*                                                                       64800020
*        DATA CONTROL BLOCK                                             65700020
*                                                                       66600020
DCB      EQU   *                                                        68400020
*                                                                       69300020
DCBDCDEP DS    5F                 DEVICE DEPENDENT FIELD                70200020
DCBBUFNO DS    C                  NUMBER OF BUFFERS IN DATA SET         71100020
DCBBUFCB DS    CL3                BUFFER POOL CONTROL BLOCK ADDRESS     72000020
DCBBUFL  DS    H                  BUFFER LENGTH                         72900020
DCBDSORG DS    H                  DATA SET ORGANIZATION                 73800020
DCBIOBAD DS    F                  I/O BLOCK ADDRESS                     74700020
DCBBGFEK DS    C                  BUFFER TECNIQUE, BUFFER ALIGNMENT     75600020
DCBEODAD DS    CL3                END OF DATA SET ROUTINE               76500020
DCBRECFM DS    C                  RECORD FORMAT                         77400020
DCBEXLST DS    CL3                EXIT LIST                             78300020
DCBTIOT  DS    H                                                        79200020
DCBMACRF DS    H                  MACRO INSTRUCTION REFERENCE           80100020
DCBIFLGS DS    C                  I/O SUPERVISOR FLAGS                  81000020
DCBDEBAD DS    CL3                DATA EXTENT BLOCK ADDRESS             81900020
OLTDEBA  EQU   DCB+44             DEB ADDRESS                           82300022
DCBOFLGS DS    C                  OPEN FLAGS                            82800020
         DS    CL3                RESERVED                              83700020
DCBOPTCD DS    CL1                OPTION CODES                          84600020
         DS    CL7                RESERVED                              85500020
DCBEOEA  DS    H                  END OF EXTENT APPENDAGE               86400020
DCBPCIA  DS    H                  PROGRAM CONTROLLED INTERRUPT APPENDAG 87300020
DCBSIOA  DS    H                  START I/O APPENDAGE                   88200020
DCBCENDA DS    H                  CHANNEL END APPENDAGE                 89100020
DCBXENDA DS    H                  ABNORMAL END APPENDAGE                90000020
         DS    H                  RESERVED                              90900020
         MEND                                                @Y17XAXU*/ 90907000
*%PLSIOBK: ;                                                            90914000
*DECLARE                                                                90921000
*  1 IOBLOCKS BDY(WORD) BASED,    /*                         @Y17XAXU*/ 90928000
*/*                                                          @Y17XAXU*/ 90935000
*/*      I/O CONTROL BLOCKS  (ECB,TECB ADDRESS,IOB,DCB)      @Y17XAXU*/ 90942000
*/*                 VERSION 10.0 (TCAM,TOTE)                 @Y17XAXU*/ 90949000
*/*                                                          @Y17XAXU*/ 90956000
*/*      EVENT CONTROL BLOCK                                 @Y17XAXU*/ 90963000
*/*                                                          @Y17XAXU*/ 90970000
*   2 ECBOLT PTR(31),             /* EVENT CONTROL BLOCK     @Y17XAXU*/ 90977000
*/*                                                          @Y17XAXU*/ 90984000
*/*      UNIT CONTROL BLOCK ADDRESS                          @Y17XAXU*/ 90991000
*/*                                                          @Y17XAXU*/ 90998000
*   2 OLTUCBA FIXED(16),          /* UCB ADDRESS             @Y17XAXU*/ 91005000
*/*                                                          @Y17XAXU*/ 91012000
*   2 OLTTCOFF FIXED(16),         /* C. TNT ENTRY OFFSET     @Y17XAXU*/ 91019000
*   2 OLTTNOFF FIXED(16),         /* REAL TNT OFFSET         @Y17XAXU*/ 91026000
*   2 OLTTRSID FIXED(16),         /* NETWORK ADDRESS         @Y17XAXU*/ 91033000
*   2 OLTTCRLN CHAR(1),           /* RLN                     @Y17XAXU*/ 91040000
*   2 OLTLCBA PTR(24),            /* LCB ADDRESS OF 3705     @Y17XAXU*/ 91047000
*   2 OLTTCTNT PTR(31),           /* C. TNT ENTRY ADDRESS    @Y17XAXU*/ 91054000
*   2 OLTRLTNT PTR(31),           /* REAL TNT ENTRY ADDRESS  @Y17XAXU*/ 91061000
*   2 OLTTDLN FIXED(15),          /* LENGTH OF TD TTE AREA   @Y17XAXU*/ 91068000
*   2 OLTFLAG1 BIT(8),            /* TEST DEVICE FLAG BYTE 1 @Y17XAXU*/ 91075000
*    3 OLTTNTAS BIT(1),           /* TD TNT ENTRY ASSIGNED   @Y17XAXU*/ 91082000
*    3 * BIT(1),                  /* RESERVED                @Y17XAXU*/ 91089000
*    3 OLTPRSC BIT(1),            /* ON=PRI TD,OFF=SEC TD    @Y17XAXU*/ 91089700
*    3 OLTUNRD BIT(1),            /* ON=UNREAD DATA          @Y17XAUU*/ 91090400
*                                 /* OFF=NO UNREAD DATA      @Y17XAUU*/ 91091100
*    3 OLTEX BIT(1),              /* EXCEPTION RESPONSE      @Y17XAXU*/ 91091800
*    3 OLTFME BIT(1),             /* DEFINITE RESPONSE       @Y17XAXU*/ 91092500
*    3 OLTEN BIT(1),              /* ON=EXPEDITED            @Y17XAXU*/ 91093200
*                                 /* OFF=NORMAL              @Y17XAXU*/ 91093900
*    3 * BIT(1),                  /* UNUSED                  @Y17XAXU*/ 91094600
*   2 * CHAR(1),                  /* RESERVED                @Y17XAXU*/ 91096000
*   2 OLTQCBA PTR(31),            /* QCB ADDRESS             @Y17XAXU*/ 91103000
*   2 OLTCCWA PTR(31),            /* READ CCW CHAIN ADDRESS  @Y17XAXU*/ 91110000
*   2 OLTBUFA PTR(31),            /* ADDRESS OF BUFFER       @Y17XAXU*/ 91117000
*                                 /* CONTAINING READ DATA    @Y17XAXU*/ 91124000
*   2 OLTDTBUF PTR(31),           /* RESPONSE BUFFER ADDRESS @Y17XAXU*/ 91131000
*   2 OLTDTCNT FIXED(15),         /* RESPONSE BUFFER SIZE    @Y17XAXU*/ 91138000
*   2 OLTFLAG2 BIT(8),            /* TEST DEVICE FLAG BYTE 2 @Y17XAXU*/ 91145000
*    3 OLTPTIMD BIT(1),           /* POST WAITI/0 IMMEDIATELY@Y17XAXU*/ 91152000
*    3 OLTMVDAT BIT(1),           /* MOVE RESPONSE TO BUFFER @Y17XAXU*/ 91159000
*    3 OLTLV3IO BIT(1),           /* LAST EXIO WAS LEVEL 3   @Y17XAXU*/ 91166000
*    3 OLTSIOAC BIT(1),           /* EXIO TO DEVICE IS       @Y17XAXU*/ 91173000
*                                 /* OUTSTANDING             @Y17XAXU*/ 91180000
*    3 * BIT(4),                  /* RESERVED                @Y17XAXU*/ 91187000
*   2 * CHAR(1),                  /* RESERVED                @Y17XAXU*/ 91194010
*   2 OLTSN CHAR(4) BDY(WORD),    /* DEVICE SEQ NUMBER FIELD @ZM47554*/ 91195010
*     3 * CHAR(2),                /* FLAGS                   @ZM47554*/ 91196010
*     3 OLTSEQ FIXED(16),         /* SEQUENCE NUMBER (FROM SNA TH    */ 91197010
*                                   /*                       @ZM47554*/ 91198010
*   2 TECBADDR PTR(31),           /* TECB ADDRESS            @Y17XAXU*/ 91201000
*/*                                                          @Y17XAXU*/ 91208000
*/*      I/O BLOCK                                           @Y17XAXU*/ 91215000
*/*                                                          @Y17XAXU*/ 91222000
*   2 IOB BDY(WORD),              /* IOB CONTROL BLOCK       @Y17XAXU*/ 91229000
*    3 IOBFLG1 CHAR(1),           /* FIRST FLAG BYTE         @Y17XAXU*/ 91236000
*    3 IOBFLG2 CHAR(1),           /* SECOND FLAG BYTE        @Y17XAXU*/ 91243000
*    3 IOBSNS CHAR(2),            /* FIRST TWO SENSE BYTE    @Y17XAXU*/ 91250000
*    3 IOBECBAD BDY(WORD),        /* ECB ADDRESS             @Y17XAXU*/ 91257000
*     4 IOBECBCD CHAR(1),         /* ECB CODE                @Y17XAXU*/ 91264000
*     4 * CHAR(3),                /* RESERVED                @Y17XAXU*/ 91271000
*    3 IOBCSW BDY(WORD),          /* CHANNEL STATUS WORD     @Y17XAXU*/ 91278000
*     4 IOBFLG3 CHAR(1),          /* THIRD FLAG BYTE         @Y17XAXU*/ 91285000
*     4 IOBCSW1 CHAR(7),          /* LAST 7 BYTES OF LAST CSW@Y17XAXU*/ 91292000
*    3 IOBCCWAD BDY(WORD),        /* CHANNEL COMMAND WORD    @Y17XAXU*/ 91299000
*     4 IOBSIOCD CHAR(1),         /* START I/O CODE          @Y17XAXU*/ 91306000
*     4 * CHAR(3),                /* LAST 3 BYTES OF CCW     @Y17XAXU*/ 91313000
*    3 IOBDCBAD PTR(31),          /* DCB ADDRESS             @Y17XAXU*/ 91320000
*    3 IOBREPM CHAR(1),           /* REPOSITION MODIFIER     @Y17XAXU*/ 91327000
*    3 IOBRSTAD CHAR(3),          /* RESTART ADDRESS         @Y17XAXU*/ 91334000
*    3 IOBINCR CHAR(2),           /* BLOCK COUNT INCREMENT   @Y17XAXU*/ 91341000
*    3 IOBERRCT CHAR(2),          /* ERROR COUNT             @Y17XAXU*/ 91348000
*    3 IOBUCBX CHAR(1),           /* UCB INDEX               @Y17XAXU*/ 91355000
*    3 IOBWORK CHAR(3),           /* WORK AREA               @Y17XAXU*/ 91362000
*    3 IOBFLG4 BIT(8),            /* FLAGS FOR TOTE AND ITS  @Y17XAXU*/ 91369000
*                                 /* APPENDAGE               @Y17XAXU*/ 91376000
*     4 IOBATTN BIT(1),           /* ATTENTION INTERRUPT     @Y17XAXU*/ 91383000
*                                 /* EXPECTED                @Y17XAXU*/ 91390000
*     4 IOBCSWV BIT(1),           /* CSW SAVE AREA VALID     @Y17XAXU*/ 91397000
*     4 IOBSEC BIT(1),            /* SECONDARY IOB           @Y17XAXU*/ 91404000
*     4 IOBPRI BIT(1),            /* PRIMARY IOB             @Y17XAXU*/ 91411000
*     4 IOBATNE BIT(1),           /* ERROR ON CE/DE BEFORE   @Y17XAXU*/ 91418000
*                                 /* ATTENTION               @Y17XAXU*/ 91425000
*     4 IOBCSWNV BIT(1),          /* CSW AREA TWO INVALID    @Y17XAXU*/ 91432000
*     4 * BIT(2),                 /* RESERVED                @Y17XAXU*/ 91439000
*    3 IOBCSWS CHAR(7),           /* CSW SAVE AREA           @Y17XAXU*/ 91446000
*/*                                                          @Y17XAXU*/ 91453000
*/*      DATA EXTENT BLOCK                                   @Y17XAXU*/ 91460000
*/*                                                          @Y17XAXU*/ 91467000
*   2 DCB BDY(WORD),              /* DATA CONTROL BLOCK      @Y17XAXU*/ 91474000
*    3 DCBDCDEP(5) PTR(31),       /* DEVICE DEPENDENT FIELD  @Y17XAXU*/ 91481000
*    3 DCBBUFNO CHAR(1),          /* NUMBER OF BUFFERS IN    @Y17XAXU*/ 91488000
*                                 /* DATA SET                @Y17XAXU*/ 91495000
*    3 DCBBUFCB CHAR(3),          /* BUFFER POOL CONTROL BLOCK       */ 91502000
*                                 /* ADDRESS                 @Y17XAXU*/ 91509000
*    3 DCBBUFL FIXED(15),         /* BUFFER LENGTH           @Y17XAXU*/ 91516000
*    3 DCBDSORG CHAR(2),          /* DATA SET ORGANIZATION   @Y17XAXU*/ 91523000
*    3 DCBIOBAD PTR(31),          /* I/O BLOCK ADDRESS       @Y17XAXU*/ 91530000
*    3 DCBBGFEK CHAR(1),          /* BUFFER TECHNIQUE        @Y17XAXU*/ 91537000
*                                 /* BUFFER ALLIGNMENT       @Y17XAXU*/ 91544000
*    3 DCBEODAD PTR(24),          /* END OF DATASET ROUTINE  @Y17XAXU*/ 91551000
*                                 /* ADDRESS                 @Y17XAXU*/ 91558000
*    3 DCBRECFM CHAR(1),          /* RECORD FORMAT           @Y17XAXU*/ 91565000
*    3 DCBEXLST PTR(24),          /* EXIT LIST               @Y17XAXU*/ 91572000
*    3 DCBTIOT FIXED(15),         /* OFFSET FROM TIOT ORIGIN @Y17XAXU*/ 91579000
*                                 /* TO TIOELNGH FIELD IN    @Y17XAXU*/ 91586000
*                                 /* TIOT ENTRY FOR DD       @Y17XAXU*/ 91593000
*                                 /* STATEMENT ASSOCIATED    @Y17XAXU*/ 91600000
*                                 /* WITH THIS DCB           @Y17XAXU*/ 91607000
*    3 DCBMACFR CHAR(2),          /* MACRO INSTRUCTION REF   @Y17XAXU*/ 91614000
*    3 OLTDEBA PTR(31),           /* ADDRESS OF ASSOCIATED   @Y17XAXU*/ 91621000
*                                 /* DEB                     @Y17XAXU*/ 91628000
*     4 DCBIFLGS CHAR(1),         /* I/O SUPERVISOR FLAGS    @Y17XAXU*/ 91635000
*     4 DCBDEBAD PTR(24) BDY(BYTE), /* ADDRESS OF ASSOCIATED @Y17XAXU*/ 91642000
*                                 /* DEB                     @Y17XAXU*/ 91649000
*    3 DCBOFLGS CHAR(1),          /* OPEN FLAGS              @Y17XAXU*/ 91656000
*    3 * CHAR(3),                 /* RESERVED                @Y17XAXU*/ 91663000
*    3 DCBOPTCD CHAR(1),          /* OPTION CODE             @Y17XAXU*/ 91670000
*    3 * CHAR(7),                 /* RESERVED                @Y17XAXU*/ 91677000
*    3 DCBEOEA FIXED(15),         /* END OF EXTENT APPENDAGE @Y17XAXU*/ 91684000
*    3 DCBPCIA FIXED(15),         /* PCI APPENDAGE           @Y17XAXU*/ 91691000
*    3 DCBSIOA FIXED(15),         /* SIO I/O APPENDAGE       @Y17XAXU*/ 91698000
*    3 DCBCENDA FIXED(15),        /* CHANNEL END APPENDAGE   @Y17XAXU*/ 91705000
*    3 DCBXENDA FIXED(15),        /* ABNORMAL END APPENDAGE  @Y17XAXU*/ 91712000
*    3 * CHAR(2);                 /* RESERVED                @Y17XAXU*/ 91719000
*                                 /*                         @Y17XAXU*/ 91726000
*%IOBKEND: ;                      /* END OF IOBLOCKS         @Y17XAXU*/ 91733000
./  ADD  SSI=81080482,NAME=IOGENER
         MACRO                                                          00100020
&NAME    IOGENER  &GEN=                                                 00101022
* ****************** MICROFICHE FLAGS *********************** SUPT CODE 00101100
* A079500-081500                                                 S22027 00101200
* A269510-269560,274050-274450,298975-298995,356570-356920       S99228 00101300
* A363070-363420,443210-443280,656050-656400,749600-749900       S99228 00101400
* A788000-790000,786840-796960,823600-823700,902330-902450,907700S99228 00101500
* A175200,322560,322680-322920,810000-812800                     S22029 00101600
* C165800-165850,272000-272300                                   S99228 00101700
* D162000                                                        S99228 00101800
* A175200,322560,322680-322860,808560,808680-808860              S22029 00101900
* C172000-173000                                                 S22029 00102000
* D176000                                                        S22029 00102300
* A272430-273034,653946-653994,744502-744512,                    S22028 00102600
* A901020-901160,907600,933800                                   S22028 00102900
* C273035-273036,648500                                          S22028 00103200
* D298512,298520-298929                                          S22028 00103500
* A259920                                                        A44890 00103800
* C061500,259530                                                 A44890 00104100
* A759000                                                         M1582 00104400
* C061500                                                         M1582 00104700
* A818000                                                         M6293 00105000
* C061500,805700-809000                                           M6293 00105300
* A165700,219200,378500,385500,402500,450700                     S21101 00105600
* C061500,194500-197500                                          S21101 00105900
* D157500,404000                                                 S21101 00106200
* A161500                                                         M5953 00106500
* C061500                                                         M5953 00106800
* C061500,086500                                                 A41024 00107100
* A073500,096200,100500-101000,105500-106500,444000,921500       A41027 00107400
* C061500,082500,084200,085500,091000,095000,097500,099000,      A41027 00107700
* D076000,079500-081500,107000                                   A41027 00108000
* A875000,876500,934500                                          A50191 00108300
* A280700,286000,290500,460500,744980,460640,460850              A48245 00108600
* C280700,727700                                                 A48245 00108900
* D459700,779700,585700                                          A48245 00109200
* C061500,106500-106600                                          A48273 00109500
* A442001-442005,473520-473900,934550                            A48276 00109800
* D460570-460920                                                 S22026 00110100
* A092080-092400,095540-095660,143520-143880,469550-469950       S22026 00110400
* A623060-623420,907580-907900,934200,949200                     S22026 00110700
* A312900,764500                                                 S22025 00111000
* C311500,767500,769500                                          S22025 00111300
* C061500                                                        S22025 00111600
* D460500,465200,460570-460640,460850                            S22025 00111900
* A341500                                                       SA56889 00112200
* A402915                                                       SA53632 00112500
* A205500,207000                                                SA55383 00112800
* A106700                                                       SA53628 00113100
* A356500,382500                                                SA55925 00113400
* C390500                                                       SA55925 00113700
* A026000,035000,491500,919500                                  SA57685 00114000
* C872500,937500,001999                                         SA57685 00114300
* D001500-001998                                                SA57685 00114600
* C005500-006500,934550                                         SA59501 00114900
* C347000,350000                                                SA60341 00115200
* A312920                                                       SA59034 00115500
* C219420,253500-254000                                         SA59034 00115800
* A201700,202500,859500                                         SA61781 00116100
* D341600-341700                                                SA62991 00116400
* D921600                                                        X01004 00116700
* C025500,106940                                                 X01004 00117000
* A322500,383000,810800                                          X02004 00117300
* C322500,322830,323000                                          X02004 00117600
* D811000-812600                                                 X02004 00117900
* A126000,947760                                                OY00451 00118200
* C269000-273023                                                SA68050 00118500
* A901080,933800,938420,947460                                  SA68050 00120000
* A470500                                                       SA69087 00121000
* D072500,152000,156500,184000,190000,198500,242000,272360       S21903 00122000
* D298995,340500,383200,447500,498000,776000,817200,854000       S21903 00123000
* D904000,923000,925000,926500,927000,927700,930000,938500       S21903 00124000
* D943440,943580-943620                                          S21903 00125000
* A269900                                                      @YA03846 00126000
* C165800,269580,298975,356530,363070,442001,443205,473520     @YA03846 00127000
* C848530,947580                                               @YA03846 00128000
* D269200,271500,274050                                        @YA03846 00129000
* A813500                                                      @SA64363 00130000
*A356640,379500                                                @SA69649 00131000
*C352000                                                       @SA69649 00132000
*D352000-356500,394000                                         @SA69649 00133000
*A272500                                                       @SA71925 00134000
*C900000-901040,901060-901085                                  @SA71925 00135000
*A140700                                                       @YA05148 00136000
*C272120-272450                                                @SA73356 00137000
*A787000,789300                                                @SA62375 00138000
*D787900,848530                                                @SA62375 00139000
*A350180,364000                                                @SA72446 00140000
*D813600,813700                                                @SA74549 00141000
.*A099500,D379700                                              @SA74956 00142000
*D925300                                                       @YA10024 00143000
*A157000,A934700                                               @ZA04039 00144000
*D272020-272040                                                @YA05471 00145000
*C936020                                                       @YA10455 00146000
*C938480,938640                                                @YA10429 00147000
.*C876620,C876650,C876670,C876690,A876820                      @YA11011 00148000
.*A372000,927500,930500                                         X30X5MT 00149000
*A372150                                                       @OY12260 00150000
*A255500                                                       @OY12393 00151000
*C875984,A876600                                               @SA76687 00152000
*C473880                                                       @SA76694 00153000
*A379266                                                       @OY12395 00154000
*A282000,940660                                                @XA08073 00155000
*A106988,184500,377000                                         @YA12276 00156000
*C925200                                                       @YA12276 00157000
*D443235                                                       @YA12276 00158000
*D255700                                                       @OX13501 00159000
*D165803-165806,165850,A165900,C350228                         @OX12562 00160000
*D219420-219440,A222000                                        @OS77414 00161000
*D934550                                                       @OY14057 00162000
*A797800                                                       @OS77835 00163000
*C282210,C282270                                               @OX14772 00164000
*C282210,C82270,A897501,A938321,A940641                        @OX14790 00165000
*A276950,277150,C276955                                        @OZ14183 00166000
*A372110,372420,479500,480500,930500                           @OS77867 00167000
.*C194000,199000,385500                                        @OY14092 00168000
.*D380070-380460,431500-432000                                 @OY14092 00187200
.*C078000,102000,372380,797800                                 @G36XRYP 00192200
*C272120-272450                                                @OZ09276 00193200
*A934800                                                       @OZ09276 00194200
*A372465,A930700                                               @OX16705 00195200
*A277210                                                       @OS79864 00195382
*A272270                                                       @OZ26670 00195482
*C290750-290800,A940642,D940680,C937700,A938322,C938360        @OZ28818 00195582
*A897500,D898500                                               @OZ28818 00196082
.********************************************************************** 00197200
IEDQKA01 CSECT                                                          00207200
&NAME    EQU   *                                                        00217200
         ENTRY &NAME                                                    00300020
         TITLE 'ACTIVATE (&NAME)- I/O GENERATOR SUBROUTINE (IEDQKA02)'  00350020
*                                                                     * 00400020
*********************************************************************** 00450020
*                                                                     * 00500020
*  TITLE:  ACTIVATE AND I/O GENERATOR SUBROUTINE ( IOGENER )          * 00550054
*                                                                     * 00556022
         AIF   ('&GEN' NE 'MINI').TAG1                          SA59501 00562022
*  MODULE NAME = IEDQKD (MINI)                                        * 00568022
         AGO   .TAG5                                            SA59501 00574022
.TAG1    AIF   ('&GEN' NE 'STSP').TAG2                          SA59501 00580022
*  MODULE NAME = IEDQKC (STSP)                                        * 00586022
         AGO   .TAG5                                            SA59501 00592022
.TAG2    AIF   ('&GEN' NE 'BISC').TAG3                          SA59501 00598022
*  MODULE NAME = IEDQKB (BISC)                                        * 00604022
         AGO   .TAG5                                            SA59501 00610022
.TAG3    AIF   ('&GEN' NE 'QTAM').TAG4                          SA59501 00616022
*  MODULE NAME = IEDQKE (QTAM)                                        * 00622022
         AGO   .TAG5                                            SA59501 00628022
.TAG4    ANOP                                                   SA59501 00634022
*  MODULE NAME = IEDQKA (BOTH)(BLANK)                                 * 00640022
.TAG5    ANOP                                                   SA59501 00646022
*                                                                     * 00652022
*  DESCRIPTIVE NAME = ACTIVATE AND I/O GENERATOR ROUTINE              * 00658022
*                                                                     * 00664022
*  COPYRIGHT = 'NONE'                                                 * 00670022
*                                                                     * 00676022
*  STATUS:  CHANGE LEVEL 5                                            * 00682051
*                                                                     * 00700020
*FUNCTION -- THE FUNCTION OF THIS MODULE IS TO CONSTRUCT CHANNEL      * 00750020
*   PROGRAMS FOR INITIAL CONTACT, CONTINUE, AND RESET SEQUENCES.      * 00800020
*                                                                     * 00850020
*ENTRY POINTS --                                                      * 00900020
*   ACTIVATE                                                          * 00950020
*        CALLING SEQUENCE                                             * 01000020
*        L     R15,ADDR OF ACTIVATE                                   * 01050020
*        BR    R15                                                    * 01100020
*                                                                     * 01150020
*   I/O GENERATOR SUBROUTINE                                          * 01200020
*        L     12,ADDR OF I/O GENERATOR SUBROUTINE                    * 01250020
*        BALR  5,12                                                   * 01300020
*                                                                     * 01350020
*INPUT -- REGISTERS SET BY CALLER                                     * 01400020
*   FOR 'ACTIVATE' --                                                 * 01450020
*   R1  ADDR OF ERB OR BUFFER                                         * 01500020
*   R13 ADDR OF AVTSAVE2                                              * 01550020
*                                                                     * 01600020
*   FOR 'I/O GENERATOR' --                                            * 01650020
*   R13 ADDR OF AVTSAVE2                                              * 01700020
*   R2  LCB ADDRESS                                                   * 01750020
*   R5  RETURN ADDRESS                                                * 01800020
*                                                                     * 01850020
*OUTPUT -- REGISTERS AT EXIT                                          * 01900020
*   FOR 'ACTIVATE' --                                                 * 01950020
*   R11 DISPATCHER BASE                                               * 02000020
*   R13 ADDR OF AVTSAVE2                                              * 02050020
*                                                                     * 02100020
*   FOR 'I/O GENERATOR SUBROUTINE' --                                 * 02150020
*   R5  RETURN ADDRESS                                                * 02200020
*   R13 ADDR OF AVTSAVE2                                              * 02250020
*                                                                     * 02300020
*EXTERNAL ROUTINES --                                                 * 02350020
*   'IEDQTNT'-- USED TO CONVERT TWO BYTE TNT OFFSET TO TERMIANL       * 02400020
*   TABLE ENTRY ADDRESS.                                              * 02450020
*                                                                     * 02500020
*   SVC 114 -- EXCPVR (AOS)                                           * 02550005
*   SVC 35--WTO                                                SA57685* 02600022
*EXITS-NORMAL --                                                      * 02650020
*   'ACTIVATE' - RETURNS TO DISPATCHER TO DISPATCH NEXT READY STCB OR * 02700020
*   TO POST A CHAIN OF BUFFERS TO MH.                                 * 02750020
*                                                                     * 02800020
*   'I/O GENERATOR SUBROUTINE' - RETURNS TO CALLER                    * 02850020
*                                                                     * 02900020
*EXITS-ERROR -- NONE                                                  * 02950020
*                                                                     * 03000020
*TABLES/WORK AREAS -- DSECTS OF CONTROL BLOCKS AS EXPANDED BY MACROS  * 03050020
*        DCBD  DSORG=TX                                                 03100022
*        TAVTD                                                          03110022
*        TCCWD                                                          03120022
*        TDEBD                                                          03130022
*        TDISPD                                                         03140022
*        TLCBD                                                          03150022
*        TPRFD                                                          03160022
*        TPRIOR                                                         03170022
*        TQCBD                                                          03180022
*        TQCBED                                                         03190022
*        TSCBD                                                          03200022
*        TSTCBD                                                         03210022
*        TTSID                                                          03220022
*        TTNTD                                                          03230022
*        TTPD                                                           03240022
*        TTRMD                                                          03250022
*                                                                     * 03550020
*ATTRIBUTES                                                           * 03600020
*   'ACTIVATE' -- REUSABLE,REFRESHABLE                                * 03650020
*                                                                     * 03700020
*   'I/O GENERATOR SUBROUTINE' - RE-ENTRANT,REFRESHABLE - WHEN        * 03750020
*                                ENTERED FROM ACTIVATE.               * 03800020
*   PROBLEM PROGRAM MODE, ENABLED.  WHEN ENTERED FROM IGG019R0        * 03850020
*   -SUPERVISOR MODE, DISABLED.                                       * 03900020
*                                                                     * 03950020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 04000020
*   PARTICUALR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 04050020
*   SET.                                                              * 04100020
*                                                                     * 04150020
* CHANGE ACTIVITY =                                            @Y16X5I0 04160000
*A-000000-999999                                               @Y16X5I0 04170000
*C147500                                                       @Y17XAII 04175000
*                                                              @Y16X5I0 04180000
*D184580-184900,377080-377400                                  @Y17XAIZ 04190000
*********************************************************************** 04200020
         EJECT                                                          04250020
         ENTRY IEDQKA02                                                 04350020
         DC    AL1(DSPMCPL2)            STCB OFFSET                     04400020
         DC    AL1(0)                                                   04450020
*    ACTIVATE IS ENTERED HERE WHEN GIVEN CONTROL BY THE DISPATCHER.   * 04500020
*                                                                       04550020
ACTIVATE EQU   *                        ENTRY PT FROM DISPATCHER        04600020
         SPACE 3                                                        04650020
         USING *,15                     LINK REGISTER                   04700022
         USING IHADCB,RDCB              DCB REGISTER                    04740022
         USING IEDQTRM,RTERM            TERM ENTRY REGISTER             04780022
         USING AVTSAVE2,RAVT            AVT SAVE REGISTER               04820022
         USING IEDQLCB,RLCB             LCB REGISTER                    04860022
         USING IEDQLCBX,RWKC            LCB EXTENSION ADDR       S99228 04920022
         USING IEDQCCW,RCCW             CCW REGISTER                    04950022
         USING IEDQDISP,RSUPBASE        DISPATCHER BASE                 04980022
         SPACE 3                                                        05010022
* REGISTER DEFINITIONS                                                  05050020
R0       EQU   0                        MODULE WORK REG                 05100022
RPARM    EQU   1                        PARAMETER REG                   05110022
RLCB     EQU   2                        LCB BASE                        05200020
RTPCDE   EQU   3                        PTS TO CURR TP FIELD IN LCB     05250020
RDCB     EQU   4                        DCB BASE                        05300020
R2       EQU   5                        WORK REGISTER                   05350020
RWKA     EQU   6                        WORK REG                        05400020
RWKB     EQU   7                        WORK REG                        05450020
RTERM    EQU   8                        TERM ENTRY BASE                 05500020
RWKC     EQU   9                        WORK REGISTER                   05550020
RCCW     EQU   10                       CCW BASE                        05600020
RSUPBASE EQU   11                       DISPATCHER BASE                 05650020
RMOD     EQU   11                       PTS TO MODEL CCW'S              05700020
RBASE    EQU   12                       BASE ADDRESS FOR I/O GENERATOR  05750020
RAVT     EQU   13                       AVT BASE ADDRESS                05800022
REXPND   EQU   14                       LINK REG FOR EXPAND ROUTINE     05850020
RLNK1    EQU   15                       WORK REG                        05900022
         EJECT                                                          05950020
         STM   11,15,12(13)             SAVE REQUIRED REGISTERS         06000020
&NAME    IEDHJN ID                                               S22025 06050022
         LR    RLCB,RPARM               ERB ADDRESS                     06250020
         TM    PRFTIC-IEDQPRF(RPARM),CCWTIC ERB OR BUFFER               06300020
         BZ    ITSERB                   BRANCH IF ERB                   06350020
         L     RLCB,PRFLCB-1-IEDQPRF(RPARM) SET LCB BASE                06400020
         B     ITSLCB                   CONTINUE                        06450020
ITSERB   EQU   *                                                        06500020
         SH    RLCB,LCBBKUP             BACK UP TO LCB                  06550020
ITSLCB   EQU   *                                                        06600020
         L     RDCB,LCBDCBPT            DCB BASE                        06650020
         AIF   ('&GEN' EQ 'BISC').L6                                    06700020
         AIF   ('&GEN' EQ 'MINI').L6                                    06750020
         AIF   ('&GEN' EQ 'QTAM').L6                                    06770020
         TM    LCBTSOB,LCBTSBUF         IS THIS A TS BUFFER?        TSO 06800020
         BZ    TSO1                     BRANCH ON NO                TSO 06850020
         L     RWKA,AVTTSOPT            GET ADDRESS OF TS SCHED     TSO 06900020
         L     RWKA,TSISCHED-IEDQTSI(,RWKA)                         TSO 06950020
         BAL   RTPCDE,24(RWKA)          BRANCH TO ROUTINE           TSO 07000020
TSO1     EQU   *                                                    TSO 07050020
.L6      ANOP                                                           07100020
         LA    RBASE,BUILD              IOGEN SUBROUTINE            TSO 07150020
         BALR  R2,RBASE                 LINK TO IO GEN                  07200020
         LM    11,15,12(13)             RESTORE REGISTERS               07300020
         MVC   LCBTTCIN,LCBTTBIN        TO BE CONNECTED IS NOW CON-     07350020
         SPACE 2                                                 A41027 07360020
         L     RWKB,DCBMH-1 .           GET MH -CB ADDRESS FOR POA41027 07370020
         SR    RWKC,RWKC .              CLEAR POST LIST FOR FINALA41027 07380020
*                                         EXIT TO DISPATCHER     A41027 07390020
         SPACE 2                                                 A41027 07392020
*        UNIT EXCEPTION BIT WILL BE SET WHEN AA CONTINUE OR ABORTA41027 07394020
* SEQUENCE CAN NOT BE SENT (EX. 1030, 2260L, ETC.)               A41027 07396020
         TM    LCBCSW+3,UNEX            NO RESTART ON CONTINUE          07400020
*                                         REQUEST                       07450020
         BZ    NOTUNEX                  BRANCH NO                       07500020
         SPACE                                                          07550020
         L     RPARM,LCBLSPCI-1         BUFFER TO POST                  07650020
         MVI   PRFPRI-IEDQPRF(RPARM),PRIMHBFR POST PRIORITY             07700020
         NI    PRFSTAT1-IEDQPRF(RPARM),PRFNLSTF 'LAST BUFFWR'           07750020
         STCM  RWKB,7,PRFQCBA-IEDQPRF(RPARM) SET POST ADDRESS  @G36XRYP 07800000
         BAL   REXPND,DSPPOST           POST BUFFER TO MH      @Y17XAIX 07850000
NOTUNEX  EQU   *                                                        07900020
         AIF   ('&GEN' EQ 'STSP').Z0 .                           S22027 07950022
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').Z0 .       S22027 08000022
         TM    LCBSTICS+1,CBRDCAST .    BROADCAST MESSAGES       S22027 08050022
         BO    EXITDSP .                BRANCH IF YES            S22027 08100022
.Z0      ANOP                                                    S22027 08150022
         TM    LCBSTAT2,LCBMSGNN        MSG GEN                         08200020
         BO    EXITDSP .                BRANCH YES               A41027 08250020
         SPACE 2                                                 A41027 08260020
         TM    LCBSTAT1,LCBRECVN        RECEIVE STATE                   08400020
         AIF   ('&GEN' NE 'MINI').Z1                                    08410020
         BO    EXITDSP .                YES                      A41027 08420020
         AGO   .Z2                                                      08430020
.Z1      ANOP                                                           08440020
         BZ    NOTRCV                   NO                              08450020
         CLI   LCBCPA+24,CCWPOLL        AUTOPOLL IN USE                 08500020
         BNE   EXITDSP .                NO                       A41027 08550020
         SPACE                                                          08600020
*        WANT TO OPEN LIST FOR SEND STCB OR POLL DELAY           A41024 08650020
         CLI   DCBINTVL,AVTEZERO .      POLL DELAY  SPECIFIED    A41024 08660020
         BNE   ITSHERE .                BRANCH IF YES            A41024 08670020
         LA    RWKA,LCBSTCBA-5          RECEIVE STCB -4                 08700020
         CLI   LCBRSKEY,BUFFVTO         BUFFERED LCB                    08750020
         BNE   LOOPPOLL                 BRANCH IF NO                    08800020
         SPACE                                                          08850020
         LA    RWKA,LCBRSKEY            ADJUST FOR LOOP CONTROL         08900020
LOOPPOLL EQU   *                                                        08950020
         L     RWKA,STCBLINK-1-IEDQSTCB(RWKA) NEXT STCB IN CHAIN        09000020
         CLI   STCBPRI-IEDQSTCB(RWKA),0 LAST STCB (QEVENT)              09050020
         BE    EXITDSP .                YES                      A41027 09100020
         CLI   STCBVTO-IEDQSTCB(RWKA),SENDVTO SEND STCB                 09150020
         BE    ITSHERE                  YES                             09200020
         AIF   ('&GEN' EQ 'MINI').CONC1A .                       S22026 09208022
         CLI   STCBVTO-IEDQSTCB(RWKA),CSVTO .                    S22026 09216022
*                                       CONC SCHEDULER           S22026 09224022
         BE    ITSHERE .                BRANCH IF YES            S22026 09232022
.CONC1A  ANOP .                                                  S22026 09240022
         CLI   STCBVTO-IEDQSTCB(RWKA),BUFFVTO BUFFERED SEND STCB        09250020
         BNE   LOOPPOLL                 NO TRY NEXT STCB                09300020
         SPACE                                                          09350020
ITSHERE  EQU   *                                                        09400020
         MVI   LCBCPA+32,CCWNOP         NOP FIRST TIC                   09450020
         B     EXITDSP .                EXIT                     A41027 09500020
         SPACE 2                                                 A41027 09510020
NOTRCV   EQU   *                                                        09550020
.Z2      ANOP                                                           09570020
*                                                                A41027 09580020
*        FOR DEVICES THAT ARE NOT SELECTED BUFFERS ARE POSTED NOWA41027 09590020
         SPACE                                                          09600020
         TM    LCBSTAT2,LCBRESP         POST BUFFER NOW                 09610020
         BNZ   POST                     YES, CONVERSE RESPONSE          09620020
* INSTEAD OF LINE END APPENDAGE                                  A41027 09630020
*                                                                A41027 09640020
         TM    LCBSTICS+1,CBISYNC+CSTNCTL+CTWX CAN TERMINAL BE          09650020
*                                         SELECTED                      09700020
         BNZ   EXITDSP .                NOT START STOP CONTENTIONA41027 09750020
         SPACE                                                          09800020
         TM    LCBSTICS+2,CWTTA         WORLD TRADR                     09850020
         BNZ   EXITDSP .                YES                      A41027 09900020
POST     EQU   *                                                        09950020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET RESPONSE BIT     @SA74956 09970058
         L     RWKA,LCBERBCH-1          ADDRESS OF FIRST BUFFER         10000020
         LR    RWKC,RWKA .              SAVE POINTER TO POST LISTA41027 10050020
LOOP     EQU   *                                                        10150020
         STCM  RWKB,7,1(RWKA)           QCB ADDRESS FOR POST   @G36XRYP 10200000
         MVI   4(RWKA),PRIMHBFR         SET POST PRIORITY               10250020
         L     RWKA,4(,RWKA)            LINK ADDRESS NEXT BUFFER        10300020
         LA    RWKA,AVTEZERO(,RWKA)     CLEAR HI ORDER BYTE             10350020
         LTR   RWKA,RWKA                IS THERE A NEXT BUFFER          10400020
         BNZ   LOOP                     YES                             10450020
         SPACE                                                          10500020
         XC    LCBERBCH,LCBERBCH .      RESET FIELD FOR LATER USEA41027 10550020
         LR    RPARM,RWKC .             ASSUME LOCAL DEVICE      A41027 10600020
         TM    LCBSTICS+1,CLOCAL+CAUDIO . LOCAL DEVICE           A48273 10650022
         BZ    ADDLABEL .               BR YES, EXCP WILL BE   @Y17XAIX 10660000
*                                         AT BUFFER ASSOCIATION  A41027 10670020
         BAL   REXPND,DSPCHAIN                                 @Y17XAIX 10671000
ADDLABEL TM    LCBSTICS+2,CNOIDLES      NO IDLES LOOP (2260R)  @Y17XAIX 10672000
         BNO   EXITDSP                  BRANCH IF YES,EXCP DONE@Y17XAIX 10674000
*                                         BUFFER ASSOCIATION    SA53628 10676022
         BAL   REXPND,DSPCHAIN                                 @Y17XAIX 10678000
EXITDSP  EQU   *                                                 A41027 10680020
         SPACE                                                          10690020
         LA    RPARM,LCBFLAG1 .         EXCP PARAMETER (IOB)     A41027 10692020
         EXCPVR (1),SUBSYS                                       X01004 10694005
         SPACE 2                                                 A41027 10696020
         LR    RPARM,RWKC .             POST PARAMETER LIST      A41027 10698020
         BAL   REXPND,DSPCHAIN          EXIT TO POST BUFFERS OR@Y17XAIX 10698400
*                                         DISPATCH NEXT STCB     A41027 10698820
         EJECT                                                          10750020
*        C O D I N G    T E C H N I Q U E S                             10800020
         SPACE 1                                                        10850020
*     THE CHANNEL PROGRAM CONSTRUCTED IS BASED UPON THE CHARACTER-      10900020
* ISTICS OF THE DEVICE (OBTAINED FROM THE DEVICE CHARACTERISTICS        10950020
* FOR THIS TERMINAL OR LINE ENTRY).  THE I/O GENERATOR SUBROUTINE       11000020
* TESTS CHARACTERISTICS BITS AND TRANSFERS CONTROL TO THE 'EXPAND'      11050020
* ROUTINE (DESCRIBED BELOW) PASSSING AN OFFSET INTO A MODEL CCW         11100020
* TABLE.                                                                11150020
*  E. G. REXPND (REG14)=A(EXPAND)                                       11200020
*        BALR  RLNK1,REXPND                                             11250020
*        DC    AL2(MODCCW08-MODCCW)                                     11300020
*     THIS SEQUENCE BUILDS A DISABLE-ENABLE SEQUENCE.                   11350020
*     THE MODEL CCW TABLE CONSISTS OF TWO BYTE ENTRIES.                 11400020
* THE FIRST BYTE IS AN OFFSET INTO A SECOND TABLE (EXPANDER TABLE).     11450020
* THE SECOND BYTE CONTAINS THE CCW FLAGS FOR THE CCW BEING BUILT.       11500020
* THE EXPAND ROUTINE MOVES THE SPECIFIED FLAGS FOR THE CCW              11550020
* THE EXPAND ROUTINE MOVES THE SPECIFIED FLAGS INTO THE CCW AND         11600020
* UTILIZES THE ONE BYTE INDEX (FROM THE MODEL CCW TABLE) TO ACCESS      11650020
* THE FOLLOWING INFORMATION FROM THE EXPANDER TABLE:                    11700020
*     EACH ENTRY IN THE EXPANDER TABLE HAS THE FOLLOWING FORMAT:        11750020
*        DC    AL2(OFFSET TO A ROUTINE THAT ESTABLISHES ADDRESS         11800020
*                  AND COUNT)                                           11850020
*        DC    AL1(CCWDISAB)            CCW OP CODE                     11900020
*        DC    AL1(TPDISAB)             TP OP CODE                      11950020
*     THE EXPAND ROUTINE PASSES CONTROL TO AN EXPANDER SUBROUTINE       12000020
* (BY BRANCHING TO ORGRTN INDEXED BY THE 2 BYTE OFFSET) THAT COM-       12050020
* PUTES CCWDATA ADDRESS AND COUNT.  UPON REGAINING CONTROL, THE         12100020
* EXPAND ROUTINE MOVES THE CCWOP CODE INTO THE CCW AND THE TP OP        12150020
* CODE INTO THE LCB FROM THE EXPANDER TABLE.                            12200020
*     RETURNING AGIN TO THE EXAMPLE, THE FIRST CCW IN THE SEQUENCE      12250020
* (DISABLE) HAS BEEN BUILT.  A REGISTER IS ADJUSTED TO POINT TO THE     12300020
* ENTRY IN THE MODEL CCW TABLE AND A TEST IS PERFORMED FOR THE LAST     12350020
* ENTRY.  IF THIS IS NOT THE LAST ENTRY THE ABOVE ACTION IS PER-        12400020
* FORMED AGAIN TO CONSTRUCT THE NEXT CCW (THE ENABLE).  EXPAND RE-      12450020
* TURNS TO IN-LINE CODE OF THE I/O GENERATOR WHEN THE LAST ENTRY        12500020
* IS REACHED.                                                           12550020
         SPACE 2                                                        12600020
         DC    A(IOGENEND-IEDQKA02)     LENGTH TO FIX FOR TSO   OY00451 12620005
* CONTROL IS GIVEN TO BUILD WHEN ENTERED FROM AN APPENDAGE.           * 12650020
BUILD    EQU   *                                                        12700020
IEDQKA02 EQU   *                                                        12750020
         USING *,RBASE                                                  12800020
         L     RDCB,LCBDCBPT                                            12850020
         LA    RWKA,LCBCPA+16           START ON 3RD CCW                12900020
         ST    RWKA,LCBSTART-1          PARAMETER FOR IOS               12950020
         NI    LCBCSW+3,AVTEFF-UNEX     RESET SWITCH                    13000020
         LH    RWKC,LCBTTBIN            TERMINAL TO BE CONNECTED        13050020
         AIF   ('&GEN' EQ 'MINI').L7                                    13070020
         LTR   RWKC,RWKC                SPECIFIC CONNECTION             13100020
         BNZ   CONNECT1                 BRANCH YES                      13150020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       13250020
         BZ    NONDIAL                  NO                              13300020
         SPACE                                                          13350020
         LH    RWKC,LCBLNENT            ADDRESS OF LINE ENTRY           13400020
         LTR   RWKC,RWKC                DO WE HAVE LINE ENTRY           13450020
         BNZ   CONNECT1                 BRANCH YES                      13500020
         SPACE                                                          13550020
NONDIAL  EQU   *                                                        13600020
         SR    RTERM,RTERM              CLEAR FOR INDEXING              13700020
         IC    RTERM,LCBUCBX            RLN-1                           13750020
         SLL   RTERM,2                  MULTIPLY FOR INDESX             13800020
         L     RTERM,DCBINVLI(RTERM)    ILIST FOR THIS LINE             13850020
         LA    RTERM,AVTEZERO(,RTERM)   CLEAR HI ORDER BYTE             13900020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'QTAM').LAA1              13910020
         L     RWKA,LCBINVPT-1          CURRENT INVITATION LIST         13920020
         CLI   0(RWKA),X'FE'            IS THIS END OF LIST             13930020
         BE    LEND                    END OF LIST              SA65910 13932005
         CLI   1(RWKA),X'FE'           IS THIS END OF LIST      SA65910 13934005
         BNE   NOTEND                  BRANCH NO                SA65910 13936005
LEND     EQU   *                                                SA65910 13938005
         BNE   NOTEND                   BRANCH ON NO                    13940020
.LAA1    ANOP                                                           13942020
         BCTR  RTERM,0                  BACK UP                         13950020
         BCTR  RTERM,0                  NOW TWO                         14000020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'QTAM').LAA2              14010020
         B     CONNECT0                                                 14020020
NOTEND   EQU   *                                                        14030020
         SR    RWKC,RWKC                CLEAR FOR IC                    14040020
         IC    RWKC,2(RTERM)            ENTRY WIDTH                     14042020
         BCTR  RWKC,0                   REDUCE BY ONE                   14044020
         IC    RWKC,0(RWKA,RWKC)        GET ENTRY INDEX                 14046020
         SLL   RWKC,1                   MULTIPLY BY TWO                 14048020
         SR    RTERM,RWKC               GET ACTUAL ENTRY OFFSET         14048420
CONNECT0 EQU   *                                                        14048820
.LAA2    ANOP                                                           14049220
         LH    RWKC,AVTEZERO(,RTERM)    REPRESENATIVE ENTRY             14050020
         TM    LCBSTAT2,LCBMSGNN       IS THIS A MESSAGE GEN    SA65910 14060005
         BNO   CONNECT1                BRANCH NO                SA65910 14070005
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @YA05148 14073056
         BO    CONNECT1                 YES, BRANCH            @YA05148 14076056
         STH   RWKC,LCBTTBIN           REPRESENATIVE ENTRY      SA65910 14080005
CONNECT1 EQU   *                                                        14100020
.L7      ANOP                                                           14120020
         N     RWKC,AVTCLRHI            CLEAR NEGATIVE PROPAGATION      14150020
         L     RWKB,AVTRNMPT            ADDRESS OF TNT                  14200020
         USING IEDQTNTD,RWKB                                            14250020
         BAL   RWKA,TNTDCODE            LNK TO ROUTINE                  14300020
         DROP RWKB                                                      14350020
         AIF   ('&GEN' EQ 'MINI').CONC2A .                       S22026 14352022
         TM    TRMDEVFL+1,TRMCONC .     CONC                     S22026 14354022
         BNO   NOTCONC .                BRANCH IF NO             S22026 14356022
         L     RWKA,TRMDESTQ-1 .        QCB ADDR                 S22026 14358022
         TM    QCBDSFLG-IEDQQCB(RWKA),QCBDRQQ .                  S22026 14360022
*                                       DATA READY QUE           S22026 14362022
         BO    NOTCONC .                BRANCH IF YES            S22026 14364022
         TM    LCBSTAT1,LCBSENDN .      LCB SENDING              S22026 14366022
         BNO   NOTSEND .                BRANCH IF NO             S22026 14368022
         TM    TRMDEVFL,X'20' .         ADDRESSING CHARS         S22026 14370022
         BO    NOTCONC .                BRANCH IF YES            S22026 14372022
NOTSEND  EQU   * .                                               S22026 14374022
         LH    RWKB,QCBEXTO-IEDQQCB(RWKA) .                      S22026 14376022
*                                       QCB EXTENSION OFFSET     S22026 14378022
         AR    RWKA,RWKB .              COMPUTE ADDR             S22026 14380022
         L     RTERM,QCBECONC-IEDQQCBE-1(RWKA) .                 S22026 14382022
*                                       CONC TERM ADDR           S22026 14384022
NOTCONC  EQU   * .                                               S22026 14386022
.CONC2A  ANOP .                                                  S22026 14388022
         LA    REXPND,EXPAND            SET-UP LINK FOR EXPAND          14400020
         LH    RWKA,TRMSIO              SIO COUNTER                     14450020
         LA    RWKA,1(,RWKA)            BUMP                            14500020
         STH   RWKA,TRMSIO              ST BACK                         14550020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             14600020
         IC    RWKA,TRMCHCIN            INDEX INTO CHARACTERISTIC       14650020
         BCTR  RWKA,R0                  DECREMENT FOR N-1TH ENTRY       14700020
         MH    RWKA,AVTDCTLN            MULTIPLY BY ENTRY LEN  @Y17XAII 14750000
         A     RWKA,AVTCSTCS            ADD TABLE START                 14800020
         MVC   LCBSTICS-1(4),0(RWKA)    CHARACTERISTICS TO LCB          14850020
         AIF   ('&GEN' EQ 'BISC').LA1                                   14900020
         AIF   ('&GEN' EQ 'MINI').LA1                                   14950020
         AIF   ('&GEN' EQ 'QTAM').LA1                                   14970020
         TM    LCBSTICS,C5041           1050/2741 LINE?             TSO 15000020
         BZ    TSO10                    NO                          TSO 15050020
         TM    LCBTSOB,LCB2741N         IS IT A 2741?               TSO 15100020
         BNO   S1050                    NO. USE 1050 CH'STICS       TSO 15150020
         MVC   LCBSTICS(3),D41STICS     2741 DEVICE CH'STICS        TSO 15250020
         B     TSO10                                                TSO 15300020
S1050    EQU   *                                                    TSO 15350020
         MVC   LCBSTICS(3),D50STICS     1050 CH'STICS               TSO 15400020
TSO10    EQU   *                                                    TSO 15450020
.LA1     ANOP                                                           15500020
         TM    LCBSTAT1,LCBCONT         REQU%EST FOR CONTINUE           15550020
         BNZ   CONTINUE                 BRANCH YES                      15600020
         MVI   LCBINCAM,AVTEZERO        RESET ERROR COUNTER             15700020
         CLI   DCBEIOBX,XC8             IS EXTENSION PRESENT   @ZA04039 15740058
         BL    CKMSGEN                  BRANCH-NO              @ZA04039 15780058
         MVI   LCBCPA+53,AVTEZERO       RESET LOCAL RETRY COUNT@ZA04039 15820058
CKMSGEN EQU *                                                  @ZA04039 15860058
         SPACE                                                          15900020
         TM    LCBSTAT2,LCBMSGNN        MSGEN                           15950020
         BO    MSGGEN                   YES                             16000020
         TM    LCBSTAT1,LCBSENDN        SEND STATE                      16050020
         BO    WRITINIT                 YES                             16100020
         TM    LCBSTAT2,LCBRESP         OWE A RESPONSE                  16110020
         BZ    READ                     NO                              16120020
         BAL   R0,WRRESP                BUILD RESPONSE                  16150020
READ     EQU   *                                                        16550020
         AIF   ('&GEN' EQ 'MINI').L4A3                         @YA03846 16580056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 16580122
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 16581022
         BO    KEEPSET                  YES, NO RESET ACK-1      S99228 16582022
.L4A3    ANOP                                                    S99228 16582522
         MVI   LCBERCCW+12,FLAG         SET ONLY SILI FLAG IN CCWS99228 16583022
         MVI   LCBMSGFM,AVTEZERO        RESET FORMAT BITS AND AC S99228 16584022
*                                         COUNTER                S21101 16590020
KEEPSET  EQU   *                                               @OX12562 16592000
         NI    LCBMSGFM,LCBACKI         CLEAR BSC CONTROL,LEAVE@OX12562 16594000
*                                       ACK COUNTER            @OX12562 16596000
         L     RWKC,LCBLSPCI-1           ADDRESS FO FIRST BUFFER        16600020
         LH    RWKA,AVTKEYLE             SIZE OF A UNIT                 16650020
         CH    RWKA,DCBBUFSI            COMPARE WITH DCB OPERAND        16700020
         BNH   SETSIZE                  BRANCH DCB LESS OR EQUAL        16750020
         LH    RWKA,DCBBUFSI            DCB PARAMETER                   16800020
SETSIZE  EQU   *                                                        16850020
          SR    RWKB,RWKB                CLEAR WORK REGISTER            16900020
         AIF   ('&GEN' EQ 'MINI').L8                                    16950020
         AIF   ('&GEN' EQ 'BISC').L8                                    17000020
         AIF   ('&GEN' EQ 'QTAM').L8                                    17020020
** TSO---CHECK FOR CORRECT DATA COUNT                               TSO 17050020
**                                                                  TSO 17100020
         TM    LCBTSOB,LCBTSBUF         IS THIS A TSO BUFFER        TSO 17150020
         BO    TSOB                     DO NOT RESERVE CHARS     S22029 17200022
*                                       FOR TIME-SHARING MSGS    S22029 17300022
.L8      ANOP                                                           17400020
         IC    RWKB,DCBRESER            IDLES RESERVED FOR HEADER       17450020
TSOB     EQU   *                                                 S22029 17470022
         STC   RWKB,LCBISZE             SET IDLES COUNT IN LCB          17500020
         LA    RWKB,PRFSHDR-PRFSUNIT(,RWKB) BUMP BY HEADER SIZE         17550020
         SR    RWKA,RWKB                 DATA COUNT FOR 1ST VUFFER      17650020
          STH  RWKA,CCWCOUNT-CCW(,RWKC) ESTABLISH COUNT                 17700020
         IC    RWKA,PRFOPCDE-IEDQPRF(,RWKC) SAVE OP CODE                17750020
         LA    RWKB,PRFSUNIT-IEDQPRF(RWKB,RWKC) START ADDRESS-CCW       17800020
         ST     RWKB,PRFIOADR-1-IEDQPRF(,RWKC) SET IN CCW               17850020
         STC    RWKA,PRFOPCDE-IEDQPRF(,RWKC) RESTORE OP CODE            17900020
         NI    PRFSTAT1-IEDQPRF(RWKC),PRFNHDRF 'TEXT' BIT OFF           17950020
         EJECT                                                          18000020
*                                                                       18050020
*        * * * * * * * * * * * * * * * * * * * * * * * * * *            18100020
*        *                                                 *            18150020
*        *     R E A D    I N I T I A L    L O G I C       *            18200020
*        *                                                 *            18250020
*        * * * * * * * * * * * * * * * * * * * * * * * * * *            18300020
         SPACE 3                                                        18350020
         NI    LCBSTAT2,AVTEFF-LCBRESP  TURN OFF RESPONSE BIT           18450020
         LA    RCCW,LCBCPA              SET CCW BASE                    18500020
         LA    RTPCDE,LCBTPCD           SET TP OP CODE BASE             18550020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  18600020
         DC    AL2(MODCCW00-MODCCW)                                     18650020
         AIF   ('&GEN' EQ 'MINI').L10                                   18700020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE?                      19050020
         BZ    NOSWITCH                 BRANCH IF NOT                   19100020
         SPACE 5                                                        19150020
******** D I A L    L I N E S ********                                  19200020
         SPACE 2                                                        19250020
         TM    LCBSTAT2,LCBNEGRP        NEG RESPL TO POLLING            19300020
         BO    ENAB                     YES, WANT TO DISCONNECT         19350020
         TM    LCBCHAIN,LCBCTLMD        DIAL UP READ           @OY14092 19400000
         BZ    CONNECT .                NO                       S21101 19450020
         SPACE 5                                                 S21101 19500020
* D I A L    C O N N E C T I O N                                        19800020
         NI    LCBCHAIN,AVTEFF-LCBCTLMD                        @OY14092 19900000
         AIF   ('&GEN' NE '').L11                                       19950020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        20000020
         BZ    NODLUPBS                 BRANCH NO                       20050020
.L11     ANOP                                                           20100020
         AIF   ('&GEN' EQ 'STSP').L12                                   20150020
         AIF   ('&GEN' EQ 'QTAM').L12                                   20170020
         TM    LCBTPCD+11,DISDLEOT      WRITE DISCONNECT        SA61781 20173005
         BO    GODISCON                 BR YES                  SA61781 20176005
         OI    LCBTPCD+11,DISDLEOT      SET TO WRITE DISCONNECT SA61781 20179005
*                                         PRIOR TO NEXT DISABLE SA61781 20182005
         LA    RTPCDE,ONE(,RTPCDE)      ADJUST TP CODE BASE     SA61781 20185005
         LA    RCCW,EIGHT(,RCCW)        ADJUST CCW BASE         SA61781 20188005
         ST    RCCW,LCBSTART-1          SET START ADDRESS       SA61781 20191005
         B     NODISCON                 CONTINUE                SA61781 20194005
GODISCON EQU   *                                                SA61781 20197005
         BALR  RLNK1,REXPND             LINK TO EXPAND                  20200020
         DC    AL2(MODCCW01-MODCCW)                                     20250020
         B     NEXT                     CONTINUE                SA61781 20258005
NODISCON EQU   *                                                SA61781 20266005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE    SA61781 20274005
         DC    AL2(MODCCW02-MODCCW)                             SA61781 20282005
NEXT     EQU   *                                                SA61781 20290005
         SPACE                                                          20300020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               20350020
         CLI   IDLOC+1(RWKC),0          ID SPECIFIED                    20400020
         BE    NOTANID                  BRANCH IF NO ID                 20450020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  20500020
         DC    AL2(MODCCW14-MODCCW)                                     20550020
         B     WREOT                    GO WRITE EOT ONLY       SA55383 20570022
NOTANID  EQU   *                                                        20600020
         BALR  RLNK1,REXPND             LINK TO EXPNAD                  20650020
         DC    AL2(MODCCW15-MODCCW)                                     20700020
WREOT    EQU   *                                                SA55383 20720022
         BALR  RLNK1,REXPND             LINK TO EXPNAD                  20750020
         DC    AL2(MODCCW16-MODCCW)                                     20800020
.L12     ANOP                                                           20850020
         AIF   ('&GEN' EQ 'BISC').L222                                  20900020
NODLUPBS EQU   *                                                        20950020
         BALR  RLNK1,REXPND             BUILD DISABLE DIAL              21000020
         DC    AL2(MODCCW02-MODCCW)                                     21050020
         TM    LCBSTICS+1,CTWX                                          21100020
         BZ    BLDPADS                  BUILD WRITE PADS                21150020
         BALR  RLNK1,REXPND             READ TERM ID                    21200020
         DC    AL2(MODCCW32-MODCCW)                                     21250020
         BALR  RLNK1,REXPND             WRITE CPU ID  AND READ          21300020
         DC    AL2(MODCCW18-MODCCW)                                     21350020
BLDPADS  EQU   *                                                        21360020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  21370020
         DC    AL2(MODCCW36-MODCCW)                                     21380020
         B     CONNECT .                BUILD REST OF CANNEL PROGAM     21390020
.L222    ANOP                                                           21400020
         EJECT                                                          21450020
* E N A B L E    C O N N E C T I O N                                    21500020
ENAB     EQU   *                                                        21550020
         NI    LCBSTAT2,AVTEFF-LCBNEGRP NEGATIVE RESPONSE OFF           21600020
         MVI   LCBTSTSW,AVTEZERO        INDICATE LINE NOT CONNECTED     21650020
         AIF   ('&GEN' NE '').L14                                       21700020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        21750020
         BZ    NOBSD                    NO                              21800020
.L14     ANOP                                                           21850020
         AIF   ('&GEN' EQ 'STSP').L15                                   21900020
         AIF   ('&GEN' EQ 'QTAM').L15                                   21920020
         L     RWKA,LCBSCBA-1           GET SCB POINTER          S21101 21930020
         USING IEDQSCB,RWKA .                                    S21101 21940020
         TM    LCBTPCD+11,DISDLEOT      NEED DLE EOT PRIOR TO DISAB     21950020
         BO    SNDLEEOT                 BRANCH IF YES                   22000020
         SPACE                                                          22050020
         OI    LCBTPCD+11,DISDLEOT      SET FOR NEXT TIME-LINE END      22100020
*                                         WILL RESET IF DLE EOT         22150020
*                                         RECEIVED                      22200020
         TM    SCBBSCFM,SCBNOEOT        DO WE OWE EOT          @OS77414 22210000
         BO    SNDLEEOT                 YES SEND DLE EOT       @OS77414 22220000
         OI    SCBBSCFM,SCBNOEOT        SET EOT RECEIPT PENDING@OS77414 22230000
         DROP  RWKA                                            @OS77414 22240000
         LA    RTPCDE,1(,RTPCDE)        ADJUST TP OP CODE BASE          22250020
         LA    RCCW,8(,RCCW)            RESET CCW BASE                  22300020
         ST    RCCW,LCBSTART-1          AND SET START ADDRESS           22350020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22400020
         DC    AL2(MODCCW7B-MODCCW)                                     22450020
         B     NXTBSCCW                 CONTINUE BUILDING               22500020
SNDLEEOT EQU   *                                                        22550020
         SPACE                                                          22600020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22650020
         DC    AL2(MODCCW07-MODCCW)     DISABLE SEQUENCE                22700020
         SPACE                                                          22750020
NXTBSCCW EQU   *                                                        22800020
         CLI   DCBINTVL,TONEOPT         WRITE TONE REQUESTED            22850020
         BNE   NOTONE                   BRANCH IF NO                    22900020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22950020
         DC    AL2(MODCCW7A-MODCCW)                                     23000020
         SPACE                                                          23050020
NOTONE   EQU   *                                                        23100020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23150020
         DC    AL2(MODCCW10-MODCCW)                                     23200020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               23250020
         CLI   IDLOC+1(RWKC),0          CPU ID SPECIFED                 23300020
         BE    NOBSID                   NO                              23350020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23400020
         DC    AL2(MODCCW11-MODCCW)                                     23450020
NOBSID   EQU   *                                                        23500020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23550020
         DC    AL2(MODCCW12-MODCCW)                                     23600020
.L15     ANOP                                                           23650020
         AIF   ('&GEN' EQ 'BISC').L16                                   23700020
         AIF   ('&GEN' EQ 'QTAM').L16A                                  23720020
         SPACE                                                          23730020
NOBSD    EQU   *                                                        23740020
         MVI   LCBTPCD+11,X'AB'         SET FIRST TIME SWITCH   TSO     23750020
         TM    LCBSTICS,C5041 .         THIS A 5041 LINE            TSO 23760020
         BZ    TSO99 .                  NO                          TSO 23770020
         NI    LCBTSOB,X'FF'-LCB2741N . RESET 2741 FLAG IF ON       TSO 23780020
TSO99    EQU   * .                                                  TSO 23790020
         L     RLNK1,DCBTRANS-1 .       POINT TO TABLE OR LIST      TSO 23802020
         TM    0(RLNK1),X'80' .         IS IT TRANLIST MACRO        TSO 23804020
         BZ    TSO20 .                  NO                          TSO 23806020
         MVC   AVTPARM3(4),OPTLIST .    SKELETON PARAM LIST         TSO 23808020
         IC    RWKB,1(,RLNK1) .         OPTION FIELD OFFSET         TSO 23810020
         STC   RWKB,AVTPARM3+2 .        TO PARM LIST                TSO 23812020
         LA    RPARM,AVTPARM3 .         PARM LIST POINTER           TSO 23814020
         LA    RAVT,72(,RAVT) .         KICK DOWN FOR UI            TSO 23818020
         STM   2,12,28(RAVT) .          SAME AS IEDQUI DOES         TSO 23818320
         LA    REXPND,LOCRTN .          SET UP RETURN            S22025 23818622
         ST    REXPND,12(,RAVT) .       SAVE IT                  S22025 23818722
         LR    RWKC,RAVT                LOAD CALLERS ADDR        S22025 23818822
         LA    RAVT,72(RAVT)            BUMP TO NEXT SAVEAREA    S22025 23818922
         ST    RWKC,4(RAVT)             STORE BACK CHAIN         S22025 23819022
         ST    RAVT,8(RWKC)             STORE FORWARD CHAIN             23819122
         L     RWKC,CVTPTR .                                        TSO 23819220
         L     RWKC,AVTCVTPT(,RWKC) .                               TSO 23819520
         L     RWKC,0(,RWKC) .          POINT TO AVT                TSO 23819820
         L     RBASE,AVTMSGS-1-IEDQAVTD(RWKC)                    S22025 23820122
*                                       VCON LIST ADDR           S22025 23820222
         L     RBASE,20(,RBASE) .       OFFSET TO AE VCON=20        TSO 23820420
         LR    RDCB,RLCB .              AE USES 4 FOR LCB           TSO 23820720
         BR    RBASE .                  TO IEDQAE                   TSO 23821020
LOCRTN   EQU   * .                                                  TSO 23821320
         SH    RAVT,H72 .               RESTORE AVTPOINTER          TSO 23822020
         LA    REXPND,EXPAND .          RESTORE CALL REG            TSO 23824020
         LTR   RLNK1,RLNK1 .            SEE IF OPTION FLD PRESENT   TSO 23826020
         BZ    TSO20 .                  NO. NOTHING TO DO               23828020
         XC    0(4,RLNK1),0(RLNK1) .    YES. ZERO FOR NEXT USE      TSO 23830020
TSO20    EQU   * .                                                  TSO 23832020
.L16A    ANOP                                                           23838020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               23850020
         DC    AL2(MODCCW08-MODCCW)                                     23900020
         SPACE 2                                                        24150020
         AIF   ('&GEN' EQ 'QTAM').L16B                                  24170020
         TM    LCBTSOB,LCB2741N         THIS A 2741                 TSO 24250020
         BO    NOSWITCH                 USED LEASED CODE                24300020
         TM    LCBSTICS,C5041           1050/2741 LINE?             TSO 24350020
         BO    SPEC41                   YES. PUT UP SPECIAL CCWS    TSO 24400020
.L16B    ANOP                                                           24420020
         TM    LCBSTICS+1,CAUDIO        AUDIO                           24450020
         BNZ   NOSWITCH                 NO                              24500020
         EJECT                                                          24700020
.L16     ANOP                                                           24750020
* C O N N E C T I O N    P R E V I O U S L Y    D O N E                 24800020
         SPACE 1                                                        24850020
CONNECT  EQU   *                                                        24900020
         AIF   ('&GEN' NE '').L17                                       24950020
         TM    LCBSTICS+1,CBISYNC       BY SYNC LINE                    25000020
         BZ    NOTBSCD                                                  25050020
.L17     ANOP                                                           25100020
         AIF   ('&GEN' EQ 'STSP').L18                                   25150020
         AIF   ('&GEN' EQ 'QTAM').L18                                   25170020
         L     RWKA,LCBSCBA-1           GET SCB ADDRESS                 25200020
         USING IEDQSCB,RWKA                                             25250020
         TM    SCBBSCFM,SCBNOEOT .      DID WE SEND A MSG        S21101 25300020
         BO    SENDEOT                  BR IF NOT               SA59034 25350005
         OI    SCBBSCFM,SCBNOEOT        SET RECEIPT OF EOT AS   SA59034 25380005
*                                         PENDING               SA59034 25410005
         BALR  RLNK1,REXPND             BUILD READ ENQ                  25450020
         DC    AL2(MODCCW17-MODCCW)                                     25500020
SENDEOT  EQU   *                                                        25550020
         DROP RWKA                                                      25600020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               25650020
         DC    AL2(MODCCW16-MODCCW)                                     25700020
.L18     ANOP                                                           25750020
         AIF   ('&GEN' EQ 'BISC').L10                                   25800020
NOTBSCD  EQU   *                                                        25850020
         TM    LCBSTICS+1,CTWX          TWX                             25900020
         BZ    NOSWITCH                 NO                              25950020
         AIF   ('&GEN' EQ 'QTAM').L18A                           A44890 25953021
         TM    LCBTSOB,LCBINHBN    INHIBITS TO BE DONE             TSO  25957020
         BZ    NOTWIN .                 BRANCH NO                       25964020
*                                                                       25971020
         BALR  RLNK1,REXPND                                             25978020
         DC    AL2(MODCCW19-MODCCW)                                     25985020
NOTWIN   EQU   *                                                        25992020
.L18A    ANOP                                                    A44890 25996021
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26000020
         DC    AL2(MODCCW18-MODCCW)                                     26050020
.L10     ANOP                                                           26100020
         SPACE 5                                                        26150020
********       L E A S E D    L I N E S      ********                   26200020
         SPACE 2                                                        26250020
NOSWITCH EQU   *                                                        26300020
         TM    LCBSTICS+1,CCONTENT      CONTENTION                      26350020
         BO    CONTT                                                    26400020
         AIF   ('&GEN' EQ 'BISC').Z4                                    26420020
         TM    LCBSTICS+1,CLOCAL+CAUDIO  LOCAL OR AUDIO                 26450020
         AIF   ('&GEN' NE 'MINI').Z3                                    26460020
         BZ    TRSTCTL                                                  26470020
         AGO   .M4                                                      26480020
.Z3      ANOP                                                           26490020
         BZ    NOLOC                    NO                              26500020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               26600020
         CLI   IDLOC+1(RWKC),0          CPU ID FOR AUDIO                26650020
         BE    NOIDAUD                  NONE SPECIFIED                  26700020
         SPACE                                                          26750020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26800020
         DC    AL2(MODCCW63-MODCCW)                                     26850020
NOIDAUD  EQU   *                                                        26900005
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 26910005
         BZ    NOC3270                  BRANCH NO                S99228 26915005
         TM    LCBSTICS+ONE,CLOCAL      LOCAL DEVICE?            S99228 26920005
         BZ    NOC3270                  BRANCH NO                S99228 26925005
         LA    RCCW,LCBCPA+16           SET CCW ADDR             S99228 26930005
         BALR  RLNK1,REXPND             LINK TO EXPAND           S99228 26935005
         DC    AL2(MODCCW73-MODCCW)     3270 LOCAL READ CH PGM   S99228 26940005
NOC3270  EQU   *                                                 S99228 26945005
         AIF   ('&GEN' EQ 'QTAM').M4                           @YA03846 26950056
         TM    LCBTSOB,LCBTSBUF .       IS THIS A TSO LINE          TSO 26955005
         BZ    NOSW1 .                  BRANCH NO                   TSO 26960005
         MVC   LCBSTART,LCBLSPCI .      START READ ON BUFFER        TSO 26965005
NOSW1    EQU   *                                                        26970005
.M4      ANOP                                                           26972056
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26975005
         DC    AL2(MODCCW64-MODCCW)                                     26980005
         AIF   ('&GEN' EQ 'MINI').Z5                                    26985005
NOLOC    EQU   *                                                        26990005
.Z4      ANOP                                                           26995005
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27005005
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 27010005
         BO    SAMESET                  YES, NO RESET ACK CNTR   S99228 27015005
         OI    LCBMSGFM,LCBACKI         FIRST ACK ON P MPT IC OD S99228 27020005
SAMESET  EQU   *                                                 S99228 27025005
         BAL   RWKB,ILIST               LOCATE INVITATION LIST   S99228 27035005
         AIF   ('&GEN' EQ 'QTAM').L446                           S22028 27040005
         AIF   ('&GEN' EQ 'BISC').L446                           S22028 27045005
         L     RWKA,TRMDESTQ-1          GET ADDRESS OF QCB       S22028 27050005
         TM    QCBFLAG-IEDQQCB(RWKA),QCBTSSES IS THIS TSO SESSIONS22028 27055005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27060005
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 27065005
         BO    CHKRESTR                 BRANCH ON YES         S22028TSO 27070005
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27075005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27080005
         TM    LCBSTICS+1,CBISYNC       IS THIS A 3270 REMOTE    S22028 27085005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27090005
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27095005
         TM    LCBXFLAG,LCBERPND        SOH%R PENDING?           S99228 27100005
         BO    AUTOPOLL                 BRANCH YES               S99228 27105005
         L     RWKA,TRMDESTQ-ONE        RESTORE DEST QCB ADDR    S99228 27110005
CHKRESTR EQU   *                                                 S22028 27115005
         CLI   LCBTPCD+11,X'BE'         IS START MI TO BE SENT   S22028 27120005
         BE    SNDSMI                   BRANCH ON YES            S22028 27125005
         TM    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI HAS START MI GONE S22028 27130005
         BO    AUTOPOLL                 YES, BRANCH              S22028 27135005
         MVI   LCBTPCD+11,X'BE'         SET TP CODE FOR SMI         TSO 27140005
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27145005
         BO    WRADD327                 BRANCH ON YES         S22028TSO 27150005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 27155005
         DC    AL2(MODCCW51-MODCCW)                                 TSO 27160005
         BR    R2                       RETURN                      TSO 27165005
WRADD327 EQU   *                                              S22028TSO 27170005
         MVI   LCBMSGFM,AVTEZERO        RESET ACK COUNTER     S22028TSO 27175005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE  S22028TSO 27180005
         DC    AL2(MODCCW44-MODCCW)                           S22028TSO 27185005
SNDSMI   EQU   *                        TSO                             27190005
         TM    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI HAS WCC BEEN SENT S22028 27195005
         BO    CHK3270R                 YES, BRANCH              S22028 27200056
SNDSMI1  EQU   *                                                 S22028 27201056
         OI    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI SET START MI SENT    TSO 27205056
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM     S22028  27206056
         BO    SNDRESTR                 BRANCH ON YES         S22028TSO 27207056
         MVI   LCBTPCD+11,AVTEZERO      RESET TP CODE               TSO 27208056
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 27209056
         DC    AL2(MODCCW90-MODCCW)                                 TSO 27210056
SNDRESTR EQU   *                                              S22028TSO 27211056
         L     RLNK1,DCBSCTAD-1         ADDR SP. CHAR. TABLE   @OZ09276 27211500
         SR    RWKB,RWKB                CLEAR WORK REGISTER    @OZ09276 27212000
         IC    RWKB,0(RLNK1)            PICK UP EOT OFFSET     @OZ09276 27217000
         AR    RLNK1,RWKB               POINT TO EOT ENTRY     @OZ09276 27222000
         CLI   ONE(RLNK1),ASCIIEOT      IS IT 3270 ASCII       @OZ09276 27227000
         BNE   EBCDWCC                  NO, MUST BE EBCDIC     @OZ26670 27236082
         OI    LCBTPCD+11,X'01'         INDICATE ASCII         @SA71925 27246056
EBCDWCC  EQU   *                                               @SA71925 27247056
         CLI   QCBSATCT-IEDQQCB(RWKA),ZERO IS THIS LINE ZERO    SA68050 27260005
         BNE   SNDREST1                 NO, BRANCH              SA68050 27265005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE    SA68050 27270005
         DC    AL2(MODCCW93-MODCCW)                             SA68050 27275005
         BR    R2                       RETURN                  SA68050 27280005
SNDREST1 EQU   *                                                SA68050 27285056
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE  S22028TSO 27295056
         DC    AL2(MODCCW92-MODCCW)                           S22028TSO 27305056
         BR    R2                       RETURN                S22028TSO 27315056
CHK3270R EQU   *                                                 S22028 27325056
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27335056
         BZ    SNDSMI1                  NO, BRANCH               S22028 27345056
         MVI   LCBTPCD+11,AVTEZERO      RESET TP CODE            S22028 27355056
         B     AUTOPOLL                 BRANCH                   S22028 27365056
AUTOPOLL EQU   *                                                 S22028 27375056
         BAL   RWKB,ILIST               LOCATE INVITATION LIST   S22028 27385056
.L446    ANOP                                                    S22028 27395056
         TM    3(RWKC),AUTOPL           AUTO POLL IN USE         S22028 27405056
         BZ    TRSTCTL                  BRANCH NO                S22028 27415056
         L     RWKA,LCBSCBA-1 .         GET CURRENT WCB ADDRESS         27425056
         USING IEDQSCB,RWKA                                             27435056
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN EXTENDED LOCK                 27445056
         BM    TRSTCTL .                BRANCH YES, DON'T WANT A        27455056
*                                         DIFFERENT SOURCE TERMINAL     27465056
         DROP  RWKA                                                     27475056
* A U T O P O L L    L I N E                                            27485056
         SPACE 1                                                        27495056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27505056
         TM    LCBXFLAG,LCBERPND        SOH%R MESSAGE PENDING?   S99228 27515056
         BO    GETSOHR                  BRANCH YES               S99228 27525056
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 27535056
         BZ    AUTOREG                  BRANCH NO                S99228 27545056
GETSOHR  EQU   *                                                 S99228 27555056
         NI    LCBXFLAG,LCBGPSTP        RESET GENERAL POLL INDIC S99228 27565056
         BALR  RLNK1,REXPND             BRANCH TO EXPAND ROUTINE S99228 27575056
         DC    AL2(MODCCW28-MODCCW)     GENPOLL READ INIT OFFSET S99228 27585056
AUTOREG  EQU   *                                                 S99228 27595056
.L423    ANOP                                                    S99228 27605056
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               27615056
         DC    AL2(MODCCW26-MODCCW)                                     27625056
         SPACE 2                                                        27635056
         SPACE 2                                                        27645056
.Z5      ANOP                                                           27655056
* L O C A L    D E V I C E                                              27665056
         SPACE 1                                                        27675056
* C O N T E N T I O N    L I N E                                        27685056
         SPACE 1                                                        27695056
CONTT    EQU   *                                               @OZ14183 27700000
*                                       LEASED+DIALWITH ENABLE AND      27705000
*                                         DIAL REQUESTS.                27715056
         L     RWKA,TRMDESTQ-1          GET ADDR OF DEST QCB   @OZ14183 27715600
         TM    QCBFLAG-IEDQQCB(RWKA),QCBTSSES IS IT TSO SESSION@OZ14183 27716200
         BO    GORCV                    BRANCH YES-CONTINUE RCV@OZ14183 27716800
         TM    LCBSTAT1,LCBOCNI         STOPLINE IN PROGRESS   @OZ14183 27717400
         BO    GOSEND                   BRANCH YES             @OZ14183 27718000
         TM    LCBSTAT2,LCBSNDPR        SEND SCH WANT LINE?    @OZ14183 27718600
         BZ    GORCV                    BRANCH-NO              @OZ14183 27719200
GOSEND   EQU   *                                               @OZ14183 27719800
         MVC   LCBQCBA(THREE),AVTBSCAN+1 SET BD ADDRESS        @OZ14183 27720400
         MVI   LCBPRI,PRIFSPCI-1        SET CLEANUP PRIORITY   @OZ14183 27721000
         NI    LCBSTAT2,AVTEFF-LCBSNDPR CLEAR SEND SCHED BIT   @OS79864 27721382
         LR    RPARM,RLCB                                      @OZ14183 27721600
         L     RSUPBASE,AVTEA                                  @OZ14183 27722200
         BAL   REXPND,DSPPOST           GO END SEND OPERATION  @Y17XAIX 27722800
GORCV    EQU   *                                               @OZ14183 27723400
         AIF   ('&GEN' EQ 'BISC').L19                                   27725056
         AIF   ('&GEN' EQ 'STSP').L20                                   27735056
         AIF   ('&GEN' EQ 'MINI').L21                                   28050020
         AIF   ('&GEN' EQ 'QTAM').L20                            A48245 28070022
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      28100020
         BZ    NOTBSC                   NO                              28150020
.L19     ANOP                                                           28200020
         L     RWKA,LCBSCBA-1           GET SCB PTR            @XA08073 28203058
         USING IEDQSCB,RWKA                                    @XA08073 28206058
         TM    SCBBSCFM,SCBNOEOT        SEND PRI W MASTER=YES? @XA08073 28209058
         BNO   NORMAL                   NO, FORGET EOT BUILD   @XA08073 28212058
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT BIT          @XA08073 28215058
         DROP  RWKA                                            @XA08073 28218058
         LA    RCCW,LCBCPA              ADDR OF CHANNEL PROGRAM@OX14790 28221000
         ST    RCCW,LCBSTART-1          SAVE FOR SIO           @XA08073 28224058
         LA    RTPCDE,LCBTPCD           TP OP CODE ADDRESS     @OX14790 28227000
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE      @XA08073 28230058
         DC    AL2(MODCCW75-MODCCW)                            @XA08073 28233058
NORMAL   EQU   *                                               @XA08073 28236058
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               28250020
         DC    AL2(MODCCW22-MODCCW)                                     28300020
         AIF   ('&GEN' EQ 'BISC').L22                                   28350020
NOTBSC   EQU   *                                                        28400020
.L20     ANOP                                                           28450020
         TM    LCBTSOB,LCB2741N         2741 TERM?                  TSO 28550020
         BZ    TRY2                                                 TSO 28600020
         AIF   ('&GEN' EQ 'QTAM').L201                           A48245 28605022
         TM    LCBTSOB,LCBTSBUF         TSO IN CONTROL                  28610020
         BZ    ITSTCAM                  BRANCH IF NO                    28620020
         SPACE                                                          28630020
         CLI   LCBTPCD+11,X'AB'         FIRST TIME                  TSO 28650020
         BNE   NORM41                   SEND EOT NOW                TSO 28700020
         MVI   LCBTPCD+11,0             CLEAR FIRST TIME INDIC      TSO 28750020
         BALR  RLNK1,REXPND                                         TSO 28800020
         DC    AL2(MODCCW54-MODCCW)                                 TSO 28850020
         SPACE                                                          28900020
NORM41   EQU   *                                                    TSO 28950020
         BALR  RLNK1,REXPND                                         TSO 29000020
         DC    AL2(MODCCW52-MODCCW)                                 TSO 29050020
.L201    ANOP                                                    A48245 29052022
ITSTCAM  EQU   *                                                        29055020
         CLI   LCBTPCD+11,X'AB'         FIRST TIME                      29060020
         BNE   NOTFIRST                 BRANCH NO                       29065020
         MVI   LCBTPCD+11,0             RESET FIRST TIME SWITCH         29070020
         LA    RCCW,LCBCPA              START OF CHANNEL PROG  @OZ28818 29075082
         ST    RCCW,LCBSTART-1          SAVE FOR SIO           @OZ28818 29076082
         LA    RTPCDE,LCBTPCD           TP OP CODE             @OZ28818 29077082
         BALR  RLNK1,REXPND             LINK TO EXPAND ROUTINE @OZ28818 29078082
         DC    AL2(MODCCW75-MODCCW)                            @OZ28818 29079082
NOTFIRST EQU   *                                                        29085020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  29090020
         DC    AL2(MODCCW20-MODCCW)                                     29095020
         SPACE                                                          29100020
TRY2     EQU   *                                                    TSO 29150020
.L21     ANOP                                                           29170020
         TM    LCBSTICS+2,CWTTA         WTTA                            29200020
         BZ    NOTWTTA                  NO                              29250020
         BALR  RLNK1,REXPND             LINK TO EXPND                   29300020
         DC    AL2(MODCCW21-MODCCW)                                     29350020
NOTWTTA  EQU   *                                                        29400020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               29500020
         DC    AL2(MODCCW20-MODCCW)                                     29550020
.L22     ANOP                                                           29600020
         SPACE 2                                                        29650020
* T R A N S    O R    S T A T I O N    C T R L                          29700020
         SPACE 1                                                        29750020
TRSTCTL  EQU   *                        STNCTL+DIAL LINE WITH ENAB      29800020
*                                         AND DIAL REQUESTS             29850020
         AIF   ('&GEN' EQ 'MINI').L22A                                  29850620
         AIF   ('&GEN' EQ 'QTAM').L22A                                  29851620
         AIF   ('&GEN' EQ 'BISC').L22A                                  29851822
CHK50HBN TM    LCBTSOB,LCBINHBN         ARE INHIBITS BEING USED     TSO 29893022
         BZ    STCTLC                   BRANCH ON NO                TSO 29893122
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 29893220
         DC    AL2(MODCCW91-MODCCW)                                 TSO 29893620
STCTLC   EQU   *                                                    TSO 29894020
.L22A    ANOP                                                           29897020
         AIF   ('&GEN' EQ 'MINI').L433                         @YA03846 29897556
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 29898122
         NI    LCBXFLAG,LCBGPSTP        RESET GENERAL POLL INDIC S99228 29898722
.L433    ANOP                                                    S99228 29899722
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               29900020
         DC    AL2(MODCCW28-MODCCW)                                     29950020
         SPACE                                                          30000020
         AIF   ('&GEN' EQ 'MINI').LE                                    30050020
         AIF   ('&GEN' EQ 'BISC').LE                                    30100020
         AIF   ('&GEN' EQ 'QTAM').LE                                    30120020
SPEC41   EQU   *                                                    TSO 30150020
         MVC   LCBSTICS,D41STICS        RESET CH'STICS              TSO 30200020
         MVI   LCBTPCD+10,X'AE'         SPECIAL CHECK INDICATOR     TSO 30250020
         BALR  RLNK1,REXPND             BUILD CCW'S                 TSO 30300020
         DC    AL2(MODCCW70-MODCCW)                                 TSO 30350020
.LE      ANOP                                                           30400020
         EJECT                                                          30450020
*                                                                       30500020
*                                                                       30550020
*        R E A D  C O N T I N U E   L O G I C                           30600020
*                                                                       30650020
*                                                                       30700020
         SPACE 3                                                        30750020
CONTINUE EQU   *                                                        30800020
         XI    LCBSTAT1,LCBCONT         RESET CONTINUE INDICATOR        30850020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET RESPONSE BIT              30900020
         L     RWKA,LCBCPA+12           OCNINUTE CCW                    30950020
         MVC   0(8,RWKA),LCBCPA+16      REBUILD BUFFER CCW              31000020
         NI    CCWFLAGS-CCW(RWKA),AVTEFF-CCWSLI SWITCH FOR LINE END     31010020
*                                       UNIT HAS WRAPPED VIA PCI        31020020
         LA    RCCW,LCBCPA+16           CONTINUE POINT                  31050020
         LA    RTPCDE,LCBTPCD+2         TP OP CODE BASE                 31100020
         NI    LCBMSGFM,LCBNAK+LCBACKI+LCBEOT+LCBOLT RESET FLAGS S22025 31150022
         TM    LCBCHAIN,LCBABRTN        ABORT REQUEST                   31200020
         BZ    NOABORT                  NO                              31250020
         AIF   ('&GEN' EQ 'BISC').L80                                   31257020
         L     RWKA,DCBSCTAD-1          GET SCT ADDRESS                 31264020
         CLI   AVTEZERO(RWKA),AVTEZERO  EOT SEQUENCE DEFINED            31271020
         BE    ABRTEXIT                 BRANCH IF NO                    31278020
         SPACE                                                          31285020
.L80     ANOP                                                           31292020
         L     RWKA,LCBSCBA-1           CURRENT SCB                     31292205
         USING IEDQSCB,RWKA             SCB REGISTER            SA59034 31292451
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT FLAG          SA59034 31292605
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').L80A          S22025 31293022
         TM    LCBMSGFM,LCBEOT .        RVI REQUEST              S22025 31294022
         BO    NOABORT                  BRANCH YES               S22025 31295022
.L80A    ANOP                                                    S22025 31296022
         BALR  RLNK1,REXPND             BUILD SEQUENCE                  31300020
         DC    AL2(MODCCW72-MODCCW)                                     31350020
         BR    R2                       RETURN                          31400020
         SPACE                                                          31450020
NOABORT  EQU   *                                                        31500020
         TM    LCBSTATE,LCBRECVN        READ CONTINUE                   31550020
         BZ    SEND                     NO WRITE CONTINUE               31600020
         SPACE                                                          31650020
         AIF   ('&GEN' NE '').L23                                       31700020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        31750020
         BZ    NOBSC1                   NO                              31800020
.L23     ANOP                                                           31850020
         AIF   ('&GEN' EQ 'MINI').L24                                   31900020
         AIF   ('&GEN' EQ 'STSP').L24                                   31950020
         AIF   ('&GEN' EQ 'QTAM').L24                                   31970020
         SPACE                                                          32000020
         L     RWKA,LCBSCBA-1           CURRENT SCB                     32050020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED YETS21101 32150020
         BZ    NOBSC1                   BRANCH NO DONT KNOW FORMAT      32200020
         L     RWKB,DCBDEBAD            DEB ADDRESS              X02004 32250005
         L     RWKB,DEBAPPAD-DEBNMSUB(,RWKB) VECTOR TABLE        X02004 32253005
         L     RWKC,TRMDESTQ-1  .       PICKUP DEST QCB          S22029 32256022
         DROP  RWKC                                              S99228 32262022
         USING IEDQQCB,RWKC                                      S22029 32268022
         TM    QCBDSFLG,QCBALTMH        IS TERMINAL CONNECTED TO S22029 32274022
*                                       AN ALTERNATE MH          S22029 32277022
         BZ    NOALTMH                  NO - USE OWNING MH LC    S22029 32280022
         LA    RWKB,ONE(,RWKB)          USE ALTERNATE MH         X02004 32283005
         DROP  RWKC                                                     32286022
NOALTMH  EQU   *                        TEST FOR LC=IN OR OUT    S22029 32289022
         USING IEDQLCBX,RWKC            LCB EXTENSION ADDR       S99228 32292022
         TM    0(RWKB),LCIN             IS LC=IN SPECIFIED       X02004 32300005
         BZ    ITSLCOUT                 NO                              32350020
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING TRANSPARNET   S21101 32400020
         BZ    NOBSC1                   NO, IT'S LCIN                   32450020
         DROP  RWKA                                                     32500020
         SPACE                                                          32550020
ITSLCOUT EQU   *                                                        32600020
         BALR  RLNK1,REXPND             GO TO EXPAND                    32650020
         DC    AL2(MODCCW45-MODCCW)                                     32700020
.L24     ANOP                                                           32750020
NOBSC1   EQU   *                                                        32800020
         AIF   ('&GEN' EQ 'BISC').Z6                                    32820020
         TM    LCBSTICS+2,CCHECK        CHECKING                        32850020
         BNZ   TESTCONT                 YES                             32900020
ABRTEXIT EQU   *                                                        32920020
         OI    LCBCSW+3,UNEX            INDICATE NO RESTART             32950020
         BR    R2                       RETURN                          33000020
TESTCONT EQU   *                                                        33050020
         TM    LCBSTICS+2,CCONTIN       CONINUTE POSSIBLE               33100020
         BZ    NOCONT                   NO                              33150020
.Z6      ANOP                                                           33170020
         BALR  RLNK1,REXPND                                             33200020
         DC    AL2(MODCCW46-MODCCW)                                     33250020
         SPACE                                                          33300020
NOCONT   EQU   *                                                        33350020
         BALR  RLNK1,REXPND             BUILD SEQUENCE                  33400020
         DC    AL2(MODCCW56-MODCCW)     OFFSET TO SEQUENCE              33450020
         BR    R2                       REUTRN                          33500020
SEND     EQU   *                                                        33550020
         AIF   ('&GEN' NE '').L25                                       33600020
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      33650020
         BZ    NBS                      NO                              33700020
.L25     ANOP                                                           33750020
         AIF   ('&GEN' EQ 'STSP').L26                                   33800020
         AIF   ('&GEN' EQ 'MINI').L26                                   33850020
         AIF   ('&GEN' EQ 'QTAM').L26                                   33870020
         BALR  RLNK1,REXPND                                             33900020
         DC    AL2(MODCCW48-MODCCW)                                     33950020
         BR    R2                       RETURN                          34000020
.L26     ANOP                                                           34050020
         AIF   ('&GEN' EQ 'BISC').L27                                   34100020
NBS      EQU   *                                                        34150020
         SPACE 1                                                SA62991 34160051
         BALR  RLNK1,REXPND             BUILD CCW                       34200020
         DC    AL2(MODCCW50-MODCCW)                                     34250020
.L27     ANOP                                                           34300020
         EJECT                                                          34350020
WRRESP   EQU   *                                                        34400020
         TM    LCBSTICS+2,CCHECK        CPABLE OF RESPONSE              34450020
         BZ    EXRESP1                  NO                              34500020
         SPACE                                                          34550020
         LA    RCCW,LCBERCCW+8          RESET CCW BASE                  34600020
         ST    RCCW,LCBSTART-1          START ADDRESS                   34650020
         LA    RTPCDE,LCBTPCD+2         SET TP OP CODE BASE     SA60341 34700022
.L28     ANOP                                                           34750020
         AIF   ('&GEN' EQ 'STSP').L29                                   34800020
         AIF   ('&GEN' EQ 'MINI').L29                                   34850020
         AIF   ('&GEN' EQ 'QTAM').L29                                   34920020
         TM    LCBSTAT2,LCBSYNC         BSC                             34950020
         BNO   TESTNAK                  BR NO                   SA60341 35000022
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION    SA60341 35006022
         TM    LCBXFLAG,LCBGPCTV        GENR'L POLL IN PROGRESS SA60341 35012022
         BO    WRACK                    BR YES                  SA60341 35018022
         TM    LCBSTICS+1,CCONTENT      CONTENTION DEVICE      @SA72446 35018658
         BNO   RESET                    NO, DO WRITE RESET     @SA72446 35019258
         TM    LCBSTAT1,LCBSENDN        SEND OPERATION         @SA72446 35019858
         BO    RESET                    YES, DO WRITE RESET    @SA72446 35020458
         LA    RCCW,LCBCPA+32           GET ADDR OF WRITE ACK  @SA72446 35021058
         ST    RCCW,LCBSTART-1          CCW TO START ON        @SA72446 35021658
         LA    RCCW,LCBCPA+16           RESET CCW BASE         @SA72446 35022258
         B     KEEPSET                  AND RETURN             @OX12562 35022800
RESET    EQU   *                                               @SA72446 35023458
         BALR  RLNK1,REXPND             GO WRITE RESET          SA60341 35024022
         DC    AL2(MODCCW72-MODCCW)     RESET MODEL CCW         SA60341 35030022
         B     EXRESP                   EXIT                    SA60341 35036022
TESTNAK  EQU   *                                                SA60341 35042022
.L29     ANOP                                                           35050020
         SPACE                                                          35100020
         TM    LCBMSGFM,LCBNAK .        REQUEST FOR NAK RESPONSE S21101 35150020
         BNZ   WRACK                    BR YES                 @SA69649 35200056
         AIF   ('&GEN' EQ 'MINI').L443                         @YA03846 35653056
         TM    LCBSTICS,CUMASK          2260 UNDER GENPOLL?      S99228 35657022
         BZ    REGRESP                  NO SEND NORMAL RESP      S99228 35664022
.L443    ANOP                                                  @SA69649 35666056
WRACK    EQU   *                                               @SA69649 35668056
         BALR  RLNK1,REXPND             LINK TO EXPAND RTN       S99228 35671022
         DC    AL2(MODCCW60-MODCCW)     EXPANDER OFFSET          S99228 35678022
         B     EXRESP                   SKIP SPECIFIC POLL CODE  S99228 35685022
REGRESP  EQU   *                                                 S99228 35692022
         TM    LCBSTICS+2,CCONTIN       1030 OR 1060 TERMINAL?  SA55925 35696522
         BZ      WRACK                  YES-BRANCH TO WRITE     SA55925 35697022
*                                        CIRCLE Y NOT CIRCLE A  SA55925 35697522
         AIF   ('&GEN' EQ 'BISC').L4R1                                  35698022
         BALR  RLNK1,REXPND             LINK TO EXPAND                  35700020
         DC    AL2(MODCCW58-MODCCW)                                     35750020
.L4R1    ANOP                                                           35800022
EXRESP   EQU   *                                                        35850020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          35900020
         BZ    EXRESP1                  NO                              35950020
         LA    RCCW,LCBCPA              SET TO CAHNGE TIC               36000020
         OI    LCBERCCW+12,CCWCD        CHANGE FLAGS                    36050020
         ST    RCCW,LCBERCCW+16         SET IN CCW                      36100020
         MVI   LCBERCCW+16,CCWTIC       SET COMMAND CODE                36150020
         BR    R2                       RETURN DO EXCP                  36200020
EXRESP1  EQU   *                                                        36250020
         LA    RCCW,LCBCPA+16           ESET CCW BASE                   36300020
         AIF   ('&GEN' EQ 'MINI').L453                         @YA03846 36307056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 36311022
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 36315022
         BZ    INAMESS                  NO, NO SET SPEC WRITE RE S99228 36321022
         OI    LCBERCCW+12,CCWCC+CCWSLI SET FLAGS FOR NO INTRPT  S99228 36328022
         LA    RCCW,LCBCPA+32           LOAD ADDR READ RESP IN T S99228 36335022
INAMESS  EQU   *                                                 S99228 36342022
.L453    ANOP                                                    S99228 36346022
         ST    RCCW,LCBERCCW+16         SET TIC ADDRESS                 36350020
         MVI   LCBERCCW+16,CCWTIC       SET COMMAND CODE                36400020
RESPEXIT EQU   *                                               @SA72446 36420058
         LA    RTPCDE,LCBTPCD+2         RESET TP OP CODE BASE           36450020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET                           36500020
         LR    RWKB,R0                  RETURN ADDRESS                  36550020
         BR    RWKB                     RETURN                          36600020
         EJECT                                                          36650020
*        ***************************************************            36700020
*        *                                                 *            36750020
*        *     W R I T E    I N I T I A L    L O G I C     *            36800020
*        *                                                 *            36850020
*        ***************************************************            36900020
         SPACE 3                                                        36950020
MSGGEN   EQU   *                                                        37000020
         LA    RCCW,LCBCPA+16           ADDJUST TO BYPASS MSGEN CCW     37050020
         LA    RTPCDE,LCBTPCD+2         ADJUST TP OP CODE BASE          37100020
         L     RWKA,LCBSCBA-1           GET SCB BASE            SA59034 37110005
         NI    SCBBSCFM-IEDQSCB(RWKA),AVTEFF-SCBNOEOT RESET EOT SA59034 37120005
*                                         FLAG TO FORCE ENQ     SA59034 37130005
         B     DIALTEST                 CONTINUE BUILDING               37150020
WRITINIT EQU   *                                                        37200020
         L     RLNK1,AVTRDYA            USER EXIT ROUTINE LIST  X30X5MT 37201058
         ICM   RLNK1,SEVEN,PURGEXT(RLNK1)  LOAD EXIT ROUTINE ADDX30X5MT 37202058
         BZ    NOEXIT                   NO, PROCESS NORMAL      X30X5MT 37203058
         LR    RPARM,RTERM              LOAD TERM TABLE ADDRESS X30X5MT 37204058
         STM   RLCB,RBASE,AVTSAVE3+REGSAVE   SAVE REGS          X30X5MT 37205058
         BALR  REXPND,RLNK1             BRANCH TO EXIT ROUTINE  X30X5MT 37206058
         LM    RLCB,RBASE,AVTSAVE3+REGSAVE  RESTORE REGS        X30X5MT 37207058
         LTR   RLNK1,RLNK1              WAS RETURN CODE ZERO    X30X5MT 37208058
         BZ    DONTPOST                 YES, PROCESS NORMAL     X30X5MT 37209058
         C     RLNK1,RETURN4            RETURN CODE OF 4        X30X5MT 37210058
         BNE   DONTPOST                 NO, CONTINUE NORMALLY   X30X5MT 37211058
SIMERROR EQU   *                                               @OS77867 37211500
         MVC   LCBTTCIN(2),LCBTTBIN    TERM TO BE CONNECTED     X30X5MT 37212058
         L     RWKB,LCBSCBA-1           LOAD ADDR OF SCB        X30X5MT 37213058
         USING IEDQSCB,RWKB                                     X30X5MT 37214058
         OI    SCBERR4,SCBSLCTN+SCBTRMLN  SET ON SEL ERR        X30X5MT 37215058
         DROP  RWKB                                            @OY12260 37215558
         L     RTERM,LCBERBST            ADDR OF HDR BUFFER     X30X5MT 37216058
         L     RPARM,PRFLINK-1-IEDQPRF(RTERM) GET TXT BUFFER ADDX30X5MT 37217058
LOOPTRAN LA    RPARM,0(RPARM)            CLEAR HI BYTE          X30X5MT 37218058
         LTR   RPARM,RPARM               SEE IF ANY TEXT BUFFERSX30X5MT 37219058
         BZ    TRANENDC                  BRANCH IF NOT TO FREE  X30X5MT 37220058
*                                        HEADER AS PSEUDO ZERO LX30X5MT 37221058
         LA    RWKC,AVTBFRTB             AVAIL. BFR. QCB FOR POSX30X5MT 37222058
         ST    RWKC,0(RPARM)             STORE QCB ADDRESS      X30X5MT 37223058
         MVI   PRFPRI-IEDQPRF(RPARM),PRIBFRTB  POST PRIORTY     X30X5MT 37224058
         L     RTERM,PRFLINK-1-IEDQPRF(RPARM)  SAVE NEXT TXT BUFX30X5MT 37225058
         BAL   REXPND,DSPPOSTR           FREE TEXT BUFFERS      X30X5MT 37226058
         LR    RPARM,RTERM               SET FOR NEXT TXT IF ANYX30X5MT 37227058
         B     LOOPTRAN                  GO FREE IF PRESENT     X30X5MT 37228058
TRANENDC EQU   *                                                X30X5MT 37229058
         L     RPARM,LCBERBST          ADDRESS OF BUFFER        X30X5MT 37230058
         STCM  RPARM,SEVEN,LCBLSPCI    SET LAST BUFFER SERVICED X30X5MT 37231058
         SR    RWKB,RWKB               CLEAR REGISTER           X30X5MT 37232058
         STCM  RWKB,SEVEN,LCBERBCH     SET ZERO ADDRESS         X30X5MT 37233058
         STH   RWKB,PRFSIZE-IEDQPRF(RPARM)  STORE ZERO LENGTH   X30X5MT 37234058
         NI    PRFSTAT1-IEDQPRF(RPARM),PRFNLSTF MARK IT LAST    X30X5MT 37235058
         MVI   PRFPRI-IEDQPRF(RPARM),PRIMHBFR  P3ST PRIORITY    X30X5MT 37236058
         L     RWKB,DCBMH-1            GET MH QCB ADDR FOR POST X30X5MT 37237058
         STCM  RWKB,7,PRFQCBA-IEDQPRF(RPARM)  SET POST ADDR    @G36XRYP 37238000
         BAL   REXPND,DSPPOST          POST BUFFER TO MH       @Y17XAIX 37239000
DONTPOST EQU   *                                                X30X5MT 37240058
         LA    REXPND,EXPAND           SET UP LINK FOR EXPAND   X30X5MT 37241058
NOEXIT   EQU   *                                                X30X5MT 37242058
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OS77867 37242600
         BZ    NODIAL                   BRANCH-NO              @OS77867 37243200
         CLI   LCBTSTSW,AVTEFF          REQUEST FOR DIALUP     @OS77867 37243800
         BNE   NODIAL                   BRANCH-NO              @OS77867 37244400
         L     RWKA,TRMDESTQ-1          GET QCB ADDRESS        @OS77867 37245000
         CLI   QCBSTPRI-IEDQQCB(RWKA),CALLOPT CLOCK OR CINTVL  @OS77867 37245600
         BL    NODIAL                   BRANCH-NO              @OS77867 37246200
         L     RWKA,DCBDEBAD            GET DEB ADDRESS        @OX16705 37246300
         USING DEBTCBAD,RWKA            ADDRESSABILTIY         @OX16705 37246400
         TM    DEBOPATB,OUTONLY         OUTPUT ONLY DEVICE?    @OX16705 37246500
         BO    NODIAL                   BRANCH IF YES-DIAL     @OX16705 37246600
         L     RWKA,LCBSCBA-1           GET SCB ADDRESS        @OS77867 37246800
         OI    SCBERR4-IEDQSCB(RWKA),SCBCONNN SET DIAL ERROR   @OS77867 37247400
         B     SIMERROR                 GO SIMULATE OUTPUT ERR @OS77867 37248000
NODIAL   EQU   *                                               @OS77867 37248600
         LA    RCCW,LCBCPA              SET CCW BASE                    37250020
         LA    RTPCDE,LCBTPCD           TP OP CODE AREA                 37300020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            37350020
         DC    AL2(MODCCW30-MODCCW)                                     37400020
*              TIC (WRITE IDLES)                                        37450020
         LA    RWKA,LCBCPA              DATA DDRESS FOR TIC             37500020
         ST    RWKA,LCBCPA+8            SAVE IN TIC COMMAND             37550020
         MVI   LCBCPA+8,CCWTIC          TIC OP CODE                     37600020
         LA    RTPCDE,ONE(R0,RTPCDE)    BUMP TP REGISTER                37650020
         LA    RCCW,EIGHT(R0,RCCW)      BUMP CCW BASE                   37700020
         MVI   LCBCPA+12,FLAG           FLAG INDICATES WHICH WRITE      37750020
*                                       IDLES TO USE AFTER CONTACT      37800020
DIALTEST EQU   *                                                        37850020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').Z66A          S21101 37860020
*                                                                S21101 37870020
*        SCBNOEOT IS SET FOR BSC DIAL LINE WITH SEND PRIORITY BY S21101 37880020
* LINE END APPENDAGE ON OUTPUT AND BY SEND SCHEDULER WHEN BYPASSIS21101 37890020
* CONTROL TO RECEIVE SCHEDULER (ALTERNATE SEND AND RECEIVE ON BSCS21101 37892020
* DIAL LINE.  WHENEVER AN EOT IS TRANSMITTED ON A BSC LDIAL LINE S21101 37894020
* LINE MUST BE MONITORED FOR A RECEVE OPERATION.  FOR SEND PRIORIS21101 37896020
* AN EOT IS NOT SENT AT THE END OF A MESSAGE IN ORDER TO FLUSH THS21101 37898020
* OUTPUT QUEUE.  THE TERMINAL IS STILL IN TEXT MODE AND THE ACK  S21101 37898420
* COUNTER MUST NOT BE RESET.   THIS HAS A BEARING ON THE WRITE   S21101 37898820
* INITIAL CONTACT  CHANNEL PROGRAM.  THERE IS NO LINE BID        S21101 37899220
* REQUIRED.  THE CHANNEL PROGRAM WILL START ON THE WRITE ESCAPE  S21101 37899620
* SEQUENCE OR ON THEWRITE IDLES LOOP.  SCBNOEOT IS RESET IN THIS S21101 37899720
* MODULE ON A DISABLE OR BY ERP OR LINE END .  ERP OR LINE END WIS21101 37899820
* RESET THE BIT ON A TCAM OR DEVICE ABORT (I. E. AN EOT WAS SENT S21101 37899920
* OR RECEVIED.)                                                  S21101 37916620
*                                                                S21101 37926620
         NI    LCBMSGFM,LCBACKI .       RESET FORMAT BITS EXCEPT S21101 37928620
*                                         ACK COUNTER            S21101 37930620
         L     RWKA,LCBSCBA-1 .         GET SCB BASE             S21101 37932620
         USING IEDQSCB,RWKA .                                    S21101 37933020
         TM    SCBBSCFM,SCBNOEOT .      BSC DIAL SEND PRIORITY INS21101 37933120
*                                         TEXT MODE              S21101 37933220
         DROP  RWKA .                                            S21101 37938820
         BO    LETACK .                 BRANCH IF YES            S21101 37940820
         MVI   LCBMSGFM,AVTEZERO .      RESET FORMAT BITS AND ACKS21101 37942820
*                                         COUNTER                S21101 37943220
LETACK   EQU   *                                                 S21101 37943620
.Z66A    ANOP                                                    S21101 37943858
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                 @OY12395 37944058
         BO    NOTMSG1                  YES,BRANCH             @OY12395 37945058
         NI    LCBSTAT2,AVTEFF-LCBNEGRP POLL TERM ONE MORE TIME@OY12395 37946058
NOTMSG1  EQU   *                                               @OY12395 37947058
         TM    LCBSTAT2,LCBRESP         OWE A RESPONSE                  37948058
         BZ    NORP                     NO                              37950020
         SPACE                                                          38000020
         AIF   ('&GEN' EQ 'MINI').Z15XX                                 38048020
         AIF   ('&GEN' EQ 'QTAM').Z15XX                                 38048420
         AIF   ('&GEN' EQ 'BISC').Z15XX                                 38048820
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 38049220
         BO    SNDRSP                   BRANCH ON YES               TSO 38049620
.Z15XX   ANOP                                                           38049720
         CLC   LCBTTBIN,LCBTTCIN        SAME TERMINAL                   38050020
         BE    OWERSP                   YES                             38100020
         SPACE                                                          38150020
SNDRSP   EQU   *                                                        38160020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          38200020
         BNZ   OWERSP                   YES                             38250020
SNDRSP1  EQU   *                                                SA55925 38270022
         BAL   R0,WRRESP                BUILD RESPO55SE                 38300020
         MVI   LCBERCCW+12,FLAG         ONLY SLI FLAG            X02004 38310005
         B     NORP                     RESUME CHANNEL PROG BUILD       38350020
         SPACE                                                          38400020
OWERSP   EQU   *                                                        38500020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').L32         @OY14092 38550000
         OI    LCBMSGFM,LCBACKI .       FIRST CONVERSATIONAL REPLS21101 38560020
*                                         IS ODD ACK             S21101 38570020
         TM    LCBSTAT2,LCBSYNC         BSC                             38600020
         BNZ   STIDLES                  BRANCH YES                      38650020
.L32     ANOP                                                           38700020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE             38710020
         BO    TSMSGN                   BRANCH ON YES                   38720020
         TM    LCBSTICS+2,C2760         2760                            38750020
         BO    STIDLES                  YES, START ON DILESOR MSGGEN    38800020
         SPACE                                                          38850020
         TM    LCBSTICS+2,CCONTIN       CAPABLE OF RESPONS              39000020
         BZ    SNDRSP1                  BRANCH IF NOT           SA55925 39050022
         BALR  RLNK1,REXPND             WR EOA AND TIC                  39100020
         DC    AL2(MODCCW62-MODCCW)                                     39150020
         SPACE                                                          39250020
.Z15     ANOP                                                           39270020
         AIF   ('&GEN' EQ 'MINI').L35                                   39300020
NORP     EQU   *                                                        39350020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       39450020
         BZ    WRLSD                    NO, LEASED LINE                 39500020
         SPACE 3                                                        39550020
********       D I A L    L I N E S      ********                       39600020
         SPACE 2                                                        39650020
         CLI   LCBTSTSW,AVTEFF          THIS A DIAL UP REQUEST          39700020
         MVI   LCBTSTSW,F0              RESET FOR SUBSEQUENT SNED       39750020
         AIF   ('&GEN' NE 'BISC').LI2A                                  39800020
         BNE   WRLSD                                                    39850020
         AGO   .LI1                                                     39900020
.LI2A    ANOP                                                           39950020
         BNE   NODIALUP                 NO                              40000020
         AIF   ('&GEN' EQ 'BISC').LI1                                   40050020
         AIF   ('&GEN' NE '').LI2                                       40100020
         TM    LCBSTAT2,LCBSYNC        BSC LINE                         40150020
         BZ    NOSYNC                  NO                               40200020
.LI1     ANOP                                                           40250020
         L     RWKA,LCBSCBA-1 .         GET SCB POINTER          S21101 40260020
         USING IEDQSCB,RWKA .                                    S21101 40270020
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT FLAG           S21101 40280020
         DROP  RWKA .                                            S21101 40290020
         MVI   LCBMSGFM,AVTEZERO .      RESET ALL BITS           S21101 40290520
         TM    LCBTPCD+11,DISDLEOT .    WRITE DLE EOT            S21101 40291020
         BO    GODLEEOT .               YES                      S21101 40291520
         OI    LCBTPCD+11,DISDLEOT      SET FOR THE NEXT TIME   SA53632 40291622
*                                         SO AS TO WRITE ABORT  SA53632 40291722
*                                         SEQUENCE BEFORE DISAB SA53632 40291822
         LA    RTPCDE,ONE(,RTPCDE) .    ADJUST TP CODE BASE      S21101 40292020
         LA    RCCW,EIGHT(,RCCW) .      ADJUST CCW BASE          S21101 40292520
         ST    RCCW,LCBSTART-1 .        SET START ADDRESS        S21101 40293020
         B     NOSYNC .                 CONTINUE                 S21101 40293520
GODLEEOT EQU   * .                                               S21101 40294020
         BALR  RLNK1,REXPND            LINK TO EXPAND                   40300020
         DC    AL2(MODCCW01-MODCCW)                                     40350020
         B     NEXTCCW                                                  40450020
NOSYNC   EQU   *                                                        40500020
.LI2     ANOP                                                           40550020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            40600020
         DC    AL2(MODCCW02-MODCCW)                                     40650020
NEXTCCW  EQU   *                                                        40700020
         AIF   ('&GEN' EQ 'BISC').L36                                   40750020
         TM    LCBSTICS+1,CTWX          TWX                             40800020
         BZ    NOTTWX                                                   40850020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            40900020
         DC    AL2(MODCCW32-MODCCW)                                     40950020
         BR    R2                       RETURN                          41000020
NOTTWX   EQU   *                                                        41050020
         AIF   ('&GEN' EQ 'STSP').L37                                   41100020
         AIF   ('&GEN' EQ 'QTAM').L37                                   41120020
         TM    LCBSTICS+1,CBISYNC                                       41150020
         BZ    STSTOP                                                   41200020
.L36     ANOP                                                           41250020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               41300020
         CLI   IDLOC+1(RWKC),AVTEZERO   ANY ID'S FOR CPU                41350020
         BE    NOID                     BRANCHNO                        41400020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  41450020
         DC    AL2(MODCCW14-MODCCW)                                     41500020
         B     ENDTEST                  CONTINUE IN LINE TESTING        41550020
NOID     EQU   *                                                        41600020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  41650020
         DC    AL2(MODCCW15-MODCCW)                                     41700020
ENDTEST  EQU   *                                                        41750020
         TM    LCBSTICS+2,CENDCTL       END/END CONTROL                 41800020
         BNZ   ENDCTL                   BRANCH IF END-END CTL           41850020
         SH    RCCW,H8                  BAK UP TO PREVIOUX              41900020
         OI    CCWFLAGS,CCWSLI          SET FLAG FOR APPENDAGE          41950020
         BR    R2                       RETURN                          42000020
ENDCTL   EQU   *                                                        42050020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  42100020
         DC    AL2(MODCCW41-MODCCW)                                     42150020
         BR    R2                       RETURN                          42200020
.L37     ANOP                                                           42450020
         AIF   ('&GEN' EQ 'BISC').L35                                   42500020
STSTOP   EQU   *                                                        42550020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            42600020
         DC    AL2(MODCCW36-MODCCW)                                     42650020
         TM    LCBSTICS+1,CSTNCTL       STATION CONTROL                 42700020
         BO    WRMLPT                   BRANCH YES                      42750020
NODIALUP EQU   *                                                        42800020
         TM    LCBSTICS+1,CTWX          TWX                             42850020
         BZ    WRLSD                    NO                              42900020
         NI    LCBSTICS+1,AVTEFF-CTWX   TURNOFF TWX BIT                 42950020
*                                         BUFFERS WILL BE POSTED        43000020
*                                         TO MH BY ACTIVATE             43050020
.L35     ANOP                                                           43100020
.M6      ANOP                                                           43250020
STIDLES  EQU   *                                                        43300020
         LA    RWKA,LCBCPA              WRITE IDLES ADDRESS             43350020
         ST    RWKA,LCBSTART-1          SET IOS PARAMETER               43400020
         BR    R2                       RETURN                          43450020
         SPACE 3                                                        43500020
*********      L E A S E D    L I N E S        *********                43550020
         SPACE 2                                                        43600020
         AIF   ('&GEN' NE 'MINI').N1                                    43650020
NORP     EQU   *                                                        43700020
         NI    LCBSTAT2,AVTEFF-LCBRESP                                  43750020
.N1      ANOP                                                           43800020
WRLSD    EQU   *                                                        43850020
         TM    LCBSTICS+1,CLOCAL+CAUDIO LOCAL OR AUDIO                  43900020
         BZ    NOAUD                    NO                              43950020
         MVC   LCBTTCIN,LCBTTBIN        SET CONNECTION DESIRED          44000020
TSMSGN   EQU   *                                                        44020020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          44050020
         BZ    NOTMSGN                  NO                              44100020
         LA    RCCW,LCBCPA              START POINT                     44150020
         ST    RCCW,LCBSTART-1          START OF CHAN PROG              44200020
         AIF   ('&GEN' EQ 'BISC').TS11                         @YA03846 44200156
         AIF   ('&GEN' EQ 'MINI').TS11                           A48276 44200221
         TM    LCBSTICS+2,CNOIDLES      IS IT 2260R              A48276 44200321
         BO    TSRESP                   IF SO, BUILD ACK RESP    A48276 44200421
.TS11    ANOP                                                    A48276 44200521
         BR    R2                       RETURN                          44250020
NOTMSGN  EQU   *                                                        44300020
*        SIMULATE 'ADDRESSING' SEQUENCE FOR 2260 LOCAL FOR SCREEN       44310020
* TO MODIFY  WRITE COMMAND.                                             44320020
         AIF   ('&GEN' EQ 'MINI').L4R6                         @YA03846 44320556
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 44321022
         BZ    NOL3270                  BRANCH NO                S99228 44321522
         TM    LCBSTICS+ONE,CLOCAL      LOCAL DEVICE?            S99228 44322022
         BZ    NOL3270                  BRANCH NO                S99228 44322522
         OI    LCBCHAIN,LCBEXCP         EXCP AT ASSOCIATION      S99228 44323022
         LA    RCCW,LCBCPA+16           SET CCW ADDR             S99228 44324022
         BALR  RLNK1,REXPND             LINK TO EXPAND           S99228 44325022
         DC    AL2(MODCCW74-MODCCW)     3270 LOCAL WRITE CH PGM  S99228 44326022
         BR    R2                       RETURN TO ACTIVATE       S99228 44327022
NOL3270  EQU   *                                                 S99228 44328022
.L4R6    ANOP                                                           44329022
         BALR  RLNK1,REXPND             LINK TO EXPAND                  44330020
         DC    AL2(MODCCW29-MODCCW)                                     44340020
         OI    LCBCHAIN,LCBEXCP         DO EXCP AT ASSOCIAION           44350020
         BR    R2 .                     RETURN TO ACTIVATE       A41027 44400020
NOAUD    EQU   *                                                        44450020
         TM    LCBSTICS+1,CCONTENT+CXMITCTL CONTENTION OR XMITCTL       44500020
         BZ    WRMLPT                                                   44550020
         SPACE 2                                                        44600020
* C O N T E N T I O N    L I N E                                        44650020
         SPACE 1                                                        44700020
         AIF   ('&GEN' NE '').L38                                       44800020
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      44850020
         BZ    NOBSCCT                                                  44900020
.L38     ANOP                                                           44950020
         AIF   ('&GEN' EQ 'STSP').L39                                   45000020
         AIF   ('&GEN' EQ 'MINI').L41                                   45050020
         AIF   ('&GEN' EQ 'QTAM').L39                                   45070020
         L     RWKA,LCBSCBA-1           GET SCB POINTER          S21101 45080020
         USING IEDQSCB,RWKA .                                    S21101 45090020
         TM    SCBBSCFM,SCBNOEOT .      DIAL WITH SEND PRIORITY  S21101 45092020
*                                         IN TEXT MODE           S21101 45094020
         DROP  RWKA .                                            S21101 45096020
         BZ    NOTEOT .                 BRANCH IF NO             S21101 45098020
         SPACE 1                                                 S21101 45098420
         TM    LCBSTICS+2,CENDCTL .     END TO END CONTROLS      S21101 45098820
         BO    ENDCTL .                 BRANCH IF YES TO BUILD   S21101 45099220
*                                         WRITE ESCAPE  AND READ S21101 45099620
         SPACE 1                                                 S21101 45099720
         OI    LCBSTAT2,LCBRESP .       SET FOR ACTIVATE TO POST S21101 45099820
*                                         BUFFERS.  THERE IS NO  S21101 45099920
*                                         SELECTION SEQUENCE.    S21101 45116620
         B     STIDLES .                START ON WRITE SYNS      S21101 45126620
         SPACE 2                                                 S21101 45128620
NOTEOT   EQU   *                                                 S21101 45130620
         TM    LCBSTICS+2,CENDCTL       END - END CONTROLS              45133320
         BZ    ITSCPU                   NO, MUST BE CPU                 45150020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            45200020
         DC    AL2(MODCCW40-MODCCW)                                     45250020
         BR    R2                       RETURN                          45300020
         SPACE                                                          45350020
ITSCPU   EQU   *                                                        45400020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  45450020
         DC    AL2(MODCCW43-MODCCW)                                     45500020
         BR    R2                       RETURN                          45550020
.L39     ANOP                                                           45600020
         AIF   ('&GEN' EQ 'BISC').L40                                   45650020
NOBSCCT  EQU   *                                                        45700020
         TM    LCBSTICS+2,CWTTA         WORLD TRADE                     45750020
         BZ    NOWTTA                   BR NO                           45800020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            45850020
         DC    AL2(MODCCW42-MODCCW)                                     45900020
NOWTTA   EQU   *                                                        45950020
         TM    LCBTSOB,LCB2741N         SEE IF 2741 TERM            TSO 46000020
         BZ    NOTS                     BRANCH NO                       46050020
         TM    LCBTSOB,LCBCIRCD         CIRCLE D SENT LAST          TSO 46100020
         BO    TSNOD                                                TSO 46150020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            46350020
         DC    AL2(MODCCW38-MODCCW)                                     46400020
         SPACE 2                                                        46450020
.L41     ANOP                                                           46460020
NOTS     EQU   *                                                        46470020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  46480020
         DC    AL2(MODCCW39-MODCCW)                                     46490020
         AIF   ('&GEN' EQ 'MINI').L40                                   46500020
TSNOD    EQU   *                                                    TSO 46550020
         LA    RWKA,LCBCPA              START I/O ON IDLES          TSO 46600020
         ST    RWKA,LCBSTART-1                                      TSO 46650020
         BR    R2                                                   TSO 46700020
         SPACE                                                          46750020
.L40     ANOP                                                           46800020
* M U L T I P O I N T    L I N E                                        46850020
         SPACE 1                                                        46900020
WRMLPT   EQU   *                        LEASED +DIAL-2740,1050          46950020
         AIF   ('&GEN' EQ 'MINI').L40A                           S22026 46955022
         AIF   ('&GEN' EQ 'STSP').L40A                           S22026 46960022
         AIF   ('&GEN' EQ 'QTAM').L40A                           S22026 46965022
         TM    LCBSTICS+1,CBRDCAST .   FAST SELECT ?             S22026 46970022
         BNO   NOFSTSEL .              BRANCH NO                 S22026 46975022
         BALR  RLNK1,REXPND .          GO TO EXPAND              S22026 46980022
         DC    AL2(MODCCWFS-MODCCW) .                            S22026 46985022
NOFSTSEL EQU   * .                                               S22026 46990022
.L40A    ANOP                                                    S22026 46995022
         TM    LCBSTICS+2,CNOIDLES      NO IDLES DEFINED                47000020
         BNZ   ITSTV                    BRANCH YES                      47050020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'STSP').L40B      SA69087 47056005
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').L40B      SA69087 47062005
         TM    LCBSTAT2,LCBSYNC         BSC ?                   SA69087 47068005
         BZ    NTSOBSC                  NO, NOT BI-SYNC         SA69087 47074005
         MVI   LCBTPCD+11,0             RESET WCC FLAG IF ON    SA69087 47080005
NTSOBSC  EQU   *                                                SA69087 47086005
.L40B    ANOP                                                   SA69087 47092005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            47100020
         DC    AL2(MODCCW44-MODCCW)                                     47150020
ITSTV    EQU   *                                                        47200020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  47250020
         DC    AL2(MODCCW51-MODCCW)                                     47300020
         OI    LCBCHAIN,LCBEXCP         EXCP TO BE DONE LATER           47350020
         AIF   ('&GEN' EQ 'BISC').TS12                         @YA03846 47352056
         AIF   ('&GEN' EQ 'MINI').TS12                           A48276 47354021
*  CAN GET HERE FOR MSGGEN RESP ON 2260R. MAKE SURE IS MSGGEN    A48276 47356021
* BECAUSE CAN GET HERE FOR ANY 2260R WRITE.                      A48276 47358021
         TM    LCBSTAT2,LCBMSGNN        IS IT A MSGGEN           A48276 47360021
         BCR   8,R2                     BR NO. DO NOT WANT RESP  A48276 47362021
*                                       TO NON-MSGGEN WRITES     A48276 47364021
TSRESP   EQU   *                                                 A48276 47366021
         LA    RCCW,LCBERCCW+12         RESPONSE AREA FOR 2260R  A48276 47368021
*                                       MSGGEN MESSAGES          A48276 47370021
         ST    RCCW,LCBCPA+48           READ AREA FOR RESPONSE   A48276 47372021
         MVI   LCBCPA+48,CCWREAD        READ COMMAND             A48276 47374021
         LA    RCCW,2                   READ COUNT               A48276 47376021
         ST    RCCW,LCBCPA+52           COUNT TO CCW             A48276 47378021
         MVI   LCBTPCD+6,TPRSPMG        RESP MSG INDEX           A48276 47380021
         LA    RCCW,LCBCPA+48           FOR TIC TO RESP          A48276 47382021
         ST    RCCW,LCBCPA+8            FOLLOW MSGGEN WRITE      A48276 47384021
         MVI   LCBCPA+8,CCWTIC          STORE TIC                A48276 47386021
         MVI   LCBCPA+4,CCWCC+CCWSLI    SLI AND CMD CHAIN      @SA76694 47388058
.TS12    ANOP                                                    A48276 47390021
         BR    R2                       RETURN                          47400020
H8       DC    H'8'                                                     47408058
LCBBKUP  DC    AL2(LCBERB-IEDQLCB)      OFFSET ERB FROM LCB             47416058
H72      DC    H'72' .                                              TSO 47424058
*  OPTLIST--OFFSET TO IEDQAE,LENGTH,OFFSET TO OPT FIELD,REG 15 INDIC    47432058
OPTLIST  DC    AL1(20),XL3'040010' .    PARM LIST FOR IEDQAE        TSO 47440058
         EJECT                                                          47450020
*                                                                       47500020
*        *****************************************                      47550020
*        *                                       *                      47600020
*        *     E X P A N D    R O U T I N E      *                      47650020
*        *****************************************                      47700020
         SPACE 1                                                        47750020
*        THIS ROUTINE EXPAND THE SUBSET OF CHANNEL PROGRAM PROVIDED     47800020
*              FIRST  - BUILD CCW IN CHANNEL PROGRAM AREA(LCBCPA).      47850020
*              SECOND - SET-UP TP CODE IN LCBTPCD.                      47900020
         SPACE 2                                                        47950020
         USING *,REXPND                                        @OS77867 47970000
EXPAND   DS    0H                                                       48000020
         LA    RMOD,MODCCW              LOAD MODEL CHAN PROG TABLE AD.  48050020
         DROP  REXPND                                          @OS77867 48070000
         AH    RMOD,0(RLNK1)            ADD OFFSET                      48100020
EXLOOP0  EQU   *                                                        48150020
         LA    REXPND,EXPAND            REATORE REXPND REGISTER         48200020
         CLI   0(RMOD),X'FF'            END OF SUBSET                   48250020
         BE    2(RLNK1)                 YES,RETURN                      48300020
         LA    REXPND,EXPRTN            SET-UP RETURN ADDRESS           48350020
         SR    RWKB,RWKB                CLEAR WORK REGISTER             48400020
         SR    RWKA,RWKA                CLEAR REGISTER                  48450020
         STM   RWKA,RWKB,CCW            CLEAR CCW                       48500020
         IC    RWKA,0(RMOD)             OFFSET IN EXPANDEER TABLE       48550020
         LH    RWKA,ORGTB1(RWKA)        GET OFFSET FOR EXPANDER ROUTINE 48600020
         B     ORGRTN(RWKA)             AND BRANCH                      48650020
*                                                                       48700020
* RETURN HER FROM EXPANDER ROUTINES                                     48750020
* RWKA CONTAINS THE CCW DATA ADDRESS                                    48800020
*                                                                       48850020
EXPRTN   EQU   *                                                        48900020
         ST    RWKA,CCWADDR-1           SET DATA ADDRES                 48950020
         SR    RWKB,RWKB                CLEAR REGISTER                  49000020
         IC    RWKB,0(RMOD)             OFFSET IN EXPANDER TABLE        49050020
         IC    RWKA,ORGTB1+2(RWKB)      PICK-UP OP CODE                 49100020
         STC   RWKA,CCWOPCDE            AND STORE IT                    49150020
EXPRTN0  EQU   *                                                SA57685 49170022
         MVC   CCWFLAGS(1),1(RMOD)      YES, SET PROVIDED FLAGS         49200020
*                                                                       49250020
* SET-UP TP CODE IN LCB(LCBTPCD)                                        49300020
*        FOR EACH CCW A TP CODE IS REQUIRED                             49350020
*                                                                       49400020
         IC    RWKB,ORGTB1+3(RWKB)      PICK-UP TP CODE                 49450020
         STC   RWKB,ZERO(R0,RTPCDE)     SET TP OP CODE                  49500020
         LA    RTPCDE,ONE(R0,RTPCDE)    BUMP TP OP CODE POINTER         49550020
         LA    RCCW,EIGHT(R0,RCCW)      BUMP CCW BASE                   49600020
*                                                                       49650020
* RETURN HERE FROM EXPANDER ROUTINES WHEN NO EXPAND IS REQUIRED         49700020
*                                                                       49750020
         LA    RMOD,TWO(R0,RMOD)        POINT TO NEXT INTRY             49850020
         B     EXLOOP0                  BUILD NEXT CCW                  49900020
         EJECT                                                          49950020
*                                                                       75050020
*        E X P A N D E R    R O U T I N E S                             75100020
*        THE FUCTION OF THE EXPANDER ROUTINES IS ...                    75150020
*              - SET THE COUNT IN THE CCW                               75200020
*              - LOAD THE CCW DATA ADDRESS IN RWKA                      75250020
*              - RETURN TO THE EXPAND ROUTINE (EXPRTN)                  75300020
*                                                                       75350020
         SPACE 3                                                        75400020
ORGRTN   DS    0H                                                       75450020
         SPACE 2                                                        75500020
*        SENSE EXPANDER                                                 75550020
*        EXPANDERS FOR ANY VALID ADDRESS                                75600020
NOPRT    EQU   *                                                        75620020
PREPRT   EQU   *                                                        75650020
RDSKPRT  EQU   *                                                        75700020
DISBLRT  EQU   *                                                        75750020
ENABLRT  EQU   *                                                        75800020
SNSRT    EQU   *                                                        75850020
         LA    RWKA,LCBCSWSV            SET SENSE FIELD                 75900020
         MVI   LCBCSWSV,AVTEFF          INITIALIZE SENSE BYTE     M1582 75920021
         MVI   CCWCOUNT+1,X'01'         SET COUNT=1                     75950020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        76000020
         SPACE 2                                                        76050020
         SPACE 2                                                        76100020
*        WRITE SPECIAL CHARACTERS EXPANDER                              76200020
WRACKRT  EQU   *                                                        76250020
         TM    LCBMSGFM,LCBNAK .        NAK REQUEST              S21101 76300020
         BO    WRNACKRT            IF YES, TAKE BRANCH                  76350020
         SPACE                                                          76400020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z10               76420020
         AIF   ('&GEN' EQ 'QTAM').Z10                                   76430020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 76450020
         TM    LCBCHAIN,LCBABRTN .      ABROT REQUEST FOR RVI    S22025 76460022
         BO    ITSRVI .                 BRANCH IF YES            S22025 76470022
         TM    LCBMSGFM,LCBACKI .       IF ON, WRITE ACK-0       S21101 76500020
         BNZ   ACK0                     BRANCH IF ACK0 REQUEST          76550020
.Z10     ANOP                                                           76570020
         B     ACK1                     MUST BE ACK 1                   76600020
         SPACE                                                          76650020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z11               76670020
         AIF   ('&GEN' EQ 'QTAM').Z11                                   76680020
WRDLETRT EQU   *                                                        76700020
         LA    RWKB,1(,RWKB) .          INDEX INTO TABLE         S22025 76750022
ITSRVI   EQU   * .                                               S22025 76760022
         LA    RWKB,8(,RWKB) .          INDEX INTO TABLE         S22025 76770022
WRENQRT  EQU   *                                                        76800020
         LA    RWKB,1(,RWKB)                                            76850020
.Z11     ANOP                                                           76870020
WRNACKRT EQU   *                                                        76900020
         NI    LCBCHAIN,AVTEFF-LCBABRTN RESET ABORT REQUEST      S22025 76950022
         NI    LCBMSGFM,X'FF'-LCBNAK-LCBEOT RESET FLAGS          S22025 76970022
         LA    RWKB,1(RWKB)                                             77000020
ACK1     EQU   *                                                        77050020
         LA    RWKB,1(,RWKB)                                            77100020
ACK0     EQU   *                                                        77150020
         LA    RWKB,1(RWKB)                                             77200020
WRIDLRT  EQU   *                                                        77250020
         LA    RWKB,1(RWKB)                                             77300020
WRPADRT  EQU   *                                                        77350020
         LA    RWKB,1(RWKB)                                             77400020
         AIF   ('&GEN' EQ 'MINI').R65XX                                 77410020
         AIF   ('&GEN' EQ 'QTAM').R65XX                                 77420020
         AIF   ('&GEN' EQ 'BISC').R65XX                                 77430020
         B     SKPCHK                                               TSO 77440020
.R65XX   ANOP                                                           77442020
WREOART  EQU   *                                                        77450020
         AIF   ('&GEN' EQ 'MINI').R66XX                                 77460020
         AIF   ('&GEN' EQ 'QTAM').R66XX                                 77470020
         AIF   ('&GEN' EQ 'BISC').R66XX                                 77480020
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 77490020
         BZ    SKPCHK                   BRANCH ON NO                TSO 77492020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 77494020
         BO    WREOTRT                  BRANCH ON YES               TSO 77496020
SKPCHK   EQU   *                                                    TSO 77498020
.R66XX   ANOP                                                           77498420
         LA    RWKB,1(RWKB)                                             77500020
WREOTRT  EQU   *                                                        77550020
         L     RWKA,DCBSCTAD-1          ADDR OF SPEC CHAR TABLE         77650020
         IC    RWKB,0(RWKA,RWKB)        PICK-UP OFFSET                  77700020
         AR    RWKA,RWKB                POINT TO CURRENT ENTRY          77750020
         MVC   CCWCOUNT+1(1),0(RWKA)    MOVE COUNT IN CCW               77800020
         LA    RWKA,1(RWKA)             SET-UP DATA ADDRESS             77850020
         AIF   ('&GEN' EQ 'BISC').L65                                   77900020
         AIF   ('&GEN' EQ 'MINI').L65                                   77950020
         CLI   0(RWKA),X'1F'            SENDING EOT                 TSO 78000020
         BNE   TSLV                     NO                          TSO 78050020
         TM    LCBSTICS,C2741           2741 TERM                   TSO 78100020
         BZ    TSLV                     NO                          TSO 78150020
         MVI   CCWCOUNT+1,X'01'         1 EOT 6OR 2741              TSO 78200020
TSLV     EQU   *                                                    TSO 78250020
.L65     ANOP                                                           78300020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        78350020
         SPACE 2                                                        78400020
*        WRITE POLLING CHARACTERS EXPANDER                              78450020
WRPOLRT  EQU   *                                                        78500020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               78550020
         IC    RWKA,TWO(,RWKC)          SIZE OF EACH ENTRY              78600020
         BCTR  RWKA,0                   DECREMENT FOR INDEX BYTE        78650020
         STC   RWKA,CCWCOUNT+1          SET CCWC OUNT                   78700020
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION   @SA62375 78720058
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L463       S99228 78750022
         AIF   ('&GEN' EQ 'QTAM').L463                           S99228 78770022
         TM    LCBXFLAG,LCBERPND        SOH%R MESSAGE PENDING?   S99228 78810022
         BZ    STANDARD                 BRANCH NO                S99228 78830022
         NI    LCBXFLAG,LCBERSTP        RESET ERP POLL INDIC     S99228 78850022
         L     RWKA,LCBXRADR            LOAD ERP POLL CHAR ADDR  S99228 78870022
         BR    REXPND                   RETURN TO EXPAND ROUTINE S99228 78890022
STANDARD EQU   *                                                 S99228 78910022
.L463    ANOP                                                    S99228 78920022
         L     RWKA,LCBINVPT-ONE        LOAD CURRENT ENTRY ADDR  S99228 78930022
         MVC   LCBERADR(THREE),LCBINVPT SET POLL ADDRESS       @SA62375 78990058
         BR    REXPND                   RETURN TO EXPAND ROUTINE        79050020
         SPACE 2                                                        79100020
*        READ RESPONSE EXPANDER                                         79150020
*            READ IN BUFFER FOR RECEIVING                               79200020
*            READ IN LCBERCCW FOR SENDING                               79250020
RDRSPSRT EQU   *                                                        79300020
         MVI   CCWCOUNT+1,9             SET RESONSE COUNT               79350020
         LA    RWKA,LCBERCCW+12         RESPONSE AREA                   79400020
         BR    REXPND             RETURN TO EXPAND ROUTINE              79450020
RDRSPRT  EQU   *                                                        79500020
         L     RWKC,LCBLSPCI-1          GET HEADER BUFFER ADDRESS       79520020
         LH    RWKA,PRFCOUNT-IEDQPRF(,RWKC) ¬ET ORIGINAL COUNT          79540020
         LA    RWKB,2                   ASSUME TWO CHARACTER RESP       79560020
*                                         (FOR NON 2260 LOCAL)          79580020
         TM    LCBTSOB,LCBTSBUF .       IS IT TSO                   TSO 79580620
         BZ    TS2260 .                 BR IF NO                    TSO 79581220
         TM    LCBTSOB,LCB2741N .       IS IT A 2741                TSO 79581820
         BO    TS2741 .                 BR IF YES                   TSO 79582420
         TM    LCBSTICS+1,CTWX .        IS IT TWX                   TSO 79583020
         BO    TS2741 .                 BR IF YES                   TSO 79583620
TS2260   EQU   *                                                        79584220
*                                                                       79595020
         TM    LCBSTICS+1,CLOCAL        2260 LOCAL                      79600020
         BZ    NOTALOC                  BRANCH IF NOT 2260 LOCAL        79620020
         TM    LCBTSOB,LCBTSBUF .       IS THIS TSO LOCAL               79625020
         BZ    TS2741 .                 BRANCH NO                       79630020
         BCTR  RWKB,0 .                 YES. NO READ RESPONSE           79635020
         SPACE                                                          79640020
TS2741   EQU   *                                                        79650020
         BCTR  RWKB,0                   ADJUST TO ONE CHARACTER         79660020
NOTALOC  EQU   *                                                        79680020
         SR    RWKA,RWKB                ADJUST ORIGINAL COUNT           79700020
         STH   RWKA,PRFCOUNT-IEDQPRF(,RWKC) RESET BUFFER COUNT          79720020
         L     RWKA,PRFIOADR-1-IEDQPRF(,RWKC) DATA ADDESS               79740020
         AR    RWKA,RWKB                BUMP BUFFER DATA ADDRESS        79760020
         STCM  RWKA,7,PRFIOADR-IEDQPRF(RWKC)  RESTORE DATA ADR @G36XRYP 79780000
         MVI   1(RWKA),AVTEZERO         CLEAR SECOND DATA BYTE @OS77835 79790000
         SR    RWKA,RWKB                BACK TO ORIGINAL DATA ADDRESS   79800020
*                                         FOR READ RESPONSE             79820020
         STC   RWKB,CCWCOUNT+1          SET READ RESPONSE COUNT         79840020
*                                         2260 LOCAL ALLOW ONE CHAR     79860020
*                                         MESSAGE                       79880020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        80050020
         SPACE 2                                                        80100020
*        RETURN TO ACTIVATE                                             80150020
*            TIC BUFFER FOR READ OP                                     80200020
*            TIC WRITE IDLE FOR WRITE OP                                80250020
TCCONRT  EQU   *                                                        80300020
         L     RWKA,LCBCPA+12           RESTART CCW                     80350020
         B     LEAVE                    EXIT                            80400020
         SPACE 2                                                        80450020
TCBUFRT  EQU   *                                                        80500020
         L     RWKA,LCBLSPCI-1          BUFFER ADDRESS                  80550020
         AIF   ('&GEN' EQ 'MINI').L66                             M6293 80570020
         AIF   ('&GEN' EQ 'STSP').L66                             M6293 80580020
         AIF   ('&GEN' EQ 'QTAM').L66                             M6293 80590020
         TM    LCBSTAT2,LCBSYNC .       IS THIS A BISYNC LINE     M6293 80600020
         BNO   NOTSYNC .                BRANCH, IF NOT            M6293 80610020
* FOR BISYNC LINES, IF AUTOPOLL, THE AUTOPOLL INDEX BYTE SHOULD   M6293 80620020
* ALWAYS BE REMOVED SINCE THE EOA STRING IS ALWAYS PRESENT.  IF   M6293 80630020
* LC=OUT IS SPECIFIED, THE EOA CHARACTERS WILL BE REMOVED BY LINE M6293 80640020
* APPENDAGE IN THE SCAN ROUTINE.                                  M6293 80650020
         CLI   LCBCPA+24,CCWPOLL .      IS THIS LINE AUTOPOLL     M6293 80700020
         BE    ADDIDLE .                BRANCH IF SO              M6293 80750020
         B     RETACT .                 DO NOT REMOVE INDEX       M6293 80800020
NOTSYNC  EQU   * .                                                M6293 80850020
         AIF   ('&GEN' EQ 'BISC').L67A                            M6293 80900020
         SPACE                                                          80950020
         L     RWKC,TRMDESTQ-1          PICK UP DEST QCB         S22029 81000022
         DROP  RWKC                                                     81020022
         USING IEDQQCB,RWKC                                             81040022
         TM    QCBDSFLG,QCBALTMH        IS TERMINAL CONNECTED TO S22029 81060022
*                                       AN ALTERNATE MH          S22029 81080022
         L     RWKC,DCBDEBAD            DEB ADDRESS              X02004 81100005
         L     RWKC,DEBAPPAD-DEBNMSUB(,RWKC) VECTOR TABLE        X02004 81110005
         BZ    LCTEST                   USE OWNING MH            X02004 81120005
         DROP  RWKC                                              X02004 81130005
         LA    RWKC,ONE(,RWKC)          USE ALTERNATE MH         X02004 81140005
LCTEST   EQU   *                                                 X02004 81150005
         AGO   .L66Z                                             X02004 81160005
.L66     ANOP                                                    X02004 81170005
         L     RWKC,DCBDEBAD            DEB ADDRESS              X02004 81180005
         L     RWKC,DEBAPPAD-DEBNMSUB(,RWKC) VECTOR TABLE        X02004 81190005
.L66Z    ANOP                                                    X02004 81200005
         TM    0(RWKC),LCIN             IS LC=IN SPECIFIED              81210005
         BO    RETACT                   YES                      S22029 81280022
         TM    LCBSTICS+1,CCONTENT+CTWX+CLOCAL+CAUDIO NONEOA DEVICE     81300020
         BNZ   RETACT                   BRANCH IF YES                   81350020
         L     RWKC,DCBSCTAD-1          GET SCT ADDRESS                 81400020
         IC    RWKB,1(RWKC)             GET EOA OFFSET                  81450020
         AR    RWKC,RWKB                POINT TO START OF SEQUENCE      81500020
         CLI   0(RWKC),X'01'            COUNT OF 1 MEANS A HARDWARE     81550020
*                                         GENERATED SEQUENCE TO BE      81600020
*                                         REMOVED                       81650020
         BNE   RETACT                   LESS THAN OR MORE THAN ONE      81750020
*                                       CHAR, DON'T ADJUST IDLES        81800020
.L67A    ANOP                                                     M6293 81810020
ADDIDLE  EQU   *                                                        81850020
         IC    RWKB,LCBISZE             IDLES RESERVED                  81900020
         LA    RWKB,1(,RWKB)            BUMP IDLES COUNT                81950020
         STC   RWKB,LCBISZE             SET IN LCB                      82000020
RETACT   EQU   *                                                        82003020
         IC    RWKB,LCBISZE             GET NUMBER OF IDLES             82006020
         LA    RWKB,PRFSHDR-PRFSUNIT(,RWKB) IDLES +PREFIX SIZE          82010020
         STH   RWKB,PRFSIZE-IEDQPRF(RWKA) PRE SET PREFIX SIZE           82020020
LEAVE    EQU   *                                                        82120020
         TM    LCBSTICS+1,CLOCAL        LOCAL CEVICE                    82300020
         BZ    NOLOCL                   NO                              82350020
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 82360022
         BO    NOLOCL                   BRANCH YES               S99228 82370022
         L     RWKB,LCBINVPT-1          INVITATION ENTRY                82400020
         MVC   LCBCPA+16(1),0(RWKB)     SET MODIFIED READ               82450020
NOLOCL   EQU   *                                                        82500020
         ST    RWKA,CCWADDR-1                                           82550020
         MVI   CCWOPCDE,CCWTIC          SET TIC OP CODE                 82600020
         BR    R2                       RETURN TO ACTIVATE ROUTINE      82650020
         SPACE 2                                                        82700020
TCIDLRT  EQU   *                                                        82710020
         LA    RWKA,LCBCPA              WRITE IDLES LOCATION            82720020
         B     NOLOCL                   USE COMMON EXIT                 82730020
         SPACE 3                                                        82740020
         AIF   ('&GEN' EQ 'MINI').Z12                                   82770020
*        POLL EXPANDER                                                  82850020
POLLRT   EQU   *                        BUILD POLL COMMANDS FOR         82900020
*                                         ALL AUTOPOLL                  82950020
         BAL   RWKB,ILIST               FIND LILIST ADDRESS             83000020
         IC    RWKA,ONE(,RWKC)          NO. OF ACTIVE ENTIRES           83050020
         LR    RWKB,RWKA                CLEAR REG EXCEPT LO-ORDER       83100020
         IC    RWKB,TWO(,RWKC)          SIZE OF EACH ENTRY              83150020
         MR    RWKB-1,RWKA              PRODUCT OF SIZE AND NUMBER      83200020
         AIF   ('&GEN' NE '').L68                                       83250020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        83300020
         BZ    STSP                     BRANCH NO                       83350020
.L68     ANOP                                                           83400020
         AIF   ('&GEN' EQ 'STSP').L69                                   83450020
         AIF   ('&GEN' EQ 'QTAM').L69                                   83500020
         SPACE                                                          83550020
         LA    RWKB,1(,RWKB)            ADJUST -EOT AT END OF BSC       83600020
*                                         LIST                          83650020
.L69     ANOP                                                           83700020
STSP     EQU   *                                                        83750020
         LA    RWKA,LCBCPA+24           SET CCW ADDRESS                 83800020
         CR    RWKA,RCCW                THIS FIRST POLL                 83850020
         BE    FRSTPOLL                 BRANCH FIRST POLL               83900020
         SPACE                                                          83950020
         LA    RWKA,8(,RWKC)            SAT OF ENTRIES                  84000020
OUT      EQU   *                                                        84050020
         STH   RWKB,CCWCOUNT            SET COUNT                       84100020
         BR    REXPND                   REUTR TO EXPAND                 84150020
         SPACE                                                          84200020
FRSTPOLL EQU   *                                                        84250020
         L     RWKA,LCBINVPT-1          STARTING ADDRESS                84300020
         LA    RWKB,8(RWKB,RWKC)        BUMP TO I END OF LIST           84350020
         SR    RWKB,RWKA                COUNT                           84400020
         B     OUT                      USE COMMON EXIT                 84450020
.Z12     ANOP                                                           84470020
         SPACE                                                          84500020
ILIST    EQU   *                                                        84550020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             84600020
         IC    RWKA,LCBUCBX             RLN-1                           84650020
         SLL   RWKA,2                   MULTILPY BY 4                   84700020
         L     RWKC,DCBINVLI(RWKA)      ILIST FOR LINE                  84750020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             84800020
         BR    RWKB                     RETURN                          84850020
         SPACE 2                                                        84856022
*        THIS SUBROUTINE LOCATES THE LCB EXTENSION ABOVE THE     S99228 84859022
*        CHANNEL PROGRAM AREA                                    S99228 84862022
         SPACE 1                                                        84865022
GLCBXA   EQU   *                                                 S99228 84868022
         SR    RWKA,RWKA                CLEAR LENGTH REGISTER    S99228 84871022
         IC    RWKA,DCBEIOBX            INSERT LCB LENGTH        S99228 84874022
         SH    RWKA,AVTHA4              REDUCE LCB LENGTH BY     S99228 84877022
         SH    RWKA,AVTHA4              8 BYTES FOR ADDR LCB EXT S99228 84880022
         LA    RWKC,ZERO(RWKA,RLCB)     LOAD LCB EXTENSION ADDR  S99228 84883022
         BR    RWKB                     RETURN TO CALLER         S99228 84886022
.L483    ANOP                                                    S99228 84889022
         SPACE 2                                                        84900020
         AIF   ('&GEN' EQ 'MINI').Z13                                   84920020
TCRDXRT  EQU   *                        READ TO READ RESINDEX-AUTOP     84950020
         LA    RWKA,T24(RCCW)           ADDR OF READ RESP               85000020
         BR    REXPND                   RETURN TO EXPAND                85050020
*        TIC EXPANDERS                                                  85100020
TCPOLRT  EQU   *                        TIC TO POLL CCW I.E. PREV.      85150020
         MVI   CCWCOUNT+1,1             SET TIC COUNT FOR LATER NOP     85200020
         LA    RWKA,LCBCPA+48           ADDRESS OF 2ND POLL             85250020
         BR    REXPND                                                   85300020
.Z13     ANOP                                                           85350020
         LA    RWKA,LCBCPA              LOAD WRITE IDLE ADDRESS         85450020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        85500020
TCSKPRT  EQU   *                                                        85600020
         LA    RWKA,LCBCPA              TIC TO READ SKIP                85650020
         MVC   LCBCPA+13(3),LCBLSPCI    SET CURRENT CCW ADDRESS         85700020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        85750020
         SPACE 2                                                        85800020
*    WRITE ADDRESSING CHARS AND CIAL COMMANDS.                          85900020
DIALRT   EQU   *                                                        85950020
         OI    LCBTPCD+11,DISDLEOT      SET TO WRITE DISCONNECT SA61781 85960005
*                                         PRIOR TO NEXT DISABLE SA61781 85970005
WRADRRT  EQU   *                                                        86000020
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS PRESENT           86050020
         BZ    NOOPT                    BRANCH NO                       86100020
         SPACE                                                          86150020
         IC    RWKB,TRMOPNO             SIZE OF OPTION TABLE            86200020
         LA    RWKB,3(,RWKB)            ACCOUNT FOR OFFSET AND          86250020
*                                         OPTION NUMBER                 86300020
NOOPT    EQU   *                                                        86350020
         LH    RWKC,TRMDEVFL            DEVICE FLAGS                    86400020
         LTR   RWKC,RWKC                BUFSZ SPECIFIED                 86450020
         BNL   NOBUFSZ                  BRANCH IF NO                    86500020
         LA    RWKB,THREE(R0,RWKB)      ADJUST FOR BUFSX FIELD          86550020
NOBUFSZ  EQU   *                                                        86600020
         LA    RWKB,TRMCHCIN+1(RWKB)    POINT TO DEVICE DEPENDENT       86650020
*                                         AREA BYPASSING OPTION S       86700020
         AIF   ('&GEN' EQ 'MINI').L71                                   86750020
         SLL   RWKC,17                  SHIFT DIAL BIT                  86800020
         LTR   RWKC,RWKC                DIAL DIGITS PRESENT             86850020
         BNL   NODIGITS                 BRANCH NO                       86900020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             86950020
         IC    RWKA,ZERO(R0,RMOD)       OFFSET INTO EXPANDER TABLE      87000020
         IC    RWKA,ORGTB1+2(RWKA)      CCW OP CODE                     87050020
         STC   RWKA,LCBERCCW            PUT IN WORK AREA                87100020
         IC    RWKA,ZERO(R0,RWKB)       COUNT OF DIAL OR ADDR  SEQ      87150020
         CLI   LCBERCCW,CCWDIAL         THIS A DIAL BUILD               87200020
********                                                                87250022
* NOTE * FOLLOWING CODE IS ONLY EXECUTED WHILE SYSTEM IS ENABLED        87250522
********                                                                87251022
         BNE   NOTDLBLD                BRANCH NO                SA57685 87251522
         STM   R0,RLNK1,AVTSAVE3       SAVE REGS                SA57685 87252022
         L     RWKC,DCBDEBAD           GET DEB                  SA57685 87252522
         IC    RWKA,LCBUCBX            RLN                      SA57685 87253022
         SLL   RWKA,2                  TIMES 4                  SA57685 87253522
         L     RWKC,DEBUCBAD-DEBNMSUB(RWKC,RWKA)   GET UCB ADRS SA57685 87254022
         TM    UCBTYP2(RWKC),AUTOCALL  AUTOCALL FEATURE         SA57685 87254522
         BO    DIALBLD                 BRANCH YES               SA57685 87255022
         MVC   WTO+22(3),UCBID(RWKC)   LINE NUMBER              SA57685 87255522
         MVI   WTO+26,C' '             SET BLANK                SA57685 87256022
         MVC   WTO+27(11),WTO+26       BLANK AREA               SA57685 87256522
         IC    RWKA,0(,RWKB)           COUNT OF DIGITS          SA57685 87257022
         BCTR  RWKA,0                  DECREMENT FOR MOVE       SA57685 87257522
         EX    RWKA,MOVEDIGT           SET DIGITS               SA57685 87258022
         OI    WTO+26,X'F0'            SET ZONE                 SA57685 87258522
         BCTR  RWKA,0                  COUNT FOR ZONE MOVE      SA57685 87259022
         EX    RWKA,MOVEZONE           SET ZONES                SA57685 87259522
WTO      WTO   'IED158I  DIAL    ,                    ',               C87260022
               ROUTCDE=8,DESC=3                                 SA57685 87260522
         LM    R0,RLNK1,AVTSAVE3       RESTORE REGS             SA57685 87261022
         ST    RLCB,CCWADDR-1          SET VLD PROTECT CMD ADDR SA57685 87261522
         MVI   CCWOPCDE,CCWENAB        SET COMMAND              SA57685 87262022
         MVI   CCWCOUNT+1,X'01'        SET COUNT OF 1           SA57685 87262522
         SR    RWKB,RWKB               CLEAR REGISTER           SA57685 87263022
         IC    RWKB,AVTEZERO(RMOD)     OFFSET IN EXPANDER TABLE SA57685 87263522
         B     EXPRTN0                 RETURN                   SA57685 87264022
*   EXCUTED   INSTRUCTIONS                                      SA57685 87264522
MOVEDIGT MVC   WTO+26(1),1(RWKB)       SET DIAL DIGITS          SA57685 87265022
MOVEZONE MVZ   WTO+27(1),WTO+26        SET ZONE                 SA57685 87265522
NOTDLBLD EQU   *                                                SA57685 87266022
*********************************************************************** 87266522
         LA    RWKB,1(RWKA,RWKB)        BUMP PAST DAIL DIGITS           87300020
DIALBLD  EQU   *                                                        87350020
NODIGITS EQU   *                                                        87400020
.L71     ANOP                                                           87450020
         MVC   CCWCOUNT+1(ONE),ZERO(RWKB) SET COUNT                     87500020
         ST    R2,LCBLINK-1 .           SAVE LINK REG            A50191 87508022
         TM    LCBSTICS+2,CNOIDLES .    2260 REMOTE              A50191 87516022
         BNZ   TESTCHAR .               BRANCH IF YES            A50191 87524022
NOCHAR   EQU   * .                                               A50191 87532022
         L     R2,LCBLINK-1 .           RESTORE LINK REG         A50191 87540022
         LA    RWKA,1(,RWKB)            POINT TO DEVICE CHARACTERS      87550020
         AIF   ('&GEN' EQ 'MINI').Z71XX                                 87560020
         AIF   ('&GEN' EQ 'QTAM').Z71XX                                 87570020
         AIF   ('&GEN' EQ 'BISC').Z71XX                                 87580020
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 87590020
         BZ    NOTS2260                 BRANCH ON NO                TSO 87592020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 87594020
         BZ    NOTS2260                 BRANCH ON NO                TSO 87596020
         CLI   0(RWKB),THREE            IS COUNT THREE              TSO 87598058
         BE    IS2260                   YES,BRANCH             @SA76687 87598158
         CLI   FOUR(RWKB),AVTEFF        CONTROL CHAR IN BFR    @SA76687 87598258
         BNE   NOTS2260                 NO,BRANCH              @SA76687 87598458
         CLI   ZERO(RWKB),FOUR          FOUR CHARS SPECIFIED   @SA76687 87598558
         BNE   NOTS2260                 NO,BRANCH              @SA76687 87598658
IS2260   EQU   *                                               @SA76687 87598758
         CLI   3(RWKB),X'E0'            IS SCREEN BEING ERASED      TSO 87598820
         BNE   NOTS2260                 BRANCH ON NO                TSO 87599220
         MVI   LCBTPCD+10,X'BD'         SET INDICATOR IN LCB        TSO 87599620
NOTS2260 EQU   *                                                    TSO 87599720
.Z71XX   ANOP                                                           87599820
         BR    REXPND                   RETURN TO EXPAND                87600020
         SPACE 2                                                        87650020
TESTCHAR EQU   * .                                               A50191 87651022
         SPACE                                                          87652022
*        TEST FOURTH ADDRESSING CHARACTER FOR X'FF' IF 2260    * A50191 87653022
*        REMOTE.  IF YES, MOVE CORRECT CONTROL CHARACTER FOR   * A50191 87654022
*        CURRENT TRANSMISSION FROM FIRST DATA BYTE IN BUFFER.  * A50191 87655022
         SPACE                                                          87656022
         CLI   FOUR(RWKB),AVTEFF .      CONTROL CHAR IN BUFFER   A50191 87657022
         BNE   NOCHAR .                 BRANCH IF NO             A50191 87658022
         CLI   ZERO(RWKB),FOUR .        FOUR CHARS SPECIFIED     A50191 87659022
         BNE   NOCHAR .                 BRANCH IF NO             A50191 87660022
         TM    LCBTSOB,LCBTSBUF         IS THIS TSO            @SA76687 87660358
         BO    NOCHARX                  YES-IGNORE CONTROL CHAR@SA76687 87660658
         NC    LCBERBCH,LCBERBCH .      BUFFER IN ERB            A50191 87661022
         BZ    NOCHAR1                  BRANCH NO              @YA11011 87662058
         L     R2,LCBERBCH-1 .          GET BUFFER ADDRESS       A50191 87663022
         TM    PRFSTAT1-IEDQPRF(R2),PRFNHDRN HEADER BUFFER       A50191 87664022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87665058
         TM    PRFSTAT1-IEDQPRF(R2),PRFCNCLN CANCELLED MESSAGE   A50191 87666022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87667058
         TM    LCBSTAT2,LCBMSGNN .      MSGGEN MESSAGE           A50191 87668022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87669058
         SR    RWKC,RWKC .              CLEAR WORK REGISTER      A50191 87670022
         IC    RWKC,PRFSCAN+1-IEDQPRF(R2) GET IDLES COUNT        A50191 87671022
         LA    RWKC,PRFSHDR-IEDQPRF(RWKC,R2) FIRST DATA BYTE     A50191 87672022
         CLI   ZERO(RWKC),XA0 .         WRITE DC                 A50191 87673022
         BE    SCREENOK .               BRANCH IF YES            A50191 87674022
         CLI   ZERO(RWKC),XB0 .         WRITE AT LINE ADDRESS    A50191 87675022
         BE    SCREENOK .               BRANCH IF YES            A50191 87676022
         CLI   ZERO(RWKC),XE0 .         WRITE ERASE              A50191 87677022
         BE    SCREENOK .               BRANCH IF NO             A50191 87678022
         CLI   EQU3(RWKB),XB0 .         WLA                      A50191 87679022
         BE    NOCHARX .                BRANCH IF YES            A50191 87680022
         CLI   EQU3(RWKB),XE0 .         WRITE ERASE              A50191 87681022
         BE    NOCHARX .                BRANCH IF YES            A50191 87682022
NOCHAR1  EQU   *                                               @YA11011 87682558
         MVI   EQU3(RWKB),XA0 .         WDC IS DEFAULT           A50191 87683022
         B     NOCHARX .                RETURN TO MAINLINE       A50191 87684022
SCREENOK EQU   * .                                               A50191 87685022
         MVC   EQU3(1,RWKB),ZERO(RWKC)  SET CONTROL CHARACTER    A50191 87686022
NOCHARX  EQU   * .                                               A50191 87687022
         SR    RWKC,RWKC .              CLEAR WORK REGISTER      A50191 87688022
         IC    RWKC,CCWCOUNT+1 .        ADDR STRING LENGTH       A50191 87689022
         BCTR  RWKC,R0 .                DECREMENT COUNT BY ONE   A50191 87690022
         STC   RWKC,CCWCOUNT+1 .        RESET NEW COUNT          A50191 87691022
         B     NOCHAR .                 RETURN TO MAINLINE       A50191 87692022
         SPACE 2                                                        87693022
         AIF   ('&GEN' EQ 'MINI').L72                                   87700020
*        DIAL EXPANDER                                                  87750020
*        READ TERM/IDENTIFICATION EXPANDER                              87800020
RDTERMRT EQU   *                                                        87850020
         MVI   CCWCOUNT+1,24            MAC COUNT TWX ID                87900020
         LA    RWKA,LCBERCCW            DATA ADDRESXS                   87950020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        88000020
         SPACE 2                                                        88050020
         SPACE 2                                                        88100020
WTTRSPRT EQU   *                                                        88150020
         LA    RWKA,LCBERCCW            DATA ADDRESS                    88200020
         MVI   CCWCOUNT+1,24            SET COUNT FOR READ              88250020
         BR    REXPND                   RETURN                          88300020
.L72     ANOP                                                           88350020
*   EXPANDER FOR CONTINUE OPERATIONS                                    88400020
RDEOBRT  EQU   *                                                        88450020
         MVI   CCWCOUNT+1,9             SET COUNT                       88500020
         LA    RWKA,LCBERCCW+12         READ ID ENQ                     88550020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        88600020
         AIF   ('&GEN' EQ 'MINI').L73                                   88650020
         AIF   ('&GEN' EQ 'STSP').L74                                   88670020
         AIF   ('&GEN' EQ 'QTAM').L74                                   88680020
RDIDRT   EQU   *                                                        88700020
RDRSPEQ  EQU   *                                                        88750020
RDENQRT  EQU   *                                                        88800020
         MVI   CCWCOUNT+1,17            MAX COUNT RD ID ENQ             88850020
         LA    RWKA,LCBERCCW+7          RESPONSE AREA                   88900020
         BR    REXPND                   RETURN                          88950020
WRTONERT EQU   *                                                        89000020
         L     RWKA,AVTTONE             GET ADDDRESS OF COUNT           89050020
         MVC   CCWCOUNT,0(RWKA)         SET CCW COUNT                   89100020
         LA    RWKA,2(,RWKA)            BUMP TO FF SEQUENCE             89150020
         BR    REXPND                   RETURN TO EXPAND                89200020
RDLCRT   EQU   *                                                        89300020
         LA    RWKA,LCBERCCW+12         READ AREA                       89350020
         MVI   CCWCOUNT+1,1             ASSUME NONTRANSPARENT           89400020
         L     RWKC,LCBSCBA-1            URRNET SCB                     89450020
         USING IEDQSCB,RWKC                                             89500020
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING RRANSPARENT   S21101 89550020
         BCR   8,REXPND                 BRANCH NON-TRANSP.              89600020
         MVI   CCWCOUNT+1,2             SET COUN T                      89650020
         BR    REXPND                   RETURN                          89700020
         DROP  RWKC                                                     89750020
.L74     ANOP                                                  @OZ28818 89753082
         SPACE                                                          89757000
TCEOTRT  EQU   *                                               @OX14790 89764000
         LA    RWKA,LCBCPA+16           TIC TO THIRD CCW       @OX14790 89771000
         MVC   LCBCPA+13(3),LCBLSPCI    RESTORE CURRENT ADDRESS@0X14790 89778000
         BR    REXPND                   RETURN TO EXPAND ROUTIN@OX14790 89785000
         SPACE 1                                               @OX14790 89792000
WRCPURT  EQU   *                        WRITE CPU ID                    89900020
*        WRITE CPU/IDENTIFICATION EXPANDER                              89950020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               90000056
         L     RWKB,IDLOC(,RWKC)        GET ADDRESS OF CPU ID           90010056
         B     NODIGITS                 USE COMMON CODE                 90020056
         SPACE                                                          90030056
WRWCCRT  LA    RWKA,WCCSEQU             ADDRESS OF WCC SEQUENCS22028TSO 90040056
         TM    LCBTPCD+11,X'01'         ASCII INDICATED ?      @SA71925 90050056
         BZ    WRWCCRT1                 NO, BRANCH             @SA71925 90060056
         LA    RWKA,WCCSEQUA            ADDR OF ASCII SEQUENCE @SA71925 90070056
         NI    LCBTPCD+11,X'FE'         TURN OFF ASCII INDICATO@SA71925 90080056
WRWCCRT1 EQU   *                                               @SA71925 90090056
         MVI   CCWCOUNT+1,X'05'         SET COUNT TO 5        S22028TSO 90106056
         BR    REXPND                   RETURN                S22028TSO 90106356
WRWCCR1  LA    RWKA,WCCNOMDT            ADDR WCC, NO MDT        SA68050 90106656
         TM    LCBTPCD+11,X'01'         ASCII INDICATED        @SA71925 90106956
         BZ    WRWCCR2                  NO, BRANCH             @SA71925 90107256
         LA    RWKA,WCCSEQA1            ADDR ASCII NO MDT SEQ  @SA71925 90107556
         NI    LCBTPCD+11,X'FE'         RESET ASCII INDICATOR  @SA71925 90107856
WRWCCR2  EQU   *                                               @SA71925 90108156
         MVI   CCWCOUNT+1,X'05'         SET COUNT TO 5          SA68050 90109005
         BR    REXPND                   RETURN                  SA68050 90109505
         SPACE                                                          90110022
RDWCCRT  MVI   CCWCOUNT+1,X'09'         SET COUNT TO 9        S22028TSO 90112022
         LA    RWKA,LCBERCCW+12         RESPONSE ADDRESS      S22028TSO 90114022
         BR    REXPND                   RETURN                S22028TSO 90116022
         AIF   ('&GEN' EQ 'BISC').L73                                   90120020
         SPACE 2                                                        90150020
BREAKCCW EQU   *                                                        90155020
WRSMIRT  LA    RWKA,SMISEQU             ADDRESS OF SMI SEQUENCE     TSO 90160020
         MVI   CCWCOUNT+1,X'03'         SET COUNT TO THREE          TSO 90170020
         BR    REXPND                   RETURN                      TSO 90180020
         SPACE                                                          90200020
         AIF   ('&GEN' EQ 'QTAM').L73                            A48245 90205022
RDACKRT  MVI   CCWCOUNT+1,X'01'         SET COUNT TO ONE            TSO 90210020
         LA    RWKA,LCBERCCW+12         RESPONSE ADDRESS            TSO 90220020
         BR    REXPND                   RETURN                      TSO 90230020
.L73     ANOP                                                    S99228 90231022
WRSEL    EQU   *                                                 S99228 90233022
* 3270 LOCAL SELECT EXPANDER                                     S99228 90236022
         SR    RWKA,RWKA                CLEAR ADDR REGISTER      S99228 90239022
         MVI   CCWCOUNT+ONE,ONE         SET DATA COUNT AT ONE    S99228 90242022
         BR    REXPND                   RETURN                   S99228 90245022
         SPACE                                                          90250020
*  E Q U A T E S  D I R E C T O R Y                                     90500020
*                                                                       90550020
*        D E V I C E    C H A R A C T E R I S T I C S                   90600020
*                                                                       90650020
* BYTE 2                                                                90700020
CBISYNC  EQU   X'80'                                                    90750020
C3270    EQU   X'04'                    3270 DEVICE              S99228 90752022
         AIF   ('&GEN' EQ 'MINI').L73C                           S22026 90758022
         AIF   ('&GEN' EQ 'STSP').L73C                           S22026 90766022
         AIF   ('&GEN' EQ 'QTAM').L73C                           S22026 90774022
CBRDCAST EQU   X'40' .                                           S22026 90782022
.L73C    ANOP                                                    S22026 90790022
CTWX     EQU   X'20'                                                    90800020
CSTNCTL  EQU   X'10'                                                    90850020
CXMITCTL EQU   X'08'                                                    90900020
CCONTENT EQU   X'04'                                                    90950020
CLOCAL   EQU   X'02'                                                    91000020
CAUDIO   EQU   X'01'                                                    91050020
* BYTE 3                                                                91100020
CWTTA    EQU   X'40'                    WORLD TRADE TELEGRAPH           91150020
CENDCTL  EQU   X'20'                    END TO END CONTROLS (2780)      91200020
CCHECK   EQU   X'10'                    CHECKING                        91250020
CBFRD    EQU   X'08'                    BUFFERED TERM.                  91300020
CCONTIN  EQU   X'04'                    CAPABLE OF CONTINUE OPER.       91350020
CNOIDLES EQU   X'02'                   NO IDLES DEFINED                 91400020
C2760    EQU   X'01'                    2760                            91450020
* BYTE 1                                                                91500020
CINHIBIT EQU   X'80'                    USE READ INHIBIT CCW'S          91550020
CBREAK   EQU   X'40'                    TERM HAS REVERSE BREAK FEATURE  91600020
CATTEN   EQU   X'20'                    TERM HAS ATTENTION FEATURE      91650020
C5041    EQU   X'10'                    2741'S AND 1050'S SUPPORTED     91700020
C2741    EQU   X'08'                    2741 ON THIS LINE               91750020
*                                                                       91800020
IDLOC    EQU   4                        OFFSET INTO ILIST               91850020
AUTOPL   EQU   X'01'                    AUTOPOLL FLAG IN ILIST          91900020
CUMASK   EQU   X'01'                    CU ENTRY DVC CHARS TABLE S99228 91910022
F0       EQU   X'F0'                    MASK USED FOR DAIL UP           91950020
AUTOCALL EQU   X'80'                   UBC MASK-AUTOCALL        SA57685 91950522
UCBTYP2  EQU   X'11'                   UCB OFFSET TO DIAL FEAT  SA57685 91951022
UCBID    EQU   X'0D'                   UCB OFFSET TO UCB ID     SA57685 91951522
SENDVTO  EQU   X'0E'                    SEND STCB FOR LEASED LINE       92000020
UNEX     EQU   X'01'                    UNIT EXCEPTION IN CSW-FLG       92050020
*                                         FOR NO RESTART                92100020
THREE    EQU   3                                                        92250020
ONE      EQU   1                                                        92350020
FLAG     EQU   X'20'                    USED IN WRITE IDLES LOOP        92450020
SLNTRC   EQU   X'08'                    TRACE REQUESTED FLAG   @YA12276 92520058
TWO      EQU   2                                                        92550020
T24      EQU   24                                                       92600020
FOUR     EQU   4                                                        92750020
SEVEN    EQU   7                                                X30X5MT 92770058
EIGHT    EQU   8                                                        92800020
LCIN     EQU   X'80'                    MASK FOR LCIN                   92950020
ZERO     EQU   X'00'                                                    93050020
CALLOPT  EQU   X'70'                    MASK FOR CHECKING CLOCK@OS77867 93053000
*                                       OR CINTVL              @OS77867 93056000
PURGEXT  EQU   9             OFFSET TO ADDRESS OF IOGENER EXIT  X30X5MT 93060058
REGSAVE  EQU   28                       OFFSET INTO SAVEAREA    X30X5MT 93070058
OUTONLY  EQU   X'03'                    OUTPUT ONLY DEVICE     @OX16705 93075000
RETURN4  DC    F'4'                     RETURN CODE OF 4        X30X5MT 93080058
* *   T E M P O R A R Y                                             TSO 93100020
CVTPTR   EQU   16 .                                                 TSO 93150020
TONEOPT  EQU   X'01'                    MASK FOR TONE GENERATION        93270020
D41STICS DC    XL3'F80400'              2741                        TSO 93300020
D50STICS DC    XL3'301014'               050                        TSO 93350020
SMISEQU  DC    XL3'02BD03'                                          TSO 93370020
WCCSEQU  DC    XL5'0227F1C303'                                S22028TSO 93380022
WCCSEQA1 DC    XL5'021B314203'          ASCII WCC NO MDT SEQU  @SA71925 93383056
WCCSEQUA DC    XL5'021B314303'          ASCII SEQUENCE         @SA71925 93386056
WCCNOMDT DC    XL5'0227F1C203'                                  SA68050 93390005
DISDLEOT EQU   X'01'                    FLAG TO WRITE DLE EOT           93400020
CSVTO    EQU   X'20' .                  CONC SCH VTO             S22026 93420022
BUFFVTO  EQU   X'1A'                    BUFFRERED TERMINAL VTO          93450020
XA0      EQU   X'A0' .                  WRITE DC                 A50191 93460022
XB0      EQU   X'B0' .                  WRITE AT LINE ADDRESS    A50191 93470022
XC8      EQU   X'C8'                    LENGTH OF LCB          @ZA04039 93475058
XE0      EQU   X'E0' .                  WRITE ERASE              A50191 93480022
ASCIIEOT EQU   X'04' .                  ASCII EOT CHAR         @OZ09276 93485000
EQU3     EQU   3 .                      CONSTANT                 A50191 93490022
*                                                                       93500022
*        E X P A N D E R S    T A B L E                                 93502022
*                                                                       93504022
*        EACH ENTRY IN THIS TABLE PROVIDES...                           93506022
*              - TWO BYTES OFFSET INTHE EXPANDER ROUTINES               93508022
*              - ONE BYTE OP CODE CCW                                   93510022
*              - ONE BYTE TP CODE EXPANDER                              93512022
*                                                                       93514022
*                                                                       93516022
ORGTB1   DS    0H                                                       93518022
         SPACE 3                                                        93520022
         AIF   ('&GEN' EQ 'BISC').L58                                   93522022
SNSCW    DC    AL2(SNSRT-ORGRTN)                                        93524022
         DC    AL1(CCWSENSE)                                            93526022
         DC    AL1(TPNULL)                                              93528022
         SPACE 1                                                        93530022
NOPCCW   EQU   *                                                        93532022
         DC    AL2(NOPRT-ORGRTN)                                        93534022
         DC    AL1(CCWNOP)                                              93536022
         DC    AL1(TPNULL)                                              93538022
         SPACE 1                                                        93540022
.L58     ANOP                                                           93542022
RDSKPCW  DC    AL2(RDSKPRT-ORGRTN)                                      93544022
         DC    AL1(CCWREAD)                                             93546022
         DC    AL1(TPRDSKIP)                                            93548022
         SPACE 1                                                        93550022
TCSKPCW  DC    AL2(TCSKPRT-ORGRTN)                                      93552022
         DC    AL1(CCWTIC)                                              93554022
         DC    AL1(TPNULL)                                              93556022
         SPACE 1                                                        93558022
WREOTCW  DC    AL2(WREOTRT-ORGRTN)                                      93560022
         DC    AL1(CCWWRITE)                                            93562022
         DC    AL1(TPWREOT)                                             93564022
         SPACE 1                                                        93566022
WRPOLCW  DC    AL2(WRPOLRT-ORGRTN)                                      93568022
         DC    AL1(CCWWRITE)                                            93570022
         DC    AL1(TPWRPOLL)                                            93572022
         SPACE 1                                                        93574022
RDRSPCW  DC    AL2(RDRSPRT-ORGRTN)                                      93576022
         DC    AL1(CCWREAD)                                             93578022
         DC    AL1(TPRDRESP)                                            93580022
         SPACE 1                                                        93582022
TCBUFCW  DC    AL2(TCBUFRT-ORGRTN)                                      93584022
         SPACE 1                                                        93586022
PREPCW   DC    AL2(PREPRT-ORGRTN)                                       93588022
         DC    AL1(CCWPREP)                                             93590022
         DC    AL1(TPNULL)                                              93592022
         SPACE 1                                                        93594022
         AIF   ('&GEN' EQ 'MINI').Z9                                    93596022
POLLCW   DC    AL2(POLLRT-ORGRTN)                                       93598022
         DC    AL1(CCWPOLL)                                             93600022
         DC    AL1(TPRDRESP)                                   @YA10455 93602058
         SPACE 1                                                        93604022
TCRDXCW  DC    AL2(TCRDXRT-ORGRTN)                                      93606022
         DC    AL1(CCWTIC)                                              93608022
         DC    AL1(TPNULL)                                              93610022
         SPACE 1                                                        93612022
TCPOLCW  DC    AL2(TCPOLRT-ORGRTN)                                      93614022
         DC    AL1(CCWTIC)                                              93616022
         DC    AL1(0)                   0 TP CODE FOR LINE END TABLE    93618022
         SPACE 1                                                        93620022
.Z9      ANOP                                                           93622022
WRIDLCW  DC    AL2(WRIDLRT-ORGRTN)                                      93624022
         DC    AL1(CCWWRITE)                                            93626022
         DC    AL1(TPWRIDLE)                                            93628022
         SPACE 1                                                        93630022
TCIDLCW  DC    AL2(TCIDLRT-ORGRTN)                                      93632022
         SPACE 1                                                        93634022
WRPADCW  DC    AL2(WRPADRT-ORGRTN)                                      93636022
         DC    AL1(CCWWRITE)                                            93638022
         DC    AL1(TPWRPAD)                                             93640022
         SPACE 1                                                        93642022
         AIF   ('&GEN' EQ 'MINI').L60                                   93644022
         AIF   ('&GEN' EQ 'STSP').L60                                   93646022
         AIF   ('&GEN' EQ 'QTAM').L60                                   93648022
RDENQCW  EQU   *                        READ ENQ                        93650022
         DC    AL2(RDENQRT-ORGRTN)                                      93652022
         DC    AL1(CCWREAD)                                             93654022
         DC    AL1(TPRDENQ)                                             93656022
         SPACE                                                          93658022
.L60     ANOP                                                           93660022
WRADRCW  DC    AL2(WRADRRT-ORGRTN)                                      93662022
         DC    AL1(CCWWRITE)                                            93664022
         DC    AL1(TPWRAD)              ADDRESSING SEQUENCE             93666022
         SPACE 1                                                        93668022
WREOACW  DC    AL2(WREOART-ORGRTN)                                      93670022
         DC    AL1(CCWWRITE)                                            93672022
         DC    AL1(TPWREOA)                                             93674022
         SPACE 1                                                        93676022
         AIF   ('&GEN' EQ 'MINI').L61                                   93678022
DISBLCW  DC    AL2(DISBLRT-ORGRTN)                                      93680022
         DC    AL1(CCWDISAB)                                            93682022
         DC    AL1(TPNULL)                                              93684022
         SPACE 1                                                        93686022
DIALCW   DC    AL2(DIALRT-ORGRTN)                                       93688022
         DC    AL1(CCWDIAL)                                             93690022
         DC    AL1(TPNULL)                                              93692022
         SPACE 1                                                        93694022
ENABLCW  DC    AL2(ENABLRT-ORGRTN)                                      93696022
         DC    AL1(CCWENAB)                                             93698022
         DC    AL1(TPENABLE)                                            93700022
         SPACE 1                                                        93702022
RDTERMCW DC    AL2(RDTERMRT-ORGRTN)                                     93704022
         DC    AL1(CCWREAD)                                             93706022
         DC    AL1(TPTWXID)                                             93708022
         SPACE 1                                                        93710022
WRCPUCW  DC    AL2(WRCPURT-ORGRTN)                                      93712022
         DC    AL1(CCWWRITE)                                            93714022
         DC    AL1(TPWRCPU)                                             93716022
         SPACE 1                                                        93718022
WTTRSPCW EQU   *                                                        93720022
         DC    AL2(WTTRSPRT-ORGRTN)                                     93722022
         DC    AL1(CCWREAD)                                             93724022
         DC    AL1(TPRDRSPD)                                            93726022
.L61     ANOP                                                           93728022
RDRSPSCW DC    AL2(RDRSPSRT-ORGRTN)                                     93730022
         DC    AL1(CCWREAD)                                             93732022
         DC    AL1(TPRDRSPD)                                            93734022
         SPACE                                                          93736022
WRACKCW  DC    AL2(WRACKRT-ORGRTN)                                      93738022
         DC    AL1(CCWWRITE)                                            93740022
         DC    AL1(TPWRACK)                                             93742022
         SPACE                                                          93744022
TCCONCW  EQU   *                                                        93746022
         DC    AL2(TCCONRT-ORGRTN)                                      93748022
         DC    AL1(CCWTIC)                                              93750022
         DC    AL1(TPNULL)                                              93752022
         SPACE                                                          93754022
RDEOBCW  EQU   *                                                        93756022
         DC    AL2(RDEOBRT-ORGRTN)                                      93758022
         DC    AL1(CCWREAD)                                             93760022
         DC    AL1(TPRDRPEB)                                            93762022
         SPACE                                                          93764022
         AIF   ('&GEN' EQ 'STSP').L62C                                  93766022
         AIF   ('&GEN' EQ 'MINI').L63                                   93768022
         AIF   ('&GEN' EQ 'QTAM').L62C                         @OZ28818 93770082
WRENQCW  EQU   *                                                        93772022
         DC    AL2(WRENQRT-ORGRTN)                                      93774022
         DC    AL1(CCWWRITE)                                            93776022
         DC    AL1(TPWRENQ)                                             93778022
         SPACE                                                          93780022
RSPENQCW EQU   *                                                        93782022
         DC    AL2(RDRSPEQ-ORGRTN)                                      93784022
         DC    AL1(CCWREAD)                                             93786022
         DC    AL1(TPRSPENQ)                                            93788022
RDLCOUT  EQU   *                                                        93790022
         DC    AL2(RDLCRT-ORGRTN)                                       93792022
         DC    AL1(CCWREAD)                                             93794022
         DC    AL1(TPRDLC)                                              93796022
         SPACE                                                          93798022
WRDLETCW EQU   *                                                        93800022
         DC    AL2(WRDLETRT-ORGRTN)                                     93802022
         DC    AL1(CCWWRITE)                                            93804022
         DC    AL1(TPWRDLET)                                            93806022
         SPACE                                                          93808022
RDIDENQ  EQU   *                                                        93810022
         DC    AL2(RDENQRT-ORGRTN)                                      93812022
         DC    AL1(CCWREAD)                                             93814022
         DC    AL1(TPRDIDNQ)            READ ID ENQ                     93816022
         SPACE                                                          93818022
WRTONECW EQU   *                                                        93820022
         DC    AL2(WRTONERT-ORGRTN)                                     93822022
         DC    AL1(CCWWRITE)                                            93824022
         DC    AL1(TPWRTONE)                                            93826022
RDIDAK   EQU   *                                                        93828022
         DC    AL2(RDIDRT-ORGRTN)                                       93830022
         DC    AL1(CCWREAD)                                             93832022
         DC    AL1(TPRDIDAK)                                            93832200
.L62C    ANOP                                                  @OZ28818 93832382
         SPACE 1                                               @OX14790 93832400
TCEOTCW  DC    AL2(TCEOTRT-ORGRTN)                             @OX14790 93832600
         DC    AL1(CCWTIC)                                     @OX14790 93832800
         DC    AL1(TPNULL)                                     @OX14790 93833000
         SPACE 1                                               @OX14790 93833200
         AIF   ('&GEN' EQ 'QTAM').L62B                         @OZ28818 93836082
WRWCCCW  DC    AL2(WRWCCRT-ORGRTN)                            S22028TSO 93838022
         DC    AL1(CCWWRITE)                                  S22028TSO 93840022
         DC    AL1(TPNULL)                                    S22028TSO 93842022
WRWCCC1  DC    AL2(WRWCCR1-ORGRTN)                              SA68050 93842505
         DC    AL1(CCWWRITE)                                    SA68050 93843005
         DC    AL1(TPNULL)                                      SA68050 93843505
RDWCCCW  DC    AL2(RDWCCRT-ORGRTN)                            S22028TSO 93844022
         DC    AL1(CCWREAD)                                   S22028TSO 93846022
         DC    AL1(TPRDRESP)                                   @YA10429 93848058
         AIF   ('&GEN' EQ 'BISC').L63                                   93852022
WRSMICW  DC    AL2(WRSMIRT-ORGRTN)                                  TSO 93854022
         DC    AL1(CCWWRITE)                                        TSO 93856022
         DC    AL1(TPNULL)                                          TSO 93858022
RDACKCW  DC    AL2(RDACKRT-ORGRTN)                                  TSO 93860022
         DC    AL1(CCWREAD)                                         TSO 93862022
         DC    AL1(TPRDRESP)                                   @YA10429 93864058
IHRSPCW  DC    AL2(RDRSPRT-ORGRTN)                                  TSO 93866022
         DC    AL1(CCWINHIB)                                        TSO 93868022
         DC    AL1(TPRDRESP)                                        TSO 93870022
.L62B    ANOP                                                    A48245 93872022
WRBRKCW  EQU   *                                                        93874022
         DC    AL2(BREAKCCW-ORGRTN)                                     93876022
         DC    AL1(CCWBREAK)                                            93878022
         DC    AL1(TPNULL)                                              93880022
.L63     ANOP                                                           93882022
RESETCCW EQU   *                                                        93884022
         DC    AL2(WREOTRT-ORGRTN)                                      93886022
         DC    AL1(CCWWRITE)                                            93888022
         DC    AL1(TPRESET)                                             93890022
         SPACE                                                          93892022
WRACKNAK EQU   *                                                        93894022
         DC    AL2(WRACKRT-ORGRTN)                                      93896022
         DC    AL1(CCWWRITE)                                            93898022
         DC    AL1(TPWRAKNK)                                            93900022
SELCTCW  EQU   *                                                 S99228 93902022
         DC    AL2(WRSEL-ORGRTN)                                 S99228 93904022
         DC    AL1(CCWSEL)                                       S99228 93906022
         DC    AL1(TPNULL)                                       S99228 93908022
         EJECT                                                          93910022
*                                                                       94000022
*        M O D E L S    C H A N N E L S    P R O G R A M                94002022
*                          T A B L E                                    94004022
*                                                                       94006022
*                                                                       94008022
*        THIS TABLE IS A SET OF SUBSETS                                 94010022
*        EACH SUBSET IS AN ELEMENT OF MODEL CHANNEL PROGRAM             94012022
*                                                                       94014022
*        THE LAST BYTE OF EACH SUBSET IS THE END ELEMENT X'FF'          94016022
*        (NOT NEEDED FOR THE LAST SUBSET OF A CHANNEL PROGRAM)          94018022
*                                                                       94020022
*        EACH ENTRY IN A SUBSET CONSISTS OF TWO BYTES.                  94022022
*    *** BYTE1   OFFSET IN EXPANDERS TABLE                              94024022
*    *** BYTE2     CCW/FLAGS  BYTE                                      94026022
*                                                                       94028022
         SPACE 3                                                        94030022
MODCCW   DS    0H                                                       94032022
MODCCW00 EQU   *                                                        94034022
         DC    AL1(RDSKPCW-ORGTB1)                                      94036022
         DC    XL1'B0'                                                  94038022
         DC    AL1(TCSKPCW-ORGTB1)                                      94040022
         DC    XL1'00'                                                  94042022
         DC    X'FF'                                                    94044022
         AIF   ('&GEN' EQ 'MINI').L42                                   94046022
         AIF   ('&GEN' EQ 'STSP').L41A                                  94048022
         AIF   ('&GEN' EQ 'QTAM').L41A                                  94050022
MODCCW01 EQU   *                                                        94052022
         DC    AL1(WRDLETCW-ORGTB1)                                     94054022
         DC    AL1(CCWCC+CCWSLI)                                        94056022
         DC    AL1(DISBLCW-ORGTB1)                                      94058022
         DC    AL1(CCWCC+CCWSLI)                                        94060022
         DC    AL1(DIALCW-ORGTB1)                                       94062022
         DC    AL1(CCWCC+CCWSLI)                                        94064082
         DC    X'FF'                                                    94064182
.L41A    ANOP                                                  @OZ28818 94064282
MODCCW75 EQU   *                                               @XA08073 94064400
         DC    AL1(WREOTCW-ORGTB1)                             @XA08073 94064600
         DC    AL1(CCWCC+CCWSLI)                               @XA08073 94064800
         DC    AL1(TCEOTCW-ORGTB1)                             @OX14790 94065000
         DC    XL1'00'                                         @OX14790 94065200
         DC    X'FF'                                           @XA08073 94066458
MODCCW02 EQU   *                                                        94070022
         DC    AL1(DISBLCW-ORGTB1)                                      94072022
         DC    XL1'60'                                                  94074022
         DC    AL1(DIALCW-ORGTB1)                                       94076022
         DC    XL1'60'                                                  94078022
         DC    XL1'FF'                                                  94080022
         AIF   ('&GEN' EQ 'STSP').L43                                   94082022
         AIF   ('&GEN' EQ 'QTAM').L43                                   94084022
MODCCW07 EQU   *                                                        94086022
         DC    AL1(WRDLETCW-ORGTB1)                                     94088022
         DC    AL1(CCWCC+CCWSLI)                                        94090022
MODCCW7B EQU   *                                                        94092022
         DC    AL1(DISBLCW-ORGTB1)                                      94094022
         DC    AL1(CCWCC+CCWSLI)                                        94096022
         DC    AL1(ENABLCW-ORGTB1)                                      94098022
         DC    AL1(CCWCC+CCWSLI)                                        94100022
         DC    X'FF'                                                    94102022
MODCCW7A EQU   *                                                        94104022
         DC    AL1(WRTONECW-ORGTB1)                                     94106022
         DC    AL1(CCWCC+CCWSLI)                                        94108022
         DC    X'FF'                                                    94110022
.L43     ANOP                                                           94112022
         AIF   ('&GEN' EQ 'BISC').L44                                   94114022
MODCCW08 EQU   *                                                        94116022
         DC    AL1(DISBLCW-ORGTB1)                                      94118022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94120022
         DC    AL1(ENABLCW-ORGTB1)                                      94122022
         DC    AL1(0)                   NO GLAGS                        94124022
         DC    XL1'FF'                                                  94126022
.L44     ANOP                                                           94128022
         AIF   ('&GEN' EQ 'STSP').L45                                   94130022
         AIF   ('&GEN' EQ 'QTAM').L45                                   94132022
MODCCW10 EQU   *                                                        94134022
         DC    AL1(RDIDENQ-ORGTB1)                                      94136022
         DC    AL1(CCWSLI)                                              94138022
         DC    X'FF'                                                    94140022
MODCCW11 EQU   *                                                        94142022
         DC    AL1(WRCPUCW-ORGTB1)                                      94144022
         DC    AL1(CCWCD+CCWSLI)                                        94146022
MODCCW12 EQU   *                                                        94148022
         DC    AL1(WRACKCW-ORGTB1)                                      94150022
         DC    AL1(CCWCC+CCWSLI)                                        94152022
         DC    AL1(TCBUFCW-ORGTB1)                                      94154022
MODCCW14 EQU   *                                                        94156022
         DC    AL1(WRCPUCW-ORGTB1)                                      94158022
         DC    AL1(CCWCD+CCWSLI)                                        94160022
MODCCW15 EQU   *                                                        94162022
         DC    AL1(WRENQCW-ORGTB1)                                      94164022
         DC    AL1(CCWCC+CCWSLI)                                        94166022
         DC    AL1(RDIDAK-ORGTB1)                                       94168022
         DC    AL1(0)                                                   94170022
         DC    X'FF'                                                    94172022
MODCCW16 EQU   *                                                        94174022
         DC    AL1(WREOTCW-ORGTB1)                                      94176022
         DC    AL1(CCWCC+CCWSLI)                                        94178022
MODCCW17 EQU   *                                                        94180022
         DC    AL1(RDENQCW-ORGTB1)                                      94182022
         DC    AL1(0)                                                   94184022
         DC    AL1(WRACKCW-ORGTB1)                                      94186022
         DC    AL1(CCWCC+CCWSLI)                                        94188022
         DC    AL1(TCBUFCW-ORGTB1)                                      94190022
.L45     ANOP                                                           94192022
         AIF   ('&GEN' EQ 'BISC').L46                                   94194022
MODCCW18 EQU   *                                                        94196022
         DC    AL1(WRCPUCW-ORGTB1)      WRTIE CPU ID                    94198022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94200022
         DC    AL1(RDRSPCW-ORGTB1)      READ RESPONSE                   94202022
         DC    AL1(CCWCD)                                               94204022
         DC    AL1(TCBUFCW-ORGTB1)                                      94206022
.L42     ANOP                                                           94208022
MODCCW20 EQU   *                                                        94210022
         DC    AL1(WREOTCW-ORGTB1)                                      94212022
         DC    XL1'60'                                                  94214022
MODCCW21 EQU   *                                                        94216022
         DC    AL1(PREPCW-ORGTB1)                                       94218022
         DC    XL1'60'                                                  94220022
         DC    AL1(SNSCW-ORGTB1)                                        94222022
         DC    XL1'60'                                                  94224022
         DC    AL1(RDRSPCW-ORGTB1)                                      94226022
         DC    AL1(CCWCD)                                               94228022
         DC    AL1(TCBUFCW-ORGTB1)                                      94230022
         AIF   ('&GEN' NE '').L47                                       94232022
.L46     ANOP                                                           94234022
MODCCW22 EQU   *                        BSC POINT - POINT               94236022
         DC    AL1(PREPCW-ORGTB1)                                       94238022
         DC    XL1'60'                                                  94240022
         DC    AL1(RDENQCW-ORGTB1)      READ ENQ                        94242022
         DC    AL1(0)                   NO FLAGS                        94244022
         DC    AL1(WRACKCW-ORGTB1)      WRITE ACK                       94246022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94248022
         DC    AL1(TCBUFCW-ORGTB1)                                      94250022
.L47     ANOP                                                           94252022
         AIF   ('&GEN' EQ 'MINI').Z8                                    94254022
MODCCW26 EQU   *                        AUTOPOLL  CCW'S                 94256022
         DC    AL1(WREOTCW-ORGTB1)                                      94258022
         DC    XL1'60'                                                  94260022
         DC    AL1(POLLCW-ORGTB1)                                       94262022
         DC    XL1'60'                                                  94264022
         DC    AL1(TCPOLCW-ORGTB1)                                      94266022
         DC    XL1'00'                                                  94268022
         DC    AL1(TCRDXCW-ORGTB1)                                      94270022
         DC    XL1'00'                                                  94272022
         DC    AL1(POLLCW-ORGTB1)                                       94274022
         DC    XL1'60'                                                  94276022
         DC    AL1(TCPOLCW-ORGTB1)                                      94278022
         DC    XL1'00'                                                  94280022
         DC    AL1(RDRSPCW-ORGTB1)                                      94282022
         DC    XL1'80'                                                  94284022
         DC    AL1(TCBUFCW-ORGTB1)                                      94286022
.Z8      ANOP                                                           94288022
MODCCW28 EQU   *                        MULTIPT READ INT.               94290022
         DC    AL1(WREOTCW-ORGTB1)                                      94292022
         DC    AL1(CCWCC+CCWSLI)                                        94294022
         DC    AL1(WRPOLCW-ORGTB1)                                      94296022
         DC    XL1'60'                                                  94298022
         DC    AL1(RDRSPCW-ORGTB1)                                      94300022
         DC    XL1'80'                                                  94302022
         DC    AL1(TCBUFCW-ORGTB1)                                      94304022
MODCCW29 EQU   *                                                        94306022
         AIF   ('&GEN' EQ 'BISC').L46A                                  94308022
         SPACE 1                                                        94310022
         DC    AL1(NOPCCW-ORGTB1)                                       94312022
         DC    AL1(CCWCC+CCWSLI)                                        94314022
         DC    X'FF'                                                    94316022
.L46A    ANOP                                                           94318022
         SPACE 1                                                        94320022
MODCCW30 EQU   *                                                        94322022
         DC    AL1(WRIDLCW-ORGTB1)                                      94324022
         DC    AL1(CCWCD+CCWSKIP)       FLAGS FOR WRITE IDLES           94326022
         DC    XL1'FF'                                                  94328022
         AIF   ('&GEN' EQ 'BISC').L48                                   94330022
         AIF   ('&GEN' EQ 'MINI').L49A                                  94332022
MODCCW32 EQU   *                                                        94334022
         DC    AL1(RDTERMCW-ORGTB1)                                     94336022
         DC    XL1'20'                                                  94338022
         DC    X'FF'                                                    94340022
.L48     ANOP                                                           94342022
MODCCW36 EQU   *                                                        94346022
         DC    AL1(WRPADCW-ORGTB1)                                      94348022
         DC    XL1'80'                                                  94350022
         DC    XL1'FF'                                                  94352022
         AIF   ('&GEN' EQ 'BISC').L50                                   94354022
.L49     ANOP                                                           94356022
MODCCW38 EQU   *                        START STOP CONTENTION-WRITE     94364022
         DC    AL1(WREOACW-ORGTB1)                                      94366022
         DC    AL1(CCWCD)                                               94368022
         DC    AL1(TCIDLCW-ORGTB1)                                      94370022
.L49A    ANOP                                                           94372022
MODCCW39 EQU   *                                                        94374022
         DC    AL1(WREOTCW-ORGTB1)                                      94376022
         DC    AL1(CCWCD+CCWSLI)                                        94378022
         DC    AL1(WREOACW-ORGTB1)                                      94380022
         DC    AL1(CCWCD+CCWSLI)                                        94382022
         DC    AL1(WRPADCW-ORGTB1)                                      94384022
         DC    AL1(CCWCD+CCWSLI)                                        94386022
         DC    AL1(TCIDLCW-ORGTB1)                                      94388022
         AIF   ('&GEN' NE '').L51                                       94390022
.L50     ANOP                                                           94392022
MODCCW40 EQU   *                        PT - PT BSC WRITE INITIAL       94394022
         DC    AL1(WRENQCW-ORGTB1)                                      94396022
         DC    AL1(CCWCC+CCWSLI)                                        94398022
         DC    AL1(RSPENQCW-ORGTB1)                                     94400022
         DC    AL1(0)                                                   94402022
MODCCW41 EQU   *                                                        94404022
         DC    AL1(WRADRCW-ORGTB1)                                      94406022
         DC    AL1(CCWCC+CCWSLI)                                        94408022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94410022
         DC    AL1(0)                   NO FLAGS                        94412022
         DC    X'FF'                                                    94414022
         AIF   ('&GEN' EQ 'BISC').L52                                   94416022
.L51     ANOP                                                           94418022
         AIF   ('&GEN' EQ 'MINI').L53                                   94420022
MODCCW42 EQU   *                                                        94422022
         DC    AL1(WRPADCW-ORGTB1)                                      94424022
         DC    AL1(CCWCD+CCWSLI)                                        94426022
         DC    AL1(WREOTCW-ORGTB1)                                      94428022
         DC    AL1(CCWCD+CCWSLI)                                        94430022
         DC    AL1(WRADRCW-ORGTB1)                                      94432022
         DC    AL1(CCWCC+CCWSLI)                                        94434022
         DC    AL1(WTTRSPCW-ORGTB1)                                     94436022
         DC    AL1(0)                                                   94438022
         DC    AL1(WREOACW-ORGTB1)                                      94440022
         DC    AL1(CCWCD+CCWSLI)                                        94442022
         DC    AL1(TCIDLCW-ORGTB1)                                      94444022
         AIF   ('&GEN' EQ 'STSP').L53                                   94446022
         AIF   ('&GEN' EQ 'QTAM').L53                                   94448022
.L52     ANOP                                                           94450022
MODCCW43 EQU   *                                                        94452022
         DC    AL1(WRENQCW-ORGTB1)                                      94454022
         DC    AL1(CCWCC+CCWSLI)                                        94456022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94458022
         DC    AL1(0)                                                   94460022
         DC    X'FF'                                                    94462022
.L53     ANOP                                                           94464022
MODCCW44 EQU   *                        MULTI-POINT WRITE INITIAL       94466022
         DC    AL1(WREOTCW-ORGTB1)                                      94468022
         DC    AL1(CCWCC+CCWSLI)                                        94470022
         DC    AL1(WRADRCW-ORGTB1)                                      94472022
         DC    XL1'60'                                                  94474022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94476022
         DC    AL1(0)                   INTERRUPT ON RESPONSE           94478022
MODCCW62 EQU   *                                                        94480022
         DC    AL1(WREOACW-ORGTB1)                                      94482022
         DC    XL1'80'                                                  94484022
         DC    AL1(TCIDLCW-ORGTB1)                                      94486022
         AIF   ('&GEN' EQ 'STSP').L54                                   94488022
         AIF   ('&GEN' EQ 'MINI').L54                                   94490022
         AIF   ('&GEN' EQ 'QTAM').L54                                   94492022
MODCCW45 EQU   *                                                        94494022
         DC    AL1(WRACKNAK-ORGTB1)                                     94496022
         DC    AL1(CCWCC+CCWSLI)                                        94498022
         DC    AL1(RDLCOUT-ORGTB1)                                      94500022
         DC    AL1(CCWCD)                                               94502022
         DC    AL1(TCCONCW-ORGTB1)                                      94504022
.L54     ANOP                                                           94506022
MODCCW46 EQU   *                                                        94508022
         DC    AL1(WRACKNAK-ORGTB1)                                     94510022
         DC    XL1'60'                  FLAGS                           94512022
         DC    AL1(TCCONCW-ORGTB1)                                      94514022
         AIF   ('&GEN' EQ 'MINI').L55                                   94516022
         AIF   ('&GEN' EQ 'STSP').L55                                   94518022
         AIF   ('&GEN' EQ 'QTAM').L55                                   94520022
         SPACE                                                          94522022
MODCCW48 EQU   *                                                        94524022
         DC    AL1(RDEOBCW-ORGTB1)                                      94526022
         DC    AL1(0)                   NO FLGS                         94528022
         DC    X'FF'                                                    94530022
MODCCWFS EQU   * .                                               S22026 94532022
         DC    AL1(WREOTCW-ORGTB1) .   WRITE EOT FOR SELECTION   S22026 94534022
         DC    AL1(CCWCC+CCWSLI) .                               S22026 94536022
         DC    AL1(WRADRCW-ORGTB1) .   WRITE ADDRESSING CHARS    S22026 94538022
         DC    XL1'60' .                                         S22026 94540022
         DC    AL1(TCIDLCW-ORGTB1) .   TIC TO WRITE IDLES        S22026 94542022
         DC    X'FF' .                                           S22026 94544022
.L55     ANOP                                                           94546022
         AIF   ('&GEN' EQ 'BISC').LB                                    94548022
MODCCW50 EQU   *                                                        94550022
         DC    AL1(RDEOBCW-ORGTB1)                                      94552022
         DC    X'60'                    FLAGS                           94554022
         DC    AL1(TCCONCW-ORGTB1)                                      94556022
.LB      ANOP                                                           94558022
         SPACE 1                                                        94560022
MODCCW51 EQU   *                                                        94562022
         DC    AL1(WREOTCW-ORGTB1)                                      94564022
         DC    AL1(CCWCD+CCWSLI)                                        94566022
         DC    AL1(WRADRCW-ORGTB1)                                      94568022
         DC    AL1(CCWCC+CCWSLI)                                        94570022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94572022
         DC    AL1(0)                                                   94574022
         DC    X'FF'                                                    94576022
         AIF   ('&GEN' EQ 'BISC').L56                                   94578022
         AIF   ('&GEN' EQ 'MINI').L56                                   94580022
         AIF   ('&GEN' EQ 'QTAM').L56                                   94582022
         SPACE 1                                                        94584022
MODCCW52 EQU   *                                                    TSO 94586022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94588022
         DC    XL1'60'                                              TSO 94590022
MODCCW54 EQU   *                                                        94592022
         DC    AL1(PREPCW-ORGTB1)                                       94594022
         DC    X'60'                                                    94596022
         DC    AL1(SNSCW-ORGTB1)                                        94598022
         DC    XL1'60'                                                  94600022
         DC    AL1(IHRSPCW-ORGTB1)                                      94602022
         DC    XL1'80'                                                  94604022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94606022
.L56     ANOP                                                           94608022
MODCCW56 EQU   *                                                        94610022
         DC    AL1(WRACKNAK-ORGTB1)                                     94612022
         DC    AL1(0)                   NO FLGAS                        94614022
         DC    X'FF'                                                    94616022
         AIF   ('&GEN' EQ 'BISC').L57                                   94618022
MODCCW58 EQU   *                                                        94620022
         DC    AL1(WREOACW-ORGTB1)                                      94622022
         DC    AL1(CCWCC+CCWSLI)                                        94624022
         DC    X'FF'                                                    94626022
.L57     ANOP                                                           94628022
MODCCW60 EQU   *                                                        94630022
         DC    AL1(WRACKCW-ORGTB1)                                      94632022
         DC    AL1(CCWCC+CCWSLI)                                        94634022
         DC    X'FF'                                                    94636022
         AIF   ('&GEN' EQ 'MINI').M7                                    94638022
MODCCW63 EQU   *                                                        94640022
         DC    AL1(WRCPUCW-ORGTB1)                                      94642022
         DC    AL1(CCWCC+CCWSLI)                                        94644022
.M7      ANOP                                                           94646022
MODCCW64 EQU   *                                                        94648022
         DC    AL1(RDRSPCW-ORGTB1)                                      94650022
         DC    AL1(CCWCD+CCWSLI)                                        94652022
         DC    AL1(TCBUFCW-ORGTB1)                                      94654022
         AIF   ('&GEN' EQ 'BISC').LD                                    94656022
         AIF   ('&GEN' EQ 'MINI').LD                                    94658022
         AIF   ('&GEN' EQ 'QTAM').LD                                    94660022
         SPACE                                                          94662022
MODCCW19 EQU   *                                                        94664022
         DC    AL1(WRCPUCW-ORGTB1)                                      94666022
         DC    AL1(CCWCC+CCWSLI)                                        94668022
         DC    AL1(IHRSPCW-ORGTB1)                                      94670022
         DC    AL1(CCWCD)                                               94672022
         DC    AL1(TCBUFCW-ORGTB1)                                      94674022
MODCCW70 EQU   *                                                    TSO 94676022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94678022
         DC    XL1'60'                                              TSO 94680022
         DC    AL1(PREPCW-ORGTB1)                                   TSO 94682022
         DC    XL1'60'                                              TSO 94684022
         DC    AL1(WRPADCW-ORGTB1)                                  TSO 94686022
         DC    XL1'80'                                              TSO 94688022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94690022
MODCCW90 EQU   *                                                    TSO 94692022
         DC    AL1(WRSMICW-ORGTB1)                                  TSO 94694022
         DC    XL1'60'                                              TSO 94696022
         DC    AL1(RDACKCW-ORGTB1)                                  TSO 94698022
         DC    XL1'60'                                              TSO 94700022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94702022
         DC    XL1'60'                                              TSO 94704022
         DC    AL1(WRPOLCW-ORGTB1)                                  TSO 94706022
         DC    XL1'60'                                              TSO 94708022
         DC    AL1(RDRSPCW-ORGTB1)                                  TSO 94710022
         DC    XL1'80'                                              TSO 94712022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94714022
MODCCW91 EQU   *                                                    TSO 94716022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94718022
         DC    AL1(CCWCC+CCWSLI)                                    TSO 94720022
         DC    AL1(WRPOLCW-ORGTB1)                                  TSO 94722022
         DC    XL1'60'                                              TSO 94724022
         DC    AL1(IHRSPCW-ORGTB1)                                  TSO 94726022
         DC    XL1'80'                                              TSO 94728022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94730022
MODCCW92 EQU   *                                              S22028TSO 94732022
         DC    AL1(WRWCCCW-ORGTB1)                            S22028TSO 94734022
         DC    XL1'60'                                        S22028TSO 94736022
         DC    AL1(RDWCCCW-ORGTB1)                            S22028TSO 94738022
         DC    XL1'60'                                        S22028TSO 94740022
         DC    AL1(WREOTCW-ORGTB1)                            S22028TSO 94742022
         DC    AL1(0)                                         S22028TSO 94744022
         DC    X'FF'                                          S22028TSO 94746022
MODCCW93 DC    AL1(WRWCCC1-ORGTB1)                              SA68050 94746205
         DC    XL1'60'                                          SA68050 94746405
         DC    AL1(RDWCCCW-ORGTB1)                              SA68050 94746605
         DC    XL1'60'                                          SA68050 94746805
         DC    AL1(WREOTCW-ORGTB1)                              SA68050 94747005
         DC    AL1(0)                                           SA68050 94747205
         DC    X'FF'                                            SA68050 94747405
.LD      ANOP                                                           94748022
MODCCW72 EQU   *                                                        94750022
         DC    AL1(RESETCCW-ORGTB1)                                     94752022
         DC    AL1(0)                                                   94754022
         DC    X'FF'                                                    94756022
         AIF   ('&GEN' EQ 'MINI').L4R5                         @YA03846 94758056
MODCCW73 EQU   *   3270 LOCAL READ CHANNEL PROGRAM               S99228 94760022
         DC    AL1(SELCTCW-ORGTB1)                               S99228 94762022
         DC    AL1(CCWCC+CCWSLI)                                 S99228 94764022
         DC    AL1(TCBUFCW-ORGTB1)                               S99228 94766022
MODCCW74 EQU   *   3270 LOCAL WRITE CHANNEL PROGRAM              S99228 94768022
         DC    AL1(SELCTCW-ORGTB1)                               S99228 94770022
         DC    AL1(CCWCC+CCWSLI)                                 S99228 94772022
         DC    X'FF'                                             S99228 94774022
.L4R5    ANOP                                                           94776022
IOGENEND EQU   *                        END OF IOGENER CODE     OY00451 94777005
         EJECT                                                          94778022
*        DCBD  DSORG=TX                                                 95000022
         DCBD  DSORG=TX                                                 95001022
         EJECT                                                          95002022
*        TAVTD                                                          95003022
         TAVTD                                                          95004022
         EJECT                                                          95005022
*        TCCWD                                                          95006022
         TCCWD                                                          95007022
         EJECT                                                          95008022
*        TDEBD                                                          95009022
         TDEBD                                                          95010022
         EJECT                                                          95011022
*        TDISPD                                                         95012022
         TDISPD                                                         95013022
         EJECT                                                          95014022
*        TLCBD                                                          95015022
         TLCBD                                                          95016022
         EJECT                                                          95017022
*        TPRFD                                                          95018022
         TPRFD                                                          95019022
         EJECT                                                          95020022
*        TPRIOR                                                         95021022
         TPRIOR                                                         95022022
         EJECT                                                          95023022
*        TQCBD                                                          95024022
         TQCBD                                                          95025022
         EJECT                                                          95026022
*        TQCBED                                                         95027022
         TQCBED                                                         95028022
         EJECT                                                          95029022
*        TSCBD                                                          95030022
         TSCBD                                                          95031022
         EJECT                                                          95032022
*        TSTCBD                                                         95033022
         TSTCBD                                                         95034022
         EJECT                                                          95035022
*        TTSID                                                          95036022
         TTSID                                                          95037022
         EJECT                                                          95038022
*        TTNTD                                                          95039022
         TTNTD                                                          95040022
         EJECT                                                          95041022
*        TTPD                                                           95042022
         TTPD                                                           95043022
         EJECT                                                          95044022
*        TTRMD                                                          95045022
         TTRMD                                                          95046022
         MEND                                                           95260022
./  ADD  SSI=81350330,NAME=LINEEND
         MACRO                                                          00020022
&NAME    LINEEND  &GEN=                                                 00022022
.*CHANGE ACTIVITY= AS FOLLOWS:                                   S21903 00024022
.*A104830-104950,107200-107330,312650                            S22027 00025022
.*A027410-027500,117820-118160,155420-155520,189010-189160       S99228 00025122
.*A199020-199140,297410-297580,298400-299400,334840-334960       S99228 00025222
.*A411810,411900                                                 S99228 00025322
.*C127600-128000                                                 S99228 00025422
.*C330000-330400,429800-429980,700000-702160,719400-719580       S99228 00025522
.*A302610-302700,351620-351740,489610-489700,291210-591320       S22029 00025622
.*C411300,657400,683800-684600                                   S22029 00025722
.*A052650-052750,058610-058720,073230-073350                     S22028 00025822
.*A481000                                                        A42376 00025922
.*C030400,461600,481600-482600,484600                            A42376 00026022
.*A589000                                                         M6293 00026122
.*C030400                                                         M6293 00026222
.*A057800,164600,167800,250600,260800,275400,280000,280900       S21101 00026322
.*A350600,393800,505600,549200,653000,657400                     S21101 00026422
.*C030400,106800,129600-134400,141400-141600,151400              S21101 00026522
.*C162600-162800,166200-166400,184600-184800,204200,204800       S21101 00026622
.*C205200-205600,218800,238200-238800,288000,341600,355400       S21101 00026722
.*C368200-368600,398400-398800,399600,400400,432600              S21101 00026822
.*C489800-490200,490400-491400,492000,505400,508800              S21101 00026922
.*C524000-525000,529000-530200,603600,651200,653800-654600       S21101 00027022
.*C716600                                                        S21101 00027122
.*A040000,420600                                                  M5953 00027422
.*C030400,040000                                                  M5953 00027522
.*C030400,216400                                                SA51068 00027622
.*A310000,430000                                                SA44892 00027722
.*C030400,489800-501200,512600-517400                           SA44892 00027822
.*A283000,598400                                                SA44983 00027922
.*C599000-601600                                                SA44983 00028022
.*C030400,645200                                                SA44894 00028122
.*A238200,454200,581800,669200,671000,671400,671800,674400       S22025 00028222
.*A676200,685000,686000,689800,690600,691200                     S22025 00028322
.*C029200,055000-055200,129200-134800,242800-246000              S22025 00028422
.*C300800-301000,335000,412000,489600,490600-490620,490740       S22025 00028522
.*C492800,504800,580600-581000,584000,587200-587600              S22025 00028622
.*C589198-589266,594200,671800,672000,674200,685200              S22025 00028722
.*C719700-719750                                                 S22025 00028822
.*D037600,111400,118000,145200-147200,298400-298800              S22025 00028922
.*D357000-357200,411400,490810-490870,585800-586400              S22025 00029022
.*D598400-598800,670200-670400,674200                            S22025 00029122
.*A034800,207800,275200,297800,312600,315800,327600,330400       S22026 00029222
.*A336600,346000,347000,351400,352600,356800,452600,522400       S22026 00029322
.*A654800,692200,692400,700200                                   S22026 00029422
.*C357000-357200,522600-522800                                   S22026 00029522
.*D145200-147200,291000,656600                                   S22026 00029622
.*A446800                               MODIFIED 11/15/71        A42413 00030522
.*A022000,368200,369400,380400,719600                           SA48278 00030622
.*A593000                                                       SA49233 00030722
.*A369500,719630                                                SA51061 00030822
.*C368650                                                       SA51061 00030922
.*A448000                               MODIFIED 12/02/71        A42413 00031022
.*A448180                                                         M2561 00031122
.*C030400                                                         M2561 00031222
.*D447600,447800                                                  M2561 00031322
.*C663200,664000                                                SA51097 00031422
.*C104600                                                       SA51791 00031522
.*A366800                                                       SA52517 00031622
.*C466800,467800,468200,468600                                  SA54276 00031722
.*A469800                                                       SA55941 00031822
.*A086220,097620,168010,176007                                  SA48276 00032022
.*D168610-168710                                                SA48276 00032122
.*A228040                                                       SA50194 00032222
.*A022000,064000,119600                                         SA51090 00032322
.*C118200-118400,120400,702010                                  SA51090 00032422
.*D119000                                                       SA51090 00032522
.*A689040                                                       SA52946 00032622
.*C172600,173400,413400,414400,A414500                          SA54923 00032722
.*A000200,002000,616800,618400                                  SA56617 00032822
.*C000400,000410-000426,000600-000800,001000,615200-615400      SA56617 00032922
.*D002200-019600                                                SA56617 00033022
.*A038410                                                       SA56915 00033122
.*C384200                                                       SA57329 00033222
.*A049060-049120                                                 A56906 00033322
.*C049000                                                        A56906 00033422
.*A162000,692200,692400                                          S99244 00033522
.*C149400,22220                                                  S99244 00033622
.*C466800,467800,468200,468600                                  SA54276 00033722
.*A469950,477000,477600                                         SA57685 00034122
.*C477000                                                       SA57685 00034222
.*C228040                                                       SA58997 00034322
.*D591203-591206,591230                                         SA59020 00034422
.*D521800-522400,523000,705400                                   S21903 00034522
.*A547600                                                       SA57695 00034622
.*C470000,547800,552200                                         SA57695 00034722
.*D552600-555000                                                SA57695 00034822
.*A469950                                                       SA59538 00034922
.*C466000                                                       SA59538 00035022
.*C062600                                                       SA59027 00035122
.*C061000,086300-086301,097680,301800,335200,411775-411795      SA59028 00035222
.*C411806-411810,451400,719560                                  SA59028 00035305
.*A125400                                                       SA59992 00035405
.*A117800                                                       SA61780 00035505
.*D121400                                                       SA61780 00035605
.*A199080                                                       SA62341 00035705
.*A311800                                                       SA61094 00035805
.*C046000                                                       SA62408 00035905
.*D432926                                                       SA62383 00036005
.*A608400                                                       SA62329 00036105
.*C609200,609800-610000                                         SA62329 00036205
.*451480                                                        SA62984 00036305
.*A172400                                                       SA61779 00036405
.*C058710                                                       SA61779 00036505
.*A411830                                                       SA63959 00036605
.*D411809-411812                                                SA63959 00036705
.*A036200                                                       SA65392 00036854
.*A398610,720091                                                SA62991 00036954
.*D 300600                                                      SA61794 00037054
.*C 301200-301900                                               SA61794 00037154
.*A049000                                                       SA64676 00037254
.*A634800,643000                                                SA65359 00037354
.*C618470-618480                                                SA65359 00037454
.*A701740,701800                                                SA65374 00037554
.*A471600,472000                                                SA65357 00037654
.*A700010,700900                                                SA65397 00037754
.*A613000                                                       OX02181 00037854
.*D613800                                                       OX02181 00037954
.*C569600-569800                                                SA65389 00038054
.*C398510                                                       SA66594 00038154
.*A577800                                                       SA65865 00038254
.*D577000-577200                                                SA65865 00038354
.*A376000                                                       SA65387 00038454
.*D376800                                                       SA65387 00038554
.*A115200                                                       SA66616 00038654
.*A035200                                                       SA65906 00038754
.*D689001-689002                                                SA66937 00038854
.*A007600,054800,414400,415000,418200,455000,702800,710810       X01004 00038954
.*C030800-034400,054800,124440,137800,179000,275500,             X01004 00039054
.*C291200-291400,300000-300400,352000-352400,352800,358000,      X01004 00039154
.*C398730,413200-414400,414600-415000,432930,534600-536400,      X01004 00039254
.*C655660                                                        X01004 00039354
.*D006000-006400,022050,034600,055000-055090,124600-124800,      X01004 00039454
.*D138000,179200-179400,291600-291800,300600-300630,353000,      X01004 00039554
.*D358200,453200-453800,455200,536600,537400-537600              X01004 00039654
.*A000000                                                        Y01948 00039754
.*C035400,054012,054168,107203,107243,118080,127600,282000,      Y01948 00039854
.*C282800,293000,315870,327685,341780,354100,378200,385600,      Y01948 00039954
.*C395600,404600,405400,420600,443600,444200,587800,592600,      Y01948 00040054
.*C655800,698600-698800,701054,701057                            Y01948 00040154
.*D000200-000240,035600,054013-054014,                           Y01948 00040254
.*D054175-054182,118100-118120,127800-128000,282200,284800,      Y01948 00040354
.*D293200-293400,315880-315910,327690-327695,341784-341788,      Y01948 00040454
.*D354120-354140,376600,378400-378600,385800-386000,             Y01948 00040554
.*D395800-396000,404800-405000,405600-405800,420640-420680,      Y01948 00040654
.*D443800-444000,444400-444600,588000-588200,592800-593000,      Y01948 00040754
.*D656000-656200,698200,701055,701058-701059                     Y01948 00040854
.*A025600,036000,036220,049200,488800,702020,702030,720091       X02004 00040954
.*C030960-034160,035400,036000,064060,120456,294920,             X02004 00041054
.*C300400,300740,368300,489490,489550,589163-589165,589179,      X02004 00041154
.*C589181,720000                                                 X02004 00041254
.*D021000,030800-030840,034180-034920,294930,300900-301000,      X02004 00041354
.*D488800-489070,489200,489600                                   X02004 00041454
.*C418296,418300                                                 Y00482 00041554
* A580200                                                       SA66604 00041605
* C301350-301920                                                SA66604 00041705
* C329780                                                       SA66598 00041805
* A700340                                                       SA65428 00041905
* D700370                                                       SA65428 00042005
* A432799                                                       SA65874 00042105
* A700880                                                       SA66946 00042205
* A330020,330146,348000                                         SA66632 00042305
* C057800,111200-112400                                         SA67139 00042405
* A110600                                                       S167139 00042505
* D686100,686150                                                SA62379 00042605
* A411720                                                       SA63595 00042705
* D411760-411765                                                SA63595 00042805
* A056200                                                       OX03963 00042905
* A701057                                                       OX03941 00043005
* A101600                                                       OY00507 00043105
* A054021,054189                                                OY03460 00043205
* D053800-054000                                                OY03460 00043305
* C330480-330500                                                SA68026 00043405
* A236600,297000,428600                                         SA68035 00043505
* A168600                                                       SA69087 00043605
* D172500                                                       SA69087 00043705
* A301290                                                       SA64386 00043805
* 376400                                                       @YA04894 00043961
* C113400                                                      @SA70316 00044061
* C484720                                                      @SA70874 00044161
* A552300                                                      @SA69964 00044261
* A204000                                                      @SA69968 00044361
* C678600                                                      @ZO2X6I0 00044461
*A483600                                                       @SA71694 00044561
*C411830                                                       @SA71658 00044661
*A327000                                                       @SA71963 00044761
*A279000                                                       @SA71490 00044861
*A137200                                                       @SA61090 00044961
*C036070-036090,036095                                         @ZA02096 00045061
*A049320                                                       @ZA02096 00045161
*C449630                                                       @ZA02095 00045261
*A720151                                                       @ZA02095 00045361
*A279600                                                       @YA06316 00045461
*C330148                                                       @YA06327 00045561
*A118080                                                       @YA06889 00045661
*A633600                                                       @XA07517 00046600
*A117860,118080,124400,580320,587800                           @SA62375 00047600
*C149400-149800,222200                                         @SA72446 00048600
*A577800                                                       @XA06335 00049600
*A469800,469950                                                @YA08108 00050600
*C196800                                                       @YA06307 00051600
*A575800,577817                                                @YA05167 00052600
*C577801,577803-577808,577811-577812,577920                    @YA05167 00053600
*A477600                                                       @SA73826 00054600
*D137300                                                       @SA73574 00055600
*A137400                                                       @SA73574 00056600
*C214000                                                       @SA74852 00057600
*A117810                                                       @SA74852 00058600
*C547920                                                       @SA74852 00059600
*D348050,348150                                                @XA09327 00060600
*A373600                                                       @XA09327 00061600
*C049330,049360                                                @ZA03108 00062600
*A646600                                                       @YA09751 00063600
*D117863-117866,C119400,A119400,A118100                        @YA10052 00064600
*A577950,D577801-577823                                        @YA10237 00065600
*C312000-312200                                                @SA75453 00066600
*A162550,163000                                                @YA10410 00067600
*A118600,A120470                                               @YA10673 00068600
*C196800-196950                                                @SA75722 00069600
*C118100                                                       @YA10695 00070600
*C048400                                                       @SA75471 00071600
*A149000                                                       @YA11157 00072600
*D149600                                                       @YA11157 00073600
*C503900-505200                                                @XA11311 00074600
*C312200,312260                                                @YA11162 00075600
*D433066-436600,D275600,D347400,D599000,D342400                @YA11151 00076600
*C560000                                                       @XA11338 00077600
*A190800                                                       @YA11495 00078600
*C503900                                                       @OS76474 00079600
*C429900-429960                                                @OS76301 00079791
*A119200,A119600                                               @OY11504 00079891
*D054009-054011                                                @OS76307 00079991
*A316800                                                       @OS76271 00080091
*A111000                                                       @OY11520 00080191
*A162099,C222200                                               @OS76283 00080291
*C428680                                                       @OY11499 00080391
*C411735,D411766-411767                                        @OS76490 00080491
*C188600                                                       @OY12393 00080591
*D376100                                                       @OS76479 00080691
*C162570                                                       @OY12287 00080791
*D163020-163160                                                @OY12287 00080891
*D196820-196960                                                @OY12287 00080991
*A339600,D340200-340800,C342000,C344600,D345000-345400,C346100 @OZ07786 00081091
*A250800,C251800-252000                                        @OY10984 00081191
*A374200                                                       @OX11954 00081291
*C519000-519800                                                @OY11983 00081391
*A023000,603700,653120,710850                                  @XA08073 00081491
*C162090,603600,653100,657580-657730                           @XA08073 00081591
*A204130                                                       @OZ09265 00081691
*D190840,190960                                                @OS76981 00081791
*C330280,330286,A330290                                        @OX12505 00081891
*C353800                                                       @OX12508 00081991
*C621400                                                       @OX12509 00082091
*C187000                                                       @OS76996 00082191
*A246800                                                       @OY12676 00082291
*A689800                                                       @OX12511 00082391
*A120568                                                       @OZ09957 00082491
*A310200,C311870-311890                                        @OZ09279 00082591
*C353800                                                       @OY13656 00082691
*A166200                                                       @OX12567 00082791
*C643040                                                       @OZ08362 00082891
*D643120                                                       @OY13667 00082991
*C621400                                                       @OZ08362 00083091
*A058800                                                       @OS77837 00083191
*D201800-202000,208400-208600                                  @OY14092 00083291
*A232000                                                       @OS77835 00083391
*A086200,408400,C270600-270800,431400,D409400,A097720          @OY14057 00083491
*D250810-250900,251820-252090,C086300-086320                   @OY14057 00083591
*C398650-398700                                                @OX12579 00083691
*A207200,C657614-657668                                        @OY13632 00083791
*A376000                                                       @OS77376 00083891
*A493000                                                       @OX14778 00083991
*A127350                                                       @OZ14176 00084091
*D127230-127350,A133200                                        @OZ14197 00084191
*A101640,A101700                                               @OS77954 00084291
*A683800,A694800                                               @OX14796 00084391
*C166215                                                       @OX16385 00084491
*D429900,429930                                                @OZ16530 00084591
*A432886                                                       @OS77965 00084691
*A029800,451480,C701954,702020                                 @OZ16540 00084791
*D035250,035300                                                @OX16693 00087791
*A235000                                                       @OX16686 00090791
*C133230-133320                                                @OZ17622 00093791
*A428685                                                       @OZ18753 00093891
*C101641                                                       @OS78332 00093991
*A270650                                                       @OX16703 00094091
* C001810,012000,035400,035600,454340,701404                   @G36XRIV 00098000
*D106800-107200,C107210-107220,162600,288000,A448920           @OX17153 00098100
*C036288,A036296,D101641-101655,D101710                        @OZ24288 00099100
*C225600                                                       @OX19180 00100100
*A127200                                                       @OZ25091 00100282
*D133220,133270                                                @OZ25091 00100382
*C230000                                                       @OS79864 00100482
*D493060-493120                                                @OZ25700 00100582
*D166203-166212,D166221                                        @OZ26326 00100682
*A451480                                                       @OZ25960 00100782
*A036288                                                       @OZ27868 00100882
.*A527200                                                      @OY19728 00100982
*A522909                                                       @OZ29663 00101082
*C216000                                                       @OY19793 00101182
*A451400                                                       @OX21187 00101282
*A693000                                                       @OZ30260 00101382
*A033800                                                       @OY20488 00101482
*C719428,719500                                                @OY20488 00101582
*A366200                                                       @OY20569 00101682
*C242800                                                       @OZ31566 00101782
.*****        DEVELOPMENT                                       ******* 00103554
.*A022460-022520,442600-444700,448186-448193,720160-720187       Y02027 00103606
.*C030860,030980                                                 Y02027 00103706
.*D033940,442600-445800,448020-448160,448186-448192              Y02027 00103806
*********************************************************************** 00120020
*                                                                     * 00121022
         TITLE '&NAME     LINE END APPENDAGE'                           00122022
&NAME    CSECT                                                          00123022
*                                                                     * 00124022
*********************************************************************** 00125022
*TITLE -- LINE END APPENDAGE                                          * 00140020
*                                                                     * 00160020
         AIF   ('&GEN' NE 'MINI').TAG1                                  00161022
*       MODULE NAME = IGG019Q4 (MINI)                                 * 00162022
         AGO   .TAG5                                                    00163022
.TAG1    AIF   ('&GEN' NE 'STSP').TAG2                                  00164022
*       MODULE NAME = IGG019Q3 (START/STOP)                           * 00165022
         AGO   .TAG5                                                    00166022
.TAG2    AIF   ('&GEN' NE 'BISC').TAG3                                  00167022
*       MODULE NAME = IGG019Q2 (BI-SYNC)                              * 00168022
         AGO   .TAG5                                                    00169022
.TAG3    AIF   ('&GEN' NE 'QTAM').TAG4                                  00170022
*       MODULE NAME = IGG019Q5 (QTAM)                                 * 00171022
         AGO   .TAG5                                                    00172022
.TAG4    AIF   ('&GEN' NE '').TAG5                                      00173022
*       MODULE NAME = IGG019R0 (BOTH)(BLANK)                          * 00174022
.TAG5    ANOP                                                           00175022
*                                                                     * 00176022
*       DESCRIPTIVE NAME = LINE END APPENDAGE                         * 00177022
*                                                                     * 00178022
*       COPYRIGHT = 'NONE'                                            * 00179022
*                                                                     * 00180022
*       STATUS: CHANGE LEVEL 10                                @G36XRIV 00181000
*                                                                     * 00200020
*FUNCTION -- AS A LOGICAL EXTENSION OF IOS LINE END APPENDAGE OBTAINS * 00220020
*   CONTROL WHEN AN I/O INTERRUPT OCCURS WITH ENDING STATUS, WHEN AN  * 00240020
*   ERROR IS DETERMINED TO BE PERMANENT BY ERP, OR WHEN AN ERROR IS   * 00260020
*   CLEARED BY ERP.                                                   * 00280020
*                                                                     * 00300020
*ENTRY POINTS -- FIRST EXECUTABLE INSTRUCTION                         * 00320020
*                                                                     * 00340020
*INPUT -- R2  IOB ADDRESS                                             * 00360020
*   R14 RETURN ADDRESS                                                * 00380020
*   R15 ENTRY POINT ADDRESS                                           * 00400020
*                                                                     * 00420020
*OUTPUT -- REGISTERS 0-9,14,15 REMAIN TRANSPARENT TO IOS UPON EXIT    * 00440020
*   FROM THIS MODULE                                                  * 00460020
*                                                                     * 00480020
*EXTERNAL ROUTINES --                                                 * 00500020
*   OS POST - TO POST MCP WAIT COMPLETE                               * 00520020
*                                                                     * 00540020
*   STAGE TWO OF EXIT EFFECTOR - TO SCHEDULE IQE                      * 00560020
*                                                                     * 00580020
*                                                                     * 00600020
*   'TCB REMOVAL ROUTINE' - TO MAKE MCP TCB NON-DISPATCHABLE FOR MP   * 00620020
*   65 ONLY.                                                          * 00640020
*                                                                     * 00660020
*   'IEDQKA02' - I/O GENERATOR SUBROUTINE TO BUILD CONTINUE CHANNEL   * 00680020
*   PROGRAMS.                                                         * 00700020
*                                                                     * 00720020
*   'IEDQTNT' - TO OBTAIN TERMINAL TABLE ENTRY ADDRESS FROM TNT OFFSET* 00740020
*                                                                     * 00760020
*   'IEAPTRV' - TO CONVERT REAL ADDRESS TO VIRTUAL               X01004 00766005
*                                                                X01004 00772005
*EXITS-NORMAL --                                                      * 00780020
*   B  4(14) - TO SKIP POST AND FREE REQUEST ELEMENT                  * 00800020
*   B  8(14) - TO RESTART A CHANNEL PROGRAM                           * 00820020
*                                                                     * 00840020
*EXITS-ERROR --                                                       * 00860020
*   BR  14 TO SCHEDULE ERP UPON 1ST DETECTION OF ERROR                * 00880020
*                                                                     * 00900020
*TABLES/WORK AREAS -- DSECTS OF CONTROL BLOCKS GENERATED BY MACROS:   * 00920020
*   TAVTD                                                             * 00940020
*   TLCBD                                                             * 00960020
*   TQCBD                                                             * 00980020
*   TTRMD                                                             * 01000020
*   TTSID                                                             * 01020020
*   TCCWD                                                             * 01040020
*   TSCBD                                                             * 01060020
*   TPRFD                                                             * 01080020
*   DCBD                                                              * 01100020
*   TRECBD                                                            * 01120020
*   TTNTD                                                             * 01140020
*   TDEBD                                                             * 01160020
*                                                                     * 01180020
*ATTRIBUTES -- REFRESHABLE, SUPERVISOR MODE, ENABLED.          @G36XRIV 01200000
*                                                                     * 01220020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 01240020
*   PARTICUALR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 01260020
*   SET.                                                              * 01280020
*                                                                     * 01300020
*   IF A PERMANENT ERROR HAS NOT OCCURRED, ENDING STATUS IS EXAMINED  * 01320020
*   TO DETERMINE IF ERP IS TO BE SCHEDULED.  UNUSUAL ENDING STATUS    * 01340020
*   RESULTS IN A RETURN TO IOS TO SCHEDULE THE FIRST LOA: OF ERP FOR  * 01360020
*   THIS DEVICE.                                                      * 01380020
*                                                                     * 01400020
*   WHEN ERP ACTION IS NOT REQUIRED, LINE END APPENDAGE OBTAINS THE   * 01420020
*   TP OP CODE FOR THE FAILING CCW BY USING THE ADDRESS IN THE CSW AS * 01440020
*   AN INDEX ARGUMENT INTO A LIST OF TP OP CODES (LCBTPCD).  THE TP   * 01460020
*   OP CODE IS USED AS AN INDEX INTO A BRANCH TABLE, TO TAKE          * 01480022
*   SPECIFIC ACTION FOR THIS INTERRUPT.  TWO TABLES ARE EMPLOYED.     * 01500020
*   ONE IS FOR NORMAL ENDING STATUS.  THE OTHER FOR ERROR CONDTIONS   * 01520020
*   DETTECTED BY ERP.                                                 * 01540020
*                                                                     * 01560020
*   FOR ERRORS THAT HAVE OCCURRED PRIOR TO TEXT TRANSFER, A ZERO      * 01580020
*   LENGTH BUFFER IS POSTED TO MH FOR INMSG/OUTMSG PROCESSING.        * 01600020
*                                                                     * 01620020
*   IF AN EOB INTERRUPT OCCURS WHILE RECEIVING A MESSAGE, A RESTART   * 01640020
*   IS MADE FROM THE APPENDAGE UNLESS MH PROCESSING IS REQUIRED.      * 01660020
*   WHEN EOT IS RECEIVED, THE FILLED BUFFER(S) ARE POSTED TO MH       * 01680020
*   INDICATING THAT THIS IS END OF MESSAGE.  FOR AN EOB INTERRUPT ON  * 01700020
*   OUTPUT, PREVIOUS BUFFERS ARE POSTED TO THE BUFFER RETURN QCB AND  * 01720020
*   A RESTART IS ACCOMPLISHED.  THE LAST BUFFER  OF A SUCCESSFULLY    * 01740020
*   SENT MESSAGE IS POSTED TO BUFFER DISPOSITION FOR OUTMSG EXITS.    * 01760020
*                                                                     * 01780020
*   IN THE EVENT OF A TEXT MODE ERROR, THE ABOVE ACTION IS TAKEN      * 01800020
*   EXCEPT THAT THE BUFFER REFLECTING THE INTERRUPT IS POSTED TO MH   * 01820020
*   TO OBSERVE USER SELECTED OPTIONS.                                 * 01840020
*                                                                     * 01860020
*   THE 'SCAN' ROUTINE IS ENTERED FROM PCI APPENDAGE AS WELL AS FROM  * 01880020
*   LINE END APPENDAGE.  ITS ADDRESS IS ALWAYS AT AN OFFSET OF 4 INTO * 01900020
*   THIS MODULE.  OPEN MOVES THIS ADDRESS INTO THE AVT FOR ACCESS BY  * 01920020
*   PCI APPENDAGE.                                                    * 01940020
*********************************************************************** 01960020
         EJECT                                                          01980020
         USING IEDQPRF,RPREFIX                                          02000020
         USING IEDQLCB,RLCB                                             02020020
         USING IEDQCCW,RCCW                                             02040020
         USING IEDQAVTD,RAVT                                            02060020
         USING IEDQSCB,RSCB                                             02080020
         USING IEDQLCBX,RE                                       S99228 02090022
*                                                                       02140020
*        REGISTER EQUATES                                               02160020
*                                                                       02180020
R0       EQU   0                                                        02200020
R1       EQU   1 .                     GENERAL REGISTER         SA48278 02210022
RLCB     EQU   2                        LCB BASE                        02220020
RWKA     EQU   3                                                        02240020
CURR     EQU   3 .                      ADDR OF CURRENT ELEMENT  Y02027 02246006
*                                  ON ASYNCHRONOUS READY QUEUE   Y02027 02252006
RBASE    EQU   4                                                        02260020
RF       EQU   5                        WORK REGISGER                   02280020
RPREFIX  EQU   6                                                        02300020
RLIST    EQU   6                        INVITATION LIST REG    @XA08073 02310091
RA       EQU   7                        WORK REGISTER                   02320020
RB       EQU   8                        WORK REGISTER                   02340020
RC       EQU   9                        WORK REGISTER                   02360020
RD       EQU   10                       WORK REGISTER                   02380020
RDCB     EQU   10                                                       02400020
RE       EQU   11                       WORK REGISTER                   02420020
R11      EQU   11                                                       02440020
RCCW     EQU   12                       CCW BASE                        02460020
RAVT     EQU   13                       AVT BASE                        02480020
RSCB     EQU   14                       SCB BASE                        02500020
R14      EQU   14                                                       02520020
R15      EQU   15                                                       02540020
         EJECT                                                          02560020
         DC    A(ELINEND-&NAME)         LENGTH OF MODULE         X02004 02566005
         USING *,R15                                             X02004 02572005
         B     ID                                                       02580020
         AIF   ('&GEN' EQ 'MINI').L6                                    02600022
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ '').LL41           S99228 02605022
SCANAD   DC    A(0)                     DUMMY SCAN ROUTINE ADCON S99228 02610022
*                                       TO PRESERVE DISPLACEMENTSS99228 02615022
*                                       OF LOOKAD AND SORCEAD FORS99228 02620022
*                                       START-STOP               S99228 02625022
         AGO   .LL42                                             S99228 02630022
.LL41    ANOP                                                    S99228 02635022
* * * * * * * * * * * * * * * * * * * * * *  * * *  * * * * * * * * * * 02640020
* * *    SCANAD MUST ALWAYS BE AT AN OFFSET OF FOUR IN TO THIS    * * * 02660020
* * *    APPENDAGE.                                               * * * 02680020
* * * * * * * * * * * * * * * * * * * * * *  * * *  * * * * * * * * * * 02700020
SCANAD   DC    A(SCAN)                  SCAN FOR BSC READ TEXT          02720020
* * * * * * * * * * * * * * * * * * * * * *  * * *  * * * * * * * * * * 02740020
*                                                                S99228 02741022
*                                                                S99228 02742022
* LOOKAD AND SORCEAD MUST BE AT OFFSET EIGHT AND TWELVE          S99228 02743022
* RESPECTIVELY                                                   S99228 02744022
*                                                                S99228 02745022
.LL42    ANOP                                                    S99228 02745522
LOOKAD   DC    A(LOOKER)                ADDR DVCCSTCS LOC RTN    S99228 02746022
SORCEAD  DC    A(SOURCER)               ADDR GENPOLL SRC DET RTN S99228 02747022
FNDQCBAD DC    A(FINDQCB) .             FIND DEST QCB ROUTINE    S22029 02747222
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'QTAM').L6         S99228 02747522
FINDAD   DC    A(FINDER)                ADDR INVLIST ENT LOC RTN S99228 02748022
*                                                                S99228 02749022
*                                                                S99228 02750022
BSCRSPAD DC    A(BSCRSP)                BSC READ RESPONSE TO TEXT       02760020
CHACKAD  DC    A(CHACK)                 CHECK RESPONSE -BSC             02780020
BSC27AD  DC    A(BSC270X)               CSW ADJUST BSC WRITES TEXT      02800020
.L6      AIF   ('&GEN' EQ 'MINI').L701                                  02820020
IDCHKAD  DC    A(IDCHK)                 ID CHECK ROUTINE                02840020
         AIF   ('&GEN' EQ 'BISC').L7                                    02860020
         AIF   ('&GEN' EQ 'QTAM').CA                                    02900022
DYNCAD   DC    A(DYNC) .                                         TSO    02910022
.CA      ANOP                                                    S22025 02920022
TSOCHKAD DC    A(TSOCHK)                                                02930022
OPCHKAD  DC    A(OPCHK1)                                                02940020
.L7      ANOP                                                           02960020
POLLAD   DC    A(POLLRT)               AUTOPOLL ROUTINE                 02980020
POLLADR  DC    A(POLLCK)                                       @OZ16540 02990091
.L701    ANOP                                                           03000020
&NAME    IEDHJN , .                     MODULE ID AND DATE       S22025 03020022
ID       DS    0H                                                       03060020
         L     R11,CVTPTR .            PICKUP CVT ADDRESS        Y02027 03080006
         L     RAVT,AVTCVTPT(,R11) .    LOAD LIST                X01004 03083005
         L     RAVT,ZERO(,RAVT) .       AVT BASE                 X01004 03086005
         STM   R0,RC,AVTSAVEX .         SAVE REGISTERS           X01004 03089005
         ST    R14,AVTDPARM .           SAVE RETURN ADDRESS      X01004 03092005
         LA    RCCW,DEBNMSUB-DEBAPVT    OFFSET TO DEB PREFIX     Y02027 03095006
         LA    R15,0(RWKA)              COPY DEB ADDRESS         Y02027 03096006
         SR    R15,RCCW                 DEB PREFIX               Y02027 03097006
         L     R15,SIOPTR(,R15)         ADDRESS OF SIO APPENDAGE X02004 03100005
         BAL   RCCW,INTENTRY(R15)       LINK TO SIO APPENDAGE TO X02004 03140005
*                                       TRANSLATE CCW'S REAL TO  X02004 03180005
*                                       VIRTUAL.                 X02004 03220005
         DROP  R15                                               X02004 03260005
         USING *,RCCW                   SET TEMPORARY BASE       X02004 03300005
TEMPBASE EQU   *                                                 Y02027 03320006
         SPACE 2                                                 X02004 03340005
         SH    RLCB,LCBSIZE             BACK UP TO LCB           X02004 03380005
         NI    LCBERBST,AVTEFF-LCBLOGDV RESET LOG REQUESTED    @OY20488 03385082
         TM    LCBINCAM+1,AVTEFF        DID IOHALT INTERRIPT AN  Y02027 03390006
*                                       INTERIM I/O OPERATION           03400006
*                                       OF ERP. EG BREAK FOR UE         03410006
         BZ    NOIOHLT                  BRANCH NO ERP FLAGS SET  Y02027 03420006
         BM    IOHLT                    YES, SET IOHALT FLAGS    Y02027 03420506
*        IF LCBINCAM+1=X'FF' , ENTRY FROM CLOSE FOR END OF DAY   Y02027 03421006
*        OBR/SDR RECORDING.                                      Y02027 03421506
         LA    RBASE,DEBNMSUB-DEBAPVT   OFFSET TO DEBPREFIX      Y02027 03422006
         LA    R15,0(RWKA)              COPY DEB ADDRESS         Y02027 03422506
         SR    R15,RBASE                DEB PREFIX               Y02027 03423006
         L     R15,CEPTR(,R15)          ADDRESS OF LINE END      Y02027 03423506
         DROP RCCW                                                      03424006
         USING &NAME+FOUR,R15,RBASE                                     03424506
         LA    RBASE,FOUR095(,R15)      SET UP SECOND BASE       Y02027 03425006
         LA    RBASE,ONE(,RBASE)        CLEAR HIGH-ORDER BYTE    Y02027 03425506
         LA    RCCW,LCBCPA              SET CCW ADDR. FOR CLOSE  Y02027 03426006
         B     PERMENT                  GO TO ERP FOR END OF DAY Y02027 03426506
*                                       OBR/SDR RECORDING        Y02027 03427006
         DROP  R15,RBASE                                                03427506
         USING TEMPBASE,RCCW                                            03428006
IOHLT    EQU   *                                                 Y02027 03428506
         SPACE 1                                                        03430006
         MVI   LCBINCAM+1,ZERO           RESET ERP FLAG                 03440006
         MVI   LCBECBCC,X48             SET HIO COMPLETION              03450006
NOIOHLT  EQU   *                                                        03460006
.CONC1   ANOP                                                    S22026 03494022
         MVI   LCBCSW+5,0               CLEAR FIRST BYTE OF CSW         03500020
*                                         INVALID ON PROG CHECK         03520020
*                                         INT ALREADY TRACED    SA65906 03535054
         LA    R14,NOTRACE              SET RETURN ADDRESS       Y02027 03537006
         SR    R15,R15                  CLEAR FOR ICM          @G36XRIV 03540000
         ICM   R15,AD,AVTIOT+1          ADDRESS OF I/O TRACE   @G36XRIV 03560000
         BNZR  R15                      LINK TO IGG019Q0         Y02027 03580000
         DROP  RCCW                     DROP TEMPORARY BASE      X02004 03601005
         USING IEDQCCW,RCCW             SET CCW ADDRESSABILITY   X02004 03602005
NOTRACE  EQU   *                                                        03603005
         LA    RBASE,DEBNMSUB-DEBAPVT   OFFSET TO DEB PREFIX     Y02027 03604006
         LA    R15,0(RWKA)              COPY DEB ADDRESS         Y02027 03604606
         SR    R15,RBASE                DEB PREFIX               Y02027 03605206
         L     R15,CEPTR(,R15)          ADDRESS OF LINEEND       X02004 03606005
         USING &NAME+FOUR,R15,RBASE                                     03607061
         LA    RBASE,FOUR095(,R15)      SET UP SECOND BASE     @ZA02096 03607361
         LA    RBASE,ONE(,RBASE)        CLEAR HIGH-ORDER BYTE  @ZA02096 03607661
         TM    LCBCSW+FOUR,SIX          POSSIBLE ACR           @ZA02096 03607961
         BNZ   ACRCK                    GO CHECK ACR           @ZA03108 03608200
TESTCC3  EQU   *                                               @ZA02096 03608561
         TM    LCBSIOCC,CC3             SIO COND. CODE THREE     Y02027 03609106
         BO    ERPEXT                   YES, EXIT TO ERP         Y02027 03609206
         TM    LCBSIOCC,CC1             SIO COND. CODE ONE       Y02027 03609306
         BNO   NOTCC1                   BRANCH NOT CONDITION 1   Y02027 03609406
SETLCBCS EQU   *                                               @ZA02096 03609561
         ICM   R14,AD,LCBSTART          START OF CHANN PROG    @ZA02096 03609861
         LA    R14,EIGHT(R14)           BUMP BY EIGHT            Y02027 03610161
         STCM  R14,AD,LCBCSW            UPDTE CSW FOR SIOCCC=1   Y02027 03610461
NOTCC1   EQU   *                                                 Y02027 03610761
         L     RSCB,LCBSCBA-1           SCB ADDRESS              X02004 03611061
         TM    SCBQTYPE,SCBCONC         IS THIS A CONCENTRATOR   X02004 03611361
         BNO   NOTCONCA                 BRANCH NO                X02004 03612005
         L     RSCB,LCBSCBDA-1          CONC SCB ADDRESS         X02004 03613005
         OI    SCBQTYPE,SCBCONC         SET CONC FLAG            X02004 03614005
NOTCONCA EQU   *                                                 X02004 03615005
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR         SA65392 03620852
         BE    NOTHRESH                 BR YES, DO NOT UPDATE   SA65392 03621652
*                                         THRESHHOLD COUNTERS   SA65392 03622452
         USING DEBTCBAD,RWKA            DEB ADDRESSIBILITY      SA65392 03623252
         SR    RCCW,RCCW                CLEAR WORK              SA65392 03624052
         LR    RF,RCCW                  REGISTERS               SA65392 03624852
         IC    RCCW,DEBNMEXT            GET NUMBER EXTENTS      SA65392 03625652
         SLL   RCCW,TWO                 SIZE OF UCB ADDRESSES   SA65392 03626452
         L     RCCW,DEBUCBAD(RCCW)      THRESHHOLD AREA         SA65392 03627252
         IC    RF,LCBUCBX               RLN MINUS ONE           SA65392 03628052
         SLL   RF,THREE                 THRESHOLD INDEX        @OZ24288 03628800
         AR    RCCW,RF                  ADD 8 TIMES RLN AND    @OZ27868 03629282
         SRL   RF,1                     ADD HALF AGAIN FOR     @OZ24288 03629600
         AR    RCCW,RF                  ERRMSG SAVE AREA       @OZ24288 03629800
         CLC   ZERO(ONE,RCCW),AVTHRESH  TRANSMISSIONS REACHED   SA65392 03630452
         BNL   INIT                     BR YES, INITIALIZE      SA65392 03631252
         IC    RF,ZERO(RCCW)            INCREMENT               SA65392 03632052
         LA    RF,ONE(RF)               THRESHHOLD              SA65392 03632852
         STC   RF,ZERO(RCCW)            COUNTER                 SA65392 03633652
         B     NOTHRESH                 AND CONTINUE            SA65392 03634452
INIT     EQU   *                                                SA65392 03635252
         MVC   ZERO(FOUR,RCCW),AVTFZERO INITIALIZE COUNTERS     SA65392 03636052
         MVI   ZERO(RCCW),ONE           INITIALIZE TRANS CNT    SA65392 03636852
NOTHRESH EQU   *                                                SA65392 03637652
TSO2     EQU   *                                                    TSO 03640020
          L     RCCW,LCBCSW-1            FAILING CCW+8                  03660020
         LA    RCCW,AVTEZERO(,RCCW)     CLEAR HI ORDER BYTE             03680020
         SH    RCCW,H8                  BACK UP TO INTRPT CCW           03700020
         AIF   ('&GEN' EQ 'MINI').L8A                                   03720020
         AIF   ('&GEN' EQ 'BISC').L8A                                   03740020
* PLEASE NOTE THAT THE FOLLOWING CODE TO SET AND RESET LCBCIRCD WILL    03770020
* WORK FOR A 1050 ONLY SO LONG AS THE RESPONSE TO POLL OR ADDRESSING    03780020
* GENERATES AN INTERRUPT. THE BIT IS USED TO DETERMINE WHETHER OR NOT   03790020
* A WRITE BREAK COMMAND WILL BE EXECUTED AFTER A HALT I/O.              03800020
         L     RWKA,LCBSTART-1          ADDRESS OF START CCW        TSO 03820020
         LA    RWKA,0(RWKA)             CLEAR HIGH ORDER BYTE       TSO 03840020
         LA    RF,LCBCPA-1              IS CCW IN CH PGM AREA   SA56915 03841022
         CR    RWKA,RF                  COMPARE ADDRESS         SA56915 03842022
         BNH   NOT2741                  BR IF RESTART OCCURED   SA56915 03843022
         SR    RF,RF                    CLEAR FOR INSERT CHAR   SA56915 03844022
         L     RA,LCBDCBPT              POINT TO DCB            SA56915 03845022
         USING IHADCB,RA                ADDRESSABILITY          SA56915 03846022
         IC    RF,DCBEIOBX              SIZE OF LCB             SA56915 03847022
         DROP  RA                       ELIMINATE DCB REG       SA56915 03848022
         LA    RF,0(RLCB,RF)            POINT TO END OF LCB     SA56915 03849022
         CR    RWKA,RF                  CCW IN LCB ?            SA56915 03850022
         BH    NOT2741                  BRANCH NO               SA56915 03851022
         CLI   0(RWKA),CCWWRITE         WAS START CCW A WRITE       TSO 03860020
         BNE   NOT2741                  BRANCH ON NO                TSO 03880020
         CR    RCCW,RWKA                IS FIRST CCW THE            TSO 03900020
*                                       INTERRUPT CCW               TSO 03920020
         BNE   NOTINT                   BRANCH ON NO                TSO 03940020
         SR    R0,R0                    CLEAR REGISTER              TSO 03960020
         CH    R0,LCBCSW+5              IS RESIDUAL COUNT ZERO      TSO 03980020
         BE    NOTINT                   BRANCH IF SO              M5953 04000020
         CLI   4(RWKA),X20              IS THIS RESPONSE OWED CCW M5953 04010020
         BNE   NOT2741                  IF NOT, CONTINUE          M5953 04012020
         OI    LCBTSOB,LCBCIRCD         INDICATE IN TEXT MODE     M5953 04014020
         OI    LCBSTAT2,LCBRESP         INDICATE RESPONSE OWED    M5953 04016020
         B     NOT2741                  BRANCH TO CONTINUE        M5953 04018020
NOTINT   EQU   *                                                    TSO 04020020
         L     RWKA,0(RWKA)             DATA ADDRESS FROM CCW       TSO 04040020
         CLI   0(RWKA),CIRCD            WAS FIRST CHAR A CIRCLE-D   TSO 04060020
         BNE   NOTCIRCD                 BRANCH ON NO                TSO 04080020
         OI    LCBTSOB,LCBCIRCD         INDICATE CIRCLE-D SENT      TSO 04100020
         B     NOT2741                                              TSO 04120020
NOTCIRCD EQU   *                                                    TSO 04140020
         CLI   0(RWKA),CIRCC            WAS FIRST CHAR CIRCLE-C     TSO 04160020
         BNE   NOT2741                  BRANCH ON NO                TSO 04180020
         NI    LCBTSOB,X'FF'-LCBCIRCD   INDICATE CIRCLE-C SENT      TSO 04200020
NOT2741  EQU   *                                                    TSO 04220020
         CLI   LCBTPCD+11,X'AC'         OPEN LINE CHECK?            TSO 04240020
         BE    OPCHK                    YES. GO PUT UP PREPARE      TOS 04260020
.L8A     ANOP                                                           04280020
         CLI   LCBECBCC,X48 .           HIO INTERRUPT               TSO 04300020
         BNE   TSO8 .                   BRANCH NO                   TSO 04320020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L8                04340020
         AIF   ('&GEN' EQ 'QTAM').L8                                    04360020
         TM    LCBTSOB,LCBPREP          IS PREPARE ON LINE          TSO 04380020
         BO    RTPREP                   BRANCH ON YES               TSO 04400020
         TM    LCBTSOB,LCBWRBRK         WAS A BREAK REQUESTED?      TSO 04420020
         BNZ   CHKBRK                   CHECK IF BREAK                  04440020
         SPACE                                                          04460020
.L8      ANOP                                                           04480020
CHKMSGEN EQU   *                                                        04500020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          04520020
         BO    ERBPOST                  BRANCH IF YES                   04540020
         CLI   LCBTPCD,TPOPEN .         INITIALIZATION SEQUENCE         04580020
         BE    EROPEN                   BRANCH YES              SA62408 04600005
         L     RCCW,LCBLSPCI-1          FREE ALL BUFFERS UP TO HERE     04640020
         OI    LCBCHAIN,LCBNORTY        SET NO RETRY                    04660020
         TM    LCBSTAT1,LCBRECVN        RECEVIE STATE                   04680020
         BZ    ADDERR                   NO, IT'S ON SEND SIDE           04700020
         MVC   PRFSIZE-IEDQPRF(2,RCCW),PRFEOB-IEDQPRF(RCCW)    @SA75471 04740000
         TM    PRFSTAT1-IEDQPRF(RCCW),PRFNHDRN HEADER                   04880020
         BO    POSTALL                  NO, FREE UP PREVIOUS BFR A56906 04900022
*                                               TO ZERO IF HDR  SA64676 04904051
         TM    LCBERBST,LCBDLNKN        IS ERB AVAILABLE (NO PCI)A56906 04906022
         BO    CLEANUP                  YES, POST LCB TO BD             04912022
         B     POSTALL                  FREE UP PREVIOUS BUFFERS        04920020
         SPACE 1                                                 X02004 04926005
LCBSIZE  DC    AL2(LCBFLAG1-IEDQLCB)    LCB PRIOR TO IOB         X02004 04932005
ACRCK    EQU   *                                               @ZA03108 04933000
         L     R14,LCBSTART-1           START OF CCWS          @ZA03108 04933500
         LA    R14,EIGHT(R14)           BUMP TO END OF FIRST   @ZA03108 04934000
         STCM  R14,AD,LCBCSW            SET NEW CCW ADDR IN CSW@ZA03108 04935000
         B     TESTCC3                  NO, TEST FOUND CODE    @ZA02096 04937061
         SPACE                                                          04940020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L8B               04960020
         AIF   ('&GEN' EQ 'QTAM').L8B                                   04980020
CHKBRK   EQU   *                                                        05000020
         MVI   LCBCPA,CCWBREAK .        BREAK COMMAND               TSO 05020020
         LA    RA,THREE                                             TSO 05040020
         ST    RA,LCBCPA+4 .            LENGTH FOR BREAK            TSO 05060020
         MVI   LCBTPCD,X12 .            TP OP CODE                  TSO 05080020
         LA    RA,LCBCPA .              START ADDR FOR IOS          TSO 05100020
         ST    RA,LCBSTART-1            MOVE IN START ADDRESS       TSO 05120020
         MVC   LCBCSWSV(7),LCBCSW .     SAVE ENDING STATUS          TSO 05140020
         MVI   LCBECBCC,X'7F'           RESET COMPLETION CODE       TSO 05160020
         TM    LCBTSOB,LCBCIRCD         IS TERMINAL IN TEXT MODE    TSO 05180020
         BO    RTWRBRK                  BRANCH IF YES, DONT WR BRK  TSO 05200020
         B     RESTART                  BRANCH TO ISSUE BREAK       TSO 05220020
.L8B     ANOP                                                           05240020
TSO8     EQU   *                                                    TSO 05260020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L8C               05280020
         AIF   ('&GEN' EQ 'QTAM').L8C                                   05300020
         CLI   LCBTPCD+11,X'BE'         IS SMI/WCC FLAG SET   S22028TSO 05305022
         BE    CHK3270R                 YES, BRANCH           S22028TSO 05310022
TSO8A    EQU   *                                              S22028TSO 05315022
         CLI   LCBTPCD+10,X'AE'         5041 CHECK?                 TSO 05320020
         BE    GODYNC                                               TSO 05340020
.L8C     ANOP                                                           05360020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE?            S99228 05400722
         BNE   CEDETOG                  BRANCH NO                S99228 05400822
         ICM   RA,AD,LCBCSW             INTERRUPT ADDR = 0       Y01948 05401205
         BNZ   CEDETOG                  BRANCH NO                S99228 05401522
         L     RA,LCBSTART-ONE          LOAD START ADDRESS       S99228 05402122
         CLI   LCBECBCC,PERMERR         PREMANENT ERROR ?       OY03460 05402205
         BE    INTERSET                 YES, BRANCH             OY03460 05402305
         CLI   ZERO(RA),CCWEAU          3270 EAU COMMAND?        S99228 05402422
         BNE   MAYBESEL                 BRANCH NO                S99228 05402822
         LA    RA,LCBCPA+16             LOAD ADDR EAU CCW        S99228 05403522
         B     INTERSET                 SET INTERRUPT ADDRESS    S99228 05404222
MAYBESEL EQU   *                                                 S99228 05404922
         CLI   ZERO(RA),CCWSEL          3270 SELECT CHANNEL PGM? S99228 05405622
         BNE   MAYBEGEN                 BRANCH NO                S99228 05406322
         L     RA,LCBLSPCI-ONE          LOAD BUFFER ADDRESS      S99228 05409822
         B     BEGIN                    ENTER LOOP               S99228 05410522
MAYBEGEN EQU   *                                                 S99228 05410622
         LA    RA,LCBCPA                LOAD ADDR MSGGEN CCW     S99228 05410722
         B     INTERSET                 SET INTERRUPT ADDRESS    S99228 05410822
NEWCCW   EQU   *                                                 S99228 05411222
         L     RA,EIGHT(R0,RA)          LOAD TIC CCW             S99228 05411922
BEGIN    EQU   *                                                 S99228 05412622
         CLI   TICEND(RA),TWO           END OF CHANNEL PROGRAM?  S99228 05413322
         BNE   NEWCCW                   BRANCH NO                S99228 05414022
INTERSET EQU   *                                                 S99228 05414722
         LR    RCCW,RA                  SET INTERRUPT ADDRESS    S99228 05415422
         LA    RCCW,ZERO(,RCCW)                                 OY03460 05415705
         LA    RA,EIGHT(R0,RA)          INCREASE ADDR FOR CSW    S99228 05416122
         STCM  RA,AD,LCBCSW             SET INTERRUPT ADDRESS    Y01948 05416805
CEDETOG  EQU   *                                                 S99228 05418922
         CLI   LCBECBCC,PERMERR         PREMANENT ERROR ?       OY03460 05419205
         BE    PERMENT                  YES, BRANCH             OY03460 05419505
         TM    LCBCSW+4,X'20'           CHAN PROG CHECK                 05420020
         BZ    NOPC                     NO                              05440020
         TM    CCWOPCDE,SEVEN           IS OP CODE A TIC         X01004 05480005
         BZ    ITSPC                    YES                      X01004 05490005
         CLI   CCWCOUNT+1,AVTEZERO .    ZERO COUNT CCW           S22025 05515022
         BNE   ERP .                    BRANCH IF NO             S22025 05518022
         TM    CCWFLAGS,CCWCD+CCWCC .   ANY CHAINING FLAGS       S22025 05524022
         BZ    NOPC .                   NO, NORMAL END OF MSG    S22025 05527022
         B     ERP .                    LET ERP PROCESS          S22025 05533022
ITSPC    EQU   * .                                               S22025 05536022
         TM    CCWADDR+2,X'01'          BUFFER BEING ASSIGNED           05540020
         BZ    NOTASGN                  NO                              05560020
ASGN     EQU   *                                                        05600020
         NI    CCWADDR+2,AVTEFF-X'01'   CLAR BIT                        05620020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE             X03963 05622005
         BNE   NEXTBUF                  BR NO, GET NEXT BUFFER   X03963 05624005
         L     RA,AVTSAVEX+REG7         UCB ADDRESS              X03963 05626005
         CLI   TTY4(RA),LCL3277         3270 LOCAL               X03963 05628005
         BL    NEXTBUF                  BR NO, GET NEXT BUFFER   X03963 05630005
         LA    RCCW,LCBCPA+16           RESTART ON SELECT COM    X03963 05632005
         B     EXIT3                    TO RESTART               X03963 05634005
NEXTBUF  EQU   *                                                 X03963 05636005
         L     RCCW,CCWADDR-1           GET NEXT BUFFER                 05640020
         B     EXIT3                    RESTART ON NEXT BUFFER          05660020
NOTASGN  EQU   *                                                        05680020
         TM    CCWADDR+2,X'02'          VALID PROGRAM CHECK             05700020
         BZ    ASGN                     NO                              05720020
         TM    SCBERR1,SCBCUTFN         CUT OFF EXECUTED                05760020
         BNZ   RTOPCUT                  POST LCB TO CUTOFF       A67139 05780054
         OI    SCBERR1,SCBNOBFN .       SET INSUFFICINET BUFFERS S21101 05790020
         TM    LCBCSW+3,X'02'           UNIT CHECK ALSO                 05800020
         BO    ERP                      BRANCH IFYES TO CLEAR ERROR     05820020
         B     TEXT                     POST PREVIOUS BUFFERS           05860020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L8D               05860322
         AIF   ('&GEN' EQ 'QTAM').L8D                                   05860622
CHK3270R EQU   *                                              S22028TSO 05861022
         LH    RC,LCBTTCIN              TERMINAL OFFSET       S22028TSO 05862022
         L     RA,AVTRNMPT              TNT CODE BASE         S22028TSO 05863022
         USING IEDQTNTD,RA                                    S22028TSO 05864022
         BAL   RPREFIX,TNTDCODE         FIND TERMINAL TYPE    S22028TSO 05865022
         DROP  RA                                             S22028TSO 05866022
         USING IEDQTRM,RB                                     S22028TSO 05867022
         L     RB,TRMDESTQ-1            GET QCB ADDRESS       S22028TSO 05868022
         DROP  RB                                             S22028TSO 05869022
         TM    QCBTSOF2-IEDQQCB(RB),QCBDSSMI HAS WCC BEEN SENTS22028TSO 05870022
         BO    SKIPUE                   BRANCH NOT SENT         SA61779 05871005
         B     TSO8A                    BRANCH NOT SENT       S22028TSO 05872022
.L8D     ANOP                                                           05876022
PCSTART  EQU   *                                                        05880020
         NI    SCBERR1,AVTEFF-SCBNOBFN  RESET INSUFF BFRS ERROR@OS77837 05890091
         MVI   LCBCPA+12,X'20'         FLAG TO ASSIGN BUFFERS FROM      05900020
         LA    RCCW,LCBCPA              FOR TIC                         05920020
         ST    RCCW,LCBCPA+8            SET IN TIC ADDRESS              05940020
         MVI   LCBCPA+8,CCWTIC          SET COMMAND CODE                05960020
         B     EXIT3                    RESTART ON NEXT BUFFER          05980020
*                                         IDLES OR SKIP LOOP            06000020
NOPC     EQU   *                                                        06020020
         TM    LCBCSW+4,X'1F'           SEVERE CHANNEL ERRORS           06040020
         BNZ   ERP                      YES                             06060020
         TM    LCBCSW+3,X'D2'           DEVICE ERROR            SA59028 06100022
         AIF   ('&GEN' EQ '').LI2                                       06120020
         AIF   ('&GEN' EQ 'STSP').LI2                                   06140020
         AIF   ('&GEN' EQ 'QTAM').LI2                                   06150022
         BNZ   ERP                                                      06160020
         AGO   .L10                                                     06180020
.LI2     ANOP                                                           06200020
         BZ    NOUC                     BRANCH NO UNIT CHECK            06220020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE?            S99228 06240022
         BE    ERPEXIT                  RETURN TO IOS FOR ERP   SA59027 06260022
         L     RA,TSOCHKAD                                              06280020
         BR    RA                                                       06300020
NOUC     EQU   *                                                        06320020
.L10     ANOP                                                           06340020
         TM    LCBCSW+3,UNEX            UNIT EXCEPTION                  06380020
         BZ    PERMENT                  NO                              06400020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L10A      SA51090 06403022
         L     RC,AVTSAVEX+UCBOFFST     UCB ADDRESS FROM SAVE    X02004 06406005
         CLI   UNITYPE(RC),AVTEZERO     IS THIS AUDIO           SA51090 06409022
         BE    ERP                      IF SO, TRY ERP          SA51090 06412022
.L10A    ANOP                                                   SA51090 06415022
         CLI   CCWOPCDE,CCWREAD         READ COMMCAN                    06420020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L11               06440020
         AIF   ('&GEN' EQ 'QTAM').L11                                   06460020
         BE    PERMENT                  YES, NORMAL                     06480020
         CLI   CCWOPCDE,CCWINHIB        INHIBIT                         06520020
.L11     ANOP                                                           06540020
         BNE   ERP                      NO, NOT NORMAL                  06560020
         EJECT                                                          06580020
*                                                                       06600020
*        THE TP OP CODE FOR THE INTERRUPTED CCW IS OBTAINED BY          06620020
* USING THE ADDRESS IN THE CSW AS AN INDEX ARGUMENT INTO A LIST OF      06640020
* TP OP CODES (LCBTPCD).  AN ENEN VALUED TP OP CODE REPRESENTS A TEXT   06660020
* OR NON-TEXT RELATED CCW FOR WHICH AN INTERRUPT IS ANTICIPATED.  AN    06680020
* EVEN VALUED TP OP CODE IS USED AS AN INDEX INTO A BRANCH TABLE        06700020
* IN ORDER TO TAKE SPECIFIC ACTION FOR THIS INTERRUPT.  TWO TABLES      06720020
* ARE EMPLOYED:  ONE FOR NORMAL ENDING STATUS AND THE OTHER FOR         06740020
* ERROR CONDITIONS (SET BY ERP).                                        06760020
*        IF THE TP OP CODE HAS AN ODD VALUE, TESTS ARE MADE TO          06780020
* DETERMINE IF IT IS A TEXT OR NON-TEXT RELATED CCW.                    06800020
*                                                                       06820020
PERMENT  EQU   *                                                        06840020
         LA    RC,LCBCPA                START OF CHAN PROG AREA         06880020
         SR    RC,RCCW                  DIFFERENCE BETWEEN TWO          06900020
         BP    TEXT                     BRANCH IF TEXT                  06920020
         SR    RB,RB                    CLEAR WORK REGISTER             06960020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 06980020
         USING IHADCB,RA                                                07000020
         IC    RB,DCBEIOBX              SIZE OF LCB                     07020020
         DROP  RA                                                       07040020
         LA    RB,AVTEZERO(RLCB,RB)     POINT TO END OF LCB             07060020
         SR    RB,RCCW                  CCW IN CHAN PROG AREA           07080020
         BNP   TEXT                     BRANCH IF TEXT                  07100020
         LPR   RC,RC                    MAKE DIFFERENCE POSITIVE        07140020
         SRL   RC,THREE                 DIVIDE BY 8                     07160020
         IC    RC,LCBTPCD(RC)           GET TP OP CODE FOR BRANCG       07180020
         STC   RC,AVTDOUBX              SAVE TP OP CODE                 07200020
         TM    AVTDOUBX,X01             NON EXPECTED INTERRUPT          07220020
         BO    TRYTXTER                 BRANCH YES                      07240020
         LH    RB,TABLE(RC)             OFFSET INTO TABLE               07260020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 07280020
         BNE   TABLE1(RB)               BRANCH NO                       07300020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L8E               07321022
         AIF   ('&GEN' EQ 'QTAM').L8E                                   07322022
         CLI   LCBTPCD+11,X'BE'         IS SMI/WCC FLAG ON    S22028TSO 07323022
         BNE   PERMENT1                 NO, BRANCH            S22028TSO 07326022
         MVI   LCBTPCD+11,X'00'         CLEAR SMI/WCC FLAG    S22028TSO 07329022
PERMENT1 EQU   *                                              S22028TSO 07332022
.L8E     ANOP                                                           07337022
         LH    RB,ERRTABLE(RC)          ENTRY INTO ERROR TABLE          07340020
         B     ERRTABLE(RB)             BRANCH TO ENTRY                 07360020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').LC1               07400020
         AIF   ('&GEN' EQ 'QTAM').LC1                                   07420020
GODYNC   EQU   *                                                        07440020
         L     RF,DYNCAD                                            TSO 07460020
         BR    RF                                                   TSO 07480020
.LC1     ANOP                                                           07520020
TABLE    EQU   *                                                        07540020
         DC    AL2(RTERROR-TABLE1)      ERROR ENTRY                     07560020
         DC    AL2(RTOPEN-TABLE1)       OPEN AND START LINE             07580020
         DC    AL2(RTPOLL-TABLE1)       READ RESPONSE TO POLL           07600020
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'BISC').L12               07620020
         DC    AL2(RTENAB-TABLE1)       ENABLE ON DIAL                  07640020
         AGO   .L13                                                     07660020
.L12     DC    AL2(RTERROR-TABLE1)                                      07680020
.L13     ANOP                                                           07700020
         DC    AL2(RTRSPADD-TABLE1)     RESPONSE TO ADDRESSING          07720020
         DC    AL2(RTRSPEB-TABLE1)      READ RESPONS TO EOB             07740020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L14               07760020
         AIF   ('&GEN' EQ 'QTAM').L14                                   07780020
         DC    AL2(RTRDENQ-TABLE1)      READ ENQ                        07800020
         DC    AL2(RTRSPENQ-TABLE1)     READ RESPONSE TO ENQ            07820020
         AGO   .L15                                                     07840020
.L14     DC    AL2(RTERROR-TABLE1)                                      07860020
         DC    AL2(RTERROR-TABLE1)                                      07880020
.L15     AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L16               07900020
         AIF   ('&GEN' EQ 'QTAM').L16                                   07920020
         DC    AL2(RTPREP-TABLE1)       PREPARE                     TSO 07940020
         DC    AL2(RTWRBRK-TABLE1)      WRITE BREAK                 TSO 07960020
         AGO   .L17                                                     07980020
.L16     ANOP                                                           08000020
         DC    AL2(RTERROR-TABLE1)                                      08020020
         DC    AL2(RTERROR-TABLE1)                                      08040020
.L17     AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L18               08060020
         AIF   ('&GEN' EQ 'QTAM').L18                                   08080020
         DC    AL2(RDLCOUT-TABLE1)      RD STX,/DLE STX                 08100020
         AGO   .L19                                                     08120020
.L18     ANOP                                                           08140020
         DC    AL2(RTERROR-TABLE1)                                      08160020
.L19     ANOP                                                           08180020
         DC    AL2(RTWRRSP-TABLE1)      WRITE RESPONSE OFFSET           08200020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L20               08220020
         AIF   ('&GEN' EQ 'QTAM').L20                                   08240020
         DC    AL2(RTIDENQ-TABLE1)      READ ID ENQ                     08260020
         DC    AL2(RTIDACK-TABLE1)      READ ID ACK                     08280020
         AGO   .L21                                                     08300020
.L20     ANOP                                                           08320020
         DC    AL2(RTERROR-TABLE1)                                      08340020
         DC    AL2(RTERROR-TABLE1)                                      08360020
.L21     ANOP                                                           08380020
         DC    AL2(RTTXTRST-TABLE1)     TEXT ABORT                      08400020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ '').L22                   08420020
         AIF   ('&GEN' EQ 'QTAM').L22                                   08440020
         DC    AL2(RTERROR-TABLE1)                                      08460020
         AGO   .L23                                                     08480020
.L22     ANOP                                                           08500020
         DC    AL2(RTTWXID-TABLE1)      READ TWX ID                     08520020
.L23     ANOP                                                           08540020
         DC    AL2(RTBUFEOT-TABLE1)     RESET LINE AFTER A BLOCK        08560020
         DC    AL2(RTCLOSE-TABLE1)      CLOSE ENTRY                     08580020
         DC    AL2(RTRSPAD-TABLE1)      RESET AFTER UNUSUAL RESP        08600020
*                                         TO ADDRESSING OR ENQ          08620020
         DC    AL2(RTEAU-TABLE1)        ERASE ALL UNPROTECTED  @OY14057 08621091
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ '').TS96          SA48276 08622022
         DC    AL2(RTERROR-TABLE1)                              SA48276 08624022
         AGO   .TS97                                            SA48276 08626022
.TS96    ANOP                                                   SA48276 08628022
         DC    AL2(RTRSPMG-TABLE1)      2260 RESP TO MSGGEN    @OY14057 08630091
.TS97    ANOP                                                  @OY14057 08633091
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ '').TS97A        @OY14057 08636091
         DC    AL2(RTERROR-TABLE1)                             @OY14057 08639091
         AGO   .TS97B                                          @OY14057 08642091
.TS97A   ANOP                                                  @OY14057 08645091
         DC    AL2(RTRS3270-TABLE1)     3270 FORMAT ERR RECOVRY@OY14057 08648091
.TS97B   ANOP                                                  @OY14057 08651091
ERRTABLE EQU   *                                                        08660020
         DC    AL2(ERERROR-ERRTABLE)                                    08680020
         DC    AL2(EROPEN-ERRTABLE)                                     08700020
         DC    AL2(ERPOLL-ERRTABLE)                                     08720020
         AIF   ('&GEN' EQ 'MINI').L24                                   08740020
         DC    AL2(ERENAB-ERRTABLE)                                     08760020
         AGO   .L25                                                     08780020
.L24     ANOP                                                           08800020
         DC    AL2(ERERROR-ERRTABLE)                                    08820020
.L25     ANOP                                                           08840020
         DC    AL2(ERRSPAD-ERRTABLE)                                    08860020
         DC    AL2(ERRSPEB-ERRTABLE)                                    08880020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L26               08900020
         AIF   ('&GEN' EQ 'QTAM').L26                                   08920020
         DC    AL2(ERRDENQ-ERRTABLE)                                    08940020
         DC    AL2(ERRSPENQ-ERRTABLE)                                   08960020
         AGO   .L27                                                     08980020
.L26     ANOP                                                           09000020
         DC    AL2(ERERROR-ERRTABLE)                                    09020020
         DC    AL2(ERERROR-ERRTABLE)                                    09040020
.L27     AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L27A              09060020
         AIF   ('&GEN' EQ 'QTAM').L27A                                  09080020
         DC    AL2(RTPREP-ERRTABLE)                                     09100020
         DC    AL2(ERERROR-ERRTABLE)                                    09120020
         AGO   .L27B                                                    09140020
.L27A    ANOP                                                           09160020
         DC    AL2(ERERROR-ERRTABLE)                                    09180020
         DC    AL2(ERERROR-ERRTABLE)                                    09200020
.L27B    ANOP                                                           09220020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L28               09240020
         AIF   ('&GEN' EQ 'QTAM').L28                                   09260020
         DC    AL2(ERLCOUT-ERRTABLE)                                    09280020
         AGO   .L29                                                     09300020
.L28     ANOP                                                           09320020
         DC    AL2(ERERROR-ERRTABLE)                                    09340020
.L29     ANOP                                                           09360020
         DC    AL2(ERWRRSP-ERRTABLE)                                    09380020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').LA                09400020
         AIF   ('&GEN' EQ 'QTAM').LA                                    09420020
         DC    AL2(ERIDENQ-ERRTABLE)    READ ID ENQ                     09440020
         DC    AL2(ERIDACK-ERRTABLE)                                    09460020
         AGO   .LB                                                      09480020
.LA      ANOP                                                           09500020
         DC    AL2(ERERROR-ERRTABLE)                                    09520020
         DC    AL2(ERERROR-ERRTABLE)                                    09540020
.LB      ANOP                                                           09560020
         DC    AL2(ERTXTRST-ERRTABLE)   TEXT ABORT                      09580020
         AIF   ('&GEN' EQ 'MINI').L30                                   09600020
         DC    AL2(ERTWXID-ERRTABLE)    ERRROR ON TWX ID                09620020
         AGO   .L31                                                     09640020
.L30     ANOP                                                           09660020
         DC    AL2(ERERROR-ERRTABLE)                                    09680020
.L31     ANOP                                                           09700020
         DC    AL2(ERBUFEOT-ERRTABLE)   RESET LINE AFTER BLOCK          09720020
         DC    AL2(ERCLOSE-ERRTABLE)    ERP RETURN AFTER OBR            09740020
         DC    AL2(ERRSPAD-ERRTABLE)                            SA59028 09750022
         DC    AL2(ERERROR-ERRTABLE)    EAU ERROR               SA59028 09760022
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ '').TS98          SA48276 09762022
         DC    AL2(ERERROR-ERRTABLE)                            SA48276 09764022
         AGO   .TS99                                            SA48276 09766022
.TS98    ANOP                                                   SA48276 09768022
         DC    AL2(ERRSPMG-ERRTABLE)                            SA48276 09770022
.TS99    ANOP                                                   SA48276 09772022
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ '').TS99A        @OY14057 09773091
         DC    AL2(ERERROR-ERRTABLE)    3270 FORMAT ERR RECOVRY@OY14057 09774091
         AGO   .TS99B                                          @OY14057 09775091
.TS99A   ANOP                                                  @OY14057 09776091
         DC    AL2(ERRS3270-ERRTABLE)   3270 FORMAT ERROR      @OY14057 09777091
.TS99B   ANOP                                                  @OY14057 09778091
         EJECT                                                          09780020
*                                                                       09800020
*        INTERRUPTS ON CCW'S WITH ODD VALUED TP OP CODES ARE            09820020
* HANDLED HERE.                                                         09840020
*                                                                       09860020
TRYTXTER EQU   *                                                        09880020
         CLI   AVTDOUBX,TPRDSKIP        PRIOR TO TEXT                   09900020
         BL    ERERROR                  BRANCH IF YES                   09920020
         BH    TRYIDLES                 NOT READ SKIP                   09960020
         L     RCCW,LCBCPA+12           CCW BEFORE TIC PROGRAM CHECK    09980020
ITSSYNC  EQU   *                                                        10000020
         OI    LCBCSW+3,UNEX            INDICATE END OF MSG             10020020
         MVI   LCBCSW+6,0               RESIDUAL COUNT 0                10040020
         MVI   LCBECBCC,PERMERR         INDICATE ERROR                  10060020
         B     TEXT                     PROCESS BUFFERS                 10080020
TRYIDLES EQU   *                                                        10100020
         CLI   AVTDOUBX,TPWRIDLE        ERROR ON WRITE IDLES            10120020
         BNE   CKSNDRCV                 NO, CHECK TYPE OF OPERATION     10140020
GOIDLES  EQU   *                                                        10160020
         TM    LCBSENS0,IR              INTERVENTION REQUIRED   OY00507 10162005
         BNO   NOIR                     BR NO, CONTINUE         OY00507 10164005
         LA    RCCW,LCBCPA              WRITE IDLES, TIC LOOP   OY00507 10166005
         CLM   RCCW,AD,LCBCPA+NINE      WRITE IDLES LOOP INTACT OY00507 10168005
         BNE   NOIR                     BR NO, CONTINUE         OY00507 10170005
         MVI   LCBINCAM,AVTEFF          SET EXCP INDICATOR FOR  OY00507 10172005
*                                         RESTART BY IEDQGA     OY00507 10174005
         B     FREERQE                  GO FREE RQE, RETURN     OY00507 10176005
NOIR     EQU   *                                                OY00507 10178005
         MVI   LCBINCAM,0               RESET RETRY COUNT               10180020
         L     RCCW,LCBCPA+8            RESTART TO ET A BUFFER          10200020
         B     EXIT3                    EXIT                            10220020
CKSNDRCV EQU   *                                                        10260020
         TM    LCBSTAT1,LCBRECVN        RECEIVE OPERATION               10280020
         BO    ERWRRSP                  BRANCH IF YES                   10300020
         B     ERRSPEB                  POST FORSEND ERROR              10320020
TABLE1   EQU   *                                                        10340020
RTERROR  EQU   *                                                        10360020
         AIF   ('&GEN' EQ 'MINI').M2                                    10380020
         CLI   CCWOPCDE,CCWNOP          AUTOPOLL-TIC'S AFTER POLL'S     10400020
         BNE   NOTNOP                   NO                              10420020
         BAL   RD,POLLEXIT              FOR EXIT FORCE END OF LIST      10440020
         DC    X'FEFE' .               FORCED END OF LIST       SA51791 10460022
NOTNOP   EQU   *                                                        10480020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').NT3670        S22027 10483022
         NC    LCBTTCIN,LCBTTCIN        IS DESTINATION DETERMINEDS22027 10484022
         BZ    NT367A                   BRANCH IF NO             S22027 10485022
         BAL   RD,DCTBASE .             GET BASE ADDR OF DCT     S22027 10486022
         TM    TWO(RA),CBRDCAST .       BROADCAST TERMINAL       S22027 10489022
         BO    ERBPOST .                BRANCH IF YES            S22027 10492022
NT367A   EQU   *                                                 S22027 10493022
.NT3670  ANOP                                                    S22027 10495022
         AIF   ('&GEN' EQ '').Z1                                        10500020
         AIF   ('&GEN' NE 'BISC').M2                                    10520020
         B     RDRSP                    PUT UP READ RESPONSE            10540020
         AGO   .M2                                                      10560020
.Z1      ANOP                                                           10580020
         TM    LCBSTAT2,LCBSYNC         BSC                             10600020
         BNZ   RDRSP                    BRANCH IF YES-READ RESP         10620020
.M2      ANOP                                                           10640020
ERBPOST  EQU   *                                                        10660020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET RESPONSE OWED BIT MH      10666020
*                                        DOES NOT RESET IT ON MSGGEN    10672020
         ICM   RD,THREE,LCBTTCIN        IS DESTINATION DETERMND  Y01948 10720305
         BZ    NT367AA                  BRANCH IF NO             S22027 10720622
         AIF   ('&GEN' NE 'MINI').NTMINI                       @OX17153 10721000
         LH    RC,LCBTTCIN              TERMINAL OFFSET        @OX17153 10721100
         L     RA,AVTRNMPT              TNT CODE BASE          @OX17153 10721200
         USING IEDQTNTD,RA                                     @OX17153 10721300
         BAL   RPREFIX,TNTDCODE         FIND TERMINAL TYPE     @OX17153 10721400
         AGO   .NTMIN2                                         @OX17153 10721900
.NTMINI  ANOP                                                  @OX17153 10722000
         BAL   RD,DCTBASE               GET BASE ADDR OF DCT     S22027 10722100
.NTMIN2  ANOP                                                  @OX17153 10722200
         USING IEDQTRM,RB                                      @OX17153 10722300
         L     RB,TRMDESTQ-1            GET QCB ADDRESS        @OX17153 10722900
         USING IEDQQCB,RB                                      @OX17153 10723000
         NI    QCBELCHN+2,AVTEFF-QCBCNTEN RESET FLG ON MSGGEN  @OX17153 10723100
*                                         SO SCHEDULER WILL NOT@OX17153 10723200
*                                         ADJUST STCB CHAIN    @OX17153 10723300
         DROP  RB                                              @OX17153 10723400
NT367AA  EQU   *                                                 S22027 10723500
.NT3670A ANOP                                                    S22027 10723600
         LA    RPREFIX,LCBERB .         POST ERB TO DISP         S22027 10723900
         MVI   PRFPRI,PRIRCQCB          POST PRIORITY            S22027 10724022
         ICM   RF,THREE,LCBTTCIN        IS DEST DETERMINED       Y01948 10724305
         BZ    CKTSOPST                 BRANCH IF NO             S22027 10724622
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').NT3670B       S22027 10725022
         TM    TWO(RA),CBRDCAST .       IS POST TO CB SCHED REQ  S22027 10726022
         BZ    CKTSOPST .               BRANCH IF NO             S22027 10727022
         L     RF,AVTCMBSS .            CB SEND SCHED            S22027 10728022
         BCTR  RF,0 .                   DECR FOR QCB ADDR        S22027 10729022
         BCTR  RF,0 .                   DECR FOR QCB ADDR        S22027 10730022
         B     POSTEXIT .               EXIT                     S22027 10731022
.NT3670B ANOP                                                           10731522
CKTSOPST EQU   *                                                 S22027 10732022
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').Z11A              10740020
         AIF   ('&GEN' EQ 'QTAM').Z11A                                  10760020
         TM    LCBTSOB,LCBSATRD         IS POST TO AYM REQUESTED?   TSO 10780020
         BZ    DISP                     BRANCH ON NO                TSO 10800020
         L     RF,AVTTSOPT              ADDRESS OF TSO AREA         TSO 10820020
         L     RF,TSIMSGEN-IEDQTSI(,RF) ADDRESS OF AYM              TSO 10840020
         B     POSTEXIT                                                 10860020
         AGO   .Z11B                                                    10880020
.Z11A    ANOP                                                           10900020
         B     DISP                     POST TO DISPOSTION              10920020
.Z11B    ANOP                                                           10940020
*                                                                       10980020
*        THE LCB WILL BE POSTED TO THE QCB POINTED TO BY LCBQCBA        11000020
*                                                                       11020020
EROPEN   EQU   *                                                        11040020
RTOPEN   EQU   *                                                        11060020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L32               11062054
         TM    LCBTSOB,LCB2741N         2741?                       TSO 11064054
         BZ    NONO                     NOT 2741                        11066054
         MVI   LCBTPCD+11,X'AB'         INDICATE FIRST TIME FOR 2741TSO 11068054
NONO     EQU   *                                                        11070054
.L32     ANOP                                                           11072054
RTOPCUT  EQU   *                                                 A67139 11074054
         LA    RLCB,AVTEZERO(,RLCB)     CLEAR HI ORDER BYTE FOR COM     11080020
         MVI   LCBTPCD,AVTEZERO         CLEAR OPEN INDICATOR            11100020
         NI   LCBCHAIN,X'FF'-LCBERMSG   RESET ERR MSG PENDING  @OY11520 11180091
         L     RF,LCBRCB                POST ADDRESS SET BY OPEN        11260020
          TM     LCBSTAT1,LCBRECVN+LCBSENDN+LCBOCNI            @SA70316 11340061
*                                 TEST STATUS OF LCB           @SA70316 11390061
         BZ    FREERQE                  FALL THROUGH IF OP CONTRL       11440020
*                                         HAS STOP REQUEST ON LINE      11460020
*                                         ELSE EXIT-LINE IS STOPPED     11480020
         MVI   LCBPRI,PRILNFRE          POST PRIORITY                   11520020
         LA    RF,AVTEZERO(,RF)         CLEAR HIGH BYTE         SA66616 11524054
         CR    RLCB,RF                  POST LCB TO ITSELF      SA66616 11528054
         BNE   POSTQ                    BRANCH IF NO            SA66616 11532054
         NI    LCBSTAT1,AVTEFF-LCBSENDN SET NOT SENDING         SA66616 11536054
POSTQ    EQU   *                                                        11540020
         LR    RPREFIX,RLCB             PARAMETER TO ENQUEUE            11560020
POSTEXIT EQU   *                                                        11580020
         BAL   RC,ENQUEUE               PUT ON READYBQUEUE              11600020
         B     FREERQE                  SKIP POST                       11620020
*                                                                       11660020
*        READ RESPONSE TO INVITATION                                    11680020
*                                                                       11700020
ERRDENQ  EQU   *                                                        11720020
ERENAB   EQU   *                                                        11740020
ERPOLL   EQU   *                                                        11760020
RTPOLL   EQU   *                                                        11780020
         MVI   LCBTSTSW,XF0             RESET FOR 2260L         SA61780 11781005
RTPOLL1  EQU   *                                               @SA74852 11781500
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').LL44       S99228 11782022
         L     RF,LOOKAD                LOAD ADDR DVCCSTCS LOCRTNS99228 11783022
         BALR  RD,RF                    BRANCH TO DVCCSTCS LOCRTNS99228 11784022
         ST    RE,AVTDOUBX+FOUR         SAVE INVLIST CWORD ADDR  S99228 11785022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 11786022
         TM    LCBDCT1,CUMASK           GENERAL POLL IN PROGRESS?S99228 11787022
         BZ    ITERATE                  NO, LCBSTART SET         S99228 11788022
         L     RE,AVTDOUBX+FOUR         LOAD INVLIST CWORD ADDR  S99228 11789022
         OI    LCBMSGFM,LCBACKI         SET ACK-0 FOR READ INIT  S99228 11790022
         LA    RA,LCBCPA+ONESIX         LOAD CHL PGM START ADDR  S99228 11792022
         ST    RA,LCBSTART-ONE          SET LCBSTART AT CHL PGM  S99228 11794022
         TM    THREE(RE),AUTOPL         AUTOPOLL IN PROGRESS?    S99228 11796022
         BZ    ITERATE                  NO, SKIP INVPTR UPDATE   S99228 11798022
         SR    RC,RC                    CLEAR WORK REGISTER      S99228 11800022
         IC    RC,TWO(R0,RE)            INSERT ENTRY LENGTH      S99228 11802022
         L     RD,LCBINVPT-ONE          LOAD CURRENT INVLIST ENT S99228 11804022
         AR    RD,RC                    INCREMENT INVLIST PTR AD S99228 11806022
         STCM  RD,AD,LCBINVPT           SET NEXT INVLIST ENTRY   Y01948 11808005
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR?       @YA06889 11809000
         BE    ERERROR                  BRANCH YES             @YA10695 11810000
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR@YA10052 11811000
         MVC   LCBERADR(THREE),LCBINVPT SET POLL ADDRESS       @SA62375 11812000
         B     CLEANUP                  NO RESTART ON NEG RESP   S99228 11814022
ITERATE  EQU   *                                                 S99228 11816022
.LL44    ANOP                                                    S99228 11818022
         LA    RC,CLEANUP               NORMAL BRANCH ADDRESS   SA51090 11820022
         TM    SCBSTATE,SCBLCK1N        IS THIS LOCK MODE       SA51090 11824022
         AIF   ('&GEN' NE 'BISC').L32A                          SA51090 11828022
         BO    ERRINIT                  BRANCH IF SO            SA51090 11832022
         AGO   .L32B                                            SA51090 11836022
.L32A    ANOP                                                   SA51090 11840022
         BO    TESTARU                  BRANCH IF SO            SA51090 11844022
.L32B    ANOP                                                   SA51090 11848022
         SPACE                                                          11852022
         SPACE                                                          11860020
         AIF   ('&GEN' EQ 'BISC').L32Z                         @YA10673 11862000
         L     RC,AVTSAVEX+UCBOFFST     GET UCB ADDRESS        @YA10673 11864000
         CLI   UNITYPE(RC),AVTEZERO     IS THIS AUDIO?         @YA10673 11866000
         BE    AUDIO                    BRANCH YES             @YA10673 11868000
         LA    RC,CLEANUP               NORMAL BRANCH ADDRESS  @YA10673 11870000
.L32Z    ANOP                                                  @YA10673 11872000
         OI    LCBSTAT2,LCBNEGRP        INDIC NEG RESP TO POLL          11880020
         TM    LCBSTAT2,LCBDIAL         DIAL LCB                        11920020
         AIF   ('&GEN' NE 'QTAM' AND '&GEN' NE 'MINI').L3222   @OY11504 11924091
         BZ    NOTDIAL                   NO-BRANCH             @OY11504 11928091
         AGO   .L322Z                                          @OY11504 11932091
.L3222   ANOP                                                  @OY11504 11936091
         BO    ERRTEST                  BRANCH IF DIAL         @YA10052 11940000
         L     RE,AVTDOUBX              LOAD LCB EXTNSION ADDR @YA10052 11943000
         TM    LCBDCT1,C3270            3270 DEVICE            @YA10052 11946000
         BZ    NOTDIAL                  NO,UPDATE LCBINVPT     @YA10052 11949000
         CLC   LCBINVPT,LCBERADR        WAS POLL FOR SOH MSG   @YA10052 11952000
         BE    NOTDIAL                  NO,UPDATE LCBINVPT     @YA10052 11955000
         SPACE                                                          11960020
.L322Z   ANOP                                                  @OY11504 11965091
ERRTEST  EQU   *                                                SA51090 11970022
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 11980020
         BE    ERERROR                  BRANCH IF YES                   12000020
         SPACE                                                          12020020
         BR    RC                       PROCEED NORMALLY        SA51090 12040022
         SPACE 2                                                        12040722
ERRINIT  EQU   *                                                SA51090 12041422
         LA    RC,RESTART               LOCK BRANCH ADDRESS     SA51090 12042122
         B     ERRTEST                  TEST FOR PERM ERROR     SA51090 12042822
         AIF   ('&GEN' EQ 'BISC').L32C                          SA51090 12043522
         SPACE 2                                                        12044222
TESTARU  EQU   *                                                SA51090 12044922
         L     RC,AVTSAVEX+UCBOFFST     UCB ADDRESS              X02004 12045605
         CLI   UNITYPE(RC),AVTEZERO     IS THIS AUDIO           SA51090 12046322
         BNE   ERRINIT                  BRANCH IF NOT           SA51090 12047022
AUDIO    EQU   *                                               @YA10673 12047300
         SPACE                                                          12047722
         CLI   LCBCSW+6,TWO             HAS TEXT BEEN ENTERED   SA51090 12048422
         BE    ERERROR                  BRANCH IF NOT           SA51090 12049122
         SPACE                                                          12049822
         L     RPREFIX,LCBLSPCI-1       GET ADDRESS OF BUFFER   SA51090 12050522
         LH    RC,PRFSIZE               GET BUFFER LENGTH       SA51090 12051222
         LA    RC,TWO(,RC)              ASSUME TEXT OF 2 BYTES  SA51090 12051922
         CLI   LCBCSW+6,ONE             WAS ONLY ONE CHAR READ  SA51090 12052622
         BNE   POSTASIS                 BRANCH IF NOT           SA51090 12053322
         SPACE                                                          12054022
         BCTR  RC,ZERO                  DECREMENT LENGTH BY ONE SA51090 12054722
         SPACE                                                          12055422
POSTASIS EQU   *                                                SA51090 12056122
         STH   RC,PRFSIZE               RESTORE BUFFER LENGTH   SA51090 12056822
         STCM  RPREFIX,AD,LCBRECAD      SET REC ADDR           @OZ09957 12057191
         B     POSTMH                   POST BUFFER TO MH       SA51090 12057522
.L32C    ANOP                                                   SA51090 12058222
         SPACE 2                                                        12060020
NOTDIAL  EQU   *                                                        12080020
TSO1     EQU   *                                                    TSO 12100020
.L33     ANOP                                                           12120020
NEXTENT  EQU   *                                                        12160020
         SR    RC,RC                    CLEAR WORK REG                  12180020
         IC    RC,LCBUCBX               RLN MINUS 1                     12200020
         SLL   RC,2                     MULTIPLY BY 4                   12220020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 12240020
         USING IHADCB,RA                                                12260020
         L     RF,DCBINVLI(RC)          ILIST  FOR THIS LINE            12280020
         DROP  RA                                                       12300020
         L     RD,LCBINVPT-1            CURRENT ENTRY IN I LIST         12320020
         SR    RE,RE                    CLEAR INDEX  REGISTER           12340020
         IC    RE,TWO(R0,RF)            SIZE OF EACH ENTRY              12360020
         AR    RD,RE                    POINT TO NEXT ENTRY             12380020
         MVI   SCBRCVCT,0               RESET RECEIVE LIMIT             12400020
POLLEXIT EQU   *                                                        12420020
         STCM  RD,AD,LCBINVPT .         NEXT ENTRY               X01004 12440005
         L     RA,LCBDCBPT              GET DCB ADDRESS        @SA62375 12446000
         USING IHADCB,RA                                       @SA62375 12452000
         SR    RC,RC                    CLEAR FOR IC           @SA62375 12458000
         IC    RC,DCBEIOBX              GET OFFSET TO LCB END  @SA62375 12464000
         DROP  RA                                              @SA62375 12470000
         LA    RA,EIGHT                 LENGTH OF EXTENSION    @SA62375 12476000
         SR    RC,RA                    OFFSET TO EXTENSION    @SA62375 12482000
         ALR   RC,RLCB                  ADDR. OF LCB EXTENSION @SA62375 12488000
         MVC   LCBERADR-IEDQLCBX(THREE,RC),LCBINVPT POLL ADDR. @SA62375 12494000
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 12500020
         BE    ERERROR                  BRANCH YES                      12520020
         CLI   ZERO(RD),FE              END OF LIST                     12560020
         BE    CLEANUP                  BRANCH YES                      12580020
.Z25     AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z24               12600020
         AIF   ('&GEN' EQ 'QTAM').Z24                                   12620020
         CLI   1(RD),FE                 END OF AUTOPOLL BSC             12640020
         BE    CLEANUP                  YES                             12660020
.Z24     ANOP                                                           12680020
         TM    LCBSTAT2,LCBSNDPR        SEND SWITCH SET BY SCHED        12700020
         BO    CLEANUP                  BRANCH YES                      12720020
         TM    AVTBIT1,AVTTSON          TSO IN THE SYSTEM      @OZ25091 12725082
         BO    CLEANUP                  BRANCH YES             @OZ25091 12730082
         TM    AVTBIT3,AVTRECVN+AVTRFULN CORE Q OR REUS FULL?  @OZ14176 12736091
         BNZ   CLEANUP                  BRANCH YES TO CLEANUP  @OZ14176 12737091
         LA    RCCW,LCBCPA+24           WRITE POLLING CHRS CCW          12740020
         STCM  RD,AD,CCWADDR            SET CCW ADDRESS          Y01948 12760005
         BCTR  RE,R0                    DECREMENT TO ACCESS INDEX       12820020
         IC    RE,0(RE,RD)              GET INDEX BYTE                  12840020
         SLL   RE,ONE                   MULTIPLY BY 2                   12860020
         SR    RF,RE                    POINT TI OFFSET IN TNT          12880020
         LH    RC,0(RF)                GET TNT OFFSET                   12900020
         AIF   ('&GEN' NE 'MINI').Z2                             S22025 12920022
         STH   RC,LCBTTCIN .            NEW CONNCTED             S22025 12970022
         AGO   .Z26A .                                           S22025 13020022
.Z2      ANOP .                                                  S22025 13070022
         L     RF,POLLAD .              AUTOPOLL ROUTINE         S22025 13120022
         BAL   RD,FINDSCBQ-POLLRT(RF) . SCB/QCB FOR NEXT ENTRY   S22025 13170022
*                                         AND GET QCB ADDRESS    S22025 13220022
         TM    QCBSTAT-IEDQQCB(RB),QCBSEND SEND MODE             S22025 13270022
         BO    NEXTENT .                BRANCH YES TO NEXT ENTRY S22025 13320022
         NI    LCBSTAT2,X'FF'-LCBNEGRP . RESET NEGATIVE RESPONSE S22025 13340022
.Z26A    ANOP .                                                  S22025 13370022
         B     RESTART                  RESTART ON NEXT ENTRY           13680020
         SPACE                                                          13700020
CLEANUP  EQU   *                                                        13720020
         MVI   LCBPRI,PRIFSPCI-1        CLEANUP PRIORITY                13740020
         L     RSCB,LCBSCBA-1           SCB BASE               @SA73574 13742000
         TM    SCBERR1,SCBCUTFN         CUTOFF RUNNING?        @SA73574 13744000
         BNO   LEAVE                    BRANCH IF NO           @SA73574 13746000
         LA    RF,AVTBFRTB              BFR RETURN QCB ADDR    @SA73574 13748000
         ST    RF,AVTDOUBX              SET FOR COMPARE        @SA73574 13750000
         CLC   AVTDOUBX+1(3),LCBERBQB   ERB POSTED TO BFR RTN? @SA73574 13752000
         BE    LEAVE                    EXIT IF YES            @SA73574 13754000
         OI    LCBERBST,LCBDLNKN        SET ERB POSTABLE       @SA73574 13756000
LEAVE    EQU   *                                                        13760020
         L     RF,AVTBSCAN .            ADDRESS OF IEDQBD        X01004 13780005
         B     POSTQ                    USE COMMON CODE                 13820020
         AIF   ('&GEN' EQ 'MINI').L37A                                  13840020
         AIF   ('&GEN' EQ 'BISC').Z3                                    13860020
         SPACE 10                                                       13880020
*                                                                       13900020
*        INTERRUPTS ON ENABLE FOR S/S DIAL LINES                        13920020
*                                                                       13940020
RTENAB   EQU   *                                                        13960020
         SPACE                                                          13980020
         TS    LCBTSTSW                 HIO TO BE DONE                  14000020
         BNZ   CLEANUP                  YES                             14020020
         B     EXIT2                    RESTART AFTER ENABLE            14040020
*                                                                       14060020
         EJECT                                                          14080020
*        READ  RESPONSE TO ADDRESSING                                   14100020
*                                                                       14120020
.Z3      AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'QTAM').L37B       S22025 14140022
RTRSPADD EQU   *                                                        14180020
         AIF   ('&GEN' NE '').L36                                       14200020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        14220020
         BZ    NOBSC                                                    14240020
.L36     ANOP                                                           14260020
         SPACE                                                          14280020
         L     RF,CHACKAD               CHECK RESPONSE ROUTINE          14300020
         BALR  RD,RF                    LINK TO ROUTINE                 14320020
BSCADD   EQU   *                                                        14340020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 14360020
         TM    LCBMSGFM,LCBACKI .       TEST ACK COUNTER         S21101 14370020
         BZ    TRYACK1                  TRY ACK-1                       14400020
         SPACE                                                          14420020
         TM    LCBERCCW,RACK0           SET CONDITION CODE              14440020
ACKTEST  EQU   *                                                        14460020
         BO    ADDROK                   RIGHT ACK RECEIVED              14480020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER BACK    S21101 14500020
         USING IEDQTRM,RB .                                      S22025 14510022
         BAL   RD,DCTBASE .             GET BASE ADDR OF DCT     S22025 14590022
         L     RB,TRMDESTQ-1 .          QCB ADDRESS              S22025 14670022
         DROP    RB                                                     14760020
         USING IEDQQCB,RB                                               14780020
         TM    LCBERCCW,RENQ            ENQ                             14800020
         BNO   TRYWK                    NO, TRY WACK                    14820020
         SPACE                                                          14840020
         TM    2(RA),MPT                MULTIPOINT                      14860020
         BO    TSTRTRY                  WRITE ENQ                       14880020
         SPACE                                                          14900020
OWERESP  EQU   *                                               @YA11157 14910000
         TM    3(RA),ENDCTL             END-END CONTROL                 14920020
         BO    TSTRTRY                  YES, SEND ENQ AGAIN    @SA72446 14940000
         SPACE 1                                               @SA72446 14950000
         OI    LCBSTAT2,LCBRESP         SET RESPONSE OWED      @SA72446 14960000
         B     CONTENT                  GO HANDLE CONTENTION   @SA72446 14980000
         SPACE                                                          15000020
TRYWK    EQU   *                                                        15020020
         TM    LCBERCCW,RWACK           WACK RECEIVED                   15040020
         BZ    NOWK                     NO                              15060020
         SPACE                                                          15080020
         TM    2(RA),MPT                MULTIPT                         15100020
         BZ    AGAINTRY                 NO                              15120020
.L37B    ANOP .                                                  S21101 15140020
TEST1ST  EQU   *                                                 S21101 15150020
         TM    QCBSTAT-IEDQQCB(RB),QCBBUFRD HEADER BUFFER        S21101 15152020
         BZ    DONTSEND                 NO                              15160020
         SPACE                                                          15180020
.L37A    ANOP                                                           15200020
RESETMM  EQU   *                                                        15220020
         NI    SCBQTYPE,AVTEFF-SCBBFMM  RESET MIDDLE OF SMG             15240020
         AIF   ('&GEN' EQ 'MINI').L37                                   15260020
         AIF   ('&GEN' EQ 'STSP').L37                                   15280020
         AIF   ('&GEN' EQ 'QTAM').L37                                   15300020
         B     DONTSEND                 EXIT                            15320020
         SPACE                                                          15340020
NOWK     EQU   *                                                        15360020
         TM    LCBERCCW,REOT            EOT                             15380020
         BO    ERRSPAD                  YES, TERMINAL NOT READY         15400020
         SPACE                                                          15420020
         TM    LCBERCCW,RRVI            RVI RECEIED                     15440020
         BZ    NORVI                    NO                              15460020
         TM    2(RA),MPT                MULTIPT                         15480020
         BZ    NOMPT                    NO                              15500020
         TM    QCBSTAT,QCBBUFRD                                         15520020
         BO    RESETMM                  YES                             15540020
         TM    ONE(RA),C3270            3270 DEVICE?             S99228 15542022
         BZ    NORVIERP                 NO, NO DVC DEP ERP       S99228 15544022
         L     RF,LOOKAD                LOAD ADDR DVCCSTCS LOCRTNS99228 15544522
         BALR  RD,RF                    BRANCH TO DVCCSTCS LOCRTNS99228 15545022
         ST    RE,AVTDOUBX+FOUR         SAVE INVLIST CWORD ADDR  S99228 15545522
         L     RF,FINDAD                LOAD ADDR DVC DEP SRC RT S99228 15546022
         BALR  RD,RF                    BRANCH TO DVC DEP SRC RT S99228 15548022
         B     ERRSPAD                  SKIP FLAG SET            S99228 15550022
NORVIERP EQU   *                                                 S99228 15552022
         SPACE                                                          15560020
         OI    SCBERR4,SCBTXTTN         SET TEXTY ERROR                 15580020
         OI    SCBERR1,SCBRVISL         SET RVI TO SELECTION            15600020
         B     RESETMM                  EXIT                            15620020
NOMPT    EQU   *                                                        15640020
         DROP  RB                                                       15660020
         SPACE                                                          15680020
         TM    3(RA),ENDCTL             END-END CONTROL                 15700020
         BO    DONTSEND                 RESCHEDULE                      15720020
         SPACE                                                          15740020
         B     TSTRTRY                  RETRY WITE ENQ                  15760020
         SPACE                                                          15780020
NORVI    EQU   *                                                        15800020
         TM    LCBERCCW,RNAK            NAK RECEIVED                    15820020
         BZ    TSTRTRY                  NO                              15840020
         SPACE                                                          15860020
         TM    2(RA),MPT                MULTIPT                         15880020
         BO    ERRSPAD                  YES                             15900020
         SPACE                                                          15920020
         TM    3(RA),ENDCTL             END-END CTL                     15940020
         BZ    RESETTM                  NINVALID RESPONSE               15960020
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED             15980020
         BNL   RESETTM                  YES                             16000020
         IC    RWKA,LCBINCAM            RETRY COUNT                     16020020
         LA    RWKA,1(,RWKA)            BUMP                            16040020
         STC   RWKA,LCBINCAM            SET BACK                        16060020
         SH    RCCW,H8                  BACK UP TO PREVIOUS CCW         16080020
         B     EXIT3                    RESTART                         16100020
         SPACE                                                          16120020
         SPACE                                                          16140020
TRYACK1  EQU   *                                                        16160020
         TM    LCBERCCW,RACK1           SET CONDITION CODE              16180020
         B     ACKTEST                  USE COMMON BRANCHES             16200020
CONTENT  EQU   *                                                 S99244 16200922
         L     RA,LCBDCBPT              GET DCB ADDRESS          S99244 16201822
         USING IHADCB,RA                                         S99244 16202722
         SR    RC,RC                    CLEAR WORK REGISTER      S99244 16203622
         IC    RC,LCBUCBX               GET RLN MINUS 1          S99244 16204522
         SLL   RC,2                     (RLN-1)*4 IS INVITATION  S99244 16205422
*                                         LIST ADDRESS INDEX     S99244 16206322
         L     RA,DCBINVLI(RC)          INVITATION LIST ADDRESS  S99244 16207222
         DROP  RA                                                S99244 16208122
         TM    3(RA),MASTER             MASTER=YES SPECIFIED   @XA08073 16209091
         BNO   DONTSEND                 NO, FORGET IT            S99244 16209922
         NI    LCBSTAT2,X'FF'-LCBRESP   RESET RESPONSE OWED    @OS76283 16210391
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED      S99244 16210822
         BH    SLCTNERR                 YES, SELECTION ERROR     S99244 16211722
         IC    RA,LCBINCAM              GET RETRY COUNT          S99244 16212622
         LA    RA,1(RA)                 INCREMENT                S99244 16213522
         STC   RA,LCBINCAM              AND SAVE                 S99244 16214422
         SH    RCCW,H8                  BACK UP TO WRITE ENQ CCW S99244 16215322
         B     EXIT3                    GO RESTART ON WRITE ENQ  S99244 16216222
SLCTNERR EQU   *                                                 S99244 16217122
         OI    SCBERR4,SCBSLCTN         INDICATE SELECTION ERR   S99244 16218022
.L37     ANOP                                                           16220020
DONTSEND EQU   *                                                        16240020
         NC    SCBDEOB(4),SCBDEOB .     IS IT START OF MSG       S99244 16243022
         BNZ   NOSDFFO .                NO, BYPASS NEXT          S99244 16246022
         NI    QCBFLAG-IEDQQCB(RB),AVTEFF-QCBSDFFO RESET TO      S99244 16249022
*                                         NEUTRAL                S99244 16252022
NOSDFFO  EQU   * .                                               S99244 16255022
         TM    QCBFLAG-IEDQQCB(RB),QCBTSSES TSO IN SESSION     @YA10410 16256000
         BO    ERRSPAD                  ADDRESSING ERROR       @OY12287 16257091
         USING IEDQQCB,RB                                      @OX17153 16260000
         OI    QCBELCHN+2,QCBCNTEN      SET FLAG FOR SCHEDULER @OX17153 16260100
         DROP  RB                                              @OX17153 16260200
*                                         TO DETERMININE NEXT TYPS21101 16270020
*                                         OF OPERATION           S21101 16280020
         B     ERRSPAD                 FREE UP BUFFERS                  16300020
ADDROK   EQU   *                                                        16320020
         LA    RCCW,LCBCPA-8           ADJUST TO START IDLES            16340020
         AIF   ('&GEN' EQ 'BISC').LC                                    16360020
         B     NOTMOD2                  POST BUFFERS                    16380020
         AIF   ('&GEN' EQ '').L35                                       16400020
RTRSPADD EQU   *                                                        16420020
.L35     ANOP                                                           16440020
NOBSC    EQU   *                                                        16460020
         AIF   ('&GEN' EQ 'MINI').L35A                           S21101 16470020
         CLI   LCBCSW+6,7               2740/2                          16480020
         BNE   NOTMOD2                  NO                              16500020
         SPACE                                                          16520020
         NI    LCBERCCW+12,X'7F'        TURN OFF PARITY BIT             16540020
         CLI   LCBERCCW+13,X'76'        CIRCLE Y RESPONSE               16560020
         BE    GOODRSP                  YES                             16580020
         CLI   LCBERCCW+12,8             ENTER, BID, PRINT, LOCAL       16600020
         BH    ERERROR .               REAL ERROR                S21101 16620020
         TM    LCBERCCW+12,X'06'        BID,ENTER,OR LOCAL     @OX16385 16621591
         BNZ   ERERROR                  YES-REAL ERROR         @OX12567 16621891
         LH    RC,LCBTTCIN .            CURRENT  CONNECTED       S21101 16623020
         L     RA,AVTRNMPT .            CONVERSION CODE          S21101 16626020
         USING IEDQTNTD,RA                                       S21101 16629020
         BAL   RPREFIX,TNTDCODE .       LINK TO IT               S21101 16632020
         DROP  RA .                                              S21101 16635020
         L     RB,TRMDESTQ-1-IEDQTRM(,RB) . GET QCB ADDRESS      S21101 16638020
         B     TEST1ST .                TEST IF HEADER           S21101 16638620
GOODRSP  EQU   *                                                        16660020
         CLI   LCBERCCW+12,X'01'        UNUSUAL POSITVE RESPONSE        16680020
         BE    NOTMOD2                  BRANCH NORMAL RESPONSE          16700020
         SPACE                                                          16720020
         CLI   LCBRCB,X'0F'             HAVE WE RECORDED YET            16740020
         MVI   LCBRCB,X'0F'             SET RECORD FLAG                 16760020
         BNE   ERPEXIT                  ERP WILL RECORD UNUSUAL         16780020
.L35A    ANOP                                                    S21101 16790020
NOTMOD2  EQU   *                                                        16800020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').Z41XX             16801022
         AIF   ('&GEN' EQ 'QTAM').Z41XX                                 16802022
         CLI   LCBTPCD+10,X'BD'         IS THIS FOR ERASURE         TSO 16803022
         BNE   NOTERASE                 BRANCH ON NO                TSO 16804022
         LR    RF,RCCW                  ADDRESS OF INTERRUPT CCW    TSO 16805022
         SH    RF,H8                    POINT TO WRITE ADDR CCW     TSO 16806022
         L     RF,0(RF)                 GET ADDRESS OF ADDR CHARS   TSO 16807022
         NI    2(RF),X'BF'              SET TO NO ERASE             TSO 16808022
         MVI   LCBTPCD+10,X'00'         RESET TP CODE               TSO 16809022
NOTERASE EQU   *                                                        16810022
.Z41XX   ANOP                                                           16811022
         TM    LCBCSW+3,UNEX            UNIT EXCEPTION                  16820020
         BNZ   ERERROR                  YES, ERROR                      16840020
.LC      ANOP                                                           16860020
SKIPUE   EQU   *                                                SA69087 16870005
         TM    LCBSTAT2,LCBMSGNN        IS THIS MESSAGE GEN             16880020
         AIF   ('&GEN' NE 'BISC').Z41                                   16900020
         BO    EXIT2                                                    16920020
         AGO   .Z42                                                     16940020
.Z41     ANOP                                                           16960020
         BO    TESTEX                   BRANCH YES                      16980020
.Z42     ANOP                                                           17000020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').Z4                17020020
         AIF   ('&GEN' EQ 'QTAM').Z4                                    17040020
         CLI   LCBTPCD+11,X'BE'         IS THIS ENTRY FOR SMI     \>3   17220020
         BNE   LDENQ                    NO, BRANCH               \>3    17240020
         ST    R15,LCBERCCW+4           SAVE REG                SA54923 17260022
         L     12,AVTKA02               GET ADDRESS OF IOGENER    \>3   17280020
         LA    RAVT,AVTSAVE2            SET AVT BASE FOR IOGENER   \>3  17300020
         BALR  5,12                     LINK TO IOGENER           TSO   17320020
         L     R15,LCBERCCW+4           RESTORE REG             SA54923 17340022
         LA    RBASE,4095(R15)          RESET SECOND BASE REGISTER TSO  17360020
         LA    RBASE,1(RBASE)                                     TSO   17380020
         SH    RAVT,AVTBACK             RESET AVT ADDRESS         TSO   17400020
         B     RESTART                  RESTART CHANNEL PROGRAM    TSO  17420020
LDENQ    EQU   *                                                  TSO   17440020
.Z4      ANOP                                                           17460020
         L     RB,LCBERBCH-1            1ST BUFFER IN CHAIN             17480020
         B     ENTER2                   ENTER LOOP                      17500020
LOOP5    EQU   *                                                        17520020
         LA    RD,0(,RD)                CLEAR HI ORDER BYTE             17540020
         LTR   RB,RD                    ADDRESS NEXT BUFFER AND         17560020
*                                         TEST IF LAST                  17580020
         BZ    EXIT1                    BRANCH NO MORE BUFFERS          17600020
         SPACE                                                          17620020
ENTER2   EQU   *                                                        17640020
         L     RD,PRFLINK-1-IEDQPRF(,RB) SAVE LINK FIELD                17660020
         LR    RPREFIX,RB               ADDRESS FO BUFFER FOR READY     17680020
         MVI   PRFPRI,PRIMHBFR          POST PRIORITY                   17700020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 17720020
         USING IHADCB,RA                                                17740020
         L     RF,DCBMH-1               QCB FOR POST                    17760020
         DROP  RA                                                       17780020
         BAL   RC,ENQUEUE               PUT ON READYBQUEUE              17800020
         SPACE                                                          17820020
         B     LOOP5                    TEST IF MORE TO POST            17840020
         SPACE                                                          17860020
EXIT1    EQU   *                                                        17880020
         STCM  RB,AD,LCBERBCH .         CLEAR FIELD              X01004 17900005
         AIF   ('&GEN' EQ 'BISC').Z5                                    17960020
TESTEX   EQU   *                                                        17980020
         TM    LCBCHAIN,LCBEXCP         NO IDLES LOOP DEFINED           18000020
         BZ    EXIT2                    BRANCH NO                       18020020
         SPACE                                                          18040020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          18060020
         BZ    FREERQE                  NO                              18080020
         LA    RCCW,LCBCPA-8            START ON MSGGEN MSG             18100020
.Z5      ANOP                                                           18120020
EXIT2    EQU   *                                                        18140020
         LA    RCCW,8(,RCCW)            RESTART ON NEXT CCW             18160020
EXIT3    EQU   *                                                        18180020
         ST    RCCW,LCBSTART-1          START ADDRESS FOR IOS           18200020
         B     RESTART                  RESTART CHANNEL PROGRA,         18220020
         SPACE 5                                                        18240020
         AIF   ('&GEN' EQ 'BISC').L39                                   18260020
RTRSPEB  EQU   *                                                        18280020
         AIF   ('&GEN' NE '').L38                                       18300020
         TM    LCBSTAT2,LCBSYNC         BI SYNC                         18320020
         BNZ   TRYBSC                   YES                             18340020
.L38     ANOP                                                           18360020
         L     RCCW,LCBCPA+12           CURRENT CCW                     18380020
         TM    LCBCSW+3,UNEX            EOT RECEIVED                    18400020
         BO    ERRSPEB                  BRANCH IF YES                   18420020
         CLI   CCWCOUNT+1,AVTEZERO .    DID PGM CHECK OCCUR      S21101 18440020
         BE    IDLEST .                 BRANCH IF YES            S21101 18450020
         SPACE 1                                                 S21101 18460020
         MVC   SCBDEOB+1(3),LCBRECAD .  SET RESTART IN SCB       S21101 18470020
         MVC   SCBDEOB(1),LCBNTXT .     SET DISK Q INFORMATION   S21101 18472020
         MVC   SCBEOB,LCBRECOF .        SET OFSET INTO BUFFER    S21101 18474020
         MVI   LCBTPCD+2,TPBUFEOT .     SET TP OP CODE           S21101 18476020
         B     RESETEOT .               RESET LINE               S21101 18478020
         SPACE 1                                                 S21101 18478420
IDLEST   EQU   *                                                 S21101 18478820
         TM    LCBCHAIN,LCBEXCP         IDLES LOOP DEFINED              18480020
         BO    FREERQE                  BRANCH IF NO                    18500020
         B     PCSTART                  START ON WRITE IDLES            18520020
.L39     ANOP                                                           18540020
*        SEND EOT FOR BUFFERED TERMINALS AND ALSO FOR END OF TRANSP     18560020
*        MODE MESSAGE                                                   18580020
RTBUFEOT EQU   *                                                        18600020
ERBUFEOT EQU   *                                                        18620020
         L     RCCW,LCBCPA+12           CURRENT CCW                     18640020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   18660020
         BAL   RA,FINDBUFF              LINK TO FREE UP RPEVIOUS        18680020
         MVI   PRFPRI-IEDQPRF(RPREFIX),PRIRCQCB E0 PRIORITY    @OS76996 18700091
         B     DISP                     TO BFR DISPOSITION     @OS76996 18710091
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L40               18720020
         AIF   ('&GEN' EQ 'QTAM').L40                                   18740020
         AIF   ('&GEN' EQ '').LM4                                       18760020
RTRSPEB  EQU   *                                                        18780020
.LM4     ANOP                                                           18800020
TRYBSC   EQU   *                                                        18820020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          18840020
         BZ    NOTMSGN                  BRANCH NO              @OY12393 18860091
         TM    LCBSTAT2,LCBDIAL         DIAL LINE?             @OY12393 18863091
         BZ    RESETTM                  BRANCH NO,SEND EOT     @OY12393 18866091
         OI    SCBBSCFM,SCBNOEOT        NO EOT SENT            @OY12393 18869091
         B     ERBPOST                  EXIT                   @OY12393 18872091
NOTMSGN  EQU   *                                               @OY12393 18875091
         L     RF,CHACKAD               CHECK RESPONSE ROUTINE          18880020
         BALR  RD,RF                    LINK TO ROUTINE                 18900020
         TM    LCBERCCW,RWACK .         WACK RECEIVED            S99228 18900322
         BZ    REGWACK .                BRANCH IF NO             S99228 18900622
         L     RF,LOOKAD                LOAD ADDR DVCCSTCS LOCRTNS99228 18901022
         BALR  RD,RF                    BRANCH TO DVCCSTCS LOCRTNS99228 18901622
         ST    RE,AVTDOUBX+FOUR         SAVE INVLIST CWORD ADDR  S99228 18902222
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 18902822
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 18903422
         BZ    REGWACK                  NO, NOT 3270 USUAL WACK  S99228 18904022
         XI    LCBMSGFM,LCBACKI         FLIP ACK COUNTER         S99228 18907022
         TM    LCBMSGFM,LCBACKI         ACK-0 EXPECTED?          S99228 18908022
         BZ    ZACK                     ACK-1 EXPECTED           S99228 18909022
         MVI   LCBERCCW,RACK0           SET ACK-0                S99228 18910022
         B     GOBACK                   BYPASS SET FOR ACK-0     S99228 18911022
ZACK     EQU   *                                                 S99228 18912022
         MVI   LCBERCCW,RACK1           SET ACK-1                S99228 18913022
GOBACK   EQU   *                                                 S99228 18914022
         XI    LCBMSGFM,LCBACKI         RETURN ACK COUNTER       S99228 18915022
REGWACK  EQU   *                                                 S99228 18916022
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 18920020
         TM    LCBMSGFM,LCBACKI .       TEST ACK COUNTER         S21101 18930020
         BZ    ITSACK1                  BANCH ACK-1 EXPECTED            18960020
         TM    LCBERCCW,RACK0           SET CONDITION CODE              18980020
TESTACK  EQU   *                                                        19000020
         BO    ACKSET                   BRANCH RIGHT ACK RECEIVED       19020020
         BZ    CHKRVI                   NO, CHECK FOR RVI               19040020
*        TO HERE IF WRIONG ACK-I                                        19060020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 19080020
CHKRTRY  EQU   *                                                        19100020
         CLI   LCBINCAM,0               RETRY COUNT                     19120020
         BNE   TESTCNT                  NOT FIRST TIME                  19140020
         SPACE                                                          19160020
         MVC   LCBCSWSV,LCBCSW          SAVE CSW                        19180020
TESTCNT  EQU   *                                                        19200020
         CLI   LCBINCAM,RETRY           RESTRY EXHAUSTED                19220020
         BL    BUMPCNT                  RETRY AGAIN                     19240020
         SPACE                                                          19260020
WREOT    EQU   *                                                        19280020
         OI    LCBCHAIN,LCBNORTY        NO RETRY                        19300020
         MVI   LCBTPCD+2,TPRESET        SET TP OPCDE                    19320020
         B     RESETEOT                 SEND EOT TO RESET LINE          19340020
         SPACE                                                          19360020
BUMPCNT  EQU   *                                                        19380020
         IC    RWKA,LCBINCAM            GET RETRY COUNT                 19400020
         LA    RWKA,1(,RWKA)            BUMP                            19420020
         STC   RWKA,LCBINCAM            SET BACK                        19440020
         B     ENQSND                   WRITE ENQ                       19460020
*                                         READ RESPONSE CCW             19480020
         SPACE 3                                                        19500020
ITSACK1  EQU   *                                                        19520020
         TM    LCBERCCW,RACK1           TET FOR ACK1 RECIVED            19540020
         B     TESTACK                  USE COMMON CODE                 19560020
CHKNAK   EQU   *                                                        19580020
         TM    LCBERCCW,RNAK            TEST FOR NAK                    19600020
         BZ    EOTTST                   BRANCH NO                       19620020
NAKSAME  EQU   *                                                        19640020
         CLI   LCBINCAM,RETRY           RETRY COUNTEXHAUSTED            19660020
         BNL   WREOT                    YES WRITE EOT          @SA75722 19680000
         SPACE 2                                                        19700020
MHEXIT   EQU   *                                                        19720020
         MVI   LCBECBCC,PERMERR         SET ERROR INDICAOTR             19740020
         L     RPREFIX,LCBLSPCI-1       LAST SERVICED BUFFER            19760020
           SPACE                                                        19780020
         B     ERRSPEB                  POST BUFFER TO MH               19800020
*                                         MH ERROR HANDLING             19820020
EOTTST   EQU   *                                                        19840020
         TM    LCBERCCW,REOT            EOT SENT                        19860020
         BZ    CHKRTRY                  C HECK RETRY COUNT              19880020
         L     RF,LOOKAD .              LOAD ADDR DVCCSTCS       S99228 19900022
         BALR  RD,RF .                  LINK TO ROUTINE          S99228 19901022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 19902022
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 19905022
         BZ    NOEOTERP                 NO, SKIP ERP FLAG SET    S99228 19908022
         ST    R0,AVTDOUBX+FOUR         SAVE INVLIST POINTER    SA62341 19909005
         L     RF,FINDAD                LOAD ADDR DVC DEP SRC RT S99228 19910022
         BALR  RD,RF                    BRANCH TO DVC DEP SRC RT S99228 19912022
NOEOTERP EQU   *                                                 S99228 19914022
         SPACE                                                          19920020
         OI    SCBERR2,SCBABRTN         SET ABORT RECEIVED              19980020
         B     ERRSPEB                  POST SENDING ERROR              20020020
CHKENQ   EQU   *                                                        20040020
         TM    LCBERCCW,RENQ            ENQ RECEIVED                    20060020
         BZ    CHKRTRY                  BEANCH IF NO                    20080020
         SPACE                                                          20100020
*        ENQ IS VALID RESPONSE IF THIS IS FIRST BLOCK OF CONVERSE       20120020
*      RESPONSE.  DESTINATION DID NOT SEE RESPONSE AND IS STILL         20140020
*      IN MASTER STATUS.                                                20160020
         SPACE                                                          20220020
CHKWK    EQU   *                                                        20240020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER BACK    S21101 20260020
         TM    LCBERCCW,RWACK           TEST FOR WACK RECEIVED          20280020
         BZ    CHKNAK                   TRY NAK                         20300020
         CLI   LCBRSKEY,BUFF            BUFFERED LINE                   20320020
         BNE   ENQSND                   WRITE ENQ                       20340020
         L     RF,BSCRSPAD              LINK TO RWUTINE                 20360020
         BALR  RD,RF                    LINK TO IT                      20380020
ENQSND   EQU   *                                                        20400020
*                                       SET TP OPCODE FOR WRITE@SA69968 20401061
         MVI   LCBTPCD+10,TPENQAD       ENQ ADDRESSING DEFAULT @SA69968 20402061
         L     RWKA,LCBCSW-1            GET TRUE               @SA69968 20403061
         LA    RWKA,AVTEZERO(,RWKA)      INTERRUPTED           @SA69968 20404061
         SH    RWKA,H8                    CCW ADDRESS          @SA69968 20405061
         LA    RA,LCBCPA                DERIVE                 @SA69968 20406061
         SR    RWKA,RA                   TP                    @SA69968 20407061
         SRL   RWKA,THREE                 OPCODE               @SA69968 20408061
         AR    RWKA,RLCB                   OFFSET              @SA69968 20409061
         DROP  RLCB                                            @SA69968 20410061
         USING IEDQLCB,RWKA             INTERRUPTED ON READ    @SA69968 20411061
         CLI   LCBTPCD,TPRDRSPD          RESPONSE TO ADDR      @SA69968 20412061
         BE    SNDENQ                   YES, BRANCH            @SA69968 20413061
         CLI   LCBTPCD,TPRSPENQ         RESPONSE TO ENQ        @OZ09265 20413391
         BE    SNDENQ                   BRANCH IF YES          @OZ09265 20413691
         DROP  RWKA                                            @SA69968 20414061
         USING IEDQLCB,RLCB                                    @SA69968 20415061
         MVI   LCBTPCD+10,TPENQRSP .    SET TP OP CODE           S21101 20420020
SNDENQ   EQU   *                                                        20440020
         LA    RA,ENQCH                SET ENQ INDEX                    20460020
         LA    RWKA,LCBCPA+80 .         SET CCW ADDRESS          S21101 20480020
         BAL   RD,CCWBLD                LINK TO ROUTINE                 20500020
         MVI   LCBCPA+84,CCWCC+CCWSLI . SET FLAGS                S21101 20520020
         ST    RCCW,LCBCPA+88 .         SET FOR TIC              S21101 20530020
         MVI   LCBCPA+88,CCWTIC .       SET TIC                  S21101 20540020
         B     RESTCOM                 RESTART                          20580020
         SPACE                                                          20600020
CHKRVI   EQU   *                                                        20620020
         TM    LCBERCCW,RRVI           RVI RECEIVED                     20640020
         BZ    CHKWK                    TRY WACK                        20660020
         TM    LCBMSGFM,DBLRVI          TWO RVI'S BACK TO BACK          20680020
         BNZ   CHKRTRY                  BRANCH YES                      20700020
         OI    LCBMSGFM,DBLRVI          SET RVI SWITCH                  20720020
         OI    SCBERR1,SCBRVITX         SET RVI RECEIVED       @OY13632 20730091
         B     GOACK                    SEND NEXT BLOCK                 20740020
         SPACE                                                          20760020
ACKSET   EQU   *                                                        20780020
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 20782022
         BNO   NOTCONCB .               BRANCH IF NO             S22026 20783022
         L     RCCW,SCBXTRA-1 .         SET REG                  S22026 20784022
         BAL   RA,FINDBUFF .            FREE UP BUFFERS          S22026 20786022
         L     RCCW,LCBCSW-1 .          RESTORE PREVIOUS         S22026 20787022
         SH    RCCW,H8 .                CCW                      S22026 20788022
NOTCONCB EQU   * .                                               S22026 20789022
         NI    LCBMSGFM,AVTEFF-DBLRVI   RESET RVI SWITCH                20800020
GOACK    EQU   *                                                        20820020
         MVI   LCBINCAM,0               RESET RETRY COUNT               20880020
         L     RF,BSCRSPAD              BSC RESPONSE ROUTINE            20900020
         BALR  RD,RF                    LINK TO IT                      20920020
.L40     ANOP                                                           20940020
RESTCOM  EQU   *                                                        20960020
         ST    RWKA,LCBSTART-1          RESTART ON WRITE CCW            20980020
         B     RESTART                  RESTART                         21000020
         EJECT                                                          21020020
*                                                                       21040020
*        READ ENQ FOR BSC TERMINAL LINE BID                             21060020
*                                                                       21080020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L41               21100020
         AIF   ('&GEN' EQ 'QTAM').L41                                   21120020
RTRDENQ  EQU   *                                                        21140020
         L     RF,CHACKAD               RESPONSE ROUTINE                21160020
         BALR  RD,RF                    LINK TO IT                      21180020
         SPACE                                                          21200020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       21220020
         BNZ   ITSDIAL                  YES                             21240020
         SPACE                                                          21260020
         TS    LCBTSTSW                 TS ISSUED BY SEND SCHED         21280020
         BNZ   CLEANUP                  BRANCH YES                      21300020
         SPACE                                                          21320020
ITSDIAL  EQU   *                                                        21340020
         TM    LCBERCCW,RDLEEOT         DLE EOT RECEIVED                21360020
         BZ    TESTEOT                  NO, TRY EOT                     21380020
         SPACE                                                          21400020
DISCON   EQU   *                                                        21420020
         MVI   LCBTSTSW,AVTEFF          ENSURE A DIAL UP                21440020
         B     RTPOLL1                  FREE UP ELEMENTS       @SA74852 21460000
         SPACE                                                          21480020
TESTEOT  EQU   *                                                        21500020
         TM    LCBERCCW,RENQ            ENQ RECEVIED                    21520020
         BO    EXIT2                    YES,RESTART                     21540000
         SPACE                                                          21560020
         TM    LCBERCCW,REOT            EOT RECEIVED                    21580020
         BZ    EOTNOTRC                 BRANCH NO              @OY19793 21600082
         TM    LCBSTAT2,LCBDIAL         IS THIS DIAL?          @OY19793 21602082
         BZ    RTPOLL                   BRIF NO                @OY19793 21604082
         OI    SCBBSCFM,SCBNOEOT        TURN ON NOEOT          @OY19793 21606082
         B     RTPOLL                   AND BRANCH             @OY19793 21608082
EOTNOTRC EQU   *                                               @OY19793 21610082
         SPACE                                                          21620020
         TM    LCBSTAT2,LCBDIAL .      DIAL LINE                SA51068 21640022
         BO    RESTART .               NO, RESTART              SA51068 21645022
         MVI   LCBTSTSW,AVTEZERO .     YES, CLEAR FOR PREPARE   SA51068 21650022
         B     RESTART .               AND RESTART              SA51068 21655022
         SPACE 3                                                        21660020
NOTENQRC EQU   *                                                        21680020
         TM    LCBERCCW,REOT            EOT RECEIVED                    21700020
         BO    ERRSPAD                  YES                             21720020
         SPACE                                                          21740020
         TM    LCBERCCW,RNAK            NAK                             21760020
         BO    RESETTM                  YES                             21780020
         SPACE                                                          21800020
         TM    LCBERCCW,RWACK           WACK RECEIVED                   21820020
         BZ    TSTRTRY                  NO, INVALID RESPONSE            21840020
AGAINTRY EQU   *                                                        21860020
         MVI   LCBTPCD+10,TPENQAD .     SET TP OP CODE           S21101 21880020
         B     SNDENQ                   WRITE ENQ UNTIL READY           21900020
         SPACE 10                                                       21920020
*                                                                       21940020
*        READ RESPONSE TO ENQ.  SELECTION OF TERMINAL ON A PT-PT OR     21960020
* DIAL LINE (BSC).                                                      21980020
*                                                                       22000020
RTRSPENQ EQU   *                                                        22020020
         L     RF,CHACKAD               CHECK RESPONSE ROUTINE          22040020
         BALR  RD,RF                    LINK TO ROUTINE                 22060020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 22080020
         TM    LCBERCCW,RACK0           ACK-0                           22100020
         BO    EXIT2                    BRANCH YES                      22120020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 22140020
         CLI   LCBERCCW,RENQ            ENQ RECEIVED                    22160020
         BNE   NOTENQRC                 BRANCH NO                       22180020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       22200020
         BO    TSTRTRY                  YES,BRANCH             @OS76283 22220091
         BAL   RD,DCTBASE               GET DCT                @OS76283 22226091
         B     OWERESP                  HANDLE CONTENTION      @OS76283 22232091
         SPACE                                                          22240020
TSTRTRY  EQU   *                                                        22260020
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED             22280020
         BL    CHKRTRY                  NO, RERY                        22300020
.L41     ANOP                                                           22320020
RESETTM  EQU   *                                                        22340020
         MVI   LCBTPCD+2,TPRSPAD        TP OP CODE FORE RESET IN        22360020
*                                         CONTROL MODE SELECTION        22380020
         B     RESETEOT                 WRITE EOT                       22400020
 SPACE 10                                                               22420020
*                                                                       22440020
*        ENTRY FROM CLOSE MODULE TO RECORD ERROR COUNTERS IN TERMINAL   22460020
* ENTRY BY  EXITING TO ERP.  ERP POST S PERMANENT ERROR  ON RETURN      22480020
* WHICH WILL POST WAIT COMPLETE.                                        22500020
*                                                                       22520020
RTCLOSE  EQU   *                                                        22540020
         OI    LCBFLAG1,X20+IOBEXEP     ERP IN CNTRL FOR CLSE  @OX19180 22560000
         B     NAPCHAP                  EXIT                   @OX19180 22566000
ERPEXIT  EQU   *                                                        22580020
         OI    LCBFLAG1,IOBEXEP         SET FLAG TO ROUTE CONTROL TO    22600020
*                                         ERP                           22620020
         B     ERP                      EXIT                            22640020
         SPACE 3                                                        22660020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'MINI').L42               22680020
         AIF   ('&GEN' EQ 'QTAM').L42                                   22700020
RTPREP   EQU   *                                                    TSO 22720020
         LA    RPREFIX,LCBERB           ELEMENT TO POST                 22740020
         MVI   PRFPRI,PRIDSPLB          LOW PRIORITY                    22760020
         L     RF,AVTTSOPT              ADDRESS OF TSO AREA             22780020
         L     RF,TSIHALT-IEDQTSI(,RF)  ADDRESS OF AYF                  22800020
         MVI   LCBSTAT1,LCBSENDN        CHANGE LINE STATUS      SA58997 22804022
         B     POSTEXIT                 BRANCH TO POST                  22820020
         SPACE 3                                                        22840020
RTWRBRK  EQU   *                                                    TSO 22860020
         L     RCCW,LCBLSPCI-1          GET ADDRESS OF BUFFER       TSO 22900020
         TM    PRFSTAT1-IEDQPRF(RCCW),PRFNHDRN IS IT FIRST BUFFER   TSO 22920020
         BO    RESCSW                   BRANCH ON NO                TSO 22940020
         L     RCCW,PRFIOADR-1-IEDQPRF(,RCCW) GET ADDRESS OF DATA   TSO 22960020
         CLI   1(RCCW),0                ANY DATA ENTERED            TSO 22980020
         BNE   RESCSW                   BRANCH IF YES          @OS79864 23000082
         MVI   LCBTSTSW,XF0             PREVENT TRY TO RECEIVE @OS79864 23005082
         B     CLEANUP                  AND GO TO CLEANUP      @OS79864 23010082
RESCSW   EQU   *                                                    TSO 23020020
         MVC   LCBCSW,LCBCSWSV .        RESTORE ENDING STATUS       TSO 23040020
         XC    LCBCSWSV,LCBCSWSV .      CLEAR IT                    TSO 23060020
         L     RCCW,LCBCSW-1            GET CSW CCW ADDR            TSO 23080020
         SH    RCCW,H8                  BACK UP TO INTERRUPTED CCW  TSO 23100020
         CLI   CCW,CCWBREAK             IS IT A WRITE BRK           TSO 23120020
         BE    CLEANUP                 BRANCH IF YES, GO CLEANUP    TSO 23140020
         TM    LCBTSOB,LCB2741N         IS IT A 2741?               TSO 23160020
         BZ    ITS1050                  BRANCH ON NO                TSO 23180020
         MVI   LCBCSW+3,CEDE            MOVE IN GOOD ENDING STATUS  TSO 23200020
         OI    SCBERR2,SCBABRTN         SET BREAK INT'D DATA   @OS77835 23210091
         B     TSO2 V                                               TSO 23220020
ITS1050  EQU   *                                                        23240020
         L     RCCW,LCBCSW-1 .          SEE IF A TIC                TSO 23260020
         CLI   CCW,CCWTIC .             WAS READ INTERRUPTED        TSO 23280020
         BNE   CLEANUP .                NO                          TSO 23300020
         MVI   LCBCSW+3,CEDE+UNEX       MOVE IN ENDING STATUS       TSO 23320020
         B     TSO2                                                 TSO 23340020
         SPACE                                                          23360020
.L42     ANOP                                                           23380020
         AIF   ('&GEN' EQ 'MINI').L42A                                  23400020
         AIF   ('&GEN' EQ 'STSP').L42A                                  23420020
         AIF   ('&GEN' EQ 'QTAM').L42A                                  23440020
RDLCOUT  EQU   *                                                        23460020
         L     RF,SCANAD                SCAN ADDRESS                    23480020
         BALR  RD,RF                    LINK TO ROUTINE                 23500020
         TM    SCBBSCFM,SCBTRNSP        TRANSPARENT            @OX16686 23505091
         BNO   RDLCENT                  BRANCH NO              @OX16686 23510091
         NI    LCBERCCW+1,AVTEFF-IN     FORCE LC OUT           @OX16686 23515091
RDLCENT  EQU   *                                                        23520020
         TM    LCBMSGFM,LCBEOT+LCBENQ . DLEEOT=SUM OF EOT AND ENQS21101 23540020
         BNO   NOTDLEOT                 BRANCH NO                       23560020
         MVI   LCBTSTSW,AVTEFF          FORCE NEW CONNECTION            23580020
         B     BSEOT                    USE EOT CODE                    23600020
NOTDLEOT EQU   *                                                        23620020
         TM    LCBMSGFM,LCBEOT .        EOT RECEIVED             S21101 23640020
         BZ    NOEOT                    BRANCH N                        23660020
         SPACE 1                                                SA68035 23666005
         BAL   RD,CHKNEG                SET NEG RESP IF NEEDED  SA68035 23672005
         SPACE                                                          23680020
BSEOT    EQU   *                                                        23700020
         L     RCCW,LCBCPA+12           CURRENT UNIT                    23720020
         L     RWKA,CCWADDR-1           DATA ADDRESS                    23740020
         MVC   0(1,RWKA),LCBERCCW+12    GET EOT INTO BUFFER             23760020
         MVI   LCBERCCW,NOPCI           SET ROUTINE PARAMETER           23780020
         BAL   RA,FINDBUFF              GET BUFFER BASE                 23800020
         LH    RC,PRFSIZE .             GET PREFIX SIZE          S21101 23820020
         LTR   RC,RC                    TEST ZERO LENGTH-POSSIBLES22025 23820822
*                                         IF ETB (ETX) WAS FIRST S22025 23821622
*                                         CHAR OF BUFFER AND WAS S22025 23822422
*                                         PROCESSED THROUGH MH   S22025 23823222
         BNZ   BUMPSIZE                                                 23824022
         L     RB,LCBDCBPT              GET DCB BASE             S22025 23824822
         IC    RC,DCBRESER+1-IHADCB(RB) ASSUME TEXT BUFFER       S22025 23825222
         LA    RA,AVTTXTSZ              FOR PRFSIZE              S22025 23825622
         TM    PRFSTAT1,PRFNHDRN        HEADER                   S22025 23826022
         BO    SETSIZE                  BRANCH IF TEXT BUFFER    S22025 23826422
         IC    RC,LCBISZE               GET HEADER RESERVES      S22025 23826822
         LA    RA,AVTHDRSZ              SET HEADER SIZE          S22025 23827222
SETSIZE  EQU   *                                                 S22025 23827622
         AR    RC,RA                    PREFIX SIZE + IDLES      S22025 23828022
BUMPSIZE EQU   *                                                 S22025 23828822
         LA    RC,ONE(,RC) .            BUMP FOR EOT             S21101 23830020
         BAL   RB,CKBFMM .              DONT WANT EOT IN BUFER IFS21101 23840020
*                                         NOT REAL EOM           S21101 23850020
         B     MHPOST .                 NOT REAL EOM             S21101 23860020
         B     LCINS                    DONT REMOVE THIS BRANCH  S99228 23870022
*                                       CKBFMM RETURNS HERE      S99228 23880022
.L42A    ANOP                                                           23900020
         SPACE 10                                                       23920020
*                                                                       23940020
*        WRITE RESPONSE (UNCHAINED) FOR RECEIPT OF MESSAGE FROM         23960020
* TERMINAL WHICH HAS NO CONTINUE CAPABILITY (1030/1060).                23980020
*                                                                       24000020
RTWRRSP  EQU   *                                                        24020020
         L     RCCW,LCBCPA+12          LAST SERVICED BUFFERR UNIT       24040020
         OI    LCBCSW+3,UNEX            INDICATE END OF MESSAGE         24060020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   24080020
         BAL RA,FINDBUFF                POST PREVIOUS BUFFERS AND       24100020
*                                         GET BUFFER BASE  FOR UNIT     24120020
         B     POSTMSG                  POST MESSAGE TO MH              24140020
         AIF   ('&GEN' EQ 'STSP').L42B                                  24160020
         AIF   ('&GEN' EQ 'MINI').L42B                                  24180020
         AIF   ('&GEN' EQ 'QTAM').L42B                                  24200020
 SPACE 5                                                                24220020
NOEOT    EQU   *                                                        24240020
         TM    LCBMSGFM,LCBENQ .        EQN RECEIVED             S21101 24260020
         BO    NOTTD                    BRANCH YES             @OZ31566 24280082
         SPACE                                                          24320022
         TM    LCBMSGFM,LCBTTD .        TTD                      S22025 24360022
         BO    ITSTTD .                 BRANCH IF YES            S22025 24400022
         SPACE                                                          24440022
         LA    RCCW,LCBCPA+24 .         ASSUME BAD DATA CHARACTERS22025 24480022
         NI    LCBMSGFM,LCBNAK+LCBACKI+LCBOLT REXET FLAGS        S22025 24520022
         B     EXIT3 .                  RESTART                  S22025 24560022
         SPACE                                                          24620020
ERLCOUT  EQU   *                        ERROR ENTRY                     24640020
.L42B    ANOP                                                           24660020
ERWRRSP  EQU   *                                                        24680020
         TM    LCBSTAT2,LCBMSGNN        MSGEN?                 @OY12676 24686091
         BO    RESETTM                  YES - RESET            @OY12676 24692091
         L     RCCW,LCBCPA+12           CURRENT CCW                     24700020
         OI    LCBCSW+3,UNEX            INDICATE END OF MESSAGE         24720020
POSTALL  EQU   *                                                        24740020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   24760020
         BAL   RA,FINDBUFF              LINK TO FREE UP RPEVIOUS        24780020
         B     ERRPOST                                                  24800020
         SPACE                                                          24820020
         AIF   ('&GEN' EQ 'BISC').L43                                   24840020
         AIF   ('&GEN' EQ 'MINI').L43                                   24860020
OPCHK    EQU   *                                                        24900020
         L     RF,OPCHKAD               GET ROUTINE ADDRESS             24920020
         BR    RF                             TSO                       24940020
 EJECT                                                                  24960020
.L43     ANOP                                                           24980020
*                                                                       25000020
* EXIT TO BUILD A WRITE EOT.  THIS EXIT EXPECTS TP OP CODE TO BE SET.   25020020
*                                                                       25040020
RESETEOT EQU   *                                                        25060020
          NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET FLAG FOR SCHEULER S21101 25070020
*                                          ACTIVATE FOR BSC DIAL S21101 25072020
*                                          THAT RECEIVE OP IS NEXS21101 25074020
*                                          AND EOT WAS SENT      S21101 25076020
         MVI   LCBINCAM,0               CLEAR RETRY COUNT FOR RESET     25080020
         SR    RA,RA                   EOT INDEX                        25100020
         LA    RWKA,LCBCPA+16           CCW BUILD AREA                  25120020
         BAL   RD,CCWBLD               BUILD SEQUENCE                   25140020
         B     RESTCOM                 RESTART                          25160020
         SPACE 5                                               @OY10984 25180091
         AIF   ('&GEN' EQ 'MINI').L45                          @OY10984 25181091
         SPACE 5                                               @OY10984 25212091
*                                                                       25215091
* READ ID ENQ FOR BSC DIAL LINE.                                        25220020
*                                                                       25240020
         AIF   ('&GEN' EQ 'MINI').L45                                   25260020
         AIF   ('&GEN' EQ 'STSP').L44                                   25280020
         AIF   ('&GEN' EQ 'QTAM').L44                                   25300020
RTIDENQ  EQU   *                                                        25320020
         CLI   LCBINCAM,0               FIRST TIME                      25340020
         BNE   NOTSTEST                 BRANCH NOT FIRST TIME           25360020
         TS    LCBTSTSW                 HIO TO BE DONE                  25380020
         BNZ   CLEANUP                  YES                             25400020
NOTSTEST EQU   *                                                        25420020
         L     RF,CHACKAD               RESPONSE ROUTINE                25440020
         BALR  RD,RF                    LINK TO IT                      25460020
         CLI   LCBERCCW,RENQ            ENQ RECEIVED                    25480020
         BE    CHKID                    YES                             25500020
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED             25520020
         BNL   DISCON                   BRANCH IF YES                   25540020
         SPACE                                                          25560020
TRYRDID  EQU   *                                                        25580020
         CLI   LCBINCAM,0               FIRST TIME                      25600020
         BNE   BUMP                     NO                              25620020
         MVC   LCBCSWSV,LCBCSW          SAVE CSW                        25640020
BUMP     EQU   *                                                        25660020
         IC    RA,LCBINCAM              GET RETRY COUNT                 25680020
         LA    RA,1(,RA)                BUMP                            25700020
         STC   RA,LCBINCAM              RESTORE                         25720020
         B     EXIT3                    RESTART ON READ ID ENQ          25740020
         SPACE                                                          25760020
CHKID    EQU   *                                                        25780020
         L     RF,IDCHKAD               CHECK ID RWOUINTE               25800020
         BALR  RD,RF                    LINK TO IT                      25820020
         B     EXIT2                    NORMAL REURN                    25840020
         B     TRYRDID                  RETRY READ ID                   25860020
         SPACE 10                                                       25880020
*                                                                       25900020
*        READ ID ACK-0 FOR BSC DIAL LINE.                               25920020
*                                                                       25940020
RTIDACK  EQU   *                                                        25960020
         L     RF,CHACKAD               RESPONSE ROUTINE                25980020
         BALR  RD,RF                    LINK TO IT                      26000020
         L     RF,IDCHKAD               CHECK ID RWOUINTE               26020020
         BALR  RD,RF                    LINK TO IT                      26040020
         B     CHKCPU                   DETERMINE WHERE TO RESTART      26060020
STWRENQ  EQU   *                                                        26080020
         MVI   LCBECBCC,PERMERR .       ASSUME RETRY EXHAUSTED   S21101 26090020
         CLI   LCBINCAM,RETRY .         IS RETRY EXHAUSTED       S21101 26092020
         BNL   ERIDACK .                BRANCH YES               S21101 26094020
         LA    RCCW,LCBCPA+40           WRITE ID(ENQ) CCW               26100005
         B     TRYRDID                  ATTEMPT RTETRY                  26120020
         SPACE                                                          26140020
CHKCPU   EQU   *                                                        26160020
         TM    LCBSTAT1,LCBRECVN        RECEIVE STE (DIAL UP OPTION)    26180020
         BO    EXIT2                    BRANCH YES                      26200005
         TM    CCWFLAGS,CCWSLI          THIS CPU OR END-END CTL         26220020
         BNZ   BSCADD                   BRANCH IF CPU                   26240005
         SPACE                                                          26260020
         TM    LCBERCCW,RACK0           ACK0 RECEIVED                   26280020
         BNO   STWRENQ                  NO RETRY ID ENQ                 26300020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER BACK    S21101 26320020
         B     EXIT2                    RESTART ON NEXT CCW             26340005
         SPACE 10                                                       26360020
.L44     ANOP                                                           26380020
*                                                                       26400020
*        READ ID FROM TWX                                               26420020
*                                                                       26440020
RTTWXID  EQU   *                                                        26460020
         TM    LCBSTAT1,LCBRECVN        DIAL UP OPTION                  26480020
         BO    EXIT2                    BRANCH YES                      26500020
         L     RF,IDCHKAD               ID SCAN ROUTINE                 26520020
         BALR  RD,RF                    LINK TO IT                      26540020
         B     ADDROK                   NORMAL RETURN                   26560020
         B     ERERROR                  INVALID ID                      26580020
         EJECT                                                          26600020
.L45     ANOP                                                           26620020
ERCLOSE  EQU   *                                                        26640020
*                                                                       26660020
*        RETURN FROM ERP AFTER IGE0904G HAS INTERFACED WITH OBR         26680020
* TO RECORD TEMPORARY ERROR COUNTERS IN TERMINAL ENTRIES.               26700020
*                                                                       26720020
         LA    RC,FREERQE               SET EXIT                        26740020
         B     POSTECB                  POST ECB FOR CLOSE              26760020
         SPACE 10                                                       26780020
*                                                                       26800020
*        ABORT RETURN FOR BOTH SEND AND RECEIVE OPERATIONS.  SEQUENCE   26820020
* INITIATED BY LINE END OR IEDQBT.                                      26840020
*                                                                       26860020
RTTXTRST EQU   *                                                        26880020
ERTXTRST EQU   *                                                        26900020
         TM    LCBSTAT1,LCBRECVN        RECEIVE STATE                   26920020
         BZ    ERRSPEB                  NO, IT'S SEND                   26940020
         SPACE                                                          26960020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   26980020
         L     RCCW,LCBCPA+12           LAST BUFFER                     27000020
         BAL   RA,FINDBUFF              LINK TO FREE UP RPEVIOUS        27020020
         B     ERRPOST                  POST BUFFER WITH ERROR          27040020
         SPACE 5                                               @OY14057 27060091
         AIF   ('&GEN' EQ 'STSP').L45A                         @OY14057 27061091
         AIF   ('&GEN' EQ 'MINI').L45A                         @OY14057 27062091
         AIF   ('&GEN' EQ 'QTAM').L45A                         @OY14057 27063091
RTRS3270 EQU   *                                               @OY14057 27064091
ERRS3270 EQU   *                                               @OY14057 27065091
         OI    LCBCHAIN,LCBNORTY        SET NO RETRY           @OX16703 27065591
         MVI   LCBECBCC,PERMERR         MARK PERM ERROR        @OY14057 27066091
         MVI   LCBINCAM,RETRY           INSURE NO RETRIES      @OY14057 27067091
         ICM   RCCW,AD,LCBCPA+THIRTN    RESTORE TEXT CCW ADDR  @OY14057 27068091
         MVC   LCBCSW,LCBCSWSV          RESTORE CSW            @OY14057 27069091
         MVC   LCBSENS0(1),LCBSNSV      RESTORE SENSE          @OY14057 27070091
         MVI   LCBERCCW,NOPCI           FREE BUFFERS NOW       @OY14057 27071091
         BAL   RA,FINDBUFF              FREE PREVIOUS BUFFERS  @OY14057 27072091
         BAL   RB,SETCOUNT              GET EOB OFFSET         @OY14057 27073091
         STH   RC,PRFSIZE               SET SIZE IN BUFFER     @OY14057 27074091
         STCM  RPREFIX,AD,LCBRECAD      SAVE RECORD ADDRESS    @OY14057 27075091
         CLI   LCBCSW+6,0               RESIDUAL COUNT ZERO    @OY14057 27076091
         BE    RTRS3271                 YES, EOB AT END OF UNIT@OY14057 27077091
         LH    RD,CCWCOUNT              ORIGINAL COUNT         @OY14057 27078091
         SH    RD,LCBCSW+5              SUBTRACT RESIDUAL COUNT@OY14057 27079091
         L     RE,CCWADDR-1             DATA ADDRESS           @OY14057 27080091
         AR    RE,RD                    NEW DATA ADDRESS       @OY14057 27081091
         ST    RE,CCWADDR-1             SET NEW ADDRESS        @OY14057 27082091
         MVC   CCWCOUNT,LCBCSW+5        SET NEW COUNT          @OY14057 27083091
RTRS3271 EQU   *                                               @OY14057 27084091
         MVC   LCBCPA+16(8),CCW         SAVE UPDATED CCW       @OY14057 27085091
         B     ERRPOST1                 POST ERROR BUFFER      @OY14057 27086091
         SPACE 5                                               @OY14057 27087091
*                                                              @OY14057 27088091
.L45A    ANOP                                                  @OY14057 27089091
*        ERROR IN RESPONSE TO TEXT                                      27100020
*                                                                       27120020
ERRSPEB  EQU   *                                                        27140020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          27160020
         BNZ   RESETTM                  BRANCH IF YES                   27180020
         L     RCCW,LCBCPA+12           UNIT ADDRESS                    27200020
HIOERR   EQU   *                                                        27220020
         AIF   ('&GEN' EQ 'MINI').M3                                    27240020
         AIF   ('&GEN' EQ 'STSP').M3                                    27260020
         AIF   ('&GEN' EQ 'QTAM').M3                                    27280020
         TM    SCBSTATE,SCBTRANP        TRANSPARENT                     27300020
         BZ    NOTTRNP                  BRANCH NO                       27320020
         SPACE                                                          27340020
         L     RCCW,LCBCPA+52           CURRENT CUNIT ADDRESS           27360020
         MVC   CCW+9(3),LCBCPA+57       LINK NEXT TO CURRENT            27380020
NOTTRNP  EQU   *                                                        27400020
.M3      ANOP                                                           27420020
         MVC   LCBNTXT(1),SCBDEOB       SAVE DISK OFFSET                27440020
         MVC   LCBRECAD(3),SCBDEOB+1    SAVE DISK RECORD ADDRESS        27460020
         MVC   LCBRECOF,SCBEOB          SAVE OFFSET INTO BUFFER         27480020
         MVC   LCBCPA+16(8),CCW         SAVE FOR POSSIBLE MH START      27500020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   27520020
         AIF   ('&GEN' EQ 'MINI').CONC2A                         S22026 27524022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 27528022
         BZ    FREEBUF                  BRANCH IF NO            SA57672 27532022
         TM    SCBERR4,SCBSLCTN         SELECTION ERROR         SA57672 27532522
         BZ    SENDERR                  BRANCH IF NO            SA57672 27533022
         NI    SCBERR4,AVTEFF-SCBSLCTN  RESET ERROR BIT         SA57672 27533522
         OI    LCBCHAIN,LCBNORTY        SET NO RETRY            SA57672 27534022
         B     SENDERR                  GO POST WITH ERROR      SA57672 27534522
FREEBUF  EQU   *                                                SA57672 27535022
.CONC2A  ANOP                                                    S22026 27536022
         BAL   RA,FINDBUFF              LINK TO FREE UP RPEVIOUS        27540020
         NI    PRFSTAT1,X'FF'-PRFITCPN .RESET NOT REAL EOM       X01004 27550005
         B     SENDERR                  SEDN ERROR                      27580020
         SPACE 10                                                       27600020
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM' ).NTSO1    SA48276 27600722
         AIF   ('&GEN' EQ 'BISC' ).NTSO1                        SA48276 27601422
RTRSPMG  EQU   *                                                SA48276 27602122
ERRSPMG  EQU   *                                                SA48276 27602822
         CLI   LCBERCCW+12,X'06'        ACK RECEIVED            SA48276 27603522
         BE    ERBPOST                  MSGGEN RECEIVED OK IF SOSA48276 27604222
         MVI   LCBCSW+3,CEDE            SET GOOD ENDING STATUS  SA48276 27604922
         L     RWORK,LCBSTART-1         GET CCW                 SA48276 27605622
         L     RWORK,0(,RWORK)          ADDRESS OF DATA         SA48276 27606322
         CLC   0(3,RWORK),STARS         WAS IT ***              SA48276 27607022
         BNE   ERBPOST                  IF NOT, IGNORE IT       SA48276 27607722
         LH    RC,LCBTTCIN              GET CONNECTED INDEX     SA48276 27608422
         L     RA,AVTRNMPT              TERM NAME ROUTINE       SA48276 27609122
         USING IEDQTNTD,RA              ADDRESSABILITY          SA48276 27609822
         BAL   RPREFIX,TNTDCODE         GET TERM ENTRY ADDRESS  SA48276 27610522
         USING IEDQTRM,RB               ADDRESSABILITY          SA48276 27611222
         L     RB,TRMDESTQ-1            DESTINATION QCB ADDRESS SA48276 27611922
         DROP  RA,RB                    DROP UNUSED REGS        SA48276 27612622
         USING IEDQQCB,RB               ADDRESSABILITY FOR QCB  SA48276 27613322
         OI    QCBTSOF1,QCBSATRD        TO TRY AGAIN LATER      SA48276 27614022
         MVC   LCBTTBIN,LCBTTCIN        FOR RETRY               SA48276 27614722
         NI    QCBTSOF2,X'FF'-QCBSIMRD  FOR RETRY               SA48276 27615422
         DROP  RB                       THROUGH WITH QCB        SA48276 27616122
         B     ERBPOST                  OPERATION COMPLETE      SA48276 27616822
STARS    DC    X'4A4A4A'                THREE ASTERISKS SATRD   SA48276 27617522
         DS    0H                                               SA48276 27618222
.NTSO1   ANOP                                                   SA48276 27618922
*                                                                       27620020
*        SELECTION ERRORS.                                              27640020
*                                                                       27660020
NOGEN    EQU   *                                                        27680020
ERTWXID  EQU   *                                                        27700020
ERRSPENQ EQU   *                                                        27720020
ERRSPAD  EQU   *                                                        27740020
RTRESET  EQU   *                                                        27760020
ERIDENQ  EQU   *                                                        27780020
ERIDACK  EQU   *                                                        27800020
ERRESET  EQU   *                                                        27820020
ERERROR  EQU   *                                                        27840020
RTRSPAD  EQU   *                                                        27860020
         TM    LCBSTAT2,LCBMSGNN        MESSAGE GEN                     27880020
         BO    ERBPOST                  BRANCH YES                      27900020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE?          @SA71490 27904061
         BNE   REMO                     BRANCH NO              @SA71490 27908061
         MVI   LCBTSTSW,X'F0'           SET FOR NO NEW RECEIVE @SA71490 27912061
REMO     EQU   *                                               @SA71490 27916061
         OI    SCBERR4,SCBSLCTN        INDICATE SELECTION ERROR         27920020
         TM    LCBSTAT1,LCBRECVN         RECEIVE STATE                  27940020
         BZ    ADDERR                   ADDRESSING ERROR                27960020
         MVI   LCBTPCD+11,AVTEZERO      RESET SMI INDICATOR    @YA06316 27970061
         OI    LCBSTAT2,LCBNEGRP        INDICATE NEGATIVE RESPONSE      27980020
LOADBUF  EQU   *                                               @YA06889 27990061
         L     RPREFIX,LCBLSPCI-1       POST FIRST BUFFER TO BD         28000020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').M3A           S21101 28010020
         TM    SCBQTYPE,SCBBFMM .       ARE WE ATTEMPTING TO READS21101 28012020
*                                         SUBSEQUNET PART OF MSG S21101 28014020
*                                         E.G. LMD OR ENQ MODE   S21101 28016020
         BO    POSTPERM .               BRANCH YES, ERP HAS SET  S21101 28018020
*                                         HEADER TO TEXT AND SET S21101 28018420
*                                         PRFSIZE TO REFLECT EOT S21101 28018820
*                                         MOVED INTO BUFFER      S21101 28019220
.M3A     ANOP .                                                  S21101 28019620
MHERR    EQU   *                                                        28020020
         SR    RC,RC                    CLEARF OR 0 LENGTH BUFFER       28040020
         STH   RC,PRFSIZE               CLEAR PREFIX SIZE               28060020
POSTPERM EQU   * .                                               S21101 28070020
         NI    PRFSTAT1,PRFNLSTF        MARK IT LAST                    28080020
         MVI   PRFPRI,PRIMHBFR-1        SET POST PRIORITY               28100020
         B     POSTERR                  POST IT TO MH                   28120020
*                                       MHAND EXIT                      28140020
         SPACE 3                                                        28160020
ADDERR   EQU   *                                                        28180020
         ICM   RCCW,AD,LCBLSPCI         IS BUFFER ASSIGNED       Y01948 28200005
         BNZ   HIOERR                   BRANCH IF YES                   28240020
         SPACE                                                          28260020
         ICM   RA,AD,LCBERBCH           BUFFERS POSTED TO MH     Y01948 28280005
         BZ    GOIDLES                  YES, WAIT FOR BUFFERS           28300020
         OI    SCBERR4,SCBSLCTN .      SET SELECTION ERROR      SA44893 28310022
         AIF   ('&GEN' EQ 'MINI').M4                                    28320020
         CLI   LCBECBCC,PERMERR         HARD ERROR                      28340020
         BNE   NOREDIAL                 BRANCH NO                       28360020
         MVI   LCBTSTSW,AVTEFF          ENSURE A RE-DIAL                28380020
         OI    LCBSTAT2,LCBNEGRP        SET NEGATIVE RESPONSE-          28400020
*                                       OF DIAL OUT CALL Q              28420020
NOREDIAL EQU   *                                                        28440020
.M4      ANOP                                                           28460020
         L     RD,PRFLINK-1-IEDQPRF(,RA) GET NEXT BUFFER -RETURN        28500020
ERRLOOP  EQU   *                                                        28520020
         LA    RD,0(,RD)                CLEAR HI ORDER BYTE             28540020
         LTR   RPREFIX,RD               ANOTHER BYFFER                  28560020
         BZ    NONE                     BRANCH NO                       28580020
         SPACE                                                          28600020
         L     RD,PRFLINK-1-IEDQPRF(,RD) SAVE LINK FIELF                28620020
         MVI   PRFPRI,PRILNEND          SET POST PRIORITY               28640020
         LA    RF,AVTBFRTB              QXB FOR POST                    28660020
         BAL   RC,ENQUEUE               PUT ON READY Q                  28680020
         B     ERRLOOP                  GET NEXT BUFFER                 28700020
         SPACE  2                                                       28720020
NONE     EQU   *                                                        28740020
         XC    LCBERBCH(3),LCBERBCH     CLEAR FIELD                     28760020
         LR    RPREFIX,RA               GET 1ST BUFFER SAVED            28780020
         NC    LCBTTCIN,LCBTTCIN        IS DESTINATION DETERMND@OX17153 28800000
         BZ    NOLMT                    NO, NOT BUFFER BUSY    @OX17153 28800100
         STM   RPREFIX,RC,CNTSAVE       SAVE REGS              @OX17153 28800200
         LH    RC,LCBTTCIN              TERMINAL OFFSET        @OX17153 28800300
         L     RA,AVTRNMPT              TNT CODE BASE          @OX17153 28800400
         USING IEDQTNTD,RA                                     @OX17153 28800500
         BAL   RPREFIX,TNTDCODE         FIND TERMINAL TYPE     @OX17153 28800600
         USING IEDQTRM,RB                                      @OX17153 28800700
         L     RB,TRMDESTQ-1            GET QCB ASSRESS        @OX17153 28800800
         USING IEDQQCB,RB                                      @OX17153 28800900
         TM    QCBELCHN+2,QCBCNTEN      UNUSUAL ADDRESSING RESP@OX17153 28801000
         LM    RPREFIX,RC,CNTSAVE       RESTORE REGS           @OX17153 28801100
         DROP  RA,RB                                           @OX17153 28801200
         BZ    NOLMT                    NO, THIS IS NOT BUFF BUSY       28820020
         SPACE                                                          28840020
         AIF   ('&GEN' EQ 'MINI').M5                                    28860020
         AIF   ('&GEN' EQ 'STSP').M5                                    28880020
         AIF   ('&GEN' EQ 'QTAM').M5                                    28900020
         TM    SCBERR1,SCBRVISL         RVI TO SELECTION                28920020
         BZ    NORVISL                  NO                              28940020
         OI    LCBCHAIN,LCBNORTY        TEXT ERROR AND NO RETRY         28960020
         B     SENDERR                  POST TO MH                      28980020
         SPACE                                                          29000020
NORVISL  EQU   *                                                        29020020
.M5      ANOP                                                           29040020
         MVC   SCBDEOB+1(3),PRFCRCD     FOR BUFFER BUSY -BUFF TERM      29060020
         MVC   SCBDEOB(1),PRFNTXT       SXBDEOB UPDATED BY FA           29080020
         STCM  RA,AD,LCBLSPCI .         SET BUFFER ADDRESS       X01004 29120005
         OI    PRFSTAT1-IEDQPRF(RA),PRFITCPN NOT REAL END OF MSG X01004 29140005
         AIF   ('&GEN' EQ 'MINI').CONC2B .                       S22026 29183022
         TM    SCBQTYPE,SCBCONC .      CONCENTRATOR              S22026 29186022
         BO    MHERR .                 BRANCH IF YES             S22026 29189022
.CONC2B  ANOP .                                                  S22026 29192022
         NI    SCBERR4,SCBSLCTF .      TURN OFF SELECTION ERROR  S22026 29195022
         LA    RA,AVTBFRTB              SET SCBDESTQ TO BUFFER          29200020
*                                         RETURN IN EVENT ERROR         29220020
*                                         OCCURS ON NEXT OPERATION      29240020
*                                         ZERO LENGTH BUFFER WILL       29260020
*                                         NOT BE QUEUED.                29280020
         STCM  RA,AD,SCBDESTQ .         SET UP DEST. Q ADDRESS   Y01948 29300005
         B     CLEANUP                  POST TO DISPOSTIION             29360020
NOLMT    EQU   *                                                        29380020
         NI    SCBQTYPE,AVTEFF-SCBBFMM  RESET MIDDLE OF MSG BIT         29400020
         B     MHERR                    YES, ERROR EXIT                 29420020
         EJECT                                                          29480020
RTEAU    DS    0H                                                S99228 29481022
         L     RPREFIX,LCBLSPCI-ONE     1ST BUFFER ADDR          S99228 29482022
         LA    RPREFIX,ZERO(RPREFIX)    CLEAR HO BYTE            S99228 29483022
         NI    PRFSTAT1,PRFNLSTF        MARK BUFFER AS LAST      S99228 29484022
         OI    LCBERBST,LCBERROR        INDICATE ERROR CONDITION S99228 29485022
*                                       SO BD WILL FREE ALL      S99228 29486022
*                                       BUFFERS                  S99228 29487022
*                                                                S99228 29488022
*        USE POST EXIT FROM LINE END                             S99228 29489022
*                                                                S99228 29490022
         MVI   PRFPRI,PRILNEND          SET POST PRIORITY        S99228 29491022
         L     RF,AVTBSCAN              ADDRESS OF BFR DISP      X02004 29492005
         B     POSTEXIT                 EXIT                     S99228 29494022
         EJECT                                                   S99228 29495022
TEXT     EQU   *                                                        29500020
         MVI   LCBTSTSW,XF0             FOR 2260L AND DIAL              29520020
         LA    RWKA,LCBERCCW+8          THIS OWED RESPONSE              29540020
*                                         WRITE ACK (NAK)               29560020
         CLR   RWKA,RCCW                THIS THE ERRROR                 29580020
         BNE   NOTCONV                  BRANCH IF NO                    29600020
         SPACE                                                          29620020
         LA    RCCW,LCBCPA+16           SET NEW START ADDRES            29640020
         MVI   LCBINCAM,0               RESET RETRY COUNT               29660020
         B     EXIT3                    EXIT FOR RESTART                29680020
NOTCONV  EQU   *                                                        29700020
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'STSP' OR '&GEN' EQ 'QTAMC29704005
               ').M66                                           SA68035 29708005
         BAL   RD,CHKNEG                SET NEG RESP IF NEEDED  SA68035 29712005
.M66     ANOP                                                   SA68035 29716005
         CLI   CCWOPCDE,CCWTIC          CCW A TC - PROG CHECK           29720020
         BNE   NOTIC                    BRANCH IF NO                    29740020
         AIF   ('&GEN' EQ 'MINI').LR40                                  29740522
         TM    LCBSTAT1,LCBRECVN        RECEIVE STATE?           S99228 29741022
         BZ    NODEV                    NO PCI RECVY ON SEND     S99228 29742022
         L     RF,LOOKAD .              LOAD ADDR DVCCSTCS       S99228 29742222
         BALR  RD,RF .                  LINK TO ROUTINE          S99228 29742422
         ST    RE,AVTDOUBX+FOUR .       SAVE INVLIST CWORD ADDR  S99228 29742622
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 29743022
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 29743822
         BZ    NODEV                    BRANCH NO                S99228 29744622
         TM    LCBDCT2,CLOCAL           LOCAL DEVICE?            S99228 29745422
         BZ    NODEV                    BRANCH NO                S99228 29746522
         L     RDCB,LCBDCBPT            SET DCB ADDR             S99228 29747022
         USING IHADCB,RDCB                                       S99228 29748022
         TM    DCBPCI,RCVPCI            TEST FOR REC PCI         S99228 29749022
         DROP  RDCB                                              S99228 29750022
         BZ    NODEV                    NO LOCAL PCI SPEC        S99228 29751022
         SR    RB,RB                    CLEAR RETRY COUNT REG    S99228 29752022
         IC    RB,LCBPCIRC              INSERT PCI RETRY COUNT   S99228 29753022
         LA    RB,ONE(R0,RB)            INCREMENT RETRY COUNT    S99228 29754022
         STC   RB,LCBPCIRC              STORE INCREASED COUNT    S99228 29755022
         CLI   LCBPCIRC,THREE           COUNT AT MAXIMUM?        S99228 29756022
         BNH   RESTART                  RETRY AGAIN              S99228 29757022
NODEV    EQU   *                                                 S99228 29758022
.LR40    ANOP                                                           29759022
         SH    RCCW,H8                  BACK UP TO CCW                  29760020
         MVI   LCBCSW+6,0               INDICATE END OF BUFFER          29780020
         SPACE                                                          29800020
NOTIC    EQU   *                                                        29820020
         L     RD,AVTSAVEX+TWLVE .      DEB ADDRESS              X01004 30000005
         L     RD,DEBAPPAD-DEBNMSUB(,RD) .  APPENDAGE TABLE.     X01004 30010005
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').ME2        X02004 30020005
         TM    TWO(RD),X80              IS ALTMH SPECIFIED       X02004 30030005
         BZ    OWNMHLC                  BRANCH NO                S22029 30064022
         NC    LCBTTCIN,LCBTTCIN        IS CONNECTED INDEX ZERO  S22029 30065022
         BZ    OWNMHLC                  YES - USE OWNING MH LC   S22029 30066022
         L     RWKA,FNDQCBAD .          GET ADDR OF ROUTINE USED S22029 30067022
*                                       TO FIND THE DEST QCB     S22029 30068022
         BALR  RE,RWKA .                GET DEST QCB ADDRESS     S22029 30069022
         LR    RE,R0 .                  FOR CONNECTED MH TEST    S22029 30070022
         TM    QCBDSFLG-IEDQQCB(RE),QCBALTMH IS TERMINAL         S22029 30071022
*                                       CONNECTED TO ALTMH       S22029 30072022
         BZ    OWNMHLC .                NO - USE OWNING MH LC    S22029 30073022
         LA    RD,ONE(,RD)              USE ALTMH OPTIONS        X02004 30074005
OWNMHLC  EQU   * .                                               S22029 30075022
.ME2     ANOP                                                           30076022
         MVC   LCBERCCW+ONE(ONE),0(RD) .STARTMH OPTION BITS      X01004 30080005
         LA    RCCW,AVTEZERO(,RCCW)     CLEAR HI ORDER BYTE             30120051
         AIF   ('&GEN' EQ 'MINI').Z7                                    30123051
         CLI   LCBCPA+24,CCWPOLL        HEADER ON AUTOPOLL              30126051
         BE    AUTOSRC                  YES-DETERMINE SOURCE    SA59028 30129051
         L     RF,LCBDCBPT              LOAD DCB OFFSET         SA64386 30129705
         CLI   DCBEIOBX-IHADCB(RF),X'C8'  LCB LESS THAN C8 LONG SA64386 30130405
         BL    RESUME                   YES, SKIP AUTOPOLL TEST SA64386 30131105
         CLI   LCBCPA+53,AVTEFF         ERP FOR AUTOPOLL DONE   SA59028 30132051
         BNE   RESUME                   NO - NOT AUTOPOLL       SA66604 30135005
AUTOSRC  EQU   *                        AUTO SECTION                    30195022
         SPACE                                                          30200020
         L     RF,POLLAD                ATUOPOLL SOURCE ROUINE          30220020
         BALR  RD,RF                    LINK TO IT                      30240022
RESUME   EQU   *                                                        30241022
         L     RF,LOOKAD .              LOAD ADDR DVCCSTCS       S99228 30242022
         BALR  RD,RF .                  LINK TO ROUTINE          S99228 30243022
         ST    RE,AVTDOUBX+FOUR .       SAVE INVLIST CWORD ADDR  S99228 30244022
         L     RE,AVTDOUBX .            LOAD LCB EXTENSION ADDR  S99228 30245022
         TM    LCBDCT1,C3270 .          3270 DEVICE              S99228 30246022
         BZ    NOCOUNT .                BRANCH IF NO             S99228 30247022
         TM    LCBDCT2,CLOCAL           LOCAL DEVICE             S99228 30248022
         BZ    NOCOUNT .                BRANCH IF NO             S99228 30249022
         MVI   LCBPCIRC,ZERO .          RESET PCI RETRY COUNT    S99228 30250022
NOCOUNT  EQU   *                                                 S99228 30251022
.Z7      AIF   ('&GEN' NE '').L49                                       30280020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        30300020
         BZ    NOTBSC                   NOT BSC                         30320020
.L49     AIF   ('&GEN' EQ 'STSP').L50                                   30340020
         AIF   ('&GEN' EQ 'MINI').L50                                   30360020
         AIF   ('&GEN' EQ 'QTAM').L50                                   30380020
         TM    LCBSTAT1,LCBRECVN        RECEIVE OPERATION               30400020
         BZ    NOTREAD                  NO                              30420020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 30440020
         BE    NOTBSC                   YES, SKIP SCAN                  30460020
         TM    LCBMSGFM,LCBVSTRT+LCBRSTRT >TART BITS ALREADY CHECS21101 30480020
         BNZ   NORM                     YES                             30500020
         L     RF,SCANAD                SCAN ADDRESS                    30520020
         BALR  RD,RF                    LINK TO ROUTINE                 30540020
         SPACE                                                          30560020
NORM     EQU   *                                                        30580020
         TM    LCBMSGFM,LCBEOT+LCBENQ . DLEEOT=SUM OF EOT AND ENQS21101 30600020
         BNO   NOHANGUP                 BRANCH NO                       30620020
         MVI   LCBTSTSW,AVTEFF          FORCE NEW CONNECTION NEXT       30640020
         B     NOTBSC                   CONTINUE PROCESSING             30660020
NOHANGUP EQU   *                                                        30680020
         TM    LCBMSGFM,LCBOLT .        OLT REQUEST              S21101 30700020
         BZ    NOOLT                    BRANCH IF NO                    30720020
         MVI   LCBERCCW+1,IN            FORCE LCIN AND READ TILL EOT    30740020
NOOLT    EQU   *                                                        30820020
         TM    SCBBSCFM,SCBTRNSP        RECEIVE TRANSPARENT             30840020
         BZ    DONTSET                  NO                              30860020
         SPACE                                                          30880020
         NI    LCBERCCW+1,AVTEFF-IN     FORCE LCOUT FOR TRANSPARENT     30900020
DONTSET  EQU   *                                                        30920020
         SPACE                                                          30940020
         TM    LCBMSGFM,LCBTTD .        TTD RECEIVED             S21101 30960020
         BZ    NOTTD                    NO                              30980020
         SPACE                                                          31000020
GOTTTD   EQU   * .                                              SA44892 31005022
ITSTTD   EQU   * .                                               S22025 31010022
         OI    LCBMSGFM,LCBNAK .        RESPONE FOR TTD          S21101 31020020
         LA    RWKA,GOEXIT              SET EXIT ADDRESS       @OZ09279 31021091
SRCPCI   EQU   *                                               @OZ09279 31022091
         SR    RC,RC                    CLEAR FOR INSERT       @OZ09279 31023091
         ICM   RC,AD,LCBLSPCI           GET LAST PCI BUFFER    @OZ09279 31024091
SRCPCI1  EQU   *                                               @OZ09279 31025091
         CLM   RC,AD,LCBCPA+13          IS IT LAST INTERR UNIT @OZ09279 31026091
         BCR   8,RWKA                   BRANCH YES             @OZ09279 31027091
         CLI   TICEND(RC),TWO           END OF CHANNEL PROGRAM?@OZ09279 31028091
         BE    SETPERM                  YES-PERMANENT ERROR    @OZ09279 31029091
         ICM   RC,AD,PRFTIC+1-IEDQPRF(RC) NEXT LSPCI CHAIN UNIT@OZ09279 31030091
         B     SRCPCI1                  SEARCH LCBLSPCI CHAIN  @OZ09279 31031091
SETPERM  EQU   *                                               @OZ09279 31032091
         MVI   LCBECBCC,PERMERR         SET PERMANENT ERROR    @OZ09279 31033091
         OI    SCBERR3,SCBFORMN         SET FORMAT ERROR       @OZ09279 31034091
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR         @OZ09279 31035091
         OI    LCBMSGFM,LCBRSTRT        SET INVALID START      @OZ09279 31036091
         NI    LCBMSGFM,AVTEFF-LCBVSTRT-LCBENQ-LCBTTD-LCBNAK   @OZ09279 31037091
         B     NOCKEND                  EXIT                   @OZ09279 31038091
         SPACE                                                          31120020
NOTTD    EQU   *                                                        31140020
         TM    LCBMSGFM,LCBENQ .        EQN RECEIVED             S21101 31160020
         BZ    NOTBSC                   NO                              31180020
         CLI   LCBINCAM,RETRY           RETRY EXHAUSTED         SA61094 31181005
         BL    BUMPIT                   BR, NO SEND ACK AGAIN   SA61094 31182005
         MVI   LCBINCAM,AVTEZERO        RESET ENQ COUNTER       SA61094 31183005
         OI    LCBCHAIN,LCBABRTN        SEND AN EOT             SA61094 31184005
         B     ITSENQ                   BR                      SA61094 31185005
BUMPIT   EQU   *                                                SA61094 31186005
         SR    RWKA,RWKA                CLEAR FOR INSERT       @OZ09279 31187091
         IC    RWKA,LCBINCAM            GET RETRY COUNT        @OZ09279 31187791
         LA    RWKA,ONE(RWKA)           BUMP BY ONE            @OZ09279 31188491
         STC   RWKA,LCBINCAM            UPDATE COUNT           @OZ09279 31189191
ITSENQ   EQU   * .                                               S22025 31190022
         BAL   RWKA,SRCPCI              CHECK PCI CHAIN        @OZ09279 31195091
         OI    LCBMSGFM,LCBNAK          REQUEST TO SEND NAK    @SA75453 31200000
         L     RWKA,LCBCPA+16           DATA ADDRESS           @SA75453 31202000
         L     RA,LCBDCBPT              GET DCB ADDRESS        @SA75453 31204000
         USING IHADCB,RA                                       @SA75453 31206000
         L     RC,DCBSCTAD-1            SPECIAL CHARACTERS     @SA75453 31208000
         DROP  RA                                              @SA75453 31210000
         SR    RA,RA                    CLEAR WORK REGISTER    @SA75453 31212000
         IC    RA,NAKCH(RC)             NAK INDEX              @SA75453 31214000
         LA    RC,1(RA,RC)              NAK SEQUENCE           @SA75453 31216000
         CLC   0(1,RWKA),0(RC)          TEST FOR NAK SENT      @SA75453 31218000
         BE    GOEXIT                   YES, REBUILD NAK       @XA11162 31220000
         XI    LCBMSGFM,LCBNAK+LCBACKI  TURN OFF NAK AND FLIP  @SA75453 31225000
*                                        ACK COUNTER           @SA75453 31230000
GOEXIT   EQU   *                                                        31235091
         L     RCCW,LCBCPA+12                                           31236091
         MVC   LCBCPA+16(8),CCW         SAVE CCW                        31237091
         B     GOIOGEN                  EXIT TO RESTART                 31238091
         SPACE                                                          31240020
NOTREAD  EQU   *                                                        31260020
         L     RF,BSC27AD                                        S22027 31265022
         BR    RF                                                S22027 31285022
.L50     ANOP                                                           31320020
         EJECT                                                          31340020
NOTBSC   EQU   *                                                        31360020
*                                                                       31380020
*    THE FOLLOWING CODE ESTABLISHES THE TRUE ENTERRUPTED CCW IN         31400020
* RCCW.  (THIS ACCOUNTS FOR THE CASE OF AN EOB OCCURRING IN THE         31420020
* LAST POSITION OF A UNIT.)  RPREFIX IS ALSO ESTABLISHED TAKING         31440020
* INTO CONSIDERATION THAT A PCI MIGHT HAVE BEEN MISSED OR THAT PCI      31460020
*        IF PCI IS NOT USED ON RECEIVE OPERATIONS, ALL BUFFERS UP TO    31480020
* THE ONE WHICH PRESENTED AN EOB OR ETB INTERRUPT ARE POSTED TO MH.     31500020
* SIMILARLY, BUFFERS ARE POSTED TO THE AVAILABLE BUFFER QUEUE  FOR      31520020
* OUTPUT OPERATIONS.                                                    31540020
*                                                                       31560020
* IS NOT USED.                                                          31580020
         AIF   ('&GEN' EQ 'MINI').CONC3                          S22026 31581022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 31582022
         BNO   NOTCONCC .               BRANCH IF NO             S22026 31583022
         STCM  RCCW,AD,SCBXTRA          INTERRUPTED UNIT         Y01948 31587005
SAVECCW  EQU   * .                                               S22026 31592022
         MVC   SCBXTRA+3(8),0(RCCW) .   SAVE CCW                 S22026 31593022
         CLI   LCBINCAM,ZERO .          ERROR RECOVERY           S22026 31594022
         BNE   NOTCONCC .               BRANCH IF YES            S22026 31595022
         MVC   SCBXTRA+11(4),LCBCPA+12 .SAVE TEXT START          S22026 31596022
NOTCONCC EQU   * .                                               S22026 31597022
.CONC3   ANOP                                                    S22026 31598022
         L     RE,LCBLSPCI-1            LAST SERVICEC  BUFFER           31600020
         LA    RE,0(,RE)                CLEAR HI ORDER BYTE             31620020
         LR    RPREFIX,RE               COPY BUFFER ADDRESS             31640020
         CLC   CCWCOUNT+1(1),LCBCSW+6   RESIDUAL COUNT EQ ORIGINAL      31660020
         BNE   NOTEQ                    NO                              31680020
         CLI   CCWCOUNT+1,AVTEZERO      WAS ORIG COUNT ZERO    @OS76271 31683091
         BNE   ORIZERO                  BRANCH-NO CONTINUE     @OS76271 31686091
         MVI   LCBECBCC,PERMERR         SET PERM ERROR         @OS76271 31689091
         B     NOTEQ                    GO HANDLE CPC          @OS76271 31692091
ORIZERO  EQU   *                                               @OS76271 31695091
         LA    R0,ONE                   LOAD A POSITIVE VALUE           31700020
         CLR   RE,RCCW                  BUFFER SAME AS CURRENT CCW      31720020
         BNE   CKBUF                    BRANCH IF NO                    31740020
         TM    LCBSTAT1,LCBSENDN        SEND SIDE                       31760020
         BO    LASTBUF                  BRANCH IF YES                   31780020
         LNR   R0,R0 .                  REMEMBER CONDITON               31800020
CKBUF    EQU   *                                                        31820020
         L     RF,LCBCPA+12             LAST TEXT CCW                   31840020
         LA    RF,0(,RF)                CLEAR HI ORDER BYTE             31860020
         CR    RF,RCCW                  SAME AS ENDING CCWIN CSW        31880020
         BNE   LOOPCT                   BRANC NO                        31900020
         TM    LCBSTAT1,LCBSENDN        SEND SIDE                       31920020
         BO    LOOPCT                   YES                             31940020
         AIF   ('&GEN' EQ 'STSP').M6                                    31960020
         AIF   ('&GEN' EQ 'MINI').M6                                    31980020
         AIF   ('&GEN' EQ 'QTAM').M6                                    32000020
         CLI   LCBTPCD+3,TPRDLC         READ LC OUT                     32020020
         BNE   NORDLC                   BRANCH IF NO                    32040020
         TM    CCWFLAGS,CCWSLI          SAME CCW AS LAST RESTART OR     32060020
*                                         HAVE WE WRAPPED AND UNIT      32080020
*                                         BEEN RE-USED                  32100020
         BZ    RDLCENT                  BRANCH IF NOT WRAPPED           32120020
         B     LOOPCT                   WRAPPED CONDITION               32140020
NORDLC   EQU   *                                                        32160020
.M6      ANOP                                                           32180020
         TM    PRFSTAT1-IEDQPRF(RE),PRFNHDRN HEADER BUFFER-POSSIBLE     32200020
*                                         NO IF HEADER BUFFER IS RE-    32220020
*                                         USED VIA PCI                  32240020
         BO    TSTSLI                   YES                             32260020
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'BISC').M61               32280020
         AIF   ('&GEN' EQ 'QTAM').M61                                   32300020
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 32320020
         BO    NOTEQ                    BRANCH ON YES               TSO 32340020
.M61     ANOP                                                           32360020
         TM    LCBCSW+3,UNEX            UNIT EXCEPTION                  32380020
         BZ    NOTEQ                    NO, TRUE CCW SET                32400020
         SPACE                                                          32420020
         B     RTPOLL                   BUMP POLLING POINTER            32440020
TSTSLI   EQU   *                                                        32460020
         TM    CCWFLAGS,CCWSLI          HAVE E WRAPPED                  32480020
         BZ    NOTEQ                    NO                              32500020
         SPACE                                                          32520020
LOOPCT   EQU   *                                                        32540020
         LTR   R0,R0 .                  LSCPI SAMEAS ENDING CCW         32560020
         BM    NOTEQ                    BRANCH IF YES                   32580020
LOOPCT1  EQU   *                                                        32600020
         LR    RD,RE                    SAVE PRECIOUS CCW               32620020
         L     RE,8(,RE)                NEXT CCW IN CHAIN               32640020
         LA    RE,0(,RE)                CLEAR FOR CMPARE                32660020
         CR    RE,RCCW                  THIS INTERRUPTED CCW            32680020
         BNE   LOOPCT1 .                NO, LOOK AT NEXT                32700020
         MVC   LCBCPA+16(8),0(RE)       SAVE CONTINUE CCW      @SA71963 32710061
         SPACE                                                          32720020
         LA    RCCW,0(,RD)              TRUE ENDING CCW                 32740020
         MVI   LCBCSW+6,0               CLEAR RESIDUAL COUNT            32760020
         AIF   ('&GEN' EQ 'MINI').CONC3A                         S22026 32762022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 32764022
         BNO   NOTCONCE .               BRANCH IF NO             S22026 32766022
         MVC   SCBXTRA+3(8),0(RCCW) .   SAVE CCW                 S22026 32768022
         STCM  RCCW,AD,SCBXTRA          SET INTERRUPTED UNIT     Y01948 32768505
NOTCONCE EQU   * .                                               S22026 32770022
.CONC3A  ANOP                                                    S22026 32772022
         SPACE                                                          32780020
NOTEQ    EQU   *                                                        32800020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 32820020
         AIF   ('&GEN' NE '').Z81                                       32840020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        32860020
         BZ    NOCKEND                  NO                              32880020
.Z81     AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z8                32900020
         AIF   ('&GEN' EQ 'QTAM').Z8                                    32920020
         SPACE                                                          32940020
         BAL   RC,FINDEOB  .            GET ADDRESS OF LAST CHAR S99228 32960022
         BAL   RC,CKEND  .              CHECK START AND END CHAR S99228 32961022
NOCKEND  EQU   *                                                 S99228 32962022
.Z8      ANOP                                                    S99228 32963022
         AIF   ('&GEN' EQ 'QTAM' OR '&GEN' EQ 'MINI').LL45       S99228 32963522
         TM    LCBSTAT1,LCBRECVN        RECEIVE STATE?           S99228 32964022
         BZ    NOGPOLL                  NO SKIP GENPOLL TEST     S99228 32965022
         TM    LCBFLAG3,LCBOBRRD        SOH%R MESSAGE FOR OBR?   S99228 32965322
         BO    NOGPOLL                  BRANCH YES               S99228 32965622
         NC    LCBTTCIN(2),LCBTTCIN     POLLRT DETERMINE INVALID S99228 32966022
*                                       SOURCE?                  S99228 32967022
         BZ    NOGPOLL                  SOURCE ZERO TREAT AS SPECS99228 32968022
*                                       POLL                     S99228 32969022
SLOWPOLL EQU   *                                                 S99228 32971322
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 32971622
         TM    LCBDCT1,CUMASK           GENERAL POLL IN PROGRESS?S99228 32972022
         BZ    NOGPOLL                  NO BYPASS SOURCE DETERM  S99228 32973022
         TM    LCBMSGFM,LCBOLT          TRM PRESENT?             S99228 32973322
         BO    SRCSET                   BRANCH YES               S99228 32973622
         TM    LCBXFLAG,LCBSRCPF        SRC DETERM PERFORMED?    S99228 32974022
         BO    SRCCOMP                  YES, SKIP SRC DET        S99228 32975022
         LA    RA,LCBCPA+40 .           LOAD ADDR TCBUF CCW      S99228 32976022
         CLI   LCBCPA+24,CCWNOP         AUTOPOLL IN PROGRESS?   SA66598 32977005
         BL    MANUAL                   NO, PROGRAM POLL        SA66598 32977105
         SR    RC,RC                    CLEAR FOR IC            SA66598 32977205
         L     RF,LCBDCBPT              GET DCB ADDRESS         SA66598 32977305
         IC    RC,LCBUCBX               GET RLN                 SA66598 32977405
         SLL   RC,TWO                   MULTIPLY BY FOUR        SA66598 32977505
         L     RC,DCBINVLI-IHADCB(RC,RF) GET ILIST ADDRESS      SA66598 32977605
         TM    THREE(RC),AUTOPL         AUTOPOLL IN PROGRESS    SA66598 32977705
         BZ    MANUAL                   NO, PROGRAM POLL        SA66598 32977805
         CLI   LCBCPA+48,CCWPOLL        IS THIS FIRST HEADER    SA66598 32977905
         BNE   MANUAL                   NO, MANUAL POLL         SA66598 32978005
         MVI   LCBCPA+48,CCWNOP         NOP FOR NEXT HEADER     SA66598 32978105
         LA    RA,LCBCPA+72 .           LOAD ADDR TCBUF CCW      S99228 32979022
MANUAL   EQU   *                                                 S99228 32981022
         L     RWKA,ZERO(R0,RA)         LOAD BUFFER ADDRESS      S99228 32984022
         L     RF,SORCEAD               LOAD SOURCE ROUTINE ADDR S99228 32985022
         BALR  RD,RF                    BRANCH TO SRC DET RTN    S99228 32986022
SRCSET   EQU   *                                                 S99228 32986322
         OI    LCBXFLAG,LCBSRCPF        INDICATE SRC DETERMINED  S99228 32986622
SRCCOMP  EQU   *                                                 S99228 32987022
         AIF   ('&GEN' EQ 'STSP').LL4B                           S99228 32987522
         TM    LCBSTAT2,LCBSYNC         BSYNC LINE               S99228 32988022
         BZ    NOCHECK                  NO, BYPASS LINE CON CHECKS99228 32989022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 32990022
         TM    LCBXFLAG,LCBERPND        END CHAR ENQ?            S99228 32990522
         BO    NOLOOK                   SKIP EOT INSERT          S99228 32991022
         TM    SCBBSCFM,SCBRCVTX        ETX RECD BSYNC LINE      S99228 32992022
         BNO   NOGPOLL                  NO BYPASS GENPOLL SET    S99228 32993022
NOCHECK  EQU   *                                                 S99228 32994022
.LL4B    ANOP                                                    S99228 32994522
         L     RA,LCBDCBPT              LOAD DCB ADDR            S99228 32995022
         USING IHADCB,RA                                         S99228 32996022
         L     RF,DCBSCTAD-ONE          LOAD ADDR SPEC CHARS     S99228 32997022
         DROP  RA                                                S99228 32998022
         SR    RC,RC                    CLEAR WORK REGISTER      S99228 32999022
         IC    RC,ZERO(R0,RF)           INSERT EOT OFFSET        S99228 33000022
         LA    RC,ONE(RC,RF)            LOAD ADDR EOT CHAR       S99228 33001022
         LR    RF,RCCW                  LOAD ADDR TRUE INTRPT CCWS99228 33002022
         CLI   CCWOPCDE,CCWTIC          INTERRUPTED CCW A TIC   SA66632 33002205
         BE    NOLOOK                   YES, SKIP EOT MOVE      SA66632 33002405
         LH    RD,SIX(R0,RF)            LOAD CCW COUNT           S99228 33002722
         LH    RA,LCBCSW+FIVE           LOAD RESIDUAL COUNT      S99228 33003422
         SR    RD,RA                    DERIVE COUNT DATA READ   S99228 33004122
         L     RF,ZERO(R0,RF)           LOAD DATA ADDR           S99228 33004822
         AR    RF,RD                    SET EOT BUFFER POSITION  S99228 33005522
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 33006222
         BO    LCINSIDE                 YES, CHECK RESIDUAL CNT  S99228 33006922
         BCTR  RF,R0                    SET BUFFER EOT POSITION  S99228 33007622
*                                       TO OVERWRITE ETX         S99228 33008322
         B     EOTMOVE                  INSERT EOT               S99228 33009022
LCINSIDE EQU   *                                                 S99228 33009722
         LTR   RA,RA                    RESIDUAL COUNT ZERO?     S99228 33010422
         BNZ   EOTFILL .                BRANCH IF NO             S99228 33011122
ZERORES  EQU   *                                                 S99228 33012522
         L     RF,LCBCSW-ONE            LOAD INTERRUPT ADDR      S99228 33013222
         LA    RF,ZERO(R0,RF)           CLEAR HI ORDER BYTE      S99228 33013922
         SH    RF,H8                    SET ADDR NEXT CCW        S99228 33014622
         CLI   CCWOPCDE-IEDQCCW(RF),CCWTIC  INTERRUPT ON A TIC @YA06327 33014861
         BE    NOLOOK                   YES, SKIP EOT MOVE      SA66632 33015005
         LR    RCCW,RF                  SET NEW TRUE INTERRUPT   S99228 33015322
*                                       CCW                      S99228 33016022
         L     RF,ZERO(R0,RF)           LOAD DATA ADDR           S99228 33016722
         LH    RA,CCWCOUNT              LOAD CCW COUNT           S99228 33017422
EOTFILL  EQU   *                                                 S99228 33018122
         BCTR  RA,R0                    REDUCE RESIDUAL COUNT    S99228 33018822
         STH   RA,LCBCSW+FIVE           RESTORE RESIDUAL COUNT   S99228 33019522
EOTMOVE  EQU   *                                                 S99228 33020222
         TM    LCBSTAT2,LCBSYNC         BISYNC LINE?             S99228 33020522
         BO    SYNCON                   BRANCH YES               S99228 33020822
         LA    RC,ONE(R0,RC)            POINT TO FIRST EOT       S99228 33021122
SYNCON   EQU   *                                                 S99228 33021422
         MVC   ZERO(ONE,RF),ZERO(RC)    MOVE EOT INTO BUFFER     S99228 33022022
NOLOOK   EQU   *                                                 S99228 33023022
         CLI   LCBECBCC,PERMERR         PERM ERROR PRESENT?      S99228 33027022
         BE    NOGPOLL1                 YES,LEAVE ETX FLAG UNSE@OX12505 33028091
         TM    SCBERR4,SCBTXTTN         TEXT ERROR?              S99228 33028322
         BO    NOGPOLL1                 BRANCH YES             @OX12505 33028691
         OI    LCBXFLAG,LCBGPCTV        SET GENPOLL IN PROGRESS  S99228 33029022
         B     NOGPOLL                  EXIT GENERAL POLL CODE@OX12505  33029291
NOGPOLL1 EQU   *                                               @OX12505 33029491
         OI    LCBCSW+THREE,UNEX        SET EOT RECEIVED       @OX12505 33029691
         B     NOGPOLL                                         @OX12505 33029891
NOGPOLL  EQU   *                                                 S99228 33030022
         L     RA,LCBDCBPT              LOAD DCB POINTER         S99228 33031022
.LL45    ANOP                                                    S99228 33035022
         USING IHADCB,RA                                                33040020
         AIF   ('&GEN' EQ 'STSP').CONC3B                         S22026 33042022
         AIF   ('&GEN' EQ 'MINI').CONC3B                         S22026 33044022
         AIF   ('&GEN' EQ 'QTAM').CONC3B                         S22026 33046022
         TM    LCBFLAG3,LCBOBRRD .      TPER RECORD              S22026 33048005
         BZ    CONTINUE .               NO, CONTINUE             S99238 33048305
         NC    LCBRECOF,LCBRECOF        READ CONTINUE           SA68026 33048605
         BZ    ERPCHK                   BR NO, CONTINUE         SA68026 33048905
         NI    LCBFLAG3,AVTEFF-LCBOBRRD RESET OBR REQUEST       SA68026 33049205
         B     TEXT                     TREAT AS TEXT           SA68026 33049505
ERPCHK   EQU   *                                                SA68026 33049805
         SPACE                                                          33050322
         CLI   LCBECBCC,PERMERR .       PERMANENT ERROR          S99238 33050622
         BNE   ERPEXIT .                NO, SCHEDULE ERP         S99238 33050922
         SPACE                                                          33051222
CONTINUE EQU   * .                                               S99238 33051522
.CONC3B  ANOP                                                    S22026 33052022
         MVI   LCBERCCW,NOPCI           ASSUME NO PCI USED              33060020
         TM    LCBCSW+4,PCIFLAG         PCI FLAG ON                     33080020
         BO    PROCBUFF                 BRANCH IF YES                   33100020
         SPACE                                                          33120020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 33140020
         BE    PROCBUFF                 YES, FRREE UP BUFFERS           33160020
         SPACE                                                          33180020
         TM    LCBSTAT1,LCBSENDN        SEND SIDE                       33200020
         BZ    RCVOP                    NO                              33220020
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 33221022
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 33222022
         BZ    CHAINBY                  BRANCH NO                S99228 33223022
         TM    LCBDCT2,CLOCAL           LOCAL DEVICE?            S99228 33224022
         BZ    CHAINBY                  BRANCH NO                S99228 33225022
         MVI   LCBERCCW,PCIOPT          SET TO FREE BUFFERS AT   S99228 33226022
*                                       COMPLETION OF CHNL PGM   S99228 33227022
         TM    CCWFLAGS,CCWCC+CCWCD     CHAINING FLAGS ON?       S99228 33228022
         BNZ   CHAINBY                  BRANCH YES               S99228 33229022
         MVI   LCBERCCW,NOPCI           SET TO FREE BUFFERS NOW  S99228 33230022
CHAINBY  EQU   *                                                 S99228 33231022
         SPACE                                                          33240020
         TM    DCBPCI,SNDPCI            PCI ON SEND SIDE                33260020
         BZ    PROCBUFF                 NO, FREE UP BUFFERS             33280020
         SPACE                                                          33300020
         TM    CCWFLAGS,CCWCC+CCWCD     ANY FLAGS                       33320020
         BZ    PROCBUFF                 FREE BUFFERS END OF MSG         33340020
         SPACE                                                          33360020
         B     SETPARM                  SET PARAMETER FOR LATER USE     33380020
         SPACE 2                                                        33400020
RCVOP    EQU   *                                                        33420020
         TM    DCBPCI,RCVPCI            PCI ON RECEIVE                  33440020
         BZ    PROCBUFF                 NO, FREE UP BUFFERS             33460020
         SPACE                                                          33480020
         AIF   ('&GEN' EQ 'QTAM' OR '&GEN' EQ 'MINI').LL46       S99228 33482022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 33484022
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 33485022
         BZ    RECHECK                  BRANCH NO                S99228 33486022
         TM    LCBDCT2,CLOCAL           LOCAL DEVICE?            S99228 33487022
         BO    PROCBUFF                 BRANCH YES               S99228 33488022
RECHECK  EQU   *                                                 S99228 33489022
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 33490022
         BO    PROCBUFF                 YES, SKIP PCIOPT SET     S99228 33496022
.LL46    ANOP                                                    S99228 33498022
         TM    LCBERCCW+1,LOGICAL+CONV+LMD   IS THERE AN MH EXIT S22025 33500022
         AIF   ('&GEN' EQ 'MIMI').LL46C                         SA59028 33520022
         AIF   ('&GEN' EQ 'QTAM').LL46C                         SA59028 33521022
         BZ    SETPARM1                 NO-CHECK FOR EOT        SA59028 33522022
         TM    LCBTSOB,LCBTSBUF         TSO IN SESSION          SA59028 33523022
         BZ    PROCBUFF                 NO-FREE UP DEVICE       SA59028 33524022
         TM    LCBDCT1,C3270            3270 DEVICE             SA59028 33525022
         BZ    PROCBUFF                 NO-FREE UP BUFFERS      SA59028 33526022
         TM    LCBDCT2,CREMOTE          BSC DEVICE              SA59028 33527022
         BZ    PROCBUFF                 NO-FREE UP BUFFERS      SA59028 33528022
         TM    SCBBSCFM,SCBRCVTX        ETX RECD BSYNC LINE     SA59028 33529022
         BO    PROCBUFF                 YES- FREE UP BUFFERS    SA59028 33530022
SETPARM1 EQU   *                                                SA59028 33531022
         AGO   .LL46B                                           SA59028 33532022
.LL46C   ANOP                                                   SA59028 33533022
         BNZ   PROCBUFF                 YES- FREE UP BUFFERS    SA59028 33534022
.LL46B   ANOP                                                   SA59028 33535022
         TM    LCBCSW+3,UNEX            EOT RECEIVED                    33540020
         BO    PROCBUFF                 YES, FREE UP BUFFERS            33560020
SETPARM  EQU   *                                                        33580020
         MVI   LCBERCCW,PCIOPT          SET FLAG ,POST BUFFERS LATER    33600020
*                                         PCI WILL DO IT TO REQUEST     33620020
*                                         MORE NEEDED BUFFERS           33640020
PROCBUFF EQU   *                                                        33660020
         AIF   ('&GEN' EQ 'MINI').CONC4                          S22026 33662022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 33664022
         BZ    NOTCONCF .               BRANCH IF NO             S22026 33666022
         CLI   LCBECBCC,PERMERR .       PERMANET ERROR           S22026 33668022
         BE    NOTCONCF .               BRANCH IF YES            S22026 33670022
         MVI   LCBERCCW,PCIOPT .        SET PCI FLAG             S22026 33672022
         OI    SCBSTAT1,SCBNOPST .      INDICATE NO POST         S22026 33674022
NOTCONCF EQU   * .                                               S22026 33676022
.CONC4   ANOP                                                    S22026 33678022
         DROP  RA                                                       33680020
         LA    RA,FOUND                 SEST EXIT FROM SUBROUTINE       33700020
         EJECT                                                          33720020
FINDBUFF EQU   *                                                        33740020
*        THE FOLLOWING SUBROUTIE WILL DETERMINE THE FIRST UNIT          33760020
* UNIT OF A BUFFER FOR THE UNIT WHICH PRESENTED THE INTERRUPT.          33780020
* RCCW CONTAINS THE ADDRESS OF THE ENDING UNIT.  RPREFIX WILL POINT     33800020
* TO THE BUFFER. IN ADDITION, RB WILL CONTIN THE COUNT OF BUFFERS       33820020
* UP TO,BUT NOT INCLUDING THE INTEDRRUPTED BUFFER.  IF LCBERCCW IS      33840020
* EQUAL TO 00 (NOPCI) ALL PREVIOUS BUFFERS WILL BE POSTED TO THE        33860020
* AVAILABLE BUFFER QUEUE (SEND) OR TO MH (RECEIVE).                     33880020
         LA    RCCW,0(,RCCW)            CLEAR HI ORDER BYTE -COMPARE    33900020
         SR    RB,RB                    CLEAR FOR BUFFER COUNT          33920020
         LR    R0,RB                    CLEAR WORK REGISTER             33940020
         L     RE,LCBLSPCI-1            LAST SERVICED BUFFER            33960020
LOOP2    EQU   *                                               @OZ07786 33970091
         LR    RPREFIX,RE               SAVE BUFFER ADDRESS             33980020
         IC   R0,PRFNBUNT              NUMBER OF NNIT SON BUFFER        34000020
ENTER    EQU   *                                                        34100020
         LA    RE,0(,RE)                CLEAR FOR COMPARE               34120020
         CR    RE,RCCW                  THIS INTERRUPTED CCW            34140020
         BNE   BCTIT .                  BRANCH NO -GET NEXT UNIT S21101 34160020
         SPACE 1                                                 S21101 34170020
         CLI   LCBERCCW,PCIOPT .        PCI TO FREE BUFFERS      S21101 34172020
         BCR   8,RA .                   BRANCH YES               S21101 34174020
         SPACE 1                                                 S21101 34176020
         STCM  RPREFIX,AD,LCBLSPCI      SET LAST SERVICED BUFFER Y01948 34178005
         BR    RA .                     RETURN TO CALLER         S21101 34179220
         SPACE 1                                                 S21101 34179620
BCTIT    EQU   *                                                 S21101 34179720
         SPACE                                                          34180020
         L     RE,PRFTIC-IEDQPRF(,RE)   NEXT CCW ADDRESS       @OZ07786 34200091
         BCT   R0,ENTER                 CHECK NEXT UNIT        @OZ07786 34210091
         SPACE                                                          34220020
         TM    LCBSTAT1,LCBSENDN        SEND STATE                      34260020
         BO    SEND                     YES                             34280020
         USING IHADCB,RD                                                34300020
         L     RD,LCBDCBPT              GET DCB ADDRESS                 34320020
         MVC   PRFSIZE,DCBBUFSI         SET PREFIX SIZE                 34340020
         MVI   PRFPRI,PRIMHBFR          POST PRIORITY                   34360020
         L     RF,DCBMH-1               QCB POST ADDRESS                34380020
         DROP  RD                                                       34400020
BUFFPOST EQU   *                                                        34420020
         CLI   LCBERCCW,PCIOPT          CPI TO FREE BUFFERS             34440020
         BE    LOOP2                    YES,DON'T FREE BFRS    @OZ07786 34460091
         BAL   RC,ENQUEUE               PUT ON READYBQUEUE              34480020
         B     LOOP2                    LOOP ON NEXT BUFFER             34560020
         SPACE                                                          34580020
SEND     EQU   *                                                        34600020
         AIF   ('&GEN' EQ 'MINI').CONC4A                         S22026 34602022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 34604022
         BZ    NOTCONCG .               BRANCH IF NO             S22026 34606022
         TM    SCBSTAT1,SCBNOPST .      POST BUFFERS             S22026 34608022
         BO    LOOP2                    BRANCH IF NO           @OZ07786 34610091
NOTCONCG EQU   * .                                               S22026 34612022
.CONC4A  ANOP                                                    S22026 34614022
         LA    RF,AVTBFRTB              BUFFER RETURN                   34620020
         MVI   PRFPRI,PRIBFRTB          SET POST PRIORITY               34640020
         B     BUFFPOST                                                 34660020
         EJECT                                                          34680020
FOUND    EQU   *                                                        34700020
         AIF   ('&GEN' EQ 'MINI').CONC4B                         S22026 34702022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 34704022
         BZ    NOTCONCH .               BRANCH IF NO             S22026 34706022
         NI    SCBSTAT1,255-SCBNOPST .  RESET POST FLAG          S22026 34708022
NOTCONCH EQU   * .                                               S22026 34710022
.CONC4B  ANOP                                                    S22026 34712022
         STC   R0,LCBERCCW+3            SVAE FORLATER                   34720020
         LR    RD,RPREFIX               SAVE FOR UPDATING COUNTS        34760020
         CLI   LCBCSW+6,0               RESIDUAL COITN 0                34780020
         BNE   CURRCCW                  NO                              34800020
         TM    CCWFLAGS,CCWCD+CCWCC     ANY CHAINING FLAGS ON           34820020
         BNZ   NOEOTSNT                 BRANCH EOT NOT SENT             34840020
         CLI   LCBECBCC,PERMERR         TEXT ERROR                      34860020
         BNE   TESTRSP                  BRANH NO                        34880020
SENDERR  EQU   *                                                        34900020
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR                  34920020
         OI    LCBERBST,LCBERROR        ASSOGN NO MORE BUFFERS          34940020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 34960020
         USING IHADCB,RA                                                34980020
         L     RF,DCBMH-1               MH QCB ADDRESS                  35000020
         SPACE                                                          35020020
*        IF NO RECAL IS GOING TO BE PERFORMED AND WE ARE STILL          35040020
*        READING FROM DISK RECALL ADDRESS MUST BE BUFF DISPOSITION      35060020
         TM    LCBCSW+3,UNEX .          ABORT OR UNIT EXCEPTION  S21101 35070020
         BO    SETBD .                  BRANCH IF YES            S21101 35072020
         SPACE                                                          35074020
         TM    LCBCHAIN,LCBNORTY .      NO RETRY POSSIBLE               35080020
         BO    SETBD                    BRANCH IF YES                   35100020
        CLI   LCBINCAM,RETRY .         RETRY LIMIT REACHED              35120020
         BNL   SETBD .                  BRANCH IF RETRY EXHAUSTED       35140020
         AIF   ('&GEN' EQ 'MINI').CONC5                          S22026 35141022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 35142022
         BNO   NOTCONCD .               BRANCH IF NO             S22026 35143022
         IC    RA,LCBINCAM .            GET RETRY COUNT          S22026 35144022
         LA    RA,1(RA) .               ADD ONE                  S22026 35145022
         STC   RA,LCBINCAM .            STORE BACK               S22026 35146022
         L     RA,SCBXTRA-1 .           GET SAVED UNIT ADDR      S22026 35147022
         MVC   0(8,RA),SCBXTRA+3 .      RESTORE CCW              S22026 35149022
         L     RCCW,SCBXTRA+11 .        RESTORE TEXT START       S22026 35150022
         NI    LCBERBST,255-LCBERROR .  RESET ERROR              S22026 35151022
         NI    SCBERR4,255-SCBTXTTN .   RESET TEXT ERROR         S22026 35152022
         B     EXIT3 .                  RESTART                  S22026 35153022
NOTCONCD EQU   * .                                               S22026 35154022
.CONC5   ANOP                                                    S22026 35155022
         SPACE                                                          35160020
         AIF   ('&GEN' EQ 'MINI').MIX0350                        S22029 35162022
         AIF   ('&GEN' EQ 'BISC').MIX0350                        S22029 35164022
         AIF   ('&GEN' EQ 'QTAM').MIX0350                        S22029 35166022
         TM    LCBTSOB,LCBTSBUF         IS A TIME-SHARING        S22029 35168022
*                                       TERMINAL ON THIS LINE    S22029 35170022
         BO    SETBD                    YES,SETUP ERB FOR BD     S22029 35172022
.MIX0350 ANOP                                                    S22029 35174022
         MVC   LCBRCQCB+1(3),DCBMH      ASSUME BT                       35180020
         L     RF,AVTSAVEX+TWLVE .      DEB ADDRESS              X01004 35200005
         DROP  RA .                     DROP DCB BASE.           X01004 35210005
         L     RF,DEBAPPAD-DEBNMSUB(,RF) .  APPENDAGE TABLE.     X01004 35220005
         TM    ZERO(RF),MHBT            IS IEDQBT IN THIS MH     X01004 35230005
         BO    MHERR .                  BRANCH NO                X01004 35240005
SETBD    EQU   *                                                        35260020
         AIF   ('&GEN' EQ 'MINI').CONC5A                         S22026 35262022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 35264022
         BZ    ALLFREED .               NO, DON'T FREE BUFFERS   S22026 35266022
         BAL   RA,FINDBUFF .            FREE UP PREVIOUS BUFFERS S22026 35268022
         OI    PRFSTAT1,PRFNHDRN .      SET TEXT BUFFER TO AVOID S22026 35270022
*                                       FEFO UPDATE              S22026 35272022
ALLFREED EQU   * .                                               S22026 35274022
.CONC5A  ANOP .                                                  S22026 35276022
         MVC   LCBRCQCB+ONE(THREE),AVTBSCAN+ONE SET IEDQBD ADDR  X01004 35280005
         B     MHERR                    POST BUFFER TO MH               35320020
TESTRSP  EQU   *                                                        35340020
         BAL   RC,FINDEOB               EOB AT END OF BUFFER            35360020
         LA    RA,ONE(RWKA)             BSC EOB CHAR           @OY13656 35380091
         TM    LCBSTAT2,LCBSYNC         BSC LINE?              @OY13656 35383091
         BO    CKEOB                    BR YES                 @OY13656 35386091
         BCTR  RA,0                     POINT TO START/STOP EOB@OY13656 35389091
CKEOB    EQU   *                                               @OY13656 35392091
         CLC   0(ONE,RA),0(RB)          IS EOB LAST CHARACTER? @OY13656 35395091
         BNE   EOTSNT1                  NO,EOT WAS SENT                 35400020
         STCM  RPREFIX,AD,LCBLSPCI      SET LSPCI                Y01948 35410005
RDRSP    EQU   *                                                        35420020
         ST    RCCW,LCBCPA+12           SAVE TO POST LAST BUFFER        35440020
         LA    RA,LCBERCCW+12           RESPOSE AREA                    35460020
         ST    RA,LCBCPA+16             SET IN CCW                      35480020
         MVI   LCBCPA+16,CCWREAD        SET COMMAND                     35500020
         MVI   LCBCPA+20,CCWSLI         SET FLAG                        35520020
         MVI   LCBCPA+23,9 .            SET COUNT                S21101 35540020
         MVI   LCBTPCD+2,TPRDRPEB       SET TP OP CODE                  35560020
         LA    RCCW,LCBCPA+8            SET TO USE COMMON CODE          35640020
         B     EXIT2                    EXIT TO RESART                  35660020
EOTSNT1  EQU   *                                                        35680020
         AIF   ('&GEN' EQ 'MINI').CONC6                          S22026 35685022
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 35690022
         BNO   NOTCONCI .               BRANCH IF NO             S22026 35695022
         L     RCCW,SCBXTRA-1 .         TEXT CCW ADDR            S22026 35700022
         MVI   LCBERCCW,NOPCI .         SET TO POST              S22026 35710022
         BAL   RA,FINDBUFF .            FREE BUFFERS             S22026 35715022
         L     RCCW,LCBCSW-1 .          RESET CCW ADDR           S22026 35720022
         SH    RCCW,H8 .                SUB EIGHT                S22026 35725022
NOTCONCI EQU   * .                                               S22026 35730022
.CONC6   ANOP                                                    S22026 35735022
EOTSNT   EQU   *                                                        35740020
         MVI   PRFPRI,PRILNEND          ST POST PRIORITY                35760020
DISP     EQU   *                                                        35780020
         L     RF,AVTBSCAN .            ADDRESS OF IEDQBD        X01004 35800005
         B     POSTEXIT                 USE COMMON CODE                 35840020
         EJECT                                                          35860020
NOEOTSNT EQU   *                                                        35880020
*        EOB/ETB AT END OF UNIT OR BUFFER.                              35900020
         TM    LCBSTAT1,LCBSENDN        EOB SENT                        35920020
         BZ    RECEIVE                  NO, EOB RECEIVE OR EOT          35940020
         BAL   RE,SETSCB                SET PREVIOUS OFFSET IN SCB      35960020
         SPACE                                                          35980020
         CLI   LCBERCCW+3,1             EOB AT END OF BUFFER            36000020
         BE    ENDBUF                   BRANCH END OF BUFFER            36020020
         SPACE                                                          36040020
         BAL   RB,SETCOUNT              GET OFFSET INTO BUFFER          36060020
         L     RCCW,8(,RCCW)            NEXT CCW IN CHAIN               36080020
         B     ETBUPDT                  USE COMMON CODE                 36100020
         SPACE                                                          36120020
ENDBUF   EQU   *                                                        36140020
         TM    LCBCSW+4,X'20'           CHAN PROG CHECK                 36160020
         BZ    ITSCLEAN                 BRANH IF NO                     36180020
         TM    LCBSTAT1,LCBINITN        INITIATE MODE                   36200020
         BZ    NOBFRS                   DO NOT SET INSUFF. BUFFERS      36220020
         SPACE                                                          36240020
         NI    SCBERR1,AVTEFF-SCBNOBFN  TURN OFF INSUFFICIENT BUFF      36260020
NOBFRS   EQU   *                                                        36280020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE?            S99228 36286022
         BE    POSITIVE                 BRANCH YES               S99228 36292022
         MVI   CCWCOUNT+1,0             INDICATE CHAN PROGRAM CHECK     36300020
POSITIVE EQU   *                                                 S99228 36310022
         AIF   ('&GEN' NE '').Z9                                        36320020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        36340020
         BO    IOGEN                    BRANCH IF YES                   36360020
.Z9      AIF   ('&GEN' NE 'BISC').Z10                                   36380020
         B     IOGEN                    BUILD CONTINUE                  36400020
         AGO   .Z11                                                     36420020
.Z10     ANOP                                                           36440020
         ST    RCCW,LCBCPA+12           SAVE CURRENT CCW POINTER        36460020
         MVI   LCBCPA+12,X'20'          PROGRAM CHECK FLAG              36480020
         TM    LCBCHAIN,LCBEXCP         IDLES LOOP DEFINED              36500020
         BZ    PCSTART                  BRANCH IF YES                   36520020
         B     FREERQE                  EXIT                            36540020
.Z11     ANOP                                                           36560020
ITSCLEAN EQU   *                                                        36580020
         CLI   LCBERCCW,PCIOPT          POST NOW                        36600020
         BE    SKIPPOST                 BRANCH IF NO                    36620020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR        @OY20569 36623082
         BNE   GOODBACK                 BRANCH NO              @OY20569 36626082
         CLI   LCBCSW+6,AVTEZERO        ZERO RESIDUAL COUNT    @OY20569 36629082
         BE    LASTBUF                  BRANCH YES             @OY20569 36632082
GOODBACK EQU   *                                               @OY20569 36635082
         LA    RF,AVTBFRTB              BUFFER RETURN                   36640020
         MVI   PRFPRI,PRIBFRTB          POST PRIORITY                   36660020
         BAL   RC,ENQUEUE               PUT ON READY Q                  36680020
         MVC   LCBLSPCI,9(RCCW)         SET NEW LAST SERVICED   SA52517 36686022
*                                         BUFFER                SA52517 36692022
SKIPPOST EQU   *                                                        36700020
         L     RPREFIX,8(,RCCW)         NEXT  BUFFER ADDRESS            36720020
         LR    RCCW,RPREFIX             RESETART S CCW                  36740020
LASTBUF  EQU   *                                                        36760020
         LA    R0,PRFSTXT-PRFSUNIT      SAVE FOR LATER                  36780020
         STH   R0,LCBRECOF         SAVE FOR LATER                       36800020
         B     ETBUPDT .                USE COMMON CODE          S21101 36820020
TTYTEST  EQU   *                                                SA48278 36825022
         L     RC,AVTSAVEX+UCBOFFST     UCB ADDRESS              X02004 36830005
         CLI   TTY1(RC),TTY2 .         POSSIBLY TELETYPE        SA48278 36835022
         BCR   7,RB .                  BRANCH IF NO             SA48278 36840022
         TM    TTY4(RC),TTY3 .         POSSIBLY TELETYPE        SA48278 36845022
         BCR   14,RB .                 BRANCH IF NO             SA48278 36850022
         TM    TTY4(RC),TTY5 .         POSSIBLY TELETYPE        SA48278 36855022
         BCR   5,RB .                  BRANCH IF NO             SA48278 36860022
SIMEOT   OI    LCBCSW+3,UNEX .     SIMULATE EOT                 SA51061 36865022
         B     ITSEOT .                GO HANDLE EOM            SA48278 36870022
         SPACE                                                          36880020
RECEIVE  EQU   *                                                        36900020
         TM    LCBCSW+3,UNEX            EOT RECEIVED                    36920020
         BO    ITSEOT                   YES                             36940020
         BAL   RB,TTYTEST .            TEST FOR TELETYPE        SA48278 36945022
         CLI   L22601(RC),L2260 .  TEST FOR GRAFICS             SA51061 36950022
         BE    SIMEOT .            GO SIMULATE EOT              SA51061 36955022
         SPACE                                                          36960020
         TM    LCBERCCW+1,IN            LCIN SPECIFIED                  36980020
         BZ    CURRCCW                  NO, IT'S LCOUT                  37000020
         SPACE                                                          37020020
         BAL   RB,SETCOUNT              GET COUNT INTO BUFFER           37040020
         STH   RC,PRFSIZE               SET R PREFIX SIZE               37060020
.Z12     ANOP                                                           37320020
         LR    RWKA,RCCW                SAVE CCW POINTER                37340020
         L     RCCW,8(,RCCW)            NEXT CCW IN CHAIN               37360020
         STCM  RCCW,AD,LCBRECAD         SET NEXT CCW ADDR      @XA09327 37370000
         CLI   LCBERCCW+3,1             EOB AT END OF BUFFER            37380020
         BNE   NOTEND                                                   37400020
         ST    RWKA,LCBCPA+12           SAVE CURRENT CCW POINTER        37420020
         MVC   LCBCPA+16(8),CCW         SAVE CCW               @OX11954 37430091
         CLI   LCBECBCC,PERMERR         ERROR                           37440020
         BE    ERRPOST                  BRANCH IF YES                   37460020
         TM    LCBCSW+4,X'20'           CHAN PROG CHECK                 37480020
         BZ    NOTAPC                   BRANCH IF NO                    37500020
         LR    RCCW,RWKA                SAVE                            37520020
         MVC   LCBCPA+16(8),CCW         SAVE CCW                        37540020
         OI    LCBCHAIN,LCBABRTN        SET ABORT BIT                   37560020
         B     IOGEN                    GO TO IO GENERATOR              37580020
NOTAPC   EQU   *                                                        37600020
         TM    PRFSTAT1,PRFTSMSG        IS THIS TSO MESSAGE    @OS77376 37604091
         BO    ITSTSO                   YES, DONT SET EXTRA    @OS77376 37608091
         MVC   PRFXTRA+1(2),PRFSIZE     SET EOB OFFSET         @OS77376 37612091
ITSTSO   EQU   *                                               @OS77376 37616091
         MVI   LCBERCCW,PCIOPT          DELATY POSTING BUFFERS NOW      37620020
         L     RC,PRFIOADR-1-IEDQPRF(,RCCW) DATA ADDRESS NEXT BUFF      37640020
         LA    R0,PRFSUNIT-IEDQPRF(RCCW) FIRST BYTE FOR PRFSIZE@YA04894 37670061
         SR    RC,R0                    AMOUNT OF PREFIX+IDLES          37700020
         STH   RC,PRFSIZE-IEDQPRF(,RCCW) SET IN PREFIX                  37720020
         LR    RC,RCCW                  FOR SUBROUTINE                  37740020
         BAL   RB,EXITSUB               CHECK STATUS                    37760020
         LR    RPREFIX,RCCW             NEXT BUFFER                     37780020
NOTEND   EQU   *                                                        37800020
         STCM  RPREFIX,AD,LCBRECAD .    SAVE RECORD ADDRESS      Y01948 37820005
         B     IOGEN                    GO BUILD CONTINUE               37880020
         EJECT                                                          37900020
CURRCCW  EQU   *                                                        37920020
         LA    RPREFIX,AVTEZERO(R0,RPREFIX) CLEAR HI ORDER BYTE         37940020
         TM    LCBSTATE,LCBSENDN        EOB SENT                        37960020
         BO    EOBSENT                  YES                             37980020
         SR    RC,RC                    CLEAR WORK REGISTER             38000020
         TM    LCBCSW+3,UNEX            UNIT EXCEPTION MEANS EOT        38020020
         BO    ITSEOT                   BRANCH YES, FALL THRU - EOB     38040020
         BAL   RB,TTYTEST .            TEST FOR TELETYPE        SA48278 38140022
.Z13     ANOP                                                           38300020
         BAL   RB,SETCOUNT              GET COUNT FOR EOB OFFSET        38320020
         TM    LCBERCCW+1,IN            LCIN SPECIFIED                  38340020
         BO    COMMON                   BRANCH YES                      38360020
         CLI   LCBECBCC,PERMERR         ERRORS                          38380020
         BE    COMMON                   YES                             38400020
         CLI   LCBRSKEY,LCLRSCH         LOCAL DEVICE?           SA57329 38420022
         BNE   REDUCE                   BRANCH NO               SA57329 38422022
         TM    LCBERCCW+ONE,CONV+LMD+LOGICAL  CONTINUE?         SA57329 38424022
         BNZ   GOODCONV                 BRANCH NO               SA57329 38426022
REDUCE   EQU   *                                                SA57329 38428022
         BCTR  RC,R0                    REDUCE COUNT FOR LCOUT  SA57329 38430022
GOODCONV EQU   *                                                SA57329 38432022
         STH   RC,LCBRECOF              SAVE RECORD AOFFSET             38440020
         LH    RE,LCBCSW+5              RESIDUAL COUNT                  38460020
         LA    RE,1(,RE)                BUMP FOR COMMON CODE            38480020
         STH   RE,LCBCSW+5              SAVE BACK                       38500020
COMMON   EQU   *                                                        38520020
         STH   RC,PRFSIZE               ASSUME THIS IS END OF MSG       38540020
         STCM  RPREFIX,AD,LCBRECAD .    SAVE CURRENT RECORD ADDR Y01948 38560005
EOBCOM   EQU   *                                                        38620020
         CLI   LCBCSW+6,0         RESIDUAL COUNT C 0                    38640020
         BE    IOGEN              YES, EOB AT END OF UNIT(BUFFER)       38660020
         LH    RD,CCWCOUNT              ORIGINAL COUNT                  38680020
         SH    RD,LCBCSW+5              SUBTRACT RESID COUNT            38700020
         L     RE,CCWADDR-1       DATA ADDRESS                          38720020
         AR    RE,RD              NEW DATA ADDRESS                      38740020
         ST    RE,CCWADDR-1       SET NEW ADDRESS                       38760020
         MVC   CCWCOUNT,LCBCSW+5  SET NEW COUNT                         38780020
         B     IOGEN                    RESTART                         38800020
         EJECT                                                          38820020
*                                                                       38840020
*        SUBROUTINE TO COMPUTE AMOUNT OF DATA TRANSMITTED OR            38860020
* RECEIVED IN A BUFFER.                                                 38880020
*                                                                       38900020
SETCOUNT EQU   *                                                        38920020
         LR    RD,RPREFIX              CCW ADDR OF 1ST UNIT             38940020
         SR    RC,RC                    CLEAR WORK REGISTER             38960020
         B     ENTER1                   ENTER LOOP                      38980020
LOOP1    EQU   *                                                        39000020
         L     RD,EIGHT(,RD)            ADDRESS OF NEXT UNIT            39020020
         AH    RC,AVTKEYLE              ADD UNIT SIZE                   39040020
ENTER1   EQU   *                                                        39060020
         LA    RD,AVTEZERO(,RD)         CLEAR HI ORDER BYTE             39080020
         CR    RD,RCCW                  THIS INTERRUPTED CCW            39100020
         BNE   LOOP1                    TRY NEXT UNIT                   39120020
         LA    RWKA,PRFSUNIT-PRFRCB(,RCCW) TEXT START                   39140020
         L     RD,CCWADDR-1            DATA ADDR  ( MAY HAVE BEEN       39160020
*                                         UPDATED BY PREV EOB           39180020
         SR    RD,RWKA                  DATA TRANSF PREV EOB            39200020
         LH    RE,CCWCOUNT             CCW COUNT                        39220020
         SH    RE,LCBCSW+5             SUB RES CONT FOR AMT TRANSF      39240020
         AR    RC,RD                    ADD TO ACCUM TOTAL              39260020
         AR    RC,RE                    ADD TO ACCUM TOTAL              39280020
         STH   RC,LCBRECOF              SAVE RECORD AOFFSET             39300020
         BR    RB                       RETURN                          39320020
         SPACE 3                                                        39340020
ITSEOT   EQU   *                                                        39360020
         BAL   RB,SETCOUNT                                              39380020
         AIF   ('&GEN' NE 'BISC' AND '&GEN' NE '').M6E           S21101 39390020
         BAL   RB,CKBFMM .              DONT WANT EOT IN BUFER IFS21101 39392020
*                                         NOT REAL EOM           S21101 39394020
         B     MHPOST .                 NOT REAL EOM             S21101 39396020
.M6E     ANOP                                                    S21101 39398020
LCINS    EQU   *                                                        39400020
         STH   RC,PRFSIZE               SAVE IN PREFIX                  39420020
POSTMSG  EQU   *                                                        39440020
POSTMH   EQU   *                                                        39460020
         NI    PRFSTAT1,PRFNLSTF        TURN OFF'NOT LAST BUFFER'       39480020
MHPOST   EQU   *                                                        39500020
         MVI   PRFPRI,PRIMHBFR          POST PRIORITY                   39520020
POSTERR  EQU   *                                                        39540020
         STCM  RPREFIX,AD,LCBLSPCI .    SET LAST SERVICED PCI    Y01948 39560005
POSTBUF  EQU   *                                                        39620020
         L     RWKA,LCBDCBPT            GET DCB ADDRESS                 39640020
        USING IHADCB,RWKA                                               39660020
         L     RF,DCBMH-1               ADDRESS OF QUEUE                39680020
         DROP  RWKA                                                     39700020
         B     POSTEXIT                 USE COMMON CODE                 39720020
         SPACE 10                                                       39740020
*                                                                       39760020
*        SET UP SCB PARAMETERS FOR START/STOP IN EVENT A SUBSEQUENT     39780020
* RECALL IS REQUIRED .  FOR BSC, THE PARAMETERS ARE SAVED IN THE LCB    39800020
* THE SCB IS UPDATED AFTER READ RESPOSNE INTERRUPT IS RECEIVED.         39820020
EOBSENT  EQU   *                                                 S21101 39840020
         BAL   RE,SETSCB .              SET SCB PARAMETERS       S21101 39841020
         SPACE 2                                                 S21101 39842020
         BAL   RB,SETCOUNT .            GET OFFSET INTO BUFFER   S21101 39843020
         SPACE 2                                                 S21101 39844020
ETBUPDT  EQU   *                                                 S21101 39845020
         MVC   LCBRECAD,PRFCRCD .       SAVE DISK ADDRESS        S21101 39846020
         MVC   LCBNTXT,PRFNTXT .        SAVE DISK PARAMETER      S21101 39847020
*        FOR BSC PARAMETERS ARE SET IN SCB FROM LCB AFTER READ   S21101 39848020
* RESPONSE.  FOR START STOP SCB IS UPDATED AFTER NEXT EOB.  FOR  S21101 39849020
* 2740/2 SCB IS UPDATED AFTER READ RESPONSE                      S21101 39850020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'QTAM' OR '&GEN' EQ '').MX39851054
               6A                                               SA66594 39851554
         B     EOBCOM .                 UPDATE CCW AND GO TO IOGES21101 39852020
         AGO   .M6C                                              S21101 39853020
.M6A     ANOP                                                    S21101 39854020
         AIF   ('&GEN' NE'').M6B                                 S21101 39855020
         TM    LCBSTAT2,LCBSYNC .       BSC LINE                 S21101 39856020
         BO    EOBCOM .                 BRANCH IF YES. BUFFERED  S21101 39857020
*                                         SUPPROT IS DONE AT READS21101 39858020
*                                         RESPONSE               S21101 39859020
         SPACE 1                                                 S21101 39860051
.M6B     ANOP                                                    S21101 39860151
         SPACE 1                                                SA62991 39860251
         CLI   LCBTPCD+2,TPRDRPEB       READ RESP FIRST CCW     SA62991 39860351
         BNE   SKIPRTRY                 BR NO, FORGET IT        SA62991 39860451
         L     RD,LCBSTART-1            CHAN PROG START ADDRESS SA62991 39860551
         LA    RD,0(RD)                                         SA62991 39860651
         LA    RE,LCBCPA+16             SLOT FOR READ RESP CCW  SA62991 39860751
         CR    RD,RE                    START ON READ RESPONSE  SA62991 39860851
         BNE   SKIPRTRY                 BR NO, FORGET IT        SA62991 39860951
         L     RD,0(RE)                 GET RESPONSE ADDRESS    SA62991 39861051
         CLI   0(RD),EBCDACK            IS IT EBCDIC ACK        SA62991 39861151
         BE    ZERORTRY                 BR YES, CLEAR RETRY CNT SA62991 39861251
         CLI   0(RD),ASCIACK            ASCII ACK               SA62991 39861351
         BNE   SKIPRTRY                 BR NO, FORGET IT        SA62991 39861451
ZERORTRY EQU   *                                                SA62991 39861551
         MVI   LCBINCAM,AVTEZERO        CLEAR RETRY COUNT       SA62991 39861651
SKIPRTRY EQU   *                                                SA62991 39861751
         SPACE 1                                                SA62991 39861851
         CLI   LCBRSKEY,BUFF .          BUFFERED LINE            S21101 39862020
         BNE   EOBCOM .                 BRANCH IF NO             S21101 39863020
         SPACE 1                                                 S21101 39864020
         TM    CCWFLAGS,CCWCD           NO CHAINING            @OX12579 39865091
         BNZ   LATER                    BRANCH NOT EOM         @OX12579 39865891
         CLI   LCBCSW+6,ONE             ONLY ONE CHARACTER LEFT@OX12579 39866691
         BE    EOBCOM                   YES,BRANCH             @OX12579 39867491
         BH    LATER                    NOT EOB AT END OF UNIT @OX12579 39868291
         CLI   CCWCOUNT+ONE,ONE         ONLY EOT LEFT          @OX12579 39869091
         BE    EOBCOM                   YES,BRANCH             @OX12579 39869891
LATER    EQU   *                                                 S21101 39871020
         OI    SCBQTYPE,SCBBFMM .       INDICATE MIDDLE OF MSG   S21101 39872020
         OI    PRFSTAT1,PRFITCPN .      SET NOT REAL END OF MSG  X01004 39873005
*                                          AT READ RESPONSE INTERS21101 39874020
         B     RDRSP                    PUT UP READ RESPONSE     S21101 39875020
.M6C     ANOP                                                    S21101 39876020
         SPACE 10                                                S21101 39877020
         AIF   ('&GEN' NE 'BISC' AND '&GEN' NE '').M6D           S21101 39878020
*                                                                S21101 39879020
*         SUBROUTINE TO DETERMINE IF EOT IS ALL THAT REMAINS IN  S21101 39880020
* MESSAGE.                                                       S21101 39881020
*                                                                S21101 39882020
ONLYEOT  EQU    *                                                S21101 39883020
         CLI   CCWCOUNT+1,ONE .         ONE CHARACTER TO WRITE   S21101 39884020
         BNE   4(RC) .                  BRANCH IF NO             S21101 39885020
         SPACE 1                                                 S21101 39886020
         TM    CCWFLAGS,CCWCD           NO CHAINING FLAG ON      S21101 39887020
         BCR   8,RC .                   BRANCH IF OFF, TRUE EOM  S21101 39888020
          SPACE 1                                                S21101 39889020
         B     4(RC) .                  RETURN, MORE TO MESSAGE  S21101 39890020
         SPACE 10                                                S21101 39891020
.M6D     ANOP                                                    S21101 39892020
SETSCB   EQU   *                                                        39900020
         AIF   ('&GEN' NE '').L53                                       39920020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        39940020
         BCR   1,RE .                   BRANCH IF YES            S21101 39960020
.L53     AIF   ('&GEN' EQ 'BISC').L54                                   39980020
         SPACE                                                          40000020
         OC    LCBRECAD,LCBRECAD        FIRST OUPUT BLOCK               40020020
         BCR   8,RE .                   BRANCH IF YES            S21101 40040020
         SPACE                                                          40060020
         MVC   SCBDEOB+1(3),LCBRECAD    SET Q ADDRESS                   40080020
         MVC   SCBDEOB(1),LCBNTXT       SET DISK RECORD                 40100020
         MVC   SCBEOB(2),LCBRECOF       SET OFFSET INTO RECORD          40120020
.L54     ANOP                                                           40140020
         BR    RE                       RETURN TO CALLER                40180020
         EJECT                                                          40320020
IOGEN    EQU   *                                                        40340020
         LA    RB,SUBEXIT               SET ROUTINE EXIT                40360020
         LR    RC,RPREFIX               SAVE PARAMTER                   40380020
EXITSUB  EQU   *                                                        40400020
         CLI   LCBERCCW,PCIOPT          PCI TO FREE BUFFERS             40420020
         BE    NOSET                    YES                             40440020
         STCM  RPREFIX,AD,LCBLSPCI .    UPDATE LAST SERVICED BFR Y01948 40460005
NOSET    EQU   *                                                        40520020
         STCM  RCCW,AD,LCBCPA+THIRTN .  'NEW' LAST TEXT CCW      Y01948 40540005
         MVC   LCBCPA+16(8),CCW         SAVE UPDATED CCW                40600020
         MVC   LCBTTBIN,LCBTTCIN        SET FOR CONT                    40620020
         TM    CCWOPCDE,CCWWRITE        WRITE COMMAND                   40640020
         BZ    NOTWRITE                 BRANCH IF NO                    40660020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 40680020
         BNE   GOIOGEN                  NO                              40700020
         OI    LCBCHAIN,LCBNORTY        SET NO RETRY                    40720020
         B     SENDERR                  POST BUFFER TO MH               40740020
NOTWRITE EQU   *                                                        40760020
         TM    LCBCHAIN,LCBABRTN .      ABORT REQUEST FOR PGM CHK       40766020
         BCR   1,RB .                   BRANCH IF YES                   40772020
         SPACE                                                          40780020
         CLI   LCBECBCC,PERMERR         TEXT ERROR                      40800020
         BNE   NOERR                                                    40820020
ERRPOST  EQU   *                                                        40840020
         OI    LCBMSGFM,LCBNAK          RESPONSE FOR TTD       @OY14057 40846091
ERRPOST1 EQU   *                                               @OY14057 40852091
         OI    LCBERBST,LCBERROR        DONT ASSIGN MORE BUFFERS        40860020
         MVI   PRFPRI,PRIMHBFR-1        SET POST PRIORITY               40880020
         NI    PRFSTAT1,PRFNLSTF        MARK IT LAST                    40900020
         OI    SCBERR4,SCBTXTTN         TEXT ERROR                      40920020
         B     POSTERR                  EXIT                            40960020
NOERR    EQU   *                                                        40980020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z14               41000020
         AIF   ('&GEN' EQ 'QTAM').Z14                                   41020020
         NI    SCBERR2,AVTEFF-SCBABRTN  RESET ABORT BIT                 41040020
         NI    SCBERR3,AVTEFF-SCBFORMN  RESET FORMAT ERROR BIT          41060020
.Z14     ANOP                                                           41080020
*****************************************************************S22025 41081022
*        THE FOLLOWING CODE ADJUSTS FOR THE CASE OF RECEIVING    S22025 41082022
*        CHANNEL END/DEVICE END WITHOUT DTA TRANSFERRED ON A     S22025 41083022
*        START/STOP LINE.                                        S22025 41084022
         ST    RC,LCBERCCW+4            BUFFER ADDRESS           S22025 41085022
         CLC   LCBERCCW+5(3),SCBDEOB+1  THIS THE DEOB BUFFER     S22025 41086022
         BNE   GOODSIZE                 NO                       S22025 41087022
         CLC   SCBEOB,PRFSIZE-IEDQPRF(RC) IS PREVIOUS SIZE LESS  S22025 41088022
*                                         THAN NEW SIZE          S22025 41089022
         BNH   GOODSIZE                 BRANCH IF YES            S22025 41090022
         MVC   PRFSIZE-IEDQPRF(2,RC),SCBEOB ADJUST SIZE          S22025 41091022
GOODSIZE EQU   *                                                 S22025 41092022
*****************************************************************S22025 41093022
         NI    SCBERR4,AVTEFF-SCBTXTTN  RESET TEXT ERROR BIT            41100020
         MVI   LCBINCAM,0               RESET RETRY COUNT               41120020
         TM    PRFSTAT1,PRFTSMSG .      IS THIS A TSO BUFFER     S22029 41130022
         BO    TSOBUF .                 BRANCH IF YES            S22025 41140022
         MVC   PRFXTRA+1-IEDQPRF(TWO,RC),PRFSIZE-IEDQPRF(RC)     S22025 41160022
*                                       RESET THE EOB OFFSET IN  S22025 41166022
*                                         THE BUFFER             S22025 41172022
TSOBUF   EQU   *                                                SA63595 41172554
         OI    LCBSTAT2,LCBRESP        SET RESPONSE OWED        SA63595 41173054
         AIF   ('&GEN' NE 'MINI' AND '&GEN' NE 'QTAM').LL46A   @OS76490 41173591
         TM    LCBERCCW+1,LOGICAL+CONV+LMD  IS THERE AN MH EXIT SA63595 41174054
         BNZ    POSTMH                 BRANCH EITHER            SA63595 41174554
         BR    RB                      RETURN                   SA63595 41175054
.LL46A   ANOP                                                           41176822
         AIF   ('&GEN' EQ 'QTAM' OR '&GEN' EQ 'MINI').LL47              41177022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR SA59028 41177522
         TM    LCBERCCW+ONE,LOGICAL+CONV+LMD  LOGICAL, CONVERSE  S99228 41180222
*                                             OR LMD?            S99228 41180422
         BZ    CONVTEST                 NO-CHECK GEN POLL       SA59028 41180622
         TM    LCBDCT1,C3270            3270 DEVICE             SA59028 41181522
         BZ    POSTMH                   NO-POST BUFFERS TO MH   SA59028 41181822
         TM    LCBDCT2,CREMOTE          BSC DEVICE              SA59028 41182122
         BZ    POSTMH                   NO-POST BUFFERS TO MH   SA59028 41182422
         TM    SCBERR2,SCBSOHE          SOH%R MSG RECIEVED      SA59028 41182722
         BO    CONVTEST                 BRANCH IF YES          @SA71658 41183061
         TM    LCBTSOB,LCBTSBUF         TSO IN SESSION          SA63959 41183105
         BZ    POSTMH                   NO - POST BFRS TO MH    SA63959 41183205
         TM    SCBBSCFM,SCBRCVTX        ETX RECD BSYNC LINE     SA59028 41183322
         BCR   EIGHT,RB                 BRANCH IF NO            SA59028 41183622
         B     POSTMH                   POST BUFFERS TO MH              41183922
CONVTEST EQU   *                                                SA59028 41184222
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 41185022
         BCR   EIGHT,RB                 BRANCH IF NO             S99228 41190022
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 41191022
         BO    POSTMH                   BRANCH IF YES            S99228 41192022
         LH    RC,PRFSIZE               LOAD PRFSIZE             S99228 41193022
         LA    RC,ONE(R0,RC)            INCREASE PRFSIZE FOR EOT S99228 41194022
         STH   RC,PRFSIZE               RESTORE PRFSIZE          S99228 41195022
LINEIN   EQU   *                                                 S99228 41196022
         B     POSTMH                   POST BUFFERS TO MH       S99228 41197022
.LL47    ANOP                                                    S99228 41218022
SUBEXIT  EQU   *                                                        41260020
         SPACE                                                          41280020
GOIOGEN  EQU   *                                                        41300020
         MVC   LCBTTBIN,LCBTTCIN        RESET TO BE CONNECTED           41320006
         ST    R15,LCBERCCW+4           SAVE REGISTER           SA54923 41330006
         OI    LCBSTAT1,LCBCONT         SET CONTINUE BIT                41340006
         L     RCCW,AVTKA02             ADDRESS OF IEDQKA               41350006
         LA    RAVT,AVTSAVE2            AVT BASE FOR KA                 41360006
         BALR  RF,RCCW                  LINK TO KA                      41370006
         L     R15,LCBERCCW+4           RESTORE REGISTER        SA54923 41380006
         L     R14,LCBSCBA-1            RESTORE SCB ADDRESS     SA54923 41390006
         LA    RBASE,FOUR095(,R15)      SET SECOND BASE                 41400006
         LA    RBASE,ONE(,RBASE)                                        41410006
         SH    RAVT,AVTBACK             RESET AVT BASE                  41420006
         AIF   ('&GEN' NE 'BISC').Z15                                   41520020
         B     RESTART                  RESTART CHAN PROGRAM            41540020
         AGO   .Z16                                                     41560020
.Z15     ANOP                                                           41580020
         TM    LCBCSW+3,UNEX            NO CONTINUE POSSIBLE            41600020
         BZ    RESTART                  BRANCH RESTART POSSIBLE         41620020
         L     RCCW,LCBCPA+12           INTERRUPTED CCW                 41640020
         MVI   LCBERCCW,NOPCI           SET PARAMETER TO POST BUFFS     41660020
         BAL   RA,FINDBUFF              LIN TO SUBROUTINE               41680020
         TM    LCBCHAIN,LCBABRTN .      NO ABORT FOR THIS LINE          41685020
         BO    POSTMH .                 BRANCH IF YES                   41690020
         SPACE                                                          41695020
         TM    LCBERCCW+1,IN            LCIN                            41700020
         BO    POSTMH                   BRANCH IFYES                    41720020
         LH    RWKA,PRFSIZE             GET PREFIX SIZE                 41740020
         LA    RWKA,1(,RWKA)            BUMP                            41760020
         STH   RWKA,PRFSIZE             SET BACK                        41780020
         B     POSTMH                   POST AS LAST TO MH              41800020
.Z16     ANOP                                                           41820020
         EJECT                                                          41840020
FINDEOB  EQU   *                                                        41860020
*                                                                       41880020
*        SUBROUTINE WILL COMPUTE ADDRESS OF LAST CHARACGER TRANSMITTED  41900020
* OR RECEIVED IN A UNIT AND THE EOB SEQUENCE IN THE SPECIAL             41920020
* CHARACTERS TABLE.                                                     41940020
         L     RWKA,LCBDCBPT            DCB  BASE                       41960020
         USING IHADCB,RWKA                                              41980020
         L     RB,DCBSCTAD-1            SCT ADDRESS                     42000020
         DROP  RWKA                                                     42020020
         SR    RWKA,RWKA                CLEAR FOR INDEX                 42040020
         ICM   RWKA,ONE,ETBCH(RB)       ETB SEQUENCE DEFINED     Y01948 42060005
         BZ    EOTSNT1 .                BRANCH, IF NOT            M5949 42072020
.NOSTSP  ANOP                                                     M5949 42076020
         LA    RWKA,1(RWKA,RB)          POINT TO SEQUENCE               42080020
         L     RB,CCWADDR-1             DATA ADDRESS                    42100020
         AH    RB,CCWCOUNT              ORIGINAL COUNT                  42120020
         SH    RB,LCBCSW+5              SUBTRAC T RESIDUAL COUNT        42140020
         BCTR  RB,0                     DECREMENT ONE                   42160020
         BR    RC                       RETURN                          42180020
         SPACE 10                                                       42200020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z17               42220020
         AIF   ('&GEN' EQ 'QTAM').Z17                                   42240020
CKEND    EQU   *                                                        42260020
*                                                                       42280020
*        THIS SUBROUTINE WILL CHECK IF LAST CHARACTER IS A VALID        42300020
* LINE CONTROL CHARACTER.  IF NOT, EXIT IS TO IOS TO SCHEDULE ERP       42320020
*                                                                       42340020
         TM    LCBSTAT1,LCBSENDN        SEND SIDE                       42360020
         BCR   1,RC                     YES, EXIT                       42380020
         SPACE                                                          42400020
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR                 42420020
         BCR   8,RC                     YES, EXIT                       42440020
         SPACE                                                          42460020
         TM    LCBMSGFM,LCBRSTRT .      INVALID START CHARACTER  S21101 42480020
         BO    CKCNT                    YES, CHECK RETRY COUNT          42500020
         TM    LCBMSGFM,LCBEOT .        EOT RECEIVED             S21101 42520020
         BCR   1,RC                     YES, RETURN                     42540020
         SPACE                                                          42560020
         USING IHADCB,RA                                                42580020
         L     RF,DCBSCTAD-1            SCT ADDRESS                     42600020
         DROP  RA                                                       42620020
         SR    RE,RE                    CLEAR INDEX REGISTER            42640020
         IC    RE,ETBCH(,RF)            GET DLE ETB INDEX               42660020
         LA    RWKA,2(RE,RF)            POINT TO ETB                    42680020
         NI    SCBBSCFM,AVTEFF-SCBRCVTX ASSUME ETB RECEIVED      S21101 42700020
         CLC   0(1,RB),0(RWKA)          ETB RECEIVED                    42720020
         BCR   8,RC                     BRANCH IF YES                   42740020
         CLC   0(1,RB),3(RWKA)          ETX                             42760020
         BNE   CKSENQ                   NO, SEE IF ABORT                42780020
         SPACE                                                          42800020
         OI    SCBBSCFM,SCBRCVTX .      SET ETX RECEIVED         S21101 42820020
         BR    RC                       RETURN                          42840020
         SPACE                                                          42860020
CHKNEG   EQU   *                                                SA68035 42861005
         TM    LCBSTAT1,LCBRECVN        RECEIVE OPERATION       SA68035 42862005
         BCR   14,RD                    BR NO, RETURN           SA68035 42863005
         TM    LCBCSW+THREE,UNEX        EOT RECEIVED            SA68035 42864005
         BCR   14,RD                    BR NO, RETURN           SA68035 42865005
         TM    LCBSTAT2,LCBSYNC+LCBDIAL BISC DIAL LINE          SA68035 42866005
         BCR   14,RD                    BR NO, RETURN           SA68035 42867005
         OI    SCBBSCFM,SCBNOEOT        SET FLAG FOR SEND SCHED@OY11499 42868091
*                                       AND ACTIVATE           @OY11499 42868591
         OI    LCBSTAT2,LCBNEGRP        SHOW NEG RESP TO POLL  @OZ18753 42868791
*                                         TO FORCE SEND NEXT    SA68035 42869005
         BR    RD                       RETURN                  SA68035 42870005
         SPACE 5                                                SA68035 42871005
CKSENQ   EQU   *                                                        42880020
         IC    RE,ENQCH(,RF)            GET ENQ INDEX                   42900020
         LA    RWKA,1(RE,RF)            POINT TO ENQ                    42920020
         OI    SCBERR3,SCBFORMN         SET FORMAT ERROR                42940020
         CLC   0(1,RB),0(RWKA)          THIS AN ABORT                   42960020
         BNE   CKCNT .                  NO, INVALID END CHAR     S99228 42980022
         OI    SCBERR2,SCBABRTN .       SET ABORT                S99228 42981022
         NC    LCBTTCIN(TWO),LCBTTCIN   POLLRT DETERMINE INVALID S99228 42982022
*                                       SOURCE?                  S99228 42982522
         BZ    NOENQERP                 BRANCH YES               S99228 42983022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 42987322
         TM    LCBDCT1,C3270            3270 DEVICE?             S99228 42987622
         BZ    NOENQERP                 NO 3270 SKIP DVC DEP ERP S99228 42988022
         MVI   LCBINCAM,RETRY           SET FOR NO RETRY         S99228 42989022
         LA    RC,SLOWPOLL              LOAD RETURN ADDRESS      S99228 42996322
         B     ENQERP                   SKIP REGULAR RETURN RESETS99228 42996622
NOENQERP EQU   *                                                 S99228 42997022
         LA    RC,NOCKEND               RELOAD RETURN ADDR       S99228 42998022
ENQERP   EQU   *                                                 S99228 42999022
*        AN ENQ WAS READ IN NON-TRANSPARENT MODE.  IF THIS IS   SA44892 43000922
*        A VALID TTD, IT WAS HANDLED IN THE SCAN ROUTINE.       SA44892 43001822
*        IF THIS IS TRANSPARENT MODE, AN ENQ IS A VALID DATA    SA44892 43002722
*        CHARACTER.  IT MUST BE DETERMINED WHETHER THE ENQ      SA44892 43003622
*        CAUSED THE ENDING STATUS OR NOT.  TO BE A VALID TTD, THSA44892 43004522
*        ENQ MUST BE THE ONLY CHARACTER AFTER THE DLE STX.      SA44892 43005422
*                                                                       43006322
         LH    RE,CCWCOUNT .           ORIGINAL CCW COUNT       SA44892 43007222
         BCTR  RE,0 .                  MINUS ONE                SA44892 43008122
         LH    RWKA,LCBCSW+5 .         RESIDUAL COUNT           SA44892 43009022
         CR    RE,RWKA .               WZS ONLY 1 CHARACTER     SA44892 43009922
         BNE   SETABORT .              READ - BR IF NO          SA44892 43010822
         LA    RCCW,0(RCCW) .          ENDING/CURRENT CCW CLEAR SA44892 43011722
         L     RWKA,LCBCPA+12 .        STARTING CCW             SA44892 43012622
         LA    RWKA,0(RWKA) .          CLEAR FOR COMPARE        SA44892 43013522
         CR    RCCW,RWKA .             ARE THEY THE SAME UNIT   SA44892 43014422
         BNE   SETABORT .              BR IF NO                 SA44892 43015322
         TM    CCWFLAGS,CCWSLI .       IS THIS THE RESTART CCW  SA44892 43016222
         BNO   GOTTTD .                BR IF YES - A REAL TTD   SA44892 43017122
SETABORT EQU   * .                                              SA44892 43018022
CKCNT    EQU   *                                                        43020020
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED             43040020
         BL    DCKK                     NO TREAT AS DATA CHECK          43060020
         SPACE                                                          43080020
         OI    SCBERR4,SCBTXTTN         SET TEXT ERRRO                  43100020
         MVI   LCBECBCC,PERMERR         SET ERROR INDICATION            43120020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                 @OY14057 43140091
         BOR   RC                       YES,RETURN             @OY14057 43140691
         L     RE,AVTDOUBX              LOAD LCB EXTENSION     @OY14057 43141291
         TM    LCBDCT1,C3270            3270 DEVICE            @OY14057 43141891
         BNOR  RC                       NO,RETURN              @OY14057 43142491
         STCM  RCCW,AD,LCBCPA+THIRTN    SAVE CCW ADDRESS       @OY14057 43143091
         MVC   LCBCSWSV,LCBCSW          SAVE CSW               @OY14057 43143691
         MVC   LCBSNSV,LCBSENS0         SAVE SENSE BYTE        @OY14057 43144291
         MVI   LCBTPCD+2,TPNULL         NON-READ WIRTE CCW     @OY14057 43144891
         LA    RA,RVICH                 INDEX IN SCT           @OY14057 43145491
         LA    RWKA,LCBCPA+16           CHANNEL PROGRAM AREA   @OY14057 43146091
         BAL   RD,CCWBLD                BUILD CCW              @OY14057 43146691
         MVI   LCBCPA+20,CCWCC+CCWSLI   CMD CHAIN/SUPR INC LNGT@OY14057 43147291
         MVI   LCBTPCD+3,TPRS3270       OP CODE FOR READ EOT   @OY14057 43147891
         LA    RA,1                     ONE                    @OY14057 43148491
         ST    RA,LCBCPA+28             COUNT FOR READ         @OY14057 43149091
         LA    RA,LCBERCCW+4            RESPONSE ADDRESS       @OY14057 43149691
         ST    RA,LCBCPA+24             STORE IN CHANNEL PGM   @OY14057 43150291
         MVI   LCBCPA+24,CCWREAD        READ CCW               @OY14057 43150891
         LH    RC,LCBTTCIN              TERMINAL OFFSET        @OY14057 43151491
         N     RC,AVTCLRHI              IS IT ZERO             @OY14057 43152091
         BZ    RESTCOM                  YES,RESTART            @OY14057 43152691
         L     RA,AVTRNMPT              TNT CODE BASE          @OY14057 43153291
         BAL   RPREFIX,TNTDCODE-IEDQTNTD(RA) FIND TERM ENTRY   @OY14057 43153891
         L     RB,TRMDESTQ-1-IEDQTRM(RB) GET DEST QCB          @OY14057 43154491
         TM    QCBFLAG-IEDQQCB(RB),QCBTSSES TSO                @OY14057 43155091
         BZ    RESTCOM                  NO,BRANCH              @OY14057 43155691
         NI    QCBTSOF2-IEDQQCB(RB),AVTEFF-QCBDSSMI STARTMI OFF@OY14057 43156291
         B     RESTCOM                  WRITE RVI, READ EOT    @OY14057 43156891
         SPACE                                                          43160020
DCKK     EQU   *                                                        43180020
         MVI   LCBCSW+3,UNITCHK         SET ENDING STATUS               43200020
         MVI   LCBSENS0,DATCK           SET DATA CHECK                  43220020
         B     ERPEXIT                  EXIT TO ERP                     43240020
         SPACE 7                                                 S21101 43260020
CKBFMM   EQU   *                                                 S21101 43270020
*        SUBROUTINE WILL DETERMINE IF WE ARE AT TRUE EOM OR TEMP S21101 43272020
* EOM FOR INPUT BUFFERED TERMINAL CUPPORT                        S21101 43274020
*        RPREFIX=ADDRESS OF CURRENT BUFFER                       S21101 43276020
*        RC=PRFSIZE WITH EOT                                     S21101 43278020
         AIF   ('&GEN' EQ 'BISC').Z17A                           S21101 43278420
         TM    LCBSTAT2,LCBSYNC .      BSC LINE                  S21101 43278820
         BNO   4(RB) .                 BRANCH NO -REAL EOM       S21101 43279220
.Z17A    ANOP                                                    S21101 43279620
         CLI   LCBRSKEY,BUFF .          BUFFERED TERMINAL        S21101 43279720
         BNE   4(RB) .                  BRANCH NO, REAL EOM      S21101 43279820
         SPACE 1                                                 S21101 43279920
         CLI   LCBECBCC,PERMERR         PERMANENT ERROR         SA65874 43280905
         BE    4(RB)                    YES, TREAT AS EOM       SA65874 43281905
         SPACE 1                                                        43282905
         TM    SCBBSCFM,SCBRCVTX .      WAS ETX BEFORE EOT       S21101 43286620
         BO    4(RB) .                  BRANCH YES ,REAL EOM     S21101 43288620
         TM    SCBERR2,SCBABRTN         IS IT ABORT            @OS77965 43289291
         BO    4(RB)                    BRANCH YES             @OS77965 43289891
         SPACE 1                                                 S21101 43290620
         OI    PRFSTAT1,PRFITCPN .      SET LOGICAL EOM          X01004 43293005
         BCTR  RC,R0 .                  DECREMENT EOT OUTOF BUFF S21101 43293120
         STH   RC,PRFSIZE .             SET PREFIX SIZE          S21101 43293220
         BR    RB .                     RETURN                   S21101 43299920
.Z17     ANOP                                                    S21101 43300020
         EJECT                                                          43680020
CCWBLD   EQU   *                                                        43700020
*                                                                       43720020
*        THIS SUBROUTINE WILL BUILD A CCW AT THE LOCATION POINTED TO    43740020
* BY RWKA.  RA CONTAINS INDEX INTO SPECIAL CHARACTERS TABLE FOR         43760020
* SEQUENCE DESIRED.                                                     43780020
*                                                                       43800020
         L     RC,LCBDCBPT              GET DCB ADDRESS                 43820020
         USING IHADCB,RC                                                43840020
         L     RB,DCBSCTAD-1            SCT ADDRESS                     43860020
         DROP  RC                                                       43880020
         IC    RA,0(RA,RB)              INDEX INTO SEQUENCE             43900020
         LA    RC,0(RA,RB)              POINT TO COUNT FO SEQUENCE      43920020
         IC    RA,0(,RC)                GET SEQUENCE COUNT              43940020
         ST    RA,4(,RWKA)             SET COUNT                        43960020
         LA    RC,1(,RC)                BUMP TO SEQUENCE                43980020
         ST    RC,0(,RWKA)             SET CCW ADDRESS                  44000020
         MVI   0(RWKA),CCWWRITE        SET COMMAND CODE                 44020020
         BR    RD                       RETURN                          44040020
   SPACE 10                                                             44060020
ENQUEUE  EQU   *                                                        44080020
*                                                                       44100020
*        INPUT:                                                         44120020
*        RPREFIX POINTS TO ELEMENT                                      44140020
*        RF POINTS TO QCB WHICH THE ELEMENT IS TO BE POSTED             44160020
*        RWKA IS USED AS A WORK REGISTER                                44180020
*        RC CONTAINS THE RETURN ADDRESS                                 44200020
*                                                                       44220020
         ST    RF,RECBQCBA-1-IEDQRECB(,RPREFIX) QCB ADDRESS             44240020
         DROP  RAVT                                              Y02027 44260006
         L     RAVT,CVTPTR              PICKUP CVT ADDRESS       Y02027 44270006
         USING CVT,RAVT                                          Y02027 44280006
         L     RAVT,CVTAQAVT           PICKUP ADDR OF TCAM'S     Y02027 44290006
*                                       CVT EXTENSION            Y02027 44300006
         DROP  RAVT                                              Y02027 44310006
         USING IEDQTCX,RAVT                                      Y02027 44320006
         L     CURR,TCXREADY            PICKUP ADDR OF CURRENT   Y02027 44330006
*                                       ELEMENT ON AYNCHRONOUS   Y02027 44340006
*                                       READY QUEUE              Y02027 44350006
NEWCURR  STCM  CURR,SEVEN,PRFLINK .     LINK NEW ELEMENT TO THE  Y02027 44360006
*                                       CURRENT ELEMENT          Y02027 44370006
         CS    CURR,RPREFIX,TCXREADY   .WAS CURRENT ELEMENT      Y02027 44380006
*                                       UPDATED ASYNCHRONOUSLY   Y02027 44390006
         BNE   NEWCURR                  YES, LINK NEW ELEMENT    Y02027 44400006
*                                       TO NEW CURRENT ELEMENT   Y02027 44410006
*                                       NO, ASYNCHRONOUS RDY Q   Y02027 44420006
*                                       IS UPDATED WITH NEW ELEM Y02027 44430006
*                                       BY COMPARE-AND-SWAP INST Y02027 44440006
         L     RAVT,TCXAVT              RESTORE AVT ADDRESS      Y02027 44450006
         DROP  RAVT                                              Y02027 44460006
         USING IEDQAVTD,RAVT                                     Y02027 44470006
         SPACE                                                          44600020
         TM    AVTOSECB,COMPLETE        ARE WE IN WAIT STATE            44620020
         BCR   1,RC                     BRANCH NO                       44640020
         SPACE                                                          44660020
POSTECB  EQU   *                                                        44680020
         STM   9,10,ECBSAVE             SAVE REGISTERS           S99228 44700022
         STM   R11,R15,LCBERCCW+4       SAVE REGISTERS                  44720020
         LA    R11,AVTOSECB             ECB TO BE POSTED                44740020
         L     RCCW,AVTTCB .            TCB ADDRESS                     44800020
         SR    RD,RD                    CLEAR REG 10             A42413 44818021
         L     R15,CVTPTR .             PICKUP CVT ADDRESS       Y02027 44818606
         L     R15,CVT0PT01-CVT(,R15) . ADDR OF POST ROUTINE     Y02027 44819206
         BALR  R14,R15                  LINK TO POST                    44820020
         LM    R11,R15,LCBERCCW+4       RESTORE REGISTERS               44840020
         LM    9,10,ECBSAVE             RESTORE REGISTERS        S99228 44860022
         BR    RC                       RETURN                          44880020
         SPACE 2                                                        44886022
ECBSAVE  DS    D                        POSTECB REG SAVE AREA    S99228 44892022
CNTSAVE  DS    2D                                              @OX17153 44892100
         EJECT                                                          44900020
RESTART  EQU   *                        THIS EXIT TO RESTART            44920020
         MVI   LCBTTBIN,AVTEZERO        CLEAR ERP ERROR COUNTER         44940020
         NI    LCBFLAG1,FF-X24          TURN OFF ERROR FLAGS            44960020
         L     R1,AVTSAVEX+THIRTY2      IOSB ADDRESS           @ZA02095 44963061
         USING IOSB,R1                                           Y02027 44966006
         XC    IOSSNS,IOSSNS            CLEAR SENSE BYTES        Y02027 44969006
         DROP  R1                                                       44975006
         L     14,AVTDPARM              RETURN REGISTER                 44980020
         LA    14,8(,14)                BUMP FOR RESTART                45000020
         B     IOSEXIT                  LEAVE                           45020020
POSTELE  EQU   *                        POST BUFFERS AND LCB            45040020
FREERQE  EQU   *                                                        45060020
         L     14,AVTDPARM              RETURN REGISTER                 45080020
         LA    14,4(,14)                BUMP TO SKIP POST               45100020
         B     IOSEXIT                  LEAVE                           45120020
ERP      EQU   *                                               @OX21187 45140082
         CLI   LCBCPA+24,CCWPOLL        AUTOPOLL               @OX21187 45140182
         BNE   NAPCHAP                  BRANCH NO              @OX21187 45140282
         LA    RCCW,0(,RCCW)            DETERMINE              @OX21187 45140382
         LA    RA,LCBCPA                IF                     @OX21187 45140482
         SR    RA,RCCW                  CONTROL                @OX21187 45140582
         BP    YEXTEXT                  MODE                   @OX21187 45140682
         SR    RB,RB                    INTERRUPT              @OX21187 45140782
         L     RC,LCBDCBPT              BECAUSE                @OX21187 45140882
         USING IHADCB,RC                IF                     @OX21187 45140982
         IC    RB,DCBEIOBX              INTERRUPT              @OX21187 45141082
         DROP  RC                       IS                     @OX21187 45141182
         LA    RB,0(RLCB,RB)            CONTROL                @OX21187 45141282
         SR    RB,RCCW                  MODE                   @OX21187 45141382
         BNP   YEXTEXT                  AND                    @OX21187 45141482
         LPR   RA,RA                    HAS                    @OX21187 45141582
         SRL   RA,3                     OPEN                   @OX21187 45141682
         LA    RA,LCBTPCD(RA)           TPOPCODE               @OX21187 45141782
         CLI   0(RA),TPOPEN             THEN                   @OX21187 45141882
         BE    NAPCHAP                  NO SCB DETERMINATION   @OX21187 45141982
YEXTEXT  EQU   *                                               @OX21187 45144082
         AIF   ('&GEN' EQ 'MINI').NO1                          @OZ25960 45145282
         CLI   0(RCCW),CCWWRITE         INTERRUPT ON WRITE     @OZ25960 45145882
         BE    NAPCHAP                  BRANCH YES             @OZ25960 45146482
         L     RF,POLLADR               ADDR OF AUTOPOLL RTN   @OZ16540 45148291
         BALR  R14,RF                   BRANCH TO IT           @OZ16540 45148391
.NO1     ANOP                                                  @OZ16540 45148491
         L     RA,LCBDCBPT              GET DCB ADDRESS         SA62984 45148605
         USING IHADCB,RA                                        SA62984 45149205
         TM    DCBPCI,RCVPCI            PCI=A ON RECEIVE        SA62984 45149805
         BO    NAPCHAP                  BR YES                  SA62984 45150405
         DROP  RA                                               SA62984 45151005
         MVI   LCBCPA+53,AVTEFF         SET ERP FOR AUTOPOLL    SA59028 45152022
NAPCHAP  EQU   *                                                SA59028 45156022
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'BISC').NO2               45160020
         AIF   ('&GEN' EQ 'QTAM').NO2                                   45180020
         TM    LCBTSOB,LCBPREP .        MONITOR STATE               TSO 45200020
         BO    RTPREP .                 BRANCH YES                  TSO 45220020
*                                                                   TSO 45240020
.NO2     ANOP                                                           45260020
ERPEXT   EQU   *                                                 Y02027 45270006
         L     14,AVTDPARM              RETURN RGISTER                  45280020
IOSEXIT  EQU   *                                                        45300020
         LM    0,9,AVTSAVEX             RESTORE REGISTERS               45400020
         BR    R14                      RETURN                          45420020
         AIF   ('&GEN' EQ 'MINI').NO2B .                         S22025 45421022
         SPACE 3                                                 S22025 45422022
DCTBASE  EQU   * .                                               S22025 45423022
*    THIS ROUTINE GETS THE ADDRESS OF THE DEVICE CHARACTERISTICS S22025 45424022
*    TABLE.                                                      S22025 45425022
         LH    RC,LCBTTCIN .            TERMINAL OFFSET          S22025 45426022
         L     RA,AVTRNMPT .            TNT CODE BASE            S22025 45427022
         USING IEDQTNTD,RA .                                     S22025 45428022
         BAL   RPREFIX,TNTDCODE .       FIND TERMINAL TYPE       S22025 45429022
         USING IEDQTRM,RB .                                      S22025 45430022
         SR    RA,RA .                  CLEAR FOR INDEX          S22025 45431022
         IC    RA,TRMCHCIN .            CHARACTERISTICS INDEX    S22025 45432022
         BCTR  RA,0 .                   DECREMENT                S22025 45433022
         MH    RA,AVTDCTLN              LENGTH OF DCT ENTRY    @G36XRIV 45434000
         A     RA,AVTCSTCS .            DCT BASE                 S22025 45435022
         DROP  RA .                                              S22025 45436022
         DROP  RB .                                              S22025 45437022
         BR    RD .                     RETURN TO CALLER         S22025 45438022
.NO2B    ANOP                                                    S22025 45439022
         SPACE 3                                                        45440020
H3       DC    H'3'                                                     45460020
H8       DC    H'8'                                                     45480020
AVTBACK  DC    AL2(AVTSAVE2-IEDQAVTD)                                   45500020
D41STICS DC    X'F80400' .              2741 CHARACTERISTICS     X01004 45506005
D50STICS DC    X'301014' .              1050 CHARACTERISTICS     X01004 45512005
         AIF   ('&GEN' EQ 'MINI').ME1                            S22029 45540022
.L58     AIF   ('&GEN' EQ 'STSP').ME1                            S22029 45560022
         AIF   ('&GEN' EQ 'QTAM').ME1                            S22029 45580022
         EJECT                                                          45600020
         USING *,RF                                                     45620020
BSC270X  EQU   *                                                        45640020
*     THE FOLLOWING CODE SETS UP RCCW AND THE RESIFUAL COUNT FOR        45660020
* BSC WRITE OPERATIONS.  RESIDUAL COUNT CAN BE UP TO 7 LESS THAN        45680020
*  ACTUAL STATUS                                                        45700020
         USING IEDQSCB,RSCB                                             45720020
         TM    SCBSTATE,SCBTRANP        TRANSPARENT                     45740020
         BZ    ITSNTR                   NO                              45760020
         LA    RA,LCBCPA+24             EXIT INDICATOR FROM UNIT        45780020
         LR    RE,RCCW                  GET INTERRUPTED CCW COPIED      45800020
         SPACE                                                          45820020
ERTRLP   EQU   *                                                        45840020
         LR    RB,RE                    SAVE CCW POINTER                45860020
         L     RE,PRFTIC-IEDQPRF(,RE)   NEXT CCW                        45880020
         LA    RE,0(,RE)                CLEAR HI ORDER BYTE             45900020
         CLR   RE,RA                    THIS THE EXIT UNIT              45920020
         BNE   ERTRLP                   NO                              45940020
         MVC   PRFTIC+1-IEDQPRF(3,RB),LCBCPA+57 SET UP TIC TO NEXT      45960020
*                                         UNIT (FOR CLEANUP             45980020
         B     NOTBSC                                                   46000020
         SPACE 3                                                        46020020
ITSNTR   EQU   *                                                        46040020
         CLI   LCBCSW+6,0               RESIDUAL COUNT ZERO             46060020
         BNE   ITSETB                   NO                              46080020
         SPACE                                                          46100020
         CLI   CCWCOUNT+1,1             ORIGINAL COUNT 1-ONLY OET       46120020
         BNE   ITSETB                   NO SCAN FOR ENDING CHARACTER    46140020
         TM    CCWFLAGS,CCWCD+CCWSLI+CCWCC  ANY FLAGS SET        A42376 46160020
         BC    8,NOTBSC                                                 46180020
         SPACE                                                          46200020
ITSETB   EQU   *                                                        46220020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 46240020
         USING IHADCB,RA                                                46260020
         L     RE,DCBSCTAD-1            SCT ADDRESS                     46280020
         DROP  RA                                                       46300020
         LA    RDCB,9                   ASSUME WORST CASE               46320020
         L     RA,CCWADDR-1             DATA ADDRESS                    46340020
         LR    RC,RA                    SAVE FRO FUTUTE TEST            46360020
         AH    RA,CCWCOUNT              ADD ORIGINAL COUNT              46380020
         LH    RB,LCBCSW+5              RESIDUAL COUNT FROM CSS         46400020
         LA    RB,9(,RB)                ADJUST CSW FOR WORST CASE       46420020
         SR    RA,RB                    NEW DATA ADDRESS FOR SEARCH     46440020
         CR    RA,RC                    NEW LESS THAN ORIGINAL          46460020
         BL    CHKCCW                   BRANCH YES- 2 CASES:            46480020
*                                       VERY SHORT BLOCK IN THIS        46500020
*                                       CCW OR CHANNEL HAS FETCHED      46520020
*                                       THE NEXT CCW IN CHAINE          46540020
        SPACE                                                           46560020
ETBEXIT  EQU   *                                                        46580020
         LA    RWKA,SKIPCLR             SET EXIT FROM LOOP      SA59538 46600022
FINDETB  EQU   *                                                        46620020
         SR    RB,RB                    CLAR WORK REGISTER              46640020
         IC    RB,ENQCH(,RE)            ENQ OFFSET                      46660020
         LA    RB,1(RB,RE)              POINT TO SEQUENCE       SA54276 46680022
         BCTR  RA,0                     ADJUST FOR LOOP                 46700020
SRCHLOOP EQU   *                                                        46720020
         LA    RA,1(,RA)                BUMP TO NEX T POSITION IN       46740020
*                                         BUFFER                        46760020
         CLC   0(1,RB),0(RA)            ENQ                     SA54276 46780022
         BE    ENDFOUND                 YES                             46800020
         CLC   3(1,RB),0(RA)            ETB                     SA54276 46820022
         BE    ENDFOUND                 YES                             46840020
         CLC   6(1,RB),0(RA)            ETX                     SA54276 46860022
         BE    ENDFOUND                 YES                             46880020
         SPACE                                                          46900020
         BCT   RDCB,SRCHLOOP            BUMP TO NEXT POSITION           46920020
         BR    RWKA                     RETURN                          46940020
         SPACE                                                          46960020
ENDFOUND EQU   *                                                        46980020
         TM    SCBQTYPE,SCBCONC         CONCENTRATOR?          @YA08108 46981000
         BO    UNITERM                  BRANCH IF YES          @YA08108 46982000
         MVI   0(RA),AVTEZERO           ZERO END CHAR TO        SA55941 46985022
*                                         PREVENT LOOP ON NEXT  SA55941 46990022
*                                         INTERRUPT             SA55941 46995022
UNITERM  EQU   *                                               @YA08108 46995500
SKIPCLR  EQU   *                                                SA59538 46996022
         NI    LCBCSW+4,X'FD'           RESET SCAN SWITCH       SA57685 46997022
         BCTR  RDCB,0                   ADJUST                          47000020
         LTR   R0,RDCB                  TEST FOR NEGATIVE COUNT         47020020
         L     RDCB,LCBDCBPT            RESTORE DCB BASE                47040020
         BC    4,NOTBSC                                                 47060020
         AH    R0,LCBCSW+5              ADD RESIDUAL COUNT              47080020
         STH   R0,LCBCSW+5              CORRECT THE COUNT               47100020
         B     NOTBSC                                                   47120020
         SPACE                                                          47140020
CHKCCW   EQU   *                                                        47160020
         TM    LCBCSW+4,CSWPC           CHAN PROGRAM CHECK      SA65357 47161052
         BNO   GETTEXT                  BR NO, TREAT NORMALLY   SA65357 47162052
         L     RWKA,LCBCPA+12           GET LAST TEXT CCW       SA65357 47163052
         LA    RWKA,0(,RWKA)            CLEAR HI BYTE           SA65357 47164052
         L     RPREFIX,LCBLSPCI-1       GET FIRST BUFFER CCW    SA65357 47165052
SEARCH   EQU   *                                                SA65357 47166052
         LA    RPREFIX,0(,RPREFIX)      CLEAR HI BYTE           SA65357 47167052
         CR    RPREFIX,RWKA             LAST TEXT CCW IN CHAIN  SA65357 47168052
         BE    GETTEXT                  BR YES, TREAT NORMALLY  SA65357 47169052
         TM    PRFTIC+3,TWO             IS THERE ANOTHER CCW    SA65357 47170052
         BO    GETLSPCI                 BR NO, START WITH PCI   SA65357 47171052
         L     RPREFIX,PRFTIC           GET NEXT CCW            SA65357 47172052
         B     SEARCH                   AND CONTINUE SEARCH     SA65357 47173052
GETLSPCI EQU   *                                                SA65357 47174052
         L     RWKA,LCBLSPCI-1          GET FIRST TEXT BUFFER   SA65357 47175052
         B     GETTEXT1                 AND CONTINUE            SA65357 47176052
GETTEXT  EQU   *                                                SA65357 47177052
         L     RWKA,LCBCPA+12           LAST TEXT CCW                   47180020
*                                         RESTART                       47200020
GETTEXT1 EQU   *                                                SA65357 47210052
         LA    RWKA,0(,RWKA)            CLEAR HI ORDER BYTE             47220020
         CR    RWKA,RCCW                WAS A SHORT BLOCK XENT          47240020
         BNE   PREVCCW                  BRANCH NO RCCW IS POINTING      47260020
*                                         TO NEXT CCW IN CHAIN          47280020
         L     RPREFIX,LCBLSPCI-1 .     LAST SERVICED BUFFER - IT       47300020
*                                         MIGHT BE A VERY SMALL MSG     47320020
*                                         OR LAST PART OF MSG TO        47340020
*                                         BUFFERED TERMINAL. IN         47360020
*                                         EITHER CASE THERE IS NO       47380020
*                                         PREVIOUS UNIT.                47400020
         LA    RPREFIX,AVTEZERO(,RPREFIX) CLEAR HI ORDER BYTE           47420020
         CR    RPREFIX,RWKA .           IS THE ABOVE CASE TRUE?         47440020
         BE    THISISIT .               BRANCH IF YES                   47460020
         SPACE                                                          47480020
         TM    CCWFLAGS,CCWSLI          HAS THIS CCW BEEN RE-USED       47500020
*                                         VIA PCI                       47520020
         BO    PREVCCW                  BRANCH IF YES                   47540020
         SPACE                                                          47560020
THISISIT EQU   *                                                        47580020
         SR    RA,RC                    DIFFERENCE BETWEEEN NEW         47600020
*                                         DATA ADDRESS AND ORIGINAL     47620020
         LCR   RB,RA                    MAKE DIFFERENCE POSITINVE       47640020
         SR    RDCB,RB                  NUMBER FO POSITIONS FOR SCAN    47660020
         LR    RA,RC                    SET FOR COMMON LOOP             47680020
         TM    LCBCSW+4,X'02'           MORE THAN ONE CCW       SA57685 47700022
         BNO   ETBEXIT                  BR NO, LAST CCW         SA57685 47703022
         LA    RC,9                     ASSUME WORST CASE       SA57685 47706022
         SR    RC,R0                    AMOUNT FOR NEXT CCW     SA57685 47709022
         SR    R0,RB                    ADJUST COUNT THIS CCW   SA57685 47712022
         B     CCWOK                    BR, SET UP FOR SCAN     SA57685 47715022
         SPACE                                                          47720020
PREVCCW  EQU   *                                                        47740020
         L     RPREFIX,LCBLSPCI-1       LST SER ICED BUFFER             47760020
         TM    LCBCSW+4,X'02'           MORE THAN ONE CCW?     @SA73826 47760700
         BNO   PREVCCWX                 BR NO, LAST CCW        @SA73826 47761400
         LA    RPREFIX,ZERO(,RPREFIX)   CLEAR FOR COMPARE      @SA73826 47762100
         CR    RPREFIX,RCCW             IS THIS THE CCW?       @SA73826 47762800
         BE    THISISIT                 BRANCH YES             @SA73826 47763500
PREVCCWX EQU   *                                               @SA73826 47764200
         OI    LCBCSW+4,X'02'           SET MULTIPLE CCW SWITCH SA57685 47765022
*                                         USE INTERFACE CONTROL SA57685 47770022
*                                         BIT RESET LATER       SA57685 47775022
LOOPCCW  EQU   *                                                        47780020
         LR    RDCB,RPREFIX             SAVE FOR LOOP CONTROL           47800020
         L     RPREFIX,PRFTIC           NEXT BUFFER(UNIT) FROM TIC      47820020
         LA    RPREFIX,0(,RPREFIX)      CLEAR FOR COMPARE               47840020
         CR    RPREFIX,RCCW             THIS CCW CSW POINTS TO          47860020
         BNE   LOOPCCW                  NO, CONINUE SEARCH              47880020
         SPACE                                                          47900020
         LA    RCCW,0(,RDCB)            PREVIOUS CCW IN CHAIN           47920020
         SR    RC,RA                    GET DIFFERNCE VOR SCAN          47940020
         LR    R0,RC                    AMOUNT FOR PREVIOUS             47960020
         LA    RC,9                     ASSUME WORST                    47980020
         SR    RC,R0                    AMOUNT FOR CURRENT CCW          48000020
         L     RA,CCWADDR-1             DATA ADDRESS PREVIOUS CCW       48020020
         LR    RB,RA                    SAVE -FUTURE UXE                48040020
         AH    RA,CCWCOUNT              ADD ORIGINAL COUNT              48060020
         SR    RA,R0                    SUBTRACT AMOUNT FOR SCAN        48080020
         MVC   LCBRCB(1),LCBCSW+6            CSW RESIDUAL COUNT         48100020
         LR    RC,RB                    RESET REGISTER FOR LOOP  A42376 48110020
         LR    RDCB,R0                 GET COUNT RIGHT           A42376 48112020
         CR    RA,RB                    LESS THAN ORIGINAL ADDRESS      48120020
*                                         POSSIBLE FOR SHORT RECORD     48140020
         BL    CHKCCW                  CK OF IN ONE OF 2 PREVIOUSA42376 48160020
         LA    RC,9 .                  TOTAL BYTES OFF            42376 48170020
         SR    RC,R0 .                 SAVE AMOUNT IN NEXT BUFFER 42376 48180020
CCWOK    EQU   *                                                        48280020
         MVI   LCBCSW+6,0               CLEAR RESIDUAL COUNT            48300020
         LR    RDCB,R0                  SET SCAN COUNT FOR LOOP         48320020
         BAL   RWKA,FINDETB             LOOP FOR ETB OR ETX             48340020
         MVC   LCBCSW+6(1),LCBRCB       RESTORE ORIGINAL CSW COUNT      48360020
         LTR   RC,RC                    COUNT EXHAUSTED?       @SA71694 48366061
         BZ    SKIPCLR                  BR YES, CHAN PROG CHECK@SA71694 48372061
         L     RCCW,8(,RCCW)            NO ETB OR ETX IN PREVIOUS       48380020
         LA    RCCW,0(,RCCW)            MUST BE NEXT CCW                48400020
         L     RA,CCWADDR-1             DATA ADDRESS -NEXT CCW          48420020
         LR    RDCB,RC                  SET SCAN COUNT                  48440020
         LH    R0,CCWCOUNT             IS WHATS LEFT             A42376 48460020
         SR    RC,R0                           IN TNE NEXT CCW   A42376 48470020
         BM    ETBEXIT                  YES, USE COMMON CODE   @SA70874 48472061
         B     CCWOK                   NO, LOOP BACK AND CK NEXT A42376 48474020
         EJECT                                                          48480020
         USING *,RF                                                     48500020
SCAN     EQU   *                                                        48520020
*    SCBTRNSP OR SCBNONTR IS SET UPON RECEIPT OF FIRST BLOCK OF DATA    48540020
* AND RESET IN BUFFER DISPOSITION.  IT'S PURPOSE IS TO DETERMINE        48560020
* LCBISZE AND TYPE OF MSG RECEIVED FOR SUBSEQUNET CONTINUE SEQUENCES    48580020
* I/O GENERATOR MIGHT BUILD A READ OF COUNT 1 OR 2 AFTER WRITE ACK/NAK  48600020
* IF LCOUT IS IN USE.  ON SUBSEQUENT BLOCKS OF DATA THE SCAN ROUTINE    48620020
* LOOKS FOR LINE CONTROL CHARACTERS IN LCBERCCW+12 IF LCOUT IS IN USE.  48640020
*     LCBVSTRT OR LCBRSTRT IS SET BY SCAN TO INFORM PCI APPENDAGE       48660020
* ON SUBSEQUENT PCI'S AND LINE END THAT SCAN HAS COMPLETED.             48680020
*    WHEN LCBVSTRT IS SET, ONE OF THE FOLLOWING SILL ALSO BE SET:       48700020
* LCBTTD,LCBENQ,LCBEOT,LCBOLT.  LCBRSTRT IS SET WHEN AN INVALID         48720020
* START CHARACTER IS DETECTED OR IF USER IS NOT MAINTAINING             48740020
* TRANSPARENCY OR NON-TRANSPARENCY FOR THIS MESSAGE.  THESE BITS ARE    48760020
* RESET IN ACTIVATE.                                                    48780020
         DROP  RSCB                                                     48800020
         SR    RB,RB                    CLEAR WORK REGISTER             48820020
         L     RC,LCBSCBA-1             SCB ADDRESS                     48840020
         USING IEDQSCB,RC                                               48860020
         L     RWKA,AVTSAVEX+TWLVE      DEB ADDRESS              X02004 48880005
         L     RA,DEBAPPAD-DEBNMSUB(,RWKA) APPENDAGE TABLE       X02004 48886005
         TM    TWO(RA),X80              IS ALTMH SPECIFIED       X02004 48892005
         BZ    DCBMHLC                  BRANCH NO                S22029 48903022
         TM    LCBSTAT2,LCBDIAL         DIAL LINE?               S22029 48904022
         BO    DCBMHLC                  BRANCH YES               S22029 48905022
         NC    LCBTTCIN,LCBTTCIN        IS CONNECTED INDEX ZERO  S22029 48906022
         BZ    DCBMHLC                  YES - USE OWNING MH LC   S22029 48908022
         LA    RWKA,FINDQCB .           GET ADDR OF ROUTINE USED S22029 48909022
*                                       TO FIND DESTINATION QCB  S22029 48910022
         BALR  RE,RWKA .                GET DEST QCB ADDRESS     S22029 48911022
         LR    RE,R0 .                  FOR CONNECTED MH TEST    S22029 48912022
         TM    QCBDSFLG-IEDQQCB(RE),QCBALTMH IS TERMINAL         S22029 48940022
*                                       CONNECTED TO ALTMH       S22029 48943022
         BZ    DCBMHLC .                NO - USE OWNING MH LC    S22029 48946022
         LA    RA,ONE(,RA)              USE ALTMH OPTIONS        X02004 48949005
DCBMHLC  EQU   * .                                               S22029 48952022
         MVC   LCBERCCW+1(ONE),0(RA)    SAVE STARTMH OPTIONS     X02004 48955005
         L     RPREFIX,LCBLSPCI-1 .     GET HEADER BUFFER        S21101 48980020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MESSAGE DETERMINEDS21101 49040020
         IC    RB,LCBISZE .             GET IDLES RESERVED       S21101 49041020
         LA    RWKA,PRFSHDR(RB) .       SET INITIAL SCAN IF FIRSTS21101 49042020
         ST    RWKA,LCBERCCW+4 .        SAVE IT FOR LATER        S21101 49043020
         BZ    NOTSET .                 BRANCH VERY FIRST BLOCK  S21101 49044020
         SPACE 1                                                 S21101 49045020
         TM    PRFSTAT1,PRFNHDRN .      HEADER BUFFER            S21101 49046020
         BO    SET .                    BRANCH IF NO             S21101 49047020
         SPACE 1                                                 S21101 49048020
         TM    SCBQTYPE,SCBBFMM .       MIDDLE OF MESSAGE        S21101 49049020
         BZ    SET .                    BRANCH IF NO             S21101 49050020
*                                                                S21101 49051020
*        THE FOLLOWING CODE IS EXECUTED FOR INPUT BUFFERED       S21101 49052020
* TERMINAL SUPPORT SUCH AS ENQUIRY MODE ON 2770.  WE ARE READING S21101 49053020
* A SUBSEQUNET BLOCK OF A MESSAGE AND THE HEADER BUFFER MUST BE  S21101 49054020
* CONVERTED TO A TEXT BUFFER.  THE CCW IS REBUILT OR POSSIBLE    S21101 49055020
* ERROR RETRIES BY ERP AND FOR RECEPTION OF TTD, ENQ, ETC.  A    S21101 49056020
* FLAG IS SET IN THE TIC FIELD (PRFBFMM) TO INDICATE TO MH THAT  S21101 49057020
* IDLES FOR THIS BUFFER ARE SET IN LCBISZE.                      S21101 49058020
*                                                                S21101 49059020
         TM    PRFTIC,PRFBFMM .         MID MSG SITUATION        S22025 49060022
         BO    SET .                    BRANCH IF YES            S22025 49060422
*                                                                S22025 49060822
         OI    PRFTIC,PRFBFMM .         SET HEADER CONVERTED     S22025 49061222
*                                         TO TEXT                S22025 49061622
         NI    PRFFLAGS,AVTEFF-CCWSLI . RESET WRAP SWITCH        S21101 49063020
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING TRANSPARENT   S21101 49064020
         BZ    ITSNONTR .               BRANCH IF NO-TEST LCIN   S21101 49065020
         SPACE 1                                                 S21101 49066020
         BAL   RB,SETISZE .             BUMP IDLES  COUNT        S21101 49067020
ITSOUT   EQU   *                                                 S21101 49068020
         BAL   RB,SETISZE .             TWO FOR TRANSPARENT      S21101 49069020
         B     ADJBUF .                 NOW RESET BUFFER CCW FOR S21101 49070020
*                                         ERP AND OTHER -TTD,ENQ S21101 49071020
         SPACE 1                                                 S21101 49072020
ITSNONTR EQU   *                                                 S21101 49073020
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 49074022
         BZ    ITSOUT .                 BRANCH IF LCOUT -BUMP IDLS21101 49075020
*                                         PAST STX               S21101 49076020
ADJBUF   EQU   *                                                 S21101 49077020
         BAL   RE,BLDBUFF1 .            REBUILD BUFFER USING NEW S21101 49078020
*                                         IDLES COUNT            S21101 49079020
         L     RC,LCBSCBA-1 .           RESET SCB BASE           S21101 49080020
NOTSET   EQU   *                                                 S21101 49088020
         L     RPREFIX,LCBERCCW+4 .     DATA ADDRESS IN BUFFER   S21101 49089020
*                                         TO SCAN FOR LINE CNTROLS21101 49090020
         B     SCANTEST .               START THE SCAN           S21101 49091020
         SPACE 5                                                 S21101 49092020
.ME1     ANOP                                                           49096022
FINDQCB  EQU   * .                                               S22029 49100022
* THIS ROUTINE GETS THE ADDRESS OF THE DESTINATION QCB           S22029 49104022
         STM   RPREFIX,RC,SUBSAVE-FINDQCB(RWKA) .SAVE REGISTERS  S22029 49108022
*                                       USED BY TNT CODE         S22029 49112022
         LH    RC,LCBTTCIN .            GET CONNECTED INDEX      S22029 49116022
         L     RA,AVTRNMPT .            GET TNT CODE BASE        S22029 49120022
         BAL   RPREFIX,TNTDCODE-IEDQTNTD(RA) .GO GET TERM TABLE  S22029 49124022
*                                       ENTRY                    S22029 49128022
         L     R0,AVTEZERO(RB) .        GET ADDR OF DEST QCB     S22029 49132022
SUBREGS  LM    RPREFIX,RC,SUBSAVE-FINDQCB(RWKA) .RESTORE REGS    S22029 49136022
         BR    RE .                     RETURN TO CALLER         S22029 49140022
SUBSAVE  DS    4F .                     REGISTER SAVE AREA       S22029 49144022
         AIF   ('&GEN' EQ 'MINI').L70                            S22029 49148022
         AIF   ('&GEN' EQ 'STSP').L59                            S22029 49152022
         AIF   ('&GEN' EQ 'QTAM').L59                            S22029 49156022
SET      EQU   *                                                        49160020
         SPACE                                                          49180020
         L     RWKA,LCBCPA+12 .         GET CURRENT CCW          S21101 49200020
         LA    RPREFIX,LCBERCCW+12 .    SCAN AREA                S21101 49201020
         LA    RA,ONE(,RPREFIX) .       ASSUME TRANSPARENT       S21101 49202020
         TM    SCBBSCFM,SCBTRNSP .      TRANSPARENT MODE         S21101 49220020
         BO    TRCOM                    BRANCH IF YES                   49240020
         BCTR  RA,R0                    ADJUST-LCIN,LCOUT-NONTRANSP     49260020
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 49280022
         BO    NOTR                     BRANCH IF LCIN                  49300020
         SPACE                                                          49320020
TRCOM   EQU   *                                                         49340020
         LR    RE,RWKA                  COPY CCW ADDRESS                49360020
         CLI   CCWCOUNT+1-CCW(RWKA),3   AT LEAST 3 CHARACTERS           49380020
        L     RWKA,CCWADDR-1-CCW(,RWKA) DATA ADDRESS                    49400020
         BH    MOVEIT                   YES                             49420020
         LH    RB,CCWCOUNT-CCW(RE)  GET COUNT                           49440020
         BCTR  RB,0                     FOR EXECUTE                     49460020
         EX    RB,MOVELC                MOVE                            49480020
         LA    RA,1(RA,RB)              ADJUST SCAN AREA                49500020
         TM    11(RE),X'03'             IS THERE NEXT UN IT             49520020
         BNZ   SCANTEST                 NO                              49540020
         L     RE,8(,RE)                GET NEXT UNIT                   49560020
         L     RE,CCWADDR-1-CCW(,RE)    GET DATA ADDRESS                49580020
         MVC   0(3,RA),0(RE)            MOVE DATA                       49600020
         B     SCANTEST                 SCAN DATA                       49620020
MOVEIT   EQU   *                                                        49640020
        MVC   1(2,RA),0(RWKA)          MOVE DATA FOR SCAN               49660020
         B     SCANTEST                 START SCAN                      49680020
         SPACE                                                          49700020
NOTR    EQU   *                                                         49720020
         LR    RPREFIX,RWKA             GET CURRENT CCW ADDRESS         49740020
         CLI   PRFCOUNT+1,3             AT LEAST 3 CHARCTERS            49760020
         BH    NOMOVE                   YES                             49780020
         LH    RWKA,PRFCOUNT            GET COUNT                       49800020
         L     RB,PRFIOADR-1            GET DATA ADDRSS                 49820020
         BCTR  RWKA,0                   FOR EXECUTE                     49840020
         EX    RWKA,MOVESCAN            MOVE REMANING COUNT             49860020
         LA    RA,1(RA,RWKA)            ADJUST SCAN AREA                49880020
         TM    PRFTIC+3,X'03'           IS THERE NEXT UNIT              49900020
         BNZ   STARTSCN                 NO                              49920020
         L     RPREFIX,PRFTIC           NEXT C W                        49940020
         L     RB,PRFIOADR-1            DATA DADDRESS                   49960020
         LA    RWKA,2                   MOVE AT LEAST 3                 49980020
         EX    RWKA,MOVESCAN            MOVE DATA                       50000020
STARTSCN EQU   *                                                        50020020
         LA    RPREFIX,LCBERCCW+12      SCAN AREA                       50040020
         B     SCANTEST                 SCAN THE DATA                   50060020
         SPACE                                                          50080020
NOMOVE   EQU   *                                                        50100020
         L     RPREFIX,PRFIOADR-1       FOR SCAN                        50120020
SCANTEST EQU  *                                                         50140020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 50160020
         USING IHADCB,RA                                                50180020
         L     RE,DCBSCTAD-1            SCT ADDRESS                     50200020
         DROP  RA                                                       50220020
         SR    RA,RA                    CLEAR EORK REGISTER             50240020
         IC    RA,STXENQCH(,RE)         TTD OOFFSET                     50260020
         LA    RWKA,1(RA,RE)            POINT TO SEQUENC                50280020
         CLC   1(2,RWKA),0(RPREFIX)     STX ENQ                         50300020
        BNE   NOTTTD                   NO                               50320020
         OI    SCBERR2,SCBABRTN         POSSIBLE ABORT                  50340020
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR                  50360020
         OI    LCBMSGFM,LCBTTD+LCBVSTRT . SAET STATUS            S21101 50380020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED  @OS76474 50390000
         BCR   7,RD                     Y- NO NEED TO UPDTE CCW@OS76474 50460000
         SPACE 5                                                 S21101 50540020
BLDBUFF  EQU   *                                                        50560020
         LR    RE,RD .                  SET FINAL EXIT ADDRESS   S21101 50570020
BLDBUFF1 EQU   *                                                 S21101 50572020
*        REBUILD BUFFER IF FIRST BLOCK FROM POLLING                     50580020
         L     RPREFIX,LCBLSPCI-1       LAST SERVICED BUFFER            50600020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             50620020
         IC    RWKA,LCBISZE             NO OF IDLES FOR HEADER          50640020
         LA    RWKA,PRFSHDR(RWKA)          PREIX PLUS IDLES             50660020
         L     RB,PRFIOADR-1            DATA ADDRESS                    50680020
         LR    RC,RB                    SAVE FOR UPDATE                 50700020
         LA    RB,0(,RB)                CLEAR HI ORDER BYTE             50720020
         SR    RB,RWKA                  FIND DIFFERNCE IN ADDRESS       50740020
         SR    RC,RB                    NEW LOWER DATA DADRESS          50800020
         AH    RB,PRFCOUNT              ADJUST COUNT                    50820020
         ST    RC,PRFIOADR-1            NEW DATA ADDRESS                50840020
         STH   RB,PRFCOUNT              SET NEW COUNT                   50860020
         BR    RE .                     REUTRN TO CALLER         S21101 50880020
NOTTTD   EQU   *                                                        50900020
         CLC   1(1,RWKA),0(RPREFIX)     STX RECEIVED                    50920020
         BNE   TRTTD                    NO TRY TRANSPARENT TTD          50940020
STXREC   EQU   *                                                        50960020
         TM    SCBBSCFM,SCBTRNSP .      TRANSPARENT              S21101 50980020
         BNZ   ERRSET                   YES, WRONAG FORMAT              51000020
         TM    SCBBSCFM,SCBNONTR .      NON-TRANSPARENT MODE     S21101 51020020
         BNZ   ITSET                    YES                             51040020
         TM    LCBERCCW+1,IN            LCIN                            51060020
         BO    ITSET                    YES                             51080020
         SPACE                                                          51100020
         BAL   RB,SETISZE               BUMP IDLES                      51120020
ITSET    EQU   *                                                        51140020
         OI    SCBBSCFM,SCBNONTR .      SET NONTRANSPARENT BIT   S21101 51160020
ALLSET   EQU   *                                                        51180020
         OI    LCBMSGFM,LCBVSTRT .      VALID START CHARACTER    S21101 51200020
         BR    RD                       RETURN                          51220020
TRTTD    EQU   *                                                        51240020
         CLC   0(2,RWKA),0(RPREFIX) .  STX                      SA44892 51260022
         BNE   NOTRAN                                           SA44892 51290022
         TM    SCBBSCFM,SCBNONTR .    RECEIVING NONTRANSP       SA44892 51320022
         BNZ   SETERR                                           SA44892 51350022
         OI    LCBMSGFM,LCBVSTRT .     VALID START SEQUENCE.    SA44892 51380022
         TM    SCBBSCFM,SCBTRNSP .     ALREADY RECEIVE AT LEAST SA44892 51410022
*                                      ONE DATA SEQUENCE ?      SA44892 51440022
         BCR   7,RD .                  YES, RETURN              SA44892 51470022
         BAL   RB,SETISZE .            BUMP IDLES               SA44892 51500022
         BAL   RB,SETISZE .            BUMP IDLES               SA44892 51530022
         OI    SCBBSCFM,SCBTRNSP .     SET TRANSP . RECEIVE     SA44892 51560022
         B     BLDBUFF .               REBUILD BUFFER FOR CASE  SA44892 51590022
*                                      OF MULTIPOINT LINE .     SA44892 51620022
NOTRAN   EQU   *                                                        51760020
         CLC   2(1,RWKA),0(RPREFIX)     INQ RECEIVED                    51780020
         BNE   NOTENQ                   NO                              51800020
         SPACE                                                          51820020
         OI    LCBMSGFM,LCBVSTRT+LCBENQ SET ENQ START            S21101 51840020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED    S21101 51860020
         BCR   7,RD                     BRANSH YES                      51880020
         B     BLDBUFF                  REBUILD CHANNEL PROGRAM@OY11983 51900091
         SPACE                                                          52000020
NOTENQ   EQU   *                                                        52020020
         IC    RA,EOTCH(,RE)            EOT SEQUENCE                    52040020
         LA    RWKA,1(RA,RE)            POINT TO EOT SEQUENCE           52060020
         CLC   0(1,RWKA),0(RPREFIX)     EOT RECEIVED                    52080020
         BNE   TRYSOH                   NOT EOT, TRY SOH                52100020
         OI    LCBMSGFM,LCBEOT+LCBVSTRT SET STATUS BITS          S21101 52120020
         BR    RD                       ERETURN                         52140020
TRYSOH   EQU   *                                                        52160020
         IC    RA,ESOHCH(,RE) .         SOH % E                  S22026 52247022
         LA    RWKA,1(RA,RE) .          POINT TO SEQUENCE        S22026 52254022
         CLC   0(3,RWKA),0(RPREFIX) .   SOH % E SEQUENCE         S22026 52261022
         BE    TPER .                   YES, SET TPER BIT        S99238 52262022
         SPACE                                                          52263022
         IC    RA,CSOHCH(,RE) .         SOH % C                  S99238 52264022
         LA    RWKA,1(RA,RE) .          POINT TO SEQUENCE        S99238 52265022
         CLC   0(3,RWKA),0(RPREFIX) .   SOH % C SEQUENCE         S99238 52266022
         BNE   TRYOLT .                 NO, TRY NEXT SEQUENCE    S22026 52268022
         OI    LCBFLAG3,LCBSOHC         SOH % C MESSAGE          S99238 52270022
TPER     EQU   * .                                               S99238 52272022
         OI    LCBFLAG3,LCBOBRRD .      SET TPER RECORD          S22026 52275022
         B     STXREC .                 GO TO COMMON CODE        S22026 52282022
TRYOLT   EQU   *                                               @OY20488 52289082
         AIF   ('&GEN' EQ 'QTAM' OR '&GEN' EQ 'MINI').LL49              52289182
         AIF   ('&GEN' EQ 'STSP').LL49                         @OY20488 52289282
         IC    RA,RSOHCH(,RE)           INSERT SOHR OFFSET     @OY20488 52289382
         LA    RWKA,1(RA,RE)            POINT TO SOHR CHARS    @OY20488 52289482
         CLC   0(3,RWKA),0(RPREFIX)     SOHR                   @OY20488 52289582
         BNE   PROBOLT                  BRANCH NO              @OY20488 52289682
         OI    SCBERR2,SCBSOHE          SET SOHR MESSAGE FLAG  @OY20488 52289782
         IC    RA,EOTCH(,RE)            EOT OFFSET             @OY20488 52289882
         LA    RWKA,1(RA,RE)            POINT TO EOT CHAR      @OY20488 52289982
         CLI   0(RWKA),ASCIEOT          ASCII TERMINAL         @OY20488 52290082
         BNE   SOHEBCD                  BRANCH NO              @OY20488 52290182
         CLI   SS1(RPREFIX),ASTAT3      IR                     @OY20488 52290282
         BE    STXREC                   BRANCH YES             @OY20488 52290382
         TM    SS1(RPREFIX),ASTAT2      CR,IR,EC,DC,CC         @OZ29663 52291782
         BNZ   YESLOG                   BRANCH YES             @OZ29663 52291882
         TM    SS0(RPREFIX),ASTAT1      DB,DE                  @OZ29663 52291982
         BNZ   STXREC                   BRANCH YES             @OZ29663 52292082
         CLI   SS0(RPREFIX),ASCIDE      DEVICE END ONLY        @OZ29663 52292182
         BE    STXREC                   BRANCH YES             @OZ29663 52292282
         B     YESLOG                   LOG STATUS MESSAGE     @OZ29663 52292382
SOHEBCD  EQU   *                                               @OZ29663 52292482
         OI    LCBFLAG3,LCBSOHR         SET SOH%R MSG INDICATOR  S99228 52293122
         TM    SS1(RPREFIX),STAT2       CR, IR, EC, DC, CC?      S99228 52293322
         BNZ   YESLOG                   YES, LOG SOH%R MESSAGE   S99228 52293522
         TM    SS0(RPREFIX),STAT1       DB, DE?                  S99228 52293722
         BNZ   STXREC                   BRANCH EITHER            S99228 52293922
YESLOG   EQU   *                                                 S99228 52294122
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUF S99228 52294422
         BZ    YESLOG1                  BRANCH ON NO             S99228 52294822
         OI    SCBERR4,SCBTRMLN         SET TERMINAL ERROR FLAG  S99228 52295222
YESLOG1  EQU   *                                                 S99228 52295622
         OI    LCBFLAG3,LCBOBRRD        SET RECORDING FLAG       S99228 52296022
         B     STXREC                   RETURN TO COMMON CODE    S99228 52296422
PROBOLT  EQU   *                                                 S99228 52298922
.LL49    ANOP                                                    S99228 52299422
         IC    RA,TOTESOH(,RE)          SOH % / FOR TOTE         S21903 52300022
         LA    RWKA,1(RA,RE)            POINT TO SEQUENCE        S21903 52306022
         CLC   0(3,RWKA),0(RPREFIX)     ON LINE TEST?            S21903 52312022
         BNE   SOHTRY                   TRY SOH                         52320020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR 1ST TIME               S21101 52340020
         BNZ   STXREC                   NO                              52360020
         OI    LCBMSGFM,LCBVSTRT+LCBOLT INDICATE OLT REQUEST     S21101 52380020
         OI    SCBBSCFM,SCBNONTR .      SET NONTRANSPARENT BIT   S21101 52400020
         BR    RD                       RETURN                          52520020
SOHTRY   EQU   *                                                        52540020
         CLC   0(1,RWKA),0(RPREFIX)     SOH RECEIVED                    52560020
         BE    STXREC                   YES, USE COMMON CODE            52580020
         IC    RA,DLEEOTCH(,RE)         INDEX TO SEQUENCE               52600020
         LA    RWKA,1(RA,RE)            BUMP TO SEQUENCE                52620020
         CLC   0(2,RWKA),0(RPREFIX)     DLE EOT RECEVIED                52640020
         BNE   ERRSET                   NO                              52660020
         NI    LCBTPCD+11,AVTEFF-DISDLEOT DONT WRITE DLE EOT NEXT       52680020
         OI    LCBMSGFM,LCBEOT+LCBENQ+LCBVSTRT VALID START       S21101 52700020
*                                         SET DLE EOT RECEIVED   S21101 52710020
         OI    LCBSTAT2,LCBNEGRP        SET NEGATIVE RESPONSE           52720020
         MVC   LCBERCCW+12(1),1(RWKA)   MOVE EOT               @OY19728 52730082
         BR    RD                       RETURN                          52740020
ERRSET   EQU   *                                                        52760020
         TM    LCBSTAT2,LCBDIAL         DIAL                            52780020
         BZ    SETERR                   NO                              52800020
         SPACE                                                          52820020
*        THIS MIGHT BE ID ENQ IF CPU ID WAS HIT ON LINE                 52840020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR 1ST TIME               S21101 52860020
         BNZ   SETERR                   NO, NOT FIRST BLOCK             52880020
         SPACE                                                          52886020
TESTENT  EQU   * .                                               S21101 52892020
         CLI   LCBCPA+24,CCWDISAB .     CONNECTION JUXT MADE     S21101 52900020
         BNE   SETERR .                 BRANCH IF NO             S21101 52950020
         SPACE                                                          53000020
         TM    LCBCSW+3,CEDE            PCI OR LINE END                 53040020
         BCR   8,RD                     BRANCH IF ENTERED FROM PCI      53060020
         TM    LCBCSW+4,PCIFLAG         PCI IN STATUS                   53080020
         BZ    STRTID                   BRANCH NO                       53100020
         XI    LCBCSW+4,PCIFLAG         TURN OFF PCI FOR LINE END       53120020
*                                         ENTRY BEFORE RESTART          53140020
         BR    RD                       RETURN TO PCI                   53160020
STRTID   EQU   *                                                        53180020
         LA    RCCW,LCBCPA+48           ASSUME NO WRITE TONE            53200020
         CLI   LCBTPCD+5,TPWRTONE                                       53220020
         BNE   EXIT3                    NO, RESTART                     53240020
         LA    RCCW,LCBCPA+56           ADDRESS OF WRITE ID ADK         53260020
         B     EXIT3                    TO RESTART                      53280020
SETERR   EQU   *                                                        53300020
         OI    SCBERR3,SCBFORMN         SET FORMAT ERROR                53320020
         OI    SCBERR4,SCBTXTTN         TEXT ERROR                      53340020
         OI    LCBMSGFM,LCBRSTRT .      SET INVALID START        S21101 53360020
         BR    RD                       RETURN                          53380020
MOVELC   MVC   1(1,RA),0(RWKA)          'EXECUTED'                      53400020
MOVESCAN MVC   0(1,RA),0(RB)            'EXECUTED'                      53420020
SETISZE  EQU   *                                                        53440020
         ICM   RPREFIX,AD,LCBLSPCI .    FIRST BUFFER             X01004 53460005
         LH    RA,PRFSIZE .             PICK UP SIZE             X01004 53480005
         LA    RA,ONE(,RA) .            ADD ONE                  X01004 53520005
         STH   RA,PRFSIZE .             RESTORE NEW SIZE         X01004 53540005
         IC    RA,LCBISZE .             PICK UP IDLES COUNT      X01004 53580005
         LA    RA,ONE(,RA) .            ADD ONE                  X01004 53600005
         STC   RA,LCBISZE .             STORE NEW COUNT          X01004 53640005
         BR    RB                       RETURN                          53680020
         DROP  RC                                                       53700020
         USING IEDQSCB,RSCB                                             53720020
         EJECT                                                          53780020
         USING *,RF                                                     53800020
CHACK    EQU   *                                                        53820020
*                                                                       53840020
*        THIS SUBROUTINE INSPECTS ARESPONSE RECEIVED FOR BSC LINES      53860020
* AND SETS FLAGS ACCORDINGLY IN LCBERCCW FOR CALLER TO INTERROGATE.     53880020
*                                                                       53900020
         LH    RA,CCWCOUNT              ORIGINAL COUNT                  53920020
         SH    RA,LCBCSW+5              SUBTRACT RESIDUAL COUNT         53940020
         BCTR  RA,0                     DECREMENT ONE                   53960020
         BCTR  RA,0                     NOW TWO TO RESPONSE             53980020
         L     RB,CCWADDR-1             DATA ADDRESS                    54000020
         AR    RB,RA                    BACK UP TO RESPOSNE AREA        54020020
         L     RA,LCBDCBPT              GET DCB ADDRESS                 54040020
         USING IHADCB,RA                                                54060020
         L     RE,DCBSCTAD-1            SPECIAL CHARACTERS              54080020
         DROP  RA                                                       54100020
         SR    RA,RA                   CLEAR WORK REGIER                54120020
         IC    RA,ACK0CH(,RE)           ACK0 SEQUNCE                    54140020
         LA    RWKA,1(RA,RE)            POIN  TO SEQUENCE               54160020
         CLC   0(2,RWKA),0(RB)          TEST ACK0                       54180020
         BNE   TRACK1      I            TRY ACK1                        54200020
         SPACE                                                          54220020
         MVI   LCBERCCW,RACK0           SET ACK0 INDICATOR              54240020
         BR    RD                       RETURN                          54260020
         SPACE                                                          54280020
TRACK1   EQU   *                                                        54300020
         LA    RWKA,3(,RWKA)            BUMP TO ACK1                    54320020
         CLC   0(2,RWKA),0(RB)          TEST FOR ACK-I                  54340020
         BNE   TRYNAK                                                   54360020
         SPACE                                                          54380020
         MVI   LCBERCCW,RACK1           SET ACK-1 INDICATOR             54400020
         BR    RD                       RETURN                          54420020
         SPACE                                                          54440020
TRYNAK   EQU   *                                                        54460020
         IC    RA,NAKCH(,RE)            POINT TO NAK                    54480020
         LA    RWKA,1(RA,RE)            NAK SEQUENCE                    54500020
         CLC   0(1,RWKA),1(RB)          TEST FOR NAK                    54520020
         BNE   TRYWACK                  NOT A NAK                       54540020
         MVI   LCBERCCW,RNAK            SET NAK I DICATOR               54560020
         BR    RD                       RETURN                          54580020
         SPACE                                                          54600020
TRYWACK  EQU   *                                                        54620020
         IC    RA,WACKCH(,RE)           INDEX TO WACK                   54640020
         LA    RWKA,1(RA,RE)            POINT TO WACK SEQUENCE          54660020
         CLC   0(2,RWKA),0(RB)          TEST FOR WACK                   54680020
         BNE   TRYDLEOT                 TRY DLE-EOT             SA57695 54700022
         SPACE                                                          54720020
         MVI   LCBERCCW,RWACK           SET WACK INDICATOR              54740020
         BR    RD                       RETURN                          54760020
         SPACE                                                          54762022
TRYDLEOT EQU   *                                                        54764022
         IC    RA,DLEEOTCH(,RE)         INDEX TO SEQUENCE               54766022
         LA    RWKA,1(RA,RE)            POINT TO SEQUENCE               54768022
         CLC   0(2,RWKA),0(RB)          DLE EOT                         54770022
         BNE   TRYTTD                   TRY TTD                 SA57695 54772022
         NI    LCBTPCD+11,X'FF'-DISDLEOT DONT SEND DLE EOT              54780022
*                                         SEQUENCE                      54783022
         MVI   LCBTSTSW,AVTEFF          VORCE NEW CONNECTION            54786022
         OI    LCBSTAT2,LCBNEGRP        INDICATE NEGATIVE RESPONSE      54789022
         NI    LCBMSGFM,AVTEFF-LCBACKI  RESET ACK COUNTER      @SA74852 54792000
         MVI   LCBERCCW,RDLEEOT+REOT    SET DLE EOT AND EOT    @SA74852 54792700
*                                       INDICATOR              @SA74852 54793400
         BR    RD                       RETURN                 @SA74852 54794100
         SPACE                                                          54795022
TRYTTD   EQU   *                                                        54800020
         IC    RA,EOTCH(,RE)            INDEX TO EOT                    54820020
         LA    RWKA,1(RA,RE)            POINT TO EOT SEQUENCE           54840020
         CLC   0(1,RWKA),1(RB)          TEST FOR EOT                    54860020
         BNE   TRYRVI                   NO,                             54880020
EOTREC   EQU   *                                                        54900020
         SPACE                                                          54920020
         NI    LCBMSGFM,AVTEFF-LCBACKI  RESET ACK COUNTER FOR CASS21101 54930020
*                                          OF BSC DIAL WHERE     S21101 54932020
*                                          SCBNOEOT IS ON . I/O GS21101 54934020
*                                          WILL NOT RESET IT     S21101 54936020
         MVI   LCBERCCW,REOT            SET EOT INDICATOR               54940020
         BR    RD                       RETURN                          54960020
         SPACE                                                          54980020
TRYRVI   EQU   *                                                        55000020
         IC    RA,RVICH(,RE)            INDEX TO SEQUENCE               55020020
         LA    RWKA,1(RA,RE)            POINT TO SEQUENCE               55040020
         CLC   0(2,RWKA),0(RB)          RVI RECEIVED                    55060020
         BNE   TRYENQ                   NO                              55080020
         MVI   LCBERCCW,RRVI            SET RVI INDICATOR               55100020
         BR    RD                       RETURN                          55120020
TRYENQ   EQU   *                                                        55140020
         IC    RA,ENQCH(,RE)            INDEX                           55160020
         LA    RWKA,1(RA,RE)            POINT TO SEQUNECE               55180020
         CLC   0(1,RWKA),1(RB)          THIS ENQ                        55200020
         MVI   LCBERCCW,0               ASSUME ERROR                    55220022
         BCR   7,RD                     RETURN IF ERROR                 55230022
         CLI   AVTDOUBX,TPRDRPEB        ENQ IN RESP TO TEXT    @SA69964 55233061
         BCR   8,RD                     BR YES, LEAVE AS INVAL @SA69964 55236061
         MVI   LCBERCCW,RENQ                                            55240020
         BR    RD                       RETURN                          55260020
         EJECT                                                          55520020
.L59     ANOP                                                           55540020
IDCHK    EQU   *                                                        55560020
         USING *,RF                                                     55580020
*                                                                       55600020
*        THIS SUBROUTINE WILL VERIFY AN IDENTIFICATION SEQUENCE FOR     55620020
* DIAL LINES.                                                           55640020
*                                                                       55660020
         USING  IEDQSCB,RSCB                                            55680020
         DROP  RPREFIX                                                  55700020
         L     RPREFIX,LCBDCBPT         DCB  BASE                       55720020
         USING IHADCB,RPREFIX                                           55740020
         L     RB,CCWADDR-1             ID RESD AREA                    55760020
         LA    RB,0(,RB)                CLEAR HI ORDER BYTE             55780020
         AH    RB,CCWCOUNT              ADD ORIGIANL COUNT              55800020
         LH    RA,LCBCSW+5              RESIDUAL COUNT                  55820020
         AIF   ('&GEN' NE '').L61                                       55840020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        55860020
         BZ    TRYTWX                   NO                              55880020
.L61     AIF   ('&GEN' EQ 'STSP').L62                                   55900020
         AIF   ('&GEN' EQ 'QTAM').L62                                   55920020
         SPACE                                                          55940020
         LA    RA,2(,RA)                ASSUME ACK SEQUENCE RCVD        55960020
         CLI   LCBERCCW,RENQ            ENQ RECEIVED                    55980020
         BE    ADJUST                   YES,BRANCH             @XA11338 56000000
         CLI   LCBERCCW,RNAK            NAK RECEIVED           @XA11338 56003000
         BE    ADJUST                   YES,BRANCH             @XA11338 56006000
         CLI   LCBERCCW,REOT            EOT RECEIVED           @XA11338 56009000
         BNE   TRYTWX                   NO,BRANCH              @XA11338 56012000
ADJUST   EQU   *                                                        56015000
         BCTR  RA,0                     ADJUST FOR ENQ                  56020020
.L62     ANOP                                                           56040020
TRYTWX   EQU   *                                                        56060020
         STC   RA,AVTDOUBX .            SAVE TRUE RESIDUAL CNT          56080020
         SR    RB,RA                    SUBTRACT TRUE RESIDUAL CNT      56100020
         LA    RA,LCBERCCW+24           END OF ID AREA                  56120020
         SR    RA,RB                    PAD AREA                        56140020
         BNP   NOPAD                    NO PADDDING REQUIERD            56160020
         MVI   0(RB),C' '               SET FIR BLANK                   56180020
         BCTR  RA,0                     FOR EXECUTE INTR                56200020
         LTR   RA,RA                    ONLY 1 PAD REQUIRED             56220020
         BNP   NOPAD                    BRANCH NO NORE PADS             56240020
         BCTR  RA,0                     FOR EXECUTE                     56260020
         EX    RA,MOVER                 BLANK AREA                      56280020
NOPAD    EQU   *                                                        56300020
         L     RB,CCWADDR-1             DATA ADDRESS                    56320020
         SR    RA,RA                    CLEAR WORK REGISTER             56340020
         LR    R0,RA                    CLEAR WORK REGISTER             56360020
         IC    R0,DCBILCT               NUMBER OF ILISTS                56380020
         LR    RE,RA                    CLEAR WORK REGISTER             56400020
         TM    LCBSTAT1,LCBSENDN .      SEND SIDE START WITH FIRST      56420020
         BO    START1ST .               INVITATION LIST                 56440020
         SPACE                                                          56460020
         IC    RE,LCBUCBX               RLN-1                           56480020
         SR    R0,RE                    NUMBER OF ILISTS TO SCAN        56500020
START1ST EQU   *                                                        56520020
         MVI   LCBPRI,0                 SET FIRST TIME SWITCH           56540020
NEXTLIST EQU   *                                                        56560020
         SLL   RE,2                     MULTIPLY FOR INDEX              56580020
         L     RC,DCBINVLI(RE)          NEXT INVITATION LIST            56600020
         DROP  RPREFIX                                                  56620020
         USING IEDQPRF,RPREFIX                                          56640020
         LA    RWKA,LISTSIZE(,RC)       BUMP TO FIRST ENTRY             56660020
         CLI   LCBPRI,0                 FIRST TIME                      56680020
         BNE   NOTFIRST                 NOT FIRST                       56700020
         MVI   LCBPRI,PRILNFRE          RESET FIRST TIME                56720020
         SPACE                                                          56740020
         CLI   TWO(RC),2                SIZE OF EACH ENTRY 1(+INDEX)    56760020
         BH    IDSRCH                   BRANCH IF ID'S USED             56780020
         BCR   4,RD                     BRANCH IF 0-OUTPUT ONLY         56800020
         CLI   1(RC),1                  ONLY ONE ACTIVE ENTRY           56820020
         BNE   IDSRCH                   NO                              56840020
         CLI   LISTSIZE(RC),DUMMY       DUMMY ENTRY                     56860020
         BNE   IDSRCH .                 BRANCH FOR 1 CHAR ID            56880020
         SPACE                                                          56900020
         CLC   AVTDOUBX(1),CCWCOUNT+1 . ORIGINAL COUNT=ORIGINAL, UE     56920020
*                                         DID WE RECEIVED NO ID         56940020
         BNE   TRYNXTIL                 CHECK FURTHER           SA65389 56960054
         BR    RD .                     RETURN ID'S ARE NOT USED        57000020
         SPACE                                                          57020020
NOTFIRST EQU   *                                                        57040020
IDSRCH   EQU   *                                                        57060020
         IC    RA,TWO(,RC)              SIZE OF EACH ENTRY              57080020
         BCTR  RA,0                     DECREMENT FOR INDEX BYTE        57100020
         CLI   0(RWKA),FE               END OF LIST                     57120020
         BE    TRYNXTIL                 YES, GET NEXT ILIST             57140020
         SPACE                                                          57160020
         BCTR  RA,0                     DECREMENT FOR EXECUTE           57180020
         EX    RA,IDCLC                 COMPARE ID                      57200020
         BE    IDFND                    BRANCH FOUND                    57220020
         SPACE                                                          57240020
         LA    RWKA,2(RA,RWKA)          BUMP TO NEXT ENTRY              57260020
         B     IDSRCH                   LOOK AT NEXT                    57280020
         SPACE                                                          57300020
TRYNXTIL EQU   *                                                        57320020
         SRL   RE,2                     GET TRUE RLN -1                 57340020
         LA    RE,1(,RE)                NEXT LINE NUMBER                57360020
         BCT   R0,NEXTLIST              GET NEXT ILIST ADDRESS          57380020
         AIF   ('&GEN' NE '').Z19                                       57400020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        57420020
         BZ    ITSATWX                  NOT BSC                         57440020
.Z19     AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z20               57460020
         AIF   ('&GEN' EQ 'QTAM').Z20                                   57480020
         CLI   LCBINCAM,IDRETRY         RETRY LIMIT REACHED             57500020
         BL    4(RD)                    BRANCH IF NO                    57520020
ITSATWX  EQU   *                                                        57540020
.Z20     ANOP                                                           57560020
BADID    EQU   *                                                        57580020
         L     RPREFIX,LCBDCBPT         RESTORE DCB ADDRESS    @YA05167 57590000
         OI    SCBERR3,SCBTMIDN         SET ID ERROR                    57600020
         MVI   LCBTSTSW,AVTEFF          TO FORCE SUBSEQUENCE HANGUP     57620020
         OI    LCBSTAT2,LCBNEGRP        SET NEGATIVE RESPONSE           57640020
         B     ERERROR                  POST ERROR                      57660020
IDFND    EQU   *                                                        57680020
         IC    RA,1(RWKA,RA)            INDEX BYTE OF ID ENTRY          57740020
         AR    RA,RA                    DOUBLE FOR NEGATIVE INDEX       57760020
         SR    RC,RA                    BACK UP TO TNT OFFSETS          57780020
         TM    LCBSTAT1,LCBSENDN        SENDING                 SA65865 57783054
         BNO   SETTTCIN                 BR NO, SET LCBTTCIN     SA65865 57786054
         CLC   LCBTTCIN,AVTEZERO(RC)    CORRECT TERMINAL        SA65865 57789054
         BE    SETTTCIN                 YES, SET TTCIN         @YA05167 57792000
         AR    RC,RA                    NEXT ENTRY ADDRESS     @YA05167 57792500
         SR    RA,RA                    CLEAR                  @YA05167 57793000
         IC    RA,TWO(RC)               SIZE OF EACH ENTRY     @YA05167 57793500
         LA    RWKA,0(RA,RWKA)          BUMP TO NEXT ENTRY     @YA05167 57794000
         B     IDSRCH                   CONTINUE SEARCH        @YA05167 57794500
SETTTCIN EQU   *                                                SA65865 57795054
         L     RB,DCBDEBAD-IHADCB(RPREFIX)  DEB ADDRESS        @YA05167 57800000
         SR    RE,RE                    CLEAR FOR IC           @XA06335 57802000
         IC    RE,DEBNMEXT-DEBTCBAD(RB) NUMBER OF EXTENTS      @YA05167 57804000
         SR    RB,RB                    CLEAR FOR IC           @YA05167 57806000
         IC    RB,DCBEIOBX-IHADCB(RPREFIX) LCB SIZE            @YA05167 57808000
         L     RPREFIX,DCBIOBAD-IHADCB(RPREFIX)  IOB ADDRESS   @YA05167 57810000
         LA    RPREFIX,0(RPREFIX)       CLEAR                  @YA05167 57812000
         SH    RPREFIX,LCBSIZE          POINT TO LCB BOUNDARY  @YA05167 57814000
         LA    RLCB,0(RLCB)             SET FOR COMPARE        @XA06335 57816000
LOOPLCB  EQU   *                                               @XA06335 57818000
         AR    RPREFIX,RB               FIRST/NEXT LCB         @YA05167 57820000
         CR    RPREFIX,RLCB             IS THIS THE LINE?      @YA05167 57822000
         BE    DECR                     BR YES,CONTINUE        @XA06335 57824000
         CLC   LCBTTCIN-LCBRCB(TWO,RPREFIX),0(RC) TNT MATCH?   @YA05167 57826000
         BE    BADID                    BR YES,TREAT AS BAD ID @XA06335 57828000
DECR     EQU   *                                               @XA06335 57830000
         BCT   RE,LOOPLCB               CONTINUE SEARCH        @XA06335 57832000
         MVC   LCBTTCIN(2),0(RC)        SET IN LCB                      57834000
         BR    RD                       RETURN                          57836000
IDCLC    CLC   0(1,RWKA),0(RB)          EXECUTED INSTRUCTION            57840020
MOVER    MVC   1(1,RB),0(RB)            EXECUTED INSTRUCTION            57860020
         EJECT                                                          57880020
POLLRT   EQU   *                                                        57900020
         USING *,RF                                                     57920020
*                                                                       57940020
*        THIS SUBROUTINE COMPUTES SOURCE INFORMATION ON AN AUTOPOLL     57960020
* LINE.                                                                 57980020
*                                                                       58000020
         MVI   LCBCPA+24,CCWNOP         INDDICATE SEARCH WAS DONE       58020020
         MVI   LCBCPA+53,AVTEZERO       TURN OFF ERP FOR        SA66604 58026005
*                                        AUTOPOLL INDICATOR     SA66604 58032005
         L     RA,LCBDCBPT              GET DCB ADDRESS        @SA62375 58033000
         USING IHADCB,RA                                       @SA62375 58034000
         SR    RE,RE                    CLEAR FOR IC           @SA62375 58035000
         IC    RE,DCBEIOBX              GET LCB SIZE           @SA62375 58036000
         SH    RE,H8S                   EXTENSION OFFSET       @SA62375 58037000
         ALR   RE,RLCB                  GET EXTENSION ADDRESS  @SA62375 58038000
         DROP  RA                                              @SA62375 58039000
         L     RPREFIX,LCBLSPCI-1       HEADER BUFFER                   58040020
         L     RWKA,LCBCPA+64 .         ADDRESS OF INDEX BYTE    S22025 58060022
         L     RA,LCBCPA+48             2N D POLL COMMCAND              58120020
         LR    RC,RA                    SAVE START OF LIST              58140020
         SH    RA,H8                    BACK UP TO CONTROL WORDS        58160020
         SR    RB,RB                    CLEAR WORK REGISTER             58180020
         STH   RB,LCBTTCIN .            ASSUME NO SOURCE         S22025 58190022
         IC    RB,TWO(,RA)              SIZE OF EACH ENTRY              58200020
         BCTR  RC,0                     DECREMENT FOR INDEX SCAN        58220020
POLLLOOP EQU   *                                                        58240020
         AR    RC,RB                    BUMP TO NEXT ENTRY              58260020
         CLC   0(1,RC),0(RWKA)          THIS THE INDEX BYTE             58280020
         BE    SRCEFND                  YES SET UP SOURCE               58300020
         SPACE                                                          58320020
         AIF   ('&GEN' EQ 'BISC').Z21                                   58340020
         CLI   1(RC),FE                 END OF LIST                     58360020
         AIF   ('&GEN' NE '').Z22                                       58380020
         BCR   8,RD .                   BRANCH IF YES            S22025 58400022
         AGO   .Z21                                                     58420020
.Z22     ANOP                                                           58440020
         BNE   POLLLOOP                 NO,GET NEXT ENTRY               58460020
         AGO   .Z23                                                     58480020
.Z21     ANOP                                                           58500020
         CLI   2(RC),FE                 END OF BSC LIST                 58520020
         BNE   POLLLOOP                 NO, GET NEXT ENTRY              58540020
.Z23     ANOP                                                           58560020
         BR    RD                       RETURN                          58660020
         SPACE 2                                                        58680020
SRCEFND  EQU   *                                                        58700020
         BCTR  RB,R0 .                  DECREMENT FOR INDEX      S22025 58720022
         SR    RC,RB .                  BACK UP TO TNT OFFSET    S22025 58750022
         STCM  RC,AD,LCBINVPT .         POINTER FOR NEXT POLL    Y01948 58780005
         MVC   LCBERADR(THREE),LCBINVPT SET POLL ADDRESS       @SA62375 58810000
         IC    RB,0(,RWKA)              GET INDEX BYTE                  58840020
         AR    RB,RB                    DOUBLE FOR NEGAIVE INDEX        58860020
         SR    RA,RB                    BACK UP TO TNT OFFSET           58880020
         LH    RC,0(RA)                 GET TNT OFFSET                  58900020
         STH   RC,LCBTTCIN .            PUT TNT OFFSET IN LCB    S22029 58905022
         L     RB,AVTSAVEX+TWLVE        DEB ADDRESS              X02004 58916305
         L     RB,DEBAPPAD-DEBNMSUB(,RB) APPENDAGE TABLE         X02004 58916405
         TM    TWO(RB),X80              IS ALTMH SPECIFIED       X02004 58916505
         BZ    CORECTLC                 BRANCH NO                S22029 58916622
         LR    RA,RWKA .                SAVE ADDR OF INDEX BYTE  S22029 58916722
         LR    RWKA,RF .                SAVE BASE REGISTER       S22029 58916822
         NC    LCBTTCIN,LCBTTCIN        IS CONNECTED INDEX ZERO  S22029 58916922
         BZ    CORECTLC                 YES - USE OWNING MH LC   S22029 58917022
         S     RWKA,FQCB .              GET ADDR OF FINDQCB RTN  S22029 58917122
         BALR  RE,RWKA .                GET DEST QCB ADDRESS     S22029 58917222
         LR    RWKA,RA                  RESTORE INDEX BYTE ADDR  S22029 58917322
         LR    RE,R0 .                  QCB ADDR FOR CHECKING    S22029 58917422
*                                       FOR CONNECTED MH         S22029 58917522
         TM    QCBDSFLG-IEDQQCB(RE),QCBALTMH IS TERMINAL         S22029 58917622
*                                       CONNECTED TO ALTMH       S22029 58917722
         BZ    CORECTLC .               USE OWNING MH LC         S22029 58917822
         LA    RB,ONE(,RB)              USE ALTMH OPTIONS        X02004 58917905
CORECTLC EQU   * .                                               S22029 58918022
         TM    0(RB),LCIN               LC=IN SPECIFIED          X02004 58918105
         BNO   FINDSCBQ                 BRANCH IF NO             S99228 58919722
         TM    LCBSTAT2,LCBSYNC         BISC LINE?               S22028 58919822
         BO    TSOPRES                  BRANCH YES               S22028 58920122
         MVI   AVTEZERO(RWKA),X'16'     REPLACE INDEX WITH EOA   S22028 58920422
         B     FINDSCBQ                 FIND SCB                 S22028 58920722
TSOPRES  EQU   *                                                 S22028 58921022
         TM    LCBTSOB,LCBTSBUF         TSO BUFFER?              S22028 58921322
         BNO   FINDSCBQ                 BRANCH NO                S22028 58921622
         MVI   AVTEZERO(RWKA),ZERO      ZERO INDEX BYTE          S22028 58921922
.Z23A    ANOP                                                     M6293 58922522
FINDSCBQ EQU   * .                      ENTRY TO SET SCBAND QCB  S22025 58928822
         STH   RC,LCBTTCIN              SET IN LCB                      58933320
         L     RA,AVTRNMPT              GET TNT CODE ADDRESS            59000020
         USING IEDQTNTD,RA                                              59020020
         BAL   RPREFIX,TNTDCODE         LINK TO IT                      59040020
         USING IEDQTRM,RB                                               59060020
         L     RB,TRMDESTQ-1            GET QCB ADDRESS                 59080020
         DROP  RB                                                       59100020
         USING IEDQQCB,RB                                               59120020
         AIF   ('&GEN' EQ 'MINI').MIX0590                        S22029 59121022
         AIF   ('&GEN' EQ 'BISC').MIX0590                        S22029 59122022
         OI    LCBTSOB,LCBTSBUF .       INDICATE TSO TERM ON     S22029 59123022
*                                       THIS LINE                S22029 59123222
         TM    QCBFLAG,QCBTSSES         ARE WE CONNECTED TO A    S22029 59126022
*                                       TIME-SHARING TERMINAL    S22029 59127022
         BO    MIX5910 .                BRANCH IF YES            S22029 59128022
         NI    LCBTSOB,AVTEFF-LCBTSBUF  NO, INDICATE A TCAM      S22029 59129022
*                                       TERMINAL ON THIS LINE    S22029 59130022
MIX5910  EQU   *                                                 S22029 59131022
.MIX0590 ANOP                                                    S22029 59132022
         SR    RA,RA                    CLER WORK REGISTER              59140020
         LR    R0,RA                    CLAR WORK REGISTER              59160020
         IC    RA,QCBSCBOF              QCB OFSET TO SCB                59180020
         IC    R0,AVTSCBSZ              GET SIZE FO SCB                 59200020
         MR    RA-1,R0                  GET OFFFSET TO RIGHT SCB        59220020
         AL    RA,LCBSCBDA-1            SET SCB BASE                    59240020
         LR    RSCB,RA .               SET SCB ADDR             SA49233 59250022
         STCM  RA,AD,LCBSCBA .          SET SCB ADDRESS IN LCB   Y01948 59260005
         DROP  RA                                                       59320020
         DROP  RB                                                       59340020
         BR    RD                       RETURN                          59360020
*********************************************************************** 59362022
*        THE FOLLOWING ADCON IS USED TO ESTABLISH ADDRESSABILITY      * 59364022
*        TO THE FINDQCB SUBROUTINE                                    * 59366022
*                                                                     * 59368022
FQCB     DC    A(POLLRT-FINDQCB) .      FINDQCB OFFSET           S22029 59370022
*                                                                     * 59372022
*********************************************************************** 59374022
         EJECT                                                          59380020
         AIF   ('&GEN' EQ 'STSP').L71                                   59400020
         AIF   ('&GEN' EQ 'QTAM').C                              S22025 59420022
BSCRSP   EQU   *                                                        59440020
*                                                                       59460020
*        THE FOLLOWING CODE HANDLES TRANSPARENT OUTPUT TO A BSC         59480020
* TERMINAL AND WACK IN RESPONSE TO TEXT FOR A TERMIBAL DEFINED AS       59500020
* BUFFERED ON THE TERMINAL MACRO.                                       59520020
*                                                                       59540020
         USING *,RF                                                     59560020
         USING IEDQSCB,RSCB                                             59580020
         MVC   LCBLINK(1),LCBERCCW      SAVE RESPONSE INDDICATOR        59600020
         TM    SCBSTATE,SCBTRANP        TRANSPARENT                     59620020
         BZ    NOTRP                    BRANCH NO                       59640020
         L     RCCW,LCBCPA+52           CURRENT UNIT                    59660020
         ST    RF,LCBRCB                SAVE BASE                       59680020
         L     RWKA,LCBDCBPT            DCB B ASE                       59700020
         USING IHADCB,RWKA                                              59720020
         MVI   LCBERCCW,NOPCI           ASSUJE PCI NOT USED             59740020
         TM    DCBPCI,SNDPCI            PCI ON SEND                     59760020
         BZ    NOTUSED                  BRANCH IF NO PCI                59780020
         SPACE                                                          59800020
         DROP  RWKA                                                     59820020
         MVI   LCBERCCW,PCIOPT          SET PARAMETER FOR ROUTINE       59840020
NOTUSED  EQU   * .                                              SA44893 59850022
         BAL   RA,FINDBUFF              GET BUFFER BASE                 59860020
         L     RF,LCBRCB                S RESETORE BASE                 59880020
TESTLAST EQU   *                                                        60180020
         TM    LCBCPA+28,CCWSKIP       LAST BLOCK SENT                  60200020
         BZ    MOREDATA                 NO                              60220020
         SPACE                                                          60240020
         L     RCCW,LCBCPA+52           CURRETN CCW                     60260020
         NI    SCBQTYPE,AVTEFF-SCBBFMM  RESET MIDDLE OF MESSGE          60280020
         MVC   CCW+9(3),LCBCPA+57 SET CURR TIC TO NEXT UNIT             60300020
         MVC   LCBCPA+13(3),LCBCPA+53   SAVE CURRENT NIT POINTER        60320020
         MVI   LCBTPCD+2,TPBUFEOT       SET TP OP CODE                  60340020
         BAL   RE,DIALTEST              CHECK BSC QFLUSH       @XA08073 60360091
         B     RESETEOT .               NOT BSC DIAL SNED PRI    S21101 60370020
*                                         OR NOT BSC CONTT,    @XA08073 60370691
*                                         SEND PRI W MASTER=YES@XA08073 60371291
         SPACE 1                                                 S21101 60372020
         B     RTBUFEOT .               TREAT AS TRUE EOM        S21101 60374020
MOREDATA EQU   *                                                        60380020
         SPACE                                                          60400020
         LA    RA,LCBCPA+24             UNIT EXIT INDICATOR             60420020
         LR    RE,RPREFIX               GET CURRENT BUFFER ADDRESS      60440020
         SR    R0,R0                    CLEAR WORK REGISTER             60460020
         LR    RCCW,R0                  CLEAR REGISTER                  60480020
         IC    R0,PRFNBUNT              NUMBER UNIT S IN BUFFER         60500020
         B     STLOOP                   ENTER LOOP                      60520020
TRPLOOP  EQU   *                                                        60540020
         L     RE,PRFTIC-IEDQPRF(,RE)   NEXT UNIT (BUFFER)              60560020
         AH    RCCW,AVTKEYLE            BUMP BY KEY LENGTH              60580020
STLOOP   EQU   *                                                        60600020
         L     RB,PRFTIC-IEDQPRF(,RE)   NEX CCW                         60620020
         LA    RB,0(,RB)                CLEAR HI ORDER BYTE             60640020
         CLR   RB,RA                    THIS THE CCW                    60660020
         BE    NOMORE                   BRANCH YES                      60680020
         BCT   R0,TRPLOOP               GET NEXT UNIT IN BUFFER         60700020
NOMORE   EQU   *                                                        60720020
         STC   R0,LCBERCCW              SAVE UNIT COUNT FOR LATER       60740020
         LA    R0,PRFSUNIT-IEDQPRF(,RE) START OF UNIT                   60760020
         L     RWKA,CCWADDR-1-CCW(,RE)  DATA ADDRESS                    60780020
         LA    RWKA,0(,RWKA)            FOR COMPARE HALF                60800020
         SR    RWKA,R0                  PREVIOUS SENT (OR PREFIX)       60820020
         AH    RWKA,CCWCOUNT-CCW(RE)    ADD AMOUNT SENT                 60840020
         LR    RC,RPREFIX               COPY HEADER BUFFER ADDR SA62329 60850005
         AR    RCCW,RWKA                TOTAL AMOUNT                    60860020
         CH    RCCW,PRFSIZE             END OF BUFFER                   60880020
         BL    SETOFF                   NO                              60900020
         L     RC,LCBCPA+56             NEXT BUFFER ADDRESS     SA62329 60920005
         LA    RCCW,PRFSTXT-PRFSUNIT    SET OFFSET INTO NEXT RECORD     60940020
SETOFF   EQU   *                                                        60960020
         MVC   SCBDEOB+1(3),PRFCRCD-IEDQPRF(RC) SET DISK ADDR   SA62329 60980005
         MVC   SCBDEOB(1),PRFNTXT-IEDQPRF(RC) SET DISK RECORD   SA62329 61000005
         STH   RCCW,SCBEOB              SAVE OFFSET IN TO BUFFER        61020020
         SPACE                                                          61040020
         CLI   LCBLINK,RWACK            WACK ON A BUFFERED LINE         61060020
         BNE   GOMORE                   NO                              61080020
         SPACE                                                          61100020
         L     RCCW,LCBCPA+52           CURRENT UNIT IN BUFFER          61120020
         MVC   LCBCPA+13(3),LCBCPA+53   SAVE CURRENTC W POINTER         61140020
         MVC   CCW+9(3),LCBCPA+57       SET NEXT CCW POINTER            61160020
         B     NOTNOW                   RESET THE LINE                  61180020
         SPACE 5                                                        61200020
GOMORE   EQU   *                                                        61220020
*        THE FOLLOWING VODE DETERMINES IF THE NEXT BLOCK TO BE          61240020
*        WRITTEN IS THE LAST MESSAGE BLOCK.  IF SO, DLE ETX IS TO       61260020
*        BE WRITTEN.  THE MAJOR DECISION IS A COMPARISON BETWEEN        61280020
*        OUPUT BOCK SIZE AND KEY LENGTH.                                61300020
         LR    RE,RPREFIX               COPY BUFFER ADDRESS             61306051
         LR    RPREFIX,RC               COPY PREFIX UNIT ADDR   OX02181 61312051
         LA    RC,LCBCPA+24             SET EXIT ADDRESS                61320020
         LA    RB,1                     INITIALZIE FOR LOOP             61340020
         LH    RWKA,SCBBKFCT+1          OUTPUT BLOCK SIZE               61360020
         CH    RWKA,AVTKEYLE            COMPARE WITH KEY LENGTH         61400020
         BH    GREAT                    BRANCH IF GREATER               61420020
         SPACE                                                          61440020
         TM    PRFSTAT1,PRFNLSTN        LAST BUFFER                     61460020
         BZ    TRLOOP1                  BRANCH YES, LAST BLOCK          61480020
         SPACE                                                          61500020
         CLI   LCBERCCW,2               TWO UNIT BUFFER         SA56617 61520022
         BH    NOTLAST                  BRANCH IF ANOTHER BLOCK SA56617 61530022
         BE    CKNXTLST                 CHK NEXT TO LAST        SA56617 61540022
         EX    RWKA,NEXTBLK             SEE IF ANOTHER BLOCK FROM       61560020
*                                         THIS UNIT                     61580020
         BNL   NOTLAST                  BRANCH IF ANOTHER BLOCK         61600020
         SPACE                                                          61620020
         TM    LCBCPA+59,2              NEXT BUFFER ABAILABLE           61640020
         BNZ   NOTLAST                  NO                              61660020
         L     RA,LCBCPA+56             NEXT UNIT ADDRESS               61680020
COMTEST  EQU   *                                                SA56617 61690022
         TM    PRFSTAT1-IEDQPRF(RA),PRFNLSTN LAST UNIT                  61700020
         BO    NOTLAST                  BRANCH NO                       61720020
         SPACE                                                          61740020
         SPACE                                                          61760020
         MVI   LCBERCCW,0               INDCATE NOT END OF BUFFER       61780020
         CLI   PRFOPCDE-IEDQPRF(RA),0   ANOTHER BLOCK AFTER THIS        61800020
         BE    SETETX                   BRANCH IF LAST BLOCK            61820020
         B     NOTLAST                  SNED NEXT BLOCK                 61840020
* FOLLOWINT CODE TAKES CARE OF CASE OF TWO UNIT BUFFER, PRFSIZE SA56617 61841022
* LESS THAN MULTIPLE OF KEYLENGTH, AND NEXT BUFFER IS LAST      SA56617 61842022
* CONTIANING LAST BLOCK OF MESSAGE.                             SA56617 61843022
CKNXTLST EQU   *                                                SA56617 61844022
         SR    R0,R0                    CLEAR REGISTER          SA56617 61845022
         IC    R0,LCBCPA+52             REMAINING IN UNIT       SA56617 61846022
         L     RCCW,LCBCPA+56           ADDR OF NEXT UNIT       SA65359 61847051
         AH    R0,CCWCOUNT              REMAINING DATA          SA56617 61849022
         CH    R0,SCBEOBSZ              MORE THAN 1 BLOCK LEFT  SA56617 61850022
*                                       IN THE MESSAGE          SA56617 61851022
         BNL   NOTLAST                  BRANCH IF ANOTHER BLK   SA56617 61852022
         TM    CCW+11,2                 NEXT BUFFER AVIALABLE   SA56617 61853022
         BNZ   NOTLAST                  BRANCH NO               SA56617 61854022
         L     RA,CCW+8                 NEXT BUFFER ADDRESS     SA56617 61855022
         B     COMTEST                  COMMON CODE             SA56617 61856022
         SPACE                                                          61860020
TRLOOP1  EQU   *                                                        61880020
         L     RE,PRFTIC-IEDQPRF(,RE)   NEXT UNIT                       61900020
         LA    RE,0(,RE)                CLEAR HI ORDER BYTE             61920020
         CLR   RE,RC                    THIS THE CCW                    61940020
         BE    FOUNDIT                  YES                             61960020
         LA    RB,1(,RB)                BUMP UNIT COUNT                 61980020
         B     TRLOOP1                  GET NEXT  UNIT                  62000020
         SPACE                                                          62020020
FOUNDIT  EQU   *                                                        62040020
         STC   RB,LCBERCCW              SAVE FOR LATER TEST             62060020
         SR    RE,RE                    CLEAR WORK REGISTER             62080020
         IC    RE,LCBCPA+52             REMANING COUNT                  62100020
         CLR   RE,RWKA                  GREATER                         62120020
         BH    NOTLAST                  BRANCH HIGH            @OZ08362 62140091
         EX    RB,CLIUNT                THIS LAST UNIT                  62160020
         BE    SETETX                   SEND LAST BLOCK                 62180020
TRYNEXT  EQU   *                                                        62200020
         LA    RB,1(,RB)                BUMP UNIT COUNT                 62220020
         EX    RB,CLIUNT                LAST UN IT                      62240020
         BNE   NOTLAST                  NO                              62260020
         L     RA,LCBCPA+56             NEXT UNIT                       62280020
         CLI   PRFOPCDE-IEDQPRF(RA),0   MORE DATA IN NEXT UNIT          62300020
         BE    SETETX                   YES, NEXT BLOCK IS LAST         62320020
         B     NOTLAST                  NEXT BLOCK IS NOT LAST          62340020
         SPACE 3                                                        62360020
*        TO HERE WHEN BLOCK SIZE GREATER THAN KEYLENGH                  62380020
GREAT    EQU   *                                                        62400020
         IC    RB,LCBERCCW              UNIT COUNT IF BUFFER            62420020
         TM    LCBCPA+59,X'02'          NEXT  UNIT AVAILABLE            62440020
         BZ    ITSOK                    YES                             62460020
         TM    PRFSTAT1,PRFNLSTN        LAST BUFFER                     62480020
         BO    NOTLAST                  NO                              62500020
         B     SETETX                   BRANCH FOR LAST BLOCK           62520020
         SPACE                                                          62540020
ITSOK    EQU   *                                                        62560020
         LA    RE,LCBCPA+56-(PRFTIC-IEDQPRF) ADJUST FOR COMMON CODE     62580020
         BCT   RB,NEXTUNT               BRANCH NOT END OF UNIT          62600020
         L     RPREFIX,LCBCPA+56        NEXT UNIT ADDRESSS              62620020
         IC    RB,PRFNBUNT              GET NUMBER OF UNITS             62640020
NEXTUNT  EQU   *                                                        62660020
         L     RE,PRFTIC-IEDQPRF(,RE)   NEXT UNIT                       62680020
GREATER  EQU   *                                                        62700020
         TM    PRFTIC-IEDQPRF(RE),X'20' THIS UNIT SHOULD TIC TO         62720020
*                                         CH ANNEL PROGRAN AREA         62740020
         BO    THISUNIT                 BRANCH YES                      62760020
         SPACE                                                          62780020
         BCT   RB,NEXTUNT               GET NEXT UNIT                   62800020
         TM    PRFTIC+3-IEDQPRF(RE),X'02'   NEXT BUFFER ABAILBLE        62820020
         BNZ   NOTLAST                  BRANCH NO                       62840020
         L     RPREFIX,PRFTIC-IEDQPRF(,RE)     NEXT BUFFER              62860020
         IC    RB,PRFNBUNT              NUMBER UNIT S IN NEX BUFFER     62880020
         B     NEXTUNT                  LOOK AT NEXT BUFFER             62900020
         SPACE                                                          62920020
THISUNIT EQU   *                                                        62940020
         TM    PRFSTAT1,PRFNLSTN        LAST BUFFER                     62960020
         BO    NOTLAST                  BRANCH NO                       62980020
         BCT   RB,NOTLAST               BRANCH NOT END OF BUFFER        63000020
         CLI   PRFOPCDE-IEDQPRF(RE),0   WILL THERE  BE ANOTHER          63020020
*                                         BLOCK AFTER THIS ONE          63040020
         BNE   NOTLAST                  BRANCH IF ANOTHER BLOCK         63060020
SETETX   EQU   *                                                        63080020
         L     RA,LCBCPA+24             DLEETB CCW                      63100020
         AH    RA,H3                    BUMP ADDRESS TO DLEETX          63120020
         ST    RA,LCBCPA+24             NEW CCW SET                     63140020
         OI    LCBCPA+28,CCWSKIP        INDICATE LAST BLOCK SENT        63160020
NOTLAST  EQU   *                                                        63180020
*        THE FOLLOWING CODE SETS UP THE CCW'S IN BUFFERS TO WRITE       63200020
*        THE NEXT BLOCK                                                 63220020
         SR    RB,RB                    CLEAR WORK REGISTER             63240020
         LR    R0,RB                    LCEAR WORK REGISTER             63260020
         L     RCCW,LCBCPA+52           CURRENT UNIT                    63280020
         IC    R0,CCWCOUNT+1            ORIGIANL COUNT                  63300020
         AL    R0,CCWADDR-1             UPDATE DATA ADDRESS             63320020
         ST    R0,CCWADDR-1             NEW CCW SET                     63340020
         IC    RB,LCBCPA+52             REMAINING COUNT IN CURRENT      63360020
         LTR   RB,RB                    IS REMAINING CNT ZERO  @XA07517 63366000
         BZ    SETCCWCD                 BRANCH-YES GET NEXT    @XA07517 63372000
         CH    RWKA,AVTKEYLE            COMPARE BLOCK WITH KEY SIZE     63380020
         BNH   SAME                     LOW OR EQUAL                    63400020
         SPACE                                                          63420020
*        INSERT CODE IF NEXT BLOCK NOT AVAILABLE                        63440020
NEXTUNIT EQU   *                                                        63460020
         STC   RB,CCWCOUNT+1            NEW DATA COUNT                  63480020
         LR    RA,RCCW                  CURRENT UNIT ADDRESS    SA65359 63482051
         TM    LCBCPA+28,CCWSKIP        LAST BLOCK              SA65359 63484051
         BNO   SETCCWCD                 BR NO, CHAIN DATA       SA65359 63486051
         TM    LCBCPA+59,X'02'          NEXT UNIT AVAILABLE     SA65359 63488051
         BO    SENDIT                   BR NO, LAST BLOCK       SA65359 63490051
SETCCWCD EQU   *                                                SA65359 63492051
         OI    CCWFLAGS,CCWCD           SET CHAIN DATA FLAG             63500020
         L     RA,LCBCPA+56             NEXT UNIT IN CHAIN              63520020
         ST    RA,CCWOPCDE+8            SET TIC ADDRESS FROM CURRENT    63540020
*                                         TO NEXT                       63560020
         MVI   CCWOPCDE+8,CCWTIC        TIC OP CODE                     63580020
         LTR   RB,RB                    WE AT END OF UNIT               63600020
         BNZ   MORED                    BRANCH NO                       63620020
         MVC   LCBCPA+53(3),LCBCPA+57   NEXT IS NOW CURRENT             63640020
MORED    EQU   *                                                        63660020
         MVC   LCBCPA+49(3),LCBCPA+53   SET TIC ADDRESS FROM DLESTX     63680020
         TM    CCWOPCDE+11,X'02'        IS THERE NEXT BUFFER            63700020
         BZ    TRENTER                  YES                             63720020
*        NEXT BLOCK NOT AVAILABLE, TREAT AS CHAN PROG CHECK             63740020
         LA    RWKA,2                   CHANNEL PROGRAM CHECK           63760020
         ST    RWKA,LCBCPA+56           SET AS NEXT UNIT ADDRESS        63780020
         B     PCSTART                  START ON WRITE SYN'S            63800020
         SPACE                                                          63820020
*        IF NEXT BLOCK NOT AVAILABLE,RESTART IS MADE ON WRITE SYNS      63840020
* LOOP.  PCI WILL UPDTE NEXT CCW POINTER (LCBCPA+56) AND SET 1 BYTE     63860020
* REMAING COUNT IN LCBCPA+52.  IF THERE IS A REMAINING COUNT OF 0       63880020
* IN CURRENT CCW BUT THE NEXT CCW IS AVAILABLE, PCI WILL SET UP         63900020
* LCBCPA+52 (WHICH BECOMES NEW CURRENT UNIT) AND LCBCPA+56 WHICH        63920020
* WILL BE THE SUBSEQUENT 1ST CCW OF FUTURE BLOCK.  IF REMAINING         63940020
* COUNT IN CURRENTCCW IS 0 AND THE NEXT UNIT IS NOT AVAILABLE, PCI      63960020
* WILL SET UP LCBCPA+48 (TIC FROM DLE STX) IN ADDITION TO LCBCPA+56     63980020
* AND LCBCPA+52.                                                        64000020
NOTHIS   EQU   *                                                        64020020
         L     RA,PRFTIC-IEDQPRF(,RA)   NEXT UNIT                       64040020
TRENTER  EQU   *                                                        64060020
         TM    PRFTIC-IEDQPRF(RA),X'20' NEXT ENDING UIT                 64080020
         BO    THISONE                  THS IS IT                       64100020
         TM    PRFTIC+3-IEDQPRF(RA),X'02' NEXT BUFFER AVAILABLE         64120020
         BNZ   PCSTART                  BRANCH NO                       64140020
         B     NOTHIS                   GET NEXT UNIT                   64160020
THISONE  EQU   *                                                        64180020
         ST    RA,LCBCPA+52             NEW CURRENT                     64200020
         IC    RB,PRFOPCDE-IEDQPRF(,RA) REMAINING COUNT IN NEXT         64220020
         STC   RB,LCBCPA+52             SAVE FOR NEXT TIME ARAOUND      64240020
RESTR    EQU   *                                                        64260020
         MVC   LCBCPA+57(3),PRFTIC+1-IEDQPRF(RA)  ADDRESS OF NEXT UNIT  64280020
SENDLAST EQU   *                                                        64300020
         TM    LCBCPA+28,CCWSKIP        LAST BLOCK              SA65359 64302051
         BO    NOCHANGE                 ETX SETUP ALREADY DONE @OZ08362 64304091
         TM    LCBCPA+59,X'02'          NEXT UNIT AVAILABLE?   @OZ08362 64304191
         BZ    NOCHANGE                 YES- THIS IS NOT LAST  @OZ08362 64304291
         LR    RCCW,RA                  SET UNIT ADDR          @OZ08362 64304391
         MVI   LCBERCCW,PCIOPT          DON'T POST BUFFERS     @OZ08362 64304491
         BAL   RA,FINDBUFF              GET BUFFER PREFIX BASE @OZ08362 64304591
         L     RF,LCBRCB                RESTORE REGISTER       @OZ08362 64304691
         LR    RA,RCCW                  RESET CURRENT UNIT ADDR@OZ08362 64304791
         TM    PRFSTAT1,PRFNLSTN        MARKED LAST?           @OZ08362 64304891
         BO    NOCHANGE                 NO-THIS IS NOT LAST    @OZ08362 64304991
         SR    RB,RB                    CLEAR FOR INSERT       @OZ08362 64305091
         IC    RB,LCBCPA+52             GET REMAINING COUNT    @OZ08362 64305191
         LTR   RB,RB                    IS IT ZERO             @OZ08362 64305291
         BNZ   NOCHANGE                 BRANCH NO- NOT LAST    @OZ08362 64305391
         L     RB,LCBCPA+24             GET ADDRESS FOR ETB    @OZ08362 64305491
         AH    RB,H3                    ADD OFFSET TO ETX      @OZ08362 64305591
         ST    RB,LCBCPA+24             AND REPLACE IT         @OZ08362 64305691
         OI    LCBCPA+28,CCWSKIP        SHOW ETX IS SET UP     @OZ08362 64305791
NOCHANGE EQU   *                                               @OY13667 64306091
         NI    CCWFLAGS-CCW(RA),AVTEFF-CCWCD RESET CHAIN DATA   SA65359 64308051
         OI    CCWFLAGS-CCW(RA),CCWCC   SET COMMAND CHAINING    SA65359 64310051
         LA    RB,LCBCPA+24             SET TIC TO CPA                  64320020
         ST    RB,PRFTIC-IEDQPRF(,RA)   SET IN CCW                      64340020
         MVI   PRFOPCDE-IEDQPRF(RA),CCWWRITE    >ET COMMAND CODE        64360020
         MVI   PRFTIC-IEDQPRF(RA),CCWTIC    SET TIC COMMAND             64380020
         LA    RWKA,LCBCPA+40           RESTART ADDRESS                 64400020
         B     RESTCOM                  USE COMMON EXIT                 64420020
         SPACE                                                          64440020
SAME     EQU   *                                                        64460020
         LR    RA,RCCW                  CURRENT UNIT ADDRESS            64480020
         CLR   RB,RWKA                  REMAINING GREATER THAN BLOCK    64500020
         BNL   GOSAME .              YES, UNIT CONTAINS NEXT BLKSA44894 64520022
         SPACE                                                          64540020
         TM    LCBCPA+28,CCWSKIP        LAST BLOCK                      64560020
         BZ    NEXTUNIT                 NO                              64580020
         SPACE                                                          64600020
         CLC   LCBERCCW(1),PRFNBUNT     LAST UNIT OF LAST BUFFER        64620020
         BNE   NEXTUNIT                 NO, IT'S NEXT TO LST            64640020
         STC   RB,CCWCOUNT+1            SET COUNT FOR LAST UNIT         64660020
         TM    SCBBSCFM,SCBNPDTR        IS PADDING REQUESTED   @YA09751 64664000
         BO    SENDIT                   NO USE REAL DATA COUNT @YA09751 64668000
         STC   RWKA,CCWCOUNT+1          USE DATA COUNT + PADS  @YA09751 64672000
         MVI   LCBCPA+52,AVTEZERO       CLEAR REMAINING COUNT  @YA09751 64676000
         B     SENDIT                   BRANCH IF YES                   64680020
GOSAME   EQU   *                                                        64700020
         SR    RB,RWKA                  GET DIFFERENCE                  64720020
         STC   RB,LCBCPA+52             SAVE REMAINING COUNT            64740020
         STC   RWKA,CCWCOUNT+1-CCW(,RA) SET NEW COUNT                   64760020
         LA    RC,LCBCPA+24             CCW EXIT ADDRESS                64780020
         L     RB,PRFTIC-IEDQPRF(,RA)   NEXT CCW                        64800020
         LA    RB,0(,RB)                CLEAR HI BYTE FOR COMPARE       64820020
         CLR   RB,RC                    ALREADY WRITE FROM THIS CCW     64840020
         BNE   RESTR                    NO, SAVE ADDRESSS OF NEXT       64860020
SENDIT   EQU   *                                                        64880020
         ST    RA,LCBCPA+48             SET UP TIC ADDRESS              64900020
         MVI   LCBCPA+48,CCWTIC         SET COMMAND CODE                64920020
         B     SENDLAST                 GO EXIT                         64940020
         SPACE                                                          64960020
         SPACE                                                          64980020
NOTRP    EQU   *                                                        65000020
         L     RCCW,LCBCPA+12           CURRENT CCW                     65020020
         CLI   CCWCOUNT+1,0             DID CHAN PROG CHECK OCCUR       65040020
         BNE   UPDTFLD                  BRANCH IF NO                    65060020
         TM    CCW+11,X'02'             NEXT BUFFER AVAILABLE           65080020
         BNZ   PCSTART                  BRANCH IF NEXT NOT AVAIL        65100020
         MVC   LCBCPA+13(3),CCW+9 .     SET UP NEW START CCW     S21101 65120020
         L     RCCW,8(,RCCW)            BUMMP TO NEXT BUFFER            65140020
         MVC   LCBRECAD,PRFCRCD-IEDQPRF(RCCW) SET QUEUE ADDRESS         65160020
         MVC   LCBNTXT,PRFNTXT-IEDQPRF(RCCW) SET DIAK RECORD            65180020
         LA    R0,PRFSTXT-PRFSUNIT      SAVE FOR LATER                  65200020
         STH   R0,LCBRECOF              SET IN LCB                      65220020
UPDTFLD  EQU   *                                                        65240020
         MVC   SCBDEOB+1(3),LCBRECAD    MOVE QUEUE ADDRESS              65260020
         MVC   SCBEOB(2),LCBRECOF       SET OFFSET INTO RECORD          65280020
         MVC   SCBDEOB(1),LCBNTXT       SET DISK RECORD                 65300020
         BAL   RE,DIALTEST              CHECK BSC QFLUSH       @XA08073 65310091
         B     NODIAL .                  BRANCH IF NOT DIAL SEND S21101 65312020
*                                         OR NOT BSC CONTT,    @XA08073 65312691
*                                         SEND PRI W MASTER=YES@XA08073 65313291
          SPACE 1                                                S21101 65314020
         BAL   RC,ONLYEOT .             IF ONLY EOT IS LEFT TREATS21101 65316020
*                                          TRUE END OF MESSAGE INS21101 65318020
*                                          ORDER TO FLUSH QUEUE  S21101 65318420
         B     RTBUFEOT .               BRANCH ONLY EOT IS LEFT  S21101 65318820
          SPACE 1                                                S21101 65319220
NODIAL   EQU    *                                                S21101 65319620
         CLI   LCBLINK,RWACK            WACK ON BUFFERED LINE           65320020
         BNE   EXIT3                    BRAVNCH NO TO RESTART           65340020
         SPACE                                                          65360020
         BAL   RC,ONLYEOT .             CHECK IF WE ARE AT END   S21101 65380020
*                                          OF MESSAGE            S21101 65390020
         B     EXIT3 .                  BEANCH IF ONLY EOT REMINSS21101 65400020
          SPACE 1                                                S21101 65410020
NOTNOW   EQU   *                                                        65480020
         MVI   LCBERCCW,NOPCI           SET PARAMETER                   65500020
         ST    RF,LCBRCB                SAVE BASE                       65520020
         BAL   RA,FINDBUFF              POST PREVIOUS BUFFERS           65540020
         L     RF,LCBRCB                RESTORE BASE                    65560020
         OI    PRFSTAT1,PRFITCPN .      NOT REAL END OF MSG      X01004 65566005
FSELECT  EQU   *                                                 S22025 65572022
         STCM  RPREFIX,AD,LCBLSPCI .    SET LAST RECEIVED BUFFER Y01948 65580005
         MVI   LCBTPCD+2,TPBUFEOT       SET TP OP CODE                  65640020
         B     RESETEOT                 WRITE EOT                       65680020
NEXTBLK  CLI   LCBCPA+52,0              EXECUTED INSTRUCTION            65700020
CLIUNT   EQU   *                                                        65720020
         CLI   PRFNBUNT,0                                               65740020
         SPACE 10                                                S21101 65750020
DIALTEST EQU   *                                                 S21101 65752020
*                                                                S21101 65754020
*        SUBROUTINE TO DETERMINE IS LINE IS BSC DIAL WITH SEND   S21101 65756020
*        PRIORITY, OR BSC CONTENTION, SEND PRIORITY, AND MASTER@XA08073 65758091
*        =YES SPECIFIED.                                       @XA08073 65758291
*                                                              @XA08073 65758491
         CLI   LCBRSPRI,SENDPRI         SEND PRIORITY          @XA08073 65758891
         BNER  RE                       RETURN IF NO           @XA08073 65759291
         SPACE 1                                               @XA08073 65759491
         OI    SCBBSCFM,SCBNOEOT        SET FLAG FOR SCHEDULER @XA08073 65759891
*                                         AND I/O GEN TO NOT   @XA08073 65759991
*                                         RESET ACK COUNTER    @XA08073 65760291
*                                         AND TO PROCEED WITH  @XA08073 65760591
*                                         SENDING (TENATIVELY) @XA08073 65760891
         SPACE 1                                               @XA08073 65761191
         TM    SCBBSCFM,SCBMLMTN        WAS MSG LIMIT REACHED  @OY13632 65761491
         BO    NOTMSTR                  BRANCH-YES SEND EOT    @OY13632 65763491
         SPACE 1                                               @XA08073 65767091
         BAL   RD,DCTBASE               COMPUTE DCT            @XA08073 65767291
         SPACE 1                                               @XA08073 65767491
         TM    TWO(RA),CCONTENT         CONTENTION             @XA08073 65767691
         BO    4(RE)                    YES, RETURN AT + 4     @XA08073 65767891
         SPACE 1                                               @XA08073 65768691
NOTMSTR  EQU   *                                               @XA08073 65769091
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT FLAG         @XA08073 65769491
         SPACE 1                                               @XA08073 65769891
         BR    RE                       RETURN                 @XA08073 65770291
         EJECT                                                          65773320
.L71     ANOP                                                           65780020
         AIF   ('&GEN' EQ 'BISC').L70                                   65800020
         USING *,RF                                                 TSO 65820020
DYNC     EQU   *                                                    TSO 65840020
         CLI   CCWOPCDE,CCWENAB         THIS ENABEL INTERRUPT       TSO 65860020
         BE    CHGPREP                  YES. CHANGE PREP TO READ    TSO 65880020
         SPACE                                                          65900020
DYN1     EQU   *                                                    TSO 65920020
         TM    LCBSENS0,TIMEOUT+IR      TIME OUT OR INTERV REQ.     TSO 65940020
         BM    S1050                      2703        2702          TSO 65960020
S2741    EQU   *                                                  TSO   65980020
         SPACE                                                          66140020
TSO98    EQU   * .                                                  TSO 66160020
         MVI   LCBTPCD+10,0 .           ZERO SPECIAL FLAG           TSO 66180020
         B     TSO2 .                   PROCESS MESSAGE             TSO 66200020
         SPACE                                                          66220020
S1050    EQU   *                                                    TSO 66240020
         CLI   LCBTPCD+11,X'16'         CIRCLE D RCVD?            TSO   66260020
         BE    S2741                    YES. MUST BE 2741         TSO   66280020
         NI    LCBTSOB,X'FF'-LCB2741N . IS NOT A 2741                   66290020
         NI    LCBSTAT1,X'FF'-LCBCONT   CLR CONTINUE REQ.           TSO 66300020
         ST    R15,LCBERCCW+4    .     SAVE BASE                SA51097 66320022
         L     12,AVTKA02               ADR OF ACTIVATE (IOGEN)     TSO 66340020
         LA    RAVT,AVTSAVE2            AVT BASE FOR KA             TSO 66360020
         BALR  5,12                                                 TSO 66380020
         L     R15,LCBERCCW+4  .       RESTORE BASE             SA51097 66400022
         LA    RBASE,4095(,R15)                                   TSO   66420020
         LA    RBASE,1(,RBASE)                                    TSO   66440020
         SH    RAVT,AVTBACK             RESET AVT BASE              TSO 66460020
         MVC   LCBCPA+48(4),LCBCPA+56   OVERLAY W/WRT PADS          TSO 66480020
         LA    RC,LCBCPA+16             ADR FOR 1050 START I/O      TSO 66500020
         ST    RC,LCBCPA+56             BUILD TIC TO IT             TSO 66520020
         MVI   LCBCPA+56,CCWTIC         SET TIC                     TSO 66540020
         LA    RC,LCBCPA+48             NEW SIO ADR                 TSO 66560020
NEWSTART EQU   *                                                    TSO 66580020
         MVI   LCBTPCD+10,0             CLEAR CHECK INDICATOR       TSO 66600020
         ST    RC,LCBSTART-1                                        TSO 66620020
         B     RESTART                                              TSO 66640020
         SPACE                                                          66660020
CHGPREP  EQU   *                                                    TSO 66680020
         OI    LCBTSTSW,X'80'           SET 'CONNECTED' BIT         TSO 66700020
         OI    LCBTSOB,LCB2741N .       ASSUME 2741                 TSO 66710020
         LA    RC,LCBTPCD+11            ADDR FOR READ               TSO 66720020
         ST    RC,LCBCPA+40             CHANGE IT                   TSO 66740020
         MVI   LCBCPA+40,CCWREAD        SET CCW = READ              TSO 66760020
         MVI   LCBCPA+44,X'80' .        DATA CHAIN READ             TSO 66780020
         L     RC,LCBCPA+48             SAVE WRT PADS CMD           TSO 66800020
         MVC   LCBCPA+48(4),LCBCPA+56   MOVE IN 'TIC BFR'           TSO 66820020
         ST    RC,LCBCPA+56             SAVE WRT PADS                   66840020
         LA    RCCW,LCBCPA+40           NEW SIO ADDR                TSO 66860020
         ST    RCCW,LCBSTART-1                                      TSO 66880020
         B     RESTART                                              TSO 66900020
         EJECT                                                          66920020
.C       ANOP                                                    S22025 66930022
TSOCHK   EQU   *                                                        66940020
RWORK    EQU   RB                                                   TSO 66960020
         SPACE                                                          66980020
         USING *,RA                                                     67000020
         TM    LCBSENS0,X'40'           INTERVENTION REQUIRED?      TSO 67080020
         BZ    ERP                      NO..ERP CAN HANDLE          TSO 67100020
         AIF   ('&GEN' EQ 'QTAM').C1                             S22025 67110022
         LA    RF,OPCHK1                                                67120020
         LA    RPREFIX,LCBERB .         SET TO POST ERB TO AYF     TSO  67140020
.C1      ANOP                                                    S22025 67150022
         TM    LCBSTAT2,LCBMSGNN                                    TSO 67160020
         BNO   CKTXT .                  BRANCH IF NOT A MSGGEN   S22025 67180022
         AIF   ('&GEN' NE 'QTAM').C2 .                           S22025 67180422
         B     ERP .                    GO TO ERP                S22025 67180822
         AIF   ('&GEN' EQ 'QTAM').CC .                           S22025 67181222
.C2      ANOP .                                                  S22025 67181622
         TM    LCBTSOB,LCBTSBUF .       IS THIS A TSO LINE ?     S22025 67182022
         BNO   ERP .                    NOT TSO-TCAM TREATS AS   S22025 67184022
*                                            ERROR               S22025 67186022
         B     CKATN .                  TSO-CHECK ATTN STATUS    S22025 67190022
.CC      ANOP                                                           67192022
CKTXT    LA    RCCW,0(,RCCW) .          GET ADDRESS OF END CCW   S22025 67200022
         LA    RWORK,LCBCPA             START OF CH PGM AREA            67220020
         SR    RWORK,RCCW                                               67240020
         BP    ITEXT                                                    67260020
         SR    RB,RB .                  CLEAR                       TSO 67280020
         L     RC,LCBDCBPT .            DCB ADDRESS                 TSO 67300020
         USING IHADCB,RC  .                                         TSO 67320020
         IC    RB,DCBEIOBX .            LCB SIZE                    TSO 67340020
         DROP  RC  .                                                TSO 67360020
         LA    RB,0(RLCB,RB) .          LCB ADDRESS                 TSO 67380020
         SR    RB,RCCW .                IN CHANNEL PROGRAM AREA     TSO 67400020
         BNP   ITEXT .                  NOT IN CHANNEL PROGRAM   S22025 67420022
         AIF   ('&GEN' NE 'QTAM').C9 .                           S22025 67420422
         B     ERP .                    SCHEDULE ERP             S22025 67420822
         AIF   ('&GEN' EQ 'QTAM').C4 .                           S22025 67421222
.C9      ANOP .                                                  S22025 67421622
         TM    LCBTSOB,LCBTSBUF .       IS THIS A TSO LINE ?     S22025 67422022
         BNO   ERP .                    NOT TSO - TCAM TREATS AS S22025 67424022
*                                            ERROR               S22025 67426022
         BO    TWXCHK1 .                CHECK FOR POSSIBLE TWX   S22025 67430022
*                                       ATTENTION ON READ TSO    S22025 67432022
.C3      ANOP                                                    S22025 67434022
ITEXT    EQU   *                                                        67440020
         TM    LCBTSOB,LCBTSBUF .       IS THIS A TSO LINE ?     S22025 67445022
         BNO   TCAMATN .                BRANCH = NO              S22025 67450022
         AIF   ('&GEN' EQ 'QTAM').C4                             S22025 67455022
         TM    LCBSTAT1,LCBRECVN .      ARE WE IN RECEIVE MODE      TSO 67460020
         BO    TWXCHK2 .          BR ON YES TO CHECK FOR TWX        TSO 67480020
ITEXT1   EQU   *                                                        67500020
         L     RPREFIX,LCBLSPCI-1 .     POST BUFFER TO AYF         TSO  67520020
         MVC   PRFSHDR-IEDQPRF(8,RPREFIX),0(RPREFIX) SAVE COMMANDS22029 67540022
CKATN    EQU   *                                                        67560020
         L     RB,AVTTSOPT .            ADDRESS OF TSO WORK AREA   TSO  67580020
         L     RF,TSIHALT-IEDQTSI(RB) . ADDRESS OF AYF             TSO  67600020
         B     TSOCOM .                 USE COMMON CODE             TSO 67620020
.C4      ANOP                                                    S22025 67621022
         AIF   ('&GEN' NE 'QTAM').C5 .                           S22025 67621222
ITEXT    EQU   * .                                               S22025 67621422
.C5      ANOP .                                                  S22025 67621622
TCAMATN  EQU   * .                                               S22025 67622022
         SPACE 1                                                        67622222
         TM    LCBSTAT1,LCBRECVN .      LINE RECEIVING ?         S22025 67622422
         BO    ERP .                    BRANCH IF YES            S22025 67622622
         BAL   RD,DCTBASE .             GO FIND DCT              S22025 67623022
         USING *,RD .                     ADDRESSABILITY         S22025 67624022
         TM    1(RA),ATTN .             IS ATTENTION ALLOWED?    S22025 67625022
         BZ    ERP .                    BRACNH = NO              S22025 67627022
         LR    RPREFIX,RLCB .           SET TO POST LCB TO       S22025 67628022
*                                            STOPLINE            S22025 67629022
         MVI   PRFPRI,PRILCBAT .        SET PRIORITY             S22025 67630022
         L     RF,AVTHK .               GET ROUTINE'S ADDRESS    S22025 67631022
         AIF   ('&GEN' EQ 'QTAM').C6                             S22025 67632022
         B     TSOCOM1                                           S22025 67633022
         DROP  RD                                                S22025 67633522
         USING TSOCHK,RA                                                67634022
*                                                                       67640020
TWXCHK1  EQU   *                                                        67660020
*                                                                       67680020
         CLI   0(RCCW),X'0A' .  IS THE INT. CCW AN INH. READ        TSO 67700020
         BNE   ERP .              BR IF NO, TREAT AS ERROR          TSO 67720020
         LA    RC,LCBCPA+24 .   GET ADDR OF READ RESP. CCW          TSO 67740020
         CR    RC,RCCW .        WAS INT ON READ RESP.               TSO 67760020
         BE    ITEXT .                  BR YES FOR TWX ATTN ON READ TSO 67780020
         B     CHK10501 NO, CHECK FOR 1050                         TSO  67800020
*                                                                       67820020
TWXCHK2  EQU   *                                                        67840020
         L     RC,AVTSAVEX+UCBOFFST     UCB ADDRESS            @ZO2X6I0 67860061
         CLI   16(RC),X'51' .           CHK UCB MODEL CODE FOR TWX  TSO 67880020
         BNE   CHK10502 BR IF NOT, CHECK 1050                      TSO  67900020
         TM    19(RC),X'50' .CHECK UCB UNIT TYPE FOR TEL. ADPT./2   TSO 67920020
         BNO   CHK10502 BR IF NO, CHECK 1050                       TSO  67940020
         TM    19(RC),X'A0' IS IT ANYTHING BUT TEL.ADPT.-2          TSO 67960020
         BC    5,CHK10502 BR IF YES  CHECK 1050                    TSO  67980020
         B     ITEXT1 .     WE HAVE TWX ATTN ON READ TEXT           TSO 68000020
*                                                                       68020020
CHK10501 EQU   *                                                        68040020
         LA    RC,LCBCPA+32 GET ADDR OF POSSIBLE 1050 RD. RESP. CCW TSO 68060020
         CR    RCCW,RC WAS INT. ON RD. RESP.                        TSO 68080020
         BE    ITEXT YES,ATTN ON NULL LINE,TREAT AS TEXT            TSO 68100020
         B     ERP NO, ATTN ON READ RESP, TREAT AS ERROR            TSO 68120020
CHK10502 EQU   *                                                        68140020
         TM    19(RC),X'10' IS IT TERMINAL ADPTER-TYPE 1            TSO 68160020
         BZ    ERP  BR IF NO                                        TSO 68180020
         TM    19(RC),X'E0' IS IT ANYTHING BUT TERM. ADPT.-TYPE 1   TSO 68200020
         BC    5,ERP BR IF YES                                      TSO 68220020
         TM    LCBTSOB,LCB2741N IS IT 2741                          TSO 68240020
         BZ    ITEXT1 BR IF NO, MUST BE 1050,TREAT AS ATTN ON RD TEXT   68260020
         B     ERP GO TO ERP FOR 2741                               TSO 68280020
LCBTOATN EQU   *                                                    TSO 68300020
         OI    SCBERR3,SCBATTN                                      TSO 68320020
         MVI   LCBPRI,PRILNCL                                       TSO 68340020
         LR    RPREFIX,RLCB                                         TSO 68360020
         L     RF,AVTTSOPT .           GET ADDRESS OF TSINPUT QCBS22029 68380022
         LA    RF,0(RF)                 CLEAR HIGH ORDER BYTE  @OX14796 68383091
         LTR   RF,RF                    CHECK FOR NO TSO       @OX14796 68386091
         BZ    REMO                     BRANCH IF NO TSO       @OX14796 68389091
         TM    LCBTSOB,LCBTSBUF         TSO CHECK              @OX14796 68392091
         BZ    REMO                     BRANCH NO TSO          @OX14796 68395091
         L     RF,TSIATTEN-IEDQTSI(,RF) GET ADDRESS OF ATTENTION S22029 68400022
TSOCOM   EQU   * .                                                  TSO 68480020
         MVI   PRFPRI,PRIRCQCB .        SET PRIORITY                    68500020
.C6      ANOP                                                    S22025 68510022
TSOCOM1  LA    RC,FREERQE .                                      S22025 68520022
         B     ENQUEUE .                PLACE ELEMENT ON READY Q    TSO 68540020
OPCHK1   EQU   *                                                        68560020
         USING *,RF                                                     68580020
         MVI   LCBTPCD+11,0 .           CLEAR OPEN CHECK FLAG       TSO 68600020
         AIF   ('&GEN' EQ 'QTAM').C7   .                         S22025 68605022
         SPACE 1                                                SA62379 68610054
        TM    LCBSTAT2,LCBMSGNN .      MESSAGE GEN                 TSO  68620020
         BZ    NOATN .                  BRANCH NO                  TSO  68640020
         TM    LCBCSW+4,X2F   .         ERROR STATUS               TSO  68660020
         BNZ   ERBPOST .                BRANCH YES                 TSO  68680020
         TM    LCBSENS0,IR+TIMEOUT .    HAS USER HUNG UP           TSO  68700020
        BNZ   HANG .                   BRANCH YES                       68720020
         L     RA,TSOCHKAD .            SET BASE                        68740020
         USING TSOCHK,RA                                                68760020
         B     LCBTOATN .               POST LCB TO ATTENTION       TSO 68780020
         DROP  RA                                                       68800020
NOATN    EQU   *                                                        68820020
         TM    LCBCSW+4,X2F             SERIOUS ERRORS              TSO 68840020
         BNZ   HANG                     GO TO HANG-UP                   68860020
         TM    LCBSENS0,IR+TIMEOUT      HUNG UP                         68880020
         BNZ   HANG                     GO                              68900020
         SPACE                                                          68920020
         TM    LCBTSOB,LCBPREP                                          68940020
         BO    RTPREP                                                   68960020
         OI    SCBERR3,SCBATTN          SET ATTENTION BIT           TSO 68980020
         OI    LCBCHAIN,LCBNORTY        DO NOT RETRY           @OX12511 68981091
         B     RESETSO .                                         S22025 68982022
.C7      ANOP                                                    S22025 68984022
TCAMATN1 TM    LCBSENS0,IR+TIMEOUT .    HAS STATION HUNG UP ?    S22025 68986022
         BZ    BITON                    BRANCH IF NO             S22025 68988022
         MVI   LCBECBCC,X7F             RESET ECB COMPLETION CD  S22025 68988222
         MVC   LCBCSW(7),LCBCSWSV       RESTORE CSW SAVED IN     S22025 68988422
*                                       STOPLINE                 S22025 68988622
         XC    LCBCSWSV(7),LCBCSWSV     CLEAR FIELD              S22025 68988822
         B     ERP                      HANDLE INTERVENTION REQ  S22025 68989022
BITON    EQU   *                                                 S22025 68989222
         OI    SCBERR3,SCBATTN .        NO, SET ATTENTION BIT    S22025 68990022
         MVI   LCBCHAIN,LCBNORTY                                 S22025 68992022
         SPACE                                                          69000020
RESETSO  EQU   *                                                        69020020
         MVI   LCBTPCD+11,0             CLR OPEN LINE CHK INDIC     TSO 69040020
         MVC   LCBCSW(7),LCBCSWSV                                       69060020
         AIF   ('&GEN' EQ 'QTAM').C8 .                           S22025 69070022
         XC    LCBCSWSV(7),LCBCSWSV     CLEAR                           69080020
         NC    LCBLSPCI(2),LCBLSPCI .   MAKE SURE                   TSO 69100020
         BZ    CTLNOBUF                                                 69120020
.C8      ANOP .                                                  S22025 69130022
         MVI   LCBECBCC,PERMERR .       SET PERMANENT ERROR             69140020
         B     TSO2 .                   POST BUFFER TO MH               69160020
         AIF   ('&GEN' EQ 'QTAM').L70                            S22025 69170022
CTLNOBUF EQU   *                                                        69180020
         TM    LCBSTAT2,LCBMSGNN        WAS IT MSGGE?"                  69200020
         BO    ERBPOST                                                  69220020
         L     RA,TSOCHKAD .            ESTABLISH ADDRESSABILITY S22026 69226022
         USING TSOCHK,RA .                                       S22026 69232022
         B     LCBTOATN .               POST LCB TO ATTN            TSO 69240020
         DROP  RA .                                              S22026 69250022
*  ASSUME USER HAS HUNG UP (DISCONNTCTED)                               69260020
HANG     EQU   *                                                        69280020
         L     RSCB,LCBSCBA-1                                           69300020
         OI    SCBERR3,SCBTMINN         SET PERMANENT ERROR    @OZ30260 69310082
         TM    LCBSTAT2,LCBMSGNN .      MESSAGE GEN                 TSO 69320020
         BO    NOBUF .                   BRANCH YES                 TSO 69340020
         SPACE                                                          69360020
         NC    LCBLSPCI(2),LCBLSPCI .   ANY BUFFERS ASSIGNED            69380020
         BNZ   TSTXTER                                                  69400020
         SPACE                                                          69420020
NOBUF    EQU   *                                                        69440020
*  NO BUFFERS TO PASS SO POST LCB TO HANGUP                             69460020
         L     RWORK,AVTTSOPT                                           69480020
         LA    RWORK,0(RWORK)           CLEAR HIGH ORDER BYTE  @OX14796 69483091
         LTR   RWORK,RWORK              CHECK FOR NO TSO       @OX14796 69486091
         BZ    REMO                     BRANCH IF NO TSO       @OX14796 69489091
         TM    LCBTSOB,LCBTSBUF         TSO CHECK              @OX14796 69492091
         BZ    REMO                     BRANCH NO TSO          @OX14796 69495091
         USING IEDQTSI,RWORK                                            69500020
         L     RF,TSIHANG .             ADDRESS OF HANGUP ROUTINE   TSO 69520020
         DROP  RWORK                                                    69540020
         LR    RPREFIX,RLCB             ELEMENT TO PASS                 69560020
         BAL   RC,ENQUEUE                                               69580020
         B     FREERQE                                                  69600020
         SPACE                                                          69620020
TSTXTER  EQU   *                                                        69640020
         TM    LCBSTAT1,LCBSENDN        SENDING                         69660020
         BO    RESETSO .                                            TSO 69680020
*  RECEIVING. MAKE PERM ERROR ON FIRST BUFFER                           69700020
TSTXTRCV EQU   *                                                        69720020
         L     RCCW,LCBLSPCI-1                                          69740020
         LH    RPREFIX,6(,RCCW)         ORIG COUNT                      69760020
         STH   RPREFIX,LCBCSW+5                                         69780020
         MVI   LCBECBCC,X'41'                                           69800020
         LA    RCCW,8(,RCCW)                                            69840020
         STCM  RCCW,AD,LCBCSW .         SET CSW = ADDRESS OF 1ST Y01948 69860005
*                                       BUFFER + 8.              Y01948 69880005
         XC    LCBCSWSV(7),LCBCSWSV                                     69900020
         MVI   LCBTPCD+11,0                                             69920020
         B     TSO2                                                     69940020
*  SEND MODE. TREAT AS FOR OUTPUT ATTN EXCEPT ATTN BIT NOT SET          69960020
         EJECT                                                          69980020
.L70     ANOP                                                           70000022
         AIF   ('&GEN' EQ 'MINI').LL4A                                  70000522
SOURCER  EQU   *                                                 S99228 70001022
         AIF   ('&GEN' EQ 'QTAM').LL4F                          SA65397 70001552
* THIS SUBROUTINE CALCULATES TRANSMISSION SOURCES OF MESSAGES    S99228 70002022
* RECEIVED UNDER GENERAL POLL                                    S99228 70003022
         USING *,RF                                              S99228 70004022
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 70005022
         USING IHADCB,RA                                         S99228 70006022
         L     RA,LCBDCBPT              LOAD INVLIST POINTER     S99228 70007022
         IC    RB,LCBUCBX               LOAD INVLIST INDEX       S99228 70008022
         SLL   RB,TWO                   MULTIPLY POINTER BY 4    S99228 70009022
         L     RC,DCBINVLI(RB)          LOAD ADDR INVLIST C WORD S99228 70010022
         LR    RPREFIX,RWKA             LOAD BUFFER ADDRESS      S99228 70012022
         SR    RB,RB                    CLEAR IDLES REGISTER     S99228 70013022
         IC    RB,LCBISZE               INSERT IDLES COUNT       S99228 70013722
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 70013822
         BO    LCPRES                   BRANCH YES               S99228 70013922
         BCTR  RB,R0                    SET TO POINT AT LC CHAR  S99228 70014022
LCPRES   EQU   *                                                 S99228 70014122
         LA    RE,PRFSHDR(RB)           LOAD DATA ADDRESS        S99228 70014422
         AIF   ('&GEN' EQ 'STSP').LL4C                           S99228 70015122
         TM    LCBSTAT2,LCBSYNC         BISYNC LINE?             S99228 70016022
         BZ    REGMSG                   NO, SKIP SOH%R SEARCH    S99228 70017022
         L     RB,DCBSCTAD-ONE          LOAD ADDR SPEC CHARS TBL S99228 70018022
         DROP  RA                                                S99228 70019022
         SR    RA,RA                    CLEAR OFFSET REGISTER    S99228 70020022
         IC    RA,RSOHCH(R0,RB)         INSERT SOH%R OFFSET      S99228 70021022
         LA    RB,ONE(RA,RB)            LOAD ADDR SOH%R CHARS    S99228 70022022
         CLC   ZERO(ONE,RB),ZERO(RE)    SOH%R MESSAGE?           S99228 70023022
         BNE   USUMSG                   BRANCH NO                S99228 70024022
         LA    RE,THREE(R0,RE)          BYPASS SOH%R STX CHARS   S99228 70025022
USUMSG   EQU   *                                                 S99228 70026022
         LA    RE,ONE(R0,RE)            POINT TO CU ENTRY        S99228 70027022
REGMSG   EQU   *                                                 S99228 70028022
.LL4C    ANOP                                                    S99228 70028522
         LR    R0,RC                    SAVE INVLIST C WORD ADDR S99228 70029022
         SR    RA,RA                    CLEAR ENTRY COUNT REG    S99228 70029522
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 70030022
         IC    RB,TWO(R0,RC)            LOAD INVLIST ENTRY LENGT S99228 70031022
         IC    RA,ONE(R0,RC)            SET ACTIVE INVLIST E CNT S99228 70032022
         LA    RC,EIGHT(R0,RC)          SET INVLIST START ADDR   S99228 70033022
         LA    RPREFIX,TWO              SET ACTIVE-INACTIVE CON  S99228 70034022
SYNCTEST EQU   *                                                SA65428 70034505
         LTR   RA,RA                    TEST NUMBER ACTIVE ENT   S99228 70035022
         BZ    NOORG                    NO ACTIVE ENTRIES NO SRC S99228 70036022
         AIF   ('&GEN' EQ 'STSP').LL4D                           S99228 70037522
         TM    LCBSTAT2,LCBSYNC         TEST FOR BSYNC LINE      S99228 70038022
         BZ    SLOLINE                  NO, NO SKIP OF 1ST CU    S99228 70039022
         LA    RC,ONE(R0,RC)            ADJ PTR TO COMPARE 2ND C S99228 70040022
SLOLINE  EQU   *                                                 S99228 70041022
.LL4D    ANOP                                                    S99228 70041522
         L     RWKA,LCBINVPT-ONE        LOAD INVLIST POINTER     S99228 70042022
CONCHECK EQU   *                                                 S99228 70043022
         CLC   ZERO(ONE,RWKA),ZERO(RC)  COMPARE CONTROL UNIT ADD S99228 70044022
         BE    DVCCHECK                 CU ADDRS EQUAL CHECK DVC S99228 70045022
CONTEST  EQU   *                                                 S99228 70046022
         AR    RC,RB                    SKIP TO NEXT INVLIST ENT S99228 70047022
         BCT   RA,CONCHECK              CONTINUE SEARCHING       S99228 70048022
         BCT   RPREFIX,FEINCRE          PROCESS INACTIVE ENTRIES S99228 70049022
         B     NOORG                    NO SRC FOUND SET NO SRC  S99228 70050022
DVCCHECK EQU   *                                                 S99228 70051022
         CLC   ONE(ONE,RC),ONE(RE)      COMPARE DEVICE ADDR      S99228 70052022
         BNE   CONTEST                  BRANCH DEVICE NOT FOUND  S99228 70053022
         STM   RPREFIX,RC,SRCREGS       SAVE REGISTERS           S99228 70053122
         LR    RA,R0                    LOAD INVLIST CWORD ADDR  S99228 70053222
         TM    LCBSTAT2,LCBSYNC         BYSNC INVLIST?           S99228 70053322
         BZ    RUNLOW                   BRANCH NO                S99228 70053422
         BCTR  RB,R0                    REDUCE ENTRY LENGTH      S99228 70053522
RUNLOW   EQU   *                                                 S99228 70053622
         BCTR  RB,R0                    REDUCE ENTRY SIZE        S99228 70053722
         IC    RB,ZERO(RB,RC)           INSERT ENTRY INDEX       S99228 70053822
         SLL   RB,ONE                   DOUBLE INDEX VALUE       S99228 70053922
         SR    RA,RB                    POINT TO TNT INDEX       S99228 70054022
         LH    RC,ZERO(R0,RA)           LOAD TNT INDEX           S99228 70054122
         BAL   RWKA,BOLOC               BRANCH TO DCT ENTRY LOC  S99228 70054222
         TM    ONE(RA),C3270            3270 DEVICE?             S99228 70054322
         BO    RELOAD                   BRANCH YES               S99228 70054422
         TM    THREE(RA),CNOIDLES       2260 DEVICE?             S99228 70054522
RELOAD   EQU   *                                                 S99228 70054622
         LM    RPREFIX,RC,SRCREGS       RESTORE REGISTERS        S99228 70054722
         BO    SETORG                   BRANCH IF GENPOLL DEVICE S99228 70054822
         B     CONTEST                  NOT GENPOLL DEVICE       S99228 70054922
FEINCRE  EQU   *                                                 S99228 70055022
         LA    RC,ONE(R0,RC)            ADJ PTR ADDR TO PASS FE  S99228 70056022
         LR    RWKA,R0                  RESTORE CONTROL WORD ADD S99228 70057022
         IC    RA,ZERO(R0,RWKA)         LOAD TOTAL ENTRIES       S99228 70058022
         SR    RB,RB                    CLEAR ACTIVE ENTRIES REG S99228 70059022
         IC    RB,ONE(R0,RWKA)          LOAD ACTIVE ENTIRES      S99228 70060022
         SR    RA,RB                    DERIVE INACTIVE ENTRIES  S99228 70061022
         IC    RB,TWO(R0,RWKA)          RESTORE LENGTH           S99228 70062022
         B     SYNCTEST                 CONT SRCH INACT ENTRIES  S99228 70063022
SETORG   EQU   *                                                 S99228 70064022
         AIF   ('&GEN' EQ 'STSP').LL4E                           S99228 70064522
         TM    LCBSTAT2,LCBSYNC         BYSNC INVLIST?           S99228 70065022
         BZ    UNSYNC                   NO, NO RETARD INV PTR    S99228 70066022
         BCTR  RC,R0                    RETARD INV PTR TO CU ADD S99228 70067022
UNSYNC   EQU   *                                                 S99228 70068022
.LL4E    ANOP                                                    S99228 70068522
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 70069022
         ST    RC,LCBXRADR              SAVE ERP POLL ADDR       S99228 70071022
*                                       FOR ERP POLL             S99228 70073022
         BCTR  RC,R0                    RETARD INVLIST ENTRY PTR S99228 70074022
         AR    RC,RB                    PT TO INVLIST ENT INDEX  S99228 70075022
         SR    RWKA,RWKA                CLEAR WORK REGISTER      S99228 70076022
         IC    RWKA,ZERO(R0,RC)         LOAD INDEX VALUE         S99228 70077022
         SLL   RWKA,ONE                 DOUBLE INDEX VALUE       S99228 70078022
         LR    RC,R0                    RSTR INVLIST C WORD ADDR S99228 70079022
         SR    RC,RWKA                  POINT TO TNT INDEX       S99228 70080022
         LH    RWKA,ZERO(R0,RC)         LOAD TNT INDEX VALUE     S99228 70081022
         STH   RWKA,LCBTTCIN            SET SOURCE OF TRANS      S99228 70086022
         BR    RD                       RETURN TO CALLER         S99228 70087022
NOORG    EQU   *                                                 S99228 70088022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR SA66946 70088505
         NI    LCBXFLAG,LCBERSTP        PREVENT ERP POLL         S99228 70089022
         XC    LCBTTCIN(TWO),LCBTTCIN   INVALID SOURCE CLEAR SRC S99228 70090022
.LL4F    ANOP                                                   SA65397 70090552
         BR    RD                       RETURN TO CALLER         S99228 70091022
         SPACE 2                                                        70091222
SRCREGS  DS    4F                       SAVE AREA FOR SOURCE     S99228 70091422
*                                       DETERMINATION REGISTERS  S99228 70091622
         EJECT                                                   S99228 70095022
LOOKER   EQU   *                                                 S99228 70096022
* THIS SUBROUTINE LOCATES THE INVITATION LIST AND DEVICE         S99228 70097022
* CHARACTERISTICS TABLE ENTRY FOR 2260  AND 3270 DEVICES         S99228 70098022
         USING *,RF                                              S99228 70099022
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 70100022
         USING IHADCB,RA                                         S99228 70101022
         L     RA,LCBDCBPT              LOAD DCB POINTER         S99228 70102022
         IC    RB,LCBUCBX               LOAD INVLIST INDEX       S99228 70103022
         SLL   RB,TWO                   MULTIPLY INDEX BY 4      S99228 70104022
         L     RC,DCBINVLI(RB)          LOAD ADDR INVLIST CWORD  S99228 70105022
         LR    R0,RC                    SAVE ADDR INVLIST CWORD  S99228 70105122
         SR    RB,RB                    CLEAR LENGTH REGISTER    S99228 70105222
         IC    RB,DCBEIOBX              INSERT LCB LENGTH        S99228 70105322
         SH    RB,H8S                   BACK UP LCB BY 8         Y01948 70105405
         LA    RE,ZERO(RB,RLCB)         LOAD LCB EXTENSION ADDR  S99228 70105622
         STCM  RE,AD,AVTDOUBX+ONE      SAVE LCB EXTN ADDR        Y01948 70105705
         ST    R0,AVTDOUBX+FOUR         SAVE CWORD ADDR         OX03941 70105854
         DROP  RA                                                S99228 70106022
         LH    RC,LCBTTCIN .            LOAD TERM INDEX          S99228 70106622
         N     RC,AVTCLRHI .            CLEAR HI-ORDER HALF      S99228 70107222
         TM    LCBSTAT1,LCBSENDN        SEND STATE?              S99228 70108022
         BO    OUTBY                    YES, USE LCBTTCIN        S99228 70109022
         TM    LCBXFLAG,LCBSRCPF        SRC DETERM PERFORMED?    S99228 70110022
         BO    USEPTR                   YES, USE INVLIST PTR     S99228 70111022
         LTR   RC,RC .                  TTCIN ZERO               S99228 70112022
         BNZ   OUTBY                    NO, LCBTTCIN VALID       S99228 70114022
USEPTR   EQU   *                                                 S99228 70115022
         LR    RC,R0                    RESTORE REG              S99228 70115522
         L     RA,LCBINVPT-ONE          LOAD INVLIST ENTRY PTR   S99228 70116022
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 70117022
         IC    RB,TWO(R0,RC)            LOAD INVLIST ENTRY LENGTHS99228 70118022
         AR    RA,RB                    SKIP TO END INVLIST ENT  S99228 70119022
         BCTR  RA,R0                    POINT TO ENTRY INDEX     S99228 70120022
         IC    RB,ZERO(R0,RA)           LOAD ENTRY INDEX VALUE   S99228 70121022
         SLL   RB,ONE                   DOUBLE INDEX VALUE       S99228 70122022
         SR    RC,RB                    POINT TO TNT INDEX       S99228 70124022
         LH    RC,ZERO(R0,RC)           LOAD TNT INDEX           S99228 70125022
OUTBY    EQU   *                                                 S99228 70126022
         BAL   RWKA,BOLOC               BRANCH TO DCT ENTRY LOC  S99228 70127022
         MVC   LCBXDCT(THREE),ONE(RA)   SAVE DCT BYTES 1, 2, 3   S99228 70138022
         LR    RE,R0                    LOAD INVLIST CWORD ADDR  S99228 70138522
         BR    RD                       RETURN                   S99228 70139022
         EJECT                                                          70139122
BOLOC    EQU   *                                                 S99228 70139222
* THIS SUBROUTINE LOCATES DEVICE CHARACTERISTICS TABLE ENTRIES   S99228 70139322
         N     RC,AVTCLRHI              CLEAR HI ORDER BYTES     S99228 70139422
         L     RA,AVTRNMPT              LOAD ADDR TERMNAME TABLE S99228 70139522
         USING IEDQTNTD,RA                                       S99228 70139622
         BAL   RPREFIX,TNTDCODE         BRANCH TO TRM ENT LOC RT S99228 70139722
         USING IEDQTRM,RB                                        S99228 70139822
         DROP  RA                                                S99228 70140022
         SR    RA,RA                    CLEAR INDEX REGISTER     S99228 70140122
         IC    RA,TRMCHCIN              LOAD DCT INDEX           S99228 70140222
         BCTR  RA,R0                    DECREMENT FOR ENTRY      S99228 70140322
         MH    RA,AVTDCTLN              LENGTH OF DCT ENTRY    @G36XRIV 70140400
         DROP  RB                                                S99228 70140522
         A     RA,AVTCSTCS              SET ADDR DCT ENTRY       S99228 70140622
         BR    RWKA                     RETURN TO CALLER         S99228 70140722
         AIF   ('&GEN' EQ 'STSP').LL4A                           S99228 70140822
         EJECT                                                          70140922
FINDER   EQU   *                                                 S99228 70141022
* THIS ROUTINE CALCULATES INVITATION LIST ENTRY ADDRESSES        S99228 70142022
* ON 3270 DEVICE DEPENDENT OUTPUT ERRORS                         S99228 70143022
         USING *,RF                                              S99228 70144022
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 70145022
         L     RE,AVTDOUBX+FOUR         LOAD INVLIST CWORD ADDR  S99228 70146022
         SR    RC,RC                    CLEAR WORK REGISTER      S99228 70152022
         IC    RC,ZERO(R0,RE)           INSERT INVLIST TOTAL ENT S99228 70153022
         LA    RC,ONE(R0,RC)            INCRE TOTAL BY 1 FOR LOO S99228 70154022
         SLL   RC,ONE                   MULT BY 2 FOR ADDR RETAR S99228 70155022
         LR    RB,RE                    SAVE INVLIST CWORD ADDR  S99228 70156022
         SR    RB,RC                    RETARD ADDR TO 1ST INDEX S99228 70157022
         SRL   RC,ONE                   RETURN TO TOTAL ENTRIES  S99228 70158022
LOOPER   EQU   *                                                 S99228 70159022
         BCT   RC,LOCENTRY              NO INDEX FOUND EXIT      S99228 70160022
         BR    RD                       RETURN                   S99228 70161022
LOCENTRY EQU   *                                                 S99228 70162022
         LA    RB,TWO(R0,RB)            ADJUST TO 1ST INDEX      S99228 70163022
         CLC   ZERO(TWO,RB),LCBTTCIN    INDEX =CUR CON INDEX?    S99228 70164022
         BNE   LOOPER                   NO, CHECK NEXT INDEX     S99228 70165022
         LR    RB,RC                    SAVE TNT INDEX INDEX     S99228 70166022
         SR    RC,RC                    CLEAR WORK REGISTER      S99228 70167022
         IC    RC,ONE(R0,RE)            INSERT ACTIVE ENTRIES    S99228 70168022
         SR    RA,RA                    CLEAR WORK REGISTER      S99228 70169022
         IC    RA,TWO(R0,RE)            INSERT INVLIST ENTRY LEN S99228 70170022
         BCTR  RA,R0                    SET LENGTH -INDEX        S99228 70171022
         LR    R0,RE                    SAVE INVLIST CWORD ADDR  S99228 70172022
         LA    RE,EIGHT(R0,RE)          SKIP TO 1ST ENTRY        S99228 70173022
         SR    RWKA,RWKA                CLEAR WORD REGISTER      S99228 70174022
         LTR   RC,RC .                  ANY ACTIVE ENTRIES      SA65374 70174352
         BZ    ROUNDER1 .               BRANCH IF YES           SA65374 70174652
ROUNDER  EQU   *                                                 S99228 70175022
         IC    RWKA,ZERO(RA,RE)         INSERT ENTRY INDEX       S99228 70176022
         CR    RWKA,RB                  INDEX = DEVELOPED INDEX? S99228 70177022
         BE    SETENTRY                 YES, INV CHARS LOCATED   S99228 70178022
         LA    RE,ONE(RA,RE)            SKIP TO NEXT ENTRY       S99228 70179022
         BCT   RC,ROUNDER               CHECK ENTRY INDEX        S99228 70180022
ROUNDER1 EQU   * .                                              SA65374 70180552
         LA    RE,TWO(R0,RE)            SKIP EOT AND FE          S99228 70181022
         LR    RWKA,RE                  SAVE CURRENT ENTRY ADDR  S99228 70182022
         LR    RE,R0                    RELOAD INVLIST CWORD ADD S99228 70183022
         IC    RC,ZERO(R0,RE)           INSERT TOTAL ENTRIES     S99228 70184022
         IC    RA,ONE(R0,RE)            INSERT ACTIVE ENTRIES    S99228 70185022
         SR    RC,RA                    CALC INACTIVE ENTRIES    S99228 70186022
         IC    RA,TWO(R0,RE)            RESTORE ENTRY LENGTH     S99228 70187022
         BCTR  RA,R0                    SET LENGTH - INDEX       S99228 70188022
         LR    RE,RWKA                  RESTORE ENTRY ADDR       S99228 70189022
         SR    RWKA,RWKA                CLEAR WORK REGISTER      S99228 70190022
         B     ROUNDER                  CHECK INACTIVE ENTRIES   S99228 70191022
SETENTRY EQU   *                                                 S99228 70192022
         LR    RC,RE                    SAVE INVLIST CWORD ADDR  S99228 70194022
         L     RE,AVTDOUBX              LOAD LCB EXTENSION ADDR  S99228 70194722
         ST    RC,LCBXRADR              SET ERP POLL ADDR        S99228 70195491
         OI    LCBXFLAG,LCBERPND        SET SOR PENDING          S99228 70195591
         BR    RD                       RETURN                   S99228 70195691
         EJECT                                                          70195791
.LL4A    ANOP                                                           70195891
         AIF   ('&GEN' EQ 'MINI').LL4A1                        @OZ16540 70195991
POLLCK   EQU   *                                                        70196091
         USING *,RF                                            @OZ16540 70196191
         SR    RE,RE                    CLEAR WORK REGISTER    @OZ16540 70196291
         L     RD,LCBCPA+48             LOAD SECOND POLL CCW   @OZ16540 70196391
         LR    RA,RD                    SAVE FIRST ENTRY       @OZ16540 70196491
         SH    RD,H8                    BACK UP TO CWORD       @OZ16540 70196591
         IC    RE,2(,RD)                INSERT ENTRY WIDTH     @OZ16540 70196691
         CLI   0(RCCW),CCWPOLL          INTERRUPT ON POLL      @OZ16540 70196791
         BNE   TMODE                    BRANCH TEXT MODE       @OZ16540 70196891
         LR    RB,RE                    SAVE ENTRY WIDTH       @OZ16540 70196991
         LH    RC,CCWCOUNT              LOAD ORIGINAL COUNT    @OZ16540 70197091
         SH    RC,LCBCSW+5              SUBTRACT RESIDUAL      @OZ16540 70197191
         BNP   ENTRY                    BRANCH FIRST ENTRY     @OZ16540 70197291
         SR    RB,RB                    CLEAR DIVIDE REGISTER  @OZ16540 70197391
         DR    RB,RE                    CALCULATE              @OZ16540 70197491
         MR    RB,RE                    ENTRY INDEX            @OZ16540 70197591
         LTR   RB,RC                    MOVE COUNT             @OZ16540 70197691
         BNZ   ENTRY                    BRANCH VALUE           @OZ16540 70197791
         LR    RB,RE                    USE ENTRY LENGTH       @OZ16540 70197891
ENTRY    EQU   *                                               @OZ16540 70197991
         L     RA,CCWADDR-1             LOAD POLL ADDRESS      @OZ16540 70198091
         LA    RA,0(RB,RA)              POINT TO               @OZ16540 70198191
         BCTR  RA,0                     INDEX BYTE             @OZ16540 70198291
         B     SRCEFIND                 LOCATE TERMINAL        @OZ16540 70198391
TMODE    EQU   *                                               @OZ16540 70198491
         L     RC,LCBCPA+64             LOAD READ RESPONSE     @OZ16540 70198591
         SR    RB,RB                    CLEAR INDEX REGISTER   @OZ16540 70198691
         STH   RB,LCBTTCIN              ZERO CONNECTED INDEX   @OZ16540 70198791
         BCTR  RA,0                     REDUCE FOR LOOP        @OZ16540 70198891
POLLOOP  EQU   *                                               @OZ16540 70198991
         AR    RA,RE                    MOVE TO FIRST INDEX    @OZ16540 70199091
         CLC   0(1,RA),0(RC)            INDEX FOUND            @OZ16540 70199191
         BE    SRCEFIND                 BRANCH YES             @OZ16540 70199291
         CLI   1(RA),FE                 END                    @OZ16540 70199391
         BER   R14                      OF                     @OZ16540 70199491
         CLI   2(RA),FE                 LIST                   @OZ16540 70199591
         BNE   POLLOOP                  BRANCH NO              @OZ16540 70199691
         BR    R14                      YES, EXIT              @OZ16540 70199791
SRCEFIND EQU  *                                                @OZ16540 70199891
         IC    RB,0(,RA)                INSERT INDEX           @OZ16540 70199991
         AR    RB,RB                    LOCATE                 @OZ16540 70200091
         SR    RD,RB                    OFFSET                 @OZ16540 70200191
         LH    RC,0(,RD)                LOAD TNT OFFSET        @OZ16540 70200291
         STH   RC,LCBTTCIN              SET CONNECTED INDEX    @OZ16540 70200391
         L     RA,AVTRNMPT              LOAD ADDRESS TNT CODE  @OZ16540 70200491
         USING IEDQTNTD,RA                                     @OZ16540 70200591
         BAL   RPREFIX,TNTDCODE         LOCATE TERMINAL ENTRY  @OZ16540 70200691
         USING IEDQTRM,RB                                      @OZ16540 70200791
         L     RB,TRMDESTQ-1            LOAD TTE ADDRESS       @OZ16540 70200891
         DROP  RB                                              @OZ16540 70200991
         USING IEDQQCB,RB                                      @OZ16540 70201091
         SR    RA,RA                    CLEAR WORK REGISTER    @OZ16540 70201191
         IC    RA,QCBSCBOF              INSERT SCB INDEX       @OZ16540 70201291
         IC    RE,AVTSCBSZ              AND SCB SIZE           @OZ16540 70201391
         MR    RA-1,RE                  GET SCB OFFSET         @OZ16540 70201491
         AL    RA,LCBSCBDA-1            AND SCB ADDRESS        @OZ16540 70201591
         STCM  RA,7,LCBSCBA             STORE SCB ADDRESS      @OZ16540 70201691
         BR    R14                                             @0Z16540 70201791
         DROP  RA                                              @OZ16540 70201891
         DROP  RB                                              @OZ16540 70201991
.LL4A1   ANOP                                                  @OZ16540 70202091
         EJECT                                                          70202191
*        CONSTANTS                                                      70202291
H8S      DC    H'8'                     CONSTANT OF X'08'        X02004 70202505
ESOHCH   EQU   26 .                                              S22026 70203022
CEPTR    EQU   12                       ADDRESS OF CHANNEL       X02004 70203105
*                                       END APPENDAGE IN DEB     X02004 70203205
*                                       VECTOR TABLE             X02004 70203305
SIOPTR   EQU   4                        ADDRESS OF SIO IN ABOVE  X02004 70203405
INTENTRY EQU   4                        SECOND ENTRY TO IGG019QE X02004 70203505
*                                       FOR ADDRESS TRANSLATION  X02004 70203605
CBRDCAST EQU   X'40' .                                           S22026 70204022
CC1      EQU   X'10'                    SIO COND CODE MASK       Y02027 70204506
CC3      EQU   X'30'                    SIO COND CODE MASK              70205022
PERMERR  EQU   X'41'                    MASK FOR PERM ERROR(BY ERP)     70206022
ZERO     EQU   0                                                        70207022
ONE      EQU   1                                                        70208022
TWO      EQU   2                                                        70209022
THREE    EQU   3                                                        70210022
FE       EQU   X'FE'                    END OF INV LIST                 70211022
FOUR     EQU   4                                                        70212022
FIVE     EQU   5                                                 S99228 70213022
SIX      EQU   6                                                 S99228 70214022
ONESIX   EQU   16                                                S99228 70215022
RSOHCH   EQU   29                       OFFSET SOH%R SEQUENCE    S99228 70215522
EIGHT    EQU   8                                                        70216022
CEDE     EQU   X'0C'                    STATUS=CHAN END, DEVICE END TSO 70220020
UNEX     EQU   X'01'                    UNIT EXCEPTION                  70240020
CSWPC    EQU   X'20'                    CHANNEL PROGRAM CHECK   SA65374 70250005
CVTLOC   EQU   X'10'                    CVT PTR LOCATION                70260020
NAK      EQU   X'80'                    REQUEST FOR NAK.         X01004 70280005
ACKI     EQU   X'40'                    REQUEST FOR ACK-I.       X01004 70300005
EOMSG    EQU   X'80'                    TEMPORARY END OF MSG            70340020
DLEEOTCH EQU   16                       OFFSET TO SEQUENCE              70360020
EOTCH    EQU   0                        OFFSET TO SEQUENCE IN SCT       70460020
STXCH    EQU   1                         OFSET TO SEQUENCE IN SCT       70480020
ACK0CH   EQU   4                        INDEX N TO SCT                  70500020
NAKCH    EQU   6                        INDEX TO SEQUENCE               70520020
TOTESOH  EQU   27                       SOH % / FOR TOTE         S21903 70540022
CSOHCH   EQU   28                       INDEX TO SOH % C         S99238 70550022
ENQCH    EQU   7                        OFFSET TO SEQUENCE IN SCT       70560020
ETBCH    EQU   8                         OFSET TO SEQUENCE IN SCT       70580020
ETXCH    EQU   9                        OFFSET TO DEQUENCE IN SCT       70600020
DLESTXCH EQU   10                       OFFSET TO SEQUENCE IN SCT       70620020
BUFF     EQU   X'1A'                    LCBRSKEY FOR BUFFERED LCB       70660020
STXENQCH EQU   11                       OFFSET TO SEQUENCE IN SCT       70700020
SOHCH    EQU   13                       OFFSET TO SEQUENCE              70740020
WACKCH   EQU   14                       INDEX TO SEQUENCE IN SCT        70760020
RVICH    EQU   15                       INDEX TO SEQUENCE IN SCT        70780020
IN       EQU   X'80'                    MASK FOR LCIN                   70840020
X2F      EQU   X'2F'                   MASK ERRORS PGM CHK+CAT ERRS     70860020
IDRETRY  EQU   6                        RETRY COUNT BSC READ ID         70880020
X20      EQU   X'20'                   BIT-LCBFLAG1-ERP IN CONTROL      70900020
CMDREJ   EQU   X'80'                    COMMAND REJECT IN SENSE         70920020
X24      EQU   X'24'                    MASK FOR ERROR FLAGS            70940020
XF2      EQU   X'F2'                    MASK FOR ERRORS-AATN,STMOD,     70960020
*                                        CTL UNT END,BUSY,UNTCHCK       70980020
CVTOPT01 EQU   X'98'                    OFFSET ADDRESS IN CVT -POST     71000020
COMPLETE EQU   X'40'                    MASK FOR ECB COMPLETE           71020020
ACTIVE   EQU   1                        ILIST OFFSET-#ACTIVE ENTRIES    71040020
LOGICAL  EQU   X'04'                    LOGICAL EXIT AT MH              71060020
CONV     EQU   X'10'                    CONVERSE REQUEST AT MH          71080020
MHBT     EQU   X'08'                    BT PRESENT IN MH QCB     X01004 71081005
LCIN     EQU   X'80' .                  LINE CONTROL IN FLAG     X01004 71082005
CCONTIN  EQU   4 .                      CONTINUE CAPABILITY FLAG X01004 71083005
CBISYNC  EQU   X'80' .                  BISYNC DEVICE FLAG       X01004 71084005
CCHECK   EQU   X'10' .                  CHECKING CAPABILITY FLAG X01004 71085005
CCONTENT EQU   X'04'                    CONTENTION DEVICE      @XA08073 71085391
MASTER   EQU   X'20'                    MASTER/SLAVE STATUS    @XA08073 71085691
SEVEN    EQU   7 .                                               X01004 71086005
NINE     EQU   9 .                                               X01004 71087005
EOL      EQU   X'FE' .                  END OF LIST INDICATOR    X01004 71088005
THIRTN   EQU   13 .                                              X01004 71089005
AD       EQU   7 .                      MASK FOR ICM OF ADDRESS  X01004 71090005
FOUR095  EQU   4095 .                   OFFSET FOR SECOND BASE   X01004 71091005
TWLVE    EQU   12 .                                              X01004 71092005
SIXTN    EQU   16 .                                              X01004 71093005
ALL      EQU   15 .                     MASK TO ICM FOUR BYTES   X01004 71094005
CCZRO    EQU   8                        ZERO CONDITION CODE      X02004 71095005
LISTSIZE EQU   8                        SIZE OF ILIST CONTROL FIELDS    71100020
FF       EQU   X'FF'                    MASK FOR TEST AND SET           71120020
CEDEUC   EQU   X'0E'                    CH END, DEV END, UNIT CHECK     71140020
IOBEXEP  EQU   X'04'                    FLAG TO GET TO ERP              71160020
TIMEOUT  EQU   X'01'                    TIME OUT VALUE IN SENSE         71180020
IR       EQU   X'40'                    INTERVENTION REQ.           TSO 71200020
CIRCC    EQU   X'1F'                                                TSO 71220020
CIRCD    EQU   X'16'                                                TSO 71240020
X80      EQU   X'80'                    MASK FOR TS SWITCH              71280020
X48      EQU   X'48'                   COMP CODE IN ECB FOR HIO         71300020
X01      EQU   X'01'                    TP OP CODE MASK                 71320020
X12      EQU   X'12'                    TP CODE FOR BREAK           TSO 71340020
RACK0    EQU   X'81'                    INDICATOES RESPONSE RCVD        71360020
RACK1    EQU   X'41'                    INDICATOES RESPONSE RCVD        71380020
LMD      EQU   X'03' .                  LMD FLAGS ON STARTMH     S22025 71390022
RWACK    EQU   X'20'                    INDICATOES RESPONSE RCVD        71400020
RTTD     EQU   X'10'                    INDICATOES RESPONSE RCVD        71420020
REOT     EQU   X'08'                    INDICATOES RESPONSE RCVD        71440020
RRVI     EQU   X'04'                    INDICATOES RESPONSE RCVD        71460020
RNAK     EQU   X'02'                    INDIACTES RESPONSE RCVD         71480020
RENQ     EQU   X'0C'                    MASK FOR RESPOSNE RECEIVED      71500020
XF0      EQU   X'F0'                    SWITCH FOR 2260L AND LOCAL      71520020
*                                         SCHEDULER                     71540020
UNITCHK  EQU   X'0E'                    SET ENDING STATUS               71560020
DATCK    EQU   X'08'                    DATACHECK MASK                  71580020
RDLEEOT  EQU   X'10'                    MASK FOR RESPONSE RECEIVED      71600020
DATCHK   EQU   X'08'                    DATA CHECK MASK                 71620020
SENDPRI  EQU   X'20' .                  SEND PRIORITY MASK FOR LCS21101 71660020
MPT      EQU   X'10'                    MULTIPT CHARCTERISTIC           71680020
DUMMY    EQU   X'DF'                    DUMMY ILIST ENTRY               71700020
RETRY    EQU   6                        BSC RETRY COUNT                 71720020
ENDCTL   EQU   X'20'                    DEVICE CHARACTERISTIC           71740020
PCIOPT   EQU   X'FF'                    PARAMETER NOT TO POST BUFFERS   71780020
RCVPCI   EQU   X'20'                    MASK FOR PCI ON RECEIVE         71800020
SNDPCI   EQU   X'10'                    MASK FOR PCI ONSNDING           71820020
PCIFLAG  EQU   X'80'                    PCI STATUS IN CSW               71840020
DISDLEOT EQU   X'01'                    FLAG TO WRITE DLE EOT           71860020
NOPCI    EQU   X'00'                    PARAMETER                       71880020
LOCKED   EQU   X'80'                    LOCK OUT MASK FOR BUFFER COUNT  71900020
DBLRVI   EQU   X'01'                    SWITCH FOR DOUBLE RVI I5        71920020
*                                       RESPONSE TO TEXT                71940022
*                                         MODE                          71942022
STAT1    EQU   X'0A'                    DB, US, DE MASK          S99228 71942422
STAT2    EQU   X'2E'                    CR,EC,DC,CC MASK       @OY20488 71942882
ASTAT3   EQU   X'26'                    IR                     @OY20488 71942982
SS0      EQU   6                        SENSE 0 OFFSET           S99228 71943222
SS1      EQU   7                        SENSE 1 OFFSET           S99228 71943622
PCIRCV   EQU   X'22'                    RECEIVE PCI MASK         S99228 71944022
ASCIEOT  EQU   X'04'                    ASCII EOT              @OZ29663 71946082
ASTAT1   EQU   X'18'                    ASCII DB, DE MASK      @OZ29663 71948082
ASTAT2   EQU   X'1E'                    ASCII CR,IR,ER,DC,CC   @OZ29663 71950082
ASCIDE   EQU   X'42'                    ASCII DEVICE END ONLY  @OZ29663 71952082
AUTOPL   EQU   X'01'                    INVLIST CWORD AUTOPL IND S99228 71954022
CLOCAL   EQU   X'02'                                             S99228 71956022
CREMOTE  EQU   X'80'                    BSC DEVICE              SA59028 71957022
C3270    EQU   X'04'                    3270 DEVICE              S99228 71958022
CNOIDLES EQU   X'02'                    NO IDLES DEFINED         S99228 71959022
CUMASK   EQU   X'01'                    GENERAL POLL CONTROL UNITS99228 71960022
LCL3277  EQU   X'09'                    LOCAL 3277 MODEL CODE    S99228 71960222
REG7     EQU   28                       OFFSET TO REGISTER 7     S99228 71960622
TTY1     EQU   X'10' .                 UCBTYPE+0                SA48278 71961022
TTY2     EQU   X'51' .                 UCBTYPE+0 FLAGS          SA48278 71962022
TTY3     EQU   X'50' .                 UCBTYPE+3 FLAGS          SA48278 71963022
TTY4     EQU   X'13' .                 UCBTYPE+3                SA48278 71964022
TTY5     EQU   X'A0' .                 UCBTYPE+3 FLAGS          SA48278 71965022
L22601   EQU   X'12' .                 UCBTYPE+2                SA51061 71966022
L2260    EQU   X'10'                   UCBTYPE+2 FLAG           SA51061 71967022
ATTN     EQU   X'20' .                  ATTENTION  ALLOWED FLAG  S22025 71970022
TICEND   EQU   11                       LOW ORDER BYTE TIC ADDR  S99228 71973022
X7F      EQU   X'7F'                    OK CHANNEL PROG COMP CD  S22025 71975022
UCBOFFST EQU   28                       OFFSET TO UCB REG IN SAVEX02004 72000005
UNITYPE  EQU   19                       UNIT TYPE OF UCB        SA51090 72000122
LCLRSCH  EQU   X'1E'                    LOCAL RECIEVE SCHD KEY  SA57329 72009122
EBCDACK  EQU   X'76'                    EBCDIC ACK FOR S/S      SA62991 72012151
         CNOP  0,8                      ALIGN TO DOUBLE WORD     X02004 72013105
ASCIACK  EQU   X'06'                    ASCII  ACK FOR S/S      SA62991 72015151
THIRTY2  EQU   32                       OFFSET 32              @ZA02095 72016161
ELINEND  EQU   *                                                 X02004 72017105
         TPRIOR                                                         72020020
         TLCBD                                                          72040020
         TQCBD                                                      TSO 72060020
         TTRMD                                                          72080020
         TTSID                                                          72100020
         TCCWD                                                          72120020
         TSCBD                                                          72140020
         TAVTD                                                          72160020
         TPRFD                                                          72180020
         DCBD  DSORG=TX                                                 72200020
         TRECBD                                                         72220020
         TTNTD                                                          72240020
         TTPD                                                           72260020
         TTCBD                                                          72280020
         TDEBD                                                          72300020
         CVT   DSECT=YES                                                72320006
         EJECT                                                          75320006
         TTCXD                                                          78320006
         EJECT                                                          81320006
         IECDIOSB                                                       82320006
         MEND                                                           84320006
./  ADD  SSI=80680102,NAME=MIEDQFA
         MACRO                                                          00030020
         MIEDQFA  &X                                                    00060022
.*A-000000-999999                                              @X31X8Q0 00060208
.*A513900                                                      @OX12563 00060300
         LCLC     &CH                                                   00060522
         LCLA     &A                                                    00061022
* CHANGE ACTIVITY = AS FOLLOWS:                                         00061261
* ****************** MICROFICHE FLAGS *********************** SUPT CODE 00061561
* A281400,751500,752100,756900,759600                            A44866 00062061
* C283500                                                        A44866 00062161
* A473700                                                        A42363 00062261
* C085200,487800,495900,501000,501900,826200-826500              A42363 00062361
* D243700                                                        A42363 00062461
* A487800,831300                                                  M2321 00062561
* C085200,495300,661700                                           M2321 00062661
* A206100                                                         M6298 00062761
* C085200,183600-184200                                           M6298 00062861
* D176100-176400                                                  M6298 00062961
* A221300,221320                                                 A49211 00063061
* C085200,221200                                                 A49211 00063161
* D220800                                                        A49211 00063261
* A757100                                                        A49228 00063361
* C738000,756000                                                 A49228 00063461
* A284700                                                        A41025 00063561
* C085200,089100-092100                                          A41025 00063661
* D088200-088500                                                 A41025 00063761
* A238200                                                        A42400 00063861
* C085200                                                        A42400 00063961
* C085200,153903,155080                                          A47133 00064061
* A054900,056100,096300,150300,153900,154100,154500,154800       S21101 00064161
* A155060,155080,156600,166800,167100,178800,179400,180000       S21101 00064261
* A180600,180800,180840,217800,235500,340800,456300,479100       S21101 00064361
* A485400,504600,661500,840300                                   S21101 00064461
* C021300,026700,027300,030300,032400-033300,037200,040500       S21101 00064561
* C063300,071700,076200,085200,092700,105900,112200,116700       S21101 00064661
* C121200,130500-131100,139800,141000,143400,145200,146100       S21101 00064761
* C154120,155066-155084,161100,163500,180220,182700,186900       S21101 00064861
* C188400,192000,218400,220800-221100,236100-237000,238400       S21101 00064961
* C238599,239400,653700,257100,260400-261600,262200-269700       S21101 00065061
* C287400,288000,288600,329100,331200,339900,345000,346800       S21101 00065161
* C362100,363000,388200,399000,399900,404400,405300,426300       S21101 00065261
* C431700,435600,438000,438600,535800,547800,558600,574500       S21101 00065361
* C612600,691200,709500,726600,729300,766500,767100,767700       S21101 00065461
* C774000,793200,821100,822000,827400,857100-857400              S21101 00065561
* D117900-119100,129900,132900-138000,147000-148200              S21101 00065661
* D154600-154800,179100,180300-180818,218700,219600,226500       S21101 00065761
* D229800,230400,232800,249600,258000-258900,259500-259800       S21101 00065861
* D270300-270600,333300-334200,339300,527100-528300,859800       S21101 00065961
* A451300,485760-485940,513601-513810,539730-539970,540700       S22026 00066061
* A765930-766140,766600,860800                                   S22026 00066161
* C067800,450300,550800-551700                                   S22026 00066261
* D513000                                                        S22026 00066361
* C341400                                                        A44895 00066461
* A228300                                                       SA54922 00066561
* C221320                                                       SA54922 00066661
* A562500,282900                                                SA54262 00066761
* C478500-479300                                                SA52972 00066861
* A514800                                                       SA57087 00066961
* A518100                                                       SA55393 00067061
* D551400-552600                                                SA56898 00067161
* C485880                                                       SA57333 00067261
* A153900,219900,223500,428700,438900,503700,521700             SA52971 00067361
* C153000-153250,153600,153903-153994,154120,155070-155400      SA52971 00067461
* C164400-164500,181040-181240,217900,220500,220900-221040      SA52971 00067561
* C221200-221360,222600-222900,225000-226800,227400-228000      SA52971 00067661
* C234000-235600,429000-429150,478500-479300,484200-484800      SA52971 00067761
* C500700-500800,504700-504840,513600-513619,522300-531600      SA52971 00067861
* C532800-533400                                                SA52971 00067961
* D001800-006600,154000-154100,163800,228400,485500,            SA52971 00068061
* D507300-507600,532200                                         SA52971 00068161
* A445500,515400,738300,741900,753100,755700                    SA52984 00068261
* C445200,445800,755940                                         SA52984 00068361
* D449400-457200,743400-743700                                  SA52984 00068461
* D055800,790500-791100,795600-798000                           SA51078 00068561
* A202600-202700,214300,795600-796600                           SA51078 00068661
* C231900                                                       SA51078 00068761
* A033070-033490                                                SA51783 00068861
* D145200,150400-150580,154900-155070,156000-156900,178900      SA51783 00068961
* D179500,179800-179900,180100-180840                           SA51783 00069061
* A148510-148650,148860-149040                                  SA51783 00069161
* A154126-154150,181280-181440,215420-215680,221040-221220      SA50192 00069261
* A221382-221392                                                SA50192 00069361
* C220980                                                       SA50192 00069461
* D221040-221200                                                SA50192 00069561
* A056150,549650,553850-554060                                   S22024 00069661
* D550500                                                        S22024 00069761
* A256230-256470                                                SA61800 00069861
* C350100,359400                                                SA59522 00069961
* D358200                                                       SA59522 00070061
* A460200,546240,554400                                         SA61767 00070161
* C546020                                                       SA61767 00070261
* D238400                                                       SA61768 00070361
* C238406-238408,238420,238460,238484,238496-238599             SA61768 00070461
* A509700                                                       SA62949 00070561
* C 358000                                                      SA62976 00070661
* A 661760                                                      SA63623 00070761
* C481800                                                       SA66617 00070861
* A522300                                                       SA66626 00070961
* A786900                                                       SA68051 00071061
* D787800                                                      @SA68051 00071161
.*C013390                                                      @Z30X8QE 00071208
* A207600                                                      @YA03936 00171161
* A602700,603000                                               @SA70861 00271161
* C495440                                                      @SA70861 00371161
* A786900                                                      @SA68051 00371261
* A38910,384600                                                @SA69655 00371361
*A482700                                                       @YA05477 00371461
.*D814500                                                      @SA73185 00471461
.*A202800                                                      @YA06869 00571461
*A482100                                                       @YA08105 00601461
*D518170-518310                                                @YA08105 00631461
*A733200,751500                                                @YA07705 00640400
*A154200                                                       @SA71965 00649400
*A504600                                                       @SA74867 00658400
*D513780-513810                                                @OX11340 00667400
*A056300,445740,445961                                         @OZ09304 00668400
*C445560-445590                                                @OZ09304 00669400
*C439140                                                       @OZ09304 00670400
*A056350,385800,389280                                         @OZ14195 00671400
*A056350                                                       @OS79957 00671582
*C445940-445961                                                @OS79957 00671682
*A452100,759300,782700                                         @OX20639 00671782
*D456000,459000,463800                                         @OX20639 00671882
*A455400,455700,459600,459900                                  @OX20639 00671982
*A445930                                                       @OY20265 00672082
*A389300                                                       @OZ30296 00672182
*A514900                                                       @OX11340 00676400
*C 554050                                                      @Y17XA0Z 00682400
*A615600                                                       @OS77389 00683400
         SPACE 3                                                        00690022
.********************************************************************** 00720022
         AIF   ('&X' NE 'CORE').CDS                                     00750020
&A       SETA  1 .                                               S22025 00780022
IEDQFA1  TITLE '''IEDQFA'' - CPB INITIALIZATION - CORE ONLY' .   S22025 00790022
IEDQFA1  CSECT                                                          00810020
         AGO   .OK                                                      00840020
.CDS     AIF   ('&X' NE 'DISK').BOTH                                    00870020
&A       SETA  2                                                        00900020
IEDQFA2  TITLE '''IEDQFA'' - CPB INITIALIZATION - DISK ONLY' .   S22025 00930022
IEDQFA2  CSECT                                                          00960020
         AGO   .OK                                                      00990020
.BOTH    ANOP                                                           01020020
&A       SETA  3                                                        01050020
IEDQFA3  TITLE '''IEDQFA'' - CPB INITIALIZATION - CORE AND DISK' S22025 01080022
IEDQFA   CSECT                                                          01110020
IEDQFA3  EQU   * .                                                      01140020
.OK      ANOP                                                           01170020
&CH      SETC  'IEDQFA&A'                                               01200020
         ENTRY IEDQFQ .                                                 01230020
*********************************************************************** 01260020
*                                                                     * 01290020
*  TITLE: MIEDQFA - CPB INITIALIZATION                                * 01320022
*                                                                     * 01320552
         AIF   ('&X' NE 'CORE').TAG1                                    01321022
*  MODULE NAME = IEDQFA1                                              * 01322022
*                                                                     * 01323022
*  DESCRIPTIVE NAME = CPB INITIALIZATION - CORE ONLY                  * 01324022
         AGO   .TAG3                                                    01325022
.TAG1    AIF   ('&X' NE 'DISK').TAG2                                    01326022
*  MODULE NAME = IEDQFA2                                              * 01327022
*                                                                     * 01328022
*  DESCRIPTIVE NAME = CPB INITIALIZATION - DISK ONLY                  * 01329022
         AGO   .TAG3                                                    01330022
.TAG2    ANOP                                                           01331022
*  MODULE NAME = IEDQFA(3)                                            * 01332022
*                                                                     * 01333022
*  DESCRIPTIVE NAME = CPB INITIALIZATION - CORE AND DISK              * 01334022
.TAG3    ANOP                                                           01335022
*                                                                     * 01336022
*  COPYRIGHT = 'NONE'                                                 * 01337022
*                                                                     * 01338022
*  STATUS -- CHANGE LEVEL 8                                    @Z30X8QE 01339008
*                                                                     * 01410020
*FUNCTION -- THIS ROUTINE CONSISTS OF 2 PARTS                         * 01440020
*   1. FA - THIS ROUTINE WILL INITIALIZE CPBS TO WRITE OR READ        * 01470020
*     BUFFER UINTS TO OR FROM DISK.                                   * 01500020
*   2. FQ - THIS ROUTINE WILL HANDLE CPBS AFTER DISK I/O HAS BEEN     * 01530020
*   COMPLETED.                                                        * 01560020
*                                                                     * 01590020
*ENTRY POINTS -- THIS MODULE HAS TWO ENTRY POINTS                     * 01620020
*   1. 'IEDQFA' - TO QUEUE A BUFFER ON DISK OR TO OBTAIN FULL         * 01650020
*      BUFFERS FROM A MESSAGE QEUUE                                   * 01680020
*   2. 'IEDQFQ' - TO HANDLE CPBS AFTER DISK OPERATIONS AND FILL       * 01710020
*      BUFFERS FROM DATA IN CPBS WHICH HAVE READ A RECORD             * 01740020
*      OR FROM UNITS IN A MAIN STORAGE QUEUE.                         * 01770020
*   CALLING SEQUENCE                                                  * 01800020
*                  L     R1,ELEMAD                                    * 01830020
*                  L     R15,QCBSTCHN-1                               * 01860020
*                  LA    R15,2(R15)                                   * 01890020
*                  BR    R15                                          * 01920020
*                                                                     * 01950020
*INPUT -- ENTRY IS ALWAYS FROM THE DISPATCHER.  DIFFERENT INPUT       * 01980020
*   IS EXPECTED AT THE TWO ENTRY POINTS                               * 02010020
*   1.  IEDQFA -                                                      * 02040020
*      A. BUFFER TO BE WRITTEN ON DISK.  IT WILL CONTAIN THE          * 02070020
*         RELATIVE RECORD NIMBERS FOR THE UNITS OF THE BUFFER         * 02100020
*         THE BUFFER IS POSTED TO THE DISK I/O QCB FROM THE      S21101 02130020
*         DESTINATION SCHEDULER.                                      * 02160020
*      B. BUFFERS TO BE FLAGGED SERVICED, INTERCEPTED, OR CANCELED    * 02190020
*         ON THE MESSAGE QUEUES                                       * 02220020
*         POSTED BY BUFFER DISPOSITION, INTERCEPT, OR CANCEL          * 02250020
*      C. ERB - AN ERB WILL BE POSTED TO OBTAIN FULL BUFFERS.         * 02280020
*         SEND SCHEDULER WILL POST THE ERB TO OBTAIN FULL BUFFERS     * 02310020
*         TO SATISFY AN INITIAL REQUEST FOR SENDING                   * 02340020
*         BUFFER DISPOSTION WILL POST THE ERB FOR RECALL              * 02370020
*         EOBCHECK WILL POST FOR RECALLED BUFFERS                     * 02400020
*         THE GET SCHEDULER WILL POST TO OBTAIN FULL BUFFERS TO       * 02430020
*         SATISFY A GET                                               * 02460020
*         PCI APPENDAGE WILL POST TO GET BUFFERS FOR                  * 02490020
*         SUBSEQUENT TRANSMISSION                                     * 02520020
*         THE ADDRESS OF THE FIRST BYTE OF DATA TO PUT IN THE         * 02550020
*         BUFFER WILL BE IN SCBDEOB                                   * 02580020
*                                                                     * 02610020
*   2.  IEDQFQ                                                        * 02640020
*      A. QCB - THE CPB CLEANUP QCB WILL BE POSTED TO ITSELF     S21101 02670020
*         TO INITIATE CLEANING UP OF THE CPBS.                        * 02700020
*         THE QCB WILL BE POSTED BY DISK END APPENDAGE AFTER DISKS21101 02730020
*         I/O IS COMPLETE AND THE COMPLETED CPBS HAVE BEEN            * 02760020
*         PLACED ON THE AVTDKAPQ.                                     * 02790020
*      B. BUFFER - A BUFFER UNIT WILL BE POSTED TO SATISFY            * 02820020
*         A REQUEST FROM FQ.                                          * 02850020
*         BUFFER RETURN WILL POST THE AVAILABLE UNIT TO THE           * 02880020
*         CLEANUP QCB                                                 * 02910020
*                                                                     * 02940020
*OUTPUT -- THE COMBINED OUTPUT OF FA AND FQ WILL BE                   * 02970020
*   1. BUFFERS WRITTEN ON DISK                                        * 03000020
*   2. ERB WITH FULL BUFFERS POSTED TO ACTIVATE QCB OF THE GET   S21101 03030020
*      SCHEDULER.                                                     * 03060020
*   3. ERB WITH RECALLED BUFFERS POSTED TO THE SPECIFIED QCB.         * 03090020
*   4. DUPLICATE HEADERS POSTED TO SPECIFIED QCB.                     * 03120020
*   5. CPBS PUT BACK INTO THE FREE POOL.                              * 03150020
*                                                                     * 03180020
*EXTERNAL ROUTINES --                                                 * 03210020
*        'IEDQDISP' - DSPPOSTR - PLACE AN ELEMENT ON THE READY   S21101 03240020
*   QUEUE BY PRIORITY.                                           S21101 03250020
*        IGG019RC-WTORTN-DISK ERROR HANDLING                     99226  03300022
*        ANY EXTERNAL SUBROUTINE WHOSE ADDRESS IS IN THE PRFTIC SA51783 03307022
*        FIELD OF A BUFFER POSTED TO IEDQFA WITH 'EE' PRIORITY  SA51783 03314022
*        TO REQUEST A CPB.                                      SA51783 03321022
*        THESE SUBROUTINES ARE:                                 SA51783 03328022
*        'BUILDCPB' - IN IEDQGQ                                 SA51783 03335022
*        'NEWPFEFO' - IN IGG019RP                               SA51783 03342022
*        'UPFEFO' - IN IGG019RP                                 SA51783 03349022
*                                                                     * 03360020
*EXITS-NORMAL -- FA - WHEN THERE ARE NO MORE CPBS AVAILABLE           * 03390020
*   OR ELEMENTS TO PROCESS, EXIT IS TO EXCP DRIVER. WHO WILL          * 03420020
*   RETURN TO THE DISPATCHER.                                         * 03450020
*   FQ - WHEN ALL CPBS HAVE BEEN PROCESSED EXIT IS TO FA              * 03480020
*                                                                     * 03510020
*EXITS-ERROR-BRANCH TO THE WTORTN OF IGG019RC ON DISK ERRORS     99226  03540022
*   A LOGICAL READ ERROR MAY OCCUR WHEN PERFORMING A RECALL      99226  03570022
*   A LOGICAL READ ERROR MAY OCCUR WHEN A REQUEST IN MADE TO          * 03600020
*   READ A RECORD AND THE RECORD NUMBER OF  RECORD WHEN READ          * 03630020
*   DOES NOT AGREE WITH THE REQUESTED RECORD NUMBER.                  * 03660020
*   APPROPRIATE ERROR FLAGS ARE SET AND THE ERB IS RETURNED           * 03690020
*   TO THE SPECIFIED QCB.                                        S21101 03720020
*                                                                     * 03750020
*TABLES/WORKAREAS --                                                  * 03780020
*   LOCAL FLAGS IN THE TIC FIELD OF THE BUFFERS ARE                   * 03810020
*   XBUFFER,XSPECIAL,XREUSDSK,XPARTIAL,XNONREUS.                      * 03840020
*   IN THE ERB STATUS FIELD FLAGS ARE                                 * 03870020
*   XMSG,XXUSED,XXINQ,XCOMPL,XERROR                                   * 03900020
*   LOCAL CONSTANTS - XMASK FOR TERM DSECT                            * 03930020
*   DSECTS USED - LCB,SCB,PRF,TRM,AVT,QCB,CPB,DATA,DCB,DISP           * 03960020
*   AVTFIELDS - ACTIB,APLKN,APLKF,AVFCT,BFDSB,BFREB,BFRTB,BIT1        * 03990020
*   BIT2,CADDR,DATLN,DKAPQ,DKENQ,DOUBL,DSKCT,EA,EINPR,EZERO,FCPB      * 04020020
*   RC,RO,HDRSZ,IA,INCPQ,KEYLE,MHCOB,NCPBQ,NOBFQ,PARM,PARM3,     S21101 04050020
*   REUSQ,TRNMPT,RUFTN,TXTSZ,UMALN.                                   * 04080020
*                                                                     * 04110020
*ATTRIBUTES -- REUSEABLE, REFRESHABLE, ENABLED, RESIDENT              * 04140020
*                                                                     * 04170020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 04200020
*    PARTICULAR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER     * 04230020
*    SET.                                                             * 04260020
*                                                                     * 04290020
**********************************************************************  04320020
*                                                                     * 04350020
**********************************************************************  04380020
*                                                                     * 04410020
R0       EQU   0 .                      WORK REG                        04440020
*                                       ADDR OF LAST THING POSTED       04470020
R1       EQU   1 .                      PARAMETER REG                   04500020
*                                       WORK REG                        04530020
R2       EQU   2 .                      ADDRESS OF CPB UNIT             04560020
*                                       ADDRESS OF QCB OT POST TO       04590020
*                                       ADDRESS OF BUFFER UNIT          04620020
RSCB     EQU   3 .                      SCB ADDRESS                     04650020
R3       EQU   3 .                                                      04680020
RLCB     EQU   4 .                      LCB ADDRESS                     04710020
R5       EQU   5 .                      WORK REG                        04740020
*                                       DUMMY CPB REG                   04770020
RPRF     EQU   6 .                      BUFFER PREFIX ADDRESS           04800020
RPREFIX  EQU   6 .                      BUFFER PREFIX ADDRESS           04830020
R6       EQU   6 .                                                      04860020
RQCB     EQU   7 .                                                      04890020
R7       EQU   7 .                                                      04920020
R8       EQU   8 .                      NUMBER OF UNITS IN BFR          04950020
*                                       ADDR OF LAST UNIT OF BFR        04980020
RPQ      EQU   9 .                      ADDRESS OF PRIORITY             05010020
*                                       DEST QCB                        05040020
R9       EQU   9 .                                                      05070020
*                                       WORK REG                        05100020
*                                       ADDRESS TO MOVE FROM            05130020
RDCB     EQU   10 .                     ADDRESS OF DCB                  05160020
R10      EQU   10 .                     VALUE OF ADDR FOR RECORD        05190020
R11      EQU   11 .                     DISPATCHER BASE                 05220020
*                                       WORK REG                        05250020
*                                       COUNT TO MOVE                   05280020
RBASE    EQU   12 .                     PROGRAM BASE REG                05310020
RSAVE    EQU   13 .                     ADDR OF AVT SAVE 2              05340020
R14      EQU   14 .                     ADDRESS TO MOVE TO              05370020
*                                       WORK REG                        05400020
R15      EQU   15 .                     ADDRESS OF CPB                  05430020
**********************************************************************  05460020
**                                                                    * 05490020
*                       CONDITIONS FOR BCR INSTRUCTIONS          S21101 05500020
*                                                                S21101 05510020
ONES     EQU   1 .                                               S21101 05512020
PLUS     EQU   2 .                                               S21101 05514020
NOTZERO  EQU   7 .                                               S21101 05516020
ZERO     EQU   8 .                                               S21101 05518020
EQUAL    EQU   8 .                                               S21101 05518420
NOTMINUS EQU   11 .                                              S21101 05518820
NOTONES  EQU   14 .                                              S21101 05519220
LASTNOFF EQU   X'04'                                            SA52971 05519300
DCBOPEN  EQU   X'10' .                                                  05520020
XXCTUSED EQU   X'80' .             THE DISABLED CT IS BEING REFER'D     05550020
XCTZERO  EQU   X'7F' .                                                  05610020
LGB      EQU   X'80' .                  DSORG TO INDICATE LGB    S22024 05615022
INCR     EQU   4 .                      INCREMENT VALUE FOR ADDR S21101 05620020
DIV4     EQU   2 .                      VALUE TO DIVIDE BY 4     S21101 05630020
EIGHT    EQU   8                        MASK FOR ICM           @OZ09304 05632000
AD       EQU   7                        ICM/STCM MASK            Y02027 05635006
FOUR     EQU   4                        CONSTANT               @OS79957 05636082
FIVE     EQU   5                        CONSTANT               @OS79957 05636582
TWO      EQU   2 .                                             @OZ14195 05637000
*                                                                       05640020
*                                                                       05670020
*        THE FOLLOWING FLAGS ARE IN THE ERB STATUS BYTE                 05700020
*        X'08' MUST NEVER BE ON                                         05730020
*                                                                       05760020
*                                                                       05790020
XXHMSG   EQU   X'80' .                  END OF MSG RCVD IN HM           05820020
XRDERR   EQU   X'20' .                  LOGICAL RD ERR FROM DISK        05850020
*     INITIATE MODE WITH CORE QUEUES - THE NTXT IS NOT THERE YET        05880020
*        IF A LOGICAL READ ERROR OCCURS IN INITIATE MODE - FA WILL      05910020
*        DROP THE ERB LEAVING LCBDLNK SWITCH SET TO 'NOT POSTABLE'      05940020
*        PCI WILL NOT POST THE ERB.  LOGICAL READ ERROR WILL ALSO BE    05970020
*        SET IN ERBST.  WHEN HM RECEIVES A BFR IN INIT MODE UNDER       06000020
*        THESE CONDITIONS - THE ERB FOR THE DESTINATION LINE WILL       06030020
*        BE REPOSTED TO FA WITH AN E0 PRIORITY REQUESTING               06060020
*        THE BUFFERS OF THIS MESSAGE AGAIN.  THE DESTINATION LCB        06090020
*        WILL BE FOUND FROM THE LCBINSRCE CHAIN OF THE SOURCE LCB.      06120020
XCOMPL   EQU   X'02' .                                                  06150020
*        COMPLETE REQUEST HAS BEEN DONE                                 06180020
XXXINQ   EQU   X'10' .                  ERB IS IN BFR RTN Q             06210020
XMSG     EQU   X'40' .                  END OF MSG FROM THE QUEUE       06240020
*                                                                       06270020
*                                                                       06300020
*        THE FOLLOWING FLAGS ARE IN THE BUFFER TIC FIELD         S21101 06330020
*                                                                       06360020
*                                                                       06390020
XPARTIAL EQU   X'40' .                                                  06420020
*        NOT A COMPLETE BFR - NO PRFX HERE                              06450020
XREUSDSK EQU   X'20' .                                                  06480020
*        BFR TO BE QUEUED ON REUSABLE DISK                              06510020
XSPECIAL EQU   X'80' .                                                  06540020
*        THE SPECIAL OPERATION REQUIRED IS DONE BUT BFR NOT WRITTEN     06570020
XBUFFER  EQU   X'01' .                                                  06600020
*        FEFO PTR DONE BUT BFR NOT WRITTEN                              06630020
XNRDISK  EQU   X'10' .                  TO BE QUEUED ON MR DISK         06660020
XSRVCD   EQU   X'02' .                 TO BE FLAGGED SERVICED           06690020
*                                                                     * 06720020
ONE      EQU   1 .                                                      06750020
PCIADD   EQU   X'50' .                                           S22026 06780022
XLOGEOM  EQU   X'80' .                  NO PCI SPEC.- END OF INIT       06810020
*                                       IAL REQUEST FOR LINE            06840020
*        PRFTIC FLAGS WILL BE AS FOLLOWS                                06870020
*              X'28' - TO BE QUEUED ON REUS DISK                        06900020
*              X'18' - TO BE QUEUED ON NONREUS DISK                     06930020
*              AS SET BY DEST SCHEDULER                                 06960020
*              X'88' - SPECIAL FLAG - 2 OPERATIONS WERE TO BE           06990020
*              PERFORMED AS A RESULT OF THIS BUFFER BUT CPBS WERE       07020020
*              NOT AVAILABLE FOR BOTH                                   07050020
*              X'48' - PARTIAL BUFFER ONLY - NOT ENOUGH CPBS WERE       07080020
*              AVAILABLE TO QUEUE THE LAST UNITS                        07110020
*              WITH THIS FLAG THE SCB ADXR AND NO. OF UNITS LEFT        07140020
*              TO QUEUE IN THE BUFFER WILL BE IN THE FIRST       S21101 07170020
*              WORD .  THE VALUE OF ADDR IS IN THE SCB                  07200020
*              X'01'- FEFO PTR HAS BEEN WRITTEN BUT NOT THE BUFFER      07230020
*              X'02' - TO BE FLAGGED SERVICED                           07260020
*                                                                     * 07290020
*        ERB STATUS WILL BE AS FOLLOWS                                  07320020
*        IT MUST NEVER HAVE THE X'08' BIT ON                            07350020
*       X'04' - TRANSMISSION ERROR - TREAT THE REQUEST                  07380020
*        AS COMPLETED                                                   07410020
*        X'02' / COMPLETE - ALL INFO THAT WAS REQUESTED HANDLED         07440020
*        ALL CPBS ARE NOT IN                                            07470020
*       XX'20' - ERB IS ALREADY IN THE BFR REQ Q                        07500020
*                                                                     * 07530020
*********************************************************************** 07560020
*                                                                       07590020
*    THIS ROUTINE WILL INITIALIZE CPB(S) TO WRITE UNIT(S) OF A   S21101 07620020
*    BUFFER TO DISK OR TO READ DISK RECORDS TO SATISFY A REQUEST        07650020
*    MADE BY AN ERB.                                                    07680020
*                                                                       07710020
*********************************************************************** 07740020
         USING AVTSAVE2,RSAVE .                                  S22025 07770022
         USING IEDQLCB,RLCB .                                           07800020
         USING IEDQDATA,R2 .                                            07830020
         USING IEDQSCB,RSCB .                                           07860020
         USING IEDQPRF,RPREFIX .                                        07890020
         USING IEDQDISP,R11 .                                           07920020
         USING IEDQQCB,RQCB .                                           07950020
         USING IEDQPQCB,RPQ .                                           07980020
         USING IHADCB,R10 .                                             08010020
         USING IEDQCPB,R15 .                                            08040020
*********************************************************************** 08070020
         EJECT                                                          08100020
*STCB FOR DISK I/O QCB                                                * 08130020
         SPACE 2                                                        08160020
         DC    AL1(DSPMCPL2) .                                          08190020
         DC    AL1(PROCESS-&CH) .                                       08220020
         SPACE 2                                                        08250020
CPBINIT  EQU   * .                                                      08280020
         USING *,RBASE .                                                08310020
         LR    RBASE,R15 .                                              08340020
         SR    R0,R0 .                                                  08370020
*    CLEAR POST REG                                                     08400020
&CH      IEDHJN NOCPBQ .                MODULE ID AND DATE              08430022
         SPACE 3                                                        08550020
*        THIS SECTION DEALS WITH A NEWLY POSTED ELEMENT - IF IT IS      08580020
*        A BUFFER IT WILL GET THE SCB PRI FOR THE PRILVL QCB AND        08610020
*        SAVE IT.  IF A MESSAGE IS TO BE SERVICED IT WILL FORCE THIS    08640020
*        REQUEST TO BE HANDLED FIRST.                                   08670020
         SPACE  3                                                       08700020
         MVI   PRFKEY-IEDQPRF(R1),XCTZERO .                             08760020
         LR    RPRF,R1 .                                                08790020
         TM    PRFTIC,CPBTICC .         IS THIS A BFR                   08880020
         BNO   TESTQ .                  BR NOT BFR               A41025 08910020
         LA    R2,0(RPRF) .             INSURE POSITIVE R2       A41025 08920020
         NI    PRFTIC,CPBTICC+XNRDISK+XREUSDSK                          09240020
*        THESE ARE THE ONLY VALID FLAGS AT THIS POINT            S21101 09270020
         L     RLCB,PRFLCB-1 .          LCB ADDR                        09300020
         L     RSCB,LCBSCBA-1 .         SCB ADDR                        09330020
         IC    R2,SCBPRI .              SAVEPRTY QCB                    09360020
         L     RQCB,SCBDESTQ-1 .                                        09390020
         ST    RQCB,PRFQCBA-1 .                                         09420020
         STC   R2,PRFKEY .                                              09450020
         AIF   (&A NE 1).F002                                           09480020
         B     SRVCDMSG .                                               09510020
         AGO   .F003                                                    09540020
.F002    ANOP                                                           09570020
         CLI   PRFPRI,PRIDKSRV .                                        09600020
         BE    SRVCDMSG .                                               09630020
         CLI   PRFPRI,PRIFEFO .         IS THIS A REQUEST AN UP  S21101 09640020
*                                         DATE OF A FEFO POINTER S21101 09650020
         BE    UPFEFO .                   YES, GO UPDATE DISK PTRS21101 09652020
*                                         NO, NOT SO             S21101 09654020
         LH    R1,PRFSIZE .                                             09660020
         BAL   R14,SUBTRKEY .                                           09690020
         AH    R1,AVTKEYLE .                                            09720020
         STC   R1,PRFPRI .                                              09750020
         TM    PRFSTAT1,PRFNLSTN .      LAST BFR FOR LOCK               09780020
         BO    CKINIT .                 BR NO - NO FLAG NEEDED          09810020
         TM    PRFSTAT1,PRFDUPLN+PRFERMGN .                             09840020
*        DUPL HDR OR ERRMSG FOR ORGIGINAL MSG                           09870020
         BNZ   CKINIT .                 BR IF EITHER                    09900020
         TM    QCBFLAG,QCBPROC .        IS THIS THE LOCK LINE DEST      09930020
         BO    CKINIT .                 BR IF NOT LINE DEST             09960020
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN .   LOCK                      09990020
         BZ    CKINIT .                 BR NOT LOCK                     10020020
         BM    EXTLOCK .                                                10050020
         NI    SCBSTATE,X'FF'-(SCBLCK1N+SCBMSGLN) .   FLAGS OFF         10080020
EXTLOCK  EQU   * .                                                      10110020
         OI    PRFTIC,XBUFFER .         SET FLAG NOT TO WRITE FEFO      10140020
CKINIT   EQU   * .                                                      10170020
         ST    RPRF,AVTDOUBL .                                          10200020
         CLC   AVTDOUBL+1(3),SCBDEOB+1 . WAS THE LAST SUCCESSFUL EOB    10230020
*        IN THIS BUFFER                                                 10260020
         BNE   TESTQ .                                                  10290020
         MVC   SCBDEOB+1(3),PRFCRCD .   SET ADDR THIS RECORD            10320020
.F003    ANOP                                                           10350020
TESTQ    EQU   * .                                                      10380020
         NC    AVTNCPBQ+1(2),AVTNCPBQ+1 .                               10410020
         BZ    TESTELEM .                                               10440020
         LA    R2,AVTNCPBQ .            ADDR OF NO CPBQ                 10470020
         LR    R15,RPRF .               SET FOR QMGR                    10500020
         BAL   R11,ENQMGRB .                                            10530020
         SPACE 3                                                        10560020
*        CHECKS FOR MORE ELEMENTS TO BE PROCESSED BEFORE THE EXITS21101 10590020
         SPACE 3                                                        10620020
PROCESS  EQU   * .                                                      10650020
         ICM   RPREFIX,AD,AVTNCPBQ+ONE  ANY CPBS THERE           Y02027 10680006
         BZ    CALLEXCP .                                               10710020
         MVC   AVTNCPBQ+1(3),PRFLINK .  DELINK ELEM                     10770020
TESTELEM EQU   * .                                                      10800020
         AIF   (&A NE 1).F004                                           10830020
         B     ERB .                                                    10860020
         AGO   .F005                                                    10890020
.F004    ANOP                                                           10920020
         TM    PRFTIC,CPBTICC .         IS THIS A BFR                   10950020
         BNO   ERB .                                                    10980020
         SPACE 3                                                        11010020
*        WILL WRITE A BUFFER OF DISK ALONG WITH THE FEFO POINTER        11040020
*        IF NEEDED AND WILL HANDLE CANCELED MESSAGE REQUESTS AND        11070020
*        SERVICED MESSAGES.                                             11100020
         SPACE 3                                                        11130020
*                                                                       11160020
*  FOR A BUFFER WHICH HAS BEEN PARTIALLY WRITTEN ON DISK, THE FIRST     11190020
*  OF THE UNITS NOT WRITTEN WILL APPEAR ON THE NCPBQ.            S21101 11220020
*  THE TIC FIELD WILL HAVE X'18' INDICATING A PARTIALLY QUEUED          11250020
*  BUFFER AND A '20' TO INDICATE REUSEABLE DISK OR X'40' FOR NON-       11280020
* REUSABLE DISK.  PRFKEY WILL HAVE THE VALUE                            11310020
* OF ADDRESS FOR THIS UNIT IN BYTES 2,3,4,                              11340020
* AND THE NUMBER OF REMAINING UNITS IN BYTE 1                           11370020
*                                                                       11400020
         TM    PRFTIC,XPARTIAL .        HAS THIS BFR BEEN PARTIALLY     11430020
         BNO   CKSERVD .                WRITTEN ON DISK - BR NO         11460020
         SR    R8,R8 .                                                  11490020
         IC    R8,PRFKEY .              NO. OF UNITS LEFT               11520020
         L     R10,PRFKEY .             VALUE OF ADDR                   11550020
REQUEST  EQU   * .                                                      11580020
         BAL   R9,BIGSUBR .                                             11610020
         BAL   R9,SAVE .                                                11640020
         STCM  R10,AD,CPBADDR+ONE       SET ABSOLUTE RECORD NO.  Y02027 11670006
         ST    R10,DATFEFO-1-IEDQDATA(R6) .  SET REC NO THIS REC        11700020
         MVI   DATFLAGS-IEDQDATA(R6),DATNPRFX .  SET FLAG               11730020
         XC    DATCOUNT-IEDQDATA(2,R6),DATCOUNT-IEDQDATA(R6) .          11760020
         BAL   R11,EXCPINQ1 .                                           11940020
         BCT   R8,NEXTXTRA .           DECR NO UNITS IN BFR             11970020
         IC    R1,AVTDOUBL .                                            12000020
         STC   R1,DATCOUNT-IEDQDATA(R6) . SET SIZE OF DATA IN           12030020
         B     PROCESS .                 LAST UNIT                      12060020
NEXTXTRA EQU   * .                                                      12090020
         LA    R10,INCR(0,R10) .        ADD 4 TO ADDR            S21101 12120020
NEXTRA   EQU   * .                                                      12150020
         LH    R2,AVTDOUBL .                                            12180020
         L     R6,PRFTIC .               NEST UNIT                      12210020
         STC   R2,PRFTIC .             RESTORE PARTIAL FLAGS            12240020
         STCM  R2,PLUS,PRFPRI           RESTORE SIZE OF LAST UNITY02027 12270006
         B     REQUEST .                                                12330020
SAVE     EQU   * .                                                      12360020
         ICM   R2,PLUS,PRFPRI           SAVE SIZE OF ALST UNIT   Y02027 12390006
         IC    R2,PRFTIC .              SAVE FLAGS                      12450020
         STH   R2,AVTDOUBL .          SAVE ALL                          12480020
         BR    R9 .                     RETURN                          12510020
RENQELEM EQU   * .                                                      12540020
         TM    PRFTIC,XPARTIAL+CPBTICC .IS THIS A PARTIAL BFR           12570020
         BNO   ENQUEUE .                BR NO                           12600020
         ST    R10,PRFKEY .             VALUE OF ADDR                   12630020
         STC   R8,PRFKEY .              COUNT OF REMAINING UNITS        12660020
ENQUEUE  EQU   * .                                                      12690020
*        THIS ELEMENT MUST BE PUT FIRST ON THE FIFO NCPBQ               12720020
         ICM   R14,AD,AVTNCPBQ+1        GET TOP OF QUEUE         Y02027 12750006
         STCM  R14,AD,PRFLINK           CHAIN TO BUFFER          Y02027 12760006
         ST    RPREFIX,AVTNCPBQ .       PUT ELEM FIRST ON CHAIN         12780020
         BNZ   CALLEXCP .               BR YES                          12840020
         ST    RPREFIX,AVTNCPBQ+4 .     IF NO SET PTR TO LAST           12870020
         B     CALLEXCP .                                               12900020
BIGSUBR  EQU   * .                                                      12930020
         BAL   R14,REQCPB .                                             12960020
         L     R1,CPBXREAF .            UNIT ADDR                       13020020
         BAL   R14,UNITFREE .           FREE BUFFER              S21101 13050020
FREEUNIT EQU   * .                                                      13140020
         L     RQCB,PRFQCBA-1 .                                         13170020
         BAL   R14,WRKD .                                               13200020
         BR    R9 .                                                     13230020
.F005    ANOP                                                           13260020
         AIF   (&A EQ 1).F006                                           13830020
WRKD     EQU   * .                                                      13860020
         MVI   CPBRDWR,CPBWRKC .                                        13890020
         ST    RPREFIX,CPBXREAF .       ADDR OF START OF BFR TO WR      13920020
         MVI   CPBXDWR,CPBWRC .         INTO DATA FIELD                 13950020
*   A '00' FLAG INDICATES THAT THIS RECORD HAD A PREFIX          S21101 13980020
*        THE FEFO POINTER IS SET TO 0.                                  14010020
         BR    R14 .                   RETURN                           14040020
REQCPB1  EQU   * .                                                      14070020
         LA    R2,0(R3) .               INSURE R2 IS POSITIVE    S21101 14100020
*                                         AND NON ZERO           S21101 14110020
         LNR   R2,R2 .                                                  14130020
REQCPB   EQU   * .                                                      14160020
         ICM   R15,AD,AVTFCPB+ONE       ANY CPBS THERE           Y02027 14190006
         BZ    RENQELEM .               BR NO                           14220020
         MVC   AVTFCPB+1(3),CPBNEXT .  DELINK                           14280020
         LTR   R2,R2 .                                                  14310020
         BCR   NOTMINUS,R14 .                                    S21101 14340020
         L     R2,CPBXREAF .            SET UNIT ADDR FOR WR DATA       14400020
*              TO PASS ON - IT SHOULD REMAIN THE SAME                   14430020
         MVI   CPBRDWR,CPBWRC .         WRITE DATA COMMAND              14460020
         MVI   CPBXDWR,CPBNOPC .        NOP COMMAND CODE                14490020
         MVC   CPBADDR+1(3),PRFCHDR .   SET VALUE OF ADDR               14550020
         TM    PRFSTAT1,PRFNHDRN .      IS THIS A HEADER                14580020
         BCR   1,R14 .                  BR IF NOT HDR            S21101 14610020
SETCRCD  EQU   * .                                                      14640020
         MVC   CPBADDR+1(3),PRFCRCD .   SET ADDR OF THIS BFR IF HDR     14670020
         BR    R14 .                                                    14850020
UPFEFO   EQU   * .                                              SA51783 14851022
         MVI   PRFSTAT1,X'FF'-PRFNLSTN-PRFNHDRN .               SA51783 14852022
*                                       FLAG AS PRIFEFO REQUEST SA51783 14853022
NOSPEC   EQU   * .                                              SA51783 14854022
         BAL   R14,REQCPB .             GO REQUEST A CPB        SA51783 14855022
         SPACE                                                          14856022
         L     R11,AVTEA .              SET DSP BASE FOR SUBRTN SA51783 14857022
         L     R14,PRFTIC .             SAVE RETURN ADDRESS     SA51783 14858022
         ST    R15,PRFTIC .             PASS ADDRESS OF CPB     SA51783 14859022
         LR    R15,R14 .                SET RETURN ADDRESS      SA51783 14860022
         BALR  R14,R15 .                RETURN TO CALLING SBRTN SA51783 14861022
         SPACE                                                          14862022
         BAL   R11,EXCPINQ1 .           GO ENQUEUE CPB          SA51783 14863022
         B     PROCESS .                GO PROCESS NEXT ELEMENT SA51783 14864022
         SPACE                                                          14865022
CKSERVD  EQU   * .                                                      14880020
         CLI   PRFSTAT1,X'FF'-PRFNLSTN-PRFNHDRN .               SA51783 14886022
*                                       PRIFEFO REQUEST         SA51783 14892022
         BE    NOSPEC .                 BR YES                  SA51783 14898022
         SPACE                                                          14904022
         L     RLCB,PRFLCB-1 .          LCB ADDRESS                     14910020
         L     RQCB,PRFQCBA-1 .                                         14940020
         SR    R11,R11 .                                                14970020
         IC    R11,PRFKEY .                                             15000020
         BAL   R14,FINDEST2 .                                           15030020
         TM    PRFSTAT1,PRFNLSTN .      IS THIS A LAST BFR              15060020
         BO    CKCNCLD .                BR NO                           15090020
         TM    PRFTIC,XSRVCD .         TO BE FLAGGED SERVICED           15120020
         BNO   CKCNCLD .               BR NO                            15150020
         B     JUSTONE .                ALL OTHER PROCESSING IS DONE    15180020
.F006    ANOP                                                           15210020
SRVCDMSG EQU   * .                                                      15240020
         OI    PRFTIC,XSRVCD .          SET FOR LATER IN CASE OF        15270020
         TM    PRFSTAT1,PRFNHDRN .      IS THIS A HDR-EOM       SA52971 15300022
         BNO   HDRLAST .                BR YES, IF NOT HDR-EOM, SA52971 15305022
         MVC   PRFCRCD(3),PRFCHDR .     SET REC NOS AND FLAGS   SA52971 15310022
         MVC   PRFCORE(3),PRFCHDR .                             SA52971 15315022
         NI    PRFSTAT1,X'FF'-PRFNHDRN .TO LOOK LIKE HDR-EOM    SA52971 15320022
HDRLAST  EQU   * .                                              SA52971 15325022
         SR    R11,R11 .                                                15330020
         IC    R11,PRFTQBCK .           GET PRI LEVEL           SA52971 15360022
         BAL   R14,FINDEST2 .                                           15390020
         TM    QCBFLAG,QCBPROC        . APPLICATION PROGRAM      S21101 15390122
         BO    FEFORSET               . YES - BR                 S21101 15390222
*** THIS SUBROUTINE DESTROYS REGS 0,1,2, AND 11.  THE QCB       SA52971 15390322
*   EXTENSION IS RETURNED IN REG2.  RETURN IS TO +0 IF THIS     SA52971 15390622
*   IS NOT A CONCENTRATOR AND TO +4 IF IT IS A CONCENTRATOR.    SA52971 15390922
         BAL   R10,FINDLVL .            GO SEE IF PRI LVL       SA52971 15391222
         B     SETSDFFO .               BR IF NOT A CONC        SA52971 15391522
         TM    QCBEFLG-IEDQQCBE(R2),QCBEOPL .                   SA52971 15391822
*        IS THIS A PLVL CONC                                    SA52971 15392122
         BNO   SETSDFFO .               BR IF NOT PLVL          SA52971 15392422
*** WHEN MARKING SRVCD, IF CONC IS PLVL QUEUED, THE SCB USED    SA52971 15392722
*   IS NOT THE REAL ONE, SINCE 'SCBFEFO' CANNOT BE UPDATED,     SA52971 15393022
*   HM03 WILL UPDATE THE QCB EXTENSION; THEREFORE, THE          SA52971 15393322
*   EQUIVALENT OF SCBFEFO (PRFSRCE) MUST NOW BE UPDATED WITH THESA52971 15393622
*   CORRECT FEFO POINTER.                                       SA52971 15393922
         MVC   PRFSRCE(3),QCBEFEFO-IEDQQCBE(R2) SAVE FEFO       SA52971 15394222
         XC    QCBEHDR-IEDQQCBE(3,R2),QCBEHDR-IEDQQCBE(R2) ZERO SA52971 15394522
*                                         HDR PTR AS HM03 FLAG  SA52971 15394822
         B     FEFORSET .               GO DON'T RESET 'SENDING'SA52971 15395122
SETSDFFO EQU   * .                                              SA52971 15395422
         NI    QCBFLAG,X'FF'-QCBSDFFO . RESET CURRENTLY SENDING SA52971 15395722
FEFORSET EQU   * .                                              SA52971 15396022
         LR    R1,R6 .                  SET COMPARE REG WITH BFRSA52971 15396322
*                                         ADDRESS               SA52971 15396622
         AIF   (&A NE 3).F006AA .                               SA52971 15396922
         TM    PRFCRCD+L'PRFCRCD-1,CPBQTYPE IS THIS DISK ADDR   SA52971 15397222
         BNZ   TSTLF .                  YES, WE'RE SET FOR COMP SA52971 15397522
         L     R1,PRFCRCD-1 .           GET FEFO CHAIN ADDRESS  SA52971 15397822
TSTLF    EQU   * .                                              SA52971 15398122
.F006AA  ANOP  , .                                              SA52971 15398422
         CLC   PRFCRCD-IEDQPRF(3,R1),QCBLFEFO LAST MSG          SA52971 15398722
         BNE   NOQCB .                  NO, BR                   S22025 15399522
         MVI   QCBDATFL,DATSENT .       FLAG MESSAGE SERVICED    S21101 15411021
         MVC   QCBDATSQ(2),PRFTQBCK+1 . SAVE SEQ OUT            SA52971 15412022
*                                       IS THIS SCAN START      SA50192 15412622
         CLC   PRFCRCD-IEDQPRF(,R1),QCBPFEFO .                  SA50192 15413222
         BNE   NOQCB .                  BR NO                   SA50192 15413822
         SPACE                                                          15414422
         OI    QCBDATFL,DATIFEFO .      SET INITIAL FEFO        SA50192 15415022
NOQCB    EQU   *                          .                      S21101 15416021
         BAL   R14,DECRMGCT .                                           15420020
         TM    QCBDSFLG,QCBDISK         CORE ONLY              @SA71965 15423000
         BNZ   NOQCB1                   BRANCH IF NO           @SA71965 15426000
         NC    QCBFFEFO,QCBFFEFO        FEFO CHAIN EMPTY       @SA71965 15429000
         BNZ   NOQCB1                   BRANCH IF NO           @SA71965 15432000
         XC    QCBLFEFO,QCBLFEFO        ERASE NONUNIQUE        @SA71965 15435000
*                                       CORE QUEUE BRF ADDR    @SA71965 15438000
NOQCB1   EQU   *                                               @SA71965 15441000
         L     R1,PRFTIC .              SAVE NEXT UNIT                  15450020
         MVI   SCBHBFNO,AVTEZERO .      CLEAR FOR NEXT MSG              15570020
         CLI   PRFNBUNT,ONE .                                           15720020
         BE    JUSTONE .                                                15750020
         IC    R5,PRFNBUNT .            NO. OF UNITS IN THIS BFR        15780020
         MVI   PRFNBUNT,ONE .           REPLACE NUMBER OF UNITS         15810020
         BCTR  R5,0 .                   FREED                           15840020
*        FREE ALL BUT FIRST UNIT - 1 HAS NEXT UNIT ADDR                 15870020
         STC   R5,PRFNBUNT-IEDQPRF(R1) .   NEW NO. OF UNITS             15900020
         BAL   R14,RTNBFR .                                             15930020
         L     RQCB,PRFQCBA-1 .         RESTORE QCB ADDR                15960020
JUSTONE  EQU   * .                                                      15990020
         AIF   (&A NE 3).F008                                           16020020
         LA    R15,FROMDISK .           SET RTN ADDR                    16050020
         TM    QCBDSFLG,QCBCORE .       MSG IN CORE                     16080020
         BCR   NOTONES,R15 .            BR NO                    S21101 16110020
*                                                                       16140020
*  WHEN A MSG IS READ TO SEND, SCBQTYPE IS SET TO INDICATE WHICH        16170020
*  TYPE OF Q THE MSG IS BEING SENT FROM.                                16200020
*                                                                       16230020
*  PRFTIC WILL BE FLAGGED WITH A X'80' IF A SPECIAL CONDITION EXISTS    16260020
*                                                                       16290020
         TM    PRFTIC,XSPECIAL .        HAS THIS MSG BEEN FREED FROM    16320020
         BCR   ONES,R15 .               THE CORE Q - BR YES      S21101 16350020
         LR    R7,R15 .                                                 16410020
         TM    PRFCHDR+L'PRFCHDR-1,CPBQTYPE SENT FROM CORE      SA52971 16440022
         BNZ   DISKMSG .                NO, BR                  SA52971 16450022
.F008    AIF   (&A EQ 2).F009                                           16470020
         TM    LCBSTAT1,LCBINITN .      SENDING INIT MSG                16500020
         BNO   FREEIT .                 BR NO                           16530020
*        IF INITIATE MODE - THE MSG COULD BE FLAGGED SERVICED ( AS      16560020
*        IN THE CASE OF ADDRESSING ERRORS) BEFORE THE MESSAGE HAS       16590020
*        COMPLETELY ARRIVED. - IF THIS HAPPENS, THE MSG SHOULD          16620020
*        NOT BE FLAGGED SERVICED BUT ADDED TO THE FEFO Q WHEN           16650020
*        IT IS COMPLETELY RECEIVED.                                     16680020
         L     R1,PRFCORE-1 .           ADDR OF A BFR OF THIS           16740020
*                                       MSG IN THE QUEUE.               16770020
         L     R1,PRFLCB-1-IEDQPRF(R1) .  ADDR OF SRCE LCB              16800020
         TM    LCBSTAT1-IEDQLCB(R1),LCBINITN+LCBRECVN .                 16830020
*        IS SRCE LINE STILL TRANSMITTING AN INIT MODE MSG               16860020
         BNO   FREEIT .                 BR NO                           16890020
         L     R7,LCBINSRC-1-IEDQLCB(R1) .  ADDR OF DEST LINE           16920020
         LA    R7,0(R7) .               CLEAR FOR COMPARE               16950020
         LA    RLCB,0(RLCB) .           CLEAR FOR COMPARE               16980020
         CLR   R7,RLCB .                STILL SENDING TO THIS LINE      17010020
         BNE   FREEIT .                 BR NO                           17040020
*        IF THE LCB HAS REACHED BFR DISPOSITION - THE EOM BFR           17070020
*        HAS REACHED DEST. SCH. - BD WILL FREE ALL UNUSED BFRS          17100020
*        BEFORE POSTING THE EOM BFR TO H M.                             17130020
         NC    LCBLSPCI-IEDQLCB(2,R1),LCBLSPCI-IEDQLCB(R1) .            17160020
*        HAVE THE BFRS BEEN FREED                                       17190020
         BZ    FREEIT .                 BR IF BFRS HAVE BEEN BFRRE      17220020
*        BY BD                                                          17250020
         NI    LCBSTAT1-IEDQLCB(R1),X'FF'-LCBINITN .                    17280020
*        RESET INIT MODE FOR THIS SOURCE TO FORCE MSG INTO FEFO         17310020
         B     POSTBFR .                DO NOT FREE MSG FROM Q          17340020
FREEIT   EQU   * .                                                      17370020
         L     R15,ADFREEMS .           FREE MSG FROM CORE QUEUE UNI    17400020
         BALR  R7,R15 .                 UNITS                           17430020
         L     RQCB,PRFQCBA-1 .         RESTORE QCB ADDR                17460020
         AIF   (&A NE 3).F009                                           17490020
         TM    QCBDSFLG,QCBREUS+QCBNREUS .                              17520020
*                       WAS THIS MSG DISK QUEUED ALSO                   17550020
         BZ    POSTBFR .               BR NO                            17580020
*                                                                       17670020
*  THIS SPECIAL FLAG MEANS THE MSG HAS BEEN FREED FROM THE CORE Q       17700020
*  BUT NOT FLAGGED SERVICED ON DISK.                                    17730020
*                                                                       17760020
.F009    AIF   (&A EQ 1).F010                                           17790020
         AIF   (&A EQ 2).F009A                                          17820020
FROMDISK EQU   * .                                                      17850020
         OI    PRFTIC,XSPECIAL .        FLAG SPECIAL - FREED FROM CORE  17880020
         LPR   R2,R2 .                  RESET 2                         17940020
.F009A   ANOP                                                           17970020
         BAL   R14,REQCPB1 .            SET A CPB                       18000020
         USING IEDQDATA,R2                                       S21101 18003021
         MVI   DATFLAGS,DATSENT  .      FLAG MSG SERVICED        S21101 18006021
         TM    PRFSVFFO+L'PRFSVFFO-1,CPBQTYPE  DISK ADDR        SA52971 18016000
         BNZ   DISKADDR                 BRANCH YES              SA52971 18026000
         NI    PRFSVFFO+L'PRFSVFFO-1,X'FF'-LASTNOFF  INSURE     SA52971 18036000
*                                       PROPER CORE ADDRESS     SA52971 18046000
DISKADDR EQU   *                                                SA52971 18056000
         MVC   DATFEFO(3),PRFSRCE .     SET FEFO PTR            SA52971 18104022
         MVC   DATSEQOT(2),PRFTQBCK+1 . SET SEQ OUT             SA52971 18124022
         CLC   QCBPFEFO,PRFCRCD .       IS THIS PFEFO           SA50192 18128022
         BNE   NOTPFEFO .               BR NO                   SA50192 18132022
         SPACE                                                          18136022
         OI    DATFLAGS,DATIFEFO .      SET INITIAL FEFO        SA50192 18140022
NOTPFEFO EQU   * .                                              SA50192 18144022
         BAL   R11,EXCPINQ1 .                                           18150020
.F010    ANOP                                                           18180020
POSTBFR  EQU   * .                                                      18210020
         LR    R1,RPREFIX .             FREE THIS UNIT                  18240020
         BAL   R14,UNITFREE .                                    S21101 18270020
         B     PROCESS .                GO GET NEXT ELEM                18300020
DECRMGCT EQU   * .                                                      18330020
         LH    R11,QCBMSGCT .           DECREASE MSGCT BY ONE     M6298 18360020
         BCTR  R11,0 .                                            M6298 18390020
         STH   R11,QCBMSGCT .                                     M6298 18420020
         BR    R14 .                                                    18450020
         AIF   (&A EQ 1).F011                                           18480020
CKCNCLD  EQU   * .                                                      18510020
         TM    PRFSTAT1,PRFCNCLN .                                      18540020
         BNO   CKDUPLHD .               BR NO                           18570020
         AIF   (&A NE 3).F010BB                                         18600020
         TM    QCBDSFLG,QCBCORE .       CORE W/ DISK BACKUP             18630020
         LA    R7,NOBACKUP .            SET RTN ADDR                    18660020
         BCR   NOTONES,R7 .             BR IF DISK ONLY          S21101 18690020
*        IF YES - FREE THE MSG FROM THE CORE QUEUE                      18720020
         TM    LCBSTAT1,LCBINITN .      INIT MODE                       18750020
         BNO   DISKMSG .                BR NO - FREE MSG                18780020
         TM    LCBINSRC+2,XXXON .       BEING SENT                      18810020
         BCR   NOTONES,R7 .             BR IF BEING SENT-NO FREE S21101 18840020
DISKMSG  EQU   * .                                                      18870020
         L     R15,ADFREEMS .           ADDR OF SUBROUTINE              18900020
         MVC   AVTDOUBL+4(3),PRFCRCD .  DISK ADDR OF BFR                18930020
         TM    PRFSTAT1,PRFNHDRN .      THIS A HDR                      18960020
         BNO   CRCDOK .                 BR IF HDR                       18990020
         MVC   AVTDOUBL+4(3),PRFCHDR .  ADDR OF HDR ON DISK             19020020
CRCDOK   EQU   * .                                                      19050020
         L     R2,QCBCFHDR-1 .          ADDR OF FIRST ON P QCB          19080020
         LA    R2,0(R2) .               CLEAR HI                        19110020
CKCRCD   EQU   * .                                                      19140020
         LTR   R2,R2 .                  IS ONE THERE                    19170020
         BCR   ZERO,R7 .                IF NO - RETURN           S21101 19200020
         ST    R2,AVTDOUBL .            ADDR OF BFR TO FREE             19230020
         CLC   AVTDOUBL+4(3),PRFCRCD-IEDQPRF(R2) .                      19260020
*        THIS THE HDR COPY OF THIS MSG                                  19290020
         BE    HAVEADDR-FREEMSG(R15) .  BR YES - THIS IS IT - GO        19320020
*        FREE IT                                                        19350020
         L     R2,PRFNHDR-IEDQPRF(R2) . NEXT HDR IN Q                   19380020
         SRL   R2,8 .                   SHIFT ADDR OVER                 19410020
         B     CKCRCD .                 GO LOOK AT THIS ONE             19440020
NOBACKUP EQU   * .                                                      19470020
.F010BB  ANOP                                                           19500020
         L     RQCB,PRFQCBA-1 .         RESTORE QCB ADDR                19530020
         TM    PRFSTAT1,PRFNHDRN .      HDR SEG                         19560020
         BNO   WRITE .                  YES - PUT CNCLD FLAG WITH BFR   19590020
         TM    PRFTIC,XSPECIAL .                                        19620020
         BO    WRITEBFR .               CNCLD FLAG HAS BEEN DONE        19650020
         BAL   R14,REQCPB1 .                                            19680020
         BAL   R14,DECRMGCT .                                           19710020
         XC    DATFLAGS-IEDQDATA(6,R2),DATFLAGS-IEDQDATA(R2) .          19740020
*        CLEAR DATA FIELD                                               19770020
         MVI   DATFLAGS-IEDQDATA(R2),DATCNCLD .SET CNCLD FLAG           19800020
         OI    PRFTIC,XBUFFER+XSPECIAL . FLAG FOR CNCL DONE AND FEFO    19830020
         BAL   R11,EXCPINQ1 .                                           19860020
         B     WRITEBFR .                 TO WRITE OUT THIS BFR         19890020
CKDUPLHD EQU   * .                                                      19920020
*            FROM BFR PRFX INTO SCB PRF WORK AREA                       19950020
         TM    PRFSTAT1,PRFDUPLN .      IS THIS A DUPL HDR              19980020
         BNO   WRITEBFR .               BR NO                           20010020
         BAL   R8,SETFEFO .                                             20040020
         BAL   R14,REQCPB .                                             20070020
         NI    PRFTIC,X'FF'-XBUFFER .  SET FLAG OFF                     20100020
         LR    R10,R6 .                                                 20130020
         L     R6,CPBXREAF .            ADDR OF CPB UNIT                20160020
         LH    R14,AVTKEYLE .                                           20190020
         EX    R14,TRANSFER .           TRANSFER DATA TO CPB UNIT       20220020
         BAL   R14,WRKD .                                               20250020
*                                       SAVE PRI LEVEL ON DISK  SA51078 20260022
         MVC   PRFPLQCB,PRFKEY-IEDQPRF(R10) .                   SA51078 20270022
         XC    DATFLAGS-IEDQDATA(8,R6),DATFLAGS-IEDQDATA(R6) . CLEAR    20280020
         LR    R2,R10                   SAVE REG               @YA06869 20283061
         SR    R11,R11                  CLEAR FOR IC           @YA06869 20286061
         IC    R11,PRFPLQCB             GET PRIORITY LEVEL     @YA06869 20292061
         BAL   R14,FINDEST2             GET PRIORITY QCB       @YA06869 20298061
         MVC   DATFLAGS-IEDQDATA(,R6),QCBDATFL  SET DATA FLAGS @YA06869 20304061
         LR    R10,R2                   RESTORE REG            @YA06869 20307061
         BAL   R14,SETCRCD .           SET REC. NO. AND DATA SET        20310020
         BAL   R11,EXCPINQ1 .                                           20340020
         LR    R1,R10 .                                                 20370020
         L     R2,LCBRCQCB .            ADDR TO POST TO                 20400020
         MVI   PRFPRI-IEDQPRF(R1),PRIRCQCB .  SET PRTY                  20430020
         LA    R14,PROCESS .            SET RTN ADDR                    20460020
         NI    PRFTIC-IEDQPRF(R1),X'FF'-XBUFFER .  FLAG OFF             20490020
         B     POST .                   POST BFR                        20520020
CNCLDCK  EQU   * .                                                      20550020
         TM    PRFSTAT1,PRFNHDRN .      IF NOT A HDR - IGNORE IT        20580020
         BO    NOSET .                                                  20610020
         BAL   R14,DECRMGCT .                                     M6298 20620020
         OI    DATFLAGS-IEDQDATA(R6),DATCNCLD .      SET CNCLD FLAG     20640020
         B     NOSET .                  CONTINUE                        20670020
WRITEBFR EQU   * .                                                      20700020
         TM    PRFSTAT1,PRFNLSTN .      IS THIS A LAST SEG              20730020
         BO    WRITE .                  BR NO                           20760020
         LH    R1,PRFSRCE               SOURCE OFFSET          @YA03936 20762061
         N     R1,AVTCLRHI              CLEAR HI HALF          @YA03936 20764061
         LTR   R1,R1                    SOURCE SPECIFIED?      @YA03936 20766061
         BZ    NOTPROC                  BRANCH IF NO           @YA03936 20768061
         L     R15,AVTRNMPT             CORRECT OFFSET TO      @YA03936 20770061
         BALR  R14,R15                  AN ADDRESS             @YA03936 20772061
         TM    TRMSTATE-IEDQTRM(R1),TRMPROC PUT PROCESS?       @YA03936 20774061
         BNO   NOTPROC                  BRANCH IF NO           @YA03936 20776061
         CLC   TRMSTAT+1-IEDQTRM(2,R1),AVTFZERO DCB CLOSED     @YA03936 20778061
         BE    CKBFRFLG                 BRANCH IF YES          @YA03936 20780061
NOTPROC  EQU   *                                               @YA03936 20782061
         TM    LCBSTAT1,LCBINITN+LCBRECVN                               20790020
*        RECEIVING AN INITIATE MODE MESSAGE                             20820020
         BNO   CKBFRFLG .               BR NO                           20850020
         NI    LCBSTAT1,LCBINITF .      INIT OFF                        20880020
         TM    LCBINSRC+2,XXXON .       IS THIS INIT MODE MSG           20910020
*                   CURRENTLY BEING SENT                                20940020
         BO    CKBFR .                  BR IF NOT BEING SENT            20970020
*     DO NOT PUT THIS MSG IN THE FEFO CHAIN                             21000020
         OI    PRFTIC,XBUFFER .                                         21030020
         B     WRITE .                                                  21060020
XXXON    EQU   X'01' .                                                  21090020
CKBFR    EQU   * .                                                      21120020
         NI    LCBINSRC+2,X'FF'-XXXON .   TURN SRC BIT OFF              21150020
CKBFRFLG EQU   * .                                                      21180020
         BAL   R8,SETFEFO .                                             21210020
WRITE    EQU   * .                                                      21240020
         SR    R8,R8 .                                                  21270020
         IC    R8,PRFNBUNT .            NO. OF UNITS TO WRITE           21300020
         BAL   R9,BIGSUBR .                                             21330020
         BAL   R14,SETCRCD .           SET REC. NO. AND DATA SET        21360020
         OI    PRFTIC,XPARTIAL .        SET PARTIAL FLAGS               21390020
         BAL   R9,SAVE .                                                21420020
         MVC   PRFPLQCB,PRFKEY .        SAVE PRI LEVEL ON DISK  SA51078 21430022
         XC    DATFLAGS-IEDQDATA(8,R6),DATFLAGS-IEDQDATA(R6) . CLEAR    21450020
         TM    PRFSTAT1,PRFCNCLN .      MSG TO BE CNCLD                 21480020
         BO    CNCLDCK .                BR YES TO CK IF HDR             21510020
NOSET    EQU   * .                                                      21540020
*                                       IS THIS HDR LAST        SA50192 21542022
         TM    PRFSTAT1,PRFNHDRN+PRFNLSTN .                     SA50192 21544022
         BNZ   NOTHDRL .                BR NO                   SA50192 21546022
         SPACE                                                          21548022
         SR    R11,R11 .                CLEAR REG               SA50192 21550022
         IC    R11,PRFPLQCB             QCB PRIORITY LEVEL      SA50192 21552022
         BAL   R14,FINDEST2 .           GET PRIORITY QCB        SA50192 21554022
         SPACE                                                          21556022
         CLC   QCBLFEFO,PRFCRCD .       LAST MSG ON QUEUE       SA50192 21558022
         BNE   NOTHDRL .                BR NO                   SA50192 21560022
         SPACE                                                          21562022
*                                       SET DATA FLAGS          SA50192 21564022
         MVC   DATFLAGS-IEDQDATA(,R6),QCBDATFL .                SA50192 21566022
NOTHDRL  EQU   * .                                              SA50192 21568022
         BAL   R11,EXCPINQ1 .                                           21570020
         BCT   R8,WRITEUNT .            ARE ANY UNITS LEFT BR-YES       21600020
         B     PROCESS .                BR NO                           21630020
WRITEUNT EQU   * .                                                      21660020
         MVC   AVTDOUBL+5(3),PRFXTRA . VALUE OF ADDR FOR                21690020
         L     R10,AVTDOUBL+4 .          THE NEXT UNIT                  21720020
         B     NEXTRA .                 PROCESS THE UNITS               21750020
SETFEFO  EQU   * .                                                      21780020
         MVC   AVTSAVE2+64(6),QCBDATFL  SET UP WORK AREA         S21101 21790022
         TM    PRFTIC,XBUFFER .         HAS THE FEFO PTR BEEN WRITTEN   21810020
         BCR   ONES,R8 .                BR YES                   S21101 21840020
         MVC   AVTSAVE2+65(3),PRFCHDR    SAVE CURRENT HDR        S21101 21870020
         TM    PRFSTAT1,PRFNHDRN .                                      21900020
         BO    TESTFEFO .                                               21930020
         MVC   AVTSAVE2+65(3),PRFCRCD    SAVE CURRENT RCD        S21101 21960020
TESTFEFO EQU   * .                                                      21990020
         BAL   R14,REQCPB1              GETG CPB                 S21101 21997022
         MVI   QCBDATFL,AVTEZERO .      SAVE FLAGS FOR LFEFO    SA52971 22004022
         XC    QCBDATSQ(2),QCBDATSQ .   SAVE SEQ NO. FOR LFEFO  SA52971 22011022
         NC    QCBFFEFO(3),QCBFFEFO .                                   22020020
         BNZ   TSTLFEFO .               BR IF ONE THERE         SA52971 22050022
         MVC   QCBFFEFO(3),AVTSAVE2+65 .SET FEFO                 A49211 22090022
* THIS MOVE CANNOT BE DONE EARLIER SINCE THERE MAY BE NO CPBS    A49211 22092022
TSTLFEFO EQU   * .                                              SA52971 22094022
         NC    QCBPFEFO(3),QCBPFEFO .   SCAN START POINT SET    SA52971 22096022
         BNZ   WRFEFO .                 BR YES                  SA50192 22098022
         MVC   QCBPFEFO(3),AVTSAVE2+65 .SET FOR FIRST TIME      SA52971 22100022
         MVC   QCBPREVF(3),AVTSAVE2+65 .SET FOR FIRST TIME      SA52971 22102022
         OI    QCBDATFL,DATIFEFO .      SET INITIAL FEFO        SA50192 22104022
         TM    PRFSTAT1,PRFNHDRN .      TEXT BFR                SA50192 22110022
         BO    SETDATFL .               BR YES                  SA50192 22116022
         SPACE                                                          22122022
         BAL   R14,CPBFREEA .           GO LET CPB GO           SA52971 22129022
         B     SETLFEFO .               SET LAST FEFO POINTER    A49211 22138022
SETDATFL EQU   * .                                              SA50192 22138222
         XC    DATFLAGS(6),DATFLAGS .   CLEAR DATA FIELD        SA50192 22138422
         MVC   DATFLAGS,QCBDATFL .      SET DATA FLAGS          SA50192 22138622
         BAL   R11,EXCPINQ1 .           GO ENQUEUE CPB          SA50192 22138822
         B     SETLFEFO .               SET LAST FEFO POINTER   SA50192 22139022
         SPACE                                                          22139222
WRFEFO   EQU   * .                                                      22140020
*        IF ONLY 1 THERE THE MSG COULD HAVE BEEN READ BUT THE           22170020
*        FEFO PTR MAY NOT BE UPDATED YET , SO THE SCB IN WHICH          22200020
*        THE FEFO PTR WAS SAVED MUST BE UPDATED.                        22230020
         ST    R15,AVTSAVE2+4 .         SAVE                    SA52971 22260022
         ST    R8,AVTSAVE2 .            SAVE R8                         22320020
         LR    R8,R9 .                  SET PQCB FOR SUBR               22350020
         LA    R9,QCBLFEFO .            PASS PTR TO FEFO TO CHNGSA52971 22360022
         LA    R10,AVTSAVE2+65 .        PASS PTR TO NEW FEFO    SA52971 22370022
         L     R15,AVTHM02 .            FIND HM03 FROM HM02 - 4         22380020
         SH    R15,AVTHA4 .                                             22410020
         L     R15,0(R15) .             ADDR HM03                       22440020
         BALR  R14,R15 .                                                22470020
         LR    R9,R8 .                  RESTORE                 SA52971 22500022
         L     R8,AVTSAVE2 .            RESTORE RTN REG                 22710020
         L     R15,AVTSAVE2+4 .         RESTORE                 SA52971 22740022
         AIF   (&A EQ 2).F010A                                          22830020
         TM    QCBDSFLG,QCBCORE .       CORE ALSO                       22860020
         BNO   NOCORE .                 BR NO                           22890020
         NC    QCBCFHDR(3),QCBCFHDR .   IS ONE THERE                    22920020
         BZ    NOCORE .                 BR NO                           22950020
         MVC   AVTSAVE2+61(3),QCBCFHDR . ADDR FIRST IN Q         S21101 22980020
COREFEFO EQU   * .                                                      23010020
         L     R2,AVTSAVE2+60         . MSG HDR                  S21101 23040020
         CLC   PRFCRCD-IEDQPRF(3,R2),QCBLFEFO .                         23070020
*                   IS THIS THE MSG IN CORE TO PUT THE FEFO             23100020
*               PTR IN                                                  23130020
         BE    SETCFEFO .               BR YES                          23160020
         CLC   PRFNHDR-IEDQPRF(,R2),AVTFZERO                    SA51078 23190022
*                                       IS THIS THE LSAT MSG ON Q       23220020
         BE    NOCORE .                                                 23250020
         MVC   AVTSAVE2+61(3),PRFNHDR-IEDQPRF(R2) . NEXTMSG      S21101 23280020
         B     COREFEFO .                                               23310020
SETCFEFO EQU   * .                                                      23340020
         MVC   DATFEFO-IEDQDATA(3,R2),AVTSAVE2+65                S21101 23370020
.F010A   ANOP  , .                                              SA52971 23400022
NOCORE   EQU   * .                                              SA52971 23490022
         L     R2,CPBXREAF .                                            23580020
         MVC   CPBADDR+1(3),QCBLFEFO    FEFO PTR TO WRITE        S21101 23610020
         MVC   DATFLAGS(6),AVTSAVE2+64  SET DATA FIELD OF RECORD S21101 23620020
         BAL   R11,EXCPINQ1 .                                           23730020
SETLFEFO EQU   * .                                                      23760020
         OI    PRFTIC,XBUFFER .         FEFO PTR HAS BEEN DONE          23790020
         MVC   QCBLFEFO(3),AVTSAVE2+65  UPDATE LAST FEFO         S21101 23820020
         AIF   (&A EQ 1).F010B                                   A42400 23830000
         TM    QCBDSFLG,QCBTSQ          TSO QUEUES               S22028 23840222
         BZ    LSTCB                    NO-BRANCH                S22028 23840422
         L     R14,AVTTSOPT             ADDR TSINPUT QCB        SA61768 23840600
         L     R14,TSIDEST-IEDQTSI(R14) ADDR HM STCB            SA61768 23840800
         B     FOUNDHM                  FOUND HM STCB            S22028 23841022
LSTCB    DS    0H                                                S22028 23841222
         L     R14,QCBSTCHN-1           ADDR OF FURST STCB      SA61768 23842000
CLI08    EQU   * .                                               A42400 23844000
         CLI   0(R14),DSPMCPL6          IS THIS HM STCB         SA61768 23846000
         BE    FOUNDHM .                BE YES                   A42400 23848000
         L     R14,4(R14)               ADDR OF NEXT STCB       SA61768 23848400
         B     CLI08 .                  IS THIS IT               A42400 23848800
FOUNDHM  EQU   * .                                               A42400 23849200
         LR    R0,RBASE                 SAVE BASE REG           SA61768 23849600
         LA    RBASE,6(R14)             SET HM BASE             SA61768 23853600
         L     R2,0(R14)                ADDR OF FIND STCA IN HM SA61768 23857652
         BALR  R14,R2                   HM WILL SAVE & REST REGSSA61768 23861652
         LR    RBASE,R0                 RESTORE BASE            SA61768 23865652
.F010B   ANOP                                                    A42400 23869900
         BR    R8 .                                                     23870000
.F011    ANOP                                                           23880020
         TITLE '''IEDQFQ'' - CPB CLEANUP' .                      S22025 23910022
*        CONTROL RECEIVED HERE WHEN CPB'S HAVE BEEN FREED BY DISKS21101 23940020
*        END APPENDAGE AND THE QCB POSTED TO ITSELF, OR A BUFFER        23970020
*        UNIT WAS POSTED BECAUSE AN EARLIER OPEARTION WAS OUT           24000020
*        OF BUFFER UNITS                                                24030020
         SPACE 3                                                        24060020
         DC    C'IEDQFQ' .                                              24090020
IEDQFQ   DS    0H .                                                     24120020
*********************************************************************** 24150020
*                                                                       24180020
*        STCB FOR CPB CLEANUP QCB                                       24210020
*                                                                       24240020
         DC    AL1(DSPMCPL2) .                                          24270020
         DC    X'00' .                                                  24300020
*                                                                     * 24330020
*********************************************************************** 24360020
CPBCLNUP EQU   * .                                                      24390020
         USING *,R15 .                                                  24420020
         L     RBASE,BASE .                                             24450020
         DROP  R15 .                                                    24480020
         USING IEDQCPB,R15 .                                            24510020
         AIF   (&A NE 1).F012                                           24540020
         B     CALLBUFF .                                               24570020
         AGO   .F013                                                    24600020
.F012    ANOP                                                           24630020
         LA    R7,0(R7) .               CLEAR HI                        24660020
         LA    R1,0(R1) .               CLEAR HI                        24690020
         CLR   R1,R7 .                                                  24780020
*            WAS THE ELEMENT POSTED THE QCB                             24810020
         BNE   CALLBUFF .                                               24840020
         MVI   QCBPRI,AVTEZERO .        WET THE NOT POSTED FLAG         24870020
*                                       FOR DISK END APPENDAGE          24900020
         SPACE 3                                                        24930020
*        PUT ANY WRITE CPB'S BACK IN THE FREE POOL, AND PUT READ        24990020
*        CPB'S ON THE ENABLED QUEUE.                                    25020020
         SPACE 3                                                        25050020
EMTYAPPQ EQU   * .                                                      25080020
         LA    R1,AVTDKAPQ .            APP. CPB Q                      25110020
         BAL   R14,DEQMGRC .                                            25170020
         B     APPQEMTY .                IF NONE THERE                  25200020
         EJECT ,                                                 99226  25231022
*                                                                99226  25232022
* WHEN THE CPB COMES BACK FROM APPENDAGE, A TEST IS MADE TO      99226  25233022
* DETERMINE IF THERE WAS A DISK ERROR.  IF SO IT PICKS UP A      99226  25234022
* WTO ROUTINE IN IGG019RC TO HANDLE IT                           99226  25235022
*                                                                99226  25236022
CPBER    EQU   X'01' .                  CPB FLAG FROM DISK ERROR 99226  25237022
         TM    CPBFLAG,CPBER .          DID CPB HAVE I/O ERROR   99226  25238022
         BZ    GOODCPB .                  NO, GOOD CPB           99226  25239022
*                                         YES, I/O ERROR         99226  25240022
         LR    R7,R15 .                 GET CPB FOR WTO          99226  25241022
         L     R15,AVTFL .              GET ADDRESS OF IGG019RC  99226  25242022
         L     R15,4(,R15) .             GET 2ND WORD OF RC      99226  25243022
         BALR  R14,R15 .                CALL DISK ERROR WTO RTN  99226  25244022
*                                                                99226  25245022
         LR    R15,R7 .                 RESTORE CPB BASE         99226  25246022
GOODCPB  EQU   *                                                 99226  25247022
         TM    CPBSEEK,X'80' .          THIS ONE FIXED                  25260020
         BO    PUTONENQ .                                               25290020
         LA    R14,EMTYAPPQ .                                           25320020
         BAL   R11,CKWRITE .                                            25350020
PUTONENQ EQU   * .                                                      25380020
         LA    R2,AVTDKENQ .            ENABLED Q                       25410020
         LA    R11,EMTYAPPQ .            SET RETN ADDR                  25440020
         B     ENQMGRC .                                                25470020
APPQEMTY EQU   * .                                                      25500020
         LA    R1,AVTDKENQ .            ENABLED Q                       25560020
         BAL   R14,DEQMGRC .                                            25590020
         B     CPBSGONE .               IF NONE THERE                   25620020
         TM    CPBFLAG,CPBER            CPB HAVE I/O ERROR      SA61800 25623000
         BZ    GOODCPB1                 BR NO                   SA61800 25626000
         LR    R7,R15                   GET CPB FOR WTO         SA61800 25629000
         L     R15,AVTFL                ADDR OF IGG019RC        SA61800 25632000
         L     R15,4(,R15)              ADDR OF WTO RTN IN 19RC SA61800 25635000
         BALR  R14,R15                  CALL DISK ERROR WTO RTN SA61800 25638000
*                                                               SA61800 25641000
         LR    R15,R7                   RESTORE CPB BASE        SA61800 25644000
GOODCPB1 EQU   *                                                SA61800 25647000
         TM    CPBSEEK,X'80' .          THIS ONE FIXED                  25650020
         LA    R11,CALCKERB .                                           25680020
         BCR   ONES,R11 .                                        S21101 25710020
         LA    R14,APPQEMTY .                                           25740020
         B     CKWRITE .                                                25770020
CPBSGONE EQU   * .                                                      25920020
         SR    R0,R0 .                  CLEAR R0 FOR POST REG           26010020
         B     PROCESS .                                         S21101 26040020
CKWRITE  EQU   * .                                                      26190020
         OI    CPBSEEK,X'80' .          FLAG FIXED                      27000020
         TM    CPBRDWR,CPBWRITB .                                       27090020
*                  IS THIS A WRITE OF ANY KIND                          27120020
         BO    CPBFREEA .                                               27150020
         BR    R11 .                                                    27180020
.F013    AIF   (&A EQ 1).F016                                           27210020
EXCPINQ1 EQU   * .                                                      27240020
         LA    R14,ENQMGRC .            ADDR OF Q MGR                   27270020
         B     EXCPINPT .                                               27300020
.F016    ANOP                                                           27330020
CALLBUFF EQU   * .                                                      27360020
         L     RBASE,ADRFA01 .           RESET BASE REG                 27390020
         DROP  RBASE .                                                  27420020
         USING IEDQFA01,RBASE .                                         27450020
         B     BUFFER .                  AND ADJUST ADDRESSIBILITY      27480020
         DROP  RBASE .                                                  27510020
         USING CPBINIT,RBASE .                                          27540020
         AIF   (&A EQ 1).F017                                           27570020
CALCKERB EQU   * .                                                      27600020
         L     RBASE,ADRFA01 .                                          27630020
         DROP  RBASE .                                                  27660020
         USING IEDQFA01,RBASE .                                         27690020
         B     CKERB .                                                  27720020
TRANSFER EQU   * .                                                      27750020
         MVC   PRFSUNIT-1(0),PRFSUNIT-1-IEDQPRF(R10) .                  27780020
.F017    ANOP                                                           27810020
         USING CPBINIT,RBASE .                                          27840020
         TITLE '''IEDQFA'' - ERB' .                              S22025 27870022
*        AN ERB HAS BEEN POSTED REQUESTING A MESSAGE - THIS SECTION     27900020
*        WILL DETERMINE THE TYPE OF REQUEST, HOW MUCH DATA IS NEEDED    27930020
*        AND WHETHER TO GET IT FROM DISK OR CORE QUEUES.                27960020
         SPACE 3                                                        27990020
ERB      EQU   * .                                                      28020020
         LR    RLCB,RPREFIX .                                           28050020
         SH    RLCB,DCH .                                               28080020
         L     RSCB,LCBSCBA-1           SCB ADDR                SA52971 28090022
         TM    LCBERBST,LCBERROR .      TRANS ERROR ON SEND             28110020
         BNO   NOERROR .                BR IF NO ERROR                  28140020
ERBERROR EQU   * .                                               A44866 28150021
         L     RBASE,ADRFA01 .          SET SECOND BASE REG             28170020
         BAL   R5,FREEBFRS-IEDQFA01(RBASE)                              28200020
*        FREE ATTACHED BFRS IF ANY                                      28230020
ADRTAG   EQU   * .                      LABEL FOR ADDRESSIBILITY        28260020
         L     R2,LCBRCQCB .       SET TO POST THE ERB TO               28290020
         LA    R2,AVTEZERO(R2)          CLEAR HI BYTE           SA54262 28300022
         LA    R1,LCBERB .         THE SPECIFIED QCB                    28320020
         MVI   LCBERBPY,PRIDSPLB-1 .    SET PRIORITY FOR POST    A44866 28350021
         LA    R14,CALLPROC-ADRTAG(R5) .  SET RTN                       28380020
         B     POST-ADRTAG(R5) .        POST THE ERB                    28410020
NOERROR  EQU   *                                                        28440020
         CLI   LCBERBPY,PRIINTRQ .      INITIAL REQUEST          A41025 28480020
         BNE   QTYPSET .                BR NOT INIT              A41025 28490020
         NC    LCBERBCH(3),LCBERBCH .   ANY BFRS THERE           A41025 28492020
         BNZ   QTYPSET .                BR IF BFRS THERE         A41025 28494020
         NI    SCBQTYPE,X'0F' .         CLEAR FOR LATER TEST FOR A41025 28496020
*                                       HDR READ                 A41025 28498020
QTYPSET  EQU   *                                                 A41025 28498420
         MVI   SCBCPBNO,AVTEZERO .                                      28500020
         MVI   SCBNXCPB,EONE .          SET NO OF NEXT CPB TO GET       28530020
         XC    AVTDOUBL(7),AVTDOUBL .    CLEAR WORK AREA                28560020
*        THE ERBPY FIELD WILL SERVE AS A FLAG - IF IT IS NON ZERO       28590020
*        A BUFSIZE MUST BE PLACED IN ERBQB+1.  IF THE KEY               28620020
* IS ZERO THE SIZE IS THERE.                                            28650020
         LA    R7,SZTHERE .             SET RTN ADDR                    28680020
         TM    LCBSTAT1,LCBRCLLN .      IF THIS A RECALL - NOT          28710020
         BCR   ONES,R7 .                TO BE COMPUTED NOW       S21101 28740020
         CLI   LCBERBKY,AVTEZERO .                                      28770020
         BCR   EQUAL,R7 .               BR IF ALREADY DONE       S21101 28800020
         NC    LCBERBCH(3),LCBERBCH .   ARE BUFFERS THERE               28830020
         BCR   ZERO,R7 .                BR IF NO BUFFER YET      S21101 28860020
*              COMPUTE ZIZE YET                                         28890020
         L     RPRF,LCBERBCH-1 .                                        28920020
         B     OFFSET .                 RTN SET ALREADY                 28950020
SZTHERE  EQU   * .                                                      28980020
         OI    LCBERBCT+1,XXCTUSED .    FLAG FOR APPENDAGE              29010020
         IC    R7,LCBERBCT+1 .          DISABLED CT                     29040020
         MVI   LCBERBCT+1,AVTEZERO .    ZERO CT                         29070020
         LA    R7,4096-XXCTUSED(R7) .   CLEAR HI BIT OF LOW BYTE        29100020
         IC    R2,LCBERBCT .            ENABLED CT                      29130020
         AR    R2,R7 .                  ADD CTS                         29160020
         STC   R2,LCBERBCT .            SET NEW CR                      29190020
         L     RSCB,LCBSCBA-1 .                                         29220020
         BAL   R14,FINDESTQ .                                           29250020
         TM    LCBSTAT1,LCBRCLLN .      RECALL ?                        29280020
         BO    RECALL .                 BR YES                          29310020
         AIF   (&A NE 3).F026                                           29340020
         TM    QCBDSFLG,QCBCORE .                                       29370020
*                 IS THERE A CORE COPY                                  29400020
         BNO   DISKONLY .               BR NO                           29430020
.F026    AIF   (&A EQ 2).F027                                           29460020
         TM    LCBERBST,XRDERR .         INIT AND NTXT NOT THERE        29490020
         BO    FIXSCSEG .                                               29520020
         CLI   LCBERBPY,PRISBPCI .     SB PCI REQ                       29550020
         BNE   INITREQ .               BR NO TO GET ALL BFRS            29580020
CKPREV   EQU   * .                                                      29610020
         AIF   (&A NE 1).F026A                                          29640020
         B     CALLFQ .                                                 29670020
         AGO   .F028                                                    29700020
.F026A   ANOP                                                           29730020
         TM    SCBQTYPE,SCBCOREQ .      DID THIS MSG COME FROM CORE     29760020
         BO    CALLFQ .                 BR YES                          29790020
.F027    ANOP                                                           29820020
         SPACE 3                                                        29850020
*        WILL BUILD CPB'S FOR A DISK READ                               29880020
         SPACE 3                                                        29910020
DISKONLY EQU   * .                                                      29940020
         NI    LCBERBST,X'FF'-LCBRDERR ..   RESET ERROR BIY             29970020
         XC    AVTDOUBL+3(5),AVTDOUBL+3 INITIALIZE                      30000020
* TH SCSEG AND SCHDR FIELDS ARE SET BE SND SCH OR GET SCH.  IF A HDR    30030020
*    IS NOT EXPECTED NEXT SCHDR IS NOT INITIALIZED. SCSEG IS ALWAYS     30060020
*    INITIALIZED TO THE NEXT SEG TO READ FOR SCHEDULER                  30090020
         L     R9,SCBSCSEG-1 .          ADDR OF CURRENT SEG             30120020
         LA    R2,1 .                                                   30150020
         TM    SCBQTYPE,X'70' .         IF QTYPE NOT ALREADY SET -      30180020
         BZ    HDRNEXT1 .               A HDR IS EXPECTED NEXT          30210020
         CLC   SCBSCSEG(3),SCBCRCD .    HAS THIS RECORD (IF IT HAS      30240020
*   A PREFIX) BEEN READ BEFORE?     ----  IF THE LAST BFR FILLED        30270020
*   WAS FILLED WITH DATA FROM WITHIN THIS PRFX RECORD AND COMPLETED     30300020
*   A REQUEST - TOO MUCH DATA WILL BE READ  SINCE IT IS OTHERWISE       30330020
*   ASSUMED THAT THE PRFX WAS READ ON A PREVIOUS OPERATION.             30360020
         BE    HDRNEXT .M               BR IF READ TO READ ONLY         30390020
*   THIS RECORD AND NO MORE.                                            30420020
*        SCBCPBNO IS THE NO, OF CPBS BUILT TO READ AND THE NO.          30450020
*        LEFT TO GET FROM APPENDAGE                                     30480020
*        SCBNXCPB IS THE NO. OF THE CPB THAT IS EXPECTED NEXT           30510020
*   CPBBFRNO CONTAINS THE NUMBER FO THE LOGICAL BFR IN WHICH THE        30540020
*        FIRST BYTE OF DATA IN THE UNIT IS TO BE PLACED.                30570020
*   CPBBFRCT CONTAINS THE NUMBER OF THE BYTE IN THE LAST UNIT           30600020
*        OF THE LAST BFR IN WHICH THE FIRST BYTE OF DATA IS PLACED.     30630020
*   CPBWKACT CONTAINS THE NUMBER OF TH BYTE IN THE CPB WORK AREA        30660020
*        WHICH IS TO BE THE FIRST BYTE TRANSFERRED.                     30690020
*   CPBNUMB CONTAINS THE NUMBER OF THE CPB FOR THIS ERB.                30720020
*    AVTDOUBL+3 HAS THE NO. OF UNITS REQUESTED SO FAR                   30750020
*    AVT DOUBL +4 HAS THE NO, OF UNITS IN 1 BFR                         30780020
*   AVTDOUBL+5 HAS WKACT                                                30810020
*     WKACT SHOULD BE 0 EXCEPT FOR FISRT RECALL  , FIRST READ OR SBPCI  30840020
*   AVTDOUBL+6 HAS NUMB                                                 30870020
*   AVTDOUBL+7 HAS BFRNO                                                30900020
*                           SCBUNTCTILL HAVE WHERE IN THE NEXT UNIT     30930020
*        TO BE READ FROM SIDK DATA TRANSFER WILL START.                 30960020
         TM    SCBSTAT1,PRFNLSTN .      LAST SEG                        30990020
         BNO   FIXNTXT .                BR YES                          31020020
FIXED    EQU   * .                                                      31050020
         MVC   AVTDOUBL+5(1),SCBUNTCT .CT OF BYTE TO READ               31080020
         L     R10,LCBDCBPT .           DCB ADDR                        31110020
         MVC   AVTDOUBL+4(1),LCBERBQB . NO UNITS PER BFR                31140020
         NC    LCBERBCH(3),LCBERBCH .   ARE THERE ANY BFRS              31170020
         BZ    TRYNEXT .                BR NO                           31200020
         LA    R6,LCBERBLK-1 .                                          31230020
         L     R14,AVTDOUBL+4 .         GET BFR NO                      31260020
COUNT    EQU   * .                                                      31290020
         NC    PRFLINK(3),PRFLINK .     IS THIS THE LAST BFR            31320020
         BZ    LASTUNIT .               BR YES                          31350020
         L     R6,PRFLINK-1 .           NEXT BFR                        31380020
         AR    R14,R2 .                 ADD 1 TO BFR NO                 31410020
         ST    R14,AVTDOUBL+4 .                                         31440020
         B     COUNT .                                                  31470020
LASTUNIT EQU   * .                                                      31500020
         IC    R14,PRFNBUNT .           NO OF UNITS IS BFR              31530020
         MVI   AVTDOUBL+3,AVTEZERO .    SET NO REQD UNITS TO 0          31560020
         EX    R14,CLINOUNT .           NO IN 1 BFR = NO FOR BFR        31590020
         BE    TRYNEXT .                BR YES                          31620020
         IC    R10,AVTDOUBL+4 .         NO. TO BE PUT IN BFR            31650020
         SR    R10,R14 .                - NO THERE ALREADY              31680020
         BCTR  R10,0 .                  -1                              31710020
         STC   R10,AVTDOUBL+3 .         = NO UNITS REQD SO FAR          31740020
TRYNEXT  EQU   * .                                                      31770020
         BAL   R14,READCPB .                                            31800020
*            RECORED TO BE READ.                                        31830020
*   THE NEXT TEXT IS THE LAST RECORD THAT CAN BE READ UNTIL THE         31860020
*   NEXT PREFIX HAS BEEN READ.  THE NTXT IS ALWAYS A HIGHER VALUE       31890020
*   OF ADDRESS THAN THE ADDITIONAL RECORDS.                             31920020
*   THIS ERB SHOULD BE DROPPED NOW AND BEGIN PROCESSING THE NEXT        31950020
*   ELEMENT.                                                            31980020
         CLC   SCBSCSEG(3),SCBNTXT .    HAS THE NEST TXT BEEN           32010020
*                                         READ                          32040020
         BH    PROCESS .                BR YES(SCSEG=LAST ADDR +1)      32070020
         L     R14,AVTDOUBL .           ADD 1 TO NO UNITS               32100020
         AR    R14,R2 .                 REQUESETD SO FAR                32130020
         ST    R14,AVTDOUBL .                                           32160020
         EX    R14,CLINOUNT .           R14 HAS NO OF UNITS THAT        32190020
*        HAVE BEEN READ - COMPARE TO THE NO. TO READ IN DOUBL+4         32220020
         BNE   TRYNEXT .                BR IF MORE TO READ FOR 1 BFR    32250020
         CLI   LCBERBPY,PRISBPCI .     SB PCI REQ                       32280020
         BE    PROCESS .                BR YES                          32310020
*   IF THIS IS NOT AN INITIAL REQ OF RIRST SUBSEQUENT REQ ONLY          32340020
*   ONE BFR AT A TIME SHOULD BR FILLED.                                 32370020
         L     R14,AVTDOUBL+4 .         ADD 1 TO NO OF BFRS THAT        32400020
         AR    R14,R2 .                 UNITS HAVE BEEN READ FOR        32430020
         ST    R14,AVTDOUBL+4 .                                         32460020
         MVI   AVTDOUBL+3,AVTEZERO .    SET NO UNITS REQD =0 FOR NEW    32490020
         EX    R14,CLIREQ .             HAS THE NO. OF BFRS REQ-        32520020
*        UESTED BEEN FILLED                                             32550020
         BH    TRYNEXT .                BR NO                           32580020
         B     PROCESS ..               BR YES                          32610020
CLIREQ   CLI   LCBERBCT,X'00' .                                         32640020
CLINOUNT CLI   AVTDOUBL+4,X'00' .                                       32670020
READCPB  EQU   * .                                                      32700020
         L     R15,AVTFCPB .             ADDR OF FIRST IF ONE THERE     32730020
         LA    R15,0(R15) .              CLEAR HI BYTE                  32760020
         LTR   R15,R15 .                ANY THERE                       32790020
         BZ    CKENQ .                  BR NO                           32820020
         MVC   AVTFCPB+1(3),CPBNEXT .                                   32850020
         ST    R14,CPBSEEK .            KEEP RTN ADDR                   32880020
         IC    R14,CPBADDR .                                     S21101 32910020
         ST    R9,CPBADDR .             SET ADDRESS              S21101 32920020
         STC   R14,CPBADDR .                                     S21101 32930020
         ST    RLCB,CPBAERBF .          SET LCB ADDR FOR THIS READ      32940020
         IC    R14,SCBCPBNO .           NO OF LAS< CPB                  32970020
         AR    R14,R2 .                 PLUS 1                          33000020
         STC   R14,SCBCPBNO .                                           33030020
         XC    CPBINWKA(5),CPBINWKA .                                   33060020
         STC   R14,CPBNUMB .            SET NUMBER OF CPB               33090020
         LA    R9,INCR(R9) .            ADD FOUR TO REC. NO.     S21101 33120020
         IC    R11,SCBSCSEG-1 .         SAVE HI BYTE                    33150022
         ST    R9,SCBSCSEG-1 .          KEEP REC NO                     33160022
         STC   R11,SCBSCSEG-1 .         RESTORE HI BYTE                 33170022
         MVI   CPBRDWR,CPBRDKC .        READ K & D                      33180020
         MVI   CPBXDWR,CPBRDC .         READ DATA                       33210020
         BAL   R11,EXCPINQ2 .           PUT CPB ON INPUT Q              33240020
         LA    R2,1 .                   RESET R2                        33270020
         L     R14,CPBSEEK .            RESTORE RETURN                  33300020
         BR    R14 .                                                    33450020
.F028    AIF   (&A EQ 1).F029                                           33480020
CKENQ    EQU   * .                                                      33510020
         CLI   SCBCPBNO,AVTEZERO .      HAVE ANY CPBS BEEN GOTTEN       33540020
         BNE   CALLEXCP .               FOR THIS REQ. BR YES            33570020
         LA    R6,LCBERB .              NO - RE-ENQ THE ERB             33600020
         B     ENQUEUE .                                                33630020
.F029    AIF   (&A EQ 1).F033                                           33660020
FIXNTXT  EQU   * .                                                      33690020
*    SINCE THERE IS NO NTXT, THE LAST ADD.REC. WILL BE IN NTXT          33720020
         MVI   AVTDOUBL,AVTEZERO .                                      33750020
         MVC   AVTDOUBL+1(3),SCBXTRA .                                  33780020
         MVC   SCBNTXT(3),SCBCRCD .                                     33810020
         L     R10,AVTDOUBL .                                           33840020
         LTR   R10,R10 .                                                33870020
         BZ    FIXED .                  BR IF NO XTRA RECORDS           33900020
         BAL   R14,SBTRKEY1 .                                           33960020
         SH    R10,CONST .              ADJUST R10               S21101 33990020
         ST    R10,AVTDOUBL .           LAST XTRA FOR NTXT              34020020
         MVC   SCBNTXT(3),AVTDOUBL+1 .                                  34050020
         B     FIXED .                                                  34080020
CONST    DC    H'8' .                   CONSTANT                 S21101 34090020
HDRNEXT1 EQU   * .                                                      34110020
         BAL   R14,READCPB .            GET A CPB                A44895 34140022
         BAL   R14,QTYPE .              SET QTYPE                A44895 34150022
         B     PROCESS .                CONTINUE                 A44895 34160022
HDRNEXT  EQU   * .                                                      34170020
         BAL   R14,READCPB .                                            34200020
         B     PROCESS .                                                34230020
         SPACE 3                                                        34260020
.F033    ANOP                                                           34290020
QTYPE    EQU   * .                                                      34320020
         MVI   SCBUNTCT,AVTEZERO .      SET START CNT TO FIRST          34350020
         AIF   (&A EQ 2).F034                                           34380020
         OI    SCBQTYPE,SCBCOREQ .      SET FLG FOR CORE READ           34410020
         AIF   (&A EQ 1).F035                                           34440020
         TM    QCBDSFLG,QCBCORE .                                       34470020
         BCR   ONES,R14 .                                        S21101 34500020
.F034    ANOP                                                           34530020
QTYPE1   EQU   * .                                                      34560020
         NI    SCBQTYPE,X'0F' .         CLEAR QTYPE                     34590020
         OI    SCBQTYPE,SCBREUS .       ASSUME REUS DISK                34620020
         TM    QCBDSFLG,QCBREUS .                                       34650020
         BCR   ONES,R14 .                                        S21101 34680020
         XI    SCBQTYPE,SCBREUS+SCBNREUS .                              34710020
.F035    ANOP                                                           34740020
         BR    R14 .                                                    34770020
         AIF   (&A EQ 2).F036                                           34800020
*        WILL INITIALIZE TO GET A MESSAGE FROM A CORE Q                 34830020
         SPACE 3                                                        34860020
INITREQ  EQU   * .                                                      34890020
         TM    SCBQTYPE,X'70' .         HAS QTYPE BEEN SET ALREADY -    34920020
         BNZ   CKPREV .                 BR YES - ONE READ DONE FOR      34950020
*        THIS MSG LAREADY                                               34980020
         OI    SCBQTYPE,SCBCOREQ        ASSUME CORE             SA59522 35010000
         AIF   (&A NE 1).F035A                                          35040020
         B     CALLFQ .                                                 35070020
         AGO   .F036                                                    35100020
.F035A   ANOP                                                           35130020
         TM    QCBDSFLG,QCBREUS+QCBNREUS . ANY DISK                     35160020
         BZ    CALLFQ .                 BR NO                           35190020
         MVC   AVTDOUBL+1(3),QCBCFHDR . YES- FIND CORE COPY OF MSG      35220020
COMPARE  EQU   * .                                                      35250020
         NC    AVTDOUBL+1(3),AVTDOUBL+1 . LAST MSG                      35280020
         BZ    NOMSG .                  BR YES                          35310020
         L     R2,AVTDOUBL .            ADDR THIS MSG                   35340020
         CLC   SCBSCHDR(3),PRFCRCD-IEDQPRF(R2) .                        35370020
*                  IS THIS THE MSG  TO SEND                             35400020
         BE    LOSTMSG1 .               TO CHECK FOR LOST MSG           35430020
         MVC   AVTDOUBL+1(3),PRFNHDR-IEDQPRF(R2) .  NEXT MSG            35460020
         B     COMPARE .                                                35490020
LOSTMSG1 EQU   * .                                                      35520020
         TM    DATFLAGS-IEDQDATA(R2),DATLOSTN .  LOST MSG               35550020
         BNO   RESETSCH .               BR NOT LOST TO GET FROM CORE    35580020
*        OTHERWISE FREE MSG FROM CORE Q AND SET TO READ FROM DISK       35610020
         LR    R6,R2 .                  SET FAKE BFR ADDR               35640020
         L     R15,ADFREEMS .           BASE FOR SUBR                   35670020
         BAL   R7,HAVEADDR-FREEMSG(R15) .   ENTRY PT FOR THIS           35700020
         L     RSCB,LCBSCBA-1 .         RESTORE SCB ADDR                35730020
         L     R7,SCBDESTQ-1 .          RESTORE QCB ADDR                35760020
NOMSG    EQU   * .                                                      35790020
         NI    SCBQTYPE,X'FF'-SCBCOREQ  RESET CORE BIT          SA62976 35820005
         XC    AVTDOUBL(6),AVTDOUBL .   CLEAR WORK AREA                 35850020
         L     R9,SCBSCSEG-1 .                                          35880020
         LA    R2,1 .                                                   35910020
         BAL   R14,READCPB              GET A CPB               SA59522 35940000
         BAL   R14,QTYPE1               SET QUING MEDIUM        SA59522 35950000
         B     PROCESS                  PROCESS NEXT ELEMEMT    SA59522 35960000
.F036    ANOP                                                           35970020
RECALL   EQU   * .                                                      36000020
         MVC   SCBSCSEG(3),SCBDEOB+1 .  SET FIELDS FROM RECALL          36030020
         ST    R7,AVTDOUBL .            SAVE R7                         36060020
         IC    R7,SCBDEOB .             TO LOOK NORMAL                  36090020
         STC   R7,SCBUNTCT .                                            36120020
         LA    R7,NOSIZE .                SET RTN ADDR                  36150020
         TM    LCBSTAT1,LCBRECVN .      RECV SIDE                       36180020
         BCR   ONES,R7 .                BR YES - RECALL BFR THAT S21101 36210020
*                                       IS THERE - DO NOT CHANGE S21101 36220020
*                                       THE DSIZE                S21101 36230020
*        THERE - DO NOT CHANGE THE DSIZE                                36240020
         TM    LCBCHAIN,LCBBFRSZ .      SPECIAL BD RECALL               36270020
         BCR   ONES,R7 .                                         S21101 36300020
         CLI   LCBERBKY,AVTEZERO .     HAS SIZE BEEN COMPUTED           36330020
         BNE   USELCB .                 SEND REQUEST                    36360020
NOSIZE   EQU   * .                                                      36390020
         L     R7,AVTDOUBL .            RESET R7                        36420020
         TM    SCBQTYPE,X'F0' .         IS THIS A FIRST RECLL           36450020
         BZ    FIRSTRCL .               FROM ANYBODY BUT BT             36480020
         NC    LCBERBCH(2),LCBERBCH .   ANY BFRS THEER                  36510020
         AIF   (&A NE 2).F037                                           36540020
         BNZ   DISKONLY .                                               36570020
         AGO   .F037A                                                   36600020
.F037    ANOP                                                           36630020
         BNZ   CKPREV .                 BR YES - ONE READ DONE          36660020
.F037A   ANOP                                                           36690020
         AIF   (&A EQ 1).F038A                                          36720020
         AIF   (&A EQ 2).F038                                           36750020
         TM    SCBQTYPE,SCBCOREQ .                                      36780020
         BNO   OKREUS .                 BR NOT CORE                     36810020
*        THIS IS A FIRST RECALL FROM BT                                 36840020
.F038A   ANOP                                                           36870020
         TM    LCBSTAT1,LCBSENDN .      SENDING                         36900020
         BO    BTSEND .                 BR YES - ADDR OF HDR IS THERE   36930020
         AIF   (&A NE 3).F038B                                          36960020
         TM    QCBDSFLG,QCBREUS+QCBNREUS .  ANY DISK                    36990020
         BNZ   NOMSG .                  RECALL ON RCV SIDE - GET        37020020
*     FROM DISK                                                         37050020
.F038B   ANOP                                                           37080020
         MVC   SCBSCHDR(3),SCBCCHDR .   GET ADDR OF HDR                 37110020
BTSEND   EQU   * .                                                      37140020
         L     R2,SCBSCSEG-1 .          ADDR OF UNIT TO GET             37170020
         TM    DATFLAGS-IEDQDATA(R2),DATNPRFX . DOES IT HAVE PRFX       37200020
         BNO   CALLFQ .                                                 37230020
         L     R6,SCBSCHDR-1 .          HDR ADDR                        37260020
BTTIC    EQU   * .                                                      37290020
         LR    R2,R6 .                  SET FOR LOOP TO FIND PRFX THAT  37320020
         B     BTTIC2 .                 GOES WITH THIS EXTRA UNIT       37350020
BTTIC1   EQU   * .                                                      37380020
         L     R2,PRFTIC-IEDQPRF(R2) .  ADDR NEXT UNIT                  37410020
BTTIC2   EQU   * .                                                      37440020
         NC    PRFTIC+1-IEDQPRF(2,R2),PRFTIC+1-IEDQPRF(R2) . MORE THERE 37470020
         BZ    BTBFR .                  BR NO TO GET NEXT BFR           37500020
         CLC   PRFTIC+1-IEDQPRF(3,R2),SCBSCSEG . THIS IT                37530020
         BNE   BTTIC1 .                 BR IF NOT THE ONE               37560020
         LH    R2,SCBSCAN .             SAVE SEQ OUT NO                 37590020
         MVC   SCBSRCE(PRFSTXT-PRFSRCE),PRFSRCE .  SET PRFX FOR BFR     37620020
         STH   R2,SCBSCAN .             SAVE SEQ OUT NO                 37650020
         OI    SCBSTAT1,PRFNHDRN .      INSURE NOT A HDR BFR            37680020
         B     CALLFQ .                                                 37710020
BTBFR    EQU   * .                                                      37740020
         MVC   AVTDOUBL+1(3),PRFNTXT .  GET NEXT BFR IN QUEUE           37770020
         L     R6,AVTDOUBL .                                            37800020
         B     BTTIC .                                                  37830020
         AGO   .F039                                                    37860020
.F038    ANOP                                                           37890020
         B     OKREUS .                                                 37920020
.F039    ANOP                                                           37950020
FIRSTRCL EQU   * .                                                      37980020
         AIF   (&A NE 1).F040                                           38010020
         OI    SCBQTYPE,SCBCOREQ .                                      38040020
         B     CKTHERE .                                                38070020
         AGO   .F040A                                                   38100020
.F040    ANOP                                                           38130020
         LA    R1,QCBDSFLG .            ASSUME NOT BD                   38160020
         LA    R2,X'10' .               SET CC FOR EX BRANCH            38190020
         TM    LCBCHAIN,LCBBFRSZ .      BD RCLL                         38220020
         BNO   NOTBD .                  BR NO                           38250020
         LA    R1,SCBHBFNO .            SET TO TEST DCB NOT QCB         38280020
         LA    R2,X'80' .               SET CC FOR BR                   38310020
NOTBD    EQU   * .                                                      38340020
         AIF   (&A EQ 2).F039A                                          38370020
         OI    SCBQTYPE,SCBCOREQ .      SET FOR CORE RECALL             38400020
         TM    0(R1),QCBREUS+QCBNREUS .   ANY DISK                      38430020
         BZ    CKTHERE .                                                38460020
PUTRET   EQU   *                                               @SA69655 38470061
         NI    SCBQTYPE,X'FF'-SCBCOREQ .SET NOT CORE                    38490020
.F039A   ANOP                                                           38520020
         OI    SCBQTYPE,SCBREUS .       SET RES DISK                    38550020
         TM    0(R1),QCBREUS .                                          38580020
         AIF   (&A NE 3).F039A1                                @OZ14195 38587000
BRNCHQ   EQU   *                                               @OZ14195 38594000
.F039A1  ANOP                                                  @OZ14195 38601000
         EX    R2,BRANCH .                                              38610020
         XI    SCBQTYPE,SCBREUS+SCBNREUS .                              38640020
OKREUS   EQU   * .                                                      38670020
         L     R9,SCBSCSEG-1 .           RECORD TO READ                 38700020
         LA    R2,1 .                   INITIALIZE R2 FOR ADDS          38730020
         MVC   AVTDOUBL+5(1),SCBDEOB .                                  38760020
         B     HDRNEXT .                                                38790020
BRANCH   NOP   OKREUS .                 COND CODE FILLED BY EX   S21101 38820020
.F040A   ANOP                                                           38850020
         AIF   (&A EQ 2).F040B                                          38880020
CKTHERE  EQU   * .                                                      38910020
         AIF   (&A EQ 1).F040A1                                @SA69655 38916061
         CLI   QCBDSFLG,QCBFQCB         PUT PROCESS ENTRY      @SA69655 38922061
         BE   PUTRET                   NO, BRANCH              @SA69655 38928061
         NC    LCBTTCIN,LCBTTCIN        TTCIN ZERO?            @OZ14195 38928500
         BNZ   CALLFQ                   NO                     @OZ14195 38929000
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OZ14195 38929500
         BO    CALLFQ                   YES                    @OZ14195 38930000
         TM    LCBCHAIN,LCBBFRSZ        BD RECALL              @OZ30296 38930182
         BO    CALLFQ                   YES, BRANCH            @OZ30296 38930282
*        THIS CODE WILL ALLOW THE CAPABILITY TO RETRIEVE A     @OZ14195 38930500
*        MESSAGE BY INPUT SEQUENCE NUMBER FOR A TERMINAL THAT  @OZ14195 38931000
*        IS CORE QUEUED.                                       @OZ14195 38931500
         OI    SCBQTYPE,SCBREUS         SET REUS               @OZ14195 38932000
         NI    SCBQTYPE,AVTEFF-SCBCOREQ TURN OFF CORE BIT      @OZ14195 38932500
         TM    SCBSCSEG+TWO,CPBQTYPE    CHECK TYPE OF QUEUES   @OZ14195 38933000
         B     BRNCHQ                   GO SET APPROPRIATE BIT @OZ14195 38933500
.F040A1  ANOP                                                  @SA69655 38934061
CALLFQ   EQU   * .                                                      38940020
         L     RBASE,ADRFA01 .                                          38970020
         B     CALLFQA-IEDQFA01(RBASE) .                                39000020
.F040B   ANOP                                                           39030020
         AIF   (&A NE 3).F040C                                          39060020
RESETSCH EQU   * .                                                      39090020
         L     RBASE,ADRFA01 .                                          39120020
         B     RESETA-IEDQFA01(RBASE) .                                 39150020
.F040C   ANOP                                                           39180020
ADRFA01  DC    A(IEDQFA01) .                                            39210020
EONE     EQU   X'01' .                                                  39240020
BASE     DC    A(CPBINIT) .                                             39270020
         DROP  RBASE .                                                  39330020
         TITLE '''IEDQFA'', ''IEDQFQ'' - COMMON SUBROUTINES' .   S22025 39340022
         USING *,RBASE .                                                39360020
*        THIS SPECTION IS A GOUUP OF COMMON SUBROUTINES USED BY         39390020
*        BOTH SECTIONS OF CODE.                                         39420020
         SPACE 3                                                        39450020
IEDQFA01 EQU   * .                                                      39480020
         AIF   (&A EQ 1).F018                                           39510020
CPBFREE  EQU   * .                                                      39540020
         LA    R14,GOAPQEMT .            SET RTN ADDR                   39570020
*    WILL FREE CPB - NO CHECKING - RETURN                               39600020
CPBFREEA EQU   * .                                                      39630020
         L     R1,AVTFCPB .             LINK CPB INTO THE               39660020
         ST    R15,AVTFCPB .            CPB FREE POOL                   39690020
         ST    R1,CPBNEXTF .                                            39720020
         MVI   CPBFLAG,AVTEZERO .       ZERO ALL FLAGS                  39750020
         BR    R14 .                    RETURN                          39780020
.F018    ANOP                                                           39810020
ENQMGRB  EQU   * .                                                      39840020
         BALR  R14,0 .                                                  39870020
         USING *,R14 .                                           S21101 39900020
         L     R14,ADENQMGR .                                           39930020
         BR    R14 .                                                    39960020
         DROP  R14 .                                             S21101 39990020
OFFSET   EQU   * .                                                      40020020
         BALR  R15,0 .                  SET ADDRESSIBLITY               40050020
         USING *,15 .                                                   40080020
         L     R15,ADROFFST .           ADDR OF SUBROUTINE              40110020
         BR    R15 .                                                    40140020
USELCB   EQU   * .                                                      40170020
         BALR  R15,0 .                  SET ADDRESSIBLITY               40200020
         USING *,15 .                                                   40230020
         L     R15,ADROFFST .           ADDR OF SUBROUTINE              40260020
         USING IEDQCPB,R15 .                                            40290020
         B     USELCBA-OFFSETA(R15) .                                   40320020
         AIF   (&A EQ 1).F040D                                          40350020
ENQMGRC  EQU   * .                                                      40380020
         BALR  R14,0 .                                                  40410020
         USING *,R14 .                                           S21101 40440020
         L     R14,ADMGRX .                                             40470020
         BR    R14 .                                                    40500020
         DROP  R14 .                                             S21101 40530020
ADMGRX   DC    A(ENQMGRCA) .                                            40560020
.F040D    ANOP                                                          40590020
ADROFFST DC    A(OFFSETA) .                                             40620020
ADENQMGR DC    A(ENQMGRBA) .                                            40650020
DCH      DC    AL2(LCBERB-IEDQLCB) .                                    40680020
TAG1     EQU   * .                                                      40710020
         AIF   (&A NE 1).F030                                           40740020
         B     CALPROC1 .                                               40770020
         AGO   .F032                                                    40800020
.F030    AIF   (&A EQ 2).F031                                           40830020
         L     RSCB,LCBSCBA-1 .         SCB ADDRESS                     40860020
         TM    SCBQTYPE,SCBCOREQ .      FROM CORE                       40890020
         BO    CALPROC1 .               BR YES                          40920020
.F031    ANOP                                                           40950020
GOAPQEMT EQU   * .                                                      40980020
         L     RBASE,BASE1 .            SET NEW BASE                    41010020
         B     APPQEMTY-CPBINIT(RBASE) .                                41040020
.F032    ANOP                                                           41070020
CALLPROC EQU   * .                                                      41100020
         L     RSCB,LCBSCBA-1 .                                         41130020
CALPROC1 EQU   * .                                                      41160020
         L     RBASE,BASE1 .                                            41190020
         DROP  RBASE .                                                  41220020
         USING CPBINIT,RBASE .                                          41250020
         SR    R0,R0 .                  CLEAR R0 FOR POST REG           41280020
         B     PROCESS .                                                41310020
         DROP  RBASE .                                                  41340020
         USING IEDQFA01,RBASE .                                         41370020
.F032A   ANOP                                                           41400020
UNITFREE EQU   * .                                                      41430020
*        WILL POST A UNIT TO THE AVAILABLE BFR QUEUE                    41460020
         MVI   PRFNBUNT-IEDQPRF(R1),X'01' .SET NO. UNITS                41490020
         MVI   PRFTIC-IEDQPRF(R1),CPBTICC .                             41520020
RTNBFR   EQU   * .                                                      41550020
         LA    R2,AVTBFRTB .            ADDR OF BFR RTN QCB             41580020
         MVI   PRFPRI-IEDQPRF(R1),PRIBFRTB .PRIORITY                    41610020
POST     EQU   * .                                                      41640020
         ST    R2,PRFQCBA-1-IEDQPRF(R1) FOR POST                        41670020
NOSTORE  EQU   * .                                                      41700020
         LA    R0,0(R1) .               DEEP ADDR LAST ELEM POSTED      41730020
         L     R11,AVTEA .                                              41760020
         B     DSPPOSTR .               POST AND RETURN                 41790020
         AIF   (&A EQ 1).F019                                           41820020
EXCPINQ2 EQU   * .                                                      41850020
*        WILL ENQUEUE A CPB ON THE FIFO EXCP INPUT Q                    41880020
         BALR  R14,0 .                                                  41910020
         USING *,R14 .                                                  41940020
         L     R14,ADMGRCC .                                            41970020
         DROP  R14 .                                                    42000020
EXCPINPT EQU   * .                                                      42030020
         LA    R2,AVTINCPQ .            EXCP DRIVER INPUTQ              42060020
         LR    R1,R15 .                 CPB ADDR IN 1                   42090020
         BR    R14 .                                                    42120020
ADMGRCC  DC    A(ENQMGRC) .                                             42150020
.F019    ANOP                                                           42180020
*        WILL BRANCH TO EXCP DRIVER IF ANY DISK OR DSPDISK OF NOT       42210020
CALLEXCP EQU   * .                                                      42240020
         AIF   (&A EQ 1).F020                                           42270020
         BALR  R14,0 .                  SET ADDRESSIBILITY              42300020
         USING *,R14 .                                                  42330020
         AIF   (&A EQ 2).F019A                                          42360020
         TM    AVTBIT1,AVTDISKN .       DISK SPEC.                      42390020
         BZ    NOFL .                   BR NO                           42420020
.F019A   ANOP                                                           42450020
         ICM   R15,AD,AVTFL+1           IS DISK OPENED           Y02027 42480006
*        IF YES                                                         42600020
         BCR   NOTZERO,R15 .                                     S21101 42630020
*        IS NO                                                          42660020
NOFL     EQU   * .                                                      42690020
.F020    ANOP                                                           42720020
         L     R11,AVTEA .                                              42750020
         B     DSPDISP .                                                42780020
         AIF   (&A EQ 1).F021                                           42810020
         DROP  R14 .                                                    42840020
.F021    ANOP                                                           42870020
FINDLVL  EQU   * .                                              SA52971 42874022
*** THIS SUBROUTINE DESTROYS REGS 0,1,2, AND 11.  THE QCB       SA52971 42878022
*   EXTENSION IS RETURNED IN REG2.  RETURN IS TO +0 IF THIS     SA52971 42882022
*   IS NOT A CONCENTRATOR AND TO +4 IF IT IS A CONCENTRATOR.    SA52971 42886022
         TM    SCBQTYPE,SCBCONC .       IS THIS A CONCENTRATOR  SA52971 42890022
         BCR   8,R10 .                  BR IF NOT               SA52971 42894022
         LH    R2,QCBEXTO .             EXT OFFSET               S22026 42900022
         AR    R2,RQCB .                QCBE ADDR                S22026 42901022
         TM    QCBEFLG-IEDQQCBE(R2),QCBEOPL .                    S22026 42902022
*                                       PRTY LEVEL QUEUEING      S22026 42903022
         BZ    4(,R10) .                BR IF CONC              SA52971 42904022
         SR    R0,R0 .                  ZERO IC REG             SA52971 42905022
         LA    R11,QCBMEND-QCBPSIZE .   INIT TO ZEROETH PRI QCB SA52971 42906022
         BALR  R1,AVTEZERO .            SET LOOP POINT          SA52971 42907022
         SPACE 1 .                                              SA52971 42908022
         IC    R0,QCBELGTH-IEDQQCBE(,R2) GET EXTENSION LENGTH   SA52971 42909022
         AR    R2,R0 .                  POINT TO NEXT EXTENSION SA52971 42910022
         LA    R11,QCBPSIZE(,R11) .     POINT TO NEXT PRI QCB   SA52971 42911022
         CLR   R11,RPQ .                IS THIS THE ONE         SA52971 42912022
         BCR   7,R1 .                   NO, GO LOOK AT NEXT     SA52971 42913022
         B     4(,R10) .                RETURN TO +4            SA52971 42914022
FINDESTQ EQU   * .                                              SA52971 42915022
*        WILL FIND THE ADDRESS OF BOTH THE MASTER AND PRTY LVL QCBS     42930020
         L     RQCB,SCBDESTQ-1 .        ADDR OF QCB                     42960020
         SR    R11,R11 .                                                42990020
         IC    R11,SCBPRI .              OFFSET TO PRTY QCB             43020020
FINDEST2 EQU   * .                                                      43050020
         LA    RPQ,QCBMEND-IEDQQCB(RQCB) .                              43080020
*              ADDR OF FIRST PRTY QCB                                   43110020
         LTR   R11,R11 .                IS THERE MORE THAN ONE          43140020
         BCR   ZERO,R14 .               BR NO                    S21101 43170020
         LA    R1,QCBPEND-IEDQPQCB .    SIZE OF A PQCB                  43200020
         MR    R10,R1 .                 SIZE X NUMBER                   43230020
         AR    RPQ,R11 .                ADDR OF THIS PQCB               43260020
         BR    R14 .                                                    43290020
*        WILL DEQUEUE AND ELMENT FROM A FIFO Q                          43320020
         AIF   (&A EQ 1).F025                                           43350020
DEQMGRC  EQU   * .                                                      43380020
*        IN PUT PARAMETERS - R1 - Q ADDR                                43410020
*        RETURN WILL BE AT R14 IF NONE OR 4(R14) IF ONE THERE           43440020
         DROP  RBASE                                                    43470006
         USING CPBINIT,RBASE                                            43480006
         TS    AVTEZERO(R1)             LOCK Q FOR UPDATE        Y02027 43490006
         BNE   DEQMGRC                  YES, LOOP TILL APP. DONE Y02027 43500006
         ICM   R15,AD,1(R1)             ADDR OF FIRST ON Q       Y02027 43510006
         BNZ   DEQMGRC1                 ELEMENT ON Q             Y02027 43520006
         MVI   AVTEZERO(R1),AVTEZERO    CLEAR Q LOCK             Y02027 43530006
         BR    R14                      RETURN                   Y02027 43540006
DEQMGRC1 EQU   *                                                 Y02027 43550006
         DROP  RBASE                                                    43560006
         USING IEDQFA01,RBASE                                           43570006
         MVC   1(3,R1),CPBNEXT .        DELINK THE CPB                  43590020
         MVI   AVTEZERO(R1),AVTEZERO    CLEAR Q LOCK             Y02027 43600006
         B     4(R14) .                 RETURN TO +4 IF ONE THERE       43620020
SBTRKEY1 EQU   * .                                                      43650020
         LH    R1,SCBSIZE .             GET SIZE                        43680020
.F025    ANOP                                                           43710020
SUBTRKEY EQU   * .                                                      43740020
         BALR  R11,0 .                  SET ADDRESSIBILITY              43770020
         LA    R10,INCR(0,R10) .          INCREASE ADDRESS       S21101 43800020
         SH    R1,AVTKEYLE .            SUBTR. KEY LENGTH FROM SIZE     43830020
         BCR   PLUS,R11 .               BR IF PLUS TO SUBRT      S21101 43860020
         BR    R14 .                    BR IF ALL UNITS HAVE BEEN COUNT 43890020
         AIF   (&A EQ 2).F051 .                                 SA52971 43893022
ADFREEMS DC    A(FREEMSG) .             ADDR OF SUBROUTINE      SA52971 43896022
.F051    ANOP  , .                                              SA52971 43899022
*                                                               SA52971 43902022
*   END OF COMMON AREA                                          SA52971 43905022
*                                                               SA52971 43908022
         DC    40A(0)        XXXXXXXXXX PATCH AREA XXXXXXXXXXX @OZ09304 43914000
         TITLE '''IEDQFQ'' - CPB CLEANUP' .                      S22025 43920022
         AIF   (&A EQ 1).F041A                                          43950020
*        THIS SECTION DEALS WITH A CPB FROM A DISK READ.  IT HANDLES    44160020
*        ERROR CONDITIONS AND GETTING CPB'S OUT OR ORDER.               44190020
         SPACE 3                                                        44220020
CKERB    EQU   * .                                                      44250020
         L     RLCB,CPBAERBF .          ADDR OF ERB ASSOCIATED          44280020
*                                       WITH THIS READ                  44310020
         L     RSCB,LCBSCBA-1 .                                         44340020
         LNR   R2,R2 .                 SET FLAG FOR FREE CPB            44370020
         TM    LCBERBST,XCOMPL .                                        44400020
*                   HAS THIS REQUEST BEEN COMPLETED PREVIOUSLY          44430020
         BO    ERBCPB .                                                 44460020
         TM    LCBERBST,XXXINQ .        IS THIS ERB WAITING FOR BFR     44490020
         BO    NOBFRQ                   YES-PLACE CPB ON NOBFQ  SA52984 44520022
         CLC   CPBNUMB(1),SCBNXCPB .                                    44550020
         BE    CPBCK                    IF NEXT ONE GO AHEAD    SA52984 44553022
TSLOOP   EQU   *                                               @OZ09304 44556000
         TS    AVTDKENQ                 FIELD BEING USED       @OZ09304 44556700
         BNZ   TSLOOP                   YES, BRANCH AND LOOP   @OZ09304 44557400
         LA    R2,AVTDKENQ-(CPBNEXTF-IEDQCPB)  SET ADDRESS FOR @OZ09304 44559000
*                                        START OF LOOP         @OZ09304 44559700
         ICM   R15,EIGHT,AVTDKENQ       INSERT IN USE BYTE     @OZ09304 44560400
SEARCHLP EQU   *                                                SA52984 44562022
         LR    R14,R2                   SET TO NEXT CPB         SA52984 44565022
SRCHLP   EQU   *                                                 Y02027 44568006
         ICM   R2,AD,CPBNEXT-IEDQCPB(R14) IS THIS THE LAST CPB   Y02027 44571006
         BNZ   CPBCK1                   IF NOT-CHECK THIS ONE   SA52984 44574022
         MVI   AVTDKENQ,AVTEZERO        FREE FIELD             @OZ09304 44577000
         LA    R2,AVTDKAPQ .                                            44580022
         L     R14,AENQMGR .            ADDR OF Q MGR            S22026 44582022
         BALR  R11,R14                  ENQ CPB                  Y02027 44583006
         B     GOAPQEMT .                                               44585022
CPBCK1   EQU   *                                                SA52984 44586022
         L     R2,CPBNEXTF-IEDQCPB(R14) NEXT CPB                SA52984 44587022
         TM    CPBRDWR-IEDQCPB(R2),CPBWRITB  IS IT WRITE CPB    SA52984 44588022
         BO    SEARCHLP                 YES                     SA52984 44589022
         CLC   CPBAERB(3),CPBAERB-IEDQCPB(R2) SAME LCB          SA52984 44590022
         BNE   SEARCHLP                 NO-GET NEXT ONE         SA52984 44591022
         CLC   SCBNXCPB(1),CPBNUMB-IEDQCPB(R2)  NEXT THIS LCB   SA52984 44592022
         BNE   SEARCHLP                 NO-GET NEXT ONE         SA52984 44593022
         ICM   R15,EQUAL,CPBNEXTF-IEDQCPB(R14)  SAVE HIGH BYTE @OY20265 44593582
         CS    R2,R15,CPBNEXTF-IEDQCPB(R14)  REPLACE THIS CPB  @OS79957 44594082
*                                        WITH NEXT FOR THIS LCB@OS79957 44594182
         BNE   SRCHLP                   CS FAILED, RECHAIN     @OS79957 44594282
         XC    CPBNEXT-IEDQCPB(3,R15),CPBNEXT-IEDQCPB(R15)     @OS79957 44594382
*                                       CLEAR LINK POINTER     @OS79957 44594482
         OC    CPBNEXT(3),CPBNEXT-IEDQCPB(R2)  GET NEW LINK PTR@OS79957 44594582
         BNZ   END                      BR IF NOT LAST IN CHAIN@OS79957 44594682
         STCM  R15,AD,AVTDKENQ+FIVE     SET NEW LAST           @OS79957 44594782
END      EQU   *                                               @OS79957 44595282
         MVI   AVTDKENQ,AVTEZERO        FREE FIELD             @OZ09304 44596500
         LR    R15,R2                   NEW CPB TO PROCESS      SA52984 44597022
CPBCK    EQU   *                                                SA52984 44598022
         L     R2,CPBXREAF .                                            44610020
         TM    DATFLAGS,DATNPRFX .                                      44640020
         BO    CKRECNO .                                                44670020
         CLC   CPBADDR+1(3),PRFCRCD-IEDQPRF(R2) .                       44700020
*                 WAS THERE A LOGICAL READ ERROR                        44730020
         BNE   RDERROR .                BR YES                          44760020
CKEOB    EQU   * .                                                      44790020
         TM    LCBERBST,LCBERROR+LCBRDERR .                             44820020
*        READ ERROR OR LINE ERROR                                       44850020
         BNZ   ANYBFRS .                BR IF EITHER                    44880020
         B     NEXTCPB .                BR TO PROCESS THIS CPB          44910020
AENQMGR  DC    A(ENQMGRCA) .            ADDR OF Q MGR            S22026 45130022
CKRECNO  EQU   * .                                                      45150020
         CLC   CPBADDR+1(3),DATFEFO .                                   45180020
         BE    CKEOB .                                                  45210020
.F041A   ANOP                                                  @OX20639 45220082
RDERROR  EQU   * .                                                      45240020
         OI    LCBERBST,XRDERR .        SET RDERR FLAG                  45270020
ANYBFRS  EQU   * .                                                      45300020
**    SET FLAG TO UPDATE ONLY THE CPB COUNT OF ALL SCB FIELDS           45330020
         LNR   R2,R2 .                 SET FLAG                         45360020
         MVC   SCBSCSEG(3),CPBADDR+1 .  SET FOR NEXT READ IF INIT       45390020
         BAL   R14,FREECPBA .                                           45420020
         TM    LCBSTAT1,LCBINITN .                                      45450020
         BNO   NOTINIT .                BR IF NOT INIT                  45480020
         TM    LCBERBST,LCBERROR .      LINE ERROR ON SEND              45510020
         BO    NOTINIT .                BR YES                          45540020
         AIF   (&A EQ 1).F041B                                 @OX20639 45550082
         LA    R14,GOAPQEMT .           SET RTN ADDR                    45570020
.F041B   ANOP                                                  @OX20639 45580082
INITPOST EQU   * .                                                      45630020
         MVI   LCBERBKY,XCTZERO   .     SET FIRST BYTE OF ERB    S21101 45640020
*                                 .     NON ZERO SO HM WILL KNOW S21101 45650020
*                                 .     NOT TO POST              S21101 45652020
         TM    LCBERBST,XXHMSG .        EOM RCVD IN HM YET              45660020
         BCR   14,R14 .                 BR IF NO TO DROP ERB            45690020
         LA    R2,AVTDSIOB .            ADDR TO POST ERB TO FA          45720020
         LA    R1,LCBERB .                                              45750020
         CLI   LCBERBPY,PRIINTRQ .      INITIAL REQUEST                 45780020
         BE    POST .                   YES - LEAVE THE PRTY            45810020
         MVI   LCBERBPY,PRISBPCI .      SET LOW PRTY                    45840020
         B     POST .                   POST ERB TO FA                  45870020
NOTINIT  EQU   * .                                                      45930020
         BAL   R5,FREEBFRS .                                            45960020
         AIF   (&A EQ 1).F041C                                 @OX20639 45970082
         LA    R14,GOAPQEMT .                                           45990020
.F041C   ANOP                                                  @OX20639 46000082
         LA    R1,LCBERB .                                              46020020
         L     RSCB,LCBSCBA-1           SCB ADDRESS             SA61767 46022000
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 46025022
         BZ    CHKRCALL .               BRANCH IF NO             S22026 46030022
         TM    LCBERBST,LCBERROR .      LINE ERROR               S22026 46035022
         BO    POSTERR .                BRANCH IF YES            S22026 46040022
CHKRCALL EQU   * .                                               S22026 46045022
         TM    LCBSTAT1,LCBRCLLN .      RECALL                          46050020
         BO    ERBRCQCB .               BR YES                          46080020
POSTERR  EQU   * .                                               S22026 46090022
         MVI   LCBERBPY,PRIDSPLB-1 .    POST WITH LOWER PRTY            46110020
         TM    LCBERBST,LCBERROR .      LINE ERROR                      46140020
         BO    ERBRCQCB .               BR YES TO RETURN ERB            46170020
*        IS RECALL ERB SHOULD BE POSTED TO RCQCB WITH NO BFRS           46200020
*        IS NOT RECALL POST AN EOM BFR TO MH WITH ERR BITS SET          46230020
         LA    R15,ABCODE3 .           SET 15 TO ABEND CODE             46260020
         BAL   R14,AVTABEND .          SET 14 TO ADDR OF ABEND          46290020
*        AND GO TO THE RTN TO ABEND                                     46320020
ABCODE3  EQU   X'03' .                 LOGICAL READ ERROR               46350020
         EJECT                                                          46410020
*        THIS SECTION DEALS WITH A CPB UNIT THAT IS THE NEXT READ       46440020
*        EXPECTED OR A CORE UNIT.                                       46470020
         SPACE 3                                                        46500020
         AIF   (&A EQ 2).F042                                           46530020
FIXSCSEG EQU   * .                                                      46560020
         USING CPBINIT,RBASE .                                          46590020
         NI    LCBERBST,X'FF'-LCBRDERR .RESET READ ERROR                46620020
         AIF   (&A NE 3).F042A                                          46650020
         TM    SCBQTYPE,SCBCOREQ .      CORE QUEUEING                   46680020
         BNO   DISKONLY .               BR NO                           46710020
.F042A   ANOP                                                           46740020
         L     RBASE,ADRFA01 ..         SET UP SECOND BASE              46770020
         USING IEDQFA01,RBASE .                                         46800020
         L     R2,SCBCORE-1 .            ADD  LAST BFR THERE            46830020
         TM    PRFSTAT1-IEDQPRF(R2),PRFNLSTN .  THIS NOW LAST           46860020
         BO    CKNTXT .                 BR NOW LAST NOW                 46890020
         MVC   SCBSCSEG(3),SCBCORE .    RESET BFR ADDR                  46920020
         B     CALLFQA .                                                46950020
CKNTXT   EQU   * .                                                      46980020
         NC    PRFNTXT-IEDQPRF(3,R2),PRFNTXT-IEDQPRF(R2) .              47010020
         BZ    INITERR .                                                47040020
         MVC   SCBSCSEG(3),PRFNTXT-IEDQPRF(R2) .   ADDR NEXT BFR        47070020
         B     CALLFQA .                                                47100020
.F042    AIF   (&A EQ 1).F043                                           47130020
NEXTCPB  EQU   * .                                                      47160020
         MVC   SCBSCSEG(3),CPBADDR+1 .  RESET SCSEG                     47190020
         L     R2,CPBXREAF .                                            47220020
.F043    ANOP                                                           47250020
NEXTCPB1 EQU   * .                                                      47280020
         TM    DATFLAGS-IEDQDATA(R2),DATNPRFX .                         47310020
*              DOES IS HAVE A PREFIX                                    47340020
         BO    CKBFRA .                 BR NO PRFX                      47370020
         LA    R11,FIXPRFX1 .           SET RTN ADDR             A42363 47380021
         LH    R7,PRFSCAN-IEDQPRF(R2) . SAVE SCAN PRT (NO IDLES)        47400020
         STH   R7,DATSCAN-IEDQDATA(R2) .  WHILE PROCESSING THIS UNIT    47430020
         LH    R7,SCBSCAN .             SAVE SEQ OUT NO                 47460020
         TM    PRFSTAT1-IEDQPRF(R2),PRFNHDRN .                          47490020
*              IS I T A HEADER                                          47520020
         BO    FIXPRFX .                BR NO                           47550020
         TM    DATFLAGS-IEDQDATA(R2),DATLOSTN LOST MSG                  47580020
         BNO   CONTINUE .               BR NO                           47610020
         OI    SCBERR3,SCBLOSTN .       SET SCB ERR BIT                 47640020
CONTINUE EQU   * .                                                      47670020
*   ALLOW CNCL MSG IF RECALL                                            47700020
         TM    LCBSTAT1,LCBRCLLN .      RECALL                          47730020
         BO    FIXSCHDR .                                               47760020
         BAL   R14,FINDESTQ .                                           47790020
*              ALLOW INTCP MSG IF RECALL                                47820020
         TM    DATFLAGS-IEDQDATA(R2),DATCNCLD+DATSENT HAS THIS  SA52971 47850022
*                                         MSG BEEN CANCELLED OR SA52971 47870122
*                                         SENT                  SA52971 47890122
         BNZ   RTNSCHD .                BR IF EITHER            SA52971 47910022
         AIF   (&A EQ 1).F044                                           47940020
         LR    R5,R15 .                 SAVE 15                         47970020
         LH    R1,PRFDEST-IEDQPRF(R2) . TRM OFFSET                      48000020
         N     R1,AVTCLRHI .            SET UP ADDR OF TNT TO           48030020
         L     R15,AVTRNMPT .           CONVERT OFFSET TO TRM           48060020
         BALR  R14,R15 .                ENTRY ADDRESS                   48090020
         USING IEDQTRM,R1 .                                             48120020
         LR    R15,R5 .                 RESTORE 15                      48150020
         TM    TRMSTATE,TRMLIST+TRMPROC LIST OR PROCESS ENTRY   SA66617 48180054
*                                         INTERCEPTED           SA66617 48190054
         BNZ   NOINTC .                 BR NO                           48210020
         CLI   SCBUNTCT,AVTEZERO        FIRST READ OF HDR      @YA08105 48220061
         BNE   NOINTC                   BR NO                  @YA08105 48230061
         TM    TRMSTATE,TRMHELDN .      IS THE TRM INTERCEPTED          48240020
         BO    FLAGINTC .               BR YES                          48270020
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN LOCK MODE            @YA05477 48273061
         BNZ   NOINTC                   BRANCH IF YES          @YA05477 48276061
         TM    LCBSTAT1,LCBINITN        INITIATE MODE          @YA05477 48279061
         BO    NOINTC                   BRANCH IF YES          @YA05477 48282061
         NC    QCBINTFF(3),QCBINTFF     POSSIBLE RELEASE       @YA05477 48285061
         BNZ   NOINTC                   BRANCH IF NO           @YA05477 48288061
         CLC   SCBSCHDR(3),QCBFFEFO     SENDING FEFO MSG       @YA05477 48291061
         BNE   RTNSCHD                  BRANCH IF NO           @YA05477 48294061
NOINTC   EQU   * .                                                      48300020
.F044    ANOP                                                           48330020
         NC    SCBFEFO(3),SCBFEFO .     HAS IT BEEN UPDATED ALREADY     48360020
         BNZ   NOFEFOUP .               BR YES                          48390020
         MVC   SCBFEFO(3),DATFEFO-IEDQDATA(R2) SET THE FEFO PTR SA52971 48420022
NOFEFOUP EQU   * .                                                      48510020
*                                       SAVE FEFO PTR                   48540020
         MVC   LCBTTBIN(2),PRFDEST-IEDQPRF(R2) .                        48570020
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 48576022
         BZ    NOTCONCC .               BRANCH IF NO             S22026 48582022
         MVC   LCBTTCIN(2),PRFDEST-IEDQPRF(R2)                  SA57333 48588022
NOTCONCC EQU   * .                                               S22026 48594022
FIXOSEQ  EQU   * .                                                      48600020
         LH    R7,DATSEQOT .                                            48630020
         B     FIXPRFX1 .               ALL HEADERS COME HERE           48660020
*        BRANCH TO AVOID TEST FOR RETRIEVE                              48690020
FIXPRFX  EQU   * .                                                      48720020
         NC    LCBTTCIN(2),LCBTTCIN .   IF ZERO THIS IS A RETRIEVE      48750020
         BCR   7,R11 .                  BR NOT RETR TO FIXPRFX1  A42363 48780021
         TM    LCBSTAT2,LCBDIAL         IF 0, COULD BE DIAL       M2321 48787021
         BCR   1,R11                    BRANCH IF DIAL-IT IS NOT  M2321 48794021
*                                       RETRIEVE                  M2321 48801021
         MVC   SCBSCHDR(3),PRFCHDR-IEDQPRF(R2) .                        48810020
*        SET HDR ADDR THAT CORRESPONDS TO THIS BFR                      48840020
FIXPRFX1 EQU   * .                                                      48870020
         MVC   SCBSRCE(PRFSTXT-PRFSRCE),PRFSRCE-IEDQPRF(R2) .           48900020
         MVC   SCBCHDR(3),SCBSCHDR .    SET HDR ADDR                    48930020
         STH   R7,SCBSCAN .             RESTORE SEQ OUT NO              48960020
         BAL   R7,SIZECK .                                              48990020
         LH    R7,PRFSIZE-IEDQPRF(R2) . GET SIZE OF BFR                 49020020
         XC    DATCOUNT(2),DATCOUNT .                                   49050020
         CH    R7,AVTKEYLE .                                            49080020
         BH    CKBFRA .                                                 49110020
         STC   R7,CPBINWKA .                                            49140020
         B     FIXWKACT .                                               49170020
FIXSCHDR EQU   * .                                                      49200020
         AIF   (&A EQ 1).F045                                           49230020
         MVC   SCBSCHDR(3),PRFCRCD-IEDQPRF(R2) .     SET SCHDR TO THIS  49260020
         AIF   (&A EQ 2).F046                                           49290020
         TM    SCBQTYPE,SCBCOREQ .      IS THIS CORE                    49320020
         BNO   CKBDRCL .                BR NOT CORE - SCHDR IS OK       49350020
.F045    ANOP                                                           49380020
         MVC   SCBSCHDR(3),PRFCORE-IEDQPRF(R2) .    RESET SCHDR TO THIS 49410020
.F046    ANOP                                                           49440020
CKBDRCL  EQU   * .                                                      49470020
         NC    LCBTTCIN(2),LCBTTCIN .   RETRIEVE                        49500020
         BNZ   NOTRET1                  NOT RETRIEVE, CONTINUE    M2321 49530021
         TM    LCBSTAT2,LCBDIAL         IS THIS DIAL LCB?         M2321 49537021
         BO    NOTRET1                  YES,CANT BE RETRIEVE   @SA70861 49544061
         TM    DATFLAGS-IEDQDATA(R2),DATCNCLD  CANCELLED MSG?  @SA70861 49545061
         BNO   FIXOSEQ                  NO, HANDLE RETRIEVE    @SA70861 49546061
         OI    PRFSTAT1-IEDQPRF(R2),PRFCNCLN                   @SA70861 49547061
*                                            SET MSG CANCELLED @SA70861 49548061
         B     FIXOSEQ                  HANDLE RETRIEVE        @SA70861 49549061
NOTRET1  EQU   *                                                  M2321 49551021
         TM    LCBCHAIN,LCBBFRSZ .      SPECIAL RECALL                  49560020
         BCR   14,R11 .                 BR NO TO FIXPRFX1        A42363 49590021
         TM    SCBQTYPE,SCBCOREQ .      IS THIS CORE Q'D         A42363 49600021
         BCR   1,R11 .                  BR YES TO FIXPRFX1       A42363 49610021
         AIF   (&A EQ 1).F046A                                          49620020
*        IS DUPL HDR ON DISK - SCBMBSSA WILL HAVE XTRA OR NTXT          49650020
         LR    R1,RSCB .                SET FOR MBSSA ( REUS DSK)       49680020
         TM    SCBQTYPE,SCBNREUS .      IS IT REUS                      49710020
         BNO   ONEOK .                  BR IF REUS                      49740020
         LA    R1,4(R1) .               SET FOR MBSSA+4 N NON REUS)     49770020
ONEOK    EQU   * .                                                      49800020
.F046A   ANOP                                                           49830020
         TM    SCBHBFNO,X'0F' .         FIRST BD RCLL                   49860020
         BNZ   NOTFIRST .                                               49890020
         MVC   SCBTRANS(3),SCBSCHDR .   SET HDR ADDR FOR NEXT RCLL      49920020
NOTFIRST EQU   * .                                                      49950020
         AIF   (&A EQ 1).F046B                                          49980020
         MVC   SCBMBSSA-IEDQSCB(3,R1),PRFXTRA-IEDQPRF(R2) .             50010020
*        ASSUME MORE THAN 1 UNIT IN BFR - IF NOT SET NTXT               50040020
         NC    PRFXTRA-IEDQPRF(3,R2),PRFXTRA-IEDQPRF(R2)        SA52971 50070022
*        MORE THAN ONE UNIT                                     SA52971 50080022
         BCR   7,R11 .                  BR MORE THAN 1           A42363 50100021
         MVC   SCBMBSSA-IEDQSCB(3,R1),PRFNTXT-IEDQPRF(R2) .             50130020
.F046B   ANOP                                                           50160020
         BR    R11 .                    BR TO FIXPRFX1           A42363 50190021
         SPACE 3                                                        50220020
*        THIS SECTION DEALS WITH FREEING THE LINE AFTER FINDING         50250020
*        A CANCLED OR INTERCEPTED MESSAGE AND WILL PUT AN INTERCEPTED   50280020
*        MESSAGE IN THE INTERCEPT QUEUE.                                50310020
         SPACE 3                                                        50340020
RTNSCHD  EQU   * .                                                      50370020
         NI    QCBFLAG,X'FF'-QCBSDFFO . RESET FLAG - NO LONGER  SA52971 50380022
*                                         SENDING FROM QUEUE    SA52971 50390022
         CLC   SCBSCHDR(3),QCBFFEFO .   IS THIS THE FIRST FEFO MSG      50400020
         BNE   RTNSCHD1 .               BR NO                           50430020
         MVC   QCBFFEFO(3),DATFEFO-IEDQDATA(R2) . UPDATE FEFO           50460020
         OC    QCBFFEFO(3),QCBFFEFO     ONLY FEFO MSG?         @SA74867 50461000
         BNZ   ANYHELD                  NO, CHECK FOR HELD MSGS@SA74867 50462000
         MVC   QCBFFEFO(3),SCBFEFO      MOVE FROM SCB - MAY    @SA74867 50463000
*                                        HAVE BEEN UPDATED     @SA74867 50464000
*                                        WHILE READING 1ST FEFO@SA74867 50465000
ANYHELD  EQU   *                                               @SA74867 50466000
         NC    QCBINTFF(3),QCBINTFF .   ANY HELD MSGS ON LEVEL  SA52971 50470022
         BNZ   RTNSCHD1 .               BR SOME THERE           SA52971 50472022
         MVC   QCBPFEFO(3),QCBPREVF .   SET PTR TO MSG THAT IS  SA52971 50474022
*                                         PREVIOUS TO THE FIRST SA52971 50476022
*                                         UNSENT MSG IN THE FEFOSA52971 50478022
*                                         CHAIN                 SA52971 50480022
         MVC   QCBPREVF(3),PRFCRCD-IEDQPRF(R2) SET PTR TO MSG   SA52971 50482022
*                                       PREVIOUS TO FFEFO       SA52971 50484022
RTNSCHD1 EQU   * .                                                      50490020
         AIF   (&A NE 3).F047                                           50520020
         TM    SCBQTYPE,SCBCOREQ .      IS THIS MSG CORE QUEUED         50550020
         BO    CORERTN .               BR YES                           50580020
.F047    AIF   (&A EQ 1).F048                                           50610020
         LH    R14,AVTDSKCT .           DECR FOR THIS READ              50640020
         BCTR  R14,0 .                                                  50670020
         STH   R14,AVTDSKCT .                                           50700020
         BAL   R14,CPBFREEA .          FREE THE CPB                     50790020
RTNSCHED EQU   * .                                                      50820020
         LA    R14,GOAPQEMT .                                           50850020
         AIF   (&A EQ 2).F049                                           50880020
         B     XTNSCHED .                                               50910020
.F048    ANOP                                                           50940020
CORERTN  EQU   * .                                                      50970020
         TM    QCBDSFLG,QCBDISK         ANY DISK                SA62949 50974005
         BNZ   NOMSGCT                  IF DISK, MSGCT DONE     SA62949 50978005
         LH    R14,QCBMSGCT             LOAD COUNT              SA62949 50982005
         BCTR  R14,0                    DECREMENT               SA62949 50986005
         STH   R14,QCBMSGCT             STORE COUNT             SA62949 50990005
NOMSGCT  EQU   *                                                SA62949 50994005
         LR    R6,R2 .                                                  51000020
         ST    R2,AVTDOUBL .            SET MSG ADDR                    51030020
         L     R15,ADFREEMS .                                           51060020
         BAL   R7,HAVEADDR-FREEMSG(R15) .                               51090020
RTNSCHD2 EQU   * .                                                      51120020
         LA    R14,CALLPROC .           SO CPB Q WILL NOT BE CHECKED    51150020
XTNSCHED EQU   * .                                                      51180020
.F049    ANOP                                                           51210020
         L     RSCB,LCBSCBA-1 .         SCB ADDR                        51240020
         NI    SCBQTYPE,X'FF'-SCBBFMM . SET NOT MIDDLE OF MSGL          51270020
         L     RQCB,SCBDESTQ-1 .        DEST Q ADDR                     51330020
*** THIS SUBROUTINE DESTROYS REGS 0,1,2, AND 11.  THE QCB       SA52971 51360022
*   EXTENSION IS RETURNED IN REG2.  RETURN IS TO +0 IF THIS     SA52971 51360422
*   IS NOT A CONCENTRATOR AND TO +4 IF IT IS A CONCENTRATOR.    SA52971 51360822
         BAL   R10,FINDLVL .            GO FIND QCB EXTENSION   SA52971 51361222
         B     RESETLCB .               BR NOT CONC             SA52971 51361622
         NI    QCBEFLG-IEDQQCBE(R2),255-QCBEDATA .               S22026 51362022
*                                       RESET QCBEDATA           S22026 51362122
         LA    R1,LCBERB .              ERB ADDR                 S22026 51363022
         L     R2,AVTCSCH .             CONC SCH ADDR            S22026 51366022
         SH    R2,AVTHA2 .              SUB TWO                  S22026 51369022
         B     POST .                   POST ERB TO Q9           S22026 51372022
RESETLCB EQU   * .                                               S22026 51375022
         LA    R2,AVTBFRTB .            ADDR OF BFR RTB QCB             51390020
         CLI   LCBFLAG1,LCBPLCB         PLCB                   @YM08981 51390400
         BNE   NOTPLCB                  BR NO                  @YM08981 51390800
         XC    SCBERRST,SCBERRST        CLEAR ERROR WORD       @YM08981 51391200
*                                       TO RESET ANY BITS THAT @YM08981 51391600
*                                       MAY HAVE BEEN SET DUE  @YM08981 51392000
*                                       TO A PREVIOUS DIAL     @YM08981 51392400
*                                       CONTACT ERROR OR PURGE @YM08981 51392800
*                                       EXIT TAKEN PRIOR TO    @YM08981 51393200
*                                       DIAL CONTACT           @YM08981 51393600
         B     NOBSDIAL                 SKIP EP ONLY CODE      @YM08981 51394000
NOTPLCB  EQU   *                                               @YM08981 51394400
         TM    LCBSTAT2,X'06'           BSC DIAL               @OX12563 51395000
         BNO   NOBSDIAL                 BR IF NO               @OX12563 51400000
         MVC   LCBSTAT1(1),LCBSENS0     SET LINE STATE         @OX12563 51405000
         MVC   SCBBSCFM(1),LCBSENS1     SET FORMAT BITS        @OX12563 51410000
NOBSDIAL EQU   *                                               @OX12563 51415000
         ST    R2,SCBDESTQ-1 .          INTO SCB FOR BD POST            51420020
         CLI   LCBERBPY,PRIAPERB .      IS THIS AN APPL. PGM.           51450020
         BE    ERBRCQCB .               YES - RETURN ERB NOT LCB        51480020
         CLI   LCBRSKEY,DSPBUFSC        IS THIS A BFRD TERM     SA57087 51485022
         BNE   POSTLCB                  BR IF NOT BFRD          SA57087 51490022
         XI    LCBSTAT1,LCBRECVN+LCBSENDN  RESET LCBSTATE      @OX11340 51492000
         OI    LCBSTAT2,LCBNEGRP        SET NEG RESP FLG        SA57087 51495022
         NI    QCBSTAT,X'FF'-QCBSEND    RESET SENDING FLG       SA57087 51500022
POSTLCB  EQU   *                                                SA57087 51505022
         LR    R2,RLCB .                                                51510020
         LR    R1,R2 .                                                  51540020
         MVI   LCBPRI,PRILNFRE          SET LCB PRIORITY        SA52984 51550022
         B     POST .                                                   51570020
         AIF   (&A EQ 1).F050                                           51600020
SET14    EQU   * .                                                      51630020
         LA    R14,GOAPQEMT .                                           51660020
         B     POST .                                                   51690020
FLAGINTC EQU   * .                                                      51720020
*        IF TERMINAL IS IN LOCK MODE SEND THE RESPONSE ANYWAY           51750020
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN .LOCKED TERMINAL              51780020
         BNZ   NOINTC .                 BR IF LOCKED TO SEND ANYWAY     51810020
         TM    LCBSTAT1,LCBINITN .      INITIATE MODE                   51840020
         BNO   OKHOLD .                 BR NOT INIT TO HOLD MSG         51870020
         NI    LCBSTAT1,LCBINITF .      SET NOT INIT                    51900020
         MVC   DATFEFO-IEDQDATA(3,R2),QCBFFEFO . SET FOR MOVES LATER    51930020
         L     R5,PRFLCB-1-IEDQPRF(R2) . SRCE LCB ADDR                  51960020
         TM    LCBSTAT1-IEDQLCB(R5),LCBINITN . STILL INIT MODE          51990020
         BNO   OKHOLD .                 BR NO TO HOLD MSG               52020020
         NI    LCBSTAT1-IEDQLCB(R5),LCBINITF .RESET INIT MODE           52050020
         B     RTNSCHD1 .               GO TO RETURN THE LINE           52080020
OKHOLD   EQU   * .                                                      52110020
         TM    QCBDSFLG,QCBREUS+QCBNREUS .  ANY DISK                    52140020
         BZ    RTNSCHD .                BR NO                           52170020
         MVC   SCBSCHDR(3),PRFCRCD-IEDQPRF(R2) RESET SCB        SA52971 52176022
*** IF DISK QUEUED, THIS IS A NOP.  IF CORE WITH DISK BACK UP,  SA52971 52182022
*   THIS WILL SET THE DISK ADDRESS OF THE HEADER INSTEAD OF THE SA52971 52188022
*   MAIN STORAGE ADDRESS OF THE HEADER                          SA52971 52194022
         NC    QCBINTFF(3),QCBINTFF .   ANY FEFO MSGS THERE             52200020
         BNZ   RTNSCHD .                BR IF SOME ALREADY THERESA52971 52230022
         CLC SCBSCHDR(3),QCBFFEFO       FIRST FEFO MESSAGE      SA66626 52530054
         BNE   RTNSCHD                  NO,DON'T UPDATE INTFF   SA66626 52830054
         MVC   QCBINTFF(3),PRFCRCD-IEDQPRF(R2) .                        53190020
         B     RTNSCHD .                FREE THE CPB THIS TIME          53250020
.F050    AIF   (&A EQ 1).F052 .                                 SA52971 53280022
ERBCPB   EQU   * .                                                      53370020
         BAL   R14,FREECPBA .                                           53400020
         LA    R6,LCBERBCH-5 .          SET ERBCH FOR LINK FIELD        53430020
         BAL   R14,BFRLINK .            GO LIND THE LAST BFR            53460020
         L     R6,PRFLINK-1 .           NEXT IN CHAIN                   53490020
BFRLINK  EQU   *                                                        53520020
         NC    PRFLINK(3),PRFLINK .     ANOTHER THERE                   53550020
         BCR   NOTZERO,R14 .            BR NOT ZER0 TO GET NEXT  S21101 53580020
         B     CKENQERB .                                               53610020
.F052    ANOP                                                           53640020
         SPACE 3                                                        53670020
*        THIS SECTION WILL POST THE ERB AFTER A REQUEST IS COMPLETED    53700020
*        IF NECESSARY OR WILL FREE THE ERB TO BE POSTED AGAIN FRO       53730020
*        ANOTHER REQUEST.                                               53760020
         SPACE 3                                                        53790020
*   TO CKREQ WHEN END OF MESSAGE GOTTEN FROM THE QUEUE                  53820020
*    TO CKREQ WHEN THE REQUEST HAS BEEN COMPLETED -- BUFFERS FILLED     53850020
CKREQ    EQU   * .                                                      53880020
         L     RSCB,LCBSCBA-1 .         RESTORE IN CASE OF DISP BAL     53910020
         BAL   R11,FIXDEOB .            CC WILL REMAIN UNCHANGED        53940020
         BO    FIXRECAL .               BR YES                          53970020
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 53973022
         BZ    NOTCONCA .               BRANCH IF NO                    53976022
         L     RSCB,LCBSCBDA-1 .        LINE SCB ADDR            S22026 53979022
         MVI   LCBERBPY,PRIFSPCI .      SET TO POST BUFFERS      S22026 53985022
         TM    SCBSTAT1,SCBCBGN .       CONC MSG BEGIN           S22026 53988022
         L     RSCB,LCBSCBA-1 .         RESET SCB ADDR           S22026 53991022
         BO    LOGICEOM .               BRANCH IF YES                   53994022
NOTCONCA EQU   * .                                               S22026 53997022
         CLI   LCBERBPY,PRIINTRQ .                                      54000020
*              IS THIS AN INITIAL REQ                                   54030020
         BE    LOGICEOM .               BR YES                          54060020
CMIDMSG  EQU   * .                                               S22026 54070022
         CLI   LCBERBPY,PRIAPERB .      APPLICATION PGM ERB             54090020
         BE    ERBRCQCB .               BR YES                          54120020
         AIF   (&A EQ 1).F053                                           54150020
         LA    R5,GOAPQEMT .                                            54180020
         AIF   (&A EQ 2).F054                                           54210020
         TM    SCBQTYPE,SCBCOREQ .                                      54240020
         BNO   CKRQTYPE .                                               54270020
.F053    ANOP                                                           54300020
         LA    R5,CALPROC1 .                                            54330020
CKRQTYPE EQU   * .                                                      54360020
.F054    ANOP                                                           54390020
         CLI   LCBERBPY,PRIFSPCI .                                      54420020
         BNE   FREEBFRS .                                               54450020
         TM    SCBQTYPE,SCBCONC .       CONCENTRATOR             S22026 54456022
         BZ    NOTCONCD .               BRANCH IF NO             S22026 54462022
         MVI   LCBERBPY,PRIINTRQ-1 .    RESET PRIORITY                  54468022
NOTCONCD EQU   * .                                               S22026 54474022
         L     RDCB,LCBDCBPT .                                          54480020
         L     R2,DCBMH-1 .                                             54510020
         CLI   LCBFLAG1,LCBPLCB         THIS A PLCB            @YM06085 54516000
         BNE   GOTMH                    BR NO, HAVE MH ADDRESS @YM06085 54522000
         L     R2,LCBMHA-1              GET PROPER MH QCB      @YM06085 54528000
GOTMH    EQU   *                                               @YM06085 54534000
         LA    R15,PRIMHBFR .                                           54540020
         B     FREEBFR1 .                                               54570020
FREEBFRS EQU   * .                                                      54600020
         TM    LCBSTAT1,LCBRCLLN        IS THIS A RECALL        SA61767 54602000
         BO    NOCONC                   IF RECALL NO NEED TO    SA61767 54602500
*                                        RESET EDATA            SA61767 54603000
         BAL   R14,FINDESTQ             GET QCB & PQCB          SA61767 54603500
         BAL   R10,FINDLVL              QCBE ADDR IF CONC       SA52971 54604022
         B     NOCONC                   BRANCH IF NOT CONC      SA52971 54606022
         L     R1,LCBERBCH-1            BUFFER ADDR             SA52971 54608022
         LA    R1,AVTEZERO(R1)          CLEAR HI-ORDER BYTE     SA52971 54610022
         LTR   R1,R1                    BUFFER THERE            SA52971 54612022
         BZ    NOCONC                   BRANCH IF NO            SA52971 54614022
         TM    PRFSTAT1-IEDQPRF(R1),PRFNHDRN                    SA52971 54616022
*                                       HEADER BUFFER           SA52971 54618022
         BO    NOCONC                   BRANCH IF NO            SA52971 54620022
         NI    QCBEFLG-IEDQQCBE(R2),255-QCBEDATA                SA52971 54622022
*                                       RESET QCBEDATA          SA52971 54624022
         NI    SCBQTYPE,AVTEFF-SCBBFMM  RESET MIDDLE MSG BIT    SA61767 54625000
NOCONC   EQU   *                                                SA52971 54626022
         LA    R15,PRIBFRTB .           SET PRTY FOR SUBRTN             54630020
         LA    R2,AVTBFRTB .                                            54660020
FREEBFR1 EQU   * .                                                      54690020
         BALR  R14,0 .                                                  54720020
         NC    LCBERBCH(3),LCBERBCH .                                   54750020
         BCR   ZERO,R5 .                                         S21101 54780020
         L     R1,LCBERBCH-1 .                                          54810020
         STC   R15,PRFPRI-IEDQPRF(R1) . SET PRIORITY                    54840020
         MVC   LCBERBCH(3),PRFLINK-IEDQPRF(R1) .                        54870020
         B     POST .                                                   54900020
LOGICEOM EQU   * .                                                      54930020
         OI    LCBERBST,LCBDLNKN .      SET FOR PCI                     54960020
         L     RDCB,LCBDCBPT .          DCB ADDR                 S22024 54965022
         TM    LCBERBST,XMSG .          HAS EOM BEEN DONE               54990020
         BO    POSTERB .                BR YES                          55020020
         TM    DCBPCI,PCIADD .          PCI=ADD SPECIFIED        S22026 55080022
         BNZ   POSTERB .                BRANCH IF YES            S22026 55100022
         TM    SCBQTYPE,SCBBBFTM+SCBCONC .                       S22026 55120022
         NI    PRFSTAT1,PRFNLSTF .      SET LAST SEG IN BFR             55290020
POSTERB  EQU   * .                                                      55320020
         MVI   LCBERBPY,PRIACTIV .                                      55350020
         LA    R2,AVTACTIB .            ACTIVATE QCB                    55380020
         TM    DCBDSORG,LGB .           IS BLOCK DCB OR LGB      S22024 55385022
         BNO   RCPOST .                 BRANCH IF DCB            S22024 55390022
         L     R2,AVTSAVTP              GET POINTER TO SECONDARY S22024 55395022
*                                        AVT                     S22024 55400022
         L     R2,SAVTCNIR-IEDNSVTD(R2)  NIR QCB ADDR          @Y17XA0Z 55402000
RCPOST   EQU   * .                                                      55410020
         LA    R1,LCBERB .                                              55440020
         L     RSCB,LCBSCBA-1           SCB ADDRESS             SA61767 55450000
         AIF   (&A NE 3).F055                                           55470020
         TM    SCBQTYPE,SCBCOREQ .                                      55500020
         BNO   SET14 .                                                  55530020
.F055    AIF   (&A NE 2).F056A                                          55560020
         B     SET14 .                                                  55590020
         AGO   .F056                                                    55620020
.F056A   ANOP                                                           55650020
         LA    R14,CALPROC1 .                                           55680020
         B     POST .                                                   55710020
.F056    ANOP                                                           55740020
FIXDEOB  EQU   * .                                                      55770020
         NI    LCBERBST,X'FF'-XCOMPL .  RESET REQUEST COMPLETE          55800020
         TM    LCBSTAT1,LCBRCLLN .      RECALL                          55830020
         BCR   NOTONES,R11 .                                     S21101 55860020
         L     R2,SCBSCSEG-1 .          UPDATE SCB DEOB                 55890020
         ST    R2,SCBDEOB .                                             55920020
         IC    R2,SCBUNTCT .                                            55950020
         STC   R2,SCBDEOB .                                             55980020
         BR    R11 .                                                    56010020
FIXRECAL EQU   * .                                                      56040020
         L     RPREFIX,LCBERBCH-1 .     ADDR FIRST BFR                  56070020
         OI    PRFSTAT1,PRFDUPLN .      SER DUPL FLAG                   56100020
         MVI   LCBERBPY,PRIRCQCB .      SET PRTY FOR RECALLS            56130020
         MVI   SCBUNTCT,AVTEZERO .                                      56160020
         MVI   SCBNXCPB,AVTEZERO .      SET FOR MH                      56190020
ERBRCQCB EQU   * .                                                      56220020
         L     R2,LCBRCQCB .                                            56250020
         LA    R2,AVTEZERO(R2)          CLEAR HI BYTE           SA54262 56260022
*        LEAVE PRTY SET TO D0 FOR AN APPL PGM                           56280020
         B     RCPOST .                                                 56310020
         EJECT                                                          56340020
*        THIS SECTION OF CODE WILL INITIALIZE THE FIELDS NEEDED         56370020
*        TO CONSTRUCT A BUFFER FROM A UNIT OF DATA.  THE UNIT IS        56400020
*        A CPB UNIT JUST READ FROM DISK OR A UNIT IN THE CORE QUEUE     56430020
*        THESE ARE THE FIELDS AND THRIR MEANINGS                        56460020
*        CPBINWKA - THE COUNT OF DATA TO BE MOVED FROM THE UNIT         56490020
*              INTO THE BUFFER.                                         56520020
*        CPBWKACT - THE COUNT OF DATA IN THE UNIT THAT HAS NOT YET      56550020
*              BEEN TRANSFERED INTO A BUFFER.                           56580020
*        DATCOUNT - THE COUNT OF DATA IN A UNNIT THAT DOES NOT HAVE     56610020
*              A PREFIX - IF =0 - UNIT IS FULL                          56640020
*        CPBTOUNT - THE COUNT OF DATA TO BE MOVED INTO A BUFFER UNIT    56670020
*              TO FILL THE UNIT OF THE BUFFER                           56700020
*        CPBUNTCT - COUNT OF DATA BYTES ALREADY IN A BUFFER UNIT.       56730020
*        SCBUNTCT - THE COUNT OF DATA BYTES ALREADY TRANSFERRED OUT     56760020
*              OF THE UNIT QUEUED AT SCBSCSEG.                          56790020
         SPACE 3                                                        56820020
CKBFRA   EQU   * .                                                      56850020
         MVC   CPBINWKA(1),AVTKEYLE+1 . SET COUNT OF DATA IN WKA TO     56880020
*        KEYLE                                                          56910020
         CLI   DATCOUNT,AVTEZERO .      IS COUNT =0                     56940020
         BE    FIXWKACT .                                               56970020
         MVC   CPBINWKA(1),DATCOUNT .   CORRECT CONUT                   57000020
FIXWKACT EQU   * .                                                      57030020
         CLI   SCBUNTCT,AVTEZERO .      ANY NOT MOVED                   57060020
         BE    HAVEBUF .                BR NO                           57090020
         IC    R8,SCBUNTCT .            AMT LEFT TO MOVE                57120020
         IC    R14,CPBINWKA .           TOTAL DATA THERE                57150020
         SR    R14,R8 .                 SUBTRACT FOR AMY LEFT           57180020
         STC   R14,CPBINWKA .           NEW AMT OF DATA THERE           57210020
         STC   R8,CPBWKACT .           SET AMT MOVED ALREADY            57240020
HAVEBUF  EQU   * .                                                      57270020
         NC    LCBERBCH(3),LCBERBCH .   ANY BFRS THERE                  57300020
         BNZ   BFRTHERE .               BR YES                          57330020
         LR    R8,R15 .                 SAVE CPB ADDR                   57360020
         LA    R7,SIZTHERE .                                            57390020
         CLI   LCBERBKY,AVTEZERO .                                      57420020
         BCR   EQUAL,R7 .                                        S21101 57450020
         TM    DATFLAGS,DATNPRFX .                                      57480020
         BO    USELCB .                                                 57510020
         LR    RPRF,R2 .                                                57540020
         BAL   R7,OFFSET .                                              57570020
SIZTHERE EQU   * .                                                      57600020
         LR    R15,R8 .                 RSTORE CPB ADDR                 57630020
         LA    RPRF,LCBERBLK-1 .        INITIALIZE                      57660020
         LA    R8,LCBERB .                                              57690020
*        SET UP AMOUNT OF DATA TO BE MOVED INTO THE NEW UNIT            57720020
NEWBUFB  EQU   * .                                                      57750020
         LA    R14,AVTUMALN(R2) .       SET FOR MOVE                    57780020
         MVC   CPBTOUNT(1),AVTKEYLE+1 . COUNT TO UNT = KEYLE            57810020
         CLC   LCBERBQB+1(2),AVTKEYLE . BFR LARGER THAT KEYLE           57840020
         BH    NEWBUFC .                BR YES                          57870020
         MVC   CPBTOUNT(1),LCBERBQB+2 . CORRECT COUNT                   57900020
NEWBUFC  EQU   * .                                                      57930020
         SR    R7,R7 .                                                  57960020
*        SET R7 TO INDICATE A PREFIX IS NEEDED                          57990020
*        GET A NEW UNIT                                                 58020020
         BAL   R9,GETBFR .                                              58050020
NEWBUFD  EQU   * .                                                      58080020
         LA    R9,AVTUMALN(R5) .        ADDR TO MOVE FROM               58110020
NEWBUFA  EQU   * .                                                      58140020
         AIF   (&A EQ 1).F056C                                          58170020
         LA    R1,0(R1) .               MAKE R1 POSITIVE                58200020
.F056C   ANOP                                                           58230020
         SPACE        3                                                 58260020
*        THIS SECTION WILL DETERMINE WHETHER THE BUFFER UNIT AND        58290020
*        CPB UNIT ( OR QUEUED UNIT IN CORE) CAN BE SWAPPED OR DATA      58320020
*        MUST BE TRANSFERRED.                                           58350020
         SPACE 3                                                        58380020
         CLI   CPBWKACT,AVTEZERO .      ANY MOVED                       58410020
*        IF ANY HAS ALREADY BEEN MOVED FROM THE WORK UNIT BR TO         58440020
*        SKIP OVER IT                                                   58470020
         BNE   MOVEWKBS(R7) .                                           58500020
         TM    DATFLAGS,DATNPRFX .      UNIT HAVE PRFS                  58530020
*        IF NOT - ONE MAY OR MAY NOT BE NEEDED - GO CHECK               58560020
         BO    SETMOVE1(R7) .                                           58590020
*        THE UNIT HAS A PREFIX                                          58620020
         LTR   R7,R7 .                  IS A PRFX NEEDED                58650020
         BNZ   SETMOVE .                BR NO                           58680020
         AIF   (&A EQ 1).F056D                                          58710020
*        HAVE PRFX AND NEED PRFX - IS DISK AND NOT A HDR - IDLE         58740020
*        CHARACTERS MUST BE REMOVED.                                    58770020
         TM    PRFSTAT1-IEDQPRF(R2),PRFNHDRN .     HDR                  58800020
         BNO   MAYSWAP .                BR HDR                          58830020
         TM    LCBSTAT1,LCBRCLLN+LCBRECVN .                             58860020
*     LEAVE IDLES IF RECALL ON RCV OR FROM BD                           58890020
         BO    MAYSWAP .                BR IF RECALL                    58920020
         TM    LCBCHAIN,LCBBFRSZ .      FROM BD                         58950020
         BO    MAYSWAP .                BR YES                          58980020
         CLI   DATSCAN+1-IEDQDATA(R2),AVTEZERO .   ANY IDLES            59010020
         BZ    MAYSWAP .                BR IF NO IDLES TO REMOVE        59040020
         LNR   R1,R1 .                  SET FLAG FOR IDLES              59070020
.F056D   ANOP                                                           59100020
MAYSWAP  EQU   * .                                                      59130020
         CLC   CPBTOUNT(1),CPBINWKA .   IS THE AMT OF DATA THE          59160020
*        UNIT CAN HODD LESS THAN AMT TO MOVE IN WKA                     59190020
         BL    MOVUNT2(R7) .                                            59220020
         CLI   CPBUNTCT,AVTEZERO .      ANY ALREADY IN UNIT             59250020
         BNE   PARTFULL .               BR IF DATA THERE                59280020
         AIF   (&A EQ 3).F057                                           59310020
         AIF   (&A NE 1).F058                                           59340020
         B     MOVUNT2(R7) .                                            59370020
         AGO   .F059                                                    59400020
.F057    ANOP                                                           59430020
*        THE UNIT AND BFR UNIT CAN BE SWAPPED IF NOT CORE QUEUED        59460020
         TM    SCBQTYPE,SCBCOREQ .                                      59490020
         BO    MOVUNT2(R7) .                                            59520020
.F058    ANOP                                                           59550020
         LTR   R1,R1 .                  ANY IDLES TO REMOVE             59580020
         BM    BLDPRF1 .                BR YES TO MOVE DATA             59610020
*        SWAP CPB UNIT AND BFR                                          59640020
         ST    R5,CPBXREAF .                                            59670020
         MVI   CPBWKACT,AVTEZERO .                                      59700020
         LTR   R7,R7 .                  PRFX NEEDED                     59730020
         BNZ   TICLINK .                BR NO                           59760020
         TM    PRFSTAT1-IEDQPRF(R2),PRFNHDRN .   HDR                    59790020
         BNO   NOMOVE .                 BR NO - YES SET UP THE ADDR     59820020
         MVC   PRFCHDR-IEDQPRF(3,R2),SCBSCHDR . OF CORRECT HDR          59850020
NOMOVE   EQU   * .                                                      59880020
         STH   R7,PRFSIZE-IEDQPRF(R2) .                                 59910020
         LR    R5,R2 .                                                  59940020
         BAL   R7,FIXIT .                                               59970020
.F059    ANOP                                                           60000020
         AIF   (&A EQ 1).F059A                                          60030020
ADDWKA   EQU   * .                                                      60060020
         IC    R11,CPBINWKA .                                           60090020
         MVI   CPBINWKA,AVTEZERO .                                      60120020
.F059A   ANOP                                                           60150020
STORE    EQU   * .                                                      60180020
         N     R11,XMASK .                                              60210020
         AH    R11,PRFSIZE .                                            60240020
         STH   R11,PRFSIZE .                                            60270020
         NC    LCBTTCIN(2),LCBTTCIN     RETRIEVE?              @SA70861 60275061
         BNZ   NOTRET3                  BRANCH IF NO           @SA70861 60280061
         TM    LCBSTAT2,LCBDIAL         DIAL LCB?              @SA70861 60285061
         BNO   NOTRET4                  BRANCH IF NO           @SA70861 60290061
NOTRET3  EQU   *                                               @SA70861 60295061
         NI    PRFSTAT1,PRFCNCLF                                        60300020
NOTRET4  EQU   *                                               @SA70861 60310061
         IC    R14,CPBWKACT .                                           60330020
         STC   R14,SCBUNTCT .                                           60360020
         CH    R11,LCBERBQB+1 .                                         60390020
         BNL   BUFCPB .                                                 60420020
BFNOTFUL EQU   * .                                                      60450020
         CLI   CPBINWKA,AVTEZERO .      ALL WKA BEEN MOVED              60480020
         BNE   NXTUNT .                 BR YE  NO                       60510020
BFRFULL  EQU   * .                                                      60540020
         LA    R2,0(R2) .               CLEAR FOR LTR                   60570020
         BAL   R14,FREECPBA .                                           60600020
         TM    SCBSTAT1,PRFNLSTN .               LAST BFR               60630020
         BO    CKENQERB .                                               60660020
         AIF   (&A NE 3).F060                                           60690020
         TM    SCBQTYPE,SCBCOREQ .                                      60720020
         BO    ENDMSG1 .                                                60750020
.F060    AIF   (&A EQ 1).F061                                           60780020
         NC    SCBXTRA(3),SCBXTRA .     ANY XTRA RECORDS                60810020
         BZ    ENDMSG .                  BR NO                          60840020
         CLC   CPBADDR+1(3),SCBCRCD .   HAS THIS PRFX ONLY BEEN         60870020
         BE    CKENQERB .               READ - BR YES TO READ XTRA AND  60900020
*        FIX NTXT - IF ONLY PRFX READ NTXT COULD BE TXT QBCK CHN        60930020
         CLC   CPBADDR+1(3),SCBNTXT .   LAST XTRA READ                  60960020
         BNE   CKENQERB .              BR NO TO INIT NEXT READ          60990020
ENDMSG   EQU   * .                                                      61020020
         CLI   CPBINWKA,AVTEZERO .      ALL MOVED                       61050020
         BNE   CKENQERB .               NO - NOT EOM                    61080020
         BAL   R10,SETEOM .                                             61110020
.F061    ANOP                                                           61140020
ENDMSG1  EQU   * .                                                      61170020
         LA    R14,CKENQERB .                                           61200020
         NC    LCBERBCH(2),LCBERBCH .   THIS BFR BEEN FREED YET         61230020
         BCR   ZERO,R14 .               BR IF FREED              S21101 61260020
         B     FULLBUF .                                                61290020
SETEOM   EQU   * .                                                      61320020
         NI    PRFSTAT1,PRFNLSTF .      SET NOT LAST OFF                61350020
         OI    LCBERBST,LCBEOMSG .      SET EOM GOTTEN                  61380020
         MVI   SCBUNTCT,AVTEZERO .      SET TO 0 FRO MH                 61410020
         MVI   SCBNXCPB,AVTEZERO .      SET FOR MH                      61440020
         BR    R10 .                    RETURN                          61470020
CKENQERB EQU   * .                                                      61500020
         TM    LCBERBST,LCBEOMSG .      END OF MSG GOTTEN               61530020
         BO    CKREQ .                                                  61560020
         AIF   (&A EQ 1).F061AA                                         61560300
         TM    LCBERBST,LCBERROR        LCB ERROR              @OS77389 61560600
         BNO   NOSNDERR                 NO, BRANCH             @OS77389 61560900
         NI    LCBERBST,AVTEFF-LCBPRCPG TURN OFF BFR REQUEST   @OS77389 61561200
         B     POSTERR                                         @OS77389 61561500
NOSNDERR EQU   *                                               @OS77389 61561800
.F061AA  ANOP                                                           61562100
         CLI   LCBERBCT,AVTEZERO .                                      61590020
         BNE   ENQERB .                                                 61620020
         OI    LCBERBCT+1,XXCTUSED .    FLAG THE DISABLED COUNT         61650020
         CLI   LCBERBCT+1,XXCTUSED .    IS THE DISABLED CT 0            61680020
         BNE   ADDCTS .                 BR IF DISA. CT NOT 0            61710020
         NI    LCBERBCT+1,X'FF'-XXCTUSED .                              61740020
*        SET DISABLED COUNT FLAG OF                                     61770020
         OI    LCBERBST,LCBDLNKN .      SET FOR PCI                     61800020
         LH    R11,LCBERBCT .                                           61830020
         LTR   R11,R11 .                                                61860020
         BZ    CKREQ .                                                  61890020
         TM    LCBERBST,LCBDLNKN .                                      61920020
         BNO   CKREQ .                                                  61950020
         NI    LCBERBST,LCBDLNKF .                                      61980020
         B     ENQERB .                                                 62010020
         SPACE 3                                                        62040020
*        THIS SECTION WILL DETERMINE HAW TO BUILD THE BUFFER UNIT WHEN  62070020
*        DATA IS TO BE MOVED.                                           62100020
         SPACE 3                                                        62130020
SETMOVE1 EQU   * .                                                      62160020
*        IF UNIT DOES NOT HAVE A PREFIX - BR *+(R7)                     62190020
         B     BUILDPRF .                                               62220020
         B     MAYSWAP .                                                62250020
MOVEWKBS EQU   * .                                                      62280020
*        IF PART OF WORK AREA HAS BEEN MOVED - BR TO *+(R7)             62310020
         B     MOVEWKA .                                                62340020
         B     MOVUNT2+4 .                                              62370020
         AIF   (&A EQ 1).F061A                                          62400020
TICLINK  EQU   * .                                                      62430020
         LR    R5,R2 .                                                  62460020
         LA    R7,ADDWKA .              RETURN ADDRESS                  62490020
         B     LINKTIC .                USE COMMON CODE                 62520020
*                                                                       62550020
.F061A   ANOP                                                           62580020
*        IF MORE DATA IN WORK AREA THAN NEEDED IN UNIT                  62610020
MOVUNT2  EQU   * .                                                      62640020
*        COULD SWAP IF NOT CORE QUEUED                                  62670020
         B     BLDPRF1 .                                                62700020
         LA    R7,MOVEWKB .             SET RETURN ADDRESS              62730020
LINKTIC  EQU   * .                                                      62760020
         ST    R5,PRFTIC-IEDQPRF(R8) .                                  62790020
         MVI   PRFTIC-IEDQPRF(R8),CPBTICC .                             62820020
         LR    R8,R5 .                                                  62850020
         XC    PRFLINK-IEDQPRF(6,R8),PRFLINK-IEDQPRF(R8) .              62880020
         MVI   PRFTIC+3-IEDQPRF(R8),X'02' .                             62910020
         MVI   PRFTIC-IEDQPRF(R8),CPBTICC .  SET TIC                    62940020
         BR    R7 .                     RETURN                          62970020
*                                                                       63000020
MOVEUNTA EQU   * .                                                      63030020
*        HERE TO MOVE AMOUNT OF DATA NEEDED IN NEW UNIT                 63060020
         LR    R8,R5 .                                                  63090020
         IC    R11,CPBTOUNT .                                           63120020
MOVESET  EQU   * .                                                      63150020
         LA    R7,4095(R11) .           SUBRT ONE FOR MOVE              63180020
         EX    R7,MOVE .                MOVE DATA                       63210020
         IC    R14,CPBWKACT .           ADD AMOUNT MOVED THIS           63240020
         AR    R14,R11 .                TIME TO AMOUNT ALREADY          63270020
         STC   R14,CPBWKACT .           MOVED FROM WORK AREA            63300020
         IC    R14,CPBINWKA .           SUBTR AMOUNT MOVED              63330020
         SR    R14,R11 .                FROM AMOUNT LEFT TO             63360020
         STC   R14,CPBINWKA .           MOVE FROM WORK AREA             63390020
         B     STORE .                                                  63420020
BFRTHERE EQU   * .                                                      63450020
         BAL   R14,LAST .                                               63480020
         B     NEWBUFB .                BR IF LAST BFR FULL             63510020
         LA    R14,AVTUMALN(R2) .       FROM ADDR + 12                  63540020
         LA    R7,4 .                   SET NO PRFX NEEDED              63570020
         LTR   R11,R11 .                                                63600020
         BP    NEWBUFA .                THE LAST UNIT NOT FULL          63630020
         BAL   R9,ADDNBUNT .                                            63660020
         B     NEWBUFD .                                                63690020
PARTFULL EQU   * .                                                      63720020
         LA    R14,AVTUMALN(R2) .       SET 14  FOR MOVE                63750020
         B     MOVEWKB .                BR TO MOVE DATA                 63780020
MOVEWKA  EQU   * .                                                      63810020
         LA    R14,AVTUMALN(R2) .       FROM ADDR + 12                  63840020
         B     BUILDPRF .                                               63870020
IDLETEST EQU   * .                                                      63900020
         TM    LCBSTAT1,LCBRCLLN+LCBRECVN .      SHOULD IDLES           63930020
         BO    SAVEIDLE .               RESERVE CHARACTERS ARE TO BE    63960020
*        BE SAVED - ---- YES IF THIS IS A BD RECALL OR A                63990020
*        RECALL ON THE RECEIVE SIDE - BT                                64020020
         TM    LCBCHAIN,LCBBFRSZ .      BD RECALL                       64050020
         BO    SAVEIDLE .                                               64080020
         B     BLDPRF2 .                SAVED                           64110020
BLDPRF1  EQU   * .                                                      64140020
*    WILL ENTER HERE ONLY IF HAVE A PREFIX AND NEED ONE BUT             64170020
*    A SWAP IS NOT POSSIBLE.                                            64200020
         SR    R1,R1 .                                                  64230020
         IC    R1,DATSCAN+1-IEDQDATA(R2) .    NO. IDLES                 64260020
*        SHOULD ALSO BE SKIPPED                                         64290020
         LA    R11,AVTTXTSZ .           SIZE OF TXT PRF                 64320020
         TM    SCBSTAT1,PRFNHDRN .      IS THIS IS HCR                  64350020
         BO    IDLETEST .               BR NOT HDR TO TEST FOR IDLES    64380020
         MVC  PRFHQBCK-IEDQPRF(PRFSHDR-PRFSTXT,R5),PRFHQBCK-IEDQPRF(R2) 64410020
***********************                                                 64440020
*        UPDATE HDR ONLY FIELDS SINCE THE HDR IS STILL AVAILABLE        64470020
         LA    R11,AVTHDRSZ .           CORRECT SIZE FOR HDR            64500020
SAVEIDLE EQU   * .                                                      64530020
         LH    R7,DATSCAN-IEDQDATA(R2) .    SAVE SCAN AND IDLES         64560020
         SR    R1,R1 .                   IDLES SHOULD REMAIN IN HDRS    64590020
BLDPRF2  EQU   * .                                                      64620020
         AR    R1,R11 .                 NO IDLES + SIZE OF PRFX         64650020
         IC    R9,CPBINWKA .            SUBTR PRF SIZE FROM COUNT       64680020
         SR    R9,R1 .                  OF DATA TO MOVE FROM WK AREA    64710020
         STC   R9,CPBINWKA .                                            64740020
         STC   R1,CPBWKACT .            SET AMT MOVED                   64770020
         B     BLDPRF3 .                TREAT AS NEW BFR NOT NEW REC    64800020
BUILDPRF EQU   * .                                                      64830020
*    ENTER HDRE IF NEED A PREFIX BUT DO NOT HAVE ONE                    64860020
         LA    R11,AVTTXTSZ .           INITIALIZE TXT PRF SIZE         64890020
         OI    SCBSTAT1,PRFNHDRN .      THIS MUST NOT BE HDR            64920020
BLDPRF3  EQU   * .                                                      64950020
         MVC   PRFSRCE-IEDQPRF(AVTTXTSZ-4,R5),SCBSRCE .                 64980020
         NI    SCBSTAT1,X'D7' .         INTERCPT AND DULP OFF           65010020
         STH   R7,PRFSCAN-IEDQPRF(R5) . ZERO THE SCAN PRT               65040020
         STC   R11,CPBUNTCT .           SET AMT IN UNIT NOW             65070020
         IC    R9,CPBTOUNT .                                            65100020
         SR    R9,R11 .                                                 65130020
         STC   R9,CPBTOUNT .                                            65160020
         STH   R11,PRFSIZE-IEDQPRF(R5) .                                65190020
*              NEXT MOVE TO UNIT ADDR + PRFX SIZE + 12                  65220020
         BAL   R7,FIXIT .                                               65250020
*        SET FOR DEOB FOR EOB'S - THE THE QUEEU ADDR OF                 65280020
         MVC   PRFCRCD(3),SCBSCSEG .    THIS RECORD                     65310020
         TM    PRFSTAT1,PRFNHDRN .      IS THIS A HDR                   65340020
         BNO   MOVEWKB                  BRANCH IF NOT HEADER     S21101 65370021
         MVC   PRFCHDR(3),SCBSCHDR .    SET HDR ADDRESS                 65400020
MOVEWKB  EQU   * .                                                      65430020
         SR    R9,R9 .                                                  65460020
         IC    R9,CPBUNTCT .                                            65490020
         LA    R9,AVTUMALN(R9,R5) .                                     65520020
         SR    R11,R11 .                CLEAR FOR IC AND ADD            65550020
         IC    R11,CPBWKACT .           ADD WKACT TO                    65580020
         AR    R14,R11 .                THE FROM ADDRESS                65610020
         CLC   CPBTOUNT(1),CPBINWKA .   MORE IN UNT THAN WKA            65640020
         BNH   MOVEUNTA .                                               65670020
*        HERE TO MOVE AMOUNT OF DATA AVAILABLE                          65700020
         IC    R11,CPBINWKA .                                           65730020
         B     MOVESET .                                                65760020
FIXIT    EQU   * .                                                      65790020
         OI    SCBSTAT1,PRFNHDRN .      INSURE NHDR FOR NEXT TIME       65820020
         IC    R11,PRFLINK-1 .                                          65850020
         ST    R5,PRFLINK-1 .                                           65880020
         STC   R11,PRFLINK-1 .                                          65910020
         LR    RPRF,R5 .                NEW BFR ADDR                    65940020
         XC    PRFLINK(7),PRFLINK .     CLEAR LINK AND TIC              65970020
         MVI   PRFTIC+3,X'02' .                                         66000020
         MVI   PRFTIC,CPBTICC .         SET TIC OP CODE                 66030020
         LR    R8,R5 .                  NEW LAST UNIT ADDR              66060020
         ST    RLCB,PRFLCB-1 .          SET LCB ADDR                    66090020
         MVI   PRFNBUNT,X'01' .         SET NUMB UNITS                  66120020
         OI    PRFSTAT1,PRFNLSTN .      SET NOT LAST SEG                66150020
         NC    LCBTTCIN(2),LCBTTCIN .   IS THIS RETRIEVE         S21101 66160021
         BNZ   NOTRET2                  BR NOT RETRIEVE           M2321 66170021
         TM    LCBSTAT2,LCBDIAL         IF 0, COULD BE DIAL-IF    M2321 66172021
         BCR   14,R7                    NOT DIAL, THIS IS RETR.   M2321 66174021
NOTRET2  EQU   *                                                  M2321 66176021
         TM    LCBCHAIN,LCBBFRSZ        IS THIS FROM BD         SA63623 66177052
         BOR   R7                        BR IF YES               A63623 66178052
         IC    R9,SCBUNTCT .            THIS BYTE ADDRESS WITH IN       66180020
         STC   R9,PRFNTXT .             THIS RECORD                     66210020
         BR    R7 .                                                     66240020
NXTUNT   EQU   * .                                                      66270020
         BAL   R9,ADDNBUNT .                                            66300020
         MVC   CPBTOUNT(1),AVTKEYLE+1 . SET AMT TO MOVE TO UNIT         66330020
         BAL   R7,LINKTIC .                                             66360020
         LA    R14,AVTUMALN(R2) .       FROM ADDR +12                   66390020
         LH    R11,PRFSIZE .            DATA THERE                      66420020
         LH    R9,LCBERBQB+1 .          SIZE NEEDED                     66450020
         SR    R9,R11 .                 AMT LEFT TO GET                 66480020
         MVI   CPBUNTCT,AVTEZERO .      AMOUNT ALREADY IN UNIT =0       66510020
         CH    R9,AVTKEYLE .            THIS UNIT TO BE FILLED          66540020
         BH    MOVEWKB .                BR YES                          66570020
         STC   R9,CPBTOUNT .            RESET COUNT TO MOVE             66600020
         B     MOVEWKB .                                                66630020
SETMOVE  EQU   * .                                                      66660020
*        HERE IF UNIT HAS A PREFIX AND ONE IS NOT NEEDED - SET          66690020
*        TO SKIP OVER THE PREFIX                                        66720020
         TM    SCBSTAT1,PRFLOCK .       THIS LOCK MODE MSG              66750020
         BNO   NOLOCK .                 BR NO                           66780020
         OI    PRFSTAT1,PRFLOCK .       SET LOCK IN THIS BFR            66810020
NOLOCK   EQU   * .                                                      66840020
         SR    R1,R1 .                                                  66870020
         IC    R1,DATSCAN+1-IEDQDATA(R2) .    IDLES IN BFR              66900020
         LA    R1,AVTTXTSZ(R1) .        + SIZE OF PRFX                  66930020
         STC   R1,CPBWKACT .            INTO WKACT FOR AMT MOVED        66960020
         IC    R11,CPBINWKA .                                           66990020
         SR    R11,R1 .                 SUBTR SIZE OF TXT AND IELES     67020020
         STC   R11,CPBINWKA .                                           67050020
         CLI   CPBUNTCT,AVTEZERO .      ANY IN THIS UNIT ALREADY        67080020
         BNE   MOVEWKB .                BR YES                          67110020
         B     MOVUNT2+4 .                                              67140020
ADDCTS   EQU   * .                                                      67170020
         SR    R0,R0 .                  ADD THE DISABLED CT TO THE      67200020
         IC    R0,LCBERBCT+1 .                                          67230020
         MVI   LCBERBCT+1,AVTEZERO .                                    67260020
         LA    R11,AVTE80-1 .           SET FOR NR TO CLEAR             67290020
         NR    R0,R11 .                 FLAG FROM DISABLED COUNT        67320020
         IC    R11,LCBERBCT .                                           67350020
         AR    R11,R0 .                                                 67380020
         STC   R11,LCBERBCT .                                           67410020
ENQERB   EQU   * .                                                      67440020
         BAL   R11,FIXDEOB .                                            67470020
         LA    R15,LCBERB .             ELEM ADDR                       67500020
         LA    R2,AVTNCPBQ .                                            67530020
         BAL   R11,ENQMGRB .                                            67560020
         B     TAG1 .                                                   67590020
BUFCPB   EQU   * .                                                      67620020
         TM    PRFSTAT1,PRFNLSTN .      LAST BFR FULL                   67650020
         BO    NOCOMPL .                BR NOT LAST BUT FULL            67680020
         OI    LCBERBST,LCBCOMPL .      SET REQ COMPLETE                67710020
NOCOMPL  EQU   * .                                                      67740020
         BAL   R14,FULLBUF .                                            67770020
         L     RLCB,PRFLCB-1 .                                          67800020
         L     RSCB,LCBSCBA-1 .                                         67830020
         TM    LCBERBST,XCOMPL .        REQ COMPLETE                    67860020
         BO    BFRFULL .                                                67890020
         CLI   CPBINWKA,AVTEZERO .      ALL WK AREA MOVED               67920020
         BE    BFNOTFUL .                                               67950020
         B     HAVEBUF .                                                67980020
LASTTEST EQU   * .                                                      68010020
         IC    R1,CPBWKACT .           COUNT INTO WORK AREA             68040020
         CLI   CPBINWKA,AVTEZERO .      ALL MOVED                       68070020
         BNE   LASTEST .                BR NO                           68100020
         SR    R1,R1 .                  SET TO 0                        68130020
LASTEST  EQU   * .                                                      68160020
         STC   R1,SCBUNTCT .            RESET UNTCT                     68190020
         BR    R9 .                                                     68220020
         SPACE 3                                                        68250020
*        THIS SECTION WILL FIND THE LAST UNIT OF THE LAST BUFFER        68280020
*        ASSOCIATED WITH THE ERB AND THE AMOUNT OF DATA IN IT.          68310020
         SPACE 3                                                        68340020
LAST     EQU   * .                                                      68370020
         L     RPRF,LCBERBCH-1 .                                        68400020
         B     CKNEXTA .                                                68430020
CKNEXT   EQU   * .                                                      68460020
         L     RPRF,PRFLINK-1 .          ADDR NEXT BFR                  68490020
CKNEXTA  EQU   * .                                                      68520020
         NC    PRFLINK(3),PRFLINK .     IS THERE A NEXT BFR             68550020
         BNZ   CKNEXT .                                                 68580020
         TM    LCBSTAT1,LCBRCLLN+LCBRECVN .      RECALL BFR THERE       68610020
         BO    DATTEST .                BR TO NOT CHANGE BFR SIZE       68640020
         TM    LCBCHAIN,LCBBFRSZ .      IF IT IS SPECIAL RECALL         68670020
         BNO   LAST1 .                 BR NOT SPECIAL RECALL            68700020
DATTEST  EQU   * .                                                      68730020
         TM    DATFLAGS-IEDQDATA(R2),DATNPRFX .  IF A PRFX HAS BEEN     68760020
         BCR   14,R14 .                 READ ASSUME LAST BFR IS FULL    68790020
LAST1    EQU   * .                                                      68820020
         LR    R11,R2 .                 SAVE R2                         68850020
         LA    R2,((SCBSIZE-IEDQSCB)-(PRFSIZE-IEDQPRF))(R3) .           68880020
*        USE LAST SAVED PRFX                                            68910020
         BAL   R7,SIZECK .             CHECK BFR SIZE                   68940020
         LR    R2,R11 .                 RESTORE 2                       68970020
         LH    R7,AVTKEYLE .            GT KEYLENGTH                    69000020
         LR    R8,RPRF .                                                69030020
         LH    R11,PRFSIZE .                                            69060020
         CH    R11,LCBERBQB+1 .         IS BFR FULL                     69090020
         BCR   EQUAL,R14 .              IF YES, RETURN           S21101 69120020
         LH    R1,LCBERBQB+1 .          SIZE THERE ALREADY              69150020
BFRUNIT  EQU   * .                                                      69180020
         SR    R11,R7 .                 SIZE THERE - KEY                69210020
         SR    R1,R7 .                  SIZE TO GET - KEY               69240020
         NC    PRFTIC+1-IEDQPRF(2,R8),PRFTIC+1-IEDQPRF(R8) .            69270020
         BZ    RETURN .                 BR IF NO NEXT UNIT              69300020
         L     R8,PRFTIC-IEDQPRF(R8) .  NEXT UNIT ADDR                  69330020
         B     BFRUNIT .                                                69360020
RETURN   EQU   * .                                                      69390020
         LR    R5,R8 .                  SET LAST UNIT ADDR              69420020
         LTR   R11,R11 .                LAST UNIT FULL                  69450020
         BNM   SETUNTCT .               BR IF FULL                      69480020
         AR    R11,R7 .                 ADD FOR AMOUNT THERE            69510020
         AR    R1,R7 .                  ADJUST SIZE ALSO                69540020
SETUNTCT EQU   * .                                                      69570020
         STC   R11,CPBUNTCT .           SET COUNT ALREADY IN UNT        69600020
         CR    R1,R7 .                  IS SIZE LEFT TO MOVE LESS       69630020
         BL    SUBTREM .                THAN KEY -- BR YES              69660020
         LR    R1,R7 .                  RESET FOR STC                   69690020
SUBTREM  EQU   * .                                                      69720020
         SR    R1,R11 .                 SIZE LEFT - AMT THERE           69750020
         STC   R1,CPBTOUNT .            IS COUNT TO MOVE TO UNIT        69780020
         LR    R5,R8 .                                                  69810020
         B     4(R14) .                                                 69840020
         SPACE 3                                                        69870020
*        THIS SECTION WILL FREE A CPB IF DISK QUEUEING AND INITIALIZE   69900020
*        FOR THE NEXT OPERATION, WAIT FOR THE NEXT CPB IF ONE, OR       69930020
*        IF THE REQUEST IS COMPLETE, FREE THE ERB TO WAIT FOR THE       69960020
*        NEXT REQUEST.    IF CORE QUEUED THE NEXT UNIT OF THE           69990020
*        MESSAGE IF FOUND IN THE CORE QUEUE AND INITIALIZED FOR DATA    70020020
*        TRANSFER OR IF THE REQUEST IF COMPLETE IT WILL SET UP TO       70050020
*        WAIT FOR THE NEXT REQUEST.                                     70080020
         SPACE 3                                                        70110020
*    WILL SUBTR 1 FROM CPB COUNT AND GO TO APPQEMTY                     70140020
*    WILL RETURN                                                        70170020
FREECPBA EQU   * .                                                      70200020
         IC    R1,SCBCPBNO .                                            70230020
         BCTR  R1,0 .                                                   70260020
         STC   R1,SCBCPBNO .                                            70290020
         LTR   R2,R2 .                 TEST FLAG NOT TO UPDATE          70320020
         BM    NOUNTCT .                 BR IF NO UPDATE                70350020
         BAL   R9,LASTTEST .                                            70380020
NOUNTCT  EQU   * .                                                      70410020
         AIF   (&A NE 3).F062                                           70440020
         TM    SCBQTYPE,SCBCOREQ .                                      70470020
         BO    CORECPB .                                                70500020
.F062    AIF   (&A EQ 1).F063                                           70530020
         IC    R1,SCBNXCPB .            SAVE HI BYTEM                   70560020
         LA    R1,1(R1) .               ADD ONE TO NO. OF NEXT CPB      70590020
         STC   R1,SCBNXCPB .            RESTORE HI BYTE                 70620020
         LH    R1,AVTDSKCT .            SUBTR ONE FROM DISK CT          70650020
         BCTR  R1,0 .                                                   70680020
         STH   R1,AVTDSKCT .                                            70710020
         LTR   R2,R2 .             COMPRTEST TO UPDATE FLAG             70740020
         BM    TESTLAST .               BR NO UPDATE                    70770020
         CLI   CPBINWKA,AVTEZERO .      ANY DATA LEFT                   70800020
         BNE   TESTLAST .               BR YES                          70830020
         TM    DATFLAGS-IEDQDATA(R2),DATNPRFX .    HAVE A PRFX          70860020
         BNO   CKLAST2 .                BR YES                          70890020
         L     R9,CPBADDR .             ADDR THIS RECORD                70920020
         LA    R9,INCR(R9) .            ADD FOUR                 S21101 70950020
         IC    R11,SCBSCSEG-1 .                                         70980020
         ST    R9,SCBSCSEG-1 .                                          71010020
         STC   R11,SCBSCSEG-1 .                                         71040020
         B     TESTLAST .                                               71070020
CKLAST2  EQU   * .                                                      71100020
         NC    SCBXTRA(3),SCBXTRA .     ANY XTRAS                       71130020
         BZ    CKLAST3 .                BR NO                           71160020
         MVC   SCBSCSEG(3),SCBXTRA .                                    71190020
         B     TESTLAST .                                               71220020
CKLAST3  EQU   * .                                                      71250020
         MVC   SCBSCSEG(3),SCBNTXT .                                    71280020
TESTLAST EQU   * .                                                      71310020
         CLI   SCBCPBNO,AVTEZERO .                                      71340020
         BE    CPBFREEA .               IF 0 RETURN                     71370020
         B     CPBFREE .                IF NOT RETURN TO APPQEMTY       71400020
.F063    AIF   (&A EQ 2).F064                                           71430020
CORECPB  EQU   * .                                                      71460020
         NC    PRFTIC+1-IEDQPRF(2,R2),PRFTIC+1-IEDQPRF(R2) .            71490020
         BZ    GETCORE .                                                71520020
         CLI   CPBINWKA,AVTEZERO .      ANY DATA LEFT                   71550020
         BNE   DEOBSET .                BR YES                          71580020
         MVC   SCBSCSEG(3),PRFTIC+1-IEDQPRF(R2) .                       71610020
         L     R2,PRFTIC-IEDQPRF(R2) .                                  71640020
         B     DEOBSET .                                                71670020
GETCORE  EQU   * .                                                      71700020
         CLI   CPBINWKA,AVTEZERO .      ALL DATA MOVED                  71730020
         BNE   DEOBSET .                BR NO                           71760020
         TM    SCBSTAT1,PRFNLSTN .                                      71790020
         BNO   SETCPBNA .                                               71820020
         TM    LCBSTAT1,LCBINITN .      INIT MODE                       71850020
         BNO   MOVENTXT .               BR NOT INIT                     71880020
         NC    SCBNTXT(3),SCBNTXT .     IS THE BUFFER THERE             71910020
         BNZ   MOVENTXT .               BR YES                          71940020
INITERR  EQU   * .                                                      71970020
         OI    LCBERBST,LCBRDERR .      SET LOGICAL READ ERROR          72000020
         LA    R14,TAG1 .               SET RTN ADDR                    72030020
         B     INITPOST .                                               72060020
MOVENTXT EQU   * .                                                      72090020
         MVC   SCBSCSEG(3),SCBNTXT .                                    72120020
         L     R2,SCBSCSEG-1 .                                          72150020
DEOBSET  EQU   * .                                                      72180020
         TM    LCBERBST,XCOMPL .        REQ COMPLETE                    72210020
         BO    SETCPBNO .               BR YES                          72240020
         XC    AVTDOUBL(5),AVTDOUBL .   CLEAR WORK AREA                 72270020
         B     NEXTCPB1 .                                               72300020
SETCPBNA EQU   * .                                                      72330020
         BAL   R10,SETEOM .                                             72360020
SETCPBNO EQU   * .                                                      72390020
         MVI   SCBCPBNO,AVTEZERO .                                      72420020
         BR    R14 .                                                    72450020
.F064    ANOP                                                           72480020
*        SILL GET SIZE OF BFR THAT IS QUEUED IF FROM BD REQ.            72510020
SIZECK   EQU   * .                                                      72540020
         TM    LCBSTAT1,LCBRCLLN+LCBRECVN .                             72570020
         BO    SIZECK1 .                                                72600020
         TM    LCBCHAIN,LCBBFRSZ .      RECALL FROM BFR DISPOSITION     72630020
         BCR   NOTONES,R7 .             BR NOT BD RECALL         S21101 72660020
*        WHEN ENTERED HERE FROM 'OFFSET' - THIS ROUTINE HAS NO BASE     72690020
SIZECK1  EQU   * .                                                      72720020
         LH    R8,PRFSIZE-IEDQPRF(R2) . SIZE IN BFR READ                72750020
         STH   R8,LCBERBQB+1 .          SET TO BUILD BFRS SAME SIZE     72780020
         SR    R10,R10 .                AS THE BFR ON THE QUEUE         72810020
         BALR  R1,0 .                                                   72840020
         LA    R10,1(R10) .             ADD ON E TO COMPUTE NO UNITS    72870020
         SH    R8,AVTKEYLE .            LESS ONE UNIT                   72900020
         BCR   PLUS,R1 .                BR IF NOT ALL UNITS      S21101 72930020
         STH   R10,LCBERBQB-1 .         SET NO UNITS IN BFR TO RECALL   72960020
         BR    R7 .                     RETURN                          72990020
ADDNBUNT EQU   * .                                                      73020020
         IC    R11,PRFNBUNT .                                           73050020
         LA    R11,1(R11) .                                             73080020
         STC   R11,PRFNBUNT .                                           73110020
         B     NOSET11 .                                                73140020
GETBFR   EQU   * .                                                      73170020
         SR    R11,R11 .                                                73200020
NOSET11  EQU   * .                                                      73230020
         NC    AVTBFREB+1(3),AVTBFREB+1 ARE ANY BFRS THERE              73260020
         BZ    NOBFRS .                                                 73290020
         LH    R5,AVTAVFCT .            SUBTR. ONE FROM AV BF CT        73320020
         N     R5,AVTCLRHI              CLEAR HIGH BYTES       @YA07705 73330000
         BCTR  R5,0 .                                                   73350020
         STH   R5,AVTAVFCT .                                            73380020
         L     R5,AVTBFREB .            ADDR OF UNIT                    73410020
         L     R1,PRFLINK-1-IEDQPRF(R5) ADDR OF NEXT UNIT               73440020
         ST    R1,AVTBFREB .            INTO BFR REQ QCB                73470020
CLRBFR   EQU   *                                                        73500020
         XC    PRFLINK-1-IEDQPRF(8,R5),PRFLINK-1-IEDQPRF(R5) .          73530020
         MVI   PRFTIC-IEDQPRF(R5),8 .   SET TIC OP CODE                 73560020
         BR    R9 .                                                     73590020
NOBFRS   EQU   * .                                                      73620020
         AIF   (&A NE 3).F065                                           73650020
         TM    SCBQTYPE,SCBCOREQ .      READ FROM CORE                  73680020
         BO    PUTERB .                 BR YES NO CPB CHAIN             73710020
.F065    AIF   (&A EQ 1).F065B                                          73740020
*        SAVE NEEDED REGS FOR RTN ON R9 WHEN BFR IS AVAILABLE           73770020
         STM   R6,R11,CPBSEKFL .        SAVE REGS FOR STATUS     A49228 73800022
         ST    R14,CPBUNUSD .                                           73830020
         MVI   CPBSEEK,X'FF'            STE FLAG IN ORIG CPB    SA52984 73840022
NOBFRQ   EQU   *                                                SA52984 73850022
         L     R1,AVTNOBFQ .                                            73860020
         ST    R1,CPBNEXTF .                                            73890020
         ST    R15,AVTNOBFQ .                                           73920020
         AIF   (&A EQ 2).F065C                                          73950020
         B     TESTFLAG                                                 73980020
.F065B   ANOP                                                           74010020
PUTERB   EQU   * .                                                      74040020
         LTR   R11,R11 .                                                74070020
         BZ    TESTFLAG .                                               74100020
         BCTR  R11,0 .                                                  74130020
         STC   R11,PRFNBUNT .                                           74160020
TESTFLAG EQU   * .                                                      74190020
.F065C   ANOP                                                           74220020
         AIF   (&A EQ 1).F066                                           74226022
         TM    LCBERBST,XXXINQ .        IS THE ERB ALREADY IN THE       74232022
         BO    GOAPQEMT .                                               74238022
.F066    ANOP                                                           74244022
         IC    R11,CPBWKACT .           RESTORE SCBUNTCT                74250020
         STC   R11,SCBUNTCT .                                           74280020
         OI    LCBERBST,XXXINQ .        FLAG ON                         74430020
         MVC   LCBERBLK(3),AVTBFRTB+1 .                                 74460020
         IC    R1,LCBERBPY .                                            74490020
         STC   R1,LCBERB .                                              74520020
         LA    R1,LCBERB .                                              74550020
         MVI   LCBERBPY,PRIDSKBF .                                      74580020
         ST    R1,AVTBFRTB .                                            74610020
         B     TAG1 .                                                   74640020
         SPACE 3                                                        74670020
*        THIS SECTION DEALS WITH A UNIT POSTED TO CPB CLEANUP AS A      74700020
*        RESULT OF AS ERB APPEARING IN THE BUFFER RETURN QUEUE BECAUSE  74730020
*        THERE WERE NO UNITS AVAILABLE.                                 74760020
         SPACE 3                                                        74790020
BUFFER   EQU   * .                                                      74820020
         LR    R5,R1 .                  SET NEW UNIT ADDR               74850020
         L     RLCB,PRFLCB-1-IEDQPRF(R1) .   LCB ADDR                   74880020
         NI    LCBERBST,X'FF'-XXXINQ .  RESET FLAG                      74910020
         L     RSCB,LCBSCBA-1 .                                         74940020
         IC    R1,LCBERB .                                              74970020
         STC   R1,LCBERBPY .                                            75000020
         AIF   (&A NE 3).F068                                           75030020
         TM    SCBQTYPE,SCBCOREQ .      READ FROM CORE                  75060020
         BO    SETCPBAD .               BR YES TO RECOMPUTE CPB AD      75090020
.F068    AIF   (&A EQ 1).F069                                           75120020
         LH    R1,AVTAVFCT .            DECR. CT. OF AV. UNITS          75150020
         N     R1,AVTCLRHI              CLEAR HIGH BYTES       @YA07705 75155000
         TM    LCBERBST,LCBERROR .      IS THERE AN ERROR        A44866 75160021
         BO    NODECR .                 BR YES, BFR RETURN       A44866 75170021
         BCTR  R1,0 .                                                   75180020
         STH   R1,AVTAVFCT .                                            75210020
NODECR   EQU   * .                                               A44866 75220021
         LA    RLCB,0(RLCB) .           CLEAR HI BYTE                   75240020
         LA    R15,AVTNOBFQ-(CPBNEXTF-IEDQCPB) INITIALIZE FOR LP        75270022
CKCPB    EQU   * .                                                      75300020
         LR    R14,R15 .                SAVE ADDR LAST CPB              75310022
CKCPBA   EQU   *                                                SA52984 75320022
         L     R15,CPBNEXTF-IEDQCPB(R14) . NEXT CPB                     75330020
         L     R2,CPBAERBF .            ERB ADDR                        75360020
         LA    R2,0(0,R2) .             CLEAR HI BYTE                   75390020
         CR    RLCB,R2 .                SAME LCB                        75420020
         BNE   CKCPB .                  NO, GO CHECK NEXT CPB    S22025 75450022
         MVC   CPBNEXT-IEDQCPB(3,R14),CPBNEXT .  REMOVE CPB             75570020
         CLI   CPBSEEK,X'FF'            IS THIS THE ORIG.       SA52984 75573022
         BE    HAVECPB                  YES-PROCESS             SA52984 75576022
         LR    R6,R14                   SAVE ADDR OF CPB PREVUS SA52984*75579022
                                         TO THIS                SA52984 75582022
         LA    R2,AVTDKENQ              PUT THIS CPB ON Q       SA52984 75585022
         BAL   R11,ENQMGRC              TO BE PROCESSED LATER   SA52984 75588022
         LR    R14,R6                   RESTORE ADDR OF PREV    SA52984 75591022
         B     CKCPBA                   CONTINUE SEARCH         SA52984 75594022
HAVECPB  EQU   *                                                SA52984 75597022
*        RESTORE NEEDED REGS FOR RTN ON R9                              75600020
         L     R2,CPBXREAF .            UNIT ADDR                       75630020
         LM    R6,R11,CPBSEKFL .        RESTORE REGS FOR STATUS  A49228 75660022
         L     R14,CPBUNUSD .                                           75690020
         TM    LCBERBST,LCBERROR .      LINE ERROR               A44866 75695021
         BNO   CLRBFR .                 BRANCH IF NOT            A44866 75700021
         MVC   PRFLINK-IEDQPRF(3,R5),AVTBFREB+1 .                A44866 75705021
         ST    R5,AVTBFREB .            RETURN BFR JUST GOTTEN   A44866 75710021
         LTR   R11,R11 .                IS THI NEW UNIT A SINGLE A49228 75710822
*        UNIT BFR OR A SUBSEQUENT UNIT OF THE LAST BFR           A49228 75711622
         BZ    ANYBFRS .                BR IF NOT A SUBS. UNIT   A49228 75712422
         BCTR  R11,0 .                  DECR. NO. UNITS IN LAST  A49228 75713222
         STC   R11,PRFNBUNT .           SINCE THIS ONE WAS COUNTEA49228 75714022
         B     ANYBFRS .                RETURN EXTRA BFRS & ERB  A44866 75715021
.F069    AIF   (&A EQ 2).F070                                           75750020
SETCPBAD EQU   * .                                                      75780020
*        AND START OVER FOR THIS CPB                                    75810020
         MVC   PRFLINK-IEDQPRF(3,R5),AVTBFREB+1 .                       75840020
         ST    R5,AVTBFREB .            REPLACE BFR IN THE POOL         75870020
         LA    R15,AVTDOUBL-(CPBINWKA-IEDQCPB) SET DOUBL AS CPB  S22025 75900022
*                                            WORK AREA           S22025 75910022
         L     R2,SCBSCSEG-1 .          SET 2 TO UNIT ADDR              75930020
         CLM   R2,AD,PRFCORE-IEDQPRF(R2)  BFR STILL IN CORE Q  @OX20639 75940082
         BNE   RDERROR                  NO, BRANCH             @OX20639 75950082
         XC    AVTDOUBL(6),AVTDOUBL .                                   75960020
         TM    LCBERBST,LCBERROR .      LINE ERROR               A44866 75966021
         BNO   NEXTCPB1 .               BRANCH IF NOT            A44866 75972021
         L     RBASE,BASE1 .            RESET BASE               A44866 75978021
         B     ERBERROR-CPBINIT(RBASE) . RETURN BUFFERS & ERB    A44866 75984021
         SPACE 3                                                        76020020
*        THIS SECTION DETERMINES WHAT TO DO WITH A BUFFER THAT IS FULL  76050020
         SPACE 3                                                        76080020
.F070    ANOP                                                           76110020
FULLBUF  EQU   * .                                                      76140020
         IC    R1,LCBERBCT .                                            76170020
         BCTR  R1,0 .                                                   76200020
         STC   R1,LCBERBCT .            RESET ENABLED CT -1             76230020
         OI    LCBERBCT+1,XXCTUSED .    FLAG DIABLED CT                 76260020
         IC    R11,LCBERBCT+1 .         GET DISABLED CT                 76290020
         MVI   LCBERBCT+1,AVTEZERO .    ZERO THE COUNT                  76320020
         IC    R1,LCBERBCT .            GET NEW ENABLED CT              76350020
         AR    R1,R11 .                 ADD COUNTS                      76380020
         STC   R1,LCBERBCT .                                            76410020
         NI    LCBERBCT,X'FF'-XXCTUSED . FLAG OFF                       76440020
         CLI   LCBERBCT,AVTEZERO .                                      76470020
         BNE   RTNPRI .                 BR NO                           76500020
         OI    LCBERBST,XCOMPL .        SET REQ COMPLETE                76530020
RTNPRI   EQU   * .                                                      76560020
         BAL   R9,LASTTEST .            SET UP SCBUNTCT                 76590020
         TM    SCBQTYPE,SCBCONC .       CONC                     S22026 76593022
         BZ    NOTCONCB .               BRANCH IF NO             S22026 76596022
         L     RSCB,LCBSCBDA-1 .        LINE SCB ADDR            S22026 76599022
         TM    SCBSTAT1,SCBCBGN .       CONC MSG BEGIN           S22026 76602022
         L     RSCB,LCBSCBA-1 .         RESET SCB ADDR           S22026 76605022
         BZ    CONCMID .                BRANCH IF NO             S22026 76608022
         BR    R14 .                    BRANCH                   S22026 76611022
NOTCONCB EQU   * .                                               S22026 76614022
         CLI   LCBERBPY,PRIINTRQ .       INIT REQ                       76620020
         BCR   EQUAL,R14 .              BR YES                   S21101 76650020
CONCMID  EQU   * .                                               S22026 76660022
         CLI   LCBERBPY,PRIAPERB .      APPLICATION ERB                 76680020
         BCR   EQUAL,R14 .              BR YES                   S21101 76710020
         TM    LCBSTAT1,LCBRCLLN .      IS THIS RECALL                  76740020
         BCR   ONES,R14 .               BR YES -DON'T POST TO MH S21101 76770020
         L     R1,LCBERBCH-1 .          BFR ADDR FORNPOST               76800020
         MVC   LCBERBCH(3),PRFLINK-IEDQPRF(R1) .  DECHAIN BFR           76830020
         MVI   PRFPRI-IEDQPRF(R1),PRIMHBFR .                            76860020
         L     RDCB,LCBDCBPT .                                          76890020
         MVC   PRFQCBA-IEDQPRF(3,R1),DCBMH . SET QCB ADDR FOR MH        76920020
         CLI   LCBFLAG1,LCBPLCB         THIS A PLCB            @YM06085 76927000
         BNE   NOSTORE                  BR NO, HAVE PROPER MH  @YM06085 76934000
         MVC   PRFQCBA-IEDQPRF(3,R1),LCBMHA GET PROPER MH QCB  @YM06085 76941000
         B     NOSTORE .                                                76950020
MOVE     MVC   0(0,R9),0(R14) .                                         76957000
BASE1    DC    A(CPBINIT) .                                             76964000
XMASK    DC    X'000000FF' .                                            76971000
         AIF   (&A NE 3).F071                                           76980020
         SPACE 3                                                        77010020
*        THIS SECTION INITIALIZES THE CPB ADDRESS AND BUFFER SIZE       77040020
*        FOR A CORE QUEUED OPERATION.                                   77070020
         SPACE 3                                                        77100020
RESETA   EQU   * .                                                      77130020
         MVC   SCBSCHDR(3),AVTDOUBL+1 .                                 77160020
         MVC   SCBSCSEG(3),SCBSCHDR .                                   77190020
.F071    AIF   (&A EQ 2).F072                                           77220020
CALLFQA  EQU   * .                                                      77250020
         L     R2,SCBSCSEG-1 .                                          77280020
         L     RPRF,SCBSCHDR-1 .                                        77310020
         TM    LCBSTAT1,LCBRCLLN .      RECALL                          77320021
         BNO   SETCPB .                 BR NO                           77330021
         ST    R6,AVTDOUBL .            SET BFR ADDR                    77332021
         CLC   AVTDOUBL+1(3),PRFCORE .                                  77334021
*        IS THIS BFR STILL IN THE CORE QUEUE                            77336021
         BE    SETCPB .                 BR YES                          77338021
         LA    R5,ERBRCQCB .            SET RTN ADDR                    77338421
         B     FREEBFRS .               RETURN 0 TP BD                  77338821
SETCPB   EQU   * .                                                      77339221
         BALR  R7,0                     TO EXTEND BASE         @Y17XA0Z 77339400
         USING *,R7                     TELL ASSEMBLER         @Y17XA0Z 77339600
         LA    R7,HAVESIZE .            SET RTN                         77340020
         DROP  R7                       DROP EXTENDED BASE     @Y17XA0Z 77350000
         CLI   LCBERBKY,AVTEZERO .      SIZE THERE                      77370020
         BCR   EQUAL,R7 .               BR IF EQUAL TO SIZE THERES21101 77400020
         TM    PRFSTAT1,PRFNHDRN .      THIS A HDR                      77430020
         BNO   OFFSET .                                                 77460020
         L     RPREFIX,PRFCHDR .         GET ADDR OF HDR                77490020
         SRL   RPREFIX,8 .             SHIFT OUT LOW BYTE               77520020
         B     OFFSET .                                                 77550020
HAVESIZE EQU   * .                                                      77580020
         XC    AVTDOUBL(7),AVTDOUBL .   CLEAR FOR WORK AREA             77880020
         LA    R15,AVTDOUBL-(CPBINWKA-IEDQCPB) SET DOUBL AS CPB  S22025 77910022
*                                            WORK AREA           S22025 77950022
         IC    R9,LCBERBQB .                                            78000020
*        THE NO OF UNITS PER BUFFER WILL BE IN ERBQB                    78030020
         IC    R8,LCBERBCT .                                            78060020
         MR    R8,R8 .                                                  78090020
         STC   R9,SCBCPBNO .                                            78120020
         B     NEXTCPB1 .               BR TO PROCESS THIS BFR UNIT     78150020
.F072    ANOP                                                           78180020
THREE    EQU   3                        LENGTH                 @OX20639 78230082
         AIF   (&A EQ 2).F077                                           78300020
         SPACE 3                                                        78330020
*        THIS SECTION WILL FREE A MESSAGE FROM THE CORE QUEUE AND       78360020
*        UPDATE THE MSUNIT COUNT.                                       78390020
         SPACE 3                                                        78420020
FREEMSG  EQU   * .                                                      78450020
         DROP  12 .                                                     78480020
         USING *,R15 .                                                  78510020
         MVC   AVTDOUBL+1(3),PRFCHDR .  GET ADDR OF CORE UNIT THIS      78540020
         TM    PRFSTAT1,PRFNHDRN .                                      78570020
         BO    USECHDR .                                                78600020
         MVC   AVTDOUBL+1(3),PRFCORE .                                  78630020
USECHDR  EQU   * .                                                      78660020
         L     R2,AVTDOUBL .            MSG HDR CAME FROM               78690020
HAVEADDR EQU   *                                                SA68051 78700054
         LA    R2,0(,R2) .              CLEAR HIGH ORDER BYTE           78720020
*        THE MSG MUST BE REMOVED FROM THE HDR CHAIN                     78750020
*    R6 DOES NOT HAVE A BFR ADDR, R2 HAS THE HDR ADDR OF MSG            78810020
         L     R10,AVTCADDR .           NO. OF CORE UNITS IN USE        78840020
         LR    R8,R9 .                                                  78870020
         DROP  RPREFIX .                                                78900020
         USING PRFSUNIT,R8 .                                            78930020
*        SET BASE SO THAT QCBCFHDR WILL COINCIDE WILH                   78960020
*        PRFNHDR                                                        78990020
         LA    R8,((QCBCFHDR-IEDQPQCB)-(PRFNHDR-PRFSUNIT))(R8) .        79020020
COMPARE1 EQU   * .                                                      79140020
         CLC   PRFNHDR(3),PRFCORE-IEDQPRF(R2) .                         79170020
*        IS THIS THE MSG TO REMOVE                                      79200020
         BE    TAKEOUT .                BR UES                          79230020
         LNR   R2,R2 .                  SET FLAG FOR RTN HERE           79260020
         NC    PRFNHDR(3),PRFNHDR .     IS THIS THE LAST ONE            79290020
         BCR   ZERO,R7 .                BR YES - MSG NOT THERE   S21101 79320020
         LPR   R2,R2 .                  RESET  FLAG FOR NO RTN          79350020
         MVC   AVTDOUBL+5(3),PRFNHDR .  ADDR OF NEXT MSG                79380020
         L     R8,AVTDOUBL+4 .                                          79410020
         LA    R8,PRFSUNIT-IEDQPRF(R8) .SET BASE FOR USIGN              79440020
         B     COMPARE1 .                                               79470020
TAKEOUT  EQU   * .                                                      79500020
         MVC   PRFNHDR(3),PRFNHDR-IEDQPRF(R2) .                         79530020
*                                       LINK NHDR OF THIS MSG   SA51078 79560022
*                                       INTO NHDR OF PREV ONE   SA51078 79660022
         DROP  R8 .                                                     79830020
         USING IEDQPRF,RPREFIX .                                        79860020
         LR    R8,R6 .                  SET 8 FOR MOVE                  79890020
         TM    PRFSTAT1,PRFNHDRN .      IS THIS A HDR                   79920020
         BNO   MVCCRCD .                BR IF HDR TO SET CRCD TO        79950020
*        DISK HDR ADDRESS                                               79980020
         LA    R8,PRFCHDR-PRFCRCD(R8) . IF NOT HDR SET TO UPDATE        80010020
*        THE CHDR FIELD TO THE REAL ADDRESS OF THE DISK HDR             80040020
MVCCRCD  EQU   * .                                                      80070020
         MVC   PRFCRCD-IEDQPRF(3,R8),PRFCRCD-IEDQPRF(R2) .              80100020
*        UPDATE TO THE PROPER DISK ADDRESS OF THE HDR TO WRITE          80130020
*        THE SERVICED FLAG                                              80160020
         TM    DATFLAGS,DATLOSTN+DATINITL .       THIS MSG LOST         80190020
         BM    LOSTMSG .                BR IF LOST BUT NOT INIT         80220020
*        TO FREE 1 UNIT                                                 80250020
         TM    PRFSTAT1-IEDQPRF(R2),PRFDUPLN .                          80280020
*                                       IS THIS A DUPL HDR              80310020
         BNO   ALLDUPL .                BR YES                          80340020
*        WHEN IN CORE QUEUES DUPL HDRS ARE COUNTED IN FIRST TIC         80370020
         CLI   PRFNBUNT-IEDQPRF(R2),EONE .  ONLY 1 UNIT IN BFR          80400020
         BH    GETTIC .                 BR MORE THAN 1                  80430020
         MVC   AVTDOUBL+5(3),PRFNTXT-IEDQPRF(R2) .                      80460020
         L     R14,AVTDOUBL+4 .         ADDR NEXT BFR                   80490020
         B     GETDUPCT .                                               80520020
GETTIC   EQU   * .                                                      80550020
         L     R14,PRFTIC-IEDQPRF(R2) . ADDR NEXT UNIT                  80580020
GETDUPCT EQU   * .                                                      80610020
         LA    R14,0(R14) .             CLEAR HI BYTE                   80640020
         LTR   R14,R14 .                MORE BUFFERS FOR THIS DUPL      80670020
         BZ    LOSTMSG .                BR NO TO FREE 1 UNIT            80700020
*        THERE IS NO COUNT TO UPDATE IN THIS CASE                       80730020
         SR    R11,R11 .                                                80760020
         IC    R11,PRFTIC-IEDQPRF(R14) .NUMBER OF DUPL HDRS             80790020
         LTR   R11,R11 .                                                80820020
         BZ    ALLDUPL .                BR IF NONE LEFT                 80850020
         BCTR  R11,0 .                  DECR COUNT                      80880020
         STC   R11,PRFTIC-IEDQPRF(R14) .RESTORE                         80910020
LOSTMSG  EQU   * .                                                      80940020
         XC    PRFTIC+1-IEDQPRF(3,R2),PRFTIC+1-IEDQPRF(R2) .            80970020
         MVI   PRFNBUNT-IEDQPRF(R2),EONE .  SET TO 1 UNIT               81000020
         LR    R1,R2 .                  POST FREED UNIT                 81030020
         LA    R2,AVTBFRTB .                                            81060020
         OI    PRFCORE+2-IEDQPRF(R1),EONE .  SET ADDR BAD               81090020
         MVI   PRFPRI-IEDQPRF(R1),PRIBFRTB .                            81120020
         ST    R7,AVTDOUBL+4 .          SAVE RETURN ADDR                81150020
         L     R7,ADRTNBFR .                                            81180020
         BAL   R14,POST-RTNBFR(R7) .                                    81210020
         L     R7,AVTDOUBL+4 .           RESTORE RETURN ADDR            81240020
         BCTR  R10,R0 .                                                 81270020
CKCMIN   EQU   * .                                                      81300020
         ST    R10,AVTCADDR .           RESTORE CADDR                   81330020
         CL    R10,AVTCMIN .            HAS THE NO. OF CORE UNITS       81360020
         BNL   CKCMAX .                 REACHED THE MINIMUN BR NO       81390020
         OI    AVTSYSER,AVTCMINN .      SET FLAG FOR MIN                81420020
CKCMAX   EQU   * .                                                      81480020
         CL    R10,AVTCMAX .            HAS CADDR BECOME LOWER          81510020
         BCR   10,R7 .                  BR NO                           81540020
         NI    AVTSYSER,AVTCMAXF .      MAX OFF                         81570020
         NI    AVTBIT3,AVTRECVF .       SET REV SWITCH ON               81600020
         BR    R7 .                     RETURN                          81630020
ALLDUPL  EQU   * .                                                      81660020
         LA    R5,1(R5) .               RESET NO. OF UNITS              81690020
         ST    R7,AVTDOUBL+4 .          SAVE RTN ADDR                   81720020
         SR    R8,R8 .                                                  81750020
SETBFR   EQU   * .                                                      81780020
         L     R1,AVTDOUBL .             BFR ADDRESS                    81810020
         OI    PRFCORE+2-IEDQPRF(R1),EONE .  SET BAD ADDR               81840020
         IC    R8,PRFNBUNT-IEDQPRF(R1) .    NO UNITX                    81870020
         L     R7,ADRTNBFR .                                            81900020
         BALR  R14,R7 .                                                 81930020
         SR    R10,R8 .                 SUBTRACT NO IN THIS BFR         81960020
         L     R1,AVTDOUBL .             FROM CADDR                     81990020
         BAL   R7,CKCMIN .                                              82020020
         L     R7,AVTDOUBL+4 .          RTN ADDR                        82050020
         TM    PRFSTAT1-IEDQPRF(R1),PRFNLSTN .                          82080020
         BCR   ZERO,R7 .                                         S21101 82110020
*    IF THE LAST BFR WAS THE LAST SEGMENT RETURN                        82140020
         NC    PRFNTXT-IEDQPRF(3,R1),PRFNTXT-IEDQPRF(R1) .              82170020
         BCR   ZERO,R7 .                BR IF NO NTXT            S21101 82200020
         MVC   AVTDOUBL+1(3),PRFNTXT-IEDQPRF(R1) .                      82230020
*                        ADDR OF NEXT TXT BFR                           82260020
         B     SETBFR .                                                 82290020
ADRTNBFR DC    A(RTNBFR) .                                              82320020
         DROP  15 .                                                     82350020
         USING IEDQCPB,R15 .                                            82380020
.F077    ANOP                                                           82410020
         SPACE 3                                                        82440020
*        WILL GET THE BUFFER SIZE FROM THE TERMINAL TABLE OR DCB        82470020
*        FOR BUILDING THE BUFFERS.                                      82500020
         SPACE 3                                                        82530020
         USING *,15 .                                                   82560020
OFFSETA  EQU   * .                                                      82590020
         TM    LCBSTAT1,LCBSENDN .      SEND OPERATION           A42363 82620021
         BO    OFFSET1 .                BR YES                   A42363 82630021
         TM    LCBSTAT1,LCBRCLLN .      THIS A RECALL            A42363 82640021
         BNO   OFFSET1 .                BR NOT RECALL            A42363 82650021
*        THIS CODE TO EXECUTE ONLY IF RECEIVE RECALL - TEST FOR  A42363 82660021
*        RCV AND RCLL WILL CAUSE RETRIEVE TO PROGRAM CK          A42363 82670021
         L     R1,ADRSZCK1 .                                            82680020
         TM    LCBCHAIN,LCBBFRSZ .      SPECIAL RECALL                  82710020
         BCR   ONES,R1 .                                         S21101 82740020
OFFSET1  EQU   * .                                                      82770020
         LH    R1,PRFDEST .                                             82800020
         TM    PRFSTAT1,PRFNHDRN .      IS THIS A HDR                   82830020
         BNO   TERMENTR .               BR YES                          82860020
*        IF NOT A HDR DOES NOT CONTAIN THE DEST OFFSET                  82890020
USELCBA  EQU   * .                                                      82920020
         LH    R1,LCBTTCIN .            DEST OFFSET                     82950020
TERMENTR EQU   * .                                                      82980020
         N     R1,AVTCLRHI .                                            83010020
         LTR   R1,R1 .                  IS TTCIN 0 - TTCIN IS THE ONLY  83040020
*        ONE OF THE FIELDS PICKED UP THAT CAN BE 0                      83070020
         BNZ   TTCINOK .                BR IF NOT 0 - THIS ISNOT        83100020
*        RETRIEVE                                                       83130020
         TM    LCBSTAT2,LCBDIAL         IS THIS DIAL LCB          M2321 83140021
         BO    TTCINOK                  YES,BRANCH -NOT RETRIEVE  M2321 83150021
         MVC   LCBERBQB+1(2),AVTKEYLE . IF RETRIEVE - SET TO BUILD      83160020
         MVI   LCBERBQB,X'01' .         SINGLE UNIT BFRS                83190020
         MVI   LCBERB,X'00' .                                           83220020
         BR    R7 .                     RETURN                          83250020
TTCINOK  EQU   * .                                                      83280020
         L     R15,AVTRNMPT .                                           83310020
         BALR  R14,R15 .                                                83340020
*        TERM TABLE ENTRY ADDRESS IS IN R1,  IF BUFFER SIZE IS          83370020
*        SPECIFIED IN T TABLE, PUT IT IN LCBERBQP+1, IF NOT             83400020
*        USE DCBBFSZE.                                                  83430020
         USING *,15 .                                                   83460020
         LR    R15,R14 .                RESET ADDRESSIBILITY            83490020
         USING IEDQTRM,R1 .                                             83520020
         TM    TRMDEVFL,X'80' .         IS A BFR SZ SPECIFIED           83550020
         BNO   USEDCBA .                                                83580020
*        IF FROM T TABLE                                                83610020
         SR    R10,R10 .                ZERO REG                        83640020
         LA    R14,TRMOPNO+1 .          LOC OF BFR SZ IF NO OPT         83670020
         TM    TRMSTATE,TRMOPTFN .      ARE OP. SPECIFIED               83700020
         BNO   NONE .                   BR NO                           83730020
         LR    R14,R10 .                ZERO 14                         83760020
         IC    R14,TRMOPNO .            NO OF OPT FIELDS                83790020
         LA    R14,TRMOPT+1(R14) .      ADDR OF OPT FIELDS + 1  + NO    83820020
*        OF OPT FIELDS GIVES THE LOCATION OF BFR SIZE                   83850020
         DROP  R1 .                                                     83880020
NONE     EQU   * .                                                      83910020
         MVC   LCBERBQB+1(2),0(R14) .   SET ERBQB                       83940020
         LH    R1,LCBERBQB+1 .                                          83970020
         L     R11,ADSBTR .                                             84000020
         BALR  R14,R11 .                                                84030020
         SRL   R10,DIV4 .               ADJUST R10               S21101 84040020
         B     SIZEDONE .                                               84060020
USEDCBA  EQU   * .                                                      84090020
         L     RDCB,LCBDCBPT .          DCB ADDR                        84120020
         LH    R1,DCBBFSZE .            SET SIZE AND NUMBER OF          84150020
         STH   R1,LCBERBQB+1 .          UNITS IN BFR IN                 84180020
         IC    R10,DCBUNTCT .           ERBQB AND ERBQB+1               84210020
SIZEDONE EQU   * .                                                      84240020
         STC   R10,LCBERBQB .                                           84270020
         MVI   LCBERBKY,AVTEZERO .     SET SIZE THERE FLAG              84300020
         BR    R7 .                                                     84330020
ADSBTR   DC    A(SUBTRKEY) .                                            84360020
ADRSZCK1 DC    A(SIZECK1) .                                             84390020
         USING IEDQCPB,R15 .                                            84420020
*        WILL ENQUEUE AN ELEMENT ( BFR ,ERB, OR CPB) ON A FIFO Q        84450020
ENQMGRBA EQU   * .                                                      84480020
         USING ENQMGRBA,R14                                             84490006
*        INPUT PARAMETERS - R2 - Q ADDR, R15 - ELEM ADDR                84510020
*        R14 - BASE REG     R1 - SCRATCH REG     ¢ 15 WILL BE KEPT      84540020
         XC    PRFLINK-IEDQPRF(3,R15),PRFLINK-IEDQPRF(R15) .            84570020
*        CLEAR LINK FIELD OF BFR OR ERB                                 84600020
         LTR   R2,R2 .                  SET POSITIVE COND CODE          84630020
         BAL   R14,NOMPCK               SKIP TS INSTRUCTION      Y02027 84660006
         AIF   (&A EQ 1).F023                                           84690020
ENQMGRCA EQU   * .                                                      84720020
*        WHEN ENTERED HERE THE HI BYTE OF 14 IS 0                       84750020
.F023    ANOP                                                           84780020
         USING *,R14 .                                                  84810020
MPLOOP   EQU   *                                                 Y02027 84813006
         TS    AVTEZERO(R2)             LOCK Q FOR UPDATE        Y02027 84817006
         BNE   MPLOOP                   YES, LOOP TILL APP. DONE Y02027 84824006
NOMPCK   EQU   *                                                 Y02027 84831006
         L     R1,4(R2) .               ADDR LASR ON Q                  84840020
         LA    R1,PRFLINK-IEDQPRF(R1) . SET ADDR OF LINK FIELD          84870020
         AIF   (&A EQ 1).F024                                           84900020
         SPM   R14 .                    RESET COND CODE                 84930020
         BP    ENQBFR .                 BR IF A BFR OR ERB              84960020
         LA    R1,((CPBNEXT-IEDQCPB)-(PRFLINK-IEDQPRF))(R1) .           84990020
*        IF IT WAS A CPB CORRECT THE ADDR OF LINK FIELD                 85020020
         XC    CPBNEXT(3),CPBNEXT .     ZERO CPB LINK FIELD             85050020
.F024    ANOP                                                           85080020
ENQBFR   EQU   * .                                                      85110020
         ST    R15,4(R2) .              SET NEW LAST ELEM               85140020
         NC    1(3,R2),1(R2) .          IS ONE ON THE Q                 85170020
         BNZ   ENQNMTY .                BR IF YES                       85200020
         MVC   1(3,R2),5(R2) .          IF NOT SET ADDR OF FIRST        85230020
         MVI   AVTEZERO(R2),AVTEZERO    CLEAR Q LOCK             Y02027 85240006
         BR    R11 .                    RETURN                          85260020
ENQNMTY  EQU   * .                                                      85290020
         MVC   0(3,R1),5(R2) .          LINK THIS ONE TO PREVIOUS       85320020
         MVI   AVTEZERO(R2),AVTEZERO    CLEAR Q LOCK             Y02027 85330006
         BR    R11 .                    LAST ONE AND RETURN             85350020
         TITLE '''IEDQFA'' - DSECTS' .                           S22025 85380022
*        TPRIOR                                                         85410020
         TPRIOR                                                         85440020
         EJECT , .                                               S22025 85470022
*        DCBD                                                           85500020
         DCBD  DSORG=TX .                                               85530020
DCBBFSZE EQU   DCBBUFSI .                                               85560020
         EJECT , .                                               S22025 85590022
*        TDISPD                                                         85620020
         TDISPD                                                         85650020
         EJECT , .                                               S22025 85680022
*        TCPBD 3330                                              S21101 85710021
         TCPBD 3330                                              S21101 85720021
         EJECT , .                                               S22025 85770022
*        TDATD                                                          85800020
         TDATAD                                                         85830020
         EJECT , .                                               S22025 85860022
*        TSCBD                                                          85890020
         TSCBD                                                          85920020
XFEFO    EQU   SCBFEFO .                                                85950020
SCBSQOUT EQU   SCBCLSEG+1-IEDQSCB .                                     86010020
         EJECT , .                                               S22025 86040022
*        TQCBD                                                          86070020
         TQCBED .                       QCBE DSECT               S22026 86080022
         TQCBD                                                          86100020
         EJECT , .                                               S22025 86130022
*        TPRFD                                                          86160020
         TPRFD                                                          86190020
         EJECT , .                                               S22025 86220022
*        TLCBD                                                          86250020
         TLCBD                                                          86280020
LCBNSRCD EQU   X'01' .                  IN-SOURCE CHAIN FLAG     S22025 86310022
         EJECT , .                                               S22025 86320022
*        TTRMD                                                          86340020
         TTRMD                                                          86370020
         EJECT , .                                               S22025 86400022
*        TAVTD , .                                               S22025 86430022
         TAVTD , .                                               S22025 86460022
         TTSID                                                   S22028 86470022
         MEND                                                           86490020
./  ADD  SSI=80470109,NAME=MIEDQHM
         MACRO                                                          00060020
     MIEDQHM    &X                                                      00120020
.*A-000000-999999                                              @X31X8Q0 00150008
         LCLA  &A                                                       00180020
.*CHANGE ACTIVITY= AS FOLLOWS:                                          00180522
.*A526200                                                        S22029 00181022
.*C159600                                                        S22029 00181122
.*A103200,243600,286800,307200,316200,423000,423600,820200       S21101 00181222
.*A904800                                                        S21101 00181322
.*C123000,131400,300000,301800,338400,400800-402000              S21101 00181422
.*C211800-212400                                                 S21101 00181522
.*D235200-238200,263400-270600,309600                            S21101 00181622
.*C121800,447000                                                 A42363 00181722
.*C123000,865200                                                 A42367 00181822
.*A868800                                                        A42367 00181922
.*C123000                                                        A42400 00182022
.*A525000                                                        A42400 00182122
.*D527400                                                        A42400 00182222
.*A199200,202800                                                 S21101 00182322
.*A707000                                                        A47137 00182422
.*C160800-162000,528600-529800,535800                            S22026 00182522
.*A109900-110100,162300,544860-545340,906300                     S22026 00182622
.*A106800,131630,131952                                          A51765 00182722
.*A489100-489300                                                SA52986 00182822
.*C487200                                                       SA52986 00182922
.*D487400-487600                                                SA52986 00183022
.*A103500,393700-394100,397280-397680                           SA57334 00183122
.*D395400-396600                                                SA57334 00183222
.*A103400,110130,128460,129600,131670,261600,323400,377400,434400S22025 00183322
.*A910800,918000                                                 S22025 00183422
.*C009000,012000,111000,121200,213300,253200,262800,328800,378600S22025 00183522
.*C385800,416400,489600,559800,772800,902400,906400,907800,909000S22025 00183622
.*C913200,915000,916800,922200,924000                            S22025 00183722
.*A480600,579600,846600,847800,860400,900000,915300             SA52971 00183822
.*C639000-639400,640200-642600,849000-849930,866400-892200      SA52971 00183922
.*C901200-902280                                                SA52971 00184022
.*D850800                                                       SA52971 00184122
.*A275470,484800-486800                                         SA51078 00184222
.*A275540-275890                                                SA50192 00184322
.*A381030-381570                                                SA51783 00184422
.*D484800-489300,909000                                         SA51078 00184522
.*D886800                                                       SA58988 00184622
.*A886800-886860                                                SA58988 00184722
.*A018600                                                        S21903 00184822
.*A546600                                                       SA59006 00184922
.*A432200                                                       SA60012 00185022
.*C002399,019800                                                SA60012 00185122
.*C117000-117500,532800,543600-544200,545340                    SA61768 00185200
.*A532800                                                       SA61768 00185300
.*D536400,541800-542400                                         SA61768 00185400
.*A654000,654600                                                SA61085 00185500
.*A110340,894600,897600                                         OX02183 00195554
.*C307720,308400                                                SA66611 00205554
.*A547000                                                      @XA05307 00205661
.*A529000                                                        X03039 00210608
* A275680                                                      @SA71682 00215661
.*A377700                                                       OX06353 00215761
.*C668400-677400,681600,718800-719400,720600                   @SA72466 00219761
.*D680400,709200,687000                                        @SA72466 00223761
.*A682800,713400,723600                                        @SA72466 00227761
.*A894600,897900,103400                                        @YA06890 00231761
*A849030                                                       @SA74018 00232700
*A605400,687600,742200                                         @YA07705 00233700
*C547200,553200                                                @SA74250 00234700
* A686400                                                      @SA74250 00235700
*C349800,356400,360600                                         @XA11314 00236700
*A275680                                                       @SA76275 00237700
*A588600                                                       @ZA06194 00238700
*A849046                                                       @SA76309 00238881
*A588600                                                       @OY12977 00239100
*D589200                                                       @OY12977 00239400
*A674400                                                       @OY14492 00239500
*A674400                                                                00239600
*D686700-687300                                                         00239700
*A103800,128400                                                         00239800
*A850280                                                       @OZ29731 00239982
*A103800,849720                                                @OX16398 00240000
*C849870                                                       @OX16398 00270000
         SPACE 3                                                        00300000
         AIF   ('&X' NE 'CORE').CKD                                     00500000
&A       SETA  1                                                        00700000
IEDQHM1  TITLE '''IEDQHM'' - DESTINATION SCHEDULER (CORE ONLY)'  S22025 00900022
IEDQHM1  CSECT                                                          00960020
         AGO   .GO                                                      01020020
.CKD     AIF   ('&X' NE 'DISK').BOTH                                    01080020
&A       SETA  2                                                        01140020
IEDQHM2  TITLE '''IEDQHM'' - DESTINATION SCHEDULER (DISK ONLY)'  S22025 01200022
IEDQHM2  CSECT                                                          01260020
         AGO   .GO                                                      01320020
.BOTH    ANOP                                                           01380020
&A       SETA  3                                                        01440020
IEDQHM3  TITLE '''IEDQHM'' - DESTINATION SCHEDULER (DISK AND CORE)'     01500022
IEDQHM   CSECT                                                          01560020
.GO      ANOP                                                           01620020
         ENTRY IEDQHM02                                                 01680020
*                                                                       01740020
*********************************************************************** 01800020
*                                                                     * 01860020
         AIF   ('&X' NE 'CORE').TAG1                             S21903 01864022
*  MODULE NAME = IEDQHM1 ( CORE )                                     * 01868000
         AGO   .TAG3                                             S21903 01872022
.TAG1    AIF   ('&X' NE 'DISK').TAG2                             S21903 01876022
*  MODULE NAME = IEDQHM2 ( DISK )                                     * 01880000
         AGO   .TAG3                                             S21903 01884022
.TAG2    ANOP                                                    S21903 01888022
*  MODULE NAME = IEDQHM ( MIXED - CORE / DISK )                       * 01892000
.TAG3    ANOP                                                    S21903 01896022
*                                                                     * 01900000
*  DESCRIPTIVE NAME = DESTINATION SCHEDULER                           * 01920000
*                                                                     * 01940000
*  COPYRIGHT = 'NONE'                                                 * 01960000
*                                                                     * 01980000
*  STATUS:  CHANGE LEVEL 8                                     @Z30X8QE 02000008
*                                                                     * 02040020
*FUNCTION -- THIS SUBTASK ASSIGNS A BUFFER TO A LOCATION IN A         * 02100020
*   MESSAGE QUEUE3 DATA SET (REUSEABLE DISK, NONREUSEABLE DISK, OR    * 02160020
*   CORE AS APPLICABLE).  THIS BUFFER WILL BE CHAINED TO OTHER        * 02220020
*   BUFFERS OF THIS MESSAGE AND THIS MESSAGE WILL BE CHAINED TO       * 02280020
*   OTHER MESSAGES IN THE SAME QUEUE.                                 * 02340020
*    THE HEADER OF THE MESSAGE MUST CONTAIN THE ADDRESS OF THE        * 02400020
*    NEXT TEXT SEGMENT AND THE NEXT MESSAGE HEADER.  ALL BUFFERS      * 02460020
*    MUST HAVE THE ADDRESS OF THE NEXT TEXT (IF IT IS NOT THE         * 02520020
*    LAST BUFFER), THE ADDRESS OF THE ADDITIONAL RECORES (IF ANY),    * 02580020
*    AND  IF IT IS NOT A HEADER, IT WILL HAVE THE ADDRESS OF ITS      * 02640020
*    HEADER.                                                          * 02700020
*                        DISK QUEUEING                                * 02760020
*    IF THE MESSAGE IS DISK QUEUED, THE HEADER AND LAST TEXT          * 02820020
*    BUFFERS ILL CONTAIN THE QBACK CHAIN POINTERS.  QBACK CHAIN IS    * 02880020
*    A TIME SEQUENTIAL RECORD OF THE EVENTS (BOTH SENDING AND         * 02940020
*    RECEIVING) FOR THIS QCB.  IF THE QCB REPRESENTS THE DESTINATION  * 03000020
*    OF THE MESSAGE, THE HEADER WILL APPEAR IN THE QBACKCHAIN FROM    * 03060020
*    THAT QCB.  IF THE QCB REPRESENTS THE SOURCE OF THE MESSAGE       * 03120020
*    (LINE OR TERMINAL) THE LAST BUFFER OF THE MESSAGE WILL APPEAR    * 03180020
*    IN THE QBACK CHAIN OF THE QCB.                                   * 03240020
*    DISK MESSAGE QUEUEING (REUSABLE OR NONREUSABLE) WILL BE          * 03300020
*    ACCOMPLISHED BY ASSIGNING RECORD NUMBERS AHEAD ON DISK.          * 03360020
*    THERE EXISTS A VALUE CALLED 'ADDRESS' FOR BOTH REUSABLE (RADDR)  * 03420020
*    AND NONREUSABLE (NADDR) DISK.  THERE IS A CORRESPONDENCE         * 03480020
*    BETWEEN THE VALUE OF ADDRESS AND THE PHYSICAL LOCATION           * 03540020
*    (MBBCCHHR) OF THE RECORD ON DISK.  WHEN ADDRESS MODULO           * 03600020
*    (THE TOTAL NUMBER OF RECORDS IN THE DATA SET) IS USED, THIS      * 03660020
*    IS A ONE TO ONE CORRESPONDENCE.  WHEN A 'HEADER NOT LAST'        * 03720020
*    BUFFER IS RECEIVED, A VALUE OF ADDRESS IS RESERVED FOR THE NEXT  * 03780020
*    HEADER FOR THE QCB AND THE NEXT TEXT BUFFER OF THIS MESSAGE.     * 03840020
*    SEQUENTIAL VALUES OF ADDR ARE RESERVED FOR ANY ADDITIONAL        * 03900020
*    RECORDS REQUIRED.  WHEN A 'TEXT NOT LAST' IS RECEIVED LOCA-      * 03960020
*    TIONS FOR NEXT TEXT AND ADDITIONAL RECORDS ARE RESERVED.         * 04020020
*    WHEN A 'LAST' BUFFER IS RECEIVED, NO NEXT TEXT IS RESERVED.      * 04080020
*                        CORE QUEUEING                                * 04140020
*    THE CORE QUEUES DATA SET IS NOT DIVIDED INTO NUMBERED            * 04200020
*    RECORDS.  ONE RECORD CORRESPONDS IN SIZE TO ONE BUFFER UNIT      * 04260020
*    UNITS ARE NOT ASSIGNED AHEAD AS IN DISK QUEUES, HOWEVER THE      * 04320020
*    MESSAGES  IN ONE QUEUE ARE CHAINED TOGETHER AND THE BUFFERS      * 04380020
*    OF A MESSAGE ARE CHAINED TOGETHER,  THERE IS A VALUE CADDR       * 04440020
*    SIMILIAR TO ADDRESS ON DISK WHICH CORRESPONDS TO THE NUMBER OF   * 04500020
*    UNITS WHICH ARE USED OUT OF THE NUMBER RESERVED FOR CORE         * 04560020
*    QUEUES.  CHAINING IS NOT DONE BY RECORD NUMBER FOR CORE QUEUES   * 04620020
*    BUT BY THE ACTUAL ADDRESS.   THE ADDITIONAL RECORDS AND          * 04680020
*    LOCATED THROUGH THE TIC FIELDS OF THE BUFFER UNITS WHILE IN      * 04740020
*    THE CORE QUEUE.  WHEN A BUFFER IS RECIEVED, IF IT IS A HEADER    * 04800020
*    IT IS CHANED TO THE PREVIOUS HEADER IN THE QUEUE.  IF IT IS A    * 04860020
*    TEXT, IT IS CHAINED TO THE PREVIOUS BUFFER OF THIS NESSAGE.  A     04920020
*    NUMBER OF UNITS CORRESPONDING TO THE NUMBER OF UNITS IN THE        04980020
*    BUFFER WILL BE REMOVED FROM THE FREE CORE QUEUE UNITS (LINE      * 05040020
*    BUFFER POOL).  IF THIS QCB'S MESSAGES ARE TO BE CORE QUEUED ONLY * 05100020
*    THESE UNITS ARE POSTED TO THE AVAILABLE BUFFER POOL IN           * 05160020
*    RETURN FOR THE BUFFER.  THE BUFFER IS THEN PLACED THE THE        * 05220020
*    QCB'S CORE QUEUE OF MESSAGES.   IF THE MESSAGE IS THE BE DISK    * 05280020
*    QUEUED ALSO, THE MESSAGE WILL BE COPIED INTO THESE UNITS AND     * 05340020
*    BUFFER FORMED WILL BE PLACED IN THE QCB'S MESSAGE QUEUE.         * 05400020
*    THE ORIGINAL BUFFER WILL THEN BE DISK QUDUED.                    * 05460020
*                                                                     * 05520020
*ENTRY POINTS -- THIS ROUTINE HAS TWO ENTRY POINTS                    * 05580020
*    1. IEDQHM / FROM THE DISPATCHER WITH A FULL BUFFER TO BE         * 05640020
*       QUEUED.                                                       * 05700020
*       CALLING SEQUENCE -                                            * 05760020
*                  L      R15,ENTRY POINT ADDRESS                     * 05820020
*                  L    R1,BUFFER ADDRESS                             * 05880020
*                  BR    R15                                          * 05940020
*    2. IEDQHM02 / FROM THE REUS-RECOPY SUBTASK WITH ONE UNIT OF      * 06000020
*       A BUFFER TO BE QUEUED.                                        * 06060020
*       CALLING SEQUENCE                                              * 06120020
*                  L    R15,ENTRY POINT ADDRESS                       * 06180020
*                  L    R1,UNIT ADDRESS                               * 06240020
*                  BALR  R14,R15                                      * 06300020
*                                                                     * 06303020
*    3. IEDQHM03 -- CALLED BE THE REUS COPY SUBTASK WITH A            * 06306020
*       PRIORITY QCB                                                  * 06309020
*       CALLING SEQUENCE --             L     R15,ADDR HM03           * 06312020
*                                       BALR  R14,R15                 * 06315020
*       RETURN CODES -- IF RETURN IS BR R14 - THE MESSAGE ON THE      * 06318020
*          PRIORITY QCB IS NOT BEING SENT                             * 06321020
*          IF RETURN IS B  4(R14) - THE MESSAGE IS BEING SENT         * 06324020
*                                                                     * 06327020
*    4. FINDSTCB -- CALLED FROM REUS - COPY WITH A DESTINATION        * 06330020
*       QCB.  UPON RETURN THE SEND SCHEDULER WILL HAVE BEEN           * 06333020
*       NOTIFIED THAT THERE IS A MESSAGE TO SEND.                     * 06336020
*       CALLING SEQUENCE -              L     R12,HMBASE              * 06339020
*                                       L     RX,OFFSET OF SUBROUTINE * 06342020
*                                       BAL   R14,R12+RX              * 06345020
*                                                                     * 06360020
*INPUT -- R15 WILL CONTAIN THE ENTRY POINT ADDRESS                    * 06420020
*    R1 - THE BUFFER ADDRESS                                          * 06480020
*    R13  THE AVT ADDRESS AND SAVE AREA ADDRESS                       * 06540020
*                                                                     * 06600020
*OUTPUT -- THE BUFFER WILL CONTAIN THE QUEUEING POINTERS MENTIONED    * 06660020
*    ABOVE.                                                           * 06720020
*    IF THE BUFFER WAS DISK QUEUED THE BUFFER WILL BE POSTED TO THE   * 06780020
*    DISK O /I QCB TO BE WRITTEN ON DISK.                             * 06840020
*    IF THE BUFFER WAS CORE QUEUED ONLY, A CORRESPONDING NUMBER OF    * 06900020
*    UNITS WILL BE RETURNED TO THE AVAILABLE BUFFER POOL.             * 06960020
*    IF THE ENTRY WAS FROM COPY SUBTASK WITH A CORE ONLY BUFFER,      * 07020020
*    THE FERE CORE UNIT WILL BE RETURNED TO COPY.                     * 07080020
*                                                                     * 07140020
*EXTERNAL ROUTINES -- DSPPOSTR - TO INSERT AN ELEMENT BY PRIORITY     * 07200020
*    ON THE READY QUEUE.                                              * 07260020
*    DSPUNAVR - TO REMOVE A STCB FROM THIS QCBS STCB CHAIN AND        * 07320020
*    INSERT IT BY PRIORITY INTO THE STCB CHAIN OF ANORHER QCV.        * 07380020
*    AVTRNMPT - TO FIND THE ADDRESS OF THE TERM TABLE ENTRY FROM      * 07440020
*    THE OFFEST INTO THE TERM NAME TABLE                              * 07500020
*                                                                     * 07560020
*EXITS-NORMAL -- TO THE DISPATCHER AT DSPPOST OR DSPDISP OR IF        * 07620020
*    CALLED BY COPY - TO THE CALLING ROUTINE WITH R15 =0              * 07680020
*                                                                     * 07740020
*EXITS -ERROR -- NONE                                                 * 07800020
*                                                                     * 07860020
*TABLES/WORK AREAS -- DSECTS- LCB,DCB,SCB,PREFIX,AVT 4,QCB            * 07920020
*   AVT FIELDS - RADDR,NADDR,CADDR                                    * 07980020
*                                                                     * 08040020
*ATTRIBUTES -- REUSEABLE,REFRESHABLE,ENABLED,RESIDENT                 * 08100020
*                                                                     * 08160020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 08220020
*    PARTICULAR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER     * 08280020
*    SET.                                                             * 08340020
*                                                                     * 08400020
*********************************************************************** 08460020
         EJECT                                                          08520020
R0       EQU   0                        WORK REGISTER                   08580020
R1       EQU   1                        ELEMENT ADDRESS FORM DISP       08640020
*                                       PARAMETER TO TERM NAME TBL      08700020
*                                       ELEMENT ADDR TO DISP            08760020
R2       EQU   2                        ADDRESS OF THE VALUE            08820020
*                                       OF ADDRESS BEING USED           08880020
*                                       (RADDR,NADDR)                   08940020
*                                       ADDRESS OF QCB TO POST T TO     09000020
RSCB     EQU   3                        ADDR OF SCB                     09060020
RLCB     EQU   4                        ADDR OF LCB                     09120020
R5       EQU   5                        WORK REGISTER                   09180020
*                                       ADDR OF BUFFER FORMED           09240020
*                                       FROM CORE UNITS                 09300020
RPREFIX  EQU   6                        ADDRESS OF BUFFER               09360020
RPRF     EQU   6                        ADDRESS OF BUFFER               09420020
R6       EQU   6                                                        09480020
RQCB     EQU   7                        ADDRESS OF MASTER QCB           09540020
R7       EQU   7                        WORK REGISETER                  09600020
RPQ      EQU   8                        ADDR OF PRIORITY QCB            09660020
R9       EQU   9                        WORK REGISTER                   09720020
R10      EQU   10                       WORK REGISTER                   09780020
R11      EQU   11                       WORK REGISTER                   09840020
*                                       DISP BASE REG                   09900020
R12      EQU   12                       PROGRAM BASE                    09960020
R13      EQU   13                       AVT ADDRESS                     10020020
R14      EQU   14                       NUMBER OF CORE UNITS TO GET     10080020
*                                       WORK REG. AND RETURN REG        10140020
R15      EQU   15                       WORK REGISTER                   10200020
*********************************************************************** 10260020
         SPACE 2                                                        10320020
ONE      EQU   1 .                                               S22025 10340022
TWO      EQU   2 .                      CONSTANT               @YA06890 10345061
HEX01    EQU   X'01'                    TEST FOR MULTI-UNIT BFR SA57334 10350022
MULT4    EQU   2 .                      VALUE FOR RRN ADJUSTMENT S21101 10370020
DIV4     EQU   2 .                      VALUE FOR RRN ADJUSTMENT S21101 10372020
ROUNDER  EQU   3 .                      VALUE FOR RRN ADJUSTMENT S21101 10374020
INCR     EQU   4 .                      VALUE FOR ADDR INCREMENT S21101 10376020
THREE    EQU   4                                                        10380020
D24      EQU   24                       DISPLACEMENT           @OX16398 10440000
D28      EQU   28                       DISPLACEMENT           @OX16398 10500000
REGSAVE  EQU   28                       OFFSET INTO SAVEAREA   @XM05843 10560000
PRIEXOFS EQU   13                       OFFSET TO PRIEXIT      @XM05843 10620000
ADDR     EQU   7                        MASK FOR ICM STCM      @XM05843 10680000
         SPACE 1                                                        10740020
*        PRFTIC FLAGS WILL BE AS FOLLOWS                                10800020
*              X'28' - TO BE QUEUED ON REUSABLE DISK                    10860020
*              X'18' - TO BE QUEUED ON NONREUSABLE DISK                 10920020
*              X'40' - TO BE QUEUED IN MS QUEUES                        10980020
CONC     EQU   X'20' .                                           S22026 10990022
CLOCK    EQU   X'80' .                                           S22026 11000022
INTVL    EQU   X'70' .                                           S22026 11010022
         SPACE 2 .                                               S22025 11013022
*****************************************************************S22025 11016022
*                                                                S22025 11019022
*** CONDITION CODE MASKS                                         S22025 11022022
*                                                                S22025 11025022
*****************************************************************S22025 11028022
         SPACE 2 .                                               S22025 11031022
ZEROES   EQU   8 .                      ZEROES CONDITION         S22025 11034022
FOUR     EQU   4 .                      CONSTANT                OX02183 11037054
         EJECT                                                          11040020
         USING AVTSAVE2,R13 .                                    S22025 11100022
         USING IEDQLCB,RLCB                                             11160020
         USING IEDQPRF,RPRF                                             11220020
         USING IEDQSCB,RSCB                                             11280020
          USING  IEDQQCB,RQCB                                           11340020
          USING  IEDQPQCB,RPQ                                           11400020
         USING IEDQDISP,R11                                             11460020
         USING IEDQDATA,R2                                              11520020
         SPACE 2                                                        11580020
         DC    AL1(DSPMCPL6)                                            11640020
         DC    AL3(FINDSTCA)            ADDRESS OF SUBROUTINE   SA61768 11700000
*              CALLED BY QFA AND 19RP TO ACTIVATE THE SEND      SA61768 11720000
*              SCHEDULER                                        SA61768 11740000
          DC    X'00',X'00'                                             11760020
         SPACE 2                                                        11820020
         USING *,12                                                     11880020
         SPACE 1                                                        11940020
DESTSCH  EQU   *                                                        12000020
         LA    R12,0(0,R15)             SET BASE REG                    12060020
IEDQHM&A IEDHJN QUEUE .                 MODULE ID AND DATE       S22025 12120022
          LR    RPREFIX,R1                                              12480020
         L     RLCB,PRFLCB-1                                            12540020
         L     RSCB,LCBSCBA-1           SCB ADDR                        12600020
         L    RQCB,SCBDESTQ-1                                           12660020
         LA    RPQ,QCBMSIZE(RQCB)       ADDR OF FIRST PQCB              12720020
         LA    R11,QCBPEND-IEDQPQCB     SIZE OF A PRTY QCB              12780020
         SR    R10,R10                                                  12840020
         TM    LCBSTAT1,LCBRECVN        IS RECEIVE BIT ON?     @AS05843 12840700
         BZ    ENDEXTST                 NO, NO EXIT USED       @AS05843 12841400
         TM    PRFSTAT1,PRFDUPLN        DUPLICATE HEADER?      @AS05843 12842100
         BZ    ENDEXTST                 NO, NO EXIT USED       @AS05843 12842800
         L     R15,AVTRDYA              GET ADDR OF USER EXITS @AS05843 12843500
         ICM   R15,ADDR,PRIEXOFS(R15)   GET ADDR OF PRIEXITS   @AS05843 12844200
         BZ    ENDEXTST                 NO EXIT SPECIFIED      @AS05843 12844900
         MVI   SCBPRI,AVTEZERO          SET ZERO PRIORITY      @AS05843 12846000
         STM   R2,R12,AVTSAVE3+REGSAVE  SAVE REGS              @AS05843 12846800
         BALR  R14,R15                  BRANCH TO USER         @AS05843 12847600
         LM    R2,R12,AVTSAVE3+REGSAVE  RESTORE REGS           @AS05843 12848400
         STC   R15,SCBPRI               SET NEW PRIORITY       @AS05843 12849200
ENDEXTST EQU   *                                               @AS05843 12850000
         TM    PRFSTAT1,PRFDUPLN        DUP HEADER               S22025 12850800
         BO    BUMPCNT                  YES, BUMP COUNT          S22025 12852022
         TM    PRFSTAT1,PRFNLSTN        EOM                      S22025 12858022
         BO    CNTOK                    NO, DON'T BUMP COUNT     S22025 12864022
BUMPCNT  EQU   *                                                 S22025 12870022
         LH    R9,QCBMSGCT .            THE COUNT OF MESSAGES    S22025 12876022
         LA    R9,1(,R9) .              SHOULD BE INCREMENTED    S22025 12882022
         STH   R9,QCBMSGCT .            EACH EOM OR DUP HEADER   S22025 12888022
CNTOK    EQU   *                                                 S22025 12894022
         TM    PRFSTAT1,PRFNHDRN        IS THIS A HEADER                12900020
         BO    TXTBFR                   BR NO                           12960020
         TM    PRFSTAT1,PRFERMGN        IS THIS AN ERROR MSG     S22025 12980022
         BO    COMPARE                  YES, BRANCH              S22025 13000022
         NI    SCBQTYPE,X'0F' .         CLEAR QTYPE FOR HDRS            13020020
         TM    LCBSTAT1,LCBINITN        INITIAE MODE                    13080020
         BZ    COMPARE .                BRANCH NO INITIATE MODE  S21101 13140021
         SPACE                                                          13163021
         L     R15,QCBDCBAD-1 .         ADDR OF DEST DCB         A51765 13167022
         TM    DCBPCI-IHADCB(R15),PCISEND IS PCI=A/PCI=X         S22025 13171022
*                                            SPECIFIED FOR SEND  S22025 13175022
         BZ    NOTINIT .                BR IF NO PCI             S22025 13179022
         CLI   LCBRSKEY,DSPBUFSC .      INITIATE FUNCTION NOT    S21101 13186021
         BNE   OUT .                      SUPPORTED FOR BUFFERED S21101 13190621
*                                         TERMINAL AS SOURCE     S21101 13195221
NOTINIT  EQU   * .                                               A51765 13197222
         NI    LCBSTAT1,X'FF'-LCBINITN . TREAT AS FEFO MESSAGE   S21101 13199821
COMPARE  EQU   *                                                        13200020
         CLC   SCBPRI(1),QCBPRIPQ  IS THIS MSG PRTY SAME                13260020
*                                       AS THIS QCB PRTY                13320020
         BNL   OUT .                    BR IF THIS MSG IS HI OR EQ      13380020
*                                       LAST QCB HAS 0 PRI              13440020
         LA    R10,1(,R10) .            SET OFFSET TO NEXT QCB          13500020
         AR    RPQ,R11 .                ADDR OF NEXT PQCB               13560020
         B     COMPARE .                GO LOOK AT IT                   13620020
         SPACE 1                                                        13680020
NOINIT   EQU   *                                                        13740020
*        IF QCB IS FOR 24 HOUR DELAY DO NOT REMOVE IT                   13800020
         NI    LCBSTAT1,LCBINITF        RESET INIT MODE                 13860020
         B     GETSIZE                                                  13920020
POSTSUB  EQU   *                                                        13980020
         LA    R2,AVTBFRTB              ADDR OF BFRRTN QCB              14040020
         MVI    PRFPRI-IEDQPRF(R1),PRIBFRTB                             14100020
POSTSUBA EQU   *                                                        14160020
         ST   RSCB,AVTSAVE3                                             14220020
          BAL   R14,POSTA                                               14280020
         L    RSCB,AVTSAVE3                                             14340020
          L     RQCB,SCBDESTQ-1         RESTORE QCB ADDR                14400020
         BR    R10 .                    RETURN                          14460020
SENDINIT EQU   *                                                        14520020
         TM    LCBSTAT1,LCBINITN+LCBRECVN                               14560020
*        RECEIVING AN INITIATE MODE MESSAGE                             14600020
         BCR   14,R14 .                 BR NOT INIT                     14640020
         TM    LCBINSRC+2,XXXON .       NOW BEING SENT                  14700020
         BCR   1,R14 .                  BR NOT GEING SENT               14760020
         L     R1,LCBINSRC-1 .          ADDR OF DEST LCB                14820020
         TM    LCBSTAT1-IEDQLCB(R1),LCBINITN .   STILL BEING SENT       14880020
         BCR   14,R14 .                 BR NOT BEING SENT               14940020
         B     4(R14)                   BR INIT BEING SENT              15000020
TXTBFR   EQU   *                                                        15060020
         IC    R10,SCBPRI .             OFFSET TO PRI QCB               15120020
         MR     R10,R10 .                                               15180020
          AR    RPQ,R11                 + QCB ADDR                      15240020
         B     GETSIZE .                                                15300020
         SPACE 1                                                        15360020
OUT      EQU   *                                                        15420020
         STC     R10,SCBPRI     REPLACE PRI WITH OFFSET                 15480020
         TM    PRFSTAT1,PRFDUPLN        DUPL HDR                        15720020
         BO    POSTDISK                 BR YES TO BYPASS NEXT THING     15780020
         TM    LCBSTAT1,LCBINITN+LCBRECVN                               15820020
*        RECEIVING AN INITIATE MODE MESSAGE                             15860020
         BNO   GETSIZE                                                  15900020
         TM    SCBSTATE,SCBMSGLN+SCBLCK1N .  LOCK MODE                  15920020
         BNZ   NOINIT .                 IF LOCK - NO INIT MODE          15940020
         TM    QCBDSFLG,QCBTSQ          TIME-SHARING QUEUEING?   S22029 15960022
         BO    NOINIT                   BRANCH ON YES               TSO 16020020
         CLI   QCBSTVTO,CONC .          DEST A CONC              S22026 16080022
         BE    NOINIT .                 BRANCH IF YES            S22026 16110022
         CLI   QCBSTPRI,CLOCK .         CLOCK OPTION             S22026 16140022
         BE    NOINIT .                 BRANCH IF YES            S22026 16170022
         CLI   QCBSTPRI,INTVL .         INTVL OPTION             S22026 16200022
         BNE   NOTDIAL .                BRANCH IF NO             S22026 16230022
         BAL   R10,CKDELAYQ             CK IF IN DELAY Q                16260020
NOTDIAL  EQU   *                                                        16320020
         LA    R7,0(R7) .               CLEAR HI                        16380020
         LR    R2,R7 .                  SET R2                          16440020
*        FIND THE LAST LCB IN INSRC CHAIN BEFORE INSERT THIS ONE        16500020
INITLOOP EQU   *                                                        16560020
         LR    R1,R2 .                  SET ADDR OF PVEV IN Q           16620020
         L     R2,QCBINSRC-1-IEDQQCB(R1) .  ADDR OF NEXT                16680020
         N     R2,CLEAROFF .            CLEAR HI AND INSRC BITS         16740020
         CLR   R2,R7 .                  IS THIS LAST ONE                16800020
*        LAST IN CHAIN POINTS TO ITSELF                                 16860020
         BNE   INITLOOP .               BR NOT LAST TO GET NEXT         16920020
         MVC   LCBINSRC(3),QCBINSRC-IEDQQCB(R1)                         16980020
         MVC   QCBINSRC-IEDQQCB(3,R1),PRFLCB                            17040020
*        CHAIN LCB INTO CHAIN                                           17100020
         OI    QCBINSRC+2-IEDQQCB(R1),XXXON .   SET INSRC FLAG ON       17160020
         OI    LCBINSRC+2,XXXON .      SET INSRC FLAG ON                17220020
GETSIZE  EQU   *                                                        17280020
         LR    R10,RPREFIX .            INITIALIZE FOR LOOP WITH FIRST  17340020
*                                       UNIT ADDR                       17400020
         SR    R2,R2 .                  INITIALIZE UNIT COUNT TO ZERO   17460020
         LH    R5,PRFSIZE                                               17520020
         SR    R11,R11                                                  17580020
         IC    R11,PRFNBUNT             NUMBER OF UNITS IN BFR          17640020
COMPARE1 EQU   *                                                        17700020
          L     R10,PRFTIC-IEDQPRF(R10)                                 17760020
         LA    R2,1(0,R2)                                               17820020
         SH    R5,AVTKEYLE              SUBTRACT AMT. IN THIS UNIT      17880020
         BP    COMPARE1 .               IF UNITS REMAIN, GO COUNT THEM  17940020
ALL      EQU   *                                                        18000020
         STC   R2,PRFNBUNT              REPLACE CORRECT NO. UNITS       18060020
         CR    R2,R11                                                   18120020
         BE    POSTDISK                                                 18180020
          SR    R11,R2                                                  18240020
          STC   R11,PRFNBUNT-IEDQPRF(R10)                               18300020
          LR    R1,R10                                                  18360020
         BAL   R10,POSTSUB .            POST BFR                        18420020
POSTDISK EQU   *                                                        18480020
         CLI   QCBSTPRI,DIALPRTY        DIAL QCB                        18540020
         BNH   NODIAL                   BR NOT DIAL                     18600020
         TM    PRFSTAT1,PRFNLSTN        IS THIS A LAST SEG              18660020
         BO    NODIAL                   BR IF NOT LAST                  18720020
         IC    R14,QCBPRIPQ             PRTY OF THIS QCB                18780020
         EX    R14,COMPRI               THIS MSG PRTY HIGHER THAN       18840020
         BH    NODIAL                   PREVIOUS MSG - BR NO            18900020
         STC   R14,QCBPRLVL             SET HIGHSET PRTY MSG            18960020
NODIAL   EQU   *                                                        19020020
*        IF A LOGICAL READ ERROR OCCURS IN INITIATE MODE - FA WILL      19080020
*        DROP THE ERB LEAVING LCBDLNK SWITCH SET TO 'NOT POSTABLE'      19140020
*        PCI WILL NOT POST THE ERB.  LOGICAL READ ERROR WILL ALSO BE    19200020
*        SET IN ERBST.  WHEN HM RECEIVES A BFR IN INIT MODE UNDER       19260020
*        THESE CONDITIONS - THE ERB FOR THE DESTINATION LINE WILL       19320020
*        BE REPOSTED TO FA WITH AN E0 PRIORITY REQUESTING               19380020
*        THE BUFFERS OF THIS MESSAGE AGAIN.  THE DESTINATION LCB        19440020
*        WILL BE FOUND FROM THE LCBINSRCE CHAIN OF THE SOURCE LCB.      19500020
         BAL   R14,SENDINIT                                             19560020
         B     NOERB                                                    19620020
         TM    LCBERBST-IEDQLCB(R1),LCBDLNKN+LCBEOMSG                   19680020
*        CAN THE ERB BE POSTED                                          19740020
         BNZ   NOERB                    BR YES PCI MAY POST IT          19800020
         TM    LCBERBST-IEDQLCB(R1),LCBRDERR .   HAS A READ ERROR       19860020
         BNO   NOERB .                  BR IF NO ERROR                  19920020
         CLI   LCBERBKY-IEDQLCB(R1),AVTEZERO  SHOULD HM POST ERB S21101 19970020
         BE    NOERB NO IT IS ALREADY ON READY Q                 S21101 19972020
         CLI   LCBERBPY-IEDQLCB(R1),PRIFSPCI . SHOULD PTRY BE CHGED     19980020
         BNE   PRIOK .                  BR NO                           20040020
         MVI   LCBERBPY-IEDQLCB(R1),PRISBPCI . SET PRTY                 20100020
PRIOK    EQU   *                                                        20160020
         LA    R1,LCBERB-IEDQLCB(R1) .  ADDR OF ERB TO POST             20220020
         LA    R2,AVTDSIOB .            QCB ADDR FOR FA                 20280020
*                                   .   STORE OF R2 WILL ZERO    S21101 20330020
*                                   .   FIRST BYTE OF ERB        S21101 20332020
         BAL   R10,POSTSUBA .           POST ERB TO FA                  20340020
NOERB    EQU   *                                                        20400020
         AIF   (&A NE 1).H001                                           20460020
         B     COREQUE                                                  20520020
         AGO   .H005                                                    20580020
.H001    ANOP                                                           20640020
         TM    PRFSTAT1,PRFDUPLN        DUPL HDR                        20700020
         AIF   (&A NE 2).H002                                           20760020
         BNO   QUEUE1                                                   20820020
         AGO   .H003                                                    20880020
.H002    ANOP                                                           20940020
         BO    DUPL                     BR YES                          21000020
          TM    QCBDSFLG,QCBCORE                                        21060020
*                       IS THIS A CORE QUEUE QCB                        21120020
         BNO   QUEUE1 .                   NO, DISK ONLY          S21101 21180021
*                                         YES, HAS CORE Q        S21101 21230021
         CLI   PRFPRI,COPYPRI .         IS THIS BUF FROM COPY    S21101 21240021
         BNE   COREQUE .                  NO, NOT COPY, GO ENQUE S21101 21290021
*                                           ONTO CORE QUEUE      S21101 21292021
*                                         YES, FROM COPY         S21101 21294021
         TM    QCBDSFLG,QCBDISK .       DOES THIS CORE Q HAVE    S21101 21296021
*                                         ANY DISK BACKUP        S21101 21298021
         BZ    COREQUE .                  NO, CORE ONLY          S21101 21298421
*                                         YES, CORE WITH DISK    S21101 21298821
         B     QUEUE1 .                 ENQUEUE ONTO DISK        S21101 21299221
.H003    ANOP                                                           21300020
         TITLE '''IEDQHM'' - DUPLICATE MESSAGE TESTING' .        S22025 21330022
DUPL     EQU   *                                                        21360020
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21420020
*        WHEN A DUPL. HDR IS BEING PROCESSED--                          21480020
**       A COPY MAY OR MAY NOT BE ON THE QUEUEING MEDUUM INVOLVED       21540020
*        WITH THIS DESTINATION.                                         21600020
**       WHEN THE INITIAL RECALL IS DONE (IEDQBD), THE CONTENTS         21660020
*        OF SCBQTYPE - HIGH HALF BYTE -- INDICATING THE ORIGINAL        21720020
*        COPY OF THE MESSAGE IS PUT INTO SCBCQT ( HBFNO) AND SCB        21780020
*        QTYPE IS CLEARED TO 0.                                         21840020
**       WHEN THE SUBTASK GETS THE ERB FROM THE INITIAL RECALL          21900020
*        - USUALLY IEDQBD -- THE XTRA RECORDS ADDRESS IS COPCOPIED      21960020
*        INTO SCBRDX (SCBMBSSA) FOR RESUABLE DISK AND FOR NON-          22020020
*        REUSABLE DISK INTO SCBNDX (SCBMBSSA+4).  FOR A CORE COPY       22080020
*        NO COPY SHOULD BE MADE OF XTRA.                                22140020
**       SCBDCHDR WILL REFLECT THE DCHDR OF THE DISK Q TYPE INDICATED   22200020
*        IN SCBQTYPE. THE OTHER DISK QTYPE WILL BE IN SCBOTHER          22260020
*        (SCBTRANS).  IF ONE EXISTS.                                    22320020
**       SCBCQT HIGH HALF BYTE WILL BE THE COPY OF SCBQTYPE MADE        22380020
*        EARLIER.  THE LOW HALF BYTE IS THE INDICATION OF ALL MED-      22440020
*        IUMS WHICH CONTAIN A COPY OF THES MESSAGE.                     22500020
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22560020
         L     RSCB,LCBSCBA-1                                           22680020
         AIF   (&A EQ 2).H003A                                          22740020
         LA    R1,256*SCBCC+SCBCC+SCBCOREQ                              22800020
*        SET TO MARK FISLD AS HAVING A COPY ON THIS MEDIUM              22860020
*        SET REG TO TEST FOR MSG ORIGINAL OR COPY ON THIS MEDIUM        22920020
         LA    R14,COREQUE .            ASSUME COPY THERE - TRN TO Q    22980020
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                23040020
         BZ    EXTM                                                     23100020
.H003A   ANOP                                                           23160020
*     IS COPY IS TO BE CALLED AND THE ORIGINAL IS IN CORE, THEN         23220020
*     IT MUST NOT BE FREED (SERVICED) UNITL AFTER COPY IS DONE.         23280020
*     THEREFORE  IT WILL BE FLAGGED AS A DUPL WITH ONE MORE DUPL HDR    23340020
*        COUNTED THAN EXISTS.  THEN WHEN COPY FINISHES. IT WILL         23400020
*    REDUCE THE COUNT BY ONE.                                           23460020
         TM    QCBDSFLG,QCBREUS .       RESU DISK                       23880020
         BO    TSTSCB .                 BR YES                          23940020
         LA    R1,256*SCBCN+SCBCN+SCBNREUS                              24000020
*        SET REG TO TEST FOR MSG ORIGINAL OR COPY ON THIS MEDIUM        24060020
*        SET TO MARK FISLD AS HAVING A COPY ON THIS MEDIUM              24120020
         LA    R14,QUEUE1 .             ASSUME COPY THERE  - SET RTN    24180020
EXTM     EQU   *                                                        24240020
         EX    R1,TM .                  TEST FOR ORIG. OR COPY          24300020
         BNZ   EXBR .                   BR IF ONE THERE                 24360020
         AIF   (&A EQ 2).H003B .                                 S21101 24410021
         TM    SCBCQT,SCBREUS+SCBNREUS .ANY DISK-COPY WILL USE ITS21101 24412021
         BNZ   NOCORE .                   YES, DISK              S21101 24414021
*                                         NO, Q=MO               S21101 24416021
         LR    R14,R1 .                 SAVE REG 1               S21101 24418021
         BAL   R1,DUPLCORE .                                     S21101 24418421
*                                                                S21101 24418821
         BAL   R1,INCRCNT .             INCR COUNT OF DUPLS-COPY S21101 24419221
*                                                                S21101 24419621
         LR    R1,R14 .                 RESTORE REG 1            S21101 24419721
NOCORE   EQU   * .                                               S21101 24419821
.H003B   ANOP , .                                                S21101 24419921
         LA    R14,POSTCOPY .           SET RTN TO PUT ONE THER)        24420020
EXBR     EQU   *                                                        24480020
         SRL   R1,8 .                   SET R1 TO OI MASK               24540020
         EX    R1,OI .                  SET COPY HERE                   24600020
         BR    R14 .                    RETURN                          24660020
TSTSCB   EQU   *                                                        24720020
         LA    R1,256*SCBCR+SCBCR+SCBREUS                               24780020
*        SET TO MARK FISLD AS HAVING A COPY ON THIS MEDIUM              24840020
*        SET REG TO TEST FOR MSG ORIGINAL OR COPY ON THIS MEDIUM        24900020
         BAL   R14,EXTM .               ASSUME COPY THERE - RTN HERE    24960020
         BAL   R14,REUSDUPL .           IF DUPL TO BE QUEUED HE¢E       25020020
*        CHECK FOR TOO FAR                                              25080020
         TITLE '''IEDQHM'' - DISK ASSIGNMENT' .                  S22025 25320022
QUEUE1   EQU   *                                                        25380020
          LA    R2,AVTDSIOB             SET FOR LATER POST              25440020
         ST    R2,PRFQCBA-1                                             25500020
         MVI    PRFPRI,PRIDESTQ                                         25560020
         LA    R2,AVTNADDR              NON REUSABLE VALUE OF ADDR      25570022
         MVI   PRFTIC,XPRFNRUS+XTIC     SET TIC FLAGS TO NON REUS       25580022
         LA    R9,SCBNREUS .            SET FOR LATER OI                25590022
         TM    QCBDSFLG,QCBREUS                                         25620020
*                                       IS THIS FOR REUS DISK           25680020
         BZ    NONREUS                  BR NO                           25740020
         LA    R2,AVTRADDR              ADDR OF REUS VALUE OF           25800020
*                                       ADDRESS                         25860020
         MVI   PRFTIC,XPRFREUS+XTIC     SET TIC FLAGS TO REUS DSK       25920020
*                       TELL TIC OP CODE FIELD IS USED TO               25980020
*                       TELL DISK I/O WHICH DISK DATA SET               26040020
*                       IS TO BE USED                                   26100020
         LA    R9,SCBREUS .             SET FOR LATER OI                26160020
NONREUS  EQU   * .                                               S22025 26170022
         MVC   PRFCRCD(3),SCBDNSEG .    SET RRNS ASSUMING TEXT   S22025 26180022
         MVC   PRFCHDR(3),SCBDCHDR .         BUFFER              S22025 26190022
         TM    PRFSTAT1,PRFNHDRN        IS THIS A HEADER                26220020
         BO    TXTSAME .                NO, SKIP HEADER PROCESS  S22025 26280022
QUESAME  EQU   *                                                        27120020
         TM    PRFSTAT1,PRFDUPLN+PRFERMGN  DUPL OR ERR MSG              27180020
         BNZ   NOEX .                   BR IF EITHER                    27240020
         EX    R9,QTYPEOI                                               27300020
NOEX     EQU   *                                                        27360020
         MVC   PRFCRCD(3),QCBDNHDR                                      27420020
         MVC   PRFHQBCK(3),QCBQBACK                                     27480020
         MVC    QCBQBACK(3),PRFCRCD                                     27540020
         MVC   QCBPQBCK,PRFCRCD         UPDATE PRI Q BACK PTR   SA51078 27547022
         TM    QCBPREVF+L'QCBPREVF-1,CPBQTYPE                   SA50192 27554022
*                                       FIRST MSG ON QUEUE      SA50192 27561022
         BNZ   PREVFSET                 BRANCH IF NO            SA50192 27568022
         BAL   R9,LOCKMSG               IS IT LOCK MODE        @SA76275 27568100
         B     LKPFEFO                  BR NOT LOCK            @SA76275 27568200
         B     PREVFSET                 BYPASS SETTING UP PFEFO@SA76275 27568300
*                                       IF ONLY A LOCK RESPONSE@SA76275 27568400
LKPFEFO  EQU   *                                               @SA76275 27568500
         TM    PRFSTAT1,PRFCNCLN        CANCELLED HEADER?      @SA71682 27569061
         BO    PREVFSET                 YES, DOES NOT GET IN   @SA71682 27570061
*                                       FEFO CHAIN             @SA71682 27571061
         MVC   QCBPREVF,PRFCRCD         SET FOR RESTART IF NO   SA50192 27575022
*                                       PFEFO IN CHKPOINT       SA50192 27582022
PREVFSET EQU   *                                                SA50192 27589022
         MVC   QCBDNHDR(3),1(R2)                                        27600020
         MVC   PRFNHDR(3),QCBDNHDR                                      27660020
         BAL   R9,ADDONE                                                27720020
         TM    PRFSTAT1,PRFERMGN        ERR MSG IN THIS BFR             27780020
         BO    TXTSAME                  BR YES - DO NOT UPDATE QCB      27840020
         MVC   SCBDCHDR(3),PRFCRCD      SET CORRENT HDR ADDR            27900020
         TM    PRFSTAT1,PRFDUPLN        DUPL HDR                        27960020
         BO    DUPLHDR                  BR YES                          28020020
         BAL   R9,LOCKMSG                                               28080020
         B     TXTSAME                  BR NOT LOCK                     28140020
         MVC   QCBLKRRN(3),PRFCRCD                                      28200020
*                        SET DEST QCB LOCK FIELD                        28260020
TXTSAME  EQU   *                                                        28320020
         XC    PRFXTRA(3),PRFXTRA .     CLEAR THE XTRA ADDRESS          28350020
         SR    R14,R14                                                  28380020
         IC    R14,PRFNBUNT             NUMBER OF UNITS CONTAINING      28440020
         BCTR  R14,R0                   DATA  -1                        28500020
         LTR   R14,R14                  IS THERE MORE THAN 1 UNIT       28560020
         BZ    ISITLAST .               BR IF JUST ONE                  28620020
         MVC   PRFXTRA(3),1(R2)         SET LOCATION OF XTRA AS ADDR    28680020
         SLL   R14,MULT4 .              ADJUST NO. OF RECORDS    S21101 28730020
         A     R14,0(R2)           ADD NO. ADD. RECS. TO ADR            28740020
         ST    R14,0(R2)                                                28800020
ISITLAST EQU   *                                                        28860020
         TM    PRFSTAT1,PRFNLSTN   IS THIS THE LAST SEG                 28920020
         BZ    LASTSEG                  BR YES                          28980020
         MVC   SCBDNSEG(3),1(R2)                                        29040020
         MVC   PRFNTXT(3),SCBDNSEG                                      29100020
         BAL   R9,ADDONE                                                29160020
CKLDPT   EQU   *                                                        29220020
         TM    QCBDSFLG,QCBNREUS                                        29280020
          BO    DISKPOST                IF NON REUS RETURN              29340020
CKLOADPT EQU   *                                                        29400020
         TM    PRFSTAT1,PRFERMGN+PRFDUPLN .  THIS ERMSG OR DUPL         29420020
         BNZ   NOABEND .                BR NO                           29440020
         L     R14,AVTRADDR .           NEXT VALUE OF ADDR              29460020
         L     R11,SCBDCHDR-1 .         ADDR OF HDR THIS MSG            29520020
         LA    R11,0(R11) .             CLEAR HI                        29580020
         SR    R14,R11 .                GET DIFFERENCE FOR MSG SPAN     29640020
         L     R11,AVTTOTNR .           ADJUST AVTTOTNR TO       S21101 29700020
         SLL   R11,MULT4 .              REFLECT THE RRN NUMBERINGS21101 29750020
*                                       SYSTEM WHICH INCREMENTS  S21101 29752020
*                                       BY 4                     S21101 29754020
         CR    R14,R11 .                COMPARE MSG SPAN TO SIZE S21101 29756020
         BL    NOABEND .                DOES MSG SPAN THE DISK          29760020
         LA    R15,ABCODE7 .           SET ABEND CODE                   29800020
         BAL   R14,AVTABEND .          SET 14 TO ADDR OF ABEND          29840020
*        AND GO TO RTN TO ABEND                                         29880020
NOABEND  EQU   *                                                        29940020
         L     R2,AVTRADDR .            ADJUST AVTRADDR          S21101 30000020
         LA    R2,ROUNDER(R2) .         TO REFLECT               S21101 30050020
         SRL   R2,DIV4 .                THE ABSOLUTE             S21101 30052020
         CL    R2,AVTLODPT .            NO. OF RECORDS           S21101 30054020
          BL    DISKPOST                LESS THAN LDPT - RETURN         30060020
         SR    R10,R10                  DIVIDE RADDR BY TOTAL NO.       30120020
         LR    R11,R2 .                 OF RECORDS. IF REMAINDER S21101 30180020
         D     R10,AVTTOTNR             ER IS LESS THAN 1/4 OF THE      30240020
         SR    R14,R14                  TOT NO OF OF RECORDS RADDR      30300020
         L     R15,AVTTOTNR             SHOULD BE CHANGED TO ITS        30360020
         LA    R5,4                     MODULO VALUE IF THE 2 TO        30420020
         DR    R14,R5                   23RD BIT IS ALSO ON             30480020
         CR    R15,R10                  IS THE REMAINDER LESS THAN      30540020
         BL    SETREUS                  1/4 OF TOTAL BR NO              30600020
         TM    AVTRADDR+1,AVTMODBT      IS THE 2 TO 23RD BIT ON         30660020
         BNO   SETREUS                  BR  NO                          30720020
         SLL   R10,MULT4 .              ADJUST THE VALUE         S21101 30770020
         A    R10,ROUND                 REINITIALIZE RADDR      SA66611 30772054
         ST     R10,AVTRADDR            SET REUS TO MODULO VALUE        30780020
         SRL   R10,MULT4                DIVIDE BY FOUR          SA66611 30840054
         ST    R10,AVTLODPT             SET NEW VALUE           SA66611 30870054
SETREUS  EQU   *                                                        30900020
         IC    R2,AVTADEBR              SINCE 1/4 OF TOTAL MAY          31020020
         LA    R2,1(R2)                 HAVE A REMAINDER, EVERY 4TH     31080020
         STC   R2,AVTADEBR              TIME LDPT IS CHANGED, THE       31140020
         CLI   AVTADEBR,THREE           QUDTIENT AND REMAINDER MUST     31200020
         BL    ADD1QTR                  BE ADDED TO KEEP THE ZONE       31260020
         MVI   AVTADEBR,AVTEZERO        BOUNDARIES ON THE SAME DISK     31320020
         AR   R15,R14                   LOCATION                        31380020
ADD1QTR  EQU   *                                                        31440020
         L     R2,AVTLODPT              ADD 1/4 ( OR 1/4 + REMAINDER)   31500020
         AR    R2,R15                   TO LDPT FOR NEXT POINT          31560020
         ST    R2,AVTLODPT              TO CALL RESUABILITY             31620020
         L     R1,AVTIA .               GET ADDRESS OF REUS QCB  S21101 31670020
         L     R11,AVTEA .              SET DISPATCHER BASE      S21101 31672020
         BAL   R14,DSPPOSTR .           POST REUS QCB TO ITSELF  S21101 31674020
*                                         TO ACTIVATE REUS ZONE  S21101 31676020
*                                         CLEANING               S21101 31678020
* THE REUS QCB ALREADY HAS ASSEMBLED IN IT THE PROPER PRIORITY & S21101 31678420
* THE ADDRESS OF ITSELF IN ITS FIRST WORD TO SIMPLIFY TPOSTING.  S21101 31678820
*                                                                S21101 31679220
DISKPOST EQU    *                                                       31680020
         L     R2,PRFQCBA-1             FOR COMMON CODE                 31740020
.H005    ANOP                                                           31800020
NRPOST    EQU   *                                                       31860020
         LTR   R12,R12                                                  31920020
         BM    COPYRTN                                                  31980020
          LR    R1,RPREFIX                                              32040020
          L     R11,AVTEA                                               32100020
         LA    R15,DSPPOST                                              32160020
         B     POSTB                                                    32220020
         AIF   (&A EQ 1).H006                                           32280020
LASTSEG  EQU   *                                                        32340020
         BAL   R14,SAMELAST .                                    S22025 32370022
         LA    R10,CKLOCK .             SET RETURN ADDR                 32400020
TQBACK   EQU   *                                                        32460020
*                                       IF VALID THE SRCE QCB MUST      32520020
*                                       BE LOCATED TO UPDATE THE        32580020
*                                       SOURCE QBACK CHAIN              32640020
         LR    R5,R15                                                   32700020
         LH    R1,PRFSRCE                                               32760020
         N     R1,AVTCLRHI .            CLEAR HI-ORDER HALF AND TEST    32820020
         BCR   ZEROES,R10 .             NO, BR                   S22025 32880022
         L     R15,AVTRNMPT                                             32940020
         BALR  R14,R15                                                  33000020
         L     R1,0(R1)                                                 33060020
         MVC   PRFTQBCK(3),QCBQBACK-IEDQQCB(R1)                         33120020
*                       QBACK PTR INTO BFR                              33180020
         MVC   QCBQBACK-IEDQQCB(3,R1),PRFCRCD                           33240020
*                       UPDATE QCB QBACK WITH THIS REC. ADDR.           33300020
         LR    R15,R5                                                   33360020
         BR    R10                                                      33420020
QTYPEOI  OI    SCBQTYPE,X'00' .         SET A VALUE IN QTYPE            33480020
ADDONE   EQU   *                                                        33780020
         LA    R0,INCR .                ADD 4 TO THE VALUE OF    S21101 33840020
         A     R0,0(R2)                 ADDRESS CURRENTLY BEING         33900020
         ST    R0,0(R2)                 USED                            33960020
         BR    R9                                                       34020020
.H006    ANOP                                                           34080020
SAMELAST EQU   *                                                        34140020
         LTR   R12,R12            IF THIS IS COPY OR REUS               34200020
         BCR   4,R14                    NO CHECKING REQUIRED            34260020
         BAL   R9,LOCKMSG                                               34320020
         B     CKINIT                   BR NOT LOCK                     34380020
         AIF   (&A EQ 1).H007                                           34440020
         TM    QCBDSFLG,QCBREUS+QCBNREUS    ANY DSIK                    34500020
         BNZ   POSTLCB                  IF CORE ONLY  CLEAR BITS        34560020
.H007    ANOP                                                           34620020
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN                               34680020
         BNO   POSTLCB                                                  34740020
         NI    SCBSTATE,X'FF'-(SCBLCK1N+SCBMSGLN)       MSG LOCK OFF    34800020
*********    INITIALIZE LCB TO SEND                                     34860020
POSTLCB  EQU   *                                                        34920020
         ST    R14,AVTPARM3             SAVE RETURN ADDRESS    @XA11314 34980000
         L     R1,QCBDCBAD-1            DCB ADDR                        35040020
         CLI   QCBSTVTO,DSPLOGSC        IS QCB FOR LOGTYPE       S22024 35046022
         BE    NOLGB                    BRANCH ON YES            S22024 35052022
         TM    DCBDSORG-IHADCB(R1),AVTE80    IS THIS AN LGB      S22024 35060022
         BO    LGB                      BRANCH ON YES            S22024 35080022
NOLGB    EQU   *                                                 S22024 35090022
         SR    R14,R14                  CLEAR FOR IC                    35100020
         LR    R15,R14                  CLEAR FOR IC                    35160020
         IC    R14,QCBLKRLN .           REL LN  O OF LOCKED LINE        35220020
         IC    R15,DCBEIOBX-IHADCB(R1)  SIZE OF LCB                     35280020
         MR    R14,R14                  SIZE X LN NO.                   35340020
         AL    R15,DCBIOBAD-IHADCB(R1)  + ADDR FIRST IOB - SIZE OF      35400020
         LA    R1,LCBFLAG1-IEDQLCB      IOB -- SIZE OF LCB-IOB          35460020
         SR    R15,R1                   - LCB ADDR                      35520020
         LR    R1,R15                   LCB ADDR FOR POST               35580020
RESUME   EQU   *                                                 S22024 35610022
         L     R14,AVTPARM3             RESTORE REGISTER 14    @XA11314 35640000
         NI    LCBINSRC+2-IEDQLCB(R1),X'FF'-X'40'                       35700020
         BCR   7,R14                                                    35760020
         ST    R1,LCBQCBA-1-IEDQLCB(R1)                                 35820020
         MVI   LCBPRI-IEDQLCB(R1),PRILNFRE                              35880020
         L     R11,AVTEA                RSSTORE DISP ADDR               35940020
         BAL   R14,DSPPOSTR                                             36000020
         L     R14,AVTPARM3             RESTORE RETURN ADDRESS @XA11314 36060000
         L     RSCB,LCBSCBA-1           RESTORE R3                      36120020
         L     RQCB,SCBDESTQ-1          RESTORE R7                      36180020
         BR    R14                                                      36240020
LGB      EQU   *                                                 S22024 36250022
         LR    R1,RQCB                  PUT QCB ADDR IN R1       S22024 36260022
         SH    R1,NPRFSIZE              BACK UP TO NEG PREFIX  @YM04658 36270000
         L     R1,QCBPLCBA-1-IEDNQCB(R1)  ADDRESS OF PLCB        S22024 36280022
         B     RESUME                                            S22024 36290022
CKINIT   EQU   *                                                        36300020
         TM    LCBSTAT1,LCBINITN+LCBRECVN                               36330020
*        RECEIVING AN INITIATE MODE MESSAGE                             36360020
         BCR   14,R14 .                 BR NOT RCV INIT                 36390020
         TM    LCBINSRC+2,XXXON         IF THELOW ORDER BIT IS NOT      36480020
         BO    GETINSRC .               BR IF LCB IS IN SRCE CHAIN      36540020
         L     R1,LCBINSRC-1 .          ADDR OF DEST LCB                36600020
         OI    LCBERBST-IEDQLCB(R1),XXHMSG .    SET EOM TO HM           36660020
         BR    R14                                                      36720020
GETINSRC EQU   *                                                        36780020
*    IS LCB IS IN TE SRCE CHAIN REMOVE IT                               36840020
         LR    R2,RQCB .                INITIALIZE FOR LOOP             36900020
         LA    RLCB,0(0,RLCB)                                           36960020
CKLCB    EQU   *                                                        37020020
         LR    R15,R2                                                   37080020
         L     R2,LCBINSRC-IEDQLCB-1(R2)  ADDR NEXT LCB                 37140020
         N     R2,CLEAROFF              CLEAR HI AND INSRC BIT          37200020
         CR    R2,RLCB .                IS THIS THE LCB TO REMOVE       37260020
         BNE   CKLCB .                  IF NOT, GO LOOK AT NEXT ONE     37320020
REMOVE   EQU   *                                                        37380020
         MVC   LCBINSRC-IEDQLCB(3,R15),LCBINSRC-IEDQLCB(R2)             37440020
*                        REMOVE LCB FROM SOURCE CHAIN                   37500020
        BR     R14                                                      37560020
         AIF   (&A EQ 1).H007A                                          37620020
DUPLHDR  EQU   *                                                        37680020
         BAL   R10,GETNTXT                                              37740020
CKLOCK   EQU   * .                                               S22025 37770022
         TM    PRFSTAT1,PRFCNCLN        CANCELLED MESSAGE       OX06353 37777061
         BO    CKLDPT                   BR YES                  OX06353 37784061
*                                                               OX06353 37791061
         BAL    R14,FINDSTCB                                            37800020
         B     CKLDPT .                 GO, SEE IF REUS NEEDED   S22025 37860022
         SPACE 1 .                                               S22025 37950022
POSTCOPY EQU   *                                                        38040020
         MVI   PRFPRI,PRICOPY                                           38100020
         SPACE 1 .                                              SA51783 38103022
*** QCB MESSAGE COUNT HAS BEEN INCREMENTED FOR THIS DUPLICATE   SA51783 38106022
*   HEADER; BUT, COPY WILL TPOST THE BUFFERS OF THE MESSAGE     SA51783 38109022
*   BACK HERE WHEREUPON THE MESSAGE WOULD BE RECOUNTED.  HEADERSSA51783 38112022
*   OF MESSAGES WHICH WILL BE DISK QUEUED WILL NOT RETURN HERE. SA51783 38115022
*   SO, TO AVOID AN INCORRECT MESSAGE COUNT, WE MUST DECREMENT  SA51783 38118022
*   IT FOR CORE-ONLY QUEUED OR DISK QUEUED MULTI-BUFFER MSGS.   SA51783 38121022
         SPACE 1 .                                              SA51783 38124022
         AIF   (&A EQ 2).H900 .                                 SA51783 38127022
         TM    QCBDSFLG,QCBDISK .       IS THIS DISK QUEUED     SA51783 38130022
         BZ    DECRCT .                 NO, GO DECREMENT COUNT  SA51783 38133022
.H900    ANOP  , .                                              SA51783 38136022
         TM    PRFSTAT1,PRFNLSTN .      IS IT LAST BUFFER       SA51783 38139022
         BZ    NODECRCT .               YES, IT WON'T RETURN    SA51783 38142022
DECRCT   EQU   * .                                              SA51783 38145022
         LH    R2,QCBMSGCT .            DECREMENT MESSAGE COUNT SA51783 38148022
         BCTR  R2,0 .                     BY ONE                SA51783 38151022
         STH   R2,QCBMSGCT .            RESTORE IT              SA51783 38154022
NODECRCT EQU   * .                                              SA51783 38157022
         L    R2,AVTCOPY                QCB ADDR FOR POST               38160020
         LA    R2,0(R2)                 CLEAR HI BYTE                   38220020
         LTR   R2,R2                    COPY THERE                      38280020
         BNZ   NRPOST .                 BR YES                          38340020
         LA    R15,ABCODE4 .           SET ABEND CODE IN 15             38400020
         BAL   R14,AVTABEND .          SET 14 TO INSTR OF ABEND         38460020
*        AND GO TO RTN TO ABEND                                         38520020
         SPACE 3 .                                               S22025 38580022
REUSDUPL EQU   *                                                        39360020
         MVC   AVTDOUBL+1(3),QCBDNHDR   HEADER RECORD           SA57334 39370022
         MVC   AVTDOUBL+5(3),PRFXTRA    EXTRA SEGMENT           SA57334 39380022
         CLI   PRFNBUNT,HEX01           ANY EXTRAS              SA57334 39390022
         BNE   PASTNTXT                 BR YES                  SA57334 39400022
         SPACE                                                          39410022
         TM    PRFSTAT1,PRFNLSTN        LAST SEG                        39420020
         BCR   14,R14                   BR YES - NO NTXT                39480020
         MVC   AVTDOUBL+5(3),PRFNTXT                                    39720020
*                                                               SA57334 39728022
*        IF A DUPL HDR IS MORE THAN 1 ZONE AWAY FROM ITS        SA57334 39736022
*        PREVIOUSLY ASSIGNED NEXT TEXT OR EXTRA SEGMENT         SA57334 39744022
*        THE WHOLE MSG SHOULD BE RECOPIED                       SA57334 39752022
*                                                               SA57334 39760022
PASTNTXT EQU   *                                                SA57334 39768022
         L     R5,AVTDOUBL                                              39780020
         LA    R5,0(0,R5)                                               39840020
         MVI   AVTDOUBL+4,AVTEZERO                                      39900020
         S     R5,AVTDOUBL+4                                            39960020
         SR    R10,R10                                                  40020020
         L     R11,AVTTOTNR .           AVTTOTNR IS THE ABSOLUTE S21101 40080020
*                                       NUMBER OF RECORDS. THIS  S21101 40130020
*                                       IS ALSO THE SIZE OF A    S21101 40140020
*                                       ZONE IN THE RRN NUMBERINGS21101 40190020
*                                       SYSTEM WHICH INCREMENTS  S21101 40200020
*                                       BY 4                     S21101 40250020
         CR    R5,R11                                                   40260020
         BH    POSTCOPY                                                 40320020
       L    R7,SCBDESTQ-1               RESTORE QCB ADDR                40380020
         BR    R14                                                      40440020
.H007A   ANOP                                                           40500020
POST   EQU   *                                                          40560020
         LR    R1,RPREFIX                                               40620020
POSTA    EQU   *                                                        40680020
         L     R11,AVTEA                                                40740020
         LA    R15,DSPPOSTR                                             40800020
POSTB    EQU   *                                                        40860020
         ST   R2,PRFQCBA-1-IEDQPRF(R1)                                  40920020
         BR    R15                      GO POST                @XM05743 40980000
         AIF   (&A EQ 1).H008                                           41040020
GETNTXT  EQU   *                                                        41100020
         CLI   PRFNBUNT,X'01'           JUST ONE UNIT                   41160020
         BNE   NOCLEAR                  BR MORE THAN 1                  41220020
         XC    PRFXTRA(3),PRFXTRA       THERE IS NO EXTR REC            41280020
         TM    PRFSTAT1,PRFNLSTN        LAST BFR                        41340020
         BNO   TQBACK                   BR YES - NO NTXT EITHER         41400020
NOCLEAR  EQU   *                                                        41460020
         MVC   PRFNTXT(3),SCBNDX                                        41490022
         TM    PRFTIC,XPRFNRUS .        THIS FOR NREUS DISK             41520020
*        ALREADY HAVE A COPY FOR THIS MSG ON THE ONE NEEDED             41580020
         BNZ   CKUNITS .                BR YES                   S22025 41640022
         MVC   PRFNTXT(3),SCBRDX        ASSUME REUS - GET NTXT          41700020
CKUNITS  EQU   *                                                        41760020
         CLI   PRFNBUNT,X'01'           JUST ONE UNIT                   41820020
         BCR   8,R10                    BR YES                          41880020
         MVC   PRFXTRA(3),PRFNTXT       SET XTRA                        41940020
         TM    PRFSTAT1,PRFNLSTN        LST BFR                         42000020
         BNO   TQBACK                   BR IF LAST                      42060020
         SR    R1,R1                                                    42120020
         IC    R1,PRFNBUNT              NO UNITS                        42180020
         BCTR  R1,0                     SUBTR 1 FOR ADD                 42240020
         L     R0,PRFXTRA-1             ADDR OF XTRA                    42300020
         SLL   R1,MULT4 .               ADJUST FOR 4'S           S21101 42350020
*                                       ARITHMETIC               S21101 42352020
         AR    R0,R1                                                    42360020
         SRL   R1,DIV4 .                ADJUST BACK              S21101 42410020
         STC   R0,PRFNTXT+2             SET VALUE FOR NTXT SEGS         42420020
         SRL   R0,8                                                     42480020
         STH   R0,PRFNTXT                                               42540020
         BR    R10                      RETURN                          42600020
.H008    ANOP                                                           42840020
LOCKMSG  EQU   *                                                        42900020
         LTR   R12,R12 .                COPY CALL                       42920020
         BCR   4,R9 .                   BR IF OCPY - NOT LOCK           42940020
         TM    PRFSTAT1,PRFDUPLN+PRFERMGN                               42960020
*        DUPL HDR OR ERRMSG COULD BE FROM ORIGINAL LOCK MSG             43020020
         BCR   7,R9 .                   BR IF EITHER                    43080020
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN    LOCK MSG                   43140020
         BCR    8,R9                    BR NOT LOCK                     43200020
         CLI   LCBRSKEY,DSPPUTSC        PUT RESPONSE MSG        SA60012 43220022
         BCR   7,R9                     BRANCH IF NO            SA60012 43240022
         TM    QCBFLAG,QCBPROC          THIS THE REQ. MSG OR RESP MSG   43260020
         BNO   4(R9)                    BR IF THE RESPONSE MSG          43320020
         BR    R9                       BR IF REQUESTING MSG            43380020
         AIF   (&A EQ 2).H009                                           43440020
         TITLE '''IEDQHM'' - CORE ENQUEUE' .                     S22025 43500022
*      THE FIRST 12 BYTES OF THE RECORDS WILL BE USED AS A KEY FIEDS    43560020
*     ON DISK.  THE TIC PORTION OF THIS FIELD WILL BE USED TO           43620020
*     COUNT DUPLICATE HEADERS                                           43680020
COREQUE  EQU   *                                                        43740020
         AIF   (&A NE 3).H011A .                                 A51776 43746022
         TM    LCBSTAT1,LCBRECVN+LCBINITN INITIATE MESSAGE       A51776 43752022
         BNO   INITCORE .               NO, GO QUEUE IT          A51776 43758022
         TM    QCBDSFLG,QCBREUS+QCBNREUS IS IT DISK BACK-UP      A51776 43764022
         BNZ   CLEARCOR .               YES, GO QUEUE ON DISK    A51776 43770022
*                                            ONLY                A51776 43776022
INITCORE EQU   * .                                               A51776 43782022
.H011A   ANOP  , .                                               A51776 43788022
      TM    PRFSTAT1,PRFNHDRN                                           43800020
         BNO    NOCHECK                                                 43860020
         NC    SCBCCHDR(3),SCBCCHDR .   HDR THERE OR LOST               43920020
         BZ    NOQUEUE1 .               BR IF LOST                      43980020
         MVC    AVTDOUBL+1(3),SCBCCHDR                                  44040020
         L    R2,AVTDOUBL                                               44100020
         TM    PRFSTAT1,PRFCNCLN                                        44160020
         BNO   NOTCNCL                  BR NO                           44220020
         OI    DATFLAGS-IEDQDATA(R2),DATCNCLD     SET CNCL FLAG         44280020
NOTCNCL  EQU   *                                                        44340020
         TM    DATFLAGS-IEDQDATA(R2),DATLOSTN+DATINITL                  44400020
*                                       HAS THIS MSG BEEN LOST          44460020
         BNZ   NOQUEUE                                                  44520020
NOCHECK   EQU   *                                                       44580020
         XC    0(8,RPRF),0(RPRF)        ZERO DATA FIELD                 44640020
         XC    PRFNTXT(L'PRFNTXT+L'PRFCRCD),PRFNTXT .            A42363 44700021
         BAL   R9,CNTUNITS                                              44760020
         TM    PRFSTAT1,PRFDUPLN                                        44820020
         BO    COREDUPL                                                 44880020
         AIF   (&A EQ 1).H009A                                          44940020
          TM     QCBDSFLG,QCBREUS+QCBNREUS                              45000020
*                        IS THIS TO BE DISK QUEUED ALSO                 45060020
         BNZ    SWAPNOT                                                 45120020
.H009A   ANOP                                                           45180020
INITRTN  EQU   *                                                        45240020
          LR    R1,R5                                                   45300020
         BAL   R10,POSTSUB .            POST BFR                        45360020
UNITQUE EQU   *                                                         45420020
         BAL   R10,QUEUNITS                                             45480020
         AIF   (&A EQ 1).H009B                                          45540020
         BAL   R9,SETDISK                                               45600020
.H009B   ANOP                                                           45660020
         TM    PRFSTAT1,PRFNLSTN        IS THIS A LAST SEG              45720020
         BO    RETURN                                                   45780020
         LTR   R12,R12                  IS THIS REUS OR COPY            45840020
         BM    COPYRTN                  BR YES                          45900020
         BAL   R9,SETFEFO                                               45960020
          BAL   R14,FINDSTCB                                            46020020
         BAL   R14,SAMELAST                                             46080020
         NI    LCBINSRC+2,X'FF'-XXXON . SET INSRC FLAG OFF              46140020
         NI    LCBSTAT1,LCBINITF .      SET INIT MODE OFF               46200020
RETURN    EQU   *                                                       46260020
         LTR   R12,R12                                                  46320020
         BM    COPYRTN                                                  46380020
          L     R11,AVTEA                                               46440020
          B     DSPDISP                                                 46500020
COREHDR  EQU   *                                                        46560020
         TM    PRFSTAT1,PRFCNCLN                                        46620020
         BNO   NOTCNCLD                 BR NO                           46680020
         OI    DATFLAGS-IEDQDATA(RPREFIX),DATCNCLD      SET CNCL        46740020
NOTCNCLD EQU   *                                                        46800020
         TM    PRFSTAT1,PRFDUPLN+PRFERMGN  DUPL OR ERRMSG               46860020
         BNZ   NOQTYPE .                BR IF EITHER - NO QTYPE TO SET  46920020
         OI    SCBQTYPE,SCBCOREQ                                        46980020
NOQTYPE  EQU   *                                                        47040020
         AIF   (&A EQ 1).H009C                                          47100020
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                47160020
         BNZ   ASSIGN                                                   47220020
.H009C   ANOP                                                           47280020
         BAL   R9,LOCKMSG                                               47340020
         B     ASSIGN                   BR NOT LOCK                     47400020
         MVC   QCBLKRRN(3),AVTDOUBL+1                                   47460020
ASSIGN   EQU   *                                                        47520020
         BAL   R9,ASSIGN1                                               47580020
         NC    PRFTIC+1(3),PRFTIC+1                                     47640020
         BCR   8,R10                                                    47700020
         L     R2,PRFTIC                                                47760020
         MVI   PRFTIC-IEDQPRF(R2),AVTEZERO                              47820020
         BR    R10                                                      47880020
ASSIGN1  EQU   *                                                        47940020
         MVC   PRFCORE(3),AVTDOUBL+1                                    48000020
ASSIGN1A EQU   *                                                        48060020
         MVC   PRFCRCD(3),PRFCORE       SET CURRENT RECORD IN   SA52971 48080022
*                                         CASE MAIN ONLY        SA52971 48100022
         XC    PRFNHDR(3),PRFNHDR        ZERO NEXT HDR POINTER          48120020
         TM    PRFSTAT1,PRFERMGN        ERROR MSG THIS BFR              48180020
         BO    SKIP                     BR YES DO NOT UPDATE SCB        48240020
         MVC   SCBCCHDR(3),PRFCORE      NEW SCB CURR HDR ADDR           48300020
         MVC   SCBCLSEG(3),PRFCORE      >ET NEW LAST SEGMENT            48360020
SKIP     EQU   *                                                        48420020
         MVC   PRFNHDR,QCBCFHDR         LINK HDR ON QUE         SA51078 48480022
         MVC   QCBCFHDR,PRFCRCD         UPDATE FIRST HDR        SA51078 48580022
         BR    R9                       RETURN                  SA51078 48680022
         SPACE 1 .                                               S22025 48960022
DUPLCORE EQU   *                                                        49140020
         L     R2,SCBCCHDR-1            HDR ADDR                        49200020
         TM    LCBSTAT1,LCBSENDN        SENDING                         49260020
         BNO   NOTSEND                  BR NO   CCHDR IS OK             49320020
         L     R2,SCBSCHDR-1            GET HDR ADDR                    49380020
NOTSEND  EQU   *                                                        49440020
         ST    R2,AVTDOUBL .            HAS THIS  MSG BEEN FREED        49450020
         CLC   AVTDOUBL+1(3),PRFCORE-IEDQPRF(R2) .   FROM THE CORE      49460020
        BNE   RCQCB .                  QUEUE- ALREADY SENT              49470020
*        THE ORIGINAL HDR ADDRESS MUST REMAIN IN R2 FOR COREDUPL        49475020
         OI    PRFSTAT1-IEDQPRF(R2),PRFDUPLN .  FLAG ORIG AS DUPL       49480020
         MVC   PRFNTXT(3),PRFNTXT-IEDQPRF(R2)                           49500020
         L     R9,PRFTIC-IEDQPRF(R2)    ADDR OF NEXT UNIT               49560020
         ST    R9,AVTDOUBL                                              49580020
         MVI   AVTDOUBL,AVTEZERO .      CLEAR HI BYTE                   49600020
         NC    PRFTIC+1-IEDQPRF(3,R2),PRFTIC+1-IEDQPRF(R2)              49620020
         BNZ   DUPLCNT                                                  49680020
         MVC   AVTDOUBL+1(3),PRFNTXT-IEDQPRF(R2)                        49860020
        L     R9,AVTDOUBL                                               49920020
         LTR   R9,R9 .                  IS THE COUNT TO BE UPDATED      49940020
         BCR   8,R1 .              BR NO - NO TIC TO COUNT IN           49960020
DUPLCNT  EQU   *                                                        49980020
*       IF THE DUPL HDR HAS A SINGLE UNIT, THE COUNT OF HEADERS         50040020
*       WILL BE KEPT IN THE TIC FIELD OF HTE NEXT TEXT                  50100020
*        SEGMENT.  IF IT HAS MORE THAN ONE UNIT, THE COUNT WILL         50160020
*        BE IN THE TIC OF THE FIRST UNIT                                50220020
*        IF THERE IS ONE UNIT AND ONE SEGMENT, NO COUNT IS NEEDED.      50280020
         CLI   PRFTIC-IEDQPRF(R9),X'FF' .  DO NOT ALLOW MORE THAN       50340020
         BE    RCQCB .                  255 DUPL ENTRIES IN CORE Q      50400020
        BR    R1 .                     RETURN                           50410020
INCRCNT EQU   *                                                         50420020
         L     R9,AVTDOUBL .            ADDR OF UNIT TO PUT CNT IN      50430020
         LTR   R9,R9 .             IS ONE THERE                         50440020
         BCR   8,R1 .              BR IF NO COUNT                       50450020
         IC    R14,PRFTIC-IEDQPRF(R9)   COUNT OF DUPL HDRS              50460020
         LA    R14,1(0,R14)                                             50520020
         STC   R14,PRFTIC-IEDQPRF(R9)                                   50580020
         BR    R1                                                       50760020
COREDUPL EQU   *                                                        50820020
         BAL   R1,INCRCNT .             COUNT THIS DUPL HDR             50880020
         MVC    DATFLAGS-IEDQDATA(AVTUMALN,R5),DATFLAGS-IEDQDATA(R2)    50920020
*        COPY TIC, FLAGS AND LINK FIELD                                 50960020
         XC    DATFEFO-IEDQDATA(3,R5),DATFEFO-IEDQDATA(R5)              51000020
*        CLEAR FEFO PRT                                                 51040020
         LH    R9,AVTKEYLE                                              51120020
         BCTR  R9,0                     ADJUST COUNT                    51180020
         EX    R9,DUPLTRAN                                              51240020
         LH    R9,PRFDEST .             COPY THE DEST FOR THIS          51260020
         STH   R9,PRFDEST-IEDQPRF(R5) . DUPL HDR                        51280020
         IC    R9,PRFCORE-1-IEDQPRF(R5)                                 51300020
         ST    R5,PRFCORE-1-IEDQPRF(R5)                                 51360020
         STC    R9,PRFCORE-1-IEDQPRF(R5)                                51420020
         ST    RPREFIX,AVTDOUBL+4       SAVE ADDR OF ORIGINAL BFR       51480020
         LR    RPREFIX,R5               USE R6 FOR SUBROUTINE           51540020
         BAL   R9,ASSIGN1A                                              51660020
         BAL   R9,SETFEFO1                                              51960020
         L     RPREFIX,AVTDOUBL+4       RESTORE R6                      52020020
RCQCB    EQU   *                                                        52080020
         MVI   PRFTIC,X'08'                                             52140020
         L     R2,LCBRCQCB                                              52200020
         MVI   PRFPRI,PRIRCQCB          SET FOR POST                    52260020
         BAL   R14,POST                                                 52320020
         LA    R14,RETURN                                               52380020
.H009    ANOP                                                           52440020
FINDSTCB EQU   *                                                        52500020
         L     RSCB,LCBSCBA-1 .         RESTORE SCB              A42400 52550000
         L     RQCB,SCBDESTQ-1 .        RESTORE QCB              A42400 52552000
FINDSTCA EQU   * .                                               A42400 52554000
         LTR   R12,R12                 COPY CALL                        52560020
         BCR   4,R14                    BR IF COPY                      52620020
         TM    QCBFLAG,QCBTSSES         TERMINAL IN TIME-SHARING S22029 52630022
*                                       SESSION                  S22029 52640022
         BCR   7,R14                    YES, DO NOT SEND ANY MSG S22029 52650022
*                                       TRAFFIC AT THIS TIME     S22029 52660022
         L    R11,AVTEA                                                 52680020
         CLI   QCBSTPRI,CLOCK .         CLOCK OPTION             S22026 52860022
         BNE   CHKINTVL                 BR NO                    X03039 52900008
*                                                                X03039 52903008
         CLI   QCBSTVTO,DSPSEND         QCB FOR VTAM TERMINAL  @Y17XAQZ 52906000
         BNER  R14                      BR NO                    X03039 52909008
*                                                                X03039 52912008
         TM    QCBTSOF1,QCBDELAY        QCB ON TIME DELAY        X03039 52915008
         BOR   R14                      BR YES                   X03039 52918008
*                                                                X03039 52921008
         B     CONTINUE                 GO FIND SEND SCHEDULER   X03039 52924008
*                                                                X03039 52927008
CHKINTVL EQU   *                                                 X03039 52930008
         CLI   QCBSTPRI,INTVL .         INTVL OPTION             S22026 52940022
         BNE   CONTINUE .               BRANCH IF NO             S22026 52980022
*        IF THE STCB PRTY IS X'70' CHECK IF THE QCB IS IN THE TIME      53040020
*        QUEUE.  IF YES - REMOVE THE QCB AND PUT THE SEND SCHED.        53100020
*        BACK INTO THE QCB STCB CHAIN.                                  53160020
         BAL   R10,CKDELAYQ                                             53220020
CONTINUE EQU   *                                                        53280020
         STM   R0,R15,AVTSAVE4          SAVE CALLERS REGISTERS  SA61768 53288000
*        SAVE AREAS USED AT THIS POINT ARE                      SA61768 53296000
*        19R4 - AVTSAVE3+4, R14                                 SA61768 53304000
*        IEDQHG - AVTSAVE2 ( IN R13) +C FOR R14 - R12           SA61768 53312000
*        PRIOR TO THIS APAR FIX, IEDQFA USED AVTSAVE4+10 FOR    SA61768 53320000
*        REGS 0 - 15, IGG019RP USED AVTSAVE3+36 FOR REGS 3-12   SA61768 53328000
CONTINU2 EQU   *                                                SA61768 53334000
         LA    R15,QCBSTCHN-1           IS THE SCHEDULER THE            53340020
         L     RSCB,QCBSTCHN-1          FIRST STCB ON THE QCB           53400020
         LA    RSCB,0(RSCB)             STCB CHAIN                      53460020
         CLR   RSCB,R15                 BR NO                           53520020
         BNE   CHKCONC .               TO CHECK IF CONC          S22026 53580022
         SR    R15,R15                                                  53700020
         IC    R15,QCBSTVTO             OFFSET TO THE SCHEDULER         53760020
         AR    R15,R15                  DOUBLED TO GET TO THE           53820020
         L     RSCB,AVTDISP-24(R15)     ADDRESS IN THE DISP V CON       53880020
         SH    RSCB,AVTHA2              TABLE - HALF WORD BEFORE        53940020
         LH    R15,0(RSCB)              THE CODE IS THE OFFSET          54000020
         AR    R15,RSCB                 TO THE SUBROUTINE TO FIND       54060020
         BALR  R14,R15                                                  54120020
RESET    EQU   *                                                        54300020
         LM    R0,R15,AVTSAVE4          RESTORE REGISTERS       SA61768 54360000
         BR    R14                                                      54480020
CHKCONC  CLI   QCBSTVTO,CONC .         CONCENTRATOR              S22026 54486022
         BNE   RESET .                 BRANCH IF NO              S22026 54492022
         TM    QCBDSFLG,QCBDRQQ .      DRQ                       S22026 54498022
         BO    RESET .                 BRANCH IF YES             S22026 54504022
         LH    RSCB,QCBEXTO .          EXT OFFSET                S22026 54510022
         AR    RSCB,RQCB .             QCBE ADDRESS              S22026 54516022
         L     RSCB,QCBECONC-1-IEDQQCBE(RSCB) TRM ENTRY          S22026 54522022
         L     RQCB,TRMDESTQ-1-IEDQTRM(RSCB) .DRQ ADDRESS        S22026 54528022
         B     CONTINU2                 CONTINUE                SA61768 54534000
CKDELAYQ EQU   *                                                        54540020
         TM    QCBINSRC+2,QCBDELAY      QCB IN DELAY Q                  54600020
         BCR   14,R10                   BR NO                           54660020
         TM    QCBSTAT,QCBTRMHO         TERMINAL HELD           SA59006 54680022
         BCR   1,R10                    BR YES, RETURN          SA59006 54700022
         TM    AVTBIT2,AVTREUSN         REUSABILITY RUNNING    @XA05307 54701061
         BNO   CONT                     BR NO, FORGET IT       @XA05307 54702061
         LA    R1,IEDQQCB+QCBMSIZE-QCBPSIZE INIT FOR SCAN LOOP @XA05307 54703061
SCANLOOP EQU   *                                               @XA05307 54704061
         LA    R1,QCBPSIZE(0,R1)        NEXT PRIORITY QCB      @XA05307 54705061
         OC    QCBFFEFO-IEDQPQCB(3,R1),QCBFFEFO-IEDQPQCB(R1)   @XA05307 54706061
*                                         UNSENT FEFO MESSAGE  @XA05307 54707061
         BNZ   CONT                     BR YES, CONTINUE       @XA05307 54708061
         CLI   QCBPRIPQ-IEDQPQCB(R1),AVTEZERO LAST PRIORITY QCB@XA05307 54709061
         BNE   SCANLOOP                 BR NO, CONTINUE        @XA05307 54710061
         BR    R10                      BR RETURN              @XA05307 54711061
CONT     EQU   *                                               @XA05307 54712061
         ST    R14,AVTPARM3             SAVE RETURN ADDRESS    @SA74250 54720000
         LR    R1,RQCB                  QCB ADDR TO REMOVE              54780020
         L     R15,AVTHG02              ADDR OF SUBRTN                  54840020
         BALR  R14,R15                                                  54900020
         NI    QCBINSRC+2,X'FF'-QCBDELAY                                54960020
         LA    R15,QCBSTCHN-1           ADDR OF SEND SCHED              55020020
         MVC   QCBSLINK(3),QCBSTCHN     MOVE THE STCB LINK FIELD        55080020
         IC    R1,QCBSTCHN-1            PUT SEND SCH BACK IN CHAIN      55140020
         ST    R15,QCBSTCHN-1                                           55200020
         STC   R1,QCBSTCHN-1                                            55260020
         L     R14,AVTPARM3             SAVE RETURN ADDRESS    @SA74250 55320000
         BR    R10                      RETURN                          55380020
         AIF   (&A NE 3).H010                                           55440020
SWAPNOT  EQU  *                                                         55500020
         BAL    R10,NOSWAP                                              55560020
         B    UNITQUE                                                   55620020
SETDISK  EQU   *                                                        55680020
          TM     QCBDSFLG,QCBREUS+QCBNREUS                              55740020
*                        IS THIS A CORE ONLY QCB                        55800020
         BCR   8,R9                                                     55860020
         MVC   PRFCRCD(3),QCBDNHDR                                      55890022
         TM    PRFSTAT1,PRFNHDRN                                        55920020
         BZ    DISKALL .                YES, WE'RE SET           S22025 55980022
         MVC   PRFCRCD(3),SCBDNSEG .    SEG DISK ADDRESS OF THIS BFR    56040020
DISKALL   EQU   *                                                       56100020
         L     RPREFIX,AVTDOUBL+4                                       56160020
         B     QUEUE1                                                   56220020
.H010    AIF   (&A EQ 2).H011                                           56460020
QUEUNITS EQU   *                                                        56520020
         ST    RPREFIX,AVTDOUBL                                         56580020
         LTR   R12,R12                                                  56640020
         BM    OUTSZE                                                   56700020
         LH    R9,PRFSIZE                                               56760020
COMPSZE  EQU   *                                                        56820020
         CH    R9,AVTKEYLE                                              56880020
         BNH   FIXSZE .                 BR IF END IN THIS UNIT          56970020
        SH    R9,AVTKEYLE                                               57060020
        L    R6,PRFTIC                                                  57120020
         XC    1(7,R6),1(R6)            CLEAR DATA AREA                 57180020
         MVI   DATFLAGS-IEDQDATA(R6),DATNPRFX                           57240020
         B      COMPSZE                                                 57300020
FIXSZE   EQU   *                                                        57360020
         STC    R9,DATCOUNT-IEDQDATA(RPRF)                              57420020
OUTSZE   EQU   *                                                        57480020
         XC    PRFTIC+1(3),PRFTIC+1                                     57540020
         L    R6,AVTDOUBL                                               57600020
         XC    PRFKEY(6),PRFKEY .       ZERO IF SINGLE UNIT             57630020
         XC    PRFNTXT(3),PRFNTXT       CLEAR THE NTXT OF BFR           57660020
         TM    PRFSTAT1,PRFNHDRN        IS THIS A HEADER                57720020
         BNO   COREHDR                  BR YES                          57780020
         MVI   PRFTIC,AVTEZERO                                          57840020
         MVC   PRFCHDR(3),SCBCCHDR      CORE CURR HDR ADDR              57900020
         MVC   PRFCORE(3),AVTDOUBL+1                                    57960020
         MVC   PRFCRCD(3),PRFCORE       SET CURRENT RECORD IN   SA52971 57980022
*                                         CASE MAIN ONLY        SA52971 58000022
         MVC   AVTDOUBL+1(3),SCBCLSEG   ADDR OF PREV. TXT               58020020
         L     R9,AVTDOUBL                                              58080020
         MVC    PRFNTXT-IEDQPRF(3,R9),PRFCORE                           58140020
*                         ADDR OF THIS RECORD IN PREVIOUS UN TXT        58200020
         MVC    SCBCLSEG(3),PRFCORE                                     58260020
         BR    R10                                                      58320020
CNTUNITS EQU *                                                          58380020
         SR    R14,R14                                                  58440020
         IC    R14,PRFNBUNT             MO. OF UNITS IN TGUS BFR        58500020
         TM    PRFSTAT1,PRFDUPLN                                        58560020
         BNO   UNITCNT                                                  58620020
         LR    R10,R9 .                 SAVE RTN ADDR                   58630020
         BAL   R1,DUPLCORE .            FIND THIS ORIG. HDR             58640020
         LR    R9,R10 .                 RESTORE ADDR                    58650020
         LA    R14,1                                                    58680020
UNITCNT  EQU   *                                                        58740020
         SR    R5,R5 .                  CLEAR TO INITIALIZE             58800020
         SR    R0,R0 .                  CLEAR TO INITIALIZE             58860020
         L     R10,AVTCADDR             NO. UNITS USED IN COREQ@OY12977 58870000
         TM    QCBSTAT,QCBTRMHO         TERM HELD              @ZA06194 58880000
         BO    TOOMANY                  BR, YES                @ZA06194 58900000
         AR    R10,R14                  + NO. IN THIS BFR               58980020
        C   R10,AVTTOTNC                                                59040020
         BH    TOOMANY                  NO. OF CORE UNITS-BR YES        59100020
          C    R10,AVTCMAX                                              59220020
         BL    NOBITSET                                                 59280020
         OI    AVTSYSER,AVTCMAXN        SET CORE MAX                    59340020
         AIF   (&A EQ 1).H012A                                          59348020
*        IF DISK BACKUP - STOP CORE QUEUEING WHEN OVER CORE             59356020
*        MAX TO PREVENT FILLING TJE CORE QUEUE                          59364020
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                59372020
         BM    TOOMANY .                BR IF DISK BACKUP               59380020
.H012A   ANOP                                                           59388020
NOBITSET EQU   *                                                        59400020
         ST    R10,AVTCADDR .           SET NEW NO. USED FROM CORE Q    59430020
         C     R10,AVTCMIN                                              59460020
         BL    GETUNITS                                                 59520020
         NI    AVTSYSER,AVTCMINF                                        59580020
GETUNITS  EQU  *                                                        59640020
         LR    R11,R14 .                SAVE NUMBER GOTTEN              59670020
TAKEUNIT EQU   *                                                        59700020
        NC    AVTBFREB+1(3),AVTBFREB+1                                  59760020
        BZ    ALLGONE                                                   59820020
         L     R5,AVTBFREB                                              59880020
         MVC   AVTBFREB+1(3),PRFLINK-IEDQPRF(R5)                        59940020
*                        REMOVE THE FIRST UNIT                          60000020
         ST    R0,PRFTIC-IEDQPRF(R5)    LINK THIS UNIT TO PREV. ONE     60060020
         LR    R0,R5                    GET NOE PREV. UNIT              60120020
         BCT   R14,TAKEUNIT             WHEN THE NECESSARY UNITS        60180020
*                                       HAVE BEEN REMOVED, SET UP       60240020
*                                       TO POST THEM AS ONE UNIT        60300020
         IC    R14,PRFNBUNT        PUT NUMB OF UNITS                    60360020
         STC   R14,PRFNBUNT-IEDQPRF(R5)   IN NEXT BFR                   60420020
         XC    PRFLINK-IEDQPRF(3,R5),PRFLINK-IEDQPRF(R5)                60480020
         LH    R0,AVTAVFCT .            SUBTRACT THE NO. OF UNITS       60540020
         N     R0,AVTCLRHI              CLEAR HIGH BYTES       @YA07705 60570000
*        TO BE USED FROM THE AVAILABLE COUNT                            60600020
         SR    R0,R11 .                 DECR NO GOTTEN                  60660020
         STH   R0,AVTAVFCT                                              60720020
         BR    R9                                                       60780020
ALLGONE  EQU   *                                                        60840020
         LA     R5,0(0,R5)                                              60900020
         LTR   R5,R5                                                    60960020
         BZ    TOOMANY                                                  61020020
         MVC   PRFLINK-IEDQPRF(3,R5),AVTBFREB+1                         61080020
         ST    R5,AVTBFREB                                              61140020
        L     R5,PRFTIC-IEDQPRF(R5)                                     61200020
         B     ALLGONE                                                  61260020
         AIF   (&A EQ 1).H012                                           61320020
NOSWAP   EQU   *                                                        61380020
         LH    R2,AVTKEYLE                                              61440020
         XC    0(8,R5),0(R5)            CLEAR FIRST 8 BYTES OF BFR      61500020
         ST    RPRF,AVTDOUBL+4                                          61560020
         LR    R0,R5                                                    61620020
         LR    R9,RPRF                                                  61680020
         BCTR    R2,0                    FOR EXECUTE INSTR.             61740020
         SR    RPRF,RPRF                CLEAR                           61800020
         IC    RPRF,PRFNBUNT-IEDQPRF(R9)     UNITS IN BFR               61860020
MOVE     EQU   *                                                        61920020
         EX    R2,TRANSFER                                              61980020
         BCT   RPRF,NXTUNT              DECR UNIT CNT                   62040020
         LR    RPREFIX,R0                                               62100020
          BR    R10                                                     62160020
NXTUNT   EQU   *                                                        62220020
         L     R5,PRFTIC-IEDQPRF(R5)                                    62280020
         L     R9,PRFTIC-IEDQPRF(R9)                                    62340020
         B     MOVE                                                     62400020
.H012    ANOP                                                           62460020
SETFEFO EQU   *                                                         62520020
         LTR    R12,R12                 CALLED BY REUS                  62580020
         BCR    8,R9                    YES - RETURN                    62640020
         LR    R2,R9 .                  SAVE RTN ADDR                   62700020
         BAL   R9,LOCKMSG                                               62760020
         B     INITFEFO .               IF RTN HERE - NOT LOCK MSG      62820020
*        SO THE FEFO PRTR SHOULD BE SET                                 62880020
         LR    R9,R2 .                  RESTORE RTN ADDR                62940020
         BR    R9 .                     RETURN - NO FEFO PTR ON LOCK    63000020
INITFEFO EQU   *                                                        63060020
         LR    R9,R2 .                  RESTORE RTN ADDR                63120020
         BAL   R14,SENDINIT                                             63180020
         B     SETFEFO1                                                 63240020
         BR    R9                                                       63300020
SETFEFO1 EQU   *                                                        63360020
         MVC    AVTDOUBL+1(3),PRFCORE                                   63420020
         TM    PRFSTAT1,PRFNHDRN        THIS A HDR                      63480020
         BNO   RECOK                    BR YES                          63540020
         MVC   AVTDOUBL+1(3),PRFCHDR    NEW HDR ADR                     63600020
RECOK    EQU   *                                                        63660020
*        IF ONLY 1 THERE THE MSG COULD HAVE BEEN READ BUT THE           63720020
*        FEFO PTR MAY NOT BE UPDATED YET , SO THE SCB IN WHICH          63780020
*        THE FEFO PTR WAS SAVED MUST BE UPDATED.                        63840020
         STM   R14,R12,AVTSAVE2+12 .    SAVE REGS               SA52971 63900022
         LA    R9,QCBLFEFO .            SET HM03 INPUT          SA52971 63920022
         LA    R10,AVTDOUBL+1 .           PARAMETERS            SA52971 63940022
         BAL   R14,IEDQHM03                                             63960020
         LM    R14,R12,AVTSAVE2+12 .    RESTORE REGS            SA52971 64020022
         LH    R2,QCBLFEFO              KEEP ADDR OF                    64320020
         SLL   R2,8                     LAST COMPLETELY RCVD MSG        64380020
         IC    R2,QCBLFEFO+2                                            64440020
         MVC   QCBLFEFO(3),AVTDOUBL+1                                   64500020
         NC    QCBFFEFO(3),QCBFFEFO     IS THERE ONE FEFO MSG           64560020
         BZ    FIRSTFFO                                                 64620020
         MVC   DATFEFO(3),QCBLFEFO                                      64680020
         BR   R9                                                        64740020
FIRSTFFO EQU   *                                                        64800020
         MVC   QCBFFEFO(3),QCBLFEFO                                     64860020
         BR    R9                                                       64920020
MSGCNT   EQU   *                                                        64980020
         LH    R5,QCBMSGCT .            MSGCNT HAS ALREADY BEEN         65040020
         BCTR   R5,0                    CHANGED FOR THIS HDR            65100020
         STH   R5,QCBMSGCT .            FIX IT BACK                     65160020
         B     RCQCB                                                    65220020
TOOMANY  EQU   *                                                        65280020
         LTR   R12,R12 .                REUS OR COPY                    65340020
         BM    4(R9) .                  RETURN AT +4                    65400020
         TM    QCBDSFLG,QCBREUS+QCBNREUS ANY DISK               SA61085 65420000
         BM    NOTLOST .                BRANCH IF YES           SA61085 65440000
         OI    SCBERR3,SCBLOSTN .       SET LOST MSG                    65460020
NOTLOST  EQU   *                                                SA61085 65490000
         SR    R10,R14                                                  65520020
         ST    R6,AVTDOUBL+4            SAVE BFR ADDR                   65580020
         TM    PRFSTAT1,PRFNHDRN                                        65640020
         BO    NOTHDR                                                   65700020
         TM    PRFSTAT1,PRFDUPLN .      DUPL HDR - NO QUEUEING          65720020
         BO    MSGCNT .                 BR IF DUPL TO DECR MSG COUNT    65740020
         AIF   (&A EQ 1).H013                                           65760020
         TM    PRFSTAT1,PRFERMGN .      IS THIS AN ERRORMSG             65770020
         BO    NOCLR .                  BR IF ERR MSG                   65780020
CLEARCOR EQU   * .                                               A51776 65785022
         XC    SCBCCHDR(3),SCBCCHDR .   CHEAR FOR NOQUEUE               65790020
NOCLR    EQU   *                                                        65800020
          TM     QCBDSFLG,QCBREUS+QCBNREUS                              65880020
         BM    QUEUE1                                                   65940020
.H013    ANOP                                                           66000020
         XC    SCBMRFSD(4),SCBMRFSD     STOP MULT RT AND DLIST          66180020
         BAL   R14,SENDINIT                                             66240020
         B     NOHMSG                                                   66300020
         OI    DATFLAGS-IEDQDATA(R6),DATINITL .  SET INIT LOST          66360020
NOHMSG   EQU   *                                                        66420020
         LA    R10,1(R10)                                               66480020
         C     R10,AVTTOTNC             IF ONE UNIT IS AVAILABLE        66540020
*              THE RCV. SWITCH SHOULD NOT BE SET                        66600020
         BNH   UNITHERE                 BR IF AVAILABLE                 66660020
         OI    AVTBIT3,AVTRECVN         SET RCV SW.                     66720020
UNITHERE EQU   *                                                        66780020
         SR    R5,R5                    CLEAR TO SET NO BUF RET@SA72466 66840061
         ST    R5,AVTDOUBL+4            SET NO BFR TO RETURN   @SA72466 67140061
         MVC   AVTDOUBL+4(1),PRFSTAT1   SAVE PRFSTAT           @SA72466 67440061
         SR    R9,R9                    CLEAR REGISTER         @OY14492 67510000
         IC    R9,PRFNBUNT              NO. OF UNITS IN BUFFER @OY14492 67580000
         AR    R10,R9                   SET TO CADDR+NBUNT     @OY14492 67650000
         BCTR  R10,R0                   ACCOUNT FOR 1 UNIT     @OY14492 67720000
         ST    R10,AVTCADDR             UPDATE NO USED UNITS            67800020
         ST    R6,AVTDOUBL                                              67860020
         BAL   R9,ASSIGN1                                               67920020
         TM    PRFSTAT1,PRFCNCLN .      IS THIS TO BE CNCLD             67930020
         BNO   NOCNCL .                 BR NO                           67940020
         OI    DATFLAGS-IEDQDATA(R6),DATCNCLD                           67950020
NOCNCL   EQU   *                                                        67960020
         XC    AVTDOUBL+1(3),AVTDOUBL+1                                 67980020
         LR    R2,R6                                                    68100020
         B     FOUNDMSG                 GO FREE EXTRA UNITS    @SA72466 68160061
NOLOST   EQU   *                                                        68220020
         ST    R6,AVTDOUBL+4            SAVE BFR ADDR                   68280020
         MVC   AVTDOUBL+4(1),PRFSTAT1   SAVE PRFSTAT           @SA72466 68310061
         L     R2,AVTDOUBL                                              68340020
FOUNDMSG EQU   *                                                        68400020
         MVC   AVTDOUBL+1(3),PRFNTXT-IEDQPRF(R2)                        68460020
         XC    PRFNTXT-IEDQPRF(3,R2),PRFNTXT-IEDQPRF(R2)                68520020
         SR    R9,R9                                                    68580020
         IC    R9,PRFNBUNT-IEDQPRF(R2)                                  68640020
         LH    R1,AVTAVFCT              COUNT OF AVAILABLE BFRS         68760020
         N     R1,AVTCLRHI              CLEAR HIGH BYTES       @YA07705 68790000
         OI    DATFLAGS-IEDQDATA(R2),DATLOSTN                           68820020
         NI    PRFSTAT1-IEDQPRF(R2),PRFNLSTF                            68880020
         CLC   PRFSIZE-IEDQPRF(2,R2),AVTKEYLE                           68940020
         BNH   SIZEOK                                                   69000020
         MVC   PRFSIZE-IEDQPRF(2,R2),AVTKEYLE                           69060020
SIZEOK   EQU   *                                                        69120020
         MVI   PRFNBUNT-IEDQPRF(R2),X'01'                               69180020
*              SET NB UNITS TO ONE IN BFR TO LEAVE                      69240020
         BCT   R9,NEXTUNIT                                              69300020
         XC    PRFTIC+1-IEDQPRF(3,R2),PRFTIC+1-IEDQPRF(R2)              69360020
NEXTBFR  EQU   *                                                        69420020
         NC    AVTDOUBL+1(3),AVTDOUBL+1                                 69480020
         BZ    LASTBFR                                                  69540020
         L     R5,AVTDOUBL                                              69600020
         IC    R9,PRFNBUNT-IEDQPRF(R5)       NO UNITS IS BFR            69660020
         MVC   AVTDOUBL+1(3),PRFNTXT-IEDQPRF(R5)                        69720020
         B     FREEUNIT                                                 69780020
NEXTUNIT EQU   *                                                        69840020
         L     R5,PRFTIC-IEDQPRF(R2)                                    69900020
         XC    PRFTIC+1-IEDQPRF(3,R2),PRFTIC+1-IEDQPRF(R2)              69960020
FREEUNIT EQU   *                                                        70020020
         MVC    PRFLINK-IEDQPRF(3,R5),AVTBFREB+1                        70080020
         ST    R5,AVTBFREB                                              70140020
         LR    R2,R5                                                    70200020
         BCTR  R10,R0                                                   70260020
         LA    R1,1(R1)                 INCREASE COUNT FOR NO. RTNED    70320020
         BCT   R9,NEXTUNIT                                              70380020
         B     NEXTBFR                                                  70440020
LASTBFR  EQU   *                                                        70500020
         MVC   SCBCLSEG(3),SCBCCHDR .   SET LAST SET (ALSO       A47137 70520022
*        SCBSCHDR) TO THE LAST SEGMENT ON THE QUEUE              A47137 70540022
         STH   R1,AVTAVFCT              RESTORE COUNT OF BFRS           70560020
         ST    R10,AVTCADDR                                             70620020
         AIF   (&A EQ 1).H0013A                                         70680020
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                70740020
         BM    QUEUE1                                                   70800020
.H0013A  ANOP                                                           70860020
         B     CKLAST                                                   70980020
NOQUEUE   EQU   *                                                       71040020
         BM    NOQUEUE1 .               BR NOT INIT LOST                71100020
         TM    PRFSTAT1,PRFNLSTN .      IS THIS THE LAST BFR            71160020
         BNO   NOTHDR .                 BR IF LAST BFR                  71220020
NOQUEUE1 EQU   *                                                        71280020
         ST    R6,AVTDOUBL+4                                            71340020
         MVC   AVTDOUBL+4(1),PRFSTAT1   SAVE PRFSTAT           @SA72466 71370061
         MVC    PRFCHDR(3),SCBCCHDR                                     71400020
         AIF  (&A EQ 1).H0013B                                          71460020
         BAL   R9,SETDISK                                               71520020
.H0013B  ANOP                                                           71580020
CKLAST   EQU   *                                                        71640020
        LA    R6,0(R6)                                                  71700020
         LTR    R6,R6                                                   71760020
         BZ    RTNBFR                                                   71820020
         TM    AVTDOUBL+4,PRFNLSTN      WAS THIS LAST          @SA72466 71880061
         BO    TESTLAST                 BR IF NO               @SA72466 71940061
         LTR   R12,R12                                                  72000020
         BM    TESTLAST                 BR IF YES              @SA72466 72060061
         BAL   R9,SETFEFO                                               72120020
         BAL   R14,FINDSTCB                                             72180020
         BAL   R14,SAMELAST                                             72240020
         NI    LCBSTAT1,LCBINITF .      SET INIT MODE OFF               72300020
         NI    LCBINSRC+2,X'FF'-XXXON . SET INSRC FLAG OFF              72360020
TESTLAST EQU   *                                               @SA72466 72370061
         L     R6,AVTDOUBL+4            RESTORE ADDR OF BUFFER @SA72466 72380061
*                                         TO FREE              @SA72466 72390061
         LA    R6,0(R6)                 CLEAR HIGH ORDER BYTE  @SA72466 72400061
RTNBFR   EQU   *                                                        72420020
         L     R11,AVTEA                DISP ADDR                       72480020
         LTR   R6,R6                                                    72540020
         BZ    DSPDISP                  BR NO                           72600020
         MVI    PRFPRI,PRIBFRTB                                         72660020
          LA    R2,AVTBFRTB                                             72720020
          B     NRPOST                                                  72780020
NOTHDR   EQU   *                                                        72840020
         MVC   AVTDOUBL+1(3),SCBCCHDR                                   72900020
         MVC   PRFCHDR(3),SCBCCHDR                                      72960020
         BAL   R14,SENDINIT                                             73020020
         B     NOLOST                                                   73080020
         L     R2,AVTDOUBL .            ADDR OF HDR                     73140020
         OI    DATFLAGS-IEDQDATA(R2),DATLOSTN+DATINITL                  73200020
*        SET INIT LOST                                                  73260020
         TM    PRFSTAT1,PRFNLSTN .      LAST BFR                        73560020
         BO    RTNBFR .                 BR NOT LAST - DO NOT QUEUE IT   73620020
         OI    LCBERBST-IEDQLCB(R1),XXHMSG .  SET EOM HERE              73680020
         L     R1,LCBSCBA-1-IEDQLCB(R1) .    DEST SCB                   73740020
         OI    SCBERR3-IEDQSCB(R1),SCBLOSTN .  SET MSG LOST             73800020
CKBFR    EQU   *                                                        73860020
         NC    AVTBFREB+1(3),AVTBFREB+1 .   ANY BFRS                    73920020
         BZ    INITNOBF .               BR NO                           73980020
         L     R5,AVTBFREB .            UNIT ADDR                       74040020
         MVC   AVTBFREB+1(3),PRFLINK-IEDQPRF(R5) .   DELINK VFR         74100020
         MVI   PRFNBUNT-IEDQPRF(R5),X'01' .   SET NO UNITS              74160020
         LH    R1,AVTAVFCT .            DECR COUNT OF AVAIL BFRS        74220020
         N     R1,AVTCLRHI              CLEAR HIGH BYTES       @YA07705 74250000
         BCTR  R1,0                                                     74280020
         STH   R1,AVTAVFCT                                              74340020
         SR    R2,R2                    CLEAR 2                         74400020
         L     R1,AVTCADDR .            NO. OF CORE UNITS USED          74460020
         IC    R2,PRFNBUNT .            NO THIS BFR                     74520020
         AR    R1,R2 .                  NEW TOTAL USED                  74580020
         ST    R1,AVTCADDR                                              74640020
         NI    PRFSTAT1,PRFNLSTF                                        74700020
         B     INITRTN                                                  74760020
INITNOBF EQU   *                                                        74820020
         L     R1,LCBINSRC-1 .          DEST LCB ADDR                   76620020
         TM    LCBERBST-IEDQLCB(R1),LCBRDERR                            76680020
*        NOW WAITING FOR THIS BFR TO SEND                               76740020
         L     R1,LCBSCBA-1-IEDQLCB(,R1) DEST SCB                       76800020
         BNO   SETLAST .                BR NOT WAITING FOR THIS BFR     76860020
         MVC   SCBCORE-IEDQSCB(3,R1),SCBCLSEG RESET LAST BFR            76920020
SETLAST  EQU   *                                                        76980020
         L     R1,SCBCLSEG-1 .          ADDR FOR LAST BFR               77040020
         NI    PRFSTAT1-IEDQPRF(R1),PRFNLSTF .  SET EON                 77100020
         B     RTNBFR                                                   77160020
.H011    ANOP                                                           77220020
         TITLE '''IEDQHM'' - INTER-MODULE SUB-ROUTINES' .        S22025 77280022
*                                                                       77340020
*                                                                       77400020
*        ENTRY HERE FROM REUS - COPY AND CKPT-RESTART                   77460020
*                                                                       77520020
*                                                                       77580020
         DC    A(IEDQHM03)                                              77640020
IEDQHM02 EQU   *                                                        77700020
         USING *,R15                                                    77760020
         STM   14,12,12(R13)                                            77820020
         L    R12,BASE                                                  77880020
         DROP  R15                                                      77940020
*        REUS, COPY, AND RESTART ALL SET UP PQCB                        78000020
         AIF   (&A NE 3).H014                                           78060020
         TM    QCBDSFLG,QCBREUS+QCBNREUS                                78120020
*                   IS THES A CORE ONLY QCB                             78180020
         BM    QUEUE1                   BR NO                           78240020
.H014    AIF   (&A NE 2).H014A                                          78300020
         B     QUEUE1                                                   78360020
         AGO   .H015                                                    78420020
.H014A   ANOP                                                           78480020
         ST    R6,AVTDOUBL+4 .          SAVE PASSED UNIT                78540020
         XC    PRFTIC(4),PRFTIC .       CLEAR TIC FIELD                 78600020
         TM    DATFLAGS-IEDQDATA(R6),DATNPRFX                           78660020
         BNO   SETNBUNT                 BR IF UNIT HAS PRFX             78720020
         L     R6,SCBCLSEG-1            ADDR LAST PRFX PASSED           78780020
         B     NOMVI                    BR NOT TO SET NBUNT             78840020
SETNBUNT EQU   *                                                        78900020
         MVI   PRFNBUNT,X'01' .         SET 1 UNIT IN BFR               78960020
NOMVI    EQU   *                                                        79020020
         LA    R14,1                                                    79080020
         BAL   R9,UNITCNT                                               79140020
         B     TMDAT .                  HAVE A UNIT TO USE              79200020
         BCTR  R10,0 .                  DECRMENT  MSUNIT COUNT          79260020
         ST    R10,AVTCADDR .           UPDATE                          79320020
         ST    R5,AVTPARM                                               79380020
         L     R2,SCBCCHDR-1 .          HDR THIS MSG                    79440020
         L     R10,AVTCADDR .           NO MSUNITS USED                 79500020
         L     R1,AVTDOUBL+4 .          ADDR OF PASSED UNIT             79560020
         TM    DATFLAGS-IEDQDATA(R1),DATNPRFX                           79620020
         BO    FOUNDMSG .               BR NO PRFX                      79680020
         TM    PRFSTAT1,PRFNHDRN .      THIS A HDR                      79740020
         BO    FOUNDMSG .               BR NOT HDR                      79800020
.H015    ANOP                                                           79860020
COPYRTN  EQU   *                                                        79920020
         L     R5,AVTPARM                                               79980020
         LTR   R15,R5                   PASS BUFFER ADDR TO 19RP        80040000
         L     R14,12(13,0)             RESTORE 14                      80100020
         LM    0,12,20(13)              RESTORE REUS REGISTERS          80160020
         BR    R14                      RETURN                          80220020
         AIF   (&A EQ 2).H017                                           80280020
TMDAT    EQU   *                                                        80340020
         ST    R5,AVTPARM                                               80400020
         L     R2,AVTDOUBL+4 .          ADDR OF PASSED UNIT             80460020
         TM    DATFLAGS-IEDQDATA(R2),DATNPRFX  PRFX IN TUNIT            80520020
*                  DOES THIS UNIT JAVE A PRFFIX                         80580020
         BNO   UNITQUE .                BR IF PRFX THIS UNIT            80640020
         IC    R1,PRFNBUNT .            ADD 1 TO NBUNT OF LAST BFR      80700020
         LA    R1,1(R1)                                                 80760020
         STC   R1,PRFNBUNT .                                            80820020
CHECKTIC EQU   *                                                        80880020
         NC    PRFTIC+1(2),PRFTIC+1                                     80940020
         BZ    NOTIC                                                    81000020
         L    R6,PRFTIC                                                 81060020
         B    CHECKTIC                                                  81120020
NOTIC    EQU    *                                                       81180020
         ST    R2,PRFTIC                LINK TO PREV UNIT               81240020
         MVI    PRFTIC,X'00'                                            81300020
         B     COPYRTN                                                  81360020
         AIF   (&A EQ 1).H016                                           81420020
TRANSFER EQU   *                                                        81480020
         MVC    PRFSUNIT-IEDQPRF(0,R5),PRFSUNIT-IEDQPRF(R9)             81540020
.H016    ANOP                                                           81600020
DUPLTRAN EQU   *                                                        81660020
         MVC   PRFSUNIT-IEDQPRF(0,R5),PRFSUNIT-IEDQPRF(R2)              81720020
.H017    ANOP                                                           81780020
COMPRI   CLI   QCBPRLVL,X'00'                                           81840020
         DS    0F                                                       81900020
BASE     DC    X'80'                                                    81960020
         DC    AL3(DESTSCH)                                             82020020
ROUND    DC    F'3' .                   CONSTANT VALUE           S21101 82070020
CLEAROFF DC    X'00FFFFFC'                                              82080020
         DS    0H                       ADDRESS CONSTANT FOR   @YM04658 82090000
NPRFSIZE DC    AL2(QCBPRFSZ)            QCB NEG PREFIX SIZE    @YM04658 82100000
ABCODE4  EQU   X'04' .                  COPY NOT PRESENT IN SYSTEM      82120020
ABCODE7  EQU   X'07' .                 MSG WRAPPED TOE DISK             82160020
TM       TM    SCBCQT,X'00'                                             82220020
OI       OI    SCBCQT,X'00'                                             82240020
XTIC     EQU   X'08'                    TIC OP CODE                     82260020
DIALPRTY EQU   X'40'                    PRTY OF DIAL SCHEDULER          82320020
         EJECT                                                          82380020
IEDQHM03 DS    0H                                                       82440020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 82500020
*                                                                       82560020
                        ENTRY IEDQHM03                                  82620020
*                                                                       82680020
* QUESTION - IS THE MSG POINTED TO BY FFEFO THE ONLY MSG ON THIS Q --   82740020
* AND IS THAT ONE MSG BEING SENT -- IF SO, WHERE IS THE SCB --          82800020
*                                                                       82860020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 82920020
*                                                                       82980020
* INPUT - R14 RETURN ADDRESS                                            83040020
*         R7  MASTER QCB                                                83100020
*         R8  PRIORITY QCB                                              83160020
*        R13 AVTSAVE2                                                   83220020
*                                                                       83280020
*OUTPUT - IF THE ONLY MSG IS BEING SENT, RETURN TO R14+4, SCB IN R2.    83340020
*     IF OTHERWISE, RETURN TO R14.  THIS COULD BE FOR TWO REASONS --    83400020
*     A. IF FIRST MSG WAS NOT BEING SENT, RETURN TO R14 (POSITIVE).     83460020
*     B. IF THE FIRST MSG WAS BEING SENT, BUT WAS NOT THE ONLY          83520020
*        MSG ON THE QUEUE, RETURN TO R14 (NEGATIVE), SCB IN R2.         83580020
*                                                                       83640020
* WORK REGS MODIFIED - R0,R2,R15,R1                                     83700020
*                                                                       83760020
* SCRATCH AREA MODIFIED - AVTPARM3                                      83820020
*                                                                       83880020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 83940020
*                                                                       84000020
         LA    R14,0(,R14) .            FORCE POSITIVE                  84060020
* IF ONLY 1 MSG THERE,THE MSG COULD HAVE BEEN READ BUT THE FEFO PTR     84120020
* MAY NOT BE UPDATED YET, SO THE SCB IN WHICH THE FEFO PTR WAS          84180020
* SAVED MUST BE UPDATED BY THE CALLER.                                  84240020
*                                                                       84300020
         TM    QCBFLAG,QCBSDFFO .       IS THAT ONE MSG BEING SENT      84360020
         BCR   8,R14 .                    NO, NOT BEING SENT            84420020
*                                         YES, SOME MSG IS BEING        84480020
*                                           SENT, BUT IT MAY BE         84540020
*                                           FROM SOME OTHER PRIORITY    84600020
*                                           LEVEL OF THIS SAME QCB      84660020
         STM   R14,R12,AVTSAVE4+12      SAVE REGS               SA52971 84690022
         BALR  R15,0 .                  ESTABLISH ADDRESSABILITY        84720020
         USING *,R15 .                    FOR HM03 IN R15               84780020
         SR    R0,R0 .                  ZERO WORK REG           SA52971 84810022
         TM    QCBFLAG,QCBPROC .        IS QCB FOR PROCESS ENTRY        84840020
         BZ    FINDLCB .                NO, FIND CORRECT LCB    SA52971 84900022
         L     RSCB,QCBPREN .           GET TPROCESS ENTRY ADDR SA52971 84903022
         CLI   TRMSTAT+1-IEDQTRM(RSCB),AVTEZERO                @SA74018 84903400
*                                        PROCESS ENTRY CLOSED  @SA74018 84903800
         BNE   PROCGO                   BRANCH IF NO           @SA74018 84904200
         NI    QCBFLAG,AVTEFF-QCBSDFFO  SET NOT SENDING        @SA74018 84904600
         LM    R14,R12,AVTSAVE4+12      RESTORE REGS           @SA76309 84904881
         BR    R14                      RETURN TO CALLER       @SA74018 84905000
PROCGO   EQU   *                                               @SA74018 84905400
         L     RSCB,TRMSTAT-IEDQTRM(,RSCB) GET PEWA ADDR        SA52971 84906022
         LA    RLCB,EOMSAVE-4-IEDQPEWA(,RSCB) SET FOR SAVED EOM SA52971 84909022
         LA    R2,(SCBFEFO-IEDQSCB)-(PRFSRCE-IEDQPRF) MAKE SAVEDSA52971 84912022
*                                         FEFO LOOK LIKE SCB    SA52971 84915022
         BAL   R14,APPBFR .             GO CHECK SAVED BFR      SA52971 84918022
         LA    RLCB,PERAQCB-4-IEDQPEWA(,RSCB) SET FOR READ-     SA52971 84921022
*                                         AHEAD QUEUE           SA52971 84924022
         TM    LCBSTAT1-LCBCHAIN(RSCB),LCBRCLLN RETRIEVING      SA52971 84927022
         BNO   NORCL .                  NO, WE HAVE BFR CHAIN   SA52971 84930022
         LA    RLCB,PERAQCB-IEDQPEWA(,RSCB) GET CORRECT BFR CHN SA52971 84933022
NORCL    EQU   * .                                              SA52971 84936022
         LA    R2,(SCBFEFO-IEDQSCB)-(PRFQCBA-IEDQPRF) MAKE SAVEDSA52971 84939022
*                                         FEFO LOOK LIKE SCB    SA52971 84942022
         BAL   R14,APPBFR .             GO CHECK SAVED BFRS     SA52971 84945022
LOOPBGN  EQU   * .                                              SA52971 84948022
         CLC   PRFLINK-IEDQPRF(3,RLCB),AVTDELAD+1 IS THAT ALL   SA52971 84951022
         BE    LOOPEND .                YES, EXIT               SA52971 84954022
         LR    R1,RLCB .                SAVE PREVIOUS           SA52971 84957022
         L     RLCB,PRFLINK-1-IEDQPRF(,RLCB) GET NEXT           SA52971 84960022
         MVC   PRFQCBA-IEDQPRF(3,RLCB),PRFQCBA-IEDQPRF(R1) SET  SA52971 84963022
*                                         NEXT BFR WITH FEFO    SA52971 84966022
         B     LOOPBGN .                GO LOOK AT NEXT         SA52971 84969022
LOOPEND  EQU   * .                                              SA52971 84972022
         LA    R5,PEWASAVE+D24-IEDQPEWA(RSCB) MSG SAVED IN RETR@OX16398 84973000
         LR    R1,RSCB .                SAVE LCB ADDRESS        SA52971 84975022
         LA    RSCB,LCBCHAIN-IEDQLCB .                          SA52971 84978022
         SLR   R1,RSCB .                                        SA52971 84981022
         L     R2,LCBSCBA-1-IEDQLCB(,R1) SCB ADDRESS            SA52971 84984022
         TM    LCBSTAT1-IEDQLCB(R1),LCBRCLLN RETRIEVE          @OX16398 84987000
         BZ    TSTLEVEL                 NO                     @OX16398 84987600
         LA    R2,(PEWASAVE+D28-IEDQPEWA)-(SCBFEFO-IEDQSCB)(R1,RSCB)    84987900
*        SET PEWASAVE+28 TO LOOK LIKE SCBFEFO FOR LATER CODE   @OX16398 84988800
         B     FEFOCK                   CHECK TO UPDATE FEFO PT@OX16398 84989400
         SPACE 1 .                                              SA52971 84990022
FINDLCB  EQU   * .                                              SA52971 84993022
         L     R2,QCBDCBAD-1 .          GET ADDR OF DCB                 85020020
         CLI   QCBSTVTO,DSPLOGSC        IS QCB FOR LOGTYPE       S22024 85020622
         BE    NOT3705                  BRANCH ON YES            S22024 85021222
         TM    DCBDSORG-IHADCB(R2),AVTE80 IS THIS AN LGB ?       S22024 85022022
         BNO   NOT3705                  NO,GO GET SCB ADDR.      S22024 85024022
         LA    R2,QCBPRFSZ              QCB PREFIX SIZE        @YM06062 85026000
         LNR   R2,R2                    MAKE IT NEGATIVE       @YM06062 85027000
         AR    R2,RQCB                  SET NEGATIVE QCB BASE  @YM06062 85028000
         TM    QCBSTAT1-IEDNQCB(R2),QCBPLCBN  IS PLCB ASSIGNED @OZ29731 85028682
         BZ    EXIT                     NO, EXIT IEDQHM03      @OZ29731 85029282
         L     R2,QCBPLCBA-1-IEDNQCB(R2)  GET PLCB ADDRESS       S22024 85030022
         B     RITELCB                  EXIT TO COMMON CODE             85032022
NOT3705  EQU   *                                                        85034022
         IC    R0,DCBEIOBX-IHADCB(,R2) .GET SIZE OF AN LCB              85140020
         ST    R0,AVTPARM3 .            SAVE SIZE OF AN LCB             85200020
         L     R2,DCBIOBAD-IHADCB(,R2) .GET PSEUDO IOB ADDR             85260020
         LA    R1,LCBFLAG1-IEDQLCB .    GET OFFSET INTO LCB OF IOB      85320020
         SR    R2,R1 .                  BACK UP TO PSEUDO LCB           85380020
         AR    R2,R0 .                  BUMP TO FIRST REAL LCB          85440020
         TM    LCBSTAT2-IEDQLCB(R2),LCBDIAL IS THIS A DIAL LCB          85500020
         BO    DIALCB .                   YES, DIAL                     85560020
*                                         NO, NON-DIAL                  85620020
         SR    R1,R1 .                  CLEAR WORK REG                  85680020
         IC    R1,QCBRELLN .            GET REL. LINE NO.               85740020
         BCTR  R1,0 .                   ADJUST FOR ONE BUMP             85800020
*                                         ALREADY DONE                  85860020
         MR    R1-1,R0 .                MULT. REL. LINE NO(-1) TIMES    85920020
*                                         LCB SIZE, GET OFFSET TO LCB   85980020
         AR    R2,R1 .                  BUMP TO PROPER LCB              86040020
         LR    R11,R2 .                 SAVE LCB ADDRESS        SA52971 86070022
         L     R2,LCBSCBDA-1-IEDQLCB(,R2) GET ADDR FIRST SCB            86100020
         SR    R0,R0 .                  CLEAR BOTH                      86160020
         LR    R1,R0 .                    WORK REGS                     86220020
         IC    R1,QCBSCBOF .            GET INDEX TO PROPER SCB         86280020
         IC    R0,AVTSCBSZ .            GET SIZE OF ONE SCB             86340020
         MR    R1-1,R0 .                MULT. NO. OF SCB TIMES SIZE     86400020
*                                         OF ONE SCB, GET OFFSET        86460020
         ALR   R2,R1 .                  BUMP ADDR OF FIRST SCB TOA42367 86520021
*                                         PROPER SCB FOR THIS QCB       86580020
         LR    RSCB,R2 .                SAVE SCB ADDR           SA52971 86610022
         TM    SCBQTYPE-IEDQSCB(R2),SCBCONC IS THIS A CONCEN    SA52971 86640022
         BZ    RELOAD .                 BRANCH IF NO            SA52971 86740022
         LR    R2,RQCB .                GET QCB ADDR            SA52971 86940022
         AH    R2,QCBEXTO .             GET QCB EXTENSION       SA52971 87040022
         LR    R12,R2 .                 SAVE PRIMARY ADDR       SA52971 87100022
         TM    QCBEFLG-IEDQQCBE(R2),QCBEOPL MSG,L QUEUE         SA52971 87140022
         BZ    RSETLCB .                NO, GO RESET LCB        SA52971 87240022
         LA    RLCB,IEDQPQCB-QCBPSIZE . GET 0TH PRI QCB         SA52971 87340022
EXTLOOP  EQU   * .                                              SA52971 87440022
         IC    R0,QCBELGTH-IEDQQCBE(,R2) GET EXTENSION LENGTH   SA52971 87540022
         AR    R2,R0 .                  GO TO NEXT EXTENSION    SA52971 87640022
         LA    RLCB,QCBPSIZE(,RLCB) .   POINT TO NEXT PRI QCB   SA52971 87740022
         CR    RLCB,RPQ .               IS THIS CORRECT ONE     SA52971 87840022
         BNE   EXTLOOP .                NO, LOOK AT NEXT        SA52971 87940022
         LR    R12,R2 .                 SAVE PRIMARY ADDR       SA52971 87990022
         LA    R5,(SCBFEFO-IEDQSCB)-(QCBEFEFO-IEDQQCBE) GET DECRSA52971 88040022
*                                         FOR DUMMY SCB         SA52971 88140022
         SLR   R2,R5 .                  MAKE FEFO PTR LOOK LIKE SA52971 88240022
*                                         IT'S IN SCB           SA52971 88340022
         LA    R5,((SCBFEFO-IEDQSCB)-(QCBEFEFO-QCBEHDR))(,R2) PTSA52971 88440022
*                                         TO HEADER ADDR        SA52971 88540022
         BAL   R14,FEFOCOMP .           GO CHECK MSG            SA52971 88640022
RSETLCB  EQU   * .                                              SA52971 88650022
         TM    QCBEFLG-IEDQQCBE(R12),QCBEPEND QACTION HERE      SA52971 88660022
         BZ    RELOAD .                 NO, WE'RE SET           SA52971 88670022
         LR    R2,RQCB                  GET QCB ADDR            SA58988 88680022
         AH    R2,QCBEXTO               CALC QCB EXTENSION      SA58988 88683022
         MVC   AVTSAVE4+1(3),QCBELCB-IEDQQCBE(R2)  RESET TO     SA58988 88686022
         L     R11,AVTSAVE4 .           DUMMY LCB IN QACTION    SA52971 88690022
RELOAD   EQU   * .                                              SA52971 88740022
         LR    R1,R11 .                 SET LCB ADDRESS         SA52971 88840022
         LR    R2,RSCB .                RESET SCB ADDR          SA52971 88940022
         B     TSTLEVEL .               GO CHECK SCB            SA52971 89040022
         SPACE 1 .                                              SA52971 89140022
DIALCB   EQU   * .                      R2 IS ADDR OF LCB               89280020
         LA    R0,QCBSTVTO .            GET ADDR OF MASTER QCB STCB     89340020
NXTDIAL  EQU   * .                                                      89400020
         L     R1,LCBSTCBA-1-IEDQLCB(,R2) GET ADDR OF FIRST STCB ON     89460020
         TM    LCBSTCBA+2-IEDQLCB(TWO),ONE LINE STOPPED FOR    @YA06890 89467061
*                                          CLOSEDOWN           @YA06890 89474061
         BO    NXTDIAL2                 BRANCH IF YES          @YA06890 89481061
NXTDIAL1 EQU   *                                                OX02183 89490054
         LA    R1,0(,R1) .                STCB CHAIN OF LCB             89520020
         CR    R1,R0 .                  DOES 3RD WORD OF LCB POINT      89580020
*                                         TO 3RD WORD OF MASTER QCB     89640020
         BE    RITELCB .                  YES, GOT PROPER DIAL LCB      89700020
*                                         NO, TRY NEXT DIAL LCB         89760020
         CLI   FOUR(R1),AVTEZERO .      END OF STCB CHAIN       OX02183 89770054
         L     R1,FOUR(,R1) .           GET NEXT STCB ADDRESS   OX02183 89780054
         BNE   NXTDIAL1 .               BRANCH IF YES           OX02183 89790054
NXTDIAL2 EQU   *                                               @YA06890 89800061
         A     R2,AVTPARM3 .            BUMP BY SIZE OF LCB             89820020
         B     NXTDIAL .                MAYBE NEXT LCB IS THE ONE       89880020
*                                                                       89940020
RITELCB  EQU   * .                      FOUND DIAL LCB                  90000020
         LR    R1,R2 .                  SET LCB ADDRESS         SA52971 90030022
         L     R2,LCBSCBA-1-IEDQLCB(,R2) GET SCB OF THIS DIAL LCB       90060020
         SR    R0,R0 .                  ZERO WORK REG           SA52971 90120022
TSTLEVEL EQU   * .                                              SA52971 90122022
         LA    R5,SCBSCHDR-IEDQSCB(,R2) GET HEADER              SA52971 90124022
         TM    SCBHBFNO-IEDQSCB(R2),QCBDISK+QCBCORE RECALLING   SA52971 90126022
         BZ    FEFOCK .                 NO, GOT POINTER         SA52971 90128022
         L     R1,LCBLSPCI-1-IEDQLCB(,R1) GET SERVICE BFR ADDRESSA52971 90130022
         LA    R1,AVTEZERO(,R1) .       ZERO HI-ORDER           SA52971 90132022
         LTR   R1,R1 .                  ONE THERE               SA52971 90134022
         BZ    EXIT .                   NO, EXIT ROUTINE        SA52971 90136022
         LA    R5,PRFCRCD-IEDQPRF(,R1) .ASSUME HDR; GET HDR ADDRSA52971 90138022
         TM    PRFSTAT1-IEDQPRF(R1),PRFNHDRN IS IT HEADER       SA52971 90140022
         BZ    FEFOCK .                 YES, GO CHECK IT        SA52971 90142022
         LA    R5,PRFCHDR-IEDQPRF(,R1) .GET HEADER'S RRN        SA52971 90144022
FEFOCK   EQU   * .                                              SA52971 90146022
         BAL   R14,FEFOCOMP .           GO CHECK SCBFEFO        SA52971 90148022
EXIT     EQU   * .                                              SA52971 90150022
         LR    R2,RPRF .                SET RETURN PARAMETER    SA52971 90152022
         LM    R14,R1,AVTSAVE4+12 .     RESTORE REGS            SA52971 90154022
         LM    RSCB,R12,AVTSAVE4+32 .   RESTORE REGS            SA52971 90156022
         BR    R14 .                    RETURN                  SA52971 90158022
         SPACE 1 .                                              SA52971 90160022
APPBFR   EQU   * .                                              SA52971 90162022
         CLC   PRFLINK-IEDQPRF(3,RLCB),AVTDELAD+1 IS ANYTHING   SA52971 90164022
*                                         THERE                 SA52971 90166022
         BCR   8,R14 .                  NO, RETURN              SA52971 90168022
         NC    PRFLINK-IEDQPRF(3,RLCB),PRFLINK-IEDQPRF(RLCB) IS SA52971 90170022
*                                         ANYTHING THERE        SA52971 90172022
         BCR   8,R14 .                  NO, RETURN              SA52971 90174022
         L     RLCB,PRFLINK-1-IEDQPRF(,RLCB) GET BFR ADDR       SA52971 90176022
         LA    R5,PRFCRCD-IEDQPRF(,RLCB) ASSUME HDR             SA52971 90178022
         TM    PRFSTAT1-IEDQPRF(RLCB),PRFNHDRN IS IT HDR        SA52971 90180022
         BNO   HDRRN .                  YES, THAT'S SET         SA52971 90182022
         LA    R5,PRFCHDR-IEDQPRF(,RLCB) SET HEADER PTR         SA52971 90184022
HDRRN    EQU   * .                                              SA52971 90186022
         SLR   R2,RLCB .                BACK UP TO APPEAR AS    SA52971 90188022
         LPR   R2,R2 .                    LCB                   SA52971 90190022
FEFOCOMP EQU   * .                                              SA52971 90192022
         AIF   (&A NE 3).H020 .                                 SA52971 90194022
         TM    L'SCBSCHDR-1(R5),CPBQTYPE CORE COPY              SA52971 90196022
         BNZ   DISKPTR .                NO, IT'S SET            SA52971 90198022
         NC    AVTEZERO(3,R5),AVTEZERO(R5) USABLE POINTER       SA52971 90200022
         BCR   8,R14 .                  NO, RETURN              SA52971 90202022
         MVC   AVTSAVE4+1(3),AVTEZERO(R5) ALIGN ADDR            SA52971 90204022
         L     R5,AVTSAVE4 .            GET ADDR                SA52971 90206022
         LA    R5,PRFCRCD-IEDQPRF(,R5) .POINT TO FEFO ADDR      SA52971 90208022
DISKPTR  EQU   * .                                              SA52971 90210022
.H020    ANOP  , .                                              SA52971 90212022
         CLC   AVTEZERO(3,R9),AVTEZERO(R5) THIS MSG TO UPDATE   SA52971 90214022
         BCR   7,R14 .                  NO, DON'T UPDATE        SA52971 90216022
         LR    RPRF,R2 .                SAVE SCB ADDRESS        SA52971 90218022
         OI    AVTSAVE4+12,AVTE80 .     SET 'FOUND' FLAG FOR RETSA52971 90220022
         LTR   R10,R10 .                ARE WE TO UPDATE        SA52971 90222022
         BCR   8,R14 .                  NO, THEN DON'T          SA52971 90224022
         MVC   SCBFEFO-IEDQSCB(3,R2),AVTEZERO(R10) SET FEFO     SA52971 90226022
         BR    R14 .                    RETURN                  SA52971 90228022
         TITLE '''IEDQHM'' - DSECTS' .                           S22025 90240022
*        TPRIOR                                                         90420020
         TPRIOR                                                         90480020
COPYPRI  EQU   PRIFEFO-1 .              BUF POSTED BY COPY       S21101 90530021
         EJECT                                                          90540020
         TQCBED                                                  S22026 90630022
         EJECT , .                                               S22025 90640022
*        TDISPD                                                         90660020
          TDISPD                                                        90720020
         EJECT , .                                               S22025 90780022
         TDATAD                                                         90840020
         EJECT , .                                               S22025 90930022
*        DCBD                                                           90960020
         DCBD  DSORG=TX                                                 91020020
DCBOPEN  EQU   X'10'                                                    91080020
PCISEND  EQU   X'50' .                  SEND PCI=A/PCI=X         S22025 91110022
         EJECT , .                                               S22025 91140022
*        TPRFD                                                          91200020
          TPRFD                                                         91260020
XPRFREUS EQU   X'20' .                  REUSABLE DISK BUFFER     S22025 91320022
XPRFNRUS EQU   X'10' .                  PERMANENT DISK BUFFER    S22025 91340022
         EJECT , .                                               S22025 91360022
*        TLCBD                                                          91380020
         TLCBD                                                          91440020
LCBNSRCD EQU   X'01' .                  IN-SOURCE CHAIN FLAG     S22025 91500022
XXXON    EQU   LCBNSRCD .                                        S22025 91510022
XXHMSG   EQU   LCBMSG .                                          S22025 91520022
         EJECT , .                                               S22025 91530022
*        TPEWAD , .                                             SA52971 91537022
         TPEWAD , .                                             SA52971 91544022
         EJECT , .                                              SA52971 91551022
*        TTRMD                                                          91560020
         TTRMD                                                          91620020
         EJECT , .                                               S22025 91680022
*        TSCBD                                                          91740020
         TSCBD                                                          91800020
CPBQTYPE EQU   X'03' .                  QUEUE TYPE FLAGS         S22025 91830022
SCBCN    EQU   X'01'                                                    91860020
SCBCQT   EQU   SCBHBFNO                                                 91920020
SCBRDX   EQU   SCBMBSSA                                                 91980020
SCBNDX   EQU   SCBMBSSA+4                                               92040020
SCBCC    EQU   X'02'                                                    92100020
SCBCR    EQU   X'04'                                                    92160020
         EJECT , .                                               S22025 92220022
*        TQCBD                                                          92280020
         TQCBD                                                          92340020
*        TAVTD , .                                               S22025 92400022
         TAVTD , .                                               S22025 92490022
         MEND                                                           92580020
./  ADD  SSI=71880123,NAME=OLTCB
*%GOTO OLTCBPLS;                       /*                        S21903 00050000
         MACRO                                                          00100000
         OLTCB &DSECT=YES,&EQUATES=NO,&POINTER=NO,&CONFG=NO             00150000
.* CHANGE ACTIVITY                                                      00160010
.* A000000-999999                                              @G36XRXV 00170010
.* C165500,626000,626500,634000                                @G36XRXV 00180010
*                                                                       00200000
*        ON-LINE TEST CONTROL BLOCK                                     00250000
*                                                                       00300000
*        STATUS = VERSION 10.0                                 @Y17XAXU 00350000
*                                                                       00400000
*CHANGE ACTIVITY AS FOLLOWS:                                            00450000
TOTODISP EQU   8                                                        00500000
         AIF   ('&POINTER' NE 'YES').BYP001                             00550000
TOTOBPTR DSECT                                                          00600000
*                                                                       00650000
TOTELKEY DS    C .           OLTCB QUEUE ELEMENT KEY                    00700000
TOTELQCB DS    AL3 .         ADDRESS OF OLTCB QCB                       00750000
         DS    C .                                                      00800000
TOTELLNK DS    AL3 .         OLTCB QUEUE ELEMENT LINK FIELD             00850000
*                                                                       00900000
         AGO   .BYPASS                                                  00950000
.BYP001  ANOP                                                           01000000
         AIF   ('&DSECT' EQ 'NO').BYPASS                                01050000
TOTOLTCB DSECT                                                          01100000
         AGO   .BYPASS1                                                 01150000
.BYPASS  ANOP                                                           01200000
TOTOLTCB DS    0F                                                       01250000
.BYPASS1 ANOP                                                           01300000
*                                                                       01350000
*              SECTION CONTROL TABLE MAPPING                            01400000
*                                                                       01450000
$SCTTBLE DS    0F                                                       01500000
$ERRLPCT DS    H .           LOOP ON ERROR COUNT                        01550000
*                                                                       01600000
$TESTOPT DS    C .           TEST OPTION FIELD                          01650000
*                                                                       01700000
$NOPRT   EQU   X'04' .            NO PRINT OPTION FLAG                  01750000
$INDEFLP EQU   X'02' .            INDEFINITE ERROR LOOP FLAG            01800000
$FSTCOMM EQU   X'01' .            FIRST ERROR COMMUNICATION FLAG        01850000
*                                                                       01900000
$ERROPT  DS    C .           ERROR AND OPTION FIELD                     01950000
*                                                                       02000000
$TESTERR EQU   X'80' .            TEST ERROR FLAG                       02050000
$ASTERIK EQU   X'40' .            PRINT ASTERIK ON TERMINATE MSG FLAG   02100000
$CATERR  EQU   X'20' .            CATASTROPHIC ERROR FLAG               02150000
$ALTPRNT EQU   X'10' .            ALTERNATE PRINTER OPTION FLAG         02200000
$NOCNTRL EQU   X'08' .            NO CONTROL PRINT OPTION FLAG          02250000
$NERRPRT EQU   X'04' .            NO ERROR PRINT OPTION FLAG            02300000
$LOOPERR EQU   X'02' .            LOOP ON ERROR OPTION FLAG             02350000
$LOOPTST EQU   X'01' .            LOOP ON TEST ENTRY OPTION FLAG        02400000
*                                                                       02450000
$RT0108  DS    C .           ROUTINE MASK 1 THRU 8                      02500000
$RT0916  DS    C .           ROUTINE MASK 9 THRU 16                     02550000
$DRIVER  DS    C .           DRIVER IDENTIFICATION                      02600000
*                                                                       02650000
$TOTE    EQU   X'8A' .            TOTE ID                      @Y17XAXU 02700000
*                                                                       02750000
$SPARE1  DS    C .           UNUSED                                     02800000
$TSSSYM  DS    H .           RESERVED FOR TSS                           02850000
$PDEVFLG DS    C .           PRIMARY DEVICE FLAGS                       02900000
*                                                                       02950000
$FPMOLD  EQU   X'80' .            FILE PROTECT FLAG                     03000000
$EXFILPT EQU   X'40' .            ADDITIONAL FILE PROTECT FLAG          03050000
$TSSSYS1 EQU   X'20' .            RESERVED FOR TSS                      03100000
$LASTDEV EQU   X'10' .            LAST DEVICE OF SUBSYSTEM FLAG         03150000
*        EQU   X'08' .            SPARE                                 03200000
$TERMNDX EQU   X'04' .            RESERVED FOR TSS                      03250000
$PATHDEF EQU   X'02' .            RESERVED FOR TSS                      03300000
$LASTSUB EQU   X'01' .            LAST DEVICE OF LAST SUBSYSTEM FLAG    03350000
*                                                                       03400000
$CDSFLGS DS    C .           DEVICE FLAGS FROM CDS FLAG BYTE            03450000
*                                                                       03500000
$FPM     EQU   X'80' .            FILE PROTECT FLAG                     03550000
$SHARED  EQU   X'40' .            SHARED DEVICE FLAG                    03600000
$CEVOL   EQU   X'20' .            CE VOLUME FLAG                        03650000
$EXTINTC EQU   X'10' .            DEV ADDR ASSOCIATED WITH EXT FLAG     03700000
$SYMNAME EQU   X'08' .            SYMBOLIC NAME FLAG                    03750000
$TWOCHSW EQU   X'04' .            TWO CHANNEL SWITCH FLAG               03800000
$CUSTSYM EQU   X'02' .            CUSTOMER ASSIGNED SYMBOLIC            03850000
*                                   NAME FLAG                           03900000
$COMMCN  EQU   X'01' .            LINE CONNECTION REQUIRED FLAG         03950000
*                                                                       04000000
$PDEVADR DS    F .           PRIMARY DEVICE ADDRESS                     04050000
$PDEVDSC DS    F .           PRIMARY DEVICE DESCRIPTORS                 04100000
$CDS8T19 DS    3F .          PRIMARY DEVICE CDS BYTES 8 THRU 19         04150000
$RMSKCNT DS    C .           ROUTINE MASK COUNT LENGTH                  04200000
$EXECFLG DS    C .           EXECUTIVE PROGRAM FLAGS                    04250000
*                                                                       04300000
$CECCMIN EQU   X'80' .            REPLY IN TO OUTSTANDING CECOM FLAG    04350000
$MULTDEV EQU   X'40' .            MORE THAN ONE DEVICE ENTRY FLAG       04400000
$RTNSLCT EQU   X'20' .            OPERATOR MADE ROUTINE SELECTION FLAG  04450000
$ERRCNT  EQU   X'10' .            OPERATOR SPECIFIED ERROR LOOP COUNT   04500000
$LSTPDEV EQU   X'08' .            DON'T ASSIGN MORE PRIMARY DEVICES FLG 04550000
$CLEANUP EQU   X'04' .            SECTION ENTERED FOR CLEANUP FLAG      04600000
$CTRLMOD EQU   X'02' .            CONTROL MODE AVAILABLE FLAG           04650000
$QSCTMOD EQU   X'01' .            QUIESCENT MODE AVAILABLE FLAG         04700000
*                                                                       04750000
$OLTSIZE DS    H .           OLT REGION SIZE                            04800000
$OLTFLGS DS    C .           OLT FUNCTIONAL FLAGS                       04850000
*                                                                       04900000
$MANINTV EQU   X'80' .            MANUAL INTERVENTION ROUTINE FLAG      04950000
$CLEANRT EQU   X'40' .            OLT HAS CLEANUP ROUTINE FLAG          05000000
$RETAIN  EQU   X'20' .            RETAIN IS ACTIVE FLAG                 05050000
$CONTCB  EQU   X'10' .            CONTINGENT CONNECTION BROKEN FLAG     05100000
$RETCODE EQU   X'08' .                                                  05150000
$TRACE   EQU   X'04' .                                                  05200000
$LASTSEC EQU   X'02' .            LAST SECTION SCHEDULED FLAG           05250000
*                                                                       05300000
         DS    C .           UNUSED                                     05350000
$TOTFLG1 DS    C .           TOTE 1ST FLAG BYTE                         05400000
*                                                                       05450000
$LINESHR EQU   X'80' .            LINE CAN BE SHARED FLAG               05500000
$TDATBLK EQU   X'40' .            TOTE MESSAGE BLOCKING FLAG            05550000
$TERMSEC EQU   X'20'              TRM REQUESTS TEST IN BACKUP    S22024 05600000
*                                   MODE                         S22024 05650000
$CTEQTT  EQU   X'10'              CONTROL TERMINAL AND TEST      S22024 05700000
*                                   TERMINAL ARE ON THE SAME LINES22024 05750000
*                                                                       05800000
$TOTFLG2 DS    C .           TOTE 2ND FLAG BYTE                         05850000
$R017024 DS    C .           ROUTINE MASK 017 THRU 024                  05900000
$R025032 DS    C .           ROUTINE MASK 025 THRU 032                  05950000
$R033040 DS    C .           ROUTINE MASK 033 THRU 040                  06000000
$R041048 DS    C .           ROUTINE MASK 041 THRU 048                  06050000
$R049056 DS    C .           ROUTINE MASK 049 THRU 056                  06100000
$R057064 DS    C .           ROUTINE MASK 057 THRU 064                  06150000
$R065072 DS    C .           ROUTINE MASK 065 THRU 072                  06200000
$R073080 DS    C .           ROUTINE MASK 073 THRU 080                  06250000
$R081088 DS    C .           ROUTINE MASK 081 THRU 088                  06300000
$R089096 DS    C .           ROUTINE MASK 089 THRU 096                  06350000
$R097104 DS    C .           ROUTINE MASK 097 THRU 104                  06400000
$R105112 DS    C .           ROUTINE MASK 105  THRU 112                 06450000
$R113120 DS    C .           ROUTINE MASK 113  THRU 120                 06500000
$R121128 DS    C .           ROUTINE MASK 121  THRU 128                 06550000
$R129136 DS    C .           ROUTINE MASK 129  THRU 136                 06600000
$R137144 DS    C .           ROUTINE MASK 137  THRU 144                 06650000
$R145152 DS    C .           ROUTINE MASK 145  THRU 152                 06700000
$R153160 DS    C .           ROUTINE MASK 153  THRU 160                 06750000
$R161168 DS    C .           ROUTINE MASK 161  THRU 168                 06800000
$R169176 DS    C .           ROUTINE MASK 169  THRU 176                 06850000
$R177184 DS    C .           ROUTINE MASK 177  THRU 184                 06900000
$R185192 DS    C .           ROUTINE MASK 185  THRU 192                 06950000
$R193200 DS    C .           ROUTINE MASK 193  THRU 200                 07000000
$R201208 DS    C .           ROUTINE MASK 201  THRU 208                 07050000
$R209216 DS    C .           ROUTINE MASK 209  THRU 216                 07100000
$R217224 DS    C .           ROUTINE MASK 217  THRU 224                 07150000
$R225232 DS    C .           ROUTINE MASK 225  THRU 232                 07200000
$R233240 DS    C .           ROUTINE MASK 233  THRU 240                 07250000
$R241248 DS    C .           ROUTINE MASK 241  THRU 248                 07300000
$R249255 DS    C .           ROUTINE MASK 249  THRU 255                 07350000
$RETMASK DS    C .           RETURN CODE MASK                           07400000
         DS    C .           SPARE                                      07450000
         DS    CL6           SPARE                               S05331 07500000
$MSGIDAC DS    CL2           ACTIVE OLT ID                       S05331 07550000
$TABLE   DS    F .           ADDR OF BRANCH TABLE                       07600000
$PASS    DS    F .           ADDR OF PASSON AREA                        07650000
$EXT     DS    F .           ADDRESS OF EXTERNAL DATA                   07700000
         DS    6F .          SCT EXPANSION AREA                         07750000
*                                                                       07800000
*                                                                       07850000
TOTSMGRT DS    A .           SERVICE MANAGER RETURN SAVE                07900000
TOTSAVE1 DS    18F .         OLT SUBTASK 1ST SAVE AREA                  07950000
TOTSAVE2 DS    18F .         OLT SUBTASK 2ND SAVE AREA                  08000000
TOTSAVE3 DS    18F .         OLT SUBTASK 3RD SAVE AREA                  08050000
TOTSAVE4 DS    18F .         OLT SUBTASK 4TH SAVE AREA                  08100000
TOTSAVE5 DS    18F .         OLT SUBTASK 5TH SAVE AREA                  08150000
TOTSAVE6 DS    18F .         OLT SUBTASK 6TH SAVE AREA         @Y17XAXU 08200000
TOTWOSV1 DS    F .           IEDQWO LEV 1 SAVE AREA            @Y17XAXU 08250000
TOTWOSV2 DS    F             IEDQWO LEV 2 SAVE AREA            @Y17XAXU 08300000
TOTWOSV3 DS    F .           IEDQWO LEV 3 SAVE AREA            @Y17XAXU 08350000
TOTWOSV4 DS    F .           IEDQWO LEV 4 SAVE AREA            @Y17XAXU 08400000
TOTOLTPT EQU   TOTSAVE5+44                                              08450000
TOTOLTEP EQU   TOTSAVE5+64                                              08500000
TOTSVEND DS    0C .               END OF TOTE SAVE AREAS                08550000
*                                                                       08600000
TOTBKASN DS    H .           MAIN STORAGE BLOCKS ASSIGNED TO THIS OLT   08650000
TOTBKRQD DS    H .           MAIN STORAGE BLOCKS REQUIRED BY THIS OLT   08700000
*                                                                       08750000
TOTMMSPC DS    F .           OLT UNUSED MAIN STORAGE SPACE              08800000
*                                                              @Y17XAXU 08850000
*              SOURCE TERMINAL ENTRY                           @Y17XAXU 08900000
*                                                              @Y17XAXU 08950000
TOTSRENT DS    0F .          SOURCE TERMINAL ENTRY             @Y17XAXU 09000000
TOTSROFF DS    H .                OFFSET TO SOURCE TNT ENTRY   @Y17XAXU 09050000
         DS    H .                RESERVED                     @Y17XAXU 09100000
TOTSRLCB DS    F .                SOURCE LCB ADDRESS           @Y17XAXU 09150000
*                                                                       09200000
*              CONTROL TERMINAL ENTRY                                   09250000
*                                                                       09300000
TOTCTENT DS    0F .          CONTROL TERMINAL ENTRY                     09350000
TOTCTUCB DS    AL2 .              C.T. UCB ADDRESS                      09400000
TOTCTOFF DS    H .                OFFSET TO C.T. TNT ENTRY     @Y17XAXU 09450000
*                                 (DUMMY)                      @Y17XAXU 09500000
TOTCROFF DS    H .                OFFSET TO C.T. TNT ENTRY              09550000
*                                 (REAL)                       @Y17XAXU 09600000
TOTCRSID DS    H .                NETWORK ADDRESS OF C.T.      @Y17XAXU 09650000
TOTCTRLN DS    C .                C.T. RELATIVE LINE NUMBER             09700000
TOTCTLCB DS    CL3 .              C.T. LCB ADDRESS                      09750000
TOTCTTNT DS    F .                C.T. TERMINAL NAME TABLE ENTRY        09800000
*                                   ADDRESS (DUMMY ENTRY)               09850000
TOTCRTNT DS    F .                C.T. TERMINAL NAME TABLE ENTRY        09900000
*                                   ADDRESS (REAL ENTRY)                09950000
TOTCTTLN DS    H                  LENGTH OF CT TTE AREA                 10000000
TOTCTFLG DS    C                  CONTROL TERMINAL FLAGS                10050000
TOTCTASN EQU   X'80'              DUMMY ENTRY ASSIGNED           S22024 10100000
TOTCTORN EQU   X'40'              CONTROL TERMINAL ON 3705       S22024 10150000
TOTCTSWD EQU   X'01'              DIAL CONTROL TERMINAL          S22024 10200000
TOTCTEND DS    0C .               END OF BASIC C.T. AREA       @Y17XAXU 10250000
TOTCTRNL DS    CL8                GROUP NAME FOR CT LINE         S22024 10300000
TOTCTNAM DS    CL9                CONTROL TERM NAME IN EBCDIC    S22024 10350000
TOTCTDFL DS    C                  CONTROL TERMINAL INITIAL CONDITIONS   10400000
TOTCTTRM EQU   X'80'                   TERMINAL DEVICE FLAG             10450000
TOTCTLIN EQU   X'40'                   LINE ADDRESS FLAG                10500000
TOTCTGP  EQU   X'10'                   GENERAL POLL INITIALLY ACTIVE    10550000
*                                        ON TEST LINE                   10600000
TOTCTLST EQU   X'08'                   CT INITIALLY STOPPED             10650000
TOTCTHD  EQU   X'04'                   CT INITIALLY HELD                10700000
TOTCTIAC EQU   X'02'                   CT INVITATION LIST ENTRY         10750000
*                                        INITIALLY INACTIVE             10800000
*                                                                       10850000
         DS    CL3           RESERVED                          @Y17XAXU 10900000
TOTCUTST DS    0F            CONTROL INFO FOR $CUTEST MACRO             10950000
TOTCUFLG DS    1C            $CUTEST FLAGS                              11000000
*                                                                       11050000
TOTCUDON EQU   X'80'              CUTEST ISSUED                         11100000
TOTCUCUP EQU   X'40'              CUTEST CLEAN UP REQUIRED              11150000
*                                                                       11200000
TOTCU#AD DS    1C            $CUTEST NUMBER OF CONTIGUOUS ADDRESSES     11250000
TOTCUCUU DS    2C            $CUTEST STARTING ADDRESS                   11300000
*                                                                       11350000
TOTCUSAV DS    1F            $CUTEST SAVE AREA                          11400000
*                                                                       11450000
TOTCURS1 DS    1C            $CUTEST CODE PARAMETER                     11500000
TOTCURS2 DS    1C            $CUTEST HEX CHANNEL ID                     11550000
TOTCURS3 DS    1C            $CUTEST RESERVED BYTE 3 CODE PARAMETER     11600000
TOTCURS4 DS    1C            $CUTEST RESERVED BYTE 4 CODE PARAMETER     11650000
*                                                                       11700000
TOTWOOPC DS    6F            IEDQWO OPERATOR CONTROL PARM LIST  SA41602 11750000
TOTPLIST DS    0F            OPERATOR CONTROL PARAMETER LIST     S22024 11800000
TOTOKEY  DS    C                  KEY                            S22024 11850000
TOTOQCBA DS    CL3                OP CONTROL QCB ADDRESS         S22024 11900000
TOTOPRI  DS    C                  PRIORITY                       S22024 11950000
TOTOLINK DS    CL3                LINK FIELD                     S22024 12000000
TOTOVBCD DS    C                  VERB CODE                      S22024 12050000
TOTOELNG DS    C                  LENGTH OF ELEMENT              S22024 12100000
TOTORLN  DS    C                  RELATIVE LINE NUMBER           S22024 12150000
TOTORTCD DS    C                  RETURN CODE                    S22024 12200000
TOTOFLG  DS    0FL1               FLAG BYTE                    @YM08136 12250000
TOTOATC  EQU   X'80'              USE ALTERATE TTCIN           @YM08136 12300000
TOTOECBA DS    F                  ECB ADDRESS                    S22024 12350000
TOTOLADR DS    CL8                TERMINAL NAME OR LINE ADDRESS  S22024 12400000
TOTOALTT DS    H                  ALTERNATE TTCIN                       12450000
         DS    CL38               UNUSED                       @YM08136 12500000
TOTOPCLN DS    A             OP CONTROL ECB ADDRESS FOR CLEANUP  S22024 12550000
TOTUSCOR DS    F             CORE CURRENTLY IN USE BY OLT        S22024 12600000
*              ALTERNATE PRINTER ENTRY                                  12650000
*                                                                       12700000
TOTAPENT DS    0F .          ALTERNATE PRINTER ENTRY                    12750000
TOTAPUCB DS    AL2 .              A.P. UCB ADDRESS                      12800000
TOTAPOFF DS    H .                OFFSET TO A.P. TNT ENTRY     @Y17XAXU 12850000
*                                 (DUMMY ENTRY)                @Y17XAXU 12900000
TOTAROFF DS    H .                OFFSET TO A.P. TNT ENTRY              12950000
*                                 (REAL ENTRY)                 @Y17XAXU 13000000
TOTARSID DS    H .                NETWORK ADDRESS OF A.P.      @Y17XAXU 13050000
TOTAPRLN DS    C .                A.P. RELATIVE LINE NUMBER             13100000
TOTAPLCB DS    CL3 .              A.P. LCB ADDRESS                      13150000
TOTAPTNT DS    F .                A.P. TERMINAL NAME TABLE ENTRY        13200000
*                                   ADDRESS (DUMMY ENTRY)               13250000
TOTARTNT DS    F                  A.P. TERMINAL NAME TABLE ENTRY        13300000
*                                   ADDRESS ( REAL ENTRY)               13350000
TOTAPTLN DS    H                  LENGTH OF AP TTE AREA                 13400000
TOTAPFLG DS    C                  ALTERNATE PRINTER FLAGS               13450000
TOTAPASN EQU   X'80'              DUMMY ENTRY ASSIGNED           S22024 13500000
TOTAPORN EQU   X'40'              AP ON 3705                     S22024 13550000
TOTAPSWD EQU   X'01'              DIAL ALTERNATE PRINTER         S22024 13600000
TOTAPEND DS    0C .               END OF BASIC AP AREA         @Y17XAXU 13650000
TOTAPRNL DS    CL8                GROUP NAME FOR AP LINE         S22024 13700000
TOTAPDFL DS    C                  ALTERNATE PRINTER INITIAL CONDITIONS  13750000
*                                                                       13800000
TOTAPTER EQU   X'80'                   TERMINAL DEVICE FLAG             13850000
TOTAPLIN EQU   X'40'                   LINE ADDRESS FLAG                13900000
TOTAPGP  EQU   X'10'                   GENERAL POLL INITIALLY ACTIVE    13950000
*                                        ON TEST LINE                   14000000
TOTAPLST EQU   X'08'                   A.P. INITIALLY STOPPED           14050000
TOTAPHD  EQU   X'04'                   A.P. INITIALLY HELD              14100000
TOTAPIAC EQU   X'02'                   A.P. INVITATION LIST ENTRY       14150000
*                                        INITIALLY INACTIVE             14200000
         DS    F             UNUSED                            @ZM47554 14220010
*                                                                       14350000
TOTAPDCB DS    F             LOCAL PRINTER DCB ADDRESS           S22024 14400000
TOTPDECB DS    5F .          LOCAL PRINTER DECB                         14450000
*                                                                       14500000
TOTPARML DS    F             ADDRESS OF PARAMETER LIST FOR      SA41612 14550000
*                              MACRO SERVICE CALL               SA41612 14600000
*                                                                       14650000
TOTOLTMQ DS    A .           SUBTASK MESSAGE QUEUE                      14700000
TOTOTECB DS    F .           TOTE SUBTASK ECB                           14750000
*                                                                       14800000
TOTRESSV DS    F .           POINTER TO MOTHER TASK SAVE AREA           14850000
TOTTCBAD DS    F .           SUBTASK TCB ADDRESS                        14900000
TOTCMPCD DS    F .           SUBTASK COMPLETION CODE                    14950000
*                                                                       15000000
TOTOLTPL DS    3F .          OLT INPUT PARAMETER LIST                   15050000
TOT#TBLE EQU   TOTOLTPL+8 .  BRANCH TABLE ADDRESS                       15100000
*                                                                       15150000
TOTWTORP DS    0F .          WTOR PARM LIST FOR OPERATOR COMMUNICATION  15200000
TOTINCNT DS    C .                REPLY BYTE COUNT                      15250000
TOTINADR DS    3C .               REPLY BUFFER ADDRESS                  15300000
TOTINECB DS    F .                REPLY ECB ADDRESS                     15350000
*                                                                       15400000
TOTWTOPL DS    0F .          WTO & WTOR PL FOR OPERATOR COMMUNICATION   15450000
         DS    C .                                                      15500000
TOTOTCNT DS    C .                OUT MESSAGE COUNT                     15550000
         DS    H .                                                      15600000
TOTOTBUF DS    CL84          OUTPUT AREA                                15650000
TOTINBUF DS    CL80          REPLY BUFFER                               15700000
*                                                                       15750000
TOTOLTID DS    H .           TOTE OLT IDENTIFICATION                    15800000
TOTRTCOD DS    C .           SERVICE MODULE RETURN CODE                 15850000
         DS    C .           UNUSED                                     15900000
*                                                                       15950000
TOTPLNKQ DS    0F .          PLINK MODULE QUEUE                         16000000
TOTPLFWD DS    F .                QUEUE FORWARD POINTER                 16050000
TOTPLBKW DS    F .                QUEUE BACKWARD POINTER                16100000
         DS    F .           RESERVED                          @Y17XAX6 16150000
TOTWKSPC DS    16D .         TOTE WORK AREA                             16200000
TOTWKEND DS    0C .               END OF TOTE WORK AREA                 16250000
TOTWKLNT EQU   TOTWKEND-TOTWKSPC .     LENGTH OF TOTE WORKAREA          16300000
         DS    5F .          UNUSED                                     16350000
TOTAVTPT DS    F .           ADDRESS OF AVT                             16400000
TOTSTAE  DS    F             ADDRESS OF STAE EXIT ROUTINE        S22024 16450000
TOTRESPL DS    F .           ADDRESS OF TOTE RESIDENT PARAMETER LIST    16500000
TOTFLG01 DS    C .           TOTE 1ST FLAG BYTE  (ABNORMAL)    @G36XRXV 16550010
TOTCLNST EQU   X'02'         CLEANUP STARTED                   @YM08158 16600000
TOTCLNED EQU   X'01'         CLEANUP ENDED                     @YM08158 16650000
*                                                                       16700000
TOTFINAL EQU   X'80'              FINAL MESSAGE INDICATOR        S05331 16750000
TOTCONFG EQU   X'40'              CONFIGURATOR RUN                      16800000
TOTIPLCU EQU   X'20'              FORCED CLEANUP FROM IPL        S05331 16850000
TOTEXIT  EQU   X'10'              IEDQWO CONTROL FLOW FLAG     @Y17XAXU 16900000
TOTAPTST EQU   X'08'              AP ON TEST LINE              @Y17XAUU 16950000
TOTPRMPT EQU   X'04'              PROMPTER RUN                   S22024 17000000
*                                                                       17050000
TOTFLG02 DS    C .           TOTE 2ND FLAG BYTE                         17100000
*                                                                       17150000
TOTTTSPE EQU   X'80' .            TEST SESSION PENDING END     @Y17XAXU 17200000
TOTTSST  EQU   X'40' .            CT/AP LINE IN TEST MODE      @Y17XAUU 17250000
TOTDEV0X EQU   X'20'              TEST DEVICE ON 270X            S22024 17300000
TOTOLTRQ EQU   X'10'              ONLINE TEST REQUEST FLAG       S22024 17350000
TOTCHKSZ EQU   X'08'              UPDATE SUBTASK STORAGE         S22024 17400000
*                                   ALLOCATION FLAG              S22024 17450000
TOTCONMD EQU   X'04'              CALL TOTE CONCENTRATOR MODULE SA41597 17500000
*                                   FOR INITIAL STATUS SET UP   SA41597 17550000
TOTCONCU EQU   X'02'              CONCENTRATOR CLEAN UP REQUIREDSA41597 17600000
TOTDEVRN EQU   X'01'              TEST DEVICE ON 3704/3705       S22024 17650000
*                                                                       17700000
TOTFLG03 DS    C .           TOTE 3RD FLAG BYTE                         17750000
*                                                                       17800000
TOTAPOER EQU   X'80' .            ALTERNATE PRINTER OPTION ERROR FLAG   17850000
TOTTDFER EQU   X'40' .            TEST DEVICE FIELD ERROR FLAG          17900000
TOTTSTER EQU   X'20' .            TEST ID FIELD ERROR FLAG              17950000
TOTOPTER EQU   X'10' .            OPTION FIELD ERROR FLAG               18000000
TOTIMNCP EQU   X'08' .            TEMPORARY NO CONT PRINT FLAG          18050000
TOTTSINC EQU   X'04' .            INCLUSIVE TEST ID ENTRY FLAG          18100000
TOTREPEX EQU   X'02'              REPLY EXPECTED FLAG           SA41613 18150000
*                                                                       18200000
TOTFLG04 DS    C .           TOTE 4TH FLAG BYTE                         18250000
TOTPRCTF EQU   X'08'         COUNTERFEIT PRIMARY TEST DEVICE   @YM08407 18300000
TOTSCCTF EQU   X'04'         COUNTERFEIT SECONDARY TEST DEVICE @YM08407 18350000
*                                                                       18400000
TOTNUMDV EQU   X'80' .            NUMERIC TRM ENTRY FLAG                18450000
TOTDTCHD EQU   X'40' .            SUBTASK ALREADY DETACHED FLAG         18500000
TOTCLOSE EQU   X'20' .            TCAM CLOSEDOWN IN PROGRESS FLAG       18550000
TOTTTSWT EQU   X'01' .            TEST TERMINAL LINE SWITCHED FLAG      18600000
*                                                                       18650000
TOTFLG05 DS    C .           TOTE 5TH FLAG BYTE                         18700000
*                                                                       18750000
TOTPRINT EQU   X'80' .            ACCESS METHOD PRINT FLAG              18800000
TOTCECOM EQU   X'40' .            ACCESS METHOD CECOM FLAG              18850000
TOTREPLY EQU   X'20' .            ACCESS METHOD CECOM WITH REPLY FLAG   18900000
TOTSRCE  EQU   X'10' .            SEND MSG TO SOURCE TERMINAL  @Y17XAXU 18950000
TOTSRCON EQU   X'08' .            TRM ENTERED FROM SYSCON      @Y17XAXU 19000000
TOTTMOUT EQU   X'04' .            WAIT TIMEOUT FLAG                     19050000
TOTEXIOF EQU   X'02' .            ACCESS METHOD EXIO FLAG               19100000
TOTNDMSG EQU   X'01' .            SEND CANCEL OR TERMINATE MESSAGE FLAG 19150000
*                                                                       19200000
TOTFLG06 DS    C .           TOTE 6TH FLAG BYTE                         19250000
*                                                                       19300000
TOTOTERM EQU   X'80' .            SECTION TERMINATE FLAG                19350000
TOTCBOPN EQU   X'40'              CANCEL BEFORE OPEN                    19400000
TOTWACAN EQU   X'20' .            CANCEL REQUEST PENDING                19450000
TOTNCMFG EQU   X'10' .            NON-CONCURRENT MODE FLAG              19500000
TOTABEND EQU   X'08' .            OLT HAS ABENDED FLAG                  19550000
TOTCANCL EQU   X'04' .            CANCEL TESTING FLAG                   19600000
TOTOTACT EQU   X'02' .            OLT ACTIVE FLAG                       19650000
TOTNPERR EQU   X'01' .            NO PERMANENT ERROR FLAG               19700000
*                                                                       19750000
TOTFLG07 DS    C .           TOTE 7TH FLAG BYTE                         19800000
*                                                                       19850000
TOTPRIEX EQU   X'80' .            PRIMARY DEVICE FOR EXIO/WAITIO FLAG   19900000
TOTSECEX EQU   X'40' .            SECONDARY DEV  FOR EXIO/WAITIO FLAG   19950000
TOTMSCEC EQU   X'08' .            TOTE MESSAGE SOURCE FLAG - CECOM      20000000
TOTMSREP EQU   X'04' .            TOTE MESSAGE SOURCE FLAG - CECOM      20050000
TOTMSPRT EQU   X'02' .            TOTE MESSAGE SOURCE FLAG - CECOM      20100000
TOTMSSRC EQU   X'01' .            TOTE MESSAGE SOURCE FLAG     @Y17XAXU 20150000
*                                                                       20200000
TOTFLG08 DS    C .           TOTE 8TH FLAG BYTE                         20250000
*                                                                       20300000
*                                 BITS 0-3 ARE DPRINT FORMS CNTRL FLAGS 20350000
*                                 BITS 4-7 ARE DPRINT LEVEL CNTRL FLAGS 20400000
*                                                                       20450000
*                                                                       20500000
TOTFLG09 DS    C .           TOTE 9TH FLAG BYTE                         20550000
*                                                                       20600000
TOTAPCON EQU   X'80' .            PRINTER = SYSTEM CONSOLE FLAG         20650000
TOTAPOUT EQU   X'40' .            PRINTER = SYSTEM PRINTER FLAG         20700000
TOTCTCON EQU   X'20' .            CONTROL TERMINAL = SYS CONSOLE FLAG   20750000
TOTAPTRM EQU   X'10' .            PRINTER = TERMINAL FLAG               20800000
TOTNOBRK EQU   X'08'              NO BREAK OPTION SPECIFIED      S22024 20850000
TOTLNCON EQU   X'04'              LINE CONNECTION ALREADY DONE   S22024 20900000
TOTPRECT EQU   X'02' .            NO ALTERNATE PRINTER FLAG             20950000
*                                   (OR CT = AP)                 S05331 21000000
TOTMACFT EQU   X'01'              UNSUPPORTED MACRO FUNCTION FLAG       21050000
*                                                                       21100000
TOTFLG10 DS    C .           TOTE 10TH FLAG BYTE                        21150000
*                                                                       21200000
TOTTERMS EQU   X'80' .            TEST DEVICES = TERMINALS FLAG         21250000
TOTTNTRQ EQU   X'08' .            DUMMY TNT ENTRY REQUEST FLAG          21300000
TOTOLTED EQU   X'04' .            ON-LINE TEST ENDED FLAG               21350000
TOTOLTWT EQU   X'02' .            ON-LINE TEST WAITING FLAG             21400000
TOTOLTRS EQU   X'01' .            ON-LINE TEST RESTART FLAG             21450000
*                                                                       21500000
TOTTTBEL DS    CL1           TERMINAL NAME TABLE ENTRY                  21550000
*                              NAME LENGTH                              21600000
         DS    CL1           UNUSED                                     21650000
         AIF   ('&CONFG' EQ 'YES').CNFBYP                               21700000
TOTEXT   DS    14F .         EXTERNAL DATA BUFFER                       21750000
TOTPASS  DS    16F .         PASSON DATA BUFFER                         21800000
TOTTRMBF DS    0C .          TRM BUFFER FOR TRM ANALYSIS                21850000
TOTPRIBK DS    0F .          PRIMARY TEST DEVICE I/O CONTROL BLOCKS     21900000
TOTPRECB DS    F .           PRIMARY ECB                                21950000
*                                                                       22000000
*              PRIMARY TEST DEVICE ENTRY                                22050000
*                                                                       22100000
TOTPRENT DS    0F .          TOTE PRIMARY TEST DEVICE ENTRY             22150000
*                                                                       22200000
TOTPRUCB DS    AL2 .              PRIMARY DEVICE UCB ADDRESS            22250000
TOTPCOFF DS    H .                OFFSET TO PRIMARY DEVICE     @Y17XAXU 22300000
*                                 (DUMMY ENTRY)                @Y17XAXU 22350000
TOTPROFF DS    H .                OFFSET TO PRIMARY TNT ENTRY           22400000
*                                 (REAL ENTRY)                 @Y17XAXU 22450000
TOTPRSID DS    H .                NETWORK ADDRESS OF PRIMARY   @Y17XAXU 22500000
TOTPRRLN DS    C .                PRIMARY DEVICE RELATIVE               22550000
*                                   LINE NUMBER                         22600000
TOTPRLCB DS    AL3 .              ADDRESS OF 3705 LCB          @Y17XAXU 22650000
TOTPDTNT DS    F .                PRIMARY TNT ENTRY ADDRESS    @Y17XAXU 22700000
*                                 (DUMMY ENTRY)                @Y17XAXU 22750000
TOTTNTPR DS    F                  PRIMARY TNT ENTRY ADDRESS    @Y17XAXU 22800000
*                                 (REAL ENTRY)                 @Y17XAXU 22850000
TOTPRLEN DS    H .                LENGTH OF PRIMARY TTE AREA   @Y17XAXU 22900000
TOTPRFLG DS    C .                PRIMARY FLAGS                @Y17XAXU 22950000
TOTPRTAS EQU   X'80' .            PRIMARY TNT ENTRY ASSIGNED   @Y17XAXU 23000000
TOTPRLU  EQU   X'40' .            LU TERMINAL                  @Y17XAXU 23050000
TOTPPRSC EQU   X'20' .            ON=PRIMARY                   @Y17XAX6 23100000
*                                 OFF=SECONDARY                @Y17XAX6 23150000
TOTPUNRD EQU   X'10' .            ON=UNREAD DATA               @Y17XAX6 23200000
*                                 OFF=NO UNREAD DATA           @Y17XAX6 23250000
TOTPREX  EQU   X'08' .            EXCEPTION RESPONSE           @Y17XAX6 23300000
TOTPRFME EQU   X'04' .            DEFINITE RESPONSE            @Y17XAX6 23350000
TOTPEXNM EQU   X'02' .            ON=EXPEDITED                 @Y17XAX6 23400000
*                                 OFF=NORMAL                   @Y17XAX6 23450000
         DS    C .                RESERVED                     @Y17XAXU 23500000
TOTPRQCB DS    F                  PRIMARY QCB ADDRESS            S22024 23550000
TOTPRCCW DS    F                  ADDRESS OF READ CCW FOR PRIMARYS22024 23600000
TOTPRBUF DS    F                  ADDRESS OF BUFFER CONTAINING   S22024 23650000
*                                   READ DATA FOR PRIMARY        S22024 23700000
*                                                                       23750000
*        PRIMARY DEVICE DATA BLOCKING FIELD                             23800000
*                                                                       23850000
TOTPDTBF DS    A .           RESPONSE BUFFER ADDRESS                    23900000
TOTPDTCT DS    H .           RESPONSE BUFFER SIZE                       23950000
TOTPFLGS DS    BL1 .         FLAGS                                      24000000
         DS    CL1           UNUSED                            @ZM47554 24050010
TOTPRSN  DS    0F            PRIMARY SEQ NUMBER FIELD          @ZM47554 24058010
         DS    CL2           FLAGS                             @ZM47554 24066010
TOTPRSEQ DS    H             SEQUENCE NUMBER (FROM SNA TH)     @ZM47554 24074010
*                                                              @ZM47554 24082010
TOTPTECB DS    F .           PRIMARY TECB ADDRESS                       24100000
TOTPRIOB DS    11F           PRIMARY IOB                                24150000
TOTPRDCB DS    18F .         PRIMARY DCB                                24200000
TOTPRDEB EQU   TOTPRDCB+44        PRIMARY DEB ADDRESS                   24250000
*                                                                       24300000
TOTSCIBK DS    0F .          SECONDARY TEST DEVICE I/O CONTROL BLOCKS   24350000
TOTSCECB DS    F .           SECONDARY ECB                              24400000
*                                                                       24450000
*              SECONDARY TEST DEVICE ENTRY                              24500000
*                                                                       24550000
TOTSCENT DS    0F .          TOTE SECONDARY TEST DEVICE ENTRY           24600000
*                                                                       24650000
TOTSCUCB DS    AL2 .              SECONDARY DEVICE UCB ADDRESS          24700000
TOTNCOFF DS    H .                OFFSET TO SECONDARY TNT ENTRY@Y17XAXU 24750000
*                                 (DUMMY ENTRY)                @Y17XAXU 24800000
TOTSCOFF DS    H .                OFFSET TO SECONDARY TNT ENTRY         24850000
*                                 (REAL ENTRY)                 @Y17XAXU 24900000
TOTSRSID DS    H .                NETWORK ADDRESS OF SECONDARY @Y17XAXU 24950000
TOTSCRLN DS    C .                SECONDARY DEVICE RELATIVE             25000000
*                                   LINE NUMBER                         25050000
TOTSCLCB DS    AL3 .              ADDRESS OF 3705 LCB          @Y17XAXU 25100000
TOTSDTNT DS    F .                SECONDARY TNT ENTRY ADDRESS  @Y17XAXU 25150000
*                                 (DUMMY ENTRY)                @Y17XAXU 25200000
TOTSRTNT DS    F .                SECONDARY TNT ENTRY ADDRESS  @Y17XAXU 25250000
*                                 (REAL ENTRY)                 @Y17XAXU 25300000
TOTSCLEN DS    H .                LENGTH OF SECONDARY TTE AREA @Y17XAXU 25350000
TOTSCFLG DS    C .                SECONDARY FLAGS              @Y17XAXU 25400000
TOTSCTAS EQU   X'80' .            SECONDARY TNT ENTRY ASSIGNED @Y17XAXU 25450000
TOTSCLU  EQU   X'40' .            LU DEVICE                    @Y17XAXU 25500000
TOTSPRSC EQU   X'20' .            ON=PRIMARY                   @Y17XAX6 25550000
*                                 OFF=SECONDARY                @Y17XAX6 25600000
TOTSUNRD EQU   X'10' .            ON=UNREAD DATA               @Y17XAX6 25650000
*                                 OFF=NO UNREAD DATA           @Y17XAX6 25700000
TOTSCEX  EQU   X'08' .            EXCEPTION RESPONSE           @Y17XAX6 25750000
TOTSCFME EQU   X'04' .            DEFINITE RESPONSE            @Y17XAX6 25800000
TOTSEXNM EQU   X'02' .            ON=EXPEDITED                 @Y17XAX6 25850000
*                                 OFF=NORMAL                   @Y17XAX6 25900000
         DS    C .                RESERVED                     @Y17XAXU 25950000
TOTSCQCB DS    F                  SECONDARY QCB ADDRESS          S22024 26000000
TOTSCCCW DS    F                  ADDRESS OF READ CCW FOR        S22024 26050000
*                                   SECONDARY TEST DEVICE        S22024 26100000
TOTSCBUF DS    F                  ADDRESS OF BUFFER CONTAINING   S22024 26150000
*                                   READ DATA FOR SECONDARY      S22024 26200000
*                                                                       26250000
*        SECONDARY DEVICE DATA BLOCKING FIELD                           26300000
*                                                                       26350000
TOTSDTBF DS    A .           RESPONSE BUFFER ADDRESS                    26400000
TOTSDTCT DS    H .           RESPONSE BUFFER SIZE                       26450000
TOTSFLGS DS    BL1 .         FLAGS                                      26500000
         DS    CL1           UNUSED                            @ZM47554 26550010
TOTSCSN  DS    0F            SECONDARY SEQ NUMBER FIELD        @ZM47554 26558010
         DS    CL2           FLAGS                             @ZM47554 26566010
TOTSCSEQ DS    H             SEQUENCE NUMBER (FROM SNA TH)     @ZM47554 26574010
*                                                              @ZM47554 26582010
TOTSTECB DS    F .           SECONDARY TECB ADDRESS                     26600000
TOTSCIOB DS    11F           SECONDARY IOB                              26650000
TOTSCDCB DS    18F .         SECONDARY DCB ADDRESS                      26700000
TOTSCDEB EQU   TOTSCDCB+44        SECONDARY DEB ADDRESS                 26750000
*                                                                       26800000
TOTTRMND DS    0C .          END OF TRM BUFFER                          26850000
*                                                                       26900000
TOTCROLT DS    CL8 .         CURRENT OLT I.D.                           26950000
*  THE FOLLOWING EQUATES ARE USED BY THE 'INCLUSIVE' ROUTINE IN IEDQWE  27000000
TOTCRALP EQU   TOTCROLT+5                                               27050000
TOTCRTOO EQU   TOTCROLT+6                                               27100000
TOTONELT EQU   TOTCROLT+7                                               27150000
TOTCRFST EQU   TOTCROLT+8                                               27200000
TOTSECBL EQU   TOTCROLT+9                                               27250000
TOTONECU EQU   TOTCROLT+10                                              27300000
TOTCRSEC EQU   TOTCROLT+11                                              27350000
TOTSECBK EQU   TOTCROLT+12                                              27400000
TOTONEND EQU   TOTCROLT+13                                              27450000
TOTCRFLG EQU   TOTCROLT+15                                              27500000
TOTFTTIM EQU   X'80'              FIRST TIME SWITCH                     27550000
TOTCLRFG EQU   X'00'              USED TO CLEAR FIRST  TIME SWITCH      27600000
TOTSAADR EQU   TOTCROLT+16                                              27650000
TOTOLTTB DS    10CL3 .       OLT I.D. TABLE                             27700000
TOTOLTTE DS    0C .               END OF TABLE                          27750000
*                                                                       27800000
TOTCONTB DS    10CL1         CONCENTRATOR INITIAL STATUS TABLE  SA41597 27850000
*                              FOR TEST DEVICES                 SA41597 27900000
TOTCONCT DS    CL1           CONCENTRATOR STATUS FOR CONTROL    SA41597 27950000
*                              TERMINAL                         SA41597 28000000
TOTCONAP DS    CL1           CONCENTRATOR STATUS FOR ALTERNATE  SA41597 28050000
*                              PRINTER                          SA41597 28100000
TOTCONND DS    0C            END OF TABLE                       SA41597 28150000
*                                                               SA41597 28200000
*        CONCENTRATOR INITIAL STATUS CONDITIONS                 SA41597 28250000
*                                                               SA41597 28300000
TOTCSTOP EQU   X'80'              CONCENTRATOR INITIALLY STOPPEDSA41597 28350000
TOTCHELD EQU   X'40'              CONCENTRATOR INITIALLY HELD   SA41597 28400000
TOTCINAC EQU   X'20'              CONCENTRATOR INITIALLY        SA41597 28450000
*                                   INACTIVE                    SA41597 28500000
TOTCSTRT EQU   X'E0'              NONE SET IF ORIGINALLY STARTEDSA41597 28550000
         DS    CL38          SPARE                              SA41597 28600000
TOTTDTBL DS    10F .         TOTE TEST DEVICE TABLE                     28650000
TOTLETGO EQU   TOTTDTBL+36        LAST ENTRY POINTER                    28700000
TOTTDEND DS    0F .               END OF TABLE                          28750000
*                                                                       28800000
*              TEST DEVICE INITIAL CONDITIONS                           28850000
*                                                                       28900000
TOTTDTRM EQU   X'80' .            TERMINAL DEVICE FLAG                  28950000
TOTTDLIN EQU   X'40' .            LINE ADDRESS FLAG                     29000000
TOTTDGRB EQU   X'20' .            TEST DEVICE GRABBED FLAG              29050000
TOTTDORN EQU   X'10'              TEST DEVICE ON A 3705          S22024 29100000
TOTTDLST EQU   X'08' .            TEST DEVICE INITIALLY STOPPED         29150000
TOTTDTHD EQU   X'04' .            TEST DEVICE INITIALLY HELD            29200000
TOTTDIAC EQU   X'02' .            TEST DEVICE INVITATION LIST           29250000
*                                   ENTRY INITIALLY INACTIVE            29300000
TOTTSWPM EQU   X'01'              A SWITCH HAS BEEN PERFORMED    Y06330 29350000
TOTTNIPL EQU   X'06'              NO IPL REQUIRED FOR 3705       S05331 29400000
*                                                                       29450000
*                                                                       29500000
*        WAITIO ECB LIST                                                29550000
*                                                                       29600000
TOTWECBA DS    A .           POINTER TO ECB FOR TEST DEVICE             29650000
TOTECBPT DS    A             POINTER TO SUBTASK ECB                     29700000
*                                                                       29750000
TOTTLCNT DS    H .           TEST LOOP COUNT                            29800000
         DS    CL2 .         RESERVED                          @Y17XAX6 29850000
         AGO   .EQUATES                                                 29900000
.CNFBYP  ANOP                                                           29950000
         DS    CL4 .         RESERVED                          @Y17XAX6 30000000
CDSWORK  DS    0D            CONFIGURATOR WORK AREA                     30050000
CDSREC   DS    0CL256 .      CDS RECORD CREATION AREA                   30100000
CDSUNIT  DS    CL4 .              UNIT ADDRESS                          30150000
CDSMODEL DS    CL1 .              MODEL                                 30200000
CDSFEAT  DS    CL1 .              FEATURES                              30250000
CDSCLASS DS    CL1 .              CLASS                                 30300000
CDSTYPE  DS    CL1 .              TYPE DEVICE                           30350000
CDSBYTES DS    CL1 .              BYTE COUNT                            30400000
CDSFLAGS DS    CL1 .              FLAGS                                 30450000
*                                                                       30500000
CDSFPMOD EQU   X'80' .                 FILE PROTECT MODE FLAG           30550000
CDSDVSHR EQU   X'40' .                 DEVICE SHARED WITH ANOTHER SYS   30600000
CDSFEVOL EQU   X'20' .                 F.E. VOLUME MOUNTED FLAG         30650000
CDSEXINT EQU   X'10' .                 EXTERNAL INTERRUPT POSSIBLE FLAG 30700000
CDSSYMNM EQU   X'08' .                 SYMBOLIC ADDRESSING FLAG         30750000
CDSTWOCH EQU   X'04' .                 TWO CHANNEL SWITCH FLAG          30800000
CDSCUSYM EQU   X'02' .                 CUSTOMER ASSIGNED SYMBOLIC NAME  30850000
CDSLCNCT EQU   X'01' .                 LINE CONNECTION REQUIRED         30900000
*                                                                       30950000
CDSSIGNL DS    CL2 .              EXTERNAL SIGNAL MASK                  31000000
CDSNAME  DS    0CL8 .             SYMBOLIC (ALTERNATE MEMBER) NAME      31050000
CDSTCU   DS    CL2 .              OR      TCU FEATURES                  31100000
CDSMISC  DS    CL3 .                      MISC                          31150000
CDSRMASK DS    CL3 .                      SECTION RUN MASK              31200000
CDSFXARA DS    0CL4 .             EXTENDED FIXED AREA                   31250000
CDSFXLEN DS    CL1 .                   LENGTH                           31300000
CDSFXFLG DS    CL2 .                   FLAGS                            31350000
*                                           TWO BYTE SET MODE           31400000
CDSSETMD EQU   X'80' .                      AUTOCALL FEATURE            31450000
CDSAUTCL EQU   X'40' .                      SWITCHED LINE               31500000
CDSMPNT  EQU   X'20' .                      NON-SWITCHED MULTIDROP LINE 31550000
CDSMDROP EQU   X'10' .                      BSC WORLD TRADE DATA SET    31600000
CDSWTBSC EQU   X'08' .                                                  31650000
*                                                                       31700000
CDSLNCON DS    CL1                     LINE CONNECTION CMD SEQ CODE     31750000
CDSVAR   DS    0C    .            CDS VARIABLE FIELD                    31800000
         ORG   CDSWORK+256                                              31850000
CDSINPUT DS    0CL80         INPUT TO UNIT CONFIGURATOR AREA            31900000
CDSTCUTY DS    CL4 .              TCU TYPE (EBCDIC)                     31950000
CDSSYMBL DS    CL8 .              SYMBOLIC TERMINAL NAME (EBCDIC)       32000000
CDSTERM  DS    CL4 .              TERMINAL TYPE (EBCDIC)                32050000
CDSADAP  DS    CL1 .              ADAPTER TYPE                          32100000
*                                                                       32150000
CDSIBM1  EQU   X'10' .                 IBM I                            32200000
CDSIBM2  EQU   X'20' .                 IBM II                           32250000
CDSIBMTY EQU   X'30'                   IBM TTY                          32300000
CDSTTY1  EQU   X'40' .                 TTY I                            32350000
CDSTTY2  EQU   X'50' .                 TTY II                           32400000
CDSWTTY  EQU   X'60' .                 WTC TTY                          32450000
CDSSDA1  EQU   X'70' .                 SDA I                            32500000
CDSIBM3  EQU   X'80' .                 IBM III                          32550000
CDSSDA2  EQU   X'90' .                 SDA II                           32600000
*                                                                       32650000
CDSLINE  DS    CL1 .              LINE TYPE                             32700000
*                                                                       32750000
CDSPTP   EQU   X'01' .                 LEASED POINT TO POINT            32800000
CDSMP    EQU   X'02' .                 LEASED MULTIPOINT                32850000
CDSSWTCH EQU   X'03' .                 SWITCHED WITHOUT AUTODIAL        32900000
CDSSWAUT EQU   X'04' .                 SWITCHED WITH AUTODIAL           32950000
CDSLOCAL EQU   X'05' .                 LOCAL                            33000000
*                                                                       33050000
CDSCONN  DS    CL1 .              LINE CONNECTION CODE                  33100000
*                                                                       33150000
CDSBYP   EQU   X'00' .                 BYPASS                           33200000
CDSDISEN EQU   X'01' .                 DISABLE, ENABLE OR DIAL          33250000
CDSDSMI  EQU   X'02' .                 DISABLE, SETMODE, ENABLE OR DIAL 33300000
* .                                         FOR SDA I                   33350000
CDSDSMIT EQU   X'03' .                 DISABLE, SETMODE, ENABLE OR DIAL 33400000
* .                                         FOR SDA II                  33450000
CDSDSAD0 EQU   X'04' .                 DISABLE, SADZERO, ENABLE OR DIAL 33500000
CDSDSAD1 EQU   X'05' .                 DISABLE, SADONE,  ENABLE OR DIAL 33550000
CDSDSAD2 EQU   X'06' .                 DISABLE, SADTWO,  ENABLE OR DIAL 33600000
CDSDSAD3 EQU   X'07' .                 DISABLE, SADFOUR, ENABLE OR DIAL 33650000
*                                                                       33700000
CDS#POLL DS    CL1 .              NUMBER OF POLLING CHARACTERS (HEX)    33750000
CDSPOLL  DS    CL7 .              POLLING CHARACTERS                    33800000
CDS#ADDR DS    CL1 .              NUMBER OF ADDRESSING CHARACTERS (HEX) 33850000
CDSADDR  DS    CL10 .             ADDRESSING CHARACTERS                 33900000
         DS    CL1 .              UNUSED                                33950000
CDS#DIAL DS    CL1 .              NUMBER OF DIAL DIGITS                 34000000
CDSDIAL  DS    CL20 .             DIAL DIGITS                           34050000
CDS#ID   DS    C .                CPU ID LENGTH                         34100000
CDSCPUID DS    15C .              CPU ID                                34150000
CDSCODE  DS    C .           ADAPTER LINE CODE                          34200000
CDSCFLGS DS    CL1           RESERVED                                   34250000
CDSFNFLG DS    CL1 .              FUNCTION FLAGS                        34300000
*                                                                       34350000
CDSADD   EQU   X'02' .                 ADD                              34400000
CDSDEL   EQU   X'04' .                 DELETE                           34450000
CDSCHNG  EQU   X'06' .                 CHANGE                           34500000
CDSEXIBT EQU   X'08' .                 EXHIBIT                          34550000
*                                                                       34600000
CDSRETFL DS    CL1 .              RETURN CODE                           34650000
*                                                                       34700000
CDSNRML  EQU   X'00' .                 NORMAL RETURN                    34750000
CDSINVLD EQU   X'01' .                 INVALID                          34800000
*                                                                       34850000
CDSBLDL  DS    0CL40 .       BLDL LIST FOR CONFIG DIRECTORY             34900000
CDSMEMBR DS    CL8 .              MEMBER NAME                           34950000
CDSTTRC  DS    CL3 .              CESD RELATIVE TTR                     35000000
CDSTTRC4 DS    CL1 .              CESD RELATIVE TTR 4TH BYTE            35050000
CDSTTRD  DS    CL3 .              DATA RELATIVE TTR                     35100000
CDSTTRD4 DS    CL1 .              DATA RELATIVE TTR 4TH BYTE            35150000
CDSTTRNS DS    CL4 .              RESERVED                              35200000
CDSATTRB DS    CL2 .              ATTRIBUTES                            35250000
CDSMAIN  DS    CL3 .              MAIN STORAGE REQUIREMENTS             35300000
CDSBLK1  DS    CL2 .              LENGTH OF FIRST BLOCK                 35350000
CDSEPADR DS    CL3 .              ENTRY POINT ADDRESS                   35400000
CDSTXBLK DS    CL3 .              FIRST TEXT BLOCK ORIGIN               35450000
CDSSSI   DS    CL7 .              CDS SSI                               35500000
*                                                                       35550000
         DS    0D .                                                     35600000
CDSCESD  DS    0CL56 .       CESD RECORD FOR CONFIG PDS                 35650000
CDSCESID DS    CL1 .              CESD IDENTIFICATION                   35700000
CDSCESPR DS    CL3 .              UNUSED                                35750000
CDSESD01 DS    CL2 .              ESDID OF FIRST ESD                    35800000
CDSCESCT DS    CL2 .              COUNT                                 35850000
CDSCESNM DS    CL8 .              MEMBER NAME                           35900000
CDSCESTY DS    CL1 .              TYPE                                  35950000
CDSCESAD DS    CL3 .              ADDRESS                               36000000
CDSCESGM DS    CL1 .              SEGMENT                               36050000
CDSCESLN DS    CL3 .              ID AND LENGTH                         36100000
CDSESD02 DS    CL16 .             SECOND ESD RECORD                     36150000
CDSESD03 DS    CL16 .             THIRD ESD RECORD                      36200000
*                                                                       36250000
CDSCNTL  DS    0CL20 .       CONTROL RECORD FOR CONFIG PDS              36300000
CDSCTLID DS    CL1 .              CNTROL IDENTIFICATION                 36350000
CDSCTLSP DS    CL3 .              UNUSED                                36400000
CDSCNT01 DS    CL2 .              # BYTES FOLLOWING CCW                 36450000
CDSCNT02 DS    CL2 .              COUNT                                 36500000
CDSCCW   DS    CL8 .              CHANNEL CONTROL WORD                  36550000
CDSCESDI DS    CL2 .              CESD ENTRY                            36600000
CDSRECLN DS    CL2 .              LENGTH OF TEXT RECORD                 36650000
CDSTTBLE DS    A .           TERMINAL TABLE ENTRY ADDRESS               36700000
CDSTINDX DS    H .           TERMNAME TABLE INDEX                       36750000
         DS    CL142 .       RESERVED                          @Y17XAX6 36800000
.EQUATES ANOP                                                           36850000
TOTWAITI DS    D             WAITIO TIME INTERVAL                       36900000
TOTGRABP DS    F             CURRENT SECONDARY DEVICE POINTER           36950000
TOTAPNAM DS    CL8           ALTERNATE PRINTER NAME IN EBCDIC           37000000
TOTOLTEN DS    F             ENTRY POINT ADDRESS OF OLT                 37050000
TOTWAWRK DS    20F .         IEDQWA WORK AREA                  @Y17XAXU 37100000
TOTWOWRK DS    35F           IEDQWO WORK SPACE                  SA41602 37150000
         DS    CL52          RESERVED FOR MAINTENANCE          @Y17XAXU 37200000
TOTSERV  DS    0CL454 .           START OF SERVICE ROUTINES    @Y17XAXU 37250000
*                                 WORK AREA                    @Y17XAXU 37300000
************************************************************** @Y17XAXU 37350000
*                                                            * @Y17XAXU 37400000
*        THE LABEL 'TOTSERV' DEFINES THE START OF THE SERVICE* @Y17XAXU 37450000
*        ROUTINE WORK AREA. IT'S PURPOSE IS TO PROVIDE       * @Y17XAXU 37500000
*        PRE TCAM 10.0 SERVICE ROUTINES A MEANS OF BEING     * @Y17XAXU 37550000
*        REENTRANT . MODIFIABLE DATA AREAS ARE MOVED TO THIS * @Y17XAXU 37600000
*        WORK SPACE. SERVICE MODULES WHICH USE THIS AREA     * @Y17XAXU 37650000
*        SHOULD DEFINE IN A DSECT FASHION (DO NOT INCLUDE A  * @Y17XAXU 37700000
*        DSECT STATEMENT) THEIR MODIFIABLE DATA AREAS. THE   * @Y17XAXU 37750000
*        MODIFIABLE AREA WILL BECOME A CONTINUATION OF THIS  * @Y17XAXU 37800000
*        DSECT (OLTCB) AND SHOULD BE PLACED IMMEDIATELY      * @Y17XAXU 37850000
*        BEHIND THE OLTCB MACRO STATEMENT.                   * @Y17XAXU 37900000
*                                                            * @Y17XAXU 37950000
************************************************************** @Y17XAXU 38000000
.MEND    ANOP                                                           38050000
TOTOBEND DS    0F .          END OF OLTCB                    @Y17XAX6   38100000
         MEND   ,             */                                        38150000
 %OLTCBPLS:   ;                                                         38200000
 /*                                                                   */38250000
 /*      ON-LINE TEST CONTROL BLOCK FOR PLS MODULES                   */38300000
 /*                                                                   */38350000
 /*      STATUS = VERSION 10.0                                @Y17XAXU*/38400000
 /*                                                                   */38450000
         DECLARE                                                        38500000
           1 TOTOLTCB BASED (OLTCBPTR) BDY(DWORD), /*     @Y17XAX6*/    38550000
 %IF PONTER¬='YES' %THEN                                                38600000
   %GOTO BYP001;                                                        38650000
             2 TOTOBPTR,                                                38700000
               3 TOTELKEY CHAR(1),                /* OLTCB QUEUE      */38750000
                                                  /* ELEMENT KEY      */38800000
               3 TOTELQCB PTR(24),                /* ADDRESS OF OLTCB */38850000
                                                  /* QCB              */38900000
               3 * CHAR(1),                       /* UNUSED           */38950000
               3 TOTELLNK PTR(24),                /* OLTCB QUEUE      */39000000
                                                  /*ELEMENT LINK FIELD*/39050000
 /*                                                                   */39100000
 /*            SECTION CONTROL TABLE MAPPING                          */39150000
 /*                                                                   */39200000
 %BYP001:   ;                                                           39250000
             2 $SCTTBLE BDY(WORD),                /* SECTION CONTROL    39300000
                                                      TABLE   @Y17XAX6*/39350000
               3 $ERRLPCT FIXED(15) BDY(HWORD),   /* LOOP ON ERROR      39400000
                                                      COUNT   @Y17XAX6*/39450000
               3 $TESTOPT CHAR(1),      /* TEST OPTION FIELD @Y17XAX6*/ 39500000
                 4 * BIT(5),                      /* UNUSED           */39550000
                 4 $NOPRT BIT(1),                 /* X'04'- NO PRINT    39600000
                                            OPTION FLAG  @Y17XAX6*/     39650000
                 4 $INDEFLP BIT(1),               /* X'02'- INDEFINITE  39700000
                                           ERROR LOOP FLAG @Y17XAX6*/   39750000
                 4 $FSTCOMM BIT(1),               /* X'01'-FIRST ERROR  39800000
                                           COMMUNICATION FLAG @Y17XAX6*/39850000
               3 $ERROPT CHAR(1),                 /* ERROR AND OPTION   39900000
                                                      FIELD  @Y17XAX6 */39950000
                 4 $TESTERR BIT(1),      /* X'80'- TEST ERROR @Y17XAX6*/40000000
                 4 $ASTERIK BIT(1),      /* X'40'- PRINT ASTERIK ON     40050000
                                          TERMINATE MSG FLAG @Y17XAX6 */40100000
                 4 $CATERR BIT(1),       /* X'20'-CATASTROPHIC ERROR    40150000
                                          FLAG @Y17XAX6*/               40200000
                 4 $ALTPRNT BIT(1),       /* X'10'- ALTERNATE PRINTER   40250000
                                          OPTION FLAG   @Y17XAX6*/      40300000
                 4 $NOCNTRL BIT(1),       /* X'08'- NO CONTROL PRINT    40350000
                                           OPTION  @Y17XAX6*/           40400000
                 4 $NERRPRT BIT(1),       /* X'04'- NO ERROR PRINT      40450000
                                           OPTION FLAG @Y17XAX6*/       40500000
                 4 $LOOPERR BIT(1),       /* X'02'- LOOP ON ERROR       40550000
                                           OPTION FLAG @Y17XAX6*/       40600000
                 4 $LOOPTST BIT(1),       /* X'01'- LOOP ON TEST        40650000
                                          ENTRY OPTION FLAG @Y17XAX6*/  40700000
               3 $RT0108 CHAR(1) BDY(BYTE),       /* ROUTINE MASK 1     40750000
                                               THROUGH 8 @Y17XAX6     */40800000
               3 $RT0916 CHAR(1),                 /* ROUTINE MASK 9     40850000
                                               THROUGH 16 @Y17XAX6*/    40900000
               3 $DRIVER CHAR(1),            /* DRIVER   @Y17XAX6*/     40950000
               3 $SPARE1 CHAR(1) BDY(BYTE),       /* UNUSED   @Y17XAX6*/41000000
       3 $TSSSYM CHAR(2) BDY(HWORD),      /* RESERVED FOR TSS @Y17XAX6*/41050000
               3 $PDEVFLG CHAR(1),                /* PRIMARY DEVICE     41100000
                                                      FLAGS   @Y17XAX6*/41150000
                 4 $FPMOLD BIT(1),                /* X'80'- FILE        41200000
                                           PROTECT FLAG  @Y17XAX6*/     41250000
                 4 $EXFILPT BIT(1),               /* X'40'- ADDITIONAL  41300000
                                           FILE PROTECT FLAG @Y17XAX6*/ 41350000
                 4 $TSSSYS1 BIT(1),               /* X'20'- RESERVED    41400000
                                                FOR TSS @Y17XAX6*/      41450000
                 4 $LASTDEV BIT(1),               /* X'10'- LAST        41500000
                                 DEVICE OF SUBSYSTEM FLAG  @Y17XAX6*/   41550000
                 4 * BIT(1),                      /* X'08'- SPARE     */41600000
                 4 $TERMNDX BIT(1),               /* X'04'- RESERVED    41650000
                                                    FOR TSS  @Y17XAX6*/ 41700000
                 4 $PATHDEF BIT(1),               /* X'02'- RESERVED    41750000
                                                    FOR TSS  @Y17XAX6*/ 41800000
                 4 $LASTSUB BIT(1),               /* X'01'- LAST        41850000
                               DEVICE OF LAST SUBSYSTEM FLAG @Y17XAX6*/ 41900000
               3 $CDSFLGS CHAR(1),                /* DEVICE FLAGS FROM  41950000
                                      CDS FLAG BYTE @Y17XAX6*/          42000000
                 4 $FPM BIT(1),                   /* X'80'- FILE        42050000
                                      PROTECT FLAG @Y17XAX6*/           42100000
                 4 $SHARED BIT(1),                /* X'40'- SHARED      42150000
                                      DEVICE FLAG  @Y1XAX6*/            42200000
                 4 $CEVOL BIT(1),                 /* X'20'- CE VOLUME   42250000
                                                      FLAG  @Y17XAX6  */42300000
                 4 $EXTINTC BIT(1),               /* X'10'- DEV ADDR    42350000
                                     ASSOCIATED WITH EXT FLAG @Y17XAX6*/42400000
                 4 $SYMNAME BIT(1),               /* X'08'- SYMBOLIC    42450000
                                                 NAME FLAG @Y17XAX6*/   42500000
                 4 $TWOCHSW BIT(1),               /* X'04'-TWO CHANNEL  42550000
                                              SWITCH FLAG @Y17XAX6*/    42600000
                 4 $CUSTSYM BIT(1),               /* X'02'- CUSTOMER    42650000
                        ASSIGNED SYMBOLIC NAME FLAG  @Y17XAX5*/         42700000
                 4 $COMMCN  BIT(1),               /* X'01'- LINE        42750000
                        CONNECTION REQUIRED FLAG @Y17XAX6*/             42800000
               3 $PDEVADR PTR(31) BDY(WORD),      /* PRIMARY DEVICE     42850000
                                                ADDRESS  @Y17XAX6*/     42900000
               3 $PDEVDSC CHAR(4),                /* PRIMARY DEVICE     42950000
                                          DESCRIPTORS @Y17XAX6*/        43000000
               3 $CDS8T19 CHAR(12) BDY(WORD),     /* PRIMARY DEVICE     43050000
                                  CDS BYTE8 8 THROUGH 19 @Y17XAX6*/     43100000
               3 $RMSKCNT CHAR(1),                /* ROUTINE MASK       43150000
                                       COUNT LENGTH @Y17XAX6*/          43200000
               3 $EXECFLG CHAR(1),                /* EXECUTIVE PROGRAM  43250000
                                                    FLAGS  @Y17XAX6 */  43300000
                 4 $CECCMIN BIT(1),               /* X'80'- REPLY IN    43350000
                                 TO OUTSTANDING CECOM FLAG @Y17XAX6*/   43400000
                 4 $MULTDEV BIT(1),               /* X'40'- MORE THAN   43450000
                                    ONE DEVICE ENTRY FLAG  @Y17XAX6*/   43500000
                 4 $RTNSLCT BIT(1),               /* X'20'- OPERATOR    43550000
                           MADE ROUTINE SELECTION FLAG  @Y17XAX6*/      43600000
                 4 $ERRCNT  BIT(1),               /* X'10'- OPERATOR    43650000
                           SPECIFIED ERROR LOOP COUNT  @Y17XAX6*/       43700000
                 4 $LSTPDEV BIT(1),               /* X'08'- DON'T       43750000
                           ASSIGN MORE PRIMARY DEVICES FLAG  @Y17XAX6*/ 43800000
                 4 $CLEANUP BIT(1),               /* X'04'- SECTION     43850000
                            ENTERED FOR CLEANUP FLAG  @Y17XAX6*/        43900000
                 4 $CTRLMOD BIT(1),               /* X'02'- CONTROL     43950000
                                 MODE AVAILABLE FLAG  @Y17XAX6 */       44000000
                 4 $QSCTMOD BIT(1),               /* X'01'- QUIESCENT   44050000
                                MODE AVAILABLE FLAG  @Y17XAX6*/         44100000
        3 $OLTSIZE FIXED(15) BDY(HWORD),   /* OLT REGION SIZE @Y17XAX6*/44150000
         3 $OLTFLGS CHAR(1),     /* OLT FUNCTIONAL FLAGS @Y17XAX6*/     44200000
                 4 $MANINTV BIT(1),               /* X'80'- MANUAL      44250000
                              INTERVENTION ROUTINE FLAG  @Y17XAX6*/     44300000
                 4 $CLEANRT BIT(1),               /* X'40'-OLT HAS      44350000
                                     CLEANUP ROUTINE FLAG  @Y17XAX6*/   44400000
                 4 $RETAIN BIT(1),                /* X'20'- RETAIN      44450000
                                           IS ACTIVE FLAG @Y17XAX6*/    44500000
                 4 $CONTCB BIT(1),                /* X'10'-CONTINGENT   44550000
                              CONNECTION BROKEN FLAG  @Y17XAX6*/        44600000
                 4 $RETCODE BIT(1),               /* X'08'   @Y17XAX6 */44650000
                 4 $TRACE  BIT(1),                /* X'04'   @Y17XAX6 */44700000
                 4 $LASTSEC BIT(1),               /* X'02'- LAST        44750000
                              SECTION SCHEDULED FLAG  @Y17XAX6*/        44800000
                 4 * BIT(1),            /* X'01'- UNUSED          */    44850000
               3 * CHAR(1),                       /* UNUSED           */44900000
               3 $TOTFLG1 CHAR(1),      /* TOTE 1ST FLAG BYTE @Y17XAX6*/44950000
                 4 $LINESHR BIT(1),               /* X'80'- LINE CAN    45000000
                                          BE SHARED FLAG @Y17XAX6*/     45050000
                 4 $TDATBLK BIT(1),               /* X'40'- TOTE        45100000
                                       MESSAGE BLOCKING FLAG @Y17XAX6*/ 45150000
                 4 $TERMSEC BIT(1),          /* X'20'- TRM REQUESTS     45200000
                          TEST IN BACKUP MODE @Y17XAX6*/                45250000
                 4 $CTEQTT BIT (1),       /* X'10'-CONTROL TERMINAL     45300000
                      AND TEST TERMINAL ARE ON SAME LINE  @Y17XAX6*/    45350000
                 4 * BIT(4),                      /* UNUSED     S22024*/45400000
               3 $TOTFLG2 CHAR(1) BDY(BYTE),      /* TOTE 2ND FLAG      45450000
                                                 BYTE  @Y17XAX6  */     45500000
               3 $R017024 CHAR(1),                /* ROUTINE MASK 017   45550000
                                                 THRU 024 @Y17XAX6*/    45600000
               3 $R025032 CHAR(1),                /* ROUTINE MASK 025   45650000
                                                 THRU 032 @Y17XAX6*/    45700000
               3 $R033040 CHAR(1),                /* ROUTINE MASK 033   45750000
                                                 THRU 040 @Y17XAX6*/    45800000
               3 $R041048 CHAR(1),                /* ROUTINE MASK 041   45850000
                                                 THRU 048 @Y17XAX6*/    45900000
               3 $R049056 CHAR(1),                /* ROUTINE MASK 049   45950000
                                                 THRU 056 @Y17XAX6*/    46000000
               3 $R057064 CHAR(1),                /* ROUTINE MASK 057   46050000
                                                 THRU 064 @Y17XAX6*/    46100000
               3 $R065072 CHAR(1),                /* ROUTINE MASK 065   46150000
                                                 THRU 072 @Y17XAX6*/    46200000
               3 $R073080 CHAR(1),                /* ROUTINE MASK 073   46250000
                                                 THRU 080 @Y17XAX6*/    46300000
               3 $R081088 CHAR(1),                /* ROUTINE MASK 081   46350000
                                                 THRU 088 @Y17XAX6*/    46400000
               3 $R089096 CHAR(1),                /* ROUTINE MASK 089   46450000
                                                 THRU 096 @Y17XAX6*/    46500000
               3 $R097104 CHAR(1),                /* ROUTINE MASK 097   46550000
                                                 THRU 104 @Y17XAX6*/    46600000
               3 $R105112 CHAR(1),                /* ROUTINE MASK 105   46650000
                                                 THRU 112 @Y17XAX6*/    46700000
               3 $R113120 CHAR(1),                /* ROUTINE MASK 113   46750000
                                                 THRU 120 @Y17XAX6*/    46800000
               3 $R121128 CHAR(1),                /* ROUTINE MASK 121   46850000
                                                 THRU 128  @Y17XAX6*/   46900000
               3 $R129136 CHAR(1),                /* ROUTINE MASK 129   46950000
                                                 THRU 136 @Y17XAX6*/    47000000
               3 $R137144 CHAR(1),                /* ROUTINE MASK 137   47050000
                                                 THRU 144 @Y17XAX6*/    47100000
               3 $R145152 CHAR(1),                /* ROUTINE MASK 145   47150000
                                                 THRU 152 @Y17XAX6*/    47200000
               3 $R153160 CHAR(1),                /* ROUTINE MASK 153   47250000
                                                 THRU 160 @Y17XAX6*/    47300000
               3 $R161168 CHAR(1),                /* ROUTINE MASK 161   47350000
                                                 THRU 168 @Y17XAX6*/    47400000
               3 $R169176 CHAR(1),                /* ROUTINE MASK 169   47450000
                                                 THRU 176  @Y17XAX6*/   47500000
               3 $R177184 CHAR(1),                /* ROUTINE MASK 177   47550000
                                                 THRU 184  @Y17XAX6*/   47600000
               3 $R185192 CHAR(1),                /* ROUTINE MASK 185   47650000
                                                 THRU 192 @Y17XAX6*/    47700000
               3 $R193200 CHAR(1),                /* ROUTINE MASK 193   47750000
                                                 THRU 200 @Y17XAX6*/    47800000
               3 $R201208 CHAR(1),                /* ROUTINE MASK 201   47850000
                                                 THRU 208 @Y17XAX6*/    47900000
               3 $R209216 CHAR(1),                /* ROUTINE MASK 209   47950000
                                                 THRU 216 @Y17XAX6*/    48000000
               3 $R217224 CHAR(1),                /* ROUTINE MASK 217   48050000
                                                 THRU 224 @Y17XAX6*/    48100000
               3 $R225232 CHAR(1),                /* ROUTINE MASK 225   48150000
                                                 THRU 232  @Y17XAX6*/   48200000
               3 $R233240 CHAR(1),                /* ROUTINE MASK 233   48250000
                                                 THRU 240 @Y17XAX6*/    48300000
               3 $R241248 CHAR(1),                /* ROUTINE MASK 241   48350000
                                                 THRU 248 @Y17XAX6*/    48400000
               3 $R249255 CHAR(1),                /* ROUTINE MASK 249   48450000
                                                 THRU 255 @Y17XAX6*/    48500000
               3 $RETMASK CHAR(1),       /* RETURN CODE MASK @Y17XAX6*/ 48550000
               3 * CHAR(1),                       /* SPARE            */48600000
               3 * CHAR (6),                   /* SPARE      S05331*/   48650000
               3 $MSGIDAC CHAR (2),       /* ACTIVE OLT ID @Y17XAX6*/   48700000
               3 $TABLE PTR(31) BDY(WORD),        /* ADDRESS OF BRANCH  48750000
                                                      TABLE  @Y17XAX6 */48800000
               3 $PASS PTR(31) BDY(WORD),         /* ADDRESS OF PASSON  48850000
                                                      AREA  @Y17XAX6  */48900000
               3 $EXT  PTR(31) BDY(WORD),         /* ADDRESS OF         48950000
                                            EXTERNAL DATA @Y17XAX6*/    49000000
               3 * CHAR(24) BDY(WORD),            /* SCT EXPANSION      49050000
                                                      AREA   @Y17XAX6 */49100000
             2 TOTSMGRT PTR(31),                  /* SERVICE MANAGER  */49150000
                                                  /*  RETURN SAVE     */49200000
             2 TOTSAVE1 CHAR(72) BDY(WORD),       /* OLT SUBTASK 1ST  */49250000
                                                  /*  SAVE AREA       */49300000
             2 TOTSAVE2 CHAR(72) BDY(WORD),       /* OLT SUBTASK 2ND  */49350000
                                                  /*  SAVE AREA       */49400000
             2 TOTSAVE3 CHAR(72) BDY(WORD),       /* OLT SUBTASK 3RD  */49450000
                                                  /*  SAVE AREA       */49500000
             2 TOTSAVE4 CHAR(72) BDY(WORD),       /* OLT SUBTASK 4TH  */49550000
                                                  /*  SAVE AREA       */49600000
             2 TOTSAVE5 BDY(WORD),                /* OLT SUBTASK 5TH  */49650000
               3 * CHAR(44),                      /*  SAVE AREA       */49700000
               3 TOTOLTPT PTR(31),                                      49750000
               3 * CHAR(16),                                            49800000
               3 TOTOLTEP PTR(31),                                      49850000
               3 * CHAR(4),                                             49900000
             2 TOTSAVE6 CHAR(72) BDY(WORD),       /* OLT SUBTASK 6TH  */49950000
                                                  /* SAVE AREA@Y17XAXU*/50000000
             2 TOTWOSV1 PTR(31),                  /* IEDQWO LEV 1     */50050000
                                                  /* SAVE AREA@Y17XAXU*/50100000
             2 TOTWOSV2 PTR(31),                  /* IEDQWO LEV 2     */50150000
                                                  /* SAVE AREA@Y17XAXU*/50200000
             2 TOTWOSV3 PTR(31),                  /* IEDQWO LEV 3     */50250000
                                                  /* SAVE AREA@Y17XAXU*/50300000
             2 TOTWOSV4 PTR(31),                  /* IEDQWO LEV 4     */50350000
                                                  /* SAVE AREA@Y17XAXU*/50400000
  2 TOTSVEND CHAR(0),  /* END OF TOTE SAVE AREAS  @Y17XAX6*/            50450000
             2 TOTBKASN FIXED(15) BDY(HWORD),     /* MAIN STORAGE     */50500000
                                                  /*  BLOCKS ASSIGNED */50550000
                                                  /*  TO THIS OLT     */50600000
             2 TOTBKRQD FIXED(15) BDY(HWORD),     /* MAIN STORAGE     */50650000
                                                  /*  BLOCKS REQUIRED */50700000
                                                  /*  BY THIS OLT     */50750000
             2 TOTMMSPC CHAR(4) BDY(WORD),        /* OLT UNUSED MAIN  */50800000
                                                  /*  STORAGE SPACE   */50850000
 /*                                                          @Y17XAXU*/ 50900000
 /*            SOURCE TERMINAL ENTRY                         @Y17XAXU*/ 50950000
 /*                                                          @Y17XAXU*/ 51000000
             2 TOTSRENT BDY(WORD),   /* SRC TERMINAL ENTRY   @Y17XAXU*/ 51050000
               3 TOTSROFF FIXED(16), /* TTCIN OF SOURCE      @Y17XAXU*/ 51100000
               3 * CHAR(2),          /* RESERVED             @Y17XAXU*/ 51150000
               3 TOTSRLCB PTR(31),   /* SOURCE LCB ADDRESS   @Y17XAXU*/ 51200000
 /*                                                                   */51250000
 /*            CONTROL TERMINAL ENTRY                                 */51300000
 /*                                                                   */51350000
             2 TOTCTENT BDY(WORD),                /* CONTROL TERMINAL */51400000
                                                  /*  ENTRY           */51450000
               3 TOTCTUCB FIXED(16),              /* C.T. UCB ADDRESS */51500000
               3 TOTCTOFF FIXED(16),              /* OFFSET TO C.T.   */51550000
                                                  /*  TNT ENTRY       */51600000
                                                  /* (DUMMY)  @Y17XAXU*/51650000
               3 TOTCROFF FIXED(16),              /* OFFSET TO C.T.   */51700000
                                                  /* TNT ENTRY        */51750000
                                                  /* (REAL)   @Y17XAXU*/51800000
               3 TOTCRSID FIXED(16),              /* C.T. NETWORK    */ 51850000
                                                  /* ADDRESS @Y17XAXU*/ 51900000
               3 TOTCTRLN CHAR (1),               /* C.T. RELATIVE    */51950000
                                                  /*  LINE NUMBER     */52000000
               3 TOTCTLCB PTR(24),                /* C.T. LCB ADDRESS */52050000
               3 TOTCTTNT PTR(31),                /* C.T. TERMINAL    */52100000
                                                  /*  NAME TABLE ENTRY*/52150000
                                                  /* ADDRESS (DUMMY)  */52200000
               3 TOTCRTNT PTR(31),                /* CT TNT ADDRESS   */52250000
                                                  /* (REAL ENTRY)     */52300000
               3 TOTCTTLN FIXED(15),              /* LENGTH OF CT TTE */52350000
                                                  /*  AREA            */52400000
               3 TOTCTFLG CHAR(1),                /* CONTROL TERMINAL */52450000
                                                  /* FLAGS            */52500000
                 4 TOTCTASN BIT(1),               /* X'80'-   S22024*/  52550000
                                                  /* DUMMY EN-S22024*/  52600000
                                                  /* TRY ASGN.S22024*/  52650000
                 4 TOTCTORN BIT (1),              /* X'40'- CTS22024*/  52700000
                                                  /* ON 3705  S22024*/  52750000
                 4 * BIT(5),                     /* RESERVED @Y17XAXU*/ 52800000
                   4 TOTCTSWD BIT(1),            /* X'01' DIAL S22024*/ 52850000
        3 TOTCTEND CHAR(0),    /* END OF BASIC C.T. AREA  @Y17XAX6*/    52900000
                 3 TOTCTRNL CHAR (8),            /* GROUP NAME S22024*/ 52950000
                                                 /* OF CT LINE S22024*/ 53000000
               3 TOTCTNAM CHAR (9),               /* CONTROL TERMINAL */53050000
                                                  /* NAME IN EBCDIC   */53100000
             2 TOTCTDFL CHAR (1),                /* CONTROL TERMINAL  */53150000
                                                 /* INITIAL CONDITIONS*/53200000
               3 TOTCTTRM BIT(1),                /* X'80'-TERMINAL    */53250000
                                                 /* DEVICE FLAG       */53300000
               3 TOTCTLIN BIT (1),               /* X'40'-LINE ADDRESS*/53350000
                                                 /* FLAG              */53400000
               3 * BIT(1),                       /* UNUSED            */53450000
               3 TOTCTGP BIT(1),                 /* X'10'-GENERAL POLL*/53500000
                                                 /* INITIALLY ACTIVE  */53550000
                                                 /* ON TEST LINE      */53600000
               3 TOTCTLST BIT (1),               /* X'08'-CT INITIALLY*/53650000
                                                 /* STOPPED           */53700000
               3 TOTCTHD BIT (1),                /* X'04'-CT INITIALLY*/53750000
                                                 /* HELD              */53800000
               3 TOTCTIAC BIT (1),               /* X'02'-CT INVITA-  */53850000
                                                 /* TION LIST ENTRY   */53900000
                                                 /* INITIALLY INACTIVE*/53950000
               3 * BIT (1),                      /* UNUSED            */54000000
             2 * CHAR(3),                        /* RESERVED  @Y17XAXU*/54050000
             2 TOTCUTST,                         /* CONTROL INFO FOR  */54100000
                                                 /* $CUTEST MACRO     */54150000
               3 TOTCUFLG CHAR(1),               /* $CUTEST FLAGS     */54200000
                 4 TOTCUDON BIT (1),             /* X'80-CUTEST ISSUED*/54250000
                 4 TOTCUCUP BIT (1),             /* X'40'-CUTEST CLEAN*/54300000
                                                 /* UP REQUIRED       */54350000
                 4 * BIT (6),                    /* UNUSED            */54400000
               3 TOTCU#AD CHAR (1),              /* $CUTEST NUMBER OF   54450000
                                      CONTIGUOUS ADDRESS @Y16XAX6*/     54500000
               3 TOTCUCUU CHAR (2),              /* $CUTEST STARTING  */54550000
                                                 /* ADDRESS           */54600000
               3 TOTCUSAV    CHAR (4),           /* $CUTEST SAVE AREA */54650000
               3 TOTCURS1 CHAR (1),              /* $CUTEST CODE      */54700000
                                                 /* PARAMETER         */54750000
               3 TOTCURS2 CHAR (1),              /* $CUTEST HEX       */54800000
                                                 /* CHANNEL ADDRESS   */54850000
               3 TOTCURS3 CHAR (1),              /* $CUTEST RESERVED  */54900000
                                                 /* BYTE 3 CODE       */54950000
                                                 /* PARAMETER         */55000000
               3 TOTCURS4 CHAR (1),              /* $CUTEST RESERVED  */55050000
                                                 /* BYTE 4 CODE       */55100000
                                                 /* PARAMETER         */55150000
             2 TOTWOOPC CHAR(24),                 /* IEDQWO   SA41602*/ 55200000
                                                  /* OP CNTRL SA41602*/ 55250000
                                                  /* PARM LISTSA41602*/ 55300000
             2 TOTPLIST CHAR (24),               /* OP CONTROL S22024*/ 55350000
                                                 /* PARM LIST  S22024*/ 55400000
               3 TOTOKEY CHAR(1),                /* KEY        S22024*/ 55450000
               3 TOTOQCBA CHAR(3),               /* QCB ADDR   S22024*/ 55500000
               3 TOTOPRI CHAR(1),                /* PRIORITY   S22024*/ 55550000
               3 TOTOLINK CHAR(3),               /* LINK FIELD S22024*/ 55600000
               3 TOTOVBCD CHAR(1),               /* VERB CODE  S22024*/ 55650000
               3 TOTOELNG CHAR(1),               /* LENGTH     S22024*/ 55700000
               3 TOTORLN CHAR(1),                /* RELATIVE   S22024*/ 55750000
                                                 /* LINE NO    S22024*/ 55800000
               3 TOTORTCD CHAR(1),               /* RETURN CODES22024*/ 55850000
               3 TOTOECBA CHAR(4),               /* ECB ADDR   S22024*/ 55900000
                 4 TOTOFLG CHAR(1),              /* FLAG BYTE           55950000
                                                             @YM08136*/ 56000000
                   5 TOTOATTC BIT(1),            /* USE ALTERNATE TTCIN 56050000
                                                             @YM08136*/ 56100000
                   5 *        BIT(7),            /* UNUSED   @YM08136*/ 56150000
                 4 *       CHAR(3),              /* UNUSED   @YM08136*/ 56200000
               3 TOTOLADR CHAR(8),               /* TERM NAME  S22024*/ 56250000
                                                 /* OR LINE    S22024*/ 56300000
                                                 /* ADDRESS    S22024*/ 56350000
             2 TOTOALTT FIXED(16),               /* ALTERNATE TTCIN     56400000
                                                             @YM08136*/ 56450000
             2 * CHAR (38),                      /* UNUSED   @YM08136*/ 56500000
             2 TOTOPCLN PTR(31),                 /* OP CONTROL S22024*/ 56550000
                                                 /* ECB ADDRESSS22024*/ 56600000
                                                 /* FOR CLEANUPS22024*/ 56650000
             2 TOTUSCOR PTR (31),                /* CORE IN USES22024*/ 56700000
 /*                                                                   */56750000
 /*            ALTERNATE PRINTER ENTRY                                */56800000
 /*                                                                   */56850000
             2 TOTAPENT BDY(WORD),                /* ALTERNATE PRINTER*/56900000
                                                  /*  ENTRY           */56950000
               3 TOTAPUCB FIXED(16),              /* A.P. UCB ADDRESS */57000000
               3 TOTAPOFF FIXED(16),              /* OFFSET TO A.P.   */57050000
                                                  /*  TNT ENTRY       */57100000
                                                  /* (DUMMY)  @Y17XAXU*/57150000
               3 TOTAROFF FIXED(16),              /* OFFSET TO A.P.   */57200000
                                                  /* TNT ENTRY        */57250000
                                                  /* (REAL)   @Y17XAXU*/57300000
               3 TOTARSID FIXED(16),              /* NETWORK ADDRESS  */57350000
                                                  /* OF A.P.  @Y17XAXU*/57400000
               3 TOTAPRLN CHAR(1),                /* A.P. RELATIVE    */57450000
                                                  /*  LINE NUMBER     */57500000
               3 TOTAPLCB PTR(24),                /* A.P. LCB ADDRESS */57550000
               3 TOTAPTNT PTR(31),                /* A.P. TERMINAL    */57600000
                                                  /*  NAME TABLE ENTRY*/57650000
                                                  /* ADDRESS (DUMMY)  */57700000
               3 TOTARTNT PTR(31),                /* AP TNT ADDRESS   */57750000
                                                  /* (REAL ENTRY)     */57800000
               3 TOTAPTLN FIXED(15),              /* LENGTH OF AP TTE */57850000
                                                  /* AREA             */57900000
               3 TOTAPFLG CHAR (1),               /* A.P FLAGS S22024*/ 57950000
                 4 TOTAPASN BIT(1),               /* X'80'-   S22024*/  58000000
                                                  /* DUMMY EN-S22024*/  58050000
                                                  /* TRY ASGN.S22024*/  58100000
                 4 TOTAPORN BIT (1),              /* X'40'- APS22024*/  58150000
                                                  /* ON 3705  S22024*/  58200000
                 4 * BIT(5),                     /* RESERVED @Y17XAXU*/ 58250000
                 4 TOTAPSWD BIT(1),              /* X'01' DIAL S22024*/ 58300000
       3 TOTAPEND CHAR(0),     /* END OF BASIC A.P. AREA  @Y17XAX6*/    58350000
                 3 TOTAPRNL CHAR (8),            /*GROUP NAME S05331*/  58400000
                                                 /* OF AP LINE S05331*/ 58450000
               2 TOTAPDFL CHAR (1),              /* ALTERNATE PRINTER*/ 58500000
                                                 /* INITIAL CONDITIONS*/58550000
               3 TOTAPTER BIT (1),               /* X'80'-TERMINAL    */58600000
                                                 /* DEVICE FLAG       */58650000
               3 TOTAPLIN BIT (1),               /* X'40'-LINE ADDRESS*/58700000
                                                 /* FLAG              */58750000
               3 * BIT (1),                      /* UNUSED            */58800000
               3 TOTAPGP BIT (1),                /* X'10'-GENERAL POLL*/58850000
                                                 /* INITIALLY ACTIVE  */58900000
                                                 /* ON TEST LINE      */58950000
               3 TOTAPLST BIT (1),               /* X'08'-AP INITIALLY*/59000000
                                                 /* STOPPED           */59050000
               3 TOTAPHD BIT (1),                /* X'04'-AP INITIALLY*/59100000
                                                 /* HELD              */59150000
               3 TOTAPIAC BIT (1),               /* X'02'-AP INVITA-  */59200000
                                                 /* TION LIST ENTRY   */59250000
                                                 /* INITIALLY INACTIVE*/59300000
               3 * BIT (1),                      /* UNUSED            */59350000
             2 * FIXED(31),                      /* UNUSED    @ZM47554*/59370010
             2 TOTAPDCB PTR (31),                 /* LOCAL      S22024*/59600000
                                                  /* PRINTER    S22024*/59650000
                                                  /* DCB ADDRESSS22024*/59700000
             2 TOTPDECB CHAR(20) BDY(WORD),       /* LOCAL PRINTER    */59750000
                                                  /*  DECB            */59800000
             2 TOTPARML PTR (31),                /* ADDR OF   SA41612*/ 59850000
                                                 /* PARM LIST SA41612*/ 59900000
                                                 /* FOR MACRO SA41612*/ 59950000
                                                 /* CALL      SA41612*/ 60000000
             2 TOTOLTMQ PTR(31),                  /* SUBTASK MESSAGE  */60050000
                                                  /*  QUEVE           */60100000
             2 TOTOTECB CHAR(4) BDY(WORD),        /* TOTE SUBTASK ECB */60150000
             2 TOTRESSV PTR(31),                  /* POINTER TO MOTHER*/60200000
                                                  /*  TASK SAVE AREA  */60250000
             2 TOTTCBAD PTR(31),                  /* SUBTASK TCB ADDR */60300000
             2 TOTCMPCD CHAR(4),                  /* SUBTASK          */60350000
                                                  /*  COMPLETION CODE */60400000
             2 TOTOLTPL BDY(WORD),                /* OLT INPUT        */60450000
                                                  /*  PARAMETER LIST  */60500000
               3 * CHAR (8),                     /* UNUSED            */60550000
               3 TOT#TBLE PTR(31),     /* BRANCH TABLE ADDR  @Y17XAX6*/ 60600000
             2 TOTWTORP BDY(WORD),                /* WTOR PARAMETER   */60650000
                                                  /*  LIST FOR        */60700000
                                                  /*  OPERATOR        */60750000
                                                  /*  COMMUNICATION   */60800000
               3 TOTINCNT PTR(8),                 /* REPLY BYTE COUNT */60850000
               3 TOTINADR PTR(24),                /* REPLY BUFFER ADDR*/60900000
               3 TOTINECB PTR(31),                /* REPLY ECB ADDRESS*/60950000
             2 TOTWTOPL BDY(WORD),                /* WTO & WTOR PARM  */61000000
                                                  /*  LIST FOR        */61050000
                                                  /*  OPERATOR        */61100000
                                                  /*  COMMUNICATION   */61150000
               3 * CHAR (1),                     /* UNUSED            */61200000
               3 TOTOTCNT PTR(8),                 /* OUT MESSAGE COUNT*/61250000
               3 * CHAR (2),                     /* UNUSED            */61300000
               3 TOTOTBUF CHAR (84),             /* OUTPUT AREA       */61350000
                                                  /*  BUFFER          */61400000
               3 TOTINBUF CHAR(80),               /* REPLY BUFFER     */61450000
             2 TOTOLTID CHAR(2) BDY(HWORD),       /* TOTE OLT         */61500000
                                                  /*  IDENTIFICATION  */61550000
             2 TOTRTCOD CHAR(1),                  /* SERVICE MODULE   */61600000
                                                  /*  RETURN CODE     */61650000
             2 * CHAR(1),                         /* UNUSED           */61700000
             2 TOTPLNKQ BDY(WORD),                /* PLINK MODULE     */61750000
                                                  /*  QUEUE           */61800000
               3 TOTPLFWD PTR(31),                /* QUEUE FORWARD    */61850000
                                                  /*  POINTER         */61900000
               3 TOTPLBKW PTR(31),                /* QUEUE BACKWARD   */61950000
                                                  /*  POINTER         */62000000
      2 * CHAR(4),      /* RESERVED    @Y17XAX6*/                       62050000
             2 TOTWKSPC CHAR(128) BDY(DWORD),     /* TOTE WORK AREA   */62100000
     2 TOTWKEND CHAR(0),  /* WORK SPACE END  @Y17XAX6*/                 62150000
             2 * CHAR (20),                       /* UNUSED           */62200000
             2 TOTAVTPT PTR (31),                 /* ADDRESS OF AVT   */62250000
             2 TOTSTAE PTR (31),                  /* ADDRESS OF S22024*/62300000
                                                  /* STAE EXIT  S22024*/62350000
                                                  /* ROUTINE    S22024*/62400000
             2 TOTRESPL PTR(31),                  /* ADDRESS OF TOTE  */62450000
                                                  /*  RESIDENT        */62500000
                                                  /*  PARAMETER LIST  */62550000
             2 TOTFLG01 CHAR(1) ABNL,             /* TOTE 1ST FLAG    */62600010
                                                  /*  BYTE   @G36XRXV */62650010
               3 TOTFINAL BIT (1),               /* FINAL MSG  S05331*/ 62700000
                                                 /* INDICATOR  S05331*/ 62750000
               3 TOTCONFG BIT (1),                /* X'40'-CONFIGURA-*/ 62800000
                                                  /* RUN             */ 62850000
               3 TOTIPLCU BIT (1),               /* X'20'-FORCES05331*/ 62900000
                                                 /* CLEANUP    S05331*/ 62950000
                                                 /* FROM IPL   S05331*/ 63000000
               3 TOTEXIT BIT(1),                 /*X'10'- IEDQWO     */ 63050000
                                                 /* CONTROL FLOW      */63100000
                                                 /* FLAG      @Y17XAXU*/63150000
               3 TOTAPTST BIT(1),        /* AP ON TEST LINE   @Y17XAXU*/63200000
               3 TOTPRMPT BIT (1),                /* X'04'-     S22024*/63250000
                                                  /* PROMPTER   S22024*/63300000
                                                  /* RUN        S22024*/63350000
               3 TOTCLNST BIT(1) ABNL, /*CLEANUP STARTED      @G36XRXV*/63400010
               3 TOTCLNED BIT(1),   /* CLEANUP ENDED          @YM08158*/63450000
             2 TOTFLG02 CHAR(1),                  /* TOTE 2ND FLAG    */63500000
                                                  /*  BYTE            */63550000
                 3 TOTTTSPE BIT(1),      /* TEST SESSION      @Y17XAXU*/63600000
                                         /* PEND END          @Y17XAXU*/63650000
                 3 TOTTSST BIT(1),       /* CT/AP IN TEST MODE@Y17XAXU*/63700000
                 3 TOTDEV0X BIT(1),               /* X'20'-TESTS22024*/ 63750000
                                                  /* DEVICE ON S22024*/ 63800000
                                                  /* 270X      S22024*/ 63850000
               3 TOTOLTRQ BIT(1),                 /* X'10'-ON- S22024*/ 63900000
                                                  /* LINE TEST S22024*/ 63950000
                                                  /* REQUEST   S22024*/ 64000000
                                                  /* FLAG      S22024*/ 64050000
               3 TOTCHKSZ BIT(1),                 /* X'08'- UPDATE    */64100000
                                                  /*  SUBTASK STORAGE */64150000
                                                  /*  ALLOCATION FLAG */64200000
               3 TOTCONMD BIT (1),                /* X'04'-GETSA41597*/ 64250000
                                                  /* CONC MOD SA41597*/ 64300000
                                                  /* FOR INIT SA41597*/ 64350000
                                                  /* STATUS   SA41597*/ 64400000
                                                  /* SET UP   SA41597*/ 64450000
               3 TOTCONCU BIT(1),                 /* X'02'CONCSA41597*/ 64500000
                                                  /* CLEANUP  SA41597*/ 64550000
                                                  /* REQUIRED SA41597*/ 64600000
               3 TOTDEVRN BIT(1),                 /* X'01-TEST S22024*/ 64650000
                                                  /* DEVICE ON S22024*/ 64700000
                                                  /* 3705      S22024*/ 64750000
             2 TOTFLG03 CHAR(1),                  /* TOTE 3RD FLAG    */64800000
                                                  /*  BYTE            */64850000
               3 TOTAPOER BIT(1),                 /* X'80'- ALTERNATE */64900000
                                                  /*  PRINTER OPTION  */64950000
                                                  /*  ERROR FLAG      */65000000
               3 TOTTDFER BIT(1),                 /* X'40'- TEST      */65050000
                                                  /*  DEVICE FIELD    */65100000
                                                  /*  ERROR FLAG      */65150000
               3 TOTTSTER BIT(1),                 /* X'20'- TEST ID   */65200000
                                                  /*  FIELD ERROR FLAG*/65250000
               3 TOTOPTER BIT(1),                 /* X'10'- OPTION    */65300000
                                                  /*  FIELD ERROR FLAG*/65350000
               3 TOTIMNCP BIT(1),                 /* X'08'- TEMPORARY */65400000
                                                  /*  NO CONTROL PRINT*/65450000
                                                  /*  FLAG            */65500000
               3 TOTTSINC BIT(1),                 /* X'04'- INCLUSIVE */65550000
                                                  /*  TEST ID ENTRY   */65600000
                                                  /*  FLAG            */65650000
               3 TOTREPEX BIT(1),                /* X'02'-    SA41613*/ 65700000
                                                 /* REPLY     SA41613*/ 65750000
                                                 /* EXPECTED  SA41613*/ 65800000
                                                 /* FLAG      SA41613*/ 65850000
               3 * BIT (1),                      /* UNUSED     S22024*/ 65900000
             2 TOTFLG04 CHAR(1),                  /* TOTE 4TH FLAG    */65950000
                                                  /*  BYTE            */66000000
               3 TOTNUMDV BIT(1),                 /* X'80'- NUMERIC   */66050000
                                                  /*  TRM ENTRY FLAG  */66100000
               3 TOTDTCHD BIT(1),                 /* X'40'- SUBTASK   */66150000
                                                  /*  ALREADY DETACHED*/66200000
                                                  /*  FLAG            */66250000
               3 TOTCLOSE BIT(1),                 /* X'20'- TCAM      */66300000
                                                  /*  CLOSEDOWN IN    */66350000
                                                  /*  PROGRESS FLAG   */66400000
               3 TOTPRCTF BIT (1),/*PRIMARY TEST DEVICE COUNTERFEIT     66450000
                                                            @YM08407*/  66500000
               3 TOTSCCTF BIT (1),/* SECONDARY TEST DEVICE COUNTERFEIT  66550000
                                                            @YM08407*/  66600000
               3 * BIT (1),                      /* UNUSED     S22024*/ 66650000
               3 * BIT (1),                      /* UNUSED     S22024*/ 66700000
               3 TOTTTSWT BIT(1),                 /* X'01'- TEST      */66750000
                                                  /*  TERMINAL LINE   */66800000
                                                  /*  SWITCHED FLAG   */66850000
             2 TOTFLG05 CHAR(1),                  /* TOTE 5TH FLAG    */66900000
                                                  /*  BYTE            */66950000
               3 TOTPRINT BIT(1),                 /* X'80'- ACCESS    */67000000
                                                  /*  METHOD PRINT    */67050000
                                                  /*  FLAG            */67100000
               3 TOTCECOM BIT(1),                 /* X'40'- ACCESS    */67150000
                                                  /*  METHOD CECOM    */67200000
                                                  /*  FLAG            */67250000
               3 TOTREPLY BIT(1),                 /* X'20'- ACCESS    */67300000
                                                  /*  METHOD CECOM    */67350000
                                                  /*  WITH REPLY FLAG */67400000
               3 TOTSRCE BIT(1),     /* SEND MSG TO SOURCE   @Y17XAXU*/ 67450000
               3 TOTSRCON BIT(1),    /* TRM ENTERED FROM SRC @Y17XAXU*/ 67500000
               3 TOTTMOUT BIT(1),                 /* X'04'- WAIT      */67550000
                                                  /*  TIMEOUT FLAG    */67600000
               3 TOTEXIOF BIT(1),                 /* X'02'- ACCESS    */67650000
                                                  /*  METHOD EXIO FLAG*/67700000
               3 TOTNDMSG BIT(1),                 /* X'01'- SEND      */67750000
                                                  /*  CANCEL OR       */67800000
                                                  /*  TERMINATE       */67850000
                                                  /*  MESSAGE FLAG    */67900000
             2 TOTFLG06 CHAR(1),                  /* TOTE 6TH FLAG    */67950000
                                                  /*  BYTE            */68000000
               3 TOTOTERM BIT(1),                 /* X'80'-SECTION    */68050000
                                                  /*  TERMINATE FLAG  */68100000
               3 TOTCBOPN BIT(1),                 /* X'40'-CANCEL     */68150000
                                                  /* BEFORE OPEN      */68200000
               3 TOTWACAN BIT(1),                 /* X'20'-CANCEL     */68250000
                                                  /* REQUEST PENDING  */68300000
               3 TOTNCMFG BIT(1),                 /* X'10'-NON-CONCUR-*/68350000
                                                  /*  RENT MODE FLAG  */68400000
               3 TOTABEND BIT(1),                 /* X'08'- OLT HAS   */68450000
                                                  /*  ABENDED FLAG    */68500000
               3 TOTCANCL BIT(1),                 /* X'04'- CANCEL    */68550000
                                                  /*  TESTING FLAG    */68600000
               3 TOTOTACT BIT(1),                 /* X'02'- OLT ACTIVE*/68650000
                                                  /*  FLAG            */68700000
               3 TOTNPERR BIT(1),                 /* X'01'- NO PERMA- */68750000
                                                  /*  NENT ERROR FLAG */68800000
             2 TOTFLG07 CHAR(1),                  /* TOTE 7TH FLAG    */68850000
                                                  /*  BYTE            */68900000
               3 TOTPRIEX BIT(1),                 /* X'80'- PRIMARY   */68950000
                                                  /*  DEVICE FOR      */69000000
                                                  /*  EXIO/WAITIO FLAG*/69050000
               3 TOTSECEX BIT(1),                 /* X'40'- SECONDARY */69100000
                                                  /*  DEVICE FOR      */69150000
                                                  /*  EXIO/WAITIO FLAG*/69200000
               3 * BIT (1),                      /* UNUSED     S22024*/ 69250000
               3 * BIT (1),                      /* UNUSED            */69300000
               3 TOTMSCEC BIT(1),                 /* X'08'- TOTE      */69350000
                                                  /*  MESSAGE SOURCE  */69400000
                                                  /*  FLAG - CECOM    */69450000
               3 TOTMSREP BIT(1),                 /* X'04'- TOTE      */69500000
                                                  /*  MESSAGE SOURCE  */69550000
                                                  /* 'FLAG - CECOM    */69600000
               3 TOTMSPRT BIT(1),                 /* X'02'- TOTE      */69650000
                                                  /*  MESSAGE SOURCE  */69700000
                                                  /*  FLAG - CECOM    */69750000
               3 TOTMSSRC BIT(1), /* TOTE MESSAGE SOURCE FLAG @Y17XAX6*/69800000
             2 TOTFLG08 CHAR(1),                  /* TOTE 8TH FLAG    */69850000
                                                  /*  BYTE            */69900000
               3 TOTFMCTL BIT(4),                 /* BITS 0-3 ARE     */69950000
                                                  /*  DPRINT FORMS    */70000000
                                                  /*  CONTROL FLAGS   */70050000
               3 * BIT(4),                        /* BITS 4-7 ARE     */70100000
                                                  /*  DPRINT LEVEL    */70150000
                                                  /*  CONTROL FLAGS   */70200000
             2 TOTFLG09 CHAR(1),                  /* TOTE 9TH FLAG    */70250000
                                                  /*  BYTE            */70300000
               3 TOTAPCON BIT(1),                 /* X'80'- PRINTER = */70350000
                                                  /*  SYSTEM CONSOLE  */70400000
                                                  /*  FLAG            */70450000
               3 TOTAPOUT BIT(1),                 /* X'40'- PRINTER = */70500000
                                                  /*  SYSTEM PRINTER  */70550000
                                                  /*  FLAG            */70600000
               3 TOTCTCON BIT(1),                 /* X'20'- CONTROL   */70650000
                                                  /*  TERMINAL = SYS  */70700000
                                                  /*  CONSOLE FLAG    */70750000
               3 TOTAPTRM BIT(1),                 /* X'10'- PRINTER = */70800000
                                                  /*  TERMINAL FLAG   */70850000
               3 TOTNOBRK BIT (1),               /* X'08' - NO S22024*/ 70900000
                                                 /* BREAK OPT  S22024*/ 70950000
               3 TOTLNCON BIT (1),               /* X'04'-LINE S22024*/ 71000000
                                                 /* CONN DONE  S22024*/ 71050000
               3 TOTPRECT BIT(1),                 /* X'02'- NO        */71100000
                                                  /*  ALTERNATE       */71150000
                                                  /*  PRINTER FLAG    */71200000
               3 TOTMACFT BIT(1),                 /* X'01'-UN- S22024*/ 71250000
                                                  /* SUPPORTED S22024*/ 71300000
                                                  /* MACRO     S22024*/ 71350000
                                                  /* FUNCTION  S22024*/ 71400000
             2 TOTFLG10 CHAR(1),                  /* TOTE 10TH FLAG   */71450000
                                                  /*  BYTE            */71500000
               3 TOTTERMS BIT(1),                 /* X'80'- TEST      */71550000
                                                  /*  DEVICES=TERMINAL*/71600000
                                                  /*  FLAG            */71650000
               3 * BIT (1),                      /* UNUSED     S22024*/ 71700000
               3 * BIT (1),                      /* UNUSED     S22024*/ 71750000
               3 * BIT (1),                      /* UNUSED    S22024*/  71800000
               3 TOTTNTRQ BIT(1),                 /* X'08'- DUMMY TNT */71850000
                                                  /*  ENTRY REQUEST   */71900000
                                                  /*  FLAG            */71950000
               3 TOTOLTED BIT(1),                 /* X'04'- ON-LINE   */72000000
                                                  /*  TEST ENDED FLAG */72050000
               3 TOTOLTWT BIT(1),                 /* X'02'- ON-LINE   */72100000
                                                  /*  TEST WAITING    */72150000
                                                  /*  FLAG            */72200000
               3 TOTOLTRS BIT(1),                 /* X'01'- ON-LINE   */72250000
                                                  /*  TEST RESTART    */72300000
                                                  /*  FLAG            */72350000
             2 TOTTTBEL PTR(8),                  /* TERMINAL NAME     */72400000
                                                  /*  TABLE ENTRY NAME*/72450000
                                                  /*  LENGTH          */72500000
             2 * CHAR (1),                       /* RESERVED          */72550000
 %IF CONFG='YES'  %THEN                                                 72600000
    %GOTO CNFBYP;                                                       72650000
             2 TOTEXT CHAR(56) BDY(WORD),         /* EXTERNAL DATA    */72700000
                                                  /*  BUFFER          */72750000
             2 TOTPASS CHAR(64) BDY (WORD),       /* PASSON DATA      */72800000
                                                  /*  BUFFER          */72850000
             2 TOTPRECB CHAR(4),                  /* PRIMARY ECB      */72900000
               3 TOTPRIBK CHAR(4),                /* PRIMARY TEST     */72950000
                                                  /* DEVICE I/O       */73000000
                                                  /*  CONTROL BLOCKS  */73050000
                 4 TOTTRMBF CHAR(4),              /* TRM BUFFER FOR   */73100000
                                         /*  TRM ANALYSIS  @Y17XAX6*/   73150000
 /*                                                                   */73200000
 /*            PRIMARY TEST DEVICE ENTRY                              */73250000
 /*                                                                   */73300000
             2 TOTPRENT BDY(WORD),                /* TOTE PRIMARY TEST*/73350000
                                                  /*  DEVICE ENTRY    */73400000
               3 TOTPRUCB FIXED(16),              /* PRIMARY DEVICE   */73450000
                                                  /*  UCB ADDRESS     */73500000
               3 TOTPCOFF FIXED(16),              /* OFFSET TO SECOND */73550000
                                                  /* TNT ENTRY        */73600000
                                                  /* (DUMMY)  @Y17XAXU*/73650000
               3 TOTPROFF FIXED(16),              /* OFFSET TO PRIMARY*/73700000
                                                  /*  TNT ENTRY       */73750000
                                                  /* (REAL)   @Y17XAXU*/73800000
               3 TOTPRSID FIXED(16),              /* NETWORK ADDRESS  */73850000
                                                  /* OF PRI   @Y17XAXU*/73900000
               3 TOTPRRLN CHAR(1),                /* PRIMARY DEVICE   */73950000
                                                  /*  RELATIVE LINE   */74000000
                                                  /*  NUMBER          */74050000
               3 TOTPRLCB PTR(24),                /* 3705 LCB @Y17XAX6*/74100000
                                                  /* ADDRESS  @Y17XAXU*/74150000
               3 TOTPDTNT PTR(31),                /* PRIMARY TNT      */74200000
                                                  /* ADDRESS          */74250000
                                                  /* (DUMMY)  @Y17XAXU*/74300000
               3 TOTTNTPR PTR(31),                /* PRIMARY TERMINAL */74350000
                                                  /* TNT ADDRESS -REAL*/74400000
               3 TOTPRLEN FIXED(15),              /* PRIMARY TTE AREA */74450000
                                                  /* LENGTH   @Y17XAXU*/74500000
               3 TOTPRFLG CHAR(1),                /* PRIMARY          */74550000
                                                  /* FLAGS    @Y17XAXU*/74600000
                4 TOTPRTAS BIT(1),                /* PRIMARY TNT      */74650000
                                                  /* ASSIGNED @Y17XAXU*/74700000
                4 TOTPRLU BIT(1),                 /* LU TERM  @Y17XAXU*/74750000
       4 TOTPPRSC BIT(1),  /* ON=PRIMARY, OFF=SECONDARY @Y17XAX6*/      74800000
    4 TOTPUNRD BIT(1),  /* ON=UNREAD DATA, OFF=NO UNREAD DATA @Y17XAX6*/74850000
   4 TOTPREX BIT(1),  /* EXCEPTION RESPONSE  @Y17XAX6*/                 74900000
   4 TOTPRFME BIT(1),  /* DEFINITE RESPONSE  @Y17XAX6*/                 74950000
   4 TOTPEXNM BIT(1), /* ON=EXPEDITED, OFF=NORMAL  @Y17XAX6*/           75000000
                4 * BIT(1),                       /* RESERVED @Y17XAX6*/75050000
               3 * CHAR(1),                       /* RESERVED @Y17XAXU*/75100000
               3 TOTPRQCB PTR (31),               /* PRIMARY QCBS22024*/75150000
                                                  /* ADDRESS    S22024*/75200000
               3 TOTPRCCW PTR (31),               /* ADDRESS OF S22024*/75250000
                                                  /* READ CCW   S22024*/75300000
                                                  /* FOR PRIMARYS22024*/75350000
                                                  /* TEST DEVICES22024*/75400000
               3 TOTPRBUF PTR (31),               /* ADDRESS OF S22024*/75450000
                                                  /* BUFFER CON-S22024*/75500000
                                                  /* TAINING    S22024*/75550000
                                                  /* READ DATA  S22024*/75600000
                                                  /* FOR PRIMARYS22024*/75650000
                                                  /* TTE AREA         */75700000
 /*                                                                   */75750000
     /* PRIMARY DEVICE DATA BLOCKING FIELD                            */75800000
 /*                                                                   */75850000
             2 TOTPDTBF POINTER (31),             /* RESPONSE BUFFER  */75900000
                                                  /*  ADDRESS         */75950000
             2 TOTPDTCT FIXED (15),               /* RESPONSE BUFFER  */76000000
                                                  /*  SIZE            */76050000
             2 TOTPFLGS CHAR (1),                 /* FLAGS            */76100000
             2 * CHAR (1),                        /* UNUSED  @ZM47554 */76150010
             2 TOTPRSN CHAR(4) BDY(WORD),         /* PRIMARY SEQ      */76155010
                                                  /* NUMBER FIELD     */76160010
                                                  /*         @ZM47554 */76165010
               3 * CHAR(2),                       /* FLAGS   @ZM47554 */76170010
               3 TOTPRSEQ FIXED(16),              /* SEQUENCE NUMBER  */76175010
                                                  /* (IN SNA TH )     */76180010
                                                  /*         @ZM47554 */76185010
             2 TOTPTECB PTR(31),                  /* PRIMARY TECB ADDR*/76200000
             2 TOTPRIOB CHAR (44),                /* PRIMARY   S22024*/ 76250000
                                                  /* IOB       S22024*/ 76300000
             2 TOTPRDCB CHAR (72) BDY(WORD), /* PRIMARY DCB @Y17XAX6*/  76350000
               3 * CHAR (44),                     /* UNUSED    S22024*/ 76400000
               3 TOTPRDEB PTR (31),               /* PRIMARY   S22024*/ 76450000
                                                  /* DEB ADDR  S22024*/ 76500000
             2 TOTSCECB CHAR(4),                  /* SECONDARY ECB    */76550000
               3 TOTSCIBK CHAR(4),                /* SECONDARY TEST   */76600000
                                                  /* DEVICE I/O       */76650000
                                                  /*  CONTROL BLOCKS  */76700000
 /*                                                                   */76750000
 /*            SECONDARY TEST DEVICE ENTRY                            */76800000
 /*                                                                   */76850000
             2 TOTSCENT BDY(WORD),                /* TOTE SECONDARY   */76900000
                                                  /*  TEST DEVICE     */76950000
                                                  /*  ENTRY           */77000000
               3 TOTSCUCB FIXED(16),              /* SECONDARY DEVICE */77050000
                                                  /*  UCB ADDRESS     */77100000
               3 TOTNCOFF FIXED(16),              /* OFFSET TO        */77150000
                                                  /* SECONDARY TNT    */77200000
                                                  /* ENTRY            */77250000
                                                  /* (DUMMY)  @Y17XAXU*/77300000
               3 TOTSCOFF FIXED(16),              /* OFFSET TO        */77350000
                                                  /*  SECONDARY TNT   */77400000
                                                  /*  ENTRY           */77450000
                                                  /* (REAL)   @Y17XAXU*/77500000
               3 TOTSRSID FIXED(16),              /* NETWORK ADDRESS  */77550000
                                                  /* OF SEC   @Y17XAXU*/77600000
               3 TOTSCRLN CHAR(1),                /* SECONDARY DEVICE */77650000
                                                  /*  RELATIVE LINE   */77700000
                                                  /*  NUMBER          */77750000
               3 TOTSCLCB PTR(24),                /* 3705 LCB @Y17XAX6*/77800000
                                                  /* ADDRESS  @Y17XAXU*/77850000
               3 TOTSDTNT PTR(31),                /* SECONDARY        */77900000
                                                  /* TNT ENTRY        */77950000
                                                  /* ADDRESS  @Y17XAXU*/78000000
                                                  /* (DUMMY)  @Y17XAXU*/78050000
               3 TOTSRTNT PTR(31),                /* SECONDARY        */78100000
                                                  /* TERMINAL TNT ADDR*/78150000
                                                  /* (REAL ENTRY)     */78200000
               3 TOTSCLEN FIXED(15),              /* SECONDARY TTE    */78250000
                                                  /* AREA LEN @Y17XAXU*/78300000
               3 TOTSCFLG CHAR(1),                /* SECONDARY        */78350000
                                                  /* FLAGS    @Y17XAXU*/78400000
                4 TOTSCTAS BIT(1),                /* SECONDARY TNT    */78450000
                                                  /* ASSIGNED @Y17XAXU*/78500000
                4 TOTSCLU BIT(1),                 /* LU TERM  @Y17XAXU*/78550000
  4 TOTSPRSC BIT(1),  /* ON=PRIMARY, OFF=SECONDARY  @Y17XAX6*/          78600000
  4 TOTSUNRD BIT(1),  /* ON=UNREAD DATA, OFF=NO UNREAD DATA @Y17XAX6*/  78650000
  4 TOTSCEX BIT(1), /* EXCEPTION RESPONSE @Y17XAX6*/                    78700000
  4 TOTSCFME BIT(1), /* DEFINITE RESPONSE  @Y17XAX6*/                   78750000
  4 TOTSEXNM BIT(1), /* ON=EXPEDITED, OFF=NORMAL  @Y17XAX6*/            78800000
                4 * BIT(1),                       /* RESERVED @Y17XAX6*/78850000
               3 * CHAR(1),                       /* RESERVED @Y17XAXU*/78900000
               3 TOTSCQCB PTR (31),               /* SECONDARY  S22024*/78950000
                                                  /* QCB ADDRESSS22024*/79000000
               3 TOTSCCCW PTR (31),               /* ADDRESS OF S22024*/79050000
                                                  /* READ CCW   S22024*/79100000
                                                  /* FOR SECON- S22024*/79150000
                                                  /* DARY TEST  S22024*/79200000
                                                  /* DEVICE     S22024*/79250000
               3 TOTSCBUF PTR(31),                /* ADDRESS OF S22024*/79300000
                                                  /* BUFFER CON-S22024*/79350000
                                                  /* TAINING    S22024*/79400000
                                                  /* READ DATA  S22024*/79450000
                                                  /* FOR SECON- S22024*/79500000
                                                  /* DARY TEST  S22024*/79550000
                                                  /* DEVICE     S22024*/79600000
 /*                                                                   */79650000
     /* SECONDARY DEVICE DATA BLOCKING FIELD                          */79700000
 /*                                                                   */79750000
             2 TOTSDTBF POINTER (31),             /* RESPONSE BUFFER  */79800000
                                                  /* ADDRESS          */79850000
             2 TOTSDTCT FIXED (15),               /* RESPONSE BUFFER  */79900000
                                                  /*  SIZE            */79950000
             2 TOTSFLGS CHAR (1),                 /* FLAGS            */80000000
             2 * CHAR (1),                        /* UNUSED  @ZM47554 */80050010
             2 TOTSCSN CHAR(4) BDY(WORD),         /* SECONDARY SEQ    */80055010
                                                  /* NUMBER FIELD     */80060010
                                                  /*         @ZM47554 */80065010
               3 * CHAR(2),                       /* FLAGS   @ZM47554 */80070010
               3 TOTSCSEQ FIXED(16),              /* SEQUENCE NUMBER  */80075010
                                                  /* (IN SNA TH )     */80080010
                                                  /*         @ZM47554 */80085010
             2 TOTSTECB CHAR(4),                  /* SECONDARY TECB   */80100000
                                                  /*  ADDRESS         */80150000
             2 TOTSCIOB CHAR (44),                /* SECONDARY S22024*/ 80200000
                                                  /* IOB       S22024*/ 80250000
        2 TOTSCDCB CHAR (72) BDY(WORD), /* SECONDARY DCB   @Y17XAX6*/   80300000
                                                  /* DCB       S22024*/ 80350000
               3 * CHAR (44),                     /* UNUSED    S22024*/ 80400000
               3 TOTSCDEB PTR (31),               /* SECONDARY S22024*/ 80450000
                                                  /* DEB ADDR  S22024*/ 80500000
             2 TOTCROLT CHAR (8),                 /* CURRENT   S22024*/ 80550000
                                                  /* OLT ID    S22024*/ 80600000
               3 TOTTRMND CHAR (1),               /* END OF    S22024*/ 80650000
                                                  /* TRM BUFFERS22024*/ 80700000
             2 TOTOLTTB (10) CHAR(3),             /* OLT ID    S22024*/ 80750000
                                                  /* TABLE     S22024*/ 80800000
             2 TOTOLTTE CHAR (0),        /* END OF TABLE @Y17XAX6*/     80850000
           2 TOTCONTB (10) CHAR (1),              /* CONC INITSA41597*/ 80900000
                                                  /* STAT TBL SA41597*/ 80950000
           2 TOTCONCT CHAR (1),                   /* CONC STATSA41597*/ 81000000
                                                  /* FOR CT   SA41597*/ 81050000
           2 TOTCONAP CHAR (1),                   /* CONC STATSA41597*/ 81100000
                                                  /* FOR AP   SA41597*/ 81150000
           2 TOTCONND CHAR (0),        /* END OF TABLE  @Y17XAX6*/      81200000
             2 * CHAR (38),                       /* UNUSED   SA41597*/ 81250000
             2 TOTTDTBL (10) CHAR(4),             /* TOTE TEST DEVICE */81300000
                                                  /*  TABLE           */81350000
               3 * CHAR(1),                                             81400000
                 4 TOTTDTRM BIT(1),               /* X'80'- TERMINAL  */81450000
                                                  /*  DEVICE FLAG     */81500000
                 4 TOTTDLIN BIT(1),               /* X'40' - LINE ADDR*/81550000
                                                  /*  FLAG            */81600000
                 4 TOTTDGRB BIT(1),               /* X'20'-TEST DEVICE*/81650000
                                                  /* GRABBED FLAG     */81700000
                 4 TOTTDORN BIT(1),               /* X'10'-TEST S22024*/81750000
                                                  /* DEVICE ON  S22024*/81800000
                                                  /* A 3705     S22024*/81850000
                 4 TOTTDLST BIT(1),               /* X'08' - TEST     */81900000
                                                  /*  DEVICE INITIALLY*/81950000
                                                  /*  STOPPED         */82000000
                 4 TOTTDTHD BIT(1),               /* X'04' - TEST     */82050000
                                                  /*  DEVICE INITIALLY*/82100000
                                                  /*  HELD            */82150000
                 4 TOTTDIAC BIT(1),               /* X'02' - TEST     */82200000
                                                  /*  DEVICE INVITA-  */82250000
                                                  /*  TION LIST ENTRY */82300000
                                                  /*  INITIALLY       */82350000
                                                  /*  INACTIVE        */82400000
                 4 TOTTSWPM BIT(1),              /*X'01'-SWITCHY06330*/ 82450000
                                                 /* HAS BEEN   Y06330*/ 82500000
                                                 /* PERFORMED  Y06330*/ 82550000
               3 * CHAR (3),                     /* SKIP   @Y17XAX6 */  82600000
               2 TOTTDEND CHAR(0),        /* END OF TABLE  @Y17XAX6*/   82650000
 /*                                                                   */82700000
     /* WAITIO ECB LIST                                               */82750000
 /*                                                                   */82800000
             2 TOTWECBA POINTER(31),              /* POINTER TO ECB   */82850000
                                                  /* FOR TEST DEVICE  */82900000
             2 TOTECBPT POINTER (31),             /* POINTER TO       */82950000
                                                  /* SUBTASK ECB      */83000000
             2 TOTTLCNT FIXED(15),                /* TEST LOOP COUNT  */83050000
            2 * CHAR(2),  /*RESERVED  @Y17XAX6*/                        83100000
 %GOTO MEND;                                                            83150000
 %CNFBYP:   ;                                                           83200000
             2 * CHAR(4),             /* RESERVED   @Y17XAX6*/          83250000
             2 CDSREC CHAR(256) BDY(DWORD),       /* CONFIGURATOR WORK*/83300000
                                                  /*  AREA            */83350000
               3 CDSUNIT PTR(31),                 /* UNIT ADDRESS     */83400000
                 4 CDSWORK CHAR (1),                                    83450000
               3 CDSMODEL CHAR(1),                /* MODEL            */83500000
               3 CDSFEAT CHAR(1),                 /* FEATURES         */83550000
               3 CDSCLASS CHAR(1),                /* CLASS            */83600000
               3 CDSTYPE CHAR(1),                 /* TYPE DEVICE      */83650000
               3 CDSBYTES CHAR(1),                /* BYTE COUNT       */83700000
               3 CDSFLAGS CHAR(1),                /* FLAGS            */83750000
                 4 CDSFPMOD BIT(1),               /* X'80'- FILE      */83800000
                                                  /*  PROTECT MODE    */83850000
                                                  /*  FLAG            */83900000
                 4 CDSDVSHR BIT(1),               /* X'40'- DEVICE    */83950000
                                                  /*  SHARED WITH     */84000000
                                                  /*  ANOTHER SYSTEM  */84050000
                 4 CDSFEVOL BIT(1),               /* X'20'- F.E.      */84100000
                                                  /*  VOLUME MOUNTED  */84150000
                                                  /*  FLAG            */84200000
                 4 CDSEXINT BIT(1),               /* X'10'- EXTERNAL  */84250000
                                                  /*  INTERRUPT       */84300000
                                                  /*  POSSIBLE FLAG   */84350000
                 4 CDSSYMNM BIT(1),               /* X'08'- SYMBOLIC  */84400000
                                                  /*  ADDRESSING FLAG */84450000
                 4 CDSTWOCH BIT(1),               /* X'04'- TWO       */84500000
                                                  /*  CHANNEL SWITCH  */84550000
                                                  /*  FLAG            */84600000
                 4 CDSCUSYM BIT(1),               /* X'02'- CUSTOMER  */84650000
                                                  /*  ASSIGNED        */84700000
                                                  /*  SYMBOLIC NAME   */84750000
                 4 CDSLCNCT BIT(1),               /* X'01'- LINE      */84800000
                                                  /*  CONNECTION      */84850000
                                                  /*  REQUIRED        */84900000
               3 CDSSIGNL CHAR(2),                /* EXTERNAL SIGNAL  */84950000
                                                  /*  MASK            */85000000
               3 CDSNAME CHAR(8),                 /* SYMBOLIC         */85050000
                                                  /*  (ALTERNATE      */85100000
                                                  /*  MEMBER) NAME    */85150000
                 4 CDSTCU CHAR(2),                /* OR TCU FEATURES  */85200000
                 4 CDSMISC CHAR(3),               /* MISC             */85250000
                 4 CDSRMASK CHAR(3),              /* SECTION RUN MASK */85300000
               3 CDSFXARA CHAR(4),                /* EXTENDED FIXED   */85350000
                                                  /*  AREA            */85400000
                 4 CDSFXLEN CHAR(1),              /*   LENGTH         */85450000
                 4 CDSFXFLG CHAR(2),              /*   FLAGS          */85500000
                   5 CDSSETMD BIT(1),             /* X'80'- TWO BYTE  */85550000
                                                  /*  SET MODE        */85600000
                   5 CDSAUTCL BIT(1),             /* X'40'- AUTOCALL  */85650000
                                                  /*  FEATURE         */85700000
                   5 CDSMPNT BIT(1),              /* X'20'- SWITCHED  */85750000
                                                  /*  LINE            */85800000
                   5 CDSMDROP BIT(1),             /* X'10'- NON-      */85850000
                                                  /*  SWITCHED MULTI- */85900000
                                                  /*  DROP LINE       */85950000
                   5 CDSWTBSC BIT(1),             /* X'08'- BSC WORLD */86000000
                                                  /*  TRADE DATA SET  */86050000
                   5 * BIT(11),                   /* UNUSED           */86100000
                 4 CDSLNCON CHAR(1),              /* LINE CONNECTION  */86150000
                                                  /*  CMD SEQ CODE    */86200000
             2 CDSINPUT CHAR(80),                 /* INPUT TO UNIT    */86250000
                                                  /*  CONFIGURATOR    */86300000
                                                  /*  AREA            */86350000
               3 CDSTCUTY CHAR(4),                /* TCU TYPE (EBCDIC)*/86400000
                 4 CDSVAR CHAR (1),               /* CDS VARIABLE     */86450000
                                                  /*  FIELD           */86500000
               3 CDSSYMBL CHAR(8),                /* SYMBOLIC TERMINAL*/86550000
                                                  /*  NAME (EBCDIC)   */86600000
               3 CDSTERM CHAR(4),                 /* TERMINAL TYPE    */86650000
                                                  /*  (EBCDIC)        */86700000
               3 CDSADAP CHAR(1),                 /* ADAPTER TYPE     */86750000
                 4 CDSIBM3 BIT(1),                /* X'80'- IBM III   */86800000
                 4 CDSTTY1 BIT(1),                /* X'40'- TTY I     */86850000
                 4 CDSIBM2 BIT(1),                /* X'20'- IBM II    */86900000
                 4 CDSIBM1 BIT(1),                /* X'10'- IBM I     */86950000
                 4 * BIT(4),                      /* UNUSED           */87000000
               3 CDSLINE CHAR(1),                 /* LINE TYPE        */87050000
                 4 * BIT(5),                      /* UNUSED           */87100000
                 4 CDSSWAUT BIT(1),               /* X'04'- SWITCHED  */87150000
                                                  /*  WITH AUTODIAL   */87200000
                 4 CDSMP BIT(1),                  /* X'02'- LEASED    */87250000
                                                  /*  MULTIPOINT      */87300000
                 4 CDSPTP BIT(1),                 /* X'01'- LEASED    */87350000
                                                  /*  POINT TO POINT  */87400000
               3 CDSCONN CHAR(1),                 /* LINE CONNECTION  */87450000
                                                  /*  CODE            */87500000
                 4 * BIT(5),                      /* UNUSED           */87550000
                 4 CDSDSAD0 BIT(1),               /* X'04'- DISABLE,  */87600000
                                                  /*  SADZERO,ENABLE  */87650000
                                                  /*  OR DIAL         */87700000
                 4 CDSDSMI BIT(1),                /* X'02'- DISABLE,  */87750000
                                                  /*  SETMODE,ENABLE  */87800000
                                                  /*  OR DIAL FOR SDAI*/87850000
                 4 CDSDISEN BIT(1),               /* X'01'-DISABLE,   */87900000
                                                  /*  ENABLE OR DIAL  */87950000
               3 CDSNPOLL CHAR(1),                /* NUMBER OF POLLING*/88000000
                                                  /*  CHARACTERS (AEX)*/88050000
               3 CDSPOLL CHAR(7),                 /* POLLING CHARACTER*/88100000
               3 CDSNADDR CHAR(1),                /* NUMBER OF ADDRES-*/88150000
                                                  /*  SING CHARACTERS */88200000
                                                  /*  (HEX)           */88250000
               3 CDSADDR CHAR(10),                /* ADDRESSING       */88300000
                                                  /*  CHARACTERS      */88350000
               3 * CHAR(1),                       /* UNUSED           */88400000
               3 CDSNDIAL CHAR(1),                /* NUMBER OF DIAL   */88450000
                                                  /*  DIGITS          */88500000
               3 CDSDIAL CHAR(20),                /* DIAL DIGITS      */88550000
               3 CDSNID CHAR(1),                  /* CPU ID LENGTH    */88600000
               3 CDSCPUID CHAR(15),               /* CPU ID           */88650000
               3 CDSCODE CHAR (1),                /* ADAPTER LINE CODE*/88700000
               3 CDSCFLGS CHAR (1),              /* RESERVED          */88750000
               3 CDSFNFLG CHAR(1),                /* FUNCTION FLAGS   */88800000
                 4 * BIT(4),                      /* UNUSED           */88850000
                 4 CDSEXIBT BIT(1),               /* X'08'-EXHIBIT    */88900000
                 4 CDSDEL BIT(1),                 /* X'04'-DELETE     */88950000
                 4 CDSADD BIT(1),                 /* X'02'-ADD        */89000000
                 4 * BIT(1),                      /* UNUSED           */89050000
               3 CDSRETFL CHAR (1),               /* RETURN CODE      */89100000
                 4 * BIT(7),                      /* UNUSED           */89150000
                 4 CDSINVLD BIT (1),              /* X'01'- INVALID   */89200000
             2 CDSBLDL CHAR(40),                  /* BLDL LIST FOR    */89250000
                                                  /*  CONFIG DIRECTORY*/89300000
               3 CDSMEMBR CHAR(8),                /*  MEMBER NAME     */89350000
               3 CDSTTRC CHAR(3),                 /* CESD RELATIVE TTR*/89400000
               3 CDSTTRC4 CHAR(1),                /* CESD RELATIVE TTR*/89450000
                                                  /*  4TH BYTE        */89500000
               3 CDSTTRD CHAR(3),                 /* DATA RELATIVE TTR*/89550000
               3 CDSTTRD4 CHAR(1),                /* DATA RELATIVE TTR*/89600000
                                                  /*  4TH BYTE        */89650000
               3 CDSTTRNS CHAR(4),                /* RESERVED         */89700000
               3 CDSATTRB CHAR(2),                /* ATTRIBUTES       */89750000
               3 CDSMAIN CHAR(3),                 /* MAIN STORAGE     */89800000
                                                  /*  REQUIREMENTS    */89850000
               3 CDSBLK1 CHAR(2),                 /* LENGTH OF FIRST  */89900000
                                                  /*  BLOCK           */89950000
               3 CDSEPADR CHAR(3),      /* ENTRY POINT ADDR @Y17XAX6*/  90000000
               3 CDSTXBLK CHAR(3),      /* FIRST TEXT BLOCK @Y17XAX6*/  90050000
                                                  /*  ORIGIN          */90100000
               3 CDSSSI CHAR(7),                  /* CDS SSI          */90150000
             2 CDSCESD CHAR(56) BDY(DWORD),       /* CESD RECORD FOR  */90200000
                                                  /*  CONFIG PDS      */90250000
               3 CDSCESID CHAR(1),                /* CESD ID          */90300000
               3 CDSCESPR CHAR(3),                /* UNUSED           */90350000
               3 CDSESD01 CHAR(2),                /* ESDID OF FIRST   */90400000
                                                  /*  ESD             */90450000
               3 CDSCESCT FIXED(15),              /* COUNT            */90500000
               3 CDSCESNM CHAR(8),                /* MEMBER NAME      */90550000
               3 CDSCESTY CHAR(1),                /* TYPE             */90600000
               3 CDSCESAD PTR(24),                /* ADDRESS          */90650000
               3 CDSCESGM CHAR(1),                /* SEGMENT          */90700000
               3 CDSCESLN CHAR(3),                /* ID AND LENGTH    */90750000
               3 CDSESD02 CHAR(16),               /* SECOND ESD RECORD*/90800000
               3 CDSESD03 CHAR(16),               /* THIRD ESD RECORD */90850000
             2 CDSCNTL CHAR(20),                  /* CONTROL RECORD   */90900000
                                                  /* FOR CONFIG PDS   */90950000
               3 CDSCTLID CHAR(1),                /* CONTROL ID       */91000000
               3 CDSCTLSP CHAR(3),                /* UNUSED           */91050000
               3 CDSCNT01 CHAR(2),   /* # BYTES FOLLOWING CCW @Y17XAX6*/91100000
               3 CDSCNT02 CHAR(2),              /* COUNT   @Y17XAX6 */  91150000
               3 CDSCCW CHAR(8),                  /* CHANNEL CONTROL  */91200000
                                                  /*  WORD            */91250000
               3 CDSCESDI CHAR(2),                /* CESD ENTRY       */91300000
               3 CDSRECLN CHAR (2),               /* LENGTH OF TEXT   */91350000
                                                  /* RECORD           */91400000
             2 CDSTTBLE PTR (31),                 /* TERMINAL TABLE   */91450000
                                                  /* ENTRY ADDRESS    */91500000
             2 CDSTINDX FIXED(15),                /* TERMNAME TABLE   */91550000
                                                  /* INDEX            */91600000
             2 * CHAR (142),               /* RESERVED  @Y17XAX6*/      91650000
 %MEND:    ;                                                            91700000
           2 TOTWAITI CHAR (8) BDY(DWORD),       /* WAITIO TIME      */ 91750000
                                                 /* INTERVAL         */ 91800000
           2 TOTGRABP PTR (31),                  /* CURRENT SECONDARY*/ 91850000
                                                 /* DEVICE POINTER   */ 91900000
           2 TOTAPNAM CHAR (8),                  /* ALTERNATE PRINTER*/ 91950000
                                                 /* NAME IN EBCDIC   */ 92000000
           2 TOTOLTEN PTR (31),                  /* ENTRY POINT      */ 92050000
                                                 /* ADDRESS OF OLT   */ 92100000
           2 TOTWAWRK CHAR(80),      /* IEDQWA WORK AREA     @Y17XAUU*/ 92150000
           2 TOTWOWRK CHAR (140),                /* IEDQWO    SA41602*/ 92200000
                                                 /* WORKAREA  SA41602*/ 92250000
           2 * CHAR (52),                        /* PATCH    @Y17XAXU*/ 92300000
             2 TOTSERV BDY(DWORD),   /* START OF SERVICE     @Y17XAXU*/ 92350000
                                     /* ROUTINE WORK AREA    @Y17XAXU*/ 92400000
             2 TOTOBEND CHAR (0);            /* @Y17XAX6*/              92450000
 DCL $TOTE BIT(8) CONSTANT('8A'X);      /* TOTE ID @Y17XAX6 */          92500000
 %IF CONFG¬='YES' %THEN %GOTO MEND1;                                    92550000
 DCL CDSIBMTY BIT(8) CONSTANT('30'X); /* IBM TTY @Y17XAX6*/             92600000
 DCL CDSTTY2 BIT(8) CONSTANT('50'X); /* TTY II  @Y17XAX6*/              92650000
 DCL CDSWTTY BIT(8) CONSTANT('60'X); /* WTC TTY  @Y17XAX6*/             92700000
 DCL CDSSDA1 BIT(8) CONSTANT('70'X); /* SDA 1 @Y17XAX6*/                92750000
 DCL CDSSDA2 BIT(8) CONSTANT('90'X);  /* SDA II @Y17XAX6*/              92800000
 DCL CDSSWTCH BIT(8) CONSTANT('03'X);      /* SWITCHED WITHOUT          92850000
                                                    AUTODIAL  @Y17XAX6*/92900000
 DCL CDSLOCAL BIT(8) CONSTANT('05'X); /* LOCAL  @Y17XAX6*/              92950000
 DCL CDSBYP BIT(8) CONSTANT('00'X);  /* BYPASS  @Y17XAX6*/              93000000
 DCL CDSDSMIT BIT(8) CONSTANT('03'X);           /* DISABLE,SETMODE      93050000
                             ENABLE OR DIAL FOR SDA II  @Y17XAX6*/      93100000
 DCL CDSDSAD1 BIT(8) CONSTANT('05'X);           /* DISABLE, SADONE      93150000
                                  ENABLE OR DIAL  @Y17XAX6*/            93200000
 DCL CDSDSAD2 BIT(8) CONSTANT('06'X);           /* DISABLE, SADTWO      93250000
                                 ENABLE OR DIAL  @Y17XAX6*/             93300000
 DCL CDSDSAD3 BIT(8) CONSTANT('07'X);           /* DISABLE, SADFOUR     93350000
                                   ENABLE OR DIAL  @Y17XAX6*/           93400000
 DCL CDSCHNG BIT(8) CONSTANT('06'X);  /* CHANGE  @Y17XAX6*/             93450000
 DCL CDSNRML BIT(8) CONSTANT('00'X);  /* NORMAL RETURN  @Y17XAX6 */     93500000
 %MEND1:   ;                                                            93550000
./  ADD  SSI=60240689,NAME=PLINK
         MACRO                                                          00200020
&NAME    PLINK &LOAD=,&EPLIST=,&CALL=,&SIZE=,                          C00400020
               &DELETE=,&RETURN=,&MF=                                   00600020
.*                                                                      00800020
.* MACRO NAME: PLINK                                                    01000020
.*                                                                      01200020
.* STATUS:     CHANGE LEVEL 001                                         01400020
.*                                                                      01600020
.* FUNCTION:   TO PROVIDE THE LINKAGE NECESSARY TO EXECUTE THE PLINK    01800020
.*             MODULE. THE MACRO GENERATES A PARAMETER LIST AND/OR      02000020
.*             LOADS REGISTER 15 WITH THE ADDRESS OF THE PLINK MODULE   02200020
.*             AND REGISTER 1 WITH THE ADDRESS OF A PARAMETER LIST.     02400020
.*                                                                      02600020
.* REGISTER 15 RETURN CODE:    (SET BY LOAD AND DELETE FUNCTIONS ONLY.) 02800020
.*                                                                      03000020
.*             CODE       MEANING                                       03200020
.*                                                                      03400020
.*              00       THE REQUESTED FUNCTION HAS BEEN ACCOMPLISHED   03600020
.*                       SUCCESSFULLY.                                  03800020
.*                                                                      04000020
.*              04       THE PLINK FACILITY IS NOT AVAILABLE.           04200020
.*                                                                      04400020
.*              08       AN ERROR OTHER THAN THOSE DESCRIBED HAS        04600020
.*                       OCCURRED.                                      04800020
.*                                                                      05000020
.*              0C       LOAD - THE REQUESTED MODULE IS NOT AVAILABLE   05200020
.*                       IN THE SYSTEM.                                 05400020
.*                       DELETE - THE SPECIFIED MODULE IS NOT IN CORE.  05600020
.*                                                                      05800020
.*              10       LOAD - THERE IS NOT ENOUGH CORE AVAILABLE.     06000020
.*                       DELETE - NEVER RETURNS THIS CODE.              06200020
.*                                                                      06400020
.* PARAMETERS AND/OR KEYWORDS:                                          06600020
.*                                                                      06800020
.*             LOAD(SUBLIST)-THE ENTRY POINT NAMES OF MODULES TO BE     07000020
.*                 LOADED. IF MORE THAN ONE, SEPARATED BY COMMAS AND    07200020
.*                 ENCLOSED IN PARENTHESES.                             07400020
.*                                                                      07600020
.*             EPLIST-THE ADDRESS OF A LIST WHERE ENTRY POINT ADDRESSES 07800020
.*                    OF THE LOADED MODULES WILL BE STORED. MUST        08000020
.*                    ACCOMPANY THE LOAD PARAMETER.                     08200020
.*                                                                      08400020
.*             SIZE-  INTEGER DEFINING THE TOTAL AMOUNT OF CORE IN 1K   08600020
.*                                                                      08800020
.*                    MULTIPLES REQUIRED TO RUN TEST.                   09000020
.*             CALL-  MODULE TO TRANSFER CONTROL TO; TWO FORMS ALLOWED, 09200020
.*                                                                      09400020
.*                    1. ADDRESS- LOCATION CONTAINING THE ENTRY POINT.  09600020
.*                                                                      09800020
.*                    2. (15)   - INDICATES REGISTER 15 CONTAINS THE    10000020
.*                                ADDRESS. R15 MUST HAVE BEEN LOADED    10200020
.*                                PRIOR TO INVOKING PLINK.              10400020
.*                                                                      10600020
.* NOTE:       CALL=(15) CANNOT BE USED WHEN LOADING OR DELETING IN THE 10800020
.*             SAME PLINK AS CALL.                                      11000020
.*                                                                      11200020
.*             DELETE(SUBLIST)-SAME COMMENTS AS APPLY TO LOAD.          11400020
.*                                                                      11600020
.*             RETURN=YES- INDICATES CONTROL IS TO BE RETURNED TO THE   11800020
.*                         CALLING MODULE. ITS REGISTERS ARE RESTORED   12000020
.*                         AND A BRANCH IS MADE TO THE ADDRESS STORED   12200020
.*                         IN REGISTER 14.                              12400020
.*                                                                      12600020
.*             MF= E,ADDRESS/(1) INDICATES THE EXECUTE FORM OF THE      12800020
.*                 MACRO WITH THE PARAMETER LIST ADDRESS EITHER         13000020
.*                 SPECIFIED OR PREVIOUSLY LOADED IN REGISTER 1.        13200020
.*                                                                      13400020
.*                                                                      13600020
.*             MF= L  INDICATES THE LIST FORM OF THE MACRO WITH NO      13800020
.*                    EXECUTABLE CODE GENERATED.                        14000020
.*                                                                      14200020
.* RESTRICTIONS: LOAD AND RETURN MAY NOT BE SPECIFIED IN THE SAME       14400020
.*               MACRO.                                                 14600020
.*               CALL AND RETURN MAY NOT BE SPECIFIED IN THE SAME       14800020
.*               MACRO.                                                 15000020
.*                                                                      15200020
.*                                                                      15400020
.* WARNING:    IF CALL OR RETURN AND LOAD OR DELETE ARE USED IN THE     15600020
.*             SAME MACRO AND THE RETURN CODE IS NOT ZERO, A BRANCH     15800020
.*             WILL BE MADE AROUND THE RETURN OR CALL INSTRUCTIONS.     16000020
.*                                                                      16200020
.* CONTROL BITS SET BY THIS MACRO:                                      16400020
.*                                                                      16600020
.*             L&SYSNDX DC B'&L1&C&B&B&D&R&B&S'                         16800020
.*                            |  | | | | | | |                          17000020
.*                            |  | 0 0 | | 0 |                          17200020
.*                            |  |     | |   SIZE                       17400020
.*                            |  |     | RETURN                         17600020
.*                            |  |     DELETE                           17800020
.*                               CALL                                   18000020
.*                            LOAD                                      18200020
.*                                                                      18400020
.* GLOBALS SET OR RESET BY THIS MACRO:                                  18600020
.*                                                                      18800020
.*             &CR AND &MOD(255)                                        19000020
.*                                                                      19200020
.* GLOBALS EXAMINED BY THIS MACRO: NONE                                 19400020
.*                                                                      19600020
.* SYMBOLS GENERATED BY THIS MACRO: NONE                                19800020
.*                                                                      20000020
.* MNOTES ISSUED BY THIS MACRO:                                         20200020
.*                                                                      20400020
.*             MNOTE 8,'DELETE AND RETURN INVALID.'                     20600020
.*                                                                      20800020
.*             MNOTE 8,'DELETE AND CALL INVALID.'                       21000020
.*                                                                      21200020
.*             MNOTE 8,'DELETE AND LOAD INVALID.'                       21400020
.*                                                                      21600020
.*             MNOTE 8,'LOAD AND RETURN INVALID.'                       21800020
.*                                                                      22000020
.*             MNOTE 8,'CALL AND RETURN INVALID.'                       22200020
.*                                                                      22400020
.*             MNOTE 8,'THERE IS NO LIST EXPANSION FOR CALL.'           22600020
.*                                                                      22800020
.*             MNOTE 8,'THERE IS NO LIST EXPANSION FOR RETURN.'         23000020
.*                                                                      23200020
.*             MNOTE 8,'ENTRY POINT LIST ADDRESS MISSING.'              23400020
.*                                                                      23600020
.*             MNOTE 8,'NO MACRO OPERANDS SELECTED.'                    23800020
.*                                                                      24000020
.*             MNOTE 8,'REG 15 CANNOT BE USED FOR CALL ADDRESS WHEN     24200020
.*                      LOAD OR DELETE ARE SPECIFIED.'                  24400020
.*                                                                      24600020
.* REASONS:    ABOVE MNOTES ARE SELF EXPLANATORY.                       24800020
.*                                                                      25000020
.* EXAMPLE:                                                             25200020
.*                                                                      25400020
.* *******************************************                          25600020
.* *  NAME  * OPERATION *       OPERAND      *                          25800020
.* *******************************************                          26000020
.* *        *           *                    *                          26200020
.* * SYMBOL *   PLINK   * LOAD=(SUBLIST),    *                          26400020
.* *        *           * EPLIST=ADDR,       *                          26600020
.* *        *           * SIZE=INTEGER,      *                          26800020
.* *        *           * CALL=ADDR/(15),   *                           27000020
.* *        *           * DELETE=(SUBLIST),  *                          27200020
.* *        *           * RETURN=YES,        *                          27400020
.* *        *           * MF=(E,ADDR/(1))    *                          27600020
.* *        *           *   =L               *                          27800020
.* *        *           *                    *                          28000020
.*                                                                      28200020
         GBLA  &CR                                                      28400020
         GBLC  &MOD(255)                                                28600020
         LCLA  &C1,&C2,&CTR,&N                                          28800020
         LCLB  &L1,&C,&B,&D,&R,&S,&E                                    29000020
         LCLC  &FILEN                                                   29200020
&L1      SETB  (T'&LOAD NE 'O')   SET TO 1 IF PARAMETER EXISTS.         29400020
&C       SETB  (T'&CALL NE 'O')                                         29600020
&D       SETB  (T'&DELETE NE 'O')                                       29800020
&R       SETB  (T'&RETURN NE 'O')                                       30000020
&S       SETB  (T'&SIZE NE 'O')                                         30200020
&E       SETB  (T'&EPLIST NE 'O')                                       30400020
.*                                                                      30600020
.* TEST FOR INVALID COMBINATIONS                                        30800020
.*                                                                      31000020
         AIF   (&L1+&R GT 1).ERR1                                       31200020
         AIF   (&C+&R GT 1).ERR2                                        31400020
         AIF   (&L1+&D GT 1).ERR8                                       31600020
         AIF   (&C+&D GT 1).ERR9                                        31800020
         AIF   (&D+&R GT 1).ERR10                                       32000020
.*                                                                      32200020
         AIF   (T'&NAME NE 'O').N1                                      32400020
&FILEN   SETC  'A&SYSNDX'                                               32600020
         AGO   .N2                                                      32800020
.N1      ANOP                                                           33000020
&FILEN   SETC  '&NAME'                                                  33200020
.*                                                                      33400020
.N2      AIF   (&CR NE 0).T2                                            33600020
&CR      SETA  1                                                        33800020
.*                                                                      34000020
.T2      ANOP                                                           34200020
&C1      SETA  N'&LOAD            C1=# OF LOAD MODULES                  34400020
&C2      SETA  N'&DELETE          C2=# OF DELETE MODULES                34600020
.*                                                                      34800020
         AIF   (T'&MF EQ 'O').STD .GO TO STD FORM IF MF OMITTED         35000020
         AIF   ('&MF(1)' EQ 'E').EXEC .GOTO EXEC FORM IF MF=E           35200020
         AIF   ('&MF(1)' EQ 'L').LISTA .GOTO LIST FORM IF MF=L          35400020
.*                                                                      35600020
.STD     AIF   (&L1 NE 0).LOADA . TEST FOR LOAD PARAM.                  35800020
         AGO   .DELA .            NO, TRY DELETE                        36000020
.LOADA   AIF   (&L1+&C GT 1).LOADC . IS IT LOAD&CALL?                   36200020
.LOADB   ANOP                                                           36400020
&FILEN   L     R15,#TABLE         TABLE OF EXECUTIVE ENTRY POINTS       36600020
&FILEN   SETC  ' '                                                      36800020
         L     R15,28(R15)        ENTRY TO TRANSIENT MANAGER            37000020
         LA    R14,R&SYSNDX       RETURN ADDRESS                        37200020
         CNOP  2,4                                                      37400020
         BALR  R1,R15                                                   37600020
         AGO   .LISTB             SET UP PARAMETER LIST                 37800020
.LOADC   AIF   ('&CALL'(1,1) NE '(').LOADB  CHECK FOR REGISTER 15       38000020
         AGO   .ERR7                                                    38200020
.*                                                                      38400020
.DELA    ANOP                                                           38600020
         AIF   (&D EQ 0).CALLA                                          38800020
         AGO   .LOADB                                                   39000020
.CALLA   ANOP                                                           39200020
         AIF   (&C NE 1).RETC                                           39400020
.CALLB   AIF   ('&CALL'(1,1) EQ '(').CALLC                              39600020
&FILEN   L     R15,&CALL                                                39800020
&FILEN   SETC  ' '                                                      40000020
         BALR  R14,R15                                                  40200020
         MEXIT                                                          40400020
.CALLC   ANOP                                                           40600020
&FILEN   L     R15,0(R15)                                               40800020
&FILEN         SETC ' '                                                 41000020
&FILEN   BALR  R14,R15            BRANCH TO ADDRESS IN R15              41200020
         MEXIT                                                          41400020
.*                                                                      41600020
.EXEC    ANOP                                                           41800020
         AIF   (N'&MF GE 2).EXECA                                       42000020
         AIF   (&C EQ 1).CALLB                                          42200020
.RETC    ANOP                                                           42400020
         AIF   (&R EQ 0).ERR6                                           42600020
&FILEN   L     R13,4(R13)         GET OLD SAVE AREA ADDRESS             42800020
&FILEN   SETC  ' '                                                      43000020
         LM    R14,R12,12(R13)    RESTORE CALLING PROGRAM'S REGISTERS.  43200020
         BR    R14                RETURN                                43400020
         MEXIT                                                          43600020
.EXECA   AIF   ('&MF(2)'(1,1) EQ '(').R1                                43800020
&FILEN   LA    R1,&MF(2) .        LOAD R1 WITH PARAMETER LIST ADDRESS.  44000020
&FILEN   SETC  ' '                                                      44200020
.R1      ANOP                                                           44400020
&FILEN   L     R15,#TABLE                                               44600020
&FILEN   SETC  ' '                                                      44800020
         L     R15,28(R15)                                              45000020
         BALR  R14,R15                                                  45200020
         AIF   (&C EQ 0).EXECB                                          45400020
         AIF   ('&CALL'(1,1) EQ '(').ERR7                               45600020
.CALLD   ANOP                                                           45800020
         LTR   R15,R15            TEST RETURN CODE                      46000020
         BNZ   E&SYSNDX           IF NOT ZERO, BRANCH AROUND CALL       46200020
         L     R15,&CALL                                                46400020
         BALR  R14,R15                                                  46600020
E&SYSNDX EQU   *                                                        46800020
         MEXIT                                                          47000020
.EXECB   ANOP                                                           47200020
         AIF   (&R EQ 1).RETB                                           47400020
         MEXIT                                                          47600020
.RETB    ANOP                                                           47800020
         LTR   R15,R15            TEST RETURN CODE                      48000020
         BNZ   E&SYSNDX                                                 48200020
         L     R13,4(R13)         GET CALLING MODULES SAVE AREA         48400020
         LM    R14,R12,12(R13)    RESTORE REGISTERS                     48600020
         BR    R14                RETURN TO CALLING MODULE              48800020
E&SYSNDX EQU   *                                                        49000020
         MEXIT                                                          49200020
.LISTA   ANOP                                                           49400020
         AIF   (&C EQ 1).ERR3                                           49600020
         AIF   (&R EQ 1).ERR4                                           49800020
.*                                                                      50000020
.LISTB   ANOP                                                           50200020
&FILEN   DC    A(P&SYSNDX) .      OLTEP PARAMETER LIST ADDRESS          50400020
&FILEN   SETC  ' '                                                      50600020
         DC    A(L&SYSNDX) .      POINTER TO CONTROL BYTE               50800020
         AIF   (&L1 EQ 0).LISTC                                         51000020
         DC    A(L&SYSNDX+4) .    POINTER TO LOAD MODULE LIST           51200020
         AIF   (&E EQ 0).ERR5                                           51400020
         DC    A(&EPLIST) .       ENTRY POINT LIST ADDRESS              51600020
         AGO   .LISTD                                                   51800020
.LISTC   ANOP                                                           52000020
         DC    A(0)                                                     52200020
         DC    A(0)                                                     52400020
.LISTD   ANOP                                                           52600020
         AIF   (&D EQ 0).LISTE                                          52800020
         DC    A(D&SYSNDX)        POINTER TO LIST OF DELETED MODULES    53000020
         AGO   .DELC                                                    53200020
.LISTE   ANOP                                                           53400020
         DC    A(0)                                                     53600020
.DELC    ANOP                                                           53800020
P&SYSNDX DC    B'00000000' .      INDICATORS FOR TRANSIENT MANAGER      54000020
         DC    AL1(1) .           MACRO LEVEL                           54200020
         DC    CL2'28' .          IDENTITY OF MACRO EXPANSION           54400020
L&SYSNDX DC    B'&L1&C&B&B&D&R&B&S' .    CONTROL BYTE                   54600020
         AIF   (T'&SIZE EQ 'O').QA                                      54800020
         DC    AL1(&SIZE)         CORE NEEDED IN 1K MULTIPLES           55000020
         AGO   .QB                                                      55200020
.QA      ANOP                                                           55400020
         DC    AL1(0)             CORE NEEDED IN 1K MULTIPLES           55600020
.QB      ANOP                                                           55800020
         DC    AL1(&C1)           # OF LOAD MODULES                     56000020
         DC    AL1(&C2)           # OF DELETED MODULES                  56200020
         AIF   (&L1 EQ 0).DELB                                          56400020
&CTR     SETA  1                                                        56600020
.P2      ANOP                                                           56800020
         DC    CL8'&LOAD(&CTR)'                                         57000020
.P3      ANOP                                                           57200020
&N       SETA  1                                                        57400020
.P4      AIF   ('&LOAD(&CTR)' EQ '&MOD(&N)').EX2                        57600020
         AIF   (&N EQ &CR).EX3                                          57800020
&N       SETA  &N+1                                                     58000020
         AGO   .P4                                                      58200020
.EX3     ANOP                                                           58400020
         EXTRN &LOAD(&CTR)                                              58600020
&MOD(&CR) SETC '&LOAD(&CTR)'                                            58800020
&CR      SETA  &CR+1                                                    59000020
.EX2     ANOP                                                           59200020
         AIF   (&CTR EQ &C1).DELB                                       59400020
&CTR     SETA  &CTR+1                                                   59600020
         AGO   .P2                                                      59800020
.DELB    AIF   (&D EQ 0).DELD                                           60000020
D&SYSNDX EQU   *                                                        60200020
&CTR     SETA  1                                                        60400020
.PA      ANOP                                                           60600020
         DC    CL8'&DELETE(&CTR)'                                       60800020
         AIF   (&CTR EQ &C2).DELD                                       61000020
&CTR     SETA  &CTR+1                                                   61200020
         AGO   .PA                                                      61400020
.DELD    ANOP                                                           61600020
R&SYSNDX DS    0H                 RETURN ON HALFWORD BOUNDARY           61800020
.*                                                                      62000020
         AIF   (&C EQ 0).RETA                                           62200020
         AGO   .CALLD                                                   62400020
.RETA    ANOP                                                           62600020
         AIF   (&R EQ 1).RETB                                           62800020
         AIF   (&L1+&C+&D+&R EQ 0).ERR6                                 63000020
         MEXIT                                                          63200020
.ERR1    MNOTE 8,'LOAD AND RETURN INVALID.'                             63400020
         MEXIT                                                          63600020
.ERR2    MNOTE 8,'CALL AND RETURN INVALID.'                             63800020
         MEXIT                                                          64000020
.ERR3    MNOTE 8,'THERE IS NO LIST EXPANSION FOR CALL.'                 64200020
         MEXIT                                                          64400020
.ERR4    MNOTE 8,'THERE IS NO LIST EXPANSION FOR RETURN.'               64600020
         MEXIT                                                          64800020
.ERR5    MNOTE 8,'ENTRY POINT LIST ADDRESS MISSING.'                    65000020
         MEXIT                                                          65200020
.ERR6    MNOTE 8,'NO MACRO OPERANDS HAVE BEEN CHOSEN.'                  65400020
         MEXIT                                                          65600020
.ERR7    MNOTE 8,'REG 15 CANNOT BE USED FOR CALL ADDRESS WHEN LOAD OR  C65800020
                DELETE ARE SPECIFIED.'                                  66000020
         MEXIT                                                          66200020
.ERR8    MNOTE 8,'DELETE AND LOAD INVALID.'                             66400020
         MEXIT                                                          66600020
.ERR9    MNOTE 8,'DELETE AND CALL INVALID.'                             66800020
         MEXIT                                                          67000020
.ERR10   MNOTE 8,'DELETE AND RETURN INVALID.'                           67200020
         MEXIT                                                          67400020
         MEND                                                           67600020
./  ADD  SSI=71450747,NAME=RESPL
*        %GOTO PLSRESPL;          /*BILINGUAL HEADER                    00500000
         MACRO                                                          01000020
&NAME    RESPL &DSECT=YES,&EQUATES=NO                                   02000022
         LCLC  &A0010,&A0020,&A0030,&A0040,&A0050                       03000020
         LCLC  &A0060,&A0070,&A0080,&A0090,&A0095,&A0096       @Y17XAUU 03050000
         LCLC  &A0097,&A0098,&A0099                            @Y17XAXU 03120000
*                                                                       03200020
*        TOTE RESIDENT CONTROL BLOCK                                    03300022
*                                                                       03400022
*        STATUS = VERSION 10.0                                 @Y17XAXU 03600000
*                                                                       03800020
         AIF   ('&DSECT' EQ 'NO').BYP010                                04000020
&A0010   SETC  '0'                                                      05000020
&A0020   SETC  '0'                                                      06000020
&A0030   SETC  '0'                                                      07000020
&A0040   SETC  '0'                                                      08000020
&A0050   SETC  '0'                                                      09000020
&A0060   SETC  '0'                                                      09200022
&A0070   SETC  '0'                                                      09400022
&A0080   SETC  '0'                                                      09600022
&A0090   SETC  '0'                                                      09800022
&A0095   SETC  '0'                                               S22024 09900000
&A0096   SETC  '0'                                             @Y17XAUU 09950000
&A0097   SETC  '0'                                             @Y17XAXU 09960000
&A0098   SETC  '0'                                             @Y17XAUU 09970000
&A0099   SETC  '0'                                             @Y17XAUU 09980000
         AGO   .BYP020                                                  10000020
.BYP010  ANOP                                                           11000020
&A0010   SETC  'ERROR'                                                  12000020
&A0020   SETC  'SMGR'                                                   13000020
&A0030   SETC  'IEDQWA'                                                 14000020
&A0040   SETC  'OLTETXR'                                                15000020
&A0050   SETC  'PRFSTXT-PRFSUNIT'                                       16000020
&A0060   SETC  'QREMFRX'                                                16200022
&A0070   SETC  'QREMELX'                                                16400022
&A0080   SETC  'QADDNDX'                                                16600022
&A0090   SETC  'QADDAFX'                                                16800022
&A0095   SETC  'STAERT'                                          S22024 16900000
&A0096   SETC  'HIERSCAN'                                      @XM05672 16950010
&A0097   SETC  'POSTWAIT'                                      @Y17XAXU 16955000
&A0098   SETC  'ALLOCBUF'                                      @Y17XAXU 16970000
&A0099   SETC  'FREEBUF'                                       @Y17XAUU 16980000
.BYP020  ANOP                                                           17000020
         AIF   ('&DSECT' EQ 'NO').BYP030                                18000020
&NAME    DSECT                                                          19000020
         AGO   .BYP040                                                  20000020
.BYP030  ANOP                                                           21000020
&NAME    DS    0F                                                       22000020
.BYP040  ANOP                                                           23000020
RESTECBS DC    A(0)               PARAMETER LIST FOR TOTE WAIT          23800022
         DC    XL1'80'            SET ECB CODE TO WAITING               24200022
         DC    AL3(RESTECB1)      ADDRESS OF USBTASK ECB                24600022
RESTECB1 DC    F'0'               SUBTASK REQUEST ECB                   25000022
*                                                                       25400022
RESOBQCB DS    0F                 OLTCB QUEUE CONTROL BLOCK             25800022
RESOBFWD DC    A(RESOBQCB)        OLTCB QUEUE FORWARD POINTER           26200022
RESOBBKW DC    A(RESOBQCB)        OLTCB QUEUE BACKWARD POINTER          26600022
*                                                                       27000022
RESTTLST DC    A(0)               LAST TOTE TNT ENTRY ADDRESS           27400022
RESBKTOT DC    H'12'              TOTAL STORAGE BLOCKS FOR TOTE  S22024 27800000
RESBKAVL DC    H'8'               CURRENT FREE STORAGE BLOCKS           28200022
RESEFQCB DC    A(RESEFQCB)        EXTENDED AREA FREE QUEUE              28600022
*                                   CONTROL BLOCK                       29000022
RESTNTCT DC    X'00'              TOTAL NUMBER OF TNT ENTRIES           29400022
RESDMTTE DC    AL3(0)             POINTER TO TOTE EXTENDED AREA         29800022
*                                   FOR TTE'S AND QCB'S                 30200022
RESETXRA DC    A(&A0040)          END OF TASK EXIT ROUTINE ADDRESS      30600022
RESSTAEA DC    A(&A0095)          STAE EXIT ROUTINE ADDRESS      S22024 30800000
RESSMGRA DC    A(&A0020)          SERVICE MANAGER ENTRY ADDRESS         31000022
RES#TBLE EQU   RESSMGRA-28        BRANCH TABLE ADDRESS                  31400022
RESWBFNC DC    X'00'              IEDQWB FUNCTION REQUEST CODE          31800022
*                                                                       32200022
RESFLAGS DC    XL1'0'             TOTE RESIDENT FLAG BYTE               32600022
*                                                                       33000022
RESINIT  EQU   X'80'                   TOTE INITIALIZED FLAG            33400022
RESFIRST EQU   X'40'                   FIRST-TIME INDICATOR             33800022
*                                                                       34200022
         DC    XL2'0000'          UNUSED                       @XM05672 34600010
RESTRMQ  DC    A(RESTRMQ)         TOTE TRM QUEUE CONTROL BLOCK          35000022
         DS    XL1'0'             UNUSED                                35400022
RESTNTPT DS    AL3(0)             ADDRESS OF START OF TOTE TNT          35800022
*                                   ENTRIES                             36200022
*                                                                       36600022
*           BRANCH TABLE FOR QUEUE HANDLERS                             37000022
*                                                                       37400022
RESQHBL  DS    0F                 ALIGN ON FULLWORD                     37800022
RESREMFR DC    A(&A0060)          ADDRESS OF REMOVE ELEMENT FROM        38200022
*                                   FRONT HANDLER                       38600022
RESREMEL DC    A(&A0070)          ADDRESS OF REMOVE SPECIFIED           39000022
*                                   ELEMENT HANDLER                     39400022
RESADDND DC    A(&A0080)          ADDRESS OF ADD ELEMENT TO END         39800022
*                                   HANDLER                             40200022
RESADDAF DC    A(&A0090)          ADDRESS OF ADD ELEMENT AFTER          40600022
*                                   ANOTHER SPECIFIED ELEMENT HANDLER   40610000
RESPLRVT DC    A(&A0097)          POST/WAIT ROUTINE            @Y17XAXU 40610500
RESABUF  DC    A(&A0098)          BUFFER ALLOCATION ROUTINE    @Y17XAXU 40612000
RESFBUF  DC    A(&A0099)          BUFFER DEALLOCATION ROUTINE  @Y17XAXU 40613000
RESMHSRC DC    H'0' .             TOTE MH TTCIN                @Y17XAXU 40614000
RESMHNAT DC    H'0' .             TOTE MH NETWORK ADDRESS      @Y17XAXU 40615000
RESTOTMH DC    A(0) .             TOTE MH ADDRESS              @Y17XAXU 40620000
RESPLADR DS    0F .               SERVICE ROUTINE ADDRESSES    @Y17XAXU 40630000
RESPLWO  DC    A(0) .             I/O ACCESS MANAGER           @Y17XAXU 40640000
RESPLAB  DC    A(0) .             DATE ROUTINE                 @Y17XAXU 40650000
RESPLAJ  DC    A(0) .             $CUTEST ROUTINE              @Y17XAXU 40660000
RESPL35  DC    A(0) .             EXIO ROUTINE                 @Y17XAXU 40670000
RESPLAA  DC    A(0) .             TIME ROUTINE                 @Y17XAXU 40680000
RESPL39  DC    A(0) .             DPRINT LOAD 1 ROUTINE        @Y17XAXU 40690000
RESPLP1  DC    A(0) .             DPRINT LOAD 2 ROUTINE        @Y17XAXU 40700000
RESPLP2  DC    A(0) .             DPRINT LOAD 2 ROUTINE        @Y17XAXU 40710000
RESPL37  DC    A(0) .             CECOM ROUTINE                @Y17XAXU 40720000
RESPL28  DC    A(0) .             PLINK ROUTINE                @Y17XAXU 40730000
RESPL36  DC    A(0) .             WAITIO ROUTINE               @Y17XAXU 40740000
RESPLAC  DS    0F .               $GRAB ROUTINE                @Y17XAXU 40750000
RESPL21  DS    A(0) .             $LETGO ROUTINE               @Y17XAXU 40760000
RESPL41  DC    A(0) .             CONVERT ROUTINE              @Y17XAXU 40770000
RESPL16  DC    A(0) .             GETCONFIG ROUTINE            @Y17XAXU 40780000
RESPL42  DS    0F .               MORECORE ROUTINE             @Y17XAXU 40790000
RESPL43  DC    A(0) .             FREECORE ROUTINE             @Y17XAXU 40800000
RESPL44  DC    A(0) .             DIO ROUTINE                  @Y17XAXU 40810000
RESPL47  DC    A(0) .             ROUTINE ROUTINE              @Y17XAXU 40820000
RESPLM2  DC    A(0) .             TRACE/RETURN CODE ROUTINE    @Y17XAXU 40830000
RESPL25  DC    A(0) .             SEND ROUTINE                 @Y17XAXU 40840000
RESPL33  DC    A(0) .             RECEIVE ROUTINE              @Y17XAXU 40850000
RESTLIB  DC    A(&A0096)          ADDR OF HIERARCHY SCAN RTN   @XM05672 40860010
RESPLA1  DC    A(0) .             TOTE INPUT PROCESSOR ADDRESS @Y17XAXU 40870000
RESAPDCB DCB   DSORG=PS,MACRF=WC,DDNAME=DIAGMSG,BLKSIZE=80      SA21903 41100000
RESAPOPN EQU   RESAPDCB+48                                      SA21903 41200000
         MEND                                                @Y17XAXU*/ 41300000
*%PLSRESPL: ;                                                           41400000
*DECLARE                                                                41500000
*  1 IEDRESPL BDY(WORD) BASED,    /*                         @Y17XAXU*/ 41600000
*/*                                                          @Y17XAXU*/ 41700000
*/*      TOTE RESIDENT CONTROL BLOCK                         @Y17XAXU*/ 41800000
*/*      STATUS = VERSION 10.0 (TCAM,TOTE)                   @Y17XAXU*/ 41900000
*/*                                                          @Y17XAXU*/ 42000000
*   2 RESTECBS PTR(31),           /* PARMLIST FOR TOTE WAIT  @Y17XAXU*/ 42100000
*   2 * CHAR(1),                  /* ECSB CODE               @Y17XAXU*/ 42200000
*   2 * PTR(24) BDY(BYTE),        /* SUBTASK ECB ADDRESS     @Y17XAXU*/ 42300000
*   2 RESTECB1 PTR(31),           /* SUBTASK REQUEST ECB     @Y17XAXU*/ 42400000
*   2 RESOBQCB BDY(WORD),         /* OLTCB QUEUE CONTROL     @Y17XAXU*/ 42500000
*                                 /* BLOCK                   @Y17XAXU*/ 42600000
*    3 RESOBFWD PTR(31),          /* OLTCB QUEUE FORWARD     @Y17XAXU*/ 42700000
*                                 /* POINTER                 @Y17XAXU*/ 42800000
*    3 RESOBBKW PTR(31),          /* OLTCB QUEUE BACKWARD    @Y17XAXU*/ 42900000
*                                 /* POINTER                 @Y17XAXU*/ 43000000
*   2 RESTTLST PTR(31),           /* LAST TOTE TNT ENTRY     @Y17XAXU*/ 43100000
*                                 /* ADDRESS                 @Y17XAXU*/ 43200000
*   2 RESBKTOT FIXED(15),         /* TOTAL STORAGE BLOCKS    @Y17XAXU*/ 43300000
*                                 /* FOR TOTE                @Y17XAXU*/ 43400000
*   2 RESBKAVL FIXED(15),         /* CURRENT FREE STORAGE    @Y17XAXU*/ 43500000
*                                 /* BLOCKS                  @Y17XAXU*/ 43600000
*   2 RESEFQCB PTR(31),           /* EXTENTED AREA FREE      @Y17XAXU*/ 43700000
*                                 /* QUEUE CONTROL BLOCK     @Y17XAXU*/ 43800000
*   2 RESTNTCT PTR(8),            /* TOTAL NUMBER OF TNT     @Y17XAXU*/ 43900000
*                                 /* ENTRIES                 @Y17XAXU*/ 44000000
*   2 RESDMTTE PTR(24) BDY(BYTE), /* POINTER TO TOTE         @Y17XAXU*/ 44100000
*                                 /* EXTENTED AREA FOR TTE'S,@Y17XAXU*/ 44200000
*                                 /* QCB'S AND LGB'S         @Y17XAXU*/ 44300000
*   2 RESETXRA PTR(31),           /* END OF TASK EXIT ROUTINE@Y17XAXU*/ 44400000
*                                 /* ADDRESS                 @Y17XAXU*/ 44500000
*   2 RESSTAEA PTR(31),           /* STAE EXIT ROUTINE       @Y17XAXU*/ 44600000
*                                 /* ADDRESS                 @Y17XAXU*/ 44700000
*   2 RESSMGRA PTR(31),           /* SERVICE MANAGER ENTRY   @Y17XAXU*/ 44800000
*                                 /* ADDRESS                 @Y17XAXU*/ 44900000
*   2 RESWBFNC CHAR(1),           /* IEDQWB FUNCTION REQUEST @Y17XAXU*/ 45000000
*                                 /* CODE                    @Y17XAXU*/ 45100000
*   2 RESFLAGS BIT(8),            /* TOTE RESIDENT FLAGS     @Y17XAXU*/ 45200000
*    3 RESINIT BIT(1),            /* TOTE INITIALIZED FLAG   @Y17XAXU*/ 45300000
*    3 RESFIRST BIT(1),           /* FIRST-TIME INDICATOR    @Y17XAXU*/ 45400000
*    3 * BIT(6),                  /* RESERVED                @Y17XAXU*/ 45500000
*   2 * CHAR(2),                  /* RESERVED                @Y17XAXU*/ 45600000
*   2 RESTRMQ PTR(31),            /* TRM QUEUE CONTROL BLOCK @Y17XAXU*/ 45700000
*   2 * CHAR(1),                  /* RESERVED                @Y17XAXU*/ 45800000
*   2 RESTNTPT PTR(24) BDY(BYTE), /* ADDRESS OF START OF     @Y17XAXU*/ 45900000
*                                 /* TOTE TNT ENTRIES        @Y17XAXU*/ 46000000
*/*                                                          @Y17XAXU*/ 46100000
*/*      BRANCH TABLE FOR QUEUE HANDLERS                     @Y17XAXU*/ 46200000
*/*                                                          @Y17XAXU*/ 46300000
*   2 RESQHBL BDY(WORD),          /*                         @Y17XAXU*/ 46400000
*    3 RESREMFR PTR(31),          /* ADDRESS OF REMOVE       @Y17XAXU*/ 46500000
*                                 /* ELEMENT FROM FRONT      @Y17XAXU*/ 46600000
*                                 /* HANDLER                 @Y17XAXU*/ 46700000
*    3 RESREMEL PTR(31),          /* ADDRESS OF REMOVE       @Y17XAXU*/ 46800000
*                                 /* SPECIFIED ELEMENT       @Y17XAXU*/ 46900000
*                                 /* HANDLER                 @Y17XAXU*/ 47000000
*    3 RESADDND PTR(31),          /* ADDRESS OF ADD ELEMENT  @Y17XAXU*/ 47100000
*                                 /* TO END HANDLER          @Y17XAXU*/ 47200000
*    3 RESADDAF PTR(31),          /* ADD OF ADD ELEMENT AFTER@Y17XAXU*/ 47300000
*                                 /* ANOTHER SPECIFIED       @Y17XAXU*/ 47400000
*                                 /* ELEMENT                 @Y17XAXU*/ 47500000
*   2 RESPLRVT PTR(31),           /* POST/WAIT ROUTINE       @Y17XAUU*/ 47510000
*   2 RESABUF PTR(31),            /* BUFFER ALLOCATION RTN   @Y17XAXU*/ 47520000
*   2 RESFBUF PTR(31),            /* BUFFER DEALLOCATION RTN @Y17XAXU*/ 47530000
*   2 RESMHSRC FIXED(16),         /* TOTE MH TTCIN           @Y17XAXU*/ 47540000
*   2 RESMHNAT FIXED(16),         /* TOTE MH NETWORK ADDRESS @Y17XAXU*/ 47550000
*   2 RESTOTMH PTR(31),           /* TOTE MH ADDRESS         @Y17XAXU*/ 47600000
*   2 RESPLADR BDY(WORD),         /* SERVICE ROUTINE ADDR    @Y17XAXU*/ 47700000
*    3 RESPLWO PTR(31),           /* I/O ACCESS MANAGER      @Y17XAXU*/ 47800000
*    3 RESPLAB PTR(31),           /* DATE ROUTINE            @Y17XAXU*/ 47900000
*    3 RESPLAJ PTR(31),           /* $CUTEST ROUTINE         @Y17XAXU*/ 48000000
*    3 RESPL35 PTR(31),           /* EXIO ROUTINE            @Y17XAXU*/ 48100000
*    3 RESPLAA PTR(31),           /* TIME ROUTINE            @Y17XAXU*/ 48200000
*    3 RESPL39 PTR(31),           /* DPRINT LOAD 1 ROUTINE   @Y17XAXU*/ 48300000
*    3 RESPLP1 PTR(31),           /* DPRINT LOAD 2 ROUTINE   @Y17XAXU*/ 48400000
*    3 RESPLP2 PTR(31),           /* DPRINT LOAD 2 ROUTINE   @Y17XAXU*/ 48500000
*    3 RESPL37 PTR(31),           /* CECOM ROUTINE           @Y17XAXU*/ 48600000
*    3 RESPL28 PTR(31),           /* PLINK ROUTINE           @Y17XAXU*/ 48700000
*    3 RESPL36 PTR(31),           /* WAITIO ROUTINE          @Y17XAXU*/ 48800000
*    3 RESPLAC PTR(31),           /* $GRAB ROUTINE           @Y17XAXU*/ 48900000
*     4 RESPL21 PTR(31),          /* $LETGO ROUTINE          @Y17XAXU*/ 49000000
*    3 RESPL41 PTR(31),           /* CONVERT ROUTINE         @Y17XAXU*/ 49100000
*    3 RESPL16 PTR(31),           /* GETCONFIG ROUTINE       @Y17XAXU*/ 49200000
*    3 RESPL42 PTR(31),           /* MORECORE ROUTINE        @Y17XAXU*/ 49300000
*     4 RESPL43 PTR(31),          /* FREECORE ROUTINE        @Y17XAXU*/ 49400000
*    3 RESPL44 PTR(31),           /* DIO ROUTINE             @Y17XAXU*/ 49500000
*    3 RESPL47 PTR(31),           /* ROUTINE ROUTINE         @Y17XAXU*/ 49600000
*    3 RESPLM2 PTR(31),           /* TRACE/RETURN CODE       @Y17XAXU*/ 49700000
*                                 /* ROUTINE                 @Y17XAXU*/ 49800000
*    3 RESPL25 PTR(31),           /* SEND ROUTINE            @Y17XAXU*/ 49900000
*    3 RESPL33 PTR(31),           /* RECEIVE ROUTINE         @Y17XAXU*/ 50000000
*   2 RESTLIB PTR(31),            /* ADDRESS OF OLTLIB DCB   @Y17XAXU*/ 50100000
*   2 RESAPDCB BDY(WORD);         /* START OF AP DCB AREA    @Y17XAXU*/ 50200000
*                                 /*                         @Y17XAXU*/ 50300000
*%RESPLEND: ;                     /* END OF RESPL            @Y17XAXU*/ 50400000
./  ADD  SSI=72940027,NAME=SNDSCH
         MACRO                                                          00000105
&NAME    SNDSCH  &GEN=MAXI                                              00000205
.*A-000000-999999                                              @X31X8I0 00000308
.*                                                                      00010308
.******************* MICROFICHE FLAGS *********************** SUPT CODE 00020308
.*C341000                                                        X02004 00030308
.*A573700                                                        Y01948 00040308
.*C556000,567423                                                 Y01948 00050308
.*D557000,558000,567432,567441                                   Y01948 00060308
.*A388000,573000                                                 S99228 00130022
.*A186000,217000,462600,488000                                   S22029 00130122
.*C001000-002000                                                 S22029 00130222
.*A355600,355700                                                 A42390 00130322
.*A400000,420000,426000,439000,446000,457000                     S21101 00130422
.*A507000,524000,528000,544000,566000                            S21101 00130522
.*C128000,442000,447000,458000,534000-537000                     S21101 00130622
.*D549000,606000-608000,614000                                   S21101 00130722
.*A114000,124000,403000,427050,427560,508400,535000,550000,      S22025 00130822
.*A558000,567126,567459                                          S22025 00130922
.*C128000,267000-268000,292000-293000,296000,534000,567000       S22025 00131022
.*D221000-225000,417000,427055,427085,427100-427300,427400-427700S22025 00131122
.*D439060-439240,439360-439840,505000,514000-515000,566180-566900S22025 00131222
.*D567000,567639,567657                                          S22025 00131322
.*A340450                                                         M2173 00131422
.*A220000                                                       SA56891 00131822
.*D177000-178000                                                SA56891 00131922
.*A565000,565200                                                SA52971 00132022
.*C567297-567324                                                SA52971 00132122
.*D545000,565400,567225,567477,567630-567648,569000             SA52971 00132222
.*A427020-427040,534000-534840                                  SA56606 00132322
.*D427420-427480,427560,427580-427800,534000-534500             SA56606 00132422
.*A561000                                                       SA60792 00132505
.*C567072,573200-573400                                         SA60792 00132605
.*C407500,409080,412000,443500,446000-446320                    SA61773 00132705
.*A409800,599800                                                SA58984 00132805
.*C015100-016000                                                SA58984 00132905
.*A461000,447200,524800                                         SA59034 00133005
.*C456000                                                       SA59034 00133105
.*D524100-524200                                                SA59034 00133205
.*C498000                                                       SA62953 00133305
.*A357000,357500                                                SA65412 00203352
.*A311050-311950                                                 Y05331 00203408
.*A427000,427400                                                OX02199 00233454
.*C389100,441600                                                SA65379 00243454
.*A389800                                                       SA65379 00253454
.*C357800-357900                                                SA68703 00253508
*A357500                                                       @ZA02054 00253761
*A183000                                                       @SA70324 00253861
*A248000,279000,573000                                         @SA71683 00253961
*A544600                                                       @SA72478 00254061
*D547300                                                       @SA72478 00254161
*C339200                                                       @YA08088 00254209
*A341660                                                       @YA08088 00254309
*C455000-461700                                                @ZA03063 00254409
.*A561400                                                       SA69635 00260508
.*A015000,017000,020000,024000,026000,065000,066000,101000       X03039 00260608
.*A146000,147000,189000,358600,362000,388000,392000,403000       X03039 00260708
.*A405600,409020,409080,409800,409930,416000,427020,427040,      X03039 00260808
.*A427540,428000,428070,434000,435000,437000,439000,442200,      X03039 00260908
.*A446500,469000,480000,483000,488500,492000,493000,507500,      X03039 00261008
.*A524800,526000,527000,528000,535500,536000,561000,561800,      X03039 00261108
.*A566000,567540,575000,599900,602000,605000,610000,613000       X03039 00261208
.*C004000,016500,088000,089000,090000,091000,431000,564000       X03039 00261308
.*D565000                                                        X03039 00261408
.*A427060,427090,427430,427520,                                  X03039 00261508
.*A000002                                                      @Z30X8IG 00267508
.*C002841,016500                                               @Z30X8IG 00275508
.*A080000,098000,101400,358715,474000,476000,599918            @Z30X8IR 00279508
.*A427170                                                      @Z30X8IM 00279608
.*A-365100,368300,384000                                       @X50X9IH 00280609
.*C-368300                                                     @X50X9IH 00281609
.*A358630,358680,358835,439095,439200                          @ZA03122 00281709
.*A413000                                                      @XA09773 00281809
.*A435100,435300                                               @X50X9II 00281909
.*D311280-311440,D312000                                       @YA11169 00282000
*D419000                                                       @OS76313 00282181
*C467000                                                       @OX11964 00282281
*C553000-555000                                                @OZ07113 00282391
*C553000-555000                                                @OY12395 00282491
*C405400                                                       @XA08073 00282591
*A156000,157000,160000,162200,C161600                          @OZ09912 00282691
*A256000                                                       @OY12421 00282791
*C467000,A469000                                               @OY12969 00282891
*A465000,C469200,A613000,A409930                               @OX13500 00282991
*A453000                                                       @OX12563 00283091
*D339400-339600,D353100-353200,A243000,A341400,C354200         @OS77835 00283191
*C341000,A610500                                               @OS77835 00283291
*C441600                                                       @OY14503 00283391
*D469100-469200                                                @OS77867 00283491
*C400000                                                       @OY14092 00283591
*C439720,439900                                                @OX17153 00283600
*A123000,567540                                                @OZ24185 00283700
*C567297                                                       @OZ24185 00283800
         SPACE 3                                                        00284022
*A124000                                                       @OY19438 00284182
*A567288,567297                                                @OY19438 00287182
* DUMMY APAR                                                   @OZ27328 00287282
.********************************************************************** 00293108
         AIF   ('&GEN' EQ 'MAXI' OR '&GEN' EQ 'MINI' OR '&GEN' EQ 'NTSO-00300020
               ' OR '&GEN' EQ 'VTAM').OK                         X03039 00400008
         MNOTE 12,'XXX IHB     -INVALID OPERAND.'                       00500020
         MEXIT                                                          00600020
.OK      ANOP                                                           00700020
         TITLE '&NAME     SEND SCHEDULER'                               00800020
&NAME    CSECT                                                          00900020
.L1      ANOP                                                           01000020
*                                                                     * 01100020
*********************************************************************** 01200020
*                                                                     * 01300020
*TITLE --  SEND SCHEDULER MODULE                                      * 01400020
*                                                                     * 01500020
         AIF   ('&GEN' NE 'VTAM').TAG0                           X03039 01502008
*  MODULE NAME = IEDIAQ (VTAM)                                   X03039 01504008
         AGO   .TAG3                                             X03039 01506008
.TAG0    ANOP                                                    X03039 01508008
         AIF   ('&GEN' NE 'MINI').TAG1                                  01510005
*  MODULE NAME = IGG019Q6 (MINI)                                      * 01520005
         AGO   .TAG3                                                    01530005
.TAG1    AIF   ('&GEN' NE 'NTSO').TAG2                                  01540005
*  MODULE NAME = IGG019Q7 (NTSO)                                      * 01550005
         AGO   .TAG3                                                    01560005
.TAG2    ANOP                                                           01570005
*  MODULE NAME = IGG019R4 (MAXI)                                      * 01580005
.TAG3    ANOP                                                           01590005
*                                                                     * 01600005
*  DESCRIPTIVE NAME = SEND SCHEDULER                                  * 01610005
*                                                                     * 01620005
*  COPYRIGHT = 'NONE'                                                 * 01630005
*                                                                     * 01640005
*STATUS -- CHANGE LEVEL 8                                      @Z30X8IG 01650008
*                                                                     * 01700020
         AIF   ('&GEN' EQ 'VTAM').VFUNC                          X03039 01750008
*FUNCTION -- TO SCHEDULE A SENDING OPERATION AND TO FIND THE ADDRESS  * 01800020
*   OF THE DESTINATION LCB WHEN A MESSAGE IS POSTED TO A DESTINATION  * 01900020
*   QUEUE OR WHEN A DIAL QCB COMES OUT OF A TIME DELAY.               * 02000020
         AGO   .ENTPNT                                           X03039 02010008
.VFUNC   ANOP                                                    X03039 02020008
*FUNCTION -- TO SCHEDULE A SENDING OPERATION AND TO REQUEST A    X03039 02030008
*   LOGON IF NEEDED TO PERFORM THE SEND OPERATION.               X03039 02040008
.ENTPNT  ANOP                                                    X03039 02050008
*                                                                     * 02100020
*ENTRY POINTS --                                                      * 02200020
*   FIRST EXECUTABLE INSTRUCTION                                      * 02300020
*                                                                     * 02400020
         AIF   ('&GEN' EQ 'VTAM').VENTPT2                        X03039 02450008
*   'LCBSCAN'  WHEN CALLED BY DESTINATION ASSIGNMENT OR BY THE SEND   * 02500020
*   SCHEDULER (INITIATE MODE AND FOR A DIAL QCB).                     * 02600020
         AGO   .INPUT                                            X03039 02610008
.VENTPT2 ANOP                                                    X03039 02620008
*   'LCBSCAN' WHEN CALLED BY DESTINATION ASSIGNMENT, THE TIME    X03039 02630008
*   DELAY SUBTASK, OR THE SEND SCHEDULER ITSELF.                 X03039 02640008
.INPUT   ANOP                                                    X03039 02650008
*                                                                     * 02700020
*INPUT --                                                             * 02800020
*   WHEN ACTIVATED BY THE DISPATCHER -                                * 02900020
*   R1 POINTS TO BUFFER, LCB OR QCB                                   * 03000020
*   R11  DISPATCHER BASE                                              * 03100020
*   R13  ADDRESS OF AVTSAVE2                                          * 03200020
*   R15  ENTRY POINT ADDRESS                                          * 03300020
*   'LCBSCAN' -                                                       * 03400020
*   R7  ADDRESS OF QCB                                                * 03500020
*   R13  ADDRESS OF AVTSAVE2                                          * 03600020
*   R14  RETURN ADDRESS                                               * 03700020
*   R15  ADDRESS OF LCBSCAN                                           * 03800020
*                                                                     * 03900020
*OUTPUT --                                                            * 04000020
*   WHEN ACTIVATED BY THE DISPATCHER                                  * 04100020
*   R11  ADDRESS OF DISPATCHER                                        * 04200020
*   R13  ADDRESS OF AVTSAVE2                                          * 04300020
*                                                                     * 04400020
*   'LCBSCAN' -                                                       * 04500020
*   R13  ADDRESS OF AVTSAVE2                                          * 04600020
*   R14  RETURN ADDRESS                                               * 04700020
*                                                                     * 04800020
*EXITS-NORMAL --                                                      * 04900020
*   WHEN CALLED BY DISPATCHER                                         * 05000020
*   R13  ADDRESS OF AVTSAVE2                                          * 05100020
*   R11  DISPATCHER BASE                                              * 05200020
*   RETURN IS MADE ON R11 WITH AN OFFSET TO HAVE THE DISPATCHER       * 05300020
*   PERFORM THE DESIRED FUNCTION.                                     * 05400020
*                                                                     * 05500020
*   'LCBSCAN'                                                         * 05600020
*   R11  DISPATCHER BASE                                              * 05700020
*   R13  ADDRESS OF AVTSAVE2                                          * 05800020
*   R14  RETURN ADDRESS                                               * 05900020
*   BR  R14                                                           * 06000020
*                                                                     * 06100020
*EXTERNAL ROUTINES --                                                 * 06200020
*   'IEDQTNT' - TO CONVERT A TWO BYTE TNT OFFSET TO TERMINAL ENTRY    * 06300020
*   ADDRESS                                                           * 06400020
*                                                                     * 06500020
         AIF   ('&GEN' EQ 'VTAM').VEXTRTN                        X03039 06550008
*   'IOHALT' MACRO - TO HALT AN ENABLE OR PREPARE COMMAND IN          * 06600020
         AGO   .EXITS                                            X03039 06610008
.VEXTRTN ANOP                                                    X03039 06620008
*   'IEDQHG01' - TO PUT THE QCB ON THE TIME DELAY QUEUE WHEN     X03039 06630008
*   MSGLIMIT IS REACHED ON OUTPUT.                               X03039 06640008
*                                                                X03039 06650008
*   'IEDIAF2' - TO ISSUE A RESET CONDITIONAL.                    X03039 06660008
.EXITS   ANOP                                                    X03039 06670008
*                                                                     * 06700020
*EXITS-ERROR -- NONE                                                  * 06800020
*                                                                     * 06900020
*TABLES/WORK AREAS --VARIOUS CONTROL BLOCKS EXPANDED BY MACROS        * 07000020
*   TAVTD                                                             * 07100020
*   TCCWD                                                             * 07200020
*   DCBD                                                              * 07300020
*   TDEBD                                                             * 07400020
*   TLCBD                                                             * 07500020
*   TPRFD                                                             * 07600020
*   TQCBD                                                             * 07700020
*   TSCBD                                                             * 07800020
*   TSTCBD                                                            * 07900020
*   TTRMD                                                             * 08000020
*   TTSID                                                      @Z30X8IR 08050008
*                                                                     * 08100020
*ATTRIBUTES -- RE-USABLE, REFRESHABLE, ENABLED, PROBLEM PROGRAM MODE  * 08200020
*                                                                     * 08300020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 08400020
*   PARTICUALR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 08500020
*   SET.                                                              * 08600020
*                                                                     * 08700020
*   ROUTINES CALLING THE LCBSCAN ROUTINE EXPECT THE OFFSET TO    X03039 08800008
*   LCBSCAN ALWAYS TO BE THE FIRST TWO BYTES OF THE SEND         X03039 08900008
*   SCHEDULER.                                                   X03039 09000008
*                                                                     * 09200020
*********************************************************************** 09300020
         EJECT                                                          09400020
         DC    AL2(LCBSCAN-&NAME) .     USED BY OPEN TO                 09500020
*                                         SET ADDRESS IN AVT            09600020
*                                 REGISTER EQUATES                      09700020
         SPACE 1                                                        09800020
         AIF   ('&GEN' NE 'VTAM').REG0                         @Z30X8IR 09820008
RSELECT  EQU   0                  IEDAYG ENTRY PNT INDEX REG   @Z30X8IR 09840008
.REG0    ANOP                                                  @Z30X8IR 09860008
R0       EQU   0                  FLAG REG                              09900020
RTEMP    EQU   1                        WORK REGISTER                   10000020
RWORK    EQU   2                        WORK REGISTER                   10100020
         AIF   ('&GEN' NE 'VTAM').EQRSTCB                        X03039 10120008
RQCBP    EQU   2                        QCB PREFIX REGISTER      X03039 10130008
RSCB     EQU   3                        SCB REGISTER FOR LCBSCAN X03039 10140008
RRTN     EQU   3                  RETURN REG FOR IEDAYG        @Z30X8IR 10150008
.EQRSTCB ANOP                                                    X03039 10160008
RSTCB    EQU   3                  STCB BASE                             10200020
RLCB     EQU   4                  LCB BASE                              10300020
R5       EQU   5                        WORK REGISTER                   10400020
R6       EQU   6                                                    TSO 10500020
RQCB     EQU   7                  QCB ADDR                              10600020
RHOLD    EQU   8                  FIRST LCB SCANNED FOR AVAILABLE       10700020
RLAST    EQU   9                  COUNT OF LCB'S TO SCAN                10800020
RDCB     EQU   10                 DCB BASE                              10900020
RSUPBASE EQU   11                 DISPATCHER BASE REG                   11000020
RBASE    EQU   12                 SUBTASK BASE REG                      11100020
R13      EQU   13                 SAVE AREA ADDR (AVTSAVE2)             11200020
R14      EQU   14                 RETURN ADDR REG                       11300020
R15      EQU   15                 ENTRY BASE REG                        11400020
CLEAR0F  EQU   X'0F'                                             S22025 11450022
         SPACE 1                                                        11500020
         SPACE 2                                                        11600020
         USING IEDQSTCB,RSTCB                                           11700020
         USING IEDQLCB,RLCB                                             11800020
         USING IEDQQCB,RQCB                                             11900020
         USING IHADCB,RDCB                                              12000020
         USING IEDQDISP,RSUPBASE                                        12100020
         USING AVTSAVE2,R13                                             12200020
         USING *,R15                    TEMPORARY USING          Y05330 12300005
         BAL   RBASE,ID                 BYPASS ID / SET BASE     Y05330 12400005
TAG      EQU   *                                               @OY19438 12450082
         USING *,RBASE                  SET NEW USING            Y05330 12500005
         DROP  R15                                               Y05330 12600005
         SPACE 1                                                 Y05330 12700005
&NAME    IEDHJN                                                         12800005
ID       DS    0H                                                Y05330 12900005
         LA    RSTCB,IEDQSTCB     ZERO HI-ORDER BYTE                    13000020
         LA    RQCB,QCBSTVTO-IEDQQCB GET QCB'S STCB OFFSET              13100020
         LCR   RQCB,RQCB          SET NEGATIVE                          13200020
         AR    RQCB,RSTCB         BACK UP TO QCB BASE                   13300020
         SPACE 2                                                        13400020
*** ANALYZE THE PASSED ELEMENT.  IT MIGHT BE:                           13500020
*        1. BUFFER (+8 IS A 'TIC' COMMAND CODE)                         13600020
*             IF END OF MESSAGE, SEARCH FOR AN AVAILABLE LINE ON SHICH  13700020
*             TO SEND.                                                  13800020
*        2. LCB (+8 IS THE RECEIVE SCHEDULER'S STCBVTO)                 13900020
*             LOOK FOR THE MESSAGE TO SEND, AND TELL DISK ROUTINES TO   14000020
*             START READING MESSAGE.                                    14100020
         AIF   ('&GEN' EQ 'MINI').L5                                    14200020
*        3. QCB (+8 IS THE SEND SCHEDULER'S STCBVTO)                    14300020
*             SEND TIME DELAY HAS JUST EXPIRED.  LOOK FOR AN AVAILABLE  14400020
*             LINE ON WHICH TO CONTACT THE DIAL TERMINAL.               14500020
         SPACE 1                                                        14600020
         AIF   ('&GEN' EQ 'VTAM').VTAMVTO                        X03039 14650008
         CLI   PRFTIC-IEDQPRF(RTEMP),DSPSNDSC IS THIS A QCB?        TSO 14700020
         AGO   .QCBBR                                            X03039 14720008
.VTAMVTO ANOP                                                    X03039 14740008
         CLI   PRFTIC-IEDQPRF(RTEMP),DSPVSSCH IS THIS A QCB      X03039 14760008
.QCBBR   ANOP                                                    X03039 14780008
         BE    QCBTSO                   BRANCH IF IT IS A QCB       TSO 14800020
.L5      ANOP                                                           14900020
         CLI   LCBPRI-IEDQLCB(RTEMP),PRILNFRE  LCB                      15000020
         BE    SENDSCH                  YES                             15100020
         L     RLCB,PRFLCB-1-IEDQPRF(,RTEMP) LCB ADDRESS                15200020
         TM    LCBSTAT1,LCBINITN        INITIATE MODE                   15300020
         BZ    EXIT                     NO                              15400020
         LA    R15,LCBSCAN              ADDRESSABILITY                  15500020
         ST    RQCB,AVTDOUBL            SAVE QCB ADDRES                 15600020
         AIF   ('&GEN' EQ 'VTAM').STCBTSO                               15610091
         L     R6,QCBSLINK-1                                   @OZ09912 15620091
         LR    R5,RTEMP                 SAVE VALUE             @OZ09912 15630091
         AGO   .STCB2                                          @OZ09912 15640091
.STCBTSO ANOP                                                  @OZ09912 15650091
         ST    RTEMP,AVTDOUBL+4         SAVE BUFFER ADDRESS    @AS09778 15700009
.STCB2   ANOP                                                  @OZ09912 15800091
         BALR  R14,R15                  LINK TO FIND LCB                15900020
         L     RQCB,AVTDOUBL            SET  QCB ADDRES                 16000020
         AIF   ('&GEN' EQ 'VTAM').STCB3                        @OZ09912 16010091
         LR    RTEMP,R5                 RESTORE VALUE          @OZ09912 16020091
         LR    RSTCB,R6                 RESTORE VALUE          @OZ09912 16030091
         AGO   .STCB4                                          @OZ09912 16040091
.STCB3   ANOP                                                  @OZ09912 16050091
         L     RTEMP,AVTDOUBL+4         RESTORE BUFFER ADDR    @AS09778 16100009
         L     RSTCB,QCBSTCHN-1         1ST STCB ON DEST QCB   @AS09778 16120009
         CLI   0(RSTCB),DSPMCPL6        IS IT IEDQHM'S STCB    @AS09778 16140009
         BNH   FOUNDHM                  BRANCH IF YES          @OZ09912 16160091
         L     RSTCB,QCBSLINK-1         NO, GET HM'S STCB      @AS09778 16180009
*                                       FROM STCB LINK FIELD   @AS09778 16200009
FOUNDHM  EQU   *                                               @AS09778 16220009
.STCB4   ANOP                                                  @OZ09912 16260091
         B     DSPBYPAS                 DISPATCH NEXT SSTCB             16300020
         AIF   ('&GEN' EQ 'MINI').L7                                    16400020
QCBTSO   LA    R15,LCBSCAN              ESTABLISH ADDRESSABILITY    TSO 16500020
         LA    R14,DSPDISP              SET EXIT FROM SUBROUTINE        16600020
        AIF   ('&GEN' EQ 'NTSO').L6                                     16700020
         TM    QCBFLAG,QCBTSSES         IS THIS FOR TIME SHARING?   TSO 16800020
         BZ    SETEXIT                  BRANCH IF NO                    16900020
         NI    QCBTSOF2,X'FF'-QCBPOSTO  TURN OFF QCB POSTED BIT     TSO 17000020
         B     TSO1                                                 TSO 17100020
.L6      ANOP                                                           17200020
         SPACE 1                                                        17300020
*** A QCB QPOST'ED TO ITSELF IS ASSUMED                                 17400020
         SPACE 1                                                        17500020
SETEXIT  EQU   *                                                        17600020
         EJECT                                                          17900020
.L7      ANOP                                                           18000020
         USING *,R15                                                    18100020
LCBSCAN  EQU   *                                                        18200020
         LA    RQCB,0(,RQCB)            LCRER HI ORDER BYTE FOR COM     18300020
         TM    QCBDSFLG,QCBHELD         REUS USING QCB ?       @SA70324 18330061
         BOR   R14                      YES, EXIT              @SA70324 18360061
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'NTSO').L8                18400020
         TM    QCBDSFLG,QCBDISK+QCBCORE TIME-SHARING QUEUES?        TSO 18500020
         BCR   8,R14                    YES. RETURN TO CPB INIT     TSO 18600020
         TM    QCBFLAG,QCBTSSES .      QCB IN TSO SESSION        S22029 18630022
         BCR   7,R14 .                 YES RETURN TO CPB INIT    S22029 18660022
         SPACE                                                          18700020
TSO1     EQU   *                                                    TSO Ø 0020
.L8      ANOP                                                           18900020
         AIF   ('&GEN' EQ 'VTAM').VSCAN                          X03039 18950008
         L     RDCB,QCBDCBAD-1    GET DCB ADDR                          19000020
         TM    DCBOFLGS,OPEN      IS DCB OPEN                           19100020
         BCR   8,R14                    NO EXIT                         19200020
RETRY    EQU   *                                                        19300020
         L     RTEMP,DCBDEBAD     GET DEB ADDR                          19400020
         USING DEBNMSUB,RTEMP                                           19500020
         TM    DEBOPATB,OUTPUT          OPENED FOR OUTPUT               19600020
         BCR   8,R14                    NO, RETURN                      19700020
         DROP  RTEMP                                                    19800020
         SR    RLAST,RLAST        ZERO COUNT REG                        19900020
         IC    RLAST,X'10'(,RTEMP)      DEB NUMBER OF EXTENTS           20000020
         SR    RTEMP,RTEMP        ZERO ODD REG                          20100020
         IC    RTEMP,QCBRELLN     GET QCB'S STARTING RLN                20200020
         LR    RLCB,RTEMP               COPY RLN FOR NEXT TEST          20300020
         BCTR  RLCB,R0                  RLN MINUS 1                     20400020
         SR    RLAST,RLCB               GET COUNT OF LCB'S TO SCAN      20500020
         BCR   13,R14                   NO, EXIT                        20600020
         SR    RWORK,RWORK        ZERO SIZE REG                         20700020
         IC    RWORK,DCBEIOBX     GET LCB SIZE                          20800020
         MR    RTEMP-1,RWORK      GET STARTING LCB OFFSET               20900020
         AL    RTEMP,DCBIOBAD           POINT TO IOB OF LCB             21000020
         SH    RTEMP,LCBSIZE            ADJUST TO START OF LCB          21100020
         LR    RLCB,RTEMP               LCB BASE                        21200020
         AIF   ('&GEN' EQ 'MINI').LNODL                                 21300020
         SR    RHOLD,RHOLD              CLEAR WORK REGISTER             21400020
        AIF   ('&GEN' EQ 'NTSO').L9                                     21500020
         TM    QCBDSFLG,QCBDISK+QCBCORE TIME-SHARING QUEUES?        TSO 21600020
         BZ    NONDIAL                  YES. TREAT AS IF LEASED     TSO 21700020
         TM    QCBFLAG,QCBTSSES .      QCB IN TSO SESSION        S22029 21730022
         BO    NONDIAL .               YES TREAT AS LEASED       S22029 21760022
.L9      ANOP                                                           21800020
         TM    LCBSTAT2,LCBDIAL   ARE THESE DIAL LINES                  21900020
         BZ    NONDIAL            NO, THIS IS THE LINE                  22000020
         CLI   QCBSTPRI,CALLOPT         CLOCK OR INTERVAL       SA56891 22100022
         BL    DIALLOOP                 BRANCH IF NOT           SA56891 22200022
         OI    QCBSTAT,QCBSCHDL         FORCE RECEIVE OPERATION SA56891 22300022
*                                         PRIOR TO SENDING      SA56891 22400022
DIALLOOP EQU   *                                                        22600020
         TM    LCBTSTSW,CONNECT         LCB CONNECTED                   22700020
         BZ    NOTCONNT                  NOT CONNECTED                  22800020
         SPACE                                                          22900020
         LH    RTEMP,LCBTTCIN           CURRENTLY CONNECTED             23000020
         LTR   RTEMP,RTEMP              ORIGIN SPECIFIED                23100020
         BZ    TRYNEXT                  NO                              23200020
         STM   14,15,AVTSAVE3           SAVE REGISTERS                  23300020
         SPACE                                                          23400020
         L     R15,AVTRNMPT             CONVERT ROUTINE                 23500020
         BALR  R14,R15                  GET TERMINAL CADDRESS           23600020
         LM    14,15,AVTSAVE3            SET REGISTERS                  23700020
         L     RTEMP,TRMDESTQ-1-IEDQTRM(,RTEMP) QCB ADDRESS             23800020
         LA    RTEMP,0(,RTEMP)          CLEAR HI ORDER BYTE FOR CR      23900020
         CR    RTEMP,RQCB               ARE WE CONNECTED TO THIS        24000020
         BNE   TRYNEXT                  NO CONNECTION                   24100020
         SPACE                                                          24200020
         NI    QCBSTAT,AVTEFF-QCBSCHDL  TNT WOURCE SET                  24300020
         AIF   ('&GEN' EQ 'NTSO').L9A                          @OS77835 24310091
         TM    QCBFLAG,QCBNOBRK         CAN TERMINAL BE BROKEN @OS77835 24320091
         BO    LEAVE                    NO,EXIT                @OS77835 24330091
         TM    LCBTSOB,LCB2741N         2741?                  @OS77835 24340091
         BO    NONDIAL                  YES,TREAT AS LEASED    @OS77835 24350091
.L9A     ANOP                                                  @OS77835 24360091
         B     LEAVE                    EXIT                            24400020
         SPACE                                                          24500020
NOTCONNT EQU   *                                                        24600020
         CLI   QCBSTPRI,CALLPRI         CALL=NONE SPECIFIED             24700020
         BE    TRYNEXT                  BRANCH YES                      24800020
         TM    LCBSTCBA+TWO,CLOSEDWN    LINE STOPPED BY        @SA71683 24820061
*                                        CLOSEDOWN ?           @SA71683 24840061
         BO    TRYNEXT                  BR IF YES              @SA71683 24860061
         LTR   RHOLD,RHOLD              PREVIOUS LCB SELECTED           24900020
         BNZ   TRYNEXT                  YES,ALREADY HAVE AVAILABEL      25000020
         LR    RHOLD,RLCB               SAVE FOUND LCB                  25100020
TRYNEXT  EQU   *                                                        25200020
         AR    RLCB,RWORK               ADDRESS OF NEXT LCB             25300020
         BCT   RLAST,DIALLOOP           LOOK AT NEXT LCB                25400020
         LTR   RLCB,RHOLD               WAS AVAILABLE LINE FOUND        25500020
         BZ    CALLQ                    BRANCH NO                       25600020
         LA    RTEMP,DSPDISP            GET DISPATCHER EXIT    @OY12421 25610091
         CR    RTEMP,R14                WAS THIS A QCB ENTRY   @OY12421 25620091
         BE    NOHOLD                   BRANCH-YES DO DIAL UP  @OY12421 25630091
         TM    QCBSTAT,QCBTRMHO         IS TERMINAL HELD       @OY12421 25640091
         BO    CALLQ                    BRANCH YES             @OY12421 25650091
NOHOLD   EQU   *                                               @OY12421 25660091
         TS    LCBTSTSW                 LINE STILL AVAILABLE            25700020
         BNZ   RETRY                    LOOP AGAIN ON LINE GROUP        25800020
         OI    LCBSTAT2,LCBNEGRP        SET NEGATIVE RESPONSE IN        25900020
*                                         CASE TERMINAL IS HELD         26000020
*                                         IF NOT SET, AN ERRONEOUS      26100020
*                                         'CONNECTION' APPEARS TO       26200020
*                                         RCV SCHED AND ACTIVATE        26300020
         NI    LCBTPCD+11,AVTEFF-DISDLEOT DONT SEND DLE EOTSINCE WE     26400020
*                                         ARE NOT DISCONNECTING         26500020
*                                         A CALL                        26600020
         TM    LCBSTAT1,LCBFREEN .      LCB FREE                        26700022
         BZ    HALTLINE .               BRANCH IF NO TO HIO      S22025 26800022
         B     POSTLCB                  GET LCB                         26900020
         SPACE                                                          27000020
CALLQ    EQU   *                                                        27100020
         L     RSTCB,DCBIOBAD           1ST IOB                         27200020
         AR    RSTCB,RWORK              POINT TO 1ST IOB                27300020
         SH    RSTCB,DOCQAD             BACK UP TO CALL Q               27400020
         B     DSPUNAVR                 USE UNAVAIL AND RETURN          27500020
*                                         TO CALLER                     27600020
         SPACE                                                          27700020
NONDIAL  EQU   *                                                        27800020
.LNODL   ANOP                                                           27900020
         TM    LCBSTCBA+TWO,CLOSEDWN    LINE STOPPED BY        @SA71683 27920061
*                                        CLOSEDOWN?            @SA71683 27940061
         BOR   R14                      BR IF YES              @SA71683 27960061
         CLI   LCBRSPRI,SENDPRI         LINE HAVE SEND PRIORITY         28000020
         BH    OBTAIN             NO, GO GET THE LINE                   28100020
         OI    LCBSTAT2,LCBSNDPR  SET SEND SCHEDULER WANTS LINE         28200020
OBTAIN   EQU   *                                                        28300020
         AIF   ('&GEN' EQ 'NTSO' OR '&GEN' EQ 'MINI').L10               28400020
         TM    QCBFLAG,QCBTSSES         IS THIS TIME SHARING?       TSO 28500020
         BZ    TSO2                     BRANCH ON NO                TSO 28600020
         L     R6,AVTTSOPT              ADDRESS OF TSINPUT QCB      TSO 28700020
         L     R6,TSISCHED-IEDQTSI(,R6) ADDRESS OF TS SCHEDULER     TSO 28800020
         BAL   RSTCB,8(,R6)             BRANCH TO ROUTINE           TSO 28900020
TSO2     EQU   *                                                    TSO 29000020
.L10     ANOP                                                           29100020
         TM    LCBSTAT1,LCBFREEN .      IS LINE FREE             S22025 29200022
         BZ    TESTPOLL .               NO, GO LOOK FOR NON-REGULS22025 29260022
*                                       AR INTERUPTING TERMINALS S22025 29320022
*                                      INTERRUPTING TERMINALS           29400020
POSTLCB  EQU   *                                                        29500020
         XI    LCBSTAT1,LCBSENDN+LCBFREEN . CHANGE LCB STATE TO  S22025 29600022
*                                         A MULTIPE POST OF LCB         29700020
         MVI   LCBPRI,PRILNFRE          POST PRIORITY                   29800020
         ST    14,AVTSAVE3+4            SAVE REGISTER                   29900020
         ST    RQCB,AVTSAVE3            SAVE REGISTER                   30000020
         ST    RLCB,LCBQCBA-1           LCB IS QCB                      30100020
         LR    1,RLCB                   PARAMETER FOR POST              30200020
         BAL   R14,DSPPOSTR             PUT LCB ON READY Q              30300020
         L     RQCB,AVTSAVE3            SET  REGISTER                   30400020
         L     14,AVTSAVE3+4            SET  REGISTER                   30500020
         B     LEAVE                    EXIT                            30600020
         SPACE                                                          30700020
TESTPOLL EQU   *                                                        30800020
         CLI   LCBCPA+24,POLL           LINE IN AUTOPOLL                30900020
         BNE   BASIC                    BRANCH NO                       31000020
         SPACE                                                          31100020
         ST    RLCB,AVTSAVE2            LCB POINTER              Y05331 31104005
         L     RWORK,AVTSAVTP           POINTER TO SECONDARY AVT Y05331 31108005
         USING IEDNSVTD,RWORK                                    Y05331 31112005
         TM    SAVTDIAF,SAVTVIRT        IN VM ENVIRONMENT?       Y05331 31116005
         BNO   NOVIRT                   NO, BRANCH               Y05331 31120005
         STM   R14,R15,AVTSAVE2+24      SAVE REGISTERS 14 AND 15 Y05331 31124005
         LA    R0,LCBCPA+56             TIC ADDRESS              Y05331 31148005
         L     R15,SAVTDIAG             VIRTUAL DIAGNOSE ROUTINE Y05331 31152005
         DROP  RWORK                                             Y05331 31156005
         MVI   LCBCPA+56,CCWNOP         NOP 2ND VIRTUAL TIC      Y05331 31160005
         BAL   R14,4(,R15)              NOP CORRESPONDING REAL   Y05331 31164005
*                                         TIC                    Y05331 31168005
         LM    R14,R15,AVTSAVE2+24      RESTORE REGISTERS 14,15  Y05331 31172005
         B     LEAVE                    EXIT                     Y05331 31176005
         SPACE                                                          31180005
NOVIRT   EQU   *                                                 Y05331 31184005
         MVI   LCBCPA+56,CCWNOP         NOP 2ND TIC                     31300020
         B     LEAVE                    EXIT                            31400020
         SPACE                                                          31500020
BASIC    EQU   *                                                        31600020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        31700020
         BZ    NOTBSC                   BRANCH NO                       31800020
         SPACE                                                          31900020
         CLI   LCBCPA+16,CCWPREP        RECEIVE STATE                   32000020
         BNE   LEAVE                    NO                              32100020
         TS    LCBTSTSW                 LINE FREE                       32200020
         BNZ   LEAVE                    BRANCH BUSY                     32300020
         B     HALTLINE                 ISSUE HALT IO                   32400020
NOTBSC   EQU   *                                                        32500020
         CLI   LCBCPA+24,CCWSENSE       SENSE COMMAND                   32600020
         BE    CHKSENSE                 YES, SEE IF NIO REQUIRED        32700020
         CLI   LCBCPA+32,CCWSENSE       START STOP CONTENTION           32800020
*                                         MAY BE REQUIRED)              32900020
         AIF   ('&GEN' EQ 'MAXI').L11A                                  33000020
         BNE   LEAVE .                  BRANCH IF NOT A BASIC           33100020
*                                                                       33300020
         AGO   .L11B                                                    33380020
.L11A    ANOP                                                           33460020
         BNE   CKTSO .                  BRANCH IF NOT A BASIC           33540020
.L11B    ANOP                                                           33620020
CHKSENSE EQU   *                                                        33700020
         TM    LCBCSWSV,AVTEFF          SENSE BEEN EXECUTED             33800020
         AIF   ('&GEN' NE 'MAXI').L11                                   33860020
         BNO   CKTSO                    BRANCH IF SENSE DONE   @YA08088 33920009
         TM    QCBFLAG,QCBTSSES         TSO OPERATION          @YA08088 33922009
         BO    HALTLINE                 IF SO, ISSUE HIO       @YA08088 33924009
         TM    LCBTSOB,LCB2741N         IS THIS A 2741         @YA08088 33926009
         BNO   HALTLINE                 IF NOT,ISSUE HIO       @YA08088 33928009
CKTSO    EQU   *                                                        33930020
         TM    LCBSTAT1,LCBRECVN .      IS LINE RECEIVING           TSO 33964020
         BZ    LEAVE .                  BRANCH IF NO                TSO 33968020
         TM    LCBSTAT2,LCBMSGNN .      MSGEN IN PROGRESS           TSO 33972020
         BO    LEAVE .                  BRANCH IF YES                   33976020
         SPACE                                                          33980020
         TM    QCBFLAG,QCBNOBRK         CAN TERMINAL BE BROKEN?    2741 34000020
         BO    LEAVE                    BRANCH ON NO               2741 34020020
         L     RWORK,LCBLSPCI-1         GET ADDRESS OF FIRST BUFFER2741 34040020
         LA    RWORK,0(,RWORK) .        TEST ADDRESS ONLY         M2173 34045093
         LTR   RWORK,RWORK .            TEST FOR ADDRESS          M2173 34050093
         BZ    LEAVE .                  IF NO BFR, CAN NOT BREAK  M2173 34055093
         TM    PRFSTAT1-IEDQPRF(RWORK),PRFNHDRN IS IT FIRST BUFFER?2741 34060020
         BO    LEAVE                    BRANCH ON NO               2741 34080020
         L     RTEMP,PRFIOADR-1-IEDQPRF(,RWORK) GET DATA ADDR  @OS77835 34100091
         N     RTEMP,CLRHI              GET OFFSET IN PAGE     @OS77835 34105091
         N     RWORK,CLRLOW             GET ADDR OF PAGE       @OS77835 34110091
         AR    RWORK,RTEMP              GET DATA ADDRESS       @OS77835 34115091
         CLI   1(RWORK),0               HAS USER ENTERED ANY DATA? 2741 34120020
         BNE   LEAVE                                                    34140020
         TM    QCBFLAG,QCBTSSES         TSO IN CONTROL?        @OS77835 34142091
         BO    HALTLINE                 YES,CONTINUE           @OS77835 34144091
         TM    LCBTSOB,LCB2741N         2741?                  @OS77835 34146091
         BZ    LEAVE                    NO,EXIT                @OS77835 34148091
         AGO   .L11C                                                    34150020
.L11     ANOP                                                           34160020
         BNO   LEAVE                                                    34166020
         TM    LCBTSOB,LCB2741N         IS THIS A 2741         @YA08088 34168009
         BO    LEAVE                    IF SO, DO NOT HIO      @YA08088 34170009
.L11C    ANOP                                                           34172020
HALTLINE EQU   *                                                        34180020
         SR    RWORK,RWORK              CLEAR FOR INDEXING              34800020
         IC    RWORK,LCBUCBX            RLN MINUS 1                     34900020
         SLL   RWORK,2                   MULTIPLY BY 4 FOR INDEX        35000020
         L     RTEMP,DCBDEBAD           DEB ADDRESS                     35100020
         L     RTEMP,X'20'(RTEMP,RWORK) UCB ADDRESS                     35200020
         LA    RTEMP,0(,RTEMP)          CLEAR HI ORDER BYTE             35230020
*                                         ENSURE POSTIVE POINTER        35260020
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'NTSO').L13               35300020
         TM    19(RTEMP),AVTEFF-AIBM1   CAN DEVICE BE A 1050 OR 2741TSO 35330020
         BNZ   ISSUESVC                 BRANCH ON NO                TSO 35360020
         CLI   16(RTEMP),T1050          IS IT A 1050                TSO 35390020
         BNE   TEST2741                 NO,BRANCH              @OS77835 35420091
         TM    QCBFLAG,QCBTSSES         TSO IN CONTROL?        @OS77835 35422091
         BO    SETBRK                   YES,BRANCH             @OS77835 35424091
TEST2741 EQU   *                                               @OS77835 35426091
         CLI   16(RTEMP),T2741C .       IS IT A 2741 CORRES         TSO 35430020
         BE    SETBRK .                 BRANCH IF YES               TSO 35440020
         CLI   16(RTEMP),T2741B .       IS IT A 2741 BCD            TSO 35450020
         BNE   ISSUESVC .               BRANCH IF NO                TSO 35460020
SETBRK   EQU   *                                                    TSO 35510020
         TM    QCBFLAG,QCBNOBRK .       CAN WRITE BREAK BE USED  A42390 35540030
         BO    ISSUESVC .               BRANCH NO                A42390 35570030
         OI    LCBTSOB,LCBWRBRK         SET SWITCH FOR LINE END 2741    35600020
.L13     ANOP                                                           35650020
ISSUESVC EQU   *                                                   2741 35700020
         DROP  R15                                              SA65412 35710052
         LR    RSTCB,R15                COPY BASE ADDRESS       SA65412 35720052
         USING LCBSCAN,RSTCB                                    SA65412 35730052
*                                         PREVENT LOSS OF LINE IF       35733006
*                                         ERROR OCCURRED AND LCB IS     35736006
*                                         ON WAY TO ERP OR UNDER ERP    35739006
*                                         CONTROL                       35742006
         MVI   LCBECBCC,HIOCC           SET HALT I/O COMPLETION  Y02027 35745006
         IOHALT (1)                                                     35750020
         LTR   R15,R15                  RETURN CODE ZERO       @ZA02054 35758061
         BZ    HIODONE                  BR YES, HIO COMPLETE   @ZA02054 35766061
         SR    R15,R15                  CLEAR FOR COMPARE      @ZA02054 35774061
         CLM   R15,15,LCBCSW+THREE      CHANNEL PROGRAM STILL  @ZA02054 35782061
*                                       OUTSTANDING            @ZA02054 35790061
         LR    R15,RSTCB                COPY BASE REGISTER     @ZA02054 35798061
         BZ    HALTLINE                 BR YES, REISSUE IOHALT @ZA02054 35806061
HIODONE  EQU   *                                               @ZA02054 35814061
         LR    R15,RSTCB                BASE REGISTER           SA65412 35830052
         DROP  RSTCB                                            SA65412 35840052
         USING LCBSCAN,R15                                      SA65412 35850052
         USING IEDQSTCB,RSTCB                                   SA65412 35860052
         AGO   .NOTVTAM                                          X03039 35860508
.VSCAN   ANOP                                                    X03039 35861008
         L     RTEMP,AVTSAVTP           SECONDARY AVT ADDRESS    X03039 35861508
*                                                                X03039 35862008
         USING IEDNSVTD,RTEMP           ADDRESSABILITY FOR SAVT  X03039 35862508
         L     RDCB,SAVTACB             ACB ADDRESS              X03039 35863008
         DROP  RTEMP                                           @ZA03122 35863209
*                                       ACB OPEN                 X03039 35863508
         TM    ACBOFLGS-IFGACB(RDCB),ACBOPEN                     X03039 35864008
         BNOR  R14                      BR NO                    X03039 35864508
*                                                                X03039 35865008
         LA    RQCBP,QCBPRFSZ           QCB PREFIX SIZE          X03039 35865508
         LNR   RQCBP,RQCBP              MAKE NEGATIVE FOR BACKUP X03039 35865808
         AR    RQCBP,RQCB               BACK UP TO QCB PREFIX    X03039 35866108
*                                                                X03039 35866509
         USING IEDNQCB,RQCBP            ESTABLISH ADDRESSABILITY X03039 35866609
         TM    QCBSTAT1,QCBNIDLE        LINE STOPPED             X03039 35866709
         BZR   R14                      BR YES                   X03039 35866809
*                                                                X03039 35866909
         TM    QCBSTAT,QCBTRMHO         TERMINAL HELD            X03039 35867009
         BOR   R14                      BR YES                   X03039 35867109
*                                                                X03039 35867209
         TM    QCBSTAT1,QCBPLCBN        IS DEST LOGGED ON        X03039 35867309
         BZ    REQLOGON                 BRANCH NO                X03039 35867409
*                                                                X03039 35867509
         L     RLCB,QCBPLCBA-1          PLCB ADDRESS             X03039 35867609
         LR    RHOLD,R14                SAVE RETURN REGISTER   @ZA03122 35867709
         LH    RTEMP,LCBTTCIN           GET TNT OFFSET         @ZA03122 35868009
         N     RTEMP,AVTCLRHI           CLEAR HI ORDER BYTES   @ZA03122 35868109
         LR    R6,R15                   SAVE BASE REGISTER     @ZA03122 35868209
         L     R15,AVTRNMPT             ADDR OF TNT            @ZA03122 35868309
         BALR  R14,R15                  GET TERM ENTRY ADDR    @ZA03122 35868509
         LR    R14,RHOLD                RESTORE RETURN REGISTER@ZA03122 35868609
         LR    R15,R6                   RESTORE BASE REG       @ZA03122 35868709
         USING IEDNTRM,RTEMP            TERMINAL DSECT BASE    @ZA03122 35868809
         SH    RTEMP,AVTHA4             BACK UP TO TRM PREFIX  @ZA03122 35868909
         TM    TRMSTAT1,TRMSESSN        IS TERMINAL IN SESSION @ZA03122 35869009
         BZ    TMDELAY                  NO, PUT QCB ON TIME    @ZA03122 35869109
*                                         DELAY QUEUE          @ZA03122 35869209
         DROP  RTEMP                                           @ZA03122 35869309
         L     RTEMP,AVTSAVTP           SECONDARY AVT ADDR     @ZA03122 35869409
         USING IEDNSVTD,RTEMP           ADDRESSABILITY         @ZA03122 35869509
         EJECT                                                          35869609
         TM    QCBFLAG,QCBTSSES         IS TSO IN SESSION      @Z30X8IR 35869709
         BZ    INPUT                    BRANCH ON NO           @Z30X8IR 35869809
         L     R6,AVTTSOPT              GET TSINPUT QCB ADDR   @Z30X8IR 35869909
         L     R6,TSIRNSCH-IEDQTSI(,R6) VTAM TSO SCHED ADDR    @Z30X8IR 35870009
         LA    RSELECT,THREE            INDEX TO IEDA1C ENTRY  @Z30X8IR 35870109
*                                         PT OF VTAM TSO SCHED @Z30X8IR 35870209
         BALR  RRTN,R6                  BRANCH TO VTAM TSO     @Z30X8IR 35870309
*                                         SCHED,IEDAYG         @Z30X8IR 35870409
INPUT    EQU   *                                               @Z30X8IR 35870509
         TM    LCBSTAT1,LCBFREEN        LINE FREE                X03039 35870609
         BO    PRIME                    BR YES                   X03039 35871508
*                                                                X03039 35871608
         L     RSCB,LCBSCBA-1           SCB ADDRESS              X03039 35871708
*                                       IN MIDDLE OF MESSAGE     X03039 35871808
         TM    SCBQTYPE-IEDQSCB(RSCB),SCBBFMM                    X03039 35871908
         BO    LEAVE                    BR YES                   X03039 35872008
*                                                                X03039 35872108
         TM    LCBSTAT4,LCBINPTP        INPUT PENDING?           X03039 35872608
         BO    PRIME                    BR YES                   X03039 35873008
*                                                                X03039 35873508
         TM    LCBSTAT3,LCBRDOUT        READ OUTSTANDING         X03039 35874008
         BZ    LEAVE                    BR NO                    X03039 35874508
*                                                                X03039 35875008
         TS    LCBTSTSW                 READ BACK INTO TPIO/FDBK X03039 35875508
         BNZ   LEAVE                    BR YES                   X03039 35876008
*                                                                X03039 35876508
         STM   R0,R15,AVTSAVE3          SAVE REGISTERS           X03039 35877008
*                                       ADDR LCCW GEN'R STCB VTO X03039 35878008
         L     R15,SAVTLCWQ+(QCBSTVTO-IEDQQCB)                   X03039 35878508
         L     R15,AVTEZERO(,R15)       RESET ENTRY POINT ADDR   X03039 35879008
         LA    R0,LXC                   PASS RESET CONDITIONAL   X03039 35879508
         SR    RTEMP,RTEMP              INDICATE NO DATA TO IAF2 X03039 35880008
         SR    R5,R5                    INDICATE - USE RESET LCPBX03039 35880508
         BALR  R14,R15                  GO ISSUE RESET COND'L    X03039 35881008
*                                                                X03039 35881508
         LTR   R15,R15                  RESET REQUEST ACCEPTED   X03039 35882008
         LM    R0,R15,AVTSAVE3          RESTORE REGISTERS        X03039 35882508
         BZ    LEAVE                    BR RESET REQUEST ACCEPTEDX03039 35883008
*                                                                X03039 35883508
         SPACE 1                                               @ZA03122 35883609
TMDELAY  EQU   *                                               @ZA03122 35883709
         TM    QCBTSOF1,QCBDELAY        IS QCB ALREADY ON T-D Q@ZA03122 35883809
         BOR   R14                      YES-BRANCH             @ZA03122 35883909
         MVC   QCBSTCHN,QCBSLINK        REMOVE SS FROM QCB       X03039 35884008
         LA    RTEMP,ONESECD            FORCE 1 SECOND DELAY     X03039 35884508
         STH   RTEMP,QCBEOLDT           SET DELAY TIME IN QCB    X03039 35885008
         MVI   QCBLKRLN,AVTEZERO        SET QCB INDICATOR        X03039 35885508
         LA    RTEMP,AVTDELYB           ADDR OF TIME DELAY QCB   X03039 35886008
         STCM  RTEMP,AD,QCBELCHN        SET TIME DELAY QCB ADDR  X03039 35886508
         MVI   QCBPRI,PRITIME           SET TIME DELAY PRIORITY  X03039 35887008
         LR    RTEMP,RQCB               PASS QCB AS ELEMENT      X03039 35887508
         B     DSPPOSTR                 POST QCB TO TIME DELAY   X03039 35888008
*                                       AND RETURN               X03039 35888508
PRIME    EQU   *                                                 X03039 35889008
         NI    LCBSTAT4,AVTEFF-LCBINPTP   RESET INPUT PENDING    X03039 35889508
*                                       MARK LINE SENDING        X03039 35890008
         XI    LCBSTAT1,LCBSENDN+LCBFREEN                        X03039 35890508
         ST    RQCB,AVTSAVE3            SAVE QCB REG             X03039 35891008
         ST    R14,AVTSAVE3+WORD2       SAVE RETURN REG          X03039 35891508
         STCM  RLCB,AD,LCBQCBA          POST LCB TO ITSELF       X03039 35892008
         MVI   LCBPRI,PRILNFRE          SET INITIAL POST PRIORITYX03039 35892508
         LR    RTEMP,RLCB               SET LCB AS POST ELEMENT  X03039 35893008
         BAL   R14,DSPPOSTR             POST LCB                 X03039 35893508
*                                                                X03039 35894008
         L     RQCB,AVTSAVE3            RESTORE QCB ADDRESS      X03039 35894508
         L     R14,AVTSAVE3+WORD2       RESTORE RETURN ADDRESS   X03039 35895008
*                                                                X03039 35895508
.NOTVTAM ANOP                                                    X03039 35896008
LEAVE    EQU   *                                                        35900020
         LR    RSTCB,RLCB                                               36000020
         B     DSPUNAVR                 LINK STCB INTO CHAIN            36100020
*                                         AND RETURN TO CALLER          36200020
         AIF   ('&GEN' NE 'VTAM').EXIT                           X03039 36270008
*                                                                X03039 36340008
REQLOGON EQU   *                                                 X03039 36410008
         OI    QCBSTAT,QCBSEND          INDICATE THAT SEND     @XM10739 36480009
*                                       SCHED SHOULD BE PUT IN @XM10739 36500009
*                                       CHAIN WHEN PLCB IS     @XM10739 36520009
*                                       ASSIGNED               @XM10739 36540009
         NI    QCBSTAT,AVTEFF-QCBSCHDL  INIT SCHDL SWITCH      @XM10739 36560009
         BAL   R5,GETTERM               GET TERMINAL ENTRY     @XM10739 36580009
         TM    TRMSTAT0-IEDNTRM(RTEMP),TRMLUNIT LOGICAL UNIT   @XM10739 36600009
         BZ    CKCALL                   NO-BRANCH              @XM10739 36620009
         CLI   QCBSTPRI,LUINIT          TCMSESN=LUINIT         @XM10739 36640009
         BER   R14                      YES-BRANCH             @XM10739 36660009
         B     TSPOSTED                 NO-BRANCH              @XM10739 36680009
CKCALL   EQU   *                                               @XM10739 36700009
         CLI   QCBSTPRI,NOCALL          CALL=NONE              @XM10739 36720009
         BE    SETSCHDL                 YES-BRANCH             @XM10739 36740009
         CLI   QCBSTPRI,CALLOPT         CLOCK OR CINTVL        @XM10739 36760009
         BL    TSPOSTED                 NO-BRANCH              @XM10739 36780009
         OI    QCBSTAT,QCBSCHDL         SCHED RECEIVE FIRST    @XM10739 36800009
         B     TSPOSTED                                        @XM10739 36820009
SETSCHDL EQU   *                                               @XM10739 36840009
         OI    QCBSTAT,QCBSCHDL         SCHED RECEIVE FIRST    @XM10739 36860009
         BR    R14                      RETURN                 @XM10739 36880009
TSPOSTED EQU   *                                                 X03039 37040008
         TS    QCBTSTSW                 QCB POSTED BY LOGON EXIT X03039 37110008
         BNZR  R14                      BR YES                   X03039 37180008
*                                                                X03039 37250008
*   POST QCB TO PLCB RETURN TO GET A PLCB AND REQUEST A LOGON    X03039 37320008
*                                                                X03039 37390008
         L     RTEMP,AVTSAVTP     SEC'ND AVT ADDR              @XM10729 37460009
         LA    RTEMP,SAVTPRTQ           PLCB RETURN QCB ADDRESS  X03039 37530008
         STCM  RTEMP,AD,QCBELCHN        POST QCB TO PLCB RETURN  X03039 37600008
         MVI   QCBPRI,PRILCBRQ          PLCB REQUEST PRIORITY    X03039 37670008
         LR    RTEMP,RQCB               SET QCB AS ELEMENT       X03039 37740008
         B     DSPPOSTR                 POST QCB TO PLCB RETURN  X03039 37810008
*                                       AND RETURN TO CALLER     X03039 37880008
.EXIT    ANOP                                                    X03039 37950008
EXIT     EQU   *                                                        38200020
         L     RSTCB,QCBSLINK-1         NEXT STCB (DEST SCHED)          38300020
         B     DSPBYPAS           GO ACTIVATE DESTINATION SCHEDULER     38400020
         AIF   ('&GEN' NE 'VTAM').XGTERM                       @X50X9IH 38406009
         SPACE 1                                               @X50X9IH 38412009
GETTERM  EQU   *                                               @X50X9IH 38418009
         LH    RTEMP,QCBTTCIN     GET TERMNAME TABLE OFFSET    @X50X9IH 38424009
         N     RTEMP,AVTCLRHI     CLEAR HALF                   @X50X9IH 38430009
         LR    R6,R15             SAVE REG15                   @X50X9IH 38436009
         ST    R14,AVTSAVE3       SAVE REG 14                  @XM10729 38442009
         L     R15,AVTRNMPT       GET ADDR OF TNT CODE         @X50X9IH 38448009
         BALR  R14,R15            LINK TO LOCATE TERM ENTRY    @X50X9IH 38454009
         LR    R15,R6             RESTORE REG 15               @X50X9IH 38460009
         L     R14,AVTSAVE3       RESTORE REG 14               @XM10729 38466009
         SPACE 2                                               @X50X9IH 38472009
         SH    RTEMP,AVTHA4  SET BASE TO TERMINAL PREFIX       @X50X9IH 38478009
         BR    R5                 RETURN                       @X50X9IH 38484009
.XGTERM  ANOP                                                  @X50X9IH 38490009
         DROP  15                                                       38500020
         EJECT                                                          38600020
SENDSCH  EQU   *                                                        38700020
         LA    RLCB,AVTEZERO(,RTEMP)    PASSED LCB ADDRESS              38800020
         AIF   ('&GEN' EQ 'VTAM').VSNDSCH                        X03039 38810008
         SR    RHOLD,RHOLD              CLEAR WORK REGISTER      S99228 38820022
         L     RDCB,LCBDCBPT            LOAD DCB ADDRESS         S99228 38840022
         IC    RHOLD,DCBEIOBX           INSERT LCB LENGTH        S99228 38850022
         SH    RHOLD,AVTHA4             REDUCE LCB LENGTH BY     S99228 38860022
         SH    RHOLD,AVTHA4             8 BYTES FOR ADDR LCB EXT S99228 38870022
         LA    RHOLD,ZERO(RHOLD,RLCB)   LOAD LCB EXTENSION ADDR  S99228 38880022
         USING IEDQLCBX,RHOLD                                    S99228 38890022
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 38900022
         BO    CKDLY1                   BRANCH YES TO RCV SCH   SA65379 38910054
         TM    LCBXFLAG,LCBERPND        SOH%R MESSAGE PENDING?   S99228 38920022
         DROP  RHOLD                                             S99228 38930022
         BZ    NOERP                    NO, SPEC ERP NOT PENDING S99228 38980022
CKDLY1   EQU   *                                                SA65379 38990054
         TM    LCBINSRC+TWO,DELAY       LCB ON TIME DELAY Q?     S99228 39000022
         BZ    NODELAY                  NO, NOT IN POLL DELAY    S99228 39020022
         LR    RTEMP,RLCB               LOAD LCB ADDR            S99228 39040022
         L     R15,AVTHG02              LOAD ADDR TIME DELAY RTN S99228 39060022
         BALR  R14,R15                  BRANCH TO TIME DELAY     S99228 39080022
         LA    RQCB,LCBRSKEY            INSERT RCV SCHED IN CHAI S99228 39100022
         LR    RTEMP,RQCB               LOAD QCB ADDR            S99228 39120022
         BAL   R14,DSPPRIOR             BRANCH TO DISPATCHER     S99228 39140022
NODELAY  EQU   *                                                 S99228 39160022
         B     RCVSCHED                 BYPASS TO RCV SCHED      S99228 39180022
NOERP    EQU   *                                                 S99228 39200022
.VSNDSCH ANOP                                                    X03039 39300008
         MVC   AVTDOUBL(1),LCBSTAT1     SAE CURRENT STATE               39400020
         NI    LCBSTAT1,LCBOCNI+LCBOCWTN SAVE STOP LINE BIT    @OY14092 40000091
         OI    LCBSTAT1,LCBSENDN .      SET LCB STATE            S21101 40300020
         AIF   ('&GEN' EQ 'VTAM').VSCB                           X03039 40310008
FNDSCB   EQU   * .                                               S22025 40320022
         TM    LCBSTAT2,LCBDIAL .       IS THIS A DIAL LINE      S22025 40340022
         BO    TSTSCB .                 YES-BRANCH               S22025 40360022
         SR    R0,R0 .                  CLEAR REG FOR MULTIPLY   S22025 40380022
         SR    RTEMP,RTEMP .            CLEAR REG FOR MULTIPLY   S22025 40400022
         IC    R0,AVTSCBSZ .            PICK UP SCB SIZE         S22025 40420022
         IC    RTEMP,QCBSCBOF .         PICK UP SCB OFFSET       S22025 40440022
         MR    R0,R0 .  .               OFFSET X SIZE = PROPER   S22025 40460022
*                                       SCB OFFSET IN RTEMP      S22025 40480022
         L     R5,LCBSCBDA-1 .          SCB DIRECTORY START ADDR S22025 40500022
         LA    R5,0(RTEMP,R5) .         GET SCB FOR THIS QCB     S22025 40520022
         STCM  R5,AD,LCBSCBA            SET SCB ADDR IN LCB    @XA08073 40540091
TSTSCB   EQU   * .                                               S22025 40560022
.VSCB    ANOP                                                    X03039 40580008
         USING IEDQSCB,RLAST                                            40600020
         L     RLAST,LCBSCBA-1          GET SCB ADDRESS                 40700020
         L     RSTCB,STCBLINK-1         NEXT STCB ADDRESS       SA61773 40750005
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN EXTENDD LOCK                  40800020
         BZ    NOLOCK                   NO                              40900020
         SPACE 2                                                 S22025 40901022
         TM    SCBQTYPE,SCBBFMM  .      MIDDLE MSG               S22025 40902022
         AIF   ('&GEN' NE 'VTAM').L13A                           X03039 40902208
         BO    CHKDLY                   BR YES                   X03039 40902408
         AGO   .L13B                                             X03039 40902608
.L13A    ANOP                                                    X03039 40902808
         BZ    TYPELOCK                 NO-BR                    S22025 40903022
         SPACE 2                                                 S22025 40904022
         TM    QCBSTAT,QCBSEND          MIDDLE OF SENDING LOCK MSG22025 40905022
         BO    NOLOCK                   YES-BR                   S22025 40906022
         SPACE 2                                                 S22025 40907022
         B     CHKDLY                   BRANCH IF NO            SA61773 40908005
.L13B    ANOP                                                    X03039 40908508
         SPACE 2                                                 S22025 40909022
TYPELOCK EQU   *                                                 S22025 40910022
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN EXTENDED LOCK          S22025 40911022
         BM    EXTEND                   BRANCH IF EXTENDED LOCK         40920020
         SPACE                                                          40940020
         MVI   QCBLKRLN,AVTEZERO        CLEAR TO PREVENT POSSIBLE       40960020
*                                       DOUBLE POST OF LCB              40980020
         AIF   ('&GEN' EQ 'VTAM').L13C                           X03039 40980508
         CLI   LCBRSPRI,RECVPRI         RECEIVE PRIORITY        SA58984 40981005
         BNE   LOCKTEST                 BR NO, HANDLE NORMALLY  SA58984 40982005
         LR    RDCB,RQCB                SAVE QCB ADDRESS        SA58984 40983005
         LR    RSTCB,RLCB               QCB TO BE UPDATED       SA58984 40984005
         LR    RQCB,RLCB                QCB WITH SEND SCHED STCBSA58984 40985005
*                                         AT TOP OF CHAIN       SA58984 40986005
         BAL   R14,DSPUNAVR             FOR MESSAGE LOCK AND    SA58984 40987005
*                                         RECV PRIORITY, SEND   SA58984 40988005
*                                         SCHED IS ON TOP OF    SA58984 40989005
*                                         LCB STCB CHAIN OUT OF SA58984 40990005
*                                         PRIORITY ORDER. MUST  SA58984 40991005
*                                         BE REINSERTED BY PRI  SA58984 40992005
         LR    RQCB,RDCB                RESTORE QCB ADDRESS     SA58984 40993005
         L     RDCB,LCBDCBPT            RESTORE DCB REG        @OX13500 40994091
.L13C    ANOP                                                    X03039 40996008
         B     LOCKTEST            USE COMMON CODE                      41000020
         SPACE                                                          41020020
EXTEND   EQU   *                                                        41040020
         TM    AVTDOUBL,LCBRECVN        LAST OPERATION A RECEIVE        41100020
         BZ    CHKDLY                   BRANCH IF NO            SA61773 41200005
LOCKTEST EQU   *                                                        41300020
         TM    AVTDOUBL,LCBSENDN        WAS LAST OP A SEND     @XA09773 41320009
         BO    SENDEOT                  BRANCH-YES             @XA09773 41340009
         NI    SCBBSCFM,AVTEFF-SCBNOEOT ACTIVATE WILL NOT EOT  @XA09773 41360009
SENDEOT  EQU   *                                               @XA09773 41380009
         OC    QCBLKRRN,QCBLKRRN        IS THERE LOCK MSG               41400020
         BZ    NOLOCK                   NO                              41500055
         SPACE                                                          41600020
         AIF   ('&GEN' NE 'VTAM').LOCKMSG                        X03039 41630008
         TM    LCBSTAT3,LCBERLCK        ERROR LOCK SET           X03039 41660008
         BO    LCBTOIAF                 BR YES                   X03039 41690008
*                                                                X03039 41720008
.LOCKMSG ANOP                                                    X03039 41750008
         MVC   SCBSCHDR,QCBLKRRN        SET HEADER                      41800020
         B     SENDINIT .               SEND LOCK MESSAGE       SA52971 42000022
         SPACE 2                                                 S21101 42050020
         SPACE 3                                                 S21101 42650020
NOLOCK   EQU   *                                                        42700020
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE     OX02199 42700654
         BO    CKMIDMSG                 YES,SKIP STOPLINE TEST  OX02199 42701254
         TM    LCBSTAT1,LCBOCNI         STOPLINE IN PROGRESS    SA56606 42702022
         AIF   ('&GEN' EQ 'VTAM').BHELD                          X03039 42703008
         BO    NEXTSTCB                 YES-BRANCH              SA56606 42704022
         AGO   .MMTEST                                           X03039 42704208
.BHELD   ANOP                                                    X03039 42704408
         BO    REMOVESS                 BR YES                   X03039 42704608
.MMTEST  ANOP                                                    X03039 42704808
CKMIDMSG EQU   *                                                OX02199 42705054
         TM    SCBQTYPE,SCBBFMM .       MIDDLE OF MSG            S22025 âø-0020
         AIF   ('&GEN' NE 'VTAM').BDELAY                         X03039 42706108
         BO    NEXTSTCB                 BR YES                   X03039 42706208
         AGO   .TSTLGOF                                          X03039 42706308
.BDELAY  ANOP                                                    X03039 42706408
         BZ    TSTDELAY .               NO-BRANCH                S22025 42706522
         TM    QCBSTAT,QCBSEND .        QCB IN SEND MODE         S22025 42707022
         BO    SETSCERB .               YES GO SET ERB AND SCB UPS22025 42707522
*                                       FOR RECALL               S22025 42708022
         B     NEXTSTCB .               GET NEXT STCB            S22025 42709022
         AGO   .TSTDELY                                          X03039 42713008
.TSTLGOF ANOP                                                    X03039 42717008
         TM    QCBFLAG,QCBTSSES         IN TSO SESSION         @Z30X8IM 42718008
         BO    TSTDELAY                 BRANCH YES             @Z30X8IM 42719008
         TM    LCBSTAT4,LCBLGOFF        LOGOFF REQUESTED         X03039 42721008
         BO    DELAYSND                 BR YES                   X03039 42725008
.TSTDELY ANOP                                                    X03039 42729008
         SPACE 2                                                        42735020
TSTDELAY EQU   * .                                               S22025 42740022
         TM    LCBSTAT1,LCBOCNI .       STOPLINE IN PROGRESS    OX02199 42743054
         AIF   ('&GEN' NE 'VTAM').BNSTCB                         X03039 42743508
         BO    REMOVESS                 BR YES                   X03039 42744008
*                                                                X03039 42744508
         AGO   .TSTCLOS                                          X03039 42745008
.BNSTCB  ANOP                                                    X03039 42745508
         BO    NEXTSTCB                 YES,BRANCH              OX02199 42746054
         TM    AVTBIT1,AVTDLAYN .       SYSTEM DELAY             S22025 42750022
         BO    NEXTSTCB .               BRANCH-YES               S22025 42752022
.TSTCLOS ANOP                                                    X03039 42753008
         TM    AVTBIT1,AVTCLOSN+AVTQUCKN QUICK CLOSE             S22025 42754022
         AIF   ('&GEN' NE 'VTAM').L14                            X03039 42754608
         BO    REMOVESS                 BR YES                   X03039 42755208
         AGO   .L15                                              X03039 42755808
.L14     ANOP                                                    X03039 42756408
         BO    NEXTSTCB .               QUICK CLOSE              S22025 42757022
         AIF   ('&GEN' EQ 'MINI').L16                                   42800020
         AIF   ('&GEN' NE 'VTAM').TSTSCHD                        X03039 42807008
.L15     ANOP                                                    X03039 42810008
*                                                                X03039 42814008
         L     RTEMP,AVTSAVTP           SECONDARY AVT ADDRESS    X03039 42821008
*                                                                X03039 42828008
         USING IEDNSVTD,RTEMP           ESTABLISH ADDRESSABILITY X03039 42835008
*                                       VTAM QUICK CLOSEDOWN     X03039 42842008
         TM    SAVTSTAT,SAVTVCLS+SAVTVQCK                        X03039 42849008
         BO    REMOVESS                 BR YES                   X03039 42856008
*                                                                X03039 42863008
         TM    LCBSTAT3,LCBERLCK        ERROR LOCK SET           X03039 42870008
         BO    LCBTOIAF                 BR YES                   X03039 42877008
*                                                                X03039 42884008
.TSTSCHD ANOP                                                    X03039 42891008
         TM    QCBSTAT,QCBSCHDL         HAS SOURCE BEEN SET FOR         42900020
*                                         CLOCK OR INTVL                43000020
         BZ    NOTDIALQ                 BR NO                    X03039 43100008
*                                                                X03039 43110008
         AIF   ('&GEN' NE 'VTAM').ACTDIAL                        X03039 43120008
         NI    QCBSTAT,AVTEFF-QCBSCHDL  RESET RCV BEFORE SEND    X03039 43130008
         B     RCVSCHED                 GO ACTIVATE RCV SCHEDULERX03039 43140008
*                                                                X03039 43150008
         AGO   .NOTDIAL                                          X03039 43160008
.ACTDIAL ANOP                                                    X03039 43170008
         LR    RTEMP,RQCB     SET FOR DIAL SCHEDULER                    43200020
         LA    RSTCB,LCBRSKEY           NEXT STCB                       43300020
         B     DSPBYPAS                 ACTIVATE DIAL RCV SCHED         43400020
.NOTDIAL ANOP                                                    X03039 43450008
NOTDIALQ EQU   *                                                        43500020
         AIF   ('&GEN' NE 'VTAM').L16                            X03039 43510008
         TM    LCBBSMST,LCBRTRRO        RESP OWED TO RTR       @X50X9II 43513009
         BO    CKSSOUT                  YES-BRANCH             @X50X9II 43516009
         TM    LCBSTAT3,LCBUNSIP        UNSOLICITED INPUT RCV'D  X03039 43520008
         BO    RCVSCHED                 BR YES                   X03039 43530008
CKSSOUT  EQU   *                                               @X50X9II 43540009
         TM    LCBSTAT3,LCBSSOUT        REMOVE SS FOR SPECOUT    X03039 43550008
         BZ    GOSEND                   BR NO                    X03039 43560008
*                                                                X03039 43570008
         AGO   .VNMSGLT                                          X03039 43580008
.L16     ANOP                                                           43600020
         TM    SCBBSCFM,SCBMLMTN        MESSAGE LIMIT REACHED           43700020
         BZ    NOLMT                    NO                              43800020
         NI    SCBBSCFM,SCBMLMTF        RESET BIT                       43900020
         AGO   .NEVTAM                                           X03039 43900508
.VNMSGLT ANOP                                                    X03039 43901508
DELAYSND EQU   *                                                 X03039 43903008
         LR    R5,RSTCB                 SAVE NEXT STCB ADDRESS   X03039 43904008
         LR    R6,RQCB                  SAVE QCB ADDR            X03039 43904508
         LR    RSTCB,RQCB               UNAVAIL PARAMETER        X03039 43905008
         LR    RQCB,RLCB                UNAVAIL PARAMETER        X03039 43905508
         BAL   R14,DSPUNAVR             PUT SS BACK INTO QCB     X03039 43906008
*                                                                X03039 43906508
         LR    RSTCB,R5                 RESTORE NEXT STCB ADDR   X03039 43907008
         LR    RQCB,R6                  RESTORE QCB ADDR         X03039 43907508
         MVC   QCBSTCHN,QCBSLINK        REMOVE SEND SCH FROM QCB X03039 43908008
*                                                                X03039 43908508
*   PREPARE TO PUT QCB ON THE TIME DELAY QUEUE                   X03039 43909008
*                                                                X03039 43909508
         TM    LCBSTAT3,LCBSSOUT        REMOVE SS FOR SPECOUT  @ZA03122 43909609
         BO    DELAY1                   YES, FORCE 1 SEC DELAY @ZA03122 43909709
         LH    R5,QCBINTVL              ASSUME CLOCK OR CINTVL   X03039 43910008
         N     R5,AVTCLRHI              CLEAR HI HALF            X03039 43910508
         CLI   QCBSTPRI,CLOCK           CLOCK SPECIFIED          X03039 43911008
         BNE   INTVL                    BR NO                    X03039 43911508
*                                                                X03039 43912008
         AR    R5,R5                    DOUBLE VALUE             X03039 43912508
         TIME  BIN                      GET TIME OF DAY          X03039 43913008
         SRDL  R0,HALF                  SHIFT TO REG1            X03039 43913508
         D     R0,HUND                  TIME IN SECONDS          X03039 43914008
         CLR   RTEMP,R5                 IS TIME TODAY            X03039 43914508
         BL    TODAY                    BR YES                   X03039 43915008
*                                                                X03039 43915508
         A     R5,TWNTY4HR              ADD 24 HOURS             X03039 43916008
TODAY    EQU   *                                                 X03039 43916508
         SR    R5,RTEMP                 AMOUNT OF DELAY          X03039 43917008
         B     CHKTIME                  CONTINUE CLOCK PROCESSINGX03039 43917508
*                                                                X03039 43918008
INTVL    EQU   *                                                 X03039 43918508
         CLI   QCBSTPRI,CINTVL          CINTVL SPECIFIED         X03039 43919008
         BE    CHKTIME                  BR YES                   X03039 43919508
*                                                                X03039 43920008
DELAY1   EQU   *                                               @ZA03122 43920209
         LA    R5,ONESECD               SET DELAY TO 1 SECOND    X03039 43920508
CHKTIME  EQU   *                                                 X03039 43921008
         C     R5,TWELVHR               MORE THAN 12 HOURS       X03039 43921508
         BNH   LESS12                   BR NO                    X03039 43922008
*                                                                X03039 43922508
         S     R5,TWELVHR               MAKE LESS THAN 12 HOURS  X03039 43923008
         OI    QCBSTAT,QCBTIME          INDICATE MORE THAN 12 HRSX03039 43923508
LESS12   EQU   *                                                 X03039 43924008
         STH   R5,QCBEOLDT              SET DELAY TIME           X03039 43924508
         MVI   QCBLKRLN,AVTEZERO        SET QCB INDICATOR        X03039 43925008
         LR    RTEMP,RQCB               QCB ADDR FOR TIME DELAY  X03039 43925508
         LA    R14,NEXTSTCB             SET RETURN ADDRESS       X03039 43926008
         L     R15,AVTHG01              ADDRESS OF TIME DELAY    X03039 43926508
         BR    R15                      GO PUT QCB ON TIME DELAY X03039 43927008
         AGO   .VSCHL                                            X03039 43927508
.NEVTAM  ANOP                                                    X03039 43928008
         LR    RSTCB,RLCB .             UNAVAIL PARAMETER        S21101 43930020
         LR    RQCB,RLCB .              RESTORE QCB ADDR         S22025 43936022
         B     POSTIT .                 POST LCB TO ITSELF       S21101 43954020
         SPACE 2                                                 S21101 43960020
NOLMT    EQU   *                                                 S21101 43966020
         TM    QCBELCHN+2,QCBCNTEN      CONTENTION,RVI,OR OTHER@OX17153 43972000
*                                         BUFFER BUSY CONDITION  S21101 43978020
         BZ    NOTBUSY .                BRANCH IF NO             S21101 43984020
         NI    QCBELCHN+2,AVTEFF-QCBCNTEN RESET CONTENTION BIT @OX17153 43990000
         L     RSTCB,QCBSLINK-1         GET NEXT STCB                   44000020
         CLI   STCBPRI-IEDQSTCB(RSTCB),0   QEVENT NEXT                  44100020
         BE    CHKDLY                   BRANCH-YES GO RCV      @OY14503 44160091
         B     NEXTSTCB                 TRY TO SEND TO NEXTTERM@OY14503 44190091
*                                         RECEIVE SCHEDULER      S21101 44220020
.VSCHL   ANOP                                                    X03039 44260008
         SPACE                                                          44300020
CHKDLY   EQU   *                                                SA61773 44350005
         TM    LCBINSRC+2,DELAY         IN DELAY Q                      44400020
         BNZ   NEXTSTCB                 YES DISPATCH                    44500020
RCVSCHED EQU   *                                                SA61773 44600005
         LA    RSTCB,LCBRSKEY           RCV SCHED STCB          SA61773 44608005
NEXTSTCB EQU   *                                                SA61773 44616005
         AIF   ('&GEN' NE 'VTAM').NORMVSS                        X03039 44618008
         NI    LCBSTAT3,AVTEFF-LCBSSOUT RESET REMOVE SS BIT      X03039 44620008
.NORMVSS ANOP                                                    X03039 44622008
         LR    RTEMP,RLCB               SET ELEMENT REG         SA61773 44624005
         LR    RQCB,RLCB                SET QCB REG             SA61773 44632005
         B     DSPBYPAS                 BYPASS                  SA61773 44640005
         SPACE 3                                                 S21101 44650020
         AIF   ('&GEN' NE 'VTAM').NOTBUSY                        X03039 44655008
*                                                                X03039 44660008
LCBTOIAF EQU   *                                                 X03039 44665008
         MVC   LCBSTAT1,AVTDOUBL        RESTORE PREVIOUS STATUS  X03039 44667008
         L     RTEMP,AVTSAVTP           SECONDARY AVT ADDRESS    X03039 44670008
         LA    RTEMP,SAVTLCWQ           LCCW GEN'R QCB ADDRESS   X03039 44675008
         STCM  RTEMP,AD,LCBQCBA         PUT QCB ADDR IN LCB      X03039 44680008
         LR    RTEMP,RLCB               SET LCB AS ELEMENT       X03039 44685008
         B     DSPPOST                  POST LCB TO LCCW GEN'R   X03039 44690008
*                                                                X03039 44695008
         AGO   .VSEND                                            X03039 44700008
.NOTBUSY ANOP                                                    X03039 44705008
NOTBUSY  EQU   *                                                 S21101 44720020
         MVC   AVTDOUBL+1(1),SCBBSCFM   SAVE FLAGS              SA59034 44760005
         AIF   ('&GEN' EQ 'MINI').L17                                   44800020
         TM    LCBSTAT2,LCBDIAL+LCBSYNC DIAL BSC                        44900020
         BNO   NOBSD                    BRANCH IF NOT BSC DIAL          45000020
         SPACE                                                          45100020
         CLI   LCBTSTSW,AVTEFF          WAS THERE HARD ERROR INA        45200020
*                                         PREVIOUS SELSECTION           45300020
         MVC   LCBSENS0(2),AVTDOUBL                            @OX12563 45350091
         BE BSDIAL                      BRANCH IF YES                   45400020
************************************************************** @ZA03063 45500009
*                                                            * @ZA03063 45520009
*        SCBNOEOT IS USED TO CONTROL QUEUE FLUSH FOR BSC     * @ZA03063 45540009
*        DIAL WITH SEND PRIORITY. SCBNOEOT IS ALSO USED TO   * @ZA03063 45560009
*        FORCE A RECEIVE OPERATION AFTER TCAM HAS SENT AN    * @ZA03063 45580009
*        EOT. THIS IS REQUIRED FOR ALL BSC DIAL OPERATIONS.  * @ZA03063 45600009
*        IT IS SET ON EVERY RECEIVE OPERATION AND RESET ON   * @ZA03063 45620009
*        THE FIRST SEND AFTER A RECEIVE. LINE END APPENDAGE  * @ZA03063 45640009
*        WILL TURN ON SCBNOEOT AND NOT SEND AN EOT FOR BSC   * @ZA03063 45660009
*        DIAL WITH SEND PRIORITY. LINE END APPENDAGE RESETS  * @ZA03063 45680009
*        SCBNOEOT WHENEVER IT SENDS AN EOT, FOR EXAMPLE ON A * @ZA03063 45700009
*        MSGGEN.                                             * @ZA03063 45720009
*                                                            * @ZA03063 45740009
************************************************************** @ZA03063 45760009
         TM    SCBBSCFM,SCBNOEOT        TCAM SEND AN EOT       @ZA03063 45780009
         BZ    GORCV                    BRANCH IF YES          @ZA03063 45790009
         NI    SCBBSCFM,AVTEFF-SCBNOEOT INDICATE EOT SENT      @ZA03063 45820009
         TM    AVTDOUBL,LCBSENDN        LAST OPERATION A SEND  @ZA03063 45830009
         BZ    GOSEND                   BRANCH IF NO           @ZA03063 45850009
         OI    SCBBSCFM,SCBNOEOT        INDICATE EOT NOT SENT  @ZA03063 45870009
         CLI   LCBRSPRI,SENDPRI         SEND PRIORITY          @ZA03063 45900009
         BE    GOSEND                   BRANCH IF YES          @ZA03063 45920009
GORCV    EQU   *                                               @ZA03063 45940009
         OI    SCBBSCFM,SCBNOEOT        INDICATE EOT NOT SENT  @ZA03063 45960009
         NI    LCBSTAT2,AVTEFF-LCBNEGRP FORCE THE ADDITIONAL   @ZA03063 45980009
*                                       RECEIVE OPERATION      @ZA03063 46000009
*                                       REQUIRED BY BSC DIAL   @ZA03063 46020009
*                                       ARCHITECTURE           @ZA03063 46040009
         B     RCVSCHED                 GO RECEIVE             @ZA03063 46060009
NOBSD    EQU   *                                                        46200020
         AIF   ('&GEN' EQ 'NTSO').L17A                                  46220020
         TM    QCBDSFLG,QCBDISK+QCBCORE NON-TSO QUEUES              TSO 46240020
         BZ    GOSEND                   BRANCH ON NO                TSO 46260020
         TM    QCBFLAG,QCBTSSES         TIME-SHARING SESSION?    S22029 46266022
         BO    GOSEND                   YES, START SEND OPRATION S22029 46272022
.L17A    ANOP                                                           46280020
         CLI   LCBTSTSW,AVTEFF          REQUEST FOR NEW CONNECTION      46300020
         BNE   GOSEND                   BRANCH IF NO                    46400020
BSDIAL   EQU   *                                                        46500020
         L     RTEMP,DCBDEBAD           DEB ADDRESS            @OX13500 46510091
         USING DEBNMSUB,RTEMP           ADDRESSABILITY         @OX13500 46520091
         TM    DEBOPATB,OUTONLY         OUTPUT ONLY DEVICE?    @OX13500 46530091
         BO    GOSEND                   YES WE WANT TO SEND    @OX13500 46540091
         DROP  RTEMP                                           @OX13500 46550091
         CLI   QCBSTPRI,CALLPRI         CALL=NONE                       46600020
         BE    TRMHELD                  BRANCH IF YES - THIS IS@OY12969 46700091
*                                         POSSIBLE IF HARD ERROR ON     46800020
*                                         PREVIOUS ATTEMPT TO SEND      46900020
.VSEND   ANOP                                                    X03039 46950008
GOSEND   EQU   *                                                        47000020
         AIF   ('&GEN' EQ 'NTSO').L17                                   47100020
         TM    AVTBIT1,AVTTSON          IS IT TIME SHARING?         TSO 47200020
         BZ    TSO3                     BRANCH ON NO                TSO 47300020
         L     R6,AVTTSOPT              GET ADDRESS OF TSINPUT QCB  TSO 47400020
         AIF   ('&GEN' EQ 'VTAM').VTSO                         @Z30X8IR 47450008
         L     R6,TSISCHED-IEDQTSI(R6)  ADDRESS OF TS SCHEDULER     TSO 47500020
         BAL   RWORK,12(,R6)            BRANCH TO ROUTINE           TSO 47600020
         AGO   .SEND                                           @Z30X8IR 47610008
.VTSO    ANOP                                                  @Z30X8IR 47620008
         L     R6,TSIRNSCH-IEDQTSI(,R6) VTAM TSO SCHED ADDR    @Z30X8IR 47630008
         LA    RSELECT,FOUR             INDEX TO IEDA20 ENTRY  @Z30X8IR 47640008
*                                         PT OF VTAM TSO SCHED @Z30X8IR 47650008
         BALR  RRTN,R6                  BRANCH TO VTAM TSO     @Z30X8IR 47660008
*                                         SCHED,IEDAYG         @Z30X8IR 47670008
.SEND    ANOP                                                  @Z30X8IR 47680008
         B     TSO4                     PUT SEND SCHED IN QCB       TSO 47700020
         B     SENDPREP                 GO TO START SENDING.        TSO 47800020
TSO3     EQU   *                                                    TSO 47900020
.L17     ANOP                                                           48000020
         AIF   ('&GEN' EQ 'VTAM').VHELD                          X03039 48050008
         TM    QCBFLAG,QCBTERMQ         QUEUED BY TERMINAL?             48100020
         BZ    NOTRMQ                   BRANCH IF NOT                   48200020
         SPACE 2                                                        48300020
.VHELD   ANOP                                                    X03039 48350008
         TM    QCBSTAT,QCBTRMHO         HAS TERMINAL BEEN INTERCEPTED   48400020
         BO    TRMHELD                  BRANCH IF  TERMINAL WAS HELD    48500020
*                                         TO AVOID GETTING MSG OFF QUE  48600020
         SPACE 2                                                        48700020
NOTRMQ   EQU   *                                                        48800020
         AIF   ('&GEN' EQ 'NTSO' OR '&GEN' EQ 'MINI').MIX0010    S22029 48810022
         TM    QCBDSFLG,QCBTSQ          TIME-SHARING QUEUEING    S22029 48820022
         BO    NOINIT                   YES. SKIP SENDING INIT   S22029 48830022
*                                       MODE MSGS.               S22029 48840022
.MIX0010 ANOP                                                    S22029 48850022
         AIF   ('&GEN' NE 'VTAM').NOSAVE                         X03039 48860008
         LR    R5,RSTCB                 SAVE NEXT STCB ADDR      X03039 48870008
.NOSAVE  ANOP                                                    X03039 48880008
         L     RSTCB,QCBINSRC-1   GET INITIATE SOURCE LCB CHAIN         48900020
         N     RSTCB,CLEAR              CLEAR LOW ORDER BYTE            49000020
         LA    RQCB,0(,RQCB)            CLEAR HI ORDER BYTE             49100020
         CLR   RSTCB,RQCB               INITIATE MODE                   49200020
         AIF   ('&GEN' EQ 'VTAM').VINIT                          X03039 49250008
         BE    NOINIT                   NO                              49300020
         AGO   .NVINIT                                           X03039 49320008
.VINIT   ANOP                                                    X03039 49340008
         BE    RSTRSTCB                 BR NO                    X03039 49360008
.NVINIT  ANOP                                                    X03039 49380008
         MVC   QCBINSRC(3),LCBINSRC-IEDQLCB(RSTCB) REMOVE LCB FROM      49400020
*                                      INITIATE CHAIN                   49500020
         NI    LCBINSRC+2-IEDQLCB(RSTCB),X'FF'-LCBNSRCD TURN OFF        49600020
*                                      INITIATE FLAG                    49700020
         STCM  RLCB,AD,LCBINSRC-IEDQLCB(RSTCB) DEST LCB INTO SRCSA62953 49750005
         L     RSTCB,LCBSCBA-1-IEDQLCB(RSTCB) SOURCE SCB                49900020
         MVC   SCBSCHDR,SCBDCHDR-IEDQSCB(RSTCB)  LOAD SOURCE SCB        50000020
         TM    QCBDSFLG,QCBREUS+QCBNREUS  DISK                          50100020
         BNZ   MOVER                    YES                             50200020
         MVC   SCBSCHDR,SCBCCHDR-IEDQSCB(RSTCB)   PARAMETER             50300020
MOVER    EQU   *                                                        50400020
         MVI   SCBPRI,AVTEZERO          RESET PRIORITY           A      50500022
         OI    LCBSTAT1,LCBSENDN+LCBINITN SET LCB STATE                 50600020
         B     SENDINIT                 SEND MSG                        50700020
         SPACE 3                                                 S21101 50750020
         AIF   ('&GEN' NE 'VTAM').NRESTR                         X03039 50760008
RSTRSTCB EQU   *                                                 X03039 50770008
         LR    RSTCB,R5                 RESTORE NEXT STCB ADDR   X03039 50780008
.NRESTR  ANOP                                                    X03039 50790008
NOINIT   EQU   *                                                        50800020
         TM    QCBDSFLG,QCBHELD         IS FEFO CHAIN BEING CHANGED     50810020
*                                         BY REUS IN DISABED CODE       50820020
         BO    TRMHELD                  BRANCH YES, TO REMOVE STCB.     50830020
*                                         WILL BE RE-INSERTED LATER     50840020
         SPACE                                                          50850020
         SR    R0,R0                    CLEAR COUNT REGISTER            50900020
         LA    RTEMP,IEDQQCB+QCBMSIZE-QCBPSIZE INITIALIZE SCAN FOR      51000020
*                                      LOOP                             51100020
SCANLOOP EQU   *                                                        51200020
         LA    RTEMP,QCBPSIZE(0,RTEMP) BUMP TO NEXT PRIORITY QCB        51300020
         MVC   SCBSCHDR-IEDQSCB(3,RLAST),QCBFFEFO-IEDQPQCB(RTEMP)       51600020
*                                      NEXT FEFO MESSAGE                51700020
         OC    QCBFFEFO-IEDQPQCB(3,RTEMP),QCBFFEFO-IEDQPQCB(RTEMP) IS   51800020
*                                      THERE AN UNSENT FEFO MESSAGE     51900020
         BNZ   PREPARE            YES, GO PREPARE SCB                   52000020
         BCTR  R0,R0                    BUMP COUNT                      52100020
         CLI   QCBPRIPQ-IEDQPQCB(RTEMP),0 LAST PRIORITY QCB             52200020
         BNE   SCANLOOP           NO, LOOK AT NEXT ONE                  52300020
         AIF   ('&GEN' EQ 'MINI').L19                                   52400020
         MVI   QCBPRLVL,AVTEZERO .      RESET HIGHEST PRIORITY LES21101 52430020
*                                         MESSAGE INDICATOR FOR DS21101 52440020
*                                         LINES.  HM WILL INDICATS21101 52450020
*                                         HIGHEST LEVEL IN USE   S21101 52460020
.L19     ANOP                                                    S22025 52470022
TRMHELD  EQU   * .                                               S22025 52480022
         AIF   ('&GEN' EQ 'VTAM').VRMOVSS                        X03039 52482008
         MVC   SCBBSCFM,AVTDOUBL+1      RESTORE FLAGS           SA59034 52485005
         AIF   ('&GEN' EQ 'MINI').L19A                           S22025 52490022
         LA    RSTCB,LCBRSKEY           RCV SCHED STCB                  52500020
         LR    RTEMP,RQCB               SET ELEMENT FOR DIAL RCV SN     52600020
         CLI   QCBSTPRI,CALLOPT         THIS CLOCK OR INTVL             52700020
         BNL   DSPBYPAS                 YES TO RESET DELAY              52800020
         AGO   .NRMOVSS                                          X03039 52807008
.VRMOVSS ANOP                                                    X03039 52817008
REMOVESS EQU   *                                                 X03039 52827008
         NI    LCBSTAT3,AVTEFF-LCBSSOUT RESET REMOVE SS BIT      X03039 52832008
.NRMOVSS ANOP                                                    X03039 52837008
         SPACE 3                                                 S21101 52850020
.L19A    ANOP                                                    S22025 52900022
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'NTSO').L18               53000020
TSO4     EQU   *                                                    TSO 53100020
.L18     ANOP                                                           53200020
         LA    RSTCB,LCBSTCBA-(STCBLINK-IEDQSTCB)               SA56606 53400022
*                                       SET REG                 SA56606 53406022
STCBLP   EQU   *                                                SA56606 53412022
         LR    RTEMP,RSTCB              SAVE PREVIOUS STCB      SA56606 53418022
         L     RSTCB,STCBLINK-IEDQSTCB-1(RSTCB)                 SA56606 53424022
*                                       LOAD NEXT STCB          SA56606 53430022
         LA    R0,QCBSTVTO-IEDQQCB      STCB OFFSET             SA56606 53436022
         LR    RWORK,RSTCB              SET REG                 SA56606 53442022
         LA    RWORK,ZERO(,RWORK)       CLEAR HO BYTE           SA56606 53448022
         SR    RWORK,R0                 QCB ADDR                SA56606 53454022
         CLR   RWORK,RQCB               CORRECT QCB             SA56606 53460022
         BNE   STCBLP                   BRANCH IF NO            SA56606 53466022
         SH    RTEMP,AVTHA4             SET REG                 SA56606 53472022
         LR    RSTCB,RQCB               UNAVAIL REG             SA56606 53478022
         LR    RQCB,RTEMP               UNAVAIL REG             SA56606 53484022
POSTIT   EQU   *                                                 S21101 53500020
         BAL   R14,DSPUNAVR .           REMOVE STCB              S22025 53550022
         AIF   ('&GEN' EQ 'VTAM').VNMGLMT                        X03039 53570008
         MVI   SCBSNDCT,AVTEZERO .      RESET SEND LIMIT COUNT   S21101 53600020
.VNMGLMT ANOP                                                    X03039 53700008
         LR    RTEMP,RLCB               SET LCB TO BE QPOST'ED          53800020
         ST    RTEMP,LCBQCBA-1          GO QPOST                        53900020
         B     DSPPOST            GO QPOST                              54000020
         SPACE 1                                                        54100020
PREPARE  EQU   *                                                        54200020
         LPR   R0,R0                    MAK COUNT POSITIVE              54300020
         STC   R0,SCBPRI-IEDQSCB(,RLAST)  SET PRIORITY LEVEL INDEX      54400020
         AIF   ('&GEN' EQ 'MINI').L21                            S21101 54420020
         STC   R0,QCBPRLVL .            SET HIGHEST LEVEL MSG IN S21101 54440020
.L21     ANOP                                                    S21101 54460020
SENDINIT EQU   *                                               @SA72478 54530061
         XC    SCBFEFO,SCBFEFO          CLEAR FOR PRIORITY LEVEL        54600020
*                                         MESSAGES                      54700020
         OI    QCBFLAG,QCBSDFFO         SET AS SENDING A MESG   SA52971 54760022
SENDPREP EQU   *                                                        54800020
         NI    LCBERBST,AVTEFF-LCBDLNKN . RESET DLINK SWITCH     S22025 55050022
         NI    LCBSTAT2,AVTEFF-LCBSNDPR RESET SEND PRIORITY    @OY12395 55300091
         STCM  RQCB,AD,SCBDESTQ-IEDQSCB(RLAST) SET QCB ADDRESS   Y01948 55600005
         MVC   SCBSCSEG(3),SCBSCHDR .   SET SCB SEG              S22025 55820022
         MVI   SCBUNTCT,AVTEZERO .      SET UNIT COUNT TO BUILD  S22025 55840022
*                                       FROM BEGINNING OF BUFFER S22025 55860022
COMMON1  EQU   *                                                 S22025 55900022
         XC    LCBRECAD,LCBRECAD .      CLEAR Q RECORD ADDRESS   S22025 56000022
         XC    LCBRECOF,LCBRECOF .      ALSO OFFSETR FOR LINEEND S22025 56100022
         AIF   ('&GEN' EQ 'VTAM').VSPOUT                         X03039 56110008
         TM    LCBSTAT2,LCBDIAL                                 SA60792 56120022
         BO    NORESET                                          SA60792 56140022
         NC    LCBTTCIN,LCBTTCIN        CONNECTED TERMINAL ?    SA69635 56146005
         BNZ   NORESET                  YES, BR-LEAVE AS IS     SA69635 56152005
         MVI   LCBTTCIN+ONE,ONE                                 SA60792 56160022
NORESET  EQU   *                                                        56180022
.VSPOUT  ANOP                                                    X03039 56182008
         AIF   ('&GEN' NE 'VTAM').SETERB                         X03039 56184008
         TM    LCBSTAT3,LCBSPOUT        SPECOUT PROCESSING       X03039 56186008
         BZ    BUILDERB                 BR NO                    X03039 56188008
*                                                                X03039 56190008
         OI    LCBSTAT3,LCBNLOUT        REQUEST NULL WRITE       X03039 56192008
BUILDERB EQU   *                                                 X03039 56194008
.SETERB  ANOP                                                    X03039 56196008
         MVI   LCBERBPY,PRIINTRQ        INITIAL REQUEST PRIORITY        56200020
         L     RDCB,LCBDCBPT            DCB BASE                        56300020
         MVC   LCBRBCT1,DCBBUFOU        REQUEST BUFOUT           X03039 56400008
         NI    LCBRBCT1,X0F             CLEAR 1ST 4 BITS         X03039 56430008
         MVI   LCBRBCT2,AVTEZERO        ZERO DISABLED COUNT      X03039 56460008
COMMON   EQU   *                                                 S22025 56510022
         LA    RTEMP,AVTDSIOB .         GET DISK I/O QCB ADDRESS S22025 56520022
COMMON2  EQU   *                                                 S22025 56525022
         ST    RTEMP,LCBERB .           SET TO POST ERB TO IT    S22025 56530022
         LA    RTEMP,LCBERB             ADDR OF ERB              S22025 56550022
         B     DSPPOST            GO QPOST ERB TO DISK READ ROUTINE     56600020
         AIF   ('&GEN' EQ 'VTAM').EQUATES                        X03039 56604008
         SPACE 7                                                 S21101 56609020
         EJECT                                                   S22025 56700922
SETSCERB EQU   * .                                               S22025 56701822
         TM    SCBQTYPE,SCBCOREQ .      CORE QUEUEING            S22025 56702722
         BO    GOCORE .                 YES-BR                   S22025 56703622
         TM    SCBSTAT1,PRFNLSTN  .     EOM BUFFER               S22025 56704522
         BO    NOTALL .                 BRANCH IF NO             S22025 56705422
         CLC   SCBDEOB+1(3),SCBCRCD .   SENDING LAST SEGMENT     S22025 56706322
         BNL   GOCORE                                           SA60792 56707222
         NC    SCBXTRA(THREE),SCBXTRA                           SA60792 56707322
         BZ    RSET                                             SA60792 56707422
         CLC   SCBDEOB+ONE(THREE),SCBXTRA                       SA60792 56707522
         BNL   GOCORE                                           SA60792 56707622
RSET     EQU   *                                                SA60792 56707722
         OI    SCBSTAT1,PRFNLSTN .      FLAG NOT LAST            S22025 56708122
NOTALL   EQU   * .                                               S22025 56709022
         XC    SCBXTRA(3),SCBXTRA .     CLEAR FOR RECALL         S22025 56709922
         XC    SCBNTXT(3),SCBNTXT .     CLEAR FOR RECALL         S22025 56710822
GOCORE   EQU   *                                                 S22025 56711722
         MVZ   SCBHBFNO,SCBQTYPE        SET QTYPE FLGS FOR FA   SA52971 56712122
         MVC   LCBCPA(4),SCBDEOB .      SAVE ACROSS RECALL       S22025 56712622
         MVC   LCBCPA+4(3),SCBTRANS .   SAVE SCB TRANS ACROSS RCLS22025 56713022
         MVI   LCBERBPY,PRIDKEOB .      RECALL PRIORITY          S22025 56713522
         MVI   LCBERBCT,1 .             RECALL BUFFER COUNT      S22025 56714422
         MVI   LCBERBCT+1,AVTEZERO .    CLEAR DISABLED COUNT     S22025 56715322
         OI    LCBSTAT1,LCBRCLLN .      SET RECALL BIT IN LCB    S22025 56716222
         LA    R0,ERBRETRN .            RETURN ADDR FOR ERB      S22025 56717122
         ST    R0,LCBRCQCB .            IN LCB                   S22025 56718022
         B     COMMON                   GO POST ERB              S22025 56718922
         SPACE 3                                                 S22025 56723422
         DS    0F .                     WORD BOUNDARY            S22025 56724322
ERBRETRN EQU   *-8 .                    QCB                      S22025 56725222
         DC    AL1(DSPMCPL4),AL3(*-1) . STCB THAT GETS CONTROL   S22025 56726122
*                                       WHEN ERB FOR RECALL IS   S22025 56727022
*                                       POSTED BACK TO R4 WHEN   S22025 56727922
*                                       READ IS DONE             S22025 56728822
         USING *,R15                                           @OY19438 56729282
         L     RBASE,BASE               LOAD BASE REGISTER     @OZ24185 56729700
         DROP  R15                                             @OY19438 56730782
         USING TAG,RBASE                                       @OY19438 56731782
         LA    RWORK,LCBERB-IEDQLCB .   ERB OFFSET INTO LCB      S22025 56733322
         SR    RTEMP,RWORK .            COMPUTE LCB ADDRESS      S22025 56734222
         LR    RLCB,RTEMP .             LCB ADDR                 S22025 56735122
         L     RLAST,LCBSCBA-1 .        SCB ADDRESS              S22025 56736022
         L     RTEMP,LCBERBCH-1 .       RECALLED BUFFER ADDRESS  S22025 56737822
         OI    PRFSTAT1-IEDQPRF(RTEMP),PRFCNCLN . SET CNCL FLG   S22025 56738722
         MVC   LCBISZE(1),PRFSCAN+1-IEDQPRF(RTEMP) . SET IDLES CTS22025 56739622
         MVC   LCBTTBIN,SCBDCHDR .      SETUP TNTOFFSET          S22025 56740522
         LA    RTEMP,AVTINOUT .         INMSG/OUTMSG DELIMITER   S22025 56741422
         STCM  RTEMP,AD,SCBMACR         RESET MACRO ADDRESS      Y01948 56742305
         MVC   SCBUNTCT(1),SCBDEOB .    SET UNIT COUT            S22025 56745022
         MVC   SCBDEOB(4),LCBCPA .      RESTORE DEOB OFTER RECALLS22025 56745922
         MVC   SCBTRANS(3),LCBCPA+4 .   RESTORE SCB TRANS        S22025 56746222
         NI    SCBHBFNO,CLEAR0F         RESET HBFNO              S22025 56746522
         LA    RTEMP,AVTACTIB .         ACTIVATE ROUTINE QCB ADDRS22025 56746822
         L     RQCB,SCBDESTQ-1 .        PICK UP QCB ADDR         S22025 56748622
         NI    SCBQTYPE,AVTEFF-SCBBFMM .RESET MIDDLE OF MSG BIT  S22025 56749522
         NI    QCBSTAT,AVTEFF-QCBSEND .RESET QCB SEND BIT        S22025 56750422
         NI    LCBSTAT1,AVTEFF-LCBRCLLN RESET RECALL BIT         S22025 56751322
         TM    LCBERBST,LCBEOMSG .      EOM IN RECALLED BUFFER   S22025 56752222
         BO    COMMON2                  GO POST ERB              S22025 56753122
         B     COMMON1                  GO POST ERB              S22025 56754022
BASE     DC    A(TAG)                   BASE ADDRESS CONSTANT  @OZ24185 56764000
.EQUATES ANOP                                                    X03039 56774008
         EJECT                                                          56800020
*                                 OTHER EQUATES                         57000020
         SPACE 1                                                        57100020
AUTOPOLL EQU   X'01'              INVITATION LIST IS CURRENTLY BEING    57200020
*                                      AUTOPOLLED                       57300020
CLOSEDWN EQU   X'01'                    LINE STOPPED BY        @SA71683 57303061
*                                        CLOSEDOWN             @SA71683 57306061
ZERO     EQU   0                                                 S99228 57310022
ONE      EQU   1                        CONSTANT OF ONE         SA60792 57320022
THREE    EQU   3                        CONSTANT OF THREE       SA60792 57330022
TWO      EQU   2                                                 S99228 57350022
AD       EQU   7                        MASK FOR STCM OF ADDRESS Y01948 57370005
CALLOPT  EQU   X'70'                    MASK STCB PRI DIAL UP           57400020
*                                         CLOCK OR INTVL                57500020
XB0      EQU   X'B0'                    MASK FOR 1ST TIME SWITCH X03039 57550008
SENDPRI  EQU   X'20'                    MASK FOR SEND PRIORITY          57600020
CONNECT  EQU   X'80'                    MASK FOR DIAL CONNECTION        57700020
CALLPRI  EQU   X'50'                    PRIORITY OF DIAL SEND WITH      57800020
*                                         CALL=NONE                     57900020
DELAY    EQU   X'02'                    MASK FOR LCB IN DELAY Q         58000020
STATUS   EQU   X'03'              OFFSET OF STATUS INFORMATION IN       58100020
*                                      INVITATION LIST                  58200020
*                                      FOR OUTPUT                       58300020
NOP      EQU   X'03'              NO-OP CHANNEL COMMAND CODE            58400020
TIC      EQU   X'08'              TIC CHANNEL COMMAND CODE              58500020
OPEN     EQU   X'10'              DCB FLAG INDICATING LINE GROUP OPEN   58600020
SENSE    EQU   X'FF'              VALUE SET IN SENSE BYTE OF COMMAND    58700020
*                                      FOLLOWING PREPARE ON CONTENTION  58800020
*                                      TERMINALS                        58900020
F0       EQU   X'F0'                    DIAL CONNECTION AND NO DIAL     59000020
X0F      EQU   X'0F'                    MASK USED FOR INITIAL BUFF      59100020
X12      EQU   X'12'                                               2741 59200020
POLL     EQU   X'09'                    POLL COMMAND                    59300020
LCBNSRCD EQU   X'01'                    FLAG FOR INITIATE MODE          59400020
ERPCTL   EQU   X'24'                    BITS IN LCBFLAG1-ERP IS IN      59500020
*                                         CONTROL                       59600020
LINEADD  EQU   4                        OFFSET IN UNCB-LINE ADDRESS     59700020
SENSMASK EQU   X'FF'                    VALUE OF SENSE FIELD IN         59800020
*                                         LCB BEFORE SENSE              59900020
AIBM1    EQU   X'1F'                                                TSO 59920020
T1050    EQU   X'51'                                                TSO 59940020
T2741B   EQU   X'56' .                                              TSO 59960020
T2741C   EQU   X'55' .                                              TSO 59980020
RECVPRI  EQU   X'80'                    LCB RECV PRI VALUE      SA58984 59990005
         AIF   ('&GEN' NE 'VTAM').NVTAM                          X03039 59990908
ONESECD  EQU   1                        ONE SECOND DELAY         X03039 59991808
FOUR     EQU   4                        IEDAYG ENTRY PNT INDEX @Z30X8IR 59992208
WORD2    EQU   4                        OFF TO 2ND WORD OF SAVE  X03039 59992708
HALF     EQU   32                                                X03039 59993608
LUINIT   EQU   X'50'                    TCMSESN=LUINIT (FOR LU)@XM10739 59994009
NOCALL   EQU   X'50'                    CALL=NONE SS PRIORITY    X03039 59994508
CINTVL   EQU   X'70'                    CHECK CINTVL SPECIFIED   X03039 59995408
CLOCK    EQU   X'80'                    CHECK CLOCK SPECIFIED    X03039 59996308
LXC      EQU   X'1B'                    VTAM LCCW RESET COND'L   X03039 59997208
*                                       OP CODE                  X03039 59998108
.NVTAM   ANOP                                                    X03039 59999008
HIOCC    EQU   X'48'                    IOHALT COMPLETION CODE   Y02027 60000006
         SPACE 1                                                        60100020
         AIF   ('&GEN' EQ 'MINI').L20                                   60200020
         AIF   ('&GEN' NE 'VTAM').DOCQAD                         X03039 60210008
HUND     DC    F'100'                   ONE HUNDRED              X03039 60220008
TWELVHR  DC    F'43200'                 NUMBER SECONDS IN 12 HRS X03039 60230008
TWNTY4HR DC    F'86400'                 NUMBER SECONDS IN 24 HRS X03039 60240008
         AGO   .VCLEAR                                           X03039 60250008
.DOCQAD  ANOP                                                    X03039 60260008
DOCQAD   DC    AL2(LCBFLAG1-IEDQLCB+12) CONSTANT TO OBTAIN CALL Q       60300020
.L20     ANOP                                                           60400020
LCBSIZE  DC    AL2(LCBFLAG1-IEDQLCB)    SIZE OF LCB FROM RCB TO IOB     60500020
.VCLEAR  ANOP                                                    X03039 60700008
CLEAR    DS    0F                                                       60900020
         DC    X'00FFFFFC'                                              61000020
         AIF   ('&GEN' EQ 'VTAM').VDSECTS                        X03039 61050008
CLRLOW   DS    0F                                              @OS77835 61080091
         DC    X'00FFF000'              CLEAR FOR ADDRESS TRANS@OS77835 61110091
CLRHI    DC    X'00000FFF'              CLEAR FOR ADDR TRANS   @OS77835 61140091
DISDLEOT EQU   X'01'                    FLAG TO WRITE DLE EOT           61200020
OUTPUT   EQU   X'01'                    DEB MASK OPEN OUTPUT            61300020
OUTONLY  EQU   X'03'                    OUTPUT ONLY DEVICE FLAG@OX13500 61310091
         AGO   .DSECTS                                           X03039 61320008
.VDSECTS ANOP                                                    X03039 61340008
         EJECT                                                          61360008
         IFGACB                                                  X03039 61380008
         EJECT                                                          61400008
         TLGBD                                                   X03039 61420008
         EJECT                                                          61440008
.DSECTS  ANOP                                                    X03039 61460008
         TPRIOR                                                         61500020
         TAVTD                                                          61600020
         TPRFD                                                          61700020
         DCBD  DSORG=TX                                                 61800020
         TDISPD                                                         61900020
         TLCBD                                                          62000020
         TQCBD                                                          62100020
         TSCBD                                                          62200020
         TSTCBD                                                         62300020
         TTRMD                                                          62400020
         TTSID                                                      TSO 62500020
         TCCWD                                                          62600020
         TDEBD                                                          62700020
         MEND                                                           62800020
./  ADD  SSI=61400513,NAME=TACSMD
         MACRO                                                          01000020
         TACSMD                                                         02000020
.*A562000-566000,026000                                          S21101 02300010
.*A568000                                                        S22025 02400010
.*C562000,566000                                                 S22025 02500010
.*           MACRO VERSION DATED 6/24/71                         S21101 02600010
.*             MACRO UPDATED 10/20/71                            S22025 02800010
*                     TCAM ACCESS METHOD WORKAREA                       03000020
         SPACE 2                                                        04000020
IEDQWRKA DSECT                                                          05000020
PWASAVE  DS    0F                                                       06000020
GWASAVE  DS    F                        ADDRESS OF USER'S               07000020
*                                       REGISTER SAVEAREA               08000020
PWAPEWA  DS    F .                      ADDR OF PROCESS ENTRY WORKAREA  09000020
GWAPEB   DS    F                        ADDRESS OF PART-EMPTY BFR       10000020
PWASTART DS    0F                       ADDRESS OF FIRST BYTE OF        11000020
*                                       DATA IN WORKAREA                12000020
GWAMOVE  DS    F                        ADDRESS OF NEXT BYTE IN A       13000020
*                                       BUFFER TO BE MOVED              14000020
PWACKPT  DS    0F                                                       15000020
GWACKPT  DS    F                        ADDRESS OF USER'S               16000020
*                                       CHECKPOINT ROUTINE              17000020
GWAPEWA  DS    F                        ADDRESS OF NEXT EMPTY BYTE      18000020
*                                       IN USER'S WORKAREA              19000020
PWAECB   DS    0F                       PUT/WRITE ECB                   20000020
GWAECB   DS    F                        GET/READ ECB                    21000020
PWAELEM  DS    0F                                                       22000020
GWAELEM  DS    5F .                     SPECIAL AQCTL ELEMENT           23000020
PWALIST  DS    0F                                                       24000020
GWALIST  DS    0F                       AQCTL PARAMETER LIST            25000020
MOVEAD   DS    F                        ADDR OF FIELD TO BE MOVED       26000020
TARGETAD DS    F                        TARGET OF DATA MOVEMENT         27000020
PFLAG    DS    FL1                      END-OF-LIST INDICATOR           28000020
LENGTHAD DS    3X                       ADDRESS OF LENGTH OF FIELD      29000020
PWASAVA  DS    0F                       PUT/WRITE SAVEAREA              30000020
GWASAVA  DS    18F                      READ/CHECK SAVEAREA             31000020
PWAFLG   DS    H                                                        32000020
IOBPSAVE DS    F                        CONTAINS ADDRESS OF PARTLY      33000020
*                                       EMPTY BUFFER UNIT               34000020
GWASTAT  DS    0F                       ADDR OF STATUS INDICATORS       35000020
PWASTAT  DS    F                        ADDR OF STATUS INDICATORS       36000020
PWASOWA  DS    0H                       SIZE OF WORKAREA                37000020
GWASOWA  DS    H                        SIZE OF USER'S WORKAREA         38000020
PWACTL   DS    X                        WORKAREA CONTENTS               39000020
*                                       DESCRIPTOR BYTE                 40000020
GWARDEL  DS    X                        RECORD DELIMITER                41000020
GWABUFL  DS    H                        SIZE OF MCP BUFFER              42000020
PWAOPTCD DS    0X                                                       43000020
GWAOPTCD DS    X                        GENERAL SWITCHES                44000020
PWARECFM DS    0X                                                       45000020
GWARECFM DS    X                        GENERAL SWITCHES                46000020
GWALRECL DS    H                        SIZE OF LOGICAL WORK UNIT       47000020
PWAOFF   DS    H                                                        48000020
CTLADDR  DS    F                        ADDR OF WORKAREA CONTROL BYTE   49000020
GWASCAN  DS    H                        SIZE OF FIELD TO BE SCANNED     50000020
BUFCNT   DS    H                        EMPTY-BUFFER COUNTER            51000020
IOBUSZE  DS    H                        COUNT OF DATA IN A LOGICAL      52000020
*                                       BUFFER                          53000020
IOBPSZE  DS    H                        PREFIX SIZE WORKAREA            54000020
IOBSRCE  DS    H                        TERMNAME TABLE OFFSET           55000020
GWARTVE  DS    2F                       MSG RETRIEVAL WORKAREA          56000020
GWAOPT2  DS    X                        OPTIONS FROM TPDATE      S22025 56200010
GWADLTE  EQU   X'40'                   DELETE=YES SPECIFIED      S21101 56400010
GWADATE  EQU   X'10'                    DTSAREA IS SPEC          S22025 56600010
GWADTSA  DS    AL3                      DATE/TIME/SOURCE AREA    S22025 56800010
WRKAEND  EQU   *                                                        57000020
WRKASIZE EQU   WRKAEND-IEDQWRKA                                         58000020
         MEND                                                           59000020
./  ADD  SSI=61820037,NAME=TADWD
 /*                                                                   */00900010
 /*                ... ACTIVATE NCP COMMON AREA ...                   */01800010
 /*                                                                   */02700010
 /*A000000-999999                                             @Y17XAXG*/03600010
    DCL 1 IEDQADW BASED(RDATA),    /*STORAGE AREAS IN OP.CTL. WORK      04500010
                                    AREA */                             05400010
      2 ADWRRTP PTR(31),            /*POINTER TO START OF RRT*/         06300010
      2 ADWRVTP PTR(31),            /*RVT POINTER*/                     07200010
      2 ADWENTP PTR(31),           /*ENTRY POINTER INTO RRT*/           08100010
      2 ADWENTRR PTR(31),           /*POINTER INTO RESOURCE ENTRIES IN  09000010
                                    RRT*/                               09900010
      2 ADWRSCP PTR(31),            /*POINTER TO START OF RESOURCE      10800010
                                    ENTRIES IN RRT*/                    11700010
      2 ADWENTRV PTR(31),           /*POINTER INTO RVT ENTRIES*/        12600010
      2 ADWLGBP PTR(31),            /*POINTER TO LINE GROUP BLOCK*/     13500010
      2 ADWLCBP PTR(31),            /*POINTER TO LINE CONTROL BLOCK*/   14400010
      2 ADWDCBP PTR(31),            /*POINTER TO DATA CONTROL BLOCK*/   15300010
      2 ADWBYTEP PTR(31),           /*LOCAL POINTER*/                   16200010
      2 ADWLSTLN PTR(31),           /*LAST LINE'S TTE ADDR.*/           17100010
      2 ADWLSTRM PTR(31),           /*LAST TERM.'S TTE ADDR.*/          18000010
      2 ADWNCPTE PTR(31),           /*NCP'S TTE ADDR.*/                 18900010
      2 ADWNATP PTR(31),           /*POINTER TO NAT*/                   19800010
      2 ADWSATP PTR(31),           /*POINTER TO SAT*/                   20700010
      2 ADWSTGSZ FIXED(31),         /*STORAGE SIZE FOR RVT*/            21600010
      2 ADWENTNM FIXED(31),         /*COUNT OF RRT ENTRIES*/            22500010
      2 ADWENTSZ FIXED(31),         /*LENGTH OF RRT ENTRY*/             23400010
      2 ADWPSNAN FIXED(31),         /*NUMBER OF PRE-SNA ENTRIES IN      24300010
                                    RRT*/                               25200010
      2 ADWCTR FIXED(31),           /*LOOP COUNTER*/                    26100010
      2 ADWENTCT FIXED(31),         /*LOOP COUNTER*/                    27000010
      2 ADWBSCCT FIXED(31),         /* COUNT OF PRE-SNA DEVICES IN      27900010
                                    RVT*/                               28800010
      2 ADWRVTLG FIXED(31),         /*LENGTH OF RVT*/                   29700010
      2 ADWGETAR CHAR(12) BDY(WORD),/*HOLDS LIST FORM OF GETMAIN*/      30600010
      2 ADWFREAR CHAR(12) BDY(WORD),/*HOLDS LIST FORM OF FREEMAIN*/     31500010
      2 ADWBLDL CHAR(62) BDY(HWORD),                                    32400010
      3 ADWNTRYN PTR(15),         /*NUMBER OF BLDL ENTRIES*/            33300010
      3 ADWNTRYL PTR(15),         /*LENGTH OF ENTRY*/                   34200010
      3 ADWLNTRY,                                                       35100010
      4 ADWLNAME CHAR(8),         /*NAME OF LOAD MODULE*/               36000010
      4 ADWDATA CHAR(50),        /*FILLED IN BY BLDL*/                  36900010
      2 ADWIPLTN CHAR(9),           /*IPL TEXT NAME*/                   37800010
      2 ADWSRCH BIT(8),             /*PARAMETER FOR SEARCH ROUTINE*/    38700010
      2 ADWISUBA FIXED(8),          /*ISOLATE SUBAREA SHIFT CT.*/       39600010
      2 ADWPADSZ FIXED(8),          /*CONTENTS OF RRTBUFSZ*/            40500010
      2 ADWFLGS1 CHAR(1),         /*FLAG BYTE ONE*/                     41400010
      3 ADWERRFG BIT(1),          /*ERROR FLAG*/                        42300010
      3 ADWPSNA BIT(1),           /*PRE SNA SWITCH*/                    43200010
      3 ADWLOOP BIT(1),           /*LOOP SWITCH*/                       44100010
      3 ADWSKIP BIT(1),           /*SKIP SWITCH*/                       45000010
      3 ADWQCBSK BIT(1),          /*SKIP QCB CHECK SWITCH*/             45900010
      3 ADWOUTSW BIT(1),          /*SWITCH TO GET OUT OF MODULE*/       46800010
      2 ADWFLGS2 BIT(8),          /*FLAG BYTE 2*/                       47700010
      3 ADWLNDEL BIT(1),          /*INDICATES LINE RVTINDEX IS 0*/      48600010
      3 ADWPUDEL BIT(1),          /*INDICATES PU RVTINDEX IS 0*/        49500010
      3 ADWCTERM BIT(1),          /*INDICATES PRE-SNA SWITCHED LINE     50400010
                                  ENCOUNTERED*/                         51300010
      3 ADWGPCLS BIT(1),          /*INDICATES PRE-SNA CLUSTER           52200010
                                    ENCOUNTERED*/                       53100010
      2 ADWFLGS3 BIT(8),          /*FLAG BYTE 3*/                       54000010
      3 ADWMANDL BIT(1);          /* MANUAL DIAL SWITCH*/               54900010
    DCL RRTPTR PTR(31) DEFINED(ADWRRTP);                                55800010
    DCL RVTPTR PTR(31) DEFINED(ADWRVTP);                                56700010
    DCL ENTRYPTR PTR(31) DEFINED(ADWENTP);                              57600010
    DCL ENTADDRR PTR(31) DEFINED(ADWENTRR);                             58500010
    DCL RSCPTR PTR(31) DEFINED(ADWRSCP);                                59400010
    DCL ENTADDRV PTR(31) DEFINED(ADWENTRV);                             60300010
    DCL LGBPTR PTR(31) DEFINED(ADWLGBP);                                61200010
    DCL LCBPTR PTR(31) DEFINED(ADWLCBP);                                62100010
    DCL DCBPTR PTR(31) DEFINED(ADWDCBP);                                63000010
    DCL BYTEPTR PTR(31) DEFINED(ADWBYTEP);                              63900010
    DCL LASTLINE PTR(31) DEFINED(ADWLSTLN);                             64800010
    DCL LASTTERM PTR(31) DEFINED(ADWLSTRM);                             65700010
    DCL NCPTTEA PTR(31) DEFINED(ADWNCPTE);                              66600010
    DCL IEDQNATP PTR(31) DEFINED(ADWNATP);                              67500010
    DCL IEDQSATP PTR(31) DEFINED(ADWSATP);                              68400010
    DCL STGSIZE FIXED(31) DEFINED(ADWSTGSZ);                            69300010
    DCL ENTRYNUM FIXED(31) DEFINED(ADWENTNM);                           70200010
    DCL ENTRYSIZ FIXED(31) DEFINED(ADWENTSZ);                           71100010
    DCL PSNANUM FIXED(31) DEFINED(ADWPSNAN);                            72000010
    DCL CTR FIXED(31) DEFINED(ADWCTR);                                  72900010
    DCL ENTCTR FIXED(31) DEFINED(ADWENTCT);                             73800010
    DCL BSCTR FIXED(31) DEFINED(ADWBSCCT);                              74700010
    DCL RVTLGTH FIXED(31) DEFINED(ADWRVTLG);                            75600010
    DCL GETAREA CHAR(12) BDY(WORD) DEFINED(ADWGETAR);                   76500010
    DCL FREEAREA CHAR(12) BDY(WORD) DEFINED(ADWFREAR);                  77400010
    DCL 1 BLDLIST CHAR(62) BDY(HWORD) DEFINED(ADWBLDL),                 78300010
        2 BLDNTRYN PTR(15),                                             79200010
        2 BLDNTRYL PTR(15),                                             80100010
        2 BLDLNTRY CHAR(58),                                            81000010
        3 BLDLNAME CHAR(8),                                             81900010
        3 BLDLDATA CHAR(50);                                            82800010
    DCL IPLTXTNM CHAR(9) DEFINED(ADWIPLTN);                             83700010
    DCL SRCH BIT(8) DEFINED(ADWSRCH);                                   84600010
    DCL ISOSUBA FIXED(8) DEFINED(ADWISUBA);                             85500010
    DCL PADSIZE FIXED(8) DEFINED(ADWPADSZ);                             86400010
    DCL 1 FLAGS1 CHAR(1) DEFINED(ADWFLGS1),                             87300010
        2 ERRFLG BIT(1),                                                88200010
        2 PSNASW BIT(1),                                                89100010
        2 LOOPSW BIT(1),                                                90000010
        2 SKIPSW BIT(1),                                                90900010
        2 QCBSKP BIT(1),                                                91800010
        2 OUTSW BIT(1);                                                 92700010
    DCL 1 FLAGS2 BIT(8) DEFINED(ADWFLGS2),                              93600010
        2 LINEDEL BIT(1),                                               94500010
        2 PUDEL BIT(1),                                                 95400010
        2 CTERMDEL BIT(1),                                              96300010
        2 GPCLUST BIT(1);                                               97200010
    DCL 1 FLAGS3 BIT(8) DEFINED(ADWFLGS3),                              98100010
        2 MANDLSW BIT(1);                                               99000010
./  ADD  SSI=71100933,NAME=TAIBD
         MACRO                                                          00500006
         TAIBD &EXT=(NETWKCTL,GETREAD,PUTWRITE,POINT,CKREQ,QRESET)      01000006
IEDQAIB  DSECT                                                          01500006
         SPACE                                                          02000006
*        OS/VS2 , TCAM LEVEL 9, 9/22/75                        @Z40X9AG 02100009
         SPACE 1                                               @Z40X9AG 02200009
.*A605000                                                      @ZA03744 02250010
.*D620000                                                      @ZA03744 02300010
.*C525000,640000                                               @Z40X9AG 02350010
.*A200000                                                      @OZ09941 02400010
.*C815000-835000                                               @OZ11191 02450010
AIBSTATE DS    X                        STATUS OF BLOCK                 02500006
AIBFREE  EQU   X'00'                    BLOCK AVAILABLE                 03000006
AIBBUSY  EQU   X'80'                    BLOCK BUSY                      03500006
AIBCHAIN DS    AL3                      LINK FIELD OF CHAIN OF          04000006
*                                       AIBS                            04500006
AIBECBA  DS    A                        ADDRESS OF ECB FOR SVC102       05000006
AIBPCBAD DS    A                        PCB ADDRESS                     05500006
AIBWAPTR DS    A                        POINTER TO WORKAREA IN          06000006
*                                       AIB                             06500006
AIBKEY   DS    X                        RCB KEY FIELD                   07000006
AIBAPKEY EQU   X'18'                    APPL PROG / NETWKCTL FUNC       07500006
AIBQCBA  DS    AL3                      QCB ADDRESS OF RCB              08000006
AIBPRI   DS    X                        PRIORITY OF RCB                 08500006
AIBLINK  DS    AL3                      LINK FIELD OF RCB               09000006
AIBEXT   DS    0F                       EXTENSION FOR FUNCTION          09500006
         LCLA  &IND                                                     10000006
&IND     SETA  1                                                        10500006
.LOOP1   AIF   (&IND GT 6).NEXT1                                        11000006
         AIF   ('&EXT(&IND)' EQ 'NETWKCTL').NET                         11500006
&IND     SETA  &IND+1                                                   12000006
         AGO   .LOOP1                                                   12500006
.NET     ANOP                                                           13000006
         SPACE 1                                                        13500006
*        OPCTL / NETWORK CONTROL FUNCTION EXTENSION                     14000006
AIBCOMCD DS    XL1                      COMMAND VERB FIELD              14500006
*                     BIT   DEFINITIONS                               * 15000006
AIBMCNT  EQU   X'06'                    MCOUNT                          15500006
AIBTPDAT EQU   X'07'                    TPDATE                          16000006
AIBQCLS  EQU   X'10'                    MCPCLOSE - QUICK                16500006
AIBFCLS  EQU   X'11'                    MCPCLOSE - FLUSH                17000006
AIBTCHNG EQU   X'20'                    TCHNG                           17500006
AIBQCOPY EQU   X'40'                    QCOPY                           18000006
AIBICHNG EQU   X'49'                    ICHNG                           18500006
AIBICOPY EQU   X'50'                    ICOPY                           19000006
AIBTCOPY EQU   X'80'                    TCOPY                           19500006
AIBMRLSE EQU   X'87'                    MREALEASE                       20000006
AIBICPYX EQU   X'D0'                    ICOPY EXTENDED         @OZ09941 20200010
*                                                                     * 20500006
AIBFLAG1 DS    XL1                      FLAG BYTE                       21000006
*                     BIT   DEFINITIONS                               * 21500006
AIBENT01 EQU   X'01'                    3705 SERVICE RTN ENTRY          22000006
*                                       CODE FOR TCOPY                  22500006
AIBENT02 EQU   X'02'                    3705 SERVICE ENTRY              23000006
*                                       CODE FOR ICOPY                  23500006
AIBGETSZ EQU   X'80'                    FLAG = SIZING REQUEST           24000006
AIBTNT   EQU   X'40'                    FLAG = LOOK UP TERMINAL         24500006
*                                       ENTRY ADDRESS                   25000006
*                                                                     * 25500006
AIBFLAG2 DS    XL1                      FLAG BYTE                       26000006
*                     BIT   DEFINITIONS                               * 26500006
AIBRES04 EQU   X'04'                    3705 SERVICE RTN RESPONSE       27000006
*                                       FOR ICOPY                       27500006
AIBRES08 EQU   X'08'                    3705 SERVICE RTN RESPONSE       28000006
*                                       FOR TCOPY                       28500006
AIBDTS   EQU   X'20'                    BIT ON = DATE TIME REQUEST      29000006
AIBDEL   EQU   X'40'                    BIT ON = 'DELETE=YES' SPECIFIED 29500006
AIBRECDL EQU   X'80'                    BIT ON = GET RECORD DELIMITER   30000006
*                                                                     * 30500006
AIBOPRC  DS    XL1                      RETURN CODE FIELD               31000006
AIBNAME  DS    0XL8                     TERM OR DD NAME                 31500006
         DS    F                        FILLER FOR DOUBLY USED AREA     32000006
AIBRNTO  DS    AL4                      3705 INTERFACE FIELD            32500006
AIBRNFRO DS    AL4                      3705 INTERFACE FIELD            33000006
AIBTNDX  DS    H                        TERMINAL INDEX FIELD            33500006
         DS    H                        FIELD SET & CHECKED BY 3705     34000006
*                                       SERVICE ROUTINE                 34500006
AIBCOUNT DS    H                        DATA BYTE COUNT                 35000006
AIBLIMIT DS    H                        QCOPY LIMIT VALUE               35500006
AIBRNRET DS    AL4                      RETURN ADD TO CONTINUE PROC     36000006
*                                       AFTER CALL TO 3705 SERVICE RTN  36500006
AIBQLMNA DS    AL4                      PTR TO USER'S TERM NA AREA FOR  37000006
*                                       QCOPY FUNCTION                  37500006
         DS    F                        RESERVED                        38000006
AIBXMLST DS    3F                       XMPOST LIST                     38500006
AIBDATA  DS    0F                       DATA AREA                       39000006
         SPACE 1                                                        39500006
.NEXT1   ANOP                                                           40000006
&IND     SETA  1                                                        40500006
.LOOP2   AIF   (&IND GT 6).NEXT2                                        41000006
         AIF   ('&EXT(&IND)' EQ 'GETREAD').GR                           41500006
&IND     SETA  &IND+1                                                   42000006
         AGO   .LOOP2                                                   42500006
.GR      ANOP                                                           43000006
         SPACE 1                                                        43500006
*        GET / READ FUNCTION EXTENSION                                  44000006
         SPACE 1                                                        44500006
         ORG   AIBEXT                   GETREAD                         45000006
AIBGPEWA DS    A                        ADDRESS OF PEWA                 45500006
AIBRECFG DS    X                        DCBRECFM                        46000006
AIBMACRF DS    X                        DCBMACRF                        46500006
AIBBUFL  DS    H                        DCBBUFL                         47000006
AIBBLKSI DS    H                        DCBBLKSI                        47500006
AIBLRECL DS    H                        DCBLRECL                        48000006
AIBOPTCG DS    X                        DCBOPTCD                        48500006
AIBEXLFG DS    X                        CHECKPOINT FLAG                 49000006
CKPTFLG  EQU   X'0F'                    CHECKPOINT IN EXIT LIST         49500006
AIBLNGTH DS    H                        DECLNGTH                        50000006
AIBDECBG DS    A                        ADDRESS OF DECB                 50500006
AIBDECS  DS    A                        DECSDECB                        51000006
WAFULL   EQU   X'40'                    WORKAREA FILLED                 51500006
AIBCTLG  DS    A                        ADDRESS OF CTL BYTE IN WA       52000006
AIBCMPTG DS    0CL16                    POST PARAMETER LIST    @Z40X9AG 52500009
AIBSSGF1 DS    XL1                      FLAG BYTE 1            @Z40X9AG 52550009
AIBSSGEC EQU   X'2C'                    SCH SRB ENTRY CODE     @Z40X9AG 52600009
AIBSSGEA DS    AL3                      ECB ADDRESS            @Z40X9AG 52650009
AIBSSGAS DS    A                        ASCB ADDRESS           @Z40X9AG 52700009
AIBSSGCC DS    XL1                      COMPLETION CODE        @Z40X9AG 52750009
         DS    XL1                      UNUSED                 @Z40X9AG 52800009
AIBSSGID DS    H                        ASID                   @Z40X9AG 52850009
AIBSSGTC DS    A                        TCB ADDRESS            @Z40X9AG 52900009
         ORG   AIBSTATE+72                                              53000006
AIBWAG   DS    0F                       START OF WORKAREA               53500006
.NEXT2   ANOP                                                           54000006
&IND     SETA  1                                                        54500006
.LOOP3   AIF   (&IND GT 6).NEXT3                                        55000006
         AIF   ('&EXT(&IND)' EQ 'PUTWRITE').PW                          55500006
&IND     SETA  &IND+1                                                   56000006
         AGO   .LOOP3                                                   56500006
.PW      ANOP                                                           57000006
         SPACE 1                                                        57500006
*        PUT / WRITE FUNCTION EXTENSION                                 58000006
         SPACE 1                                                        58500006
         ORG   AIBEXT                   PUTWRITE                        59000006
AIBPPEWA DS    A                        ADDRESS OF PEWA                 59500006
AIBMSTRT DS    H                        START OF MESSAGE                60000006
AIBWASZE DS    H                        SIZE OF WORKAREA                60500006
         DS    X                        RESERVED               @ZA03744 60700009
AIBEXLFP DS    X                        CHECKPOINT INDICATOR            61000006
CKPTFLP  EQU   X'0F'                    CHECKPOINT IN EXIT LIST         61500006
AIBOPTCP DS    X                        DCBOPTCD                        62500006
AIBRECFP DS    X                        DCBRECFM                        63000006
AIBDECBP DS    A                        ADDRESS OF DECB                 63500006
AIBCMPTP DS    0CL16                    POST PARAMETER LIST    @Z40X9AG 64000009
AIBSSPF1 DS    XL1                      FLAG BYTE 1            @Z40X9AG 64050009
AIBSSPEC EQU   X'2C'                    SCH SRB ENTRY CODE     @Z40X9AG 64100009
AIBSSPEA DS    AL3                      ECB ADDRESS            @Z40X9AG 64150009
AIBSSPAS DS    A                        ASCB ADDRESS           @Z40X9AG 64200009
AIBSSPCC DS    XL1                      COMPLETION CODE        @Z40X9AG 64250009
         DS    XL1                      UNUSED                 @Z40X9AG 64300009
AIBSSPID DS    H                        ASID                   @Z40X9AG 64350009
AIBSSPTC DS    A                        TCB ADDRESS            @Z40X9AG 64400009
         ORG   AIBSTATE+72                                              64500006
AIBWAP   DS    0F                       START OF WORKAREA               65000006
.NEXT3   ANOP                                                           65500006
&IND     SETA  1                                                        66000006
.LOOP4   AIF   (&IND GT 6).NEXT4                                        66500006
         AIF   ('&EXT(&IND)' EQ 'POINT').PT                             67000006
&IND     SETA  &IND+1                                                   67500006
         AGO   .LOOP4                                                   68000006
.PT      ANOP                                                           68500006
         SPACE 1                                                        69000006
*        POINT FUNCTION EXTENSION                                       69500006
         SPACE 1                                                        70000006
         ORG   AIBEXT                   POINT                           70500006
AIBRPEWA DS    A                        ADDRESS OF PEWA                 71000006
AIBSTANM DS    FL8                      STATION NAME                    71500006
AIBINOUT DS    X                        INPUT OR OUTPUT                 72000006
AIBIN    EQU   C'I'                     INPUT SEQUENCE NUMBER           72500006
AIBOUT   EQU   C'O'                     OUTPUT SEQUENCE NUMBER          73000006
AIBSEQNO DS    H                        SEQUENCE NUMBER                 73500006
AIBCMPTR DS    3F                       CROSS MEMORY POST LIST          74000006
         ORG   AIBSTATE+72                                              74500006
AIBWAR   DS    0F                       START OF WORKAREA               75000006
.NEXT4   ANOP                                                           75500006
&IND     SETA  1                                                        76000006
.LOOP5   AIF   (&IND GT 6).NEXT5                                        76500006
         AIF   ('&EXT(&IND)' EQ 'CKREQ').CK                             77000006
&IND     SETA  &IND+1                                                   77500006
         AGO   .LOOP5                                                   78000006
.CK      ANOP                                                           78500006
         SPACE 1                                                        79000006
*        CHECK REQUEST FUNCTION EXTENSION                               79500006
         SPACE 1                                                        80000006
         ORG   AIBEXT                   CKREQ                           80500006
*              CHECK REQUEST ELEMENT IN AIB STARTS WITH AIBKEY          81000006
AIBCKECB DS    A                        ADDRESS OF ECB - CREECB@OZ11191 81500010
AIBOFFS  DS    0H                       TERM ENTRY OFFSET -    @OZ11191 82000010
*                                        CREOFFS               @OZ11191 82500010
AIBCPEWA DS    A                        ADDRESS OF FIRST PEWA  @OZ11191 83000010
*                                        IN CHAIN - CREDEB     @OZ11191 83500010
AIBCMPTC DS    3F                       CROSS MEMORY POST LIST          84000006
.NEXT5   ANOP                                                           84500006
&IND     SETA  1                                                        85000006
.LOOP6   AIF   (&IND GT 6).FINIS                                        85500006
         AIF   ('&EXT(&IND)' EQ 'QRESET').QR                            86000006
&IND     SETA  &IND+1                                                   86500006
         AGO   .LOOP6                                                   87000006
.QR      ANOP                                                           87500006
         SPACE 1                                                        88000006
*        QRESET FUNCTION EXTENSION                                      88500006
         SPACE 1                                                        89000006
         ORG   AIBEXT                   QRESET                          89500006
AIBQPEWA DS    A                        ADDRESS OF PEWA                 90000006
AIBDESTN DS    FL8                      DESTINATION QUEUE NAME          90500006
AIBOSEQN DS    H                        OUTPUT SEQUENCE NUMBER          91000006
AIBINDEX DS    H                        INDEX TO TERMINAL ENTRY         91500006
AIBTTPTR DS    A                        ADDR OF TERM TABLE ENTRY        92000006
AIBMAXNO DS    F                        MAXIMUM SEQ NUMBER              92500006
AIBMSGNO DS    H                        MESSAGE NUMBER                  93000006
AIBRETCD DS    H                        RETURN CODE                     93500006
AIBCMPTQ DS    3F                       CROSS MEMORY POST LIST          94000006
         ORG   AIBSTATE+72                                              94500006
AIBWAQR  DS    0F                       START OF WORKAREA               95000006
.FINIS   SPACE                                                          95500006
         MEND                                                           96000006
./  ADD  SSI=73470350,NAME=TAVTD
*        %GOTO BSLAVT;                                               /* 00070000
         MACRO                                                          00140000
         TAVTD &C,&SAVT=YES                                      S22024 00210000
.*A-000000-999999                                              @X31X8X0 00280000
         SPACE                                                          00350000
.*       CONVERTED TO BILINGUAL ON 09/26/72                      S22024 00420000
.*       UPDATED   6/7/74                                      @Z30X8XE 00490000
.*CHANGE ACTIVITY = AS FOLLOWS:                                 SA51078 00560000
.*C006800                                                       SA51078 00630000
.*A610000,742000-745200                                         SA51078 00700000
.*D610000-616000,742000-744000                                  SA51078 00770000
.*A913230-913290,913480,939410-939430,939793-939796              X03039 00840000
.*C225600-225700,912300-913200,921150-921200,924650-924850,      X03039 00910000
.*C939050-939400,939792                                          X03039 00980000
.*D913300-913450,939450-939774                                   X03039 01050000
.*A208700,225600-225800                                          S22027 01120000
.*C232500,366000                                                 S22027 01190000
.*C232500                                                        S22026 01260000
.*A099000,208200-209600,225500,263000,285000,301000,303000       S22026 01330000
.*A341000,357000,695000                                          S22026 01400000
.*C178000                                                       SA65392 01470000
.*C178000                                                        S21903 01540000
.*A000000,912000                                                 S22024 01610000
.*C004000,225000,225600,232500-233000,914000                     S22024 01680000
.*A913405,939752                                                 Y06328 01750000
.*A913410,939754,913450,939774                                   Y05330 01820000
.*C006400                                                      @Z30X8XE 01890000
.*C913485-913492,939790-939792                                 @X50X9XI 01960000
.*A913490,939792                                               @X50X9XI 02030000
.*C912998,913080,913494-913500,939210,939560                   @XA09324 02100000
.*C939320-939332,939720-939792                                 @XA09324 02170000
.*D913493                                                      @XA09324 02240000
.*C913080                                                      @XA09795 02310000
.*A208600                                                      @ZA07083 02380000
.*C920350                                                      @ZA07083 02450000
.*C225600-225700,232700,912360-913517,921150-921210,921370     @Y17XANU 02520000
.*C939070-969789                                               @Y17XANU 02590000
.*A232700,698000,921370,934100                                 @Y17XANU 02660000
.*C896040,421207,410200,884100                                 @Y17XAXF 02680000
.*D410900,884800,424200,898100                                 @Y17XAXF 02700000
.*A082500,084100,530650,530700,530750,530800                   @G36XRXG 02710000
.*C133700,589400,590100                                        @OS77945 02720000
.*A459800,967800                                               @OY19488 02720182
*A171200,649600                                                @OY19124 02720282
.*C051800-052500,490700-491400                                 @OY19405 02720382
         SPACE                                                          02730000
IEDQAVTD DSECT                                                          02800000
         AIF   ('&C' EQ '').DSECT                                       02870000
         AIF    ('&C' EQ '2').D2                                        02940000
         AIF    ('&C' EQ '3').D3                                        03010000
         AIF    ('&C' EQ '4').D4                                        03080000
.DSECT   ANOP                                                           03150000
AVTSAVE1 DS    18F .                    MESSAGE CONTROL PROG SAVEAREA   03220000
.D2      ANOP                                                           03290000
AVTSAVE2 DS    18F                                                      03360000
.D3      ANOP                                                           03430000
AVTSAVE3 DS    18F                                                      03500000
.D4      ANOP                                                           03570000
AVTSAVE4 DS    18F                                                      03650000
AVTSAVEX DS    10F .                    DISABLED SAVEAREA               03710000
         ORG   *-8                                                      03780000
AVTDLQ   DS    D .                      DLQ=TERMNAME                    03850000
AVTCSTCS DS    A IEDQSTCS               ADDR OF FIRST ENTRY             03920000
*                                         CHARACTERISTICS TABLE         03990000
AVTDPARM DS    F .                      DISABLED PARAMETER LIST         04060000
*                                         USED WITH DOUBX               04130000
AVTDOUBX DS    D .                      DISABLED DOUBLEWORD SCRATCH     04200000
AVTDOUBL DS    D .                      ENABLED SCRATCH AREA            04270000
AVTCTLCH DS    D .                      OPERATOR CONTROL CHARACTERS     04340000
AVTPASWD DS    D .                      PASSWORD                        04410000
AVTTCB   DS    A .                      ADDRESS OF MESSAGE CONTROL      04480000
*                                         PROGRAM'S TCB.                04550000
*                                         SET BY OPEN                   04620000
AVTRACE  DS    A .                      TRACE TABLE ADDRESS             04690000
*                                                                       04760000
*                       DISPATCHER'S READY QUEUES                       04830000
*                                                                       04900000
AVTREADY DS    A AVTDELEM  .            ADDRESS OF FIRST OF CHAIN       04970000
*                                         OF ELEMENTS IN PRIORITY       05040000
*                                         ORDER                         05110000
AVTBUFTR DS    0A .                     ADD. OF BUFFER TRACE   @OY19405 05180082
AVTREADD DS    A .                      DISABLED FIFO READY Q  @OY19405 05190082
AVTBUFSW DS    0X .                     BUFFER TRACE OPTION SW @OY19405 05200082
AVTFULLT EQU   X'01' .                  TRACE ENTIRE BUFFER    @OY19405 05210082
AVTUNCON EQU   X'02' .                  TRACE WITHOUT IO TRACE @OY19405 05220082
         DS    1H .                                            @OY19405 05230082
AVTBUENT DS    0H .                     NO. ENT. SPEC. ON INTRO@OY19405 05240082
         DS    1H .                                            @OY19405 05250082
         DS    0A .                     CHECKPOINT WORKAREA    @Y17XAXF 05320000
AVTCKFLG DS    XL1 .                    CHECKPOINT ACTIVE FLAGS         05321000
*                                                              @Y17XAXF 05322000
AVTCKTAC EQU   X'80' .                   TCAM CHECKPOINT IS ACTIVE      05323000
*                                                              @Y17XAXF 05324000
AVTCKNAC EQU   X'40' .                   CHECKPOINT FOR A 3705 IS ACTIV 05325000
*                                                              @Y17XAXF 05326000
AVTCKENV EQU   X'20' .                   FORCE ENVIRONMENT CHECKPOINT   05327000
*                                                              @Y17XAXF 05327200
AVTCKREQ EQU   X'10' .                   THERE IS AN ELEMENT ON THE     05327400
*                                          OPERATOR CONTROL CHECKPOINT  05327600
*                                          QUEUE THAT WILL REQUEST AN   05327800
*                                          ENVIRONMENT CHECKPOINT       05328000
*                                                              @Y17XAXF 05328200
AVTCKHLT EQU   X'08' .                   A REQUEST TO CKPT A HALT TCAM  05328400
*                                          COMMAND HAS BEEN PROCESSED   05328600
*                                                              @Y17XAXF 05328800
*        EQU   X'04'-X'01' .             RESERVED              @Y17XAXF 05329000
AVTCKAVT DS    AL3 .                    ADDRESS OF CHECKPOINT AVT       05349000
*                                                              @Y17XAXF 05369000
AVTOCGET DS    A .                      OPERATOR CONTROL WORKAREA       05390000
AVTEXA2S DS    3H .                     EXECUTED INSTRUCTIONS TO        05460000
AVTEXS2A DS    3H .                       SAVE USER'S REGISTERS         05530000
AVTPARM  DS    A .                      ADDRESS OF PARAMETERS           05600000
*                                                                       05670000
AVTPKF   DS    0X .                     PROTECTION KEY FROM TCB         05740000
*                                         OF MCP                        05810000
*                        BIT DEFINITIONS                                05880000
AVTFTCHF EQU   X'08' .                  FETCH PROTECT ACTIVE SWITCH     05950000
*                                                                       06020000
AVTBASE  DS    A IEDQAVT  .             ADDRESS OF AVT                  06090000
AVTPARM3 DS    A .                      ADDITIONAL OPTIONAL PARM        06160000
AVTDISTR DS    A .                      ADDR OF DISPATCHER TRACE        06230000
AVTRNMPT DS    A IEDQTNT  .             ADDRESS OF TERMNAME TABLE       06300000
AVTRDYA  DS    A IEDQRDYA  .            USER EXIT ADDRESS IN READY      06370000
AVTBSCAN DS    A .                      LINE END BSC MSG SCAN           06440000
AVTRARTN DS    A AVTDUMBR               ADDR OF RTN TO UPDATE LINE      06510000
*                                         TRACE TABLE. IF TRACE,        06580000
*                                         OPEN LOADS THIS MODULE        06650000
AVTSBTA  DS    A .                      ADDR IEDQSBT ROUTINE   @YM07020 06720000
AVTMVBFR DS    A .                      ADDR OF IEDMVBFR ROUTN @Y17XAXF 06790000
* AVTMVBFR IS NON-ZERO IF NON-EP MODE  OR                      @Y17XAXF 06810000
* IF EP MODE, AND TOTE IS IN THE SYSTEM                        @Y17XAXF 06830000
AVTSPLPT DS    A .                      START PARAMETER LIST            06860000
*                                         POINTER, SET BY INTRO         06930000
AVTCIB   DS    AL1 .                    CIB=INTEGER                     07000000
AVTNCKPR DS    X .                      CKREQS=INTEGER                  07070000
AVTNOLBF DS    H .                      LNUNITS=INTEGER                 07140000
AVTAS    DS    A .                      RELEASE                         07210000
*                                                                       07280000
*              ADDRESSES OF TCBS OF ATTACHED TASKS                      07350000
*                                                                       07420000
AVTCKTCB DS    A .                      CHECKPOINT                      07490000
AVTOCTCB DS    A .                      OPERATOR CONTROL                07560000
AVTOLTCB DS    A .                      ON LINE TEST                    07630000
AVTCWTCB DS    A .                      COMMON WRITE FE TASK            07700000
*                                                                       07770000
*                       EVENT CONTROL BLOCKS                            07840000
*                                                                       07910000
AVTCWECA DS    A .                      COMMON WRITE FE TASK ECB        07980000
AVTCKECA DS    F .                      CHECKPOINT                      08050000
AVTOLECA DS    F .                      ON LINE TEST                    08120000
AVTOPECA DS    F .                      OPERATOR CONTROL                08190000
AVTECB1  DS    0XL1                                            @G36XRXG 08220000
AVTOSECB DS    F .                      EVENT CONTROL BLOCK USED BY     08260000
*                                         DISPATCHER TO CAUSE QTAM      08330000
*                                         TASK TO BE IN WAIT STATE      08400000
AVTCOMP  EQU   X'40'                    ECB POSTED COMPLETE    @G36XRXG 08430000
AVTPCBPT DS    A .                      FIRST PROCESS CONTROL BLOCK     08470000
AVTOPTPT DS    F .                      ADDRESS OF OPTION TABLE         08540000
AVTKA02  DS    A IEDQKA02               I/O GENERATOR IN ACTIVATE       08610000
AVTHRESH DS    F                        THRESHHOLD VALUES       SA65392 08680000
AVTCRSRF DS    F .                      CROSSRF=INTEGER                 08750000
AVTCOMPT DS    A .                      ADDR OF COMMUNICATIONS PARM     08820000
AVTUI    DS    A IEDQUI                 USER INTERFACE                  08890000
AVTE8    DS    A .                      SEARCH ROUT APPL. PROG.  S22025 08960000
AVTOLTST DS    0X .                     OLTEST=INTEGER                  09030000
AVTHG02  DS    A IEDQHG02               REMOVE ELE FROM TIME DELAY Q    09100000
AVTAL    DS    A IEDQAL                 SCAN AT OFFSET           S22025 09170000
AVTGD    DS    A IEDQGD  .              BUFFER ASSOCIATION              09240000
AVTA3    DS    A .                      TRANSPARENCY CCW BUILDER (BT)   09310000
AVTAX    DS    A IEDQAX                 SCAN BUFFER              S22025 09380000
AVTEA    DS    A .                      DISPATCHER                      09450000
*                                                                       09520000
AVTDISP  EQU   * .                      THESE SUBTASKS ARE ACTIVAT-     09590000
*                                         ED BY THE DISPATCHER.         09660000
AVTHA    DS    A .                      RECEIVE SCHEDULER               09730000
AVTSCOPT DS    0XL1 .                                            S22026 09800000
*                                                                S22026 09870000
*                      BIT DEFINITIONS FOR HIGH ORDER BYTE       S22026 09940000
AVTAPDMP EQU   X'20'                    APPL DUMP REQUESTED    @ZA07083 10010000
AVTCMBUF EQU   X'10' .                  COMMON BUFFER TRANSMISSINS22027 10080000
AVTCONC  EQU   X'08' .                  CONCENTRATOR MIXED       S22026 10150000
AVTCONCO EQU   X'04' .                  CONCENTRATOR ONLY        S22026 10220000
AVTN2741 EQU   X'02' .                  NO 2741 AND NO TSO       S22026 10290000
AVTNDIAL EQU   X'01' .                  NO DIAL                  S22026 10360000
*                                                                S22026 10430000
AVTHD    DS    A .                      SEND SCHEDULER                  10500000
AVTEW    DS    A .                      GET SCHEDULER                   10570000
AVTEC    DS    A .                      PUT SCHEDULER                   10640000
AVTEZ    DS    A .                      GET FIFO                        10710000
AVTBZ    DS    A .                      LOG SCHEDULER                   10780000
AVTR1    DS    A .                      DIAL SCHEDULER                  10850000
AVTHB    DS    A .                      BUFFERED SCHEDULER              10920000
AVTE7    DS    A .                      RETRIEVE SCHEDULER              10990000
AVTQ1    DS    A .                      LOCAL SCHEDULER          S22024 11060000
AVTCSCH  DS    A .                      CONC SEND SCHEDULER      S22026 11130000
AVTSEND  DS    V(IEDIAQ) .              3705 RES SEND SCHED    @Y17XAXU 11200000
AVTRCV   DS    V(IEDIAM) .              3705 RES RECV SCHED    @Y17XAXU 11270000
AVTCMBSS DS    A .                      COMMBUF SEND SCHEDULER   S22027 11340000
*                                                                       11410000
*                                                                       11480000
*                       SPECIAL ELEMENTS                                11550000
*                                                                       11620000
         DS    A .                      RESERVED                 S22024 11690000
AVTSAVTF DS    0X                       SAVT FLAGS               X03039 11760000
AVTVTMCP EQU   X'80' .                  3705 ENVIRONMENT       @Y17XAXU 11830000
AVTONSNA EQU   X'40' .                  ONLY SNA ENVIRONMENT   @Y17XAXU 11900000
AVTSNA   EQU   X'20' .                  SNA ENVIRONMENT        @Y17XAXU 11970000
AVTSAVTP DS    A .                      SECONDARY AVT POINTER    S22024 12040000
AVTPLCBN DS    H .                      NUMBER OF PLCBS          S22024 12110000
AVTABEND DS    3H .                     ABEND 045, SUBCODE IN R15       12180000
AVTDMECB DS    A .                      DUMMY LINE I/O ECB              12250000
AVTA3TL  DS    A .                      IEDQA3,TRANSLATE LIST           12320000
AVTTONE  DS    A .                      ADDR OF WORLD TRADE TONE CHARS  12390000
AVTNX    DS    A .                      OPERATOR AWARENESS MSG ROUTER   12460000
AVTIOT   DS    A IGG019Q0               I/O TRACE TABLE HANDLER         12530000
AVTHI    DS    A IEDQHI                 SYSTEM DELAY QCB ADDR           12600000
AVTHK    DS    A IEDQHK                 STOPLINE QCB ADDR               12670000
AVTCKPEL DS    0CL16 .                  TIME DELAY REMOVAL ELEMENT      12740000
*                                       FOR CHECKPOINT         @Y17XAXF 12741000
AVTCKRMV DS    0F .                      1ST WORD OF REMOVAL ELEMENT    12742000
*                                                              @Y17XAXF 12743000
AVTCKRKY DS    XL1 .                      KEY FOR REMOVAL ELEMENT       12744000
*                                                              @Y17XAXF 12745000
AVTCKRMQ DS    AL3 .                      ADDR OF TIME DELAY QCB        12810000
*                                                              @Y17XAXF 12811000
AVTCKRPR DS    XL1 .                     PRIORITY              @Y17XAXF 12812000
AVTCKRLK DS    AL3 .                     LINK                  @Y17XAXF 12813000
         DS    CL8                       LAST 2 WORDS OF ELEMENT        12814000
*                                                              @Y17XAXF 12815000
AVTCKELE DS    2A .                     TIME DELAY OR REUS POSTS        12880000
*                                         ELE TO START CHECKPOINT       12950000
AVTSCBSZ DS    X .                      NO. BYTES IN SCB INCLUDING      13020000
*                                         SAVEAREA FOR USER'S REGS      13090000
AVTCKQAD DS    AL3 AVTCKPTB             CKPT QCB ADDRESS                13160000
AVTCKELF DS    X .                      FLAG BITS                       13230000
*                        BIT DEFINITIONS                                13300000
AVTNQBCK EQU   X'80'                    NO QBACK SCAN NEEDED   @OS77945 13370000
AVTCMCPN EQU   X'40' .                  CHECKPT REQUESTED BY            13420000
*                                         MCPCLOSE                      13470000
*        EQU   X'20' .                  UNUSED                          13520000
AVTCINCN EQU   X'10' .                  CHECKPT REQUESTED BY            13570000
*                                         INCIDENT OVERFLOW             13620000
AVTCCLCN EQU   X'08' .                  CLOSEDOWN COMPLETION BIT        13670000
AVTCPIPN EQU   X'04' .                  CHECKPT IN PROGRESS             13720000
AVTCRTLN EQU   X'02' .                  CHECKPOINT REQUESTED            13770000
AVTWARMN EQU   X'01' .                  WARM RESTART                    13820000
AVTCONTN EQU   X'FF'-AVTWARMN .         CONTINUATION RESTART            13870000
*                                                                       13920000
AVTCPRCD DS    X .                      CPRCDS=INTEGER                  13970000
AVTCKELV DS    H .                      CPINTVL=TIME INTERVAL           14020000
AVTCKTIM DS    H .                      TIME OF DAY OF INTERRUPT        14070000
         DS    X .                      INDEX TO QCB ADDRESS            14120000
AVTOPERL DS    X .                      OPEN ERROR LOCATOR              14170000
AVTOPXCL DS    2X .                     OPEN MODULE ID HAVING ERROR     14220000
AVTOPERT DS    X .                      TYPE OF OPEN ERROR              14270000
AVTCKBYT DS    X .                      CKPT TIME DELAY STATUS          14320000
*                        BIT DEFINITIONS                                14370000
AVTCKONQ EQU   X'02' .                  BIT ON, ELE ON TIME Q           14420000
*                                                                       14470000
AVTOPETR DS    0X .                     OPEN TRANSLATE BYTE             14520000
AVTHG01  DS    A IEDQHG01               TIME DELAY SUBROUTINE           14570000
AVTBSX   DS    0X 8                     OFFSET TO BINARY SEARCH ADDR    14620000
AVTCKLNK DS    A .                      LINK FIELD ON TIME Q            14670000
AVTDELEM DS    A AVTREADY-8             DUMMY LAST ELEMENT              14720000
AVTDELAD DS    A AVTDELEM  .            ADDR OF DUMMY LAST ELEMENT      14770000
*                                                                       14820000
AVTCRELE DS    0CL8 .                   OPERATOR CONTROL CKPT REQUEST   14870000
*                                        ELEMENT               @Y17XAXF 14920000
AVTCCELE DS    0F                                                       14970000
AVTCCKEY DS    XL1 .                     OP CONTROL KEY FOR CKPT        15020000
*                                                              @Y17XAXF 15070000
AVTCCQCB DS    AL3 .                     ADDR OF CKPT QCB      @Y17XAXF 15120000
AVTCCPRI DS    XL1 .                     PRIORITY              @Y17XAXF 15170000
AVTCCLNK DS    AL3 .                     LINK                  @Y17XAXF 15220000
AVTCLRHI DS    2X .                     WHEN USED WITH NEXT HALFWOD     15270000
*                                         IS A MASK FOR CLEARING        15320000
*                                         LEFT TWO BYTES OF REGISTR     15370000
AVTHFF   DS    XL2 FFFF  .              HALF WORD ALL 'F'               15420000
AVTABEPL DS    0F .                     ABEND PARMETER LIST    @YM07738 15470000
AVTADBUF DS    A .                      BUFFER ADDRESS SET BY           15520000
*                                         MH CONTROL                    15570000
AVT2260L DS    F .                      PT TO 2260 LOCAL APPENDAGE      15620000
AVTSYSER DS    X .                      SYSTEM ERROR FLAG BYTE          15670000
*                        BIT DEFINITIONS                                15720000
AVTCMINN EQU   X'80' .                  NO. CORE Q UNITS LESS THAN      15770000
*                                         SPECIFIED BY MSMIN=PERCENT    15820000
AVTCMINF EQU   X'FF'-AVTCMINN .         NO. CORE Q UNITS MORE THAN      15870000
*                                       SPECIFIED BY MSMIN=PERCENT      15920000
AVTCMAXN EQU   X'40' .                  NO. CORE Q UNITS MORE THAN      15970000
*                                         SPECIFIED BY MSMAX=PERCENT    16020000
AVTCMAXF EQU   X'FF'-AVTCMAXN .         NO. CORE Q UNITS LESS THAN      16070000
*                                         SPECIFIED BY MSMAX=PERCENT    16120000
*                                                                       16170000
AVTMSGS  DS    AL3 IEDQMSGS             LIST OF OPTIONAL VCONS          16220000
*                                                                       16270000
*                       POINTERS TO QCBS                                16320000
*                                                                       16370000
AVTCBQCB DS    A .                      COMMBUF MASTER QCB       S22027 16420000
AVTSUPPT DS    A .                      STARTUP MESSAGE                 16470000
AVTTSOPT DS    A .                      TS INPUT                        16520000
AVTOCQPT DS    A IEDQEU                 OPEN/CLOSE APPLICATION PROG     16570000
*                                                                       16620000
*                       NON-OPTIONAL QCBS                               16670000
*                                                                       16720000
AVTDELYB DS    4A .                     TIME DELAY QCB                  16770000
AVTREFTM DS    H .                      REFERENCE TIME, CURRENT TIME    16820000
*                                         OF DAY + OR - 6 HOURS         16870000
AVTINOUT DS    H .                      DUMMY INEND/OUTEND PARM LIST    16920000
AVTIMQPS DS    2A .                     SVC 102 PARM, POST TIME QCB     16970000
*                                         TO ITSELF AT TIME INTERRUPT   17020000
AVTTIMQ  DS    A .                      TIME DELAY QUEUE                17070000
AVTBFREB DS    F                        AVAILABLE BUFFER QCB   @OY19124 17120082
AVTBFRFG DS    XL1                      BUFFER POOL FLAG       @OY19124 17128082
AVTBFRTN EQU   X'80'                    RETURN BUFFERS BOTTOM  @OY19124 17136082
AVTSELCH DS    AL3                      BUFFER POOL BOTTOM     @OY19124 17144082
         DS    F                                               @OY19124 17152082
AVTBFRTB DS    3F .                     BUFFER RETURN                   17170000
AVTCKPQB DS    0CL12 .                  CKECKPOINT QCB         @Y17XAXF 17220000
AVTCKPTB DS    0F .                      QUEUE OF ELEMENTS FOR CKPT     17270000
*                                                              @Y17XAXF 17320000
AVTCKPVT DS    XL1 .                      VTO FOR ATTACHED TASK         17370000
*                                                              @Y17XAXF 17420000
AVTCKPCH DS    AL3 .                      CHAIN OF ELEMENTS    @Y17XAXF 17470000
AVTCKPEC DS    0F                        EVENT CONTROL BLOCK   @Y17XAXF 17520000
AVTCKPCC DS    XL1 .                      COMPLETION CODE BYTE @Y17XAXF 17570000
AVTCKPWA EQU   X'80' .                     WAITING FOR COMPLETION OF    17620000
*                                          THE EVENT           @Y17XAXF 17670000
AVTCKPPO EQU   X'40' .                     EVENT HAS COMPLETED @Y17XAXF 17720000
*        EQU   X'20'-X'01' .               RESERVED            @Y17XAXF 17770000
         DS    AL3 .                      RESERVED             @Y17XAXF 17820000
AVTCKPTS DS    CL1 .                     TEST AND SET FOR CKPT @Y17XAXF 17870000
         DS    AL3 .                     STCB ADDRESS          @Y17XAXF 17920000
AVTOPCQB DS    0CL12 .                  OPERATOR CONTROL QCB   @Y17XAXF 17970000
AVTOPCOB DS    0F .                      QUEUE OF ELEMENTS FOR OPCTL    18020000
*                                                              @Y17XAXF 18070000
AVTOPCVT DS    XL1 .                      VTO FOR ATTACHED TASK         18120000
*                                                              @Y17XAXF 18170000
AVTOPCCH DS    AL3 .                      CHAIN OF ELEMENTS    @Y17XAXF 18220000
AVTOPCEC DS    0F .                      EVENT CONTROL BLOCK   @Y17XAXF 18270000
AVTOPCCC DS    XL1 .                       COMPLETION CODE BYTE         18320000
*                                                              @Y17XAXF 18370000
AVTOPCWA EQU   X'80' .                     WAITING FOR COMPLETION OF    18420000
*                                          THE EVENT           @Y17XAXF 18470000
AVTOPCPO EQU   X'40' .                     EVENT HAS COMPLETED @Y17XAXF 18520000
         DS    CL3 .                       RESERVED            @Y17XAXF 18570000
         DS    A                         STCB ADDRESS          @Y17XAXF 18620000
AVTOLTQB DS    0A .                     ON LINE TEST QCB       @Y17XAXF 18670000
AVTOLTVT DS    XL1 .                    VTO FOR ATTACHED TASK  @Y17XAXF 18720000
AVTOLTCH DS    AL3 .                    CHAIN OF ELEMENTS      @Y17XAXF 18770000
AVTOLTEB DS    F .                      QCB                    @Y17XAXF 18820000
         DS    A .                      STCB ADDRESS           @Y17XAXF 18870000
AVTACTIB DS    3F .                     ACTIVATE                        18920000
AVTCLOSB DS    3F .                     CLOSEDOWN COMPLETION            18970000
AVTCPRMB DS    3F .                     REMOVES ELE FROM TIME DELAY Q   19020000
AVTDSIOB DS    3F .                     DISK I/O QCB                    19070000
AVTCPBCB DS    3F .                     CPB CLEANUP QCB                 19120000
AVTCOREC DS    A .                      BUFFERS POOL FOR CLOSE          19170000
AVTCADDR DS    F .                      CORE QUEUE COUNT                19220000
AVTFZERO DS    F .                      FULLWORD OF ZEROES              19270000
*                                                                       19320000
*                       FE COMMON WRITE INTERFACE AREA                  19370000
*                                                                       19420000
AVTCAREA DS    A IEDQFE                 PATCH MODULE                    19470000
AVTCWPM1 DS    F .                      FIRST PARAMETER POINTER         19520000
AVTCWEC1 DS    F .                      FIRST ECB                       19570000
AVTCWFL1 DS    X .                      FIRST FLAG BYTE                 19620000
*                                                                       19670000
*                       AVTCWFL1 BIT DEFINITIONS                        19720000
AVTCOMWN EQU   X'80' .                  COMWRTE=YES                     19770000
*                                       REMAINING BITS UNDEFINED        19820000
*                                                                       19870000
AVTCWFL2 DS    X .                      ADDITIONAL FLAG BYTES           19920000
*                                                                       19970000
*                       AVTCWFL2 BIT DEFINITIONS                        20020000
AVTCWACT EQU   X'80' .                  COMMON WRITE IS ACTIVE          20070000
*        EQU   X'7C' .                  RESERVED BY COMWRITE            20120000
AVTCWRAP EQU   X'02' .                  '0'-WRAPPING OUTPUT ALLOWED     20170000
*                                         (REUSE SAME VOLUME)           20220000
*                                       '1'-WRAP NOT ALLOWED (INVOKE    20270000
*                                         VOL SWITCHING-REQUIRES        20320000
*                                         MANUAL INTERVENTION)          20370000
AVTCWCLD EQU   X'01' .                  '1'-COMWRITE CLOSEDOWN          20420000
*                                         REQUESTED BY USER IN          20470000
*                                         PARMLIST OR TCAM CLOSEDOWN.   20520000
*                                         SET BY COMWRITE               20570000
*                                                                       20620000
AVTCWTS1 DS    X .                      COMWRITE ECB1 AVAIL    @Y17XAXU 20670000
AVTCWTS2 DS    X .                      COMWRITE ECB2 AVAIL    @Y17XAXU 20720000
AVTCWPM2 DS    F .                      SECOND PARAMETER POINTER        20770000
AVTCWEC2 DS    F .                      SECOND ECB                      20820000
AVTAFE10 DS    A .                      ENTRY POINT OF IEDQFE10         20870000
AVTAFE20 DS    A .                      ENTRY POINT OF IEDQFE20         20920000
AVTAFE30 DS    A .                      ENTRY POINT OF IEDQFE30         20970000
AVTSUBT  DS    XL1 .                    SUBT OPTIONS FLAG      @Y17XAXU 21020000
AVTSUBON EQU   X'80' .                  SUBTASK TRACE ON       @Y17XAXU 21070000
AVTSUBPT EQU   X'40' .                  SUBTASK POST TRACE ON  @Y17XAXU 21120000
AVTIOTR  DS    XL1 .                    IOTR OPTIONS FLAG      @Y17XAXU 21170000
AVTIOTRE EQU   X'80' .                  I/O TRACE ON           @Y17XAXU 21220000
AVTIOTRH EQU   X'40' .                  I/O POST TRACE ON      @Y17XAXU 21270000
         DS    XL2 .                    RESERVED               @Y17XAXU 21320000
AVTDTRAP DS    A .                      SERVICE AID ENTRY ADDR @Y17XAXU 21370000
AVTCWINT DS    13F                      SERVICE COMMUNICATION  @Y17XAXU 21420000
*                                         AREA                  SA64772 21470000
AVTCWTOT DS    F                        TOTE COMMUNICATION AREA SA64772 21520000
*                                                                       21570000
*        GETMAIN EC,MF=L                GETMAIN PARAMETER LIST          21620000
AVTGETMN GETMAIN EC,MF=L                                                21670000
AVTHA2   DS    H 2  .                   CONSTANT                        21720000
AVTHA3   DS    H 3  .                   CONSTANT                        21770000
AVTHA4   DS    H 4  .                   CONSTANT                        21820000
AVTHA7   DS    H 7  .                   CONSTANT                        21870000
AVTHA16  DS    H 16  .                  CONSTANT                        21920000
AVTKEYLE DS    H .                      KEYLEN ON MSG QUEUES            21970000
AVTLNCNT DS    H .                      NUMBER OF LINES OPENED          22020000
*                                         SET BY OPEN                   22070000
*                                         CHECKED BY SYSTEM DELAY       22120000
AVTOPCNT DS    H .                      NUMBER OF LINES GRABBED BY      22170000
*                                         OPERATOR CONTROL.             22220000
*                                         SET BY DELAY SUBTASK          22270000
AVTOPCON DS    H .                      TERMNAME TABLE OFFSET TO        22320000
*                                         PRIMARY OPERATOR CONTROL      22370000
*                                         CONSOLE.  SET BY OPEN         22420000
*                                         FROM PRIMARY=TERMNAME IN      22470000
*                                         INTRO MACRO                   22520000
AVTAVFCT DS    H .                      SET BY OPEN TO NUMBER OF        22570000
*                                         BUFFERS IN POOL               22620000
AVTSMCNT DS    H .                      NUMBER OF LINES SERVICED BY     22670000
*                                         STARTUP MESSAGE SUBTASK       22720000
AVTINTLV DS    H .                      NUMBER OF SECONDS OF SYSTEM     22770000
*                                         DELAY                         22820000
*                                           SET BY OPERATOR CONTROL     22870000
*                                             OR BY INTRO INTVAL=INT    22920000
*                                           CHECKED BY DELAY SUBTASK    22970000
AVTDLQX  DS    H .                      OFFSET INTO TNT OF DEAD         23020000
*                                         LETTER QUEUE                  23070000
AVTDUMBR DS    H BR 11                  DUMMY LINE TRACE TABLE UPDATE   23120000
AVTBIT1  DS    X .                      FLAG BITS                       23170000
*                                                                       23220000
*                       BIT1 DEFINITIONS                                23270000
*                                                                       23320000
AVTAPLKN EQU   X'80' .                  PREVENT DISK END APPENDAGE      23370000
*                                         FROM ADDING A CPB TO DIS-     23420000
*                                         ABLED DISK END Q FOR CPB      23470000
*                                         CLEANUP (AVTDKAPQ)            23520000
AVTAPLKF EQU   X'7F' .                  PERMITS ABOVE ACTION            23570000
AVTTSON  EQU   X'40' .                  ENVIRON=TSO (OR MIXED)          23620000
AVTAQTAN EQU   X'20' .                  ENVIRON=TCAM (OR MIXED)         23670000
AVTDLAYN EQU   X'10' .                  SYSTEM DELAY IS IN EFFECT       23720000
*                                         SET BY OPERATOR CONTROL       23770000
AVTDLAYF EQU   X'EF' .                  SYSTEM DELAY NOT IN EFFECT      23820000
*                                         TURNED OFF BY DELAY SUBT      23870000
AVTREADN EQU   X'08' .                  READY MACRO HAS BEEN            23920000
*                                         EXECUTED                      23970000
*                                         SET BY READY MACRO            24020000
*                                         CHECKED BY OPEN               24070000
AVTCLOSN EQU   X'04' .                  CLOSEDOWN INDICATOR             24120000
*                                         '0'-CLOSEDOWN NOT REQUEST     24170000
*                                         '1'-CLOSEDOWN REQUESTED       24220000
AVTQUCKN EQU   X'02' .                  TYPE OF CLOSEDOWN               24270000
*                                         '0'-FLUSH                     24320000
*                                         '1'-QUICK                     24370000
AVTDISKN EQU   X'01' .                  DISK=YES                        24420000
*                                                                       24470000
AVTBIT2  DS    X .                      FLAG BITS                       24520000
*                                                                       24570000
*                       BIT2 DEFINITIONS                                24620000
*                                                                       24670000
AVTEXTSC EQU   X'80' .                  EXTENDED RESTART        SA51078 24720000
AVTREUSN EQU   X'40' .                  REUS IS RUNNING                 24770000
*                                         SET BY REUS                   24820000
*                                         CHECKED BY CPB CLEANUP        24870000
AVTREUSF EQU   X'BF' .                    TURNED OFF BY REUS            26460000
AVTCOPYN EQU   X'20' .                  COPY WANTS CONTROL              26530000
AVTTOPOL EQU   X'10' .                  TOPMSG=YES/NO                   26600000
*                                         ON,(NO) SUPPRESS TIME         26670000
*                                           OUT POLL MSGS               26740000
*                                         OFF,(YES) DISPLAY MSGS        26810000
AVTSTRTN EQU   X'08' .                  RESTART HAS BEGUN               26880000
AVTSTRTF EQU   X'F7' .                  COLDSTART (OR RESTART NOT       26950000
*                                        YET BEGUN)                     27020000
AVTOPEIN EQU   X'04' .                  INITIAL LOAD DONE INDICATOR     27090000
*              X'02'                    LINETYP=STSP                    27160000
*              X'01'                    LINETYP=BISC                    27230000
*              X'03'                    LINETYP=MINI                    27300000
*              X'00'                    LINETYP=BOTH                    27370000
AVTBIT3  DS    X .                      FLAG BITS                       27440000
*                       AVTBIT3 BIT DEFINITIONS                         27510000
AVTSTAN  EQU   X'01' .                  S=C OR S=W SPECIFIED            27580000
AVTSTACN EQU   X'02' .                  S=C COLDSTART                   27650000
AVTSTAWN EQU   X'FD' .                  S=W WARMSTART                   27720000
AVTSTAIN EQU   X'04' .                  S=I INVITAION LISTS             27790000
AVTSTAYN EQU   X'08' .                  S=Y NO CONTINUATION             27860000
AVTOLTBN EQU   X'10' .                  MAX LOAD OF OLT REACHED         27930000
AVTTSAB  EQU   X'20' .                  TSO HAS ABENDED.SET BY TIME     28000000
*                                         SHARING ABEND MODULE. RESET   28070000
*                                         BY START TIME SHARING. CKED   28140000
*                                         BY TSINPUT & TSOUTPUT         28210000
AVTRFULN EQU   X'40' .                  REUS DISK ZONE FULL             28280000
*                                         SET BY REUS                   28350000
AVTRFULF EQU   X'BF' .                  REUS DISK READY TO RECEIVE      28420000
*                                         TURNED OFF BY REUS            28490000
*                                         CHECKED BY REC. SCHEDULER     28560000
*                                           AND LINE END APPEN          28630000
AVTRECVN EQU   X'80' .                  CORE QUEUE FULL                 28700000
*                                         SET BY DESTINATION SCHEDULER  28770000
AVTRECVF EQU   X'7F' .                    TURNED OFF BY DISK I/O        28840000
*                                         CHECKED BY RECEIVE SCHEDULER  28910000
*                                           AND LINE END APPENDAGE      28980000
*                                                                       29050000
AVTCKRST DS    X .                      RESTART=INTEGER                 29120000
AVTDSKCT DS    H .                      NUMBER OF BUFFERS ON CPBS       29190000
AVTOPTN  DS    V(IEDOPTN) .             OPTION SEARCH RTN      @Y17XAXU 29260000
AVTSTEAL DS    V(IEDQGA02) .            BUFFER STEAL RTN       @Y17XAXU 29330000
AVTDDFT  DS    V(IEDQTL) .              DEVICE DEP FLD         @Y17XAXU 29400000
*                                       LOOKUP RTN             @Y17XAXU 29470000
AVTOPMSK DS    A .                      ADDRESS OF OPERATOR    @Y17XAXU 29540000
*                                       CONTROL MASK TABLE     @Y17XAXU 29610000
AVTDCTLN DS    H .                      LENGTH OF DCT MASK FLD @Y17XAXU 29680000
AVTOPCIN DS    H .                      TTCIN OF PRIMARY       @Y17XAXU 29750000
*                                       TERMINAL               @Y17XAXU 29820000
*                  END OF BASIC AVT WHEN ENVIRON=TSO                    29890000
*                                                                       29960000
AVTHM02  DS    A IEDQHM02               DESTINATION ASSIGNMENT          30030000
AVTCMIN  DS    A .                      MSMIN=INTEGER                   30100000
AVTCMAX  DS    A .                      MSMAX=INTEGER                   30170000
AVTTOTNC DS    F .                      NUMBER OF RECORDS IN ENTIRE     30240000
*                                         DATA SET (MSUNITS=INTEGER)    30310000
AVTNCPBQ DS    2A .                     Q OF BUFFERS AND ERBS           30380000
*                                         WAITING TO BE PROCESSED       30450000
*                                                                       30520000
*                  END OF CORE QUEUE AVT WHEN DISK=NO                   30590000
*                                                                       30660000
AVTFL    DS    A .                      DISK EXCP DRIVER                30730000
AVTIA    DS    A .                      REUS                            30800000
AVTCOPY  DS    A .                      COPY SUBTASK QCB POINTER        30870000
AVTDKAPQ DS    2A .                     Q OF CPBS TO BE PROCESSED       30940000
*                                         BY CPB CLEANUP (DISABLED)     31010000
AVTDKENQ DS    2A .                     SAVE AS ABOVE BUT ENABLED       31080000
AVTNOBFQ DS    2A .                     Q OF CPBS WITHOUT BUFFERS.      31150000
*                                         USED BY CPB CLEANUP           31220000
AVTBIT4  DS    XL1 .                    FLAGBITS                SA51078 31290000
*                       AVTBIT4 BIT DEFINITIONS                 SA51078 31360000
AVTRUFTN EQU   X'80' .                  REUS ACTIVE AT CHECKPT  SA51078 31430000
         DS    AL3 .                    RESERVED                SA51078 31500000
         DS    AL4 .                    RESERVED                SA51078 31570000
AVTINCPQ DS    2A .                     Q OF CPBS REQUESTING I/O        31640000
*                                         TO BE DONE BY EXCP DRIVER     31710000
AVTFCPB  DS    A .                      Q OF INACTIVE CPBS, CALLED      31780000
*                                         THE CPB FREEPOOL              31850000
AVTCPBPT DS    A .                      ADDRESS OF CPB FREEPOOL TO      31920000
*                                         BE FREEMAINED BY DISK CLOSE   31990000
AVTIOBR  DS    A .                      ADDRESS OF LIST OF IOBS,        32060000
*                                         ONE FOR EACH EXTENT OF        32130000
*                                         THE REUSABLE DISK QUEUE       32200000
AVTIOBN  DS    A .                      SAME AS ABOVE, BUT FOR THE      32270000
*                                         NON-REUSABLE DISK QUEUE       32340000
AVTLODPT DS    F .                      RADDR WHEN REUS ACTIVATED       32410000
*                       REUSABLE DISK DEFINITION                        32480000
AVTADEBR DS    A .                      ADDRESS OF DEB                  32550000
AVTNOVOR DS    F .                      NUMBER OF EXTENTS               32620000
AVTRCTRR DS    F .                      NUMBER OF RECORDS/TRACK         32690000
AVTTRCYR DS    F .                      NUMBER OR TRACKS/CYLINDER       32760000
AVTTOTNR DS    F .                      NUMBER OF RECORDS IN ENTIRE     32830000
*                                         DATA SET                      32900000
AVTVOLRR DS    F .                      PRODUCT OF NUMBER OF            32970000
*                                         EXTENTS TIMES NUMBER OF       33040000
*                                         RECORDS/TRACK                 33110000
*                       NONREUSABLE DISK DEFINITION                     33180000
AVTADEBN DS    A .                      ADDRESS OF DEB                  33250000
AVTNOVON DS    F .                      NUMBER OF EXTENTS               33320000
AVTRCTRN DS    F .                      NUMBER OF RECORDS/TRACK         33390000
AVTTRCYN DS    F .                      NUMBER OF TRACKS/CYLINDER       33460000
AVTTOTNN DS    F .                      NUMBER OF RECORDS IN ENTIRE     33530000
*                                         DATA SET                      33600000
AVTVOLRN DS    F .                      PRODUCT OF NUMBER OF            33670000
*                                         EXTENTS TIMES NUMBER OF       33740000
*                                         RECORDS/TRACK                 33810000
AVTHRESN DS    F .                      THE ABSOLUTE RECORD NUMBER      33880000
*                                         WHICH IS THE THRESHOLD TO     33950000
*                                         CAUSE CLOSEDOWN DUE TO        34020000
*                                         THE FILLING OF THE            34090000
*                                         NON-REUSABLE DISK QUEUE       34160000
AVTNADDR DS    F .                      NON-REUSABLE DISK QUEUE         34230000
AVTRADDR DS    F .                      REUSABLE DISK QUEUE             34300000
AVTHRESE DS    0F .                     NON-REUSABLE THRESHOLD          34370000
*                                         CLOSEDOWN ELEMENT, 3 WORDS    34440000
         DS    F .                      ADDR OF OPERATOR CONTROL QCB    34510000
         DS    X .                      PRIORITY (VALUE IS PRIOPCTL     34580000
*                                         PLUS 4)                       34650000
         DS    AL3 .                    LINK FIELD                      34720000
         DS    X .                      X'11' - FLUSH CLOSE REQUESTED   34790000
         DS    X .                      X'0C' - LENGTH OF ELEMENT       34860000
         DS    X .                      UNUSED - (REL.LINE NO.)         34930000
AVTHRESS DS    X .                      COMPLETION CODE, USED AS STATUS 35000000
*                                         X'FF' - UNUSED ELEMENT        35070000
*                                         X'F0' - ELE HAS BEEN POSTED   35140000
*                                         X'00' OR X'04' CLOSED DOWN    35210000
AVTCPBNO DS    H .                      CPB=INTEGER                     35280000
*                                                                       35350000
*                       TCAM SYSTEM EQUATES                             35420000
*                                                                       35490000
AVTCVTPT EQU   240 .                    OFFSET INTO CVT OF ADDRESS      35520000
*                                         OF TCX                        35630000
AVTUMALN EQU   12 .                     LENGTH OF CCW-TIC (UNIT         35700000
*                                         MANAGEMENT AREA)              35770000
AVTDATLN EQU   6 .                      NO. OF BYTES IN DATA FIELD      35840000
*                                         OF MESSAGE Q RECORD           35910000
AVTMINKY EQU   36                       MINIMUM KEYLENGTH      @Z30X8XE 35980000
AVTMIN05 EQU   44                       MIN KEY FOR 3705 ENVIR @YM06968 36010000
AVTHDRSZ EQU   30 .                     SIZE OF HEADER PREFIX           36050000
AVTTXTSZ EQU   23 .                     SIZE OF TEXT PREFIX             36120000
AVTTSOSZ EQU   9 .                      SIZE OF TSO PREFIX              36190000
AVTSVSIZ EQU   72 .                     NO. BYTES IN A SAVEAREA         36260000
AVTECD4  EQU   4 .                      RETURN CODE OF 4                36330000
AVTECD8  EQU   8 .                      RETURN CODE OF 8                36400000
AVTECD12 EQU   12 .                     RETURN CODE OF 12               36470000
AVTECD16 EQU   16 .                     RETURN CODE OF 16               36540000
AVTECD20 EQU   20 .                     RETURN CODE OF 20               36610000
AVTERACE EQU   24 .                     SIZE OF TRACE TABLE ENTRY       36680000
AVTE80   EQU   X'80' .                  SIGN BIT MASK                   36750000
AVTMODBT EQU   X'80' .                  2 TO THE 23RD BIT MASK          36820000
AVTEZERO EQU   X'00' .                  EQUATED ZERO                    36890000
AVTEBLNK EQU   C' ' .                   EQUATED BLANK CHARACTER         36960000
AVTEPER  EQU   C'.' .                   EQUATED PERIOD                  37030000
AVTEFF   EQU   X'FF' .                  ALL ONES                        37100000
* BIT DEFINITIONS OF THE HIGH ORDER BYTE OF TCAM WORD IN CVT            37170000
AVTCVT80 EQU   X'80' .                  TCAM OPEN COMPLETED             37240000
AVTCVT40 EQU   X'40' .                  2260 LOCAL SUPPORT              37310000
AVTCVT08 EQU   X'08' .                  MCP IS FETCH PROTECTED          37380000
*                       OFFSETS FOR MP65 SUPPORT                        37450000
AVTCVTMP EQU   X'C0' .                  OFFSET INTO CVT OF ADDRESS      37520000
*                                         OF MULTIPROCESSOR CVT         37590000
AVTMPTRR EQU   X'0C' .                  OFFSET INTO MP CVT OF           37660000
*                                         TASK REMOVAL ROUTINE          37730000
AVTCPUST EQU   X'2AF' .                 ABSOLUTE LOCATION LOW CORE      37800000
*                                         OF CPUSTAT BYTE               37870000
         SPACE 2                                                        37940000
         AIF   ('&SAVT' NE 'YES').SAVTEND                        S22024 38010000
IEDNSVTD DSECT                                                   S22024 38080000
SAVTDIAF DS    0XL1 .                   FLAGS                    Y05331 38150000
SAVTVIRT EQU   X'80' .                  VM ENVIRONMENT INDICATOR Y05331 38220000
SAVTPRMT EQU   X'40' .                 VM PROMPT INDICATOR       Y05331 38290000
SAVTRESV EQU   X'3F'  .                 ALL OTHER BITS RESERVED  Y05331 38360000
SAVTDIAG DS    A .                      VIRTUAL DIAGNOSE ROUTINE Y05331 38430000
SAVTVM   EQU   *                        END OF VM ENVIRON INPUT  X03039 38500000
SAVTPOOL DS    A .                      PLCB POOL ADDRESS        X03039 38570000
SAVTPLCB DS    A .                      NEXT FREE PLCB           X03039 38640000
SAVTPUSE DS    H .                      PLCB IN-USE COUNT      @Y17XAXU 38710000
SAVTPH20 DS    H .                      PLCB HI-WATER COUNT    @Y17XAXU 38780000
SAVTPREQ DS    V(IEDIAP01) .            ADDRESS OF PLCB        @Y17XAXU 38850000
*                                       ALLOCATION RTN         @Y17XAXU 38920000
SAVTPRTQ DS    A .                      ANCHOR FOR PLCB        @Y17XAXU 38990000
*                                       REQUEST WAIT CHAIN     @Y17XAXU 39060000
SAVTPWT  DS    H .                      PLCB WAIT COUNT        @Y17XAXU 39130000
SAVTWH20 DS    H .                      PLCB HI-WATER WAIT CT  @Y17XAXU 39200000
         DS    V(IEDIAP7S) .            ADDRESS OF STCB FOR    @Y17XAXU 39205000
*                                       PLCB DEALLOCATION      @Y17XAXU 39340000
SAVTPRTN DS    V(IEDIAP07) .            BRANCH ENTRY ADDRESS   @Y17XAXU 39410000
*                                       OF PLCB DEALLOCATION   @Y17XAXU 39480000
*                                       RTN                    @Y17XAXU 39550000
SAVTSIB  DS    A .                      NEXT FREE SIB ADDRESS  @Y17XAXU 39620000
SAVTSUSE DS    H .                      SIB IN-USE COUNT       @Y17XAXU 39690000
SAVTFAIL DS    H .                      COUNT OF SIB REQUESTS  @Y17XAXU 39760000
*                                       THAT FAILED            @Y17XAXU 39830000
SAVTSREQ DS    V(IEDIAP02) .            ADDRESS OF SIB ALLOCA- @Y17XAXU 39900000
*                                       TION RTN               @Y17XAXU 39970000
SAVTSRTN DS    V(IEDIAP08) .            ADDRESS OF SIB DEALLO- @Y17XAXU 40040000
*                                       CATION RTN             @Y17XAXU 40110000
SAVTFLDH DS    A .                      3705 FIRST LEVEL DATA  @Y17XAXU 40180000
*                                       HANDLER                @Y17XAXU 40250000
SAVTCNIR DS    V(IEDNKA) .              CONTROL NIR GENR QCB   @Y17XAXU 40320000
*                                       ADDRESS                @Y17XAXU 40390000
SAVTDNIR DS    V(IEDNGD) .              DATA NIR GENR QCB ADDR @Y17XAXU 40460000
SAVTRNTA DS    A .                      3705 TRACE RTN ADDRESS @Y17XAXU 40530000
SAVTPIUT DS    A .                      ADDRESS OF PIU TRACE   @Y17XAXU 40600000
*                                       TABLE                  @Y17XAXU 40670000
SAVTCLUP DS    A .                      3705 CLEANUP RTN       @Y17XAXU 40740000
*                                       ADDRESS                @Y17XAXU 40810000
SAVTNAT  DS    A .                      NAT ADDRESS            @Y17XAXU 40880000
SAVTSAT  DS    A .                      SAT ADDRESS            @Y17XAXU 40950000
         DS    F .                      RESERVED               @Y17XAXF 41020000
SAVTLUSQ DS    0F .                     LUS QCB                @Y17XAXU 41160000
SAVTLUSB DS    A .                      BUFFER WAIT CHAIN      @Y17XAXU 41230000
SAVTLUSP DS    A .                      PLCB WAIT CHAIN        @Y17XAXU 41300000
         DS    V(IEDLUS) .              STCB POINTER           @Y17XAXU 41370000
SAVTLUSR DS    A .                      OP-SERV-REQ CHAIN      @Y17XAXU 41440000
SAVTSLCB DS    A .                      SSCP LCB               @Y17XAXU 41510000
SAVTSCPQ DS    A .                      SSCP OUTBOUND QCB      @Y17XAXU 41580000
SAVTSSSR DS    A .                      SERIALIZER CHAIN       @Y17XAXU 41650000
         DS    V(IEDSCPSS) .            STCB POINTER           @Y17XAXU 41720000
SAVTXFMO DS    V(IEDXFMO) .             OUTBOUND XFORMER QCB   @YM03681 41720100
*                                       ADDRESS                @YM03681 41720200
         DS    2F .                     RESERVED               @YM03681 41720300
SAVTXFMI DS    V(IEDXFMI) .             INBOUND XFORMER        @YM03681 41720700
*                                       ENTRY ADDRESS          @YM03681 41820700
         DS    2F .                     RESERVED               @YM03681 41920700
SAVTIPCQ DS    V(IEDPCIN) .             PC INBOUND QCB ADDRESS @YM03681 42020700
         DS    3F .                     RESERVED               @Y17XAXF 42120700
SAVTMVBF DS    V(IEDMVBFR) .            MOVE BFR DATA RTN      @Y17XAXU 42490000
SAVTXTRQ DS    V(IEDXTREQ) .            CROSS TASK REQ HDLR    @Y17XAXU 42560000
SAVTSCLU DS    V(IEDSCLU) .             SC ENTRY ADDR          @Y17XAXU 42630000
SAVTSSRQ DS    V(IEDSCPRQ) .            SSCP REQ HDLR ADDR     @Y17XAXU 42700000
SAVTSSRP DS    V(IEDSCPRP) .            SSCP RESP HDLR ADDR    @Y17XAXU 42770000
SAVTCSCI DS    V(IEDCSCIN) .            FID1 COM SC INBOUND    @Y17XAXU 42840000
SAVTSAI  DS    V(IEDSAI) .              FID0 SA INBOUND        @Y17XAXU 42910000
SAVTSAC  DS    V(IEDSAC) .              COMMAND PROCESSOR      @Y17XAXU 42980000
SAVTSARI DS    V(IEDSARI) .             COMMAND PROCESSOR      @Y17XAXU 43050000
SAVTSAO  DS    V(IEDSAO) .              COMMAND ID PROC        @Y17XAXU 43120000
SAVTDFCO DS    V(IEDDFOUT) .            DFC OUTBOUNT           @Y17XAXU 43190000
SAVTRQIN DS    V(IEDRQIN) .             INBOUND REQ PROCESSOR  @Y17XAXU 43260000
SAVTQRS  DS    V(IEDQRS) .              RESPONSE GENERATOR     @Y17XAXU 43330000
*                                       ADDRESS                @Y17XAXU 43400000
SAVTSSMH DS    A . IEDSCPMH             SSCP MH ENTRY ADDRESS  @Y17XAXU 43402000
SAVTMHTB DS    A . IEDMHTB              MH TABLE ADDRESS       @Y17XAXU 43404000
SAVTNATL DS    H .                      INDEX OF LAST NAT ENTR @Y17XAXU 43610000
SAVTNADL DS    H .                      CONSTANT TO CALCULATE NAT       43680000
*                                       ENTRY FROM MH INDEX    @Y17XAXU 43750000
SAVTSPLN DS    A .                      3705 STOPLINE RTN      @Y17XAXU 43760000
*                                       ADDRESS                @Y17XAXU 43890000
SAVTMAND DS    A .                      ADDRESS OF MANUAL DIAL @Y17XAXU 43960000
*                                       RTN                    @Y17XAXU 44030000
SAVTRQCH DS    A .                      APPL REQUEST QUEUE     @Y17XAXU 44100000
SAVTRQTG DS    H .                      APPL REQUEST TAG       @Y17XAXU 44170000
SAVTTCPU DS    0H .                     TCAM PU TTCIN          @Y17XAXU 44240000
SAVTSCPT DS    H .                      SSCP TTCIN             @Y17XAXU 44310000
SAVTBSM  DS    A .                      BSM ADDRESS            @Y17XAXU 44380000
SAVTSIBC DS    H .                      SIB COUNT              @Y17XAXU 44450000
SAVTSUBA DS    XL1 .                    MAX SUBAREA VALUE      @Y17XAXU 44520000
SAVTSUBV DS    XL1 .                    HOST SUBAREA VALUE     @Y17XAXU 44590000
SAVTNAX  DS    V(IEDIAP03) .            NETWORK ADDR TO TTCIN  @Y17XAXU 44660000
*                                       CONVERSION RTN ADDR    @Y17XAXU 44730000
SAVTTNTX DS    V(IEDIAP04) .            TTCIN TO NETWORK ADDR  @Y17XAXU 44800000
*                                       CONVERSION RTN ADDR    @Y17XAXU 44870000
SAVTRNMP DS    V(IEDIAP05) .            INDEX TO TTE/MH ENTRY  @Y17XAXU 44940000
*                                       CONVERSION RTN ADDR    @Y17XAXU 45010000
SAVTLCBS DS    V(IEDIAP06) .            SA LCB FETCH ROUTINE   @Y17XAXU 45080000
SAVTSH20 DS    H .                      SIB POOL UTIL. HI-WATER         45150000
*                                       COUNT                  @Y17XAXU 45220000
SAVTNAT1 DS    H .                      TNTINDEX OF FIRST      @Y17XAXU 45290000
*                                       NAT ENTRY              @Y17XAXU 45360000
SAVTMHDX DS    H .                      TTCIN OF FIRST MH      @Y17XAXU 45430000
*                                       ENTRY                  @Y17XAXU 45500000
SAVTZELM DS    0H .                     NETWORK ADDRESS        @Y17XAXU 45570000
*                                       SUBAREA MASK           @Y17XAXU 45640000
SAVTSUBM DS    XL1 .                    SUBAREA MASK           @Y17XAXU 45710000
         DS    XL1 .                    BYTE OF ZERO           @Y17XAXU 45780000
SAVTSUBL DS    XL1 ..                   SUBAREA VALUE  LENGTH  @Y17XAXU 45810000
         DS    XL1 ..                   RESERVED               @YM02919 45850000
SAVTPLSZ DS    H .                      PLCB,SAT,SIB,RVT, AND  @YM02919 45856000
*                                       NAT POOL SIZE          @YM02919 45862000
SAVTDVAS DS    V(IEDDVAS) .             DEV ASSOC. ROUTINE     @Y17XAXU 45868000
SAVTNID  DS    A . IEDNID               BSC ID VER ROUTINE     @Y17XAXU 45874000
SAVTRDRV DS    0F .                     A/D REDRIVE ELEMENT    @YM03697 45880000
SAVTRDKY DS    XL1 .                    KEY FIELD              @YM03697 45886000
SAVTRDQB DS    AL3 . AVTOPCOB           QCB ADDRESS FIELD      @YM03697 45892000
SAVTRDPY DS    XL1 .                    PRIORITY FIELD         @YM03697 45898000
         DS    XL7 .                    RESERVED               @YM03697 45904000
SAVTRDFG DS    XL1 .                    FLAG FIELD             @YM03697 45910000
         DS    CL3                      RESERVED               @Y17XAXF 45920000
SAVTCKQB DS    0CL12                    3705 CHECKPOINT QCB    @Y17XAXF 45924000
SAVTCKTB DS    0F                        QUEUE OF ELEMENTS FOR CKPT     45928000
*                                                              @Y17XAXF 45932000
SAVTCKVT DS    XL1 .                      VTO FOR ATTACHED TASK         45936000
*                                                              @Y17XAXF 45940000
SAVTCKCH DS    AL3 .                      CHAIN OF ELEMENTS    @Y17XAXF 45944000
SAVTCKEC DS    0F .                      EVENT CONTROL BLOCK   @Y17XAXF 45948000
SAVTCKCC DS    XL1 .                      COMPLETION CODE BYTE @Y17XAXF 45952000
SAVTCKWA EQU   X'80' .                     WAITING FOR COMPLETION OF    45956000
*                                          THE EVENT           @Y17XAXF 45960000
SAVTCKPO EQU   X'40' .                     EVENT HAS COMPLETED @Y17XAXF 45964000
*        EQU   X'20'-X'01' .               RESERVED            @Y17XAXF 45968000
         DS    AL3 .                      RESERVED             @Y17XAXF 45972000
         DS    A                         STCB ADDRESS          @Y17XAXF 45976000
SAVTBITN DS    A IEDBITN                 BIND IMAGE TABLE ADDR @Y17XAXF 45980000
SAVTLLCB DS    A                        POINTER TO LAST PLCB   @OY19488 45982082
SAVTVMSZ EQU   SAVTVM-IEDNSVTD          LENGTH OF VM ONLY      @Y17XAXU 45984000
SAVTSIZE EQU   *-IEDNSVTD               SAVT LENGTH            @Y17XAXU 45990000
         SPACE 2                                                 S22024 46060000
.SAVTEND ANOP                                                    S22024 46130000
         MEND  , */                                                     46200000
*%BSLAVT  :  ;                                                          46270000
*DECLARE                                                                46340000
*  1 IEDQAVTD BDY(DWORD) BASED(IEDQAPTR),                               46410000
*%IF C='2' %THEN                                                        46480000
*   %GOTO D2;                                                           46550000
*%IF C='3' %THEN                                                        46620000
*   %GOTO D3;                                                           46690000
*%IF C='4' %THEN                                                        46760000
*   %GOTO D4;                                                           46830000
*   2 AVTSAVE1    (18) PTR(31),          /* MESSAGE CNTRL PROG SAVE  */ 46900000
*%D2     :  ;                                                           46970000
*   2 AVTSAVE2    (18) PTR(31),                                         47040000
*%D3     :  ;                                                           47110000
*   2 AVTSAVE3    (18) PTR(31),                                         47180000
*%D4     :  ;                                                           47250000
*   2 AVTSAVE4    (18) PTR(31),                                         47320000
*   2 AVTSAVEX    CHAR(40),              /* DISABLED SAVEAREA        */ 47390000
*    3 *           CHAR(32),                                            47460000
*    3 AVTDLQ      CHAR(8),              /* DEAD LETTER QUEUE        */ 47530000
*   2 AVTCSTCS    PTR(31),               /* IEDQSTCS ADDR OF FIRST      47600000
*                                           ENTRY  CHARACTERISTICS      47670000
*                                           TABLE                    */ 47740000
*   2 AVTDPARM    FIXED(31),             /* DISABLED PARAMETER LIST     47810000
*                                           USED WITH DOUBX          */ 47880000
*   2 AVTDOUBX    CHAR(8) BDY(DWORD),    /* DISABLED DOUBLEWORD         47950000
*                                           SCRATCH                  */ 48020000
*   2 AVTDOUBL    CHAR(8) BDY(DWORD),    /* ENABLED SCRATCH AREA     */ 48090000
*   2 AVTCTLCH    CHAR(8) BDY(DWORD),    /* OPERATOR CONTRL CHARS    */ 48160000
*   2 AVTPASWD    CHAR(8) BDY(DWORD),    /* PASSWORD                 */ 48230000
*   2 AVTTCB      PTR(31),               /* ADDRESS OF MESSAGE          48300000
*                                           CONTROL  PROGRAM'S TCB.     48370000
*                                           SET BY OPEN              */ 48440000
*   2 AVTRACE     PTR(31),               /* TRACE TABLE ADDRESS      */ 48510000
*                                                                       48580000
*/* DISPATCHER'S READY QUEUES                                        */ 48650000
*                                                                       48720000
*   2 AVTREADY    PTR(31),               /* AVTDELEM - ADDRESS OF       48790000
*                                           FIRST OF CHAIN  OF          48860000
*                                           ELEMENTS IN PRIORITY        48930000
*                                           ORDER                    */ 49000000
*   2 AVTREADD    PTR(31),              /* DISABLED FIFO READY QUEUE    49070082
*                                                            @OY19405*/ 49080082
*     3 AVTBUFTR  PTR(31),              /* ADD. OF BUFFER TRACE TABLE   49090082
*                                                            @OY19405*/ 49100082
*   2 AVTBUFSW    BIT(8),               /* NO. ENT. ON INTRO @OY19405*/ 49110082
*     3 *         BIT(6),               /* NOT USED          @OY19405*/ 49120082
*     3 AVTUNCON  BIT(1),               /* TRACE WITHOUT I/O @OY19405*/ 49130082
*     3 AVTFULLT  BIT(1),               /* TRACE ENTIRE BUFFE@OY19405*/ 49140082
*   2 *           CHAR(1),              /* NOT USED          @OY19405*/ 49150082
*   2 AVTBUENT    CHAR(2),              /* NO. ENT. ON INTRO @OY19405*/ 49160082
*   2 *           PTR(31),               /* CHECKPOINT WORKAREA -       49210000
*                                           GETMAIN                  */ 49280000
*    3 AVTCKFLG    BIT(8),               /* CKECKPOINT ACTIVE FLAGS     49350000
*                                                            @Y17XAXF*/ 49350700
*     4 AVTCKTAC    BIT(1),              /*  TCAM CHECKPOINT IS ACTIVE  49351400
*                                                            @Y17XAXF*/ 49352100
*     4 AVTCKNAC    BIT(1),              /*  CKECKPOINT FOR A  3705     49352800
*                                            IS ACTIVE       @Y17XAXF*/ 49353500
*     4 AVTCKENV    BIT(1),              /*  FORCE ENVIRONMENT CHKPT    49353700
*                                                            @Y17XAXF*/ 49353900
*     4 AVTCKREQ    BIT(1),              /*  THERE IS AN ELEMENT ON THE 49354200
*                                            OPERATOR CONTROL CHPT QUE  49354300
*                                            THAT WILL REQUEST AN ENVIR 49354400
*                                            CHECKPOINT      @Y17XAXF*/ 49354500
*     4 AVTCKHLT    BIT(1),              /*  A REQUEST TO CKPT A HALT   49354600
*                                            TCAM COMMAND HAS BEEN      49354700
*                                            PROCESSED       @Y17XAXF*/ 49354800
*     4 *           BIT(3),              /*  RESERVED        @Y17XAXF*/ 49354900
*    3 AVTCKAVT    PTR(24),              /* ADDRESS OF CHECKPOINT AVT   49355200
*                                                            @Y17XAXF*/ 49355600
*   2 AVTOCGET    PTR(31),               /* OPERATOR CONTROL            49356300
*                                           WORKAREA                 */ 49420000
*   2 AVTEXA2S    CHAR(6),               /* EXECUTED INSTRUCTIONS TO */ 49490000
*   2 AVTEXS2A    CHAR(6),               /* SAVE USER'S REGISTERS    */ 49560000
*   2 AVTPARM     PTR(31),               /* ADDRESS OF PARAMETERS    */ 49630000
*   2 AVTBASE     PTR(31),               /* IEDQAVT - ADDRESS OF AVT */ 49700000
*    3 AVTPKF      CHAR(1),              /* PROTECTION KEY FROM TCB     49770000
*                                           OF MCP                   */ 49840000
*     4 *        BIT(1),                 /* RESERVED                 */ 49910000
*     4 *        BIT(1),                 /* RESERVED                 */ 49980000
*     4 *        BIT(1),                 /* RESERVED                 */ 50050000
*     4 *        BIT(1),                 /* RESERVED                 */ 50120000
*     4 AVTFTCHF BIT(1),                 /* FETCH PROTECT ACTIVE        50190000
*                                           SWITCH                   */ 50260000
*     4 *        BIT(1),                 /* RESERVED                 */ 50330000
*     4 *        BIT(1),                 /* RESERVED                 */ 50400000
*     4 *        BIT(1),                 /* RESERVED                 */ 50470000
*   2 AVTPARM3    PTR(31),               /* ADDITIONAL OPTIONAL PARM */ 50540000
*   2 AVTDISTR    PTR(31),               /* ADDR OF DISPATCHER TRACE */ 50610000
*   2 AVTRNMPT    PTR(31),               /* IEDQTNT - ADDRESS OF        50680000
*                                           TERMNAME TABLE           */ 50750000
*   2 AVTRDYA     PTR(31),               /* IEDQRDYA - USER EXIT        50820000
*                                           ADDRESS IN READY         */ 50890000
*   2 AVTBSCAN    PTR(31),               /* LINE END BSC MSG SCAN    */ 50960000
*   2 AVTRARTN    PTR(31),               /* AVTDUMBR ADDR OF RTN TO     51030000
*                                           UPDATE LINE TRACE TABLE.    51100000
*                                           IF TRACE, OPEN LOADS THIS   51170000
*                                           MODULE                   */ 51240000
*   2 AVTSBTA     PTR(31),              /* @ IEDQSBT ROUTINE @YM07020*/ 51310000
*     /* AVTMVBFR IS NON-ZERO IF NON-EP MODE  OR                        51330000
*        IF EP MODE, AND TOTE IS IN SYSTEM                   @Y17XAXF*/ 51350000
*   2 AVTMVBFR    PTR(31),               /* @ IEDMVBFR ROUTN @Y17XAXF*/ 51380000
*   2 AVTSPLPT    PTR(31),               /* START PARAMETER LIST        51450000
*                                           POINTER, SET BY INTRO    */ 51520000
*   2 AVTCIB      PTR(8),                /* CIB=INTEGER              */ 51590000
*   2 AVTNCKPR    PTR(8),                /* CKREQS=INTEGER           */ 51660000
*   2 AVTNOLBF    FIXED(15),             /* LNUNITS=INTEGER          */ 51730000
*   2 AVTAS       PTR(31),               /* RELEASE                  */ 51800000
*                                                                       51870000
*/* ADDRESSES OF TCBS OF ATTACHED TASKS                              */ 51940000
*                                                                       52010000
*   2 AVTCKTCB    PTR(31),               /* CHECKPOINT               */ 52080000
*   2 AVTOCTCB    PTR(31),               /* OPERATOR CONTROL         */ 52150000
*   2 AVTOLTCB    PTR(31),               /* ON LINE TEST             */ 52220000
*   2 AVTCWTCB    PTR(31),               /* COMMON WRITE FE TASK     */ 52290000
*                                                                       52360000
*/* EVENT CONTROL BLOCKS                                             */ 52430000
*                                                                       52500000
*   2 AVTCWECA    FIXED(31),             /* COMMON WRITE FE TASK ECB */ 52570000
*   2 AVTCKECA    FIXED(31),             /* CHECKPOINT               */ 52640000
*   2 AVTOLECA    FIXED(31),             /* ON LINE TEST             */ 52710000
*   2 AVTOPECA    FIXED(31),             /* OPERATOR CONTROL         */ 52780000
*   2 AVTOSECB    FIXED(31),             /* EVENT CONTROL BLOCK         52850000
*                                           USED BY  DISPATCHER TO      52920000
*                                           CAUSE TCAM TASK TO BE       52990000
*                                           IN WAIT STATE            */ 53060000
*     3 AVTECB1 BIT(8),                  /*                  @G36XRXG*/ 53070000
*       4 * BIT(1),                      /*                  @G36XRXG*/ 53080000
*       4 AVTCOMP BIT(1),                /* ECB POSTED COMPL @G36XRXG*/ 53090000
*       4 * BIT(6),                      /*                  @G36XRXG*/ 53100000
*   2 AVTPCBPT    PTR(31),               /* FIRST PROCESS CONTROL       53130000
*                                           BLOCK                    */ 53200000
*   2 AVTOPTPT    PTR(31),               /* ADDRESS OF OPTION TABLE  */ 53270000
*   2 AVTKA02     PTR(31),               /* IEDQKA02 I/O GENERATOR      53340000
*                                           IN ACTIVATE              */ 53410000
*   2 *           FIXED(31),             /* RESERVED           S21903*/ 53480000
*   2 AVTCRSRF    FIXED(31),             /* CROSSRF=INTEGER          */ 53550000
*   2 AVTCOMPT    PTR(31),               /* ADDR OF COMMUNICATIONS      53620000
*                                           PARM                     */ 53690000
*   2 AVTUI       PTR(31),               /* IEDQUI USER INTERFACE    */ 53760000
*   2 AVTE8       PTR(31),               /* SEARCH RTN APP PRG S22025*/ 53830000
*   2 AVTHG02     PTR(31),               /* IEDQHG02 REMOVE ELE FROM    53900000
*                                           TIME DELAY Q             */ 53970000
*    3 AVTOLTST    PTR(8),               /* OLTEST=INTEGER           */ 54040000
*   2 AVTAL       PTR(31),               /* IEDQAL ADDRESS              54110000
*                                           COMPUTATION        S22025*/ 54180000
*   2 AVTGD       PTR(31),               /* IEDQGD - BUFFER             54250000
*                                           ASSOCIATION              */ 54320000
*   2 AVTA3       PTR(31),               /* TRANSPARENCY CCW BUILDER */ 54390000
*   2 AVTAX       PTR(31),               /* IEDQAX - SCAN      S22025*/ 54460000
*   2 AVTEA       PTR(31),               /* DISPATCHER               */ 54530000
*   2 AVTDISP     PTR(31),                                              54600000
*                                                                       54670000
*/* SUBTASKS ACTIVATED BY THE DISPATCHER                             */ 54740000
*                                                                       54810000
*    3 AVTHA       PTR(31),              /* RECEIVE SCHEDULER        */ 54880000
*   2 AVTHD       PTR(31),               /* SEND SCHEDULER           */ 54950000
*    3 AVTSCOPT    CHAR(1),              /*                    S22026*/ 55020000
*     4 *           BIT(2),              /* RESERVED         @ZA07083*/ 55090000
*     4 AVTAPDMP    BIT(1),              /* APPL DUMP REQUEST           55160000
*                                                            @ZA07083*/ 55190000
*     4 AVTCMBUF    BIT(1),              /* COMMON BUFFER               55230000
*                                           TRANSMISSION       S22027*/ 55300000
*     4 AVTCONC     BIT(1),              /* CONCENTRATOR MIXED S22026*/ 55370000
*     4 AVTCONCO    BIT(1),              /* CONCENTRATOR ONLY  S22026*/ 55440000
*     4 AVTN2741    BIT(1),              /* NO 2741 & NO TSO   S22026*/ 55510000
*     4 AVTNDIAL    BIT(1),              /* NO DIAL            S22026*/ 55580000
*   2 AVTEW       PTR(31),               /* GET SCHEDULER            */ 55650000
*   2 AVTEC       PTR(31),               /* PUT SCHEDULER            */ 55720000
*   2 AVTEZ       PTR(31),               /* GET FIFO                 */ 55790000
*   2 AVTBZ       PTR(31),               /* LOG SCHEDULER            */ 55860000
*   2 AVTR1       PTR(31),               /* DIAL SCHEDULER           */ 55930000
*   2 AVTHB       PTR(31),               /* BUFFERED SCHEDULER       */ 56000000
*   2 AVTE7       PTR(31),               /* RETRIEVE SCHEDULER       */ 56070000
*   2 AVTQ1       PTR(31),               /* LOCAL SCHEDULER          */ 56140000
*   2 AVTCSCH     PTR(31),               /* CONC SEND SCHED    S22026*/ 56210000
*   2 AVTSEND     PTR(31),               /* 3705 RESOURCE               56280000
*                                           SEND SCHEDULER   @Y17XAXU*/ 56350000
*   2 AVTRCV      PTR(31),               /* 3705 RESOURCE               56420000
*                                           RECV SCHEDULER   @Y17XAXU*/ 56490000
*   2 AVTCMBSS    PTR(31),               /* COMMBUF SCHEDULER  S22027*/ 56560000
*   2 *           PTR(31),               /* RESERVED           S22024*/ 56630000
*   2 AVTSAVTP    PTR(31),               /* SECONDARY AVT ADDR S22024*/ 56700000
*    3 AVTSAVTF    BIT(8),              /* SAVT FLAGS          X03039*/ 56770000
*     4 AVTVTMCP BIT(1),                  /* 3705 ENVIR      @Y17XAXU*/ 56840000
*     4 AVTONSNA BIT(1),                  /* ONLY SNA ENVIR  @Y17XAXU*/ 56910000
*     4 AVTSNA   BIT(1),                  /* SNA ENVIR       @Y17XAXU*/ 56980000
*     4 *          BIT(5),              /* RESERVED          @Y17XAXU*/ 57050000
*    3 *           CHAR(3),             /* FILLER              X03039*/ 57120000
*   2 AVTPLCBN    FIXED(15),             /* NUMBER OF PLCB'S   S22024*/ 57190000
*   2 AVTABEND    CHAR(6),               /* ABEND 045, SUBCODE R15   */ 57260000
*   2 AVTDMECB    FIXED(31),             /* DUMMY LINE I/O ECB       */ 57330000
*   2 AVTA3TL     PTR(31),               /* IEDQA3 - TRANSLATE LIST  */ 57400000
*   2 AVTTONE     PTR(31),               /* ADDRESS OF WORLD TRADE      57470000
*                                           TONE CHARS               */ 57540000
*   2 AVTNX       PTR(31),               /* OPERATOR AWARENESS MESSAGE  57610000
*                                           ROUTER                   */ 57680000
*   2 AVTIOT      PTR(31),               /* IGG019Q0 - I/O TRACE        57750000
*                                           TABLE HANDLER            */ 57820000
*   2 AVTHI       PTR(31),               /* IEDQHI - SYSTEM DELAY QCB   57890000
*                                           ADDR                     */ 57960000
*   2 AVTHK       PTR(31),               /* IEDQHK STOPLINE QCB ADDR */ 58030000
*   2 AVTCKPEL    CHAR(16) BDY(WORD),   /* TIME DELQY REMOVAL ELEMENT   58100000
*                                          FOR CHECKPOINT    @Y17XAXF*/ 58106000
*    3 AVTCKRMV   PTR(31),              /*  1ST WORD OF REMOVAL ELEMENT 58112000
*                                                            @Y17XAXF*/ 58170000
*     4 AVTCKRKY  BIT(8),               /*   KEY FOR REMOVAL ELEMENT    58171000
*                                            TO CHECKPOINT   @Y17XAXF*/ 58172000
*     4 AVTCKRMQ  PTR(24),              /*   ADDR OF TIME DELAY QCB     58173000
*                                                            @Y17XAXF*/ 58174000
*    3 AVTCKRPR   BIT(8),               /*  PRIORITY         @Y17XAXF*/ 58175000
*    3 AVTCKRLK   PTR(24),              /*  LINK             @Y17XAXF*/ 58176000
*    3 *          CHAR(8),              /*  LAST 2 WORDS OF ELEMENT     58310000
*                                                            @Y17XAXF*/ 58320000
*   2 AVTCKELE    PTR(31),               /* TIME DELAY OR REUS          58380000
*                                           POSTS ELEMENT TO START      58450000
*                                           CHECKPOINT               */ 58520000
*   2 *           PTR(31),                                              58590000
*   2 AVTSCBSZ    PTR(8),                /* SCB SIZE INCLUDING          58660000
*                                           SAVEAREA FOR USER'S REGS */ 58730000
*   2 AVTCKQAD    PTR(24),               /* AVTCKPTB CKPT QCB ADDR   */ 58800000
*   2 AVTCKELF    CHAR(1),               /* FLAG BITS                */ 58870000
*    3 AVTNQBCK BIT(1),                  /* NO QBACK SCAN NEEDED        58940000
*                                                            @OS77945*/ 59010000
*    3 AVTCMCPN BIT(1),                  /* CHECKPOINT REQUESTED BY     59080000
*                                           MCPCLOSE                 */ 59150000
*    3 *        BIT(1),                  /* RESERVED                 */ 59220000
*    3 AVTCINCN BIT(1),                  /* CHECKPOINT REQUESTED BY     59290000
*                                           INCIDENT OVERFLOW        */ 59360000
*    3 AVTCCLCN BIT(1),                  /* CLOSEDOWN COMPLETION BIT */ 59430000
*    3 AVTCPIPN BIT(1),                  /* CHECKPOINT IN PROGRESS   */ 59500000
*    3 AVTCRTLN BIT(1),                  /* CHECKPOINT REQUESTED     */ 59570000
*    3 AVTWARMN BIT(1),                  /* WARM RESTART             */ 59640000
*   2 AVTCPRCD    PTR(8),                /* CPRCDS=INTEGER           */ 59710000
*   2 AVTCKELV    FIXED(15),             /* CPINTVL=TIME INTERVAL    */ 59780000
*   2 AVTCKTIM    FIXED(15),             /* TIME OF DAY OF INTERRUPT */ 59850000
*   2 *           PTR(8),                /* INDEX TO QCB ADDRESS     */ 59920000
*   2 AVTOPERL    CHAR(1),               /* OPEN ERROR LOCATOR       */ 59990000
*   2 AVTOPXCL    CHAR(2),               /* OPEN ERROR MODULE ID     */ 60060000
*   2 AVTOPERT    PTR(8),                /* TYPE OF OPEN ERROR       */ 60130000
*   2 AVTCKBYT    CHAR(1),               /* CKPT TIME DELAY STATUS   */ 60200000
*    3 *        BIT(1),                  /* RESERVED                 */ 60270000
*    3 *        BIT(1),                  /* RESERVED                 */ 60340000
*    3 *        BIT(1),                  /* RESERVED                 */ 60410000
*    3 *        BIT(1),                  /* RESERVED                 */ 60480000
*    3 *        BIT(1),                  /* RESERVED                 */ 60550000
*    3 *        BIT(1),                  /* RESERVED                 */ 60620000
*    3 AVTCKONQ BIT(1),                  /* ELEMENT ON TIME QUEUE    */ 60690000
*    3 *        BIT(1),                  /* RESERVED                 */ 60760000
*   2 AVTHG01     PTR(31),               /* IEDQHG01 - TIME DELAY       60830000
*                                           SUBROUTINE               */ 60900000
*    3 AVTOPETR    CHAR(1),              /* OPEN TRANSLATE BYTE      */ 60970000
*   2 AVTCKLNK    PTR(31),               /* LINK FIELD ON TIME QUEUE */ 61040000
*    3 AVTBSX      PTR(8),               /* BINARY SEARCH ADDR INDEX */ 61110000
*   2 AVTDELEM    PTR(31),               /* AVTREADY-8 DUMMY LAST       61180000
*                                           ELEMENT                  */ 61250000
*   2 AVTDELAD    PTR(31),               /* AVTDELEM - ADDR OF DUMMY    61320000
*                                           LAST ELEMENT             */ 61390000
*   2 AVTCRELE    CHAR(8) BDY(WORD),    /* OPERATOR CONTROL CKPT        61392000
*                                          REQUEST ELEMENT   @Y17XAXF*/ 61394000
*    3 AVTCCELE   PTR(31),                                              61396000
*     4 AVTCCKEY  BIT(8),               /*  OP CONTROL KEY FOR CKPT     61530000
*                                                            @Y17XAXF*/ 61570000
*     4 AVTCCQCB  PTR(24),              /*  ADDR OF CKPT QCB @Y17XAXF*/ 61610000
*    3 AVTCCPRI   BIT(8),               /*  PRIORITY         @Y17XAXF*/ 61630000
*    3 AVTCCLNK   PTR(24),              /*  LINK             @Y17XAXF*/ 61650000
*   2 AVTCLRHI    FIXED(31),            /* MASK FOR CLEARING   X03039*/ 61740000
*                                       /* TWO HIGH ORDER BYTESX03039*/ 61810000
*                                       /* OF A REGISTER       X03039*/ 61880000
*    3 *          CHAR(2),              /* FILLER              X03039*/ 61950000
*    3 AVTHFF     CHAR(2),              /* HALF WORD OF 'FFFF' X03039*/ 62020000
*   2 AVTADBUF    PTR(31),               /* BUFFER ADDRESS SET BY       62090000
*                                           MH CONTROL               */ 62160000
*     3 AVTABEPL  FIXED(31),             /* ABEND PARM LIST  @YM07738*/ 62190000
*   2 AVT2260L    PTR(31),               /* 2260 LOCAL APPENDAGE     */ 62230000
*   2 AVTSYSER    CHAR(1),               /* SYSTEM ERROR FLAG BYTE   */ 62300000
*    3 AVTCMINN BIT(1),                  /* NUMBER CORE QUEUE UNITS     62370000
*                                           LESS THAN SPECIFIED BY      62440000
*                                           MSMIN=PERCENT            */ 62510000
*    3 AVTCMAXN BIT(1),                  /* NUMBER CORE QUEUE UNITS     62580000
*                                           MORE THAN SPECIFIED BY      62650000
*                                           MSMAX=PERCENT            */ 62720000
*    3 *        BIT(1),                  /* RESERVED                 */ 62790000
*    3 *        BIT(1),                  /* RESERVED                 */ 62860000
*    3 *        BIT(1),                  /* RESERVED                 */ 62930000
*    3 *        BIT(1),                  /* RESERVED                 */ 63000000
*    3 *        BIT(1),                  /* RESERVED                 */ 63070000
*    3 *        BIT(1),                  /* RESERVED                 */ 63140000
*   2 AVTMSGS     PTR(24)  BDY(BYTE),    /* IEDQMSGS  LIST OF           63210000
*                                           OPTIONAL VCONS           */ 63280000
*                                                                       63350000
*/* POINTERS TO QCBS                                                 */ 63420000
*                                                                       63490000
*   2 AVTCBQCB    PTR(31),               /* COMMBUF MASTER QCB S22027*/ 63560000
*   2 AVTSUPPT    PTR(31),               /* STARTUP MESSAGE          */ 63630000
*   2 AVTTSOPT    PTR(31),               /* TIME SHARING INPUT       */ 63700000
*   2 AVTOCQPT    PTR(31),               /* IEDQEU - OPEN/CLOSE         63770000
*                                           APPLICATION PROGRAM      */ 63840000
*                                                                       63910000
*/* NON-OPTIONAL QCBS                                                */ 63980000
*                                                                       64050000
*   2 AVTDELYB    PTR(31),               /* TIME DELAY QCB           */ 64120000
*   2 *           CHAR(12),                                             64190000
*   2 AVTREFTM    FIXED(15),             /* REFERENCE TIME - CURRENT    64260000
*                                           TIME OF DAY PLUS OR         64330000
*                                           MINUS SIX HOURS          */ 64400000
*   2 AVTINOUT    FIXED(15),             /* DUMMY INEND/OUTEND          64470000
*                                           PARAMETER LIST           */ 64540000
*   2 AVTIMQPS    PTR(31),               /* PARM FOR SVC 102 - POST     64610000
*                                           TIME QCB TO ITSELF AT       64680000
*                                           TIMER INTERRUPT          */ 64750000
*   2 *           PTR(31),                                              64820000
*   2 AVTTIMQ     PTR(31),               /* TIME DELAY QUEUE         */ 64890000
*   2 AVTBFREB    PTR(31),               /* AVAILABLE BUFFER QUEUE   */ 64960000
*   2 AVTBFRFG    BIT(8),               /* BUFFER POOL FLAG  @OY19124*/ 64970082
*     3 AVTBFRTN  BIT(1),               /* RETURN BOTTOM     @OY19124*/ 64980082
*   2 AVTSELCH    PTR(24),              /* BUFFER POOL BOTTOM@OY19124*/ 64990082
*   2 *           CHAR(4),                                 /*@OY19124*/ 65030082
*   2 AVTBFRTB    PTR(31),               /* BUFFER RETURN QUEUE      */ 65100000
*   2 *           CHAR(8),                                              65170000
*   2 AVTCKPQB    CHAR(12) BDY(WORD),    /* CKECKPOINT QCB   @Y17XAXF*/ 65240000
*    3 AVTCKPTB   PTR(31),               /* QUEUE OF ELEMENTS FOR CKPT  65240100
*                                                            @Y17XAXF*/ 65240200
*     4 AVTCKPVT  BIT(8),                /* VTO FOR ATTACHED TASK       65240300
*                                                            @Y17XAXF*/ 65240400
*     4 AVTCKPCH  PTR(24),              /* CHAIN OF ELEMENTS            65240500
*                                                            @Y17XAXF*/ 65240600
*    3 AVTCKPEC   PTR(31),              /* EVENT CONTROL BLOCK          65240700
*                                                            @Y17XAXF*/ 65240800
*     4 AVTCKPCC  BIT(8),                /* COMPLETION CODE BYTE        65240900
*                                                            @Y17XAXF*/ 65241000
*      5 AVTCKPWA BIT(1),               /* WAITING FOR COMPLETION OF    65241100
*                                          THE EVENT         @Y17XAXF*/ 65241200
*      5 AVTCKPPO BIT(1),               /* EVENT HAS COMPLETED          65241300
*                                                            @Y17XAXF*/ 65241400
*      5 *        BIT(6),               /* RESERVED          @Y17XAXF*/ 65241500
*     4 *         CHAR(3),              /* RESERVED          @Y17XAXF*/ 65241600
*    3 AVTCKPTS   CHAR(1),              /* TEST AND SET FOR CKPT        65241700
*                                                            @Y17XAXF*/ 65241800
*    3 *          PTR(24),              /* STCB ADDRESS      @Y17XAXF*/ 65241900
*   2 AVTOPCQB    CHAR(12) BDY(WORD),   /* OPERATOR CONTROL QCB         65380000
*                                                            @Y17XAXF*/ 65380100
*    3 AVTOPCOB   PTR(31),              /*  QUEUE OF ELEMENTS FOR OPCTL 65380200
*                                                            @Y17XAXF*/ 65380300
*     4 AVTOPCVT  BIT(8),               /*   VTO FOR ATTACHED TASK      65380400
*                                                            @Y17XAXF*/ 65380500
*     4 AVTOPCCH  PTR(24),              /*   CHAIN OF ELEMENTS          65380600
*                                                            @Y17XAXF*/ 65380700
*    3 AVTOPCEC   PTR(31),              /*  EVENT CONTROL BLOCK         65380800
*                                                            @Y17XAXF*/ 65380900
*     4 AVTOPCCC  BIT(8),               /*   COMPLETION CODE BYTE       65381000
*                                                            @Y17XAXF*/ 65381100
*      5 AVTOPCWA BIT(1),               /*    WAITING FOR COMPLETION OF 65381200
*                                              THE EVENT     @Y17XAXF*/ 65381300
*      5 AVTOPCPO BIT(1),               /*    EVENT HAS COMPLETED       65381400
*                                                            @Y17XAXF*/ 65381500
*      5 *        BIT(6),               /*    RESERVED       @Y17XAXF*/ 65381600
*     4 *         PTR(24),              /*   RESERVED        @Y17XAXF*/ 65381700
*    3 *          PTR(31),              /* STCB ADDRESS      @Y17XAXF*/ 65381800
*   2 AVTOLTQB    PTR(31),               /* ON LINE TEST QUEUE       */ 65520000
*    3 AVTOLTVT   FIXED(8),              /* VTO FOR ATTACHED TASK       65530000
*                                                            @Y17XAXF*/ 65540000
*    3 AVTOLTCH   PTR(24),               /*CHAIN OF ELEMENTS @Y17XAXF*/ 65550000
*   2 AVTOLTEB    FIXED(31),             /* QCB              @Y17XAXF*/ 65560000
*   2 *           PTR(31),               /* STCB ADDRESS     @Y17XAXF*/ 65590000
*   2 AVTACTIB    PTR(31),               /* ACTIVATE QUEUE           */ 65660000
*   2 *           CHAR(8),                                              65730000
*   2 AVTCLOSB    PTR(31),               /* CLOSEDOWN COMPLETION Q   */ 65800000
*   2 *           CHAR(8),                                              65870000
*   2 AVTCPRMB    PTR(31),               /* REMOVES ELEMENT FROM TIME   65940000
*                                           DELAY                    */ 66010000
*   2 *           CHAR(8),                                              66080000
*   2 AVTDSIOB    PTR(31),               /* DISK I/O QUEUE           */ 66150000
*   2 *           CHAR(8),                                              66220000
*   2 AVTCPBCB    PTR(31),               /* CPB CLEANUP QUEUE        */ 66290000
*   2 *           CHAR(8),                                              66360000
*   2 AVTCOREC    PTR(31),               /* BUFFER POOL FOR CLOSE    */ 66430000
*   2 AVTCADDR    FIXED(31),             /* CORE QUEUE COUNT         */ 66500000
*   2 AVTFZERO    FIXED(31),             /* FULLWORD OF ZEROES       */ 66570000
*                                                                       66640000
*/* FE COMMON WRITE INTERFACE AREA                                   */ 66710000
*                                                                       66780000
*   2 AVTCAREA    PTR(31),               /* IEDQFE PATCH MODULE      */ 66850000
*   2 AVTCWPM1    PTR(31),               /* FIRST PARAMETER POINTER  */ 66920000
*   2 AVTCWEC1    FIXED(31),             /* FIRST ECB                */ 66990000
*   2 AVTCWFL1    CHAR(1),               /* FIRST FLAG BYTE          */ 67060000
*                                                                       67130000
*/* AVTCWFL1 BIT DEFINITIONS                                         */ 67200000
*                                                                       67270000
*    3 AVTCOMWN BIT(1),                  /* COMWRTE=YES              */ 67340000
*    3 *        BIT(1),                  /* RESERVED                 */ 67410000
*    3 *        BIT(1),                  /* RESERVED                 */ 67480000
*    3 *        BIT(1),                  /* RESERVED                 */ 67550000
*    3 *        BIT(1),                  /* RESERVED                 */ 67620000
*    3 *        BIT(1),                  /* RESERVED                 */ 67690000
*    3 *        BIT(1),                  /* RESERVED                 */ 67760000
*    3 *        BIT(1),                  /* RESERVED                 */ 67830000
*   2 AVTCWFL2    CHAR(1),               /* ADDITIONAL FLAG BYTES    */ 67900000
*                                                                       67970000
*/* AVTCWFL2 BIT DEFINITIONS                                         */ 68040000
*                                                                       68110000
*    3 AVTCWACT BIT(1),                  /* COMMON WRITE IS ACTIVE   */ 68180000
*    3 *        BIT(1),                  /* RESERVED                 */ 68250000
*    3 *        BIT(1),                  /* RESERVED                 */ 68320000
*    3 *        BIT(1),                  /* RESERVED                 */ 68390000
*    3 *        BIT(1),                  /* RESERVED                 */ 68460000
*    3 *        BIT(1),                  /* RESERVED                 */ 68530000
*    3 AVTCWRAP BIT(1),                  /* '0' - WRAPPING OUTPUT       68600000
*                                           ALLOWED (REUSE SAME         68670000
*                                           VOLUME)                     68740000
*                                           '1' - WRAP NOT ALLOWED      68810000
*                                           '1'                         68880000
*                                           (INVOKE VOLUME SWITCH)   */ 68950000
*    3 AVTCWCLD BIT(1),                  /* COMWRITE CLOSEDOWN OR       69020000
*                                           TCAM CLOSEDOWN           */ 69090000
*   2 AVTCWTS1    CHAR(1),              /* COMWRTE ECB1 AVAIL           69091000
*                                                            @Y17XAXU*/ 69092000
*   2 AVTCWTS2    CHAR(1),              /* COMWRTE ECB2 AVAIL           69093000
*                                                            @Y17XAXU*/ 69094000
*   2 AVTCWPM2    PTR(31),               /* SECOND PARAMETER POINTER */ 69300000
*   2 AVTCWEC2    FIXED(31),             /* SECOND ECB               */ 69370000
*   2 AVTAFE10    PTR(31),               /* IEDQFE10 ENTRY POINT     */ 69440000
*   2 AVTAFE20    PTR(31),               /* IEDQFE20 ENTRY POINT     */ 69510000
*   2 AVTAFE30    PTR(31),               /* IEDQFE30  ENTRY POINT    */ 69580000
*   2 AVTSUBT     CHAR(1),              /* SUBT OPTIONS FLAG @Y17XAXU*/ 69590000
*    3 AVTSUBON   BIT(1),               /* SUBTASK TRACE ON  @Y17XAXU*/ 69600000
*    3 AVTSUBPT   BIT(1),               /* SUBTASK POST TR ON           69610000
*                                                            @Y17XAXU*/ 69620000
*    3 *          BIT(6),               /* UNUSED            @Y17XAXU*/ 69630000
*   2 AVTIOTR     CHAR(1),              /* IOTR OPTIONS FLAG @Y17XAXU*/ 69640000
*    3 AVTIOTRE   BIT(1),               /* I/O TRACE ON      @Y17XAXU*/ 69650000
*    3 AVTIOTRH   BIT(1),               /* I/O POST TRACE ON @Y17XAXU*/ 69660000
*    3 *          BIT(6),               /* UNUSED            @Y17XAXU*/ 69670000
*   2 *           CHAR(2),              /* RESERVED          @Y17XAXU*/ 69680000
*   2 AVTDTRAP    PTR(31),              /* SERVICE AID ENTRY @Y17XAXU*/ 69690000
*   2 AVTCWINT    CHAR(52),              /* SERVICE COMMUNI- @Y17XAXU*/ 69700000
*                                        /* CATION AREA       SA64772*/ 69720000
*   2 AVTCWTOT    CHAR(4),               /* TOTE COMMUNICA-   SA64772*/ 69790000
*                                        /* TION AREA         SA64772*/ 69860000
*                                                                       69930000
*/* GETMAIN PARAMETER LIST - GETMAIN EC,MF=L                         */ 70000000
*                                                                       70070000
*   2 AVTGETMN    PTR(31),                                              70140000
*   2 AVTGETMD    PTR(31),                                              70210000
*   2 *           CHAR(1),                                              70280000
*   2 AVTGETMS    PTR(8),                                               70350000
*   2 AVTHA2      FIXED(15),             /* 2 - CONSTANT             */ 70420000
*   2 AVTHA3      FIXED(15),             /* 3 - CONSTANT             */ 70490000
*   2 AVTHA4      FIXED(15),             /* 4 - CONSTANT             */ 70560000
*   2 AVTHA7      FIXED(15),             /* 7 - CONSTANT             */ 70630000
*   2 AVTHA16     FIXED(15),             /* 16 - CONSTANT            */ 70700000
*   2 AVTKEYLE    FIXED(15),             /* KEYLEN ON MSG QUEUES     */ 70770000
*   2 AVTLNCNT    FIXED(15),             /* NUMBER OF LINES OPENED   */ 70840000
*   2 AVTOPCNT    FIXED(15),             /* NUMBER OF LINES IN USE      70910000
*                                           BY OPERATOR CONTROL      */ 70980000
*   2 AVTOPCON    FIXED(15),             /* TERMNAME TABLE OFFSET TO    71050000
*                                           PRIMARY OPERATOR CONTROL    71120000
*                                           CONSOLE                  */ 71190000
*   2 AVTAVFCT    FIXED(15),             /* NUMBER OF BUFFERS IN POOL*/ 71260000
*   2 AVTSMCNT    FIXED(15),             /* NUMBER OF LINES SERVICED    71330000
*                                           BY STARTUP MESSAGE SUBTSK*/ 71400000
*   2 AVTINTLV    FIXED(15),             /* NUMBER OF SECONDS OF        71470000
*                                           SYSTEM DELAY             */ 71540000
*   2 AVTDLQX     FIXED(15),             /* TERMNAME TABLE OFFSET OF    71610000
*                                           DEAD LETTER QUEUE        */ 71680000
*   2 AVTDUMBR    FIXED(15),             /* BR 11 - DUMMY LINE TRACE    71750000
*                                           TABLE UPDATE             */ 71820000
*   2 AVTBIT1     CHAR(1),               /* FLAG BITS                */ 71890000
*                                                                       71960000
*/* AVTBIT1 BIT DEFINITIONS                                          */ 72030000
*                                                                       72100000
*    3 AVTAPLKN BIT(1),                  /* PREVENT DISK END            72170000
*                                           APPENDAGE FROM ADDING CPB   72240000
*                                           TO DISABLED DISK END        72310000
*                                           QUEUE FOR CPB CLEANUP    */ 72380000
*    3 AVTTSON  BIT(1),                  /* ENVIRON=TSO (OR MIXED)   */ 72450000
*    3 AVTAQTAN BIT(1),                  /* ENVIRON=TCAM (OR MIXED)  */ 72520000
*    3 AVTDLAYN BIT(1),                  /* SYSTEM DELAY IN EFFECT   */ 72590000
*    3 AVTREADN BIT(1),                  /* READY MACRO EXECUTED     */ 72660000
*    3 AVTCLOSN BIT(1),                  /* CLOSEDOWN REQUESTED      */ 72730000
*    3 AVTQUCKN BIT(1),                  /* CLOSEDOWN TYPE              72800000
*                                           '0' - FLUSH                 72870000
*                                           '1' - QUICK              */ 72940000
*    3 AVTDISKN BIT(1),                  /* DISK=YES                 */ 73010000
*   2 AVTBIT2     CHAR(1),               /* FLAG BITS                */ 73080000
*                                                                       73150000
*/* AVTBIT2 BIT DEFINITIONS                                          */ 73220000
*                                                                       73290000
*    3 AVTEXTSC BIT(1),                  /* EXTENDED RESTART  SA51078*/ 73360000
*    3 AVTREUSN BIT(1),                  /* REUSABILITY IS RUNNING   */ 73430000
*    3 AVTCOPYN BIT(1),                  /* COPY REQUESTS CONTROL    */ 73500000
*    3 AVTTOPOL BIT(1),                  /* TOPMSG=NO                */ 73570000
*    3 AVTSTRTN BIT(1),                  /* RESTART HAS BEGUN        */ 73640000
*    3 AVTOPEIN BIT(1),                  /* INITIAL LOAD DONE           73710000
*                                           INDICATOR                */ 73780000
*/* X'02' - LINETYP=STSP                                             */ 73850000
*/* X'01' - LINETYP=BISC                                             */ 73920000
*/* X'03' - LINETYP=MINI                                             */ 73990000
*/* X'00' - LINETYP=BOTH                                             */ 74060000
*    3 *        BIT(1),                  /* RESERVED                 */ 74130000
*    3 *        BIT(1),                  /* RESERVED                 */ 74200000
*   2 AVTBIT3     CHAR(1),               /* FLAG BITS                */ 74270000
*                                                                       74340000
*/* AVTBIT3 BIT DEFINITIONS                                          */ 74410000
*                                                                       74480000
*    3 AVTRECVN BIT(1),                  /* CORE QUEUE FULL          */ 74550000
*    3 AVTRFULN BIT(1),                  /* REUS DISK ZONE FULL      */ 74620000
*    3 AVTTSAB  BIT(1),                  /* TSO HAS ABENDED          */ 74690000
*    3 AVTOLTBN BIT(1),                  /* MAX LOAD OF OLT REACHED  */ 74760000
*    3 AVTSTAYN BIT(1),                  /* S=Y - NO CONTINUATION    */ 74830000
*    3 AVTSTAIN BIT(1),                  /* S=I - INVITATION LISTS   */ 74900000
*    3 AVTSTACN BIT(1),                  /* S=C - COLDSTART          */ 74970000
*    3 AVTSTAN  BIT(1),                  /* S=C OR S=W SPECIFIED     */ 75040000
*   2 AVTCKRST    PTR(8),                /* RESTART=INTEGER          */ 75110000
*   2 AVTDSKCT    FIXED(15),             /* NUMBER OF BUFFERS ON CPBS*/ 75180000
*   2 AVTOPTN PTR(31),                  /* OPTION SEARCH RTN @Y17XAXU*/ 75250000
*   2 AVTSTEAL    PTR(31),              /* BUFFER STEAL RTN  @Y17XAXU*/ 75320000
*   2 AVTDDFT     PTR(31),              /* DEVICE DEPENDENT  @Y17XAXU*/ 75390000
*                                       /* FLD LOOKUP RTN    @Y17XAXU*/ 75460000
*   2 AVTOPMSK    PTR(31),              /* ADDR OF OPERATOR CONTROL     75530000
*                                          MASK TABLE        @Y17XAXU*/ 75600000
*   2 AVTDCTLN    FIXED(15),            /* LENGTH OF DCT MASK FIELD IN  75670000
*                                          BYTES             @Y17XAXU*/ 75740000
*   2 AVTOPCIN    FIXED(16),            /* TTCIN OF PRIMARY  @Y17XAXU*/ 75810000
*                                       /* TERMINAL          @Y17XAXU*/ 75880000
*/* END OF BASIC AVT WHEN ENVIRON=TSO                                */ 75950000
*                                                                       76020000
*   2 AVTHM02     PTR(31),               /* IEDQHM02 - DESTINATION      76090000
*                                           ASSIGNMENT               */ 76160000
*   2 AVTCMIN     PTR(31),               /* MSMIN=INTEGER            */ 76230000
*   2 AVTCMAX     PTR(31),               /* MSMAX=INTEGER            */ 76300000
*   2 AVTTOTNC    FIXED(31),             /* NUMBER OF RECORDS IN        76370000
*                                           ENTIRE  DATA SET            76440000
*                                           (MSUNITS=INTEGER)        */ 76510000
*   2 AVTNCPBQ    PTR(31),               /* QUEUE OF BUFFERS AND        76580000
*                                           ERBS WAITING TO BE          76650000
*                                           PROCESSED                */ 76720000
*   2 *           PTR(31),                                              76790000
*                                                                       76860000
*/* END OF CORE QUEUE AVT WHEN DISK=NO                               */ 76930000
*                                                                       77000000
*   2 AVTFL       PTR(31),               /* DISK EXCP DRIVER         */ 77070000
*   2 AVTIA       PTR(31),               /* REUSABILITY              */ 77140000
*   2 AVTCOPY     PTR(31),               /* COPY SUBTASK QCB POINTER */ 77210000
*   2 AVTDKAPQ    PTR(31),               /* QUEUE OF CPBS TO BE         77280000
*                                           PROCESSED BY CPB            77350000
*                                           CLEANUP (DISABLED)       */ 77420000
*   2 *           PTR(31),                                              77490000
*   2 AVTDKENQ    PTR(31),               /* SAME AS ABOVE EXCEPT        77560000
*                                           ENABLED                  */ 77630000
*   2 *           PTR(31),                                              77700000
*   2 AVTNOBFQ    PTR(31),               /* QUEUE OF CPBS WITHOUT       77770000
*                                           BUFFERS - USED BY CPB       77840000
*                                           CLEANUP                  */ 77910000
*   2 *           PTR(31),                                              77980000
*   2 AVTBIT4     CHAR(1),               /* FLAG BITS         SA51078*/ 78050000
*                                                                       78120000
*/* AVTBIT4 BIT DEFINITIONS                                   SA51078*/ 78190000
*                                                                       78260000
*    3 AVTRUFTN    BIT(1),               /* REUS ACTIVE AT CHECKPT      78330000
*                                                             SA51078*/ 78400000
*    3 *           BIT(1),               /* RESERVED                 */ 78470000
*    3 *           BIT(1),               /* RESERVED                 */ 78540000
*    3 *           BIT(1),               /* RESERVED                 */ 78610000
*    3 *           BIT(1),               /* RESERVED                 */ 78680000
*    3 *           BIT(1),               /* RESERVED                 */ 78750000
*    3 *           BIT(1),               /* RESERVED                 */ 78820000
*    3 *           BIT(1),               /* RESERVED                 */ 78890000
*                                                                       78960000
*   2 *           PTR(24),               /* RESERVED          SA51078*/ 79030000
*   2 *           PTR(31),                                              79100000
*   2 AVTINCPQ    PTR(31),               /* QUEUE OF CPBS REQUESTING    79170000
*                                           I/O BY EXCP DRIVER       */ 79240000
*   2 *           PTR(31),                                              79310000
*   2 AVTFCPB     PTR(31),               /* QUEUE OF INACTIVE CPBS -    79380000
*                                           CPB FREEPOOL             */ 79450000
*   2 AVTCPBPT    PTR(31),               /* ADDRESS OF CPB FREEPOOL     79520000
*                                           TO BE FREEMAINED BY         79590000
*                                           DISK CLOSE               */ 79660000
*   2 AVTIOBR     PTR(31),               /* ADDRESS OF LIST OF IOBS -   79730000
*                                           ONE FOR EACH EXTENT OF THE  79800000
*                                           REUSABLE DISK QUEUE      */ 79870000
*   2 AVTIOBN     PTR(31),               /* SAME AS ABOVE EXCEPT FOR    79940000
*                                           NON-REUSABLE DISK QUEUE  */ 80010000
*   2 AVTLODPT    FIXED(31),             /* RADDR WHEN REUS ACTIVATED*/ 80080000
*                                                                       80150000
*/* REUSABLE DISK DEFINITION                                         */ 80220000
*                                                                       80290000
*   2 AVTADEBR    PTR(31),               /* ADDRESS OF DEB           */ 80360000
*   2 AVTNOVOR    FIXED(31),             /* NUMBER OF EXTENTS        */ 80430000
*   2 AVTRCTRR    FIXED(31),             /* NUMBER OF RECORDS/TRACK  */ 80500000
*   2 AVTTRCYR    FIXED(31),             /* NUMBER OF TRACKS/CYLINDER*/ 80570000
*   2 AVTTOTNR    FIXED(31),             /* NUMBER OF RECORDS IN        80640000
*                                           ENTIRE DATA SET          */ 80710000
*   2 AVTVOLRR    FIXED(31),             /* PRODUCT OF NUMBER OF        80780000
*                                           EXTENTS AND NUMBER OF       80850000
*                                           RECORDS/TRACK            */ 80920000
*                                                                       80990000
*/* NON-REUSABLE DISK DEFINITION                                     */ 81060000
*                                                                       81130000
*   2 AVTADEBN    PTR(31),               /* ADDRESS OF DEB           */ 81200000
*   2 AVTNOVON    FIXED(31),             /* NUMBER OF EXTENTS        */ 81270000
*   2 AVTRCTRN    FIXED(31),             /* NUMBER OF RECORDS/TRACK  */ 81340000
*   2 AVTTRCYN    FIXED(31),             /* NUMBER OF TRACKS/CYLINDER*/ 81410000
*   2 AVTTOTNN    FIXED(31),             /* NUMBER OF RECORDS IN        81480000
*                                           ENTIRE DATA SET          */ 81550000
*   2 AVTVOLRN    FIXED(31),             /* PRODUCT OF NUMBER OF        81620000
*                                           EXTENTS AND NUMBER OF       81690000
*                                           RECORDS/TRACK            */ 81760000
*   2 AVTHRESN    FIXED(31),             /* ABSOLUTE RECORD NUMBER      81830000
*                                           WHICH IS THE THRESHOLD      81900000
*                                           THAT CAUSES CLOSEDOWN       81970000
*                                           DUE TO FILLING OF THE       82040000
*                                           NON-REUSABLE DISK QUEUE  */ 82110000
*   2 AVTNADDR    FIXED(31),             /* NON-REUSABLE DISK QUEUE  */ 82180000
*   2 AVTRADDR    FIXED(31),             /* REUSABLE DISK QUEUE      */ 82250000
*   2 *           PTR(31),               /* ADDR OF OP CONTROL QCB   */ 82320000
*    3 AVTHRESE    PTR(31),              /* NON-REUSABLE THRESHOLD      82390000
*                                           CLOSEDOWN ELEMENT -         82460000
*                                           THREE WORDS              */ 82530000
*   2 *           PTR(8),                /* PRIORITY (PRIOPCTL + 4)  */ 82600000
*   2 *           PTR(24)  BDY(BYTE),    /* LINK FIELD               */ 82670000
*   2 *           CHAR(1),               /* X'11' - FLUSH CLOSE         82740000
*                                           REQUESTED                */ 82810000
*   2 *           PTR(8),                /* X'0C' - LENGTH OF ELEMENT*/ 82880000
*   2 *           CHAR(1),               /* UNUSED - REL LINE NO     */ 82950000
*   2 AVTHRESS    CHAR(1),               /* COMPLETION CODE - STATUS    83020000
*                                           X'FF' - UNUSED ELEMENT      83090000
*                                           X'F0' - ELEMENT POSTED      83160000
*                                           X'00' OR X'04' - CLOSED  */ 83230000
*   2 AVTCPBNO    FIXED(15);             /* CPB=INTEGER              */ 83300000
*/*                                                          @Y17XAXF*/ 83300700
*/*      ABEND PARAMETER LIST                                @Y17XAXF*/ 83301400
*/*                                                          @Y17XAXF*/ 83302100
*DCL AVTHDRSZ BIT(8) CONSTANT('1E'X);   /* HDR PREFIX SIZE   @Y17XAXU*/ 83370000
*DCL AVTTXTSZ BIT(8) CONSTANT('17'X);   /* TXT PREFIX SIZE   @Y17XAXU*/ 83440000
*DCL AVTCVTPT BIT(8) CONSTANT('F0'X);   /* OFFSET INTO CVT OF ADDRESS   83510000
*                                          OF TCX            @Y17XAXU*/ 83580000
*DCL AVTUMALN BIT(8) CONSTANT('0C'X);   /* LENGTH OF CCW-TIC (UNIT      83650000
*                                          MANAGEMENT AREA   @Y17XAXU*/ 83720000
*DCL AVTDATLN BIT(8) CONSTANT('06'X);   /* NO. OF BYTES IN DATA FIELD   83790000
*                                          OF MESSAGE Q RECD @Y17XAXU*/ 83860000
*DCL AVTMINKY BIT(8) CONSTANT('24'X);   /* MINIMUM KEY LEN   @Y17XAXU*/ 83930000
*DCL AVTMIN05 BIT(8) CONSTANT('2C'X);   /* MIN KEYLENGTH FOR            83950000
*                                          3705 ENVIRONMENT  @YM06968*/ 83970000
*DCL AVTSVSIZ BIT(8) CONSTANT('48'X);   /* SAVE AREA SIZE    @Y17XAXU*/ 84000000
*DCL AVTECD4 BIT(8) CONSTANT('04'X);    /* RETURN CODE OF 4  @Y17XAXU*/ 84070000
*DCL AVTECD8 BIT(8) CONSTANT('08'X);    /* RETURN CODE OF 8  @Y17XAXU*/ 84140000
*DCL AVTECD12 BIT(8) CONSTANT('0C'X);   /* RETURN CODE OF 12 @Y17XAXU*/ 84210000
*DCL AVTECD16 BIT(8) CONSTANT('10'X);   /* RETURN CODE OF 16 @Y17XAXU*/ 84280000
*DCL AVTECD20 BIT(8) CONSTANT('14'X);   /* RETURN CODE OF 20 @Y17XAXU*/ 84350000
*DCL AVTE80 BIT(8) CONSTANT('80'X);     /* SIGN BIT MASK     @Y17XAXU*/ 84420000
*DCL AVTMODBT BIT(8) CONSTANT('80'X);   /* 2ND-23RD BIT MASK @Y17XAXU*/ 84490000
*DCL AVTEZERO BIT(8) CONSTANT('00'X);   /* EQUATED ZERO      @Y17XAXU*/ 84560000
*DCL AVTEBLNK BIT(8) CONSTANT('40'X);   /* BLANK CHAR        @Y17XAXU*/ 84630000
*DCL AVTEPER BIT(8) CONSTANT('4B'X);    /* PERIOD            @Y17XAXU*/ 84700000
*DCL AVTEFF BIT(8) CONSTANT('FF'X);     /* ALL ONES MASK     @Y17XAXU*/ 84770000
*DCL AVTCVTMP BIT(8) CONSTANT('C0'X);   /* OFFSET INTO CVT OF ADDRESS   84840000
*                                          OF MULTIPROC CVT  @Y17XAXU*/ 84910000
*DCL AVTMPTRR BIT(8) CONSTANT('0C'X);   /* OFFSET INTO MP CVT OF        84980000
*                                          TASK REMOVAL RTN  @Y17XAXU*/ 85050000
*                                                                       85120000
*%IF SAVT= 'NO' %THEN                                                   85190000
*   %GOTO SAVTEND;                                                      85260000
*DECLARE                                                                85330000
*  1 IEDNSVTD BASED(AVTSAVTP) ,                                         85400000
*   2 SAVTDIAG    PTR(31),               /* VIRT. DIAGNOSE RTN Y05331*/ 85470000
*    3 SAVTDIAF    CHAR(1),              /* FLAG BYTE          Y05331*/ 85540000
*     4 SAVTVIRT    BIT(1),             /*VIRTUAL ENVIRONMENT  X03039*/ 85610000
*     4 SAVTPRMT BIT(1),               /* PROMPTING REQUESTED  X03039*/ 85680000
*   2 SAVTPOOL PTR(31),                 /*PLCB POOL ADDR       X03039*/ 85750000
*   2 SAVTPLCB PTR(31),                 /*NEXT FREE PLCB       X03039*/ 85820000
*   2 SAVTPUSE FIXED(15),               /* PLCB IN-USE CT    @Y17XAXU*/ 85890000
*   2 SAVTPH20 FIXED(15),               /* PLCB HI WATER CT  @Y17XAXU*/ 85960000
*   2 SAVTPREQ PTR(31),                 /* ADDRESS OF PLCB   @Y17XAXU*/ 86030000
*                                       /* ALLOCATION RTN    @Y17XAXU*/ 86100000
*   2 SAVTPRTQ PTR(31),                 /* ANCHOR FOR PLCB   @Y17XAXU*/ 86170000
*                                       /* REQ WAIT CHAIN    @Y17XAXU*/ 86240000
*   2 SAVTPWT FIXED(15),                /* PLCB WAIT COUNT   @Y17XAXU*/ 86310000
*   2 SAVTWH20 FIXED(15),               /* PLCB HI-WATER     @Y17XAXU*/ 86380000
*                                       /* WAIT COUNT        @Y17XAXU*/ 86450000
*   2 * PTR(31),                        /* ADDRESS OF STCB   @Y17XAXU*/ 86520000
*                                       /* FOR PLCB DEALLOC  @Y17XAXU*/ 86590000
*   2 SAVTPRTN PTR(31),                 /* PLCB DEALLOCATION @Y17XAXU*/ 86660000
*                                       /* RTN ADDRESS       @Y17XAXU*/ 86730000
*   2 SAVTSIB  PTR(31),                 /* ADDR OF NXT FREE  @Y17XAXU*/ 86800000
*                                       /* SIB               @Y17XAXU*/ 86870000
*   2 SAVTSUSE FIXED(15),               /* SIB IN-USE CT     @Y17XAXU*/ 86940000
*   2 SAVTFAIL FIXED(15),               /* COUNT OF SIB REQ  @Y17XAXU*/ 87010000
*                                       /* THAT FAILED       @Y17XAXU*/ 87080000
*   2 SAVTSREQ PTR(31),                 /* ADDR OF SIB       @Y17XAXU*/ 87150000
*                                       /* ALLOCATION RTN    @Y17XAXU*/ 87220000
*   2 SAVTSRTN PTR(31),                 /* ADDRESS OF SIB    @Y17XAXU*/ 87290000
*                                       /* DEALLOCATION RTN  @Y17XAXU*/ 87360000
*   2 SAVTFLDH PTR(31),                 /* 3705 FIRST LEVEL  @Y17XAXU*/ 87430000
*                                       /* DATA HANDLER      @Y17XAXU*/ 87500000
*   2 SAVTCNIR PTR(31),                 /* CONTROL NIR GENR  @Y17XAXU*/ 87570000
*                                       /* QCB ADDRESS       @Y17XAXU*/ 87640000
*   2 SAVTDNIR PTR(31),                 /* DATA NIR GENR QCB @Y17XAXU*/ 87710000
*                                       /* ADDRESS           @Y17XAXU*/ 87780000
*   2 SAVTRNTA PTR(31),                 /* 3705 TRACE RTN    @Y17XAXU*/ 87850000
*                                       /* ADDRESS           @Y17XAXU*/ 87920000
*   2 SAVTPIUT PTR(31),                 /* ADDR OF PIU TRACE @Y17XAXU*/ 87990000
*                                       /* TABLE             @Y17XAXU*/ 88060000
*   2 SAVTCLUP PTR(31),                 /* 3705 CLEANUP RTN  @Y17XAXU*/ 88130000
*                                       /* ADDRESS           @Y17XAXU*/ 88200000
*   2 SAVTNAT  PTR(31),                 /* NAT ADDRESS       @Y17XAXU*/ 88270000
*   2 SAVTSAT  PTR(31),                 /* SAT ADDRESS       @Y17XAXU*/ 88340000
*   2 *        PTR(31),                 /* RESERVED          @Y17XAXF*/ 88410000
*   2 SAVTLUSQ CHAR(12) BDY(WORD),      /* LUS QCB           @Y17XAXU*/ 88550000
*    3 SAVTLUSB PTR(31),                /* BUFFER WAIT CHAIN @Y17XAXU*/ 88620000
*    3 SAVTLUSP PTR(31),                /* PLCB WAIT CHAIN   @Y17XAXU*/ 88690000
*    3 * PTR(31),                       /* STCB POINTER      @Y17XAXU*/ 88760000
*   2 SAVTLUSR PTR(31),                 /* OP-SERV-REQ CHAIN @Y17XAXU*/ 88830000
*   2 SAVTSLCB PTR(31),                 /* SSCP LCB          @Y17XAXU*/ 88900000
*   2 SAVTSCPQ PTR(31),                 /* SSCP OUTBND QCB   @Y17XAXU*/ 88970000
*   2 SAVTSSSR PTR(31),                 /* SERIALIZER CHAIN  @Y17XAXU*/ 89040000
*   2 * PTR(31),                        /* STCB POINTER      @Y17XAXU*/ 89110000
*   2 SAVTXFMO PTR(31),                 /* OUTBND XFORM QCB  @YM03681*/ 89110100
*                                       /* ADDRESS           @YM03681*/ 89110200
*   2 * (2) PTR(31),                    /* RESERVED          @YM03681*/ 89110300
*   2 SAVTXFMI PTR(31),                 /* INBND XFORM       @YM03681*/ 89110400
*                                       /* ENTRY ADDRESS     @YM03681*/ 89110500
*   2 * (2) PTR(31),                    /* RESERVED          @YM03681*/ 89110600
*   2 SAVTIPCQ PTR(31),                 /* PC INBOUND QCB    @Y17XAXU*/ 89600000
*                                       /* ADDRESS           @YM03681*/ 89602000
*   2 * (3) PTR(31),                    /* RESERVED          @Y17XAXF*/ 89604000
*   2 SAVTMVBF PTR(31),                 /* MOVE BFR DATA RTN @Y17XAXU*/ 89880000
*   2 SAVTXTRQ PTR(31),                 /* CROSS TASK REQ HD @Y17XAXU*/ 89950000
*   2 SAVTSCLU PTR(31),                 /* SC ENTRY ADDRESS  @Y17XAXU*/ 90020000
*   2 SAVTSSRQ PTR(31),                 /* SSCP REQ HDLR ADR @Y17XAXU*/ 90090000
*   2 SAVTSSRP PTR(31),                 /* SSCP RES HDLR ADR @Y17XAXU*/ 90160000
*   2 SAVTCSCI PTR(31),                 /* FID1 COM SC INBND @Y17XAXU*/ 90230000
*   2 SAVTSAI PTR(31),                  /* FID0 SA INBOUND   @Y17XAXU*/ 90300000
*   2 SAVTSAC PTR(31),                  /* COMMAND PROCESSOR @Y17XAXU*/ 90370000
*   2 SAVTSARI PTR(31),                 /* COMMAND PROCESSOR @Y17XAXU*/ 90440000
*   2 SAVTSAO PTR(31),                  /* COMMAND ID PROC   @Y17XAXU*/ 90510000
*   2 SAVTDFCO PTR(31),                 /* DFC OUTBOUND      @Y17XAXU*/ 90580000
*   2 SAVTRQIN PTR(31),                 /* INBOUND REQ PROC  @Y17XAXU*/ 90650000
*   2 SAVTQRS PTR(31),                  /* RESPONSE GENERATOR           90720000
*                                          ADDRESS           @Y17XAXU*/ 90790000
*   2 SAVTSSMH PTR(31),                 /* SSCP MH ENTRY ADR @Y17XAXU*/ 90860000
*   2 SAVTMHTB PTR(31),                 /* MH TABLE ADDRESS  @Y17XAXU*/ 90930000
*   2 SAVTNATL FIXED(15),               /* INDEX OF LAST NAT            91000000
*                                          ENTRY             @Y17XAXU*/ 91070000
*   2 SAVTNADL FIXED(15),               /* CONSTANT TO CALCULATE        91140000
*                                          NAT ENTRY FROM MH            91210000
*                                          INDEX             @Y17XAXU*/ 91280000
*   2 SAVTSPLN PTR(31),                 /* 3705 STOPLINE RTN @Y17XAXU*/ 91290000
*                                       /* ADDRESS           @Y17XAXU*/ 91420000
*   2 SAVTMAND PTR(31),                 /* ADDRESS OF MANUAL @Y17XAXU*/ 91490000
*                                       /* DIAL RTN          @Y17XAXU*/ 91560000
*   2 SAVTRQCH PTR(31),                 /* APPL REQUEST      @Y17XAXU*/ 91630000
*                                       /* QUEUE             @Y17XAXU*/ 91700000
*   2 SAVTRQTG FIXED(16),               /* APPL REQUEST TAG  @Y17XAXU*/ 91770000
*   2 SAVTTCPU  FIXED(16),              /* TCAM PU TTCIN     @Y17XAXU*/ 91840000
*    3 SAVTSCPT FIXED(16),              /* SSCP TTCIN        @Y17XAXU*/ 91910000
*   2 SAVTBSM  PTR(31),                 /* BSM ADDRESS       @Y17XAXU*/ 91980000
*   2 SAVTSIBC FIXED(15),               /* SIB COUNT         @Y17XAXU*/ 92050000
*   2 SAVTSUBA PTR(8),                  /* MAX SUBAREA VALUE @Y17XAXU*/ 92120000
*   2 SAVTSUBV PTR(8),                  /* HOST SUBAREA VAL  @Y17XAXU*/ 92190000
*   2 SAVTNAX PTR(31),                  /* NETWORK ADDR TO TTCIN     */ 92260000
*                                       /* CONVERSION RTN    @Y17XAXU*/ 92330000
*   2 SAVTTNTX PTR(31),                 /* TTCIN TO NETWORK ADDR     */ 92400000
*                                       /* CONVERSION RTN    @Y17XAXU*/ 92470000
*   2 SAVTRNMP PTR(31),                 /* INDEX TO TTE/MH E @Y17XAXU*/ 92540000
*                                       /* CONVERSION RTN    @Y17XAXU*/ 92610000
*   2 SAVTLCBS PTR(31),                 /* SA LCB FETCH RTN  @Y17XAXU*/ 92680000
*   2 SAVTSH20 FIXED(15),               /* SIB POOL UTIL. HI-WATER      92750000
*                                          COUNT             @Y17XAXU*/ 92820000
*   2 SAVTNAT1 FIXED(15),               /* TNT INDEX OF      @Y17XAX7*/ 92890000
*                                       /* FIRST NAT ENTRY   @Y17XAXU*/ 92960000
*   2 SAVTMHDX CHAR(2),                 /* TTCIN OF FIRST MH @Y17XAXU*/ 93030000
*                                       /* ENTRY             @Y17XAXU*/ 93100000
*   2 SAVTZELM FIXED(16),               /* NETWORK ADDRESS   @Y17XAXU*/ 93170000
*                                       /* SUBAREA MASK      @Y17XAXU*/ 93240000
*    3 SAVTSUBM FIXED(8),               /* SUBAREA MASK      @Y17XAXU*/ 93310000
*    3 * FIXED(8),                      /* BYTE OF  ZEROS    @Y17XAXU*/ 93380000
*   2 SAVTSUBL PTR(8),                  /* SUBAREA VALUE LEN @Y17XAXU*/ 93480000
*   2 * CHAR(1),                        /* RESERVED          @YM02919*/ 93580000
*   2 SAVTPLSZ FIXED(15),               /* PLCB,SAT,SIB,RVT, AND NAT    93680000
*                                          POOL SIZE         @YM02919*/ 93780000
*   2 SAVTDVAS PTR(31),                 /* DEV ASSOC ROUTINE @Y17XAXU*/ 93880000
*   2 SAVTNID PTR(31),                  /* BSC ID VER ROUTINE           93980000
*                                                            @Y17XAXU*/ 94080000
*   2 SAVTRDRV CHAR(13) BDY(WORD),      /* REDRIVE ELEMENT   @YM03697*/ 94180000
*    3 SAVTRDKY CHAR(1),                /* KEY FIELD         @YM03697*/ 94280000
*    3 SAVTRDQB PTR(24),                /* QCB ADDRESS       @YM03697*/ 94380000
*    3 SAVTRDPY CHAR(1),                /* PRIORITY FIELD    @YM03697*/ 94480000
*    3 * CHAR(7),                       /* RESERVED          @YM03697*/ 94580000
*    3 SAVTRDFG CHAR(1),                /* FLAG FIELD        @YM03697*/ 94680000
*   2 *        CHAR(3),                 /* RESERVED          @Y17XAXF*/ 94780000
*   2 SAVTCKQB CHAR(12) BDY(WORD),      /* 3705 CHECKPOINT QCB          94880000
*                                                            @Y17XAXF*/ 94980000
*    3 SAVTCKTB PTR(31),                /*  QUEUE OF ELEMENTS FOR CKPT  95080000
*                                                            @Y17XAXF*/ 95180000
*     4 SAVTCKVT BIT(8),                /*   VTO FOR ATTACHED TASK      95280000
*                                                            @Y17XAXF*/ 95380000
*     4 SAVTCKCH PTR(24),               /*   CHAIN OF ELEMENTS          95480000
*                                                            @Y17XAXF*/ 95580000
*    3 SAVTCKEC PTR(31),                /*  EVENT CONTROL BLOCK         95680000
*                                                            @Y17XAXF*/ 95780000
*     4 SAVTCKCC BIT(8),                /*   COMPLETION CODE BYTE       95880000
*                                                            @Y17XAXF*/ 95980000
*      5 SAVTCKWA BIT(1),               /*    WAITING FOR COMPLETION    96080000
*                                             OF THE EVENT   @Y17XAXF*/ 96180000
*      5 SAVTCKPO BIT(1),               /*    EVENT HAS COMPLETED       96280000
*                                                            @Y17XAXF*/ 96380000
*      5 *        BIT(6),               /*    RESERVED       @Y17XAXF*/ 96480000
*     4 *        PTR(24),               /*   RESERVED        @Y17XAXF*/ 96580000
*    3 *        PTR(31),                /*  STCB ADDRESS     @Y17XAXF*/ 96680000
*  2 SAVTBITN PTR(31),           /* BIND IMAGE TABLE ADDRESS @OY19488*/ 96780082
*  2 SAVTLLCB PTR(31);           /* POINTER TO LAST PLCB     @OY19488*/ 96810082
* %SAVTSIZE='LENGTH(IEDNSVTD)';         /* SAVT SIZE         @Y17XAXU*/ 96980000
./  ADD  SSI=70060646,NAME=TBDUD
*        %GOTO BDUPLS;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TBDUD                                                          03000010
.*A000000-999999                                               @Y17XAXF 04000010
IEDBDU   DSECT                                                          05000010
*                                                                       06000010
*        DSECT FOR BASIC DEVICE UNIT                                    07000010
*                                                                       08000010
BDUCMND  DS    XL1 .               COMMAND CODE                         09000010
BDUMODIF DS    XL1 .               MODIFIER BYTE                        10000010
BDUFNFLG DS    XL1 .               FUNCTION FLAGS                       11000010
BDUSTHDR EQU   X'80' .                  START OF HEADER                 12000010
BDUHEADR EQU   X'40' .                  HEADER PREFIX                   13000010
BDULEADG EQU   X'20' .                  LEADING GRAPHICS                14000010
BDUFRSTB EQU   X'10' .                  FIRST BLOCK                     15000010
BDUTPTX  EQU   X'08' .                  TRANSPARENT TEXT                16000010
BDUPOSAK EQU   X'04' .                  POSITIVE ACKNOWLEDGEMENT        17000010
BDUNEGAK EQU   X'02' .                  NEGATIVE ACKNOWLEDGEMENT        18000010
BDUALTAK EQU   X'01' .                  ALTERNATE ACKNOWLEDGEMENT       19000010
BDUBDUFG DS    XL1 .               BDU FLAGS                            20000010
BDUXERLK EQU   X'80'               /* RESET ERROR LOCK */               20500010
BDURSP   DS    0XL2  .           SYSTEM AND ERROR RESP         @YM08042 20700010
BDUSYRSP DS    XL1 .               SYSTEM RESPONSE                      21000010
BDUERROR EQU   X'80' .                  ERROR INDICATOR                 22000010
*BDUPHASE      BITS 1-2                 PHASE INDICATOR                 23000010
*BDURESP       BITS 3-7                 STATUS INFORMATION              24000010
BDUEXRSP DS    XL1 .               EXTENDED RESPONSE                    25000010
*BDUXINIT      BITS 0-2                 INITIAL STATUS                  26000010
*BDUXFINL      BITS 3-6                 FINAL STATUS                    27000010
BDUXGRPH EQU   X'01' .                  LEADING GRAPHICS                28000010
BDUEND   EQU   *                        END OF THE BDU HEADER           28300010
BDUTEXT  EQU   *                        BDU TEXT FIELD                  28600010
BDUMBHSC EQU   X'80' .                  CHANGE BH SET ASSOCATION        28700010
BDUMBHSA EQU   X'40' .                  ACTIVATE BH SET ASSOCATION      28800010
BDUMBHSD EQU   X'20' .                  DEACTIVATE BH SET ASSOCATION    28900010
BDULEN   EQU   *-IEDBDU .          BDU LENGTH                           29000010
         MEND                                                           30000010
*                                                                    */ 31000010
*%BDUPLS:;                                                              32000010
*DECLARE                                                                33000010
*  1 IEDBDU  BASED BDY(BYTE),                                           34000010
*/*                                                                  */ 35000010
*/*      DSECT FOR BASIC DEVICE UNIT                                 */ 36000010
*/*                                                                  */ 37000010
*    2 BDUCMND  CHAR(1),                /* COMMAND CODE              */ 38000010
*    2 BDUMODIF CHAR(1),                /* MODIFIER BYTE             */ 39000010
*    2 BDUFNFLG BIT(8),                 /* FUNCTION FLAGS            */ 40000010
*      3 BDUSTHDR BIT(1),               /*   START OF HEADER         */ 41000010
*      3 BDUHEADR BIT(1),               /*   HEADER PREFIX           */ 42000010
*      3 BDULEADG BIT(1),               /*   LEADING GRAPHICS        */ 43000010
*      3 BDUFRSTB BIT(1),               /*   FIRST BLOCK             */ 44000010
*      3 BDUTPTX  BIT(1),               /*   TRANSPARENT TEXT        */ 45000010
*      3 BDUPOSAK BIT(1),               /*   POSITIVE ACKNOWLEDGEMENT*/ 46000010
*      3 BDUNEGAK BIT(1),               /*   NEGATIVE ACKNOWLEDGEMENT*/ 47000010
*      3 BDUALTAK BIT(1),               /*   ALTERNATE ACKNOWLEDGEMNT*/ 48000010
*    2 BDUBDUFG BIT(8),                 /* BDU FLAGS                 */ 49000010
*      3 BDUXERLK BIT(1),               /* RESET ERROR LOCK */          49500010
*    2 BDURSP BIT(16),                  /* SYS & ERROR RESP  @YMO8042*/ 49700010
*      3 BDUSYRSP BIT(8),               /* SYSTEM RESPONSE   @YM08042*/ 50000010
*        4 BDUERROR BIT(1),             /*   ERROR INDICATOR @YM08042*/ 50900010
*        4 BDUPHASE BIT(2),             /*   PHASE INDICATOR @YM08042*/ 51800010
*        4 BDURESP  BIT(5),             /*   STATUS INFO     @YM08042*/ 52700010
*      3 BDUEXRSP CHAR(1),              /* EXTENDED RESPONSE @YM08042*/ 53600010
*        4 BDUXINIT BIT(3),             /*   INITIAL STATUS  @YM08042*/ 54500010
*        4 BDUXFINL BIT(4),             /*   FINAL STATUS    @YM08042*/ 55400010
*        4 BDUXGRPH BIT(1),             /*   LEAD GRAPHICS   @YM08042*/ 56300010
*    2 BDUEND CHAR(0);                  /* END OF THE BDU HEADER     */ 57300010
* DCL BDUTEXT CHAR(*) DEF(BDUEND);      /* BDU TEXT FIELD            */ 57600010
*/* BDUTEXT VALUES                                                   */ 57650010
* DCL BDUMBHSC BIT(8) CONSTANT('80'X);  /* CHANGE BH SET ASSOCIATION */ 57700010
* DCL BDUMBHSA BIT(8) CONSTANT('40'X);  /* ACTIVATE BH SET              57750010
*                                          ASSOCATION                */ 57800010
* DCL BDUMBHSD BIT(8) CONSTANT('20'X);  /* DEACTIVATE BH SET            57850010
*                                          ASSOCATION                */ 57900010
* %BDULEN='LENGTH(IEDBDU)';             /* BDU LENGTH                */ 58000010
./  ADD  SSI=70250034,NAME=TBINDD
*        %GOTO BINDPLS;                 /* BILINGUAL HEADER             00900010
         MACRO                                                          01800010
         TBINDD                                                         02700010
.*A000000-999999                                               @Y17XAXF 03600010
IEDBIN   DSECT                                                          04500010
*                                                                       05400010
*        DSECT FOR ENTRY WITHIN BIND IMAGE TABLE                        06300010
*                                                                       07200010
BINNAME  DS    CL8 .               NAME OF ENTRY                        08100010
BINLEN   DS    XL2 .               LENGTH OF BIND IMAGE                 09000010
BINIMAGE EQU   * .                 START OF BIND IMAGE                  09900010
BINBLEN  EQU   *-IEDBIN            LENGTH OF ENTRY WITHOUT BIND IMAGE   10800010
         MEND  */                                                       11200010
*%BINDPLS:;                                                             11700010
*DECLARE                                                                48600010
*  1 IEDBIN   BASED(RBIN),                                              49500010
*/*                                                                  */ 50400010
*/*      DSECT FOR ENTRY WITHIN BIND IMAGE TABLE                     */ 51300010
*/*                                                                  */ 52200010
*    2 BINNAME  CHAR(8),                /* NAME OF ENTRY             */ 53100010
*    2 BINLEN   FIXED(16),              /* LENGTH OF BIND IMAGE      */ 54000010
*    2 BINIMAGE CHAR(0);                /* START OF BIND IMAGE       */ 54900010
* %BINBLEN='LENGTH(IEDBIN)';            /* LENGTH OF BIND ENTRY WITHOUT 55200010
*                                          BIND IMAGE                */ 55500010
*/*                                                          @YM07701*/ 57500010
*DECLARE                                                   /*@YM07701*/ 59500010
*  1 BINBUD   BASED,                                       /*@YM07701*/ 61500010
*/*                                                          @YM07701*/ 63500010
*/*      DSECT FOR BIND IMAGE USER DATA                      @YM07701*/ 65500010
*/*                                                          @YM07701*/ 67500010
*    2 BINUDATL FIXED(8),               /* USER DATA LENGTH  @YM07701*/ 69500010
*    2 BINUDAT  CHAR(0);                /* USER DATA         @YM07701*/ 71500010
*/*                                                          @YM07701*/ 73500010
*DECLARE                                                   /*@YM07701*/ 75500010
*  1 BINBLD   BASED,                                       /*@YM07701*/ 77500010
*/*                                                          @YM07701*/ 79500010
*/*      DSECT FOR MH LOGON PREFIX DATA                      @YM07701*/ 81500010
*/*                                                          @YM07701*/ 83500010
*    2 BINLDATL FIXED(8),               /* LOGON PREFIX LEN  @YM07701*/ 85500010
*    2 BINLDAT  CHAR(0);                /* LOGON DATA        @YM07701*/ 87500010
./  ADD  SSI=70110498,NAME=TBNDD
*        %GOTO BNDPLS;                  /* BILINGUAL HEADER             00600010
         MACRO                                                          01200010
         TBNDD                                                          02400010
.*A000000-999999                                               @Y17XAXF 03000010
IEDBNDD  DSECT                                                          04200010
*                                                                       04800010
*        BIND IMAGE DSECT                                               06000010
*                                                                       06600010
BNDRUCDE DS    XL1 .               ALWAYS X'31'                         07800010
BNDFORMT DS    XL1 .               FORMAT/TYPE                          08100010
BNDFMPRF DS    XL1 .               FM PROFILE                           08400010
BNDTSPRF DS    XL1 .               TS PROFILE                           09600010
BNDPRIM  DS    XL1 .               PRIMARY LU PROTOCOLS FOR FM DATA     10200010
BNDPCHN  EQU   X'80' .                  CHAINING USE                    11400010
BNDPRQM  EQU   X'40' .                  REQUEST MODE SELECTION          12000010
BNDPDEF  EQU   X'20' .                  DEFINITE RESPONSE               13200010
BNDPEXC  EQU   X'10' .                  EXCEPTION RESPONSE              13800010
*        EQU   X'08' .                  RESERVED                        15000010
*        EQU   X'04' .                  RESERVED                        15600010
BNDPCMP  EQU   X'02' .                  COMPRESSION INDICATOR           16800010
BNDPEBI  EQU   X'01' .                  EB INDICATOR                    17400010
BNDSECD  DS    XL1 .               SECONDARY LU PROTOCOLS FOR FM DATA   18600010
BNDSCHN  EQU   X'80' .                  CHAINING USE                    19200010
BNDSRQM  EQU   X'40' .                  REQUEST MODE SELECTION          20400010
BNDSDEF  EQU   X'20' .                  DEFINITE RESPONSE               21000010
BNDSEXC  EQU   X'10' .                  EXCEPTION RESPONSE              22200010
*        EQU   X'08' .                  RESERVED                        22800010
*        EQU   X'04' .                  RESERVED                        24000010
BNDSCMP  EQU   X'02' .                  COMPRESSION INDICATOR           24600010
BNDSEBI  EQU   X'01' .                  EB INDICATOR                    25800010
BNDCOMMI DS    XL1 .               COMMON LU PROTOCOLS (1ST BYTE)       26400010
*        EQU   X'80' .                  RESERVED                        27600010
BNDFMUSE EQU   X'40' .                  FM HEADER USAGE                 28200010
BNDBRACK EQU   X'20' .                  BRACKETS                        29400010
BNDBTERM EQU   X'10' .                  BRACKET TERMINATION RULES       30000010
BNDALT   EQU   X'08' .                  ALTERNATE CODE                  31200010
*        EQU   X'04' .                  RESERVED                        31800010
*        EQU   X'02' .                  RESERVED                        33000010
*        EQU   X'01' .                  RESERVED                        33600010
BNDCOMM2 DS    XL1 .               COMMON LU PROTOCOLS (2ND BYTE)       34800010
*BNDFMODE BITS 0-1 .                    FM TRANSACTION MODE             35400010
BNDHDX   EQU   X'40' .                       HDX CONTENTION             36600010
BNDHDXFF EQU   X'80' .                       HDX FLIP-FLOP              37200010
BNDMSLVE EQU   X'C0' .                       MASTER SLAVE               38400010
BNDRECOV EQU   X'20' .                  RECOVERY RESPONSIBILITY         39000010
BNDSPKR  EQU   X'10' .                  BCKTS FIRSTSPKR                 40200010
*        EQU   X'08' .                  RESERVED                        40800010
*        EQU   X'04' .                  RESERVED                        42000010
*        EQU   X'02' .                  RESERVED                        42600010
BNDCRES  EQU   X'01' .                  CONTENTION RESOLUTION           43800010
BNDSSPC  DS    XL1 .               SEC SEND PACING COUNT                43810010
BNDSRPC  DS    XL1 .               SEC RECEIVE PACING COUNT             43820010
BNDSMSRU DS    XL1 .               SLU MAX SEND RU SIZE                 43830010
BNDNMAX  EQU   X'80' .                  NO MAX SPECIFIED                43840010
*        EQU   X'40'-X'01' .            RESERVED                        43850010
BNDPMSRU DS    XL1 .               PLU MAX SEND RU SIZE                 43860010
BNDNMAXP EQU   X'80' .                  NO MAX SPECIFIED                43870010
*        EQU   X'40'-X'01' .            RESERVED                        43880010
BNDPSPC  DS    XL1 .               PRI SEND PACING COUNT                43890010
         DS    XL1 .               RESERVED                             43900010
BNDLUPFL DS    XL1 .               LU PROFILE                           43910010
BNDPSF   EQU   X'80' .                  PRESENTATION SERVICES FORMAT    43920010
*BNDLUTYP EQU  X'40'-X'01' .            LU TYPE                         43930010
BNDLU0   EQU   X'00'                     LU TYPE 0                      43940010
BNDLU1   EQU   X'01'                     LU TYPE 1                      43950010
BNDLU2   EQU   X'02'                     LU TYPE 2                      43960010
BNDPSCH  DS    0CL10 .             PRESENTATION SERVICE CHARACTERISTICS 43970010
         DS    CL9 .                    RESERVED                        43972010
BNDSCSZE DS    CL1 .                    SCREEN SIZE                     43974010
         DS    CL1 .               RESERVED                    @YM07298 43975010
BND12X40 EQU   X'01' .                   12 X 40 SIZE                   43976010
BND24X80 EQU   X'02' .                   24 X 80 SIZE                   43978010
BNDCRYP  DS    XL1 .               ALWAYS X'00'                         43980010
BNDPLUNL DS    XL1 .               LENGTH OF LU NAME (ALWAYS X'08')     43990010
BNDPLUN  DS    CL8 .               PRIMARY LU NAME                      44000010
BNDUDFL  DS    XL1 .               USER DATA FIELD LENGTH               44010010
BNDUSD   EQU   * .                 USER DATA FIELD                      44020010
BNDBLEN  EQU   *-IEDBNDD .         LENGTH OF BIND IMAGE WITHOUT USER    44130010
*                                       DATA                            44830010
         MEND                                                           45600010
*        */                                                             46200010
*%BNDPLS:;                                                              47400010
*DECLARE                                                                48000010
*  1 IEDBNDD  BASED(RBND),                                              49200010
*/*                                                                  */ 49800010
*/*      BIND IMAGE DSECT                                            */ 51000010
*/*                                                                  */ 51600010
*    2 BNDRUCDE BIT(8),                 /* ALWAYS X'31'              */ 52800010
*    2 BNDFORMT BIT(8),                 /* FORMAT/TYPE               */ 53100010
*    2 BNDFMPRF FIXED(8),               /* FM PROFILE                */ 53400010
*    2 BNDTSPRF FIXED(8),               /* TS PROFILE                */ 54600010
*    2 BNDPRIM  BIT(8),                 /* PRIMARY LU PROTOCOLS      */ 55200010
*      3 BNDPCHN BIT(1),                /*   CHAINING USE            */ 56400010
*      3 BNDPRQM BIT(1),                /*   REQUEST MODE SELECTION  */ 57000010
*      3 BNDPDEF BIT(1),                /*   DEFINITE RESPONSE       */ 58200010
*      3 BNDPEXC BIT(1),                /*   EXCEPTION RESPONSE      */ 58800010
*      3 *       BIT(1),                /*   RESERVED                */ 60000010
*      3 *       BIT(1),                /*   RESERVED                */ 60600010
*      3 BNDPCMP BIT(1),                /*   COMPRESSION INDICATOR   */ 61800010
*      3 BNDPEBI BIT(1),                /*   EB INDICATOR            */ 62400010
*    2 BNDSECD  BIT(8),                 /* SECONDARY LU PROTOCOLS    */ 63600010
*      3 BNDSCHN BIT(1),                /*   CHAINING USE            */ 64200010
*      3 BNDSRQM BIT(1),                /*   REQUEST MODE SELECTION  */ 65400010
*      3 BNDSDEF BIT(1),                /*   EXCEPTION RESPONSE      */ 66000010
*      3 BNDSEXC BIT(1),                /*   DEFINITE RESPONSE       */ 67200010
*      3 *       BIT(1),                /*   RESERVED                */ 67800010
*      3 *       BIT(1),                /*   RESERVED                */ 69000010
*      3 BNDSCMP BIT(1),                /*   COMPRESSION INDICATOR   */ 69600010
*      3 BNDSEBI BIT(1),                /*   EB INDICATOR            */ 70800010
*    2 BNDCOMM1 BIT(8),                 /* COMMON LU PROTOCOLS BYTE 1*/ 71400010
*      3 *       BIT(1),                /*   RESERVED                */ 72600010
*      3 BNDFMUSE BIT(1),               /*   FM HEADER USAGE         */ 73200010
*      3 BNDBRACK BIT(1),               /*   BRACKETS                */ 74400010
*      3 BNDBTERM BIT(1),               /*   BRACKET TERMINATION RULE*/ 75000010
*      3 BNDALT   BIT(1),               /*   ALTERNATE CODE          */ 76200010
*      3 *        BIT(1),               /*   RESERVED                */ 76800010
*      3 *        BIT(1),               /*   RESERVED                */ 78000010
*      3 *        BIT(1),               /*   RESERVED                */ 78600010
*    2 BNDCOMM2 BIT(8),                 /* COMMON LU PROTOCOLS BYTE 2*/ 79800010
*      3 BNDFMODE BIT(2),               /*   FM TRANSACTION MODE     */ 80400010
*      3 BNDRECOV BIT(1),               /*   RECOVERY RESPONSIBILITY */ 81600010
*      3 BNDSPKR  BIT(1),               /*   BCKTS FIRST SPKR        */ 82200010
*      3 *        BIT(1),               /*   RESERVED                */ 83400010
*      3 *        BIT(1),               /*   RESERVED                */ 84000010
*      3 *        BIT(1),               /*   RESERVED                */ 85200010
*      3 BNDCRES  BIT(1),               /*   CONTENTION RESOLUTION   */ 85800010
*    2 BNDSSPC  FIXED(8),               /* SEC SEND PACING COUNT     */ 85820010
*    2 BNDSRPC  FIXED(8),               /* SEC RECEIVE PACING COUNT  */ 85840010
*    2 BNDSMSRU FIXED(8),               /* SLU MAX SEND RU SIZE      */ 85860010
*     3 BNDNMAX  BIT(1),                /*  NO MAX SPECIFIED         */ 85880010
*     3 *        BIT(7),                /*  RESERVED                 */ 85900010
*    2 BNDPMSRU FIXED(8),               /* PLU MAX SEND RU SIZE      */ 85920010
*     3 BNDNMAXP BIT(1),                /*  NO MAX SPECIFIED         */ 85940010
*     3 *        BIT(7),                /*  RESERVED                 */ 85960010
*    2 BNDPSPC  FIXED(8),               /* PRI SEND PACING COUNT     */ 85980010
*    2 *        CHAR(1),                /* RESERVED                  */ 86000010
*    2 BNDLUPFL FIXED(8),               /* LU PROFILE                */ 86020010
*     3 BNDPSF   BIT(1),                /*  PRESENTATION SERVICE FORMAT 86040010
*                                                                    */ 86060010
*     3 BNDLUTYP BIT(7),                /* LU TYPE                   */ 86080010
*    2 BNDPSCH  CHAR(10),               /* PRESERNTATION SERVICE        86100010
*                                          CHARACTERISTICS           */ 86120010
*     3 *        CHAR(9),               /*  RESERVED                 */ 86140010
*     3 BNDSCSZE CHAR(1),               /*  SCREEN SIZE              */ 86146010
*    2 *        CHAR(1),                /* RESERVED          @YM07298*/ 86149010
*    2 BNDCRYP  FIXED(8),               /* ALWAYS X'00'              */ 86152010
*    2 BNDPLUNL FIXED(8),               /* LENGTH OF PRIMARY LU NAME    86160010
*                                          (ALWAYS X'08')            */ 86180010
*    2 BNDPLUN  CHAR(8),                /* PRIMARY LU NAME           */ 86200010
*    2 BNDUDFL  FIXED(8),               /* USER DATA FIELD LENGTH    */ 86220010
*    2 BNDUSD   CHAR(0);                /* USER DATA FIELD           */ 86240010
* %BNDLEN='LENGTH(IEDBNDD)';            /* LENGTH OF BIND ENTRY      */ 86450010
* %BNDBLEN='LENGTH(IEDBNDD)';           /* LEN OF BIND ENTRY @YM07701*/ 86950010
*/*BNDSCSZE VLAUES                                                   */ 87450010
* DCL BND12X40 BIT(8) CONSTANT('01'X);  /* 12 X 40 SIZE              */ 87750010
* DCL BND24X80 BIT(8) CONSTANT('02'X);  /* 24 X 80 SIZE              */ 88050010
*/*BNDFMODE VLAUES                                                   */ 88350010
* DCL BNDHDX   BIT(2) CONSTANT('01'B);  /* HDX CONTENTION            */ 89000010
* DCL BNDHDXFF BIT(2) CONSTANT('10'B);  /* HDX FLIP-FLOP             */ 89200010
* DCL BNDMSLVE BIT(2) CONSTANT('11'B);  /* MASTER SLAVE              */ 89400010
*/*BNDLUTYP VALUES                                                   */ 89600010
* DCL BNDLU0   BIT(7) CONSTANT('0000000'B);  /* LU TYPE 0            */ 89800010
* DCL BNDLU1   BIT(7) CONSTANT('0000001'B);  /* LU TYPE 1            */ 90000010
* DCL BNDLU2   BIT(7) CONSTANT('0000010'B);  /* LU TYPE 2            */ 90200010
./  ADD  SSI=80800542,NAME=TCAVTD
*        %GOTO PLSTCAVT;                /*                              00000100
         MACRO                                                          00000200
         TCAVTD &DSECT=YES                                              00000300
.*A000000-999999                                               @Y17XAXF 00000400
.*C000005-000067 (RESEQUENCE MODULE TO INSERT FIX)             @OZ31115 00000582
         AIF   ('&DSECT' EQ 'NO').NODSECT                               01000582
IEDQCKAD DSECT                                                          02000582
         AGO   .GENFLD                                                  03000582
.NODSECT ANOP                                                           04000582
IEDQCKAD DS    0D                                                       05000582
.GENFLD  ANOP                                                           06000582
*                                                                       07000582
*        CHECKPOINT/RESTART ADDRESS VECTOR TABLE                        08000582
*                                                                       09000582
CAVTTCWA DS    A                        ADDRESS OF TCAM CHECKPOINT      10000582
*                                       WORKAREA                        11000582
CAVTNWA  DS    A                        WORKAREA FOR 3705               12000582
*                                       CHECKPOINT/RESTART              13000582
CAVTWTG  DS    XL1                      WHERE TO GO AFTER A 3705        14000582
*                                       CHECKPOINT I/O                  15000582
CAVTFLGS DS    XL1                      CHECKPOINT/RESTART FLAGS        16000582
CAVTRSV1 DS    XL2                      RESERVED                        17000582
CAVTWL1  DS    0CL16                    WAIT LIST WITH TCAM WITH OR     18000582
*                                       WITHOUT 3705 CHECKPOINT         19000582
CAVTTQE  DS    A                        ECB FOR TCAM CKPT QUEUE         20000582
CAVTEOL1 DS    XL1                      END OF LIST - TCAM CKPT ONLY    21000582
CAVTTIOE DS    AL3                      ECB FOR TCAM CKPT I/O           22000582
CAVTWL2  DS    0CL8                     WAIT LIST WITH ONLY 3705 CKPT   23000582
CAVTEOL2 DS    XL1                      END OF LIST - NO 3705 CKPT I/O  24000582
*                                       STARTED                         25000582
CAVTNQE  DS    AL3                      ECB FOR 3705 CKPT QUEUE         26000582
CAVTEOL3 DS    XL1                      END OF LIST - 3705 CKPT I/O     27000582
*                                       STARTED                         28000582
CAVTNIOE DS    AL3                      ECB FOR 3705 CKPT I/O           29000582
CAVTCRIO DS    A .                      ADDRESS OF 3705 CHECKPOINT/     30000582
*                                        RESTART I/O ROUTINE            31000582
CAVTCKTR DS    XL2                      TCAM CKPT TRACE OFFSET @OZ31115 32000582
CAVTNTR  DS    XL2                      3705 CKPT TRACE OFFSET @OZ31115 33000582
CAVTSIZE EQU   *-IEDQCKAD               SIZE OF CHECKPOINT AVT          34000582
         MEND  */                                                       35000582
*%PLSTCAVT : ;                                                          36000582
* DECLARE                                                               37000582
* 1 IEDQCKAD BDY(DWORD) BASED(RCAVT),                                   38000582
*/*                                                                  */ 39000582
*/*      CHECKPOINT/RESTART ADDRESS VECTOR TABLE                     */ 40000582
*/*                                                                  */ 41000582
*  2 CAVTTCWA PTR(31),                  /* ADDRESS OF TCAM CHECKPOINT   42000582
*                                          WORKAREA                  */ 43000582
*  2 CAVTNWA  PTR(31),                  /* WORKAREA FOR 3705            44000582
*                                          CHECKPOINT/RESTART        */ 45000582
*  2 CAVTWTG  BIT(8),                   /* WHERE TO GO AFTER A 3705     46000582
*                                          CHECKPOINT I/O            */ 47000582
*  2 CAVTFLGS BIT(8),                   /* CHECKPOINT/RESTART FLAGS  */ 48000582
*  2 *        CHAR(2),                  /* RESERVED                  */ 49000582
*  2 CAVTWL1,                           /* WAIT LIST WITH TCAM WITH OR  50000582
*                                          WITHOUT 3705 CHECKPOINT   */ 51000582
*   3 CAVTTQE  PTR(31),                 /* ECB FOR TCAM CKPT QUEUE   */ 52000582
*   3 CAVTEOL1 BIT(8),                  /* EOL - TCAM CKPT ONLY      */ 53000582
*   3 CAVTTIOE PTR(24),                 /* ECB FOR TCAM CKPT I/O     */ 54000582
*   3 CAVTWL2,                          /* WAIT LIST WITH ONLY          55000582
*                                          3705 CHPT                 */ 56000582
*    4 CAVTEOL2 BIT(8),                 /* EOL - NO 3705 CKPT I/O       57000582
*                                          STARTED                   */ 58000582
*    4 CAVTNQE  PTR(24),                /* ECB FOR 3705 CKPT QUEUE   */ 59000582
*    4 CAVTEOL3 BIT(8),                 /* END OF LIST - 3705 CKPT I/O  60000582
*                                          STARTED                   */ 61000582
*    4 CAVTNIOE PTR(24),                /* ECB FOR 3705 CKPT I/O     */ 62000582
*  2 CAVTCRIO PTR(31);                  /* ADDRESS OF 3705 CHECKPOINT   63000582
*                                          /RESTART I/O ROUTINE      */ 64000582
*  2 CAVTCKTR FIXED(16);                /* OFFSET TO TCAM CHECKPOINT    65000582
*                                          TRACE TABLE       @OZ31115*/ 66000582
*  2 CAVTNTR FIXED(16);                 /* OFFSET TO 3705 CHECKPOINT    67000582
*                                          TRACE TABLE       @OZ31115*/ 68000582
*%CAVTSIZE='LENGTH(IEDQCKAD)';          /* SIZE OF CHECKPOINT AVT    */ 69000582
./  ADD  SSI=62430472,NAME=TCCWD
*        %GOTO CCWPLS;                  /* BILINGUAL HEADER             00900010
         MACRO                                                          01800010
         TCCWD                                                          02700010
.*A000000-999999                                               @X02X5X0 03600010
.*A060000,360000                                                 S99228 04500010
.*C070000                                                        X02004 05400010
.*A377000,565000-570000                                          X02004 06300010
.*A377000,660000                                               @Y17XAXF 07200010
.*C070000                                                      @Y17XAXF 08100010
IEDQCCW  DSECT                                                          09000010
*                                                              @Y17XAXF 09900010
*        CCW DSECT, TCAM 10, 03-04-76                          @Y17XAXF 10800010
*                                                              @Y17XAXF 11700010
CCW      EQU   IEDQCCW                                                  12600010
CCWOPCDE DS    XL1 .                    COMMAND CODE                    13500010
*        C O M M A N D   C O D E S                                      14400010
CCWPOLL  EQU   X'09' .                  POLL (AUTOPOLL)                 15300010
CCWSENSE EQU   X'04' .                  SENSE                           16200010
CCWIPL   EQU   X'05' .                  IPL A 3705             @Y17XAXF 17100010
CCWPREP  EQU   X'06' .                  PREPARE                         18000010
CCWINHIB EQU   X'0A' .                  READ INHIBIT                    18900010
CCWTIC   EQU   X'08' .                  TIC                             19800010
CCWWRITE EQU   X'01' .                  WRITE                           20700010
CCWREAD  EQU   X'02' .                  READ                            21600010
CCWDIAL  EQU   X'29' .                  DIAL                            22500010
CCWDISAB EQU   X'2F' .                  DISABLE                         23400010
CCWENAB  EQU   X'27' .                  ENABLE                          24300010
CCWBREAK EQU   X'0D' .                  BREAK                           25200010
CCWNOP   EQU   X'03' .                 NO -OP COMMAND                   26100010
CCWSEL   EQU   X'0B'                    3270 SELECT              S99228 27000010
CCWRDM   EQU   X'06'                    3270 READ MODIFIED       S99228 27900010
CCWEAU   EQU   X'0F'                    3270 EAU COMMAND         S99228 28800010
CCWREAL  EQU   X'80'                    REAL TIC INDICATOR FLAG  X02004 29700010
CCWBRK   EQU   X'09' .                  3705 WRITE BREAK       @Y17XAXF 30600010
CCWWS0   EQU   X'31' .                  WRITE START ZERO       @Y17XAXF 31500010
CCWWS1   EQU   X'51' .                  WRITE START ONE        @Y17XAXF 32400010
CCWRS0   EQU   X'32' .                  READ START ZERO        @Y17XAXF 33300010
CCWRS1   EQU   X'52' .                  READ START ONE         @Y17XAXF 34200010
CCWTICR  EQU   X'88' .                  DATA ADDR & TIC ADDR INITIAL    34500010
*                                                              @Y17XAXF 34800010
CCWRRS   EQU   X'93' .                  RESTART RESET          @Y17XAXF 35100010
*                                                                       36000010
CCWADDR  DS    AL3 .                    DATA ADDRESS                    36900010
*                                                                       37800010
CCWFLAGS DS    XL1 .                    CCW FLAGS                       38700010
*        C C W   F L A G S                                              39600010
CCWCD    EQU   X'80' .                  CHAIN DATA                      40500010
CCWCC    EQU   X'40' .                  COMMAND CHAIN                   41400010
CCWSLI   EQU   X'20' .                  SUPPRESS INCORRECT LENGTH       42300010
CCWSKIP  EQU   X'10' .                  SKIP                            43200010
CCWPCI   EQU   X'08' .                  PCI                             44100010
CCWIDA   EQU   X'04'                    INDIRECT ADDRESS LIST    X02004 45000010
*                                       IS PRESENT               X02004 45900010
*                                                                       46800010
         DS    XL1 .                    UNUSED BYTE OF CCW              47700010
*                                                                       48600010
CCWCOUNT DS    XL2 .                    BYTE COUNT  (DATA TRANSFER)     49500010
CCWLEN   EQU   *-IEDQCCW                CCW LENGTH             @Y17XAXF 49700010
         MEND                                                           49900010
*        */                                                             51300010
*%CCWPLS:;                          /*                       @Y17XAXF*/ 52200010
*/*                                                          @Y17XAXF*/ 53100010
*/*      CCW STRUCTURE, TCAM 10, 03-04-76                    @Y17XAXF*/ 54000010
*/*                                                          @Y17XAXF*/ 54900010
*DECLARE                            /*                       @Y17XAXF*/ 55800010
*  1 IEDQCCW BASED,                 /* CCW                   @Y17XAXF*/ 56700010
*    2 CCW      CHAR(8),            /* CCW                   @Y17XAXF*/ 57600010
*      3 CCWOPCDE BIT(8),           /* COMMAND CODE          @Y17XAXF*/ 58500010
*      3 CCWADDR  PTR(24) BDY(BYTE), /* DATA ADDRESS         @Y17XAXF*/ 59400010
*      3 CCWFLAGS BIT(8),           /* CCW FLAGS             @Y17XAXF*/ 60300010
*        4 CCWCD   BIT(1),          /* CHAIN DATA            @Y17XAXF*/ 61200010
*        4 CCWCC   BIT(1),          /* COMMAND CHAIN         @Y17XAXF*/ 62100010
*        4 CCWSLI  BIT(1),          /* SUPPRESS INCORRECT    @Y17XAXF*/ 63000010
*                                   /* LENGTH                @Y17XAXF*/ 63900010
*        4 CCWSKIP BIT(1),          /* SKIP                  @Y17XAXF*/ 64800010
*        4 CCWPCI  BIT(1),          /* PCI                   @Y17XAXF*/ 65700010
*        4 CCWIDA  BIT(1),          /* INDIRECT ADDRESS LIST @Y17XAXF*/ 66600010
*                                   /* IS PRESENT            @Y17XAXF*/ 67500010
*        4 *       BIT(2),          /* RESERVED              @Y17XAXF*/ 68400010
*      3 CCWRSV   BIT(8),           /* UNUSED                @Y17XAXF*/ 69300010
*      3 CCWCOUNT FIXED(15) BDY(BYTE); /* BYTE COUNT         @Y17XAXF*/ 70200010
*%CCWLEN='LENGTH(IEDQCCW)';         /* LENGTH OF CCW         @Y17XAXF*/ 71100010
*/*      CCWOPCDE COMMAND CODES                              @Y17XAXF*/ 72000010
* DCL CCWPOLL  BIT(8) CONSTANT('09'X);/* POLL (AUTOPOLL)     @Y17XAXF*/ 72900010
* DCL CCWSENSE BIT(8) CONSTANT('04'X);/* SENSE               @Y17XAXF*/ 73800010
* DCL CCWIPL   BIT(8) CONSTANT('05'X);/* IPL A 3705          @Y17XAXF*/ 74700010
* DCL CCWPREP  BIT(8) CONSTANT('06'X);/* PREPARE             @Y17XAXF*/ 75600010
* DCL CCWINHIB BIT(8) CONSTANT('0A'X);/* READ INHIBIT        @Y17XAXF*/ 76500010
* DCL CCWTIC   BIT(8) CONSTANT('08'X);/* TIC                 @Y17XAXF*/ 77400010
* DCL CCWWRITE BIT(8) CONSTANT('01'X);/* WRITE               @Y17XAXF*/ 78300010
* DCL CCWREAD  BIT(8) CONSTANT('02'X);/* READ                @Y17XAXF*/ 79200010
* DCL CCWDIAL  BIT(8) CONSTANT('29'X);/* DIAL                @Y17XAXF*/ 80100010
* DCL CCWDISAB BIT(8) CONSTANT('2F'X);/* DISABLE             @Y17XAXF*/ 81000010
* DCL CCWENAB  BIT(8) CONSTANT('27'X);/* ENABLE              @Y17XAXF*/ 81900010
* DCL CCWBREAK BIT(8) CONSTANT('0D'X);/* BREAK               @Y17XAXF*/ 82800010
* DCL CCWNOP   BIT(8) CONSTANT('03'X);/* NO-OP COMMAND       @Y17XAXF*/ 83700010
* DCL CCWSEL   BIT(8) CONSTANT('0B'X);/* 3270 SELECT         @Y17XAXF*/ 84600010
* DCL CCWRDM   BIT(8) CONSTANT('06'X);/* 3270 READ MODIFIED  @Y17XAXF*/ 85500010
* DCL CCWEAU   BIT(8) CONSTANT('0F'X);/* 3270 EAU COMMAND    @Y17XAXF*/ 86400010
* DCL CCWREAL  BIT(8) CONSTANT('80'X);/* REAL TIC INDICATOR  @Y17XAXF*/ 87300010
*                                     /* FLAG                @Y17XAXF*/ 88200010
* DCL CCWBRK   BIT(8) CONSTANT('09'X);/* 3705 WRITE BREAK    @Y17XAXF*/ 89100010
* DCL CCWWS0   BIT(8) CONSTANT('31'X);/* WRITE START ZERO    @Y17XAXF*/ 90000010
* DCL CCWWS1   BIT(8) CONSTANT('51'X);/* WRITE START ONE     @Y17XAXF*/ 90900010
* DCL CCWRS0   BIT(8) CONSTANT('32'X);/* READ START ZERO     @Y17XAXF*/ 91800010
* DCL CCWRS1   BIT(8) CONSTANT('52'X);/* READ START ONE      @Y17XAXF*/ 92700010
* DCL CCWTICR  BIT(8) CONSTANT('88'X);/* DATA ADDR & TIC ADDR INITIAL   93000010
*                                                            @Y17XAXF*/ 93300010
* DCL CCWRRS   BIT(8) CONSTANT('93'X);/* RESTART RESET       @Y17XAXF*/ 93600010
./  ADD  SSI=61570082,NAME=TCD0D
*        %GOTO CD0PLS;            /* BILINGUAL HEADER                   00300010
         MACRO                                                          00600010
         TCD0D                                                          00900010
.*A000000-999999                                               @Y17XAXF 01200010
*                                                                       01500010
*        FID0 COMMAND CODES                                             01800010
*                                                                       02100010
         SPACE                                                          02400010
CD0READ  EQU   X'01' .             READ COMMANDS                        02700010
*                                                                       03000010
*        READ MODIFIERS                                                 03300010
*                                                                       03600010
CD0R     EQU   X'00' .                  READ NORMAL                     03900010
CD0RB    EQU   X'01' .                  READ BLOCK                      04200010
CD0RM    EQU   X'02' .                  READ MESSAGE                    04500010
CD0RT    EQU   X'03' .                  READ TRANSMISSION               04800010
CD0RD    EQU   X'04' .                  READ TRANSMISSION DISCONNECT    05100010
CD0RI    EQU   X'05'                    READ WITH INVITE                05400010
         SPACE                                                          05700010
CD0WRT   EQU   X'02' .             WRITE COMMAND                        06000010
*                                                                       06300010
*        WRITE MODIFIERS                                                06600010
*                                                                       06900010
CD02     EQU   X'00' .                  WRITE NORMAL                    07200010
CD0WM    EQU   X'01' .                  WRITE WITH EOM                  07500010
CD0WT    EQU   X'02' .                  WRITE WITH EOT                  07800010
CD0WD    EQU   X'03' .                  WRITE WITH DISCONNECT           08100010
CD0WR    EQU   X'06' .                  WRITE WITH READ                 08400010
CD0WI    EQU   X'07' .                  WRITE WITH INVITE               08700010
CD0WC    EQU   X'08'                    WRITE WITH CONTACT              09000010
CD0WCM   EQU   X'09' .                  WRITE WITH CONTACT(EXT)         09300010
CD0WCT   EQU   X'0A' .                  WRITE WITH CONTACT(EOT)         09600010
CD0WCD   EQU   X'0B' .                  WRITE WITH CONTACT AND DISCONN  09900010
CD0WCR   EQU   X'0E' .                  WRITE WITH CONTACT AND READ     10200010
         SPACE                                                          10500010
CD0TEST  EQU   X'03' .             TEST COMMAND                         10800010
*                                                                       11100010
*        TEST MODIFIERS                                                 11400010
*                                                                       11700010
CD0T     EQU   X'00' .                  TEST DEVICE NORMAL              12000010
CD0TC    EQU   X'01' .                  TEST DEVICE WITH CONTACT        12300010
CD0TD    EQU   X'02' .                  TEST DEVICE WITH DISCONNECT     12600010
CD0TCD   EQU   X'03' .                  TEST DEV WITH CDNTACT & DISCONN 12900010
CD0TI    EQU   X'04' .                  TEST LINE NORMAL                13200010
CD0TIC   EQU   X'05' .                  TEST LINE WITH CONTACT          13500010
CD0TID   EQU   X'06' .                  TEST LINE WITH DISCONNECT       13800010
CD0TICD  EQU   X'07' .                  TEST LINE WITH CONTACT & DISCON 14100010
         SPACE                                                          14400010
CD0REST  EQU   X'04' .             RESTART COMMAND                      14700010
*                                                                       15000010
*        RESTART MODIFIERS                                              15300010
*                                                                       15600010
CD0RLINE EQU   X'00' .                  LINE                            15900010
CD0RDEV  EQU   X'01' .                  DEVICE                          16200010
CD0RLSES EQU   X'02' .                  REP SESSION INIT INFO FOR LINE  16500010
CD0RDSES EQU   X'04' .                  REP SESSION INIT INFO FOR DEV   16800010
         SPACE                                                          17100010
CD0INV   EQU   X'05' .             INVITE COMMAND                       17400010
*                                                                       17700010
*        INVITE MODIFIERS                                               18000010
*                                                                       18300010
CD0I     EQU   X'00' .                  INVITE NORMAL                   18600010
CD0IB    EQU   X'01' .                  INVITE BLOCK                    18900010
CD0IM    EQU   X'02' .                  INVITE MESSAGE                  19200010
CD0IT    EQU   X'03' .                  INVITE TRANSMISSION             19500010
CD0ID    EQU   X'04' .                  INVITE TRANSMISSION WITH DISCON 19800010
CD0IA    EQU   X'05' .                  INVITE WITH AUTO RESTART        20100010
CD0IP    EQU   X'06' .                  INVITE PERPETUAL                20400010
         SPACE                                                          20700010
CD0CONT  EQU   X'06' .             CONTACT COMMAND                      21000010
*                                                                       21300010
*        CONTACT MODIFIERS                                              21600010
*                                                                       21900010
CD0C     EQU   X'00' .                  CONTACT NORMAL                  22000010
CD0CRSID EQU   X'01' .                  CONTACT/RETURN RSID             22100010
         SPACE                                                          22200010
CD0DISC  EQU   X'07' .             DISCONNECT COMMAND                   22500010
*                                                                       22800010
*        DISCONNECT MODIFIERS                                           23100010
*                                                                       23400010
CD0D     EQU   X'00' .                  DISCONNECT NORMAL               23700010
CD0DI    EQU   X'01' .                  DISCONNECT WITH INVITE          24000010
CD0DE    EQU   X'02' .                  DISCONNECT WITH END-OF-CALL     24300010
CD0DEI   EQU   X'03' .                  DISCONNECT WITH EOC AND INVITE  24600010
         SPACE                                                          24900010
CD0CTRL  EQU   X'08' .             CONTROL COMMAND                      25200010
*                                                                       25500010
*        CONTROL MODIFIERS                                              25800010
*                                                                       26100010
CD0CDISL EQU   X'01' .                  DISPLAY LINE STATUS             26400010
CD0CRSII EQU   X'02' .                  REP SESS INIT INFO FOR A LINE   26700010
CD0CAI   EQU   X'03' .                  ACTIVATES INVITES               27000010
CD0CDI   EQU   X'04' .                  DEACTIVATES INVITES             27300010
CD0CCSII EQU   X'05' .                  COPY SESS INIT INFO             27600010
CD0CDDS  EQU   X'06' .                  DISPLAY DEVICE STATUS           27900010
CD0CRDS  EQU   X'07' .                  REQ DEV STATISTICS              28200010
CD0CDS   EQU   X'08' .                  DISPLAY STORAGE                 28500010
CD0CSTD  EQU   X'09' .                  SET TIME AND DATE               28800010
CD0CSCMS EQU   X'0A' .                  SET CHANNEL MODE SECONDARY      29100010
CD0CDLNA EQU   X'0B' .                  DISPLAY LINE'S NETWORK ADDR     29400010
CD0CALT  EQU   X'0C' .                  ACTIVATE LINE TRACE             29700010
CD0CTLT  EQU   X'0D' .                  TERMINATE LINE TRACE            30000010
CD0CCMS  EQU   X'12' .                  CHANGE MODEM SPEED              30300010
CD0CSCMP EQU   X'15' .                  SET CHANNEL MODE PRIMARY        30600010
CD0CCDM  EQU   X'18' .                  COPY DESTINATION MODE           30900010
CD0CPD   EQU   X'1C' .                  PHYSICAL DISCONNECT             31200010
CD0CCDSI EQU   X'21' .                  COPY DEV SESSION INFO           31500010
CD0CRDSI EQU   X'22' .                  REP DEV SESSION INFO            31800010
CD0CREL  EQU   X'41' .                  RESET ERROR LOCK                32100010
CD0CRDQ  EQU   X'42' .                  RESET DEVICE QUEUES             32400010
CD0CRCMR EQU   X'43' .                  REQ CONTROLMODE RESET           32700010
CD0CRI   EQU   X'44' .                  RESET IMMEDIATE                 33000010
CD0CROTT EQU   X'48' .                  RESET ONLINE TERMINAL TEST      33300010
CD0CSTB  EQU   X'4A' .                  SWITCH TO BACKUP                33600010
CD0CSBTP EQU   X'4C' .                  SWITCH FROM BACKUP TO PRIMARY   33900010
CD0CRINV EQU   X'4D' .                  RESET INVITE                    34200010
CD0CRC   EQU   X'50' .                  RESET CONDITIONAL               34500010
CD0CREOC EQU   X'60' .                  RESET AT ENDOF COMMAND          34800010
CD0UNSIP EQU   X'77' .                  UNSOLICITED RESPONSE            35100010
CD0CSEP  EQU   X'82' .                  SWITCH TO EP MODE               35400010
CD0CSNCP EQU   X'83' .                  SWITCH TO NCP MODE              35700010
CD0CCLSP EQU   X'84' .                  CHGE LINE SERVICE-SEEKING PAUSE 36000010
CD0CCLNR EQU   X'85' .                  CHGE LINE NEG POLL RSP LIMIT    36300010
CD0CCSL  EQU   X'86' .                  CHGE SESSION LIMIT              36600010
CD0CCDTL EQU   X'8C' .                  CHGE DEV TRANSMISSION LIMIT     36900010
CD0CMBHS EQU   X'8D' .                  MODIFY BLK HANDLER SET ASSOC    37200010
CD0CAL   EQU   X'98' .                  ACTIVATE LINE                   37500010
CD0CD0   EQU   X'99' .                  DEACTIVATE ORDERLY              37800010
CD0CSDM  EQU   X'9A' .                  SET DESTINATION MODE            38100010
CD0CDLH  EQU   X'C2' .                  DEACTIVATE LINE HALT            38400010
         MEND                                                           38700010
*        */                                                             39000010
*%CD0PLS:;                                                              39300010
*/*                                                                  */ 39600010
*/*      FID0 COMMAND CODES                                          */ 39900010
*/*                                                                  */ 40200010
*                                                                       40500010
*DCL CD0READ  BIT(8) CONSTANT('01'X); /* READ COMMAND                */ 40800010
*/*                                                                  */ 41100010
*/*      READ MODIFIERS                                              */ 41400010
*/*                                                                  */ 41700010
*DCL CD0R      BIT(8) CONSTANT('00'X); /*  READ NORMAL               */ 42000010
*DCL CD0RB     BIT(8) CONSTANT('01'X); /*  READ BLOCK                */ 42300010
*DCL CD0RM     BIT(8) CONSTANT('02'X); /*  READ MESSAGE              */ 42600010
*DCL CD0RT     BIT(8) CONSTANT('03'X); /*  READ TRANSMISSION         */ 42900010
*DCL CD0RD     BIT(8) CONSTANT('04'X); /*  READ TRANSMISSION DISCON  */ 43200010
*DCL CD0RI     BIT(8) CONSTANT('05'X); /*  READ WITH INVITE          */ 43500010
*                                                                       43800010
*DCL CD0WRT    BIT(8) CONSTANT('02'X); /* WRITE COMMAND              */ 44100010
*/*                                                                  */ 44400010
*/*      WRITE MODIFIERS                                             */ 44700010
*/*                                                                  */ 45000010
*DCL CD0W      BIT(8) CONSTANT('00'X); /*  WRITE NORMAL              */ 45300010
*DCL CD0WM     BIT(8) CONSTANT('01'X); /*  WRITE WITH EOM            */ 45600010
*DCL CD0WT     BIT(8) CONSTANT('02'X); /*  WRITE WITH EOT            */ 45900010
*DCL CD0WD     BIT(8) CONSTANT('03'X); /*  WRITE WITH DISCONNECT     */ 46200010
*DCL CD0WR     BIT(8) CONSTANT('06'X); /*  WRITE WITH READ           */ 46500010
*DCL CD0WI     BIT(8) CONSTANT('07'X); /*  WRITE WITH INVITE         */ 46800010
*DCL CD0WC     BIT(8) CONSTANT('08'X); /*  WRITE WITH CONTACT        */ 47100010
*DCL CD0WCM    BIT(8) CONSTANT('09'X); /*  WRITE WITH CONTACT(EXT)   */ 47400010
*DCL CD0WCT    BIT(8) CONSTANT('0A'X); /*  WRITE WITH CONTACT(EOT)   */ 47700010
*DCL CD0WCD    BIT(8) CONSTANT('0B'X); /* WRITE WITH CONTACT & DISCON*/ 48000010
*DCL CD0WCR    BIT(8) CONSTANT('0E'X); /*  WRITE WITH CONTACT & READ */ 48300010
*                                                                       48600010
*DCL CD0TEST  BIT(8) CONSTANT('03'X); /* TEST COMMAND                */ 48900010
*/*                                                                  */ 49200010
*/*      TEST MODIFIERS                                              */ 49500010
*/*                                                                  */ 49800010
*DCL CD0T     BIT(8) CONSTANT('00'X); /*  TEST DEVICE NORMAL         */ 50100010
*DCL CD0TC    BIT(8) CONSTANT('01'X); /*  TEST DEVICE WITH CONTACT   */ 50400010
*DCL CD0TD    BIT(8) CONSTANT('02'X); /*  TEST DEVICE WITH DISCONN   */ 50700010
*DCL CD0TCD   BIT(8) CONSTANT('03'X); /*  TEST DEV WITH CONTACT & DIS*/ 51000010
*DCL CD0TI    BIT(8) CONSTANT('04'X); /*  TEST LINE NORMAL           */ 51300010
*DCL CD0TIC   BIT(8) CONSTANT('05'X); /*  TEST LINE WITH CONTACT     */ 51600010
*DCL CD0TID   BIT(8) CONSTANT('06'X); /*  TEST LINE WITH DISCONNECT  */ 51900010
*DCL CD0TICD  BIT(8) CONSTANT('07'X); /*  TEST LINE WITH CONT & DISC */ 52200010
*                                                                       52500010
*/*                                                                  */ 52800010
*/*      RESTART MODIFIERS                                           */ 53100010
*/*                                                                  */ 53400010
*DCL CD0RLINE BIT(8) CONSTANT('00'X); /*  LINE                       */ 53700010
*DCL CD0RDEV  BIT(8) CONSTANT('01'X); /*  DEVICE                     */ 54000010
*DCL CD0RLSES BIT(8) CONSTANT('02'X); /*  REP SESS INIT INFO FOR LINE*/ 54300010
*DCL CD0RDSES BIT(8) CONSTANT('04'X); /*  REP SESS INIT INFO FOR DEV */ 54600010
*                                                                       54900010
*DCL CD0INV   BIT(8) CONSTANT('05'X); /* INVITE COMMAND              */ 55200010
*/*                                                                  */ 55500010
*/*      INVITE MODIFIERS                                            */ 55800010
*/*                                                                  */ 56100010
*DCL CD0I     BIT(8) CONSTANT('00'X); /*  INVITE NCORMAL             */ 56400010
*DCL CD0IB    BIT(8) CONSTANT('01'X); /*  INVITE BLOCK               */ 56700010
*DCL CD0IM    BIT(8) CONSTANT('02'X); /*  INVITE MESSAGE             */ 57000010
*DCL CD0IT    BIT(8) CONSTANT('03'X); /*  INVITE TRANSMISSION        */ 57300010
*DCL CD0ID    BIT(8) CONSTANT('04'X); /*  INVITE TRANS WITH DISC     */ 57600010
*DCL CD0IA    BIT(8) CONSTANT('05'X); /*  INVITE WITH AUTO RESTART   */ 57900010
*DCL CD0IP    BIT(8) CONSTANT('06'X); /*  INVITE PERPETUAL           */ 58200010
*                                                                       58500010
*DCL CD0CONT  BIT(8) CONSTANT('06'X); /* CONTACT COMMAND             */ 58800010
*/*                                                                  */ 59100010
*/*      CONTACT MODIFIERS                                           */ 59400010
*/*                                                                  */ 59700010
*DCL CD0C     BIT(8) CONSTANT('00'X); /* CONTACT NORMAL              */ 60000010
*DCL CD0CRSID BIT(8) CONSTANT('01'X); /* CONTACT/RETURN RSID         */ 60100010
*                                                                       60200010
*DCL CD0DISC  BIT(8) CONSTANT('07'X); /* DISCONNECT COMMAND          */ 60300010
*/*                                                                  */ 60600010
*/*      DISCONNECT MODIFIERS                                        */ 60900010
*/*                                                                  */ 61200010
*DCL CD0D     BIT(8) CONSTANT('00'X); /*  DISCONNECT NORMAL          */ 61500010
*DCL CD0DI    BIT(8) CONSTANT('01'X); /*  DISCONNECT WITH INVITE     */ 61800010
*DCL CD0DE    BIT(8) CONSTANT('02'X); /*  DISCONNECT WITH END-OF-CALL*/ 62100010
*DCL CD0DEI   BIT(8) CONSTANT('03'X); /*  DISCONNECT WITH EOC AND INV*/ 62400010
*                                                                       62700010
*DCL CD0CTRL  BIT(8) CONSTANT('08'X); /* CONTROL COMMAND             */ 63000010
*/*                                                                  */ 63300010
*/*      CONTROL MODIFIERS                                           */ 63600010
*/*                                                                  */ 63900010
*DCL CD0CDISL BIT(8) CONSTANT('01'X); /*  DISPLAY LINE STATUS        */ 64200010
*DCL CD0CRSII BIT(8) CONSTANT('02'X); /*  REP SESS INIT INFO FOR LINE*/ 64500010
*DCL CD0CA8   BIT(8) CONSTANT('03'X); /*  ACTIVATES INVITES          */ 64800010
*DCL CD0CDI   BIT(8) CONSTANT('04'X); /*  DEACTIVATES INVITES        */ 65100010
*DCL CD0CCSII BIT(8) CONSTANT('05'X); /*  COPY SESS INIT INFO        */ 65400010
*DCL CD0CDDS  BIT(8) CONSTANT('06'X); /*  DISPLAY DEVICE STATUS      */ 65700010
*DCL CD0CRDS  BIT(8) CONSTANT('07'X); /*  REQ DEVICE STATISTICS      */ 66000010
*DCL CD0CDS   BIT(8) CONSTANT('08'X); /*  DISPLAY STORAGE            */ 66300010
*DCL CD0CSTD  BIT(8) CONSTANT('09'X); /*  SET TIME AND DATE          */ 66600010
*DCL CD0CSCMS BIT(8) CONSTANT('0A'X); /*  SET CHANNEL MODE SECONDARY */ 66900010
*DCL CD0CDLNA BIT(8) CONSTANT('0B'X); /*  DISPLAY LINE'S NETWORK ADDR*/ 67200010
*DCL CD0CALT  BIT(8) CONSTANT('0C'X); /*  ACTIVATE LINE TRACE        */ 67500010
*DCL CD0CTLT  BIT(8) CONSTANT('0D'X); /*  TERMINATE LINE TRACE       */ 67800010
*DCL CD0CCMS  BIT(8) CONSTANT('12'X); /*  CHANGE MODEM SPEED         */ 68100010
*DCL CD0CSCMP BIT(8) CONSTANT('15'X); /*  SET CHANNEL MODE PRIMARY   */ 68400010
*DCL CD0CCDM  BIT(8) CONSTANT('18'X); /*  COPY DESTINATION MODE      */ 68700010
*DCL CD0CPD   BIT(8) CONSTANT('1C'X); /*  PHYSICAL DISCONNECT        */ 69000010
*DCL CD0CCDSI BIT(8) CONSTANT('21'X); /*  COPY DEV SESSION INFO      */ 69300010
*DCL CD0CRDSI BIT(8) CONSTANT('22'X); /*  REP DEV SESSION INFO       */ 69600010
*DCL CD0CREL  BIT(8) CONSTANT('41'X); /*  RESET ERROR LOCK           */ 69900010
*DCL CD0CRD1  BIT(8) CONSTANT('42'X); /*  RESET DEVICE QUEUES        */ 70200010
*DCL CD0CRCMR BIT(8) CONSTANT('43'X); /*  REQ CONTROL MODE RESET     */ 70500010
*DCL CD0CRI   BIT(8) CONSTANT('44'X); /*  RESET IMMEDIATE            */ 70800010
*DCL CD0CROTT BIT(8) CONSTANT('48'X); /*  RESET ONLINE TERMINAL TEST */ 71100010
*DCL CD0CSTB  BIT(8) CONSTANT('4A'X); /*  SWITCH TO BACKUP           */ 71400010
*DCL CD0CSBTP BIT(8) CONSTANT('4C'X); /*  SWITCH FROM BACKUP TO PRIM */ 71700010
*DCL CD0CRINV BIT(8) CONSTANT('4D'X); /*  RESET INVITE               */ 72000010
*DCL CD0CRC   BIT(8) CONSTANT('50'X); /*  RESET CONDITIONAL          */ 72300010
*DCL CD0CREOC BIT(8) CONSTANT('60'X); /*  RESET AT END OF COMMAND    */ 72600010
*DCL CD0UNSIP BIT(8) CONSTANT('77'X); /*  UNSOLICITED RESPONSE       */ 72900010
*DCL CD0CSEP  BIT(8) CONSTANT('82'X); /*  SWITCH TO EP MODE          */ 73200010
*DCL CD0CSNCP BIT(8) CONSTANT('83'X); /*  SWITCH TO NCP MODE         */ 73500010
*DCL CD0CCLSP BIT(8) CONSTANT('84'X); /*  CHGE LINE SERV-SEEKING PAUS*/ 73800010
*DCL CD0CCLNR BIT(8) CONSTANT('85'X); /*  CHGE LINE NEG POLL RSP LIM */ 74100010
*DCL CD0CCSL  BIT(8) CONSTANT('86'X); /*  CHGE SESSION LIMIT         */ 74400010
*DCL CD0CCDTL BIT(8) CONSTANT('8C'X); /*  CHGE DEV TRANSMISSION LIMIT*/ 74700010
*DCL CD0CMBHS BIT(8) CONSTANT('8D'X); /*  MOD BLK HANDLER SET ASSOC  */ 75000010
*DCL CD0CAL   BIT(8) CONSTANT('98'X); /*  ACTIVATE LINE              */ 75300010
*DCL CD0CD0   BIT(8) CONSTANT('99'X); /*  DEACTIVATE ORDERLY         */ 75600010
*DCL CD0CSDM  BIT(8) CONSTANT('9A'X); /*  SET DESTINATION MODE       */ 75900010
*DCL CD0CDLH  BIT(8) CONSTANT('C2'X); /*  DEACTIVATE LINE HALT       */ 76200010
./  ADD  SSI=72280177,NAME=TCD1D
*        %GOTO CD1PLS;                /* BILINGUAL HEADER               00400000
         MACRO                                                          00800000
         TCD1D                                                          01200000
.*A000000-999999                                               @Y17XAXF 01600000
*                                                                       02000000
*        DATA FLOW CONTROL COMMANDS                                     02400000
*                                                                       02800000
CD1LSTAT EQU   X'04' .             LUSTAT                               03200000
CD1RTR   EQU   X'05' .             READY TO RECEIVE                     03600000
CD1QEC   EQU   X'80' .             QUIESCE AT END OF CHAIN              04000000
CD1QC    EQU   X'81' .             QUIESCE COMPLETE                     04400000
CD1REL1  EQU   X'82' .             RELEASE QUIESCE                      04800000
CD1CANCL EQU   X'83' .             CANCEL                               05200000
CD1CHASE EQU   X'84' .             CHASE                                05600000
CD1SHUTD EQU   X'C0' .             SHUTDOWN                             06000000
CD1SHUTC EQU   X'C1' .             SHUTDOWN COMPLETE                    06400000
CD1RSHUT EQU   X'C2' .             REQUEST SHUTDOWN                     06800000
CD1BID   EQU   X'C8' .             BID                                  07200000
CD1SIG   EQU   X'C9' .             SIGNAL                               07600000
         SPACE 2                                                        08000000
*                                                                       08400000
*        SESSION CONTROL COMMANDS                                       08800000
*                                                                       09200000
CD1ACTLU EQU   X'0D' .             ACTIVATE LU                          09600000
CD1DATLU EQU   X'0E' .             DEACTIVATE LU                        10000000
CD1ACTPU EQU   X'11' .             ACTIVATE PU                          10400000
CD1DATPU EQU   X'12' .             DEACTIVATE PU                        10800000
CD1BIND  EQU   X'31' .             BIND                                 11200000
CD1UBIND EQU   X'32' .             UNBIND                               11600000
CD1SDT   EQU   X'A0' .             START DATA TRAFFIC                   12000000
CD1CLEAR EQU   X'A1' .             CLEAR                                12400000
CD1STSN  EQU   X'A2' .             SET AND TEST SEQ NUMBERS             12800000
CD1RQR   EQU   X'A3' .             REQUEST RECOVERY                     13200000
         SPACE 2                                                        13600000
*                                                                       14000000
*        NETWORK CONTROL COMMANDS                                       14400000
*                                                                       14800000
CD1PREPS EQU   X'02' .             PREPARE SWITCH                       15200000
CD1SWCOM EQU   X'03' .             SWITCH COMPLETE                      15600000
CD1ANS   EQU   X'06' .             AUTO NETWORK SHUTDOWN                16000000
CD1ANSC  EQU   X'07' .             ANS COMPLETE                         16400000
CD1INITC EQU   X'50' .             INIT COMPLETE                        16800000
CD1SWNCP EQU   X'51' .               SWITCH TO NCP                      16900000
CD1SWEP  EQU   X'52' .               SWITCH TO EP                       17000000
         EJECT                                                          17200000
*                                                                       17600000
*                                                                       18000000
*        NETWORK SERVICES FID1 COMMANDS                                 18400000
*                                                                       18800000
*                                                                       19200000
CD1NETS  EQU   X'01' .             NETWORK SERVICES IND                 19600000
         SPACE                                                          20000000
*                                                                       20400000
*        CONFIGURATION SERVICES FID1 COMMANDS                           20800000
*                                                                       21200000
CD1CONFS EQU   X'02' .             CONFIGURATION SERV IND               21600000
         SPACE                                                          22000000
CD1CONT  EQU   X'01' .               CONTACT                            22400000
CD1DCONT EQU   X'02' .               DISCONTACT                         22800000
CD1IPLI  EQU   X'03' .               IPL INITIAL                        23200000
CD1IPLT  EQU   X'04' .               IPL TEXT                           23600000
CD1IPLF  EQU   X'05' .               IPL FINAL                          24000000
CD1DMPI  EQU   X'06' .               DUMP INITIAL                       24400000
CD1DMPT  EQU   X'07' .               DUMP TEXT                          24800000
CD1DMPF  EQU   X'08' .               DUMP FINAL                         25200000
CD1RPO   EQU   X'09' .               REMOTE POWER OFF                   25600000
CD1ACTLK EQU   X'0A' .               ACTIVATE LINK                      26000000
CD1DACLK EQU   X'0B' .               DEACTIVATE LINK                    26400000
CD1CESLW EQU   X'0C' .               CONTROL ENTER SLOWDOWN             26800000
CD1CXSLW EQU   X'0D' .               CONTROL EXIT SLOWDOWN              27200000
CD1CONNO EQU   X'0E' .               CONNECT OUT                        27600000
CD1ABC   EQU   X'0F' .               ABANDON CONNECTION                 28000000
CD1SETTD EQU   X'01' .               SET TIME AND DATE                  28400000
CD1SETV  EQU   X'11' .               SET CONTROL VECTOR                 28600000
CD1SENV  EQU   X'12' .               SENSE CONTROL VECTOR               28800000
CD1ESLOW EQU   X'14' .               ENTERING SLOWDOWN                  29200000
CD1EXSLW EQU   X'15' .               EXITING SLOWDOWN                   29600000
CD1ACI   EQU   X'16' .               ACTIVATE CONNECT IN                30000000
CD1DCI   EQU   X'17' .               DEACTIVATE CONNECT IN              30400000
CD1ACO   EQU   X'18' .               ABANDON CONNECT OUT                30800000
CD1ANA   EQU   X'19' .               ASSIGN NETWORK ADDR                31200000
CD1FNA   EQU   X'1A' .               FREE NETWORK ADDR                  31600000
CD1REQD  EQU   X'1B' .               REQUEST DISCONTACT                 32000000
CD1CONCT EQU   X'80' .               CONTACTED                          32400000
CD1INOP  EQU   X'81' .               INOPERATIVE                        32800000
CD1REQC  EQU   X'84' .               REQUEST CONTACT                    33200000
         SPACE                                                          33600000
*                                                                       34000000
*        MAINTENANCE SERVICES FID1 COMMANDS                             34400000
*                                                                       34800000
CD1MAINT EQU   X'03' .             MAINTENANCE SERV IND                 35200000
         SPACE                                                          35600000
CD1EX    EQU   X'01' .               EXECUTE TEST                       36000000
CD1ACTTR EQU   X'02' .               ACTIVATE TRACE                     36400000
CD1DACTR EQU   X'03' .               DEACTIVATE TRACE                   36800000
CD1RTP   EQU   X'80' .               REQUEST TEST PROCEDURE             37200000
CD1RMS   EQU   X'81' .               RECORD MAINTENANCE STATS  @YM07259 37600000
CD1RTTD  EQU   X'82' .               RECORD TEST DATA                   38000000
CD1RTRD  EQU   X'83' .               RECORD TRACE DATA                  38400000
         SPACE                                                          38800000
*                                                                       39200000
*        MEASUREMENT SERVICES FID1 COMMANDS                             39600000
*                                                                       40000000
CD1MEAS  EQU   X'04' .             MEASUREMENT SERVICES IND             40400000
         SPACE                                                          40800000
CD1STM   EQU   X'01' .               START MEASUREMENT                  41200000
CD1SPM   EQU   X'02' .               STOP MEASUREMENT                   41600000
CD1RMD   EQU   X'80' .               RECORD MEASUREMENT DATA            42000000
         SPACE                                                          42400000
*                                                                       42800000
*        SESSION SERVICES FID1 COMMANDS                                 43200000
*                                                                       43600000
CD1SESS  EQU   X'06' .             SESSION SERVICES IND                 44000000
         SPACE                                                          44400000
CD1CINIT EQU   X'01' .               CONTROL INITIATE                   44800000
CD1CTERM EQU   X'02' .               CONTROL TERMINATE                  45200000
CD1NSPRO EQU   X'04' .               NS PROC ERROR                      45600000
CD1INITS EQU   X'81' .               INITIATE SELF                      46000000
CD1INITO EQU   X'80' .               INITIATE OTHER                     46400000
CD1TERMO EQU   X'82' .               TERMINATE OTHER                    46800000
CD1TERMS EQU   X'83' .               TERMINATE SELF                     47200000
CD1BINDF EQU   X'85' .               BIND FAILURE                       47600000
CD1SESST EQU   X'86' .               SESSION STARTED                    48000000
CD1UBNDF EQU   X'87' .               UNBIND FAILURE                     48400000
CD1SESEN EQU   X'88' .               SESSION ENDED                      48800000
         SPACE                                                          48830000
*                                                                       48860000
*        NCP ONLY COMMAND CATEGORY                                      48890000
*                                                                       48920000
CD1PRE   EQU   X'00' .               3705 ONLY INDICATOR                48950000
         SPACE                                                          48980000
CD1CGTRL EQU   X'01' .               CHANGE DEVICE TRANS LIMIT          49010000
CD1CGNPL EQU   X'02' .               CHANGE NEGATIVE POLL LIMIT         49040000
CD1CGSSL EQU   X'03' .               CHANGE SESSION LIMIT               49070000
CD1CGSSP EQU   X'04' .               CHANGE SERVICE SEEKING PAUSE       49100000
         MEND                                                           49200000
*        */                                                             49600000
*%CD1PLS:;                                                              50000000
*/*                                                                  */ 50400000
*/*      DATA FLOW CONTROL COMMANDS                                  */ 50800000
*/*                                                                  */ 51200000
* DCL CD1LSTAT BIT(8) CONSTANT('04'X);  /* LUSTAT                    */ 51600000
* DCL CD1RTR   BIT(8) CONSTANT('05'X);  /* READY TO RECEIVE          */ 52000000
* DCL CD1QEC   BIT(8) CONSTANT('80'X);  /* QUIESCE AT END OF CHAIN   */ 52400000
* DCL CD1QC    BIT(8) CONSTANT('81'X);  /* QUIESCE COMPLETE          */ 52800000
* DCL CD1RELQ  BIT(8) CONSTANT('82'X);  /* RELEASE QUIESCE           */ 53200000
* DCL CD1CANCL BIT(8) CONSTANT('83'X);  /* CANCEL                    */ 53600000
* DCL CD1CHASE BIT(8) CONSTANT('84'X);  /* CHASE                     */ 54000000
* DCL CD1SHUTD BIT(8) CONSTANT('C0'X);  /* SHUTDOWN                  */ 54400000
* DCL CD1SHUTC BIT(8) CONSTANT('C1'X);  /* SHUTDOWN COMPLETE         */ 54800000
* DCL CD1RSHUT BIT(8) CONSTANT('C2'X);  /* REQUEST SHUTDOWN          */ 55200000
* DCL CD1BID   BIT(8) CONSTANT('C8'X);  /* BID                       */ 55600000
* DCL CD1SIG   BIT(8) CONSTANT('C9'X);  /* SIGNAL                    */ 56000000
         @SPACE;                                                        56400000
*/*                                                                  */ 56800000
*/*      SESSION CONTROL COMMANDS                                    */ 57200000
*/*                                                                  */ 57600000
* DCL CD1ACTLU BIT(8) CONSTANT('0D'X);  /* ACTIVATE LU               */ 58000000
* DCL CD1DATLU BIT(8) CONSTANT('0E'X);  /* DEACTIVATE LU             */ 58400000
* DCL CD1ACTPU BIT(8) CONSTANT('11'X);  /* ACTIVATE PU               */ 58800000
* DCL CD1DATPU BIT(8) CONSTANT('12'X);  /* DEACTIVATE PU             */ 59200000
* DCL CD1BIND  BIT(8) CONSTANT('31'X);  /* BIND                      */ 59600000
* DCL CD1UBIND BIT(8) CONSTANT('32'X);  /* UNBIND                    */ 60000000
* DCL CD1SDT   BIT(8) CONSTANT('A0'X);  /* START DATA TRAFFIC        */ 60400000
* DCL CD1CLEAR BIT(8) CONSTANT('A1'X);  /* CLEAR                     */ 60800000
* DCL CD1STSN  BIT(8) CONSTANT('A2'X);  /* SET AND TEST SEQ NUMBERS  */ 61200000
* DCL CD1RQR   BIT(8) CONSTANT('A3'X);  /* REQUEST RECEIVED          */ 61600000
         @SPACE;                                                        62000000
*/*                                                                  */ 62400000
*/*      NETWORK CONTROL COMMANDS                                    */ 62800000
*/*                                                                  */ 63200000
* DCL CD1PREPS BIT(8) CONSTANT('02'X);  /* PREPARE SWITCH            */ 63600000
* DCL CD1SWCOM BIT(8) CONSTANT('03'X);  /* SWITCH COMPLETE           */ 64000000
* DCL CD1ANS   BIT(8) CONSTANT('06'X);  /* AUTO NETWORK SHUTDOWN     */ 64400000
* DCL CD1ANSC  BIT(8) CONSTANT('07'X);  /* ANS COMPLETE              */ 64800000
* DCL CD1INITC BIT(8) CONSTANT('50'X);  /* INIT COMPLETE             */ 65200000
* DCL CD1SWNCP BIT(8) CONSTANT('51'X);  /*   SWITCH TO NCP           */ 65400000
* DCL CD1SWEP  BIT(8) CONSTANT('52'X);  /*   SWITCH TO EP            */ 65600000
*/*                                                                  */ 66000000
*/*                                                                  */ 66400000
*/*      NETWORK SERVICES FID1 COMMANDS                              */ 66800000
*/*                                                                  */ 67200000
*/*                                                                  */ 67600000
* DCL CD1NETS  BIT(8) CONSTANT('01'X);  /* NETWORK SERV IND          */ 68000000
         @SPACE;                                                        68400000
*/*                                                                  */ 68800000
*/*      CONFIGURATION SERVICES FID1 COMMANDS                        */ 69200000
*/*                                                                  */ 69600000
* DCL CD1CONFS BIT(8) CONSTANT('02'X);  /* CONFIGURATION SERV IND    */ 70000000
         @SPACE;                                                        70400000
* DCL CD1CONT  BIT(8) CONSTANT('01'X);  /*   CONTACT                 */ 70800000
* DCL CD1DCONT BIT(8) CONSTANT('02'X);  /*   DISCONTACT              */ 71200000
* DCL CD1IPLI  BIT(8) CONSTANT('03'X);  /*   IPL INITIAL             */ 71600000
* DCL CD1IPLT  BIT(8) CONSTANT('04'X);  /*   IPL TEXT                */ 72000000
* DCL CD1IPLF  BIT(8) CONSTANT('05'X);  /*   IPL FINAL               */ 72400000
* DCL CD1DMPI  BIT(8) CONSTANT('06'X);  /*   DUMP INITIAL            */ 72800000
* DCL CD1DMPT  BIT(8) CONSTANT('07'X);  /*   DUMP TEXT               */ 73200000
* DCL CD1DMPF  BIT(8) CONSTANT('08'X);  /*   DUMP FINAL              */ 73600000
* DCL CD1RPO   BIT(8) CONSTANT('09'X);  /*   REMOTE POWER OFF        */ 74000000
* DCL CD1ACTLK BIT(8) CONSTANT('0A'X);  /*   ACTIVATE LINK           */ 74400000
* DCL CD1DACLK BIT(8) CONSTANT('0B'X);  /*   DEACTIVATE LINK         */ 74800000
* DCL CD1CESLW BIT(8) CONSTANT('0C'X);  /*   CONTROL ENTER SLOWDOWN  */ 75200000
* DCL CD1CXSLW BIT(8) CONSTANT('0D'X);  /*   CONTROL EXIT SLOWDOWN   */ 75600000
* DCL CD1CONNO BIT(8) CONSTANT('0E'X);  /*   CONNECT OUT             */ 76000000
* DCL CD1ABC   BIT(8) CONSTANT('0F'X);  /*   ABANDON CONNECTION      */ 76400000
* DCL CD1SETTD BIT(8) CONSTANT('01'X);  /*   SET TIME AND DATE       */ 76800000
* DCL CD1SETV  BIT(8) CONSTANT('11'X);  /*   SET CONTROL VECTOR      */ 77000000
* DCL CD1SENV  BIT(8) CONSTANT('12'X);  /*   SENSE CONTROL VECTOR    */ 77200000
* DCL CD1ESLOW BIT(8) CONSTANT('14'X);  /*   ENTERING SLOWDOWN       */ 77600000
* DCL CD1EXSLW BIT(8) CONSTANT('15'X);  /*   EXITING SLOWDOWN        */ 78000000
* DCL CD1ACI   BIT(8) CONSTANT('16'X);  /*   ACTIVATE CONNECT IN     */ 78400000
* DCL CD1DCI   BIT(8) CONSTANT('17'X);  /*   DEACTIVATE CONNECT IN   */ 78800000
* DCL CD1ACO   BIT(8) CONSTANT('18'X);  /*   ABANDON CONNECT OUT     */ 79200000
* DCL CD1ANA   BIT(8) CONSTANT('19'X);  /*   ASSIGN NETWORK ADDR     */ 79600000
* DCL CD1FNA   BIT(8) CONSTANT('1A'X);  /*   FREE NETWORK ADDR       */ 80000000
* DCL CD1REQD  BIT(8) CONSTANT('1B'X);  /*   REQUEST DISCONTACT      */ 80400000
* DCL CD1CONCT BIT(8) CONSTANT('80'X);  /*   CONTACTED               */ 80800000
* DCL CD1INOP  BIT(8) CONSTANT('81'X);  /*   INOPERATIVE             */ 81200000
* DCL CD1REQC  BIT(8) CONSTANT('84'X);  /*   REQUEST CONTACT         */ 81600000
         @SPACE;                                                        82000000
*/*                                                                  */ 82400000
*/*      MAINTENANCE SERVICES FID1 COMMANDS                          */ 82800000
*/*                                                                  */ 83200000
* DCL CD1MAINT BIT(8) CONSTANT('03'X);  /* MAINTENANCE SERV IND      */ 83600000
         @SPACE;                                                        84000000
* DCL CD1EX    BIT(8) CONSTANT('01'X);  /*   EXECUTE TEST            */ 84400000
* DCL CD1ACTTR BIT(8) CONSTANT('02'X);  /*   ACTIVATE TRACE          */ 84800000
* DCL CD1DACTR BIT(8) CONSTANT('03'X);  /*   DEACTIVATE TRACE        */ 85200000
* DCL CD1RTP   BIT(8) CONSTANT('80'X);  /*   REQUEST TEST PROCEDURE  */ 85600000
* DCL CD1RMS   BIT(8) CONSTANT('81'X);  /*   RECORD MAINT STATISTICS */ 86000000
* DCL CD1RTTD  BIT(8) CONSTANT('82'X);  /*   RECORD TEST DATA        */ 86400000
* DCL CD1RTRD  BIT(8) CONSTANT('83'X);  /*   RECORD TRACE DATA       */ 86800000
         @SPACE;                                                        87200000
*/*                                                                  */ 87600000
*/*      MEASUREMENT SERVICES FID1 COMMANDS                          */ 88000000
*/*                                                                  */ 88400000
* DCL CD1MEAS  BIT(8) CONSTANT('04'X);  /*   MEASUREMENT SERV IND    */ 88800000
         @SPACE;                                                        89200000
* DCL CD1STM   BIT(8) CONSTANT('01'X);  /*   START MEASUREMENT       */ 89600000
* DCL CD1STP   BIT(8) CONSTANT('02'X);  /*   STOP MEASUREMENT        */ 90000000
* DCL CD1RMD   BIT(8) CONSTANT('80'X);  /*   RECORD MEASUREMENT DATA */ 90400000
         @SPACE;                                                        90800000
*/*                                                                  */ 91200000
*/*      SESSION SERVICES FID1 COMMANDS                              */ 91600000
*/*                                                                  */ 91800000
* DCL CD1SESS  BIT(8) CONSTANT('06'X);  /* SESSION SERV IND          */ 92000000
         @SPACE;                                                        92400000
* DCL CD1CINIT BIT(8) CONSTANT('01'X);  /*   CONTROL INITIATE        */ 92800000
* DCL CD1CTERM BIT(8) CONSTANT('02'X);  /*   CONTROL TERMINATE       */ 93200000
* DCL CD1NSPRO BIT(8) CONSTANT('04'X);  /*   NS PROC ERROR           */ 93600000
* DCL CD1INITS BIT(8) CONSTANT('81'X);  /*   INITIATE SELF           */ 94000000
* DCL CD1INITO BIT(8) CONSTANT('80'X);  /*   INITIATE OTHER          */ 94400000
* DCL CD1TERMO BIT(8) CONSTANT('82'X);  /*   TERMINATE OTHER         */ 94800000
* DCL CD1TERMS BIT(8) CONSTANT('83'X);  /*   TERMINATE SELF          */ 95200000
* DCL CD1BINDF BIT(8) CONSTANT('85'X);  /*   BIND FAILURE            */ 95600000
* DCL CD1SESST BIT(8) CONSTANT('86'X);  /*   SESSION STARTED         */ 96000000
* DCL CD1UBNDF BIT(8) CONSTANT('87'X);  /*   UNBIND FAILURE          */ 96400000
* DCL CD1SESEN BIT(8) CONSTANT('88'X);  /*   SESSION ENDED           */ 96800000
         @SPACE;                                                        97000000
*/*                                                                  */ 97200000
*/*      3705 ONLY COMMAND CATEGORY                                  */ 97400000
*/*                                                                  */ 97600000
* DCL CD1PRE   BIT(8) CONSTANT('00'X);  /* 3705 ONLY INDICATOR       */ 97800000
         @SPACE;                                                        98000000
* DCL CD1CGTRL BIT(8) CONSTANT('01'X);  /*   CHANGE DEVICE TRANS LIM */ 98200000
* DCL CD1CGNPL BIT(8) CONSTANT('02'X);  /*   CHANGE NEG POLL LIMIT   */ 98400000
* DCL CD1CGSSL BIT(8) CONSTANT('03'X);  /*   CHANGE SESSION LIMIT    */ 98600000
* DCL CD1CGSSP BIT(8) CONSTANT('04'X);  /*   CHANGE SERV SEEKING PAU */ 98800000
*/*                                                                  */ 99220000
*/*      3 BYTE NETWORK SERVICE COMMANDS                             */ 99240000
*/*                                                                  */ 99260000
* DCL CD1XSCV  BIT(24) CONSTANT('010211'X); /* SET CONTROL VECTOR    */ 99280000
* DCL CD1XALK  BIT(24) CONSTANT('01020A'X); /* ACTIVATE LINK         */ 99300000
* DCL CD1XDLK  BIT(24) CONSTANT('01020B'X); /* DEACTIVATE LINK       */ 99320000
* DCL CD1XCON  BIT(24) CONSTANT('010201'X); /* CONTACT               */ 99340000
* DCL CD1XCTD  BIT(24) CONSTANT('010280'X); /* CONTACTED             */ 99360000
* DCL CD1XDSC  BIT(24) CONSTANT('010202'X); /* DISCONTACT            */ 99380000
* DCL CD1XINP  BIT(24) CONSTANT('010281'X); /* INOPERATIVE           */ 99400000
* DCL CD1XENS  BIT(24) CONSTANT('010214'X); /* ENTERING SLOWDOWN     */ 99406000
*                                           /*               @YM07042*/ 99412000
* DCL CD1XEXS  BIT(24) CONSTANT('010215'X); /* EXITING SLOWDOWN      */ 99420000
* DCL CD1XRDC  BIT(24) CONSTANT('01021B'X); /* REQUEST DISCONTACT    */ 99440000
* DCL CD1XINS  BIT(24) CONSTANT('010681'X); /* INIT SELF             */ 99460000
* DCL CD1XTMS  BIT(24) CONSTANT('010683'X); /* TERMINATE SELF        */ 99480000
* DCL CD1XSND  BIT(24) CONSTANT('010688'X); /* SESSION ENDED         */ 99500000
* DCL CD1XCIN  BIT(24) CONSTANT('010601'X); /* CINIT                 */ 99520000
* DCL CD1XCTM  BIT(24) CONSTANT('010602'X); /* CTERM                 */ 99540000
* DCL CD1XNSP  BIT(24) CONSTANT('010604'X); /* NS PROC ERROR         */ 99560000
* DCL CD1XBFL  BIT(24) CONSTANT('010685'X); /* BIND FAILURE          */ 99580000
* DCL CD1XSST  BIT(24) CONSTANT('010686'X); /* SESSION STARTED       */ 99600000
* DCL CD1XEXT  BIT(24) CONSTANT('010301'X); /* EXECUTE TEST          */ 99620000
* DCL CD1XATR  BIT(24) CONSTANT('010302'X); /* ACTIVATE TRACE        */ 99640000
* DCL CD1XRSR  BIT(24) CONSTANT('010334'X); /* DPLY STOR REQ@ZM47883*/  99650010
* DCL CD1XMNT  BIT(24) CONSTANT('010381'X); /* REC MAINT STATISTICS  */ 99660000
* DCL CD1XTST  BIT(24) CONSTANT('010382'X); /* RECORD TEST DATA      */ 99680000
* DCL CD1XTRC  BIT(24) CONSTANT('010383'X); /* RECORD TRACE DATA     */ 99700000
* DCL CD1XDTL  BIT(24) CONSTANT('010001'X); /* CHGE DEV TRANS LIMIT  */ 99720000
* DCL CD1XNPL  BIT(24) CONSTANT('010002'X); /* CHGE NEG POLL LIMIT   */ 99740000
* DCL CD1XSNL  BIT(24) CONSTANT('010003'X); /* CHGE SESSION LIMIT    */ 99760000
* DCL CD1XSSP  BIT(24) CONSTANT('010004'X); /* CHGE SERV SEEKNG PAUSE*/ 99780000
./  ADD  SSI=72160490,NAME=TCKPD
*        %GOTO PLSCKP;                  /*                              00050000
         MACRO                                                          00200020
         TCKPD &MERLIN                                                  00400000
.* CHANGE ACTIVITY = AS FOLLOWS:                                        00400122
.*C008000                                                       SA51078 00400222
.*A303000,305000,637000                                         SA51078 00400322
.*C498000-516000,598000                                          S99240 00460000
.*A595000                                                        S99240 00520000
.*A463000                                                       SA67099 00540000
.*A451000                                                      @OX16402 00560010
.*C472000                                                      @OX16402 00580010
         SPACE                                                          00600020
*        UPDATED  10/4/72                                       SA51078 00800022
         SPACE                                                          01000020
*THIS IS A DSECT OF THE CHECKPOINT WORK AREA POINTED TO BY AVTCKGET     01200020
*THIS IS USED ONLY BY CHECKPOINT ROUTINES.                              01400020
*THE LENGTH IS VARIABLE AND DEPENDS ON THE INTRO OPERANDS CKREQS        01600020
*AND CPRCDS.  THE SPACE IS OBTAINED BY IGG01941 VIA GETMAIN.            01800020
         SPACE                                                          02000020
IEDQCKPD DSECT                                                          02200020
CKPSAVE1 DS    18F .                    SAVE AREA FOR LOAD MODULE       02400020
         SPACE 3                                                        02600020
CKPIOB   EQU   * .                      IOB FOR CKPT DISK I/O           02800020
CKPIOFL1 DS    C .                                                      03000020
CKPIOFL2 DS    C .                                                      03200020
CKPIOSN0 DS    C .                                                      03400020
CKPIOSN1 DS    C .                                                      03600020
CKPIOECB DS    0A .                     ADDRESS OF ECB         @Y17XAXF 03800000
CKPIOECC DS    XL1 .                    COMPLETION CODE FOR I/O         03840000
*                                                              @Y17XAXF 03880000
CKPIOCOM EQU   X'7F' .                  COMPLETED SUCCESSFULLY @Y17XAXF 03920000
         DS    AL3 .                    RESERVED               @Y17XAXF 03960000
CKPIOFL3 DS    C .                      I/O ERROR FLAGS                 04000020
CKPIOCSW DS    CL7 .                    CSW                             04200020
CKPIOSIO DS    C .                      START I/O CONDITION CODES       04400020
CKPIOCPA DS    AL3 .                    CHANNEL PROGRAM ADDRESS         04600020
         DS    C                                                        04800020
CKPIODCB DS    AL3 .                    DCB ADDRESS                     05000020
         DS    C .                      REPOSITION MODIFIER             05200020
CKPIORST DS    AL3 .                    RESTART ADDR                    05400020
CKPIOBCI DS    H .                      BLOCK CNT INCREMENT             05600020
CKPIORC  DS    H .                      ERROR COUNT                     05800020
CKPIOM   DS    C .                      SEEK ADDRESS                    06000020
CKPIOBB  DS    CL2                                                      06200020
CKPIOCC  DS    CL2                                                      06400020
CKPIOHH  DS    CL2                                                      06600020
CKPIOR   DS    C                                                        06800020
         SPACE                                                          07000020
CKPECB   DS    F .                      ECB POSTED BY IOS               07200020
CKPEXCP  DS    F .                      CURRENT RECORD BEING WRITTN     07400020
CKPCNVRT EQU   * .                      USED FOR CVD INSTRUCTION        07600020
CKPECBL  EQU   * .                      ECB LIST FOR WAIT               07800020
CKPEPLOC DS    D .                      EPLOC FOR LOAD MACRO            08000020
CKPIOQF  DS    F .                      DISK I/O QUEUE-FIRST RECORD     08200020
CKPIOQL  DS    F .                      I/O QUEUE-LAST RECORD           08400020
         SPACE 3                                                        08600020
CKPNDRB  EQU   X'80' .                  INDICATES NO DISK RECORD       X08800020
                                        BUILT FOR NEXT REQUEST ELEM     09000020
CKPLREB  DS    F .                      ADDRESS OF LAST REQUEST        X09200020
                                        ELEMENT FOR WHICH RECORD       X09400020
                                        WAS BUILT                       09600020
         SPACE 3                                                        09800020
CKPLDRB  DS    F .                      ADDRESS OF LAST DISK RECORD    X10000020
                                        BUILT                           10200020
         SPACE 3                                                        10400020
*THIS AREA US USED BY CKECKPOINT SUBTASK FOR 3705 CHECKPOINT            10407000
         SPACE                                                          10414000
         ORG   CKPEXCP                                                  10421000
         DS    CL7 .                    RESERVED               @Y17XAXF 10428000
CKPENCDE DS    XL1 .                    ENTRY CODE             @Y17XAXF 10435000
CKPIOERR EQU   40 .                     3705 ECECKPOINT IO ERROR        10442000
*                                                              @Y17XAXF 10449000
CKPGETFL EQU   4 .                      GETMAIN FOR 3705 RESOURCE       10456000
*                                        RECORD FAILED         @Y17XAXF 10463000
CKPEODAT EQU   8 .                      END OF 3705 CHECKPOINT DATA SET 10470000
*                                        REACHED               @Y17XAXF 10477000
CKPNTTE  DS    A .                      ADDRESS OF TERMINAL ENTRY       10484000
*                                        PREFIX FOR THE 3705   @Y17XAXF 10491000
CKPNDEVF DS    F .                      ADDRESS OF DEVICE DEPENDENT     10498000
*                                        FIELDS FOR THE 3705   @Y17XAXF 10505000
CKPNSELT DS    0F .                     SELECTOR FIELDS        @Y17XAXF 10512000
CKPSLVAL DS    0CL3 .                   CURRENT SELECT VALUES USED IN   10515000
*                                        SELECT VALUE SHIFT    @Y17XAXF 10519000
CKPCUSEL DS    AL1 .                    CURRENT SELECT VALUE   @Y17XAXF 10526000
CKPSLNEW DS    CL3 .                    NEW SELECT VALUES TO BE SHIFTED 10533000
*                                                              @Y17XAXF 10536000
CKPNTRK  DS    H .                      ALTERNATE RECORD INDICATOR      10540000
*                                                              @Y17XAXF 10547000
CKPNRSID DS    H .                      RESOURCE TO BE CHECKPOINTED OR  10554000
*                                        RESTARTED             @Y17XAXF 10561000
CKPNOTFY EQU   X'0A' .                  SELECT VALUE FOR REQUEST FOR    10568000
*                                        NOTIFICATION          @Y17XAXF 10575000
         ORG                                                            10582000
         SPACE                                                          10589000
*THIS AREA IS USED ONLY AT CHECKPOINT OPEN TIME                         10600020
         SPACE                                                          10800020
         ORG   CKPEXCP                                                  11000020
         SPACE                                                          11200020
*COUNT FIELD FOR WRITE COUNT,KEY AND DATA                               11400020
         SPACE 3                                                        11600020
CKPCYLNO DS    XL2 .                    CYLINDER NUMBER                 11800020
CKPHEDNO DS    XL2 .                    HEAD NUMBER                     12000020
CKPRCDNO DS    X .                      RECORD NUMBER                   12200020
CKPKEYLN DS    X .                      KEY LENGTH                      12400020
CKPDATLN DS    XL2 .                    DATA LENGTH                     12600020
CKPCTTRC DS    F .                      CURRENT ENTRY IN CKREQ-TTR     X12800020
                                        TABLE (USED AT RESTART)         13000020
CKPDATIM DS    2F .                     DATE,TIME OF TOTAL CKPT        X13200020
                                        USED TO COMPARE                X13400020
                                        WITH INCIDENT CKPT'S            13600020
CKPIPERE DS    H .                      NUMBER OF INCIDENTS OR         X13800020
                                        CKREQ IN ONE ENVIRONMENT       X14000020
                                        RECORD SEGMENT                  14200020
CKPCTTRA DS    F .                      ADDRESS OF TTR OF THE          X14400020
                                        ENVIRONMENT RECORD BEING       X14600020
                                        USED FOR RESTART                14800020
         ORG                                                            15000020
         SPACE 3                                                        15200020
CKPSECTR DS    0X .                     SECTOR ID FOR SET SECTOR CMD415 15300000
CKPCTTRB DS    F .                      BEGINNING OF CKREQ TTR TBL      15400020
CKPCPARM DS    2F .                     PARAMETERS FOR CONVERT RTN     X15600020
                                        ADDRESS OF DEB AND ADDRESS     X15800020
                                        FOR CONVERSION RESULT           16000020
         AIF   ('&MERLIN' NE '3330').SKP1                          0419 16040000
CKPPARM2 DS    F .                      PARAMETER FOR SECTOR CNVRT 0415X16080000
                                        ROUTINE (UCB TYPE AND ADDR)0415 16120000
.SKP1    ANOP                                                      0419 16160000
CKPCRLEN DS    X .                      LENGTH OF CONTROL RECORD        16200020
CKPSWCH1 DS    X .                      SWITCH FOR COMPARING           X16400020
                                        QCB TO SEE IF IT HAS BEEN      X16600020
                                        CHECKPOINTED                    16800020
CKPSET1  EQU   X'1' .                   USED TO INVERTQCB SWITCH        17000020
CKPSWCH2 DS    X .                      SWITCH FOR COMPARING WITH      X17200020
                                        INVITATION LIST TO SEE IF      X17400020
                                        IT HAS BEEN CHECKPOINTED        17600020
CKPSET2  EQU   X'04' .                  USED TO INVERT INVLIST SW       17800020
CKPERRCT DS    X .                      COUNT OF ERRORS ENCOUNTERD 1109X17900020
                                        IGG01943,ENVIRONMENT RCDS  1109 18000020
         SPACE 3                                                        18200020
*CHANNEL PROGRAM USED FOR CHECKPOINT DATA SET                           18400020
         SPACE                                                          18600020
         DS    0D .                                                     18800020
CKPCCWS  EQU   * .                      CHANNEL PROGRAM                 19000020
CKPSEEKC DS    D .                      SEEK CYLINDER                   19200020
         AIF   ('&MERLIN' NE '3330').SKP2                          0419 19250000
CKPSETSC DS    D .                      SET SECTOR OR NO-OP        0415 19300000
.SKP2    ANOP                                                      0419 19350000
CKPSCHID DS    D .                      SEARCH ID                       19400020
CKPTIC   DS    D .                      TIC                             19600020
CKPRW    DS    0D .                     READ/WRITE             @Y17XAXF 19800000
CKPRWCMD DS    XL1 .                    COMMAND CODE           @Y17XAXF 19810000
CKPRWADD DS    AL3 .                    DATA ADDRESS           @Y17XAXF 19820000
CKPRWFLG DS    XL1 .                    FLAGS                  @Y17XAXF 19830000
         DS    XL1 .                    RESERVED               @Y17XAXF 19840000
CKPWRBC  DS    H .                      BYTE COUNT             @Y17XAXF 19850000
CKPCCWND EQU   * .                      END OF CHANNEL PROGRAM     0415 19900000
CKPREAD  EQU   6 .                      READ DATA CCW                   20000020
CKPWRITE EQU   5 .                      WRITE DATA CCW                  20200020
CKPWCKD  EQU   29 .                     WRITE COUNT KEY AND DATA        20400020
CKPSET   EQU   35 .                     SET SECTOR CCW             0415 20450000
CKPNOOP  EQU   3 .                      NO-OP CCW-USED FOR NON-    0415X20500000
                                        MERLIN SUPPORT                  20550000
         SPACE                                                          20600020
         ORG   CKPTIC+5 .               THIS PART OF TIC COMMAND IS    X20800020
                                        NOT USED BY OS                  21000020
CKPTTRLT DS    XL3 .                    TTR OF LAST TOTAL SEG WRITN     21200020
         ORG                                                            21400020
         SPACE 3                                                        21600020
*GETMAIN PARAMETER LIST                                                 21800020
         SPACE                                                          22000020
         DS    0F                                                       22200020
CKPGETML DS    XL10 .                   GETMAIN LIST                    22400020
CKPWKALN DS    H .                      LENGTH OF CKPT WORK AREA        22600020
         SPACE 3                                                        22800020
*MESSAGE BUFFER USED FOR WTO                                            23000020
         SPACE                                                          23200020
         DS    0F                                                       23400020
CKPMSG   EQU   *                                                        23600020
CKPMSGLN DS    XL2 .                    LENGTH OF MSG BUFFER            23800020
         DS    XL2                                                      24000020
CKPMSGTX DS    XL37 .                   TEXT OF MESSAGE                 24200020
CKPMSGTP DS    XL20 .                   TYPE OF CHECKPOINT RECORD       24400020
CKPMSGGL DS    XL4 .                    GETMAIN LENGTH WHICH COULD     X24600020
                                        NOT BE SATISFIED                24800020
CKPMSGL  EQU   *-CKPMSG                                                 25000020
         ORG   CKPMSGTP+6                                               25200020
CKPMSGPN DS    XL8                                                      25400020
         ORG                                                            25600020
         SPACE 3                                                        25800020
*THE MESSAGE BUFFER IS SOMETIMES USED FOR TEMPORARY STORAGE             26000020
         SPACE                                                          26200020
         ORG   CKPMSGTX                                                 26400020
CKPSAVE2 DS    15F                                                      26600020
CKPTRMAD DS    F .                      ADDRESS OF TERM ENTRY-USED     *26800020
                                        TO GET IT ON WORD BOUNDARY      27000020
         ORG   CKPMSGTP                                                 27200020
CKPRCDSR DS    H .                      NO. RECDS(SEGMENTS)REQUIRED    X27400020
                                        FOR ONE ENV. CHECKPOINT         27600020
CKPTRKLN DS    H .                      LENGTH OF DATA ON A TRACK  0415X27700000
                                        PRECEDING THE CURRENT RECRD0415 27800000
CKPTRKSA DS    H .                      NO.AVAILABLE TRACKS (IN        X28000020
                                        DATA SET)                       28200020
         ORG                                                            28400020
         SPACE 3                                                        28600020
*CHECKPOINT CONTROL RECORD -WRITTEN EVERY TIME AN ENVIRONMENT           28800020
*RECORD IS WRITTEN                                                      29000020
         SPACE                                                          29200020
         DS    0F                                                       29400020
CKPCNTLR EQU   * .                      BEGINNING OF CONTROL RCD        29600020
         SPACE 3                                                        29609000
CKPFLAGS DS    X .                      CONTROL RECORD FLAGS            29800020
CKPNORML EQU   X'80' .                  INDICATES NORMAL CLOSEDOWN      30000020
CKPOPNEN EQU   X'40' .                  OPEN-ENVIRONMENT FLAG           30200020
CKPFSCN1 EQU   X'40' .                  FIFO SCAN 1 IN PROGRESS SA51078 30300022
CKPOPNIN EQU   X'20' .                  OPEN-INCIDENT FLAG              30400020
CKPFSCN2 EQU   X'20' .                  FIFO SCAN 2 IN PROGRESS SA51078 30500022
CKPOPNCR EQU   X'10' .                  OPEN CKREQ FLAG                 30600020
CKPERR   EQU   X'08' .                  INDICATES NO ENVIORNMENT   0818X30800020
                                        RECORDS ARE AVAIBLE-DISK ER0818 31000020
CKPSTAIN EQU   X'04' .                  VALUE OF STARTUP PARAMETER     X31200020
                                        USED AT RESTART TO DETERMIN    X31400020
                                        IF INV LISTS WERE CKPT          31600020
CKPOPTFN EQU   X'02' .                  OPTION FIELDS PRESENT FOR      X31800020
                                        AT LEAST ONE SYNC PROCESS      X32000020
                                        ENTRY                           32200020
CKPOPCRD EQU   X'01' .                  INDICATES INCIDENT RECORDS 0803X32400020
                                        PRESENT FOR OPERATOR CONTROL    32600020
CKPTTRCT DS    XL1 .                    INDEX FOR CURRENT ENV CKPT      32800020
CKPINCNT DS    X .                      TOTAL NUMBER OF INCIDENT       X33000020
                                        RECORDS IN DATA SET             33200020
CKPINCNO DS    X .                      NO. OF INCIDENT RECORDS        X33400020
                                        AVAILABLE FOR USE               33600020
CKPCRRNO DS    XL1 .                    NO. OF CKREQ RECORDS           X33800020
                                        ON 1ST TRACK CONTAINING        *34000020
                                        CKREQ RECORDS                   34200020
CKPTTRCR DS    XL3 .                    TTR OF 1ST CKREQ RECORD         34400020
CKPINRNO DS    XL1 .                    NO. OF INCIDENT RECORDS        X34600020
                                        RECORD ON 1ST TRACK            *34800020
                                        CONTAINING INCIDENT RECORDS     35000020
CKPTTRIN DS    XL3 .                    TTR OF 1ST INCIDENT RECORD      35200020
CKPBPERR DS    H .                      BYTES PER ENVIRONMENT          X35400020
                                        RECORD SEGMENT                  35600020
CKPCKRQS DS    X .                      VALUE OF CKREQS FOR LAST       X35800020
                                        STARTUP-USED AT RESTART        X36000020
                                        INSTEAD OF VALUE IN AVT         36200020
CKPCPRCD DS    X .                      VALUE OF CPRCDS AT LAST        X36400020
                                        STARTUP-USED AT RESTART        X36600020
                                        INSTEAD OF VALUE IN AVT         36800020
         DS    0F .                                                     37000020
CKPIPERT DS    X .                      NO. OF INCIDENT RCDS PER TR     37200020
CKPPRQNO EQU   * .                      MAXIMUM NUMBER OF PRIORITY     X37400020
                                        LEVEL QUEUES USED BY A SYNC    X37600020
                                        PROCESS ENTRY-USED BY 1942      37800020
CKPCPERT DS    X .                      NUMBER OF CKREQ RECORDS PER    X38000020
                                        TRACK-DETERMINED BY 1942       X38200020
                                        AFTER USING CKPPRQNO            38400020
CKPCKRLN DS    H .                      LENGTH OF CKREQ RECORD-        X38600020
                                        DEPENDS ON OPTION FIELDS       X38800020
                                        AND PRIORITY LEVEL QUEUES.      39000020
CKPRPERT DS    X .                      NO. OF ENVIRONMENT RECORD      X39200020
                                        SEGMENTS PER TRACK              39400020
CKPTTRLI DS    XL3 .                    TTR OF LAST INCIDENT WRITTN     39600020
CKPINCLN DS    H .                      LENGTH OF INCIDENT RECORD       39800020
         AIF   ('&MERLIN' NE '3330').SKP3                          0419 39810000
CKPSECLT DS    H .                      DATA ON TRACK PRECEDING    0415X39820000
                                        CURRENT ENV SEGMENT        0415 39830000
CKPSECLI DS    H .                      DATA ON TRACK PRECEDING    0415X39840000
                                        CURRENT INCIDENT RECORD    0415 39850000
CKPSECCR DS    H .                      DATA ON TRACK PRECEDING    0415X39860000
                                        1ST CKREQ RECORD                39870000
CKPSECIN DS    H .                      DATA ON TRACK PRECEDING    0415X39880000
                                        1ST INCIDENT RECORD        0415 39890000
.SKP3    ANOP                                                      0419 39900000
CKPTTRT1 EQU   * .                      3 BYTE TTR FOR 1ST ENV         X40000020
                                        ALL OTHER TTRS FOLLOW THIS      40200020
CKPSECT1 EQU   CKPTTRT1+3 .             DATA ON TRACK PRECEDING    0415X40220000
                                        1ST SEG OF ENV RECORD      0415 40240000
         AIF   ('&MERLIN' NE '3330').SKP4                          0419 40260000
CKPTTRLN EQU   5 .                      LENGTH OF ENTRY FOR ENV RCD0415 40280000
         AGO   .TTRLN                                              0419 40300000
.SKP4    ANOP                                                      0419 40320000
CKPTTRLN EQU   3 .                      LENGTH OF ENTRY FOR ENV RCD0419 40340000
.TTRLN   ANOP                                                      0419 40360000
CKPCREND EQU   * .                      END OF CONTROL RECORD           40400020
         SPACE 3                                                        40409000
*MAPPING FOR THE CONTROL RECORD FOR A 3705 CKECKPOINT DATA SET @Y17XAXF 40418000
         SPACE                                                          40427000
         ORG   CKPCNTLR                                                 40436000
         DS    H .                      RESERVED               @Y17XAXF 40445000
CKPTRSTA DS    XL1 .                    STATUS FLAGS           @Y17XAXF 40454000
CKPSWTCH DS    XL1 .                    SWITCHES               @Y17XAXF 40463000
CKPIPLTX DS    CL8 .                    IPL TEXT NAME          @Y17XAXF 40472000
CKPBLKSZ DS    H .                      BLOCK SIZE             @Y17XAXF 40481000
         DS    H .                      RESERVED               @Y17XAXF 40490000
CKPTRKCN DS    H .                      TRACK CONSTANT USED FOR         40499000
*                                        ALTERNATE TRACK ASSIGNMENT     40508000
*                                                              @Y17XAXF 40517000
         DS    H .                      RESERVED               @Y17XAXF 40526000
CKPBLKPT DS    AL1 .                    BLOCKS PER TRACK       @Y17XAXF 40535000
         DS    XL1 .                    RESERVED               @Y17XAXF 40544000
CKPDATTM DS    0CL8 .                   DATE AND TIME          @Y17XAXF 40553000
CKPDATE  DS    CL4 .                     DATE                  @Y17XAXF 40562000
CKPTIME  DS    CL4 .                     TIME                  @Y17XAXF 40571000
CKPBCKUP DS    CL8 .                    BACKUP NAME            @Y17XAXF 40580000
         ORG                                                            40589000
         SPACE 3                                                        40600020
*THE FOLLOWING EQUATE MAY BE VARIED IN ORDER TO CHANGE THE SIZE OF      40800020
*AN ENVIRONMENT RECORD SEGMENT. THE ONLY MODULE WHICH MUST BE           41000020
*REASSEMBLED IS IGG01949.                                               41200020
         SPACE                                                          41400020
CKPENVL  EQU   300 .                    LENGTH OF ENVIRONMENT RCD      X41600020
                                        SEGMENT                         41800020
         SPACE 3                                                        42000020
*EQUATED CONSTANTS USED BY THE CHECKPOINT MODULES                       42200020
         SPACE                                                          42400020
CKPPOST  EQU   X'40' .                  ECB POSTED                      42600020
CKP101   EQU   256 .                    CONSTANT USED TO BUMP TRACK     42800020
CKP100   EQU   100                                                      43000020
CKPCKRNO EQU   3 .                      NO. EXTRA CKREQ RCDS-DSK ERR    43200020
CKPCMDCH EQU   X'42' .                  INDICATE COMMAND CHAINING       43400020
CKPRETNL EQU   4 .                      RETURN OFFSET TO CHECKPOINT     43450000
*                                        EXECUTOR FOR NO ADDITIONAL     43500000
*                                        LOAD REQUESTS         @Y17XAXF 43550000
CKPCKREQ EQU   48 .                     OFFSET FOR CKREQ ROUTINE        43600020
CKPENV   EQU   56 .                     OFFSET FOR ENV ROUTINE          43800020
CKPIOQM  EQU   64 .                     OFFSET FOR I/O QUEUE MANAGR     44000020
CKPDIOR  EQU   72 .                     OFFSET FOR DISK I/O ROUTINE     44200020
CKPNOTIF EQU   80 .                     OFFSET FOR NOTIF RTN            44400020
CKPNOCOR EQU   88 .                     OFFSET FOR NO AVAIL CORE        44600020
CKPNOINC EQU   96 .                     OFFSET FOR INCIDENT OVERFLO     44800020
CKPCNCP  EQU   104 .                    OFFSET FOR 3705 CHECKPOINT      44805000
*                                         ROUTINE              @Y17XAXF 44810000
CKPRNCP  EQU   112 .                    OFFSET FOR 3705 RESTART ROUTINE 44815000
*                                                              @Y17XAXF 44820000
CKPCNCPW EQU   120 .                    OFFSET FOR 3705 CHECKPOINT      44825000
*                                        WRITE ROUTINE         @Y17XAXF 44830000
CKPOPLTL EQU   10 .                     LENGTH OF OPT LENGTH ENTRY      45000020
CKP1BYTE EQU   8 .                      USED TO SHIFT 1 BYTE       0415 45010000
CKP2BYTE EQU   16 .                     USED TO SHIFT 2 BYTES      0415 45020000
CKP3BYTE EQU   24 .                     USED TO SHIFT 3 BYTES      0415 45030000
CKPCVTPT EQU   16 .                     ADDRESS OF CVT POINTER     0415 45040000
CKPCNTTR EQU   28 .                     DISPLACEMENT OF TTR CONVERT0415X45050000
                                        ROUTINE ADDR IN CVT        0415 45060000
CKPCNSEC EQU   232 .                    DISPLACEMENT OF SECTOR     0415X45070000
                                        ROUTINE ADDR IN CVT        0415 45080000
CKPDELMT EQU   C'*' .                   DELIMITER PLACED IN ENV RCD0422X45090000
                                        BETWEEN DATA FOR EACH TERM 0422 45100000
CKPQDELM EQU   X'6C'                    DELIMITER FOR QCB ON            45103010
*                                        ENVIRONMENT RECORD    @OX16402 45106010
CKPDELLN EQU   1 .                      LENGTH OF DELIMITER FIELD  0422 45110000
CKPLTRLN EQU   1 .                      LENGTH OF LCBTRACE FLD @Y17XAXF 45130000
         SPACE 3                                                        45200020
*LENGTHS OF CHECKPOINTED FIELDS                                         45400020
         SPACE                                                          45600020
CKPSEQCT EQU   6 .                      LENGTH OF SEQ NUMBERS AND      *45800020
                                        COUNT OF MSGS ON QUEUE          46000020
CKPSEQLN EQU   4 .                      LENGTH OF SEQUENCE NO.FIELD     46200020
CKPSENSE EQU   1                        LENGTH OF SENSE FIELD   SA67099 46250000
CKPMCTLN EQU   2 .                      LENGTH OF COUNT FIELD           46400020
CKPTRMLN EQU   1 .                      LENGTH OF TRM STATUS FIELD      46600020
CKPQCBLN EQU   21 .                     LENGTH OF PRIORITY LEVEL       X46800020
                                        QCB DISK POINTERS               47000020
CKPMQBLN EQU   6                        LENGTH OF MASTER QCB            47200010
*                                        FIELDS PLUS DELIMITER @OX16402 47250010
CKPQBKLN EQU   3 .                      LENGTH OF QBACK POINTER         47400020
CKPLCBLN EQU   2 .                      LENGTH OF LCB STAT INFO    0918 47800020
CKPDCBLN EQU   1 .                      LENGTH OF DCB FIELDS       0731 48000020
CKPEND   EQU   * .                      END OF CKP WORK AREA            48200020
CKPLNGTH EQU   CKPEND-IEDQCKPD .        LNGTH OF FIXED PORTION OF      *48400020
                                        CKPT WORK AREA                  48600020
         SPACE 3                                                        48800020
*THE OPERATOR CONTROL INCIDENT CHECKPOINT RECORD CONTAINS THE DATA 0629 49000020
*DEFINED IN OPERATOR CONTROL DSECT-OPCCKELE.   THE FOLLOWING DATA IS    49200020
*INCLUDED IN THE 32 BYTES .                                             49400020
         SPACE                                                          49600020
CKPOCODE EQU   0 .                      COMMAND OPERATION TYPE          49800000
CKPOCSWC EQU   1 .                      OPERATION SUB-TYPE              50000000
CKPOCFLG EQU   2                        FLAG BYTE                       50200000
         SPACE 1                                                        50400000
CKPOCREL EQU   3 .                      RELATIVE LINE NUMBER            50600000
CKPALL   EQU   X'00' .                  INDICATES 'ALL' - NO RLN        50800000
         SPACE 1                                                        51000000
CKPOCLNO EQU   10                       HEX LINE NUMBER                 51200000
CKPOCNAM EQU   20 .                     DDNAME FOR START/STOP CMD       51400000
CKPOCLST EQU   28                       ILIST ADDRESS                   51600000
         SPACE 3                                                        51800020
*FORMAT OF CKREQ-TTR TABLE    IT IS LOCATED AT THE END OF THE WORK      52000020
*AREA.  THE NUMBER OF ENTRIES DEPENDS ON THE VALUE OF CKREQS ON         52200020
*INTRO; A CONSTANT VALUE IS ADDED TO IT FOR DISK ERRORS.                52400020
         SPACE                                                          52600020
         AIF   ('&MERLIN' NE '3330').SKP5                          0419 52650000
CKPCTTRL EQU   8 .                      LNGTH CKREQ TTR TABLE ENTRY0415 52700000
         AGO   .CTTRL                                              0419 52750000
.SKP5    ANOP                                                      0419 52800000
CKPCTTRL EQU   6 .                      LNGTH CKREQ TTR TABLE ENTRY0419 52850000
.CTTRL   ANOP                                                      0419 52900000
CKPCTFLG EQU   0 .                      OFFSET TO FLAG IN CKREQ-TTR     53000020
CKPCTACT EQU   X'80' .                  ENTRY IS ACTIVE                 53200020
CKPCTDER EQU   X'40' .                  ENTRY HAS DISK ERROR            53400020
CKPCTTTR EQU   1 .                      OFFSET TO TTR IN CKREQ-TTR      53600020
CKPCTOFF EQU   4 .                      OFFSET TO TERM OFFSET           53800020
CKPCTSEC EQU   6 .                      DATA ON TRACK PRECEDING    0415X53860000
                                        THIS CKREQ RECORD          0415 53920000
         EJECT                                                          54000020
*DSECT FOR INCIDENT OR ENVIRONMENT CHECKPOINT DISK RECORD               54200020
         SPACE                                                          54400020
IEDQCDRD DSECT                                                          54600020
CDRDATE  DS    F .                      DATE OF CHECKPOINT              54800020
CDRTIME  DS    F .                      TIME WHEN RECORD WRITTEN        55000020
CDRKEY   DS    XL1 .                    KEY FIELD                       55200020
CDRLCB   EQU   0 .                      KEY FOR LCB                     55400020
CDRCHNGT EQU   4 .                      KEY FOR CHNGT                   55600020
CDROPC   EQU   16 .                     KEY FOR OPERATOR CONTROL        55800020
CDRCKREQ EQU   24 .                     KEY FOR CKREQ                   56000020
CDRTOTAL EQU   28 .                     KEY FOR TOTAL                   56200020
CDRTOTLC EQU   32 .                     KEY FOR TOTAL-CONTINUED         56400020
CDRTTRLI DS    XL3                      TTR OF LAST INCIDENT,AT    0922X56600020
                                        TIME OF THIS ENV CKPT           56800020
CDRDATA  EQU   * .                      BEGINNING OF DATA IN SEG        57000020
CDRTINFO EQU   CDRDATA-IEDQCDRD .       LENGTH OF TOTAL INFO-NON-      X57200020
                                        DATA                            57400020
         SPACE 3                                                        57600020
*FORMAT OF INCIDENT RECORDS                                             57800020
         SPACE                                                          58000020
         ORG   CDRTTRLI                                            0922 58200020
CDRSTAT  DS    XL1 .                    TERMINAL STATUS                 58400020
CDROFFS  DS    H .                      OFFSET TO TERMNAME TABLE        58600020
CDRSEQIN DS    H .                      INPUT SEQUENCE NUMBER      1007 58800020
CDRSEQOU DS    H .                      OUTPUT SEQUENCE NUMBER     1007 59000020
         SPACE 3                                                        59200020
CDROPTN  EQU   * .                      BEGINNING OF OPTIONS            59400020
         ORG   CDRDATA                                                  59500000
CDROPCB  DS    F .                      BEGINNING OF OP CONTROL BLK     59600020
CDROPCBL EQU   36 .                     LENGTH OF OPERATOR CONTROL     X59800000
                                        BLOCK                           60000020
         SPACE 3                                                        60200020
*CKREQ RECORD                                                           60400020
         SPACE                                                          60600020
         ORG   IEDQCDRD                                                 60800020
CDRCKFLG DS    X .                      FLAG BITS                       61000020
CDRCKRNC EQU   X'80' .                  CKREQ IS NOT COMPLETED          61200020
         DS    XL3 .                    USED FOR LINK -I/O QUEUE        61400020
CDRCKIN  DS    H .                      INPUT SEQUENCE NUMBER           61600020
CDRCKOUT DS    H .                      OUTPUT SEQUENCE NUMBER          61800020
*CDRKEY  EQU   *                        RECORD KEY                      62000020
         DS    X .                                                      62200020
         DS    X .                      USED ONLY FOR ALIGNMENT         62400020
CDRCKOFF DS    H .                      TERM OFFSET                     62600020
CDRCKMSG DS    XL2 .                    QCB MSG COUNT                   62800020
CDRCKQBC DS    XL3 .                    QBACK POINTER                   63000020
CDRCKQCB DS    XL21 .                   QCB DISK POINTERS (THIS        X63200020
                                        FIELD IS REPEATED FOR EACH     X63400020
                                        PRIORITY LEVEL QCB)             63600020
CDRCKPQB DS    XL3 .                    PRILEVEL QBACK PTR      SA51078 63700022
CDRCKOPT EQU   * .                      OPTION FIELD                    63800020
         EJECT                                                          64000020
*DSECT FOR CHECKPOINT REQUEST ELEMENT(INCIDENT OR CKREQ).  THE          64200020
*ENVIRONMENT CHECKPOINT REQUEST ELEMENT IS DEFINED IN THE AVT.          64400020
         SPACE                                                          64600020
IEDQCRED DSECT                                                          64800020
CREKEY   DS    X .                                                      65000020
CRELCB   EQU   X'00' .                  KEY FOR LCB FROM CHECKPT        65200020
CRECHNGT EQU   X'10' .                  KEY FOR TCHNG FROM APP PROG     65400020
CREREMVE EQU   X'20' .                  KEY FOR TIME DELAY QUEUE       X65600020
                                        REMOVAL ELEMENT                 65800020
CREOPC   EQU   X'40' .                  KEY FOR OPERATOR CONTRO         66000020
CRECKREQ EQU   X'60' .                  KEY FOR CKREQ FROM APP PROG     66200020
CRETOTAL EQU   X'70' .                  KEY FOR TOTAL-ALL SOURCES       66400020
CREINCOF EQU   X'80' .                  KEY FLAG-INCIDENT OVERFLOW      66600020
CRECNCP  EQU   X'D0' .                  KEY FOR 3705 CHECKPOINT         66610000
*                                                              @Y17XAXF 66620000
CRERNCP  EQU   X'E0' .                  KEY FOR 3705 RESTART   @Y17XAXF 66630000
CREQCBAD DS    XL3 .                                                    66800020
CREPRI   DS    0XL1                     PRIORITY OF REQUEST ELEMENT     66810000
*                                        LINK OF REQUEST ELEMENT        66820000
*                                                              @Y17XAXF 66830000
CRELINK  DS    F .                                                      67000020
CREECB   DS    F .                      ADDR OF ECB                     67200020
CREDEB   EQU   * .                      DEB CHAIN FOR CKREQ             67400020
CREOFFS  DS    H .                      OFFSET OF TERMNAME ENTRY        67600020
         SPACE 3                                               @Y17XAXF 67600200
CKPAVT   DSECT                      CHECKPOINT AVT DSECT       @Y17XASA 67600400
CKPOPCON DS    CL2                  PRIMARY OP/CTL TERMINAL    @Y17XASA 67600600
CKPOPCIN DS    CL2                  PRIMARY OP/CTL TTCIN       @Y17XASA 67600800
CKPINTLV DS    CL2                  SYSTEM DELAY INTERVAL      @Y17XASA 67601000
CKPBIT1  DS    CL1                  AVTBIT1                    @Y17XASA 67601200
CKPBIT2  DS    CL1                  AVTBIT2                    @Y17XASA 67601400
CKPNADDR DS    CL4                  NON REUSE DISK NEXT ADDR   @Y17XASA 67601600
CKPRADDR DS    CL4                  REUSE DISK NEXT ADDR       @Y17XASA 67601800
CKPLODPT DS    CL4                  REUSE LOAD POINT FIELD     @Y17XASA 67602000
CKPSUBT  DS    CL1                  AVTSUBT SUBT= OPTION FIELD @Y17XASA 67602200
CKPIOTR  DS    CL1                  AVTIOTR IOTR= OPTION FIELD @Y17XASA 67602400
CKPAVTLN EQU   *-CKPAVT             LENGTH OF CKP AVT DSECT    @Y17XASA 67602600
         SPACE 3                                               @Y17XAXF 67602800
CKPNRES  DSECT                          FIELDS FOR NCP RESOURCE         67603000
*                                                              @Y17XACL 67603200
CKPSUBST DS    H                        SUBSTRUCT              @Y17XACL 67603400
CKPCOHRT DS    H                        COHORT                 @Y17XACL 67603600
CKPNFLG  DS    XL1                      FLAGS                  @Y17XACL 67603800
CKPREMB  EQU   X'80'                    REMEMBER               @Y17XACL 67604000
CKPRSACT EQU   X'40'                    RESOURCE ACTIVE        @Y17XACL 67604200
CKPEPMOD EQU   X'20'                    EP MODE                @Y17XACL 67604400
CKPLULOG EQU   X'10'                    ALLOW LOGON INDICATOR  @Y17XAXF 67604600
*        EQU   X'08'-X'01'              RESERVED               @Y17XACL 67604800
CKPTYPE  DS    XL1                      RESOURCE TYPE          @Y17XACL 67605000
CKPNRSZ  EQU   *-CKPNRES                LENGTH OF FIELDS CKPT'ED        67605200
*                                         FOR A 3705 RESOURCE  @Y17XACL 67605400
         MEND  */                                                       67607000
*%PLSCKP : ;                            /*                   @Y17XAXF*/ 67607500
*DCL 1 IEDQCKPD BDY(DWORD) BASED(RCKPT),                                67608000
*      2 CKPSAVE1(18) PTR(31),          /*SAVE AREA FOR LOAD            67608500
*                                         MODULE             @Y17XACL*/ 67609000
*      2 CKPIOB,                        /*IOB FOR CKPT DISK I/O         67609500
*                                                            @Y17XACL*/ 67610000
*        3 CKPIOFL1 CHAR(1),            /*FLAG BYTE 1        @Y17XACL*/ 67610500
*        3 CKPIOFL2 CHAR(1),            /*FLAG BYTE 2        @Y17XACL*/ 67611000
*        3 CKPIOSN0 CHAR(1),            /*FIRST SENSE BYTE   @Y17XACL*/ 67611500
*        3 CKPIOSN1 CHAR(1),            /*SECOND SENSE BYTE  @Y17XACL*/ 67612000
*        3 CKPIOECB PTR(31),            /*ADDRESS OF ECB     @Y17XACL*/ 67612500
*         4 CKPIOECC BIT(8),            /*COMPLETION CODE FOR I/O       67613000
*                                                            @Y17XAXF*/ 67613500
*         4 *        PTR(24),           /*RESERVED           @Y17XAXF*/ 67614000
*        3 CKPIOFL3 CHAR(1),            /*I/O ERROR FLAGS    @Y17XACL*/ 67614500
*        3 CKPIOCSW CHAR(7),            /*CSW                @Y17XACL*/ 67615000
*        3 CKPIOSIO CHAR(1),            /*START I/O CONDITION           67615500
*                                         CODES              @Y17XACL*/ 67616000
*        3 CKPIOCPA PTR(24),            /*CHANNEL PROGRAM ADDRESS       67616500
*                                                            @Y17XACL*/ 67617000
*        3 *        CHAR(1),            /*UNUSED             @Y17XACL*/ 67617500
*        3 CKPIODCB PTR(24),            /*DCB ADDRESS        @Y17XACL*/ 67618000
*        3 *        CHAR(1),            /*REPOSITION MODIFIER           67618500
*                                                            @Y17XACL*/ 67619000
*        3 CKPIORST PTR(24),            /*RESTART ADDRESS    @Y17XACL*/ 67619500
*        3 CKPIOBCI FIXED(15),          /*BLOCK CNT INCREMENT           67620000
*                                                            @Y17XACL*/ 67620500
*        3 CKPIORC  FIXED(15),          /*ERROR COUNT        @Y17XACL*/ 67621000
*        3 CKPIOSK  CHAR(8),            /*SEEK ADDRESS       @Y17XACL*/ 67621500
*          4 CKPIOM   CHAR(1),          /*DEB EXTENT         @Y17XACL*/ 67622000
*          4 CKPIOBB  CHAR(2),          /*BIN NUMBER         @Y17XACL*/ 67622500
*          4 CKPIOCC  CHAR(2),          /*CYLINDER NUMBER    @Y17XACL*/ 67623000
*          4 CKPIOHH  CHAR(2),          /*TRACK NUMBER       @Y17XACL*/ 67623500
*          4 CKPIOR   CHAR(1),          /*RECORD NUMBER      @Y17XACL*/ 67624000
*      2 CKPECB   PTR(31),              /*ECB POSTED BY IOS  @Y17XACL*/ 67624500
*      2 CKPEXCP  PTR(31),              /*CURRENT RECORD BEING          67625000
*                                         WRITTEN            @Y17XACL*/ 67625500
*      2 CKPECBL  CHAR(8),              /*ECB LIST FOR WAIT  @Y17XACL*/ 67626000
*        3 CKPCNVRT CHAR(8),            /*USED FOR CVD CONVERSION       67626500
*                                                            @Y17XACL*/ 67627000
*          4 CKPEPLOC CHAR(8),          /*EPLOC FOR LOAD MACRO          67627500
*                                                            @Y17XACL*/ 67628000
*      2 CKPIOQF  PTR(31),              /*DISK I/O QUEUE - FIRST        67628500
*                                         RECORD             @Y17XACL*/ 67629000
*      2 CKPIOQL  PTR(31),              /*DISK I/O QUEUE - LAST         67629500
*                                         RECORD             @Y17XACL*/ 67630000
*        3 * BIT(8),                    /*STATUS BYTE        @Y17XACL*/ 67630500
*          4 CKPNDRB  BIT(1),           /*INDICATES NO DISK RECORD      67631000
*                                         BUILT FOR NEXT REQUEST        67631500
*                                         ELEMENT            @Y17XACL*/ 67632000
*      2 CKPLREB  PTR(31),              /*ADDR OF LAST REQUEST ELEMENT  67632500
*                                         FOR WHICH RECORD WAS          67633000
*                                         BUILT              @Y17XACL*/ 67633500
*      2 CKPLDRB  PTR(31),              /*ADDR OF LAST DISK RECORD      67634000
*                                                            @Y17XACL*/ 67634500
*      2 CKPCTTRB PTR(31),              /*BEGINNING OF CKREQ TTR        67635000
*                                         TABLE              @Y17XACL*/ 67635500
*        3 CKPSECTR BIT(8),             /*SECTOR ID FOR SET SECTOR      67636000
*                                         COMMAND            @Y17XACL*/ 67636500
*      2 CKPCPARM CHAR(8),              /*PARAMETERS FOR CONVERT        67637000
*                                         ROUTINE ADDRESS OF DEB AND    67637500
*                                         ADDRESS FOR CONVERSION        67638000
*                                         RESULT             @Y17XACL*/ 67638500
*      2 CKPPARM2 PTR(31),              /*PARAMETER FOR SECTOR          67639000
*                                         CONVERSION ROUTINE (UCB TYPE  67639500
*                                         AND ADDRESS)       @Y17XACL*/ 67640000
*      2 CKPCRLEN CHAR(1),              /*LENGTH OF CONTROL RECORD      67640500
*                                                            @Y17XACL*/ 67641000
*      2 CKPSWCH1 CHAR(1),              /*SWITCH FOR COMPARING QCB TO   67641500
*                                         SEE IF IT HAS BEEN            67642000
*                                         CHECKPOINTED       @Y17XACL*/ 67642500
*      2 CKPSWCH2 CHAR(1),              /*SWITCH FOR COMPARING WITH     67643000
*                                         INVITATION LIST TO SEE IF IT  67643500
*                                         HAS BEEN CHECKPOINTED         67644000
*                                                            @Y17XACL*/ 67644500
*      2 CKPERRCT CHAR(1),              /*COUNT OF ERRORS ENCOUNTERED   67645000
*                                                            @Y17XACL*/ 67645500
*      2 *        FIXED(31),            /*UNUSED             @Y17XACL*/ 67646000
*      2 CKPCCWS,                       /*CHANNEL PROGRAM    @Y17XACL*/ 67646500
*        3 CKPSEEKC CHAR(8),            /*SEEK CYLINDER      @Y17XACL*/ 67647000
*        3 CKPSETSC CHAR(8),            /*SET SECTOR OR NOOP @Y17XACL*/ 67647500
*        3 CKPSCHID CHAR(8),            /*SEARCH ID          @Y17XACL*/ 67648000
*        3 CKPTIC   CHAR(8),            /*TIC                @Y17XACL*/ 67648500
*        3 CKPRW,                       /*READ/WRITE         @Y17XACL*/ 67649000
*         4 CKPRWCMD BIT(8),            /*COMMAND CODE       @Y17XAXF*/ 67649500
*         4 CKPRWADD PTR(24),           /*DATA ADDRESS       @Y17XAXF*/ 67650000
*         4 CKPRWFLG BIT(8),            /*FLAGS              @Y17XAXF*/ 67650500
*         4 *        BIT(8),            /*RESERVED           @Y17XAXF*/ 67651000
*         4 CKPRWBC  FIXED(15),         /*BYTE COUNT         @Y17XAXF*/ 67651500
*      2 * BDY(WORD),                   /*GETMAIN PARAMETER             67652000
*                                         LIST               @Y17XACL*/ 67652500
*        3 CKPGETML CHAR(10),           /*GETMAIN LIST       @Y17XACL*/ 67653000
*        3 CKPWKALN FIXED(15),          /*LENGTH OF CKPT WORK AREA      67653500
*                                                            @Y17XACL*/ 67654000
*      2 CKPMSG BDY(WORD),              /*MESSAGE BUFFER USED FOR WTO   67654500
*                                                            @Y17XACL*/ 67655000
*        3 CKPMSGLN FIXED(15),          /*LENGTH OF MSG BUFFER          67655500
*                                                            @Y17XACL*/ 67656000
*        3 *        FIXED(15),          /*                   @Y17XACL*/ 67656500
*        3 CKPMSGTX CHAR(37),           /*TEXT OF MESSAGE    @Y17XACL*/ 67657000
*        3 CKPMSGTP CHAR(20),           /*TYPE OF CKPT RECORD           67657500
*                                                            @Y17XACL*/ 67658000
*        3 CKPMSGGL CHAR(4),            /*GETMAIN LENGTH WHICH COULD    67658500
*                                         NOT BE SATISFIED   @Y17XACL*/ 67659000
*        3 *        CHAR(3),            /*UNUSED             @Y17XACL*/ 67659500
*      2 CKPCNTLR BDY(WORD),            /*CHECKPOINT CONTROL RECORD -   67660000
*                                         WRITTEN EVERY TIME AN         67660500
*                                         ENVIRONMENT RECORD IS         67661000
*                                         WRITTEN            @Y17XACL*/ 67661500
*        3 CKPFLAGS BIT(8),             /*CONTROL RECORD FLAGS          67662000
*                                                            @Y17XACL*/ 67662500
*          4 CKPNORML BIT(1),           /*NORMAL CLOSEDOWN   @Y17XACL*/ 67663000
*          4 CKPFSCN1 BIT(1),           /*FIFO SCAN 1 IN PROGRESS       67663500
*                                                            @Y17XACL*/ 67664000
*          4 CKPFSCN2 BIT(1),           /*FIFO SCAN 2 IN PROGRESS       67664500
*                                                            @Y17XACL*/ 67665000
*          4 *        BIT(1),           /*                   @Y17XACL*/ 67665500
*          4 CKPERR   BIT(1),           /*INDICATES NO ENVIRONMENT      67666000
*                                         RECORDS ARE AVAILABLE         67666500
*                                                            @Y17XACL*/ 67667000
*          4 CKPSTAIN BIT(1),           /*VALUE OF STARTUP PARAMETER    67667500
*                                         USED AT RESTART TO DETERMINE  67668000
*                                         IF INVITATION LISTS WERE      67668500
*                                         CHECKPOINTED       @Y17XACL*/ 67669000
*          4 CKPOPTFN BIT(1),           /*OPTION FIELDS PRESENT FOR AT  67669500
*                                         LEAST ONE SYNC PROCESS ENTRY  67670000
*                                                            @Y17XACL*/ 67670500
*          4 CKPOPCRD BIT(1),           /*INDICATES INCIDENT RECORDS    67671000
*                                         PRESENT FOR OPCTL  @Y17XACL*/ 67671500
*        3 CKPTTRCT  CHAR(1),           /*INDEX FOR CURRENT ENVIRONMENT 67672000
*                                         CHECKPOINT         @Y17XACL*/ 67672500
*        3 CKPINCNT  CHAR(1),           /*TOTAL NUMBER OF INCIDENT      67673000
*                                         RECORDS IN DATA    @Y17XACL*/ 67673500
*        3 CKPINCNO  CHAR(1),           /*NUMBER OF INCIDENT RECORDS    67674000
*                                         AVAILABLE FOR USE  @Y17XACL*/ 67674500
*        3 CKPCRRNO  CHAR(1),           /*NUMBER OF CKREQ RECORDS ON    67675000
*                                         FIRST TRACK CONTAINING CKREQ  67675500
*                                         RECORDS            @Y17XACL*/ 67676000
*        3 CKPTTRCR  CHAR(3),           /*TTR OF FIRST CKREQ RECORD     67676500
*                                                            @Y17XACL*/ 67677000
*        3 CKPINRNO  CHAR(1),           /*NUMBER OF INCIDENT RECORDS ON 67677500
*                                         FIRST TRACK CONTAINING        67678000
*                                         INCIDENT RECORDS   @Y17XACL*/ 67678500
*        3 CKPTTRIN  CHAR(3),           /*TTR OF FIRST INCIDENT RECORD  67679000
*                                                            @Y17XACL*/ 67679500
*        3 CKPBPERR  FIXED(15),         /*BYTES PER ENVIRONMENT RECORD  67680000
*                                         SEGMENT            @Y17XACL*/ 67680500
*        3 CKPCKRQS  CHAR(1),           /*VALUE OF CKREQ FOR LAST       67681000
*                                         STARTUP - USED AT RESTART     67681500
*                                         INSTEAD OF VALUE IN AVT       67682000
*                                                            @Y17XACL*/ 67682500
*        3 CKPCPRCD  CHAR(1),           /*VALUE OF CPRCDS AT LAST       67683000
*                                         STARTUP - USED AT RESTART     67683500
*                                         INSTEAD OF VALUE IN AVT       67684000
*                                                            @Y17XACL*/ 67684500
*        3 CKPIPERT  CHAR(1),           /*NUMBER OF INCIDENT RECORDS    67685000
*                                         PER TRACK          @Y17XACL*/ 67685500
*        3 CKPPRQNO  CHAR(1),           /*MAXIMUM NUMBER OF PRIORITY    67686000
*                                         LEVEL QUEUES USED BY A        67686500
*                                         SYNC PROCESS ENTRY - USED     67687000
*                                         BY IGG01942        @Y17XACL*/ 67687500
*          4 CKPCPERT CHAR(1),          /*NUMBER OF CKREQ RECORDS PER   67688000
*                                         TRACK - DETERMINED BY         67688500
*                                         IGG01942           @Y17XACL*/ 67689000
*        3 CKPCKRLN  FIXED(15),         /*LENGTH OF CKREQ RECORD -      67689500
*                                         DEPENDS ON OPTION FIELDS AND  67690000
*                                         PRIORITY LEVEL QUEUES         67690500
*                                                            @Y17XACL*/ 67691000
*        3 CKPRPERT  CHAR(1),           /*NUMBER OF ENVIRONMENT RECORD  67691500
*                                         SEGMENTS PER TRACK @Y17XACL*/ 67692000
*        3 CKPTTRLI  CHAR(3),           /*TTR OF LAST INCIDENT WRITTEN  67692500
*                                                            @Y17XACL*/ 67693000
*        3 CKPINCLN  FIXED(15),         /*LENGTH OF INCIDENT RECORD     67693500
*                                                            @Y17XACL*/ 67694000
*        3 CKPSECLT  FIXED(15),         /*DATA ON TRACK PRECEDING       67694500
*                                         CURRENT ENV SEGMENT           67695000
*                                                            @Y17XACL*/ 67695500
*        3 CKPSECLI  FIXED(15),         /*DATA ON TRACK PRECEDING       67696000
*                                         CURRENT INCIDENT RECORDS      67696500
*                                                            @Y17XACL*/ 67697000
*        3 CKPSECCR  FIXED(15),         /*DATA ON TRACK PRECEDING 1ST   67697500
*                                         CKREQ RECORD       @Y17XACL*/ 67698000
*        3 CKPSECIN  FIXED(15),         /*DATA ON TRACK PRECEDING 1ST   67698500
*                                         INCIDENT RECORD    @Y17XACL*/ 67699000
*        3 CKPTTRT1  CHAR(3),           /*TTR FOR FIRST ENVIRONMENT     67699500
*                                                            @Y17XACL*/ 67700000
*        3 CKPSECT1  CHAR(2);           /*DATA ON TRACK PRECEEDING 1ST  67700500
*                                         SEG OF ENV RECORD  @Y17XACL*/ 67701000
*DCL 1 CKPINIT DEFINED(CKPEXCP),        /*OPEN WORK AREA     @Y17XACL*/ 67701500
*      2 CKPCYLNO CHAR(2),              /*CYLINDER NUMBER    @Y17XACL*/ 67702000
*      2 CKPHEDNO CHAR(2),              /*HEAD NUMBER        @Y17XACL*/ 67702500
*      2 CKPRCDNO CHAR(1),              /*RECORD NUMBER      @Y17XACL*/ 67703000
*      2 CKPKEYLN CHAR(1),              /*KEY LENGTH         @Y17XACL*/ 67703500
*      2 CKPDATLN CHAR(2),              /*DATA LENGTH        @Y17XACL*/ 67704000
*      2 CKPCTTRC PTR(31),              /*CURRENT ENTRY IN CKREQ - TTR  67704500
*                                         TABLE (USED AT RESTART)       67705000
*                                                            @Y17XACL*/ 67705500
*      2 CKPDATIM CHAR(8),              /*DATE, TIME, AND TOTAL CKPT    67706000
*                                         USED TO COMPARE WITH INCIDENT 67706500
*                                         CKPT'S             @Y17XACL*/ 67707000
*      2 CKPIPERE FIXED(15),            /*NUMBER OF INCIDENTS OR CKREQ  67707500
*                                         IN ONE ENVIRONMENT RECORD     67708000
*                                         SEGMENT            @Y17XACL*/ 67708500
*      2 *        FIXED(15),            /*                   @Y17XACL*/ 67709000
*      2 CKPCTTRA PTR(31);              /*ADDRESS OF TTR OF THE         67709500
*                                         ENVIRONMENT RECORD BEING USED 67710000
*                                         FOR RESTART        @Y17XACL*/ 67710500
*DCL CKPTTRLT PTR(24) DEFINED(CKPTIC) POS(6);/*OVERLAY UNUSED PORTION   67711000
*                                              OF TIC WITH TTR OF LAST  67711500
*                                              TOTAL SEGMENT WRITTEN    67712000
*                                                            @Y17XACL*/ 67712500
*DCL CKPMSGPN CHAR(8) DEFINED(CKPMSGTP) POS(7);/*            @Y17XACL*/ 67713000
*DCL 1 CKPTWA DEFINED(CKPMSGTX),        /*OVERLAY MESSAGE BUFFER WITH   67713500
*                                         WORK AREA          @Y17XACL*/ 67714000
*      2 CKPSAVE2(15) PTR(31),          /*SAVE AREA          @Y17XACL*/ 67714500
*      2 CKPTRMAD     PTR(31);          /*ADDRESS OF TRM ENTRY          67715000
*                                                            @Y17XACL*/ 67715500
*DCL 1 CKPNCNTL DEF(CKPCNTLR),          /*MAPPING FOR THE CONTROL       67716000
*                                         RECORD FOR A 3705 CHECKPOINT  67716500
*                                         DATA SET           @Y17XAXF*/ 67717000
*     2 *        FIXED(15),             /*RESERVED           @Y17XAXF*/ 67717500
*     2 CKPTRSTA BIT(8),                /*STATUS FLAGS       @Y17XAXF*/ 67718000
*     2 CKPSWTCH BIT(8),                /*SWITCHES           @Y17XAXF*/ 67718500
*     2 CKPIPLTX CHAR(8),               /*IPL TEXT NAME      @Y17XAXF*/ 67719000
*     2 CKPBLKSZ FIXED(15),             /*BLOCK SIZE         @Y17XAXF*/ 67719500
*     2 *        FIXED(15),             /*RESERVED           @Y17XAXF*/ 67720000
*      2 CKPTRKCN FIXED(15),            /*TRACK CONSTANT USED FOR       67720500
*                                         ALTERNATE TRACK ASSIGNMENT    67721000
*                                                            @Y17XAXF*/ 67721500
*      2 *        FIXED(15),            /*RESERVED           @Y17XAXF*/ 67722000
*      2 CKPBLKPT FIXED(8),             /*BLOCKS PER TRACK   @Y17XAXF*/ 67722500
*      2 *        FIXED(8),             /*RESERVED           @Y17XAXF*/ 67723000
*      2 CKPDATTM CHAR(8),              /*DATE AND TIME      @Y17XAXF*/ 67723500
*       3 CKPDATE  CHAR(4),             /*DATE               @Y17XAXF*/ 67724000
*       3 CKPTIME  CHAR(4),             /*TIME               @Y17XAXF*/ 67724500
*      2 CKPBCKUP CHAR(8);              /*BACKUP NAME        @Y17XAXF*/ 67725000
*                                       /*                   @Y17XAXF*/ 67725500
*DCL 1 CKPNFLDS DEF(CKPEXCP),           /*DATA AREAS USED BY CHECKPOINT 67726000
*                                         SUBTASK FOR 3705 CKECKPOINT   67726500
*                                                            @Y17XAXF*/ 67727000
*      2 *        CHAR(7),              /*RESERVED           @Y17XAXF*/ 67727500
*      2 CKPENCDE FIXED(8),             /*ENTRY CODE         @Y17XAXF*/ 67728000
*      2 CKPNTTE  PTR(31),              /*ADDRESS OF TERMINAL ENTRY     67728500
*                                         ENTRY PREFIX FOR THE 3705     67729000
*                                                            @Y17XAXF*/ 67729500
*      2 CKPNDEVF PTR(31),              /*ADDRESS OF DEVICE DEPENDENT   67730000
*                                         FIELDS FOR THE 3705           67730500
*                                                            @Y17XAXF*/ 67731000
*      2 CKPNSELT BIT(32),              /*SELECTOR FIELDS    @Y17XAXF*/ 67731500
*       3 CKPCUSEL FIXED(8),            /*CURRENT SELECT VALUE          67732000
*                                                            @Y17XAXF*/ 67732500
*       3 CKPSLNEW CHAR(3),             /*NEW SELECT VALUES TO BE       67733000
*                                         SHIFTED            @Y17XAXF*/ 67733100
*      2 CKPNTRK FIXED(15),             /*ALTERNATE RECORD INDICATOR    67733200
*                                                            @Y17XAXF*/ 67733500
*      2 CKPNRSID FIXED(15);            /*RESOURCE TO BE CHECKPOINTED   67734000
*                                         OR RESTARTED       @Y17XAXF*/ 67734500
*        @SPACE (2);                                                    67735000
* DCL CKPSLVAL CHAR(3) DEF(CKPNSELT);   /*CURRENT SELECT VALUES USED IN 67735500
*                                         SELECT VALUE SHIFT @Y17XAXF*/ 67736000
* DCL CKPNOTFY BIT(8) CONSTANT('0A'X);  /*SELECT VALUE FOR REQUEST FOR  67736500
*                                         NOTIFICATION       @Y17XAXF*/ 67737000
*                                       /*                   @Y17XAXF*/ 67737500
*/*CKPENCDE VALUES                                           @Y17XAXF*/ 67738000
* DCL CKPIOERR FIXED(8) CONSTANT(40);   /*3705 CHECKPOINT I/O ERROR     67738500
*                                                            @Y17XAXF*/ 67739000
* DCL CKPGETFL FIXED(8) CONSTANT(4);    /*GETMAIN FOR 3705 RESOURCE     67739500
*                                         RECORD FAILED      @Y17XAXF*/ 67740000
* DCL CKPEODAT FIXED(8) CONSTANT(8);    /*END OF 3705 CHECKPOINT DATA   67740500
*                                         SET REACHED        @Y17XAXF*/ 67741000
*DCL 1 CKPOVER DEFINED(CKPMSGTP) POS(2),/*                   @Y17XACL*/ 67741500
*      2 CKPRCDSR FIXED(15),            /*NUMBER RECORDS(SEGMENTS)      67742000
*                                         REQUIRED FOR ONE ENV CKPT.    67742500
*                                                            @Y17XACL*/ 67743000
*      2 CKPTRKLN FIXED(15),            /*LENGTH OF DATA ON A TRACK     67743500
*                                         PRECEDING THE CURRENT         67744000
*                                         RECORD             @Y17XACL*/ 67744500
*      2 CKPTRKSA FIXED(15);            /*NUMBER AVAILABLE TRACKS IN    67745000
*                                         DATA SET           @Y17XACL*/ 67745500
*DCL 1 CKPOPNFL BIT(8) DEF(CKPFLAGS),   /*CONTROL RECORD FLAGS USED AT  67746000
*                                         OPEN TIME          @Y17XACL*/ 67746500
*      2 *        BIT(1),               /*                   @Y17XACL*/ 67747000
*      2 CKPOPNEN BIT(1),               /*OPEN-ENV FLAG      @Y17XACL*/ 67747500
*      2 CKPOPNIN BIT(1),               /*OPEN-INCIDENT FLAG @Y17XACL*/ 67748000
*      2 CKPOPNCR BIT(1),               /*OPEN-CKREQ FLAG    @Y17XACL*/ 67748500
*      2 *        BIT(4);               /*                   @Y17XACL*/ 67749000
*DCL 1 IEDQCDRD BASED(RCKPT),           /*OVERLAY FOR INCIDENT OR       67749500
*                                         ENVIRONMENT CKPT. DISK        67750000
*                                         RECORD             @Y17XACL*/ 67750500
*      2 CDRDATE  PTR(31),              /*DATE OF CKPT       @Y17XACL*/ 67751000
*      2 CDRTIME  PTR(31),              /*TIME WHEN RECORD WRITTEN      67751500
*                                                            @Y17XACL*/ 67752000
*      2 CDRKEY   BIT(8),               /*KEY FIELD          @Y17XACL*/ 67752500
*      2 CDRTTRLI PTR(24),              /*TTR OF LAST INCIDENT AT TIME  67753000
*                                         OF THIS ENV CKPT   @Y17XACL*/ 67753500
*      2 CDRDATA  CHAR(*);              /*BEGINNING OF DATA IN          67754000
*                                         THE SEGMENT        @Y17XACL*/ 67754500
*DCL 1 CDRINCFM DEFINED(CDRTTRLI) BDY(BYTE),/*FORMAT FOR INCIDENT       67755000
*                                         RECORDS            @Y17XACL*/ 67755500
*      2 CDRSTAT  CHAR(1),              /*TERMINAL STATUS    @Y17XACL*/ 67756000
*      2 CDROFFS  FIXED(15),            /*OFFSET TO TERMINAL NAME TABLE 67756500
*                                                            @Y17XACL*/ 67757000
*      2 CDRSEQIN FIXED(15),            /*INPUT SEQ NUMBER   @Y17XACL*/ 67757500
*      2 CDRSEQOU FIXED(15),            /*OUTPUT SEQ NUMBER  @Y17XACL*/ 67758000
*      2 CDROPTN  CHAR(*);              /*BEGINNING OF OPTIONS          67758500
*                                                            @Y17XACL*/ 67759000
*DCL CDROPCB PTR(31) DEF(CDRDATA);      /*BEGINNING OF OPCTL BLOCK      67759500
*                                                            @Y17XACL*/ 67760000
*DCL 1 CDRCREQR DEFINED(IEDQCDRD),      /*CKREQ RECORD       @Y17XACL*/ 67760500
*      2 CDRCKFLG BIT(8),               /*FLAG BITS          @Y17XACL*/ 67761000
*        3 CDRCKRNC BIT(1),             /*CKREQ IS NOT COMPLETED        67761500
*                                                            @Y17XACL*/ 67762000
*      2 *        PTR(24),              /*USED FOR LINK - I/O QUEUE     67762500
*                                                            @Y17XACL*/ 67763000
*      2 CDRCKIN  FIXED(15),            /*INPUT SEQ NUMBER   @Y17XACL*/ 67763500
*      2 CDRCKOUT FIXED(15),            /*OUTPUT SEQ NUMBER  @Y17XACL*/ 67764000
*      2 *        CHAR(1),              /*RECORD KEY         @Y17XACL*/ 67764500
*      2 *        CHAR(1),              /*                   @Y17XACL*/ 67765000
*      2 CDRCKOFF FIXED(15),            /*TERM OFFSET        @Y17XACL*/ 67765500
*      2 CDRCKMSG FIXED(15),            /*QCB MSG COUNT      @Y17XACL*/ 67766000
*      2 CDRCKQBC PTR(24) BDY(WORD,3),  /*QBACK POINTER      @Y17XACL*/ 67766500
*      2 CDRCKQCB CHAR(21),             /*QCB DISK POINTERS (THIS FIELD 67767000
*                                         IS REPEATED FOR EACH PRIORITY 67767500
*                                         LEVEL QCB)         @Y17XACL*/ 67768000
*      2 CDRCKPQB PTR(24) BDY(WORD,3),  /*PRILEVEL QBACK PTR @Y17XACL*/ 67768500
*      2 CDRCKOPT CHAR(*);              /*OPTION FIELD       @Y17XACL*/ 67769000
*DCL 1 IEDQCRED BASED(RCKPT),           /*MAP FOR CKPT REQUEST ELEMENT  67769500
*                                         (INCIDENT OR CKREQ)           67770000
*                                                            @Y17XACL*/ 67770500
*      2 CREKEY   CHAR(1),              /*REQUEST KEY        @Y17XACL*/ 67771000
*      2 CREQCBAD PTR(24),              /*QCB ADDRESS        @Y17XACL*/ 67771500
*      2 CRELINK  PTR(31),              /*                   @Y17XACL*/ 67772000
*        3 CREPRI   BIT(8),             /* PRIORITY OF REQUEST ELEMENT  67772500
*                                          LINK OF REQUEST ELEMENT      67773000
*                                                            @Y17XAXF*/ 67773500
*        3 *        PTR(24),            /* RESERVED          @Y17XAXF*/ 67774000
*      2 CREECB   PTR(31),              /*ADDR OF ECB        @Y17XACL*/ 67774500
*      2 CREOFFS  FIXED(15),            /*OFFSET OF TERMNAME ENTRY      67775000
*                                                            @Y17XACL*/ 67775500
*        3 CREDEB CHAR(*);              /*DEB CHAIN FOR CKREQ           67776000
*                                                            @Y17XACL*/ 67776500
*DCL 1 CKPREQTB BASED(RCKPT),           /*CKREQ-TTR TABLE ENTRY         67777000
*                                                            @Y17XACL*/ 67777500
*      2 CKPCTFLG BIT(8),               /*FLAG BYTE          @Y17XACL*/ 67778000
*        3 CKPCTACT BIT(1),             /*ENTRY IS ACTIVE    @Y17XACL*/ 67778500
*        3 CKPCTDER BIT(1),             /*ENTRY HAS DISK ERR @Y17XACL*/ 67779000
*      2 CKPCTTTR PTR(24),              /*TTR                @Y17XACL*/ 67779500
*      2 CKPCTOFF FIXED(15),            /*TERM OFFSET        @Y17XACL*/ 67780000
*      2 CKPCTSEC FIXED(15);            /*DATA ON TRACK PRECEDING       67780500
*                                         THIS CKREQ RECORD  @Y17XACL*/ 67781000
*DCL 1 CKPNRES BASED(RCKPT),            /*FIELDS FOR NCP RESOURCE       67781500
*                                                            @Y17XACL*/ 67782000
*       2 CKPSUBST FIXED(15),           /*SUBSTRUCT          @Y17XACL*/ 67782500
*       2 CKPCOHRT FIXED(15),           /*COHORT             @Y17XACL*/ 67783000
*       2 CKPNFLG  BIT(8),              /*FLAGS              @Y17XACL*/ 67783500
*        3 CKPREMB  BIT(1),             /*REMEMBER           @Y17XACL*/ 67784000
*        3 CKPRSACT BIT(1),             /*RESOURCE ACTIVE    @Y17XACL*/ 67784500
*        3 CKPEPMOD BIT(1),             /*EP MODE            @Y17XACL*/ 67785000
*        3 CKPLULOG BIT(1),             /*ALLOW LOGON IND    @Y17XAXF*/ 67785500
*        3 *        BIT(4),             /*RESERVED           @Y17XACL*/ 67786000
*       2 CKPTYPE  BIT(8);              /*RESOURCE TYPE      @Y17XACL*/ 67786500
*%CKPNRSZ='LENGTH(CKPNRES)';            /*LENGTH OF FIELDS CKPT'ED      67787000
*                                         FOR A 3705 RESOURCE           67787500
*                                                            @Y17XACL*/ 67788000
* DECLARE                               /*                   @Y17XAXF*/ 67788500
* 1 CKPAVT   BASED(RCKPT),              /*CHECKPOINT AVT DSECT          67789000
*                                                            @Y17XASA*/ 67789500
*  2 CKPOPCON CHAR(2),                  /*PRIMARY OP/CTL TERMINAL       67790000
*                                                            @Y17XASA*/ 67790500
*  2 CKPOPCIN CHAR(2),                  /* PRIMARY OP/CTL TTCIN         67791000
*                                                            @Y17XASA*/ 67791500
*  2 CKPINTLV CHAR(2),                  /* SYSTEM DELAY INTERVAL        67792000
*                                                            @Y17XASA*/ 67792500
*  2 CKPBIT1  BIT(8),                   /* AVTBIT1           @Y17XASA*/ 67793000
*  2 CKPBIT2  BIT(8),                   /* AVTBIT2           @Y17XASA*/ 67793500
*  2 CKPNADDR CHAR(4),                  /* NON REUSE DISK NEXT ADDR     67794000
*                                                            @Y17XASA*/ 67794500
*  2 CKPRADDR CHAR(4),                  /* REUSE DISK NEXT ADDR         67795000
*                                                            @Y17XASA*/ 67795500
*  2 CKPLODPT CHAR(4),                  /* REUSE LOAD POINT FIELD       67796000
*                                                            @Y17XASA*/ 67796500
*  2 CKPSUBT  CHAR(1),                  /* AVTSUBT SUBT= OPTION FIELD   67797000
*                                                            @Y17XASA*/ 67797500
*  2 CKPIOTR  CHAR(1);                  /* AVTIOTR IOTR= OPTION FIELD   67798000
*                                                            @Y17XASA*/ 67798500
*%CKPAVTLN='LENGTH(CKPAVT)';            /* LENGTH OF CKP AVT DSECT      67799000
*                                                            @Y17XASA*/ 67799500
*@EJECT;                                                                67800000
*   /*CONSTANTS                                              @Y17XACL*/ 67800500
*DCL CKPIOCOM BIT(8) CONSTANT('7F'X);   /*I/O COMPELTED SUCCESSFULLY    67801000
*                                         (USED WITH CKPIOECC)          67801500
*                                                            @Y17XAXF*/ 67802000
*DCL CKPSET1  BIT(8) CONSTANT('01'X);   /*USED TO INVERT QCB SWITCH AT  67802500
*                                         CKPSWCH1           @Y17XACL*/ 67803000
*DCL CKPSET2  BIT(8) CONSTANT('04'X);   /*USED TO INVERT INVITATION     67803500
*                                         LIST SWITCH AT CKPSWCH2       67804000
*                                                            @Y17XACL*/ 67804500
*DCL CKPREAD  BIT(8) CONSTANT('06'X);   /*READ DATA CMD      @Y17XACL*/ 67805000
*DCL CKPWRITE BIT(8) CONSTANT('05'X);   /*WRITE DATA CMD     @Y17XACL*/ 67805500
*DCL CKPWCKD  BIT(8) CONSTANT('1D'X);   /*WRITE COUNT, KEY, AND DATA    67806000
*                                                            @Y17XACL*/ 67806500
*DCL CKPSET   BIT(8) CONSTANT('23'X);   /*SET SECTOR         @Y17XACL*/ 67807000
*DCL CKPNOOP  BIT(8) CONSTANT('03'X);   /*NOOP               @Y17XACL*/ 67807500
*DCL CKPMSGL  FIXED(8) CONSTANT(65);    /*MSG LENGTH         @Y17XACL*/ 67808000
*DCL CKPENVL  FIXED(15) CONSTANT(300);  /*LENGTH OF ENVIRONMENT RECORD  67808500
*                                         SEGMENT            @Y17XACL*/ 67809000
*DCL CKP101   FIXED(15) CONSTANT(256);  /*USED TO BUMP TRACK @Y17XACL*/ 67809500
*DCL CKPCKRNO FIXED(8) CONSTANT(3);     /*NUMBER OF EXTRA CKREQ RECORDS 67810000
*                                                            @Y17XACL*/ 67810500
*DCL CKPCMDCH BIT(8)   CONSTANT('42'X); /*COMMAND CHAINING   @Y17XACL*/ 67811000
*DCL CKPRETNL FIXED(8) CONSTANT(4);     /*RETURN OFFSET TO CHECKPOINT   67811100
*                                         EXECUTOR FOR NO ADDITIONAL    67811200
*                                         LOAD REQUESTS      @Y17XAXF*/ 67811300
*DCL CKPCKREQ FIXED(8) CONSTANT(48);    /*OFFSET FOR CKREQ   @Y17XACL*/ 67811500
*DCL CKPENV   FIXED(8) CONSTANT(56);    /*OFFSET FOR ENV     @Y17XACL*/ 67812000
*DCL CKPIOQM  FIXED(8) CONSTANT(64);    /*OFFSET FOR I/O QUEUE MANAGER  67812500
*                                                            @Y17XACL*/ 67813000
*DCL CKPDIOR  FIXED(8) CONSTANT(72);    /*OFFSET FOR DISK I/O ROUTINE   67813500
*                                                            @Y17XACL*/ 67814000
*DCL CKPNOTIF FIXED(8) CONSTANT(80);    /*OFFSET FOR NOTIFICATION       67814500
*                                         ROUTINE            @Y17XACL*/ 67815000
*DCL CKPNOCOR FIXED(8) CONSTANT(88);    /*OFFSET FOR NO AVAILABLE CORE  67815500
*                                         ROUTINE            @Y17XACL*/ 67816000
*DCL CKPNOINC FIXED(8) CONSTANT(96);    /*OFFSET FOR INCIDENT OVERFLOW  67816500
*                                         ROUTINE            @Y17XACL*/ 67817000
*DCL CKPCNCP  FIXED(8) CONSTANT(104);   /*OFFSET FOR 3705 CHECKPOINT    67817500
*                                          ROUTINE           @Y17XAXF*/ 67818000
*DCL CKPRNCP  FIXED(8) CONSTANT(112);   /*OFFSET FOR 3705 RESTART       67818500
*                                         ROUTINE            @Y17XAXF*/ 67819000
*DCL CKPCNCPW FIXED(8) CONSTANT(120);   /*OFFSET FOR 3705 CHECKPOINT    67819500
*                                         WRITE ROUTINE      @Y17XAXF*/ 67820000
*DCL CKPOPLTL FIXED(8) CONSTANT(10);    /*LENGTH OF OPT LENGTH ENTRY    67820500
*                                                            @Y17XACL*/ 67821000
*DCL CKP1BYTE FIXED(8) CONSTANT(8);     /*USED TO SHIFT 1 BYTE          67821500
*                                                            @Y17XACL*/ 67822000
*DCL CKP2BYTE FIXED(8) CONSTANT(16);    /*USED TO SHIFT 2 BYTES         67822500
*                                                            @Y17XACL*/ 67823000
*DCL CKPCVTPT FIXED(8) CONSTANT(16);    /*ADDRESS OF CVT POINTER        67823500
*                                                            @Y17XACL*/ 67824000
*DCL CKPCNTTR FIXED(8) CONSTANT(28);    /*DISPLACEMENT OF TTR CONVERT   67824500
*                                         ROUTINE IN CVT     @Y17XACL*/ 67825000
*DCL CKPCNSEC FIXED(8) CONSTANT(232);   /*DISPLACEMENT OF SECTOR        67825500
*                                         ROUTINE ADDR IN CVT           67826000
*                                                            @Y17XACL*/ 67826500
*DCL CKPDELMT CHAR(1)  CONSTANT('*');   /*DELIMITER PLACED IN ENV RCD   67827000
*                                                            @Y17XACL*/ 67827500
*DCL CKPQDELM FIXED(8) CONSTANT(108);   /*DELIMETER FOR QCB ON          67827610
*                                         ENVIRONMENT FIELD  @OX16402*/ 67827710
*DCL CKPLTRLN FIXED(8) CONSTANT(1);     /*LENGTH OF LCBTRACE FIELD      67828000
*                                                            @Y17XAXF*/ 67828500
*DCL CKPDELLN FIXED(8) CONSTANT(1);     /*LENGTH OF DELIMITER FIELD     67829000
*                                                            @Y17XACL*/ 67829500
*DCL CKPSEQLN FIXED(8) CONSTANT(4);     /*LENGTH OF SEQUENCE NUMBER     67830000
*                                         FIELD              @Y17XACL*/ 67830500
*DCL CKPSENSE FIXED(8) CONSTANT(1);     /*LENGTH OF SENSE FIELD         67831000
*                                                            @Y17XACL*/ 67831500
*DCL CKPMCTLN FIXED(8) CONSTANT(2);     /*LENGTH OF COUNT FIELD         67832000
*                                                            @Y17XACL*/ 67832500
*DCL CKPTRMLN FIXED(8) CONSTANT(1);     /*LENGTH OF TRM STATUS FIELD    67833000
*                                                            @Y17XACL*/ 67833500
*DCL CKPQCBLN FIXED(8) CONSTANT(21);    /*LENGTH OF PRIORITY LEVEL QCB  67834000
*                                         DISK POINTERS      @Y17XACL*/ 67834500
*DCL CKPMQBLN FIXED(8) CONSTANT(6);     /*LENGTH OF MASTER QCB FIELDS   67835010
*                                         PLUS DELIMETER     @OX16402*/ 67835510
*DCL CKPQBKLN FIXED(8) CONSTANT(3);     /*LENGTH OF QBACK POINTER       67836000
*                                                            @Y17XACL*/ 67836500
*DCL CKPLCBLN FIXED(8) CONSTANT(2);     /*LENGTH OF LCB STAT INFO       67837000
*                                                            @Y17XACL*/ 67837500
*DCL CKPDCBLN FIXED(8) CONSTANT(1);     /*LENGTH OF DCB FIELDS          67838000
*                                                            @Y17XACL*/ 67838500
*DCL CKPOCODE FIXED(8) CONSTANT(0);     /*COMMAND OPERATION TYPE        67839000
*                                                            @Y17XACL*/ 67839500
*DCL CKPOCSWC FIXED(8) CONSTANT(1);     /*OPERATION SUB-TYPE @Y17XACL*/ 67840000
*DCL CKPOCFLG FIXED(8) CONSTANT(2);     /*FLAG BYTE          @Y17XACL*/ 67840500
*DCL CKPOCREL FIXED(8) CONSTANT(3);     /*RELATIVE LINE NUMBER          67841000
*                                                            @Y17XACL*/ 67841500
*DCL CKPOCLNO FIXED(8) CONSTANT(10);    /* HEX LINE NUMBER   @Y17XACL*/ 67842000
*DCL CKPOCNAM FIXED(8) CONSTANT(20);    /*DDNAME FOR START/STOP         67842500
*                                         COMMAND            @Y17XACL*/ 67843000
*DCL CKPOCLST FIXED(8) CONSTANT(28);    /*ILIST ADDRESS      @Y17XACL*/ 67843500
*DCL CDROPC   FIXED(8) CONSTANT(16);    /*KEY FOR OPCTL      @Y17XACL*/ 67844000
*DCL CDRCKREQ FIXED(8) CONSTANT(24);    /*KEY FOR CKREQ      @Y17XACL*/ 67844500
*DCL CDRTOTAL FIXED(8) CONSTANT(28);    /*KEY FOR TOTAL      @Y17XACL*/ 67845000
*DCL CDRTOTLC FIXED(8) CONSTANT(32);    /*KEY FOR TOTAL - CONTINUED     67845500
*                                                            @Y17XACL*/ 67846000
*   /*KEYS USED WITH CREKEY                                  @Y17XACL*/ 67846500
*DCL CRELCB   BIT(8) CONSTANT('00'X);   /*KEY FOR LCB FOR CHECKPOINT    67847000
*                                                            @Y17XACL*/ 67847500
*DCL CRECHNGT BIT(8) CONSTANT('10'X);   /*KEY FOR TCHNG FROM ALLP       67848000
*                                                            @Y17XACL*/ 67848500
*DCL CREREMVE BIT(8) CONSTANT('20'X);   /*KEY FOR TIME DELAY QUEUE      67849000
*                                         REMOVAL ELEMENT    @Y17XACL*/ 67849500
*DCL CREOPC   BIT(8) CONSTANT('40'X);   /*KEY FOR OPERATOR CONTROL      67850000
*                                                            @Y17XACL*/ 67850500
*DCL CRECKREQ BIT(8) CONSTANT('60'X);   /*KEY FOR CKREQ FROM APPL       67851000
*                                         PROGRAM            @Y17XACL*/ 67851500
*DCL CREINCOF BIT(8) CONSTANT('80'X);   /*KEY FLAG - INCIDENT           67852000
*                                         OVERFLOW           @Y17XACL*/ 67852500
*DCL CRECNCP  BIT(8) CONSTANT('D0'X);   /*KEY FOR 3705 CHECKPOINT       67853000
*                                                            @Y17XAXF*/ 67853500
*DCL CRERNCP  BIT(8) CONSTANT('E0'X);   /*KEY FOR 3705 RESTART          67854000
*                                                            @Y17XAXF*/ 67854500
./  ADD  SSI=71310501,NAME=TCMD0D
*        %GOTO CMD0PLS;            /* BILINGUAL HEADER                  00300000
         MACRO                                                          00600000
         TCMD0D                                                         00900000
.*A000000-999999                                               @Y17XAXF 01200000
*                                                                       01500000
*        FID0 COMMAND CODES                                             01800000
*                                                                       02100000
         SPACE                                                          02400000
CD0READ  EQU   X'01' .             READ COMMANDS                        02700000
*                                                                       03000000
*        READ MODIFIERS                                                 03300000
*                                                                       03600000
CD0R     EQU   X'00' .                  READ NORMAL                     03900000
CD0RB    EQU   X'01' .                  READ BLOCK                      04200000
CD0RM    EQU   X'02' .                  READ MESSAGE                    04500000
CD0RT    EQU   X'03' .                  READ TRANSMISSION               04800000
CD0RD    EQU   X'04' .                  READ TRANSMISSION DISCONNECT    05100000
CD0RI    EQU   X'05'                    READ WITH INVITE                05400000
         SPACE                                                          05700000
CD0WRT   EQU   X'02' .             WRITE COMMAND                        06000000
*                                                                       06300000
*        WRITE MODIFIERS                                                06600000
*                                                                       06900000
CD02     EQU   X'00' .                  WRITE NORMAL                    07200000
CD0WM    EQU   X'01' .                  WRITE WITH EOM                  07500000
CD0WT    EQU   X'02' .                  WRITE WITH EOT                  07800000
CD0WD    EQU   X'03' .                  WRITE WITH DISCONNECT           08100000
CD0WR    EQU   X'06' .                  WRITE WITH READ                 08400000
CD0WI    EQU   X'07' .                  WRITE WITH INVITE               08700000
CD0WC    EQU   X'08'                    WRITE WITH CONTACT              09000000
CD0WCM   EQU   X'09' .                  WRITE WITH CONTACT(EXT)         09300000
CD0WCT   EQU   X'0A' .                  WRITE WITH CONTACT(EOT)         09600000
CD0WCD   EQU   X'0B' .                  WRITE WITH CONTACT AND DISCONN  09900000
CD0WCR   EQU   X'0E' .                  WRITE WITH CONTACT AND READ     10200000
         SPACE                                                          10500000
CD0TEST  EQU   X'03' .             TEST COMMAND                         10800000
*                                                                       11100000
*        TEST MODIFIERS                                                 11400000
*                                                                       11700000
CD0T     EQU   X'00' .                  TEST DEVICE NORMAL              12000000
CD0TC    EQU   X'01' .                  TEST DEVICE WITH CONTACT        12300000
CD0TD    EQU   X'02' .                  TEST DEVICE WITH DISCONNECT     12600000
CD0TCD   EQU   X'03' .                  TEST DEV WITH CDNTACT & DISCONN 12900000
CD0TI    EQU   X'04' .                  TEST LINE NORMAL                13200000
CD0TIC   EQU   X'05' .                  TEST LINE WITH CONTACT          13500000
CD0TID   EQU   X'06' .                  TEST LINE WITH DISCONNECT       13800000
CD0TICD  EQU   X'07' .                  TEST LINE WITH CONTACT & DISCON 14100000
         SPACE                                                          14400000
CD0REST  EQU   X'04' .             RESTART COMMAND                      14700000
*                                                                       15000000
*        RESTART MODIFIERS                                              15300000
*                                                                       15600000
CD0RLINE EQU   X'00' .                  LINE                            15900000
CD0RDEV  EQU   X'01' .                  DEVICE                          16200000
CD0RLSES EQU   X'02' .                  REP SESSION INIT INFO FOR LINE  16500000
CD0RDSES EQU   X'04' .                  REP SESSION INIT INFO FOR DEV   16800000
         SPACE                                                          17100000
CD0INV   EQU   X'05' .             INVITE COMMAND                       17400000
*                                                                       17700000
*        INVITE MODIFIERS                                               18000000
*                                                                       18300000
CD0I     EQU   X'00' .                  INVITE NORMAL                   18600000
CD0IB    EQU   X'01' .                  INVITE BLOCK                    18900000
CD0IM    EQU   X'02' .                  INVITE MESSAGE                  19200000
CD0IT    EQU   X'03' .                  INVITE TRANSMISSION             19500000
CD0ID    EQU   X'04' .                  INVITE TRANSMISSION WITH DISCON 19800000
CD0IA    EQU   X'05' .                  INVITE WITH AUTO RESTART        20100000
CD0IP    EQU   X'06' .                  INVITE PERPETUAL                20400000
         SPACE                                                          20700000
CD0CONT  EQU   X'06' .             CONTACT COMMAND                      21000000
*                                                                       21300000
*        NO CONTACT MODIFIERS                                           21600000
*                                                                       21900000
         SPACE                                                          22200000
CD0DISC  EQU   X'07' .             DISCONNECT COMMAND                   22500000
*                                                                       22800000
*        DISCONNECT MODIFIERS                                           23100000
*                                                                       23400000
CD0D     EQU   X'00' .                  DISCONNECT NORMAL               23700000
CD0DI    EQU   X'01' .                  DISCONNECT WITH INVITE          24000000
CD0DE    EQU   X'02' .                  DISCONNECT WITH END-OF-CALL     24300000
CD0DEI   EQU   X'03' .                  DISCONNECT WITH EOC AND INVITE  24600000
         SPACE                                                          24900000
CD0CTRL  EQU   X'08' .             CONTROL COMMAND                      25200000
*                                                                       25500000
*        CONTROL MODIFIERS                                              25800000
*                                                                       26100000
CD0CDISL EQU   X'01' .                  DISPLAY LINE STATUS             26400000
CD0CRSII EQU   X'02' .                  REP SESS INIT INFO FOR A LINE   26700000
CD0CAI   EQU   X'03' .                  ACTIVATES INVITES               27000000
CD0CDI   EQU   X'04' .                  DEACTIVATES INVITES             27300000
CD0CCSII EQU   X'05' .                  COPY SESS INIT INFO             27600000
CD0CDDS  EQU   X'06' .                  DISPLAY DEVICE STATUS           27900000
CD0CRDS  EQU   X'07' .                  REQ DEV STATISTICS              28200000
CD0CDS   EQU   X'08' .                  DISPLAY STORAGE                 28500000
CD0CSTD  EQU   X'09' .                  SET TIME AND DATE               28800000
CD0CSCMS EQU   X'0A' .                  SET CHANNEL MODE SECONDARY      29100000
CD0CDLNA EQU   X'0B' .                  DISPLAY LINE'S NETWORK ADDR     29400000
CD0CALT  EQU   X'0C' .                  ACTIVATE LINE TRACE             29700000
CD0CTLT  EQU   X'0D' .                  TERMINATE LINE TRACE            30000000
CD0CCMS  EQU   X'12' .                  CHANGE MODEM SPEED              30300000
CD0CSCMP EQU   X'15' .                  SET CHANNEL MODE PRIMARY        30600000
CD0CCDM  EQU   X'18' .                  COPY DESTINATION MODE           30900000
CD0CPD   EQU   X'1C' .                  PHYSICAL DISCONNECT             31200000
CD0CCDSI EQU   X'21' .                  COPY DEV SESSION INFO           31500000
CD0CRDSI EQU   X'22' .                  REP DEV SESSION INFO            31800000
CD0CREL  EQU   X'41' .                  RESET ERROR LOCK                32100000
CD0CRDQ  EQU   X'42' .                  RESET DEVICE QUEUES             32400000
CD0CRCMR EQU   X'43' .                  REQ CONTROLMODE RESET           32700000
CD0CRI   EQU   X'44' .                  RESET IMMEDIATE                 33000000
CD0CROTT EQU   X'48' .                  RESET ONLINE TERMINAL TEST      33300000
CD0CSTB  EQU   X'4A' .                  SWITCH TO BACKUP                33600000
CD0CSBTP EQU   X'4C' .                  SWITCH FROM BACKUP TO PRIMARY   33900000
CD0CRINV EQU   X'4D' .                  RESET INVITE                    34200000
CD0CRC   EQU   X'50' .                  RESET CONDITIONAL               34500000
CD0CREOC EQU   X'60' .                  RESET AT ENDOF COMMAND          34800000
CD0CSEP  EQU   X'82' .                  SWITCH TO EP MODE               35100000
CD0CSNCP EQU   X'83' .                  SWITCH TO NCP MODE              35400000
CD0CCLSP EQU   X'84' .                  CHGE LINE SERVICE-SEEKING PAUSE 35700000
CD0CCLNR EQU   X'85' .                  CHGE LINE NEG POLL RSP LIMIT    36000000
CD0CCSL  EQU   X'86' .                  CHGE SESSION LIMIT              36300000
CD0CCDTL EQU   X'8C' .                  CHGE DEV TRANSMISSION LIMIT     36600000
CD0CMBHS EQU   X'8D' .                  MODIFY BLK HANDLER SET ASSOC    36900000
CD0CAL   EQU   X'98' .                  ACTIVATE LINE                   37200000
CD0CD0   EQU   X'99' .                  DEACTIVATE ORDERLY              37500000
CD0CSDM  EQU   X'9A' .                  SET DESTINATION MODE            37800000
CD0CDLH  EQU   X'C2' .                  DEACTIVATE LINE HALT            38100000
         MEND                                                           38400000
*        */                                                             38700000
*%CMD0PLS:;                                                             39000000
*/*                                                                  */ 39300000
*/*      FID0 COMMAND CODES                                          */ 39600000
*/*                                                                  */ 39900000
*                                                                       40200000
*DCL CD0READ  BIT(8) CONSTANT('01'X); /* READ COMMAND                */ 40500000
*/*                                                                  */ 40800000
*/*      READ MODIFIERS                                              */ 41100000
*/*                                                                  */ 41400000
*DCL CD0R      BIT(8) CONSTANT('00'X); /*  READ NORMAL               */ 41700000
*DCL CD0RB     BIT(8) CONSTANT('01'X); /*  READ BLOCK                */ 42000000
*DCL CD0RM     BIT(8) CONSTANT('02'X); /*  READ MESSAGE              */ 42300000
*DCL CD0RT     BIT(8) CONSTANT('03'X); /*  READ TRANSMISSION         */ 42600000
*DCL CD0RD     BIT(8) CONSTANT('04'X); /*  READ TRANSMISSION DISCON  */ 42900000
*DCL CD0RI     BIT(8) CONSTANT('05'X); /*  READ WITH INVITE          */ 43200000
*                                                                       43500000
*DCL CD0WRT    BIT(8) CONSTANT('02'X); /* WRITE COMMAND              */ 43800000
*/*                                                                  */ 44100000
*/*      WRITE MODIFIERS                                             */ 44400000
*/*                                                                  */ 44700000
*DCL CD0W      BIT(8) CONSTANT('00'X); /*  WRITE NORMAL              */ 45000000
*DCL CD0WM     BIT(8) CONSTANT('01'X); /*  WRITE WITH EOM            */ 45300000
*DCL CD0WT     BIT(8) CONSTANT('02'X); /*  WRITE WITH EOT            */ 45600000
*DCL CD0WD     BIT(8) CONSTANT('03'X); /*  WRITE WITH DISCONNECT     */ 45900000
*DCL CD0WR     BIT(8) CONSTANT('06'X); /*  WRITE WITH READ           */ 46200000
*DCL CD0WI     BIT(8) CONSTANT('07'X); /*  WRITE WITH INVITE         */ 46500000
*DCL CD0WC     BIT(8) CONSTANT('08'X); /*  WRITE WITH CONTACT        */ 46800000
*DCL CD0WCM    BIT(8) CONSTANT('09'X); /*  WRITE WITH CONTACT(EXT)   */ 47100000
*DCL CD0WCT    BIT(8) CONSTANT('0A'X); /*  WRITE WITH CONTACT(EOT)   */ 47400000
*DCL CD0WCD    BIT(8) CONSTANT('0B'X); /* WRITE WITH CONTACT & DISCON*/ 47700000
*DCL CD0WCR    BIT(8) CONSTANT('0E'X); /*  WRITE WITH CONTACT & READ */ 48000000
*                                                                       48300000
*DCL CD0TEST  BIT(8) CONSTANT('03'X); /* TEST COMMAND                */ 48600000
*/*                                                                  */ 48900000
*/*      TEST MODIFIERS                                              */ 49200000
*/*                                                                  */ 49500000
*DCL CD0T     BIT(8) CONSTANT('00'X); /*  TEST DEVICE NORMAL         */ 49800000
*DCL CD0TC    BIT(8) CONSTANT('01'X); /*  TEST DEVICE WITH CONTACT   */ 50100000
*DCL CD0TD    BIT(8) CONSTANT('02'X); /*  TEST DEVICE WITH DISCONN   */ 50400000
*DCL CD0TCD   BIT(8) CONSTANT('03'X); /*  TEST DEV WITH CONTACT & DIS*/ 50700000
*DCL CD0TI    BIT(8) CONSTANT('04'X); /*  TEST LINE NORMAL           */ 51000000
*DCL CD0TIC   BIT(8) CONSTANT('05'X); /*  TEST LINE WITH CONTACT     */ 51300000
*DCL CD0TID   BIT(8) CONSTANT('06'X); /*  TEST LINE WITH DISCONNECT  */ 51600000
*DCL CD0TICD  BIT(8) CONSTANT('07'X); /*  TEST LINE WITH CONT & DISC */ 51900000
*                                                                       52200000
*/*                                                                  */ 52500000
*/*      RESTART MODIFIERS                                           */ 52800000
*/*                                                                  */ 53100000
*DCL CD0RLINE BIT(8) CONSTANT('00'X); /*  LINE                       */ 53400000
*DCL CD0RDEV  BIT(8) CONSTANT('01'X); /*  DEVICE                     */ 53700000
*DCL CD0RLSES BIT(8) CONSTANT('02'X); /*  REP SESS INIT INFO FOR LINE*/ 54000000
*DCL CD0RDSES BIT(8) CONSTANT('04'X); /*  REP SESS INIT INFO FOR DEV */ 54300000
*                                                                       54600000
*DCL CD0INV   BIT(8) CONSTANT('05'X); /* INVITE COMMAND              */ 54900000
*/*                                                                  */ 55200000
*/*      INVITE MODIFIERS                                            */ 55500000
*/*                                                                  */ 55800000
*DCL CD0I     BIT(8) CONSTANT('00'X); /*  INVITE NCORMAL             */ 56100000
*DCL CD0IB    BIT(8) CONSTANT('01'X); /*  INVITE BLOCK               */ 56400000
*DCL CD08M    BIT(8) CONSTANT('02'X); /*  INVITE MESSAGE             */ 56700000
*DCL CD0IT    BIT(8) CONSTANT('03'X); /*  INVITE TRANSMISSION        */ 57000000
*DCL CD08D    BIT(8) CONSTANT('04'X); /*  INVITE TRANS WITH DISC     */ 57300000
*DCL CD08A    BIT(8) CONSTANT('05'X); /*  INVITE WITH AUTO RESTART   */ 57600000
*DCL CD0IP    BIT(8) CONSTANT('06'X); /*  INVITE PERPETUAL           */ 57900000
*                                                                       58200000
*DCL CD0CONT  BIT(8) CONSTANT('06'X); /* CONTACT COMMAND             */ 58500000
*/*                                                                  */ 58800000
*/*      NO CONTACT MODIFIERS                                        */ 59100000
*/*                                                                  */ 59400000
*                                                                       59700000
*DCL CD0DISC  BIT(8) CONSTANT('07'X); /* DISCONNECT COMMAND          */ 60000000
*/*                                                                  */ 60300000
*/*      DISCONNECT MODIFIERS                                        */ 60600000
*/*                                                                  */ 60900000
*DCL CD0D     BIT(8) CONSTANT('00'X); /*  DISCONNECT NORMAL          */ 61200000
*DCL CD0DI    BIT(8) CONSTANT('01'X); /* DISCONNECT WITH INVITE      */ 61500000
*DCL CD0DE    BIT(8) CONSTANT('02'X); /*  DISCONNECT WITH END-OF-CALL*/ 61800000
*DCL CD0DEI   BIT(8) CONSTANT('03'X); /*  DISCONNECT WITH EOC AND INV*/ 62100000
*                                                                       62400000
*DCL CD0CTRL  BIT(8) CONSTANT('08'X); /* CONTROL COMMAND             */ 62700000
*/*                                                                  */ 63000000
*/*      CONTROL MODIFIERS                                           */ 63300000
*/*                                                                  */ 63600000
*DCL CD0CDISL BIT(8) CONSTANT('01'X); /*  DISPLAY LINE STATUS        */ 63900000
*DCL CD0CRSII BIT(8) CONSTANT('02'X); /*  REP SESS INIT INFO FOR LINE*/ 64200000
*DCL CD0CA8   BIT(8) CONSTANT('03'X); /*  ACTIVATES INVITES          */ 64500000
*DCL CD0CDI   BIT(8) CONSTANT('04'X); /*  DEACTIVATES INVITES        */ 64800000
*DCL CD0CCSII BIT(8) CONSTANT('05'X); /*  COPY SESS INIT INFO        */ 65100000
*DCL CD0CDDS  BIT(8) CONSTANT('06'X); /*  DISPLAY DEVICE STATUS      */ 65400000
*DCL CD0CRDS  BIT(8) CONSTANT('07'X); /*  REQ DEVICE STATISTICS      */ 65700000
*DCL CD0CDS   BIT(8) CONSTANT('08'X); /*  DISPLAY STORAGE            */ 66000000
*DCL CD0CSTD  BIT(8) CONSTANT('09'X); /*  SET TIME AND DATE          */ 66300000
*DCL CD0CSCMS BIT(8) CONSTANT('0A'X); /*  SET CHANNEL MODE SECONDARY */ 66600000
*DCL CD0CDLNA BIT(8) CONSTANT('0B'X); /*  DISPLAY LINE'S NETWORK ADDR*/ 66900000
*DCL CD0CALT  BIT(8) CONSTANT('0C'X); /*  ACTIVATE LINE TRACE        */ 67200000
*DCL CD0CTLT  BIT(8) CONSTANT('0D'X); /*  TERMINATE LINE TRACE       */ 67500000
*DCL CD0CCMS  BIT(8) CONSTANT('12'X); /*  CHANGE MODEM SPEED         */ 67800000
*DCL CD0CSCMP BIT(8) CONSTANT('15'X); /*  SET CHANNEL MODE PRIMARY   */ 68100000
*DCL CD0CCDM  BIT(8) CONSTANT('18'X); /*  COPY DESTINATION MODE      */ 68400000
*DCL CD0CPD   BIT(8) CONSTANT('1C'X); /*  PHYSICAL DISCONNECT        */ 68700000
*DCL CD0CCDSI BIT(8) CONSTANT('21'X); /*  COPY DEV SESSION INFO      */ 69000000
*DCL CD0CRDSI BIT(8) CONSTANT('22'X); /*  REP DEV SESSION INFO       */ 69300000
*DCL CD0CREL  BIT(8) CONSTANT('41'X); /*  RESET ERROR LOCK           */ 69600000
*DCL CD0CRD1  BIT(8) CONSTANT('42'X); /*  RESET DEVICE QUEUES        */ 69900000
*DCL CD0CRCMR BIT(8) CONSTANT('43'X); /*  REQ CONTROL MODE RESET     */ 70200000
*DCL CD0CRI   BIT(8) CONSTANT('44'X); /*  RESET IMMEDIATE            */ 70500000
*DCL CD0CROTT BIT(8) CONSTANT('48'X); /*  RESET ONLINE TERMINAL TEST */ 70800000
*DCL CD0CSTB  BIT(8) CONSTANT('4A'X); /*  SWITCH TO BACKUP           */ 71100000
*DCL CD0CSBTP BIT(8) CONSTANT('4C'X); /*  SWITCH FROM BACKUP TO PRIM */ 71400000
*DCL CD0CRINV BIT(8) CONSTANT('4D'X); /*  RESET INVITE               */ 71700000
*DCL CD0CRC   BIT(8) CONSTANT('50'X); /*  RESET CONDITIONAL          */ 72000000
*DCL CD0CREOC BIT(8) CONSTANT('60'X); /*  RESET AT END OF COMMAND    */ 72300000
*DCL CD0CSEP  BIT(8) CONSTANT('82'X); /*  SWITCH TO EP MODE          */ 72600000
*DCL CD0CSNCP BIT(8) CONSTANT('83'X); /*  SWITCH TO NCP MODE         */ 72900000
*DCL CD0CCLSP BIT(8) CONSTANT('84'X); /*  CHGE LINE SERV-SEEKING PAUS*/ 73200000
*DCL CD0CCLNR BIT(8) CONSTANT('85'X); /*  CHGE LINE NEG POLL RSP LIM */ 73500000
*DCL CD0CCSL  BIT(8) CONSTANT('86'X); /*  CHGE SESSION LIMIT         */ 73800000
*DCL CD0CCDTL BIT(8) CONSTANT('8C'X); /*  CHGE DEV TRANSMISSION LIMIT*/ 74100000
*DCL CD0CMBHS BIT(8) CONSTANT('8D'X); /*  MOD BLK HANDLER SET ASSOC  */ 74400000
*DCL CD0CAL   BIT(8) CONSTANT('98'X); /*  ACTIVATE LINE              */ 74700000
*DCL CD0CD0   BIT(8) CONSTANT('99'X); /*  DEACTIVATE ORDERLY         */ 75000000
*DCL CD0CSDM  BIT(8) CONSTANT('9A'X); /*  SET DESTINATION MODE       */ 75300000
*DCL CD0CDLH  BIT(8) CONSTANT('C2'X); /*  DEACTIVATE LINE HALT       */ 75600000
./  ADD  SSI=71310502,NAME=TCMD1D
*        %GOTO CMD1PLS;                /* BILINGUAL HEADER              00400000
         MACRO                                                          00800000
         TCMD1D                                                         01200000
.*A000000-999999                                               @Y17XAXF 01600000
*                                                                       02000000
*        DFC FID1 COMMANDS                                              02400000
*                                                                       02800000
CD1PREPS EQU   X'02' .             PREPARE SWITCH                       03200000
CD1SWCOM EQU   X'03' .             SWITCH COMPLETE                      03600000
CD1LSTAT EQU   X'04' .             LUSTAT                               04000000
CD1RTR   EQU   X'05' .             READY TO RECEIVE                     04400000
CD1ANS   EQU   X'06' .             AUTO NETWORK SHUTDOWN                04800000
CD1ANSC  EQU   X'07' .             ANS COMPLETE                         05200000
CD1ACTLU EQU   X'0D' .             ACTIVATE LU                          05600000
CD1DATLU EQU   X'0E' .             DEACTIVATE LU                        06000000
CD1ACTPU EQU   X'11' .             ACTIVATE PU                          06400000
CD1DATPU EQU   X'12' .             DEACTIVATE PU                        06800000
CD1BIND  EQU   X'31' .             BIND                                 07200000
CD1UBIND EQU   X'32' .             UNBIND                               07600000
CD1INITC EQU   X'50' .             INIT COMPLETE                        08000000
CD1QEC   EQU   X'80' .             QUIESCE AT END OF CHAIN              08400000
CD1QC    EQU   X'81' .             QUIESCE COMPLETE                     08800000
CD1REL1  EQU   X'82' .             RELEASE QUIESCE                      09200000
CD1CANCL EQU   X'83' .             CANCEL                               09600000
CD1CHASE EQU   X'84' .             CHASE                                10000000
CD1SDT   EQU   X'A0' .             START DATA TRAFFIC                   10400000
CD1CLEAR EQU   X'A1' .             CLEAR                                10800000
CD1STSN  EQU   X'A2' .             SET AND TEST SEQ NUMBERS             11200000
CD1RQR   EQU   X'A3' .             REQUEST RECEIVED                     11600000
CD1SHUTD EQU   X'C0' .             SHUTDOWN                             12000000
CD1SHUTC EQU   X'C1' .             SHUTDOWN COMPLETE                    12400000
CD1RSHUT EQU   X'C2' .             REQUEST SHUTDOWN                     12800000
CD1BID   EQU   X'C8' .             BID                                  13200000
CD1SIG   EQU   X'C9' .             SIGNAL                               13600000
         EJECT                                                          14000000
*                                                                       14400000
*                                                                       14800000
*        NETWORK SERVICES FID1 COMMANDS                                 15200000
*                                                                       15600000
*                                                                       16000000
CD1NETS  EQU   X'01' .             NETWORK SERVICES IND                 16400000
         SPACE                                                          16800000
*                                                                       17200000
*        CONFIGURATION SERVICES FID1 COMMANDS                           17600000
*                                                                       18000000
CD1CONFS EQU   X'02' .             CONFIGURATION SERV IND               18400000
         SPACE                                                          18800000
CD1CONT  EQU   X'01' .               CONTACT                            19200000
CD1DCONT EQU   X'02' .               DISCONTACT                         19600000
CD1IPLI  EQU   X'03' .               IPL INITIAL                        20000000
CD1IPLT  EQU   X'04' .               IPL TEXT                           20400000
CD1IPLF  EQU   X'05' .               IPL FINAL                          20800000
CD1DMPI  EQU   X'06' .               DUMP INITIAL                       21200000
CD1DMPT  EQU   X'07' .               DUMP TEXT                          21600000
CD1DMPF  EQU   X'08' .               DUMP FINAL                         22000000
CD1RPO   EQU   X'09' .               REMOTE POWER OFF                   22400000
CD1ACTLK EQU   X'0A' .               ACTIVATE LINK                      22800000
CD1DATLK EQU   X'0B' .               DEACTIVATE LINK                    23200000
CD1CESLW EQU   X'0C' .               CONTROL ENTER SLOWDOWN             23600000
CD1CXSLW EQU   X'0D' .               CONTROL EXIT SLOWDOWN              24000000
CD1CONNO EQU   X'0E' .               CONNECT OUT                        24400000
CD1ABC   EQU   X'0F' .               ABANDON CONNECTION                 24800000
CD1SETV  EQU   X'11' .               SET CONTROL VECTOR                 25200000
CD1SENV  EQU   X'12' .               SENSE CONTROL VECTOR               25600000
CD1ESLOW EQU   X'14' .               ENTERING SLOWDOWN                  26000000
CD1EXSLW EQU   X'15' .               EXITING SLOWDOWN                   26400000
CD1ACI   EQU   X'16' .               ACTIVATE CONNECT IN                26800000
CD1DCI   EQU   X'17' .               DEACTIVATE CONNECT IN              27200000
CD1ACO   EQU   X'18' .               ABANDON CONNECT OUT                27600000
CD1ANA   EQU   X'19' .               ASSIGN NETWORK ADDR                28000000
CD1FNA   EQU   X'1A' .               FREE NETWORK ADDR                  28400000
CD1REQD  EQU   X'1B' .               REQUEST DISCONTACT                 28800000
CD1CONCT EQU   X'80' .               CONTACTED                          29200000
CD1INOP  EQU   X'81' .               INOPERATIVE                        29600000
CD1REQC  EQU   X'84' .               REQUEST CONTACT                    30000000
         SPACE                                                          30400000
*                                                                       30800000
*        MAINTENANCE SERVICES FID1 COMMANDS                             31200000
*                                                                       31600000
CD1MAINT EQU   X'03' .             MAINTENANCE SERV IND                 32000000
         SPACE                                                          32400000
CD1EX    EQU   X'01' .               EXECUTE TEST                       32800000
CD1ACTTR EQU   X'02' .               ACTIVATE TRACE                     33200000
CD1DACTR EQU   X'03' .               DEACTIVATE TRACE                   33600000
CD1RTP   EQU   X'08' .               REQUEST TEST PROCEDURE             34000000
CD1RMS   EQU   C'81' .               RECORD MAINTENANCE STATISTICS      34400000
CD1RTTD  EQU   X'82' .               RECORD TEST DATA                   34800000
CD1RTRD  EQU   X'83' .               RECORD TRACE DATA                  35200000
         SPACE                                                          35600000
*                                                                       36000000
*        MEASUREMENT SERVICES FID1 COMMANDS                             36400000
*                                                                       36800000
CD1MEAS  EQU   X'04' .             MEASUREMENT SERVICES IND             37200000
         SPACE                                                          37600000
CD1STM   EQU   X'01' .               START MEASUREMENT                  38000000
CD1SPM   EQU   X'02' .               STOP MEASUREMENT                   38400000
CD1RMD   EQU   X'80' .               RECORD MEASUREMENT DATA            38800000
         SPACE                                                          39200000
*                                                                       39600000
*        SESSION SERVICES FID1 COMMANDS                                 40000000
*                                                                       40400000
CD1SESS  EQU   X'06' .             SESSION SERVICES IND                 40800000
         SPACE                                                          41200000
CD1CINIT EQU   X'01' .               CONTROL INITIATE                   41600000
CD1CTERM EQU   X'02' .               CONTROL TERMINATE                  42000000
CD1NSPRO EQU   X'04' .               NS PROC ERROR                      42400000
CD1INITS EQU   X'81' .               INITIATE SELF                      42800000
CD1INITO EQU   X'81' .               INITIATE OTHER                     43200000
CD1TERMO EQU   X'82' .               TERMINATE OTHER                    43600000
CD1TERMS EQU   X'83' .               TERMINATE SELF                     44000000
CD1BINDF EQU   X'85' .               BIND FAILURE                       44400000
CD1SESST EQU   X'86' .               SESSION STARTED                    44800000
CD1UBNDF EQU   X'87' .               UNBIND FAILURE                     45200000
CD1SESEN EQU   X'88' .               SESSION ENDED                      45600000
         MEND                                                           46000000
*        */                                                             46400000
*%CMD1PLS:;                                                             46800000
*/*                                                                  */ 47200000
*/*      DFC FID1 COMMANDS                                           */ 47600000
*/*                                                                  */ 48000000
* DCL CD1PREPS BIT(8) CONSTANT('02'X);  /* PREPARE SWITCH            */ 48400000
* DCL CD1SWCOM BIT(8) CONSTANT('03'X);  /* SWITCH COMPLETE           */ 48800000
* DCL CD1LSTAT BIT(8) CONSTANT('04'X);  /* LUSTAT                    */ 49200000
* DCL CD1RTR   BIT(8) CONSTANT('05'X);  /* READY TO RECEIVE          */ 49600000
* DCL CD1ANS   BIT(8) CONSTANT('06'X);  /* AUTO NETWORK SHUTDOWN     */ 50000000
* DCL CD1ANSC  BIT(8) CONSTANT('07'X);  /*  ANS COMPLETE             */ 50400000
* DCL CD1ACTLU BIT(8) CONSTANT('0D'X);  /* ACTIVATE LU               */ 50800000
* DCL CD1DATLU BIT(8) CONSTANT('0E'X);  /* DEACTIVATE LU             */ 51200000
* DCL CD1ACTPU BIT(8) CONSTANT('11'X);  /* ACTIVATE PU               */ 51600000
* DCL CD1DATPU BIT(8) CONSTANT('12'X);  /* DEACTIVATE PU             */ 52000000
* DCL CD1BIND  BIT(8) CONSTANT('31'X);  /* BIND                      */ 52400000
* DCL CD1UBIND BIT(8) CONSTANT('32'X);  /* UNBIND                    */ 52800000
* DCL CD1INITC BIT(8) CONSTANT('50'X);  /* INIT COMPLETE             */ 53200000
* DCL CD1QEC   BIT(8) CONSTANT('80'X);  /* QUIESCE AT END OF CHAIN   */ 53600000
* DCL CD1QC    BIT(8) CONSTANT('81'X);  /* QUIESCE COMPLETE          */ 54000000
* DCL CD1RELQ  BIT(8) CONSTANT('82'X);  /* RELEASE QUIESCE           */ 54400000
* DCL CD1CANCL BIT(8) CONSTANT('83'X);  /* CANCEL                    */ 54800000
* DCL CD1CHASE BIT(8) CONSTANT('84'X);  /* CHASE                     */ 55200000
* DCL CD1SDT   BIT(8) CONSTANT('A0'X);  /* START DATA TRAFFIC        */ 55600000
* DCL CD1CLEAR BIT(8) CONSTANT('A1'X);  /* CLEAR                     */ 56000000
* DCL CD1STSN  BIT(8) CONSTANT('A2'X);  /* SET AND TEST SEQ NUMBERS  */ 56400000
* DCL CD1RQR   BIT(8) CONSTANT('A3'X);  /* REQUEST RECEIVED          */ 56800000
* DCL CD1SHUTD BIT(8) CONSTANT('C0'X);  /* SHUTDOWN                  */ 57200000
* DCL CD1SHUTC BIT(8) CONSTANT('C1'X);  /* SHUTDOWN COMPLETE         */ 57600000
* DCL CD1RSHUT BIT(8) CONSTANT('C2'X);  /* REQUEST SHUTDOWN          */ 58000000
* DCL CD1BID  BIT(8) CONSTANT('C8'X);   /* BID                       */ 58400000
* DCL CD1SIG   BIT(8) CONSTANT('C9'X);  /* SIGNAL                    */ 58800000
         @EJECT;                                                        59200000
*/*                                                                  */ 59600000
*/*                                                                  */ 60000000
*/*      NETWORK SERVICES FID1 COMMANDS                              */ 60400000
*/*                                                                  */ 60800000
*/*                                                                  */ 61200000
* DCL CD1NETS  BIT(8) CONSTANT('01'X);  /* NETWORK SERV IND          */ 61600000
         @SPACE;                                                        62000000
*/*                                                                  */ 62400000
*/*      CONFIGURATION SERVICES FID1 COMMANDS                        */ 62800000
*/*                                                                  */ 63200000
* DCL CD1CONFS BIT(8) CONSTANT('02'X);  /* CONFIGURATION SERV IND    */ 63600000
         @SPACE;                                                        64000000
* DCL CD1CONT  BIT(8) CONSTANT('01'X);  /*   CONTACT                 */ 64400000
* DCL CD1DCONT BIT(8) CONSTANT('02'X);  /*   DISCONTACT              */ 64800000
* DCL CD1IPLI  BIT(8) CONSTANT('03'X);  /*   IPL INITIAL             */ 65200000
* DCL CD1IPLT  BIT(8) CONSTANT('04'X);  /*   IPL TEXT                */ 65600000
* DCL CD1IPLF  BIT(8) CONSTANT('05'X);  /*   IPL FINAL               */ 66000000
* DCL CD1DMPI  BIT(8) CONSTANT('06'X);  /*   DUMP INITIAL            */ 66400000
* DCL CD1DMPT  BIT(8) CONSTANT('07'X);  /*   DUMP TEXT               */ 66800000
* DCL CD1DMPF  BIT(8) CONSTANT('08'X);  /*   DUMP FINAL              */ 67200000
* DCL CD1RPO   BIT(8) CONSTANT('09'X);  /*   REMOTE POWER OFF        */ 67600000
* DCL CD1ACTLK BIT(8) CONSTANT('0A'X);  /*   ACTIVATE LINK           */ 68000000
* DCL CD1DACLK BIT(8) CONSTANT('0B'X);  /*   DEACTIVATE LINK         */ 68400000
* DCL CD1CESLW BIT(8) CONSTANT('0C'X);  /*   CONTROL ENTER SLOWDOWN  */ 68800000
* DCL CD1CXSLW BIT(8) CONSTANT('0D'X);  /*   CONTROL EXIT SLOWDOWN   */ 69200000
* DCL CD1CONNO BIT(8) CONSTANT('0E'X);  /*   CONNECT OUT             */ 69600000
* DCL CD1ABC   BIT(8) CONSTANT('0F'X);  /*   ABANDON CONNECTION      */ 70000000
* DCL CD1SETV  BIT(8) CONSTANT('11'X);  /*   SET CONTROL VECTOR      */ 70400000
* DCL CD1SENV  BIT(8) CONSTANT('12'X);  /*   SENSE CONTROL VECTOR    */ 70800000
* DCL CD1ESLOW BIT(8) CONSTANT('14'X);  /*   ENTERING SLOWDOWN       */ 71200000
* DCL CD1EXSLW BIT(8) CONSTANT('15'X);  /*   EXITING SLOWDOWN        */ 71600000
* DCL CD1ACI   BIT(8) CONSTANT('16'X);  /*   ACTIVATE CONNECT IN     */ 72000000
* DCL CD1DCI   BIT(8) CONSTANT('17'X);  /*   DEACTIVATE CONNECT IN   */ 72400000
* DCL CD1ACO   BIT(8) CONSTANT('18'X);  /*   ABANDON CONNECT OUT     */ 72800000
* DCL CD1ANA   BIT(8) CONSTANT('19'X);  /*   ASSIGN NETWORK ADDR     */ 73200000
* DCL CD1FNA   BIT(8) CONSTANT('1A'X);  /*   FREE NETWORK ADDR       */ 73600000
* DCL CD1REQD  BIT(8) CONSTANT('1B'X);  /*   REQUEST DISCONTACT      */ 74000000
* DCL CD1CONCT BIT(8) CONSTANT('80'X);  /*   CONTACTED               */ 74400000
* DCL CD1INOP  BIT(8) CONSTANT('81'X);  /*   INOPERATIVE             */ 74800000
* DCL CD1REQC  BIT(8) CONSTANT('84'X);  /*   REQUEST CONTACT         */ 75200000
         @SPACE;                                                        75600000
*/*                                                                  */ 76000000
*/*      MAINTENANCE SERVICES FID1 COMMANDS                          */ 76400000
*/*                                                                  */ 76800000
* DCL CD1MAINT BIT(8) CONSTANT('03'X);  /* MAINTENANCE SERV IND      */ 77200000
         @SPACE;                                                        77600000
* DCL CD1EX    BIT(8) CONSTANT('01'X);  /*   EXECUTE TEST            */ 78000000
* DCL CD1ACTTR BIT(8) CONSTANT('02'X);  /*   ACTIVATE TRACE          */ 78400000
* DCL CD1DACTR BIT(8) CONSTANT('03'X);  /*   DEACTIVATE TRACE        */ 78800000
* DCL CD1RTP   BIT(8) CONSTANT('80'X);  /*   REQUEST TEST PROCEDURE  */ 79200000
* DCL CD1RMS   BIT(8) CONSTANT('81'X);  /*   RECORD MAINT STATISTICS */ 79600000
* DCL CD1RTTD  BIT(8) CONSTANT('82'X);  /*   RECORD TEST DATA        */ 80000000
* DCL CD1RTRD  BIT(8) CONSTANT('83'X);  /*   RECORD TRACE DATA       */ 80400000
         @SPACE;                                                        80800000
*/*                                                                  */ 81200000
*/*      MEASUREMENT SERVICES FID1 COMMANDS                          */ 81600000
*/*                                                                  */ 82000000
* DCL CD1MEAS  BIT(8) CONSTANT('04'X);  /*   MEASUREMENT SERV IND    */ 82400000
         @SPACE;                                                        82800000
* DCL CD1STM   BIT(8) CONSTANT('01'X);  /*   START MEASUREMENT       */ 83200000
* DCL CD1STP   BIT(8) CONSTANT('02'X);  /*   STOP MEASUREMENT        */ 83600000
* DCL CD1RMD   BIT(8) CONSTANT('80'X);  /*   RECORD MEASUREMENT DATA */ 84000000
         @SPACE;                                                        84400000
*/*                                                                  */ 84800000
*/*      SESSION SERVICES FID1 COMMANDS                              */ 85200000
* DCL CD1SESS  BIT(8) CONSTANT('06'X);  /* SESSION SERV IND          */ 85600000
         @SPACE;                                                        86000000
* DCL CD1CINIT BIT(8) CONSTANT('01'X);  /*   CONTROL INITIATE        */ 86400000
* DCL CD1CTERM BIT(8) CONSTANT('02'X);  /*   CONTROL TERMINATE       */ 86800000
* DCL CD1NSPRO BIT(8) CONSTANT('04'X);  /*   NS PROC ERROR           */ 87200000
* DCL CD1INITS BIT(8) CONSTANT('81'X);  /*   INITIATE SELF           */ 87600000
* DCL CD1INITO BIT(8) CONSTANT('81'X);  /*   INITIATE OTHER          */ 88000000
* DCL CD1TERMO BIT(8) CONSTANT('82'X);  /*   TERMINATE OTHER         */ 88400000
* DCL CD1TERMS BIT(8) CONSTANT('83'X);  /*   TERMINATE SELF          */ 88800000
* DCL CD1BINDF BIT(8) CONSTANT('85'X);  /*   BIND FAILURE            */ 89200000
* DCL CD1SESST BIT(8) CONSTANT('86'X);  /*   SESSION STARTED         */ 89600000
* DCL CD1UBNDF BIT(8) CONSTANT('87'X);  /*   UNBIND FAILURE          */ 90000000
* DCL CD1SESEN BIT(8) CONSTANT('88'X);  /*   SESSION ENDED           */ 90400000
./  ADD  SSI=63280124,NAME=TCNRD
*        %GOTO PLSCNR;                  /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TCNRD                                                          06000010
.*A000000,999999                                               @Y17XAXF 08000010
*                                                                       10000010
*        ASSEMBLER VERSION NOT SUPPORTED                                12000010
*                                                                       14000010
         MEND  */                                                       16000010
*%PLSCNR:;                                                              18000010
*/*                                                                  */ 20000010
*/*      3705 CHECKPOINT RESOURCE RECORD                             */ 22000010
*/*                                                                  */ 24000010
*DCL 1 IEDQCNRD BASED(RCKPREC),         /*3705 CHECKPOINT RESOURCE      26000010
*                                         RECORD                     */ 28000010
*      2 CNRTNTOF FIXED(15),            /*TNT OFFSET OF THE RESOURCE */ 30000010
*      2 CNRDATTM CHAR(8),              /*DATE AND TIME OF CKPT      */ 32000010
*        3 CNRDATE CHAR(4),             /*DATE OF CKPT               */ 34000010
*        3 CNRTIME CHAR(4),             /*TIME OF CKPT               */ 36000010
*      2 CNRCNTL  BIT(16),              /*CONTROL FLAGS              */ 38000010
*        3 CNRFBHS BIT(1),              /*ACT/DEACT BHSET ISSUED     */ 40000010
*                                       /*                   @YM07411*/ 40500010
*        3 CNRFBHSC BIT(1),             /*CHANGE BHSET ISSUED        */ 41000010
*                                       /*                   @YM07411*/ 41500010
*        3 CNRFSSP BIT(1),              /*SERVICE SEEKING PAUSE         42000010
*                                         ISSUED                     */ 44000010
*        3 CNRFNPL BIT(1),              /*NEGATIVE POLL LIMIT ISSUED */ 46000010
*        3 CNRFCSL BIT(1),              /*CHANGE SESSION LIMIT ISSUED*/ 48000010
*        3 CNRFCTL BIT(1),              /*CHANGE TRANSMISSION LIMIT     50000010
*                                         ISSUED                     */ 52000010
*        3 CNRFMSS BIT(1),              /*MODEM SPEED SELECT ISSUED  */ 54000010
*        3 CNRFRDR BIT(1),              /*REPLACE DEVICE RECORD         56000010
*                                         ISSUED                     */ 58000010
*        3 *       BIT(8),              /*RESERVED                   */ 60000010
*      2 CNRBHSET CHAR(2),              /*BHSET DATA                 */ 62000010
*        3 CNRBHFUN CHAR(1),            /*BHSET FUNCTION             */ 64000010
*          4 CNRBHFN0 BIT(1),           /*FLAG FOR FUNCTION TYPE        64600010
*                                         0-ACT/DACT,1-CHANGE        */ 65200010
*          4 *        BIT(7),           /*RESERVED                   */ 66000010
*        3 CNRBHPOS CHAR(1),            /*BHSET POSITION             */ 67000010
*      2 CNRSSPAU CHAR(1),              /*SERVICE SEEKING PAUSE DATA */ 68000010
*      2 CNRNEGPL CHAR(1),              /*NEGATIVE POLL LIMIT DATA   */ 70000010
*      2 CNRCSLIM CHAR(1),              /*CHANGE SESSION LIMIT DATA  */ 72000010
*      2 CNRCTLIM CHAR(1),              /*CHANGE TRANSMISSION LIMIT     74000010
*                                         DATA                       */ 76000010
*      2 CNRMSSEL CHAR(1),              /*MODEM SPEED SELECT DATA    */ 78000010
*      2 CNRDEVRC CHAR(*);              /*DEVICE RECORD              */ 80000010
./  ADD  SSI=70060527,NAME=TCOMD
*        %GOTO COMPLS;                  /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TCOMD                                                          06000010
.*A000000,999999                                               @Y17XAXF 08000010
IEDCOM   DSECT                                                          10000010
*                                                                       12000010
*        DSECT FOR COMMON IPL/DMP WKAREA (IGCMH10D,MI,MP,MD,ME,MF,MG)   14000010
*                                                                       16000010
COMKEY   DS    XL1 .                    KEY FIELD                       18000010
COMQCB   DS    AL3 .                    QCB ADDRESS                     20000010
COMPRI   DS    XL1 .                    PRIORITY FIELD                  22000010
COMLINK  DS    AL3 .                    LINK FIELD                      24000010
COMOPCE  DS    A .                      OPCE POINTER                    26000010
COMFLAGS DS    XL1 .                    FLAG FIELD                      28000010
COMDLCN4 EQU   X'02' .                   DLC RETURN TO N4               30000010
COMDLCMP EQU   X'12' .                   DLC RETURN TO MP               32000010
COMDLCMF EQU   X'14' .                   DLC RETURN TO MF               34000010
         DS    AL3 .                    RESERVED                        36000010
COMTTRZ  DS    A .                      TTR SAVE AREA          @YM04692 38000010
         MEND                                                           40000010
*        */                                                             42000010
*%COMPLS:;                                                              44000010
*DECLARE                                                                46000010
*  1 IEDCOM BASED BDY(WORD),                                            48000010
*/*                                                                  */ 50000010
*/*      DSECT FOR COMMON IPL/DMP WKAREA (IGCMH10D,MI,MP,MD,ME,MF,MG)*/ 52000010
*/*                                                                  */ 54000010
*   2 COMKEY   PTR(8),                  /* KEY FIELD                 */ 56000010
*   2 COMQCB   PTR(24),                 /* QCB ADDRESS               */ 58000010
*   2 COMPRI   PTR(8),                  /* PRIORITY FIELD            */ 60000010
*   2 COMLINK  PTR(24),                 /* LINK FIELD                */ 62000010
*   2 COMOPCE  PTR(31),                 /* OPCE POINTER              */ 64000010
*   2 COMFLAGS BIT(8),                  /* FLAG FIELD                */ 66000010
*   2 *        PTR(24),                 /* RESERVED                  */ 68000010
*   2 COMTTRZ  PTR(31),                 /* TTR SAVE AREA     @YM04692*/ 70000010
./  ADD  SSI=61050115,NAME=TCOMDMPD
*        %GOTO COMDPLS;                 /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TCOMDMPD                                                       09000010
.*A000000.999999                                               @Y17XAXF 12000010
*                                                                       15000010
*        COMMON DUMP WORKAREA (IGCMP10D)                                18000010
*                                                                       21000010
COMINBF1 DS    512C .                   INPUT BUFFER1                   24000010
COMINBF2 DS    512C .                   INPUT BUFFER2                   27000010
         DS    F .                      RESERVED                        30000010
COMNEXT  DS    A .                      NEXT DATA TO XFER               33000010
COMNEXT1 DS    A .                      INITIAL AREA                    36000010
COMDECB  DS    20C .                    DECB FOR WRITES                 39000010
COMLEN   EQU   *-IEDCOM .               COMMON WKAREA LENGTH            42000010
         MEND                                                           45000010
*        */                                                             48000010
*%COMDPLS:;                                                             51000010
*/*                                                                  */ 54000010
*/*      COMMON DUMP WKAREA (IGCMP10D)                               */ 57000010
*/*                                                                  */ 60000010
*   2 COMINBF1 CHAR(512),               /* INPUT BUFFER1             */ 63000010
*   2 COMINBF2 CHAR(512),               /* INPUT BUFFER2             */ 66000010
*   2 *        PTR(31),                 /* RESERVED                  */ 69000010
*   2 COMNEXT  PTR(31),                 /* NEXT DATA TO XFER         */ 72000010
*   2 COMNEXT1 PTR(31),                 /* INITIAL AREA              */ 75000010
*   2 COMDECB  CHAR(20);                /* DECB FOR WRITES           */ 78000010
*%COMLEN='LENGTH(IEDCOM)';              /* COMMON WKAREA LENGTH      */ 81000010
*/* COMFLAGS VALUES                                                  */ 84000010
*DCL COMDLCN4 BIT(8) CONSTANT('02'X);   /* DLC RETURN TO N4          */ 87000010
*DCL COMDLCMP BIT(8) CONSTANT('12'X);   /* DLC RETURN TO MP          */ 90000010
*DCL COMDLCMF BIT(8) CONSTANT('14'X);   /* DLC RETURN TO MF          */ 93000010
./  ADD  SSI=61050116,NAME=TCOMIPLD
*        %GOTO COMIPLS;                 /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TCOMIPLD                                                       06000010
.*A000000,999999                                                        08000010
*                                                                       10000010
*        COMMON IPL WORKAREA (IGCMD10D,MF,ME,MG)                        12000010
*                                                                       14000010
COMCCWS  DS    3D .                     CHANNEL COMMAND WORDS           16000010
COMCCW1  EQU   COMCCWS .                 1ST CCW                        18000010
COM1CNT  EQU   COMCCW1+6                 1ST CCW COUNT                  20000010
COMCCW2  EQU   COMCCWS+8 .               2ND CCW                        22000010
         DS    F .                      RESERVED                        24000010
COMINBF1 DS    512C .                   INPUT BUFFER1                   26000010
COMINBF2 DS    512C .                   INPUT BUFFER2                   28000010
COMLEN   EQU   *-IEDCOM .               COMMON WKAREA LENGTH            30000010
         MEND                                                           32000010
*        */                                                             34000010
*%COMIPLS:;                                                             36000010
*/*                                                                  */ 38000010
*/*      COMMON IPL WORKAREA (IGCMD10D,MF,ME,MG)                     */ 40000010
*/*                                                                  */ 42000010
*   2 COMCCWS  CHAR(24),                /* CHANNEL COMMAND WORDS     */ 44000010
*    3 COMCCW1  CHAR(8),                /*  1ST CCW                  */ 46000010
*     4 *        CHAR(6),               /*   RESERVED                */ 48000010
*     4 COM1CNT  CHAR(1),               /*   1ST CCW COUNT           */ 50000010
*     4 *        CHAR(1),               /*   RESERVED                */ 52000010
*    3 COMCCW2  CHAR(8),                /*  2ND CCW                  */ 54000010
*    3 *        CHAR(8),                /*  RESERVED                 */ 56000010
*   2 *        CHAR(4),                 /* RESERVED                  */ 58000010
*   2 COMINBF1 CHAR(512),               /* INPUT BUFFER1             */ 60000010
*   2 COMINBF2 CHAR(512);               /* INPUT BUFFER2             */ 62000010
*%COMLEN='LENGTH(IEDCOM)';              /* COMMON WKAREA LENGTH      */ 64000010
*/* COMFLAGS VALUES                                                  */ 66000010
*DCL COMDLCN4 BIT(8) CONSTANT('02'X);   /* DLC RETURN TO N4          */ 68000010
*DCL COMDLCMP BIT(8) CONSTANT('12'X);   /* DLC RETURN TO MP          */ 70000010
*DCL COMDLCMF BIT(8) CONSTANT('14'X);   /* DLC RETURN TO MF          */ 72000010
./  ADD  SSI=60241330,NAME=TCONV
         MACRO                                                          00700010
&NAME  TCONV   &MF=,&TYPE=EH,&FROM=,&TO=,&COUNT=,&MAP=NO,&LSTNAME=,    X01400010
               &RET=                                                    02100010
.*                                                                      02800010
         GBLB  &EXECUTV,&E536454                                        03500010
         GBLB  &RCC .        SET TO 1 IF INTLZE WILL SUPPORT RCC        04200010
         LCLA  &FLAG,&ERROR,&KOUNT                                      04900010
         LCLB  &RCC1                                                    05600010
         LCLC  &F,&SIZE,&CHAR,&Z                                        06300010
.*                                                                      07000010
         AIF   ('&MAP' EQ 'YES').MAP1                                   07700010
         AIF   (T'&MF EQ 'O').STD                                       08400010
         AIF   ('&MF' EQ 'L' OR '&MF' EQ 'S').STD                       09100010
         AIF   ('&MF'(1,3) NE '(E,').MFERROR                            09800010
&CHAR    SETC  '&NAME'                                                  10500010
         AIF   ('&MF'(4,3) EQ '(1)').RG1                                11200010
         AIF   ('&MF'(4,1) EQ '(').RG2                                  11900010
&CHAR    LA    R1,&MF(2) .         ADDRESS OF PARAMETER LIST            12600010
&CHAR    SETC  ' '                                                      13300010
         AGO   .RG1                                                     14000010
.RG2     ANOP                                                           14700010
&KOUNT   SETA  K'&MF(2)-2                                               15400010
&F       SETC  '&MF(2)'(2,&KOUNT)                                       16100010
         AIF   ('&F'(1,1) EQ 'R').C724                                  16800010
&CHAR    LR    R1,R&F .            ADDRESS OF PARAMETER LIST            17500010
&CHAR    SETC  ' '                                                      18200010
         AGO   .RG1                                                     18900010
.C724    ANOP                                                           19600010
&CHAR    LR    R1,&F .             ADDRESS OF PARAMETER LIST            20300010
&CHAR    SETC  ' '                                                      21000010
.RG1     ANOP                                                           21700010
.RCC2    ANOP                                                           22400010
         AIF   ('&RCC' EQ '0').RCCA                                     23100010
         AIF   (T'&RET EQ 'O').RCCD                                     23800010
         AIF   ('&RET'(1,1) EQ '#').RCCB                                24500010
         AIF   ('&RET'(1,1) EQ '(').RCCC                                25200010
         MVC   $RETMASK,&RET .     SET RETURN CODE MASK                 25900010
         AGO   .RCCD                                                    26600010
.RCCE    ANOP                                                           27300010
         MVI   $RETMASK,#ALL-#RC0 . SET RETURN CODE MASK                28000010
         AGO   .RCCD                                                    28700010
.RCCB    ANOP                                                           29400010
         MVI   $RETMASK,#ALL-&RET . SET RETURN CODE MASK                30100010
         AGO   .RCCD                                                    30800010
.RCCC    ANOP                                                           31500010
         MVI   $RETMASK,#ALL-&RET(1) . SET RETURN CODE MASK             32200010
         AGO   .RCCD                                                    32900010
.RCCA    ANOP                                                           33600010
         AIF   (T'&RET EQ 'O').RCCD                                     34300010
         MNOTE 5,'RETURN CODE NOT SUPPORTED BY -INTLZE-'                35000010
.RCCD    ANOP                                                           35700010
         AIF   (&RCC1).RCC3                                             36400010
&CHAR    BAL   R14,#EXIT .         BRANCH TO LINKAGE SUBROUTINE         37100010
         MEXIT                                                          37800010
.MFERROR MNOTE 8,'MF VALUE (&MF) INCORRECT, NO STATEMENTS GENERATED.'   38500010
         MEXIT                                                          39200010
.STD     ANOP                                                           39900010
         AIF   (T'&FROM NE 'O').TEST3                                   40600010
&ERROR   SETA  1                                                        41300010
         MNOTE 8,'FROM ADDRESS MISSING.'                                42000010
.TEST3   AIF   (T'&TO NE 'O').TEST4                                     42700010
&ERROR   SETA  1                                                        43400010
         MNOTE 8,'TO ADDRESS MISSING.'                                  44100010
.TEST4   AIF   (T'&COUNT NE 'O').BEGIN                                  44800010
&ERROR   SETA  1                                                        45500010
         MNOTE 8,'COUNT MISSING.'                                       46200010
.BEGIN   ANOP                                                           46900010
         AIF   (&ERROR EQ 1).EXIT                                       47600010
         AIF   ('&TYPE' NE 'HE').CNVRT2                                 48300010
&FLAG    SETA  X'8000'                                                  49000010
.CNVRT2  ANOP                                                           49700010
         AIF   ('&MF' EQ 'L').LIST                                      50400010
&NAME    LA    R14,&FROM(1) . GET ADDR OF DATA                          51100010
         AIF   (N'&FROM EQ 1).CNVRT4                                    51800010
.TEST5   AIF   (&FROM(2) GE 2 OR &FROM(2) LE 14).CNVRT3                 52500010
&ERROR   SETA  1                                                        53200010
         MNOTE 8,'INVALID REG SPEC FOR FROM.'                           53900010
.CNVRT3  ANOP                                                           54600010
         AIF   (&ERROR EQ 1).EXIT                                       55300010
         AR    R14,&FROM(2) . INCREMENT ADDRESS                         56000010
.CNVRT4  ANOP                                                           56700010
         ST    R14,QWIE&SYSNDX . PLACE ADDR IN PARAMETER LIST           57400010
         LA    R14,&TO . GET OUTPUT DATA ADDR                           58100010
         ST    R14,QWIU&SYSNDX . OUTPUT DATA STORE                      58800010
         LA    R14,R&SYSNDX .     RETURN ADDRESS                        59500010
&RCC1    SETB  1                                                        60200010
         AGO   .RCC2                                                    60900010
.RCC3    ANOP                                                           61600010
         CNOP  0,4                                                      62300010
         BAL   R1,#EXIT .          BRANCH TO LINKAGE SUBROUTINE         63000010
&CHAR    SETC  '&LSTNAME'                                               63700010
         AGO   .STD1                                                    64400010
.LIST    ANOP                                                           65100010
&CHAR    SETC  '&NAME'                                                  65800010
         CNOP  0,4                                                      66500010
.STD1    ANOP                                                           67200010
         AIF   (&EXECUTV).OLTSEP                                        67900010
&CHAR    DC    B'00000000' .       CONTROL PROGRAM FLAGS                68600010
         AGO   .OLTSEP1                                                 69300010
.OLTSEP  ANOP                                                           70000010
&CHAR    DC    B'00000001' .       CONTROL PROGRAM FLAGS                70700010
.OLTSEP1 ANOP                                                           71400010
         DC    AL1(2) .            MACRO LEVEL                          72100010
         DC    CL2'41' .           MACRO ID                             72800010
QWIE&SYSNDX  DC  XL4'00000000' . ADDRESS OF DATA                        73500010
QWIU&SYSNDX  DC  XL4'00000000' .  OUTPUT DATA                           74200010
C&SYSNDX DC    AL2(&COUNT+&FLAG) . COUNT AND TYPE INFORMATION           74900010
**                                BIT 0 SET TO 1 INDICATES 'HE' TYPE.   75600010
         AIF   ('&MF' EQ 'L').EXIT                                      76300010
R&SYSNDX DS    0H .               RETURN ON HALFWORD BOUNDARY           77000010
         MEXIT                                                          77700010
.MAP1    ANOP                                                           78400010
CONVMAP  DSECT                                                          79100010
&Z       SETC  '$'                                                      79800010
         AIF   (&E536454).ZIPPER                                        80500010
           DC  XL1'0' .            CONTROL PROGRAM FLAGS                81200010
           DC  XL1'0' .            MACRO LEVEL                          81900010
           DC  XL2'0' .            MACRO ID                             82600010
         AGO   .ZIPPED                                                  83300010
.ZIPPER  ANOP                                                           84000010
&Z.CNVTRMG DC  XL1'0' .            CONTROL PROGRAM FLAGS                84700010
&Z.CNVLEVL DC  XL1'0' .            MACRO LEVEL                          85400010
&Z.CNVIDNT DC  XL2'0' .            MACRO ID                             86100010
.ZIPPED  ANOP                                                           86800010
&Z.CNVFROM DC  A(0) .              FROM ADDRESS                         87500010
&Z.CNVTO   DC  A(0) .              TO   ADDRESS                         88200010
&Z.CNVCT   DC  XL2'0' .            TYPE & COUNT                         88900010
.EXIT    MEND                                                           89600010
./  ADD  SSI=63140279,NAME=TCPBD
         MACRO                                                          01000020
         TCPBD &MERLIN                                                  02000010
.*A430000                                                        S21101 02500010
         SPACE                                                          03000020
IEDQCPB  DSECT                                                          04000020
*                       SEEK HEAD CCW                                   05000020
CPBHEADF DS    0F .                                                     06000020
CPBSEEK  DS    C .                      SEEK HEAD OP CODE               07000020
CPBHEAD  DS    AL3 .                    PTR TO HEAD ID                  08000020
CPBSEKFL DS    C .                      SEEK CCW FLAG, CMD CHAINING     09000020
         DS    C .                      IGNORED                         10000020
CPBSEKCT DS    H .                      SEEK COUNT OF 6                 11000020
CPBSEK6  EQU   6 .                      BYTE COUNT SEEK CCW             11500020
*        AIF   ('&MERLIN' NE '3330').SKP                       @Y17XAXF 11550010
*                       SET SECTOR CCW                                  11600010
CPBSETAF DS    0F .                                                     11650010
CPBSET   DS    X .                      SET SECTOR OP CODE              11700010
CPBSETA  DS    AL3 .                    PTR TO SECTOR ID BYTE           11750010
CPBSETFL DS    X .                      SET SECTOR CHAIN BIT FLAG       11800010
         DS    X .                      IGNORED                         11850010
CPBSETCT DS    H .                      SET SECTOR COUNT OF 1           11900010
CPBSET1  EQU   1 .                      BYTE COUNT SET SECTOR CCW       11950010
*SKP     ANOP                                                  @Y17XAXF 11960010
*                        SEARCH ID EQ CCW                               12000020
CPBSRECF DS    0F .                                                     13000020
CPBSRCH  DS    C .                      SEARCH ID EQ OP CODE            14000020
CPBSREC  DS    AL3 .                    PTR TO RECORD ID                15000020
CPBSRHFL DS    C .                      SEARCH CCW FLAG                 16000020
         DS    C .                      IGNORED                         17000020
CPBSRHCT DS    H .                      SEARCH COUNT OF 5               18000020
CPBSRH5  EQU   5 .                      BYTE COUNT SEARCH CCW           18500020
*                        TIC TO SEARCH CCW                              19000020
CPBTICSF DS    0F .                                                     20000020
CPBTIC1  DS    C .                      TIC OP CODE                     21000020
CPBTICS  DS    AL3 .                    ADDR OF SEARCH CCW              22000020
CPBUNUSD DS    0F .                     UNUSED IF NO SET SECTOR CCW     23000010
CPBSECTR DS    X .                      SECTOR ID                       23050010
CPBUNUSA DS    AL3 .                    UNUSED                          23100010
*                        RD/WR CCW                                      24000020
CPBAREAF DS    0F .                                                     25000020
CPBRDWR  DS    C .                      RD/WR OP CODE                   26000020
CPBAREA  DS    AL3 .                    ADDRESS OF I/O AREA             27000020
CPBRWFL  DS    C .                      RD/WR FLAG                      28000020
         DS    C .                      IGNORED                         29000020
CPBCOUNT DS    H .                      NUMBER OF BYTES                 30000020
*                        SECOND RD/WR CCW                               31000020
CPBXREAF DS    0F .                                                     32000020
CPBXDWR  DS    C .                      RD/WR OP CODE                   33000020
CPBXREA  DS    AL3 .                    ADDRESS OF I/O AREA             34000020
CPBXWFL  DS    C .                      RD/WR FLAG                      35000020
         DS    C .                      IGNORED                         36000020
CPBXOUNT DS    H .                      NUMBER OF BYTES                 37000020
*                        TIC TO NEXT CPB                                38000020
CPBNEXTF DS    0F .                                                     39000020
CPBTIC2  DS    C .                      TIC OP CODE                     40000020
CPBNEXT  DS    AL3 .                    PTR TO NEXT CPB                 41000020
CPBFLAG  DS    0C .                     FLAG BYTE                       42000020
*                       CPBFLAG BIT DEFINITIONS                         42010020
CPBREUSN EQU   X'80' .                  SPECIAL CPB BELONGS TO REUS     42020020
CPBCOPYN EQU   X'40' .                  SPECIAL CPB BELONGS TO COPY     42030020
CPBRDSKN EQU   X'20' .                  REUSABLE DISK B'XX10XXXX'       42040020
CPBNDSKN EQU   X'10' .                  NON-REUS DISK B'XX01XXXX'       42050020
*                                                                       42060020
* LOW ORDER 4 BITS OF CPBFLAG ARE USED AS AN INDEX INTO A BRANCH        42070020
* TABLE TO INDICATE THE PROGRESS OF THE MESSAGE BEING MOVED.  THESE     42080020
* BITS ARE REFERENCED ONLY BY IGG019RP, REUS/COPY.                      42090020
*                                                                       42100020
*              X'00' .                  'CANCELLED HEADER' MOVE         42110020
*                                         ASSIGNED NEXT HEADER          42120020
*                                         TO CURRENT ZONE               42130020
CPBADKD1 EQU   X'01' .                  'READ BAD K+D 1' FIRST FEFO     42140020
*                                         MSG WAS TOO OLD               42150020
CPBRDGD  EQU   X'02' .                  'READ GOOD DATA' FOLLOW FEFO    42160020
*                                         CHAIN THRU RECENT MSGS        42170020
CPBADKD2 EQU   X'03' .                  'READ BAD K+D 2' NON-FIRST      42180020
*                                         FEFO MSG WAS TOO OLD          42190020
CPBWRDAT EQU   X'04' .                  'WRITE DATA' WIPE OUT FEFO      42200020
*                                         POINTER THAT USED TO          42210020
*                                         POINT TO A BAD MSG WITH       42220020
*                                         CONTENTS OF DATA FIELD OF     42230020
*                                         BAD MSG SO IT SKIPS BAD       42240020
*                                         MSG BUT POINTS TO NEXT ONE    42250020
CPBWRHED EQU   X'05' .                  'WRITE HEADER' FIRST RECORD     42260020
*                                         OF OLD MSG GOES TO            42270020
*                                         ALTERNATE DESTINATION         42280020
CPBRDXTR EQU   X'06' .                  'READ XTRA' GET NON-FIRST       42290020
*                                         UNITS OF ANY BUFFER           42300020
CPBWRXTR EQU   X'07' .                  'WRITE XTRA' PUT NON-FIRST      42310020
*                                         UNIT OF ANY BUFFER TO         42320020
*                                         ALTERNATE DESTINATION         42330020
CPBRDNXT EQU   X'08' .                  'READ NEXT' GET FIRST UNIT      42340020
*                                         OF ANY NON-FIRST BUFFER       42350020
CPBSERVC EQU   X'09' .                  'WRITE SERVICED' MARK           42360020
*                                         ORIGINAL OLD COPY AS          42370020
*                                         SERVICED (NOT SENT, BUT       42380020
*                                         QUEUED FOR ALTERNATE          42390020
*                                         DESTINATION)                  42400020
CPBUFEFO EQU   X'0A' .                  'UPDATE FEFO' ADD NEW MSG       42410020
*                                         ONTO FEFO CHAIN OF MSG        42420020
*                                         THAT WAS LAST ON FEFO         42430020
*                                         CHAIN OF ALTERNATE            42440020
*                                         DESTINATION                   42450020
CPBWRHOL EQU   X'0B' .                  'WRITE HOLD DATA' IN MOVING     42460020
*                                         HELD Q TO FRONT OF FEFO Q     42470020
*                                         CHAIN FIRST FEFO MSG ONTO     42480020
*                                         FEFO Q OF LAST HELD MSG       42490020
CPBRDHOL EQU   X'0C' .                  'READ HOLD DATA' IN MOVING      42500020
*                                         HELD Q TO FRONT OF FEFO Q     42510020
*                                         AND SINCE FIRST FEFO MSG      42520020
*                                         IS BEING SERVICED, READ       42530020
*                                         ITS FEFO POINTER TO FIND      42540020
*                                       SECOND FEFO MSG SO IT CAN       42550020
*                                         BE LINKED ONTO THE LAST       42560020
*                                         HELD MSG                      42570020
CPBADDR  DS    F .                      ABSOLUTE RECORD NO.             43000020
*                                                                S21101 43100010
CPBQTYPE EQU   X'03'                    LOW ORDER 2 BITS OF      S21101 43200010
*                                       CPBFLAG INDICATE QUEUE   S21101 43300010
*                                       TYPE -                   S21101 43400010
*                                         CORE           B'00'   S21101 43500010
*                                         NON-REUS DISK  B'01'   S21101 43600010
*                                         RESERVED       B'10'   S21101 43700010
*                                         REUSABLE DISK  B'11'   S21101 43800010
*                                                                S21101 43900010
CPBABSAD DS    D .                      MBBCCHHR                        44000020
CPBLCB   DS    0A .                     DESTINATION LCB ADDRESS         44300020
*                                         (REUS/COPY ONLY)              44600020
CPBINWKA DS    X .                      COUNT OF DATA IN WORKAREA       45000020
CPBTOUNT DS    X .                      COUNT OF DATA TO BE MOVED       46000020
*                                         INTO UNIT                     47000020
CPBWKACT DS    X .                      WHERE IN WORKAREA TO START      48000020
CPBNUMB  DS    X .                      SEQUENTIAL NO. OF THIS CPB      49000020
CPBWORK  DS    0A .                     ADDRESS OF UNIT USED AS         49300020
*                                         WORKAREA (REUS/COPY ONLY)     49600020
CPBAERBF DS    0A .                     ADDRESS OF ERB                  50000020
CPBUNTCT DS    X .                      COUNT OF DATA ALREADY IN UNIT   51000020
CPBAERB  DS    AL3 .                                                    52000020
CPBSIZE  EQU   * .                                                      53000020
*                        CCW BIT DEFINITIONS                            54000020
CPBCDC   EQU   X'80' .                  DATA CHAINING                   55000020
CPBCCC   EQU   X'40' .                  COMMAND CHAINING                56000020
CPBSLIC  EQU   X'20' .                  SUPPRESS INCORRECT LENGTH       57000020
CPBSKIPC EQU   X'10' .                  SKIP DATA                       58000020
CPBTICC  EQU   X'08' .                  TIC COMMAND                     59000020
CPBSEEKC EQU   X'1B' .                  SEEK HEAD COMMAND               60000020
CPBSETC  EQU   X'23' .                  SET SECTOR COMMAND              60050010
CPBRDKC  EQU   X'0E' .                  READ KEY AND DATA COMMAND       61000020
CPBWRKC  EQU   X'0D' .                  WRITE KEY AND DATA COMMAND      62000020
CPBRDC   EQU   X'06' .                  READ DATA COMMAND               63000020
CPBWRC   EQU   X'05' .                  WRITE DATA COMMAND              64000020
CPBSRCHC EQU   X'31' .                  SEARCH ID EQ OP                 65000020
CPBNOPC  EQU   X'03' .                  NO OP                           66000020
CPBWRITB EQU   X'01' .                  WRITE DATA OR K+D BIT           67000020
CPBKEYB  EQU   X'08' .                  KEY BIT                         68000020
         SPACE 2                                                        78000020
         MEND                                                           79000020
./  ADD  SSI=71181405,NAME=TCURD
*        %GOTO PLSCUR;                  /* BINLINGUAL HEADER            01000000
         MACRO                                                          02000000
         TCURD                                                          03000000
*                                                                       04000000
*        ASSEMBLER VERSION NOT SUPPORTED                                05000000
*                                                                       06000000
         MEND  */                                                       07000000
*%PLSCUR:;                                                              08000000
*/*                                                                  */ 09000000
*/*      CLEANUP REQUEST ELEMENT                                     */ 10000000
*/*                                                                  */ 11000000
 DCL 1 IEDCUREQ BDY(WORD) BASED(RCUR),                                  12000000
     2 CURKEY CHAR(1),             /*KEY FIELD                       */ 13000000
     2 CURQCB PTR(24),             /*QCB ADDRESS                     */ 14000000
     2 CURPRI CHAR(1),             /*PRIORITY FIELD                  */ 15000000
     2 CURELEM PTR(24),            /*PIU ADDRESS SAVE FIELD          */ 16000000
     2 CURLINK PTR(31),            /*LINK FIELD                      */ 17000000
     2 CURTOTIN PTR(15),           /*TOTE TTCIN FIELD                */ 18000000
       3 CURFLG1 CHAR(1),          /*FLAG FIELD                      */ 19000000
       3 CURSWCH CHAR(1),          /*SWITCH FIELD                    */ 20000000
     2 CURFLG2 CHAR(1),            /*FLAG FIELD                      */ 21000000
       3 CURF0FIN BIT(1),          /*FINIS SEARCH FID0 RESPONSE CHAIN*/ 22000000
       3 CURF1SEQ BIT(1),          /*FINIS SEARCH FID1 SEQUENCED        23000000
                                     RESPONSE CHAIN                  */ 24000000
       3 CURF1ID BIT(1),           /*FINIS SEARCH FID1 ID RESPONSE CH*/ 25000000
       3 CURENDCH BIT(1),          /*END OF CHAIN INDICATOR          */ 26000000
       3 * BIT(2),                 /*UNUSED                          */ 27000000
       3 CURATTCH BIT(1),          /*PIU ATTACHED INDICATOR          */ 28000000
       3 CURTERM BIT(1),           /*FORCD TERMINATE CLEANUP @YM08991*/ 29000010
     2 CURFLG3 CHAR(1),            /*FLAG FIELD                      */ 30000000
       3 CUREPOST BIT(1),          /*CU REPOST REQUEST               */ 31000000
       3 CURTOTEP BIT(1),          /*TOTE POST REQUEST               */ 32000000
       3 CURFIRST BIT(1),          /*FIRST TIME SWITCH               */ 33000000
       3 CURNCURE BIT(1),          /*REPOST REQUEST TO IEDNCU @YM07310*/34000000
       3 CURDIAL  BIT(1),          /*RVT SCAN FOR DIAL DONE   @YM08536*/34200000
       3 * BIT(3),                 /*UNUSED                          */ 34500000
     2 CURPIUCT FIXED(15),         /*PIUS POSTED COUNTER             */ 35000000
     2 CURFAILT FIXED(15),         /*FAILING RESOURCE TTCIN          */ 36000000
     2 CURTTCIN FIXED(15),         /*TTCIN OF RESOURCE TO CLEAN         37000000
                                     UP                              */ 38000000
     2 CURNXTRC FIXED(15),         /*NEXT HIGHER RESOURCE TTCIN      */ 39000000
     2 CURNEWBF PTR(31),           /*NEW BUFFER WAIT CHAIN           */ 40000000
     2 CURTOTBF PTR(31),           /*TOTE POST QUEUE                 */ 41000000
     2 CURPIUPC PTR(31),           /*PIUS FOR PATH  CONTROL          */ 42000000
     2 CUROPCE PTR(31),            /*POINTER TO DEACT OPCE           */ 43000000
     2 CURTRM PTR(31);             /*TRM ADDRESS OF EFFECTED RESOURCE*/ 44000000
*/*                                                                  */ 45000000
*/*     CURSWCH VALUES                                               */ 46000000
*/*                                                                  */ 47000000
 DCL CURFDACT BIT(8) CONSTANT('37'X); /*FORCE DEACTIVATE REQUEST     */ 48000000
 DCL CURCINOP BIT(8) CONSTANT('38'X); /*CLEANUP REQUEST FOR CHAN INOP*/ 49000000
 DCL CURCUREQ BIT(8) CONSTANT('39'X); /*CLEANUP REQUEST              */ 50000000
*/*                                                                  */ 51000000
*/*       CURFLG1 VALUES                                             */ 52000000
*/*                                                                  */ 53000000
 DCL CURC0 BIT(8) CONSTANT('0D'X);/*USED WITH PRILOFLG - TO REDRIVE     54000000
                                    IGCC110D                         */ 55000000
 DCL CURFG BIT(8) CONSTANT('0E'X);/*USED WITH PRILOFLG - TO RETURN      56000000
                                    CLEANUP REQUEST ELEMENT TO          57000000
                                    IGCFG10D FROM IEDNCU             */ 58000000
./  ADD  SSI=60241333,NAME=TDATAD
         MACRO                                                          02000020
         TDATAD                                                         04000020
         SPACE                                                          06000020
IEDQDATA DSECT                                                          08000020
.* CHANGE ACTIVITY = AS FOLLOWS:                                        08000110
.*A306000-312000                                                SA50192 08000210
.*C100000                                                       SA50192 08000310
*              UPDATED   11/02/72                               SA50192 10000010
         SPACE                                                          12000020
DATFLAGS DS    X .                      FLAG BYTE                       14000020
*                       BIT DEFINITIONS                                 16000020
DATNPRFX EQU   X'80' .                  '1'-NO PREFIX IN RECORD         18000020
*                                       '0'-HAS PREFIX IN RECORD        20000020
DATSENT  EQU   X'40' .                  '1'-MSG HAS BEEN SERVICED       22000020
*                                       '0'-NOT SERVICED                24000020
DATCNCLD EQU   X'20' .                  '1'-MSG IS CANCELED             26000020
*                                       '0'-MSG IS NOT CANCELED         28000020
DATLOSTN EQU   X'10' .                  '1'-MSG LOST FROM CORE QUEUE    30000020
DATIFEFO EQU   X'08' .                  INIT FEFO MSG ON PQCB   SA50192 30600010
DATINITL EQU   X'01' .                  INITIATE MSG LOST       SA50192 31200010
*                      REMAINING BITS UNDEFINED                         32000020
*                                                                       34000020
DATFEFO  DS    AL3 .                    FEFO POINTER TO MEXT MSG TO     36000020
*                                         BE COMPLETELY RECEIVED        38000020
*                                         FOR THIS DESTINATION          40000020
DATCOUNT DS    0C .                     FOR TEXT RECORDS ONLY, THE      42000020
*                                         NUMBER OF BYTES OF            44000020
*                                         SIGNIFICANT TEXT IN           46000020
*                                         THIS RECORD KEY FIELD, OR     48000020
*                                         ZERO IF NOT LAST TEXT REC     50000020
DATSEQOT DS    H .                      FOR HEADER RECORDS ONLY,        52000020
*                                         THE SEQUENCE OUT NUMBER       54000020
DATSCAN  DS    H .                      SAVES SCAN POINTER              56000020
*                                         (NUMBER OF IDLES REMAINING)   58000020
*                                         WHILE BUILDING A BUFFER       60000020
*                                         FROM THIS UNIT                62000020
*                                       NOT USED IN CORE OR DISK        64000020
*                                         MESSAGE QUEUE DATA SETS       66000020
         SPACE 2                                                        68000020
         MEND                                                           70000020
./  ADD  SSI=62120249,NAME=TDCTD
*        %GOTO DCTPLS;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TDCTD                                                          03000010
.*A000000-999999                                               @Y17XAXF 04000010
IEDDCT   DSECT                                                          05000010
*                                                                       06000010
*        DSECT FOR A DEVICE CHARACTERISTIC TABLE ENTRY (DCT)            07000010
*                                                                       08000010
DCTBYTE0 DS    CL1 .               RESERVED                             09000010
         SPACE                                                          10000010
DCTBYTE1 DS    CL1 .               BYTE 1                               11000010
DCTINHIB EQU   X'80' .  (CINHIBIT)   TERMINAL CAN USE READ INHIBIT CCW  12000010
DCTBREAK EQU   X'40' .  (CBREAK  )   TERMINAL HAS REVERSE BREAK FEATURE 13000010
DCTATTEN EQU   X'20' .  (CATTEN  )   TERMINAL HAS THE ATTENTION FEATURE 14000010
DCT5041  EQU   X'10' .  (C5041)  )   2741 & 1050 INTERRUPT FEATURE      15000010
DCT2741  EQU   X'08' .  (C2741   )   2741 ON THIS LINE                  16000010
DCT3270  EQU   X'04' .  (C3270   )   3270 DEVICE                        17000010
DCTSADEV EQU   X'02' .  (CSADEV  )   STAND ALONE DEVICE                 18000010
DCTUMASK EQU   X'01' .  (CUMASK  )   CONTROL UNIT(2848 OR 3270)         19000010
         SPACE                                                          20000010
DCTBYTE2 DS    CL1 .               BYTE 2                               21000010
DCTBISYN EQU   X'80' .  (CBISYNC )   BSC STATION                        22000010
DCTBRDST EQU   X'40' .  (CBRDCST )   TERMINAL IS FOR BROADCAST DATA     23000010
DCTTWX   EQU   X'20' .  (CTWX    )   TWX 3335 TERMINAL                  24000010
DCTSTCTL EQU   X'10' .  (CSTNCTL )   TERMINAL HAS STATION CTL FEATURE   25000010
DCTXMIT  EQU   X'08' .  (CXMITCTL)   TERMINAL HAS TRANSMIT CTL FEATURE  26000010
DCTCONT  EQU   X'04' .  (CCONTENT)   CONTENTION DEVICE                  27000010
DCTLOCAL EQU   X'02' .  (CLOCAL  )   LOCAL DEVICE                       28000010
DCTAUDIO EQU   X'01' .  (CAUDIO  )   AUDIO DEVICE                       29000010
         SPACE                                                          30000010
DCTBYTE3 DS    CL1 .               BYTE 3                               31000010
DCT1050  EQU   X'80' .               1050                               32000010
DCTWTTA  EQU   X'40' .  (CWTTA   )   WORLD TRADE TELEGRAPH              33000010
DCTENCTL EQU   X'20' .  (CENDCTL )   TERMINAL HAS END-TO-END CTLS(2780) 34000010
DCTCHECK EQU   X'10' .  (CCHECK  )   TERMINAL HAS THE CHECKING FEATURE  35000010
DCTBUFF  EQU   X'08' .               BUFFER DELAY (2740 MOD2)           36000010
DCTCONTN EQU   X'04' .  (CCONTIN )   TERMINAL SUPPORTS CONTINUE OPER    37000010
DCTNOIDL EQU   X'02' .  (CNOIDLES)   TERMINAL HAS NO IDLES DEFINED      38000010
DCT2760  EQU   X'01' .  (C2760   )   2760                               39000010
         SPACE                                                          40000010
DCTBYTE4 DS    CL1 .               BYTE 4                               41000010
*        DCTFMPRF  BITS 0-3          FM PROFILE NUMBER                  42000010
*        DCTTSPRF  BITS 4-7          TS PROFILE NUMBER                  43000010
         SPACE                                                          44000010
DCTBYTE5 DS    CL1 .               BYTE 5                               45000010
DCTSCS   EQU   X'80' .               USS=SCS FOR LUNT                   46000010
DCTL3270 EQU   X'40' .               USS=3270 FOR LUNT                  47000010
*        EQU   X'20'-X'01'           RESERVED                           48000010
DCTLEN   EQU   *-IEDDCT .               LEN OF DCT ENTRY                49000010
         MEND                                                           50000010
*                                                                    */ 51000010
*%DCTPLS:;                                                              52000010
*DECLARE                                                                53000010
*  1 IEDDCT  BASED BDY(BYTE),                                           54000010
*/*                                                                  */ 55000010
*/*      DSECT FOR A DEVICE CHARACTERISTICS TABLE ENTRY (DCT)        */ 56000010
*/*                                                                  */ 57000010
*    2 DCTBYTE0 CHAR(1),                /* RESERVED                  */ 58000010
*    2 DCTBYTE1 CHAR(1),                /* BYTE1                     */ 59000010
*      3 DCTINHIB BIT(1),  /*CINHIBIT*/ /*   TERM CAN USE RD INHT CCW*/ 60000010
*      3 DCTBREAK BIT(1),  /*CBREAK  */ /*   TERM HAS REVERSE BRK FEA*/ 61000010
*      3 DCTATTEN BIT(1),  /*CATTEN  */ /*   TERM HAS ATTENTION FEAT */ 62000010
*      3 DCT5041  BIT(1),  /*C5041   */ /*   2741 & 1050 INTERR FEAT */ 63000010
*      3 DCT2741  BIT(1),  /*C2741   */ /*   2741 ON THIS LINE       */ 64000010
*      3 DCT3270  BIT(1),  /*C3270   */ /*   3270 DEVICE             */ 65000010
*      3 DCTSADEV BIT(1),  /*CSADEV  */ /*   STAND ALONE DEVICE      */ 66000010
*      3 DCTUMASK BIT(1),  /*CUMASK  */ /*   CONTROL UNIT(2848/3270) */ 67000010
*    2 DCTBYTE2 CHAR(1),                /* BYTE2                     */ 68000010
*      3 DCTBISYN BIT(1),  /*CBISYNC */ /*   BSC STATION             */ 69000010
*      3 DCTBRDST BIT(1),  /*CBRDCST */ /*   TERM IS FOR BRDCAST DATA*/ 70000010
*      3 DCTTWX   BIT(1),  /*CTWX    */ /*   TWX 3335 TERMINAL       */ 71000010
*      3 DCTSTCTL BIT(1),  /*CSTNCTL */ /*   TERM HAS STATION CTL FEA*/ 72000010
*      3 DCTXMIT  BIT(1),  /*CXMITCTL*/ /*   TERM HAS XMIT CTL FEAT  */ 73000010
*      3 DCTCONT  BIT(1),  /*CCONTENT*/ /*   CONTENTION DEVICE       */ 74000010
*      3 DCTLOCAL BIT(1),  /*CLOCAL  */ /*   LOCAL DEVICE            */ 75000010
*      3 DCTAUDIO BIT(1),  /*CAUDIO  */ /*   AUDIO DEVICE            */ 76000010
*    2 DCTBYTE3 CHAR(1),                /* BYTE3                     */ 77000010
*      3 DCT1050  BIT(1),               /*   1050                    */ 78000010
*      3 DCTWTTA  BIT(1),  /*CWTTA   */ /*   WORLD TRADE TELEGRAPH   */ 79000010
*      3 DCTENCTL BIT(1),  /*CENDCTL */ /*   TERM HAS END-TO-END CTLS*/ 80000010
*      3 DCTCHECK BIT(1),  /*CCHECK  */ /*   TERM HAS CHECKING FEAT  */ 81000010
*      3 DCTBUFF  BIT(1),               /*   BUFFER DELAY (2740 MOD2)*/ 82000010
*      3 DCTCONTN BIT(1),  /*CCONTIN */ /*   TERM SUPPORTS CONT OPER */ 83000010
*      3 DCTNOIDL BIT(1),  /*CNOIDLES*/ /*   TERM HAS NO IDLES DEF   */ 84000010
*      3 DCT2760  BIT(1),  /*C2760   */ /*   2760                    */ 85000010
*    2 DCTBYTE4 CHAR(1),                /* BYTE4                     */ 86000010
*      3 DCTFMPRF BIT(4),               /*   FM PROFILE NUMBER       */ 87000010
*      3 DCTTSPRF BIT(4),               /*   TS PROFILE NUMBER       */ 88000010
*    2 DCTBYTE5 CHAR(1),                /* BYTE5                     */ 89000010
*      3 DCTSCS   BIT(1),               /*   USS=SCS FOR LUNT        */ 90000010
*      3 DCTL3270 BIT(1),               /*   USS=3270 FOR LUNT       */ 91000010
*      3 *        BIT(6);               /*   RESERVED                */ 92000010
* %DCTLEN='LENGTH(IEDDCT)';             /* DCT LENGTH                */ 93000010
./  ADD  SSI=71080522,NAME=TDEBAPD
         MACRO                                                          02000020
         TDEBAPD                                                        04000020
IEDQDEB  DSECT                          DATA EXTENT BLOCK FOR           06000020
*                                       TCAM APPLICATION PROGRAMS       08000020
*                                                                       10000020
*                                                                       12000020
*                                                                       14000020
*                                                                     * 16000020
*                                                                     * 18000020
DEBTAMID DS    FL1                      TAM DEB IDENTIFIER              20000020
DEBTCBAD DS    3X                       ADDRESS OF TCB FOR THIS DEB     22000020
         DS    FL1                      RESERVED                        24000020
DEBDEBAD  DS    3X                       ADDRESS OF NEXT DEB            26000020
*                                       IN SAME TASK                    28000020
         DS    FL1                      RESERVED                        30000020
DEBPCBAD DS    3X                       ADDRESS OF PROCESS CONTROL      32000020
*                                       BLOCK FOR THIS TASK             34000020
         DS    4X                       RESERVED                        35000010
DEBTAMPP DS    X                        POST-PENDING FLAG BYTE          44000020
DEBPEBAD DS    AL3                      ADDRESS OF PROCESS       Y02027 45000010
*                                       EXTENSION BLOCK          Y02027 46000010
         DS    FL1                      RESERVED                        48000020
DEBPEWA  DS    AL3                      ADDRESS OF THE PROCESS   Y02027 49000010
*                                       ENTRY WORKAREA           Y02027 50000010
         DS    FL1                      RESERVED                        54000020
DEBDCBAD DS    3X                       ADDRESS OF THIS DEB'S DCB       56000020
         DS    FL1                      RESERVED                        58000020
DEBLCMWA DS    3X                       ADDRESS OF LOCATE MODE          60000020
*                                       WORKAREA                        62000020
DEBTAMOS DS    H                        TERMNAME TABLE OFFSET OF        62400010
*                                       CORRESPONDING PROCESS ENTRY     62800010
DEBSOWA  DS    H                        SIZE OF LOCATE MODE             63200010
*                                       WORKAREA                        63600010
DEBEND   EQU   *                                                        64000020
DEBSIZE  EQU   DEBEND-IEDQDEB                                           66000020
         MEND                                                           68000020
./  ADD  SSI=70250035,NAME=TDEBD
*        %GOTO BSLDEB;                                               /* 01000010
         MACRO                                                          02000020
         TDEBD                                                          04000020
         SPACE                                                          06000020
.*A000000-999999                                               @Y17XAXF 07000010
IEDQDEB  DSECT                                                          08000020
DEBAPVT  DS    0CL20 .                  APPENDAGE VECTOR TABLE   S22024 09500010
DEBEOEA  DS    CL4 .                    ADDRESS OF END-OF-EXTENT        10000020
*                                         APPENDAGE                     12000020
DEBSIOA  DS    CL4 .                    ADDRESS OF STARTI/O             14000020
*                                         APPENDAGE                     16000020
DEBPCIA  DS    CL4 .                    ADDRESS OF PCI APPENDAGE        18000020
DEBCEA   DS    CL4 .                    ADDRESS OF CHANNEL END          20000020
*                                         APPENDAGE                     22000020
DEBXCEA  DS    CL4 .                    ADDRESS OF ABNORMAL END         24000020
*                                         APPENDAGE                     26000020
DEBWKARA DS    CL1 .                    I/O SUPPORT WORK AREA           28000020
DEBDSCBA DS    CL7 .                    ADDRESS OF DSCB                 30000020
DEBDCBMK DS    CL4 .                    DCB MODIFICATION MASK           32000020
DEBLNGTH DS    CL4 .                    LENGTH OF THE DEB IN            34000020
*                                         DOUBLE WORDS                  36000020
DEBNMSUB DS    0C .                     NUMBER OF OPEN SUBROUTINES      38000020
DEBTCBAD DS    A .                      ADDRESS OF THE TCB              40000020
DEBAMLNG DS    0C .                     LENGTH ACCESS METHOD SECTION    42000020
DEBDEBAD DS    A .                      ADDRESS OF NEXT DEB             44000020
DEBOFLGS DS    0C .                     DATA SET FLAGS                  46000020
DEBIRBAD DS    A .                      ADDRESS OF THE IRB              48000020
DEBOPATB DS    0C .                     TYPE OF I/O                     50000020
DEBSYSPG DS    A .                      ADDRESS OF FIRST IOB IN SYSTEM  52000020
*                                         PURGE CHAIN                   54000020
DEBNMEXT DS    0C .                     NUMBER OF EXTENTS               56000020
DEBUSRPG DS    A .                      ADDRESS OF FIRST IOB IN THE     58000020
*                                         USER PURGE CHAIN              60000020
DEBPRIOR DS    0C .                     ZERO                            62000020
DEBECBAD DS    A .                      ADDRESS OF PARAMETER LIST TO    64000020
*                                         FIND PURGE ECB                66000020
DEBPROTG DS    0C .                     PROTECTION KEY DEB ID           68000020
DEBDCBAD DS    A .                      ADDRESS OF DCB                  70000020
DEBEXSCL DS    0C .                     EXTENT SCALE                    72000020
DEBAPPAD DS    A .                      ADDRESS OF I/O APPENDAGE VECTOR 74000020
*                                         TABLE                         76000020
DEBDVMOD DS    0C .                     DEVICE MODIFIER                 78000020
DEBUCBAD DS    A .                      ADDRESS OF UCB                  80000020
DEBSUBR  DS    CL24 .                   SUBROUTINE NAMES         S22024 81000010
         SPACE 2                                                        82000020
         MEND  , */                                                     84000010
*%BSLDEB  :  ;                                                          84300010
*DECLARE                                                                84600010
*  1 IEDQDEB BASED(IEDQDPTR) BDY(DWORD), /* DATA EXTENT CB   @YM08020*/ 84900010
*   2 DEBPRF      CHAR(36) BDY(DWORD),   /* DEB PREFIX               */ 85000010
*    3 DEBAPVT     CHAR(20) BDY(WORD),   /* APPENDAGE VECTOR TABLE   */ 85200010
*     4 DEBEOEA     PTR(31),             /* ADDRESS OF END-OF-EXTENT    85500010
*                                           APPENDAGE                */ 85800010
*     4 DEBSIOA     PTR(31),             /* ADDRESS OF START I/O        86100010
*                                           APPENDAGE                */ 86400010
*     4 DEBPCIA     PTR(31),             /* ADDRESS OF PCI APPENDAGE */ 86700010
*     4 DEBCEA      PTR(31),             /* ADDRESS OF CHANNEL END      87000010
*                                           APPENDAGE                */ 87300010
*     4 DEBXCEA     PTR(31),             /* ADDRESS OF ABNORMAL END     87600010
*                                           APPENDAGE                */ 87900010
*    3 DEBWKARA    CHAR(1),              /* I/O SUPPORT WORK AREA    */ 88200010
*    3 DEBDSCBA    CHAR(7),              /* ADDRESS OF DSCB          */ 88240010
*    3 DEBDCBMK    CHAR(4),              /* DCB MODIFICATION MASK    */ 88280010
*    3 DEBLNGTH    FIXED(8),             /* DEB LEN IN DWORD @YM08020*/ 88320010
*    3 *           CHAR(3),              /* RESERVED                 */ 88360010
*   2 DEBNMSUB    FIXED(8),              /* OPEN SUBROUT CNT @YM08020*/ 88400010
*   2 DEBTCBAD    PTR(24),               /* ADDRESS OF THE TCB       */ 88440010
*   2 DEBAMLNG    FIXED(8),              /* LEN A. M. SECT'  @YM08020*/ 88480010
*   2 DEBDEBAD    PTR(24),               /* ADDRESS OF NEXT DEB      */ 88520010
*   2 DEBOFLGS    CHAR(1),               /* DATA SET FLAGS           */ 88560010
*   2 DEBIRBAD    PTR(24),               /* ADDRESS OF THE IRB       */ 88600010
*   2 DEBOPATB    CHAR(1),               /* TYPE OF I/O              */ 88640010
*   2 DEBSYSPG    PTR(24),               /* ADDRESS OF FIRST IOB IN     88680010
*                                           SYSTEM PURGE CHAIN       */ 88720010
*   2 DEBNMEXT    FIXED(8),              /* NO. OF EXTENTS   @YM08020*/ 88760010
*   2 DEBUSRPG    PTR(24),               /* ADDRESS OF FIRST IOB IN     88800010
*                                           THE USER PURGE CHAIN     */ 88840010
*   2 DEBPRIOR    CHAR(1),               /* ZERO                     */ 88880010
*   2 DEBECBAD    PTR(24),               /* ADDRESS OF PARAMETER LIST   88920010
*                                           TO FIND PURGE ECB        */ 88960010
*   2 DEBPROTG    CHAR(1),               /* PROTECTION KEY DEB ID    */ 89000010
*   2 DEBDCBAD    PTR(24),               /* ADDRESS OF DCB           */ 89040010
*   2 DEBEXSCL    CHAR(1),               /* EXTENT SCALE             */ 89080010
*   2 DEBAPPAD    PTR(24),               /* ADDRESS OF I/O APPENDAGE    89120010
*                                           VECTOR TABLE             */ 89160010
*   2 DEBUCBS     CHAR(28);              /* FILLER FOR 3705 DEB      */ 89200010
*DECLARE                                                                89240010
*  1 DEBUCB(*) DEF(DEBUCBS),             /* UCB ADDRESSES            */ 89280010
*   2 DEBDVMOD    CHAR(1),               /* DEVICE MODIFIER          */ 89320010
*   2 DEBUCBAD    PTR(24);               /* ADDRESS OF UCB           */ 89360010
*DECLARE                                                                89400010
*    DEBSUBR(*)   CHAR(2) BASED(ADDR(DEBUCBS)+(LENGTH(DEBDVMOD)         89440010
*                              +LENGTH(DEBUCBAD))*DEBNMEXT);            89480010
*                                        /* SUBROUTINE NAMES         */ 89520010
./  ADD  SSI=62710333,NAME=TDISPD
*%GO TO BSLDISP;                        /*                     X03039*/ 00200010
*/*                                                            X03039   00400010
         MACRO                                                          00600010
         TDISPD &CSECT=NO                                      @Y17XAXA 00800010
.*A-000000-999999                                              @X31X8X0 01000010
.*CONVERTED TO BILINGUAL ON 5-23-73                              X03039 01200010
.*A000001,014000,938000                                          X03039 01400010
.*A937600                                                        S22027 01600010
.*A937300                                                        S22026 01800010
.*C028000,042000,049000,056000                                 @Y17XAXF 02000010
.*C091000,182000,280000,378000,462000                          @Y17XAXF 02200010
.*C497000,504000,553000,651000,749000,833000                   @Y17XAXF 02400010
.*C938900,939800,940100,940400                                 @Y17XAXF 02600010
.*C941900,942500,946100,946700                                 @Y17XAXF 02800010
.*C950600,951200,955400,956000,882000-937600,979400-991100     @Y17XAXF 03000010
.*C959600,960200,963800,964400,964700                          @Y17XAXF 03200010
.*C968300,968900,969200,969500,969800                          @Y17XAXF 03400010
.*C972800,973400,973700,977000,977600,977900                   @Y17XAXF 03600010
.*D483000,960500                                               @Y17XAXF 03800010
.*A854000,977900                                               @Y17XAXF 04000010
.*A040000,042000,044000,046000,068000,090000,094000,096000     @Y17XAXA 04020010
.*A118000,122000,128000,150000,158000,174000,194000,200000     @Y17XAXA 04040010
.*A232000,234000,256000,258000,280000,327000,594000            @Y17XAXA 04060010
         AIF   ('&CSECT' EQ 'NO').DSECT                        @Y17XAXA 04080010
         AIF   ('&CSECT' EQ 'YES').SAVEC                       @Y17XAXA 04100010
         MNOTE 12,'IHB300 CSECT OPTION INVALID '               @Y17XAXA 04120010
         AGO   .EXIT                                           @Y17XAXA 04140010
.DSECT   ANOP                                                  @Y17XAXA 04160010
IEDQDISP DSECT                                                          04200010
DSPSAVE  DS    F                                               @Y17XAXF 04400010
         AGO   .SAVEE                                          @Y17XAXA 04420010
.SAVEC   ANOP                                                  @Y17XAXA 04440010
         USING IGG019RO,RENTRY                                 @Y17XAXA 04460010
DSPSAVE  B     SAVE                                            @Y17XAXA 04480010
         DROP  RENTRY                                          @Y17XAXA 04500010
         USING IGG019RO,RBASE                                  @Y17XAXA 04520010
.SAVEE   ANOP                                                  @Y17XAXA 04540010
*        THIS ROUTINE IS THE FIRST ENTRY ROUTINE THAT GETS     @Y17XAXA 04560010
*             CONTROL INITIALLY .                              @Y17XAXA 04580010
         SPACE 1                                               @Y17XAXA 04600010
         AIF      ('&CSECT' EQ 'YES').DISPC                    @Y17XAXA 04620010
DSPDISP  DS    F                                               @Y17XAXA 04640010
         AGO   .DISPE                                          @Y17XAXA 04660010
.DISPC   ANOP                                                  @Y17XAXA 04680010
DSPDISP  B     DISPATCH                                        @Y17XAXA 04700010
.DISPE   ANOP                                                  @Y17XAXA 04720010
*        THIS ROUTINE DISPATCHES TCAM SUBTASKS.IF NO TCAM      @Y17XAXF 04800010
*            SUBTASKS ARE READY TO RUN,IT WILL PLACE THE TCAM  @Y17XAXF 05000010
*            CONTROL PROGRAM INTO A SYSTEM WAIT.               @Y17XAXF 05200010
         SPACE 1                                                        05400010
*         ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING      @Y17XAXA 05600010
*             INITIALIZED:                                     @Y17XAXA 05800010
*                                                                       06000010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 06200010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 06400010
         SPACE 1                                                        06800010
         AIF   ('&CSECT' EQ 'YES').LISTC                       @Y17XAXA 06820010
DSPLIST  DS    F                                               @Y17XAXA 06840010
         AGO   .LISTE                                          @Y17XAXA 06860010
.LISTC   ANOP                                                  @Y17XAXA 06880010
DSPLIST  B     LIST                                            @Y17XAXA 06900010
.LISTE   ANOP                                                  @Y17XAXA 06920010
*        THIS ROUTINE WILL TPOST ALL ITEMS IN A LIST.THE LAST  @Y17XAXA 07000010
*             ENTRY MUST HAVE ITS HI-ORDER BIT TURNED ON.      @Y17XAXA 07200010
         SPACE 1                                                        07400010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 07600010
*             REGISTERS INITIALIZED:                           @Y17XAXA 07800010
*                                                                       08000010
*         1       CONTAINS ADDRESS OF FIRST ENTRY IN A LIST OF          08200010
*                          ITEMS TO BE PLACED ON READY QUEUE BY         08400010
*                          PRIORITY                                     08600010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 08800010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 09000010
*        14       EXIT ADDRESS FROM SUBTASK                    @Y17XAXA 09100010
         SPACE 1                                                        09400010
         AIF   ('&CSECT' EQ 'YES').CHAINC                      @Y17XAXA 09420010
DSPCHAIN DS    F                                               @Y17XAXA 09440010
         AGO   .CHAINE                                         @Y17XAXA 09460010
.CHAINC  ANOP                                                  @Y17XAXA 09480010
DSPCHAIN B     CHAIN                                           @Y17XAXA 09500010
.CHAINE  ANOP                                                  @Y17XAXA 09520010
*        THIS ROUTINE WILL TPOST ALL ITEMS IN A PASSED CHAIN   @Y17XAXA 09600010
*             OF ITEMS                                         @Y17XAXA 09660010
         SPACE 1                                                        09720010
*        THE LAST ITEM IN THE CHAIN MUST HAVE A LINK FIELD              09800010
*        CONTAINING X'000000'.                                          10000010
         SPACE 1                                                        10200010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 10400010
*             REGISTERS INITIALIZED:                           @Y17XAXA 10600010
*                                                                       10800010
*         1       CONTAINS ADDRESS OF FIRST ITEM IN A CHAIN OF          11000010
*                          ITEMS TO BE PLACED ON READY QUEUE BY         11200010
*                          PRIORITY                                     11400010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 11600010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 11800010
*        14       EXIT ADDRESS FROM SUBTASK                    @Y17XAXA 11900010
         SPACE 1                                                        12200010
         AIF   ('&CSECT' EQ 'YES').WAITC                       @Y17XAXA 12220010
DSPWAIT  DS    F                                               @Y17XAXA 12240010
         AGO   .WAITE                                          @Y17XAXA 12260010
.WAITC   ANOP                                                  @Y17XAXA 12280010
DSPWAIT  B     QWAIT                                           @Y17XAXA 12300010
.WAITE   ANOP                                                  @Y17XAXA 12320010
*        THIS ROUTINE WILL OBTAIN AN ELEMENT,IF AVAILABLE,FROM @Y17XAXA 12400010
*             A QCB AND PASS IT BACK TO THE SUBTASK.IF NOT     @Y17XAXA 12500010
*             AVAILABLE IT WILL QUEUE THE STCB TO WAIT FOR AN  @Y17XAXA 12600010
*             ELEMENT                                          @Y17XAXA 12700010
         SPACE 1                                                        13000010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 13200010
*             REGISTERS INITIALIZED:                           @Y17XAXA 13400010
*                                                                       13600010
*         3       CONTAINS ADDRESS OF QCB FROM WHICH ELEMENT IS         13800010
*                          DESIRED                                      14000010
*         7       CONTAINS ADDRESS OF QCB NOW CONTAINING THIS STCB      14200010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 14400010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 14600010
         SPACE 1                                                        15000010
         AIF   ('&CSECT' EQ 'YES').BYPASC                      @Y17XAXA 15020010
DSPBYPAS DS    F                                               @Y17XAXA 15040010
         AGO   .BYPASE                                         @Y17XAXA 15060010
.BYPASC  ANOP                                                  @Y17XAXA 15080010
DSPBYPAS B     BYPASS                                          @Y17XAXA 15100010
.BYPASE  ANOP                                                  @Y17XAXA 15120010
*        ENTRY AT THIS POINT WILL ACTIVATE THE STCB POINTED    @Y17XAXA 15200010
*             TO BY RSTCB IMMEDIATELY.                         @Y17XAXA 15400010
         SPACE 1                                                        15600010
*        ENTRY HERE SHOULD HAVE THE FOLLOWING REGISTERS        @Y17XAXA 15800010
*             INITILIZED                                       @Y17XAXA 15900010
*                                                                       16000010
*         1       CONTAINS ADDRESS OF ELEMENT TO BE PASSED TO SUBTASK   16200010
*         3       CONTAINS ADDRESS OF STCB TO BE ACTIVATED              16400010
*         7       CONTAINS ADDRESS OF QCB CONTAINING STCB               16600010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 16800010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 17000010
         SPACE 1                                                        17400010
         AIF   ('&CSECT' EQ 'YES').POSTC                       @Y17XAXA 17420010
DSPPOST  DS    F                                               @Y17XAXA 17440010
DSPPOSTR DS    F                                               @Y17XAXA 17460010
         AGO   .POSTE                                          @Y17XAXA 17480010
.POSTC   ANOP                                                  @Y17XAXA 17500010
DSPPOST  B     POST                                            @Y17XAXA 17520010
DSPPOSTR B     POSTR                                           @Y17XAXA 17540010
.POSTE   ANOP                                                  @Y17XAXA 17560010
*        THIS ROUTINE WILL TPOST AN ELEMENT (PLACE IT ON READY @Y17XAXF 17600010
*             QUEUE BY PRIORITY).                              @Y17XAXF 17800010
         SPACE 1                                                        18000010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING                18200010
*             REGISTERS INITIALIZED:                                    18400010
*                                                                       18600010
*         1       CONTAINS ADDRESS OF ITEM TO BE PLACED ON READY        18800010
*                          QUEUE BY PRIORITY                            19000010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 19200010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 19400010
*        14       EXIT ADDRESS FROM SUBTASK                    @Y17XAXA 19500010
         SPACE 1                                                        20000010
         AIF   ('&CSECT' EQ 'YES').TSTQC                       @Y17XAXA 20010010
DSPTSTQ  DS    F                                               @Y17XAXA 20020010
DSPTSTQR DS    F                                               @Y17XAXA 20030010
DSPUNAV  DS    F                                               @Y17XAXA 20040010
DSPUNAVR DS    F                                               @Y17XAXA 20050010
         AGO   .TSTQE                                          @Y17XAXA 20060010
.TSTQC   ANOP                                                  @Y17XAXA 20070010
DSPTSTQ  B     TESTQ                                           @Y17XAXA 20080010
DSPTSTQR B     TESTQR                                          @Y17XAXA 20090010
DSPUNAV  LA    RETURN,DISPATCH                                 @Y17XAXA 20100010
DSPUNAVR B     UNAVAILR                                        @Y17XAXA 20110010
.TSTQE   ANOP                                                  @Y17XAXA 20120010
*        THIS ROUTINE WILL MOVE AN STCB FROM ONE QCB TO ANOTHER@Y17XAXA 20200010
*             IF IT IS NOT ALREADY THERE.                      @Y17XAXA 20400010
         SPACE 1                                                        20600010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 20800010
*             REGISTERS INITIALIZED:                           @Y17XAXA 21000010
*                                                                       21200010
*         3       CONTAINS ADDRESS OF QCB FROM WHICH ELEMENT IS         21400010
*                          DESIRED                                      21600010
*         7       CONTAINS ADDRESS OF QCB NOW CONTAINING THE STCB       21800010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 22000010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 22200010
         SPACE 1                                                        23200010
         AIF   ('&CSECT' EQ 'YES').PRIOC                       @Y17XAXA 23220010
DSPPRIO  DS    F                                               @Y17XAXA 23240010
DSPPRIOR DS    F                                               @Y17XAXA 23260010
         AGO   .PRIOE                                          @Y17XAXA 23280010
.PRIOC   ANOP                                                  @Y17XAXA 23300010
DSPPRIO  LA    RETURN,DISPATCH                                 @Y17XAXA 23320010
DSPPRIOR B     PRIORITR                                        @Y17XAXA 23340010
.PRIOE   ANOP                                                  @Y17XAXA 23360010
*        THIS ROUTINE WILL INSERT AN ELEMENT INTO A CHAIN BY   @Y17XAXA 23400010
*             PRIORITY                                         @Y17XAXA 23500010
         SPACE 1                                                        23600010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 23800010
*             REGISTERS INITIALIZED:                           @Y17XAXA 24000010
*                                                                       24200010
*         1       CONTAINS ADDRESS OF ITEM TO BE PLACED IN CHAIN        24400010
*         7       CONTAINS ADDRESS OF CHAIN TO RECEIVE ITEM             24600010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 24800010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 25000010
         SPACE 1                                                        25600010
         AIF   ('&CSECT' EQ 'YES').LIFOC                       @Y17XAXA 25620010
DSPLIFO  DS    F                                               @Y17XAXA 25640010
DSPLIFOR DS    F                                               @Y17XAXA 25660010
         AGO   .LIFOE                                          @Y17XAXA 25680010
.LIFOC   ANOP                                                  @Y17XAXA 25700010
DSPLIFO  LA    RETURN,DISPATCH                                 @Y17XAXA 25720010
DSPLIFOR B     LIFOR                                           @Y17XAXA 25740010
.LIFOE   ANOP                                                  @Y17XAXA 25760010
*        THIS ROUTINE WILL INSERT AN ELEMENT AT THE TOP OF A   @Y17XAXA 25800010
*             CHAIN                                            @Y17XAXA 25900010
         SPACE 1                                                        26000010
*        ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING       @Y17XAXA 26200010
*             REGISTERS INITIALIZED:                           @Y17XAXA 26400010
*                                                                       26600010
*         1       CONTAINS ADDRESS OF ITEM TO BE PLACED IN CHAIN        26800010
*         7       CONTAINS ADDRESS OF CHAIN TO RECEIVE ITEM             27000010
*        11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER      @Y17XAXF 27200010
*        13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2                 27400010
         SPACE 1                                                        28200010
         AIF   ('&CSECT' EQ 'YES').TRACEC                      @Y17XAXA 28210010
DSPTRACE DS    F                                               @Y17XAXA 28220010
         AGO   .TRACEE                                         @Y17XAXA 28230010
.TRACEC  ANOP                                                  @Y17XAXA 28240010
DSPTRACE DC    A(TRCQCB)                                       @Y17XAXA 28250010
.TRACEE    ANOP                                                @Y17XAXA 28260010
*        ADDRESS OF TRACE QCB/STCB TO WHICH OPERATOR CONTROL   @Y17XAXA 28270010
*             TPOSTS A BUFFER TO ACTIVATE /DEACTIVATE          @Y17XAXA 28280010
*             SUBTASK TRACE (S) .                              @Y17XAXA 28290010
         EJECT                                                 @Y17XAXA 28300010
*        STCBVTO VALUES                                        @Y17XAXA 28400010
         SPACE 2                                               @Y17XAXA 28600010
DSPCWAIT EQU   0                        ISSUE SYSTEM WAIT      @Y17XAXF 28800010
DSPCPOST EQU   2                        SYS POST ATTACHED TASK @Y17XAXF 29000010
DSPMCPL2 EQU   4                        ACTIVATE 2-BYTE STCB   @Y17XAXF 29200010
DSPMCPL4 EQU   6                        ACTIVATE 4-BYTE STCB   @Y17XAXF 29400010
DSPMCPL6 EQU   8                        ACTIVATE 6-BYTE STCB   @Y17XAXF 29600010
DSPMCPL8 EQU   10                       ACTIVATE 8-BYTE STCB   @Y17XAXF 29800010
DSPRCVSC EQU   12                       RECEIVE       SCHEDULER@Y17XAXF 30000010
DSPSNDSC EQU   14                       SEND          SCHEDULER@Y17XAXF 30200010
DSPGETSC EQU   16                       GET           SCHEDULER@Y17XAXF 30400010
DSPPUTSC EQU   18                       PUT           SCHEDULER@Y17XAXF 30600010
DSPGFFSC EQU   20                       GET FIFO      SCHEDULER@Y17XAXF 30800010
DSPLOGSC EQU   22                       LOG           SCHEDULER@Y17XAXF 31000010
DSPDIASC EQU   24                       DIAL          SCHEDULER@Y17XAXF 31200010
DSPBUFSC EQU   26                       BUFFERED TERM SCHEDULER@Y17XAXF 31400010
DSPRETSC EQU   28                       RETRIEVE      SCHEDULER@Y17XAXF 31600010
DSPLOCSC EQU   30                       LOCAL RECEIVE SCHEDULER@Y17XAXF 31800010
DSPCSCH  EQU   32 .                     CONCENTRATOR  SCHEDULER@Y17XAXF 32000010
DSPSEND  EQU   34 .                     3705 RES SEND SCHEDULER@Y17XAXF 32200010
DSPRCV   EQU   36 .                     3705 RES RECV SCHEDULER@Y17XAXF 32400010
DSPCBSCH EQU   38 .                     COMBUF        SCHEDULER@Y17XAXF 32600010
.EXIT    MEND                                                  @Y17XAXA 32700010
*                                                              X03039*/ 33000010
*%BSLDISP: ;                            /*                     X03039*/ 33200010
*  DCL   IEDQDISP  CHAR(68) BDY(HWORD) BASED(RDISP);       /*@Y17XAXF*/ 33400010
*                                                                       33600010
*                                                                       33800010
*/*  THIS ROUTINE DISPATCHES TCAM SUBTASKS.  IF NO TCAM      @Y17XAXF*/ 34000010
*/*      SUBTASKS ARE READY TO RUN, IT WILL PLACE THE TCAM   @Y17XAXF*/ 34200010
*/*      MESSAGE CONTROL PROGRAM INTO A SYSTEM WAIT.         @Y17XAXF*/ 34400010
*                                                                       34600010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 34800010
*/*      INITIALIZED:                                          X03039*/ 35000010
*/*                                                            X03039*/ 35200010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 35400010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 35600010
*     DCL DSPDISP  ENTRY BASED(ADDR(IEDQDISP)) POS(5)     /* @Y17XAXF*/ 35800010
*         VALRG(*) OPTIONS(EXIT,NOSEQFLOW);               /* @Y17XAXF*/ 35900010
*                                                                       36000010
*                                                                       36200010
*/*  THIS ROUTINE WILL TPOST ALL ITEMS IN A LIST.THE LAST ENTRYX03039*/ 36400010
*/*      MUST HAVE ITS HI-ORDER BIT TURNED ON.                 X03039*/ 36600010
*                                                                       36800010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 37000010
*/*      INITIALIZED:                                          X03039*/ 37200010
*/*                                                            X03039*/ 37400010
*/*       1       CONTAINS ADDRESS OF FIRST ENTRY IN A LIST OF X03039*/ 37600010
*/*                        ITEMS TO BE PLACED ON READY QUEUE BYX03039*/ 37800010
*/*                        PRIORITY                            X03039*/ 38000010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 38200010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 38400010
*/*      14       EXIT ADDRESS FROM SUBTASK                  @Y17XAXA*/ 38500010
*   DCL DSPLIST  ENTRY BASED(ADDR(IEDQDISP)) POS(9)      /*  @Y17XAXF*/ 38600010
*       VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /*  @Y17XAXF*/ 38700010
*                                                                       38800010
*                                                                       39000010
*/*  THIS ROUTINE WILL TPOST ALL ITEMS IN A PASSED CHAIN.      X03039*/ 39200010
*/*      THE LAST ITEM IN THE CHAIN MUST HAVE A LINK FIELD     X03039*/ 39400010
*/*      CONTAINING X'000000'.                                 X03039*/ 39600010
*                                                                       39800010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 40000010
*/*      INITIALIZED:                                          X03039*/ 40200010
*/*                                                            X03039*/ 40400010
*/*       1       CONTAINS ADDRESS OF FIRST ITEM IN A CHAIN OF X03039*/ 40600010
*/*                        ITEMS TO BE PLACED ON READY QUEUE BYX03039*/ 40800010
*/*                        PRIORITY                            X03039*/ 41000010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 41200010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 41400010
*/*      14       EXIT ADDRESS FROM SUBTASK                  @Y17XAXA*/ 41500010
*   DCL DSPCHAIN ENTRY BASED(ADDR(IEDQDISP)) POS(13)      /* @Y17XAXF*/ 41600010
*       VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                 /* @Y17XAXF*/ 41700010
*                                                                       41800010
*                                                                       42000010
*/*  THIS ROUTINE WILL OBTAIN AN ELEMENT, IF AVAILABLE, FROM A X03039*/ 42200010
*/*      QCB AND PASS IT BACK TO THE SUBTASK.  IF NOT AVAILABLEX03039*/ 42400010
*/*      IT WILL QUEUE THE STCB TO WAIT FOR AN ELEMENT.        X03039*/ 42600010
*                                                                       42800010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 43000010
*/*      INITIALIZED:                                          X03039*/ 43200010
*/*                                                            X03039*/ 43400010
*/*       3       CONTAINS ADDRESS OF QCB FROM WHICH ELEMENT ISX03039*/ 43600010
*/*                        DESIRED                             X03039*/ 43800010
*/*       7       CONTAINS ADDRESS OF QCB NOW CONTAINING THIS  X03039*/ 44000010
*/*                        STCB.                               X03039*/ 44200010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 44400010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 44600010
*   DCL DSPWAIT  ENTRY BASED(ADDR(IEDQDISP)) POS(17)      /* @Y17XAXF*/ 44800010
*       VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                 /* @Y17XAXF*/ 44900010
*                                                                       45000010
*                                                                       45200010
*/*  ENTRY AT THIS POINT WILL ACTIVATE THE STCB POINTED TO BY  X03039*/ 45400010
*/*      RSTCB IMMEDIATELY.                                    X03039*/ 45600010
*                                                                       45800010
*/*  ENTRY HERE SHOULD HAVE THE FOLLOWING REGISTERS INITIALIZED:     */ 46000010
*                                       /*                     X03039*/ 46200010
*/*       1       CONTAINS ADDRESS OF ELEMENT TO BE PASSED TO SUBTASK*/ 46400010
*/*                                                            X03039*/ 46600010
*/*       3       CONTAINS ADDRESS OF STCB TO BE ACTIVATED     X03039*/ 46800010
*/*       7       CONTAINS ADDRESS OF QCB CONTAINING STCB      X03039*/ 47000010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 47200010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 47400010
*   DCL DSPBYPAS ENTRY BASED(ADDR(IEDQDISP)) POS(21)      /* @Y17XAXF*/ 47600010
*       VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                 /* @Y17XAXF*/ 47700010
*                                                                       47800010
*                                                                       48000010
*/*  THIS ROUTINE WILL TPOST AN ELEMENT(PLACE ON READY QUEUE)  X03039*/ 48200010
*/*      BY PRIORITY).                                         X03039*/ 48400010
*                                                                       48600010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 48800010
*/*      INITIALIZED:                                          X03039*/ 49000010
*/*                                                            X03039*/ 49200010
*/*       1       CONTAINS ADDRESS OF ITEM TO BE PLACED ON RDY X03039*/ 49400010
*/*                        QUEUE BY PRIORITY                   X03039*/ 49600010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 49800010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 50000010
*/*      14       EXIT ADDRESS FROM SUBTASK                  @Y17XAXA*/ 50100010
*   DCL DSPPOST  ENTRY BASED(ADDR(IEDQDISP)) POS(25)      /* @Y17XAXF*/ 50200010
*       VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                 /* @Y17XAXF*/ 50300010
*   DCL DSPPOSTR ENTRY BASED(ADDR(IEDQDISP)) POS(29)      /* @Y17XAXF*/ 50400010
*       VALRG(*);                                         /* @Y17XAXF*/ 50500010
*                                                                       50600010
*                                                                       50800010
*/*  THIS ROUTINE WILL MOVE AN STCB FROM ONE QCB TO ANOTHER IF IT    */ 51000010
*/*      IS NOT ALREADY THERE.                                 X03039*/ 51200010
*                                                                       51400010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 51600010
*/*      INITIALIZED:                                          X03039*/ 51800010
*/*                                                            X03039*/ 52000010
*/*       3       CONTAINS ADDRESS OF QCB FROM WHICH ELEMENT ISX03039*/ 52200010
*/*                        DESIRED                             X03039*/ 52400010
*/*       7       CONTAINS ADDR OF QCB NOW CONTAINING THE STCB X03039*/ 52600010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 52800010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 53000010
*    DCL DSPTSTQ  ENTRY BASED(ADDR(IEDQDISP)) POS(33)     /* @Y17XAXF*/ 53200010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXF*/ 53300010
*    DCL DSPTSTQR ENTRY BASED(ADDR(IEDQDISP)) POS(37)     /* @Y17XAXF*/ 53400010
*        VALRG(*);                                        /* @Y17XAXF*/ 53500010
*    DCL DSPUNAV  ENTRY BASED(ADDR(IEDQDISP)) POS(41)     /* @Y17XAXF*/ 53600010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXF*/ 53700010
*    DCL DSPUNAVR ENTRY BASED(ADDR(IEDQDISP)) POS(45)     /* @Y17XAXF*/ 53800010
*        VALRG(*);                                        /* @Y17XAXF*/ 53900010
*                                                                       54000010
*                                                                       54200010
*/*  THIS ROUTINE WILL INSERT AN ELEMENT INTO A CHAIN BY PRIORITY    */ 54400010
*                                                                       54600010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 54800010
*/*      INITIALIZED:                                          X03039*/ 55000010
*/*                                                            X03039*/ 55200010
*/*       1       CONTAINS ADDR OF ITEM TO BE PLACED IN CHAIN  X03039*/ 55400010
*/*       7       CONTAINS ADDRESS OF CHAIN TO RECEIVE ITEM    X03039*/ 55600010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 55800010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 56000010
*    DCL DSPPRIO  ENTRY BASED(ADDR(IEDQDISP)) POS(49)     /* @Y17XAXF*/ 56200010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXF*/ 56300010
*    DCL DSPPRIOR ENTRY BASED(ADDR(IEDQDISP)) POS(53)     /* @Y17XAXF*/ 56400010
*        VALRG(*);                                        /* @Y17XAXF*/ 56500010
*                                                                       56600010
*                                                                       56800010
*/*  THIS ROUTINE WILL INSERT AN ELEMENT AT THE TOP OF A CHAIN X03039*/ 57000010
*                                                                       57200010
*/*  ENTRY TO THIS ROUTINE SHOULD HAVE THE FOLLOWING REGISTERS X03039*/ 57400010
*/*      INITIALIZED:                                          X03039*/ 57600010
*/*                                                            X03039*/ 57800010
*/*       1       CONTAINS ADDRESS OF ITEM TO BE PLACED IN CHAIN     */ 58000010
*/*                                                            X03039*/ 58200010
*/*       7       CONTAINS ADDRESS OF CHAIN TO RECEIVE ITEM    X03039*/ 58400010
*/*      11       CONTAINS ADDRESS ASSIGNED TO DISPATCHER    @Y17XAXF*/ 58600010
*/*      13       CONTAINS ADDRESS ASSIGNED TO AVTSAVE2        X03039*/ 58800010
*    DCL DSPLIFO  ENTRY BASED(ADDR(IEDQDISP)) POS(57)     /* @Y17XAXF*/ 59000010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXF*/ 59100010
*    DCL DSPLIFOR ENTRY BASED(ADDR(IEDQDISP)) POS(61)     /* @Y17XAXF*/ 59200010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXF*/ 59300010
*    DCL DSPTRACE ENTRY BASED(ADDR(IEDQDISP)) POS(65)     /* @Y17XAXA*/ 59400010
*        VALRG(*) OPTIONS(EXIT,NOSEQFLOW);                /* @Y17XAXA*/ 59500010
*                                                                       59600010
*                                                                       59800010
*/*  STCBVTO VALUES                                            X03039*/ 60000010
*                                                                       60200010
*DCL DSPCWAIT BIT(8) CONSTANT('00'X);   /* ISSUE SYSTEM WAIT @Y17XAXF*/ 60260010
*DCL DSPCPOST BIT(8) CONSTANT('02'X);   /* SYSTEM POST ATTACHED TASK */ 60320010
*                                       /*                   @Y17XAXF*/ 61200010
*DCL DSPMCPL2 BIT(8) CONSTANT('04'X);   /* ACTIVATE 2-BYTE STCB      */ 61205010
*                                       /*                   @Y17XAXF*/ 61210010
*DCL DSPMCPL4 BIT(8) CONSTANT('06'X);   /* ACTIVATE 4-BYTE STCB      */ 61215010
*                                       /*                   @Y17XAXF*/ 61220010
*DCL DSPMCPL6 BIT(8) CONSTANT('08'X);   /* ACTIVATE 6-BYTE STCB      */ 61225010
*                                       /*                   @Y17XAXF*/ 61230010
*DCL DSPMCPL8 BIT(8) CONSTANT('0A'X);   /* ACTIVATE 8-BYTE STCB      */ 61235010
*                                       /*                   @Y17XAXF*/ 61240010
*DCL DSPRCVSC BIT(8) CONSTANT('0C'X);   /* RECEIVE     SCHEDULER     */ 61245010
*                                       /*                   @Y17XAXF*/ 61250010
*DCL DSPSNDSC BIT(8) CONSTANT('0E'X);   /* SEND        SCHEDULER     */ 61255010
*                                       /*                   @Y17XAXF*/ 61260010
*DCL DSPGETSC BIT(8) CONSTANT('10'X);   /* GET         SCHEDULER     */ 61265010
*                                       /*                   @Y17XAXF*/ 61270010
*DCL DSPPUTSC BIT(8) CONSTANT('12'X);   /* PUT         SCHEDULER     */ 61275010
*                                       /*                   @Y17XAXF*/ 61280010
*DCL DSPGFFSC BIT(8) CONSTANT('14'X);   /* GET FIFO    SCHEDULER     */ 61285010
*                                       /*                   @Y17XAXF*/ 61290010
*DCL DSPLOGSC BIT(8) CONSTANT('16'X);   /* LOG         SCHEDULER     */ 61295010
*                                       /*                   @Y17XAXF*/ 61300010
*DCL DSPDIASC BIT(8) CONSTANT('18'X);   /* DIAL        SCHEDULER     */ 61305010
*                                       /*                   @Y17XAXF*/ 61310010
*DCL DSPBUFSC BIT(8) CONSTANT('1A'X);   /* BUFF'D TERM SCHEDULER     */ 61315010
*                                       /*                   @Y17XAXF*/ 61320010
*DCL DSPRETSC BIT(8) CONSTANT('1C'X);   /* RETRIEVE    SCHEDULER     */ 61325010
*                                       /*                   @Y17XAXF*/ 61330010
*DCL DSPLOCSC BIT(8) CONSTANT('1E'X);   /* LOCAL REC   SCHEDULER     */ 61335010
*                                       /*                   @Y17XAXF*/ 61340010
*DCL DSPCSCH  BIT(8) CONSTANT('20'X);   /* CONCENTRATOR SCHEDULER    */ 61345010
*                                       /*                   @Y17XAXF*/ 61350010
*DCL DSPSEND  BIT(8) CONSTANT('22'X);   /* 3705 RES SEND SCHEDULER   */ 61355010
*                                       /*                   @Y17XAXF*/ 61360010
*DCL DSPRCV   BIT(8) CONSTANT('24'X);   /* 3705 RES RECV SCHEDULER   */ 61365010
*                                       /*                   @Y17XAXF*/ 61370010
*DCL DSPCBSCH BIT(8) CONSTANT('26'X);   /* COMBUF      SCHEDULER     */ 61375010
*                                       /*                   @Y17XAXF*/ 61380010
./  ADD  SSI=60241337,NAME=TDRQD
         MACRO                                                          01000022
         TDRQD                                                          02000022
* TDRQD MACRO UPDATED 7/2/71                                            03000022
IEDQDRQ  DSECT                                                          04000022
*                                                                       05000022
*              THIS IS A DSECT OF THE CONCENTRATOR DATA READY QUEUE.    06000022
*                                                                       07000022
DRQFLAG1 DS    XL1 .                    DRQ FLAG BYTE                   08000022
*                                       BITS 0,1,2 & 3 MUST BE 0        09000022
*                        BIT DEFINITIONS                                10000022
DRQDRQQ  EQU   X'04' .                  FLAG INDICATING A DRQ           11000022
DRQFQCB  EQU   X'02' .                  FLAG INDICATING A QCB           12000022
DRQHELD  EQU   X'01' .                  STOP SENDING - REUSE            13000022
*                                                                       14000022
DRQELCHN DS    AL3 .                    ELEMENT CHAIN                   15000022
DRQPRI   DS    CL1 .                    PRIORITY                        16000022
DRQLINK  DS    AL3 .                    DRQ LINK FIELD                  17000022
DRQSTVTO DS    XL1 .                    INDEX TO ENTRY IN SUBTASK       18000022
*                                       VECTOR TABLE                    19000022
*                        BIT DEFINITIONS                                20000022
DRQCSVTO EQU   X'20' .                  DRQ VTO                         21000022
*                                                                       22000022
DRQSTCHN DS    AL3 .                    STCB CHAIN                      23000022
DRQSTPRI DS    CL1 .                    PRIORITY OF THE STCB            24000022
DRQSLINK DS    AL3 .                    POINTER TO NEXT STCB IN CHAIN   25000022
DRQBUFCT DS    FL1 .                    TOTAL BUFFER COUNT              26000022
DRQERBCT DS    FL1 .                    ERB BUFFER COUNT                27000022
DRQTDO   DS    XL1 .                    TIME DELAY QUEUE OFFSET         28000022
DRQSTAT  DS    XL1 .                    STATUS OF THIS QCB              29000022
*                        BIT DEFINITIONS                                30000022
DRQEOM   EQU   X'80' .                  END OF MSG SENT                 31000022
DRQTRMHO EQU   X'40' .                  TERMINAL WAS HELD               32000022
DRQBUFRD EQU   X'20' .                  BUFFERED TERMINAL               33000022
DRQSEND  EQU   X'10' .                  SENDING TO BUFFERED TERM        34000022
DRQRECEV EQU   X'08' .                  RECEIVING FROM BUFFERED TERM    35000022
DRQSCHDL EQU   X'04' .                  PUT IN DELAY Q WHEN INACTIVE    36000022
DRQCLOCK EQU   X'02' .                  ON=CLOCK, OFF=INTERVAL          37000022
DRQTIME  EQU   X'01' .                  DELAY GREATER THEN 12 HOURS     38000022
*                                                                       39000022
DRQSCBOF DS    FL1 .                    X'00' - OFFSET TO PROPER SCB    40000022
DRQCURQ  DS    AL3 .                    POINTER TO CURRENT QCB          41000022
DRQFLAG3 DS    XL1 .                    DRQ FLAG BYTE                   42000022
*                        BIT DEFINITIONS                                43000022
DRQFSPCI EQU   X'80' .                  FIRST PCI FOR CONC MSG          44000022
DRQERBAV EQU   X'40' .                  INDICATES ENABLED CODE          45000022
*                                       REQUESTED ERB                   46000022
*                                                                       47000022
DRQRESV  DS    XL1 .                    RESERVED                        48000022
DRQCTBCT DS    FL1 .                    CTB COUNT                       49000022
DRQCTBMX DS    FL1 .                    MAX CTBS PER CONC MSG           50000022
DRQPRLVL DS    XL1 .                    HIGHEST PRIORITY LEVEL MSG      51000022
DRQPRVLK DS    0AL3 .                   POINTER TO THE LINK FIELD       52000022
DRQTDLNK DS    AL3 .                    LINK FIELD FOR TIME DELAY Q     53000022
DRQRELLN DS    FL1 .                    RELATIVE LINE NO                54000022
DRQDCBAD DS    AL3 .                    DCB ADDRESS                     55000022
DRQFLAG2 DS    XL1 .                    DRQ STATUS BITS                 56000022
*                        BIT DEFINITIONS                                57000022
DRQTSSES EQU   X'80' .                  TSO SESSION IN PROGRESS         58000022
DRQRSRV  EQU   X'10' .                  REUSE SERVICED BIT              59000022
DRQTERMQ EQU   X'08' .                  QUEUING BY TERMINAL             60000022
DRQSDFFO EQU   X'04' .                  CURRENTLY SENDING FEFO MSG      61000022
DRQPROC  EQU   X'02' .                  THIS QCB FOR A PROCESS ENTRY    62000022
DRQCKPT  EQU   X'01' .                  FLAG FOR CHECKPOINT             63000022
*                                                                       64000022
DRQQBACK DS    AL3 .                    QBACK CHAIN POINTER             65000022
*                                                                       66000022
*         *******************************************************       67000022
*     0   *   FLAG1   **                 ELCHN                  *       68000022
*         *******************************************************       69000022
*     4   *   PRI     **                 LINK                   *       70000022
*         *******************************************************       71000022
*     8   *   STVTO   **                 STCHN                  *       72000022
*         *******************************************************       73000022
*    12   *   STPRI   **                 SLINK                  *       74000022
*         *******************************************************       75000022
*    16   *   BUFCT   **   ERBCT    **   TD/      **   STAT     *       76000022
*         *******************************************************       77000022
*    20   *   SCBOF   **                 CURQ                   *       78000022
*         *******************************************************       79000022
*    24   *   FLAG3   **   RESV     **   CTBCT    **   CTBMX    *       80000022
*         *******************************************************       81000022
*    28   *   PRLVL   **                 TDLNK/PRVLK            *       82000022
*         *******************************************************       83000022
*    32   *   RELLN   **                 DCBAD                  *       84000022
*         *******************************************************       85000022
*    36   *   FLAG2   **                 QBACK                  *       86000022
*         *******************************************************       87000022
         MEND                                                           88000022
./  ADD  SSI=62530878,NAME=TDSID
*        %GOTO PLSDSI;                  /*                              02000010
         MACRO                                                          04000010
         TDSID                                                          06000010
.*A000000-999999                                               @Y17XAFF 08000010
*        NO ASSEMBLE VERSION OF THIS DSECT                              10000010
         MEND  */                                                       12000010
*%PLSDSI:;                                                              14000010
*/*                                                                  */ 16000010
*/*      COPY/REPLACE DEVICE SESSION INFORMATION                     */ 18000010
*/*                                                                  */ 20000010
* DECLARE                                                               22000010
* 1 IEDDSI1 BASED(RDSI1),               /*FIRST FIELD GROUP          */ 24000010
*  2 DSITOTNM FIXED(8),                 /* TOTAL NUM OF BYTES IN REC */ 26000010
*  2 DSINETAD FIXED(16) BDY(BYTE),      /* NET ADDR OF DEVICE        */ 28000010
*  2 DSIPOLL,                           /* POLLING CHARS FIELD       */ 30000010
*   3 DSIPOLNM FIXED(8),                /*  NUMBER OF POLLING CHARS  */ 32000010
*   3 DSIPOLCH CHAR(0);                 /*  POLLING CHARACTERS       */ 34000010
*                                                                       36000010
*                                                                       38000010
* DECLARE                                                               40000010
* 1 IEDDSI2 BASED(RDSI2),               /*SECOND FIELD GROUP         */ 42000010
*  2 DSIADRNM FIXED(8),                 /* NUMBER OF ADDRESSING CHAR */ 44000010
*  2 DSIADDR  CHAR(0);                  /* ADDRESSING CHARACTERS     */ 46000010
*                                                                       48000010
*                                                                       50000010
* DECLARE                                                               52000010
* 1 IEDDSI3 BASED(RDSI3),               /*THIRD FIELD GROUP          */ 54000010
*  2 DSINPTID BIT(8),                   /* INPUT IDENTIFIER          */ 56000010
*  2 DSISEQNO FIXED(16) BDY(BYTE),      /* BTU SEQ NUM FOR CURRENT      58000010
*                                          INVITE                    */ 60000010
*  2 DSIMODID FIXED(8);                 /* BTU MODIFIER              */ 62000010
*                                                                       64000010
*                                                                       66000010
* DECLARE                                                               68000010
* 1 IEDDSI4 BASED(RDSI4),               /*FOURTH FIELD GROUP         */ 70000010
*  2 DSIDIAL,                           /* DIAL DIGITS FIELD         */ 72000010
*   3 DSIDLCNT FIXED(8),                /*  COUNT OF DIAL DATA       */ 74000010
*   3 DSIDLMAX FIXED(8),                /*  MAX NUM OF DIAL DIGITS   */ 76000010
*   3 DSISLACT FIXED(8),                /*  ACTUAL NUM OF DIAL DIGITS   78000010
*                                                                    */ 80000010
*   3 DSIDLDIG CHAR(0);                 /*  DIAL DIGITS              */ 82000010
./  ADD  SSI=70060648,NAME=TDVCIDTD
*        %GOTO DVCIDPLS ;                                            /* 01000010
         MACRO                                                          02000022
         TDVCIDTD                                                       04000022
* TDVCIDTD MACRO UPDATED 7/2/71                                         06000022
.* TDVCIDTD MACRO CONVERTED TO BILINGUAL ON 11/01/72                    07000010
IEDQDVCT DSECT                                                          08000022
*              THIS IS A DSECT OF THE CONCENTRATOR DEVICE ID CHAR.      10000022
*              TABLE.                                                   12000022
*                                                                       14000022
DVCNO    DS    0FL1 .                   NO OF ENTRIES IN TABLE          16000022
DVCIDLTH DS    XL1 .                    LENGTH OF DEV ID CHARS          18000022
DVCRSV   DS    0XL1 .                   RESERVED                        20000022
DVCCHAR  DS    XL1 .                    ID CHARS - 1 BYTE OR            22000022
*                                       LARGER                          24000022
DVCENLTH DS    FL1 .                    ENTRY LENGTH                    26000022
DVCSTAT  DS    XL1 .                    STATUS                          28000022
*                        BIT DEFINITIONS                                30000022
DVCSORTD EQU   X'40' .                  TABLE SORTED                    32000022
*                                                                       34000022
DVCECW   EQU   * .                      END OF CONTROL WORD             36000022
DVCEND   EQU   X'FE' .                  END OF TABLE                    38000022
*                                                                       40000022
*         CONCENTRATOR                                                  42000022
*         *******************************************************       44000022
*     0   *   NO      **   RSV      **   ENLTH    **   STAT     *       46000022
*         *******************************************************       48000022
*     4   *   01      **    FF      **       TNT OFFSET         *       50000022
*         *******************************************************       52000022
*                                                                       54000022
*         FOLLOWING THE CONCENTRATOR ENTRY CONTIGUOUSLY IN CORE         56000022
*         ARE DVCID ENTRIES FOR EACH TERMINAL ATTACHED TO THE           58000022
*         CONCENTRATOR, IN ONE OF THE FOLLOWING FORMATS:                60000022
*                                                                       62000022
*         DVCID=NONE                                                    64000022
*         *******************************************************       66000022
*         *   01      **    FF      **       TNT OFFSET         *       68000022
*         *******************************************************       70000022
*                                                                       72000022
*         DVCID=CHAR                                                    74000022
*         *******************************************************       76000022
*         *  LENGTH   **  ID CHARS  **       TNT OFFSET         *       78000022
*         *******************************************************       80000022
*            1 BYTE      VAR LENGTH            2 BYTES                  82000022
*                                                                       84000022
         MEND   ,  */                                                   86000010
*%DVCIDPLS : ;                                                          86300010
*/* TDVCIDTD MACRO UPDATED 11/01/72                                  */ 86600010
*/*                                                                  */ 86900010
*/*  THIS IS A DSECT OF THE CONCENTRATOR DEVICE ID TABLE             */ 87200010
*DECLARE                                                                87500010
*  1 IEDQDVCT  BASED(IEDQDPTR) BDY(WORD),                               87800010
*   2 DVCIDLTH   PTR(8),                /* LENGTH OF DEVIC ID CHARS  */ 88100010
*     3 DVCNO    PTR(8),                /* NO OF ENTRIES IN TABLE    */ 88400010
*   2 DVCCHAR    (*) CHAR(1),           /* ID CHARS - 1 BYTE MINIMUM */ 88700010
*     3 DVCRSV   CHAR(1),               /* RESERVED                  */ 89000010
*   2 DVCENLTH   PTR(8),                /* ENTRY LENGTH              */ 89300010
*   2 DVCSTAT    BIT(8),                /* STATUS                    */ 89600010
*     3 *        BIT(1),                /* RESERVED                  */ 89900010
*     3 DVCSORTD BIT(1);                /* TABLE SORTED              */ 90200010
*DECLARE  DVCECW (*) CHAR(1) BASED      /* END OF CONTROL WORD       */ 90500010
*                (ADDR(IEDQDVCT) + LENGTH(IEDQDVCT));      /*@Y17XAXF*/ 90800010
*%DCL DVCEND CHAR ;                                                     91100010
*%DVCEND = '''FE''X' ;                                                  91400010
*/*                                                                  */ 91700010
*/*       CONCENTRATOR                                               */ 92000010
*/*       *******************************************************    */ 92300010
*/*   0   *   NO      **   RSV      **   ENLTH    **   STAT     *    */ 92600010
*/*       *******************************************************    */ 92900010
*/*   4   *  X'01'    **   X'FF'    **       TNT OFFSET         *    */ 93200010
*/*       *******************************************************    */ 93500010
*/*                                                                  */ 93800010
*/*       FOLLOWING THE CONCENTRATOR ENTRY CONTIGUOUSLY IN CORE      */ 94100010
*/*       ARE DVCID ENTRIES FOR EACH TERMINAL ATTACHED TO THE        */ 94400010
*/*       CONCENTRATOR, IN ONE OF THE FOLLOWING FORMATS:             */ 94700010
*/*                                                                  */ 95000010
*/*       DVCID=NONE                                                 */ 95300010
*/*       *******************************************************    */ 95600010
*/*       *  X'01'    **   X'FF'    **       TNT OFFSET         *    */ 95900010
*/*       *******************************************************    */ 96200010
*/*                                                                  */ 96500010
*/*       DVCID=CHAR                                                 */ 96800010
*/*       *******************************************************    */ 97100010
*/*       *  LENGTH   **  ID CHARS  **       TNT OFFSET         *    */ 97400010
*/*       *******************************************************    */ 97700010
*/*          1 BYTE      VAR LENGTH            2 BYTES               */ 98000010
*/*                                                                  */ 98300010
./  ADD  SSI=62660124,NAME=TEXTD
*        %GOTO EXTPLS;            /* BILINGUAL HEADER                   00400010
         MACRO                                                          00800010
         TEXTD                                                          01200010
.*A000000-999999                                               @Y17XAXF 01600010
*                                                                       02000010
*        FID0 NORMAL EXTEND RESPONSES                                   02400010
*                                                                       02800010
EXT00    EQU   X'00' .                  CONTROL MODE                    03200010
EXT20    EQU   X'20' .                  TEXT MODE                       03600010
EXT40    EQU   X'40' .                  TRANSPARENT TEXT MODE           04000010
EXT60    EQU   X'60' .                  HEADING MODE                    04400010
EXT80    EQU   X'80' .                  SPECIAL                         04800010
EXTE0    EQU   X'E0' .                  HARDWARE/USER ERROR             05200010
         SPACE                                                          05600010
*                                                                       06000010
*    FINAL STATUS WHEN INITIAL STATUS = CONTROL,TEXT,TRANSPARENT        06400010
*                                     TEXT, OR HEADING                  06800010
*                                                                       07200010
EXTX00   EQU   X'00' .                  TIME OUT                        07600010
EXTX04   EQU   X'04' .                  CUTOFF                          08000010
EXTX06   EQU   X'06' .                  REPLY TO TRANSMITTED DATA       08400010
*                                         WAS AN EOT                    08800010
EXTX08   EQU   X'08' .                  AN EOT WAS RECEIVED ON A BLK    09200010
*                                         THAT WAS IN ERROR             09600010
EXTX0A   EQU   X'0A' .                  END OF DLE CONTROL              10000010
EXTX0C   EQU   X'0C' .                  WRONG ACK                       10400010
EXTX0E   EQU   X'0E' .                  FOR  SS, NAK RETURNED IN        10800010
*                                         RSP TO A SELECTION,           11200010
*                                         POLL OR WRITE                 11600010
*                                       FOR BSC, AND EOT RETURNED       12000010
*                                         IN RESPONSE TO A SLECTION     12400010
*                                         POLL, OR WRITE                12800010
EXTX10   EQU   X'10' .                  RECEIVED SUB-BLOCK              13200010
EXTX12   EQU   X'12' .                  END OF TEXT                     13600010
EXTX14   EQU   X'14' .                  END OF BLOCK                    14000010
EXTX16   EQU   X'16' .                  DATA OR LEADIN GRAPHICS         14400010
*                                         RECEIVED WITH AN ENQ          14800010
EXTX18   EQU   X'18' .                  EOT RECEIVED WITH NO ERRORS     15200010
EXTX1A   EQU   X'1A' .                  REVERSE INTERRUPT               15600010
EXTX1C   EQU   X'1C' .                  POSITIVE ACK RETURNED           16000010
*                                         AND NO ERRORS INDICATED       16400010
*                                         ON A WRITE OPERATION          16800010
EXTX1E   EQU   X'1E' .                  WACK RECEIVED                   17200010
         EJECT                                                          17600010
*                                                                       18000010
*        FINAL STATUS WHEN INITIAL STATUS - SPECIAL                     18400010
*                                                                       18800010
EXTS00   EQU   X'00' .                  TIME-OUT WITH NOTHING REC       19200010
EXTS02   EQU   X'02' .                  COMMAND REJECT                  19600010
EXTS04   EQU   X'04' .                  LEVEL 2 AND LEVEL 3             20000010
*                                         BUFFER POOLS DEPLETED         20400010
EXTS06   EQU   X'06' .                  SELECTED                        20800010
EXTS08   EQU   X'08' .                  RECEIVED DISCONNECT SIGNAL      21200010
*                                         ON START-STOP OR DLE/EOT      21600010
EXTS0A   EQU   X'0A' .                  DATA WAS RECEIVED WHEN          22000010
*                                         IT WAS NOT EXPECTED           22400010
EXTS0C   EQU   X'0C' .                  A RESET OCCURRED                22800010
EXTS0E   EQU   X'0E' .                  THE DEVICE HAS BEEN POLLED      23200010
EXTS10   EQU   X'10' .                  TRANSMITTED SUB-BLOCK           23600010
EXTS12   EQU   X'12' .                  AN EOT WAS SENT AFTER A         24000010
*                                         SPECIFIED NUMBER OF WACKS     24400010
*                                         WERE RECEIVED IN RSP TO       24800010
*                                         TO A REQ OR OPER              25200010
EXTS14   EQU   X'14' .                  RECEIVED BREAK IN TEXT          25600010
EXTS16   EQU   X'16' .                  POLLING STOP                    26000010
EXTS18   EQU   X'18' .                  EOT TRANSMITTED                 26400010
EXTS1A   EQU   X'1A' .                  RECEIVED A BREAK SIGNAL         26800010
*                                         WHILE TRANSMITTING            27200010
EXTS1C   EQU   X'1C' .                  DISCONNECTED                    27600010
EXTS1E   EQU   X'1E' .                  CONNECTED                       28000010
         SPACE                                                          28400010
*                                                                       28800010
*        FINAL STATUS WHEN INITIAL STATUS = HARDWARE/USER ERROR         29200010
*                                                                       29600010
EXTH00   EQU   X'00' .                  USER ERROR                      30000010
EXTH04   EQU   X'04' .                  LEVEL 1 COMM SCANNER CHECK      30400010
EXTH08   EQU   X'08' .                  COMM LINE ADAPTER CHECK         30800010
EXTH0A   EQU   X'0A' .                  COMM SCANNER ADAPTER            31200010
*                                         FEEDBACK CHECK                31600010
EXTH0C   EQU   X'0C' .                  NOT USED                        32000010
EXTH10   EQU   X'10' .                  MODEM ERROR                     32400010
EXTH12   EQU   X'12' .                  MODEM TRANSMIT CLOCK OR         32800010
*                                         CLEAR-TO-SEND ERROR           33200010
EXTH14   EQU   X'14' .                  DSR-ON CHECK                    33600010
EXTH18   EQU   X'18' .                  DSR-OFF CHECK                   34000010
EXTH1C   EQU   X'1C' .                  ACU CHECK                       34400010
EXTE1E   EQU   X'1E' .                  PROGRAM FAILURE                 34800010
         SPACE                                                          35200010
*                                                                       35600010
*    CONDITIONAL EXTENDED RESPONSES                                     36000010
*                                                                       36400010
EXTC82   EQU   X'82' .                  CHANGE-SPEED COMMAND INVALID    36800010
EXTC83   EQU   X'83' .                  SPECIFIED LINE IS UNAVAILABLE   37200010
EXTC84   EQU   X'84' .                  ERROR LOCK                      37600010
EXTCE0   EQU   X'E0' .                  SWITCH-LINE-MODE COMMAND        38000010
*                                         WAS RECEIVED BUT LINE         38400010
*                                         NOT GENERATED AS MODE-        38800010
*                                         SWITCHABLE                    39200010
EXTCE1   EQU   X'E1' .                  SWITCH-LINE-MODE COMMAND        39600010
*                                         WAS RECEIVED BUT A            40000010
*                                         COMMAND IS ALREADY            40400010
*                                         EXECUTING ON THE LINE         40800010
*                                         OR LINE TRACE IS ACTIVE       41200010
         MEND                                                           41600010
*        */                                                             42000010
*%EXTPLS:;                                                              42400010
*/*                                                                  */ 42800010
*/*      FID0 NORMAL EXTEND RESPONSES                                */ 43200010
*/*                                                                  */ 43600010
*DCL EXT00    BIT(3) CONSTANT('000'B);  /*CONTROL MODE               */ 44000010
*DCL EXT20    BIT(3) CONSTANT('001'B);  /*TEXT MODE                  */ 44400010
*DCL EXT40    BIT(3) CONSTANT('010'B);  /*TRANSPARENT TEXT MODE      */ 44800010
*DCL EXT60    BIT(3) CONSTANT('011'B);  /*HEADING MODE               */ 45200010
*DCL EXT80    BIT(3) CONSTANT('100'B);  /*SPECIAL                    */ 45600010
*DCL EXTE0    BIT(3) CONSTANT('111'B);  /*HARDWARE/USER ERROR        */ 46000010
         @SPACE;                                                        46400010
*/*                                                                  */ 46800010
*/*  FINAL STATUS WHEN INITIAL STATUS = CONTROL,TEXT,TRANSPARENT     */ 47200010
*/*                                     TEXT, OR HEADING             */ 47600010
*/*                                                                  */ 48000010
*DCL EXTX00   BIT(4) CONSTANT('0000'B); /*TIME OUT                   */ 48400010
*DCL EXTX04   BIT(4) CONSTANT('0010'B); /*CUTOFF                     */ 48800010
*DCL EXTX06   BIT(4) CONSTANT('0011'B); /*REPLY TO TRANSMITTED DATA  */ 49200010
*/*                                       WAS AN EOT                 */ 49600010
*DCL EXTX08   BIT(4) CONSTANT('0100'B); /*AN EOT WAS RECEIVED ON A   */ 50000010
*/*                                       BLOCK THAT WAS IN ERROR    */ 50400010
*DCL EXTX0A   BIT(4) CONSTANT('0101'B); /*END OF DLE CONTROL         */ 50800010
*DCL EXTX0C   BIT(4) CONSTANT('0110'B); /*WRONG ACK                  */ 51200010
*DCL EXTX0E   BIT(4) CONSTANT('0111'B); /*FOR S/S, NAK RETURNED IN   */ 51600010
*/*                                       RSP TO A SELECTION,        */ 52000010
*/*                                       POLL OR WRITE              */ 52400010
*/*                                     FOR BSC, AND EOT RETURNED    */ 52800010
*/*                                       IN RESPONSE TO A SLECTION  */ 53200010
*/*                                       POLL, OR WRITE             */ 53600010
*DCL EXTX10   BIT(4) CONSTANT('1000'B); /* RECEIVED SUB-BLOCK        */ 54000010
*DCL EXTX12   BIT(4) CONSTANT('1001'B); /*END OF TEXT                */ 54400010
*DCL EXTX14   BIT(4) CONSTANT('1010'B); /*END OF BLOCK               */ 54800010
*DCL EXTX16   BIT(4) CONSTANT('1011'B); /*DATA OR LEADIN GRAPHICS    */ 55200010
*/*                                       RECEIVED WITH AN ENQ       */ 55600010
*DCL EXTX18   BIT(4) CONSTANT('1100'B); /*EOT RECEIVED WITH NO ERROR */ 56000010
*DCL EXTX1A   BIT(4) CONSTANT('1101'B); /*REVERSE INTERRUPT          */ 56400010
*DCL EXTX1C   BIT(4) CONSTANT('1110'B); /*POSITIVE ACK RETURNED      */ 56800010
*/*                                       AND NO ERRORS INDICATED    */ 57200010
*/*                                       ON A WRITE OPERATION       */ 57600010
*DCL EXTX1E   BIT(4) CONSTANT('1111'B); /*WACK RECEIVED              */ 58000010
         @EJECT;                                                        58400010
*/*                                                                  */ 58800010
*/*      FINAL STATUS WHEN INITIAL STATUS - SPECIAL                  */ 59200010
*/*                                                                  */ 59600010
*DCL EXTS00   BIT(4) CONSTANT('0000'B); /*TIME-OUT WITH NOTHING REC  */ 60000010
*DCL EXTS02   BIT(4) CONSTANT('0001'B); /*COMMAND REJECT             */ 60400010
*DCL EXTS04   BIT(4) CONSTANT('0010'B); /*LEVEL 2 AND LEVEL 3        */ 60800010
*/*                                       BUFFER POOLS DEPLETED      */ 61200010
*DCL EXTS06   BIT(4) CONSTANT('0011'B); /*SELECTED                   */ 61600010
*DCL EXTS08   BIT(4) CONSTANT('0100'B); /*RECEIVED DISCONNECT SIGNAL */ 62000010
*/*                                       ON START-STOP OR DLE/EOT   */ 62400010
*DCL EXTS0A   BIT(4) CONSTANT('0101'B); /*DATA WAS RECEIVED WHEN     */ 62800010
*/*                                       IT WAS NOT EXPECTED        */ 63200010
*DCL EXTS0C   BIT(4) CONSTANT('0110'B); /*A RESET OCCURRED           */ 63600010
*DCL EXTS0E   BIT(4) CONSTANT('0111'B); /*THE DEVICE HAS BEEN POLLED */ 64000010
*DCL EXTS10   BIT(4) CONSTANT('1000'B); /*TRANSMITTED SUB-BLOCK      */ 64400010
*DCL EXTS12   BIT(4) CONSTANT('1001'B); /*AN EOT WAS SENT AFTER A    */ 64800010
*/*                                       SPECIFIED NUMBER OF WACKS  */ 65200010
*/*                                       WERE RECEIVED IN RSP TO    */ 65600010
*/*                                       TO A REQ OR OPER           */ 66000010
*DCL EXTS14   BIT(4) CONSTANT('1010'B); /*RECEIVED BREAK IN TEXT     */ 66400010
*DCL EXTS16   BIT(4) CONSTANT('1011'B); /*POLLING STOP               */ 66800010
*DCL EXTS18   BIT(4) CONSTANT('1100'B); /*EOT TRANSMITTED            */ 67200010
*DCL EXTS1A   BIT(4) CONSTANT('1101'B); /*RECEIVED A BREAK SIGNAL    */ 67600010
*/*                                       WHILE TRANSMITTING         */ 68000010
*DCL EXTS1C   BIT(4) CONSTANT('1110'B); /*DISCONNECTED               */ 68400010
*DCL EXTS1E   BIT(4) CONSTANT('1111'B); /*CONNECTED                  */ 68800010
         @SPACE;                                                        69200010
*/*                                                                  */ 69600010
*/*      FINAL STATUS WHEN INITIAL STATUS = HARDWARE/USER ERROR      */ 70000010
*/*                                                                  */ 70400010
*DCL EXTH00   BIT(4) CONSTANT('0000'B); /*USER ERROR                 */ 70800010
*DCL EXTH04   BIT(4) CONSTANT('0010'B); /*LEVEL 1 COMM SCANNER CHECK */ 71200010
*DCL EXTH08   BIT(4) CONSTANT('0100'B); /*COMM LINE ADAPTER CHECK    */ 71600010
*DCL EXTH0A   BIT(4) CONSTANT('0101'B); /*COMM SCANNER ADAPTER       */ 72000010
*/*                                       FEEDBACK CHECK             */ 72400010
*DCL EXTH0C   BIT(4) CONSTANT('0110'B); /*NOT USED                   */ 72800010
*DCL EXTH10   BIT(4) CONSTANT('1000'B); /*MODEM ERROR                */ 73200010
*DCL EXTH12   BIT(4) CONSTANT('1001'B); /*MODEM TRANSMIT CLOCK OR    */ 73600010
*/*                                       CLEAR-TO-SEND ERROR        */ 74000010
*DCL EXTH14   BIT(4) CONSTANT('1010'B); /*DSR-ON CHECK               */ 74400010
*DCL EXTH18   BIT(4) CONSTANT('1100'B); /*DSR-OFF CHECK              */ 74800010
*DCL EXTH1C   BIT(4) CONSTANT('1110'B); /*ACU CHECK                  */ 75200010
*DCL EXTE1E   BIT(4) CONSTANT('1111'B); /*PROGRAM FAILURE            */ 75600010
         @SPACE;                                                        76000010
*/*                                                                  */ 76400010
*/*  CONDITIONAL EXTENDED RESPONSES                                  */ 76800010
*/*                                                                  */ 77200010
*DCL EXTC82   BIT(8) CONSTANT('82'X);   /*CHANGE-SPEED COMMAND INVAL */ 77600010
*DCL EXTC83   BIT(8) CONSTANT('83'X);   /*SPECIFIED LINE IS UNAVAIL  */ 78000010
*DCL EXTC84   BIT(8) CONSTANT('84'X);   /*ERROR LOCK                 */ 78400010
*DCL EXTCE0   BIT(8) CONSTANT('E0'X);   /*SWITCH-LINE-MODE COMMAND   */ 78800010
*/*                                       WAS RECEIVED BUT LINE      */ 79200010
*/*                                       NOT GENERATED AS MODE-     */ 79600010
*/*                                       SWITCHABLE                 */ 80000010
*DCL EXTCE1   BIT(8) CONSTANT('E1'X);   /*SWITCH-LINE-MODE COMMAND   */ 80400010
*/*                                       WAS RECEIVED BUT A         */ 80800010
*/*                                       COMMAND IS ALREADY         */ 81200010
*/*                                       EXECUTING ON THE LINE      */ 81600010
*/*                                       OR LINE TRACE IS ACTIVE    */ 82000010
./  ADD  SSI=71310503,NAME=TGMAIND
*        %GOTO PLSGMAIN;                /* BILINGUAL HEADER             00500000
         MACRO                                                          01000000
         TGMAIND                                                        01500000
         SPACE                                                          02000000
.*CHANGE ACTIVITY AS FOLLOWS:                                           02500000
.*A000000-999999                                               @Y17XAXU 03000000
         SPACE                                                          03500000
IEDGMAIN DSECT                                                          04000000
*                                                                       04500000
*        TSO WORK AREA                                                  05000000
*                                                                       05500000
GMTSBUFR DS    A .                      TSO BFR OR MSGGEN ADDR          06000000
GMTCBUFR DS    A .                      TCAM SCB ADDR                   06500000
GMMOVED  DS    H .                      DATA MOVED                      07000000
GMLINE   DS    H .                      LINE SIZE REMAINING             07500000
GMBLNTH  DS    H .                      TSO BFR DATA SIZE               08000000
GMMSGLEN DS    H .                      MESSAGE SIZE                    08500000
GMWBUFSZ DS    H .                      TCAM BUFFER SIZE                09000000
GMSECENT DS    X .                      SPECIAL ENTRY                   09500000
GMSTFD   EQU   X'F0' .                    STARTFIELD INSERT             10000000
GMRDAT   EQU   X'F1' .                    READ ATTRIBUTE INSERT         10500000
GMSBA    EQU   X'F2' .                    SBA INSERT                    11000000
GMCUR1   EQU   X'F3' .                    FIRST CURSOR INSERT           11500000
GMCUR2   EQU   X'F4' .                    SECOND CURSOR INSERT          12000000
GMINC    EQU   X'F5' .                    INC INSERT                    12500000
GMETX    EQU   X'F6' .                    ETX INSERT                    13000000
GMEOT    EQU   X'F7' .                    EOT INSERT                    13500000
GMETXEOT EQU   X'F8' .                    ETX/EOT INSERT                14000000
GMBYP    EQU   X'F9' .                    BYPASS CHAR INSERT            14500000
GMREST   EQU   X'FA' .                    RESTORE CHAR INSERT           15000000
GMCARCT  DS    X .                      QCB CARRIAGE COUNT              15500000
GMLINESV DS    H .                      FROM TSB OR DEFAULT LINE SIZE   16000000
GMLINENM EQU   GMLINESV .               DISPLAY NUMBER OF LINES         16500000
GMLNSIZE EQU   GMLINESV+1 .             DISPLAY LINE SIZE               17000000
GMSWT1   DS    X .                      SWITCH 1                        17500000
GMCUR2FL EQU   X'80' .                    SECOND CURSOR FLAG            18000000
GMCUR1FL EQU   X'40' .                    FIRST CURSOR FLAG             18500000
GMRDATFL EQU   X'20' .                    READ ATTRIBUTE FLAG           19000000
GMSFATFL EQU   X'10' .                    START FIELD FLAG              19500000
GMBYPFL  EQU   X'08' .                    BYPASS FLAG                   20000000
GMCRNLFL EQU   X'04' .                    CARRIAGE RETURN/NEW LINE FLAG 20500000
GMSBAFL  EQU   X'02' .                    SET BFR ADDRESS FLAG          21000000
GMWRATFL EQU   X'01' .                    WRITE ATTRIBUTE FLAG          21500000
GMSWT2   DS    X .                      SWITCH 2                        22000000
GMRTCD4  EQU   X'04' .                    CALCSIZE RC 4                 22500000
GMRTCD8  EQU   X'08' .                    CALCSIZE RC 8                 23000000
GMRTCD12 EQU   X'0C' .                    CALCSIZE RC 12                23500000
GMRTCD16 EQU   X'10' .                    CALCSIZE RC 16                24000000
GMRTCD40 EQU   X'28' .                    CALCSIZE RC 40                24500000
GMRTCD44 EQU   X'2C' .                    CALCSIZE RC 44                25000000
GMWFLG1  DS    X .                      TSO FLAG 1                      25500000
GMTSOMSG EQU   X'80' .                    TSO ENTRY                     26000000
GMASISCL EQU   X'60' .                    ASIS SCREEN CONTROL           26500000
GMCNTRLM EQU   X'40' .                    CONTROL MODE                  27000000
GMTSASIS EQU   X'20' .                    TSO TPUT ASIS                 27500000
GM1MSGEN EQU   X'10' .                    FIRST MSGGEN PASS SWITCH      28000000
GMFMTFL  EQU   X'08' .                    SCREEN FORMAT INFO IN BFR     28500000
GMNOLEFT EQU   X'06' .                    NO LEFT JUSTIFICATION REQUEST 29000000
GMLEFT   EQU   X'05' .                    LEFT JUSTIFICATION REQUEST    29500000
GMWFLG2  DS    X .                      TSO FLAG 2                      30000000
GMSAVX1  DS    H .                      SCREEN CURSOR ADDRESS           30500000
GMFLAG1  DS    X .                      FLAG BYTE 1                     31000000
GMTRAILR EQU   X'80' .                    TRAILER BUFFER FLAG           31500000
GMPARTMV EQU   X'40' .                    PARTIAL MOVE FLAG             32000000
GMRESTSW EQU   X'20' .                    RESTORE CHAR FLAG             32500000
GMRECALC EQU   X'10' .                    BYPASS CODE AND RESET         33000000
GMINCSW  EQU   X'04' .                    INSERT CURSOR FLAG            33500000
GMEOTSW  EQU   X'02' .                    EOT FLAG                      34000000
GMETXSW  EQU   X'01' .                    ETX FLAG                      34500000
GMFLAG2  DS    X .                      FLAG BYTE 2                     35000000
GMX3705  EQU   X'80' .                    TERMINAL ON A 3705            35500000
GMX1050  EQU   X'40' .                    DEVICE IS A 1050              36000000
GMPROMPT EQU   X'20' .                    PROMPT STRING FLAG            36500000
GMNLCRFL EQU   X'10' .                    NL/CR COUNT FLAG              37000000
GMNWLNCT EQU   X'08' .                    LINE COUNT FLAG               37500000
GMCRRDAT EQU   X'04' .                    READ ATTRIB LINE POS. FLAG    38000000
GMHDRFG  EQU   X'02' .                    FIRST BASIC UNIT FLAG         38500000
GMNOMVCT EQU   X'01' .                    NO MOVE COUNT FLAG            39000000
GMSAVX2  DS    H .                      FIRST/LAST CHARACTER            39500000
GMTOR    DS    F .                      DATA COUNT                      40000000
GMFROMR  DS    F .                      DATA COUNT MOVED                40500000
GMTSCURR DS    A .                      CURRENT TSO BUFFER              41000000
GMMSGNLN DS    H .                      LENGTH OF MSGGEN DATA           41500000
GMSBAFLG EQU   X'EF' .                    SBA FLAG                      42000000
GMCUR1FG EQU   X'EE' .                    CURSOR ONE FLAG               42500000
GMCUR2FG EQU   X'ED' .                    CURSOR TWO FLAG               43000000
GMSTFDFG EQU   X'EC' .                    START FIELD FLAG              43500000
GMWRATFG EQU   X'EB' .                    WRITE ATTRIBUTE FLAG          44000000
GMDEND   DS    D .                      DOUBLE SAVE                     44500000
GMAINLEN EQU   *-IEDGMAIN               GMAIN LENGTH                    45000000
*                                                                       45500000
         MEND                                                           46000000
*        */                                                             46500000
*%PLSGMAIN : ;                                                          47000000
*DECLARE                                                                47500000
*  1 IEDGMAIN BDY(WORD) BASED(IEDGMPTR),                                48000000
*/*                                                                  */ 48500000
*/*      TSO WORK AREA                                               */ 49000000
*/*                                                                  */ 49500000
*   2 GMTSBUFR PTR(31),                 /* TSO BFR OR MSGGEN ADDR    */ 50000000
*   2 GMTCBUFR PTR(31),                 /* TCAM SCB ADDR             */ 50500000
*   2 GMMOVED FIXED(15),                /* DATA MOVED                */ 51000000
*   2 GMLINE FIXED(15),                 /* LINE SIZE REMAINING       */ 51500000
*   2 GMBLNTH FIXED(15),                /* TSO BFR DATA SIZE         */ 52000000
*   2 GMMSGLEN FIXED(15),               /* MESSAGE SIZE              */ 52500000
*   2 GMWBUFSZ FIXED(15),               /* TCAM BFR SIZE             */ 53000000
*   2 GMSECENT CHAR(1),                 /* SPECIAL ENTRY             */ 53500000
*   2 GMCARCT CHAR(1),                  /* QCB CARRIAGE COUNT        */ 54000000
*   2 GMLINESV FIXED(15),               /* FROM TSB OR DEFAULT          54500000
*                                          LINE SIZE                 */ 55000000
*    3 GMLINENM CHAR(1),                /* DISPLAY NUMBER OF LINES   */ 55500000
*    3 GMLNSIZE CHAR(1),                /* DISPLAY LINE SIZE         */ 56000000
*   2 GMSWT1 CHAR(1),                   /* SWITCH 1                  */ 56500000
*    3 GMCUR2FL BIT(1),                   /* SECOND CURSOR FLAG      */ 57000000
*    3 GMCUR1FL BIT(1),                   /* FIRST CURSOR FLAG       */ 57500000
*    3 GMRDATFL BIT(1),                   /* READ ATTRIBUTE FLAG     */ 58000000
*    3 GMSFATFL BIT (1),                  /* START FIELD FLAG        */ 58500000
*    3 GMBYPFL BIT (1),                   /* BYPASS FLAG             */ 59000000
*    3 GMCRNLFL BIT (1),                  /* CARRIAGE RETURN/NEW        59500000
*                                            LINE FLAG               */ 60000000
*    3 GMSBAFL BIT(1),                    /* SET BFR ADDRESS FLAG    */ 60500000
*    3 GMWRATFL BIT (1),                  /* WRITE ATTRIBUTE FLAG    */ 61000000
*   2 GMSWT2 CHAR(1),                   /* SWITCH 2                  */ 61500000
*   2 GMWFLG1 CHAR(1),                  /* TSO FLAG 1                */ 62000000
*   2 GMWFLG2 CHAR(1),                  /* TSO FLAG 2                */ 62500000
*   2 GMSAVX1 FIXED(15),                /* SCREEN CURSOR ADDRESS     */ 63000000
*   2 GMFLAG1 CHAR(1),                  /* FLAG BYTE 1               */ 63500000
*    3 GMTRAILR BIT(1),                   /* TRAILER BUFFER FLAG     */ 64000000
*    3 GMPARTMV BIT(1),                   /* PARTIAL MOVE FLAG       */ 64500000
*    3 GMRESTSW BIT(1),                   /* RESTORE CHAR FLAG       */ 65000000
*    3 GMRECALC BIT (1),                  /* BYPASS CODE AND RESET   */ 65500000
*    3 *        BIT(1),                   /* UNUSED                  */ 66000000
*    3 GMINCSW  BIT(1),                   /* INSERT CURSOR FLAG      */ 66500000
*    3 GMEOTSW  BIT(1),                   /* EOT FLAG                */ 67000000
*    3 GMETXSW  BIT(1),                   /* ETX FLAG                */ 67500000
*   2 GMFLAG2 CHAR(1),                  /* FLAG BYTE 2               */ 68000000
*    3 GMX3705 BIT(1),                    /* TERMINAL ON A 3705      */ 68500000
*    3 GMX1050 BIT(1),                    /* DEVICE IS A 1050        */ 69000000
*    3 GMPROMPT BIT (1),                  /* PROMPT STRING FLAG      */ 69500000
*    3 GMNLCRFL BIT(1),                   /* NL/CR COUNT FLAG        */ 70000000
*    3 GMNWLNCT BIT(1),                   /* LINE COUNT FLAG         */ 70500000
*    3 GMCRRDAT BIT(1),                   /* READ ATTRIBUTE LINE        71000000
*                                            POSITION FLAG           */ 71500000
*                                                                       72000000
*    3 GMHDRFG BIT(1),                    /* FIRST BASIC UNIT FLAG   */ 72500000
*    3 GMNOMYCT BIT(1),                   /* NO MOVE COUNT FLAG      */ 73000000
*   2 GMSAVX2 CHAR(2),                  /* FIRST/LAST CHARACTER      */ 73500000
*   2 GMTOR PTR(31),                    /* DATA COUNT                */ 74000000
*   2 GMFROMR PTR(31),                  /* DATA COUNT MOVED          */ 74500000
*   2 GMTSCURR PTR(31),                 /* CURRENT TSO BUFFER        */ 75000000
*   2 GMMSGNLN FIXED(15),               /* LENGTH OF MSGGEN DATA     */ 75500000
*   2 GMDEND CHAR(8);                   /* DOUBLE SAVE               */ 76000000
*                                                                       76500000
* %GMAINLEN='LENGTH(IEDGMAIN)';         /* GMAIN LENGTH              */ 77000000
*/*                                                                  */ 77500000
*/*      GMAIN CONSTANTS                                             */ 78000000
*/*                                                                  */ 78500000
*DCL GMSTFD BIT(8) CONSTANT('F0'X);       /* STARTFIELD INSERT       */ 79000000
*DCL GMRDAT BIT(8) CONSTANT('F1'X);       /* READ ATTRIB INSERT      */ 79500000
*DCL GMSBA BIT(8) CONSTANT('F2'X);        /* SBA INSERT              */ 80000000
*DCL GMCUR1 BIT(8) CONSTANT('F3'X);       /* FIRST CURSOR INSERT     */ 80500000
*DCL GMCUR2 BIT(8) CONSTANT('F4'X);       /* SECOND CURSOR INSERT    */ 81000000
*DCL GMINC BIT(8) CONSTANT('F5'X);        /* INC INSERT              */ 81500000
*DCL GMETX BIT(8) CONSTANT('F6'X);      /* ETX INSERT                */ 82000000
*DCL GMEOT BIT(8) CONSTANT('F7'X);        /* EOT INSERT              */ 82500000
*DCL GMETXEOT BIT(8) CONSTANT('F8'X);     /* ETX/EOT INSERT          */ 83000000
*DCL GMBYP BIT(8) CONSTANT ('F9'X);       /* BYPASS CHAR INSERT      */ 83500000
*DCL GMREST BIT(8) CONSTANT('FA'X);       /* RESTORE CHAR INSERT     */ 84000000
*                                                                       84500000
*DCL GMRTCD4 BIT(8) CONSTANT('04'X);      /* CALCSIZE RC 4           */ 85000000
*DCL GMRTCD8 BIT(8) CONSTANT('08'X);      /* CALCSIZE RC 8           */ 85500000
*DCL GMRTCD12 BIT(8) CONSTANT('0C'X);     /* CALCSIZE RC 12          */ 86000000
*DCL GMRTCD16 BIT(8) CONSTANT('10'X);     /* CALCSIZE RC 16          */ 86500000
*DCL GMRTCD40 BIT(8) CONSTANT('28'X);     /* CALCSIZE RC 40          */ 87000000
*DCL GMRTCD44 BIT(8) CONSTANT('2C'X);     /* CALCSIZE RC 44          */ 87500000
*                                                                       88000000
*DCL GMTSOMGS BIT(8) CONSTANT('80'X);     /* TSO ENTRY               */ 88500000
*DCL GMASISCL BIT(8) CONSTANT('60'X);     /* ASIS SCREEN CONTROL     */ 89000000
*DCL GMCNTRLM BIT(8) CONSTANT('40'X);     /* CONTROL MODE            */ 89500000
*DCL GMTSASIS BIT(8) CONSTANT('20'X);     /* TSO TPUT ASIS           */ 90000000
*DCL GM1MSGEN BIT(8) CONSTANT('10'X);     /* FIRST MSGGEN PASS SW    */ 90500000
*DCL GMFMTFL BIT(8) CONSTANT('08'X);      /* SCREEN FORMAT INFO         91000000
*                                            IN BUFFER               */ 91500000
*DCL GMNOLEFT BIT(8) CONSTANT('06'X);     /* NO LEFT JUSTIF. REQ     */ 92000000
*DCL GMLEFT BIT(8) CONSTANT('05'X);       /* LEFT JUSTIF. REQ        */ 92500000
*                                                                       93000000
*DCL GMSBAFLG BIT(8) CONSTANT('EF'X);     /* SBA FLAG                */ 93500000
*DCL GMCUR1FG BIT(8) CONSTANT('EE'X);     /* CURSOR ONE FLAG         */ 94000000
*DCL GMCUR2FG BIT(8) CONSTANT('ED'X);     /* CURSOR TWO FLAG         */ 94500000
*DCL GMSTFDFG BIT(8) CONSTANT('ED'X);     /* START FIELD FLAG        */ 95000000
*DCL GMWRATFG BIT(8) CONSTANT('EB'X);     /* WRITE ATTRIBUTE FIELD   */ 95500000
*                                                                       96000000
./  ADD  SSI=63170534,NAME=THEDD
*        %GOTO PLSHED;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         THEDD                                                          03000010
IEDHED   DSECT                          TABLE CONTROL AREA              04000010
HEDTRCAD DS    A .                      ADDR OF TABLE-BUILD RTN         05000010
HEDSIZE  DS    F .                      OVER-ALL TABLE SIZE             06000010
HEDRLN   DS    C .                      RELATIVE LINE NUMBER            07000010
HEDFSTHF DS    AL3 .                    ADDR OF 1ST HALF OF TABLE       08000010
HEDSWCHS DS    XL1 .                    SWITCHES                        09000010
HEDTBL1  EQU   X'80' .                  TABLE-IN-USE FLAG               10000010
*                                          1 - 1ST HALF-TABLE           11000010
*                                          0 - 2ND HALF-TABLE           12000010
HEDFULL1 EQU   X'40' .                  1ST HALF-TABLE-FULL FLAG        13000010
HEDFULL2 EQU   X'20' .                  2ND HALF-TABLE-FULL FLAG        14000010
HEDECBAV EQU   X'10' .                  ECB-AVAILABLE FLAG              15000010
*        EQU   X'08'-X'01' .            RESERVED                        17000010
HEDSECHF DS    AL3 .                    ADDR OF 2ND HALF OF TABLE       18000010
HEDTBPOS DS    F .                      CURRENT TABLE POSITION          19000010
HEDSEQCT DS    H .                      SEQUENCE COUNTER                20000010
HEDREMLN DS    H .                      REMAINING TABLE LENGTH          21000010
HEDHLFSZ DS    H .                      TOTAL SIZE OF HALF-TABLE        22000010
HEDDATLN DS    H .                      DATA LENGTH PER HALF-TABLE      23000010
HEDLIST  DS    0CL16                    COMWRITE PARAMETER LIST         24000010
HEDAREA  DS    A .                      DATA ADDRESS                    25000010
HEDTS    DS    C .                      TEST & SET SWITCHES             26000010
HEDFLAG  DS    CL1 .                    FLAG BYTE                       27000010
*        EQU   X'80' .                   RESERVED                       28000010
HEDCWOK  EQU   X'40' .                   COMWRITE COMPLETION FLAG       29000010
*        EQU   X'20'-X'01' .             RESERVED                       30000010
HEDLNTH  DS    H .                      LENGTH OF DATA                  31000010
HEDCT    DS    F .                      RECORD COUNT                    32000010
HEDID    DS    CL4 .                    ID FOR LINE TRACE      @YM07377 33000010
         DS    CL4 .                    RESERVED                        34000010
         MEND  */                                                       35000010
*%PLSHED:;                                                              36000010
*/*                                                                  */ 37000010
*/*      TRACE TABLE HEADER DSECT                                    */ 38000010
*/*                                                                  */ 39000010
*DCL 1 IEDHED      BASED(RHEADER),      /* TABLE CONTROL AREA        */ 40000010
*      2 HEDTRCAD  PTR(31),             /* ADDR OF TABLE-BUILD RTN   */ 41000010
*      2 HEDSIZE   FIXED(31),           /* OVER-ALL TABLE SIZE       */ 42000010
*      2 HEDRLN    CHAR(1),             /* RELATIVE LINE NUMBER      */ 43000010
*      2 HEDFSTHF  PTR(24),             /* ADDR OF 1ST HALF OF TABLE */ 44000010
*      2 HEDSWCHS  BIT(8),              /* SWITCHES                  */ 45000010
*        3 HEDTBL1  BIT(1),             /* TABLE-IN-USE FLAG            46000010
*                                          1 - 1ST HALF-TABLE           47000010
*                                          0 - 2ND HALF-TABLE        */ 48000010
*        3 HEDFULL1 BIT(1),             /* 1ST HALF-TABLE-FULL FLAG  */ 49000010
*        3 HEDFULL2 BIT(1),             /* 2ND HALF-TABLE-FULL FLAG  */ 50000010
*        3 HEDECBAV BIT(1),             /* ECB-AVAILABLE FLAG        */ 51000010
*        3 *        BIT(4),             /* FIRST-TIME SWITCH         */ 52000010
*      2 HEDSECHF  PTR(24),             /* ADDR OF 2ND HALF OF TABLE */ 53000010
*      2 HEDTBPOS  FIXED(31),           /* CURRENT TABLE POSITION    */ 54000010
*      2 HEDSEQCT  FIXED(15),           /* SEQUENCE COUNTER          */ 55000010
*      2 HEDREMLN  FIXED(15),           /* REMAINING TABLE LENGTH    */ 56000010
*      2 HEDHLFSZ  FIXED(15),           /* TOTAL SIZE OF HALF-TABLE  */ 57000010
*      2 HEDDATLN  FIXED(15),           /* DATA LENGTH PER HALF-TABLE*/ 58000010
*      2 HEDLIST,                       /* COMWRITE PARAMETER LIST   */ 59000010
*        3 HEDAREA PTR(31),             /* DATA ADDRESS              */ 60000010
*        3 HEDTS   CHAR(1),             /* TEST & SET SWITCHES       */ 61000010
*        3 HEDFLAG CHAR(1),             /* FLAG BYTE                 */ 62000010
*          4 *      BIT(1),                                             63000010
*          4 HEDCWOK  BIT(1),           /* COMWRITE COMPLETION FLAG  */ 64000010
*          4 *      BIT(6),                                             65000010
*        3 HEDLNTH FIXED(15),           /* LENGTH OF DATA            */ 66000010
*        3 HEDCT   FIXED(31),           /* RECORD COUNT              */ 67000010
*        3 HEDID   CHAR(4),             /* ID FOR LINE TRACE         */ 68000010
*      2 *         CHAR(4);                                             69000010
./  ADD  SSI=62430476,NAME=TIDD
*        %GOTO PLSID;                   /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TIDD                                                           09000010
*                                                                       12000010
.*A000000-999999                                               @Y17XAXF 15000010
*        BALR VERSION NOT SUPPORTED                                     18000010
*                                                                       21000010
         MEND  */                                                       24000010
*%PLSID:;                                                               27000010
* DCL IDCHCKPT CHAR(2) CONSTANT('06');  /* CHECKPOINT                */ 30000010
* DCL IDMSGOOD CHAR(2) CONSTANT('M3');  /* GOOD MESSAGE MODULE       */ 33000010
* DCL IDMSGCHN CHAR(2) CONSTANT('09');  /* MESSAGE MODULE CHAIN      */ 36000010
* DCL IDBHSTLS CHAR(2) CONSTANT('MS');  /* BHSET, TRANLMT, SESSION   */ 39000010
* DCL IDRUHAND CHAR(2) CONSTANT('02');  /* REQUEST-RESPONSE UNIT        42000010
*                                          HANDLER                   */ 45000010
./  ADD  SSI=62120251,NAME=TINVLD
*        %GOTO PLSINVL;                 /*                              01000010
         MACRO                                                          02000010
         TINVLD                                                         03000010
.*A00000000-99999999                                           @Y17XAXF 04000010
IEDINVL  DSECT                                                          05000010
*                                                                       06000010
*        INVITATION LIST DSECT                                          07000010
*                                                                       08000010
INVCTL   DS    0CL4 .                   CONTROL WORD                    09000010
INVTOTNT DS    XL1 .                     TOTAL ENTRIES IN LIST          10000010
INVACTNT DS    XL1 .                     TOTAL ACTIVE ENTRIES           11000010
INVENTLG DS    XL1 .                     ENTRY LENGTH                   12000010
INVSTATS DS    XL1 .                     STATUS                         13000010
INVEOT   EQU   X'80' .                    EOT SPECIFIED                 14000010
INVOFSRT EQU   X'40' .                    OFFSETS SORTED                15000010
INVCONT  EQU   X'20' .                    CONTENTION                    16000010
*        EQU   X'10'-X'08'                RESERVED                      17000010
INVCRR   EQU   X'04' .                    CHECKPOINT RESTART            18000010
*        EQU   X'02' .                    RESERVED                      19000010
INVAUTPL EQU   X'01' .                    AUTOPOLL IN EFFECT            20000010
INVCPUID DS    0A .                     IF SEQUENCE ADDRESS             21000010
INVBFRTM DS    0CL4 .                    BUFFERED TERM FIELD            22000010
INVACTCT DS    XL1 .                      NO. ACTIVE TERM               23000010
INVUCBST DS    XL1 .                      UCB STATUS                    24000010
         DS    XL1 .                      RESERVED                      25000010
INVTRMCT DS    XL1 .                      NO TERMS ON THIS LINE         26000010
INVENTRY EQU   *                        BEGIN INVITATION LIST           27000010
*                                        ENTRIES                        28000010
INVENDL  EQU   X'FE' .                  END OF ACTIVE LIST INDICATOR    29000010
         MEND  */                                                       30000010
*%PLSINVL: ;                                                            31000010
*/*                                                                  */ 32000010
*/*      INVITATION LIST DSECT                                       */ 33000010
*/*                                                                  */ 34000010
* DECLARE                                                               35000010
* 1 IEDINVL  BASED(RINVL),                                              36000010
*  2 INVCTL   CHAR(4),                  /* CONTROL WORD              */ 37000010
*   3 INVTOTNT FIXED(8),                /*  TOTAL ENTRIES IN LIST    */ 38000010
*   3 INVACTNT FIXED(8),                /*  TOTAL ACTIVE ENTRIES     */ 39000010
*   3 INVENTLG FIXED(8),                /*  ENTRY LENGTH             */ 40000010
*   3 INVSTATS FIXED(8),                /*  STATUS                   */ 41000010
*    4 INVEOT   BIT(1),                 /*   EOT SPECIFIED           */ 42000010
*    4 INVOFSRT BIT(1),                 /*   OFFSETS SORTED          */ 43000010
*    4 INVCONT  BIT(1),                 /*   CONTENTION              */ 44000010
*    4 *        BIT(2),                 /*   RESERVED                */ 45000010
*    4 INVCRR   BIT(1),                 /*   CHECKPOINT RESTART      */ 46000010
*    4 *        BIT(1),                 /*   RESERVED                */ 47000010
*    4 INVAUTPL BIT(1),                 /*   AUTOPOLL IN EFFECT      */ 48000010
*  2 INVCPUID PTR(31),                  /* IF SEQUENCE ADDRESS       */ 49000010
*   3 INVBFRTM CHAR(4),                 /*  BUFFERED TERM FIELD      */ 50000010
*    4 INVACTCT FIXED(8),               /*   NO. ACTIVE TERM         */ 51000010
*    4 INVUCBST BIT(8),                 /*   UCB STATUS              */ 52000010
*    4 *        BIT(8),                 /*   RESERVED                */ 53000010
*    4 INVTRMCT FIXED(8),               /*   NO TERMS ON THIS LINE   */ 54000010
*  2 INVENTRY CHAR(*);                  /* BEGIN INVITATION LIST        55000010
*                                          ENTRIES                   */ 56000010
* DCL INVENDL  BIT(8) CONSTANT('FE'X);  /* END OF ACTIVE LIST INDICATOR 57000010
*                                                                    */ 58000010
./  ADD  SSI=60241434,NAME=TIOBD
         MACRO                                                          02000020
         TIOBD                                                          04000020
         SPACE                                                          06000020
IEDQIOB  DSECT                                                          08000020
IOBFLAG1 DS    C                                                        10000020
IOBFLAG2 DS    C                                                        12000020
IOBSENS0 DS    C                                                        14000020
IOBSENS1 DS    C                                                        16000020
IOBECBCC DS    C .                      COMPLETION CODE                 18000020
IOBECBPT DS    AL3 .                    ADDR OF ECB                     20000020
IOBFLAG3 DS    C .                      I/O ERROR FLAGS                 22000020
IOBCSW   DS    CL7 .                    CSW                             24000020
IOBSIOCC DS    C .                      SIO CONDITION CODES             26000020
IOBSTART DS    AL3 .                    ADDR OF CHANNEL PROGRAM         28000020
         DS    C .                      RESERVED                        30000020
IOBDCBPT DS    AL3 .                    ADDR OF DCB                     32000020
         DS    C .                      OP CODE                         34000020
IOBRESTR DS    AL3 .                    RESTART ADDR OF IOS             36000020
IOBINCAM DS    H .                      BLOCK COUNT                     38000020
IOBERRCT DS    H .                      NO. OF ERROR RETRIES            40000020
IOBSEEK  DS    CL8 .                    MBBCCHHR                        42000020
*                                                                       44000020
*                       END OF IOB                                      46000020
*                                                                       48000020
IOBXECB  DS    F .                      ECB                             50000020
IOBBUSYN EQU   X'40' .                  BUSY BIT OF AN ECB              52000020
IOBXCC   DS    H .                      CURRENT ARM POSITION - CYL      54000020
IOBXRETQ DS    AL3 .                    ADDR OF Q OF CPB READY FOR      56000020
*                                         DISK END APPENDAGE FOR RETRY  58000020
         ORG   *-1 .                    LOW BIT OF PREVIOUS ADDR REDEF  60000020
IOBXLOCK DS    0X .                     FLAG BIT - LOCKED DOOR          62000020
IOBXLOCN EQU   X'01' .                  FORBIDS DISK END APPENDAGE      64000020
*                                         TO RETRY                      66000020
IOBXLOCF EQU   X'FF'-IOBXLOCN .         UNLOCKED, RETRY PERMITTED       68000020
IOBXNEWQ DS    A .                      ADDR OF Q OF CPBS BEING BUILT   70000020
IOBEND   EQU   *                                                        72000020
         SPACE 2                                                        74000020
         MEND                                                           76000020
./  ADD  SSI=72940028,NAME=TIOSBED
         MACRO                                                          00050082
         TIOSBED                                                        00100082
.*A-000000-999999                                              @OZ26164 00150082
         SPACE                                                          00200082
*        MAPPING FOR THE EXTENSION FOR AN IOSB USED FOR A MESSAGE       00250082
*        QUEUES DISK DATA SET                                           00300082
         SPACE                                                          00350082
.*       UPDATED   09/10/77                                             00400082
.*CHANGE ACTIVITY = AS FOLLOWS:                                         00450082
.*                                                                      00500082
         SPACE                                                          00550082
IOSBE    DSECT                                                          00600082
IOSBEENT DS    XL1                      ENTRY FLAG                      00650082
IOSBESIO EQU   X'28'                    ENTRY FOR START I/O             00700082
IOSBEIOS DS    AL3                      ADDRESS OF IOSB                 00750082
IOSBEFLG DS    XL1                      FLAG BYTE                       00800082
IOSBEEOL EQU   X'80'                    END OF PARM LIST                00850082
IOSBERDY EQU   X'40'                    IOSBE READY FOR                 00900082
*                                       NEW I/O OPERATION               00950082
IOSBEBUS EQU   X'FF'-IOSBERDY           IOSBE BUSY - CANNOT             01000082
*                                       ACCEPT NEW I/O                  01050082
IOSBECPR EQU   X'20'                    CCW'S ARE REAL                  01100082
IOSBECPV EQU   X'FF'-IOSBECPR           CCW'S ARE VIRTUAL               01150082
IOSBENRQ EQU   X'10'                    QUEUE TYPE                      01200082
*                                         1 = NON-REUS QUEUES           01250082
*                                         0 = REUS QUEUES               01300082
IOSBECPB DS    AL3                      ADDRESS OF CPB                  01350082
IOSBEXCC DS    H                        ARM POSITION                    01400082
IOSBERET DS    XL3                      RETRY QUEUE                     01450082
IOSBENEW DS    AL3                      NEW QUEUE OF CPB'S              01500082
IOSBELCK DS    XL1                      TEST AND SET BYTE USED TO       01550082
*                                       SYNCHRONIZE RETRIES             01600082
         DS    XL7                      RESERVED                        01650082
IOSBELEN EQU   *-IOSBE                  LENGTH OF IOSBE                 01700082
         MEND                                                           01750082
./  ADD  SSI=81740512,NAME=TLCBD
*        %GOTO BSLLCB;                                               /* 00090000
         MACRO                                                          00180000
         TLCBD                                                          00270000
.*A000000-999999                                               @X20X5X0 00360000
.*D062000,122000,266000,338000,384000,386000,422000,434000     @Y17XAXF 00450000
.*D562600-564400,                                              @Y17XAXF 00540000
.*D914900,930800,931000,935600,935800,940000,941600,           @Y17XAXF 00630000
.*D954400-955200,935100                                        @Y17XAXF 00720000
.*D300000,560000-564000,600000                                   S22026 00810000
.*A120000,182000,241000-243000,450000,542000,5561000             S22026 00900000
.*A562000-565000,                                                S22026 00990000
.*A243200-243800,                                                S99238 01080000
.*A241000,243000,                                               SA58994 01170000
.*A184000,216000,252000,224000,922200,929800,950400,           @Y17XAXF 01260000
.*C548000,578000-579000,918800-919000,922000,923800-926800,    @Y17XAXF 01350000
.*C956600-957400,938400-93856,304000,344000,352000,356000,     @Y17XAXF 01440000
.*C430000,933200,936400-936800,941200,                         @Y17XAXF 01530000
.*A060000,216000,228000,570000,579200,914800,923600,956000,    @Y17XAXF 01620000
.*C576000,922320-923400,927200-929600,957600,957800,           @Y17XAXF 01710000
.*C956200-956600,372000,426000,937600,940400-940600,330000,    @Y17XAXF 01800000
.*A958900,584000                                               @Y17XAXF 01890000
.*A056000,509400                                               @OY14092 01920000
.*C200700,201600,509400,621000,621900                          @OY14092 01950000
.*A603000,C188100                                              @OY18040 01951000
.*A357350,357400,357450,357500,821750,821800,821850,821900     @G36XRXG 01955000
.*C358200,822600                                               @G36XRXG 01960000
.*A127400,550400                                               @G36XRXG 01965000
.*C550800,551700,552600,553500,554400,555300                   @G36XRXG 01970000
.*C556200,557100,558000,558900,559800,560700                   @G36XRXG 01975000
.*C366300                                                      @G36XRXG 01976000
.*A366400-366600,732400,372700                                 @G36XRXG 01977000
*A246600,681300                                                @OY20488 01977182
.*C772200                                                      @OY20411 01977282
IEDQLCB  DSECT                                                          01980000
         SPACE                                                          02070000
.*       CONVERTED TO BILINGUAL ON 07/18/72                      S22024 02160000
*        UPDATED 01/05/73                                        S22024 02250000
         SPACE                                                          02340000
LCBRCB   DS    0D .                     RESOURCE CONTROL BLOCK          02430000
LCBKEY   DS    XL1 .                    ELEMENT KEY OF BUFFER           02520000
LCBQCBA  DS    AL3 .                    QCB ADDRESS                     02610000
LCBPRI   DS    XL1 .                    PRIORITY OF BUFFER              02700000
LCBLINK  DS    AL3 .                    LINK FIELD OF BUFFER            02790000
LCBRSKEY DS    XL1 .                    RECEIVE SCHEDULER KEY           02880000
LCBSTCBA DS    AL3 .                    ADDRESS OF FIRST STCB WHEN      02970000
*                                       LCB IS A QCB.                   03060000
LCBRSPRI DS    XL1 .                    RECEIVE SCHEDULER PRIORITY      03150000
LCBRSLNK DS    AL3 .                    ADDR NEXT ITEM IN CHAIN         03240000
LCBEOLTD DS    XL2 .                    END OF LIST TIME DELAY          03330000
LCBTDL   DS    XL1 .                    TIME DELAY QUEUE OFFSET TO      03420000
*                                       QCB ADDRESS. FOR LCB = X'14'    03510000
LCBTSOB  DS    XL1 .                    TSO STATUS BITS             TSO 03600000
*                        BIT DEFINITIONS                            TSO 03690000
LCBWRBRK EQU   X'80' .                  WRITE BREAK IN PROGRESS@Y17XAXF 03780000
LCBTSBUF EQU   X'40' .                  BUFFER HAS TS PREFIX        TSO 03870000
LCBSATRD EQU   X'20' .                  SIMULATED ATTN READ REQUEST TSO 03960000
LCBSOPL  EQU   X'10' .                  START OF POLLING LIST       TSO 04050000
LCBPREP  EQU   X'08' .                  PREPARE ON LINE        @Y17XAXF 04140000
LCBCIRCD EQU   X'04' .                  CIRCLE D SENT TO 2741       TSO 04230000
LCBINHBN EQU   X'02' .                  USE INHIBITS FOR THIS TERM  TSO 04320000
LCB2741N EQU   X'01' .                  2741 ON THIS LINE           TSO 04410000
*                                                                       04500000
LCBCHAIN DS    XL1 .                    DISPOSITION STATUS BITS         04590000
*                        BIT DEFINITIONS                                04680000
*                                                                       04770000
LCBSCRNN EQU   X'80' .                  SCREEN CHANGE REQUESTED         04860000
LCBINVRQ EQU   X'80'                    INITIAL INVITE REQUEST   S22024 04950000
LCBSCRNF EQU   X'7F' .                  NO SCREEN CHANGE REQUESTED      05040000
LCBEXCP  EQU   X'40' .                  DELAY EXCP TILL ASSOCIATION     05130000
LCBERMSG EQU   X'20' .                  ERP MESSAGE WAITING             05220000
LCBNORTY EQU   X'10' .                  TEXT RETRY NOT POSSIBLE         05310000
LCBUREQN EQU   X'08' .                  UNIT REQUEST IN PROGRESS        05400000
LCBUREQF EQU   X'FF'-LCBUREQN .         UNIT REQUEST NOT IN PROGRESS    05490000
LCBBFRSZ EQU   X'04' .                  QUEUE MANAGEMENT FLAG           05580000
LCBTETEN EQU   X'02' .                  USER REQUESTED TETE A TETE      05670000
LCBCTLMD EQU   LCBTETEN .               LINE IN CONTROL MODE   @OY14092 05710000
LCBTETEF EQU   X'FD' .                  TETE A TETE NOT REQUESTED       05760000
LCBABRTN EQU   X'01' .                  ABORT SEQUENCE MUST BE SENT     05870000
LCBABRTF EQU   X'FE' .                  ABORT SEQUENCE NOT REQUIRED     05940000
*                                                                       06030000
LCBINSRC DS    0AL3 .                   IN-SOURCE CHAIN        @Y17XAXF 06120000
         DS    XL2 .                                           @Y17XAXF 06210000
LCBLKMDE DS    XL1 .                    LOCKMODE INDICATORS    @Y17XAXF 06300000
LCBBDFLG EQU   X'80' .                   IEDQBD HAS NOT FINISHED INMSG  06390000
*                                         PROCESSING           @Y17XAXF 06480000
LCBHMFLG EQU   X'40' .                   MSG HAS NOT BEEN PUT ON QUE    06570000
*                                         WAITING FOR LINE TO BECOME    06660000
*                                         READY TO START A SEND         06750000
*                                         OPERATION            @Y17XAXF 06840000
LCBLOCKR EQU   X'20' .                   LOCK RESPONSE FROM A PUT       06930000
*                                                              @Y17XAXF 07020000
LCBLOCKI EQU   X'10' .                   LOCK INQUIRY          @Y17XAXF 07110000
*        EQU   X'08'-'X01'               RESERVED              @Y17XAXF 07200000
LCBSTAT4 DS    0XL1 .                   FOURTH STATUS BYTE     @Y17XAXF 07290000
LCBDMPRQ EQU   X'80' .                    3705 NEEDS DUMPING   @Y17XAXF 07380000
LCBDACRQ EQU   X'40' .                    3705 NEEDS DEACT'ING @Y17XAXF 07470000
LCBIPLRQ EQU   X'20' .                    3705 NEEDS IPLING    @Y17XAXF 07560000
LCBACTRQ EQU   X'10' .                    3705 NEEDS ACTIVATING@Y17XAXF 07650000
*        EQU   X'08'                    RESERVED               @YM08120 07740000
* LCBPHASE     BITS 5&6                 PIU PHASE INFO         @Y17XAXF 07830000
LCBREAL  EQU   X'04' .                  CCW'S IN 3705 LCB HAVE @YM04622 07860000
*                                       BEEN TRANSLATED                 07890000
LCBCPGMH EQU   X'01' .                  MH CHAIN PURGE         @Y17XAXF 07920000
LCBNTXT  DS    XL1 .                    PRFNTXT SAVE                    08010000
LCBSCBDA DS    AL3 .                    ADDR SCB DIRECTORY              08100000
LCBLNENT EQU   LCBSCBDA+1 .             TNT OFFSET TO LINE ENTRY        08190000
LCBISZE  DS    XL1 .                    COUNT OF IDLES RESERVED         08280000
LCBMHA   DS    0AL3 .                   MH QCB ADDR FOR NCP    @YM06085 08310000
*                                         RESOURCES            @YM06085 08340000
LCBFSBFR DS    AL3 .                    FIRST BFR ASSIGNED TO  @Y17XAXF 08370000
*                                         LCB                  @Y17XAXF 08460000
LCBFLAG1 DS    XL1 .                    IOS FLAGS 1                     08550000
*        EQU   X'80'-X'40'                RESERVED             @Y17XAXF 08640000
LCBERPIN EQU   X'20' .                    ERP IN CONTROL       @Y17XAXF 08730000
*        EQU   X'10'-X'08'                RESERVED             @Y17XAXF 08820000
LCBEXCPN EQU   X'04' .                    IOB EXCEPTION FLAG   @Y17XAXF 08910000
LCBUNREL EQU   X'02' .                  UNRELATED REQUEST FLAG @Y17XAXG 09000000
*        EQU   X'01'                      RESERVED             @Y17XAXF 09090000
LCBPLCB  EQU   X'00'                      PLCB INDICATOR       @Y17XAXF 09110000
LCBPRFSZ EQU   LCBFLAG1-IEDQLCB .       LCB PREFIX SIZE        @Y17XAXF 09180000
*                                                              @Y17XAXF 09270000
*        SNA RESPONSE INFO                                     @Y17XAXF 09360000
*                                                              @Y17XAXF 09450000
LCBRSPIN DS    0CL19 .                  SNA RESPONSE INFO      @Y17XAXF 09540000
         DS    XL1 .                    RESERVED               @YM06118 09630000
LCBSNS0  DS    XL1 .                    SAME BYTE AS LCBSENS0- @YM06118 09660000
*                                         MUST BE 0 FOR SNA    @YM06118 09690000
LCBRHSV  DS    XL3 .                    RESPONSE RH            @YM07705 09720000
LCBLUSNS DS    0CL4 .                   RESPONSE SENSE         @Y17XAXF 11250000
LCBSMAJ  DS    XL1 .                    MAJOR SENSE BYTE       @Y17XAXG 11340000
LCBSMIN  DS    XL1 .                    MINOR SENSE BYTE       @Y17XAXG 11430000
LCBUSER  DS    XL2 .                    USER SENSE BYTES       @Y17XAXG 11520000
LCBSCPRS DS    0XL3 .                   SSCP RESPONSE BYTES    @Y17XAXF 11560000
LCBDFCMD DS    XL1 .                    DFC COMMAND RSP BYTE   @Y17XAXF 11610000
         DS    XL1 .                    RESERVED               @Y17XAXF 11700000
LCBCSWU1 DS    XL1 .                    SAME BYTE AS LCBCSWUS  @Y17XAXF 11706000
*        EQU   X'80'-X'02' .            RESERVED               @Y17XAXF 11712000
LCBUSUE1 EQU   X'01' .                  SAME BIT AS LCBUSUE-   @Y17XAXF 11718000
*                                       INDICATES END OF       @Y17XAXF 11724000
*                                       MESSAGE SENT OR RCV'D  @Y17XAXF 11730000
         DS    XL3 .                    RESERVED               @Y17XAXF 11740000
LCBRSPFG DS    XL1 .                    FLAG BYTE USED IN RESPONSE      11790000
*                                        GENERATION            @Y17XAXF 11830000
LCBEXPI  EQU   X'80'                    RESPONSE IS EXPEDITED  @Y17XAXG 11880000
LCBRSRH  EQU   X'40' .                  EXCEPTION RESP GEN'D   @YM07705 11920000
*        EQU   X'20-01'                 RESERVED               @YM07705 11970000
LCBPAKCH DS    AL3 .                    BACK BUFFER CHAIN      @Y17XAXF 12060000
         ORG   LCBRSPIN                                                 12240000
*                                                              @Y17XAXF 12330000
*        IOB SENSE INFORMATION                                 @Y17XAXF 12420000
*                                                              @Y17XAXF 12510000
LCBIOBSN DS    0CL19                    IOB SENSE              @Y17XAXF 12600000
LCBFLAG2 DS    XL1 .                    IOS FLAGS 2                     12690000
LCBSNS   DS    0XL2 .                     SENSE BYTES          @G36XRXG 12730000
LCBSENS0 DS    XL1 .                    SENSE BYTE 0                    12780000
LCBCMDRJ EQU   X'80' .                    COMMAND REJECT       @Y17XAXF 12870000
LCBINTRQ EQU   X'40' .                    INTERVENTION REQUIRED@Y17XAXF 12960000
LCBBUSCK EQU   X'20' .                    BUSOUT CHECK         @Y17XAXF 13050000
LCBEQUCK EQU   X'10' .                    EQUIPMENT CHECK      @Y17XAXF 13140000
LCBDATCK EQU   X'08' .                    DATA CHECK           @Y17XAXF 13230000
LCBOVRUN EQU   X'04' .                    OVERRUN              @Y17XAXF 13320000
LCBLOSDT EQU   X'02' .                    LOST DATA            @Y17XAXF 13410000
LCBNOTIN EQU   X'02' .                    NOT INITIALIZED      @Y17XAXF 13500000
LCBTMOUT EQU   X'01' .                    TIME-OUT EXCEEDED    @Y17XAXF 13590000
LCBABORT EQU   X'01' .                    ABORT                @Y17XAXF 13680000
LCBSENS1 DS    XL1 .                    SENSE BYTE 1                    13770000
LCBECBCC DS    XL1 .                    COMPLETION CODE                 13860000
LCBECB41 EQU   X'41' .                   PERMANENT ERROR       @Y17XAXF 13950000
LCBECB48 EQU   X'48' .                   I/O ENDED W/ HALT I/O @Y17XAXF 14040000
LCBECB7F EQU   X'7F' .                   NORMAL COMPLETION     @Y17XAXF 14130000
LCBECBPT DS    AL3 .                    ADDR OF ECB                     14220000
LCBFLAG3 DS    XL1 .                    IOS FLAGS 3                     14310000
*                        BIT DEFINITIONS                         S22026 14400000
LCBOBR   EQU   X'01'                    OBR RECORDING FLAG      SA58994 14490000
*                                                                       14580000
*                                                                       14670000
LCBOBRRD EQU   X'02' .                  TPER RECORD PROCESSING   S22026 14760000
*                                                                S22026 14850000
LCBIOMSG EQU   X'04'                    I/O MESSAGE FLAG        SA58994 14940000
*                                                                       15030000
*                                                                       15120000
LCBSOHC  EQU   X'08' .                  SOH % C FLAG BIT         S99238 15210000
LCBSOHR  EQU   X'20' .                  SOH % R FLAG BIT         S99228 15300000
*                                       IF R & C FLAG BITS OFF   S99238 15390000
*                                       SOH % E MSG IS ASSUMED   S99238 15480000
LCBRLAD  EQU   X'10'                    INDICATES REAL ADDRESSES IN     15570000
*                                       LCB CHANNEL PROGRAM AREA X01004 15660000
LCBCSW   DS    0XL7 .                   LAST CSW               @Y17XAXF 15750000
LCBCSWCA DS    AL3 .                     CCW ADDR              @Y17XAXF 15840000
LCBCSWST DS    0XL2 .                    STATUS                @Y17XAXF 15930000
LCBCSWUS DS    XL1 .                      UNIT STATUS          @Y17XAXF 16020000
LCBUSAT  EQU   X'80' .                     ATTENTION           @Y17XAXF 16110000
LCBUSSM  EQU   X'40' .                     STATUS MODIFIER     @Y17XAXF 16200000
LCBUSCUE EQU   X'20' .                     CONTROL UNIT END    @Y17XAXF 16290000
LCBUSBSY EQU   X'10' .                     BUSY                @Y17XAXF 16380000
LCBUSCE  EQU   X'08' .                     CHANNEL END         @Y17XAXF 16470000
LCBUSDE  EQU   X'04' .                     DEVICE END          @Y17XAXF 16560000
LCBUSUC  EQU   X'02' .                     UNIT CHECK          @Y17XAXF 16650000
LCBUSUE  EQU   X'01' .                     UNIT EXCEPTION      @Y17XAXF 16740000
LCBCSWCS DS    XL1 .                      CHANNEL STATUS       @Y17XAXF 16830000
LCBCSPCI EQU   X'80' .                     PROGRAM CONTROL INT @Y17XAXF 16920000
LCBCSIL  EQU   X'40' .                     INCORRECT LENGTH    @Y17XAXF 17010000
LCBCSPGC EQU   X'20' .                     PROGRAM CHECK       @Y17XAXF 17100000
LCBCSPTC EQU   X'10' .                     PROTECTION CHECK    @Y17XAXF 17190000
LCBCSCDC EQU   X'08' .                     CHANNEL DATA CHECK  @Y17XAXF 17280000
LCBCSCCC EQU   X'04' .                     CHANNEL CONTROL CHK @Y17XAXF 17370000
LCBCSICC EQU   X'02'                       INTERFACE CTL CHK   @Y17XAXF 17460000
LCBCSCHC EQU   X'01' .                     CHAINING CHECK      @Y17XAXF 17550000
LCBCSWRC DS    XL2 .                     RESIDUAL COUNT        @Y17XAXF 17640000
LCBSIOCC DS    XL1 .                    SIO CONDITION CODE              17730000
*        EQU   X'80'-X'40' .             RESERVED              @Y17XAXF 17820000
LCBSIOC1 EQU   X'20' .                   CONDITION CODE.....   @Y17XAXF 17910000
LCBSIOC2 EQU   X'10' .                   .....SETTING FOR 3705 @Y17XAXF 18000000
LCBAP1OL EQU   X'08' .              ALTERNATE PATH 1 OFFLINE   @Y17XAXG 18090000
LCBAP2OL EQU   X'04' .              ALTERNATE PATH 2 OFFLINE   @Y17XAXG 18180000
LCBAP3OL EQU   X'02' .              ALTERNATE PATH 3 OFFLINE   @Y17XAXG 18270000
LCBAP4OL EQU   X'01' .              ALTERNATE PATH 4 OFFLINE   @Y17XAXG 18360000
LCBSTART DS    AL3 .                    ADDR OF CHANNEL PROGRAM         18450000
LCBPCILK DS    0AL4 .                   PCI LOCK FOR MP SYSTEM @Y17XAXF 18540000
LCBDCBPT DS    A .                      ADDRESS OF DCB                  18630000
LCBRESTR DS    0A .                     ERROR MESSAGE DATA              18720000
LCBRCQCB DS    0A .                     QCB TO POST RECALL BUFF@OY18040 18810000
LCBCMDSV DS    CL1 .                    COMMAND CODE SAVE      @OY18040 18820000
         DS    AL3 .                                           @OY18040 18830000
LCBTHSQ  DS    0H .                     TH SEQ NUMBER          @YM06118 18850000
LCBINCAM DS    H .                      ERP RETRY COUNTS       @Y17XAXF 18900000
LCBGETMN EQU   X'80' .                  GETMAINED STORAGE AREA          18930000
*                                        EXIST IS 904I/904H    @Y17XAXF 18960000
LCBTTBIN DS    0H .                     TERM TO BE CONNECTED INDEX      18990000
LCBERRCT DS    H .                      IOS ERROR COUNTERS              19080000
LCBUCBX  DS    XL1 .                    UCB INDEX                       19170000
LCBRCBFR DS    0AL3 .                   POINTER TO RECALLED BUFFER      19260000
LCBRDBFR DS    0AL3 .                   START OF READ CHAN PROG  S22024 19350000
LCBLSPCI DS    AL3 .                    ADDR OF LAST SRVCD PCI          19440000
LCBRECOF DS    H .                      OFFSET INTO CURRENT BLOCK       19530000
LCBSTATE DS    0H .                     STATUS BITS                     19620000
LCBSTAT1 DS    XL1 .                    FIRST STATUS BYTE      @Y17XAXF 19710000
*                        BIT DEFINITIONS                                19800000
LCBRCLLN EQU   X'80' .                  RECALL BEING PERFORMED          19890000
LCBRCLLF EQU   X'FF'-LCBRCLLN .         NO RECALL                       19980000
LCBOCWTN EQU   X'40' .                  NON-IMMEDIATE OPERATOR @OY14092 20070000
*                                       COMMAND WAITING        @OY14092 20160000
LCBOCNI  EQU   X'20' .                  NON-IMEDIATE OPERATOR CONTROL   20250000
*                                       OPERATION IN PROGRESS  @Y17XAXF 20340000
LCBINITN EQU   X'10' .                  RECEIVING INITIATE MODE MSG     20430000
LCBINITF EQU   X'FF'-LCBINITN .         NO INITIATE MODE                20520000
LCBCONT  EQU   X'08' .                  CONTINUE OR RESET OPERATION     20610000
LCBFREEN EQU   X'04' .                  LINE FREE              @Y17XAXF 20700000
LCBFREEF EQU   X'FF'-LCBFREEN .         LINE NOT FREE                   20790000
LCBRECVN EQU   X'02' .                  LINE IS RECEIVING      @Y17XAXF 20880000
LCBSENDN EQU   X'01' .                  ON = LINE SENDING      @Y17XAXF 20970000
*                                       BOTH SEND AND RECEIVE BITS      21060000
*                                       OFF INDICATE LINE IS STOPPED    21150000
*                                                                       21240000
LCBSTAT2 DS    XL1 .                    SECOND STATUS BYTE     @Y17XAXF 21330000
*                        BIT DEFINITIONS                                21420000
LCBTRACE EQU   X'80' .                  I/O TRACE ACTIVE FOR THIS LINE  21510000
LCBTRCOF EQU   X'FF'-LCBTRACE .         TRACE NOT ACTIVE                21600000
LCBMSGNN EQU   X'40' .                  MSGEN/STARTUP MESSAGE           21690000
LCBMSGNF EQU   X'FF'-LCBMSGNN .         NOT MSGEN/STARTUP MESSAGE       21780000
LCBBEOTN EQU   X'20' .                  EOT FROM BFRED TERM -NO EOM     21870000
LCBCONNN EQU   X'20' .                  ERROR ON DIAL CONTACT  @YM08436 21910000
LCBBEOTF EQU   X'DF' .                  REGULAR EOM IF EOT              21960000
LCBSNDPR EQU   X'10' .                  SEND PRIORITY SWITCH SET BY     22050000
*                                       SEND SCHEDULER                  22140000
LCBNEGRP EQU   X'08' .                  NEGATIVE RESPONSE TO POLLING    22230000
*                                       RECEIVED                        22320000
LCBSYNC  EQU   X'04' .                  LINE IS BISYNC                  22410000
LCBATTN  EQU   X'04' .                  3705 ATTENTION RECEIVED@Y17XAXF 22500000
LCBDIAL  EQU   X'02' .                  DIAL LCB                        22590000
LCBBFRAV EQU   X'02' .                  3705 BUFFER AVAILABLE  @Y17XAXF 22680000
LCBRESP  EQU   X'01' .                  A RESPONSE IS OWED     @Y17XAXF 22770000
*                                                                       22860000
LCBTSTSW DS    XL1 .                    TEST-AND-SET SWITCH             22950000
*                        BIT DEFINITIONS                                23040000
LCBCONCT EQU   X'80' .                  CONNECTION ESTABLISHED          23130000
*                                                                       23220000
LCBRECAD DS    AL3 .                    ADDRESS CURRENT MSG BLOCK       23310000
LCBERB   DS    0A .                     ERB                             23400000
LCBERBKY DS    XL1 .                    ELEMENT REQUEST BLOCK KEY       23490000
LCBERBQB DS    AL3 .                    ERB QCB                         23580000
LCBERBPY DS    XL1 .                    ERB PRIORITY                    23670000
LCBERBLK DS    AL3 .                    ADDR NEXT ITEM IN CHAIN         23760000
LCBERBST DS    XL1 .                    STATUS OF ERB                   23850000
*                                       THE X'08' BIT MUST NEVER BE ON  23940000
*                                       IN THE STATUS BYTE. IT MUST     24030000
*                                       REMAIN THE 9TH BYTE OF YHE ERB  24120000
*                        BIT DEFINITIONS                                24210000
LCBINQ   EQU   X'10' .                  ERB IS WAITING-BFRS FROM HM     24300000
LCBEOMSG EQU   X'40' .                  END OF MESSAGE READ FROM DISK   24390000
LCBRDERR EQU   X'20' .                  LOGICAL READ ERROR              24480000
LCBRDERF EQU   X'FF'-LCBRDERR .         NO READ ERROR                   24570000
LCBMSG   EQU   X'80' .                  END OF INITIATE MODE TO HM      24660000
LCBLOGDV EQU   X'08'                    LOGGING REQUESTED      @OY20488 24700082
LCBERROR EQU   X'04' .                  ERROR ON SEND SIDE              24750000
LCBPRCPG EQU   X'02' .                  AFTER INITIAL REQUEST IS        24840000
*                                       SATISFIED, ERB WILL BE POSTED   24930000
*                                       TO QCB INDICATED IN LCBRCQCB    25020000
LCBCOMPL EQU   X'02' .                  DISK REQUEST IS COMPLETE        25110000
LCBDLNKN EQU   X'01' .                  DELINK SWITCH ON-ERB NOT POSTED 25200000
*                                       IF ON THE ERB CAN BE POSTED     25290000
LCBDLNKF EQU   X'FE' .                  ERB POSTED                      25380000
*                                       PCI CAN NOT POST ERB            25470000
*                                                                       25560000
LCBERBCH DS    AL3 .                    ADDR CHAIN ASSIGNED BFRS        25650000
LCBERBCT DS    0H .                     COUNT FIELDS           @Y17XAXF 25740000
LCBRBCT1 DS    CL1 .                      ENABLED COUNT FIELDS @Y17XAXF 25830000
LCBRBCT2 DS    CL1 .                      DISABLED COUNT FIELDS@Y17XAXF 25920000
LCBDCNT  EQU   X'80' .                       DISABLED CNT INUSE@Y17XAXF 26010000
*                                            RESERVED          @Y17XAXF 26100000
LCBTTCIN DS    H .                      TERM CURR CONNECTED INDEX       26190000
LCBMSGFM DS    XL1 .                    BITS TO CONTROL BSC LINE        26280000
*                        BIT DEFINITIONS                                26370000
LCBNAK   EQU   X'80' .                  REQUEST TO SEND NAK RESPONSE    26460000
LCBACKI  EQU   X'40' .                  ACK COUNTER - SEND/RECEIVE      26550000
*   FOLLOWING TWO BITS  INDICATE WHETHER A SCAN OF LINE CONTROL         26640000
*   HAS BEEN ACCOMPLISHED AND TYPE OF LINE CONTROL RECEIVED.            26730000
LCBVSTRT EQU   X'20' .                  VALID START SEQUENCE            26820000
LCBRSTRT EQU   X'10' .                  ERROR START SEQUENCE            26910000
LCBTTD   EQU   X'08' .                  TTD RECEIVED                    27000000
LCBENQ   EQU   X'04' .                  ENQ RECEIVED                    27090000
LCBEOT   EQU   X'02' .                  EOT FIRST CHARACTER             27180000
LCBOLT   EQU   X'01' .                  TOTE REQUEST                    27270000
*                                                                       27360000
LCBSCBA  DS    AL3 .                    ADDRESS OF CURRENT SCB          27450000
LCBOBRCH DS    0A .                     3705 OBR/SDR/MDR CHAIN @Y17XAXF 27540000
LCBERMSK DS    XL1 .                    ERROR RECORDING MACK   @Y17XAXF 27630000
LCBBFRW  DS    0AL3 .                   ADDR OF BSC STATUS     @Y17XAXF 27720000
*                                        PENDING BUFFER        @Y17XAXF 27810000
LCBINVPT DS    0AL3 .                   ADDR CURR ENTRY IN INV LIST     27900000
LCBNXCMD DS    CL3 .                    SNA COMMAND TYPE       @Y17XAXF 27990000
*                                                              @Y17XAXF 28080000
*        3705 CORE QUEUE INFO                                  @Y17XAXF 28170000
*                                                              @Y17XAXF 28260000
LCBCOREQ DS    0CL12 .                  3705 OUTPUT CORE QUEUE @Y17XAXF 28350000
LCBCQELE DS    AL4 .                     ELEMENT CHAIN         @Y17XAXF 28440000
LCBCQLNK DS    AL4 .                     LINK                  @Y17XAXF 28530000
LCBWRSCH DS    AL4 .                     ADDR OF WRITE SCHD'S  @Y17XAXF 28620000
*                                         STCB                 @Y17XAXF 28710000
         ORG   LCBCOREQ                                        @Y17XAXF 28800000
*                                                              @Y17XAXF 28890000
*        PLCB STATUS INFO                                      @Y17XAXF 28980000
*                                                              @Y17XAXF 29070000
LCBTPCD  DS    0CL12 .                  TP OP CODES              S22024 29160000
LCBSTAT5 DS    CL1 .                    FIFTH STATUS BYTE      @Y17XAXF 29250000
LCBPERM  EQU   X'80' .                    PLCB PERMANENTLY     @Y17XAXF 29340000
*                                          ASSIGNED            @Y17XAXF 29430000
LCBLUNIT EQU   X'40' .                    SNA LOGICAL UNIT     @Y17XAXF 29520000
LCBLUS   EQU   X'20' .                    RETURN PLCB TO LUS   @Y17XAXF 29610000
*        EQU   X'10'-X'01' .              RESERVED             @Y17XAXF 29700000
LCBBFRSV DS    AL3                      PTR TO SAVED BUF CHAIN @Y17XAXF 29790000
LCBSTAT6 DS    XL1 .                    SNA STATUS             @Y17XAXF 29880000
*LCBCHN  EQU   X'80'-X'10'                CHAINING STATE       @Y17XAXF 29970000
*        THE FOLLOWING VALUES ARE VALID WHEN LCBRECVN=1 OR LCBSENDN=1   30060000
LCBBETC  EQU   X'00' .                     BETWEEN CHAIN STATE(WAITING  30150000
*                                           FOR NO RESPONSE)   @Y17XAXF 30240000
LCBINC   EQU   X'10' .                     IN CHAIN STATE      @Y17XAXF 30330000
LCBPURG  EQU   X'20' .                     PURGING CHAIN STATE @Y17XAXF 30420000
LCBWMG   EQU   X'30' .                     BETWEEN CHAIN-WAITING FOR    30510000
*                                           MSGGEN RSP STATE   @Y17XAXF 30600000
*        THE FOLLOWING VALUES ARE VALID ONLY WHEN LCBRECVN=1   @Y17XAXF 30610000
LCBWERAS EQU   X'70' .                    BETWEEN CHAIN STATE-WAITING   30620000
*                                          FOR SCREEN ERASURE RESPONSE  30630000
*                                          (TSO STATE ONLY)    @Y17XAXF 30640000
LCBWSMI  EQU   X'80' .                    BETWEEN CHAIN STATE-WAITING   30650000
*                                          START MI RESPONSE            30660000
*                                          (TSO STATE ONLY)    @Y17XAXF 30670000
*                                                                       30680000
*        THE FOLLOWING VALUES ARE VALID ONLY WHEN LCBSENDN=1            30690000
LCBWFMD  EQU   X'40' .                     BETWEEN CHAIN-WAITING FOR FM 30780000
*                                           DATA RSP STATE     @Y17XAXF 30870000
LCBWCAN  EQU   X'50' .                     BETWEEN CHAIN-WAITING FOR FM 30960000
*                                           CANCEL RSP STATE   @Y17XAXF 31050000
LCBWBID  EQU   X'60' .                     BETWEEN CHAIN-WAITING FOR FM 31140000
*                                           BID RSP STATE      @Y17XAXF 31230000
*                                                                       31270000
LCBHDRPD EQU   X'08' .                    ON-HDR HAS BEEN POSTED TO MH  31590000
*                                         OFF-HDR HAS NOT BEEN POSTED   31680000
*                                          TO MH               @Y17XAXF 31770000
LCBRTRRO EQU   X'04' .                    RESPONSE OWED TO RTR @Y17XAXF 31860000
LCBMHBID EQU   X'02' .                    BID COMMAND TO BE BUILT       31950000
*                                                              @Y17XAXF 32040000
LCBINPAK EQU   X'01' .                    ON-IN PACK STATE              32130000
*                                         OFF-BETWEEN PACK STATE        32160000
*                                                              @Y17XAXF 32190000
LCBWAITC DS    AL3 .                    PIU WAIT CHAIN         @Y17XAXF 32220000
LCBBFSNS DS    0CL4 .                   BIND-FAILED SENSE DATA @Y17XAXF 32310000
LCBRSPSV DS    AL4 .                    PTR TO SAVED RSP BUFFER@Y17XAXF 32350000
*                                                              @Y17XAXF 32400000
*        RH CANCEL INFO                                        @Y17XAXF 32490000
*                                                              @Y17XAXF 32580000
LCBCANCL DS    0CL8 .                   CANCEL INFO            @Y17XAXF 32670000
LCBCANFG DS    XL1 .                    CANCEL RH FLAGS        @Y17XAXF 32760000
LCBCANXT EQU   X'80' .                   CANCEL MUST BE        @Y17XAXF 32850000
*                                         RESPONDED TO         @Y17XAXF 32940000
LCBCANEB EQU   X'40' .                   CANCEL RH END BKT     @Y17XAXF 33030000
*        EQU   X'20' .                   RESERVED              @Y17XAXF 33120000
LCBCANCD EQU   X'10' .                   CANCEL RH CHGE DIRECT @Y17XAXF 33210000
*        EQU   X'08'-X'01' .             RESERVED              @Y17XAXF 33300000
LCBCANTH DS    XL2 .                    CANCEL TH SEQ          @Y17XAXF 33390000
         DS    XL2 .                    RESERVED               @Y17XAXF 33480000
*                                                                       33570000
*    ================================================================   33580000
*        IGG019RP USES LCB+X'73' TO LCB+ X'97' AS WORK AREA             33590000
*    ================================================================   33600000
*                                                                       33610000
         ORG   LCBCANCL                                        @Y17XAXF 33660000
*                                                              @Y17XAXF 33750000
*        SAVE AREA FOR SENSE                                   @Y17XAXF 33840000
*                                                              @Y17XAXF 33930000
LCBSAVSN DS    0CL8 .                   SAVE SENSE             @Y17XAXF 34020000
LCBSNSV  DS    XL1 .                    SAVE AREA FOR SENSE BYTE        34110000
LCBCSWSV DS    XL7 .                    SAVE AREA FOR CSW               34200000
*                                                              @YM08142 34202000
*        IEDQNX INTERFACE AREA (3705 LCB ONLY)                 @YM08142 34204000
*                                                              @YM08142 34206000
LCBQNX   DS    0CL24                    IEDQNX INTERFACE AREA  @YM08142 34208000
LCBQNXMN DS    XL1                      MESSAGE NUMBER FOR QNX @YM08142 34210000
LCBNX064 EQU   X'80'                    WRITE MSG IED064I      @YM08142 34212000
LCBNX142 EQU   X'40'                    WRITE MSG IED142I      @YM08142 34214000
LCBNX162 EQU   X'20'                    WRITE MSG IED162I      @YM08142 34216000
LCBNX509 EQU   X'10'                    WRITE MSG IED509I      @YM08142 34218000
*        EQU   X'08'-X'01'              RESERVED               @YM08142 34220000
LCBSTSAV DS    AL3                      SAVE AREA FOR LCBSTART @Y17XAXF 35640000
*                                        DURING RETRY          @Y17XAXF 35730000
         DS    XL1                      RESERVED               @ZM46833 35760000
LCBIOSBS DS    AL3                      SAVE AREA FOR IOSB     @ZM46833 35790000
         DS    2F                       RESERVED               @ZM46833 35820000
LCBDSTEA DS    A                        DEVICE STATISTIC TAB   @Y17XAXF 35910000
*                                        ENTRY ADDRESS         @Y17XAXF 36000000
LCBUASZE DS    XL1                      UNIT NAME ADDRESS SIZ  @Y17XAXF 36090000
LCBUNADD DS    AL3                      UNIT NAME ADDRESS      @Y17XAXF 36180000
*                                                              @Y17XAXF 36270000
*        ERP COMMAND AREA                                      @Y17XAXF 36360000
*                                                              @Y17XAXF 36450000
         ORG   LCBQNX                                          @Y17XAXF 36540000
LCBERCCW DS    3D                       3 ERP COMMANDS         @G36XRXG 36630000
         ORG    LCBERCCW+8                                     @G36XRXG 36640000
LCBATL05 DS    CL8                      3705 ATTEN ELEMENT     @G36XRXG 36650000
         DS    CL8                                             @G36XRXG 36660000
LCBSTICS EQU   LCBERCCW+21 .            CHRACTERISTCIS WORK AREA        36720000
LCBCPA   DS    0D .                     CHANNEL PROGRAM AREA            36810000
LCBCCW1  EQU   IEDQLCB+144              *                      @Y17XAXF 36900000
LCBCCW2  EQU   IEDQLCB+152              *                      @Y17XAXF 36990000
LCBCCW3  EQU   IEDQLCB+160              *  C C W               @Y17XAXF 37080000
LCBCCW4  EQU   IEDQLCB+168              *                      @Y17XAXF 37170000
LCBCCW5  EQU   IEDQLCB+176              *    B U I L D         @Y17XAXF 37260000
LCBATTEL EQU   LCBCCW5                  *                      @G36XRXG 37280000
         ORG   LCBCCW5                                         @ZM46675 37290000
LCBQEBPL DS    0CL8                     PARM LIST FOR QEB      @ZM46675 37300000
LCBSIO   DS    C                        FUNCTION CODE FOR QEB  @ZM46675 37310000
LCBIOSB  DS    AL3                      IOSB PTR               @ZM46675 37320000
LCBCP    DS    A                        PTR TO CHAN PRM START  @ZM46675 37330000
LCBCCW6  EQU   IEDQLCB+184              *                      @Y17XAXF 37350000
LCBCCW7  EQU   IEDQLCB+192              *    A R E A           @Y17XAXF 37440000
LCBCCW8  EQU   IEDQLCB+200              *                      @Y17XAXF 37530000
LCBCCW9  EQU   IEDQLCB+208              *                      @Y17XAXF 37620000
LCBCCW10 EQU   IEDQLCB+216              *                      @Y17XAXF 37710000
LCBERBFS EQU   LCBERBKY-IEDQLCB .       OFFSET INTO LCB OF ERB          37800000
LCBPLCBL EQU   LCBCPA-IEDQLCB+48        LENGTH OF PLCB         @YM08062 37890000
*                                                              @YM08062 37897000
*        FOR PLCB'S ONLY THE FOLLOWING FIELDS EXIST            @YM08062 37904000
*                                                              @YM08062 37911000
         ORG   LCBCPA+40                                       @YM08062 37918000
         DS    XL1                                             @YM08062 37925000
LCBNCPPT DS    AL3                      NCP TTE ADDRESS        @YM08062 37967000
*                                                                S99228 37980000
*                                                                S99228 38070000
*        DSECT FOR LCB EXTENSION AT TOP OF CHANNEL PROGRAM AREA  S99228 38160000
*                                                                S99228 38250000
IEDQLCBX DSECT                          LCB EXTENSION            S99228 38340000
LCBXCON  DS    0D                       START OF CONTROL FIELDS  S99228 38430000
LCBXFLAG DS    XL1                      DEV DEP FLAGS            S99228 38520000
LCBGPCTV EQU   X'08'                    ETX RECD GENERAL POLL    S99228 38610000
LCBGPSTP EQU   X'FF'-X'08'              GENERAL POLL RESET       S99228 38700000
LCBSRCPF EQU   X'04'                    SOURCE DETERM PERFORMED  S99228 38790000
LCBSRSTP EQU   X'FF'-X'04'              SOURCE DETERM RESET      S99228 38880000
LCBERPND EQU   X'02'                    SOH%R MESSAGE PENDING    S99228 38970000
LCBERSTP EQU   X'FF'-X'02'              ERP POLL RESET           S99228 39060000
LCBXDCT  DS    XL3                      DCT STORAGE AREA         S99228 39150000
LCBDCT1  EQU   LCBXDCT                  DCT BYTE 1               S99228 39240000
LCBDCT2  EQU   LCBXDCT+1                DCT BYTE 2               S99228 39330000
LCBDCT3  EQU   LCBXDCT+2                DCT BYTE 3               S99228 39420000
LCBXRADR DS    F                        ERP POLL CHARS ADDRESS   S99228 39510000
LCBPCIRC EQU   LCBXRADR                 3270 LOCAL PCI RETRY CNTRS99228 39600000
LCBERADR EQU   LCBXRADR+1               POLL CHARS ADDR FIELD    S99228 39690000
IEDQLCB  DSECT                                                   S99228 39780000
*                                                                       39870000
*                                                                       39960000
*         *******************************************************       40050000
*     0   *   KEY    **                    QCBA                 *       40140000
*         *******************************************************       40230000
*     4   *   PRI    **                    LINK                 *       40320000
*         *******************************************************       40410000
*     8   *   RSKEY  **                        STCBA            *       40500000
*         *******************************************************       40590000
*    12   *   RSPRI  **                        RSLNK            *       40680000
*         *******************************************************       40770000
*    16   *         EOLDT          **    TDL     **    TSOB     *       40860000
*         *******************************************************       40950000
*    20   *   CHAIN  **                        INSRC            *       41040000
*         *******************************************************       41130000
*    24   *   NTXT   **                     SCBDA               *       41220000
*         *******************************************************       41310000
*    28   *   ISZE   **                  FSBFR/LSBFR            *       41400000
*         *******************************************************       41490000
*    32   *   FLAG1  **   FLAG2    **   SENS0    **   SENS1     *       41580000
*         *******************************************************       41670000
*    36   *   ECBCC  **                        ECBPT            *       41760000
*         *******************************************************       41850000
*    40   *   FLAG3  **                         CSW             *       41940000
*         *******************************************************       42030000
*    44   *                       CSW                           *       42120000
*         *******************************************************       42210000
*    48   *   SIOCC  **                        START            *       42300000
*         *******************************************************       42390000
*    52   *                      DCBPT                          *       42480000
*         *******************************************************       42570000
*    56   *                   RCQCB/RESTR                       *       42660000
*         *******************************************************       42750000
*    60   *        INCAM           **       ERRCT/TTBIN         *       42840000
*         *******************************************************       42930000
*    64   *   UCBX   **                    RCBFR/LSPCI          *       43020000
*         *******************************************************       43110000
*    68   *         RECOF          **          STATE            *       43200000
*         *******************************************************       43290000
*    72   *   TSTSW  **                 RECAD                   *       43380000
*         *******************************************************       43470000
*    76   *   ERBKY  **                 ERBQB                   *       43560000
*         *******************************************************       43650000
*    80   *   ERBPY  **                 ERBLK                   *       43740000
*         *******************************************************       43830000
*    84   *   ERBIN  **                 ERBCH                   *       43920000
*         *******************************************************       44010000
*    88   *        ERBCT           **          TTCIN            *       44100000
*         *******************************************************       44190000
*    92   *  MSGFM   **                        SCBA             *       44280000
*         *******************************************************       44370000
*    96   *   ERMSK  **                        INVPT            *       44460000
*         *******************************************************       44550000
*   100   *                      TPCD                           *       44640000
*         *******************************************************       44730000
*   104   *                      TPCD                           *       44820000
*         *******************************************************       44910000
*   108   *                      TPCD                           *       45000000
*         *******************************************************       45090000
*   112   *   SNSV   **                        CSWSV            *       45180000
*         *******************************************************       45270000
*   116   *                      CSWSV                          *       45360000
*         *******************************************************       45450000
*   120   *                      ERCCW                          *       45540000
*         *******************************************************       45630000
*   124   *                                                     *       45720000
*         *******************************************************       45810000
*   128   *                                                     *       45900000
*         *******************************************************       45990000
*   132   *                                                     *       46080000
*         *******************************************************       46170000
*   136   *                                                     *       46260000
*         *******************************************************       46350000
*   140   *                                                     *       46440000
*         *******************************************************       46530000
*                                                                       46620000
         MEND  , */                                                     46710000
*%BSLLCB  :  ;                                                          46800000
*DECLARE                                                                46890000
*  1 IEDQLCB  BDY(DWORD) BASED(IEDQLPTR),                               46980000
*                                                                       47070000
*   2 LCBRCB      CHAR(8) BDY(DWORD),    /* RESOURCE CONTROL BLOCK   */ 47160000
*    3 LCBKEY      CHAR(1),              /* ELEMENT KEY OF BUFFER    */ 47250000
*    3 LCBQCBA     PTR(24),              /* QCB ADDRESS      @Y17XAXF*/ 47340000
*    3 LCBPRI      CHAR(1),              /* PRIORITY OF BUFFER       */ 47430000
*    3 LCBLINK     PTR(24),              /* LINK FIELD OF BUFFER     */ 47520000
*                                        /*                  @Y17XAXF*/ 47610000
*   2 LCBRSKEY    CHAR(1),               /* RECEIVE SCHEDULER KEY    */ 47700000
*   2 LCBSTCBA    PTR(24),               /* ADDRESS OF FIRST STCB       47790000
*                                          WHEN LCB IS A QCB @Y17XAXF*/ 47880000
*   2 LCBRSPRI    CHAR(1),               /* RECEIVE SCHED PRIORITY   */ 47970000
*   2 LCBRSLNK    PTR(24),               /* ADDR NEXT ITEM IN CHAIN  */ 48060000
*                                        /*                  @Y17XAXF*/ 48150000
*   2 LCBEOLTD    FIXED(15),             /* END OF LIST TIME DELAY   */ 48240000
*   2 LCBTDL      PTR(8),                /* TIME DELAY OFFSET TO QCB    48330000
*                                           ADDRESS FOR LCB = X'14'  */ 48420000
*   2 LCBTSOB     CHAR(1),               /* TSO STATUS BITS       TSO*/ 48510000
*                                                                       48600000
*/*      BIT DEFINITIONS                                          TSO*/ 48690000
*                                                                       48780000
*    3 LCBWRBRK BIT(1),                  /* WRITE BRK INPRG  @Y17XAXF*/ 48870000
*    3 LCBTSBUF BIT(1),                  /* BUFFER HAS TS PREFIX  TSO*/ 48960000
*    3 LCBSATRD BIT(1),                  /* SIMULATED ATTN READ         49050000
*                                           REQUEST               TSO*/ 49140000
*    3 LCBSOPL  BIT(1),                  /* START OF POLLING LIST TSO*/ 49230000
*    3 LCBPREP  BIT(1),                  /* PREPARE ON LINE  @Y17XAXF*/ 49320000
*    3 LCBCIRCD BIT(1),                  /* CIRCLE D SENT TO 2741 TSO*/ 49410000
*    3 LCBINHBN BIT(1),                  /* USE INHIBITS FOR THIS       49500000
*                                           TERM                  TSO*/ 49590000
*    3 LCB2741N BIT(1),                  /* 2741 ON THIS LINE     TSO*/ 49680000
*                                                                       49770000
*   2 LCBCHAIN    CHAR(1),              /* DISP STATUS BITS  @Y17XAXF*/ 49860000
*                                                                       49950000
*/*      BIT DEFINITIONS                                             */ 50040000
*                                                                       50130000
*     4 LCBSCRNN BIT(1),                 /* SCREEN CHANGE REQUESTED  */ 50220000
*       5 LCBINVRQ BIT(1),              /* INITIAL INVITE REQ  S22024*/ 50310000
*     4 LCBEXCP  BIT(1),                 /* DELAY EXCP UNTIL            50400000
*                                           ASSOCIATION              */ 50490000
*     4 LCBERMSG BIT(1),                 /* ERP MESSAGE WAITING      */ 50580000
*     4 LCBNORTY BIT(1),                 /* TEXT RETRY NOT POSSIBLE  */ 50670000
*     4 LCBUREQN BIT(1),                 /* UNIT REQUEST IN PROGRESS */ 50760000
*     4 LCBBFRSZ BIT(1),                 /* QUEUE MANAGEMENT FLAG    */ 50850000
*     4 LCBTETEN BIT(1),             /* TETE A TETE REQSTD   @OY14092*/ 50940000
*      5 LCBCTLMD BIT(1),            /* LINE IN CONTROL MODE @OY14092*/ 50980000
*     4 LCBABRTN BIT(1),                 /* ABORT SEQUENCE MUST BE      51030000
*                                           SENT                     */ 51120000
*   2 LCBINSRC    PTR(24),              /* IN SOURCE CHAIN   @Y17XAXF*/ 51300000
*    3 *          CHAR(2),                                /* @Y17XAXF*/ 51390000
*    3 LCBLKMDE   BIT(8),               /* LOCKMODE INDICATORS          51480000
*                                                            @Y17XAXF*/ 51570000
*     4 LCBBDFLG    BIT(1),             /*  IEDQBD HAS NOT FINISHED IN- 51660000
*                                            MESSAGE PROCESSING         51750000
*                                                            @Y17XAXF*/ 51840000
*     4 LCBHMFLG    BIT(1),             /*  MSG HAS NOT BEEN PUT ON QUE 51930000
*                                            WAITING FOR LINE TO BECOME 52020000
*                                            READY TO START A SEND      52110000
*                                            OPERATION       @Y17XAXF*/ 52200000
*     4 LCBLOCKR    BIT(1),             /*  LOCK RESPONSE FROM A PUT    52290000
*                                                            @Y17XAXF*/ 52380000
*     4 LCBLOCKI    BIT(1),             /*  LOCK INQUIRY     @Y17XAXF*/ 52470000
*     4 *           BIT(4),             /*  RESERVED         @Y17XAXF*/ 52560000
*   2 LCBNTXT     CHAR(1),               /* PRFNTXT SAVE             */ 52650000
*    3 LCBSTAT4    CHAR(1),             /* 4TH STATUS BYTE   @Y17XAXF*/ 52740000
*     4 LCBDMPRQ    BIT(1),             /*  3705 NEEDS DMP'G @Y17XAXF*/ 52830000
*     4 LCBDACRQ    BIT(1),             /*  3705 NEEDS DAC'G @Y17XAXF*/ 52920000
*     4 LCBIPLRQ    BIT(1),             /*  3705 NEEDS IPL'G @Y17XAXF*/ 53010000
*     4 LCBACTRQ    BIT(1),             /*  3705 NEEDS ACT'G @Y17XAXF*/ 53100000
*     4    *        BIT(1),             /*  RESERVED         @YM08120*/ 53190000
*     4 LCBPHASE    BIT(2),             /*  PIU PHASE INFO   @Y17XAXF*/ 53280000
*      5 LCBREAL    BIT(1),             /* CCW'S IN 3705 LCB @YM04622*/ 53310000
*                                       /* HAVE BEEN TRANSLATED      */ 53340000
*     4 LCBCPGMH    BIT(1),             /*  MH CHAIN PURGE   @Y17XAXF*/ 53370000
*   2 LCBSCBDA    PTR(24),              /* ADDR SCB DIRECTRY @Y17XAXF*/ 53460000
*    3 *           CHAR(1),                                             53550000
*    3 LCBLNENT    FIXED(16),            /* TNT OFFSET TO LINE ENTRY */ 53640000
*                                        /*                  @Y17XAXF*/ 53730000
*   2 LCBISZE     PTR(8),                /* COUNT OF IDLES RESERVED  */ 53820000
*   2 LCBMHA      PTR(24),              /* MH QCB ADDR FOR NCP          53850000
*                                            RESOURCES       @YM06085*/ 53880000
*    3 LCBFSBFR    PTR(24),             /* FIRST BUF ASSGNED @YM06085*/ 53910000
*   2 LCBFLAG1    CHAR(1),               /* IOS FLAGS 1              */ 54000000
*    3 *           BIT(2),              /*  RESERVED         @Y17XAXF*/ 54090000
*    3 LCBERPIN    BIT(1),              /*  ERP IN CTL       @Y17XAXF*/ 54180000
*    3 *           BIT(2),              /*  RESERVED         @Y17XAXF*/ 54270000
*    3 LCBEXCPN    BIT(1),              /*  IOB EXCEP FLG    @Y17XAXF*/ 54360000
*    3 LCBUNREL    BIT(1),              /* UNRELATED REQUEST @Y17XAFG*/ 54450000
*    3 *           BIT(1),              /*  RESERVED         @Y17XAXF*/ 54540000
*/*                                                          @Y17XAXF*/ 54630000
*/*      IOB SENSE INFO                                      @Y17XAXF*/ 54720000
*/*                                                          @Y17XAXF*/ 54810000
*   2 LCBIOBSN CHAR(19) BDY(DWORD,2),   /* IOB SENSE         @Y17XAXF*/ 54900000
*    3 LCBFLAG2    CHAR(1),             /* IDS FLAGS 2       @Y17XAXF*/ 54990000
*    3 LCBSNS   BIT(16),                /* SENSE BYTES       @G36XRXG*/ 55030000
*      4 LCBSENS0    CHAR(1),           /* SENSE BYTE 0      @G36XRXG*/ 55080000
*        5 LCBCMDRJ   BIT(1),           /*  COMMAND REJECT   @G36XRXG*/ 55170000
*        5 LCBINTRQ   BIT(1),           /*  INTERVENTION REQ @G36XRXG*/ 55260000
*        5 LCBBUSCK   BIT(1),           /*  BUSOUT CHECK     @G36XRXG*/ 55350000
*        5 LCBEQUCK   BIT(1),           /*  EQUIPMENT CHECK  @G36XRXG*/ 55440000
*        5 LCBDATCK   BIT(1),           /*  DATA CHECK       @G36XRXG*/ 55530000
*        5 LCBOVRUN   BIT(1),           /*  OVERRUN          @G36XRXG*/ 55620000
*        5 LCBLOSDT   BIT(1),           /*  LOST DATA        @G36XRXG*/ 55710000
*         6 LCBNOTIN   BIT(1),          /*  NOT INITIALIZED  @G36XRXG*/ 55800000
*        5 LCBTMOUT   BIT(1),           /*  TME-OUT EXCEEDED @G36XRXG*/ 55890000
*         6 LCBABORT   BIT(1),          /*  ABORT            @G36XRXG*/ 55980000
*      4 LCBSENS1    CHAR(1),           /* SENSE BYTE 1      @G36XRXG*/ 56070000
*    3 LCBECBCC    CHAR(1),             /* COMPLETION CODE   @Y17XAXF*/ 56160000
*     3 LCBECBPT  PTR(24),              /* ADDR OF ECB       @Y17XAXF*/ 56250000
*     3 LCBFLAG3  CHAR(1),              /* IDS FLAGS 3       @Y17XAXF*/ 56340000
*      4 *         BIT(2),              /*  RESERVED         @Y17XAXF*/ 56430000
*      4 LCBSOHR   BIT(1),              /*  SOH% R FLAG BIT  @Y17XAXF*/ 56520000
*      4 LCBRLAD   BIT(1),              /*  REAL ADDR IN CPA @Y17XAXF*/ 56610000
*      4 LCBSOHC   BIT(1),              /*  SOH% C FLAG BIT  @Y17XAXF*/ 56700000
*      4 LCBIOMSG  BIT(1),              /*  I/O MESS FLAG    @Y17XAXF*/ 56790000
*      4 LCBOBRRD  BIT(1),              /*  TPER REC PROC    @Y17XAXF*/ 56880000
*      4 LCBOBR    BIT(1),              /*  OBR REC FLAG     @Y17XAXF*/ 56970000
*     3 LCBCSW    CHAR(7) BDY(DWORD,2), /* LAST CSW          @Y17XAXF*/ 57060000
*      4 LCBCSWCA  PTR(24),             /*  CCW ADDR         @Y17XAXF*/ 57150000
*      4 LCBCSWST  BIT(16),             /*  STATUS           @Y17XAXF*/ 57240000
*       5 LCBCSWUS  BIT(8),             /*   UNIT STATUS     @Y17XAXF*/ 57330000
*        6 LCBUSAT  BIT(1),             /*    ATTENTION      @Y17XAXF*/ 57420000
*        6 LCBUSSM  BIT(1),             /*    STATUS MODF    @Y17XAXF*/ 57510000
*        6 LCBUSCUE BIT(1),             /*    CTL UNIT END   @Y17XAXF*/ 57600000
*        6 LCBUSBSY BIT(1),             /*    BUSY           @Y17XAXF*/ 57690000
*        6 LCBUSCE  BIT(1),             /*    CHANNEL END    @Y17XAXF*/ 57780000
*        6 LCBUSDE  BIT(1),             /*    DEVICE END     @Y17XAXF*/ 57870000
*        6 LCBUSUC  BIT(1),             /*    UNIT CHECK     @Y17XAXF*/ 57960000
*        6 LCBUSUE  BIT(1),             /*    UNIT EXCEPTION @Y17XAXF*/ 58050000
*       5 LCBCSWCS  BIT(8),             /*   CHANNEL STATUS  @Y17XAXF*/ 58140000
*        6 LCBCSPCI BIT(1),             /*    PRG CTL INT    @Y17XAXF*/ 58230000
*        6 LCBCSIL  BIT(1),             /*    INCORRECT LEN  @Y17XAXF*/ 58320000
*        6 LCBCSPGC BIT(1),             /*    PRG CHECK      @Y17XAXF*/ 58410000
*        6 LCBCSPTC BIT(1),             /*    PROTECTION CHK @Y17XAXF*/ 58500000
*        6 LCBCSCDC BIT(1),             /*    CHNL DATA CHK  @Y17XAXF*/ 58590000
*        6 LCBCSCCC BIT(1),             /*    CHNL CTL CHK   @Y17XAXF*/ 58680000
*        6 LCBCSICC BIT(1),             /*    INTERFACE CTL  @Y17XAXF*/ 58770000
*        6 LCBCSCHC BIT(1),             /*    CHAINING CHECK @Y17XAXF*/ 58860000
*      4 LCBCSWRC  FIXED(16),           /*  RESIDUAL COUNT   @Y17XAXF*/ 58950000
*     3 LCBSIOCC  BIT(8),               /* SIO CONDITION CDE @Y17XAXF*/ 59040000
*      4 *        BIT(2),               /*  RESERVED         @Y17XAXF*/ 59130000
*      4 LCBSIOC1 BIT(1),               /*  CONDITION CODE.. @Y17XAXF*/ 59220000
*      4 LCBSIOC2 BIT(1),               /*  SETTING FOR 3705 @Y17XAXF*/ 59310000
*      4 LCBAP1OL BIT(1),        /* ALTERNATE PATH 1 OFFLINE @Y17XAXG*/ 59400000
*      4 LCBAP2OL BIT(1),        /* ALTERNATE PATH 2 OFFLINE @Y17XAXG*/ 59490000
*      4 LCBAP3OL BIT(1),        /* ALTERNATE PATH 3 OFFLINE @Y17XAXG*/ 59580000
*      4 LCBAP4OL BIT(1),        /* ALTERNATE PATH 4 OFFLINE @Y17XAXG*/ 59670000
*     3 LCBSTART  PTR(24),              /* ADDR OF CHNL PRGM @Y17XAXF*/ 59760000
*   2 LCBDCBPT    PTR(31),               /* ADDRESS OF DCB   @Y17XAXF*/ 59850000
*    3 LCBPCILK PTR(31),                /* PCI LOCK FOR MP   @Y17XAXF*/ 59940000
*                                       /*  SYSTEM           @Y17XAXF*/ 60030000
*   2 LCBRCQCB    PTR(31),               /* QCB TO POST RECALLED        60120000
*                                           BUFFER TO        @Y17XAXF*/ 60210000
*    3 LCBRESTR    PTR(31),              /* ERROR MESSAGE DATA       */ 60300000
*     4 LCBCMDSV CHAR(1),               /* COMMAND CODE SAVE @OY18040*/ 60330000
*     4 * CHAR(3),                      /*                   @OY18040*/ 60360000
*                                        /*                  @Y17XAXF*/ 60390000
*   2 LCBTHSQ     FIXED(16),             /* TH SEQ NUMBER    @YM06118*/ 60430000
*    3 LCBINCAM    FIXED(15),            /* ERP RETRY COUNTS @YM06118*/ 60480000
*     4 LCBGETMN    BIT(1),              /* GETMAINED STORAGE AREA      60490000
*                                            EXIST IN 904I/904H         60500000
*                                                            @YM06118*/ 60510000
*     4 *            BIT(15),            /* RESERVED         @Y17XAXF*/ 60520000
*   2 LCBERRCT    FIXED(15),             /* IOS ERROR COUNTERS       */ 60570000
*    3 LCBTTBIN    FIXED(15),            /* TERM TO BE CONNECTED        60660000
*                                           INDEX                    */ 60750000
*   2 LCBUCBX     PTR(8),                /* UCB INDEX                */ 60840000
*   2 LCBLSPCI    PTR(24),               /* ADDR OF LAST SVRCD PCI   */ 60930000
*                                        /*                  @Y17XAXF*/ 61020000
*    3 LCBRCBFR    PTR(24),              /* POINTER TO RECALLED BUFFR*/ 61110000
*                                        /*                  @Y17XAXF*/ 61200000
*     4 LCBRDBFR    PTR(24),             /* START OF READ CHANNEL       61290000
*                                           PROGRAM          @Y17XAXF*/ 61380000
*   2 LCBRECOF    FIXED(15),             /* OFFSET INTO CURRENT BLOCK*/ 61470000
*   2 LCBSTATE    CHAR(2),               /* STATUS BITS              */ 61560000
*    3 LCBSTAT1    CHAR(1),              /* 1ST STATUS BYTE  @Y17XAXF*/ 61650000
*                                                                       61740000
*/*      BIT DEFINITIONS                                             */ 61830000
*                                                                       61920000
*     4 LCBRCLLN BIT(1),                 /* RECALL BEING PERFORMED   */ 62010000
*     4 LCBOCWTN BIT(1),                 /* NON-IMMEDIATE OPERATOR      62100000
*                                           COMMAND WAITING  @OY14092*/ 62190000
*     4 LCBOCNI  BIT(1),                 /* NON-IMMEDIATE OPERATOR      62280000
*                                           CONTROL OPERATION IN        62370000
*                                           PROGRESS                 */ 62460000
*     4 LCBINITN BIT(1),                 /* RECEIVING INITIATE          62550000
*                                           MODE MSG                 */ 62640000
*     4 LCBCONT  BIT(1),                 /* CONTINUE OR RESET           62730000
*                                           OPERATION                */ 62820000
*     4 LCBFREEN BIT(1),                 /* LINE FREE        @Y17XAXF*/ 62910000
*     4 LCBRECVN BIT(1),                 /* LINE IS RECEIV'G @Y17XAXF*/ 63000000
*     4 LCBSENDN BIT(1),                 /* LINE IS SENDING  @Y17XAXF*/ 63090000
*                                        /* BOTH SEND AND RECEIVE BITS  63180000
*                                           OFF INDICATE LINE STOPPED*/ 63270000
*                                                                       63360000
*    3 LCBSTAT2    BIT(8),              /* SECOND STAT BYTE  @Y17XAXF*/ 63450000
*                                                                       63540000
*/*      BIT DEFINITIONS                                             */ 63630000
*                                                                       63720000
*     4 LCBTRACE BIT(1),                /* I/O TRACE ACTIVE  @Y17XAXF*/ 63810000
*     4 LCBMSGNN BIT(1),                 /* MSGGEN/STARTUP MESSAGE   */ 63900000
*     4 LCBBEOTN BIT(1),                 /* EOT FROM BFRED TERM -       63990000
*                                           NO EOM                   */ 64080000
*      5 LCBCONNN BIT(1),                /* ERROR ON DAIL CONTACT       64110000
*                                                            @YM08436*/ 64140000
*     4 LCBSNDPR BIT(1),                 /* SEND PRIORITY SWITCH SET    64170000
*                                           SEND SCHEDULER           */ 64260000
*     4 LCBNEGRP BIT(1),                 /* NEQATIVE RESPONSE TO        64350000
*                                           POLLING RECEIVED         */ 64440000
*     4 LCBSYNC  BIT(1),                 /* LINE IS BISYNC           */ 64530000
*      5 LCBATTN  BIT(1),               /* 3705 ATTEN RECEIV @Y17XAXF*/ 64620000
*     4 LCBDIAL  BIT(1),                 /* DIAL LCB                 */ 64710000
*      5 LCBBFRAV BIT(1),                /* 3705 BUFFER AVAILABLE       64800000
*                                                            @Y17XAXF*/ 64890000
*     4 LCBRESP  BIT(1),                 /* A RESPONSE IS OWED       */ 64980000
*                                        /*                  @Y17XAXF*/ 65070000
*                                                                       65160000
*   2 LCBTSTSW    CHAR(1),               /* TEST-AND-SET SWITCH      */ 65250000
*                                                                       65340000
*/*      BIT DEFINITIONS                                             */ 65430000
*                                                                       65520000
*    3 LCBCONCT BIT(1),                  /* CONNECTION ESTABLISHED   */ 65610000
*    3 *        BIT(1),                  /* RESERVED                 */ 65700000
*    3 *        BIT(1),                  /* RESERVED                 */ 65790000
*    3 *        BIT(1),                  /* RESERVED                 */ 65880000
*    3 *        BIT(1),                  /* RESERVED                 */ 65970000
*    3 *        BIT(1),                  /* RESERVED                 */ 66060000
*    3 *        BIT(1),                  /* RESERVED                 */ 66150000
*    3 *        BIT(1),                  /* RESERVED                 */ 66240000
*   2 LCBRECAD    PTR(24),               /* ADDRESS CURRENT MSG BLOCK*/ 66330000
*                                        /*                  @Y17XAXF*/ 66420000
*   2 LCBERB      PTR(31),               /* ERB              @Y17XAXF*/ 66510000
*    3 LCBERBKY    CHAR(1),              /* ELEMENT REQUEST BLOCK KEY*/ 66600000
*    3 LCBERBQB    PTR(24),              /* ERB QCB          @Y17XAXF*/ 66690000
*   2 LCBERBPY    CHAR(1),               /* ERB PRIORITY             */ 66780000
*   2 LCBERBLK    PTR(24),               /* ADDR NEXT ITEM IN CHAIN  */ 66870000
*                                        /*                  @Y17XAXF*/ 66960000
*   2 LCBERBST    CHAR(1),               /* STATUS OF ERB            */ 67050000
*                                           /* X'08' BIT MUST NEVER BE  67140000
*                                           ON IN THE STATUS BYTE.      67230000
*                                           IT MUST REMAIN THE 9TH BYTE 67320000
*                                           OF THE ERB               */ 67410000
*                                                                       67500000
*/*      BIT DEFINITIONS                                             */ 67590000
*                                                                       67680000
*    3 LCBMSG   BIT(1),                  /* END OF INIT MODE TO HM   */ 67770000
*    3 LCBEOMSG BIT(1),                  /* END OF MSG READ FROM DISK*/ 67860000
*    3 LCBRDERR BIT(1),                  /* LOGICAL READ ERROR       */ 67950000
*    3 LCBINQ   BIT(1),                  /* ERB IS WAITING FOR BFRS  */ 68040000
*   3  LCBLOGDV BIT(1),                 /* LOGGING REQUESTED @OY20488*/ 68130082
*    3 LCBERROR BIT(1),                  /* ERROR ON SEND SIDE       */ 68220000
*    3 LCBPRCPG BIT(1),                  /* AFTER INITIAL REQUEST IS    68310000
*                                           SATISFIED, ERB WILL BE      68400000
*                                           POSTED TO QCB INDICATED IN  68490000
*                                           LCBRCQCB                 */ 68580000
*    3 LCBDLNKN BIT(1),                  /* DELINK SWITCH            */ 68670000
*                                        /* ON - ERB NOT POSTED &       68760000
*                                           ERB CAN BE POSTED        */ 68850000
*     4 LCBCOMPL BIT(1),                 /* DISK REQUEST IS COMPLETE    68940000
*                                       PCI CAN NOT POST ERB         */ 69030000
*   2 LCBERBCH    PTR(24),               /* ADDR CHAIN ASSIGNED BFRS */ 69120000
*                                        /*                  @Y17XAXF*/ 69210000
*   2 LCBERBCT    FIXED(15),             /* COUNT FIELDS             */ 69300000
*    3 LCBRBCT1    CHAR(1),             /*  ENABLED CNT FLDS @Y17XAXF*/ 69390000
*    3 LCBRBCT2    CHAR(1),             /*  DISABLED CNT FLD @Y17XAXF*/ 69480000
*      4 LCBDCNT    BIT(1),             /*   DISABLE CNT USE @Y17XAXF*/ 69570000
*      4 *          BIT(7),             /*   RESERVED        @Y17XAXF*/ 69660000
*   2 LCBTTCIN    FIXED(16),             /* TERM CURR CONNECTED INDEX*/ 69750000
*                                        /*                  @Y17XAXF*/ 69840000
*   2 LCBMSGFM    CHAR(1),               /* BITS TO CONTROL BSC LINE */ 69930000
*                                                                       70020000
*/*      BIT DEFINITIONS                                             */ 70110000
*                                                                       70200000
*    3 LCBNAK   BIT(1),                  /* REQUEST TO SEND NAK RESP */ 70290000
*    3 LCBACKI  BIT(1),                  /* ACK COUNTER -SEND/RECEIVE*/ 70380000
*                                        /* FOLLOWING TWO BITS INDICATE 70470000
*                                           WHETHER A SCAN OF LINE      70560000
*                                           CONTROL HAS BEEN            70650000
*                                           ACCOMPLISHED AND TYPE OF    70740000
*                                           LINE CONTROL RECEIVED.   */ 70830000
*    3 LCBVSTRT BIT(1),                  /* VALID START SEQUENCE     */ 70920000
*    3 LCBRSTRT BIT(1),                  /* ERROR START SEQUENCE     */ 71010000
*    3 LCBTTD   BIT(1),                  /* TTD RECEIVED             */ 71100000
*    3 LCBENQ   BIT(1),                  /* ENQ RECEIVED             */ 71190000
*    3 LCBEOT   BIT(1),                  /* EOT FIRST CHARACTER      */ 71280000
*    3 LCBOLT   BIT(1),                  /* TOTE REQUEST             */ 71370000
*   2 LCBSCBA     PTR(24),               /* ADDRESS OF CURRENT SCB   */ 71460000
*                                        /*                  @Y17XAXF*/ 71550000
*   2 LCBOBRCH    PTR(31),               /* 3705 OBR CHAIN   @Y17XAFF*/ 71640000
*    3 LCBERMSK   CHAR(1),               /* ERROR RECORDING MASK     */ 71730000
*    3 LCBINVPT PTR(24),                 /* ADDR CURRENT ENTRY IN       71820000
*                                           INVITATION LIST  @Y17XAXF*/ 71910000
*      4 LCBBFRW  PTR(24),              /* ADDR OF BSC STAT  @Y17XAXF*/ 72000000
*                                       /*  PENDING BUFFER   @Y17XAXF*/ 72090000
*       5 LCBNXCMD CHAR(3),             /*  SNA COMMAND TYPE @Y17XAXF*/ 72180000
*/*                                                          @Y17XAXF*/ 72270000
*/*      PLCB STATUS INFO                                    @Y17XAXF*/ 72360000
*/*                                                          @Y17XAXF*/ 72450000
*   2 LCBTPCD    CHAR(12) BDY(DWORD,5), /* TP OP CODES       @Y17XAXF*/ 72540000
*     4 LCBSTAT5   CHAR(1),             /*  5TH STATUS BYTE  @Y17XAXF*/ 72630000
*       5 LCBPERM   BIT(1),             /*   PLCB PERMANENTY @Y17XAXF*/ 72720000
*                                       /*    ASSIGNED       @Y17XAXF*/ 72810000
*       5 LCBLUNIT  BIT(1),             /*   SNA LOG UNIT    @Y17XAXF*/ 72900000
*       5 LCBLUS    BIT(1),             /*   RETURN PLCB TO LUS         72990000
*                                                            @Y17XAXF*/ 73080000
*       5 *         BIT(5),             /*   RESERVED        @Y17XAXF*/ 73170000
*     4 LCBBFRSV   PTR(24),             /*  PTR TO SAVED BUF @Y17XAXF*/ 73260000
*                                       /*   CHAIN           @Y17XAXF*/ 73350000
*     4 LCBSTAT6   BIT(8),              /*  SNA STATUS       @Y17XAXF*/ 73440000
*       5 LCBCHN    BIT(4),             /*   CHAINING STATE             73530000
*                                                            @Y17XAXF*/ 73620000
*       5 LCBHDRPD  BIT(1),             /*   ON-HDR HAS BEEN POSTED TO  73980000
*                                               MH                      74070000
*                                           OFF-HDR HAS NOT BEEN POSTED 74160000
*                                               TO MH        @Y17XAXF*/ 74250000
*       5 LCBRTRRO  BIT(1),             /*   RESPONSE OWED TO RTR       74340000
*                                                            @Y17XAXF*/ 74430000
*       5 LCBMHBID  BIT(1),             /*   BID COMMAND TO BE BUILT    74520000
*                                                            @Y17XAXF*/ 74610000
*       5 LCBINPAK  BIT(1),             /*   ON-IN PACK STATE           74700000
*                                            OFF-BETWEEN PACK STATE     74730000
*                                                            @Y17XAXF*/ 74760000
*     4 LCBWAITC   PTR(24),             /*  PIU WAIT CHAIN   @Y17XAXF*/ 74790000
*     4 LCBRSPSV   PTR(31),             /*  PTR TO SAVED RSP @Y17XAXF*/ 74880000
*                                       /*   BUFFER          @Y17XAXF*/ 74970000
*      5 LCBBFSNS CHAR(4),              /* BIND-FAILED SENSE DATA       75000000
*                                                            @Y17XAXF*/ 75030000
*/*                                                          @Y17XAXF*/ 75060000
*/*      SAVE AREA FOR SENSE                                 @Y17XAXF*/ 75150000
*/*                                                          @Y17XAXF*/ 75240000
*   2 LCBSAVSN CHAR(8),                 /* SAVE SENSE        @Y17XAXF*/ 75330000
*     3 LCBSNSV  CHAR(1),               /*  SAVEAREA FOR SEN @Y17XAXF*/ 75420000
*     3 LCBCSWSV CHAR(7),               /*  SAVEAREA FOR CSW @Y17XAXF*/ 75510000
*   2 LCBERCCW    CHAR(24) BDY(DWORD),   /* 3 ERP COMMANDS           */ 75600000
*    3 *           CHAR(8),              /*                  @G36XRXG*/ 75690000
*    3 LCBATL05 CHAR(8),                 /* 3705 ATTN ELEMENT@G36XRXG*/ 75700000
*    3 *           CHAR(8),              /*                  @G36XRXG*/ 75710000
*   2 LCBCPA    CHAR(80),                /*CHANNEL PRG AREA  @Y17XAXF*/ 75780000
*    3 LCBCCW1     CHAR(8),              /*                  @Y17XAXF*/ 75870000
*    3 LCBCCW2     CHAR(8),              /* C C W            @Y17XAXF*/ 75960000
*    3 LCBCCW3     CHAR(8),              /*                  @Y17XAXF*/ 76050000
*    3 LCBCCW4     CHAR(8),              /* B U I L D        @Y17XAXF*/ 76140000
*    3 LCBCCW5     CHAR(8),              /*                  @Y17XAXF*/ 76230000
*      4 LCBATTEL   CHAR(8),             /* LOCAL ATTN ELEM  @G36XRXG*/ 76250000
*        5 LCBQEBPL  CHAR(8),            /* QEB PARM LIST    @ZM46675*/ 76260000
*          6 LCBSIO  CHAR(1),            /* QEB FUNC CODE    @ZM46675*/ 76270000
*          6 LCBIOSB PTR(24),            /* IOSB PTR         @ZM46675*/ 76280000
*          6 LCBCP   PTR(31),            /* CHAN PGM START   @ZM46675*/ 76290000
*    3 LCBCCW6     CHAR(8),              /* A R E A          @Y17XAXF*/ 76320000
*    3 LCBCCW7     CHAR(8),              /*                  @Y17XAXF*/ 76410000
*    3 LCBCCW8     CHAR(8),              /*                  @Y17XAXF*/ 76500000
*    3 LCBCCW9     CHAR(8),              /*                  @Y17XAXF*/ 76590000
*    3 LCBCCW10    CHAR(8);              /*                  @Y17XAXF*/ 76680000
*/*                                                          @Y17XAXF*/ 76770000
*/*      SNA RESPONSE INFO                                   @Y17XAXF*/ 76860000
*/*                                                          @Y17XAXF*/ 76950000
* DECLARE                               /*                   @Y17XAXF*/ 77040000
*   1 LCBRSPIN CHAR(19) DEFINED(LCBIOBSN), /*SNA RSP INFO    @Y17XAXF*/ 77130000
*     2 LCBDSCRJ BIT (1),             /* DISCONNECT OUTSTNDG @OY20411*/ 77220082
*     2 * BIT (7),                    /* RESERVED            @OY20411*/ 77230082
*     2 LCBSNS0  BIT(8),                /* SAME BYTE AS LCBSENS0 -      77250000
*                                          MUST BE 0 FOR SNA @YM06118*/ 77280000
*     2 LCBRHSV  CHAR(3),               /* RESPONSE RH       @Y17XAXF*/ 77310000
*     2 LCBLUSNS CHAR(4),               /* RESPONSE SENSE    @Y17XAXF*/ 78840000
*        3 LCBSMAJ BIT(8),              /* MAJOR SENSE BYTE  @Y17XAXG*/ 78930000
*        3 LCBSMIN BIT(8),              /* MINOR SENSE BYTE  @Y17XAXG*/ 79020000
*        3 LCBUSER BIT(16),             /* USER SENSE BYTES  @Y17XAXG*/ 79110000
*     2 LCBSCPRS CHAR(3),               /* SSCP RESPONSE BYTES          79200000
*                                                            @Y17XAXF*/ 79220000
*      3 LCBDFCMD CHAR(1),              /* DFC CMD RSP BYTE  @Y17XAXF*/ 79240000
*      3 *        BIT(8),               /* RESERVED          @Y17XAXF*/ 79260000
*      3 LCBCSWU1 BIT(8),               /* SAME BYTE AS LCBCSWUS        79264000
*                                                            @Y17XAXF*/ 79268000
*       4 *        BIT(7),              /* RESERVED          @Y17XAXF*/ 79272000
*       4 LCBUSUE1 BIT(1),              /* SAME BIT AS LCBUSUE          79276000
*                                           INDICATES END OF MSG        79280000
*                                           SENT OR RCV'D    @Y17XAXF*/ 79284000
*     2 *        CHAR(3),               /* RESERVED          @Y17XAXF*/ 79290000
*     2 LCBRSPFG CHAR(1),               /* FLAG BYTE USED IN @Y17XAXG*/ 79330000
*                                       /* RESP GENERATION   @Y17XAXG*/ 79380000
*        3 LCBEXPI BIT(1),              /* RESP EXPEDITED    @Y17XAXG*/ 79470000
*        3 LCBRSRH BIT(1),              /*EXCEP'N RESP GEN'D @YM07705*/ 79510000
*        3 *       BIT(6),              /* RESERVED          @YM07705*/ 79560000
*     2 LCBPAKCH PTR(24);               /* PACK BUFFER CHAIN @Y17XAXF*/ 79740000
*/*                                                          @Y17XAXF*/ 79830000
*/*      3705 CORE QUEUE INFO                                @Y17XAXF*/ 79920000
*/*                                                          @Y17XAXF*/ 80010000
* DECLARE                               /*                   @Y17XAXF*/ 80100000
*   1 LCBCOREQ CHAR(12) DEFINED(LCBTPCD), /* 3705 CORE QUEUE @Y17XAXF*/ 80190000
*     2 LCBCQELE PTR(31),               /* ELEMENT CHAIN     @Y17XAXF*/ 80280000
*     2 LCBCQLNK PTR(31),               /* LINK              @Y17XAXF*/ 80370000
*     2 LCBWRSCH PTR(31);               /* ADDR OF WRT SCHD  @Y17XAXF*/ 80460000
*                                       /*   STCB            @Y17XAXF*/ 80550000
*/*                                                          @YM08062*/ 80560000
*/*  THE FOLLOWING FIELDS EXIST FOR PLCB'S ONLY              @YM08062*/ 80570000
*/*                                                          @YM08062*/ 80580000
*DECLARE                                                                80590000
*  1 *    CHAR(8) DEF(LCBCPA) POS(41),  /*                   @YM08062*/ 80600000
*    2 * FIXED(8),                      /*                   @YM08062*/ 80610000
*    2 LCBNCPPT PTR (24),               /* NCP TTE ADDRESS   @YM08062*/ 81920000
*    2 *       CHAR(4);                 /* RESERVED          @YM08062*/ 81930000
*/*  ================================================================*/ 81940000
*/*      IGG019RP USES LCB+X'73' TO LCB+ X'97' AS WORK AREA          */ 81950000
*/*  ================================================================*/ 81960000
*/*                                                          @YM08142*/ 81962000
*/*   IEDQNX INTERFACE AREA (3705 LCB ONLY)                  @YM08142*/ 81964000
*/*                                                          @YM08142*/ 81966000
* DECLARE                               /*                   @YM08142*/ 81970000
*   1 LCBQNX    CHAR(24) DEFINED(LCBERCCW), /*               @YM08142*/ 81971000
*     2 LCBQNXMN FIXED(8),              /* MESSAGE NUMBER    @YM08142*/ 81972000
*       3 LCBNX064 BIT(1),              /* FLAG TO WRITE MESSAGE        81973000
*                                          IED064I           @YM08142*/ 81974000
*       3 LCBNX142 BIT(1),              /* FLAG TO WRITE MESSAGE        81975000
*                                          IED142I           @YM08142*/ 81976000
*       3 LCBNX162 BIT(1),              /* FLAG TO WRITE MESSAGE        81977000
*                                          IED162I           @YM08142*/ 81978000
*       3 LCBNX509 BIT(1),              /* FLAG TO WRITE MESSAGE        81979000
*                                          IED509I           @YM08142*/ 81980000
*       3 *        BIT(4),              /* RESERVED          @YM08142*/ 81981000
*     2 LCBSTSAV PTR(24),               /* SAVE AREA FOR LCBSTART       82080000
*                                           DURING RETRY     @Y17XAXF*/ 82170000
*     2 *        CHAR(1),               /* RESERVED          @ZM46833*/ 82260000
*     2 LCBIOSBS PTR(24),               /* SAVE IOSB PTR     @ZM46833*/ 82280000
*     2 *        CHAR(8),               /* RESERVED          @ZM46833*/ 82300000
*     2 LCBDSTEA PTR(31),               /* DEV STATISTICS TAB ENTRY     82350000
*                                           ADDRESS          @Y17XAXF*/ 82440000
*     2 LCBUASZE FIXED(8),              /* UNIT NAME ADDRESS SIZE       82530000
*                                                            @Y17XAXF*/ 82620000
*     2 LCBUNADD PTR(24);               /* UNIT NAME ADDRESS @Y17XAXF*/ 82710000
*                                                         /* @Y17XAXF*/ 82800000
*/*                                                          @Y17XAXF*/ 82890000
*/*      RH CANCEL INFO                                      @Y17XAXF*/ 82980000
*/*                                                          @Y17XAXF*/ 83070000
* DECLARE                               /*                   @Y17XAXF*/ 83160000
*   1 LCBCANCL  CHAR(5) DEFINED(LCBSAVSN), /* CANCEL INFO    @YM08062*/ 83250000
*     2 LCBCANFG BIT(8),                /* CANCEL RH FLAG    @Y17XAXF*/ 83340000
*       3 LCBCANXT BIT(1),              /*  CANCEL MUST BE RESPONDED    83430000
*                                            TO              @Y17XAXF*/ 83520000
*       3 LCBCANEB BIT(1),              /*  CAN END BKT      @Y17XAXF*/ 83610000
*       3 *        BIT(1),              /*  RESERVED         @Y17XAXF*/ 83700000
*       3 LCBCANCD BIT(1),              /*  CAN CHGE DIR     @Y17XAXF*/ 83790000
*       3 *        BIT(4),              /*  RESERVED         @Y17XAXF*/ 83880000
*     2 LCBCANTH CHAR(2),               /* CAN TH SEQ        @Y17XAXF*/ 83970000
*     2 *        CHAR(2);               /* RESERVED          @YM08062*/ 84060000
*/*                                                          @Y17XAXF*/ 84151000
*/*      USED WITH LCBFLAG1                                  @Y17XAXF*/ 84152000
*/*                                                          @Y17XAXF*/ 84153000
* DCL LCBPLCB BIT(8) CONSTANT('00'X);   /* PLCB INDICATOR    @Y17XAXF*/ 84154000
*                                                                       84155000
*/*                                                          @Y17XAXF*/ 84240000
*/*      VALUES USED WITH LCBCHN                             @Y17XAXF*/ 84330000
*/*                                                          @Y17XAXF*/ 84420000
* DECLARE                                                 /* @Y17XAXF*/ 84510000
*/*                                                          @Y17XAXF*/ 84600000
*/*      THE FOLLOWING VALUES ARE VALID ONLY WHEN LCBRECVN=1 @Y17XAXF*/ 84690000
*/*            OR LCBSENDN=1                                 @Y17XAXF*/ 84780000
* LCBBETC   BIT(4) CONSTANT('0000'B),   /* BETWEEN CHAIN STATE WAITING  84870000
*                                          FOR NO RESPONSE   @Y17XAXF*/ 84960000
* LCBINC    BIT(4) CONSTANT('0001'B),   /* IN CHAIN STATE               85050000
*                                                            @Y17XAXF*/ 85140000
* LCBPURG   BIT(4) CONSTANT('0010'B),   /* PURGING CHAIN STATE          85230000
*                                                            @Y71XAXF*/ 85320000
* LCBWMG    BIT(4) CONSTANT('0011'B),    /* BETWEEN CHAIN-WAITING FOR   85360000
*                                          MSGGEN RSP STATE  @Y17XAXF*/ 85500000
*/*                                                          @Y17XAXF*/ 85509000
*/*      THE FOLLOWING VALUES ARE VALID ONLY WHEN LCBRECVN=1 @Y17XAXF*/ 85518000
*/*                                                          @Y17XAXF*/ 85527000
* LCBWERAS  BIT(4) CONSTANT('0111'B),   /* BETWEEN CHAIN STATE-WAITING  85536000
*                                          FOR SCREEN ERASURE RESPONSE  85545000
*                                          (TSO STATE ONLY)  @Y17XAXF*/ 85554000
* LCBWSMI   BIT(4) CONSTANT('1000'B),    /* BETWEEN CHAIN STATE-        85563000
*                                          WAITING START MI RESPONSE    85572000
*                                          (TSO STATE ONLY)  @Y17XAXF*/ 85581000
*/*                                                          @Y17XAXF*/ 85590000
*/*      THE FOLLOWING VALUES ARE VALID ONLY WHEN LCBSENDN=1 @Y17XAXF*/ 85680000
*/*                                                          @Y17XAXF*/ 85770000
* LCBWFMD   BIT(4) CONSTANT('0100'B),   /* BETWEEN CHAIN STATE WAITING  85860000
*                                          FM DATA RSP STATE            85950000
*                                                            @Y17XAXF*/ 86040000
* LCBWCAN   BIT(4) CONSTANT('0101'B),   /* BETWEEN CHAIN STATE WAITING  86130000
*                                          FOR CANCEL RSP STATE         86220000
*                                                            @Y17XAXF*/ 86310000
* LCBWBID   BIT(4) CONSTANT('0110'B);   /* BETWEEN CHAIN STATE WAITING  86400000
*                                          FOR BID RSP STATE            86490000
*                                                            @Y17XAXF*/ 86580000
*                                                                       86670000
*/*                                                          @Y17XAXF*/ 86760000
*/*      VALUES FOR LCBECBCC                                 @Y17XAXF*/ 86850000
*/*                                                          @Y17XAXF*/ 86940000
* DECLARE                               /*                   @Y17XAXF*/ 87030000
*    LCBECB41 BIT(8) CONSTANT('41'X),   /* PERMANENT ERR     @Y17XAXF*/ 87120000
*    LCBECB48 BIT(8) CONSTANT('48'X),   /* I/O END W/ HALT   @Y17XAXF*/ 87210000
*    LCBECB7F BIT(8) CONSTANT('7F'X);   /* NORMAL COMPLETION @Y17XAXF*/ 87300000
*                                                                       87390000
*        DCL   LCBXPTR REG(5) PTR(24);                                  87480000
*DECLARE                                                                87570000
*  1 IEDQLCBX  BDY(DWORD) BASED(LCBXPTR), /* LCB EXTENSION     S99228*/ 87660000
*   2 LCBXCON  BDY(DWORD),              /* START OF CNTRL FLDS S99228*/ 87750000
*    3 LCBXFLAG CHAR(1),                /* DEV DEP FLAGS       S99228*/ 87840000
*/*      BIT DEFINITIONS                                       S99228*/ 87930000
*     4 *       BIT(1),                 /* RESERVED            S99228*/ 88020000
*     4 *       BIT(1),                 /* RESERVED            S99228*/ 88110000
*     4 *       BIT(1),                 /* RESERVED            S99228*/ 88200000
*     4 *       BIT(1),                 /* RESERVED            S99228*/ 88290000
*     4 LCBGPCTV  BIT(1),               /* ETX RECD GEN POLL   S99228*/ 88380000
*     4 LCBSRCPF   BIT(1),              /* SOURCE DETERM PERFORMED      88470000
*                                                              S99228*/ 88560000
*     4 LCBERPND  BIT(1),               /* SOH % R MSG PENDING S99228*/ 88650000
*     4 *       BIT(1),                 /* RESERVED            S99228*/ 88740000
*    3 LCBXDCT CHAR(3),                 /* DCT STORAGE AREA    S99228*/ 88830000
*     4 LCBDCT1 CHAR(1),                /* DCT BYTE 1          S99228*/ 88920000
*     4 LCBDCT2 CHAR(1),                /* DCT BYTE 2          S99228*/ 89010000
*     4 LCBDCT3 CHAR(1),                /* DCT BYTE 3          S99228*/ 89100000
*    3 LCBXRADR PTR(31),                /* ERP POLL CHAR ADD @Y17XAXF*/ 89190000
*     4 LCBPCIRC PTR(8),                /* 3270 LOCAL PCI RETRY         89280000
*                                       CNTR                   S99228*/ 89370000
*     4 LCBERADR PTR(24);               /* POLL CHARS ADDR FLD S99228*/ 89460000
*                                                                       89550000
*                                                                       89640000
*%LCBPLCBL='LENGTH(IEDQLCB)             /* LENGTH OF PLCB    @YM08062*/ 89730000
*          -LENGTH(LCBCPA)+48';                                         89820000
*DCL LCBPRFSZ BIT(8) CONSTANT('20'X);   /* LCB PREFIX SIZE   @Y17XAXF*/ 89910000
*DCL LCBERBFS BIT(8) CONSTANT('4C'X);   /* OFFSET INTO LCB OR ERB       90000000
*                                                            @Y17XAXF*/ 90090000
*/*                                                                  */ 90180000
*/*       *******************************************************    */ 90270000
*/*   0   *   KEY    **                    QCBA                 *    */ 90360000
*/*       *******************************************************    */ 90450000
*/*   4   *   PRI    **                    LINK                 *    */ 90540000
*/*       *******************************************************    */ 90630000
*/*   8   *   RSKEY  **                        STCBA            *    */ 90720000
*/*       *******************************************************    */ 90810000
*/*  12   *   RSPRI  **                        RSLNK            *    */ 90900000
*/*       *******************************************************    */ 90990000
*/*  16   *         EOLDT          **    TDL     **    TSOB     *    */ 91080000
*/*       *******************************************************    */ 91170000
*/*  20   *   CHAIN  **                        INSRC            *    */ 91260000
*/*       *******************************************************    */ 91350000
*/*  24   *   NTXT   **                     SCBDA               *    */ 91440000
*/*       *******************************************************    */ 91530000
*/*  28   *   ISZE   **                  FSBFR/LSBFR            *    */ 91620000
*/*       *******************************************************    */ 91710000
*/*  32   *   FLAG1  **   FLAG2    **   SENS0    **   SENS1     *    */ 91800000
*/*       *******************************************************    */ 91890000
*/*  36   *   ECBCC  **                        ECBPT            *    */ 91980000
*/*       *******************************************************    */ 92070000
*/*  40   *   FLAG3  **                         CSW             *    */ 92160000
*/*       *******************************************************    */ 92250000
*/*  44   *                       CSW                           *    */ 92340000
*/*       *******************************************************    */ 92430000
*/*  48   *   SIOCC  **                        START            *    */ 92520000
*/*       *******************************************************    */ 92610000
*/*  52   *                      DCBPT                          *    */ 92700000
*/*       *******************************************************    */ 92790000
*/*  56   *                   RCQCB/RESTR                       *    */ 92880000
*/*       *******************************************************    */ 92970000
*/*  60   *        INCAM           **       ERRCT/TTBIN         *    */ 93060000
*/*       *******************************************************    */ 93150000
*/*  64   *   UCBX   **                    RCBFR/LSPCI          *    */ 93240000
*/*       *******************************************************    */ 93330000
*/*  68   *         RECOF          **          STATE            *    */ 93420000
*/*       *******************************************************    */ 93510000
*/*  72   *   TSTSW  **                 RECAD                   *    */ 93600000
*/*       *******************************************************    */ 93690000
*/*  76   *   ERBKY  **                 ERBQB                   *    */ 93780000
*/*       *******************************************************    */ 93870000
*/*  80   *   ERBPY  **                 ERBLK                   *    */ 93960000
*/*       *******************************************************    */ 94050000
*/*  84   *   ERBIN  **                 ERBCH                   *    */ 94140000
*/*       *******************************************************    */ 94230000
*/*  88   *        ERBCT           **          TTCIN            *    */ 94320000
*/*       *******************************************************    */ 94410000
*/*  92   *  MSGFM   **                        SCBA             *    */ 94500000
*/*       *******************************************************    */ 94590000
*/*  96   *   ERMSK  **                        INVPT            *    */ 94680000
*/*       *******************************************************    */ 94770000
*/* 100   *                      TPCD                           *    */ 94860000
*/*       *******************************************************    */ 94950000
*/* 104   *                      TPCD                           *    */ 95040000
*/*       *******************************************************    */ 95130000
*/* 108   *                      TPCD                           *    */ 95220000
*/*       *******************************************************    */ 95310000
*/* 112   *   SNSV   **                        CSWSV            *    */ 95400000
*/*       *******************************************************    */ 95490000
*/* 116   *                      CSWSV                          *    */ 95580000
*/*       *******************************************************    */ 95670000
*/* 120   *                      ERCCW                          *    */ 95760000
*/*       *******************************************************    */ 95850000
*/* 124   *                                                     *    */ 95940000
*/*       *******************************************************    */ 96030000
*/* 128   *                                                     *    */ 96120000
*/*       *******************************************************    */ 96210000
*/* 132   *                                                     *    */ 96300000
*/*       *******************************************************    */ 96390000
*/* 136   *                                                     *    */ 96480000
*/*       *******************************************************    */ 96570000
*/* 140   *                                                     *    */ 96660000
*/*       *******************************************************    */ 96750000
*/*                                                                  */ 96840000
./  ADD  SSI=62120491,NAME=TLGBD
*        %GOTO BSLLGB;                                     /*           01000022
         MACRO                                                          02000022
         TLGBD                                                          03000022
.*A-000000-999999                                              @X31X8X0 03500010
.*A120000,200000,860000                                        @Y17XAXF 03600010
.*C050000-080000,210000-230000,440000,490000-520000            @Y17XAXF 03700010
.*C560000,670000,680000-700000,830000,370000                   @Y17XAXF 03800010
IEDNLGB  DSECT                                                          04000022
         ORG   *+17                                                     05000010
LGBTYPE  DS    XL1'00' .                LGB INDICATOR          @Y17XAXF 05800010
LGBGRP   EQU   X'00' .                    GROUP INDICATOR      @Y17XAXF 06600010
LGBSUBST DS    CL2 .                    TNT OFFSET TO 1ST LINE @Y17XAXF 07400010
*                                         WITHIN THIS GROUP    @Y17XAXF 08200010
LGBBUFOU DS    FL1 .                    NUMBER OF BUFFERS ASSIGNED      09000022
*                                       INITIALLY FOR SENDING           10000022
*                                       OPERATIONS FOR EACH LINE        11000022
*                                       IN THE LINE GROUP               12000022
LGBPREF  EQU   X'10'                    CORRESPONDING TRMPREF BIT       12100010
*                                        (SET BY GROUP MACRO)  @Y17XAXF 12200010
LGBMHA   DS    AL3 .                    ADDRESS OF THE MESSAGE          13000022
*                                       HANDLER FOR THIS LINE GROUP     14000022
         DS    FL1                      RESERVED                 X03039 15000010
LGBPCI   DS    XL1                      PCI OPTIONS              X03039 15200010
LGBPCIAO EQU   X'10'                    PCI=(,A) ADD ON OUTPUT   X03039 15400010
LGBPCINO EQU   X'04'                    PCI=(,N) NONE ON OUTPUT  X03039 15600010
LGBDSORG DS    XL2 .                    DATASET ORGANIZATION CODE=LG    16000022
LGBBUFMA DS    FL1 .                    MAXIMUM NUMBER OF BUFFERS       17000022
*                                       TO BE USED FOR DATA TRANSFER    18000022
*                                       FOR EACH TERMINAL ASSOCIATED    19000022
*                                       WITH THIS LINE                  20000022
LGBBYTE  DS    CL1 .                    FLAG BYTE              @Y17XAXF 20500010
LGBPACK  EQU   X'80' .                  PACK=YES SPECIFIED     @Y17XAXF 21700010
*        EQU   X'40'-X'01' .               RESERVED            @Y17XAXF 22400010
LGBOPACE DS    XL1 .                    OPACING VALUE          @Y17XAXF 23100010
         DS    CL1 .                    RESERVED               @Y17XAXF 23500010
         DS    XL1 .                    RESERVED                        24000022
*                                       SWITCHED LINE GROUP             25000022
LGBTRANS DS    AL3 .                    ADDRESS OF THE TRANSLATION      26000022
*                                       TABLE                           27000022
         ORG   IEDNLGB+40                                               27500000
LGBNAME  DS    CL8 .                    NAME OF LINE GROUP              28000022
LGBOFLGS DS    XL1 .                    OPEN FLAGS                      30000022
LGBOPEN  EQU   X'10'                    CORRESPONDING DCB OPEN FLAG     30300010
*                                       (SET BY GROUP MACRO)   @Y17XAXF 30600010
LGBSCTAD DS    AL3 .                    SPECIAL CHARACTERS TABLE        31000022
LGBILCT  DS    XL1 .                    NO. OF INVITATION LISTS         32000022
         ORG   IEDNLGB+54                                               33000022
LGBBUFSI DS    AL2 .                    BUFFER SIZE USED FOR SENDING    34000022
*                                       TO A TERMINAL IN THIS           35000022
*                                       LINE GROUP                      36000022
LGBRESER DS    0A .                     RESERVED IDLE COUNTS   @Y17XAXF 37000010
LGBRESV1 DS    AL1 .                     HDR IDLES             @Y17XAXF 37200010
LGBRESV2 DS    AL1 .                     TEXT IDLES            @Y17XAXF 37400010
LGBRESV3 DS    AL1 .                     RESERVED              @Y17XAXF 37600010
LGBRESV4 DS    AL1 .                     RESERVED              @Y17XAXF 37800010
LGBIVLST DS    A .                      ADDRESS OF INVITAION LIST       38000022
*                                       WHEN ID VERIFICATION IS         39000022
*                                       PERFORMED BY TCAM               40000022
LGBPRFSZ EQU   LGBBUFOU-IEDNLGB .       PREFIX SIZE            @Y17XAXF 40500010
         MEND  ,     */                                                 41000022
*%BSLLGB:  ;                                                            42000022
*DECLARE                                                                43000022
* 1 IEDNLGB BASED(IEDNLPTR) BDY(WORD),                     /*@Y17XAXF*/ 44000010
*/*                                                                  */ 45000022
*/*    THIS IS A DSECT OF THE LINE GROUP BLOCK. THERE IS AN LGB FOR  */ 46000022
*/*    EACH LINE GROUP IN THE TCAM-3705 SYSTEM                       */ 47000022
*/*                                                                  */ 48000022
*  2 *        CHAR(17),                 /* RESERVED          @Y17XAXF*/ 49000010
*  2 LGBTYPE  CHAR(1),                  /* GROUP TYPE IND    @Y17XAXF*/ 49800010
*  2 LGBSUBST FIXED(15),                /* TNT OFFSET TO 1ST @Y17XAXF*/ 50600010
*                                       /*   LINE WITHIN THIS@Y17XAXF*/ 51400010
*                                       /*   GROUP                   */ 52200010
*  2 LGBBUFOU PTR(8),                   /* NUMBER OF BUFFERS ASSG-      53000022
*                                          NED INITIALLY FOR SENDING    54000022
*                                          OPERATIONS FOR EACH LINE IN  55000022
*                                          THE LINE GROUP               56000010
*                                                            @Y17XAXF*/ 56300010
*    3 *        BIT(3),                 /* RESERVED          @Y17XAXF*/ 56400010
*    3 LGBPREF  BIT(1),                 /* CORRESPONDING TRMPREF BIT    56500010
*                                          (GET BY GROUP MACRO)         56600010
*                                                            @Y17XAXF*/ 56700010
*    3 *        BIT(4),                 /* BUFOUT                       56800010
*                                                            @Y17XAXF*/ 56900010
*  2 LGBMHA PTR(24) BDY(BYTE),          /* ADDRESS OF THE MESSAGE       57000022
*                                          HANDLER FOR THIS LINE        58000022
*                                          GROUP                     */ 59000022
*  2 * PTR(8),                          /* RESERVED            X03039*/ 60000010
*  2 LGBPCI CHAR(1),                    /* PCI OPTIONS         X03039*/ 60100010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60200010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60300010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60400010
*    3 LGBPCIAO BIT(1),                 /* PCI=(,A) A ON OUTPUTX03039*/ 60500010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60600010
*    3 LGBPCINO BIT(1),                 /* PCI=(,N) N ON OUTPUTX03039*/ 60700010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60800010
*    3 *        BIT(1),                 /* RESERVED            X03039*/ 60900010
*  2 LGBDSORG BIT(16),                  /* DATASET ORGANIZATION         61000022
*                                          CODE=LG                   */ 62000022
*  2 LGBBUFMA PTR(8),                   /* MAXIMUM NUMBER OF BUFFERS    63000022
*                                          TO BE USED FOR DATA TRANS-   64000022
*                                          FER FOR EACH TERMINAL        65000022
*                                          ASSOCIATED WITH THIS LINE    66000022
*                                          GROUP             @Y17XAXF*/ 67000010
*  2 LGBBYTE  CHAR(1),                  /* FLAG BYTE         @Y17XAXF*/ 67500010
*     3 LGBPACK  BIT(1),                /*  PACK=YES SPEC    @Y17XAXF*/ 68700010
*    3 *        BIT(7),                 /*  RESERVED         @Y17XAXF*/ 69400010
*  2 LGBOPACE FIXED(8),                 /* OPACING VALUE     @Y17XAXF*/ 70100010
*  2 *        CHAR(1),                  /* RESERVED          @Y17XAXF*/ 70500010
*  2 *       CHAR(1),                   /* RESERVED                  */ 71000022
*  2 LGBTRANS PTR(24) BDY(BYTE),        /* ADDRESS OF THE TRANSLATION   72000022
*                                          TABLE                     */ 73000022
*  2 *        CHAR(4),                  /* RESERVED                  */ 73500000
*  2 LGBNAME  CHAR(8),                  /* NAME OF LINE GROUP        */ 74000022
*  2 LGBOFLGS BIT(8),                   /* OPEN FLAGS                */ 76000022
*   3 *        BIT(3),                  /* RESERVED          @Y17XAXF*/ 76100010
*   3 LGBOPEN  BIT(1),                  /* CORRESPONDING DCB OPEN FLAG  76200010
*                                          (SET BY GROUP MACRO)         76300010
*                                                            @Y17XAXF*/ 76400010
*   3 *        BIT(4),                  /* RESERVED          @Y17XAXF*/ 76500010
*  2 LGBSCTAD PTR(24),                  /* SPECIAL CHARACTERS TABLE  */ 77000022
*  2 LGBILCT PTR(8),                    /* NO. OF INVITATION LISTS   */ 78000022
*  2 *       CHAR(1),                   /* RESERVED                  */ 79000022
*  2 LGBBUFSI FIXED(15) BDY(BYTE),      /* BUFFER SIZE USED FOR SEND-   80000022
*                                          ING TO A TERMINAL IN THIS    81000022
*                                          LINE GROUP                */ 82000022
*  2 LGBRESER FIXED(32),                /* RESERVE IDLES CNT @Y17XAXF*/ 83000010
*   3 LGBRESV1 FIXED(8),                /*  HDR IDLES        @Y17XAXF*/ 83200010
*   3 LGBRESV2 FIXED(8),                /*  TEXT IDLES       @Y17XAXF*/ 83400010
*   3 LGBRESV3 FIXED(8),                /*  RESERVED         @Y17XAXF*/ 83600010
*   3 LGBRESV4 FIXED(8),                /*  RESERVED         @Y17XAXF*/ 83800010
*  2 LGBIVLST PTR(31);                  /* ADDRESS OF INVITATION LIST   84000022
*                                          WHEN TERMINAL ID VERIFICA-   85000022
*                                          TION IS PERFORMED BY TCAM */ 86000022
*/*                                                          @Y17XAXF*/ 88000010
*/*  VALUES FOR LGBTYPE                                      @Y17XAXF*/ 90000010
*/*                                                          @Y17XAXF*/ 92000010
*  DCL  LGBGRP  BIT(8)   CONSTANT('00'X);  /* GROUP IND      @Y17XAXF*/ 94000010
*/*                                                          @Y17XAXF*/ 95000010
*/*      PREFIX SIZE                                         @Y17XAXF*/ 96000010
*/*                                                          @Y17XAXF*/ 97000010
*  DCL LGBPRFSZ BIT(8)   CONSTANT('14'X); /* PREFIX SIZE     @Y17XAXF*/ 98000010
./  ADD  SSI=60840005,NAME=TMHTABD
*        %GOTO PLSMHTAB;                /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TMHTABD                                                        09000010
         SPACE                                                          12000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          15000010
.*A000000-999999                                               @Y17XAXU 18000010
         SPACE                                                          21000010
IEDMHTD DSECT                                                           24000010
*                                                                       27000010
*        DSECT FOR MH TABLE                                             30000010
*                                                                       33000010
MHTABEND DS    0XL1 .                   FLAG FIELD                      36000010
MHFLGE   EQU   X'FF'                    END OF TABLE INDICATOR          39000010
MHNAME   DS    CL8 .                    MH NAME                         42000010
MHENTRY  DS    A .                      MH ENTRY ADDRESS                45000010
MHTABLEN EQU   *-IEDMHTD .              LENGTH OF MH TABLE ENTRY        48000010
         SPACE 2                                                        51000010
         MEND                           */                              54000010
*%PLSMHTAB : ;                                                          57000010
*DECLARE                                                                60000010
*  1 IEDMHTD BDY(WORD) BASED(IEDQMHTP),                                 63000010
*/*                                                                  */ 66000010
*/*      DSECT FOR MH TABLE                                          */ 69000010
*/*                                                                  */ 72000010
*   2 MHNAME CHAR(8),                   /* MH NAME                   */ 75000010
*    3 MHTABEND CHAR(1),                /* FLAG FIELD                */ 78000010
*   2 MHENTRY PTR(31);                  /* MH ENTRY ADDRESS          */ 81000010
* %MHTABLEN='LENGTH(IEDMHTD)';          /* LEN OF MH TABLE ENTRY     */ 82000010
*DCL MHFLGE BIT(8) CONSTANT('FF'X);     /* END OF TABLE INDICATOR    */ 84000010
*                                                                       93000010
*%MHEND: ;                              /* END OF MH TABLE           */ 96000010
*                                                                       99000010
./  ADD  SSI=62470483,NAME=TMODD
*        %GOTO PLSMODD;                 /*                              00700010
         MACRO                                                          01400010
         TMODD                                                          02100010
.*A000000-999999                                               @Y17XAXF 02800010
IEDQMOD  DSECT                                                          03500010
*                                                                       04200010
*        MODE DEVICE DEPENDENT FIELDS                                   04900010
*                                                                       05600010
MODLNG   DS    XL1                      LENGTH OF MODE BYTE FIELDS      06300010
*                                        IN THE TTE DEVICE DEPENDENT    07000010
*                                        FIELDS                         07700010
MODCUR   DS    0XL2                     CURRENT MODE IN NCP             08400010
MODCUR1  DS    XL1                      CURRENT MODE BYTE 1             09100010
*        EQU   X'80'                     RESERVED                       09800010
MODCWERP EQU   X'40'                     OVERRIDE WRITE TEXT MODE ERPS  10500010
MODCRLGW EQU   X'20'                     REJECT LEADING GRAPHICS ON     11200010
*                                         WRITE OPERATIONS              11900010
MODCEIBD EQU   X'10'                     EIB DELETION(NON-TRANS-        12600010
*                                         PARENT ONLY)                  13300010
*        EQU   X'08'                     RESERVED                       14000010
MODCITFL EQU   X'04'                     INHIBIT TIME FILL/INHIBIT      14700010
*                                         WACK LINES                    15400010
MODCEMLC EQU   X'02'                     EMBEDDED LINE CONTROL(NON-     16100010
*                                         TRANSPARENT) INTERMEDIATE     16800010
*                                         CONTROL CHAR INSERTION        17500010
MODCCTXT EQU   X'01'                     CRITICAL TEXT                  18200010
MODCUR2  DS    XL1                      CURRENT MODE 2ND BYTE           18900010
*        EQU   X'80'                     RESERVED                       19600010
MODCRERP EQU   X'40'                     OVERRIDE READ TEXT MODE ERPS   20300010
MODCRLGR EQU   X'20'                     REJECT LEADING GRAPHICS        21000010
*                                         ON READ OPERATIONS            21700010
MODCEIBJ EQU   X'10'                     EIB INSERTION                  22400010
MODCINTO EQU   X'10'                     INHIBIT TEXT TIME OUTS         23100010
MODCSUBB EQU   X'08'                     SUB-BLOCKING(INPUT)            23800010
MODCINTE EQU   X'04'                     INTERRUPT ENABLED              24500010
MODCMNTR EQU   X'02'                     ACTIVATE MONITOR TASK          25200010
MODCMNTP EQU   X'01'                     0-AUTOMATICALLY DEACTIVATE     25900010
*                                          MONITOR                      26600010
*                                        1-PERPETUAL MONITOR            27300010
MODNEW   DS    0XL2                     NEW MODE IN NCP                 28000010
MODNEW1  DS    XL1                      NEW MODE BYTE 1                 28700010
*        EQU   X'80'                     RESERVED                       29400010
MODNWERP EQU   X'40'                     OVERRIDE WRITE TEXT MODE ERPS  30100010
MODNRLGW EQU   X'20'                     REJECT LEADING GRAPHICS ON     30800010
*                                         WRITE OPERATIONS              31500010
MODNEIBD EQU   X'10'                     EIB DELETION(NON-TRANS-        32200010
*                                         PARENT ONLY)                  32900010
*        EQU   X'08'                     RESERVED                       33600010
MODNITFL EQU   X'04'                     INHIBIT TIME FILL/INHIBIT      34300010
*                                         WACK LINES                    35000010
MODNEMLC EQU   X'02'                     EMBEDDED LINE CONTROL(NON-     35700010
*                                         TRANSPARENT) INTERMEDIATE     36400010
*                                         CONTROL CHAR INSERTION        37100010
MODNCTXT EQU   X'01'                     CRITICAL TEXT                  37800010
MODNEW2  DS    XL1                      NEW MODE 2ND BYTE               38500010
*        EQU   X'80'                     RESERVED                       39200010
MODNRERP EQU   X'40'                     OVERRIDE READ TEXT MODE ERPS   39900010
MODNRLGR EQU   X'20'                     REJECT LEADING GRAPHICS        40600010
*                                         ON READ OPERATIONS            41300010
MODNEIBJ EQU   X'10'                     EIB INSERTION                  42000010
MODNINTO EQU   X'10'                     INHIBIT TEXT TIME OUTS         42700010
MODNSUBB EQU   X'08'                     SUB-BLOCKING(INPUT)            43400010
MODNINTE EQU   X'04'                     INTERRUPT ENABLED              44100010
MODNMNTR EQU   X'02'                     ACTIVATE MONITOR TASK          44800010
MODNMNTP EQU   X'01'                     0-AUTOMATICALLY DEACTIVATE     45500010
*                                          MONITOR                      46200010
*                                        1-PERPETUAL MONITOR            46900010
         MEND  */                                                       47600010
*%PLSMODD : ;                                                           48300010
*DCL 1 IEDQMOD  BASED(RMOD),                                            49000010
*/*                                                                  */ 49700010
*/*      MODE DEVICE DEPENDENT FIELDS                                */ 50400010
*/*                                                                  */ 51100010
*      2 MODLNG   FIXED(8),             /* LENGTH OF MODE BYTE FIELDS   51800010
*                                        IN THE TTE DEVICE DEPENDENT    52500010
*                                        FIELDS                      */ 53200010
*      2 MODCUR   CHAR(2),              /* CURRENT MODE IN NCP       */ 53900010
*        3 MODCUR1  BIT(8),             /* CURRENT MODE BYTE 1       */ 54600010
*          4 *        BIT(1),           /*  RESERVED                 */ 55300010
*          4 MODCWERP BIT(1),           /*  OVERIDE WRT TXT MODE ERPS*/ 56000010
*          4 MODCRLGW BIT(1),           /*  REJECT LEADING GRAPHICS ON  56700010
*                                           WRITE OPERATIONS         */ 57400010
*          4 MODCEIBD BIT(1),           /*  EIB DELETION(NON-TRANS-     58100010
*                                           PARENT ONLY)             */ 58800010
*          4 *        BIT(1),           /*  RESERVED                 */ 59500010
*          4 MODCITFL BIT(1),           /*  INHIBIT TIME FILL/INHIBIT   60200010
*                                           WACK LINES               */ 60900010
*          4 MODCEMLC BIT(1),           /*  EMBEDDED LINE CONTROL(NON-  61600010
*                                           TRANSPARENT) INTERMEDIATE   62300010
*                                           CONTROL CHAR INSERTION   */ 63000010
*          4 MODCCTXT BIT(1),           /*  CRITICAL TEXT            */ 63700010
*        3 MODCUR2  BIT(8),             /* CURRENT MODE 2ND BYTE     */ 64400010
*          4 *        BIT(1),           /*  RESERVED                 */ 65100010
*          4 MODCRERP BIT(1),           /*  OVERIDE READ TXT MDE ERPS*/ 65800010
*          4 MODCRLGR BIT(1),           /*  REJECT LEADING GRAPHICS     66500010
*                                           ON READ OPERATIONS       */ 67200010
*          4 MODCEIBJ BIT(1),           /*  EIB INSERTION            */ 67900010
*            5 MODCINTO BIT(1),         /*   INHIBIT TEXT TIME OUTS  */ 68600010
*          4 MODCSUBB BIT(1),           /*  SUB-BLOCKING(INPUT)      */ 69300010
*          4 MODCINTE BIT(1),           /*  INTERRUPT ENABLED        */ 70000010
*          4 MODCMNTR BIT(1),           /*  ACTIVATE MONITOR TASK    */ 70700010
*          4 MODCMNTP BIT(1),           /*  0-AUTOMATICALLY DEACTIVATE  71400010
*                                             MONITOR                   72100010
*                                           1-PERPETUAL MONITOR      */ 72800010
*      2 MODNEW   CHAR(2),              /* NEW MODE IN NCP           */ 73500010
*        3 MODNEW1  BIT(8),             /* NEW MODE BYTE 1           */ 74200010
*          4 *        BIT(1),           /*  RESERVED                 */ 74900010
*          4 MODNWERP BIT(1),           /*  OVERIDE WRT TXT MODE ERPS*/ 75600010
*          4 MODNRLGW BIT(1),           /*  REJECT LEADING GRAPHICS ON  76300010
*                                           WRITE OPERATIONS         */ 77000010
*          4 MODNEIBD BIT(1),           /*  EIB DELETION(NON-TRANS-     77700010
*                                           PARENT ONLY)             */ 78400010
*          4 *        BIT(1),           /*  RESERVED                 */ 79100010
*          4 MODNITFL BIT(1),           /*  INHIBIT TIME FILL/INHIBIT   79800010
*                                           WACK LINES               */ 80500010
*          4 MODNEMLC BIT(1),           /*  EMBEDDED LINE CONTROL(NON-  81200010
*                                           TRANSPARENT) INTERMEDIATE   81900010
*                                           CONTROL CHAR INSERTION   */ 82600010
*          4 MODNCTXT BIT(1),           /*  CRITICAL TEXT            */ 83300010
*        3 MODNEW2  BIT(8),             /* NEW MODE 2ND BYTE         */ 84000010
*          4 *        BIT(1),           /*  RESERVED                 */ 84700010
*          4 MODNRERP BIT(1),           /*  OVERIDE READ TXT MDE ERPS*/ 85400010
*          4 MODNRLGR BIT(1),           /*  REJECT LEADING GRAPHICS     86100010
*                                           ON READ OPERATIONS       */ 86800010
*          4 MODNEIBJ BIT(1),           /*  EIB INSERTION            */ 87500010
*            5 MODNINTO BIT(1),         /*   INHIBIT TEXT TIME OUTS  */ 88200010
*          4 MODNSUBB BIT(1),           /*  SUB-BLOCKING(INPUT)      */ 88900010
*          4 MODNINTE BIT(1),           /*  INTERRUPT ENABLED        */ 89600010
*          4 MODNMNTR BIT(1),           /*  ACTIVATE MONITOR TASK    */ 90300010
*          4 MODNMNTP BIT(1);           /*  0-AUTOMATICALLY DEACTIVATE  91000010
*                                             MONITOR                   91700010
*                                           1-PERPETUAL MONITOR      */ 92400010
./  ADD  SSI=62470489,NAME=TMSGD
*        %GOTO PLSMSG;                  /*                              00100010
         MACRO                                                          00200010
         TMSGD                                                          00300010
*                                                                       00400010
*        BAL VERSION OF THIS DSECT NOT SUPPORTED                        00500010
*                                                                       00600010
         MEND  */                                                       00700010
*%PLSMSG:;                                                              00800010
*/*                                                                  */ 00900010
*/*      CONSTANTS FOR MESSAGE NUMBERS                               */ 01000010
*/*                                                                  */ 01100010
* DCL MSGSTANF FIXED(15) CONSTANT(16);  /* STATION NOT FOUND         */ 01200010
* DCL MSGLNNOP FIXED(15) CONSTANT(17);  /* LINE NOT OPEN             */ 01300010
* DCL MSGINVOP FIXED(15) CONSTANT(18);  /* INVALID OPERAND           */ 01400010
* DCL MSGINCUR FIXED(15) CONSTANT(173); /* INVALID CONTROL UNIT OR      01500010
*                                          RESOURCE                  */ 01600010
* DCL MSGSESLM FIXED(15) CONSTANT(192); /* SESSION LIMIT MODIFIED    */ 01700010
* DCL MSGBHSAM FIXED(15) CONSTANT(193); /* BLOCK HANDLER SET            01800010
*                                          ASSOCIATION MODIFIED      */ 01900010
* DCL MSGCCCFC FIXED(15) CONSTANT(199); /* COMMUNICATIONS CONTROLLER    02000010
*                                          COMMAND FAILED TO COMPLETE   02100010
*                                                                    */ 02200010
* DCL MSGCINCC FIXED(15) CONSTANT(201); /* COMMAND INVALID FOR          02300010
*                                          COMMUNICATIONS CONTROLLER */ 02400010
* DCL MSGTRALM FIXED(15) CONSTANT(208); /* TRANSMISSION LIMIT MODIFIED  02500010
*                                                                    */ 02600010
./  ADD  SSI=61260104,NAME=TMSKD
*        %GOTO PLSMSK;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TMSKD                                                          03000010
         SPACE                                                          04000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          05000010
.*A-000000-999999                                              @Y17XANU 06000010
IEDMSK   DSECT                                                          07000010
*                                                                       08000010
*        OPERATOR CONTROL TCHNG MASK DSECT                              09000010
*                                                                       10000010
MSKNUM   DS    H .                 NUMBER OF MASKS                      11000010
MSKMASK  DS    0XL2 .              PROTECTION MASK                      12000010
MSK1     DS    XL1 .                    MASK BYTE 1                     13000010
MSKBYTE1 EQU   X'FF' .                   USED TO CHECK IF BYTES 4-7     14000010
*                                        OF TTE ARE PROTECTED           15000010
MSKCNT   EQU   X'80' .                   CHECK TO ALLOW TLIST COUNT     17000010
*                                        MODIFICATION                   18000010
MSKLIST  EQU   X'40' .                   CHECK TO ALLOW TLIST ENTRIES   19000010
*                                        MODIFICATION                   20000010
*        EQU   X'20'-X'01' .             RESERVED                       20300010
MSK2     DS    XL1 .                    MASK BYTE 2                     20600010
MSKBYTE2 EQU   X'F0' .                   USED TO CHECK IF BYTES 8-F     21000010
*                                        OF TTE ARE PROTECTED           22000010
*        EQU   X'80'-X'10' .             RESERVED                       23000010
MSKOPT   EQU   X'08' .                   USED TO CHECK IF OPTION        23500010
*                                        FIELDS ARE PROTECTED           24000010
*                                        (MSKBYTE2)                     25000010
MSKDVDP  EQU   X'04' .                   USED TO CHECK IF DEVICE        26000010
*                                        DEPENDENT FIELDS ARE PROTECTED 27000010
*        EQU   X'02'-X'01' .             RESERVED                       27500010
*                                                                       28000010
*        THIS DSECT CONSISTS OF 9 MASKS, REPRESENTING 9 TTE TYPES,      29000010
*        IN THE FOLLOWING ORDER:                                        30000010
*                                                                       31000010
*              1 - 270X TERMINAL (DIAL, NON DIAL, LOG)                  32000010
*              2 - 3705 BSC/SS TERMINAL                                 33000010
*              3 - PU                                                   34000010
*              4 - LU                                                   35000010
*              5 - SSCP                                                 36000010
*              6 - NCP                                                  37000010
*              7 - 3705 LINE                                            38000010
*              8 - LIST                                                 39000010
*              9 - TPROCESS                                             40000010
*                                                                       41000010
MSKLEN   EQU   *-MSKMASK .              LENGTH OF MASK ENTRY            42000010
         MEND                                                           43000010
*        */                                                             44000010
*%PLSMSK: ;                                                             45000010
*DECLARE 1 IEDMSK BDY(WORD) BASED(IEDMSKP),                             46000010
*/*                                                                  */ 47000010
*/*      OPERATOR CONTROL TCHNG MASK DSECT                           */ 48000010
*/*                                                                  */ 49000010
*   2 MSKNUM FIXED(15),                 /* NUMBER OF MASKS           */ 50000010
*   2 MSKMASK CHAR(2),                  /* PROTECTION MASK           */ 51000010
*    3 MSK1 CHAR(1),                    /* MASK BYTE 1               */ 52000010
*     4 MSKCNT BIT(1),                   /* CHECK TO ALLOW TLIST COUNT  54000010
*                                           MODIFICATION             */ 55000010
*     4 MSKLIST BIT(1),                  /* CHECK TO ALLOW TLIST        56000010
*                                           ENTRIES MODIFICATION     */ 57000010
*     4 *       BIT(6),                  /* RESERVED                 */ 57300010
*    3 MSK2 CHAR(1),                    /* MASK BYTE 2               */ 57600010
*     4 *       BIT(4),                  /* RESERVED                 */ 58000010
*     4 MSKOPT  BIT(1),                  /* USED TO CHECK IF OPTION     59000010
*                                           FIELDS ARE PROTECTED        60000010
*                                           (MSKBYTE2)               */ 61000010
*     4 MSKDVDP BIT(1),                  /* USED TO CHECK IF DEVICE     62000010
*                                           DEPENDENT FIELDS ARE        63000010
*                                           PROTECTED                */ 64000010
*     4 *       BIT(2);                  /* RESERVED                 */ 65000010
*                                                                       66000010
* %MSKLEN='LENGTH(MSKMASK)';            /* LENGTH OF MASK ENTRY      */ 67000010
*                                                                       68000010
*/*                                                                  */ 69000010
*/*      CONSTANTS (MSK1)                                            */ 70000010
*/*                                                                  */ 71000010
*DCL MSKBYTE1 BIT(8) CONSTANT('FF'X);   /* USED TO CHECK IF BYTES 4-7   72000010
*                                          OF TTE ARE PROTECTED      */ 73000010
*/*                                                                  */ 74000010
*/*      CONSTANTS (MSK2)                                            */ 75000010
*/*                                                                  */ 76000010
*DCL MSKBYTE2 BIT(8) CONSTANT('F0'X);   /* USED TO CHECK IF BYTES 8-F   77000010
*                                          OF TTE ARE PROTECTED      */ 78000010
*/*      THIS DSECT CONSISTS OF 9 MASKS, REPRESENTING 9 TTE TYPES,   */ 79000010
*/*      IN THE FOLLOWING ORDER:                                     */ 80000010
*/*                                                                  */ 81000010
*/*            1 - 270X TERMINAL (DIAL, NON DIAL, LOG)               */ 82000010
*/*            2 - 3705 BSC/SS TERMINAL                              */ 83000010
*/*            3 - PU                                                */ 84000010
*/*            4 - LU                                                */ 85000010
*/*            5 - SSCP                                              */ 86000010
*/*            6 - NCP                                               */ 87000010
*/*            7 - 3705 LINE                                         */ 88000010
*/*            8 - LIST                                              */ 89000010
*/*            9 - TPROCESS                                          */ 90000010
*/*                                                                  */ 91000010
./  ADD  SSI=62120492,NAME=TNATD
*        %GOTO PLSNAT;                  /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TNATD                                                          09000010
         SPACE                                                          12000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          15000010
.*A-000000-999999                                              @Y17XAXU 18000010
         SPACE                                                          21000010
IEDNATD  DSECT                                                          24000010
*                                                                       27000010
*        DSECT FOR NETWORK ADDRESS TABLE (NAT)                          30000010
*                                                                       33000010
NATODAF  DS    AL2 .                    NETWORK ADDRESS ENTRY           36000010
NATLEN   EQU   *-IEDNATD .              LENGTH OF NAT ENTRY             39000010
         SPACE 2                                                        42000010
         MEND                           */                              45000010
*%PLSNAT : ;                                                            48000010
*DECLARE                                                                51000010
*  1 IEDNATD BDY(WORD) BASED(IEDQNATP),                                 54000010
*/*                                                                  */ 57000010
*/*      DSECT FOR NETWORK ADDRESS TABLE                             */ 60000010
*/*                                                                  */ 63000010
*   2 NATODAF BIT(16);                  /* NETWORK ADDRESS ENTRY     */ 66000010
* %NATLEN='LENGTH(IEDNATD)';            /* LENGTH OF NAT ENTRY       */ 69000010
*                                                                       72000010
*%NATEND: ;                                                             75000010
*                                                                       78000010
./  ADD  SSI=60630367,NAME=TNCPID
*        %GOTO NCPPLS;             /* BILINGUAL HEADER                  02000010
         MACRO                                                          04000010
         TNCPID                                                         06000010
.*A000000-999999                                               @Y17XAXF 08000010
IEDNCP   DSECT                                                          10000010
*                                                                       12000010
*        DSECT FOR NCP DEVICE DEPENDENT INFORMATION                     14000010
*                                                                       16000010
NCPLEN   DS    CL1 .               LEN OF DEVICE DEPENDENT INFO         18000010
NCPFLAG1 DS    CL1 .               FLAGS                                20000010
NCPIAUTO EQU   X'80' .                  IPLAUTO=YES SPECIFIED           22000010
NCPDAUTO EQU   X'40' .                  DMPAUTO=YES SPECIFIED           24000010
NCPBGUP  EQU   X'20' .                  BRINGUP=YES SPECIFIED           26000010
NCPREST  EQU   X'10' .                  DO A RESTART                    28000010
NCPIPLD  EQU   X'08' .                  IPL FOR 3705 HAS BEEN EXECUTED  30000010
NCPBKUP  EQU   X'04' .                  BACKUP=YES SPECIFIED            32000010
NCPTRACE EQU   X'02' .                  3705 LINE TRACE ACTIVE          34000010
*        EQU   X'01' .                  RESERVED                        36000010
NCPBKUPN DS    CL8 .               BACKUP NAME                          38000010
NCPTXID  DS    CL8 .               IPL TEXT NAME                        40000010
NCPDPDCB DS    AL4 .               ADDRESS OF DUMP DCB                  42000010
NCPCKPT  DS    AL4 .               ADDRESS OF CHECK POINT DCB           44000010
NCPLTRAC DS    AL4 .               3705 LINE TRACE TABLE ADDR           46000010
NCPILEN  EQU   *-IEDNCP            LEN OF NCP INFO                      48000010
         MEND                                                           50000010
*                                                                    */ 52000010
*%NCPPLS:;                                                              54000010
*DECLARE                                                                56000010
*  1 IEDNCP BASED BDY(BYTE),                                            58000010
*/*                                                                  */ 60000010
*/*      DSECT FOR NCP DEVICE DEPENDENT INFORMATION                  */ 62000010
*/*                                                                  */ 64000010
*    2 NCPLEN   CHAR(1),                /* LEN OF DEV DEPENDENT INFO */ 66000010
*    2 NCPFLAG1 CHAR(1),                /* FLAGS                     */ 68000010
*      3 NCPIAUTO BIT(1),               /*   IPLAUTO=YES SPECIFIED   */ 70000010
*      3 NCPDAUTO BIT(1),               /*   DMPAUTO=YES SPECIFIED   */ 72000010
*      3 NCPBGUP  BIT(1),               /*   BRINGUP=YES SPECIFIED   */ 74000010
*      3 NCPREST  BIT(1),               /*   DO A RESTART            */ 76000010
*      3 NCPIPLD  BIT(1),               /*   IPL FOR 3705 EXECUTED   */ 78000010
*      3 NCPBKUP  BIT(1),               /*   BACKUP=YES SPECIFIED    */ 80000010
*      3 NCPTRACE BIT(1),               /*   3705 LINE TRACE ACTIVE  */ 82000010
*      3 *        BIT(1),               /*   RESERVED                */ 84000010
*    2 NCPBKUPN CHAR(8),                /* BACKUP NAME               */ 86000010
*    2 NCPTXID  CHAR(8),                /* IPL TEXT NAME             */ 88000010
*    2 NCPDPDCB PTR(32) BDY(BYTE),      /* ADDRESS OF DUMP DCB       */ 90000010
*    2 NCPCKPT  PTR(32) BDY(BYTE),      /* ADDRESS OF CKPT DCB       */ 92000010
*    2 NCPLTRAC PTR(32) BDY(BYTE);      /* 3705 LINE TRACE TABLE ADDR*/ 94000010
* %NCPILEN='LENGTH(IEDNCP)';            /* LEN OF NCP INFO           */ 96000010
./  ADD  SSI=62710406,NAME=TNRAD
*        %GOTO PLSNRA;                  /* BILINGUAL HEADER             00100010
         MACRO                                                          00200010
         TNRAD                                                          00300010
.*A000000-999999                                               @Y17XAXF 00400010
*                                                                       00500010
*        ASSEMBER VERSION OF DSECT NOT SUPPORTED                        00600010
*                                                                       00700010
         MEND  */                                                       00800010
*%PLSNRA:;                                                              00900010
*/*                                                                  */ 01000010
*/*      NEW DSECT FOR 3705 RESTART GETMAIN AREA                     */ 01100010
*/*                                                                  */ 01200010
* DECLARE                                                               01300010
* 1 IEDNRA BASED(RNRA),                                                 01400010
*  2 NRACURR  PTR(31),                  /*RESTART GETMAIN AREA       */ 01500010
*  2 NRASIZE  FIXED(32),                /*GETMAIN AREA SIZE          */ 01600010
*  2 NRAR1PTR PTR(31),                  /*READ1 AREA PTR             */ 01700010
*  2 NRAR2PTR PTR(31),                  /*READ2 AREA PTR             */ 01800010
*  2 NRAREAD  CHAR(*);                  /*READ AREA                  */ 01900010
./  ADD  SSI=80670112,NAME=TNSLD
*        %GOTO PLSNSL;                  /* BILINGUAL HEADER             01000000
         MACRO                                                          02000000
         TNSLD                                                          03000000
         SPACE                                                          04000000
.* CHANGE ACTIVITY AS FOLLOWS:                                          05000000
.*A-000000-999999                                              @Y17XAXF 06000000
.*A274500,588000                                               @OY20296 06000182
         SPACE                                                          07000000
IEDNNSLD DSECT                                                          07010000
NSLSAVE1 DS    F                        USED TO SAVE POINTER DURING     07020000
*                                        POST TO REQUEST BUFFERS        07030000
NSLSAVE2 DS    F                        USED TO SAVE POINTERS DURING    07040000
*                                        POST TO REQUEST BUFFERS        07050000
         SPACE                                                          07060000
IEDNSLD  EQU   *                                                        07100000
*                                                                       09000000
*        DSECT FOR START/STOP LINE ELEMENT                              10000000
*                                                                       11000000
*        IEDNSL USES THESE FIELDS INTERNALLY                            11500000
NSLOPRE  DS    CL8 .                    OP CONTROL REQ ELEMENT          12000000
NSLPLCB  DS    XL1 .                    PLCB RETURN TO OPCTL            13000000
NSLPLCBR EQU   X'80' .                   PLCB TO RETURN                 16030000
*        EQU   X'40'-X'01' .             RESERVED                       16060000
NSLSAVE  DS    AL3 .                    SAVE POINTER NEEDED ACROSS POST 16100000
NSLGPCUS DS    XL1 .                    SWITCH TO DETERMINE WHERE TO    16200000
*                                        BEGIN WHEN BUFFER RETURN       16300000
NSLNGPST EQU   X'80' .                  TRYING TO STOP A TERMINAL       16400000
*                                        FOR STOPTERM REQUEST           16450000
NSLGPTSP EQU   X'40' .                  TRYING TO STOP GP TERM          16500000
NSLNGPSL EQU   X'20' .                  TRYING TO STOP TERMINAL FOR     16600000
*                                        STOPLINE REQUEST               16630000
NSLSDIAL EQU   X'10' .                  REDIRVE FOR DIAL WHEN           16660000
*                                        REQUESTING A BUFFER DURING     16661000
*                                        STOPLINE                       16662000
NSLDRDRV EQU   X'08' .                  TO RECOGNIZE WHEN TO STOP THE   16663000
*                                        LOGICAL TERM FOR CALLOUT DIAL  16664000
*        EQU   X'04'-X'01' .            RESERVED                        16665000
NSLCTTRM DS    AL3 .                    CURRENT TRM                     16670000
NSLTTCIN DS    H .                      CURRENT TNT INDEX               16800000
*        NSLPRIBK AND NSLFLGBK PART OF INTERFACE TO IEDNSL              16900000
NSLPRIBK DS    XL1 .                    PRIORITY FIELD                  17000000
NSLFLGBK DS    XL1 .                    FLAG                            17100000
NSLERB   DS    0CL14 .                  BUFFER REQUEST ERB              17130000
NSLERBIN EQU   NSLERB-IEDNSLD .         ERB INDEX                       17160000
*        ERB MUST BE X'14' FROM QCB SO THAT IEDQGA CAN POST BUFFER      17200000
NSLERQCB DS    A .                      BUFFER REQUEST ERB QCB          17300000
NSLERBPR DS    XL1 .                    ERB PRIORITY                    17400000
NSLELINK DS    AL3 .                    LINK                            17500000
NSLESTAT DS    XL1 .                    ERB STATUS                      17600000
*        EQU   X'80'-X'04' .             RESERVED                       17800000
NSLMPPI  EQU   X'02' .                   TO HAVE THE ERB POSTED BACK TO 18000000
*                                         IEDNSL                        18200000
*        EQU   X'01' .                   RESERVED                       18400000
NSLBUFFR DS    AL3 .                    BUFFER ADDRESS                  19000000
NSLUNCNT DS    H .                      UNIT COUNT                      19400000
*        INTERFACE TO IEDNSL                                            19800000
         DS    XL1 .                    RESERVED                        20200000
NSLREQTY DS    XL1 .                    REQUEST TYPE                    20220000
NSLSTRTL EQU   X'01' .                    START LINE                    21000000
NSLSTOPL EQU   X'02' .                    STOP LINE                     22000000
NSLSTRTR EQU   X'03' .                    START TERMINAL                23000000
NSLSTPTR EQU   X'04' .                    STOP TERMINAL                 24000000
NSLSTRGP EQU   X'05' .                    START GENERAL POLL            25000000
NSLSTPGP EQU   X'06' .                    STOP GENERAL POLL             26000000
NSLSTRLU EQU   X'07' .                    START LU                      27000000
NSLSTMSG EQU   X'08' .                    MIDDLE OF MSG                 27200000
NSLSTPLI EQU   X'09' .                    STOPLINE,I                    27400000
NSLCLOSN EQU   X'0B' .                    FLUSH CLOSEDOWN               27450000
NSLSTPGB EQU   X'0D'                       STOP GENERAL POLL,B @OY20296 27470082
NSLOPCEP DS    0F .                     ADDRESS OF OPCE ASSOCIATED WITH 27500000
*                                         A GENERAL POLL REQUEST        27600000
NSLGRPNM DS    CL8 .                    GROUP NAME                      27700000
NSLTTEPT DS    A .                      TTE ADDRESS                     27800000
*                                                                       28000000
NSLLEN   EQU   *-IEDNSLD .              NSL LENGTH                      29000000
NSLNLEN  EQU   IEDNSLD-IEDNNSLD         PREFIX LENGTH                   29200000
         MEND                                                           29500000
*        */                                                             31000000
*%PLSNSL : ;                                                            32000000
*DECLARE                                                                33000000
*  1 IEDNNSLD BDY(WORD) BASED,          /* NEG PREFIX                */ 33010000
*   2 NSLSAVE1 PTR(31),                 /* USED TO SAVE POINTER DURING  33020000
*                                          POST TO REQUEST BUFFER       33030000
*                                                                    */ 33040000
*   2 NSLSAVE2 PTR(31);                 /* USED TO SAVE POINTER DURING  33050000
*                                          POST TO REQUEST BUFFERS      33060000
*                                                                    */ 33070000
*                                                                       33080000
*DECLARE                                                                33090000
*  1 IEDNSLD BDY(WORD) BASED (IEDNSLP),                                 33100000
*/*                                                                  */ 35000000
*/*      DSECT FOR START/STOPLINE ELEMENT                            */ 36000000
*/*                                                                  */ 37000000
*/*  IEDNSL USES THESE FIELD INTERNALLY                              */ 37500000
*   2 NSLOPRE CHAR(8),                  /* OP CONTROL REQ ELEMENT    */ 38000000
*   2 NSLPLCB  BIT(8),                  /* PLCB RETURN TO OPCTL      */ 39000000
*    3 NSLPLCBR BIT(1),                 /*  PLCB TO RETURN           */ 42030000
*    3 *        BIT(7),                 /*  RESERVED                 */ 42060000
*   2 NSLSAVE  PTR(24),                 /* SAVE POINTER NEEDED ACROSS   42100000
*                                          POST                      */ 42150000
*   2 NSLGPCUS BIT(8),                  /* SWITCH TO DETERMIN WHERE  */ 42200000
*                                       /*  TO BEGIN WHEN BUFFER RTN */ 42300000
*     3 NSLNGPST BIT(1),                /* TRYING TO STOP TERMINAL   */ 42400000
*                                       /*  FOR STOPTERM REQUEST     */ 42450000
*     3 NSLGPTSP BIT(1),                /* TRYIN TO STOP GP TERM     */ 42500000
*     3 NSLNGPSL BIT(1),                /* TRYING TO STOP TERMINAL   */ 42600000
*                                       /*  FOR STOPLINE REQUEST     */ 42630000
*     3 NSLSDIAL BIT(1),                /* REDIRVE FOR DIAL WHEN        42660000
*                                          REQUESTING A BUFFER DURING   42661000
*                                          STOP LINE                 */ 42662000
*     3 NSLDRDRV BIT(1),                /* TO RECOGNIZE WHEN TO STOP    42663000
*                                          THE LOGICAL TERM FOR CALLOUT 42664000
*                                          DIAL                      */ 42665000
*     3 *        BIT(3),                /* RESERVED                  */ 42666000
*   2 NSLCTTRM PTR(24),                 /* CURRENT TRM               */ 42670000
*   2 NSLTTCIN FIXED(16),               /* CURRENT TTCIN             */ 42800000
*/*    NSLPRIBK, NSLFLGBK ARE PART OF INTERFACE TO IEDNSL            */ 42900000
*   2 NSLPRIBK BIT(8),                  /* PRIORITY                  */ 43000000
*   2 NSLFLGBK BIT(8),                  /* FLAG                      */ 43100000
*/*    ERB MUST BE X'14' FROM QCB SO THAT IEDQGA CAN POST BUFFER     */ 43200000
*   2 NSLERB CHAR(14) BDY(WORD),        /* BUFFER REQ ERB            */ 43300000
*    3 NSLERQCB PTR(31),                /* BUFFER REQ ERB QCB        */ 43350000
*    3 NSLERBPR BIT(8),                 /* ERB PRIORITY              */ 43400000
*    3 NSLELINK PTR(24),                /* LINK                      */ 43440000
*    3 NSLESTAT BIT(8),                 /* ERB STATUS                */ 43480000
*     4 *        BIT(6),                /*  RESERVED                 */ 43520000
*     4 NSLMPPI  BIT(1),                /*  TO HAVE THE ERB POSTED   */ 43560000
*                                       /*   BACK TO IEDNSL          */ 43600000
*     4 *        BIT(1),                /*  RESERVED                 */ 43640000
*    3 NSLBUFFR PTR(24),                /* BUFFER ADDRESS            */ 43700000
*    3 NSLUNCNT FIXED(16),              /* UNIT COUNT                */ 43750000
*/*    INTERFACE TO IEDNSL                                           */ 43900000
*   2 *        BIT(8),                  /* RESERVED                  */ 44000000
*   2 NSLREQTY BIT(8),                  /* REQUEST TYPE              */ 44004000
*   2 NSLGRPNM CHAR(8) BDY(WORD),       /* GROUP NAME                */ 45000000
*    3 NSLOPCEP PTR(31),                /* ADDR OF OPCE ASSOCIATED   */ 45200000
*                                       /*  WITH THIS GENERAL POLL   */ 45400000
*                                       /*  REQUEST                  */ 45600000
*    3 *        CHAR(4),                /* RESERVED                  */ 45800000
*   2 NSLTTEPT PTR(32);                 /* GROUP NAME                */ 46000000
*                                                                       47000000
* %NSLLEN='LENGTH(IEDNSLD)';            /* NSL LENGTH                */ 48000000
* %NSLERBIN='ADDR(NSLERB)-ADDR(IEDNSLD)';/* ERB INDEX                */ 48500000
* %NSLNLEN='LENGTH(IEDNNSLD)';          /* PREFIX LENGTH             */ 48600000
*/*                                                                  */ 48700000
*/* .    NSLREQTY  EQUEST CONSTANTS                                  */ 50000000
*/*                                                                  */ 51000000
*DCL NSLSTRTL BIT(8) CONSTANT('01'X);   /* START LINE                */ 52000000
*DCL NSLSTOPL BIT(8) CONSTANT('02'X);   /* STOP LINE                 */ 53000000
*DCL NSLSTRTR BIT(8) CONSTANT('03'X);   /* START TERMINAL            */ 54000000
*DCL NSLSTPTR BIT(8) CONSTANT('04'X);   /* STOP TERMINAL             */ 55000000
*DCL NSLSTRGP BIT(8) CONSTANT('05'X);   /* START GENERAL POLL        */ 56000000
*DCL NSLSTPGP BIT(8) CONSTANT('06'X);   /* STOP GENERAL POLL         */ 57000000
*DCL NSLSTRLU BIT(8) CONSTANT('07'X);   /* START LU                  */ 58000000
*DCL NSLSTMSG BIT(8) CONSTANT('08'X);   /* MIDDLE OF MSG             */ 58300000
*DCL NSLSTPLI BIT(8) CONSTANT('09'X);   /* STOPLINE,I                */ 58600000
*DCL NSLCLOSN BIT(8) CONSTANT('0B'X);   /* FLUSH CLOSEDOWN           */ 58800000
*DCL NSLSTPGB BIT(8) CONSTANT('0D'X); /* STOP GENERAL POLL,B @OY20296*/ 58850082
*                                                                       59000000
./  ADD  SSI=63080809,NAME=TOCTRD
*        %GOTO PLSOCTR;                 /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TOCTRD                                                         03000010
.*A000000-999999                                               @Y17XAXF 04000010
IEDOCTR  DSECT                                                          05000010
*                                                                       06000010
*        IPL/DUMP TRAILOR TO OPCE                                       07000010
*                                                                       08000010
OCTROPCE DS    A .                      OPCE POINTER                    09000010
OCTRDCB  DS    A .                      DCB POINTER                     10000010
OCTRLCB  DS    A .                      LCB POINTER                     11000010
         DS    XL1 .                    RESERVED                        12000010
OCTRSW   DS    XL1 .                    SWITCHING FLAGS                 13000010
OCTROUT  EQU   X'80' .                   LOOP CONTROL                   14000010
OCTRNOS  EQU   X'40' .                   NO SENSE REQUIRED              15000010
OCTRBLST EQU   X'20' .                   IPL NO SENSE                   15500010
OCTRFA   EQU   X'10'                     EXIT TO ACTIVATE REQD @YM05689 16000010
OCTRINMF EQU   X'08' .                   FROM MF                        17000010
*        EQU   X'04'-X'01' .             RESERVED                       18000010
OCTRRTE  DS    XL1                      ROUTE FLAG                      19000010
OCTRFC   EQU   X'80' .                   EXIT TO IGCFC10D               20000010
OCTRMD   EQU   X'40' .                   EXIT TO IGCMD10D               21000010
OCTRMP   EQU   X'20' .                   EXIT TO IGCMP10D               22000010
OCTRC0   EQU   X'10' .                   EXIT TO IGCC010D               23000010
OCTR09   EQU   X'08' .                   EXIT TO IGC0910D               24000010
OCTR07   EQU   X'04' .                   EXIT TO IGC0710D               25000010
OCTR00   EQU   X'02'                     EXIT TO IGC0010D               26000010
OCTR06   EQU   X'01' .                   EXIT TO IGC0610D               27000010
OCTRRTN  DS    XL1 .                    RETURN FLAG                     28000010
OCTRIP   EQU   X'80' .                   IN PROGRESS                    29000010
OCTRCH   EQU   X'40' .                   CHAINED OR ATTACHED            30000010
*        EQU   X'20'-X'10' .             RESERVED                       31000010
OCTRERO  EQU   X'08' .                   DUMP ERROR                     32000010
OCTRERI  EQU   X'04' .                   IPL ERROR                      33000010
*        EQU   X'02'-X'01' .             RESERVED                       34000010
OCTRTTE  DS    A .                      TTE POINTER                     35000010
OCTRDVD  DS    A .                      DEV DEPENDENT FLD PTR           36000010
OCTRUCB  DS    A .                      UCB POINTER                     37000010
OCTRADR  DS    A .                      I/O RETURN ADDR                 38000010
OCTRSAVE DS    A .                      RETURN ADDRESS FIELD            38500010
OCTRLEN  EQU   *-IEDOCTR .              LEN OF TRAILER                  39000010
         MEND                                                           40000010
         */                                                             41000010
*%PLSOCTR:;                                                             42000010
* DECLARE                                                               43000010
*  1 IEDOCTR BASED,                                                     44000010
*/*                                                                  */ 45000010
*/*      IPL/DUMP TRAILER TO OPCE                                    */ 46000010
*/*                                                                  */ 47000010
*    2 OCTROPCE PTR(31),                /* OPCE POINTER              */ 48000010
*    2 OCTRDCB  PTR(31),                /* DCB POINTER               */ 49000010
*    2 OCTRLCB  PTR(31),                /* LCB POINTER               */ 50000010
*    2 *        PTR(8),                 /* RESERVED                  */ 51000010
*    2 OCTRSW   BIT(8),                 /* SWITCHING FLAGS           */ 52000010
*      3 OCTROUT  BIT(1),               /*  LOOP CONTROL             */ 53000010
*      3 OCTRNOS  BIT(1),               /*  NO SENSE REQUIRED        */ 54000010
*      3 OCTRBLST BIT(1),               /*  IPL NO SENSE             */ 54500010
*      3 OCTRFA   BIT(1),     /* EXIT TO ACTIVATE REQD       @YM05689*/ 55000010
*      3 OCTRINMF BIT(1),               /*  FROM MF                  */ 56000010
*      3 *        BIT(3),               /*  RESERVED                 */ 57000010
*    2 OCTRRTE  PTR(8),                 /* ROUTE FLAG                */ 58000010
*      3 OCTRFC   BIT(1),               /*  EXIT TO IGCFC10D         */ 58100010
*      3 OCTRMD   BIT(1),               /*  EXIT TO IGCMD10D         */ 58200010
*      3 OCTRMP   BIT(1),               /*  EXIT TO IGCMP10D         */ 58300010
*      3 OCTRC0   BIT(1),               /*  EXIT TO IGCC010D         */ 58400010
*      3 OCTR09   BIT(1),               /*  EXIT TO IGC0910D         */ 58500010
*      3 OCTR07   BIT(1),               /*  EXIT TO IGC0710D         */ 58600010
*      3 OCTR00   BIT(1),               /*  EXIT TO IGC0010D         */ 58700010
*      3 OCTR06   BIT(1),               /*  EXIT TO IGC0610D         */ 58800010
*    2 OCTRRTN  BIT(8),                 /* RETURN FLAG               */ 59000010
*      3 OCTRIP   BIT(1),               /*  IN PROGRESS              */ 60000010
*      3 OCTRCH   BIT(1),               /*  CHAINED OR ATTAHCED      */ 61000010
*      3 *        BIT(2),               /*  RESERVED                 */ 62000010
*      3 OCTRERD  BIT(1),               /*  DUMP ERROR               */ 63000010
*      3 OCTRERI  BIT(1),               /*  IPL ERROR                */ 64000010
*      3 *        BIT(2),               /*  RESERVED                 */ 65000010
*    2 OCTRTTE  PTR(31),                /* TTE POINTER               */ 66000010
*    2 OCTRDVD  PTR(31),                /* DEV DEPENDENT FLD PTR     */ 67000010
*    2 OCTRUCB  PTR(31),                /* UCB POINTER               */ 68000010
*    2 OCTRADR  PTR(31),                /* I/O RETURN ADDR           */ 69000010
*    2 OCTRSAVE PTR(31);                /* RETURN ADDRESS            */ 69500010
*%OCTRLENL='LENGTH(IEDOCTR)';           /* LEN OF TRAILER            */ 70000010
./  ADD  SSI=72280159,NAME=TOPCAVTD
*        %GOTO PLSOPAVT;                             /*                 00500022
         MACRO                                                          01000022
         TOPCAVTD                                                       02000022
.*A-000000-999999                                              @X31X8X0 02100008
.*C070000,160000,738000,766000                                   X03039 02300008
.*D768000                                                        X03039 02600008
.*C070000,738000                                               @Z30X8XE 02600108
.*A665000                                                      @XA09783 02700100
.*A170000,360000,410000,826000,838000                          @Y17XAXU 02700200
.*C027001,200000,360000,400000-405000,780000,826000,838000     @Y17XAXU 02720200
.*C930000                                                      @Y17XAXU 02740200
.*D962000                                                      @Y17XAXU 02760200
         SPACE                                                          03000022
IEDQOPCD DSECT                                                          04000022
         SPACE                                                          05000022
*              OPERATOR CONTROL ADDRESS VECTOR TABLE                    06000022
*              VERSION DATE  JUNE  7, 1974                     @Z30X8XE 07000008
         SPACE                                                          08000022
OPCDOUBL DS    D .                 WORK SPACE FOR TRANSIENTS            09000022
         SPACE                                                          10000022
OPCAVTPT DS    A .                 ADDRESS OT TCAM AVT                  11000022
OPCCOPCE DS    A .                 ADDRESS OF CURRENT ELEMENT (OPCE)    12000022
OPCDCBLK DS    A .                 ADDRESS OF DCB, RLN, ADDRESS LOOK-UP 13000022
OPCOPTLK DS    A .                 ADDRESS OF OPTION FIELD LOOK-UP CODE 14000022
OPCTOFLK DS    A .                 ADDRESS TO GET TNT OFFSET,TERM ENTRY 15000022
OPCIPLAD DS    A .                      ADDRESS OF IPL DCB     @Y17XAXU 15500000
         DS    A .                 UNUSED                        X03039 16000008
OPCLCB   DS    A .                 ADDRESS OF LCB SET UP ROUTINE        17000022
OPCPGCK  DS    A .                  IN-PROG CHECK AND SET RTN  @Y17XAXU 17200000
OPCTNTEA DS    A .                  FIND TNT ROUTINE           @Y17XAXU 17400000
OPCPSTWT DS    A .                 TPOST-TWAIT RTN             @Y17XAXU 17600000
*                                  A(POSTWAIT)                 @Y17XAXU 17700000
         SPACE                                                          18000022
OPCTRMWA DS    F .                 WORKAREA FOR TERM ENTRY ADDRESS      19000022
OPCSAVE  DS    18F .               OP CTL SAVE AREA            @Y17XAXU 20000000
         SPACE                                                          21000022
*   DO NOT INSERT CARDS OR MOVE CARDS BETWEEN THESE COMMENTS          * 22000022
OPCQCBAD DS    A .                 ADDRESS OF OPC QCB                   23000022
OPCRSAVE DS    2F .                BASE AND RETURN SAVEAREA (IGC0010D)  24000022
OPCWORK  DS    A .                 ADDRESS OF RESIDENT WORKAREA         25000022
OPCWRKSZ DS    H .                 SIZE OF RESIDENT WORKAREA            26000022
OPCFLAG1 DS    X .                 FLAG BYTE FOR TRANSIENT USE          27000022
OPCFLAG2 DS    X .                 FLAG BYTE FOR TRANSIENT USE          28000022
OPCBFERB DS    4F .                BUFFER REQUEST ERB                   29000022
*   DO NOT INSERT CARDS OR MOVE CARDS BETWEEN THESE COMMENTS          * 30000022
         SPACE                                                          31000022
OPCCKERB DS    4F .                CHECKPOINT REQUEST ERB               32000022
OPCAQCTL DS    0F .                SVC 102 PARAMETER LIST      @Y17XAXF 33000000
OPCAQWD1 DS    0F .                 LIST WORD 1                @Y17XAXF 33100000
OPCAQREQ DS    CL1 .                 SVC REQUEST CODE          @Y17XAXF 33200000
OPCAQFST DS    AL3 .                 FIRST ADDR OR INDEX       @Y17XAXF 33300000
OPCAQWD2 DS    0F .                 LIST WORD 2                @Y17XAXF 33400000
OPCAQRQ2 DS    CL1 .                 ACTION CODE               @Y17XAXF 33500000
OPCAQSEC DS    AL3 .                 SECOND ADDR OR INDEX      @Y17XAXF 33600000
OPCAQWD3 DS    0F .                 LIST WORD 3                @Y17XAXF 33700000
OPCAQRQ3 DS    CL1 .                 ACTION CODE               @Y17XAXF 33800000
OPCAQLST DS    AL3 .                 LAST ADDR OR INDEX        @Y17XAXF 33900000
OPCWAIT  DS    3F .                OP CONTROL INPUT WAIT LIST           34000022
OPCXCTL  DS    2A .                LIST FORM OF XCTL, USED BY TRANSIENT 35000022
OPCLDNME DS    0CL8 .               XCTL MODULE NAME           @Y17XAXU 36000000
         DS    CL3'IGC' .           MODULE NAME PREFIX         @Y17XAXU 36200000
OPCMODID DS    CL2 .                MODULE ID                  @Y17XAXU 36400000
         DS    CL3'10D' .           MODULE NAME SUFFIX         @Y17XAXU 36600000
         SPACE                                                          37000022
OPCWAITC DS    F .                 QCW FOR CHECKPOINT WAIT QUEUE        38000022
OPCWAITL DS    F .                 QCW FOR LCB WAIT LIST                39000022
OPCWAITN DS    F .                  FID0 RESP WAIT CHAIN       @Y17XAXU 40000000
OPCWAITO DS    F .                      OUTPUT QUEUE QCW       @Y17XAXU 40500000
OPCWAITP DS    A .                 SSCP OPCE Q FOR ACTPU'S     @Y17XAXU 41000000
OPCWAITR DS    F .                 QCW FOR RESOURCE WAIT QUEUE          42000022
OPCWAITA DS    F .                  QCW FOR ACT/DEACT WAIT CHN @Y17XAXU 42100000
OPCCKPTF DS    F .                  FIRST OPCE FOR CHECKPT     @Y17XAXU 42200000
OPCCKPTL DS    F .                  LAST OPCE FOR CHECKPT      @Y17XAXU 42300000
OPCHORT  DS    F .                  CONHORT SEARCH ROUTINE     @Y17XAXU 42400000
OPCHORTG DS    F .                  COHORTG SEARCH ROUTINE     @Y17XAXU 42500000
OPCSCNC  DS    F .                  FID1 EXPEDITE FLOW OR               42600000
*                                   TS PROFILE 1 WAIT CHAIN    @Y17XAXU 42700000
OPCFMDFC DS    F .                  ALL OTHER FID1'S                    42800000
*                                   WAIT CHAIN                 @Y17XAXU 42900000
         SPACE                                                          43000022
OPCNEXT  DS    A .                 ADDRESS OF ELEMENT NOW CURRENT       44000022
OPCGETBF DS    A .                 ADDRESS OF BUFFER REQUEST ROUTINE    45000022
OPCFREBF DS    A .                 ADDRESS OF BUFFER UNIT FREE ROUTINE  46000022
         SPACE                                                          47000022
OPCBFREQ DS    H .                 NO. OF UNITS NEEDED BY WAIT LIST     48000022
OPCHA8   DS    H .                 HALF WORD SET TO EIGHT               49000022
OPCCLNTS DS    X .                 T&S SWITCH FOR QUEUE SEARCH @YM07310 50000000
OPCIPLCT DS    X .                 COUNT OF 3705'S BEING IPLED @YM08447 50500000
OPCAVBUF DS    H .                 NO. OF UNITS IN OPC FREE POOL        51000022
         SPACE                                                          52000022
OPCBFIRS DS    F .                 ADDRESS OF FIRST UNIT IN FREE POOL   53000022
OPCBFEND DS    F .                 CURRENT UNIT END (IGC0110D)          54000022
         SPACE                                                          55000022
OPCSPEC  DS    X .                 FLAGS SET ONLY BY IEDQCA             56000022
         SPACE                                                          57000022
*   BIT DEFINITIONS FOR OPCSPEC FIELD                                 * 58000022
OPCALTD  EQU   X'80' .                  ALTERNATE DESTINATION SPECIFIED 59000022
OPCPART  EQU   X'40' .                  PARTIAL UNIT REQUEST            60000022
OPCRSTRT EQU   X'20' .                  RESTART IN PROGRESS             61000022
OPCFRMCA EQU   X'10' .                  INITIAL ENTRY (TO 00)    S22024 61300022
*                                       FROM IEDQCA              S22024 61600022
         SPACE                                                          62000022
OPCOQSW  DS    X .                 SWITCH, INDICATES OUTPUT BUSY (FF)   63000022
OPCHNEND DS    2H .                EXECUTED TEST FOR END OF BUFFER UNIT 64000022
OPCSTCBS DS    X .                 SWITCH TO INDICATE STCB BUSY (FF)    65000022
OPCEND   DS    X .                 TEST BYTE FOR END OF BUFFER          66000022
OPCCKCIB DS    A                        ADDR OF CMD CHECK RTN  @YA04391 66500061
OPPOLSTP DS    A  .                     ADDRESS OF POLLSTOP    @XA09783 66700000
OPCRQCNT DS    H .                 FID1 SC/NC COUNTER/SEQ      @Y17XAXU 66800000
OPCADGOT DS    H .                 NO OF BUFF UNITS A/D USING  @Y17XAXF 66810000
OPCWRKSP DS    7F .                INTERNAL SAVE AREA          @Y17XAXF 66830000
OPCBUFWT DS    A .                 ANCHOR FOR REDRIVE OPCE'S   @Y17XAXF 66834000
*                                   WAITING ON BUFFER UNITS    @Y17XAXF 66838000
OPCDECR  DS    A .                 ADDR OF ADGOT DECREMENT RTN @Y17XAXF 66842000
*                                   A(DECRCT)                  @Y17XAXF 66846000
OPCAPXTL DS    A (OPCXCTL2)        ADDR TO XCTL LIST FOR APPL  @Y17XAXF 66850000
*                                   PROGRAM USAGE              @Y17XAXF 66854000
OPCTOTCK DS    A .                 @ TOTE HIERARCHY SCAN RTN   @Y17XAXF 66857000
OPCWAITV DS    A .                 VARY WAIT CHAIN FOR 3705             66858000
*                                  RESOURCES                   @Y17XAXF 66859000
*                                                                       66860000
OPCPWCOB DS    0CL12 .             OPERATOR CONTROL QCB        @YM08403 66866000
OPCPWQCB DS    0F .                                            @YM08403 66872000
OPCPWVTO DS    XL1 .               VTO                         @YM08403 66878000
OPCPWCHN DS    AL3 .               CHAIN OF ELEMENTS           @YM08403 66884000
OPCPWECB DS    0F .                ECB                         @YM08403 66890000
OPCPWCCC DS    XL1 .               COMPLETION CODE             @YM08403 66896000
         DS    AL3 .               UNUSED                      @YM08403 66902000
         DS    XL1 .               UNUSED                      @YM08486 66908000
         DS    AL3 .               NEXT STCB                   @YM08486 66914000
OPCSCOFF EQU   X'04' .              ENTRY OFFSET IN OPCDCBLK   @Y17XAXU 66920000
         DS    140F .                   RESIDENT WORKAREA      @Y17XAXF 66924000
         DS    XL8 .                    XCTL FIELD             @Y17XAXF 66928000
         DS    XL152 .                  LCB FIELD              @Y17XAXF 66932000
         DS    XL84 .                   SCB FIELD              @Y17XAXF 66936000
OPCDSRWT DS    F .                 DISPLAY STORE QUEUE         @ZM47883 66938010
OPCBOTTM EQU   *                        END OF MAPPING         @Y17XAXU 66940000
OPCLEN   EQU   OPCBOTTM-IEDQOPCD .      SIZE OF MAPPING        @Y17XAXU 66960000
         SPACE 2                                                        67000022
         MEND ,                                           */            68000022
*%PLSOPAVT:;                                                            68200022
*/*                                                          @Y17XAXF*/ 68220000
*/*  COMMANDS ENTERED FROM CONSOLE OR TERMINAL               @Y17XAXF*/ 68240000
*/*                                                          @Y17XAXF*/ 68260000
*DCL OCVARY BIT(8) CONSTANT('28'X);     /*VARY COMMAND       @Y17XAXF*/ 68280000
*DCL OCHALT BIT(8) CONSTANT('3C'X);     /*HALT COMMAND       @Y17XAXF*/ 68300000
*DCL OCMODIFY BIT(8) CONSTANT('44'X);   /*MODIFY COMMAND     @Y17XAXF*/ 68320000
*DCL OCDSPLAY BIT(8) CONSTANT('68'X);   /*DISPLAY COMMAND    @Y17XAXF*/ 68340000
*DCL OCHOLD BIT(8) CONSTANT('6C'X);     /*HOLD COMMAND       @Y17XAXF*/ 68360000
*DCL OCRLEASE BIT(8) CONSTANT('70'X);   /*RELEASE COMMAND    @Y17XAXF*/ 68380000
*/*                                                          @Y17XAXF*/ 68400000
*/*  TOTE OR MPP COMMANDS                                    @Y17XAXF*/ 68420000
*/*                                                          @Y17XAXF*/ 68440000
*DCL OCCLOSEQ BIT(8) CONSTANT('10'X);   /* CLOSEDOWN - QUICK @Y17XAXF*/ 68460000
*DCL OCCLOSEF BIT(8) CONSTANT('11'X);   /* CLOSEDOWN - FLUSH @Y17XAXF*/ 68480000
*DCL OCSTARTL BIT(8) CONSTANT('40'X);   /* START LINE CMD    @Y17XAXF*/ 68500000
*DCL OCSTOPL BIT(8) CONSTANT('41'X);    /* STOP LINE COMMAND @Y17XAXF*/ 68520000
*DCL OCSTARTB BIT(8) CONSTANT('45'X);   /* START TERM (BOTH) @Y17XAXF*/ 68540000
*DCL OCSTARTT BIT(8) CONSTANT('46'X);   /* TOTE START TERM   @Y17XAXF*/ 68560000
*DCL OCSTOPB BIT(8) CONSTANT('47'X);    /* STOP TERM (BOTH)  @Y17XAXF*/ 68580000
*DCL OCDEACT BIT(8) CONSTANT('48'X);    /* TOTE DEACTIVATE   @Y17XAXF*/ 68600000
*DCL OCICHNG BIT(8) CONSTANT('49'X);    /* ICHNG COMMAND     @Y17XAXF*/ 68620000
*DCL OCTCHNG BIT(8) CONSTANT('56'X);    /* TCHNG COMMAND     @Y17XAXF*/ 68630000
*DCL OCMRLSE BIT(8) CONSTANT('87'X);    /* MRELEASE COMMAND  @Y17XAXF*/ 68640000
*DCL OCHOLDT BIT(8) CONSTANT('88'X);    /* TOTE HOLD COMMAND @Y17XAXF*/ 68660000
*DECLARE                                                                73000022
*  1 IEDQOPCD BDY(DWORD) BASED(ROPCAVT),                                73200022
*                                                                       73400022
*/*            OPERATOR CONTROL ADDRESS VECTOR TABLE                 */ 73600022
*/*            VERSION DATE  JUNE  7, 1974                    Y30X8XE*/ 73800008
*                                                                       74000022
*   2 OPCDOUBL    CHAR(8),               /* . WORK SPACE FOR            74200022
*                                           TRANSIENTS               */ 74400022
*                                                                       74600022
*   2 OPCAVTPT    PTR(31),               /* . ADDRESS OT TCAM AVT    */ 74800022
*   2 OPCCOPCE    PTR(31),               /* . ADDRESS OF CURRENT        75000022
*                                           ELEMENT (OPCE)           */ 75200022
*   2 OPCDCBLK    PTR(31),               /* . ADDRESS OF DCB, RLN,      75400022
*                                           ADDRESS LOOK-UP          */ 75600022
*   2 OPCOPTLK    PTR(31),               /* . ADDRESS OF OPTION         75800022
*                                           FIELD LOOK-UP CODE       */ 76000022
*   2 OPCTOFLK    PTR(31),               /* . ADDRESS TO GET TNT        76200022
*                                           OFFSET,TERM ENTRY        */ 76400022
*   2 OPCIPLAD    PTR(31),              /* ADDR OF IPL DCB   @Y17XAXU*/ 76500000
*   2 *           PTR(31),               /* . UNUSED           X03039*/ 76600008
*   2 OPCLCB      PTR(31),               /* . ADDRESS OF LCB SET UP     77000022
*                                           ROUTINE                  */ 77200022
*   2 OPCPGCK     PTR(31),           /* . IN-PROG CHECK AND             77230000
*                                       SET ROUTINE          @Y17XAXU*/ 77260000
*   2 OPCTNTEA    PTR(31),           /* . FIND TNT RTN       @Y17XAXU*/ 77290000
*   2 OPCPSTWT    PTR(31),           /* TPOST-TWAIT RTN                 77320000
*                                       ROUTINE              @Y17XAXF*/ 77330000
*   2 OPCTRMWA    PTR(31),               /* . WORKAREA FOR TERM         77600022
*                                           ENTRY ADDRESS            */ 77800022
*   2 OPCSAVE (18) FIXED(31),        /* OP CTL SAVE AREA     @Y17XAXU*/ 78000000
*                                                                       78200022
*/* DO NOT INSERT CARDS OR MOVE CARDS BETWEEN THESE COMMENTS         */ 78400022
*   2 OPCQCBAD    PTR(31),               /* . ADDRESS OF OPC QCB     */ 78600022
*   2 OPCRSAVE (2) PTR(31),              /* . BASE AND RETURN           78800022
*                                           SAVEAREA (IGC0010D)      */ 79000022
*   2 OPCWORK     PTR(31),               /* . ADDRESS OF RESIDENT       79200022
*                                           WORKAREA                 */ 79400022
*   2 OPCWRKSZ    FIXED(15),             /* . SIZE OF RESIDENT          79600022
*                                           WORKAREA                 */ 79800022
*   2 OPCFLAG1    CHAR(1),               /* . FLAG BYTE FOR             80000022
*                                           TRANSIENT USE            */ 80200022
*   2 OPCFLAG2    CHAR(1),               /* . FLAG BYTE FOR             80400022
*                                           TRANSIENT USE            */ 80600022
*   2 OPCBFERB (4) FIXED(31),            /* . BUFFER REQUEST ERB    */  80800022
*/* DO NOT INSERT CARDS OR MOVE CARDS BETWEEN THESE COMMENTS        */  81000022
*                                                                       81200022
*   2 OPCCKERB (4) FIXED(31),            /* . CHECKPOINT REQUEST ERB */ 81400022
*   2 OPCAQCTL (3) FIXED(31),     /* SVC 102 PARAMETER LIST  @Y17XAXF*/ 81500000
*   2 OPCWAIT  (3) FIXED(31),            /* . OP CONTROL INPUT WAIT     81800022
*                                           LIST                     */ 82000022
*   2 OPCXCTL  (2) PTR(31),              /* . LIST FORM OF XCTL,        82200022
*                                           USED BY TRANSIENT        */ 82400022
*   2 OPCLDNME    CHAR(8),           /* . XCTL MOD NAME      @Y17XAXU*/ 82600000
*    3 *          CHAR(3),           /* . MODULE NAME                   82630000
*                                       PREFIX               @Y17XAXU*/ 82660000
*    3 OPCMODID   CHAR(2),           /* . MODULE ID          @Y17XAXU*/ 82690000
*    3 *          CHAR(3),           /* . MODULE NAME                   82720000
*                                       SUFFIX               @Y17XAXU*/ 82750000
*                                                                       82800022
*   2 OPCWAITC    PTR(31),               /* . QCW FOR CHECKPOINT        83000022
*                                           WAIT QUEUE               */ 83200022
*   2 OPCWAITL    PTR(31),               /* . QCW FOR LCB WAIT LIST  */ 83400022
*   2 OPCWAITN    PTR(31),           /* . FID0 RESPONSE                 83600000
*                                       WAIT CHAIN           @Y17XAXU*/ 83800000
*   2 OPCWAITO    PTR(31),               /* . OUTPUT QUEUE QCW       */ 84000022
*   2 OPCWAITP    PTR(31),           /* SSCP OPCE Q FOR                 84060000
*                                       ACTPU'S              @Y17XAXU*/ 84120000
*   2 OPCWAITR    PTR(31),               /* . QCW FOR RESOURCE WAIT     84200022
*                                           QUEUE                    */ 84400022
*   2 OPCWAITA   PTR(31),            /* . QCW FOR ACT/DEACT             84410000
*                                       WAIT CHAIN           @Y17XAXU*/ 84415000
*   2 OPCCKPTF   PTR(31),            /* . FIRST OPCE FOR                84430000
*                                       CHECKPOINT           @Y17XAXU*/ 84440000
*   2 OPCCKPTL   PTR(31),            /* . LAST OPCE FOR                 84450000
*                                       CHECKPOINT           @Y17XAXU*/ 84460000
*   2 OPCHORT    PTR(31),            /* . COHORT SEARCH                 84470000
*                                       ROUTINE              @Y17XAXU*/ 84480000
*   2 OPCHORTG   PTR(31),            /* . COHORTG SEARCH                84490000
*                                       ROUTINE              @Y17XAXU*/ 84500000
*   2 OPCSCNC    PTR(31),            /* . FID1 EXPEDITE FLOW            84510000
*                                         OR TS PROFILE 1               84520000
*                                         WAIT CHAIN         @Y17XAXU*/ 84530000
*   2 OPCFMDFC   PTR(31),            /* . ALL OTHER FID1'S              84540000
                                          WAIT CHAIN         @Y17XAXU*/ 84550000
*                                                                       84600022
*   2 OPCNEXT     PTR(31),               /* . ADDRESS OF ELEMENT NOW    84800022
*                                           CURRENT                  */ 85000022
*   2 OPCGETBF    PTR(31),               /* . ADDRESS OF BUFFER         85200022
*                                           REQUEST ROUTINE          */ 85400022
*   2 OPCFREBF    PTR(31),               /* . ADDRESS OF BUFFER UNIT    85600022
*                                           FREE ROUTINE             */ 85800022
*                                                                       86000022
*   2 OPCBFREQ    FIXED(15),             /* . NO. OF UNITS NEEDED BY    86200022
*                                           WAIT LIST                */ 86400022
*   2 OPCHA8      FIXED(15),             /* . HALF WORD SET TO EIGHT */ 86600022
*   2 OPCCLNTS    BIT(8),                /* TEST-&-SET SWITCH FOR    */ 86800000
*                                        /* QUEUE SEARCH     @YM07310*/ 86900000
*   2 OPCIPLCT    FIXED(8),              /* COUNT OF 3705'S BEING IPLED 87000000
*                                                            @YM08447*/ 87100000
*   2 OPCAVBUF    FIXED(15),             /* . NO. OF UNITS IN OPC       87200022
*                                           FREE POOL                */ 87400022
*                                                                       87600022
*   2 OPCBFIRS    PTR(31),               /* . ADDRESS OF FIRST UNIT     87800022
*                                           IN FREE POOL             */ 88000022
*   2 OPCBFEND    PTR(31),               /* . CURRENT UNIT END          88200022
*                                           (IGC0110D)               */ 88400022
*                                                                       88600022
*   2 OPCSPEC     CHAR(1),               /* . FLAGS SET ONLY BY         88800022
*                                           IEDQCA                   */ 89000022
*                                                                       89200022
*/* BIT DEFINITIONS FOR OPCSPEC FIELD                                */ 89400022
*    3 OPCALTD  BIT(1),                  /* . ALTERNATE DESTINATION     89600022
*                                           SPECIFIED                */ 89800022
*    3 OPCPART  BIT(1),                  /* . PARTIAL UNIT REQUEST   */ 90000022
*    3 OPCRSTRT BIT(1),                  /* . RESTART IN PROGRESS    */ 90200022
*    3 OPCFRMCA  BIT(1),                 /* INITIAL ENTRY (TO 00)       90400022
*                                         FROM IEDQCA          S22024*/ 90600000
*    3 *        BIT(1),                  /* RESERVED                 */ 90800022
*    3 *        BIT(1),                  /* RESERVED                 */ 91000022
*    3 *        BIT(1),                  /* RESERVED                 */ 91200022
*    3 *        BIT(1),                  /* RESERVED                 */ 91400022
*                                                                       91600022
*   2 OPCOQSW     CHAR(1),               /* . SWITCH, INDICATES         91800022
*                                           OUTPUT BUSY (FF)         */ 92000022
*   2 OPCHNEND (2) FIXED(15),            /* . EXECUTED TEST FOR END     92200022
*                                           OF BUFFER UNIT           */ 92400022
*   2 OPCSTCBS    CHAR(1),               /* . SWITCH TO INDICATE        92600022
*                                           STCB BUSY (FF)           */ 92800022
*   2 OPCEND    CHAR(1),         /* TEST BYTE FOR END OF     @Y17XAXU   93000000
*                                           BUFFER                   */ 93200022
*   2 OPCCKCIB  PTR(31),                  /*ADDR OF CMD REMOV@YA04391*/ 96200000
*   2 OPPOLSTP   PTR(31),            /* . ADDR OF POLSTOP               97200000
*                                                            @YA04391*/ 97800000
*   2 OPCRQCNT   FIXED(15),             /* FID1 SC/NC CTR/SEQ           98400000
*                                       NUMBER               @Y17XAXU*/ 99000000
*   2 OPCADGOT   FIXED(16),             /* NO OF BUFF UNITS  @Y17XAXF*/ 99030000
*                                       /*  A/D USING        @Y17XAXF*/ 99032000
*   2 OPCWRKSP(7) PTR(31),              /* INTERNAL SAV AREA @Y17XAXF*/ 99032300
*   2 OPCBUFWT    PTR(31),              /* ANCHOR FOR REDRIVE OPCE'S */ 99032600
*                                       /*  WAITING ON BUFFER UNITS  */ 99032900
*                                       /*                   @Y17XAXF*/ 99033200
*   2 OPCDECR     PTR(31),              /* ADDR OF ADGOT DECREMENT   */ 99033500
*                                       /*  ROUTINE          @Y17XAXF*/ 99033800
*   2 OPCAPXTL    PTR(31),              /* ADDR TO XCTL LIST FOR     */ 99034100
*                                       /*  APPL PGM USAGE   @Y17XAXF*/ 99034400
*   2 OPCTOTCK    PTR(31),              /* ADDR OF TOTE HIERARCHY    */ 99034700
*                                       /* SCAN ROUTINE      @Y17XAXF*/ 99035000
*   2 OPCWAITV    PTR(31),              /* VARY WAIT CHAIN FOR          99035200
*                                          3705 RESOURCES    @Y17XAXF*/ 99035500
*   2 OPCPWCOB BDY(WORD),               /* OPERATOR CNTL QCB @YM08403*/ 99035700
*    3 OPCPWQCB,                        /*                   @YM08403*/ 99036000
*     4 OPCPWVTO CHAR(1),               /* VTO               @YM08403*/ 99036500
*     4 OPCPWCHN PTR(24),               /* CHAIN OF ELEMENTS @YM08403*/ 99036700
*    3 OPCPWECB,                        /* ECB               @YM08403*/ 99037000
*     4 OPCPWCCC CHAR(1),               /* COMPLETION CODE   @YM08403*/ 99037200
*     4    *     PTR(24),               /* UNUSED            @YM08403*/ 99037500
*    3   *      CHAR(1),                /* UNUSED            @YM08486*/ 99037700
*    3   *      PTR(24),                /* NEXT STCB         @YM08486*/ 99038000
*   2 *           CHAR(560),            /* RESIDENT WORKAREA @Y17XAXF*/ 99039200
*   2 *           CHAR(8),              /* XCTL FIELD        @Y17XAXF*/ 99039400
*   2 *           CHAR(152),            /* LCB FIELD         @Y17XAXF*/ 99039600
*   2 *           CHAR(84),             /* SCB FIELD         @Y17XAXF*/ 99039800
*   2 OPCDSRWT FIXED(31),               /* DSPLY STORE QUEUE @ZM47883*/ 99039910
*   2 OPCBOTTM   CHAR(0);               /* END OF MAPPING    @Y17XAXU*/ 99040000
* %OPCLEN='LENGTH(IEDQOPCD)';           /* SIZE OF MAPPING   @Y17XAXU*/ 99060000
*/*      CONSTANTS                                                   */ 99100000
*                                                                       99200000
*DCL OPCSCOFF BIT(8) CONSTANT('04'X); /* ENTRY OFFSET IN                99300000
*                                        OPCDCBLK ROUTINE    @Y17XAXU*/ 99400000
* DECLARE                                                               99440000
*    1 OPCAQWD  DEF(OPCAQCTL),                                          99480000
*     2 OPCAQWD1 FIXED(31),        /* LIST WORD 1            @Y17XAXF*/ 99520000
*      3 OPCAQREQ CHAR(1),         /*  SVC REQUEST CODE      @Y17XAXF*/ 99560000
*      3 OPCAQFST PTR(24),         /*  FIRST ADDR OR INDEX   @Y17XAXF*/ 99600000
*     2 OPCAQWD2 FIXED(31),        /* LIST WORD 2            @Y17XAXF*/ 99640000
*      3 OPCAQRQ2 CHAR(1),         /*  ACTION CODE           @Y17XAXF*/ 99680000
*      3 OPCAQSEC PTR(24),         /*  SECOND ADDR OR INDEX  @Y17XAXF*/ 99720000
*     2 OPCAQWD3 FIXED(31),        /* LIST WORD 3            @Y17XAXF*/ 99760000
*      3 OPCAQRQ3 CHAR(1),         /*  ACTION CODE           @Y17XAXF*/ 99800000
*      3 OPCAQLST PTR(24);         /*  LAST ADDR OR INDEX    @Y17XAXF*/ 99840000
./  ADD  SSI=60241443,NAME=TOPCD
         MACRO                                                          01000020
         TOPCD                                                          02000020
IEDQOPC  DSECT                                                          03000020
.*             VERSION DATED JULY 24, 1970                              04000020
OPCINPUT DS    A .                      ADDRESS OF INPUT DATA           05000020
OPCAVTAD DS    A .                      ADDRESS OF TCAM AVT             06000020
OPCDOUBL DS    D .                      DOUBLEWORD WORK AREA            07000020
OPCWORK  DS    A .                      FULLWORD WORK AREA              08000020
OPCEPS   DS    8X .                     EPLOC FOR C1                    09000020
         DS     3X                                                      10000020
OPCCOUNT DS    FL1 .                    COUNT OR RETURN CODE     STCAM4 11000010
OPCSAVE1 DS    18F .                    IEDQCA SAVE AREA                12000020
OPCSAVE2 DS    0FL10 .                  PARTIAL SAVE - WORK AREA STCAM4 12400010
         DS    8F .                                              STCAM4 12800010
OPCDATA  DS    F .                                               STCAM4 13200010
         DS    F .                                               STCAM4 13600010
OPCPPL   DS    8X .                     POST PARAMETER LIST - AQCTL     14000020
OPCSCAN  DS    A .                      ADDR OF IEDQCA02 - SCAN         15000020
OPCERMSG DS    49C .                    CANCEL COMMAND MESSAGE          16000020
OPCBITSW DS    X .                      OP CTL BIT SWITCHES             17000020
OPCCONSN EQU   X'80' .                  SOURCE IS CONSOLE               18000020
OPCMPPN  EQU   X'40' .                  SOURCE IS APPLICATION PROG      19000020
OPCMCPN  EQU   X'20' .                  SOURCE IS MSG CONTROL           20000020
OPCPROCN EQU   X'10' .                  PROCESS BIT                     21000020
OPCFRSTN EQU   X'08' .                  FIRST-TIME BIT                  23000020
OPCLCLN  EQU   X'04' .                  LOCAL WAIT BIT                  25000020
OPCQUCKN EQU   X'02' .                  ON - CLOSEDOWN IS QUICK         27000020
OPCTEMPN EQU   X'01' .                  WORK BIT                        29000020
OPCPROCF EQU   X'EF' .                                           STCAM4 29300010
OPCFRSTF EQU   X'F7' .                                           STCAM4 29600010
OPCCLCLF EQU   X'FB' .                                           STCAM4 29900010
OPCFLSHF EQU   X'FD' .                  OFF-FLUSH CLOSEDOWN      STCAM4 30200010
OPCTEMPF EQU   X'FE' .                                           STCAM4 30500010
         DS    X .                      ONE-BYTE WORK AREA - IEDQCA     31000020
OPCCKBIT DS    X .                      CHECKPOINT/RESTART BITS         32000020
OPCRSTN  EQU   X'80' .                  RESTART IN PROGRESS             33000020
OPCCKPTN EQU   X'40' .                  CHECKPOINT TO BE DONE           35000020
OPCINVN  EQU   X'20' .                  CHECKPOINT FOR INVLISTS         37000020
OPCRSTF  EQU   X'7F' .                                           STCAM4 37500010
OPCCKPTF EQU   X'BF' .                                           STCAM4 38000010
OPCINVF  EQU   X'DF' .                                           STCAM4 38500010
OPCCKELE DS    0CL32 .                  COMMON INPUT AREA        STCAM4 38590010
OPCED    DS    CL1 .                                             STCAM4 38680010
OPCIND   DS    FL1 .                                             STCAM4 38770010
OPCBIT1  DS    XL1 .                                             STCAM4 38860010
OPCBIT2  DS    XL1 .                                             STCAM4 38950010
OPCLEN   DS    FL1 .                                             STCAM4 39040010
OPCRLN   DS    CL3 .                                             STCAM4 39130010
OPCTNME  DS    CL8 .                                             STCAM4 39220010
OPCVBCD1 DS    CL1 .                                             STCAM4 39310010
OPCVBCD2 DS    CL1 .                                             STCAM4 39400010
OPCFLG   DS    XL1 .                                             STCAM4 39490010
OPCINFO  DS    XL1 .                                             STCAM4 39580010
OPCSNSE  DS    XL2 .                                             STCAM4 39670010
OPCOTHR  DS    CL2 .                                             STCAM4 39760010
OPCOPFLD DS    CL8 .                                             STCAM4 39850010
OPCMISC  DS    0X .                     MISCELLANEOUS DATA - IEDQCA     40000020
*                                                                       41000020
*              OPERATOR CONTROL EQUATES                                 42000020
*                                                                       43000020
OPCFOXES EQU   X'FF' .                                           STCAM4 44000010
OPCOSMOD EQU   X'44' .                  OS VERB CODE FOR MODIFY  STCAM4 45000010
OPCFIXT  EQU   X'2A' .                  1ST ENTRY OFFSET IN TNT  STCAM4 46000010
OPCTXTLN EQU   X'20' .                  LENGTH OF CIB            STCAM4 47000010
OPCREG1  EQU   X'18' .                  OFFSET TO REG1 IN S.A.   STCAM4 48000010
OPCFLUSH EQU   X'11' .                  FLUSH HALT CODE          STCAM4 49000010
OPCQUICK EQU   X'10' .                  QUICK HALT CODE          STCAM4 50000010
OPCTEN   EQU   X'0A' .                                           STCAM4 51000010
OPCNINE  EQU   X'09' .                                           STCAM4 52000010
OPCEIGHT EQU   X'08' .                  DOUBLE-WORD OFFSET       STCAM4 53000010
OPCSEVEN EQU   X'07' .                                           STCAM4 54000010
OPCSIX   EQU   X'06' .                                           STCAM4 55000010
OPCFIVE  EQU   X'05' .                                           STCAM4 56000010
OPCFOUR  EQU   X'04' .                  FULLWORD OFFSET          STCAM4 57000010
OPCTHREE EQU   X'03' .                                           STCAM4 58000010
OPCTWO   EQU   X'02' .                  HALFWORD OFFSET          STCAM4 59000010
OPCONE   EQU   X'01' .                  BYTE OFFSET, INITIAL CT. STCAM4 60000010
OPCZERO  EQU   X'00' .                                           STCAM4 61000010
         MEND                                                           79000020
./  ADD  SSI=80730209,NAME=TOPCED
*        %GOTO PLSOPCE;                             /*                  00400022
         MACRO                                                          00900022
         TOPCED                                                         01800000
.*A-000000-999999                                              @X31X8X0 02100008
.*C063000,919800,970800                                        @Z30X8XE 02400008
.*C108000,144000,513000,765000,810000,828000,909000,938000     @Y17XAXU 02400100
.*C953000,959000,966000,997200                                 @Y17XAXU 02410100
.*A108000,144000,513000,765000,810000,828000,909000,938000     @Y17XAXU 02420100
.*A953000,959000,966000,997200                                 @Y17XAXU 02430100
.*A959200,953700,836000,999140,855000,607800,997800,966000     @Y17XAXF 02440100
.*A909000                                                      @Y17XAXF 02450100
.*D953100-953500,766000-768000                                 @Y17XAXF 02460100
.*C774000,828000-829000,973000-980000                          @Y17XAXF 02470100
.*A608375,997842                                               @OY19405 02470282
IEDOPC   DSECT                                                 @Y17XAXF 02480100
IEDQOPCN EQU   *                        OPCE NEG PREFIX        @Y17XAXF 02490100
OCLDNME  DS    0CL8 .                   LOAD MODULE MISMATCH   @Y17XAXF 02493100
*                                        NAME                  @Y17XAXF 02496100
OCLINTTE DS    0F .                     LINE TTE ADDR (M6-MB)  @Y17XAXF 02500100
OCRESPCT DS    CL2 .                    OUTSTANTDING RSP CNT   @Y17XAXF 02510100
OCREQFLG DS    X .                      OP SERV REQ FLAG       @Y17XAXF 02520100
OCFLUSHZ EQU   X'80' .                   Z,TP,FLUSH REQUEST FOR DEACT   02530100
*                                         NCP                  @Y17XAXF 02531100
*        EQU   X'40'-X'20' .             RESERVED              @Y17XAXF 02532100
OCADNCP  EQU   X'10' .                   NCP ACT/DEACT COMMAND @Y17XAXF 02535100
OCPARTAL EQU   X'08' .                   PARTIAL ACT FLAG      @Y17XAXF 02540100
OCDCARD  EQU   X'04' .                   DISCARD FLAG          @Y17XAXF 02550100
OCFORCE  EQU   X'02' .                   FORCE FLAG            @Y17XAXF 02560100
OCIDLE   EQU   X'01' .                   IDLE FLAG             @Y17XAXF 02570100
OCPREFLG DS    X .                      GENERAL FLAG BYTE      @Y17XAXF 02575100
OCBFREQ  EQU   X'80'                     CLEAUP BUFF REQUESTED @Y17XAXF 02575200
OCRSPSNT EQU   X'40'                     CLEANUP RESPONSE SENT @Y17XAXF 02575300
OCREPOST EQU   X'20'                     CLEANUP REPOST REQ    @Y17XAXF 02575400
OCTOTEP  EQU   X'10'                     TOTE POST REQUEST     @Y17XAXF 02575500
*        EQU   X'08'-X'01'               RESERVED              @Y17XAXF 02575600
         DS    F .                      RESERVED               @Y17XAXF 02576100
OCPREFSZ EQU   *-IEDQOPCN               PREFIX SIZE            @Y17XAXF 02590100
         SPACE                                                          02700022
IEDQOPCE EQU   *                                               @Y17XAXF 03600000
         SPACE                                                          04500022
*              OPERATOR CONTROL ELEMENT                                 05400022
*              VERSION DATE  JUNE  7, 1974                     @Z30X8XE 06300008
         SPACE                                                          07200022
OCLINK   DS    F .                 LINK TO NEXT OPCE ON WAIT QUEUE      09000022
         SPACE                                                          09900022
OCELEM   DS    0F .                LINK TO ATTACHED UNITS      @Y17XAXU 10800000
         SPACE                                                          10850000
OCELMPRI DS    XL1 .               ELEMENT PRIORITY            @Y17XAXU 11100000
OCELMPTR DS    AL3 .               PTR TO ATTACHED ELEMENT     @Y17XAXU 11400000
         SPACE                                                          11700022
OCRUDEST DS    0F .                OPCE WAITING FOR A RESP     @Y17XAXU 12100000
OCUNIT   DS    0F .                LINK TO ATTACHED UNITS      @Y17XAXF 12600000
OCSCAN   DS    0X .                     BYTE USED BY OPCSCAN   @0Y12425 12610000
OCDDADDR EQU   X'A0' .                  VALUE INDICATES TO DCB LOOK     12620000
*                                       UP THAT REG 11 POINTS TO        12630000
*                                       EITHER A DDNAME OR CHANNEL ADDR 12640000
*              INPUT TO OPCSCAN RTN FROM SCAN MODS             @OY12425 12650000
OCADDR   EQU   X'80' .                  ADDR ONLY              @OY12425 12660000
OCDDNRLN EQU   X'40' .                  DDN,RLN ONLY           @OY12425 12670000
OCDDNAME EQU   X'20' .                  DDNAME ONLY            @OY12425 12680000
OCALLRLN EQU   X'10' .                  RLN CAN BE ALL         @OY12425 12690000
*              OPSCAN OUTPUT AFFECTS THESE BITS                @OY12425 12700000
OCNONAME EQU   X'08' .                  NAME NOT FOUND         @OY12425 12710000
OCNOTUCB EQU   X'04' .                  NOT A UCB ADDR         @OY12425 12720000
OCCKPKEY DS    XL1 .               OPERATOR CONTROL CKECKPOINT KEY      12800000
*                                                              @Y17XAXF 13000000
*OCCKPTYP      X'80'-X'20' .            TYPE OF CKPT REQUEST   @Y17XAXF 13020000
OCCKPINC EQU   X'80' .                   REQUEST INCIDENT CKPT @Y17XAXF 13040000
OCCKPNOP EQU   X'40' .                   REQUEST 3705 CKPT     @Y17XAXF 13060000
OCCKPRST EQU   X'20' .                   REQUEST 3705 RESTART RECORDS   13080000
*                                                              @Y17XAXF 13100000
OCCKPENV EQU   X'10' .                   ENVIRONMENT CKPT IS TO BE      13120000
*                                         FORCED               @Y17XAXF 13140000
*        EQU   X'08'-X'01'               RESERVED              @Y17XAXF 13160000
         DS    AL3 .               RESERVED                    @Y17XAXF 13200000
         SPACE                                                          13500022
OCOPTCDE DS    0X .                COMMAND OPERATION CODE      @Y17XAXU 14400000
OCPRIFLG DS    XL1 .               PRIORITY FLAG FIELD         @Y17XAXU 14800000
         SPACE                                                          15300022
*   COMMANDS ENTERED FROM CONSOLE OR TERMINAL                         * 16200022
OCVARY   EQU   X'28' .                  VARY COMMAND                    17100022
OCHALT   EQU   X'3C' .                  HALT COMMAND                    18000022
OCMODIFY EQU   X'44' .                  MODIFY COMMAND                  18900022
OCDSPLAY EQU   X'68' .                  DISPLAY COMMAND                 19800022
OCHOLD   EQU   X'6C' .                  HOLD COMMAND                    20700022
OCRLEASE EQU   X'70' .                  RELEASE COMMAND                 21600022
         SPACE                                                          22500022
*   TOTE OR MPP COMMANDS                                              * 23400022
OCCLOSEQ EQU   X'10' .                  CLOSEDOWN - QUICK               24300022
OCCLOSEF EQU   X'11' .                  CLOSEDOWN - FLUSH               25200022
OCSTARTL EQU   X'40' .                  START LINE COMMAND              26100022
OCSTOPL  EQU   X'41' .                  STOP LINE COMMAND               27000022
OCSTARTB EQU   X'45' .                  START TERMINAL (BOTH)           27900022
OCSTARTT EQU   X'46' .                  TOTE START TERMINAL COMMAND     28800022
OCSTOPB  EQU   X'47' .                  STOP TERMINAL (BOTH)            29700022
OCDEACT  EQU   X'48'                    TOTE DEACTIVATE                 30600022
OCICHNG  EQU   X'49' .                  ICHNG COMMAND                   31500022
OCTCHNG  EQU   X'56' .                  TCHNG COMMAND                   31900000
OCMRLSE  EQU   X'87' .                  MRELEASE COMMAND                32400022
OCHOLDT  EQU   X'88'                    TOTE HOLD COMMAND               33300022
         SPACE                                                          34200022
OCSWITCH DS    X .                 OPERATION SUB-TYPE                   35100022
OCQUCKN  EQU   X'80' .                  REQUEST FOR QUICK CLOSEDOWN     35300000
*                                                              @Y17XAXF 35500000
*        EQU   X'40'-X'01'              RESERVED               @Y17XAXF 35700000
         SPACE                                                          36000022
*   OPERATOR CONTROL EQUATES FOR OCSWITCH                             * 36900022
OCX01    EQU   X'01' .                  HEX 01                          37800022
OCX02    EQU   X'02' .                  HEX 02                          38700022
OCX03    EQU   X'03' .                  HEX 03                          39600022
OCBKUP   EQU   X'03' .             MODIFY 3705 AS AVAILABLE FOR BACKUP  39900000
*                                                              @Y17XAXF 40200000
OCX04    EQU   X'04' .                  HEX 04                          40500022
OCX05    EQU   X'05' .                  HEX 05                          41400022
OCOFFTPE EQU   X'05' .             VARY OFFTP E COMMAND        @Y17XAXF 41800000
OCX06    EQU   X'06' .                  HEX 06                          42300022
OCOFFTPB EQU   X'06' .             VARY OFFTP B COMMAND        @Y17XAXF 42700000
OCX07    EQU   X'07' .                  HEX 07                          43200022
OCCHNLD  EQU   X'07' .             MODIFY CHANGE LOAD          @Y17XAXF 43600000
OCX08    EQU   X'08' .                  HEX 08                          44100022
OCX09    EQU   X'09' .                  HEX 09                          45000022
OCX0A    EQU   X'0A' .                  HEX 0A                          45900022
OCDMPC   EQU   X'0A' .             DUMP COMMAND TO MH          @Y17XAXU 46300000
OCONTPE  EQU   X'0A' .             VARY ONTP E COMMAND         @Y17XAXF 46500000
OCX0B    EQU   X'0B' .                  HEX 0B                          46800022
OCONTPB  EQU   X'0B' .             VARY ONTP B COMMAND         @Y17XAXF 47200000
OCX0C    EQU   X'0C' .                  HEX 0C                          47700022
OCX0D    EQU   X'0D' .                  HEX 0D                          48600022
OCX0E    EQU   X'0E' .                  HEX 0E                          49500022
OCX0F    EQU   X'0F' .                  HEX 0F                          50400022
OCACTLU  EQU   X'10' .             ACTLU REQUEST               @Y17XAXU 51300000
OCX10    EQU   X'10' .                  HEX 10                 @Y17XAXU 51700000
OCX11    EQU   X'11' .                  HEX 11                          52200022
OCIPLC   EQU   X'11' .             IPL COMMAND TO MH           @Y17XAXU 52600000
OCSTPLNC EQU   X'11' .             STOPLINE, C REQUEST         @Y17XAXF 52630000
OCSTPLNI EQU   X'12' .             STOPLINE, I REQUEST         @Y17XAXF 52660000
OCX12    EQU   X'12' .                  HEX 12                          53100022
OCX13    EQU   X'13' .                  HEX 13                          54000022
OCX14    EQU   X'14' .                  HEX 14                          54900022
OCX15    EQU   X'15' .                  HEX 15                          55800022
OCX16    EQU   X'16' .                  HEX 16                          56700022
OCSWBACK EQU   X'16' .             MODIFY 3705 BACKUP NCP      @Y17XAXF 57100000
OCX17    EQU   X'17' .                  HEX 17                          57600022
OCX18    EQU   X'18' .                  HEX 18                          58500022
OCX19    EQU   X'19' .                  HEX 19                          59400022
OCX1A    EQU   X'1A' .                  HEX 1A                          60300022
OCBHSET  EQU   X'1D' .             MODIFY BHSET                @Y17XAXF 60307000
OCSESSNL EQU   X'1E' .             CHANGE SESSION LIMIT        @Y17XAXF 60314000
OCTRANL  EQU   X'1F' .             CHANGE TRANSMISSION LIMIT   @Y17XAXF 60321000
OCDACTLU EQU   X'20' .             DACTLU REQUEST              @Y17XAXU 60330000
OCMIDMSG EQU   X'20' .             REMOVE FROM MIDDLE MESSAGE CONDITION 60333000
*                                                              @Y17XAXF 60336000
OCSWDEVB EQU   X'20' .             SWITCH DEVICE BACK-UP       @Y17XAXU 60340000
OCSWDEVP EQU   X'21' .             SWITCH DEVICE PRIMARY       @Y17XAXU 60350000
OCTOFA   EQU   X'22' .             REDRIVE INCIDENT RECORD     @Y17XAXU 60360000
OCACTVTE EQU   X'22' .             ACTIVATE                    @Y17XAXU 60370000
OCTOFC   EQU   X'23' .             REQUEST DEACT               @Y17XAXU 60390000
OCDEACTE EQU   X'23' .             DEACTIVATE                  @Y17XAXU 60394000
OCSWAP   EQU   X'24' .             SWAP DEVICE ID              @Y17XAXU 60398000
OCCHANGE EQU   X'25' .             CHANGE DIAL MODE            @Y17XAXU 60402000
OCOFTPEM EQU   X'25' .             VARY OFFTP EM COMMAND       @Y17XAXF 60404000
OCSSELCT EQU   X'26' .             SELECT MODEM SPEED          @Y17XAXU 60406000
OCOFTPBM EQU   X'26' .             VARY OFFTP BM COMMAND       @Y17XAXF 60408000
OCSWLNME EQU   X'27' .             SWITCH LINE MODE TO EP      @Y17XAXU 60410000
OCSWLNMN EQU   X'28' .             SWITCH LINE MODE TO NCP     @Y17XAXU 60414000
OCPARO   EQU   X'29' .             COMMAND PARSED IN LCB       @Y17XAXU 60420000
OCIOTR   EQU   X'2A' .             START/STOP TRACEING OF      @Y17XAXU 60430000
*                                   LINES IN ERROR             @Y17XAXU 60440000
OCLCBIN  EQU   X'30' .             LCB INPUT TO MH             @Y17XAXU 60450000
OCACTPU  EQU   X'30' .             ACTPU (NON-NCP) REQUEST     @Y17XAXU 60480000
OCFRCDAC EQU   X'37' .             FORCE DECACT REQUEST        @Y17XAXU 60481000
OCCRINOP EQU   X'38' .             CLEANUP REQUEST FOR INOP    @Y17XAXU 60482000
OCCUREQ  EQU   X'39' .             CLEANUP REQUEST             @Y17XAXU 60483000
OCDACTPU EQU   X'40' .             DACTPU (NON-NCP) REQUEST    @Y17XAXU 60487000
OCACTLK  EQU   X'50' .             ACTLINK REQUEST             @Y17XAXU 60540000
OCDACTLK EQU   X'60' .             DACTLINK REQUEST            @Y17XAXU 60570000
OCACTNCP EQU   X'70' .             ACTPU(NCP) REQUEST          @Y17XAXU 60600000
OCCHGSL  EQU   X'80' .             CHANGE SESSION LIMIT REQ    @Y17XAXU 60630000
OCSCANON EQU   X'80' .             SCAN HAS BEEN DONE          @Y17XAXF 60640000
OCCHGNP  EQU   X'90' .             CHANGE NEGATIVE POLL LIMIT  @Y17XAXU 60660000
OCCHGSSP EQU   X'A0' .             CHANGE SERVICE SEEK PAUSE   @Y17XAXU 60690000
OCCHGTL  EQU   X'B0' .             CHANGE XMISSION LIMIT REQ   @Y17XAXU 60720000
OCSWEP   EQU   X'C0' .             SWITCH TO EP MODE REQUEST   @Y17XAXU 60750000
OCSWNCP  EQU   X'D0' .             SWITCH TO NCP MODE REQUEST  @Y17XAXU 60780000
OCVARON  EQU   X'D1' .             INTERNAL VARY ON REQUEST    @Y17XAXF 60790000
OCVAROFF EQU   X'D2' .             INTERNAL VARY OFF REQUEST   @Y17XAXF 60800000
OCSETTD  EQU   X'E0' .             SET TIME/DATE REQUEST       @Y17XAXU 60810000
OCOPYDSM EQU   X'E1' .             COPY DEST. MODE             @Y17XAXF 60816000
OCRPLDSM EQU   X'E2' .             REPLACE DEST MODE           @Y17XAXF 60822000
OCOPYDSI EQU   X'E3' .             COPY DEV SESS INFO          @Y17XAXF 60828000
OCRPLDSI EQU   X'E4' .             REPLACE DEV SESS INFO       @Y17XAXF 60834000
OCSUBT   EQU   X'E5' .             START OR STOP SUBTASK TRACE @Y17XAXF 60837000
OCSESTRM EQU   X'E6' .             SESS TERM REQ TO/FRM LUS    @Y17XAXF 60837500
OCBUF    EQU   X'E7' .                  CHANGE BUFFTR OPTION   @OY19405 60837782
OCDISCON EQU   X'F0' .             DISCONTACT REQUEST          @Y17XAXU 60838000
OCRSTART EQU   X'F1' .             RESTART RECORD REQUEST      @Y17XAXU 60870000
OCSND1   EQU   X'F2' .             RESTART COMMAND             @Y17XAXU 60900000
OCSND2   EQU   X'F3' .             RESTART COMMAND             @Y17XAXU 60930000
OCSND3   EQU   X'F4' .             RESTART COMMAND             @Y17XAXU 60960000
OCSND4   EQU   X'F5' .             RESTART COMMAND             @Y17XAXU 60990000
OCSND5   EQU   X'F6' .             RESTART COMMAND             @Y17XAXU 61020000
OCSND6   EQU   X'F7' .             RESTART COMMAND             @Y17XAXU 61050000
OCSND7   EQU   X'F8' .             RESTART COMMAND             @Y17XAXU 61080000
OCSND8   EQU   X'F9' .             RESTART COMMAND             @Y17XAXU 61110000
OCFOXES  EQU   X'FF' .                  ALL ONES                        61200022
         SPACE                                                          62100022
OCFLAG   DS    X .                 SPECIAL CONDITIONS INDICATOR         63000022
         SPACE                                                          63900022
*   BIT DEFINITIONS FOR OCFLAG FIELD                                  * 64800022
OCCONSOL EQU   X'80' .                  INDICATE CONSOLE INPUT          65700022
OCTOTE   EQU   X'40' .                  TOTE INPUT                      66600022
OCMPP    EQU   X'20' .                  APPLICATION PROG INPUT          67500022
OCLINE   EQU   X'10' .                  INPUT CONTAINED LINE NUMBER     68400022
OCOUTPUT EQU   X'08' .                  MULTIPLE BLOCK OUTPUT           69300022
OCSSCP   EQU   X'04' .                  SSCP INPUT             @Y17XAXF 70200000
OCATTACH EQU   X'02' .                  ELEMENT ATTACHED FOR RESOURCES  71100022
OCRESP   EQU   X'01' .                  THIS ELEMENT IS ASSOC    S22024 71400022
*                                       WITH A RESPONSE BTU      S22024 71700022
         SPACE                                                          72000022
OCRLN    DS    X .                 RELATIVE LINE NUMBER OF DCB          72900022
         SPACE                                                          73800022
OCCIB    DS    0A .                ADDRESS OF INPUT CIB                 74700022
OCCONID  DS    0X .                CONSOLE IDENTIFICATION BYTE          75600022
OCDEST   DS    0H .                DESTINATION OFFSET IN TNT   @Y17XAXU 76500000
OCREQVAL DS    XL1 .               OP SERVICES REQUEST VALUES  @Y17XAXU 76900000
         DS    XL3 .               FILLER FOR BOUNDARY (NOT AVAILABLE)  77400000
*                                                              @Y17XAXF 77800000
         SPACE                                                          78300022
OCTRMTBL DS    H .                 OFFSET IN TNT TO TERMINAL NAME       79200022
OCTIOT   DS    0H .                OFFSET IN TIOT TO DDNAME             80100022
OCLINENO DS    0H .                HEX LINE NUMBER             @Y17XAXU 81000000
OCWTGB   DS    H .                 WTG BACKUP FIELD            @Y17XAXU 81400000
         SPACE                                                          81900022
OCTRUNIT DS    0A .                IPL/DUMP TRAILER UNIT       @Y17XAXU 82300000
OCRSID   DS    0H .                RESOURCE ID                 @Y17XAXF 82800000
OCALSTAT DS    XL1 .               ALL OPTION STATUS FLAG      @Y17XAXF 82850000
OCRENTRD EQU   X'80' .            SECOND ENTRY TO VI FOR       @Y17XAXU 82910000
*                                 START LINE                   @Y17XAXU 82920000
OCDACTIP EQU   X'40' .              DEACT-IN-PROG             @OY19465  82925082
OCSEQIND EQU   X'20' .              OFF - SEQ NO. NOT SET               82930000
*                                   ON  - SEQ NO. SET          @Y17XAXU 82960000
OCREDRVE EQU   X'10' .              REDRIVE ELEMENT FLAG       @Y17XAXF 83030000
OCACTREQ EQU   X'08' .              ACT/DEACT REQUEST          @Y17XAXU 83100000
OCALLFLG EQU   X'04' .              ALL OPTIONS IN EFFECT      @Y17XAXU 83200000
OCALL    EQU   X'03' .              ALL STARTED/STOPPED        @Y17XAXU 83300000
OCSOME   EQU   X'02' .              SOME STARTED/STOPPED       @Y17XAXU 83400000
OCNONE   EQU   X'01' .              NONE STARTED/STOPPED       @Y17XAXU 83500000
OCUNSET  EQU   X'00' .              STATUS IS UNSET            @Y17XAXU 83600000
         DS    XL1 .               RESERVED                    @Y17XAXF 83650000
OCSEQ    DS    H .                      BTU ID TAG SEQ NUMBER    S22024 83700022
         SPACE                                                          84600022
OCRESNUM DS    0H .                RESOURCE RECORD             @Y17XAXF 85500000
OCPARM   DS    H .                 BRANCH PARAMETER FOR WTG MODULE      85540000
OCRCGNEG EQU   2                   GOOD RETURN CODE WITH SENSE @Y17XAXF 85580000
*                                    DATA                      @Y17XAXF 85660000
OCRCGPOS EQU   1                   GOOD RETURN CODE WITH NO    @Y17XAXF 85740000
*                                    SENSE DATA                @Y17XAXF 85820000
OCRCBNEG EQU   -1                  BAD RETURN CODE WITH SENSE  @Y17XAXF 85900000
*                                    DATA                      @Y17XAXF 85980000
OCRCBSIB EQU   -2                  BAD RETURN CODE FROM UNSUC- @Y17XAXF 86060000
*                                    CESSFUL SIB REQUEST       @Y17XAXF 86140000
OCRCBPOS EQU   -3                  BAD RETURN CODE WITH NO     @Y17XAXF 86220000
*                                    SENSE DATA                @Y17XAXF 86300000
OCRCBMOD EQU   -4                  BAD RETURN CODE FROM        @Y17XAXF 86400000
*                                    INEQUALITY OF LOAD MODULE @Y17XAXF 86600000
*                                    NAMES                     @Y17XAXF 86800000
OCWTG    DS    CL2 .                    NEXT LOAD TO GET CONTROL S22024 87000000
         SPACE                                                          87300022
OCBACKUP DS    0CL8 .                   NAME OF BACKUP DCB       S22024 88200000
*                                       DDNAME OR EBCDIC UCB ADDRESS    88300000
OCBUFNED DS    H .                      NUM BUF UNITS NEEDED   @Y17XAXF 88400000
OCBUFGOT DS    H .                      NUM BUF UNITS OWNED    @Y17XAXF 88500000
OCNCP    DS    H .                      SAVED TNT OF LOCAL NCP @Y17XAXF 88550000
OCDVRDCT DS    H .                      DEVICE RECORD COUNT    @Y17XAXF 88600000
         SPACE                                                          90000022
OCMODNME DS    0CL8 .                   LOAD MODULE NAME       @Y17XAXU 90900000
OCIPLWA  DS    0A .                     IPL WORKAREA PTR       @Y17XAXF 91100000
OCWTGSAV DS    CL2 .               SAVE WTG FIELD              @Y17XAXU 91300000
OCPUADR  DS    CL2 .               SAVED PU ADDRESS            @Y17XAXU 91500000
OCPTRSAV DS    F .                      SAVED OPCE POINTER     @Y17XAXU 92100000
         SPACE 3                                               @Y17XAXF 92100600
*                                                              @Y17XAXF 92101200
*        CHECKPOINT SPECIAL DATA TO BE SAVED                   @Y17XAXF 92101800
*                                                              @Y17XAXF 92102400
OCCKDATA DS    0CL8                     CHECK POINT DATA       @Y17XAXF 92103000
OCRSTGTM DS    0F .                     ADDR OF RESTART GETMAINED AREA  92103200
*                                                              @Y17XAXF 92103400
OCCKDAT1 DS    CL1                      BYTE 1 OF CHKPT DATA   @Y17XAXF 92103600
OCCKDAT2 DS    CL1                      BYTE 2 OF CKPT DATA    @Y17XAXF 92104200
         DS    CL2                      RESERVED               @Y17XAXF 92104800
OCCKPTWA DS    A                        ADDRESS OF 3705 CHECKPOINT      92105400
*                                        WORKAREA              @Y17XAXF 92305400
         MEND ,                                    */                   92700022
*%PLSOPCE:;                                                             92800022
*        DCL  1 IEDQOPCE BDY(WORD) BASED(ROPCE), /*OPERATOR CONTROL     93000022
*                                                   ELEMENT DSECT   */  93100022
*              2 OCLINK       PTR(31),  /*LINK TO THE NEXT OPCE ON      93400000
*                                          WAIT QUEUE        @YM07340*/ 93500000
*              2 OCELEM       PTR(31),  /*LINK TO ATTACHED              93600000
*                                         OPCE'S             @Y17XAXU*/ 93620000
*               3 OCELMPRI    CHAR(1),  /*ELEMENT PRIORITY   @Y17XAXU*/ 93640000
*               3 OCELMPTR    PTR(24),  /*POINTER TO ATTACHED           93660000
*                                         UNIT               @Y17XAXU*/ 93680000
*              2 OCUNIT       PTR(31),  /*LINK TO ATTACHED UNITS    */  93700022
*               3 OCRUDEST    PTR(31),   /* OPCE WAITING FOR            93730000
*                                           A RESPONSE       @Y17XAXU*/ 93760000
*                4 OCCKPKEY    BIT(8),  /*OPERATOR CONTROL CHECKPOINT   93770000
*                                         KEY                @Y17XAXF*/ 93780000
*                 5 OCSCAN     BIT(8),   /* INPUT TO OPCSCAN @OY12425*/ 93781000
*                  6 OCADDR   BIT(1),    /* ADDR ONLY        @OY12425*/ 93782000
*                  6 OCDDNRLN BIT(1),    /* DDN,RLN ONLY     @OY12425*/ 93783000
*                  6 OCDDNAME BIT(1),    /* DDNAME ONLY      @OY12425*/ 93784000
*                  6 OCALLRLN BIT(1),    /* RLN CAN BE ALL   @OY12425*/ 93785000
*                  6 OCNONAME BIT(1),    /* NAME NOT FOUND   @OY12425*/ 93786000
*                  6 OCNOTUCB BIT(1),    /* NOT A UCB ADDR   @OY12425*/ 93787000
*                  6 *        BIT(2),    /* RESERVED         @OY12425*/ 93788000
*                4 *           PTR(24), /*RESERVED           @Y17XAXF*/ 93790000
*              2 OCOPTCDE     CHAR(1),  /* COMMAND OP CODE   @Y17XAXU*/ 93800000
*               3 OCPRIFLG    CHAR(1),  /* PRIORITY FLAG FLD @Y17XAXU*/ 93850000
*              2 OCSWITCH     CHAR(1),  /*OPERATION SUBTYPE FIELD   */  93900022
*               3 OCQUCKN      BIT(1),  /*REQUEST FOR QUICK CLOSEDOWN   93920000
*                                                            @Y17XAXF*/ 93940000
*               3 *            BIT(7),  /*RESERVED           @Y17XAXF*/ 93960000
*              2 OCFLAG       BIT(8),   /*SPECIAL CONDITIONS IND    */  94000022
*               3 OCCONSOL     BIT(1),  /*CONSOLE INPUT             */  94100022
*               3 OCTOTE       BIT(1),  /*TOTE INPUT                */  94200022
*               3 OCMPP        BIT(1),  /*APPLICATION PROGRAM INPUT */  94300022
*               3 OCLINE       BIT(1),  /*INPUT HAS LINE NUMBER     */  94400022
*               3 OCOUTPUT     BIT(1),  /*MULTIPLE BLOCK INPUT      */  94500022
*               3 OCSSCP       BIT(1),  /*SSCP INPUT         @Y17XAXF*/ 94600000
*               3 OCATTACH     BIT(1),  /*ELEMENT ATTACHED          */  94700022
*               3 OCRESP       BIT(1),  /* THIS ELEMENT IS ASSOC.       94800022
*                                       WITH A RESPONSE BTU    S22024*/ 94900022
*              2 OCRLN        PTR(8),   /*RELATIVE LINE NUMBER      */  95000022
*              2   *   PTR(31),                            /*@YM08001*/ 95100000
*                       /* BYTES 2-4 ALSO OVERLAYED BY OCCIB @YM08001*/ 95150000
*               3 OCDEST      FIXED(16), /*DESTINATION OFFSET IN TNT*/  95200000
*                4 OCCONID    CHAR(1),  /*CONSOLE ID         @Y17XAXU*/ 95300000
*                4 OCREQVAL   CHAR(1),  /* OPERATOR SERVICES            95360000
*                                          REQUEST VALUES    @Y17XAXU*/ 95370000
*               3 *           CHAR(2),   /* RESERVED         @Y17XAXF*/ 95380000
*              2 OCTRMTBL     FIXED(16), /*OFFSET IN TNT TO TERMINAL    95400000
*                                            ENTRY                  */  95500022
*              2 OCLINENO     FIXED(16), /*HEX LINE NUMBER          */  95600000
*               3 OCTIOT       FIXED(16), /*OFFSET IN TIOT TO DDNAME*/  95670000
*                4 OCWTGB     CHAR(2),  /* WTG BACKUP FIELD  @Y17XAXU*/ 95750000
*              2 OCTRUNIT PTR(31),      /* IPL/DUMP TRAILER             95800000
*                                           UNIT             @Y17XAXU*/ 95810000
*               3 OCRSID      CHAR(2),  /* RESOURCE ID       @Y17XAXU*/ 95820000
*                4 OCALSTAT   CHAR(1),  /* ALL OPTION STATUS @Y17XAXU*/ 95830000
*                 5 OCRENTRD  BIT(1),    /* SECOND ENTRY TO VI          95840000
*                                           FOR START LINE   @Y17XAXU*/ 95841000
*                 5 OCDACTIP  BIT(1),    /* DEACT-IN-PROG    @OY19465*/ 95842082
*                  5 OCSEQIND BIT(1),    /* OFF - SEQ NO. NOT SET       95843000
*                                           ON - SEQ NO. SET @Y17XAXU*/ 95846000
*                 5 OCREDRVE  BIT(1),   /* REDRIVE ELEMENT   @Y17XAXF*/ 95850000
*                                       /*  FLAG             @Y17XAXF*/ 95855000
*                 5 OCACTREQ  BIT(1),    /* ACT/DEACT REQ    @Y17XAXU*/ 95860000
*                 5 OCALLFLG  BIT(1),    /* ALL OPTIONS IN              95870000
*                                           EFFECT           @Y17XAXU*/ 95880000
*                 5 OCSOME    BIT(1),    /* SOME STARTED/               95890000
*                                           STOPPED          @Y17XAXU*/ 95900000
*                 5 OCNONE    BIT(1),    /* NONE STARTED/               95910000
*                                           STOPPED          @Y17XAXU*/ 95920000
*                4 *          CHAR(1),  /* RESERVED          @Y17XAXF*/ 95940000
*              3 OCSEQ        CHAR(2),  /* BTU ID TAG SEQ NO @Y17XAXU*/ 95960000
*              2 OCPARM       FIXED(15), /*BRANCH PARAMETER FOR         96000000
*                                           WTG MODULE              */  96100022
*               3 OCRESNUM     FIXED(16), /*RESOURCE RECORD  @Y17XAXF*/ 96150000
*              2 OCWTG        CHAR(2),  /*NEXT LOAD TO RECEIVE          96200022
*                                          CONTROL AFTER WAIT       */  96300022
*              2 OCBACKUP CHAR(8) BDY(WORD), /*NAME OF BACKUP DDNAME    96400000
*                                          EBCDIC UCB ADDRESS        */ 96410000
*               3 OCBUFNED    FIXED(16), /* NUM BUFFER UNITS NEEDED     96420000
*                                                            @Y17XAXF*/ 96430000
*               3 OCBUFGOT    FIXED(16), /* NUM BUFFER UNITS OWNED      96440000
*                                                            @Y17XAXF*/ 96450000
*               3 OCNCP       FIXED(16), /* SAVED TNT OF     @Y17XAXF*/ 96460000
*                                        /*  LOCAL NCP       @Y17XAXF*/ 96500000
*               3 OCDVRDCT    FIXED(15), /* DEVICE RECORD COUNT         96510000
*                                                            @Y17XAXF*/ 96520000
*              2 OCMODNME CHAR(8) BDY(WORD), /* LOAD MOD NME @Y17XAXU*/ 96600000
*               3 OCIPLWA  PTR(31),   /* IPL WORKAREA PTR    @Y17XAXF*/ 96900000
*                4 OCWTGSAV    CHAR(2), /* SAVED WTG FIELD   @Y17XAXF*/ 97300000
*                4 OCPUADR     CHAR(2), /* SAVED PU ADDRESS  @Y17XAXF*/ 98000000
*               3 OCPTRSAV  PTR(31),    /* SAVED OPCE PTR    @Y17XAXU*/ 98700000
*/*                                                          @Y17XAXF*/ 98703000
*/*      CHECKPOINT SPECIAL DATA TO BE SAVED                 @Y17XAXF*/ 98706000
*/*                                                          @Y17XAXF*/ 98709000
*   2 OCCKDATA CHAR(8) BDY(WORD),       /* CHECKPOINT DATA   @Y17XAXF*/ 98712000
*    3 OCRSTGTM PTR(31),                /* ADDR OF RESTART GETMAINED    98713000
*                                          AREA              @Y17XAXF*/ 98714000
*     4 OCCKDAT1 CHAR(1),               /* BYTE 1 OF CHKPT DATA         98715000
*                                                            @Y17XAXF*/ 98718000
*     4 OCCKDAT2 CHAR(1),               /* BYTE 2 OF CKPT DATA          98721000
*                                                            @Y17XAXF*/ 98724000
*     4 *        CHAR(2),               /* RESERVED          @Y17XAXF*/ 98727000
*    3 OCCKPTWA PTR(31);                /* ADDR OF 3705 CHECKPOINT      98729000
*                                          WORKAREA                  */ 98731000
*                                                         /* @Y17XAXF*/ 98733000
* DCL OCCIB PTR(24) DEF(OCREQVAL);      /* ADDRESS OF INPUT CIB         98733100
*                                                            @YM08001*/ 98733200
* DECLARE                                                               98733500
* 1 OCCKPKY1 BIT(8) DEFINED(OCCKPKEY),                    /* @Y17XAXF*/ 98734000
*  2 OCCKPTYP BIT(3),                   /* TYPE OF CKPT REQUEST         98734500
*                                                            @Y17XAXF*/ 98735000
*   3 OCCKPINC BIT(1),                  /* REQUEST INCIDENT CKPT        98735500
*                                                            @Y17XAXF*/ 98736000
*   3 OCCKPNCP BIT(1),                  /* REQUEST 3705 CKPT @Y17XAXF*/ 98736500
*   3 OCCKPRST BIT(1),                  /* REQUEST 3705 RESTART RECORDS 98737000
*                                                            @Y17XAXF*/ 98737500
*  2 OCCKPENV BIT(1),                   /* ENVIRONMENT CKPT IS TO BE    98738000
*                                          FORCED            @Y17XAXF*/ 98738500
*  2 *        BIT(4);                   /* RESERVED          @Y17XAXF*/ 98739000
*                                                                       98739500
*/*                                                          @Y17XAXF*/ 98740000
*DCL 1 OCICACTN DEF(OCMODNME),          /*ICHNG ACTION WORD  @Y17XAXF*/ 98742000
*     2 OCICDADR PTR(31),               /*WORKAREA ADDRESS   @Y17XAXF*/ 98744000
*      3 OCICTYPE FIXED(8),             /*ICHNG MOVE TYPE    @Y17XAXF*/ 98746000
*      3 OCICATST PTR(15) BDY(WORD,2),  /*TEST FIELD TO DETERMINE       98748000
*                             PRESENCE OF WORKAREA ADDRESS   @Y17XAXF*/ 98750000
*      3 OCICSW BIT(8),                 /*ACT/DEACT SWITCHES @Y17XAXF*/ 98752000
*       4 * BIT(7),                     /*RESERVED           @Y17XAXF*/ 98754000
*       4 OCICINAC BIT(1);              /*DEACTIVATE REQUEST @Y17XAXF*/ 98756000
*@SPACE (1);                                               /*@Y17XAXF*/ 98758000
*DCL OCICSID FIXED(8) CONSTANT(0);/*ICHNG FOR SWITCH ID VERIFICATION    98760000
*                                                            @Y17XAXF*/ 98762000
*DCL OCICLES FIXED(8) CONSTANT(1);/*ICHNG FOR LEASED OR SWITCHED LINE   98764000
*                                   WITH NO ID VERIFICATION  @Y17XAXF*/ 98766000
*DCL OCICMUL FIXED(8) CONSTANT(2);/*ICHNG FOR MULTIPT LINE   @Y17XAXF*/ 98768000
*/*                                                          @Y17XAXF*/ 98770000
*/*      DSECT FOR NEG PREFIX                                @Y17XAXF*/ 98780000
*/*                                                          @Y17XAXF*/ 98820000
* DECLARE                                                 /* @Y17XAXF*/ 98860000
*  1 IEDQOPCN BASED(ADDR(IEDQOPCE)-LENGTH(IEDQOPCN)),     /* @Y17XAXF*/ 98880000
*   2 OCLDNME  CHAR(8) BDY(WORD),     /* LOAD MODULE         @Y17XAXF*/ 98900000
*                                     /*  MISMATCH NAME      @Y17XAXF*/ 98920000
*    3 OCLINTTE PTR(31),              /* LINE TTE ADDR       @Y17XAXF*/ 98940000
*                                     /*  (M6-MB)            @Y17XAXF*/ 98960000
*      4 OCRESPCT  FIXED(16),         /* OUTSTAND RSP COUNT  @Y17XAXF*/ 99020000
*      4 OCREQFLG BIT(8),             /* OP SERV REQUEST FLG @Y17XAXF*/ 99060000
*        5 OCFLUSHZ BIT(1),           /* Z,TP,FLUSH REQUEST FOR DEACT   99100000
*                                         NCP                @Y17XAXF*/ 99120000
*        5 *        BIT(1),           /* RESERVED            @Y17XAXF*/ 99140000
*        5 *        BIT(1),           /* RESERVED            @Y17XAXF*/ 99180000
*        5 OCADNCP  BIT(1),           /* NCP ACT/DEACT CMND  @Y17XAXF*/ 99220000
*        5 OCPARTAL BIT(1),           /* PARTIAL ACT FLAG    @Y17XAXF*/ 99260000
*        5 OCDCARD  BIT(1),           /* DISCARD FLAG        @Y17XAXF*/ 99300000
*        5 OCFORCE  BIT(1),           /* FORCE FLAG          @Y17XAXF*/ 99340000
*        5 OCIDLE   BIT(1),           /* IDLE FLAG           @Y17XAXF*/ 99380000
*      4 OCPREFLG BIT(8),             /* GENERAL FLAG BYTE   @Y17XAXF*/ 99420000
*       5 OCBFREQ  BIT(1),            /* CLEANUP BUFF REQ    @Y17XAXF*/ 99421000
*       5 OCRSPSNT BIT(1),            /* CLEANUP RESP SENT   @Y17XAXF*/ 99422000
*       5 OCREPOST BIT(1),            /* CLEANUP REPOST REQ  @Y17XAXF*/ 99423000
*       5 OCTOTEP  BIT(1),            /* TOTE POST REQUEST   @Y17XAXF*/ 99424000
*       5 *        BIT(4),            /* RESERVED            @Y17XAXF*/ 99425000
*    3 *        PTR(31);              /* RESERVED            @Y17XAXF*/ 99430000
*%OCPREFSZ='LENGTH(IEDQOPCN)';        /* LENGTH OF NEG PREF  @Y17XAXF*/ 99500000
*                                                         /* @Y17XAXF*/ 99500500
*/*                                                          @Y17XAXU*/ 99501000
*/*      OCSWITCH CONSTANTS                                  @Y17XAXU*/ 99511000
*/*                                                          @Y17XAXU*/ 99521000
*DCL OCBKUP   BIT(8) CONSTANT('03'X); /* MODIFY 3705 AS AVAILABLE FOR   99531000
*                                        BACKUP              @Y17XAXF*/ 99541000
*DCL OCOFFTPE BIT(8) CONSTANT('05'X); /* VARY OFFTP E COMMAND           99551000
*                                                            @Y17XAXF*/ 99561000
*DCL OCOFFTPB BIT(8) CONSTANT('06'X); /* VARY OFFTP B COMMAND           99571000
*                                                            @Y17XAXF*/ 99581000
*DCL OCCHNLD  BIT(8) CONSTANT('07'X); /* MODIFY CHANGE LOAD  @Y17XAXF*/ 99591000
*DCL OCDMPC BIT(8) CONSTANT('0A'X);   /* DUMP COMMAND TO MH  @Y17XAXU*/ 99601000
*DCL OCONTPE BIT(8) CONSTANT('0A'X);  /* VARY ONTP E COMMAND @Y17XAXF*/ 99611000
*DCL OCONTPB BIT(8) CONSTANT('0B'X);  /* VARY ONTP B COMMAND @Y17XAXF*/ 99745200
*DCL OCACTLU BIT(8) CONSTANT('10'X);  /* ACTLU REQUEST       @Y17XAXU*/ 99746000
*DCL OCIPLC BIT(8) CONSTANT('11'X);   /* IPL COMMAND TO MH   @Y17XAXU*/ 99746500
*DCL OCSTPLNC BIT(8) CONSTANT('11'X); /* STOPLINE,C REQUEST  @Y17XAXF*/ 99747000
*DCL OCSTPLNI BIT(8) CONSTANT('12'X); /* STOPLINE,I REQUEST  @Y17XAXF*/ 99747500
*DCL OCSWBACK BIT(8) CONSTANT('16'X); /* MODFY 3705 BKUP NCP @Y17XAXF*/ 99748000
*DCL OCBHSET  BIT(8) CONSTANT('1D'X); /* MODIFY BHSET        @Y17XAXF*/ 99748100
*DCL OCSESSNL BIT(8) CONSTANT('1E'X); /* CHANGE SESSION LIM  @Y17XAXF*/ 99749000
*DCL OCTRANL  BIT(8) CONSTANT('1F'X); /* CHANGE TRANS LIMIT  @Y17XAXF*/ 99749500
*DCL OCDACTLU BIT(8) CONSTANT('20'X); /* DACTLU REQUEST      @Y17XAXU*/ 99750000
*DCL OCMIDMSG BIT(8) CONSTANT('20'X); /* REMOVE FROM MIDDLE MESSAGE     99750200
*                                        CONDITION           @Y17XAXF*/ 99750400
*DCL OCSWDEVB BIT(8) CONSTANT('20'X); /* SWITCH DEV BACK-UP  @Y17XAXF*/ 99750600
*DCL OCSWDEVP BIT(8) CONSTANT('21'X); /* SWITCH DEV PRIMARY  @Y17XAXF*/ 99751200
*DCL OCTOFA BIT(8) CONSTANT('22'X);   /* REDRIVE INC RECORD  @Y17XAXU*/ 99752000
*DCL OCACTVTE BIT(8) CONSTANT('22'X); /* ACTIVATE            @Y17XAXF*/ 99752600
*DCL OCDEACTE BIT(8) CONSTANT('23'X); /* DEACTIVATE          @Y17XAXF*/ 99753200
*DCL OCTOFC BIT(8) CONSTANT('23'X);   /* REQUEST DEACT       @Y17XAXU*/ 99754000
*DCL OCSWAP   BIT(8) CONSTANT('24'X); /* SWAP DEVICE ID      @Y17XAXF*/ 99754300
*DCL OCCHANGE BIT(8) CONSTANT('25'X); /* CHANGE DIAL MODE    @Y17XAXF*/ 99754600
*DCL OCOFTPEM BIT(8) CONSTANT('25'X); /* VARY OFFTP EM COMMAND          99754700
*                                                            @Y17XAXF*/ 99754800
*DCL OCSSELCT BIT(8) CONSTANT('26'X); /* SELECT MODEM SPEED  @Y17XAXF*/ 99754900
*DCL OCOFTPBM BIT(8) CONSTANT('26'X); /* VARY OFFTP BM COMMAND          99755000
*                                                            @Y17XAXF*/ 99755100
*DCL OCSWLNME BIT(8) CONSTANT('27'X); /* SWIT LINE MOD TO EP @Y17XAXF*/ 99755200
*DCL OCSWLNMN BIT(8) CONSTANT('28'X); /* SWIT LNE MOD TO NCP @Y17XAXF*/ 99755500
*DCL OCPARO BIT(8) CONSTANT('29'X);   /* CMND PARSED IN LCB  @Y17XAXU*/ 99756000
*DCL OCIOTR BIT(8) CONSTANT('2A'X);   /* START/STOP TRACEING @Y17XAXU*/ 99756600
*                                     /*  OF LINES IN ERROR  @Y17XAXU*/ 99757200
*DCL OCLCBIN BIT(8) CONSTANT('30'X);  /* LCB INPUT TO MH     @Y17XAXU*/ 99758000
*DCL OCACTPU BIT(8) CONSTANT('30'X);  /* ACTPU (NON-NCP) REQ @Y17XAXU*/ 99760000
*DCL OCFRCDAC BIT(8) CONSTANT('37'X); /* FORCE DEACT REQUEST @Y17XAXU*/ 99760100
*DCL OCCRINOP BIT(8) CONSTANT('38'X); /* CLENUP REQ FOR INOP @Y17XAXU*/ 99760200
*DCL OCCUREQ  BIT(8) CONSTANT('39'X); /* CLEANUP REQUEST     @Y17XAXU*/ 99760300
*DCL OCDACTPU BIT(8) CONSTANT('40'X); /* DACTPU(NON-NCP) REQ @Y17XAXU*/ 99760500
*DCL OCACTLK BIT(8) CONSTANT('50'X);  /* ACTLINK REQUEST     @Y17XAXU*/ 99764000
*DCL OCDACTLK BIT(8) CONSTANT('60'X); /* DACTLINK REQUEST    @Y17XAXU*/ 99766000
*DCL OCACTNCP BIT(8) CONSTANT('70'X); /* ACTPU(NCP) REQUEST  @Y17XAXU*/ 99768000
*DCL OCCHGSL BIT(8) CONSTANT('80'X);  /* CHNG SESS LIMIT REQ @Y17XAXU*/ 99770000
*DCL OCSCANON BIT(8) CONSTANT('80'X); /* SCAN HAS BEEN DONE  @Y17XAXF*/ 99771000
*DCL OCCHGNP BIT(8) CONSTANT('90'X);  /* CHNG NEG POLL LIMIT @Y17XAXU*/ 99772000
*DCL OCCHGSSP BIT(8) CONSTANT('A0'X); /* CHNG SERV SEEK PAUS @Y17XAXU*/ 99774000
*DCL OCCHGTL BIT(8) CONSTANT('B0'X);  /* CHNG XMISS LIM REQ  @Y17XAXU*/ 99776000
*DCL OCSWEP BIT(8) CONSTANT('C0'X);   /* SW TO EP MODE REQ   @Y17XAXU*/ 99778000
*DCL OCSWNCP BIT(8) CONSTANT('D0'X);  /* SW TO NCP MODE REQ  @Y17XAXU*/ 99780000
*DCL OCVARON BIT(8) CONSTANT('D1'X);  /* INTER VARY ON REQ   @Y17XAXF*/ 99780600
*DCL OCVAROFF BIT(8) CONSTANT('D2'X); /* INTER VARY OFF REQ  @Y17XAXF*/ 99781200
*DCL OCSETTD BIT(8) CONSTANT('E0'X);  /* SET TIME/DATE REQ   @Y17XAXU*/ 99782000
*DCL OCOPYDSM BIT(8) CONSTANT('E1'X); /* COPY DEST. MODE     @Y17XAXF*/ 99782400
*DCL OCRPLDSM BIT(8) CONSTANT('E2'X); /* REPLACE DEST MODE   @Y17XAXF*/ 99782800
*DCL OCOPYDSI BIT(8) CONSTANT('E3'X); /* COPY DEV SESS INFO  @Y17XAXF*/ 99783200
*DCL OCRPLDSI BIT(8) CONSTANT('E4'X); /* REPL DEV SESS INFO  @Y17XAXF*/ 99783600
*DCL OCSUBT   BIT(8) CONSTANT('E5'X); /* START OR STOP       @Y17XAXF*/ 99783700
*                                     /*  SUBTASK TRACE      @Y17XAXF*/ 99783800
*DCL OCSESTRM BIT(8) CONSTANT('E6'X); /* SESS TERM REQ TO/FROM LUS   */ 99784000
*                                     /*                     @Y17XAXF*/ 99784200
*DCL OCBUF BIT(8) CONSTANT('E7'X);     /* CHANGE BUFFTR OPT. @OY19405*/ 99784382
*DCL OCDISCON BIT(8) CONSTANT('F0'X); /* DISCONNECT REQUEST  @Y17XAXU*/ 99784400
*DCL OCRSTART BIT(8) CONSTANT('F1'X); /* RSTART RECORD REQ   @Y17XAXU*/ 99784600
*DCL OCSND1 BIT(8) CONSTANT('F2'X);   /* RESTART COMMAND     @Y17XAXU*/ 99788000
*DCL OCSND2 BIT(8) CONSTANT('F3'X);   /* RESTART COMMAND     @Y17XAXU*/ 99790000
*DCL OCSND3 BIT(8) CONSTANT('F4'X);   /* RESTART COMMAND     @Y17XAXU*/ 99792000
*DCL OCSND4 BIT(8) CONSTANT('F5'X);   /* RESTART COMMAND     @Y17XAXU*/ 99794000
*DCL OCSND5 BIT(8) CONSTANT('F6'X);   /* RESTART COMMAND     @Y17XAXU*/ 99796000
*DCL OCSND6 BIT(8) CONSTANT('F7'X);   /* RESTART COMMAND     @Y17XAXU*/ 99798000
*DCL OCSND7 BIT(8) CONSTANT('F8'X);   /* RESTART COMMAND     @Y17XAXU*/ 99800000
*DCL OCSND8 BIT(8) CONSTANT('F9'X);   /* RESTART COMMAND     @Y17XAXU*/ 99802000
*/*                                                          @Y17XAXU*/ 99820000
*/*      OCALSTAT CONSTANTS                                  @Y17XAXU*/ 99840000
*/*                                                          @Y17XAXU*/ 99860000
*DECLARE OCALL BIT(8) CONSTANT('03'X);  /* ALL STRT/STOPPED  @Y17XAXU*/ 99880000
*DECLARE OCUNSET BIT(8) CONSTANT('00'X); /* STATUS IS UNSET  @Y17XAXU*/ 99900000
*/*                                                                  */ 99902000
*/*      CONSTANTS FOR OCSCAN                                        */ 99904000
*/*                                                                  */ 99906000
*DCL OCDDADDR BIT(8) CONSTANT('A0'X);   /* VALUE TO INDICATE TO DCB     99908000
*                                         LOOK UP THAT REG 11 POINTS    99910000
*                                         TO EITHER A DDNAME OR CHANNEL 99912000
*                                         ADDRESS                    */ 99914000
*/*                                                          @Y17XAXF*/ 99914300
*/*      OCPARM RETURN CODE CONSTANTS                        @Y17XAXF*/ 99914600
*/*                                                          @Y17XAXF*/ 99914900
*DCL OCRCGNEG FIXED(15) CONSTANT(2);    /* GOOD RETURN CODE  @Y17XAXF*/ 99915200
*                                       /*  WITH SENSE DATA  @Y17XAXF*/ 99915500
*DCL OCRCGPOS FIXED(15) CONSTANT(1);    /* GOOD RETURN CODE  @Y17XAXF*/ 99915800
*                                       /*  WITH NO SENSE    @Y17XAXF*/ 99916100
*                                       /*  DATA             @Y17XAXF*/ 99916400
*DCL OCRCBNEG FIXED(15) CONSTANT(-1);   /* BAD RETURN CODE   @Y17XAXF*/ 99916700
*                                       /*  WITH SENSE DATA  @Y17XAXF*/ 99917000
*DCL OCRCBSIB FIXED(15) CONSTANT(-2);   /* BAD RETURN CODE   @Y17XAXF*/ 99917300
*                                       /*  FROM UNSUCCESS-  @Y17XAXF*/ 99917600
*                                       /*  FUL SIB REQUEST  @Y17XAXF*/ 99917900
*DCL OCRCBPOS FIXED(15) CONSTANT(-3);   /* BAD RETURN CODE   @Y17XAXF*/ 99918200
*                                       /*  WITH NO SENSE    @Y17XAXF*/ 99918500
*                                       /*  DATA             @Y17XAXF*/ 99918800
*DCL OCRCBMOD FIXED(15) CONSTANT(-4);   /* BAD RETURN CODE   @Y17XAXF*/ 99919000
*                                       /*  FROM INEQUALITY  @Y17XAXF*/ 99919200
*                                       /*  OF LOAD MODULE   @Y17XAXF*/ 99919400
*                                       /*  NAMES            @Y17XAXF*/ 99919600
./  ADD  SSI=60241446,NAME=TOPCTL
         MACRO                                                          10000020
         TOPCTL                                                         20000020
         SVC   104 .                    TCAM OPERATOR CONTROL ROUTINE   30000020
         MEND                                                           40000020
./  ADD  SSI=63070657,NAME=TOPRED
*        %GOTO OPREPLS;                 /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TOPRED                                                         06000010
         SPACE                                                          08000010
.*CHANGE ACTIVITY AS FOLLOWS:                                           10000010
.*A000000-999999                                               @Y17XAXU 12000010
.*A341200,703000                                               @Y17XAXF 12600010
.*C720000                                                      @Y17XAXF 13200010
         SPACE                                                          14000010
IEDOPRED DSECT                                                          16000010
*                                                                       18000010
*        OPERATOR CONTROL REQUEST ELEMENT                               20000010
*                                                                       22000010
OPREKEY  DS    X .                      KEY FIELD                       24000010
OPREQCB  DS    AL3 .                    QCB ADDRESS                     26000010
OPREPRI  DS    X .                      PRIORITY FIELD                  28000010
*                                                                       28500010
*        REFER TO TPRIOR DSECT FOR PRIORITY EQUATES                     29000010
*                                                                       29500010
OPRELINK DS    AL3 .                    LINK FIELD                      30000010
OPRETIC  DS    0A .                     LINK TO NEXT UNIT               32000010
OPRESAVE DS    A .                      IPL/DUMP OPCE SAVE AREA         33000010
OPREFLG1 DS    X .                      FLAG FIELD                      34000010
OPRA0    EQU   X'01' .                  USED WITH PRIHIFLG -            34060010
*                                       OP SERVICES TO SSCP             34120010
*                                       USED WITH PRILOFLG-A/D REDRIVE  34126010
*                                                              @Y17XAXF 34132010
OPRSENSE EQU   X'02' .                  NSED WITH PRIHIFLG DLC @Y17XAXF 34140010
*                                       TO IPL                 @Y17XAXF 34160010
OPRFG    EQU   X'03' .                  USED WITH PRIMEDFG -            34180010
*                                       LUS TO A/D                      34240010
OPRVI    EQU   X'04' .                  USED WITH PRIMEDFG -            34300010
*                                       NSL TO VI WITH A                34360010
*                                       REQUEST BUFFER                  34420010
OPRVE    EQU   X'05' .                  USED WITH PRIMEDFG -            34480010
*                                       NSL TO VE WITH A                34540010
*                                       REQUEST BUFFER                  34600010
OPRVA    EQU   X'06' .                  USED WITH PRIMEDFG -            34660010
*                                       NSL TO VA WITH A                34720010
*                                       REQUEST BUFFER                  34780010
OPRVF    EQU   X'07' .                  USED WITH PRIMEDFG -            34840010
*                                       NSL TO VF WITH A                34900010
*                                       REQUEST BUFFER                  34960010
OPR02    EQU   X'08' .                  USED WITH PRIMEDFG -            35020010
*                                       A/D TO 02                       35080010
OPRFC    EQU   X'09' .                  TO FC WITH OPCE TO              35140010
*                                       REQUEST DEACT OF A              35200010
*                                       3705                            35260010
OPRFK    EQU   X'0A' .                  REDRIVE ELEMENT ROUTING TO FK   35320010
*                                                                       35330010
OPRVAVF  EQU   X'0B' .                  USED BY V9 TO INTERFACE WITH AN 35340010
*                                        OPCE TO VA OR VF               35350010
OPRC0    EQU   X'0D' .                  USED WITH PRILOFLG -            35360010
*                                        TO REDRIVE IGCC010D            35366010
OPRVI2   EQU   X'10' .                  USED WITH PRIMEDFG -            35372010
*                                       A/D TO VI WITH AN OPCE          35380010
OPRV8    EQU   X'11' .                  USED WITH PRIMEDFG -            35440010
*                                       A/D TO V8 WITH AN OPCE          35500010
OPRMP    EQU   X'12' .                  OPRE FROM DLC TO MP FOR         35560010
*                                       I/O COMPLETE                    35620010
OPRDRTN  EQU   X'13' .                  USED TO RETURN OPCE             35680010
*                                       TO ACTIVATE                     35740010
OPRETOMF EQU   X'14' .                  DLC ROUTE BACK TO MF AFTER I/O  35840010
OPRPRMRP EQU   X'15' .                  NSL RETURNS TO VA AFTER PRIMING 35920010
OPRTOTCL EQU   X'16' .                  FLAG FIELD VALUE FOR TOTE       35940010
*                                       CLEANUP RESP HANDLER   @Y17XAXF 35960010
OPREFLG2 DS    X .                      FLAG FIELD                      36000010
OPREFLG3 DS    X .                      FLAG FIELD                      36400010
*        EQU   X'80'-X'04'               RESERVED                       36800010
OPREATCH EQU   X'02' .                   ATTACHED FLAG                  37200010
*        EQU   X'01'                     RESERVED                       37600010
OPRELEN  EQU   *-IEDOPRED .             OPRE LENGTH                     38000010
         MEND                                                           40000010
*        */                                                             42000010
*%OPREPLS : ;                                                           44000010
*DECLARE                                                                46000010
*  1 IEDOPRED BDY(WORD) BASED,                                          48000010
*/*                                                                  */ 50000010
*/*      OPERATOR CONTROL REQUEST ELEMENT                            */ 52000010
*/*                                                                  */ 54000010
*   2 OPREKEY CHAR(1),                  /* KEY FIELD                 */ 56000010
*   2 OPREQCB PTR(24),                  /* QCB ADDRESS               */ 58000010
*   2 OPREPRI CHAR(1),                  /* PRIORITY FIELD            */ 60000010
*/*                                                                  */ 60500010
*/*      REFER TO TPRIOR DSECT FOR PRIORITY EQUATES                  */ 61000010
*/*                                                                  */ 61500010
*   2 OPRELINK PTR(24),                 /* LINK FIELD                */ 62000010
*   2 OPRESAVE PTR(31),                 /* IPL DUMP OPCE SAVE AREA   */ 64000010
*    3 OPRETIC  PTR(31),                /*  LINK TO NEXT UNIT        */ 65000010
*   2 OPREFLG1 CHAR(1),                 /* FLAG FIELD                */ 66000010
*   2 OPREFLG2 CHAR(1),                 /* FLAG FIELD                */ 68000010
*   2 OPREFLG3 CHAR(1),                 /* FLAG FIELD                */ 68400010
*    3 *        BIT(6),                 /*  RESERVED                 */ 68800010
*    3 OPREATCH BIT(1),                 /*  ATTACHED FLAG            */ 69200010
*    3 *        BIT(1);                 /*  RESERVED                 */ 69600010
* %OPRELEN='LENGTH(IEDOPRED)';          /* OPRE LENGTH               */ 70000010
*/*                                                                  */ 70060010
*/*      CONSTANTS FOR OPREFLG1                                      */ 70120010
*/*                                                                  */ 70180010
*DCL OPRA0   BIT(8) CONSTANT('01'X);    /* USED WITH PRIHIFLG -         70240010
*                                          OP SERVICES TO SSCP          70300010
*                                          USED WITH PRILOFLG-A/D       70303010
*                                           REDRIVE          @Y17XAXF*/ 70306010
*DCL OPRSENSE BIT(8) CONSTANT('02'X);   /* USED WITH         @Y17XAXF*/ 70310010
*                                       /* PRIHIFLG DLC TO   @Y17XAXF*/ 70320010
*                                       /* IPL               @Y17XAXF*/ 70330010
*DCL OPRFG   BIT(8) CONSTANT('03'X);    /* USED WITH PRIMEDFG -         70360010
*                                          LUS TO A/D                */ 70420010
*DCL OPRVI   BIT(8) CONSTANT('04'X);    /* USED WITH PRIMEDFG -         70480010
*                                          NSL TO VI WITH A             70540010
*                                          REQUEST BUFFER            */ 70600010
*DCL OPRVE   BIT(8) CONSTANT('05'X);    /* USED WITH PRIMEDFG -         70660010
*                                          NSL TO VE WITH A             70720010
*                                          REQUEST BUFFER            */ 70780010
*DCL OPRVA   BIT(8) CONSTANT('06'X);    /* USED WITH PRIMEDFG -         70840010
*                                          NSL TO VA WITH A             70900010
*                                          REQUEST BUFFER            */ 70960010
*DCL OPRVF   BIT(8) CONSTANT('07'X);    /* USED WITH PRIMEDFG -         71020010
*                                          NSL TO VF WITH A             71080010
*                                          REQUEST BUFFER            */ 71140010
*DCL OPR02   BIT(8) CONSTANT('08'X);    /* USED WITH PRIMEDFG -         71200010
*                                          A/D TO 02                 */ 71260010
*DCL OPRFC   BIT(8) CONSTANT('09'X);    /* TO FC WITH OPCE TO           71320010
*                                          REQUEST DEACT OF A           71380010
*                                          3705                      */ 71440010
*DCL OPRFK   BIT(8) CONSTANT('0A'X);    /* REDRIVE ELEMENT ROUTING TO   71500010
*                                          FK                        */ 71510010
*DCL OPRVAVF BIT(8) CONSTANT('0B'X);    /* USED BY V9 TO INTERFACE WITH 71520010
*                                          AN OPCE TO VA OR VF       */ 71530010
*DCL OPRC0   BIT(8) CONSTANT('0D'X);    /* USED WITH PRILOFLG -         71540010
*                                          TO REDRIVE IGCC010D          71545010
*                                                            @Y17XAXF*/ 71550010
*DCL OPRVI2  BIT(8) CONSTANT('10'X);    /* USED WITH PRIMEDFG -         71555010
*                                          A/D TO VI WITH AN OPCE    */ 71560010
*DCL OPRV8   BIT(8) CONSTANT('11'X);    /* USED WITH PRIMEDFG -         71620010
*                                          A/D TO V8 WITH AN OPCE    */ 71680010
*DCL OPRMP   BIT(8) CONSTANT('12'X);    /* OPRE FROM DLC TO MP FOR      71740010
*                                          I/O COMPLETE              */ 71800010
*DCL OPRDRTN BIT(8) CONSTANT('13'X);    /* USED TO RETURN OPCE          71860010
*                                          TO ACTIVATE               */ 71920010
*DCL OPRETOMF BIT(8) CONSTANT('14'X);   /* DLC ROUTE BACK TO MF AFTER   71940010
*                                          I/O                       */ 71960010
*DCL OPRPRMRP BIT(8) CONSTANT('15'X);   /* NSL RETURNS TO VA AFTER      74960010
*                                          PRIMING                   */ 77960010
*DCL OPRTOTCL BIT(8) CONSTANT('16'X);/*FLAG FIELD VALUE FOR TOTE     */ 80960010
*                                    /*CLEANUP RESP HANDLER  @Y17XAXF*/ 83960010
./  ADD  SSI=71080447,NAME=TPCBD
         MACRO                                                          01000020
         TPCBD                                                          02000020
.*A-000000-999999                                              @X31X8X0 02050010
.* CHANGE ACTIVITY AS FOLLOWS:                                          02100022
.*************************** MICROFICHE FLAGS *************** SUPT CODE 02200022
.*C040070                                                        X03039 02230010
.*D340001,345001-345003                                          X03039 02260010
.*C160000                                                        S22025 02300022
.*A027000,345000                                                 A50196 02300122
.*C440000                                                       SA59162 02300222
.*             11/15/72   MODIFICATION DATE                     SA59162 02300322
.*A340001,345001-345003                                         SA56920 02300422
.*C040070                                                      @Z30X8XE 02400410
.*A446000                                                      @XA11307 02500410
.********************************************************************** 02800022
IEDQPCB  DSECT .                        PROCESS CONTROL BLOCK           03000020
*                                                                     * 04000022
*  DSECT NAME = TPCBD                                                 * 04001022
*                                                                     * 04002022
*  DESCRIPTIVE NAME = PROCESS CONTROL BLOCK DSECT                     * 04003022
*                                                                     * 04004022
*  COPYRIGHT = 'NONE'                                                 * 04005022
*                                                                     * 04006022
*  STATUS: CHANGE LEVEL 8                                      @Z30X8XE 04006510
*                                                                     * 04008022
         DS    0F                                                       05000020
         DS    12X                      RESERVED                 Y02027 05500010
PCBJOBNA DS    FL8                      JOB NAME IN TIOT OF A.P. Y02027 06000010
PCBBUFIN DS    0BL1 .                   INITIAL BUFFER REQUEST          08000020
*                                       FOR PUT OR WRITE                09000020
PCBBUFO  DS    BL1 .                    MAXIMUM NUMBER OF FULL          10000020
*                                       BUFFERS ON READ-AHEAD QCB       11000020
PCBMH    DS    AL3 .                    ADDR OF MESSAGE HANDLER         12000020
PCBUCNT  DS    X .                      USE COUNT                       13000020
PCBLINK  DS    AL3 .                    LINK FIELD                      14000020
PCBBUFMX DS    X .                      READ-AHEAD BUFFER LIMIT         15000020
PCBDTRTN DS    AL3                      ADDRESS OF DATE/TIME RTN S22025 16000022
PCBLCBAD DS    A .                      ADDR OF LINE CONTROL BLOCK      17000020
PCBASID  DS    H                        ADDRESS SPACE IDENTIFIER Y02027 17500010
PCBCKPT  DS    H .                      CHECKPOINT OFFSET               19000020
PCBPEBAD DS    A                        ADDRESS OF THE PROCESS   Y02027 19500010
*                                       EXTENSION BLK FOR RELATEDY02027 20000010
*                                       APPLICATION PROGRAM             22000020
PCBOFLG  DS    X .                      FLAG BYTE                       23000020
*                  BIT DEFINITIONS                                      24000020
PCBRORIN EQU   X'80' .                  APPL PROG ROLLOUTABLE           25000020
PCBRORIF EQU   X'7F' .                  APPL PROG NON-ROLLOUTABLE       26000020
PCBTSON  EQU   X'40' .                  APPL PROG IS TSO                27000020
PCBTSOF  EQU   X'BF' .                  APPL PROG IS NOT TSO            28000020
PCBCKPTN EQU   X'20' .                  ENVIRONMENT CHECKPOINT          29000020
*                                       HAS BEEN TAKEN IN MCP           30000020
PCBCKPTF EQU   X'DF' .                  ENVIRONMENT CHECKPOINT          31000020
*                                       HAS NOT BEEN TAKEN IN MCP       32000020
PCBRETVN EQU   X'10' .                  SUBSEQUENT RETRIEVAL            33000020
PCBRETVF EQU   X'FF'-X'10' .            NOT SUBSEQUENT RETRIEVAL        34000020
PCBPIPN  EQU   X'02' .                  PUT IN PROGRESS          A50196 34500022
         DS    XL3                                                      35000020
         DS    BL1                                                      36000020
         DS    AL3                                                      37000020
         DS    AL1                                                      38000020
PCBUNTCT DS    AL1 .                    UNIT COUNT                      39000020
PCBBFSZE DS    XL2 .                    BUFFER SIZE                     40000020
PCBRSERH DS    AL1 .                    HEADER BUFFER RESERVE           41000020
PCBRSERT DS    AL1 .                    TEXT BUFFER RESERVE             42000020
PCBORC   DS    X .                      OPEN RETURN CODE                43000020
PCBOFLG1 DS    X .                      FLAG BYTE               SA59162 44000022
PCBSFLAG EQU   X'80' .                  OMIT MSG SERVICING      SA59162 44300022
PCBABEND EQU   X'40' .                  ALLP PROG ABENDING      SA59162 44600022
PCBDELAY DS    H                        TCAM TIME DELAY        @XA11307 44700010
*                                        IN SECONDS            @XA11307 45000010
PCBPACE  DS    H                        MAX CNT BETWEEN DELAYS @XA11307 45500010
PCBCNT   DS    H                        COUNT SINCE LAST DELAY @XA11307 46000010
         DS    H                        RESERVED FOR ALIGNMENT @XA11307 46300010
PCBEND   EQU   *                                                        47000020
PCBSIZE  EQU   PCBEND-IEDQPCB                                           48000020
         MEND                                                           49000020
./  ADD  SSI=71080528,NAME=TPEBD
         MACRO                                                          03000006
         TPEBD                                                          06000006
IEDQPEB  DSECT                          PROCESS EXTENSION BLOCK         09000006
*                                                                       12000006
PEBLINK  DS    A                        LINK FIELD OF NEXT PEB          15000006
*                                       IN CHAIN                        18000006
PEBRCB   DS    2F                       RCB FOR TERMINATOR              21000006
PEBASID  DS    F                        ASID OF APP. PGM. TASK          24000006
PEBFLG   DS    0X                       A.P. ABEND; NO CMPOST           27000006
PEBASCB  DS    A                        ADDRESS OF ASCB FOR THIS        30000006
*                                       APPLICATION PROGRAM             33000006
PEBTCB   DS    A                        ADDRESS OF TCB FOR THIS         36000006
*                                       APPLICATION PROGRAM             39000006
PEBPCB   DS    A                        ADDRESS OF ASSOCIATED PCB       42000006
PEBPEWA  DS    F                        PEWA ADDR IF A.P. TERMINATING   42600006
PEBFLAG  DS    X                        PEB FLAG                        43200006
PEBTERM  EQU   X'80'                    A.P. IS TERMINATING             43800006
PEBCLOSE EQU   X'10'                    APPL PROG HAS POSTED            44400006
*                                       ELEMENT TO IEDQEU               44500006
PEBSPARE DS    3X                       UNUSED                          44600006
PEBECBA  DS    4X                       ECB ADDR FOR A.P. CLOSE         44700006
PEBEND   DS    0X                       SIZE OF                         45000006
PEBSIZE  EQU   PEBEND-IEDQPEB           PEB                             48000006
         MEND                                                           51000006
./  ADD  SSI=73500289,NAME=TPECBD
         MACRO                                                          03000006
         TPECBD                                                         06000006
*C150000                                                       @OZ07830 07000000
*A570000                                                       @OZ18744 07000182
IEDQPECB DSECT                          PROCESS ECB                     09000006
*                                                                       12000006
PECBECB  DS    F                        ELEMENT CONTROL BLOCK  @OZ07830 15000000
*                                       USED BY SVC 102 FOR A.P.        18000006
PECBPARM DS    F                        PARAMETER LIST FOR SVC          21000006
*                                       102                             24000006
PECBSAVE DS    A                        ADDRESS OF USER'S SAVE          27000006
*                                       AREA ON GET,PUT,OR POINT        30000006
PECBPUTF DS    FL1                      PUT FLAG                        33000006
FIRSTPUT EQU   X'01'                    FIRST TIME PUT/LOCATE           36000006
PECBRET  DS    AL3                      ADDRESS OF USER'S               39000006
*                                       RETURN ON CHECK                 42000006
PECBERR  DS    0F                       ERROR CODE                      45000006
PECBSTAT DS    20X                      STATUS FOR SYNAD                48000006
         ORG   PECBSTAT                                                 48500006
PECBSA   DS    18F                      SAVE AREA FOR A.P. CK/PT        49500006
PECBFLAG EQU   PECBSTAT+4               FLAG FOR CHECKPOINT AND         51000006
*                                       MESSAGE STATUS                  54000006
PECBSAVA EQU   PECBSTAT+4               SAVE AREA FOR EXITS             57000006
PECBOPTC DS    FL1                      X'40' DELETE=YES TPDATE@OZ18744 57050082
PECBDTSA DS    AL3                      USER DTSA - TPDATE     @OZ18744 57100082
PECBEND  DS    0X                       END OF BLOCK                    60000006
PECBSIZE EQU   PECBEND-IEDQPECB         SIZE OF PECB                    63000006
         MEND                                                           66000006
./  ADD  SSI=80940192,NAME=TPEWAD
         MACRO                                                          02000020
         TPEWAD                                                         04000020
.*                 7/1/73  MODIFICATION DATE                    SA63961 04200000
.*A180000                                                       SA63961 04400000
*A400000                                                         S22027 04600022
*C400000                                                         S22027 05200022
*C614000                                                       @ZA01132 05400000
*C633000                                                       @OZ07798 05600000
*A635600                                                       @OZ27843 05600182
*A607000                                                       @OY20522 05600282
IEDQPEWA DSECT                          PROCESS ENTRY WORKAREA          06000020
PEWARES  DS    2F                       RESERVED FOR LCB         Y02027 07000000
PEWAISZE DS    F                        COUNT OF IDLES           Y02027 08000000
PEWARTVE DS    2F                       RETRIEVE SAVEAREA        Y02027 09000000
MRM      EQU   X'40'                    FIRST MULTI RETRIEVE     Y02027 10000000
MULTSEQ  EQU   X'80'                    MULTI RETRIEVE IND.      Y02027 10600000
PEWALINK DS    A                        ADDRESS OF NEXT PEWA IN  Y02027 11200000
*                                       CHAIN                    Y02027 12000000
PEWAECBA DS    F                        ADDR OF APPL PROG ECB           14000020
PEWASOWA DS    H                        WORKAREA DATA LENGTH            16000020
PEWAFLG  DS    X                        GENERAL FLAG BYTE               18000020
ERBBUSY  EQU   X'80'                    ERB IN USE               Y02027 18090000
ERBFREE  EQU   X'7F'                    ERB AVAILABLE            Y02027 18180000
CFLG     EQU   X'40'                    CLOSEDOWN IN PROGRESS    Y02027 18270000
POSTAP   EQU   X'20'                    POST A.P. ECB            Y02027 18360000
POSTOFFF EQU   X'DF'                    MASK FOR NO POST         Y02027 18450000
RAFLG    EQU   X'08'                    READ AHEAD OK            Y02027 18540000
FIRSTR   EQU   X'04'                    FIRST FOR RETRIEVE       Y02027 18630000
MHOK     EQU   X'02'                    MAY BE POSTED TO MH      Y02027 18720000
PBUF     EQU   X'01'                    PARTIAL BUFFER (PUT)     Y02027 18810000
RFLG     EQU   X'01'                    RETRIEVE INITIATED       Y02027 18900000
PEWASTOP EQU   X'10' .                  DISABLED ENTRY CODE     SA63961 19000000
PEWABFCT DS    X                        BUFFER LIMIT             Y02027 19500000
PEUNCT   DS    0FL1                     UNITS PER BUFFER                22000020
PEPCBAD  DS    F                        ADDR OF PROCESS CNTL BLK        24000020
PERCQCB  DS    F                        ADDRESS OF THE QCB              26000020
*                                       ASSOCIATED WITH THE ERB         28000020
*                                       BELOW                           30000020
PEWARESA DS    F                        RESERVED FOR LCB         Y02027 31000000
PEWALCBA DS    F                                                        34000020
PEWARESB DS    F                        RESERVED FOR LCB         Y02027 35000000
PEWACBUF DS    F                        CURRENT BUFFER UNIT      Y02027 36000000
PEERB    DS    6F                       ELEMENT REQUEST BLOCK    Y02027 38000000
PEWAELEM DS    4F                       SPECIAL ELEMENT                 42000020
PERAQCB  DS    F                        READ-AHEAD QCB           Y02027 43000000
PEWAQCBL DS    F                        LINK FIELD OF RAQCB      Y02027 44000000
PEWAQCBS DS    F                        STCB FIELD OF RAQCB      Y02027 45000000
EOMSAVE  DS    0F                       ADDR OF LAST EOM                46000020
PEWATIC  DS    F .                      CURRENT UNIT ADDRESS            48000020
PEWADEB  DS    F .                      DATA EXTENT BLOCK ADDRESS       54000020
PEWAPROC DS    F                        ADDRESS OF PROCESS ENTRY        58000020
PEWAPEBF DS    A                        ADDRESS OF PARTIALLY     Y02027 59000000
*                                       EMPTY BUFFER             Y02027 60000000
PEWAMOVE DS    A                        FOR GET, ADDRESS OF NEXT Y02027 60050000
*                                       BYTE TO BE MOVED IN BUFR Y02027 60100000
*                                       FOR PUT, ADDRESS OF FIRSTY02027 60150000
*                                       BYTE IN AIB WORKAREA     Y02027 60200000
PEWANEB  DS    A                        FOR GET, ADDRESS OF NEXT Y02027 60250000
*                                       EMPTY BYTE IN WORKAREA   Y02027 60300000
*                                       FOR PUT, ADDRESS OF NEXT Y02027 60350000
*                                       BYTE OF DATA TO BE MOVED Y02027 60400000
PEWAPEUN DS    A                        FOR GET, ADDRESS OF      Y02027 60450000
*                                       PARTIALLY EMPTY UNIT     Y02027 60500000
*                                       FOR PUT, SIZE OF DATA    Y02027 60550000
*                                       REMAINING IN WORKAREA    Y02027 60600000
PEWAOPT2 DS    FL1                      DATE AND TIME SWITCH     Y02027 60650000
DELETE   EQU   X'40'                    DELETE=YES SPECIFIED     Y02027 60700000
PEWADATE EQU   X'20'                    TPROCESS-  DATE=YES    @OY20522 60720082
DATE     EQU   X'10'                    DTSAREA IS SPECIFIED     Y02027 60750000
OVERFLOW EQU   X'04'                    OVERFLOW FOR CLOSE       Y02027 60800000
PEWAOUT  EQU   X'02'                    PEWA FOR OUTPUT DCB      Y02027 60850000
PEWAIN   EQU   X'01'                    PEWA FOR INPUT DCB       Y02027 60900000
PEWADTSA DS    AL3                      ADDRESS OF D/T INSERTION Y02027 60950000
PEWACTL  DS    X                        WORKAREA CONTENTS        Y02027 61000000
*                                       DESCRIPTOR BYTE          Y02027 61050000
NEWINIT  EQU   X'F0'                    INITIAL SEGMENT          Y02027 61100000
HDRFLG   EQU   X'F1'                    HEADER SEGMENT           Y02027 61150000
EOMFLAG  EQU   X'F2'                    LAST SEGMENT             Y02027 61200000
MESSAGE  EQU   X'F3'                    ENTIRE MESSAGE           Y02027 61250000
ISEGFLAG EQU   X'40'                    INTERMEDIATE SEGMENT     Y02027 61300000
EOR      EQU   X'F4'                    END OF RECORD          @ZA01132 61350000
PEWARDEL DS    X                        END OF RECORD            Y02027 61400000
PEWAOPTC DS    X                        FOR GET                  Y02027 61450000
TNMEFLG  EQU   X'80'                    DCBOPTCD=W               Y02027 61500000
MSGFLG   EQU   X'40'                    DCBOPTCD=U               Y02027 61550000
CTLBYTE  EQU   X'20'                    DCBOPTCD=C               Y02027 61600000
EODADFLG EQU   X'10'                    EODAD EXIT FLAG          Y02027 61650000
RECDEL   EQU   X'08'                    FIRST TIME RECDEL FLAG   Y02027 61700000
RTVFLG   EQU   X'04'                    RETRIEVE MODE SWITCH     Y02027 61750000
PARTBUF  EQU   X'02'                    PARTIALLY EMPTY BUFFER   Y02027 61800000
SYNADFLG EQU   X'01'                    EXIT TO SYNAD IF SPEC'D  Y02027 61850000
PEWAFLG1 DS    X                        CONTENTS OF DCBFLG1      Y02027 61900000
PEWAGSW  DS    2X                       GENERAL SWITCHES         Y02027 61950000
*        BYTE ONE                                                Y02027 62000000
UNDFLG   EQU   X'C0'                    UNDEFINED FORMAT         Y02027 62060000
FIXFLG   EQU   X'80'                    FIXED FORMAT             Y02027 62120000
VARFLG   EQU   X'40'                    VARIABLE FORMAT          Y02027 62180000
BLKFLG   EQU   X'10'                    BLOCKED RECORD           Y02027 62240000
RETRIEVE EQU   X'04'                    RETRIEVE OK              Y02027 62300000
INCWA    EQU   X'01'                    INCOMPLETE WORKAREA      Y02027 62360000
*        BYTE TWO                                                Y02027 62420000
EOM      EQU   X'80'                    EOM LAST TIME            Y02027 62480000
NEEDHDRN EQU   X'20'                    HEADER NEEDED            Y02027 62540000
RESETACT EQU   X'02'                    QRESET ACTIVE            Y02027 62600000
ARESET   EQU   X'01'                    QRESET IS ALLOWED        Y02027 62660000
PEWAPETO DS    H                        PROCESS ENTRY TERM NAME  Y02027 62720000
*                                       OFFSET                   Y02027 62780000
PEWAOFF  DS    H                        TERMNAME OFFSET TO MSG   Y02027 62840000
*                                       DESTINATION              Y02027 62900000
PEWASCAN DS    H                        SIZE OF FIELD SCANNED    Y02027 62960000
PEWALREC DS    H                        SIZE OF LOGICAL WORK UNITY02027 63020000
PEWAUSZE DS    H                        COUNT OF DATA IN BUFFER  Y02027 63080000
*                                       UNIT                     Y02027 63140000
PEWAPSZE DS    H                        COUNT OF DATA IN LOGICAL Y02027 63200000
*                                       BUFFER                   Y02027 63260000
PEWASRCE DS    H                        TERMNAME OFFSET OF SOURCEY02027 63320000
PEWAWA   DS    A                        ADDRESS OF WORKAREA IN   Y02027 63380000
*                                       AIB                      Y02027 63440000
PEWASAVE DS    9F                       SAVE AREA              @OZ07798 63500000
PEWARCB  DS    F                        RCB ADDRESS            @OZ07798 63560000
PEWAQCB  DS    F                        DUMMY QCB FOR APPL PROG@OZ27843 63570082
PEWAQLNK DS    F                         TO INDENTIFY PEWA IN  @OZ27843 63580082
PEWASTCB DS    F                         DISP TRACE ENTRY      @OZ27843 63590082
PEWASCB  DS    0X                       SCB - SIZE VARIABLE      Y02027 63620000
PEWATRT  DS    0X                       TRT OF INPUT DCB         Y02027 63680000
*                                       256 BYTES AFTER SCB      Y02027 63740000
PEWAEND  DS    0X                        WORKAREA                       64000020
PEWASIZE EQU   PEWAEND-IEDQPEWA         SIZE OF PROCESS ENTRY           66000020
         MEND                                                           68000020
./  ADD  SSI=71640512,NAME=TPF1D
*        %GOTO PF1PLS;                  /* BILINGUAL HEADER             01000000
         MACRO                                                          02000000
         TPF1D                                                          03000000
.*A000000-999999                                               @Y17XAXF 04000000
IEDPF1   DSECT                                                          05000000
*                                                                       06000000
*        DSECT FOR BUFFER PREFIX                                        07000000
*                                                                       08000000
PF1RH    DS    CL3 .                    RH                              09000000
PF1FLAGS DS    CL1 .                    FLAG BYTE                       10000000
PF1FIDI  EQU   X'80' .                   FID INDICATOR                  11000000
PF1EXPI  EQU   X'40' .                   EXPIDITED/NORMAL INDICATOR     12000000
*PF1FORM       BITS 2&3                  DESCRIBES 2ND WORD OF PREFIX   13000000
PF1PTRI  EQU   X'20' .                    PF1SEQP IS PRESENT            14000000
PF1IDI   EQU   X'10' .                    PF1SEQID ONLY IS PRESENT      15000000
PF1SEQRI EQU   X'30'                      PF1SEQID AND PF1RULEN PRESENT 16000000
*        EQU   X'08'-X'01' .             RESERVED                       17000000
PF1WORD2 DS    0AL4 .                   2ND WORD FORMATED AS INDICATED  18000000
*                                        IN PF1FORM                     19000000
PF1SEQP  DS    0AL4 .                   PTR TO AN AREA INTO WHICH THE   20000000
*                                        ASSIGNED SEQ# WILL BE          21000000
*                                        STORED(FID1 ONLY)              22000000
PF1SEQID DS    CL2 .                    FOR FID1 - SEQ# OR ID           23000000
*                                           FID0 - IND                  24000000
PF1RULEN DS    CL2 .                    FOR FID1 ONLY - CONTAINS LENGTH 25000000
*                                        OF RU(DATA) ON 0 LENGTH ERROR  26000000
*                                        BUFFERS                        27000000
PF1LEN   EQU   *-IEDPF1 .               LENGTH OF THIS PREFIX           28000000
         MEND                                                           29000000
*        */                                                             30000000
*%PF1PLS:;                                                              31000000
*DECLARE                                                                32000000
*  1 IEDPF1 BASED BDY(WORD),                                            33000000
*/*                                                                  */ 34000000
*/*      DSECT FOR BUFFER PREFIX                                     */ 35000000
*/*                                                                  */ 36000000
*    2 PF1RH    CHAR(3),                /* RH                        */ 37000000
*    2 PF1FLAGS CHAR(1),                /* FLAG BYTE                 */ 38000000
*      3 PF1FIDI BIT(1),                /*  FID INDICATOR            */ 39000000
*      3 PF1EXPI BIT(1),                /*  EXPEDITED/NORMAL IND     */ 40000000
*      3 PF1FORM BIT(2),                /*  DESCRIBES 2ND WORD OF PF1*/ 41000000
*      3 *       BIT(4),                /*  RESERVED                 */ 42000000
*    2 PF1WORD2 PTR(32),                /* 2ND WORD FORMATED AS      */ 43000000
*                                       /*  INDICATED IN PF1FORM     */ 44000000
*      4 PF1SEQP  PTR(32),              /* PTR TO AN AREA INTO WHICH */ 45000000
*                                       /*  THE ASSIGNED SEQ# WILL BE*/ 46000000
*                                       /*  STORED(FID1 ONLY)        */ 47000000
*        5 PF1SEQID BIT(16),            /* FOR FID1 - SEQ# OR ID     */ 48000000
*                                       /*     FID0 - IND            */ 49000000
*        5 PF1RULEN BIT(16);            /* FOR FID1 ONLY - CONTAINS  */ 50000000
*                                       /*  LEN OF RU(DATA) ON 0     */ 51000000
*                                       /*  LENGTH ERROR BUFFERS     */ 52000000
* %PF1LEN='LENGTH(IEDPF1)';             /* LENGTH OF THIS PREFIX     */ 53000000
*/* PF1FORM VALUES                                                   */ 54000000
* DCL PF1IDI   BIT(2) CONSTANT('01'B);  /* PF1SEQP IS PRESENT        */ 55000000
* DCL PF1PTRI  BIT(2) CONSTANT('10'B);  /* PF1SEQID ONLY IS PRESENT  */ 56000000
* DCL PF1SEQRI BIT(2) CONSTANT('11'B);  /* PF1SEQID & PF1RULEN ARE   */ 57000000
./  ADD  SSI=61050126,NAME=TPIUD
*        %GOTO PIUPLS;                 /* BILINGUAL HEADER              01000010
         MACRO                                                          02000010
         TPIUD                                                          03000010
.*A000000-999999                                               @Y17XAXF 04000010
IEDPIU   DSECT                                                          18000010
*                                                                       19000010
*        FORMAT OF FID1 PIU                                             20000010
*                                                                       21000010
PIUTH    DS    CL10 .                   TH AREA                         22000010
PIURH    DS    CL3 .                    RH AREA                         23000010
PIURU    EQU   * .                      START OF RU DATA                24000010
PIULEN   EQU   *-IEDPIU .               LENGTH OF PIU                   25000010
         MEND                                                           26000010
*        */                                                             27000010
*%PIUPLS:;                                                              28000010
*DECLARE                                                                44000010
*  1 IEDPIU BASED BDY(BYTE),                                            45000010
*/*                                                                  */ 46000010
*/*      FORMAT OF FID1 PIU                                          */ 47000010
*/*                                                                  */ 48000010
*   2 PIUTH  CHAR(10),                  /* TH AREA                   */ 49000010
*   2 PIURH  CHAR(3),                   /* RH AREA                   */ 50000010
*   2 PIURU  CHAR(0);                   /* START OF RU DATA          */ 51000010
*%PIULEN='LENGTH(IEDPIU)';              /* LENGTH OF PIU             */ 52000010
./  ADD  SSI=61050127,NAME=TPIU0D
*        %GOTO PIU0PLS;                /* BILINGUAL HEADER              03000010
         MACRO                                                          06000010
         TPIU0D                                                         09000010
.*A000000-999999                                               @Y17XAXF 12000010
IEDPIU0  DSECT                                                          15000010
*                                                                       18000010
*        FORMAT OF FIDO PIU                                             21000010
*                                                                       24000010
PIU0TH   DS    CL10 .                   TH AREA                         27000010
PIU0RH   DS    CL3 .                    RH AREA                         30000010
PIU0PAD  DS    CL1 .                    FID0 PAD BYTE                   33000010
PIU0PAD0 EQU   X'00' .                   PAD CONSTANT                   36000010
PIU0RU   EQU   * .                      START OF RU DATA                39000010
PIU0LEN  EQU   *-IEDPIU0                LEN OF PIU                      42000010
         MEND                                                           45000010
*        */                                                             48000010
*%PIU0PLS:;                                                             51000010
*DECLARE                                                                54000010
*  1 IEDPIU0 BASED BDY(BYTE),                                           57000010
*/*                                                                  */ 60000010
*/*      FORMAT OF FID0 PIU                                          */ 63000010
*/*                                                                  */ 66000010
*   2 PIU0TH   CHAR(10),                /* TH AREA                   */ 69000010
*   2 PIU0RH   CHAR(3),                 /* RH AREA                   */ 72000010
*   2 PIU0PAD  CHAR(1),                 /* FID0 PAD BYTE             */ 75000010
*   2 PIU0RU   CHAR(0);                 /* START OF RU AREA          */ 78000010
*%PIU0LEN='LENGTH(IEDPIU0)';            /* LENGTH OF PIU             */ 81000010
* DCL PIU0PAD0 BIT(8) CONSTANT('00'X);  /* FID0 PAD CONSTANT         */ 84000010
./  ADD  SSI=62590434,NAME=TPLBMD
*        %GOTO PLSPLBM;                 /*                              00050010
         MACRO                                                          00100010
         TPLBMD                                                         00150010
.*A000000-999999                                               @Y17XAXF 00200010
*                                                                       00250010
*        PARAMETER LIST FOR BRACKET MANAGEMENT INTERFACE                00300010
*                                                                       00350010
IEDPLBM  DSECT                                                          00400010
PLBMFLG1 DS    XL1                      FLAG BYTE                       00450010
PLBMSNDI EQU   X'80'                     ON-SENDING(OUTBOUND FLOW)      00500010
*                                        OFF-RECEIVING(INBOUND FLOW)    00550010
*PLBMSTAT EQU  X'40'-X'20'               SPECIAL STATUS INDICATOR       00600010
PLBMERR  EQU   X'60' .                    AN ERROR HAS BEEN DETECTED ON 00606010
*                                          THIS REQUEST                 00612010
PLBMPURG EQU   X'20' .                    THIS REQUEST WAS RECEIVED     00618010
*                                          (INBOUND) WHIL PURGING CHAIN 00624010
*                                          STATE                        00630010
PLBMNORM EQU   X'00' .                    NOT ANY OF ABOVE CONDITIONS   00636010
*        EQU   X'10'-X'01'               RESERVED                       00642010
         DS    XL1                      RESERVED                        00650010
PLBMSNC  DS    CL2                      1ST 2 BYTES OF SNA SENSE DATA   00700010
*                                       (ONLY PRESENT WHEN TRHSDI=ON)   00750010
*                                         THIS FIELD IS ALSO USED TO    00770010
*                                         PASS SENSE ON ERRORS DETECTED 00790010
*                                         BY BRACKET MANAGER            00810010
PLBMRH   DS    CL3                      RH                              00850010
PLBMCMD  DS    CL1                      COMMAND CODE BYTE(0 FOR FMD)    00900010
PLBMSIB  DS    A                        POINTER TO SIB                  00950010
PLBMLCB  DS    A                        POINTER TO LCB                  01000010
         MEND  */                                                       01050010
*%PLSPLBM : ;                                                           01100010
*/*                                                                  */ 01150010
*/*      PARAMETER LIST FOR BRACKET MANAGEMENT INTERFACE             */ 01200010
*/*                                                                  */ 01250010
* DECLARE                                                               01300010
* 1 IEDPLBM  BASED(PLBMPTR),                                            01350010
*   2 PLBMFLG1 CHAR(1),                 /* FLAG BYTE                 */ 01400010
*     3 PLBMSNDI BIT(1),                /* ON-SENDING(OUTBOUND FLOW)    01450010
*                                       OFF-RECEIVING(INBOUND FLOW)  */ 01500010
*     3 PLBMSTAT BIT(2),                /* SPECIAL STATUS INDICATOR  */ 01550010
*     3 *        BIT(5),                /* RESERVED                  */ 01570010
*   2 *        CHAR(1),                 /* RESERVED                  */ 01600010
*   2 PLBMSNC  CHAR(2),                 /* 1ST 2 BYTES OF SNA SENSE     01650010
*                                       DATA (ONLY PRESENT WHEN TRHSDI  01700010
*                                       =ON)                         */ 01720010
*                                       /*THIS FIELD IS ALSO USED TO    01740010
*                                         PASS SENSE ON ERRORS DETECTED 01760010
*                                         BY BRACKET MANAGER         */ 01780010
*   2 PLBMRH   CHAR(3),                 /* RH                        */ 01800010
*   2 PLBMCMD  CHAR(1),                 /* CMD CODE BYTE(0 FOR FMD)  */ 01850010
*   2 PLBMSIB  PTR(31),                 /* POINTER TO SIB            */ 01900010
*   2 PLBMLCB  PTR(31);                 /* POINTER TO LCB            */ 01950010
*/*PLBMSTAT VALUES                                                   */ 04950010
* DCL PLBMERR  BIT(2) CONSTANT('11'B);  /*AN ERROR HAS BEEN DETECTED    07950010
*                                         ON THIS REQUEST            */ 10950010
* DCL PLBMPURG BIT(2) CONSTANT('01'B);  /*THIS REQUEST WAS RECEIVED     13950010
*                                         (INBOUND) WHILE IN PURGING    16950010
*                                         CHAIN STATE                */ 19950010
* DCL PLBMNORM BIT(2) CONSTANT('00'B);  /*NOT ANY OF ABOVE CONDITIONS*/ 22950010
./  ADD  SSI=62230023,NAME=TPLMVD
*        %GOTO PLSPLMV;                                                 03000010
         MACRO                                                          06000010
         TPLMVD                                                         09000010
         SPACE                                                          12000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          15000010
.*A-000000-999999                                              @Y17XANU 18000010
IEDPLMV  DSECT                                                          21000010
*                                                                       24000010
*        DSECT FOR DATA MOVE PARAMETER LIST                             27000010
*                                                                       30000010
PLMVTU   DS    A .                      TARGET UNIT ADDRESS             33000010
PLMVTD   DS    A .                      TARGET DATA ADDRESS             36000010
PLMVSU   DS    A .                      SOURCE UNIT ADDRESS             39000010
PLMVSD   DS    A .                      SOURCE DATA ADDRESS             42000010
PLMVLNTH DS    H .                      LENGTH OF DATA TO BE MOVED      45000010
PLMVFLG1 DS    XL1 .                    FLAG BYTE 1            @Y17XAXF 45400010
PLMVUNCF EQU   X'80' .                    UNCHAIN FLAG         @Y17XAXF 45800010
PLMVSCTG EQU   X'40' .                    SOURCE = CONTIGUOUS AREA      46200010
PLMVTCTG EQU   X'20' .                    TARGET = CONTIQUOUS AREA      46300010
*        EQU   X'10'-X'01'                RESERVED             @Y17XAXF 46400010
PLMVFLG2 DS    XL1 .                    FLAG BYTE 2            @Y17XAXF 46600010
PLMVUNCA DS    A .                      ADDR OF UNUSED TARGET UNIT      47000010
*                                         UNCHNED BY IEDMVBFR  @Y17XAXF 47400010
PLMVLEN  EQU   *-IEDPLMV .              LENGTH OF P-LIST                48000010
         MEND                                                           51000010
*        */                                                             54000010
*%PLSPLMV: ;                                                            57000010
*DECLARE 1 IEDPLMV BDY(WORD) BASED(IEDPLMVP),                           60000010
*/*                                                                  */ 63000010
*/*                                                                  */ 66000010
*/*                                                                  */ 69000010
*   2 PLMVTU   PTR(31),                 /* TARGET UNIT ADDRESS       */ 72000010
*   2 PLMVTD   PTR(31),                 /* TARGET DATA ADDRESS       */ 75000010
*   2 PLMVSU   PTR(31),                 /* SOURCE UNIT ADDRESS       */ 78000010
*   2 PLMVSD   PTR(31),                 /* SOURCE DATA ADDRESS       */ 81000010
*   2 PLMVLNTH FIXED(16),               /* LENGTH OF DATA TO BE MOVED*/ 84000010
*   2 PLMVFLG1 BIT(8),                  /* FLAG BYTE 1       @Y17XAXF*/ 84300010
*     3 PLMVUNCF BIT(1),                /*  UNCHAIN FLAG     @Y17XAFX*/ 84600010
*     3 PLMVSCTG BIT(1),                /*  SOURCE = CONTIGUOUS AREA */ 84900010
*     3 PLMVTCTG BIT(1),                /*  TARGET = CONTIGUOUS AREA */ 85000010
*     3 *        BIT(5),                /*  RESERVED         @Y17XAFX*/ 85100010
*   2 PLMVFLG2 BIT(8),                  /* FLAG BYTE 2       @Y17XAXF*/ 85200010
*   2 PLMVUNCA PTR(31);                 /* ADDRESS OF UNUSED TARGET  */ 85500010
*                                       /*  UNT UNCHNED BY IEDMVBFR  */ 85800010
*                                       /*                   @Y17XAXF*/ 86100010
*                                                                       87000010
* %PLMVLEN='LENGTH(IEDPLMV)';           /* LENGTH OF P-LIST          */ 90000010
./  ADD  SSI=60710712,NAME=TPLRQD
*        %GOTO PLSPLRQ;                 /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TPLRQD                                                         06000010
         SPACE                                                          08000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          10000010
.*A-000000-999999                                              @Y17XAXU 12000010
IEDPLRQ  DSECT                                                          14000010
*                                                                       16000010
*        DSECT FOR REQUEST PARAMETER LIST                               18000010
*                                                                       20000010
PLRQBFR  DS    A .                      BUFFER ADDRESS                  22000010
PLRQOAF  DS    H .                      ORIGIN TNT OFFSET               24000010
PLRQDAF  DS    H .                      DESTINATION TNT OFFSET          26000010
PLRQLNTH DS    XL1 .                    LENGTH OF COMMAND CODE          28000010
PLRQCMD  DS    0CL3 .                   COMMAND CODE                    30000010
PLRQCMD1 DS    CL1 .                    COMMAND CODE - BYTE 1           32000010
PLRQCMD2 DS    CL1 .                    COMMAND CODE - BYTE 2           34000010
PLRQCMD3 DS    CL1 .                    COMMAND CODE - BYTE 3           36000010
PLRQLEN  EQU   *-IEDPLRQ .              LENGTH OF P-LIST                38000010
         MEND                                                           40000010
*        */                                                             42000010
*%PLSPLRQ: ;                                                            44000010
*DECLARE 1 IEDPLRQ BDY(WORD) BASED(IEDPLRQP),                           46000010
*/*                                                                  */ 48000010
*/*      DSECT FOR REQUEST PARAMETER LIST                            */ 50000010
*/*                                                                  */ 52000010
*   2 PLRQBFR    PTR(31),               /* BUFFER ADDRESS            */ 54000010
*   2 PLRQOAF    FIXED(15),             /* ORIGIN TNT OFFSET         */ 56000010
*   2 PLRQDAF    FIXED(15),             /* DESTINATON TNT OFFSET     */ 58000010
*   2 PLRQLNTH   FIXED(8),              /* LENGTH OF COMMAND CODE    */ 60000010
*   2 PLRQCMD    CHAR(3),               /* COMMAND CODE              */ 62000010
*    3 PLRQCMD1  CHAR(1),               /* COMMAND CODE - BYTE 1     */ 64000010
*    3 PLRQCMD2  CHAR(1),               /* COMMAND CODE - BYTE 2     */ 66000010
*    3 PLRQCMD3  CHAR(1);               /* COMMAND CODE - BYTE 3     */ 68000010
*                                                                       70000010
* %PLRQLEN='LENGTH(IEDPLRQ)';           /* LENGTH OF PLIST           */ 72000010
./  ADD  SSI=71171002,NAME=TPRFD
*        %GOTO BSLPRF;                                               /* 00100022
         MACRO                                                          00300008
         TPRFD                                                          00400008
.*A-000000-999999                                              @X31X8X0 00500008
.* CHANGE ACTIVITY = AS FOLLOWS:                                        00600122
.*C144000                                                       SA51078 00600222
.*A055000,061000,144600-146400                                  SA51078 00600322
.*C066000                                                       SA51783 00600422
.*A067000-068000                                                SA51783 00600522
.*C01000,093000                                                  S22029 00603022
.*D126000-129000                                                 S22029 00606022
.*A009000,051000                                                 S21101 00610020
.*D249000-948000                                                 S21101 00620020
.*A006200,132000                                                 S22025 00710022
.*C010000                                                        S22025 00800022
.*A000000,054000,249000                                          S22024 00830022
.*C246000                                                        S22024 00860022
.*A053700,115000,361000,751000-752000                            X03039 00870008
.*C010000,274000,358000,414000,493000                            X03039 00880008
.*D055001                                                        X03039 00890008
.*C010000,274000                                               @Z30X8XE 00895000
.*A055000,171000,729000,638000                                 @Y17XAXF 00896000
.*C138000,473000-477000                                        @Y17XAXF 00897000
IEDQPRF  DSECT                                                          00900020
*        UPDATED  6/7/74                                       @Z30X8XE 01000000
.*       CONVERT TO A BILINGUAL DSECT 07/17/72                   S22024 01100022
         SPACE                                                          01200020
         SPACE                                                          01500020
PRFRCB   DS    0D .                     RESOURCE CONTROL BLOCK          01800020
PRFOPCDE DS    0XL1 .                   CCW OPERATION CODE              02100020
PRFKEY   DS    XL1 .                    ELEMENT KEY OF BUFFER           02400020
PRFIOADR DS    0AL3 .                   NEXT DATA BYTE(ADDRESS) TO BE   02700020
*                                       TRANSFERED(READ)                03000020
PRFQCBA  DS    XL3 .                    QCB ADDRESS                     03300020
PRFFLAGS DS    0XL1 .                   CCW FLAGS                       03600020
PRFPRI   DS    XL1 .                    PRIORITY OF BUFFER              03900020
PRFLINK  DS    0XL3 .                   LINK FIELD OF BUFFER            04200020
         DS    XL1 .                    UNUSED WHEN CCW                 04500020
PRFCOUNT DS    H .                      CCW (READ/WRITE) COUNT          04800020
PRFTIC   DS    0A .                     TIC CCW & LINK TO NEXT UNIT     05100000
*                                                              @Y17XAXF 05130000
PRFTICC  DS    XL1 .                    TIC CCW                @Y17XAXF 05160000
PRFEOMSG EQU   X'80' .                  TEMPORARY END OF MESSAGE S21101 05200020
*                                                                S21101 05250020
PRFBFMM  EQU   X'40' .                  HEADER CONVERTED TO TEXT S21101 05300020
*                                                                S21101 05350020
PRFTICON EQU   X'08' .                  TIC COMMAND CODE         X03039 05370008
PRFTI0   DS    AL3 .                    TIC ADDRESS            @Y17XAXF 05380000
PRFSUNIT DS    0XL1 .                   START OF LOGICAL UNIT           05400020
PRFPLQCB DS    0XL1 .                   PRIORITY INDEX          SA51078 05500022
PRFPIUO  DS    0XL1 .                   OFFSET TO PIU          @Y17XAXF 05600000
PRFNBUNT DS    XL1 .                    NO. UNITS IN THIS BUFFER        05700020
PRFLCB   DS    AL3 .                    POINTER TO LCB                  06000020
PRFSVFFO DS    0XL3 .                   FEFO PTR TO MARK SVCD   SA51078 06100022
PRFSRCE  DS    H .                      SRCE INDEX TO TERMNAME TBL      06300020
PRFSIZE  DS    0H .                     SIZE OF DATA IN THIS BFRSA51783 06600022
         DS    XL1 .                    LAST BYTE OF SVFFO      SA51783 06700022
PRFSVFLG DS    XL1 .                    SAVED DATA FLAGS        SA51783 06800022
PRFSTAT1 DS    XL1 .                    STATUS BYTE                     06900020
*                        BIT DEFINITIONS                                07200020
PRFCNCLN EQU   X'80' .                  CANCEL MESSAGE EXECUTED         07500020
PRFCNCLF EQU   X'FF'-PRFCNCLN .         MESSAGE NOT CANCELLED           07800020
PRFERMGN EQU   X'40' .                  ERROR MESSAGE IN THIS BFR       08100020
PRFERMGF EQU   X'BF' .                  NOT ERROR MESSAGE BUFFER        08400020
PRFITCPN EQU   X'20' .                  MESSAGE BEING HELD              08700020
PRFITCPF EQU   X'DF' .                  MESSAGE NOT BEING HELD          09000020
PRFTSMSG EQU   X'10' .                  THIS IS A TSO MESSAGE    S22029 09300022
PRFDUPLN EQU   X'08' .                  DUPLICATE HEADER BUFFER         09600020
PRFDUPLF EQU   X'F7' .                  ORIGINAL BUFFER                 09900020
PRFEOFN  EQU   X'04' .                  SETEOF WAS EXECUTED             10200020
PRFEOFF  EQU   X'FB' .                  SETEOF NOT EXECUTED             10500020
PRFLOCK  EQU   PRFEOFN  .               LOCK EXECUTED THIS MESSAGE      10800020
PRFNLSTN EQU   X'02' .                  NOT LAST BUFFER                 11100020
PRFNLSTF EQU   X'FD' .                  LAST BUFFER                     11400020
PRFESCAP EQU   X'FC' .                  OP CONTROL ESCAPE BUFFER X03039 11500008
PRFNHDRN EQU   X'01' .                  NOT HEADER BUFFER               11700020
PRFNHDRF EQU   X'FE' .                  HEADER BUFFER                   12000020
*                                                                       12300020
PRFXTRA  DS    0AL3 .                   POINTER TO ADDL RCDS - CURR     13200020
         ORG   PRFXTRA+1                SET DISP TO EOB          S22025 13270022
PRFEOB   DS    0H                       EOB OFFSET SAVE AREA     S22025 13340022
         ORG   PRFXTRA                                           S22025 13410022
PRFCORE  DS    AL3 .                    POINTER TO CURR RCD - COREQ     13500020
PRFSCAN  DS    0H                       SCAN POINTER           @Y17XAXF 13800000
         DS    CL1 .                     RESERVED              @Y17XAXF 13900000
PRFISIZE DS    CL1 .                     NUMBER OF RESERVES    @Y17XAXF 14000000
PRFNTXT  DS    0AL3 .                   POINTER TO NEXT TEXT SEG        14100020
PRFEOBOF DS    0XL1 .                   OFFSET INTO RECORD      SA51078 14400022
PRFSVPRI DS    0XL1 .                   PQCB INDEX TO MARK SVCD SA51078 14460022
PRFTQBCK DS    0XL3 .                   BACK-CHAIN TEXT SEGS    SA51078 14520022
         DS    XL1 .                                            SA51078 14580022
PRFSVSEQ DS    XL2 .                    SEQ NO FOR MARK SVCD    SA51078 14640022
PRFCRCD  DS    AL3 .                    POINTER TO CURRENT SEGMENT      14700020
PRFNHDR  DS    0AL3 .                   POINTER TO NEXT HDR SEG         15000020
PRFCHDR  DS    AL3 .                    POINTER TO HDR OF CURR MSG      15300020
PRFSTXT  DS    0XL1 .                    START OF TEXT LABEL            15600020
*                                                                       15900020
PRFHQBCK DS    AL3 .                    BACK CHAIN - HDR SEGMENTS       16200020
PRFISEQ  DS    H .                      INPUT SEQUENCE NUMBER           16500020
PRFDEST  DS    H .                      DEST INDEX TO TERMNAME TBL      16800020
PRFSHDR  DS    0XL1 .                   START OF HEADER LABEL           17100020
         SPACE 3                                               @Y17XAXF 17107000
IEDPF1   DSECT                                                 @Y17XAXF 17114000
*                                                              @Y17XAXF 17121000
*        DSECT FOR BUFFER PREFIX                               @Y17XAXF 17128000
*                                                              @Y17XAXF 17135000
PRF1RH   DS    CL3 .                    RH                     @Y17XAXF 17142000
PRF1FLG1 DS    XL1 .                    FLAG BYTE              @Y17XAXF 17149000
PRF1FIDI EQU   X'80' .                   FID1 INDICATOR        @Y17XAXF 17156000
PRFIEXPI EQU   X'40' .                   EXPIDITED/NORMAL IND  @Y17XAXF 17163000
*PRF1FORM      BITS 2&3                  DESC 2ND WORD OF PREF @Y17XAXF 17170000
PRF1PTRI EQU   X'10' .                    PRF1SEQP IS PRESENT  @Y17XAXF 17177000
PRF1IDI  EQU   X'20' .                    PRF1SQID ONLY IS     @Y17XAXF 17181000
*                                          PRESENT             @Y17XAXF 17186000
PRF1SQLI EQU   X'30'                      PRF1SQID AND         @Y17XAXF 17191000
*                                          PRF1RULN PRESENT    @Y17XAXF 17196000
PRF1USS  EQU   X'08' .                    CONV FROM USS TO FSS @Y17XAXF 17201000
PRF1LOGD EQU   X'04' .                    BUFFER CONTAINS LOGON DATA    17212000
*                                                              @Y17XAXF 17214000
*        EQU   X'02'-X'01' .              RESERVED             @Y17XAXF 17216000
PRF1WD2  DS    0A .                     2ND WORD FORMAT AS IND @Y17XAXF 17219000
*                                        IN PRFFORM            @Y17XAXF 17226000
PRF1SEQP DS    0A .                     PTR TO AN AREA INTO    @Y17XAXF 17233000
*                                        WHICH ASSIGNED NUMBER @Y17XAXF 17234000
*                                        WILL BE STORED(FID1)  @Y17XAXF 17247000
PRF1SQID DS    0H .                     FOR FID1 - SEQ         @Y17XAXF 17254000
*                                           FID0 - IND         @Y17XAXF 17261000
PRF1TAG1 DS    XL1 .                     FIRST TAG BYTE        @Y17XAXF 17262000
* USE TTHTAGS VALUES FOR PRF1TAGS                              @Y17XAXF 17263000
*PRF1TAGS      BITS 0-3 .                 TAG ROUTING AND TYPE @Y17XAXF 17264000
*              BITS 4-7 .                 RESERVED ..          @Y17XAXF 17265000
* USE TTHTAG2 TP OP CODE VALUES FOR PRF1TAG2                   @Y17XAXF 17265500
PRF1TAG2 DS    XL1 .                     SECOND TAG  BYTE      @Y17XAXF 17266000
*                                        (WHEN USED AS A TP OP @Y17XAXF 17266500
*                                         CODE, PRF1TAG1 MUST  @Y17XAXF 17267000
*                                         BE 0)                @Y17XAXF 17267500
PRF1RULN DS    H .                      FOR FID1 ONLY - LENGTH @Y17XAXF 17268000
*                                        OF RU(DATA) ON 0 LEN  @Y17XAXF 17275000
*                                        ERROR BUFFERS         @Y17XAXF 17282000
PRF1LEN  EQU   *-IEDPF1 .               LENGTH OF BUFFER PREF  @Y17XAXF 17289000
         SPACE 2                                               @Y17XAXF 17296000
IEDPF2   DSECT                          PIU PREFIX             @Y17XAXF 17303000
*                                                              @Y17XAXF 17310000
*        DSECT FOR PIU PREFIX                                  @Y17XAXF 17317000
*                                                              @Y17XAXF 17324000
PRF2FLG2 DS    XL1 .                    FLAG BYTE              @Y17XAXF 17331000
PRF2TNTI EQU   X'80' .                   TNT OFFSETS EXIST     @Y17XAXF 17338000
*                                           IN PIU             @Y17XAXF 17345000
PRF2FORM EQU   X'40' .                   2ND WORD IN PREFIX    @Y17XAXF 17346000
*                                           CONTAINS A POINTER @Y17XAXF 17347000
*                                           TO A SEQ NO AREA   @Y17XAXF 17348000
PRF2SMI  EQU   X'20' .                   START MI INDICATOR(TSO ONLY)   17352000
*                                                              @Y17XAXF 17353000
PRF2TERM EQU   X'10' .                   FORCED TERMINATE IN   @YM08991 17353310
*                                         PROGRESS             @YM08991 17353610
*        EQU   X'08'-X'01' .             RESERVED              @YM08991 17354010
         DS    CL3 .                    RESERVED               @Y17XAXF 17355000
PRF2WD2  DS    0A                       2ND WORD(FORMAT DEFINED@Y17XAXF 17359000
*                                        BY PRF2FORM FIELD     @Y17XAXF 17361000
PRF2SEQP DS    A .                      PTR TO SEQ NO AREA     @Y17XAXF 17363000
PRF2LEN  EQU   *-IEDPF2 .               LEN OF PIU PREFIX      @Y17XAXF 17366000
         SPACE 2                                               @Y17XAXF 17400000
*       *************************************************************   17420000
*   0   *     KEY      *                    QCBA                    *   17700020
*       *************************************************************   18000020
*   4   *     PRI      *                    LINK                    *   18300020
*       *************************************************************   18600020
*   8   *                            TIC                            *   18900020
*       *************************************************************   19200020
*  12   *  NBUNT/BTUA  *                     LCB                    *   19500022
*       *************************************************************   19800020
*  16   *            SRCE             *            SIZE             *   20100020
*       *************************************************************   20400020
*  20   *    STAT1     *                XTRA/CORE                   *   20700020
*       *************************************************************   21000020
*  24   *            SCAN             *         NTXT/TQBCK          *   21300020
*       *************************************************************   21600020
*  28   *  NTXT/TQBCK  *                   CRCD                     *   21900020
*       *************************************************************   22200020
*  32   *                NHDR/CHDR                   *  STXT/HQBCK  *   22500020
*       *************************************************************   22800020
*  36   *         STXT/HQBCK          *            ISEQ             *   23100020
*       *************************************************************   23400020
*  40   *            DEST             *                                 23700020
*       *******************************                                 24000020
*                                                                       24300020
         MEND  , */                                                     24600022
*%BSLPRF  :  ;                                                          25300022
*DECLARE                                                                26000022
*  1 IEDQPRF  BDY(DWORD) BASED(IEDQPPTR),                               26700022
*/*      UPDATED  6/7/74                                      Y30X8XE*/ 27400008
*   2 PRFRCB      CHAR(8) BDY(DWORD),   /* RESOURCE CONTROL BLOCK    */ 28100022
*    3 PRFKEY       CHAR(1),            /* ELEMENT KEY OF BUFFER     */ 28800022
*     4 PRFOPCDE    CHAR(1),            /* CCW OPERATION CODE        */ 29500022
*    3 PRFQCBA     PTR(24)  BDY(BYTE),  /* QCB ADDRESS               */ 30200022
*     4 PRFIOADR    PTR(24)  BDY(BYTE), /* NEXT DATA BYTE(ADDRESS)      30900022
*                                       TO BE TRANSFERRED(READ)      */ 31600022
*    3 PRFPRI      CHAR(1),             /* PRIORITY OF BUFFER        */ 32300022
*     4 PRFFLAGS    CHAR(1),            /* CCW FLAGS                 */ 33000022
*    3 PRFLINK     PTR(24)  BDY(BYTE),  /* LINK FIELD OF BUFFER      */ 33700022
*     4 *           CHAR(1),            /* UNUSED WHEN CCW           */ 34400022
*     4 PRFCOUNT    FIXED(15) BDY(BYTE), /* CCW (READ/WRITE) COUNT   */ 35100022
*   2 PRFTIC      CHAR(4),              /* TIC CCW AND NEXT UNIT ADDR   35800008
*                                                              X03039*/ 36100008
*    3 PRFTICC     CHAR(1),             /* TIC CCW           @Y17XAXF*/ 36500000
*     4 PRFEOMSG BIT(1),                /* TEMPORARY END OF             37200022
*                                       MESSAGE                S21101*/ 37900022
*     4 PRFBFMM  BIT(1),                /* HEADER CONVERTED TO          38600022
*                                       TEXT                   S21101*/ 39300022
*     4 *        BIT(1),                /* RESERVED                  */ 40000022
*     4 *        BIT(1),                /* RESERVED                  */ 40700022
*     4 PRFTICON BIT(1),                /* TIC COMMAND CODE    X03039*/ 41400008
*     4 *        BIT(1),                /* RESERVED                  */ 42100022
*     4 *        BIT(1),                /* RESERVED                  */ 42800022
*     4 *        BIT(1),                /* RESERVED                  */ 43500022
*    3 PRFTI0      PTR(24),             /* TIC ADDRESS               */ 44200022
*   2 PRFNBUNT    PTR(8),               /* NUMBER OF UNITS IN THIS      44900022
*                                       BUFFER                       */ 45600022
*    3 PRFSUNIT    CHAR(1),             /* START OF LOGICAL UNIT     */ 46300022
*     4 PRFPLQCB    PTR(8),             /* PRIORITY INDEX     SA51078*/ 47000000
*      5 PRFPIUO     PTR(8),            /* OFFSET TO PIU     @Y17XAXF*/ 47300000
*   2 PRFLCB      PTR(24)  BDY(BYTE),   /* POINTER TO LCB            */ 48400022
*   2 *           CHAR(4),              /* START OF SRCE AND SIZE    */ 49100000
*    3 PRFSVFFO    PTR(24) BDY(BYTE),   /* FEFO PTR TO MARK SVCD        49300008
*                                                             SA51078*/ 49500000
*                                       /* SRCE INDEX TO TERMNAME TBL*/ 49700000
*     4 PRFSRCE     FIXED(15) BDY(HWORD),                               49900000
*                                       /* SIZE OF DATA IN THIS BFR  */ 50100000
*     4 PRFSIZE     FIXED(15) BDY(HWORD),                               50300000
*    3 PRFSVFLG    PTR(8),              /* SAVED DATA FLAGS   SA51783*/ 50500000
*   2 PRFSTAT1    CHAR(1),              /* STATUS BYTE               */ 51200022
*    3 PRFCNCLN BIT(1),                 /* CANCEL MESSAGE EXECUTED   */ 51900022
*    3 PRFERMGN BIT(1),                 /* ERROR MESSAGE IN THIS BFR */ 52600022
*    3 PRFITCPN BIT(1),                 /* MESSAGE BEING HELD        */ 53300022
*    3 PRFTSMSG BIT(1),                 /* THIS IS A TSO MSG   S05331*/ 54000022
*    3 PRFDUPLN BIT(1),                 /* DUPLICATE HEADER BUFFER   */ 54700022
*    3 PRFEOFN  BIT(1),                 /* SETEOF WAS EXECUTED       */ 55400022
*     4 PRFLOCK  BIT(1),                /* MESSAGE EXECUTED BY LOCK  */ 56100022
*    3 PRFNLSTN BIT(1),                 /* NOT LAST BUFFER           */ 56800022
*    3 PRFNHDRN BIT(1),                 /* NOT HEADER BUFFER         */ 57500022
*   2 PRFCORE     PTR(24)  BDY(BYTE),   /* POINTER TO CURRENT RCD -     58200022
*                                       COREQ                        */ 58900022
*    3 PRFXTRA     PTR(24)  BDY(BYTE),  /* POINTER TO ADDL RCDS -       59600022
*                                       CURR                         */ 60300022
*     4 PRFSTSO     CHAR(1),            /* START OF TIME SHARING        61000022
*                                       DATA                      TSO*/ 61700022
*     4 PRFEOB CHAR(2),                 /* EOB OFFSET SAVE AREA         62400022
*                                                              S22025*/ 63100022
*   2 PRFSCAN     FIXED(15),            /* SCAN POINTER              */ 63800022
*    3 *           CHAR(1),             /*  RESERVED         @Y17XAXF*/ 64000000
*    3 PRFISIZE    CHAR(1),             /*  NUMBER OF RESERVE@Y17XAXF*/ 64200000
*   2 PRFTQBCK    PTR(24)  BDY(BYTE),   /* BACK CHAIN - TEXT            64500022
*                                       SEGMENTS                     */ 65200022
*    3 PRFNTXT     PTR(24)  BDY(BYTE),  /* POINTER TO NEXT TEXT SEG  */ 65900022
*     4 PRFEOBOF    PTR(8),             /* OFFSET INTO RECORD SA51078*/ 66000000
*      5 PRFSVPRI    PTR(8),            /* PQCB INDEX TO MARK SVCD      66100000
*                                                             SA51078*/ 66200000
*     4 PRFSVSEQ    CHAR(2),            /* SEQ NO FOR MARK SVCD         66300000
*                                                             SA51078*/ 66400000
*   2 PRFCRCD     PTR(24)  BDY(BYTE),   /* POINTER TO CURRENT           66600022
*                                       SEGMENT                      */ 67300022
*   2 PRFCHDR     PTR(24)  BDY(BYTE),   /* POINTER TO HDR OF CURR       68000022
*                                       MSG                          */ 68700022
*    3 PRFNHDR     PTR(24)  BDY(BYTE),  /* POINTER TO NEXT HDR SEG   */ 69400022
*   2 PRFHQBCK    PTR(24)  BDY(BYTE),   /* BACK CHAIN - HDR SEGMENTS */ 70100022
*    3 PRFSTXT     CHAR(1),             /* START OF TEXT LABEL       */ 70800022
*   2 PRFISEQ     FIXED(15),            /* INPUT SEQUENCE NUMBER     */ 71500022
*   2 PRFDEST     FIXED(15);            /* DEST INDEX TO TERMNAME       72200022
*                                       TABLE                        */ 72900022
*DECLARE                                /*                   @Y17XAXF*/ 72910000
*  1 IEDPF1 BASED(ADDR(IEDQPRF)-LENGTH(IEDPF1)),          /* @Y17XAXF*/ 72920000
*/*                                                          @Y17XAXF*/ 72930000
*/*      DSECT FOR BUFFER PREFIX                             @Y17XAXF*/ 72940000
*/*                                                          @Y17XAXF*/ 72950000
*    2 PRF1RH   CHAR(3),                /* RH                @Y17XAXF*/ 72960000
*    2 PRF1FLG1 BIT(8),                 /* FLAG BYTE         @Y17XAXF*/ 72967000
*      3 PRF1FIDI BIT(1),               /*  FID1 INDICATOR   @Y17XAXF*/ 72974000
*      3 PRF1EXPI BIT(1),               /*  EXPED/NORMAL IND @Y17XAXF*/ 72981000
*      3 PRF1FORM BIT(2),               /*  DESC 2ND WORD    @Y17XAXF*/ 72988000
*      3 PRF1USS  BIT(1),               /*  CONV FROM USS    @Y17XAXF*/ 72995000
*                                       /*  TO FSS           @Y17XAXF*/ 73002000
*      3 PRF1LOGD BIT(1),               /*  BUFFER CONTAINS LOGON  DATA 73010000
*                                                            @Y17XAXF*/ 73013000
*      3 *        BIT(2),               /*  RESERVED         @Y17XAXF*/ 73016000
*    2 PRF1WD2  PTR(31),                /* 2ND WORD FORM'T A @Y17XAXF*/ 73020000
*                                       /*  IND IN PRFFORM   @Y17XAXF*/ 73030000
*      4 PRF1SEQP PTR(31),              /* POINTER TO AREA   @Y17XAXF*/ 73040000
*                                       /*  INTO WHICH THE   @Y17XAXF*/ 73046000
*                                       /*  ASSIGNED NUMBER  @Y17XAXF*/ 73049000
*                                       /*  IS STORED(FID1)  @Y17XAXF*/ 73060000
*        5 PRF1SQID FIXED(16),          /* FOR FID1 - SEQ    @Y17XAXF*/ 73065000
*                                       /*     FID0 - IND    @Y17XAXF*/ 73080000
*          6 PRF1TAG1 BIT(8),           /*  FIRST TAG BYTE   @Y17XAXF*/ 73081000
*/*          CAN USE TTHTAGS VALUES FOR PRF1TAGS             @Y17XAXF*/ 73082000
*            7 PRF1TAGS BIT(4),         /*   TAG ROUT + TYPE @Y17XAXF*/ 73083000
*            7 *        BIT(4),         /*   RESERVED.       @Y17XAXF*/ 73084000
*/*        TTHTAG2 TP OP CODE VALUES TO BE USED FOR PRF1TAG2 @Y17XAXF*/ 73085000
*          6 PRF1TAG2 BIT(8),           /*  SECOND TAG BYTE             73086000
*                                           (WHEN USED AS A TP OP       73087000
*                                           PRF1TAG1 MUST BE 0          73088000
*                                                            @Y17XAXF*/ 73089000
*        5 PRF1RULN FIXED(16);          /* FOR FID1 ONLY     @Y17XAXF*/ 73090000
*                                       /*  LEN OF RUDATA ON @Y17XAXF*/ 73100000
*                                       /*  0 LEN ERROR BUFS @Y17XAXF*/ 73110000
* %PRF1LEN='LENGTH(IEDPF1)';            /* LEN OF BUFFER PRF @Y17XAXF*/ 73120000
*/* PRF1FORM VALUES                                          @Y17XAXF*/ 73130000
* DCL PRF1PTRI BIT(2) CONSTANT('01'B);  /* PRF1SEQP IS PRES  @YM07397*/ 73140000
* DCL PRF1IDI  BIT(2) CONSTANT('10'B);  /* PRF1SQID IS PRES  @Y17XAXF*/ 73150000
* DCL PRF1SQLI BIT(2) CONSTANT('11'B);  /* PRF1SQID,PRF1RULN @Y17XAXF*/ 73160000
*                                       /*  ARE PRESENT      @Y17XAXF*/ 73170000
* DECLARE                               /*                   @Y17XAXF*/ 73180000
*   1 IEDPF2   BASED(ADDR(IEDQPRF)-LENGTH(IEDPF2)),       /* @Y17XAXF*/ 73190000
*/*                                                          @Y17XAXF*/ 73192000
*/*      DSECT FOR PIU BUFFER                                @Y17XAXF*/ 73194000
*/*                                                          @Y17XAXF*/ 73196000
*     2  PRF2FLG2  BIT(8),              /* FLAGS             @Y17XAXF*/ 73200000
*        3 PRF2TNTI  BIT(1),            /*  TTCIN OFFSETS    @Y17XAXF*/ 73205000
*                                       /*   EXIST IN PIU    @Y17XAXF*/ 73210000
*        3 PRF2FORM  BIT(1),            /*  2ND WORD IN THIS @Y17XAXF*/ 73215000
*                                       /*   PREFIX CONTAINS @Y17XAXF*/ 73220000
*                                       /*   A PTR TO A SEQ  @Y17XAXF*/ 73225000
*                                       /*   NUMBER AREA     @Y17XAXF*/ 73230000
*        3 PRF2SMI   BIT(1),            /*  START MI INDICATOR(TSO ONLY 73235000
*                                                            @Y17XAXF*/ 73236000
*        3 PRF2TERM  BIT(1),            /*  FORCED TERMINATE @YM08991*/ 73236310
*                                       /*   IN PROGRESS     @YM08991*/ 73236610
*        3 *         BIT(4),            /*  RESERVED         @YM08991*/ 73237010
*     2  *         CHAR(3),             /* RESERVED          @Y17XAXF*/ 73240000
*     2  PRF2WD2   PTR(31),             /* 2ND WORK-FORMAT   @Y17XAXF*/ 73241000
*                                       /*  DEFINED BY       @Y17XAXF*/ 73242000
*                                       /*  PRF2FORM FIELD   @Y17XAXF*/ 73243000
*       3 PRF2SEQP   PTR(31);           /* PTR TO SEQUENCE   @Y17XAXF*/ 73244000
*                                       /*  NUMBER AREA      @Y17XAXF*/ 73245000
* %PRF2LEN='LENGTH(IEDPF2)';            /* LEN OF PIU PREFIX @Y17XAXF*/ 73250000
*DECLARE PRFSHDR CHAR(1) DEF(IEDQPRF)                                   73600000
*  POS(LENGTH(IEDQPRF)+1);                                /* @Y17XAXF*/ 74300000
*                                       /* START OF HEADER LABEL     */ 75000022
*/*                                                          @Y17XAXF*/ 75010000
*/*      PREFIX CONSTANTS                                    @Y17XAXF*/ 75020000
*/*                                                          @Y17XAXF*/ 75030000
*DECLARE PRFINTIC BIT(32) CONSTANT('08000002'X);          /* @Y17XAXF*/ 75040000
*                                       /* INVALID TIC ADDR  @Y17XAXF*/ 75050000
*DECLARE PRFESCAP BIT(8) CONSTANT('FC'X);  /* OPERATOR CONTROL ESCAPE   75100008
*                                       BUFFER (IN PRFSTAT1)   X03039*/ 75200008
*/*                                                                  */ 75700022
*/*                                                                  */ 76400022
*/*     ************************************************************ */ 77100022
*/*  0  *     KEY      *                    QCBA                   * */ 77800022
*/*     ************************************************************ */ 78500022
*/*  4  *     PRI      *                    LINK                   * */ 79200022
*/*     ************************************************************ */ 79900022
*/*  8  *                            TIC                           * */ 80600022
*/*     ************************************************************ */ 81300022
*/* 12  *  NBUNT/BTUA  *                     LCB                   * */ 82000022
*/*     ************************************************************ */ 82700022
*/* 16  *            SRCE             *            SIZE            * */ 83400022
*/*     ************************************************************ */ 84100022
*/* 20  *    STAT1     *                XTRA/CORE                  * */ 84800022
*/*     ************************************************************ */ 85500022
*/* 24  *            SCAN             *         NTXT/TQBCK         * */ 86200022
*/*     ************************************************************ */ 86900022
*/* 28  *  NTXT/TQBCK  *                   CRCD                    * */ 87600022
*/*     ************************************************************ */ 88300022
*/* 32  *                NHDR/CHDR                   *  STXT/HQBCK * */ 89000022
*/*     ************************************************************ */ 89700022
*/* 36  *         STXT/HQBCK          *            ISEQ            * */ 90400022
*/*     ************************************************************ */ 91100022
*/* 40  *            DEST             *                              */ 91800022
*/*     *******************************                              */ 92500022
*/*                                                                  */ 93200022
./  ADD  SSI=80890608,NAME=TPRIOR
*        %GOTO PLSPRI;     /*                                           00100000
         MACRO                                                          00200000
         TPRIOR                                                         00300000
.*A000000-999999                                               @X31X8X0 00400000
.* C281000,286000,290000,294000,309000,686000,693000,699000,   @Y17XAXF 00410000
.* C704000,723000                                              @Y17XAXF 00420000
.* D094000,282000-284000,287000-288000,291000-292000,295000-   @Y17XAXF 00430000
.* D296000,310000,454000,687000-690000,694000-696000,700000-   @Y17XAXF 00440000
.* D701000,705000-707000,724000-725000                         @Y17XAXF 00450000
         SPACE                                                          00500000
.*A825000-826000                                                 S22025 00600000
.*A696500-699000                                                 S22026 00700000
.*C884700                                                        S22026 00800000
.*C412000                                                       SA50190 00900000
.*C020000,892600                                               @Z30X8XE 01000000
.*C864000,982300-982600                                        @OS76497 01100000
*                                                                       01200000
*        TPRIOR DSECT UPDATED  6/7/74                          @Z30X8XE 01300000
.* TPRIOR DSECT CONVERTED TO BILINGUAL BY LEVEL 5 - 9/18/72      S22024 01400000
.*A887040-887160,990200-995200                                   Y05330 01500000
.*C601600-603000                                             @OX21052   01500182
*                                                                       01600000
*                       ERB                                             01700000
*                                                                       01800000
PRIINTRQ EQU   X'E4' .                  TO REQUEST FULL BUFFERS         01900000
*                                         FROM DISK I/O                 02000000
*                                       TO REQUEST EMPTY BUFFERS        02100000
*                                         FROM BUFFER REQUEST QCB       02200000
*                                       USED BY SEND SCHEDULER          02300000
*                                       USED BY RECEIVE SCHEDULER       02400000
*                                       USED BY GET SCHEDULER           02500000
*                                       USED BY PUT SCHEDULER           02600000
*                                                                       02700000
PRIFSPCI EQU   X'E8' .                  TO REQUEST EMPTY BUFFERS        02800000
*                                         FROM BUFFER REQUEST QCB       02900000
*                                       TO REQUEST FULL BUFFERS         03000000
*                                         FROM DISK I/O                 03100000
*                                       USED BY PCI APPENDAGE           03200000
*                                         (FIRST TIME)                  03300000
*                                                                       03320000
PRITOTCL EQU   X'E8' .                  POST OF CLEANUP ELEM TO TOTE TO 03340000
*                                       INITIATE TEST CLEANUP  @Y17XAXF 03360000
*                                                                       03400000
PRISBPCI EQU   X'E0' .                  SAME AS ABOVE, EXCEPT ALL       03500000
*                                         BUT FIRST TIME                03600000
*                                                                       03700000
PRIDSKRQ EQU   X'EC' .                  TO REQUEST AN EMPTY UNIT BY     03800000
*                                         CHAINING THE ERB ON THE       03900000
*                                         BUFFER RETURN QCB             04000000
*                                       USED BY CPB CLEANUP             04100000
*                                                                       04200000
PRISBT   EQU   X'EC' .                  PRIORITY FOR ELEMENT POSTED     04230000
*                                       TO IEDQSBT             @YM07020 04260000
PRIACTIV EQU   X'E4' .                  IN POSTING ERB TO ACTIVATE      04300000
*                                         QCB TO REQUEST BUILDING       04400000
*                                         OF AN INITIAL CONTACT PGM     04500000
*                                         AND EXCP FOR LINE             04600000
*                                       USED BY CPB CLEANUP             04700000
*                                       USED BY BUFFER REQUEST          04800000
*                                       USED BY BUFFER RETURN           04900000
*                                                                       05000000
PRIDKEOB EQU   X'E0' .                  TO ENABLE EOB TO RECALL         05100000
*                                       TO POST TO EOBCHECK AFTER       05200000
*                                         EOB ERROR                     05300000
*                                       USED BY CPB CLEANUP             05400000
*                                       USED BY CPB INITIALIZATION      05500000
*                                       MUST BE LOWER PRIORITY THAN     05600000
*                                         PRIMHBFR                      05700000
*                                                                       05800000
PRIRECAL EQU   X'E0' .                  TO REQUEST FROM DISK I/O A      05900000
*                                         COPY OF HEADER                06000000
*                                       USED BY ALL ROUTINES            06100000
*                                         REQUESTING RECALLED           06200000
*                                         HEADERS                       06300000
*                                                                       06400000
PRIRCQCB EQU   X'E0' .                  TO RETURN THE ERB TO ANY        06500000
*                                         ROUTINE SPECIFIED IN          06600000
*                                         LCBRCQCB                      06700000
*                                       USED BY MH TO RETURN TO         06800000
*                                         BUFFER DISPOSITION            06900000
*                                       USED BY CPB CLEANUP AFTER       07000000
*                                         RECALL                        07100000
*                                                                       07200000
PRIAPERB EQU   X'D0' .                  TO REQUEST FULL BUFFERS         07300000
*                                         USED BY APPLICATION PROG      07400000
*                                                                       07500000
*                       BUFFER                                          07600000
*                                                                       07700000
PRIEDISP EQU   X'E0' .                  TO POST ERB TO ITSELF ON SEND   07800000
*                                         OPERATIONS WHEN AN ERROR      07900000
*                                         OCCURS BEFORE EOM             08000000
*                                       USED BY DISPOSITION             08100000
*                                         MUST BE LOWER THAN PRIMHBFR   08200000
*                                                                       08300000
PRIMHBFR EQU   X'E4' .                  TO HAVE A BUFFER PROCESSED      08400000
*                                         BY MH                         08500000
*                                       USED BY PCI APPENDAGE           08600000
*                                       USED BY CPB CLEANUP             08700000
*                                       USED BY LINE END APPENDAGE      08800000
*                                         AFTER POSITIVE RESPONSE       08900000
*                                         TO ADDRESSING                 09000000
*                                                                       09100000
PRIERBFR EQU   X'E3'                    TO HAVE AN ERROR BUFFER  X03039 09200000
*                                         PROCESSED BY MH        X03039 09300000
*                                                                X03039 09500000
PRIUREQ  EQU   X'E8' .                  TO REQUEST AN EMPTY             09600000
*                                         UNIT FOR INSERT               09700000
*                                         FUNCTION IN MH                09800000
*                                       USED BY UNIT REQUEST            09900000
*                                       MUST BE HIGHER THAN PRIMHBFR    10000000
*                                                                       10100000
PRIAPBFR EQU   X'DC' .                  TO POST A BUFFER TO AN          10200000
*                                         APPLICATION PROGRAM           10300000
*                                       USED BY MBH                     10400000
*                                                                       10500000
PRILNEND EQU   X'E4' .                  TO HAVE DISPOSITION FINISH      10600000
*                                         PROCESSING MACROS AND         10700000
*                                         CLEANUP THE LINE              10800000
*                                       USED BY LINE END APPENDAGE      10900000
*                                         (SEND-LAST BUFFER ONLY)       11000000
*                                                                       11100000
PRIRCBFR EQU   X'E0' .                  TO RETURN A DUPLICATE HEADER    11200000
*                                         TO A SPECIFIED ROUTINE        11300000
*                                       USED BY CPB CLEANUP             11400000
*                                       USED BY DESTINATION SCHEDULER   11500000
*                                                                       11600000
PRIBFRTB EQU   X'E0' .                  TO RETURN A BUFFER OR UNIT      11700000
*                                                               SA50190 11800000
*                                         TO AVAILABLE BUFFER POOL      11900000
*                                       USED BY PCI APPENDAGE           12000000
*                                       USED BY CPB CLEANUP             12100000
*                                       USED BY CPB INITIALIZATION      12200000
*                                       USED BY DESTINATION SCHEDULER   12300000
*                                       USED BY MH                      12400000
*                                                                       12500000
PRIDSKBF EQU   X'EC' .                  TO GIVE A UNIT TO CPB CLEANUP   12600000
*                                       USED BY BUFFER RETURN           12700000
*                                                                       12800000
PRICOPY  EQU   X'E0' .                  TO HAVE A MESSAGE COPIED TO     12900000
*                                         A DIFFERENT DATA SET          13000000
*                                       USED BY DESTINATION SCHEDULER   13100000
*                                                                       13200000
PRIDESTQ EQU   X'E4' .                  TO PUT A BUFFER ON A MESSAGE    13300000
*                                         QUEUE                         13400000
*                                       USED BY MH                      13500000
*                                       USED BY DESTINATION SCHEDULER   13600000
*                                                                       13700000
PRIDKWRT EQU   X'E4' .                  TO HAVE A FULL BUFFER WRITTEN   13800000
*                                         ON DISK                       13900000
*                                       USED BY DESTINATION SCHEDULER   14000000
*                                                                       14100000
PRIDKSRV EQU   X'EC' .                  TO HAVE A MESSAGE FLAGGED       14200000
*                                         SERVICED                      14300000
*                                       USED BY BUFFER CLEANUP          14400000
*                                                                       14500000
PRIDKCNC EQU   X'E0' .                  TO HAVE A MESSAGE CANCELED      14600000
*                                         IN THE MESSAGE QUEUE          14700000
*                                       USED BY CANCEL MESSAGE          14800000
*                                                                       14900000
PRIDKINT EQU   X'E0' .                  TO HAVE A MESSAGE INTERCEPTED   15000000
*                                       USED BY INTERCEPT               15100000
*                                                                       15200000
PRICKPLN EQU   X'EC' .                  TO POST THE LCB TO CHECKPOINT   15300000
*                                         REQUESTING A CHECKPOINT       15400000
*                                       USED BY BUFFER DISPOSITION      15500000
*                                                                       15600000
PRIMULTR EQU   X'E0' .                  TO POST THE LCB TO THE          15700000
*                                         MULTIPLE ROUTE ROUTINE        15800000
*                                         TO CONTINUE                   15900000
*                                       USED BY BUFFER DISPOSITION      16000000
*                                       USED BY TLIST SUBTASK           16100000
*                                                                       16200000
PRIOPCTL EQU   X'DC' .                  TO POST AN OPERATOR CONTROL     16300000
*                                         BUFFER                        16400000
*                                       USED BY MH                      16500000
*                                       USED TO POST FROM OPCTL@Y17XAXF 16530000
*                                        TO NSL                @Y17XAXF 16560000
*                                                                       16600000
PRIDSPLB EQU   X'DF' .                  TO POST LAST BUFFER OF          16700000
*                                         MESSAGE TO DISPOSITION        16800000
*                                       USED BY MH                      16900000
*                                       USED BY OPNDST/CLSDST    X03039 17000000
*                                       MUST BE LOWER THAN ANY PCI      17100000
*                                         POST OF AN ERB                17200000
*                                                                       17300000
PRIONLT  EQU   X'DC' .                  TO REQUEST ON LINE TEST         17400000
*                                       USED BY MH                      17500000
*                                                                       17600000
PRIPIUCP  EQU  X'00' .                  PACKED RU TO IEDPMD USED FOR    17700000
*                                       IDENTIFICATION PURPOSES ONLY -  17704000
*                                       WILL NEVER BE POSTED            17708000
*                                                              @Y17XAXF 17712000
PRILUSR   EQU  X'DA' .                  DEACTIVATE TO LUS TO TERMINATE  17716000
*                                       A SESSION              @Y17XAXF 17720000
PRIAIPL   EQU  X'DE' .                  TO INDICATE TO IPL/DUMP@Y17XAXF 17724000
*                                       THAT AN LCB HAS BEEN   @Y17XAXF 17800000
*                                       POSTED TO REQUEST IPL  @Y17XAXF 17900000
*                                       AND OR ACTIVATE        @Y17XAXF 18000000
*                                                              @Y17XAXF 18100000
PRIFIDIN EQU  X'E4' .                   FID POST PRIORITY FROM @Y17XAXF 18200000
*                                       PATH CONTROL INBOUND   @Y17XAXF 18300000
*                                                              @Y17XAXF 18400000
PRISCPIN EQU  PRIFIDIN+1 .              SSCP INPUT-MUST BE     @Y17XAXF 18500000
*                                       HIGHER THAN FID POST   @Y17XAXF 18600000
*                                       PRIORITY               @Y17XAXF 18700000
*                                                              @Y17XAXF 18800000
PRIFLDH  EQU  PRIMHBFR                  BTU PRIORITY TO FLDH   @Y17XAXF 18900000
*                                       QCB                    @Y17XAXF 19000000
*                                                              @Y17XAXF 19100000
PRICHKPT EQU   X'EC' .                  PRIORITY USED BY       @Y17XAXF 19200000
*                                         CHECKPOINT TO POST   @Y17XAXF 19300000
*                                         AVTCCELE             @Y17XAXF 19400000
*                                                              @Y17XAXF 19500000
PRIHIFLG EQU   X'E9' .                  HIGHEST PRIORITY THAT  @Y17XAXF 19600000
*                                         HAS ASSOCIATED FLAG  @Y17XAXF 19700000
*                                         BYTE                 @Y17XAXF 19800000
*                                                              @Y17XAXF 19900000
PRIPLCB  EQU   X'E8' .                  PLCB/LC/ POST TO VE,   @Y17XAXF 20000000
*                                         Z1,V1                @Y17XAXF 20100000
*                                                              @Y17XAXF 20200000
PRIFRCDC EQU   X'C4' .                  FORCE DEACTIVATE REQUEST OPCE   20300000
*                                        IN 3705 CLEANUP       @Y17XAXF 20305000
*                                                              @Y17XAXF 20310000
PRISSBUF EQU   X'E2' .                  PRIORITY THAT BUFFERS  @PI03742 20315000
*                                         TPOSTED TO SSCP      @Y17XAXF 20400000
*                                                              @Y17XAXF 20500000
PRISIBRQ EQU   X'E5' .                  GET AND FREE SIB       @Y17XAXF 20600000
*                                         REQUEST ELEMENTS     @Y17XAXF 20700000
*                                                              @Y17XAXF 20800000
PRISSPIU EQU   X'E5' .                  PRIORITY THAT PIU'S    @Y17XAXF 20900000
*                                         ARE TPOSTED TO SSCP  @Y17XAXF 21000000
*                                                              @Y17XAXF 21100000
PRIMH01  EQU   X'E4' .                  PRIORITY POST FROM MH  @Y17XAXF 21200000
*                                         TO 01                @Y17XAXF 21300000
*                                                              @Y17XAXF 21400000
PRILNSCL EQU   PRIDESTQ-1 .             USED BY IEDUNBND TO POST PLCB   21500000
*                                       TO IEDSCLU TO CONTINUE CLEAR    21520000
*                                       UNBIND PROCESSING      @Y17XAXF 21540000
*                                                                       21560000
PRIRESPB EQU   X'EA'                    RESPONSE BUFFER TO 02  @OX21052 21580082
*                                                              @OX21052 21620082
PRIOLD1  EQU   X'E0' .                  OLD PRIORITY POST TO VA@Y17XAXF 21700000
*                                                              @Y17XAXF 21800000
PRIMEDFG EQU   X'DF' .                  MEDIUM PRIOITY THAT    @Y17XAXF 21900000
*                                         ASSOCIATED FLAG BYTE @Y17XAXF 22000000
*                                                              @Y17XAXF 22100000
PRITOTE0 EQU   X'DC' .                  OLD PRIOITY POST FROM  @Y17XAXF 22200000
*                                         TOTE TO 00           @Y17XAXF 22300000
*                                                              @Y17XAXF 22400000
PRIPCOUT EQU   X'E4' .                  TO POST TO PATH CONTROL@Y17XAXF 22500000
*                                         OUTBOUND             @Y17XAXF 22600000
*                                                              @Y17XAXF 22700000
PRIASYNC EQU   X'E6' .                  TO POST AN ASYNCHROUS  @Y17XAXF 22800000
*                                         REQUEST BUFFER TO    @Y17XAXF 22900000
*                                         IEDNKA               @Y17XAXF 23000000
*                                       PRE-SNA - FOR RESET    @Y17XAXF 23100000
*                                         ERROR LOCK           @Y17XAXF 23200000
*                                       SNA - FOR NEGATIVE     @Y17XAXF 23300000
*                                         RESPONSE TO RTR      @Y17XAXF 23400000
*                                                              @Y17XAXF 23500000
PRIOUTQ  EQU   X'E0' .                  TO TPOST PIUS TO THE   @Y17XAXF 23600000
*                                         3705 OUTPUT CORE     @Y17XAXF 23700000
*                                         QUEUE                @Y17XAXF 23800000
*                                                              @Y17XAXF 23900000
PRIOUTBD EQU   X'E4' .                  NORMAL POST TO         @Y17XAXF 23920000
*                                         OUTBOUND PROCESSING  @Y17XAXF 23940000
*                                                              @Y17XAXF 23960000
PRILUSQB EQU   X'E2' .                  TPOST A QCB TO LUS TO  @Y17XAXF 24000000
*                                         REQUEST AN LU-LU     @Y17XAXF 24020000
*                                         SESSION              @Y17XAXF 24040000
*                                                              @Y17XAXF 24060000
PRILOFLG EQU   X'D0' .                  PRIORITY POST OF A/D   @Y17XAXF 24080000
*                                         REDRIVE ELEMENT      @Y17XAXF 24082000
*                                                              @Y17XAXF 24084000
PRIPRIME EQU   X'DD' .                  POST TO NSL FOR        @Y17XAXF 24086000
*                                         PRIMING              @Y17XAXF 24088000
*                                                              @Y17XAXF 24090000
PRICULCB EQU   X'C0'                    CLEANUP SYN AND ROUTING .       24090100
*                                                              @Y17XAXF 24090300
PRICUREQ EQU   X'C4'                    CLEANUP REQUEST        @Y17XAXF 24090500
*                                         ELEMENT              @Y17XAXF 24090700
*                                                              @Y17XAXF 24091300
PRILAEND EQU   X'E4' .                  TO START ERROR PROCESSING       24092000
*                                       USED BY LINE END APPENDAGE      24100000
*                                                                       24200000
PRIMHUNT EQU   X'E8' .                  TO POST A UNIT TO MH            24300000
*                                       USED BY IEDQBW                  24400000
*                                       MUST BE GREATER THAN PRIMHBFR   24500000
*                                                                       24600000
PRIRELSE EQU   X'E0' .                  TO RELEASE SUBTASK FROM         24700000
*                                         TIME DELAY OR OP. CONTROL     24800000
*                                       USED BY HOLD                    24900000
*                                       USED BY OPERATOR CONTROL        25000000
*                                                                       25100000
PRIFEFO  EQU   X'EE' .                  TO UPDATE DISK FEFO POINTER     25200000
*                                       CHECKED BY IEDQFA               25300000
*                                       SET BY IGG019RP, REUS/COPY      25400000
*                                                                       25500000
*                                                                       25600000
*                       OTHER                                           25700000
*                                                                       25800000
PRIRLCB  EQU   X'EB' .                  USED BY IEDQBD TO        S22026 25900000
*                                         RETURN LCB             S22026 26000000
*                                                                S22026 26100000
PRILCB   EQU   X'E7' .                  TO POST LCB FOR CLEANUP  S22026 26200000
*                                         USED BY LINEEND        S22026 26300000
*                                                                S22026 26400000
PRICPBCL EQU   X'E8' .                  TO POST CPB CLEANUP COMPLETE    26500000
*                                       USED BY DISK END APPENDAGE      26600000
*                                                                       26700000
PRICKPT  EQU   X'EC' .                  TO REQUEST COMPLETE CHECKPOINT  26800000
*                                       USED BY REUS                    26900000
*                                       USED BY MCPCLOSE                27000000
*                                       USED BY TIME DELAY              27100000
*                                                                       27200000
PRILNFRE EQU   X'E0' .                  TO FREE A LINE                  27300000
*                                       USED BY DISPOSITION             27400000
*                                       USED BY SEND SCHEDULER          27500000
*                                       USED BY PUT SCHEDULER(UNLOCK)   27600000
*                                       MUST GET TO DESTINATION         27700000
*                                         SCHEDULER BEFORE LINE         27800000
*                                         IS FREE                       27900000
*                                                                       28000000
PRILCBRQ EQU   PRIINTRQ                 UNUSED                 @Y17XAXF 28100000
*                                                                X03039 28500000
PRIOPDST EQU   PRILCBRQ                 UNUSED                 @Y17XAXF 28600000
*                                                                X03039 28900000
PRIOPCMP EQU   X'E5'                    UNUSED                 @Y17XAXF 29000000
*                                                                       29300000
PRICLDST EQU   PRILCBRQ                 UNUSED                 @Y17XAXF 29400000
*                                                                X03039 29700000
PRIRESUM EQU   X'E5'                    TO POST RESPONSE BUFFER@Y17XAXF 29800000
*                                         FROM DEBLOCK BACK TO @Y17XAXF 29900000
*                                         NIR GENERATOR MODULES@Y17XAXF 30000000
*                                         TO REQUEST RESUMPTION@Y17XAXF 30100000
*                                         OF AN OPERATION BEGUN@Y17XAXF 30200000
*                                         BY NIR GENERATOR     @Y17XAXF 30300000
*                                         MODULES                       30400000
*                                                                X03039 30500000
PRISTOPD EQU   X'E8' .                  USED TO RETURN AN        X03039 30600000
*                                       ELEMENT TO NSL           X03039 30700000
*                                                                       30800000
PRIATTNH EQU   X'E6' .                  UNUSED                 @Y17XAXF 30900000
*                                                                       31100000
PRICLSDN EQU   X'10' .                  TO REQUEST CLOSEDOWN            31200000
*                                       USED BY -----                   31300000
*                                       MUST BE LOWEST PRIORITY         31400000
*                                                                       31500000
PRIAPCKP EQU   X'EC' .                  TO REQUEST INCIDENT CHECKPOINT  31600000
*                                       USED BY APPLICATION PROGRAM     31700000
*                                                                       31800000
PRIOPCKP EQU   X'EC' .                  TO REQUEST INCIDENT CHECKPOINT  31900000
*                                       USED BY OPERATOR CONTROL        32000000
*                                                                       32100000
PRILNCL  EQU   X'EC' .                  TO CLEAN UP BUFFERS AND TO      32200000
*                                         FREE LINE                     32300000
*                                       USED BY LINE END                32400000
*                                       TO POST LINE TO DISPOSITION     32500000
*                                       USED BY IN END                  32600000
*                                       USED BY OUT END                 32700000
*                                                                       32800000
PRILCBAT EQU   X'E9' .                  TO POST LCB TO STOPLINE  S22025 32900000
*                                       SUBTASK USED BY LINE END S22025 33000000
*                                                                       33100000
PRILOGLB EQU   X'E0' .                  TO POST THE LOG LCB TO ITSELF   33200000
*                                       USED BY LOG SCHEDULER           33300000
*                                                                       33400000
PRISSOLT EQU   X'DC' .                  POSTED TO OPERATOR CONTROL      33500000
*                                       TO REQUEST START LINE/STOPLINE  33600000
*                                       USED BY ON LINE TEST            33700000
*                                                                       33800000
PRITRACE EQU   X'F0' .                  DSPTRACE PRIORITY IGCM610D      33900000
*                                        POSTS UNIT TO ALTER IGG019RO   33910000
*                                        TO START OR STOP TRACE(S)      33920000
*                                        AFTER MODIFY TCAM, SUBT=       33930000
*                                        COMAND                @Y17XAXF 33940000
*                                                                       33950000
PRITIME  EQU   X'F0' .                  TO RETURN ELE FROM TIME Q       33960000
*                                       USED BY TIME DELAY              34000000
*                                                                       34100000
PRIREUSX EQU   X'EE' .                  TO ACTIVATE REUSABILITY@OS76497 34200000
*                                       ASSEM IN PLACE BY IGG019RP      34300000
*                                                                       34400000
PRIATTN  EQU   X'DC' .                  POST ATTENTION ELEMENT          34500000
*                                         USED BY ATTENTION HANDLER     34600000
*                                                                       34620000
PRIATN05 EQU PRIATTN+1                  3705 ATTENTION ELEMENT PRIORITY 34640000
*                                                              @YM08074 34660000
*                                                                       34700000
PRISYSDL EQU   X'DC' .                  TO INITIATE SYSTEM DELAY        34800000
*                                         USED BY OPERATOR CONTROL      34900000
*                                         CHECKED BY SYS DELAY          35000000
*                                                                       35100000
PRISYSDT EQU   X'D8' .                  POST SYSTEM DELAY QCB TO TIME   35200000
*                                         DELAY                         35300000
*                                         USED BY SYSTEM DELAY          35400000
*                                                                       35500000
PRILCBDL EQU   X'20' .                  TO INDICATE AN LCB ON           35600000
*                                         SYSTEM DELAY QUEUE            35700000
*                                         SET BY SYSTEM DELAY, IEDQHI   35800000
*                                         CHECKED BY CHECKPOINT         35900000
*                                                                       35920000
PRIPOSTS EQU   X'FE'                    POST TO  SYNC QUEUE    @Y17XAXA 35940000
*                                                                       35960000
PRIPOSTA EQU   X'FF'                    POST TO ASYNC QUEUE    @Y17XAXA 35980000
         SPACE 2                                                        36000000
         MEND  ,  */                                                    36100000
*  %PLSPRI:  ;                                                          36200000
*/*      TPRIOR DSECT UPDATED  6/7/74                         Y30X8XE*/ 36300000
*/*                                                                  */ 36400000
*/*                          ERB                                     */ 36500000
*DCL PRIINTRQ BIT(8) CONSTANT('E4'X);   /* TO REQUEST FULL BUFFERS   */ 36700000
*                                       /* FROM DISK I/O             */ 36800000
*                                       /* TO REQUEST EMPTY BUFFERS  */ 36900000
*                                       /* FROM BUFFER REQUEST QCB   */ 37000000
*                                       /* USED BY SEND SCHEDULER    */ 37100000
*                                       /* USED BY RECEIVE SCHEDULER */ 37200000
*                                       /* USED BY GET SCHEDULER     */ 37300000
*                                       /* USED BY PUT SCHEDULER     */ 37400000
*/*                                                                  */ 37500000
*DCL PRIFSPCI BIT(8) CONSTANT('E8'X);   /* TO REQUEST EMPTY BUFFERS  */ 37700000
*                                       /* FROM BUFFER REQUEST QCB   */ 37800000
*                                       /* TO REQUEST FULL BUFFERS   */ 37900000
*                                       /* FROM DISK I/O             */ 38000000
*                                       /* USED BY PCI APPENDAGE     */ 38100000
*                                       /* FOR FIRST REQUEST         */ 38200000
*/*                                                                  */ 38220000
*DCL PRITOTCL BIT(8) CONSTANT('E8'X);   /* POST OF CLEANUP ELEM TO   */ 38240000
*                                       /* TOTE (TEST C-UP) @Y17XAXF */ 38260000
*/*                                                                  */ 38300000
*DCL PRISBPCI BIT(8) CONSTANT('E0'X);   /* SAME AS ABOVE EXCEPT ALL  */ 38500000
*                                       /* BUT FIRST TIME            */ 38600000
*/*                                                                  */ 38700000
*DCL PRIDSKRQ BIT(8) CONSTANT('EC'X);   /* TO REQUEST AN EMPTY UNIT  */ 38900000
*                                       /* BY CHAINING THE ERB ON THE*/ 39000000
*                                       /* BUFFER RETURN QCB         */ 39100000
*                                       /* USED BY CPB CLEANUP       */ 39200000
*/*                                                                  */ 39300000
*DCL PRISBT   BIT(8) CONSTANT('EC'X);   /* PRIORITY FOR ELEMENT POST */ 39350000
*                                       /* TO IEDQSBT        @YM07020*/ 39400000
*/*                                                                  */ 39450000
*DCL PRIACTIV BIT(8) CONSTANT('E4'X);   /* IN POSTING ERB TO ACTIVATE*/ 39500000
*                                       /* QCB TO REQUEST BUILDING   */ 39600000
*                                       /* OF AN INITIAL CONTACT PGM */ 39700000
*                                       /* AND EXCP FOR LINE         */ 39800000
*                                       /* USED BY CPB CLEANUP       */ 39900000
*                                       /* USED BY BUFFER REQUEST    */ 40000000
*                                       /* USED BY BUFFER RETURN     */ 40100000
*/*                                                                  */ 40200000
*DCL PRIDKEOB BIT(8) CONSTANT('E0'X);   /* TO ENABLE EOB TO RECALL   */ 40400000
*                                       /* TO POST TO EOB CHECK AFTER*/ 40500000
*                                       /* EOB ERROR                 */ 40600000
*                                       /* USED BY CPB CLEANUP       */ 40700000
*                                       /* USED BY CPB INITIALIZATION*/ 40800000
*                                       /* MUST BE LOWER PRIORITY    */ 40900000
*                                       /* THAN PRIMHBFR             */ 41000000
*/*                                                                  */ 41100000
*DCL PRIRECAL BIT(8) CONSTANT('E0'X);   /* TO REQUEST FROM DISK I/O  */ 41300000
*                                       /* A COPY OF HEADER USED BY  */ 41400000
*                                       /* ALL ROUTINES REQUESTING   */ 41500000
*                                       /* RECALLED HEADERS          */ 41600000
*/*                                                                  */ 41700000
*DCL PRIRCQCB BIT(8) CONSTANT('E0'X);   /* TO RETURN THE ERB TO ANY  */ 41900000
*                                       /* ROUTINE SPECIFIED IN      */ 42000000
*                                       /* LCBRCQCB                  */ 42100000
*                                       /* USED BY MH TO RETURN TO   */ 42200000
*                                       /* BUFFER DISPOSITION        */ 42300000
*                                       /* USED BY CPB CLEANUP AFTER */ 42400000
*                                       /* RECALL                    */ 42500000
*/*                                                                  */ 42600000
*DCL PRIAPERB BIT(8) CONSTANT('D0'X);   /* TO REQUEST FULL BUFFERS   */ 42800000
*                                       /* USED BY APPLICATION PROG  */ 42900000
*/*                                                                  */ 43000000
*/*                          BUFFER                                  */ 43100000
*DCL PRIEDISP BIT(8) CONSTANT('E0'X);   /* TO POST ERB TO ITSELF ON  */ 43300000
*                                       /* SEND OPERATIONS WHEN AN   */ 43400000
*                                       /* ERROR OCCURS BEFORE EOM   */ 43500000
*                                       /* USED BY DISPOSITION       */ 43600000
*                                       /* MUST BE LOWER THAN        */ 43700000
*                                       /* PRIMHBFR                  */ 43800000
*/*                                                                  */ 43900000
*DCL PRIMHBFR BIT(8) CONSTANT('E4'X);   /* TO HAVE A BUFFER PROCESSED*/ 44100000
*                                       /* BY MH                     */ 44200000
*                                       /* USED BY PCI APPENDAGE     */ 44300000
*                                       /* USED BY CPB CLEANUP       */ 44400000
*                                       /* USED BY LINE END APPENDAGE*/ 44500000
*                                       /* AFTER POSITIVE RESPONSE TO*/ 44600000
*                                       /* ADDRESSING                */ 44700000
*                                       /* USED BY DEBLOCK AFTER     */ 44800000
*                                       /* DATA RECEIVED             */ 44900000
*/*                                                                  */ 45000000
*DCL PRIERBFR BIT(8) CONSTANT('E3'X);   /* TO HAVE AN ERROR BFRX03039*/ 45200000
*                                       /* PROCESSED BY MH     X03039*/ 45300000
*/*                                                            X03039*/ 45500000
*DCL PRIUREQ BIT(8) CONSTANT('E8'X);    /* TO REQUEST AN EMPTY UNIT  */ 45700000
*                                       /* FOR INSERT FUNCTION IN MH */ 45800000
*                                       /* USED BY UNIT REQUEST      */ 45900000
*                                       /* MUST BE HIGHER THAN       */ 46000000
*                                       /* PRIMHBFR                  */ 46100000
*/*                                                                  */ 46200000
*DCL PRIAPBFR BIT(8) CONSTANT('DC'X);   /* TO POST A BUFFER TO AN    */ 46400000
*                                       /* APPLICATION PROGRAM       */ 46500000
*                                       /* USED BY MBH               */ 46600000
*/*                                                                  */ 46700000
*DCL PRILNEND BIT(8) CONSTANT('E4'X);   /* TO HAVE DISPOSITION       */ 46900000
*                                       /* FINISH PROCESSING MACROS  */ 47000000
*                                       /* AND CLEANUP THE LINE      */ 47100000
*                                       /* USED BY LINE END          */ 47200000
*                                       /* APPENDAGE                 */ 47300000
*                                       /* LAST BUFFER ONLY          */ 47400000
*/*                                                                  */ 47500000
*DCL PRIRCBFR BIT(8) CONSTANT('E0'X);   /* TO RETURN DUPLICATE       */ 47700000
*                                       /* HEADER TO A SPECIFIED     */ 47800000
*                                       /* ROUTINE                   */ 47900000
*                                       /* USED BY CPB CLEANUP       */ 48000000
*                                       /* USED BY DESTINATION       */ 48100000
*                                       /* SCHEDULER                 */ 48200000
*/*                                                                  */ 48300000
*DCL PRIBFRTB BIT(8) CONSTANT('E0'X);   /* TO RETURN A BUFFER OR A   */ 48500000
*                                       /* UNIT TO BUFFER POOL       */ 48600000
*                                       /* USED BY PCI APPENDAGE     */ 48700000
*                                       /* USED BY CPB CLEANUP       */ 48800000
*                                       /* USED BY CPB INITIALIZATION*/ 48900000
*                                       /* USED BY DESTINATION SCH   */ 49000000
*                                       /* USED BY MH                */ 49100000
*/*                                                                  */ 49200000
*DCL PRIDSKBF BIT(8) CONSTANT('EC'X);   /* TO GIVE A UNIT TO CPB     */ 49250000
*                                       /* CLEANUP                   */ 49500000
*                                       /* USED BY BUFFER RETURN     */ 49600000
*/*                                                                  */ 49700000
*DCL PRICOPY BIT(8) CONSTANT('E0'X);    /* TO HAVE A MESSAGE COPIED  */ 49900000
*                                       /* TO A DIFFERENT DATA SET   */ 50000000
*                                       /* USED BY DESTINATION SCH   */ 50100000
*DCL PRIDESTQ BIT(8) CONSTANT('E4'X);   /* TO PUT A BUFFER ON A      */ 50120000
*                                       /* MESSAGE QUEUE             */ 50140000
*                                       /* USED BY MH                */ 50160000
*                                       /* USED BY DESTINATION SCHED */ 50180000
*/*                                                                  */ 50800000
*DCL PRIDKWRT BIT(8) CONSTANT('E4'X);   /* TO HAVE A FULL BUFFER     */ 51000000
*                                       /* WRITTEN ON DISK           */ 51100000
*                                       /* USED BY DESTINATION SCH   */ 51200000
*/*                                                                  */ 51300000
*DCL PRIDKSRV BIT(8) CONSTANT('EC'X);   /* TO HAVE A MESSAGE FLAGGED */ 51500000
*                                       /* SERVICED                  */ 51600000
*                                       /* USED BY BUFFER CLEANUP    */ 51700000
*/*                                                                  */ 51800000
*DCL PRIDKCNC BIT(8) CONSTANT('E0'X);   /* TO HAVE A MESSAGE CANCELED*/ 52000000
*                                       /* IN THE MESSAGE QUEUE      */ 52100000
*                                       /* USED BY CANCEL MESSAGE    */ 52200000
*/*                                                                  */ 52300000
*DCL PRIDKINT BIT(8) CONSTANT('E0'X);   /* TO HAVE A MESSAGE INTER-  */ 52500000
*                                       /* CEPTED-USED BY INTERCEPT  */ 52600000
*/*                                                                  */ 52700000
*DCL PRICKPLN BIT(8) CONSTANT('EC'X);   /* TO POST THE LCB TO        */ 52900000
*                                       /* CHECKPOINT REQUESTING A   */ 53000000
*                                       /* CHECKPOINT                */ 53100000
*                                       /* USED BY BUFFER DISPOSITION*/ 53200000
*/*                                                                  */ 53300000
*DCL PRIMULTR BIT(8) CONSTANT('E0'X);   /* TO POST THE LCB TO THE    */ 53500000
*                                       /* MULTIPLE ROUTE ROUTINE    */ 53600000
*                                       /* TO CONTINUE               */ 53700000
*                                       /* USED BY BUFFER DISPOSITION*/ 53800000
*                                       /* USED BY TLIST SUBTASK     */ 53900000
*/*                                                                  */ 54000000
*DCL PRIOPCTL BIT(8) CONSTANT('DC'X);   /* TO POST AN OPERATOR       */ 54200000
*                                       /* CONTROL BUFFER            */ 54300000
*                                       /* USED BY MH                */ 54400000
*                                       /* USED TO POST FROM @Y17XAXF*/ 54430000
*                                       /*  OPCTL TO NSL     @Y17XAXF*/ 54460000
*/*                                                                  */ 54500000
*DCL PRIDSPLB BIT(8) CONSTANT('DF'X);   /* TO POST LAST BUFFER OF    */ 54600000
*                                       /* MESSAGE TO DISPOSITION    */ 54800000
*                                       /* USED BY MH                */ 54900000
*                                       /* USED BY OPN/CLSDST  X03039*/ 55000000
*                                       /* MUST BE LOWER THAN ANY PCI*/ 55100000
*                                       /* POST OF AN ERB            */ 55200000
*/*                                                                  */ 55300000
*DCL PRIPIUCP BIT(8) CONSTANT('00'X);   /* PACKED RU TO IEDPMD USED FOR 55500000
*                                          IDENT PUTPOSES ONLY - WILL   55502000
*                                          NEVER BE POSTED   @Y17XAXF*/ 55504000
*DCL PRILUSR BIT(8) CONSTANT('DA'X);    /* DEACTIVATE TO LUS REQUEST    55506000
*                                          FOR TERMINATION OF SESSION   55508000
*                                                            @Y17XAXF*/ 55510000
*DCL PRIONLT BIT(8) CONSTANT('DC'X);    /* TO REQUEST ON LINE TEST   */ 55512000
*                                       /* USED BY MH                */ 55600000
*/*                                                                  */ 55700000
* DCL PRIAIPL  BIT(8) CONSTANT('DE'X);  /* TO INDICAT TO IPL @Y17XAXF*/ 55800000
*                                       /* /DUMP THAT AN LCB @Y17XAXF*/ 55900000
*                                       /* HAS BEEN POSTED TO@Y17XAXF*/ 56000000
*                                       /* REQUEST IPL AND/OR@Y17XAXF*/ 56100000
*                                       /* ACTIVATE          @Y17XAXF*/ 56200000
*                                                                       56300000
* DCL PRIFIDIN BIT(8) CONSTANT('E4'X);  /* FID POST PRIORITY @Y17XAXF*/ 56400000
*                                       /* FROM PATH CONTROL @Y17XAXF*/ 56500000
*                                       /* INBOUND           @Y17XAXF*/ 56600000
*                                                                       56700000
* DCL PRISCPIN BIT(8) CONSTANT('E5'X);  /* SSCP INPUT-MUST BE@Y17XAXF*/ 56800000
*                                       /* HIGHER THAN FID   @Y17XAXF*/ 56900000
*                                       /* POST PRIORITY     @Y17XAXF*/ 57000000
*                                                                       57100000
* DCL PRIFLDH  BIT(8) CONSTANT('E4'X);  /* BTU PRIORITY TO   @Y17XAXF*/ 57200000
*                                       /* FLDH QCB          @Y17XAXF*/ 57300000
*                                                                       57400000
* DCL PRICHKPT BIT(8) CONSTANT('EC'X);  /* PRIORITY USED BY  @Y17XAXF*/ 57500000
*                                       /*  CKECKPOINT TO    @Y17XAXF*/ 57600000
*                                       /*  POST AVTCCELE    @Y17XAXF*/ 57700000
*                                       /*                   @Y17XAXF*/ 57800000
* DCL PRIHIFLG BIT(8) CONSTANT('E9'X);  /* HIGHEST PRIORITY  @Y17XAXF*/ 57900000
*                                       /*  THAT HAS         @Y17XAXF*/ 58000000
*                                       /*  ASSOCIATED FLAG  @Y17XAXF*/ 58100000
*                                       /*  BYTE             @Y17XAXF*/ 58200000
*                                       /*                   @Y17XAXF*/ 58300000
* DCL PRIPLCB  BIT(8) CONSTANT('E8'X);  /* PLCB/LCB POST TO  @Y17XAXF*/ 58400000
*                                       /*  VE,Z1,V1         @Y17XAXF*/ 58500000
*                                       /*                   @Y17XAXF*/ 58600000
* DCL PRIFRCDC BIT(8) CONSTANT('C4'X);  /* FORCE DEACTIVATE REQUEST     58700000
*                                           OPCE IN 3705 CLEANUP        58705000
*                                                            @Y17XAXF*/ 58710000
* DCL PRISSBUF BIT(8) CONSTANT('E2'X);  /* PRIORITY THAT     @PI03742*/ 58715000
*                                       /*  BUFFERS ARE      @Y17XAXF*/ 58800000
*                                       /*  TPOSTED TO SSCP  @Y17XAXF*/ 58900000
*                                       /*                   @Y17XAXF*/ 59000000
* DCL PRISIBRQ BIT(8) CONSTANT('E5'X);  /* GET AND FREE SIB  @Y17XAXF*/ 59100000
*                                       /*  REQUEST ELEMENTS @Y17XAXF*/ 59200000
*                                       /*                   @Y17XAXF*/ 59300000
* DCL PRISSPIU BIT(8) CONSTANT('E5'X);  /* PRIORITY THAT     @Y17XAXF*/ 59400000
*                                       /*  PIU'S ARE TPOSTED@Y17XAXF*/ 59500000
*                                       /*  TO SSCP          @Y17XAXF*/ 59600000
*                                       /*                   @Y17XAXF*/ 59700000
* DCL PRIMH01  BIT(8) CONSTANT('E4'X);  /* PRIORITY POST FROM@Y17XAXF*/ 59800000
*                                       /*  MH TO 01         @Y17XAXF*/ 59900000
*                                       /*                   @Y17XAXF*/ 60000000
* DCL PRILNSCL BIT(8) CONSTANT('E3'X);  /* USED BY IEDUNBND TO POST     60100000
*                                          PLCB TO IEDSCLU TO CONTINUE  60110000
*                                          CLEAR UNBIND PROCESSING -    60120000
*                                          MUST BE LOWER THAN PRIDESTQ  60130000
*                                                            @Y17XAXF*/ 60140000
*                                                                       60150000
* DCL PRIRESPB BIT(8) CONSTANT('EA'X);  /* RESPONSE BUFFER   @OX21052*/ 60160082
*                                       /*  TO 02            @OX21052*/ 60210082
*                                       /*                   @OX21052*/ 60260082
* DCL PRIOLD1  BIT(8) CONSTANT('E0'X);  /* OLD PRIORITY POST @Y17XAXF*/ 60400000
*                                       /*  TO VA            @Y17XAXF*/ 60500000
*                                       /*                   @Y17XAXF*/ 60600000
* DCL PRIMEDFG BIT(8) CONSTANT('DF'X);  /* MEDIUM PRIORITY   @Y17XAXF*/ 60700000
*                                       /*  THAT HAS         @Y17XAXF*/ 60800000
*                                       /*  ASSOCIATED FLAG  @Y17XAXF*/ 60900000
*                                       /*  BYTE             @Y17XAXF*/ 61000000
*                                       /*                   @Y17XAXF*/ 61100000
* DCL PRITOTE0 BIT(8) CONSTANT('DC'X);  /* OLD PRIORITY POST @Y17XAXF*/ 61200000
*                                       /*  FROM TOTE TO 00  @Y17XAXF*/ 61300000
*                                       /*                   @Y17XAXF*/ 61400000
* DCL PRIPCOUT BIT(8) CONSTANT('E4'X);  /* POST TO PATH CTL  @Y17XAXF*/ 61500000
*                                       /*  OUTBOUND         @Y17XAXF*/ 61600000
*                                       /*                   @Y17XAXF*/ 61700000
* DCL PRIASYNC BIT(8) CONSTANT('E6'X);  /* TO POST AN ASYNCH @Y17XAXF*/ 61800000
*                                       /*  REQUEST BUFFER   @Y17XAXF*/ 61900000
*                                       /*  TO IEDNKA        @Y17XAXF*/ 62000000
*                                       /* PRE-SNA - FOR     @Y17XAXF*/ 62100000
*                                       /*  RESET ERROR LOCK @Y17XAXF*/ 62200000
*                                       /* SNA - FOR NEGATVE @Y17XAXF*/ 62300000
*                                       /*  RESPONSE TO RTR  @Y17XAXF*/ 62400000
*                                       /*                   @Y17XAXF*/ 62500000
* DCL PRIOUTQ  BIT(8) CONSTANT('E0'X);  /* TO TPOST PIUS TO  @Y17XAXF*/ 62600000
*                                       /*  THE 3705 OUTPUT  @Y17XAXF*/ 62700000
*                                       /*  QUEUE            @Y17XAXF*/ 62800000
*                                       /*                   @Y17XAXF*/ 62900000
* DCL PRIOUTBD BIT(8) CONSTANT('E4'X);  /* NORMAL POST TO    @Y17XAXF*/ 62920000
*                                       /*  OUTBOUND PRO-    @Y17XAXF*/ 62940000
*                                       /*  CESSING          @Y17XAXF*/ 62960000
*                                       /*                   @Y17XAXF*/ 62980000
* DCL PRILUSQB BIT(8) CONSTANT('E2'X);  /* TPOST A QCB TO    @Y17XAXF*/ 62984000
*                                       /*  LUS TO REQUEST   @Y17XAXF*/ 62988000
*                                       /*  AN LU-LU SESSION @Y17XAXF*/ 62992000
*                                       /*                   @Y17XAXF*/ 62996000
*DCL PRILOFLG BIT(8) CONSTANT('D0'X);   /* PRIORITY POST OF  @Y17XAXF*/ 63100000
*                                       /*  A/D REDRIVE      @Y17XAXF*/ 63110000
*                                       /*  ELEMENT          @Y17XAXF*/ 63120000
*                                       /*                   @Y17XAXF*/ 63130000
*DCL PRICULCB BIT(8) CONSTANT('C0'X);   /* CLEANUP SYNC AND ROUTING     63130100
*                                                            @Y17XAXF*/ 63131100
*DCL PRICUREQ BIT(8) CONSTANT('C4'X);   /* CLEANUP REQUEST   @Y17XAXF*/ 63132100
*                                       /*  ELEMENT          @Y17XAXF*/ 63133100
*                                       /*                   @Y17XAXF*/ 63134100
*DCL PRIPRIME BIT(8) CONSTANT('DD'X);   /* POST TO NSL FOR   @Y17XAXF*/ 63140000
*                                       /*  PRIMING          @Y17XAXF*/ 63150000
*                                       /*                   @Y17XAXF*/ 63160000
*DCL PRILAEND BIT(8) CONSTANT('E4'X);   /* TO START ERROR PROCESSING */ 63170000
*                                       /* USED BY LINE END APPENDAGE*/ 63200000
*/*                                                                  */ 63300000
*DCL PRIMHUNT BIT(8) CONSTANT('E8'X);   /* TO POST A UNIT TO MH      */ 63500000
*                                       /* USED BY IEDQBW            */ 63600000
*                                       /* MUST BE GREATER THAN      */ 63700000
*                                       /* PRIMHBFR                  */ 63800000
*/*                                                                  */ 63900000
*DCL PRIRELSE BIT(8) CONSTANT('E0'X);   /* TO RELEASE SUBTASK FROM   */ 64000000
*                                       /* TIME DELAY OR OP. CONTROL */ 64200000
*                                       /* USED BY HOLD              */ 64300000
*                                       /* USED BY OPERATOR CONTROL  */ 64400000
*/*                                                                  */ 64500000
*DCL PRIFEFO BIT(8) CONSTANT('EE'X);    /* TO UPDATE DISK FEFO       */ 64700000
*                                       /* POINTER                   */ 64800000
*                                       /* CHECKED BY IEDQFA         */ 64900000
*                                       /* SET BY IGG019RP,REUS/COPY */ 65000000
*/*                                                                  */ 65100000
*/*                                                                  */ 65200000
*/*                      OTHER                                       */ 65300000
*/*                                                                  */ 65400000
*DCL PRIRLCB BIT(8) CONSTANT('EB'X);    /* USED BY IEDQBD TO   S22026*/ 65450000
*                                       /* RETURN LCB          S22026*/ 65700000
*/*                                                                  */ 65730000
*DCL PRILCB BIT(8) CONSTANT('E7'X);     /* TO POST LCB FOR CLEANUP   */ 65760000
*                                       /* USED BY LINEEND     S22026*/ 66100000
*/*                                                                  */ 66200000
*DCL PRICPBCL BIT(8) CONSTANT('E8'X);   /* TO POST CPB CLEANUP       */ 66400000
*                                       /* COMPLETE                  */ 66500000
*                                       /* USED BY DISK END APPENAGE */ 66600000
*/*                                                                  */ 66700000
*DCL PRICKPT BIT(8) CONSTANT('EC'X);    /* TO REQUEST COMPLETE       */ 66900000
*                                       /* CHECKPOINT                */ 67000000
*                                       /* USED BY REUS              */ 67100000
*                                       /* USED BY MCPCLOSE          */ 67200000
*                                       /* USED BY TIME DELAY        */ 67300000
*/*                                                                  */ 67400000
*DCL PRILNFRE BIT(8) CONSTANT('E0'X);   /* TO FREE A LINE            */ 67600000
*                                       /* USED BY DISPOSITION       */ 67700000
*                                       /* USED BY SEND SCHEDULER    */ 67800000
*                                       /* USED BY PUT SCHEDULER     */ 67900000
*                                       /*         (UNLOCK)          */ 68000000
*                                       /* MUST GET TO DESTINATION   */ 68100000
*                                       /* SCHEDULER BEFORE LINE     */ 68200000
*                                       /* IS FREE                   */ 68300000
*/*                                                                  */ 68400000
*DCL PRILCBRQ BIT(8) CONSTANT('E4'X);   /* UNUSED            @Y17XAXF*/ 68600000
*/*                                                            X03039*/ 69100000
*DCL PRIOPDST BIT(8) CONSTANT('E4'X);   /* UNUSED            @Y17XAXF*/ 69300000
*/*                                                            X03039*/ 69700000
*DCL PRIOPCMP BIT(8) CONSTANT('E5'X);   /* UNUSED            @Y17XAXF*/ 69900000
*                                       /*                     X03039*/ 70200000
*DCL PRICLDST BIT(8) CONSTANT('E4'X);   /* UNUSED            @Y17XAXF*/ 70400000
*/*                                                            X03039*/ 70800000
*DCL PRIRESUM BIT(8) CONSTANT('E5'X);   /* TO POST RESPONSE  @Y17XAXF*/ 70900000
*                                       /*  FROM DEBLOCK     @Y17XAXF*/ 71000000
*                                       /*  BACK TO NIR GEN  @Y17XAXF*/ 71100000
*                                       /*  MODULES TO REQ   @Y17XAXF*/ 71200000
*                                       /*  RESUMPTION OF AN @Y17XAXF*/ 71300000
*                                       /*  OPERATION BEGUN  @Y17XAXF*/ 71400000
*                                       /*  BY NIR GENERATOR @Y17XAXF*/ 71500000
*                                       /*  MODULES          @Y17XAXF*/ 71600000
*/*                                                            X03039*/ 71700000
*DCL PRISTOPD BIT(8) CONSTANT('E8'X);   /* USED TO RETURN AN   X03039*/ 71900000
*                                       /* ELEMENT TO NSL      X03039*/ 72000000
*/*                                                            X03039*/ 72100000
*DCL PRIATTNH BIT(8) CONSTANT('E6'X);   /* UNUSED            @Y17XAXF*/ 72300000
*/*                                                            X03039*/ 72600000
*DCL PRICLSDN BIT(8) CONSTANT('10'X);   /* TO REQUEST CLOSEDOWN      */ 72800000
*                                       /* USED BY -----             */ 72900000
*                                       /* MUST BE LOWEST PRIORITY   */ 73000000
*/*                                                                  */ 73100000
*DCL PRIAPCKP BIT(8) CONSTANT('EC'X);   /* TO REQUEST INCIDENT       */ 73300000
*                                       /* CHECKPOINT                */ 73400000
*                                       /* USED BY APPLICATION       */ 73500000
*                                       /* PROGRAM                   */ 73600000
*/*                                                                  */ 73700000
*DCL PRIOPCKP BIT(8) CONSTANT('EC'X);   /* TO REQUEST INCIDENT       */ 73900000
*                                       /* CHECKPOINT                */ 74000000
*                                       /* USED BY OPERATOR CONTROL  */ 74100000
*/*                                                                  */ 74200000
*DCL PRILNCL BIT(8) CONSTANT('EC'X);    /* TO CLEAN UP BUFFERS AND TO*/ 74400000
*                                       /* FREE LINE                 */ 74500000
*                                       /* USED BY LINE END TO POST  */ 74600000
*                                       /* LINE TO DISPOSITION       */ 74700000
*                                       /* USED BY IN END            */ 74800000
*                                       /* USED BY OUT END           */ 74900000
*/*                                                                  */ 75000000
*DCL PRILCBAT BIT(8) CONSTANT('E9'X);   /* TO POST LCB TO STOPLINE   */ 75050000
*                                       /* USED BY LINENED     S22025*/ 75300000
*/*                                                                  */ 75400000
*DCL PRILOGLB BIT(8) CONSTANT('E0'X);   /* TO POST THE LOG LCB TO    */ 75600000
*                                       /* ITSELF                    */ 75700000
*                                       /* USED BY LOG SCHEDULER     */ 75800000
*/*                                                                  */ 75900000
*DCL PRISSOLT BIT(8) CONSTANT('DC'X);   /* POSTED TO OPERATOR CONTROL*/ 76100000
*                                       /* TO REQUEST START LINE /   */ 76200000
*                                       /* STOPLINE                  */ 76300000
*                                       /* USED BY ON LINE TEST      */ 76400000
*/*                                                                  */ 76500000
*DCL PRITRACE BIT(8) CONSTANT('F0'X);   /* DSPTRACE PRIORITY IGCM610D   76700000
*                                           POSTS UNIT TO ALTER         76710000
*                                           IGG019RO TO START OR STOP   76720000
*                                           TRACE(S) AFTER MODIFY       76730000
*                                           TCAM, SUBT= COMMAND         76740000
*                                                            @Y17XAXF*/ 76750000
*DCL PRITIME BIT(8) CONSTANT('F0'X);    /* TO RETURN ELE FROM TIME Q */ 76760000
*                                       /* USED BY TIME DELAY        */ 76800000
*/*                                                                  */ 76900000
*DCL PRIREUSX BIT(8) CONSTANT('EE'X);   /* TO ACTIVATE REUS  @OS76497*/ 77100000
*                                       /* ASSEM IN PLACE BY IGG019RP*/ 77200000
*/*                                                                  */ 77300000
*DCL PRIATTN BIT(8) CONSTANT('DC'X);    /* POST ATTENTION ELEMENT    */ 77500000
*                                       /* USED BY ATTENTION HANDLER */ 77600000
*/*                                                                  */ 77700000
*DCL PRIATN05 BIT(8) CONSTANT('DD'X);   /* 3705 ATTENTION ELEMENT       77750000
*                                          PRIORITY          @YM08074*/ 77800000
*/*                                                                  */ 77850000
*DCL PRISYSDL BIT(8) CONSTANT('DC'X);   /* TO INITIATE SYSTEM DELAY  */ 77900000
*                                       /* USED BY OPERATOR CONTROL  */ 78000000
*                                       /* CHECKED BY SYS DELAY      */ 78100000
*/*                                                                  */ 78200000
*DCL PRISYSDT BIT(8) CONSTANT('D8'X);   /* POST SYSTEM DELAY QCB     */ 78400000
*                                       /* TO TIME DELAY             */ 78500000
*                                       /* USED BY SYSTEM DELAY      */ 78600000
*/*                                                                  */ 78700000
*DCL PRILCBDL BIT(8) CONSTANT('20'X);   /* TO INDICATE AN LCB ON     */ 78900000
*                                       /* SYSTEM DELAY QUEUE        */ 79000000
*                                       /* SET BY SYSTEM DELAY,IEDQHI*/ 79100000
*                                       /* CHECKED BY CHECKPOINT     */ 79200000
*/*                                                                  */ 79300000
*DCL PRIPOSTS BIT(8) CONSTANT('FE'X);   /* POST  SYNC QUEUE          */ 82300000
*/*                                                                  */ 85300000
*DCL PRIPOSTA BIT(8) CONSTANT('FF'X);   /* POST ASYNC QUEUE          */ 88300000
*/*                                                                  */ 91300000
./  ADD  SSI=62600013,NAME=TPROCD
*        %GOTO PROCPLS;                 /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TPROCD                                                         09000010
.*A000000-999999                                            @Y17XAXF    12000010
IEDPROC  DSECT                                                          15000010
*                                                                       18000010
*        DSECT FOR TPROCESS DEVICE DEPENDENT INFO                       21000010
*                                                                       24000010
PROLEN   DS    CL1 .               LEN OF TPROCESS DEV DEPENDENT INFO   27000010
PROFLAG  DS    CL1 .               TPROCESS FLAGS                       30000010
PROSECQ  EQU   X'80' .                  QUEUE IS SECURE                 33000010
PROLU    EQU   X'40' .                  LU=YES ON INPUT TPROCESS ENTRY  36000010
PRODATE  EQU   X'20' .                  DATE=YES SPECIFIED ON TPROCESS  37000010
*                                        MACRO                          38000010
*        EQU   X'10'-X'01' .            RESERVED                        39000010
PROILEN  EQU   *-IEDPROC .         LENGTH OF TPROCESS DEV DEP FIELD     42000010
         MEND                                                           45000010
*        */                                                             48000010
*%PROCPLS:;                                                             51000010
*DECLARE                                                                54000010
*  1 IEDPROC  BASED BDY(BYTE),                                          57000010
*/*                                                                  */ 60000010
*/*      DSECT FOR TPROCESS DEVICE DEPENDENT INFO                    */ 63000010
*/*                                                                  */ 66000010
*    2 PROLEN   CHAR(1),                /* LEN OF TPROCESS DEV DEP   */ 69000010
*    2 PROFLAG  CHAR(1),                /* TPROCESS DEV DEP          */ 72000010
*      3 PROSECQ BIT(1),                /*   QUEUE IS SECURE         */ 75000010
*      3 PROLU   BIT(1),                /*   LU=YES ON INPUT TPROCESS*/ 78000010
*      3 PRODATE BIT(1),                /*   DATE=YES ON TPROCESS MACRO 79000010
*                                                                    */ 80000010
*      3 *       BIT(5);                /*   RESERVED                */ 81000010
* %PROILEN='LENGTH(IEDPROC)';           /*LENGTH OF TPROCESS INFO    */ 84000010
./  ADD  SSI=62600014,NAME=TPRUD
*        %GOTO PRUPLS;                  /* BILINGUAL HEADER             00800010
         MACRO                                                          01600010
         TPRUD                                                          02400010
         SPACE                                                          03200010
.*CHANGE ACTIVITY AS FOLLOWS:                                           04000010
.*A000000-999999                                               @Y17XAXU 04800010
.*A560000,966000,560000,408000,576000                          @Y17XAXF 05200010
         SPACE                                                          05600010
IEDPRUND DSECT                                                          06400010
*                                                                       07200010
*        PACKED RU DSECT                                                08000010
*                                                                       08800010
PRURHTH  DS    0XL4 .                   TH AND RH FIELDS                09600010
PRURH    DS    0XL3 .                   RH FIELD                        09700010
PRURHFG0 DS    XL1 .                    RH FLAG 0                       09800010
PRURHTYP EQU   X'80' .                    ON-RSP, OFF-REQ               10400010
* PRURUCAT     2 BITS                    RU CATEGORY                    11200010
PRURHFMD EQU   X'00' .                    FM DATA                       12000010
PRURHNC  EQU   X'20' .                    NETWORK CONTROL               12800010
PRURHDFC EQU   X'40' .                    DATA FLOW CONTROL             13600010
PRURHSC  EQU   X'60' .                    SESSION CONTROL               14400010
*        EQU   X'10' .                   RESERVED                       15200010
PRURHFI  EQU   X'08' .                   FORMAT INDICATOR               16000010
PRURHSDI EQU   X'04' .                   SENSE DATA INCLUDED            16800010
PRURHBC  EQU   X'02' .                   BEGIN CHAIN                    17600010
PRURHEC  EQU   X'01' .                   END CHAIN                      18400010
PRURHFG1 DS    XL1 .                    RH FLAG 1                       19200010
PRURHDR1 EQU   X'80' .                   DEFINITE RESPONSE              20000010
*        EQU   X'40' .                   RESERVED                       20800010
PRURHDR2 EQU   X'20' .                   DEFINITE RESPONSE 2            21600010
PRURHER  EQU   X'10' .                   EXCEPTION RESPONSE             22400010
*        EQU   X'08' .                   RESERVED                       23200010
*        EQU   X'04' .                   RESERVED                       24000010
*        EQU   X'02' .                   RESERVED                       24800010
PRURHPI  EQU   X'01' .                   PACING INDICATOR               25600010
PRURHFG2 DS    XL1 .                    RH FLAG 2                       26400010
PRURHBB  EQU   X'80' .                   BEGIN BRACKET                  27200010
PRURHEB  EQU   X'40' .                   END BRACKET                    28000010
PRURHCDI EQU   X'20' .                   CHANGE DIRECTION INDICATOR     28800010
*        EQU   X'10' .                   RESERVED                       29600010
PRURHCSI EQU   X'08' .                   CODE SELECTION INDICATOR       30400010
*        EQU   X'04' .                   RESERVED                       31200010
*        EQU   X'02' .                   RESERVED                       32000010
*        EQU   X'01' .                   RESERVED                       32800010
PRUTH    DS    0XL1 .                   TH FIELDS                       33600010
PRUFIDN  DS    XL1 .                    FID LEVEL INDICATOR             34000010
*        PRUTHTYE  4 BITS                                               34400010
PRUTHFD0 EQU   X'00' .                   FID 0                          35200010
PRUTHFD1 EQU   X'10' .                   FID 1                          36000010
PRUTHFD2 EQU   X'20' .                   FID 2                          36800010
PRUTHFD3 EQU   X'30' .                   FID 3                          37600010
PRUTHBIU EQU   X'08' .                   BEGIN SEGMENT                  38400010
PRUTHEIU EQU   X'04' .                   END SEGMENT                    39200010
PRUTHUSS EQU   X'02' .                   CONV FROM USS TO FSS  @Y17XAXF 39400010
PRUTHEFI EQU   X'01' .                   EXPEDITED FLOW INDICATOR       40000010
         DS    F .                      RESERVED                        40800010
PRUNLEN  EQU   *-IEDPRUND               TPRUD NEG PREFIX LENGTH@Y17XAXF 41200010
IEDPRUQD EQU   *                        END OF NEGATIVE PREFIX          41600010
PRUTTCIN DS    H .                      DESTINATION TTCIN               42400010
PRUDATCT DS    H .                      DATA COUNT                      43200010
         DS    A .                      RESERVED                        44000010
PRUTIC   DS    0A .                     TIC COMMAND CODE/ADDR           44800010
         DS    XL1 .                    TIC CODE                        45000010
PRUNUNIT DS    AL3 .                    NEXT UNIT ADDRESS               45200010
PRUDATA  EQU   *                        START OF DATA                   45600010
PRUQLEN  EQU   *-IEDPRUQD .             TPRUD BASIC LENGTH     @Y17XAXF 46000010
PRULEN   EQU   *-IEDPRUND .             LENGTH OF TPRUD                 46400010
         MEND                                                           47200010
*        */                                                             48000010
*%PRUPLS : ;                                                            48800010
*DECLARE                                                                49600010
*  1 IEDPRUQD BDY(WORD) BASED(IEDPRUQP),                                50400010
*/*                                                                  */ 51200010
*/*      PACKED RU DSECT                                             */ 52000010
*/*                                                                  */ 52800010
*   2 PRUTTCIN FIXED(16),               /* DESTINATION TTCIN         */ 53600010
*   2 PRUDATCT FIXED(15),               /* DATA COUNT                */ 54400010
*   2 *        PTR(31),                 /* RESERVED                  */ 55200010
*   2 PRUTIC  BIT(32) BDY(WORD),        /* TIC COMMAND CODE/ADDR     */ 56000010
*                                                          /*@Y17XAXF*/ 56100010
*    3 *       CHAR(1),                 /* TIC CODE                  */ 56200010
*    3 PRUNUNIT PTR(24),                /* NEXT UNIT ADDRESS         */ 56400010
*   2 PRUDATA CHAR(*);                  /* START OF DATA             */ 56800010
* %PRULEN='LENGTH(IEDPRUQD+8)';         /* LENGTH OF TPRUD           */ 57600010
* %PRUNLEN='LENGTH(IEDPRUND)';          /* NEG PREFIX LEN    @Y17XAXF*/ 57800010
* %PRUQLEN='LENGTH(IEDPRUQD)';          /* BASIC PRU LEN     @Y17XAXF*/ 58000010
*/*                                                                  */ 58400010
*/*      NEGATIVE PREFIX                                             */ 59200010
*/*                                                                  */ 60000010
*DECLARE                                                                60800010
*  1 IEDPRUND BDY(WORD) BASED(ADDR(IEDPRUQD)-LENGTH(IEDPRUND)),         61600010
*   2 PRURHTH  CHAR(4),                 /* TH AND RH FIELDS          */ 62400010
*     3 PRURH    CHAR(3),               /* RH FIELD                  */ 62600010
*       4 PRURHFG0 CHAR(1),             /* RH FLAG 0                 */ 62900010
*         5 PRURHTYP BIT(1),              /* ON-RSP, OFF-REQ         */ 63200010
*         5 PRURUCAT BIT(2),              /* RU CATEGORY             */ 64000010
*         5 *        BIT(1),              /* RESERVED                */ 64800010
*         5 PRURHFI  BIT(1),              /* FORMAT INDICATOR        */ 65600010
*         5 PRURHSDI BIT(1),              /* SENSE DATA INDICAT      */ 66400010
*         5 PRURHBC  BIT(1),              /* BEGIN CHAIN             */ 67200010
*         5 PRURHEC  BIT(1),              /* END CHAIN               */ 68000010
*       4 PRURHFG1 CHAR(1),             /* RH FLAG 1                 */ 68800010
*         5 PRURHDR1 BIT(1),              /* DEFINITE RESPONSE 1     */ 69600010
*         5 *        BIT(1),              /* RESERVED                */ 70400010
*         5 PRURHDR2 BIT(1),              /* DEFINITE RESPONSE 2     */ 71200010
*         5 PRURHER  BIT(1),              /* EXCEPTION RESPONSE      */ 72000010
*         5 *        BIT(3),              /* RESERVED                */ 72800010
*         5 PRURHPI  BIT(1),              /* PACING INDICATOR        */ 73600010
*       4 PRURHFG2 CHAR(1),             /* RH FLAG 2                 */ 74400010
*         5 PRURHBB  BIT(1),              /* BEGIN BRACKET           */ 75200010
*         5 PRURHEB  BIT(1),              /* END BRACKET             */ 76000010
*         5 PRURHCDI BIT(1),              /* CHANGE DIRECTION INDIC  */ 76800010
*         5 *        BIT(1),              /* RESERVED                */ 77600010
*         5 PRURHCSI BIT(1),              /* CODE SELECTION INDIC    */ 78400010
*         5 *        BIT(3),              /* RESERVED                */ 79200010
*     3 PRUTH   CHAR(1),                /* TH FIELDS                 */ 80000010
*       4 PRUFIDN CHAR(1),              /* FID LEVEL INDICATOR       */ 80400010
*         5 PRUTHTYE BIT(4),              /* FORMAT TYPE             */ 80800010
*         5 PRUTHBIU BIT(1),              /* BEGIN SEGMENT           */ 81600010
*         5 PRUTHEIU BIT(1),              /* END SEGMENT             */ 82400010
*         5 PRUTHUSS BIT(1),              /* CONV FROM USS TO FSS    */ 83200010
*         5 PRUTHEFI BIT(1),              /* EXPEDITED FLOW INDIC    */ 84000010
*   2 * PTR(31);                        /* RESERVED                  */ 84800010
*                                                                       85600010
*/*                                                                  */ 85800010
*/*      FORMAT TYPE (PRUTHTYE)                                      */ 86000010
*/*                                                                  */ 86200010
* DCL PRUTHFD0  BIT(4) CONSTANT('0000'B); /* FID 0 INDICATOR         */ 86400010
* DCL PRUTHFD1  BIT(4) CONSTANT('0001'B); /* FID 1 INDICATOR         */ 87200010
* DCL PRUTHFD2  BIT(4) CONSTANT('0010'B); /* FID 2 INDICATOR         */ 88000010
* DCL PRUTHFD3  BIT(4) CONSTANT('0011'B); /* FID 3 INDICATOR         */ 88800010
*                                                                       89600010
*/*                                                                  */ 90600010
*/*      RU CATEGORY (PRURUCAT)                                      */ 91600010
*/*                                                                  */ 92600010
* DCL PRURHFMD BIT(2) CONSTANT('00'B);  /* FM DATA                   */ 93600010
* DCL PRURHNC  BIT(2) CONSTANT('01'B);  /* NETWORK CONTROL           */ 94600010
* DCL PRURHDFC BIT(2) CONSTANT('10'B);  /* DATA FLOW CONTROL         */ 95600010
* DCL PRURHSC  BIT(2) CONSTANT('11'B);  /* SESSION CONTROL           */ 96600010
*/*                                                          @Y17XAXF*/ 97100010
*/*      INVALID TIC POINTER CONSTANT                        @Y17XAXF*/ 97600010
*/*                                                          @Y17XAXF*/ 98100010
* DCL PRUINTIC BIT(32) CONSTANT('08000002'X); /* LAST PACKED @Y17XAXF*/ 98600010
*                                             /*  RU IN CHN  @Y17XAXF*/ 99100010
./  ADD  SSI=81390222,NAME=TQCBD
*        %GOTO BSLQCB;                                               /* 00200022
         MACRO                                                          00500020
         TQCBD                                                          01000020
.*A-000000-999999                                              @X31X8X0 01200008
.*       UPDATED   6/7/74                                      @Z30X8XE 01500008
.*       CONVERTED TO A BILINGUAL DSECT 07/19/72                 S22024 01700022
.* CHANGE ACTIVITY = AS FOLLOWS:                                        02000122
.*D015000,825000                                                SA51078 02000222
.*C820000,905000                                                SA51078 02000322
.*A024500                                                       SA51078 02000422
.*A087000,125000                                                 S22029 02020022
.*C015000                                                        S22029 02040022
.*D230000                                                        S22025 02060022
.*C015000                                                        S22025 02120022
.*A020000,6950000                                                       02200021
.*D110000-125000                                                 S22026 02300022
.*A087000,110000-125000,337000,382000-384000,497000              S22026 02400022
.*A000000,055000,445000,936000                                   S22024 02405022
.*C935000,020000                                                 S22024 02410022
.*D265000-270000                                                 S22024 02415022
.*A230000                                                        Y06327 02416005
.*C946800                                                        Y06327 02417005
.*C015000                                                      @Z30X8XE 02417108
.*C960000,965800                                               @XA11316 02417200
.*A145000,941800                                               @OX17153 02417500
.*A024350,1900000,944400,960000                                @Y17XAXF 02417900
.*D024550                                                      @Y17XAXF 02418600
.*C024600-024846,024900-024930,979200-981800                   @Y17XAXF 02419300
.*A175000                                                               02419600
.*A305000,949800                                               @OY20733 02419782
*                                                                S22024 02420022
*                                                                S22024 02430022
IEDNQCB  DSECT                                                   S22024 02435022
QCBCHAIN DS    AL4 .                    ADDR TO CHAIN OF QCB'  @Y17XAXF 02436000
*                                         WAITING FOR PLCB     @Y17XAXF 02437000
*                                         ALLOCATION           @Y17XAXF 02438000
QCBSTAT1 DS    XL1 .                    FLAG BYTE                S22024 02440022
QCBPLCBN EQU   X'80' .                  ON - FIELD CONTAINS PLCB ADDR   02445022
*                                       OFF - CONTAINS TTCIN     S22024 02450122
QCBWAITC EQU   X'40' .                  FIELD CONTAINS WAIT    @Y17XAXF 02460000
*                                         CHAIN ADDR           @Y17XAXF 02461000
QCBSNDRQ EQU   X'20' .                  A PLCB HAS BEEN REQ    @Y17XAXF 02462000
*                                         HAVING THE SEND &    @Y17XAXF 02463000
*                                         RECV STCB'S IN ITS   @Y17XAXF 02464000
*                                         STCB CHAIN           @Y17XAXF 02465000
QCBRCVRQ EQU   X'10' .                  A PLCB HAS BEEN REQ    @Y17XAXF 02466000
*                                         HAVING THE RECV STCB @Y17XAXF 02467000
*                                         IN ITS STCB CHAIN    @Y17XAXF 02468000
QCBESIG  EQU   X'08' .                  ESIG IS NEEDED         @Y17XAXF 02469000
QCBNDXRQ EQU   X'04' .                  INDEXED PLCB REQUEST   @Y17XAXF 02470000
QCBFLUSH EQU   X'02' .                  QUEUE FLUSH IN PROGRESS         02471000
*                                                              @Y17XAXF 02471500
*        EQU   X'01' .                  RESERVED               @Y17XAXF 02472000
*                                                              @Y17XAXF 02473000
*        QCBSTAT1 MUST ALWAYS PRECEDE QCBPLCBA                 @Y17XAXF 02474000
*                                                              @Y17XAXF 02475000
QCBPLCBA DS    0AL3 .                   ADDR OF PLCB             S22024 02485022
         DS    XL1 .                                           @Y17XAXF 02490000
QCBTTCIN DS    H .                      TNT INDEX                S22024 02495022
*                                                                       02500020
*                                                                       03000020
*        THIS IS A DSECT OF THE MASTER QCB FOLLOWED BY THE PRIORITY     03500020
*        QCB. THERE IS A MASTER QCB FOR EVERY MESSAGE QUEUE. THERE      04000020
*        IS A PRIORITY QCB FOR EACH PRIORITY LEVEL APPLICABLE FOR       04500020
*        THIS DESTINATION QUEUE.                                        05000020
         SPACE                                                          05500020
IEDQQCB  EQU   *                                                 S22024 05700022
QCBDSFLG DS    XL1 .                    FLAGS INDICATING A QCB FOR      06000020
*                                         DISPATCHER AND WHICH DATA     06500020
*                                         SET(S) THE MESSAGES FOR       07000020
*                                         THIS DEST. ARE QUEUED ON      07500020
*                        BIT DEFINITIONS                                08000020
QCBHELD  EQU   X'01' .                  STOP SENDING                    08200020
QCBFQCB  EQU   X'02' .                  FLAG INDICATING A QCB           08500020
QCBDRQQ  EQU   X'04' .                  FLAG INDIC A DRQ         S22026 08700022
QCBALTMH EQU   X'08'  .                 MSGS GO TO ALTERNATE MH  S22029 08800022
QCBREUS  EQU   X'10' .                  FLAG FOR REUSEABLE DISK Q.      09000020
QCBNREUS EQU   X'20' .                  FLAG FOR NONREUS. DISK Q.       09500020
QCBDISK  EQU   X'30' .                  DISK QUEUES USED                10000020
QCBCORE  EQU   X'40' .                  FLAG FOR MS QUEUES.             10500020
*              X'50'                    INDICATES CORE Q'S WITH         11000022
*                                       BACKUP ON REUSABLE DISK         11500022
*              X'60'                    INDICATES CORE Q'S WITH         12000022
*                                       BACKUP ON NONREUS DISK          12500022
QCBTSQ   EQU   X'80'  .                 TIME-SHARING QUEUES      S22029 12700022
*                                                                       13000020
QCBELCHN DS    AL3 .                    ELEMENT CHAIN                   13500020
*              CONTAINS THE QCB ADDRESS TO BE POSTED TO WHEN THIS       14000020
*              QCB IS REMOVED FROM THE TIME DELAY QUEUE.                14500020
*                        BIT DEFINITIONS                                14550000
QCBCNTEN EQU   X'01' .                  WACK TO ADDRESSING     @OX17153 14600000
QCBPRI   DS    XL1 .                    PRIORITY                        15000020
QCBLINK  DS    AL3 .                    POINTER TO NEXT STCB IN CHAIN   15500020
QCBSTVTO DS    AL1 .                    INDEX TO THE ENTRY IN THE       16000020
*                                         SUBTASK VECTOR TABLE          16500020
QCBSTCHN DS    AL3 .                    STCB CHAIN                      17000020
QCBSTPRI DS    XL1 .                    PRIORITY OF THE STCB            17500020
QCBCALLN EQU   X'50' .                  DIALNO=NONE CALL IN    @Y17XAXF 17600000
*                                        ONLY                  @Y17XAXF 17601000
QCBCNTVL EQU   X'70' .                  CINTVL INDICATOR       @Y17XAXF 17602000
QCBCLK   EQU   X'80' .                  CLOCK INDICATOR        @Y17XAXF 17603000
QCBSLINK DS    AL3 .                    POINTER TO NEXT STCB IN CHAIN   18000020
QCBEOLDT DS    0XL2 .                   INTERRUPT TIME         @Y17XAXF 18500000
         DS    XL1 .                    RESERVED                        18600000
QCBBYTE1 DS    XL1 .                    QCB FLAGS                       18700000
QCBRITRM EQU   X'80' .                    REC IN TRANSIT MODE           18800000
*        EQU   X'40'-X'01' .              RESERVED             @Y17XAXF 18900000
QCBRETCT DS    0XL1 .                   TSO RETRY COUNTERS          TSO 19000020
* QCBLOGCT     BITS 0-1                 TSO RETRY COUNTER      @Y17XAXF 19040000
QCBLOG2  EQU   X'80' .                    RETRY COUNTER 2      @Y17XAXF 19080000
QCBLOG1  EQU   X'40' .                    RETRY COUNTER 1      @Y17XAXF 19120000
QCBNL    EQU   X'30' .                  TSO NEW LINE REQ       @Y17XAXF 19160000
QCBCR    EQU   X'20' .                  TSO CARRIAGE RETURN REQ@Y17XAXF 19200000
QCBLF    EQU   X'10' .                  TSO LINE FEED REQ      @Y17XAXF 19240000
QCBEND   EQU   X'08' .                  EDIT SPEC OUTPUT REQ   @Y17XAXF 19280000
QCBIEND  EQU   X'04' .                  EDIT SPEC OUTPUT REQ OR@Y17XAXF 19320000
*                                         OR 3270 FORMAT       @Y17XAXF 19360000
*QCBHUCT EQU   X'02'-X'01'              TSO HANGUP COUNTS      @Y17XAXF 19400000
QCBHUCT1 EQU   X'01' .                   *                     @Y17XAXF 19410000
QCBHUCT2 EQU   X'F2' .                   *                     @Y17XAXF 19420000
QCBHUCT3 EQU   X'03' .                   *                     @Y17XAXF 19440000
QCBLKRLN DS    XL1 .                    LOCK RELATIVE LINE NO.          19500020
*              OFFSET TO QCB FOR TIME DELAY - FOR QCB = X'00'           20000020
QCBSTAT  DS    XL1 .                    STATUS OF THIS QCB              20500020
*                        BIT DEFINITIONS                                21000020
QCBEOM   EQU   X'80' .                  END OF MESSAGE SENT             21500020
QCBTRMHO EQU   X'40' .                  TERMINAL WAS HELD               21700022
QCBBUFRD EQU   X'20' .                  BUFFERED TERMINAL               22000020
QCBSEND  EQU   X'10' .                  SENDING TO BUFFERED TERMINAL    22500020
QCBSMODE EQU   X'08'                    SET MODE REQ FOR TSO TRM Y06327 23000005
QCBSCHDL EQU   X'04' .                  PUT IN DELAY Q WHEN INACTIVE    23500020
QCBCLOCK EQU   X'02' .                  ON = CLOCK, OFF = INTVL         24000020
QCBTIME  EQU   X'01' .                  DELAY GREATER THAN 12 HOURS     24500020
*                                                                       25000020
QCBSCBOF DS    XL1 .                    OFFSET TO THE PROPER SCB        25500020
*                                         FOR THIS TRANSMISSION.        26000020
QCBINSRC DS    0AL3 .                   CHAIN OF SOURCE LCB'S           27500020
*                                         CURRENTLY SENDING INITIATE    28000020
*                                         MODE MSGS TO THIS DEST. Q.    28500020
QCBSATCT DS    XL1 .                    SIM ATTN OUTPUT LINE COUNT  TSO 29000020
QCBTSOF2 DS    XL1 .                    SECOND TSO FLAG BYTE        TSO 29500020
*                        BIT DEFINITIONS                            TSO 30000020
QCBINHBN EQU   X'80' .                  USE INHIBITS WITH THIS TERM TSO 30500020
QCBMTP   EQU   X'80'                    MID TPUT FOR 3270      @OY20733 30550082
QCBBUFQ  EQU   X'40' .                  TCAM BUFFER BEING HELD      TSO 31000020
QCBPOSTO EQU   X'20' .                  QCB POSTED TO ITSELF        TSO 31500020
QCBDSSMI EQU   X'10' .                  START MI CHARACTER SENT     TSO 31700022
QCBSIMRD EQU   X'08' .                  SIMATTN READ EXECUTING      TSO 32100020
QCBSATCH EQU   X'04' .                  SIMULATED ATTN BY CHARACTER TSO 32500020
QCBSATTI EQU   X'02' .                  SIMULATED ATTN BY TIME      TSO 33000020
QCBSATLC EQU   X'01' .                  SIMULATED ATTN BY LINE      TSO 33500020
*                                                                       33700022
QCBTSOF1 DS    XL1 .                    FIRST TSO FLAG BYTE         TSO 34000020
*                        BIT DEFINITIONS                            TSO 34500020
QCBWRBRK EQU   X'80' .                  ISSUE A WRITE BREAK         TSO 35000020
QCBTGET  EQU   X'40' .                  TGET REQUEST                TSO 35500020
QCBTPUT  EQU   X'20' .                  TPUT REQUEST                TSO 36000020
QCBNOBUF EQU   X'10' .                  INSUFFICIENT BUFFERS        TSO 36500020
QCBSATRD EQU   X'08' .                  SIMULATED ATTN READ REQUEST TSO 37000020
QCBPARTO EQU   X'04' .                  PARTIAL OUTPUT LINE         TSO 37500020
QCBDELAY EQU   X'02' .                  QCB IN DELAY QUEUE              38000020
QCBDISC  EQU   X'01' .                  USER TO BE LOGGED OFF       TSO 38200022
*                                                                       38300022
QCBEXTO  DS    0H .                     OFFSET TO EXT            S22026 38400022
QCBINTVL DS    XL2 .                    INTERVAL FOR POLL DELAY         38500020
QCBMSGCT DS    H .                      COUNT OF MESSAGES IN THIS       39000020
*                                         QUEUE                         39500020
QCBPREN  DS    0A .                     ADDRESS OF TERMINAL TABLE       40000020
*                                       ENTRY IF QCB FOR A PROCESS      40500020
*                                       ENTRY                           41000020
QCBPRLVL DS    XL1 .                    HIGHEST PRIORITY LEVEL MESSAGE  41500020
QCBLKRRN DS    0XL3 .                   LOCK RELATIVE RECORD NUM.       42000020
*              LINK FIELD FOR QCB WHEN ON THE TIME DELAY QUEUE          42500020
QCBCARCT DS    XL1 .                    CARRIAGE POSITION COUNT     TSO 43000020
QCBTJID  DS    H .                      TSO JOB IDENTIFICATION      TSO 43500020
QCBRELLN DS    XL1 .                    RELATIVE LINE NO. FOR THE       44000020
*                                         LINE THIS QCB REPRESENTS      44500020
QCBLGBAD DS    0AL3 .                   ADDRESS OF LGB           S22024 44700022
QCBDCBAD DS    AL3 .                    ADDRESS OF DCB                  45000020
QCBFLAG  DS    XL1 .                    QCB STATUS BITS                 45500020
*                        BIT DEFINITIONS                                46000020
QCBTSSES EQU   X'80' .                  TSO SESSION IN PROGRESS     TSO 46500020
QCBNOBRK EQU   X'40' .                  NO REVERSE BREAK FEATURE    TSO 47000020
QCBREAD  EQU   X'20' .                  READ HAS PRIORITY           TSO 47500020
QCBRSRV  EQU   X'10' .                  REUSE SERVICED BIT              48000020
QCBTERMQ EQU   X'08' .                  QUEUING BY TERMINAL             48200022
QCBSDFFO EQU   X'04' .                  CURRENTLY SENDING FEFO MSG      48500020
QCBPROC  EQU   X'02' .                  THIS QCB FOR A PROCESS ENTRY    49000020
QCBCKPT  EQU   X'01' .                  FLAG FOR CHECKPOINT             49500020
*                                                                       49700022
QCBQBACK DS    AL3 .                    QBACK MESSAGE CHAIN             50000020
         SPACE 2                                                        50500020
*     DEC                                 HEX                           51000020
*        *********************************                              51500020
*      0 * DSFLG *         ELCHN         *                              52000020
*        *********************************                              52500020
*      4 * PRI   *         LINK          *  4                           53000020
*        *********************************                              53500020
*      8 *  VTO  *         STCHN         *  8                           54000020
*        *********************************           **************     54500020
*     12 * STPRI *         SLINK         *  C        *            *     55000020
*        *********************************           * MASTER QCB *     55500020
*     16 *    EOLDT      * LKRLN * STAT  * 10        *                  56000020
*        *********************************           **************     56500020
*     20 * SCBOF *         INSRC         * 14                           57000020
*        *********************************                              57500020
*     24 *    INTVL      *     MSGCT     * 18                           58000020
*        *********************************                              58500020
*     28 * PRILVL*     PREN/LKRRN        * 1C                           59000020
*        *********************************                              59500020
*     32 * RELLN *      DCBAD/LGBAD      * 20                    S22024 60000022
*        *********************************                              60500020
*     36 * FLAG  *         QBACK         * 24                           61000020
*        *********************************                              61500020
         SPACE                                                          62000020
*                                                                       62500020
QCBMEND  EQU   * .                                                      63000020
QCBMSIZE EQU   QCBMEND-IEDQQCB .        SIZE OF MASTER QCB              63500020
QCBPRFSZ EQU   IEDQQCB-IEDNQCB          SIZE OF 3705 PREFIX      Y06327 63700005
*                                                                       64000020
         SPACE 2                                                        64500020
*                                                                       65000020
*        THIS IS THE DSECT OF A PRIORITY QCB.  THERE IS A PRIORITY      65500020
*        QCB FOR EACH PRIORITY LEVEL APPLICABLE FOR THIS DEST. Q        66000020
*                                                                       66500020
IEDQPQCB EQU   * .                 START OF PRI LEVEL QCB               67000020
QCBDNHDR DS    XL3 .                    DISK RECORE NUMBER TO PUT       67500020
*                                         THE NEXT HDR RECEIVED         68000020
QCBFHDLZ DS    0XL3 .                   DISK RECORD             SA52971 68500022
QCBDATFL DS    X .                     DATFLAGS FIELD OF LAST    S21101 69600021
*                                      MSG REMOVED FROM FEFO Q   S21101 69650021
QCBPFEFO DS    0XL3 .                   IF TERM OF QUEUE HELD,  SA52971 69700022
*                                         PREVIOUS TO FIRST     SA52971 69710022
*                                         HELD MESSAGE          SA52971 69720022
*                                       IF TERM NOT HELD,       SA52971 69730022
*                                         PREVIOUS TO LAST      SA52971 69740022
         DS    XL2                        MESSAGE SERVICED      SA52971 69750022
QCBFHDTZ DS    0XL3 .                   DISK RECORD             SA52971 69760022
         DS    XL1 .                    PFEFO CONTINUED         SA52971 69770022
QCBDATSQ DS    XL2 .                    SEQUENC NUMBER OF LAST   S21101 69800021
*                                       MSG REMOVED FROM FEFO Q  S21101 69850021
QCBINTFF DS    XL3 .                    DISK REC.NO. OF THE FIRST       72000020
*                                         INTERCEPTED MSG. - FEFO       72500020
*                                         ORDER                         73000020
QCBINTLF DS    0XL3 .                   LAST INTERCEPTED MSG    SA52971 73500022
QCBPREVF DS    XL3 .                    PREVIOUS TO LAST FFEFO  SA52971 74000022
QCBFFEFO DS    XL3 .                    DISK REC. NO. OF THE FIRST      74500020
*                                         (FEFO) MSG. TO BE RECVD.      75000020
*                                         CORE RECORD NO. IF THIS       75500020
*                                         IS A CORE ONLY QUEUE.         76000020
QCBLFEFO DS    XL3 .                    DISK RECORD NO. OF THE          76500020
*                                         LAST FEFO MSG. RECEIVED.      77000020
*                                         CORE REC. NO. IF THIS IS      77500020
*                                         A CORE ONLY QUEUE.            78000020
QCBCFHDR DS    XL3 .                    CORE REC. NO. OF THE FIRST      78500020
*                                         HEADER APPEARING IN THIS      79000020
*                                         QUEUE.                        79500020
QCBPRIPQ DS    XL1 .                    THE PRIORITY OF THIS PRITY      80000020
*                                         LEVEL QCB.  THIS WILL BE      80500020
*                                         X'00' IF THIS IS THE          81000020
*                                         LOWEST PRTY LEVEL.            81500020
QCBPQBCK DS    XL3 .                    PQCB BACK CHAIN         SA51078 82000022
         SPACE 2                                                        83000020
*     DEC                                 HEX                           83500020
*        *********************************                              84000020
*      0 *         DNHDR         * DATFL *  0                   SA52971 84500022
*        *********************************                              85000020
*      4 *         PFEFO         * DATSQ *  4                   SA52971 85500022
*        *********************************         ****************     86000020
*      8 *(DATSQ)*         INTFF         *  8      *            SA52971 86500022
*        *********************************         * PRIORITY QCB *     87000020
*     12 *         PREVF         * FFEFO *  C      *            SA52971 87500022
*        *********************************         ****************     88000020
*     16 *    (FFEFO)    *     LFEFO     * 10                           88500020
*        *********************************                              89000020
*     20 *(LFEFO)*         CFHDR         * 14                           89500020
*        *********************************                              90000020
*     24 * PRIPQ *         PQBCK         * 18                   SA51078 90500022
*        *********************************                              91000020
*                                                                       91500020
QCBPEND  EQU   *                                                        92000020
QCBPSIZE EQU   QCBPEND-IEDQPQCB                                         92500020
QCBLDCB  EQU   IEDQQCB+X'78'            LOGTYPE DCB ADDR       @XM05707 92700000
*                                                                       93000020
         MEND  , */                                                     93500022
*%BSLQCB  :  ;                                                          93520022
*DECLARE                                                                93540022
*  1 IEDQQCB BASED(IEDQQPTR) BDY(WORD), /* START OF THE MASTER QCB      93560022
*                                                              S22024*/ 93580022
*/*                                                                  */ 93600022
*/*                                                                  */ 93620022
*/*      THIS IS A DSECT OF THE MASTER QCB FOLLOWED BY THE PRIORITY  */ 93640022
*/*      QCB. THERE IS A MASTER QCB FOR EVERY MESSAGE QUEUE. THERE   */ 93660022
*/*      IS A PRIORITY QCB FOR EACH PRIORITY LEVEL APPLICABLE FOR    */ 93680022
*/*      THIS DESTINATION QUEUE.                                     */ 93700022
*                                                                       93720022
*   2 QCBDSFLG    CHAR(1),              /* FLAGS INDICATING A QCB FOR   93740022
*                                       THE DISPATCHER AND WHICH DATA   93760022
*                                       SET(S) THE MESSAGES FOR THIS    93780022
*                                       DEST. ARE QUEUED ON          */ 93800022
*    3 QCBTSQ   BIT(1),                 /* TIME-SHARING QUEUES S22029*/ 93820022
*    3 QCBCORE  BIT(1),                 /* FLAG FOR MS QUEUES        */ 93840022
*    3 QCBDISK  BIT(2),                 /* DISK QUEUES USED          */ 93860022
*     4 QCBNREUS BIT(1),                /* NON-REUSABLE DISK QUEUE   */ 93880022
*     4 QCBREUS  BIT(1),                /* REUSABLE DISK QUEUE       */ 93900022
*    3 QCBALTMH BIT(1),                 /* MSGS GO TO ALTER MH S22029*/ 93920022
*    3 QCBDRQQ  BIT(1),                 /* FLAG INDIC A DRQ    S22026*/ 93940022
*    3 QCBFQCB  BIT(1),                 /* INDICATES A QCB           */ 93960022
*    3 QCBHELD  BIT(1),                 /* STOP SENDING                 93980022
*                                       X'60' INDICATES CORE Q'S WITH   94000022
*                                       BACK UP ON NONR. DSK            94020022
*                                       X'50' INDICATES CORE Q'S WITH   94040022
*                                       BACKUP ON REUS. DISK         */ 94060022
*/*                                                                  */ 94080022
*   2 QCBELCHN    PTR(24)  BDY(BYTE),   /* ELEMENT CHAIN                94100022
*                                       CONTAINS THE QCB ADDRESS        94120022
*                                       TO BE POSTED TO WHEN THIS       94140022
*                                       QCB IS REMOVED FROM THE         94160022
*                                       TIME DELAY QUEUE             */ 94180022
*    3 *        CHAR(2),               /*                    @OX17153*/ 94185000
*    3 *        BIT(7),                /*                    @OX17153*/ 94190000
*    3 QCBCNTEN BIT(1),                 /* WACK TO ADDRESSING@OX17153*/ 94195000
*   2 QCBPRI      CHAR(1),              /* PRIORITY                  */ 94200022
*   2 QCBLINK     PTR(24)  BDY(BYTE),   /* POINTER TO NEXT STCB IN      94220022
*                                       CHAIN                        */ 94240022
*   2 QCBSTVTO    PTR(8),               /* INDEX TO THE ENTRY IN THE    94260022
*                                       SUBTASK VECTOR TABLE         */ 94280022
*   2 QCBSTCHN    PTR(24)  BDY(BYTE),   /* STCB CHAIN                */ 94300022
*   2 QCBSTPRI    CHAR(1),              /* PRIORITY OF THE STCB      */ 94320022
*   2 QCBSLINK    PTR(24)  BDY(BYTE),   /* POINTER TO THE NEXT STCB     94340022
*                                       IN CHAIN                     */ 94360022
*   2 QCBEOLDT   FIXED(16) BDY(BYTE),   /* INTERRUPT TIME    @VS44899*/ 94380000
*    3 *         CHAR(1),               /* RESERVED          @Y17XAXF*/ 94388000
*    3 QCBBYTE1  CHAR(1),               /* QCB FLAGS         @Y17XAXF*/ 94396000
*     4 QCBRITRM  BIT(1),               /*  REC IN TRANS     @Y17XAXF*/ 94404000
*                                       /*   MODE            @Y17XAXF*/ 94408000
*     4 *         BIT(7),               /*  RESERVED         @Y17XAXF*/ 94412000
*   2 QCBLKRLN   CHAR(1),               /*LOCK RELATIVE LINE NUMBER  */ 94420008
*    3 QCBRETCT  CHAR(1),               /* TSO RETRY COUNTERS    TSO */ 94440008
*     4 QCBLOGCT BIT(2),                /* TSO RETRY COUNTER @Y17XAXF*/ 94450000
*     4 QCBNL    BIT(2),                /* TSO NLINE REQUEST @Y17XAXF*/ 94460000
*     4 QCBEND   BIT(1),                /* EDT SPEC OUTPUT   @Y17XAXF*/ 94470000
*                                       /*  REQUIRED         @Y17XAXF*/ 94475000
*     4 QCBIEND  BIT(1),                /* EDT SPEC OUTPUT   @Y17XAXF*/ 94480000
*                                       /*  REQ OR 3270      @Y17XAXF*/ 94486000
*                                       /*  FORMAT           @Y17XAXF*/ 94492000
*     4 QCBHUCT  BIT(2),                /* TSO HANGUP COUNTS @Y17XAXF*/ 94500000
*   2 QCBSTAT     CHAR(1),              /* STATUS OF THE QCB         */ 94560022
*    3 QCBEOM   BIT(1),                 /* END OF MESSAGE SENT       */ 94580022
*    3 QCBTRMHO BIT(1),                 /* TERMINAL WAS HELD         */ 94600022
*    3 QCBBUFRD BIT(1),                 /* BUFFERED TERMINAL         */ 94620022
*    3 QCBSEND  BIT(1),                 /* SENDING TO BUFFER            94640022
*                                       TERMINAL                     */ 94660022
*    3 QCBSMODE BIT(1),                 /* TSO SET MODE REQ    Y06327*/ 94680005
*    3 QCBSCHDL BIT(1),                 /* PUT IN DELAY Q WHEN          94700022
*                                       INACTIVE                     */ 94720022
*    3 QCBCLOCK BIT(1),                 /* ON = CLOCK, OFF = INTVL   */ 94740022
*    3 QCBTIME  BIT(1),                 /* DELAY GREATER THAN 12        94760022
*                                       HOURS                        */ 94780022
*   2 QCBSCBOF    PTR(8),               /* OFFSET TO THE PROPER SCB     94800022
*                                       FOR THIS TRANSMISSION.       */ 94820022
*   2 QCBINSRC    PTR(24)  BDY(BYTE),   /* CHAIN OF SOURCE LCB'S        94840022
*                                       CURRENTLY SENDING INITIATE      94860022
*                                       MODE MSGS TO THIS DEST. Q.   */ 94880022
*    3 *          PTR(24)  BDY(BYTE),                                   94900022
*     4 QCBSATCT    PTR(8),             /* SIM ATTN OUTPUT LINE CNT  */ 94920022
*     4 QCBTSOF2    CHAR(1),            /* SECOND TSO FLAG BYTE   TSO*/ 94940022
*      5 QCBINHBN BIT(1),               /* USE INHIBITS WITH THIS       94960022
*                                       TERM                      TSO*/ 94980022
*        6 QCBMTP BIT(1),               /* 3270 MID TPUT     @OY20733*/ 94990082
*      5 QCBBUFQ  BIT(1),               /* TCAM BUFFER BEING HELD TSO*/ 95000022
*      5 QCBPOSTO BIT(1),               /* QCB POSTED TO ITSELF   TSO*/ 95020022
*      5 QCBDSSMI BIT(1),               /* START MI CHARACTER SENT      95040022
*                                                                 TSO*/ 95060022
*      5 QCBSIMRD BIT(1),               /* SIMATTN READ EXECUTING TSO*/ 95080022
*      5 QCBSATCH BIT(1),               /* SIMULATED ATTN BY            95100022
*                                       CHARACTER                 TSO*/ 95120022
*      5 QCBSATTI BIT(1),               /* SIMULATED ATTN BY TIME TSO*/ 95140022
*      5 QCBSATLC BIT(1),               /* SIMULATED ATTN BY LINE TSO*/ 95160022
*     4 QCBTSOF1    CHAR(1),            /* FIRST TSO FLAG BYTE    TSO*/ 95180022
*      5 QCBWRBRK BIT(1),               /* ISSUE A WRITE BREAK    TSO*/ 95200022
*      5 QCBTGET  BIT(1),               /* TGET REQUEST           TSO*/ 95220022
*      5 QCBTPUT  BIT(1),               /* TPUT REQUEST           TSO*/ 95240022
*      5 QCBNOBUF BIT(1),               /* INSUFFICIENT BUFFERS   TSO*/ 95260022
*      5 QCBSATRD BIT(1),               /* SIMULATED ATTENTION READ     95280022
*                                       REQUEST                   TSO*/ 95300022
*      5 QCBPARTO BIT(1),               /* PARTIAL OUTPUT LINE    TSO*/ 95320022
*      5 QCBDELAY BIT(1),               /* QCB IN DELAY QUEUE        */ 95340022
*      5 QCBDISC  BIT(1),               /* USER TO BE LOGGED OFF  TSO*/ 95360022
*   2 QCBINTVL    FIXED(16),            /* INTERVAL FOR POLL DELAY      95380000
*                                                            @VS44899*/ 95390000
*    3 QCBEXTO FIXED(16) ,              /* OFFSET TO EXT     @VS44899*/ 95400000
*   2 QCBMSGCT    FIXED(15),            /* COUNT OF MESSAGES IN         95420022
*                                       THIS QUEUE                   */ 95440022
*   2 QCBPREN     PTR(31),              /* ADDRESS OF TERMINAL TABLE    95460022
*                                       ENTRY IF QCB FOR A PROCESS      95480022
*                                       ENTRY                        */ 95500022
*    3 QCBPRLVL    CHAR(1),             /* HIGHEST MESSAGE PRIORITY  */ 95520022
*    3 QCBLKRRN    CHAR(3),             /* LOCK RELATIVE RECORD NO.     95540022
*                                       LINK FIELD FOR QCB WHEN ON THE  95560022
*                                       TIME DELAY QUEUE             */ 95580022
*     4 QCBCARCT    CHAR(1),            /* CARRIAGE POSITION COUNT   */ 95600022
*     4 QCBTJID     FIXED(15) BDY(BYTE), /* TSO JOB IDENTIFICATION      95620022
*                                                                 TSO*/ 95640022
*   2 QCBRELLN    CHAR(1),              /* RELATIVE LINE NUMBER         95660022
*                                       FOR LINE THIS QCB REPRESENTS */ 95680022
*   2 QCBDCBAD    PTR(24)  BDY(BYTE),   /* ADDRESS OF DCB            */ 95700022
*    3 QCBLGBAD    PTR(24) BDY(BYTE),   /* ADDRESS OF LGB      S22024*/ 95720022
*   2 QCBFLAG     CHAR(1),              /* QCB STATUS BITS           */ 95740022
*    3 QCBTSSES BIT(1),                 /* TSO SESSION IN PROGRESS      95760022
*                                                                 TSO*/ 95780022
*    3 QCBNOBRK BIT(1),                 /* NO REVERSE BREAK FEATURE     95800022
*                                                                 TSO*/ 95820022
*    3 QCBREAD  BIT(1),                 /* READ HAS PRIORITY      TSO*/ 95840022
*    3 QCBRSRV  BIT(1),                 /* REUSE SERVICED BIT        */ 95860022
*    3 QCBTERMQ BIT(1),                 /* QUEUING BY TERMINAL       */ 95880022
*    3 QCBSDFFO BIT(1),                 /* CURRENTLY SENDING FEFO       95900022
*                                       MSG                          */ 95920022
*    3 QCBPROC  BIT(1),                 /* THIS QCB FOR A PROCESS       95940022
*                                       ENTRY                        */ 95960022
*    3 QCBCKPT  BIT(1),                 /* FLAG FOR CHECKPOINT       */ 95980022
*   2 QCBQBACK    PTR(24)  BDY(BYTE);   /* QBACK MSG CHAIN   @XA11316*/ 96000000
*/* QCBHUCT  VALUES                                          @Y17XAXF*/ 96002000
* DCL QCBHUCT1 BIT(2) CONSTANT('01'B);                                  96002200
* DCL QCBHUCT2 BIT(8) CONSTANT('F2'X);                                  96002400
* DCL QCBHUCT3 BIT(2) CONSTANT('11'B);                                  96002600
*/* QCBLOGCT VALUES                                          @Y17XAXF*/ 96002800
* DCL QCBLOG2  BIT(2) CONSTANT('10'B);  /*   RETRY COUNTER 2 @Y17XAXF*/ 96003200
* DCL QCBLOG1  BIT(2) CONSTANT('01'B);  /*   RETRY COUNTER 1 @Y17XAXF*/ 96006000
*/* QCBNL    VALUES                                          @Y17XAXF*/ 96008000
* DCL QCBCR    BIT(2) CONSTANT('10'B);  /*   CARRIAGE RET    @Y17XAXF*/ 96010000
*                                       /*   REQUIRED        @Y17XAXF*/ 96011000
* DCL QCBLF    BIT(2) CONSTANT('01'B);  /*   LINE FEED REQ   @Y17XAXF*/ 96012000
*/* QCBSTPRI VALUES                                          @Y17XAXF*/ 96014000
* DCL QCBCALLN BIT(8) CONSTANT('50'X);  /* DIALNO=NONE CALL IN ONLY  */ 96016000
*                                       /*                   @Y17XAXF*/ 96016600
* DCL QCBCNTVL BIT(8) CONSTANT('70'X);  /* CINTVL IND        @Y17XAXF*/ 96017200
* DCL QCBCLK   BIT(8) CONSTANT('80'X);  /* CLOCK IND         @Y17XAXF*/ 96018000
*/*                                                                  */ 96020022
*/*                                                                  */ 96040022
*/*   DEC                                 HEX                        */ 96060022
*/*      *********************************                           */ 96080022
*/*    0 * DSFLG *         ELCHN         *                           */ 96100022
*/*      *********************************                           */ 96120022
*/*    4 * PRI   *         LINK          *  4                        */ 96140022
*/*      *********************************                           */ 96160022
*/*    8 *  VTO  *         STCHN         *  8                        */ 96180022
*/*      *********************************           **************  */ 96200022
*/*   12 * STPRI *         SLINK         *  C        *            *  */ 96220022
*/*      *********************************           * MASTER QCB *  */ 96240022
*/*   16 *    EOLDT      * LKRLN * STAT  * 10        *               */ 96260022
*/*      *********************************           **************  */ 96280022
*/*   20 * SCBOF *         INSRC         * 14                        */ 96300022
*/*      *********************************                           */ 96320022
*/*   24 *    INTVL      *     MSGCT     * 18                        */ 96340022
*/*      *********************************                           */ 96360022
*/*   28 * PRILVL*     PREN/LKRRN        * 1C                        */ 96380022
*/*      *********************************                           */ 96400022
*/*   32 * RELLN *         DCBAD         * 20                        */ 96420022
*/*      *********************************                           */ 96440022
*/*   36 * FLAG  *         QBACK         * 24                        */ 96460022
*/*      *********************************                           */ 96480022
*/*                                                                  */ 96500022
*/*      THIS IS THE DSECT OF A PRIORITY QCB.  THERE IS A PRIORITY   */ 96520022
*/*      QCB FOR EACH PRIORITY LEVEL APPLICABLE FOR THIS DEST. Q     */ 96540022
*/*                                                                  */ 96560022
*    DECLARE 1 IEDQPQCB    CHAR(28) BASED(IEDQQPTR+LENGTH(IEDQQCB)),    96580000
*                                       /* START OF PRTY QCB @YM06080*/ 96590000
*    3 QCBDNHDR    CHAR(3),             /* DISK RECORE NUMBER TO PUT    96600022
*                                       THE NEXT HDR RECEIVED        */ 96620022
*    3 QCBFHDLZ    CHAR(3),             /* DISK REC. NO OF THE FIRST    96640022
*                                       HEADER ON THIS QUEUE         */ 96660022
*     4 QCBDATFL CHAR(1),               /* DATFLAGS FIELD OF LAST MSG   96680022
*                                       REMOVED FROM FEFO Q    S21101*/ 96700022
*     4 QCBPFEFO CHAR(3),               /* IF TERM OF QUEUE HELD,       96720022
*                                       PREVIOUS TO FIRST HELD          96740022
*                                       MESSAGE               SA52971*/ 96760022
*      5 *       CHAR(2),               /* IF TERM NOT HELD,PREVIOUS    96780022
*                                       LAST MESSAGE SERVICED SA52971*/ 96800022
*    3 QCBFHDTZ    CHAR(3),             /* LAST ZONE USED.              96820022
*                                       DISK REC. NO. OF THE FIRST      96840022
*                                       HEADER PLACED IN THE CURRENT    96860022
*                                       ZONE                         */ 96880022
*     4 *        CHAR(1),               /* PFEFO CONTINUED    SA52971*/ 96900022
*     4 QCBDATSQ CHAR(2),               /* SEQ NUMBER OF LAST MSG       96920022
*                                       REMOVED FROM FEFO Q    S21101*/ 96940022
*    3 QCBINTFF    CHAR(3),             /* DISK REC. NO. OF THE         96960022
*                                       FIRST INTERCEPTED MSG. -        96980022
*                                       FEFO ORDER                   */ 97000022
*    3 QCBINTLF    CHAR(3),             /* DISK REC. NO. OF THE LAST    97020022
*                                       INTERCEPTED MSG. - FEFO      */ 97040022
*     4 QCBPREVF  CHAR(3),              /* PREVIOUS TO LAST             97060022
*                                       FFEFO                 SA52971*/ 97080022
*    3 QCBFFEFO    CHAR(3),             /* DISK REC. NO. OF THE         97100022
*                                       FIRST (FEFO) MSG. TO BE         97120022
*                                       RECVD.                          97140022
*                                       CORE RECORD NO. IF THIS IS      97160022
*                                       A CORE ONLY QUEUE            */ 97180022
*    3 QCBLFEFO    CHAR(3),             /* DISK RECORD NO. OF THE       97200022
*                                       LAST FEFO MSG. RECEIVED         97220022
*                                       CORE REC. NO. IF THIS IS A      97240022
*                                       CORE ONLY QUEUE.             */ 97260022
*    3 QCBCFHDR    CHAR(3),             /* CORE REC. NO. OF THE         97280022
*                                       FIRST HEADER APPEARING IN       97300022
*                                       THIS QUEUE.                  */ 97320022
*    3 QCBPRIPQ    CHAR(1),             /*PRIORITY OF THE PRIORITY      97340022
*                                       LEVEL QCB. THIS WILL BE         97360022
*                                       X'00' IF THIS IS THE LOWEST     97380022
*                                       PRTY LEVEL                   */ 97400022
*    3 QCBPQBCK    PTR(24)  BDY(BYTE);  /* PQCB BACK CHAIN    SA51078*/ 97420000
*/*                                                                  */ 97460022
*/*                                                                  */ 97480022
*/*   DEC                                 HEX                        */ 97500022
*/*      *********************************                           */ 97520022
*/*    0 *         DNHDR         * DATFL *  0                 SA52971*/ 97540022
*/*      *********************************                           */ 97560022
*/*    4 *    (PFEFO)    *     DATSQ     *  4                 SA52971*/ 97580022
*/*      *********************************         ****************  */ 97600022
*/*    8 *(DATSQ)*         INTFF         *  8      *          SA52971*/ 97620022
*/*      *********************************         * PRIORITY QCB *  */ 97640022
*/*   12 *         PREVF         * FFEFO *  C      *          SA52971*/ 97660022
*/*      *********************************         ****************  */ 97680022
*/*   16 *    (FFEFO)    *     LFEFO     * 10                        */ 97700022
*/*      *********************************                           */ 97720022
*/*   20 *(LFEFO)*         CFHDR         * 14                        */ 97740022
*/*      *********************************                           */ 97760022
*/*   24 * PRIPQ *         PQBCK         * 18                 SA51078*/ 97780000
*/*      *********************************                           */ 97800022
*/*                                                                  */ 97820022
*/*                                                                  */ 97840022
*/*                                                                  */ 97880022
*DECLARE                                                                97900022
*  1 IEDNQCB BASED(ADDR(IEDQQCB)-LENGTH(IEDNQCB)),        /* @Y17XAXF*/ 97920000
*   2 QCBCHAIN PTR(31),                 /* ADDR TO CHAIN OF  @Y17XAXF*/ 97929000
*                                       /*   QCB'S WAITING   @Y17XAXF*/ 97938000
*                                       /*   FOR PLCB        @Y17XAXF*/ 97947000
*                                       /*   ALLOCATION      @Y17XAXF*/ 97956000
*   2 QCBSTAT1 CHAR(1),                 /* FLAG BYTE         @Y17XAXF*/ 97965000
*    3 QCBPLCBN BIT(1),                 /*   FIELD HAS PLCB  @Y17XAXF*/ 97974000
*                                       /*     ADDR          @Y17XAXF*/ 97983000
*    3 QCBWAITC BIT(1),                 /*   FIELD HAS WAIT  @Y17XAXF*/ 97992000
*                                       /*     CHAIN ADDR    @Y17XAXF*/ 98001000
*    3 QCBSNDRQ BIT(1),                 /*   A PLCB HAS BEEN @Y17XAXF*/ 98010000
*                                       /*     REQ HAVING    @Y17XAXF*/ 98019000
*                                       /*     SEND & RECV   @Y17XAXF*/ 98028000
*                                       /*     STCB'S IN ITS @Y17XAXF*/ 98037000
*                                       /*     STCB CHAIN    @Y17XAXF*/ 98046000
*    3 QCBRCVRQ BIT(1),                 /*   A PLCB HAS BEEN @Y17XAXF*/ 98055000
*                                       /*     REQ HAVING    @Y17XAXF*/ 98064000
*                                       /*     RECV STCB IN  @Y17XAXF*/ 98073000
*                                       /*     ITS STCB CHN  @Y17XAXF*/ 98082000
*    3 QCBESIG  BIT(1),                 /*   ESIG IS NEEDED  @Y17XAXF*/ 98091000
*    3 QCBNDXRQ BIT(1),                 /*   INDEXED PLCB REQUEST       98092000
*                                                            @Y17XAXF*/ 98093000
*    3 QCBFLUSH BIT(1),                 /*   QUEUE FLUSH IN PROGRESS    98094000
*                                                            @Y17XAXF*/ 98104000
*    3 *        BIT(1),                 /*   RESERVED        @Y17XAXF*/ 98118000
*/*                                                          @Y17XAXF*/ 98127000
*/*      QCBSTAT1 MUST ALWAYS PRECEDE QCBPLCBA               @Y17XAXF*/ 98136000
*/*                                                          @Y17XAXF*/ 98145000
*   2 QCBPLCBA PTR(24) BDY(BYTE),       /* ADDR OF PLCB      @Y17XAXF*/ 98154000
*    3 *        CHAR(1),                /*                   @Y17XAXF*/ 98163000
*    3 QCBTTCIN FIXED(15) BDY(BYTE);    /*   TNT INDEX       @Y17XAXF*/ 98172000
*/*                                                                  */ 98200022
*  DECLARE                                                              98700000
*    QCBLDCB BASED(ADDR(IEDQQCB)+120);  /*LOGTYPE DCB ADDR   @XM05707*/ 99200000
./  ADD  SSI=60790401,NAME=TQCBED
*        %GOTO QCBEPLS ;                                             /* 00900010
         MACRO                                                          01800010
         TQCBED                                                         02700010
.*       CONVERTED TO BILINGUAL ON 11/01/72                      S22024 03600010
*        UPDATED 01/05/73                                        S22024 04500010
.* CHANGE ACTIVITY = AS FOLLOWS:                                        05400010
.*A345000                                                       SA52971 06300010
.*C460000,480000                                                SA52971 07200010
.*C709000-718000,763000                                        @Y17XAXF 08100010
.*A240000                                                      @Y17XAXF 09000010
IEDQQCBE DSECT                                                          09900010
*                                                                       10800010
*              THIS IS A DSECT OF THE QCB EXTENSION.                    11700010
*                                                                       12600010
QCBEFLG  DS    XL1 .                    FLAG BYTE                       13500010
*                        BIT DEFINITIONS                                14400010
QCBESTAT EQU   X'80' .                  STATUS SPEC ON QCNTRL           15300010
QCBECNT  EQU   X'40' .                  INTEGER SPECIFIED               16200010
QCBEOPL  EQU   X'20' .                  PRIORITY LEVEL Q DEFN           17100010
QCBEHELD EQU   X'10' .                  TEMPORARY HOLD                  18000010
QCBESRVC EQU   X'08' .                  INDICATES QCB SERVICED          18900010
QCBEOMSG EQU   X'04' .                  INDICATES OUTMSG PENDING        19800010
QCBEDATA EQU   X'02' .                  INDICATES DATA IN MSG           20700010
QCBEPEND EQU   X'01' .                  QACTION OPERATION PENDING       21600010
*                                                                       22500010
QCBEHDR  DS    0XL3 .                   SCBSCHDR SAVED                  23400010
QCBECONC DS    AL3 .                    ADDRESS OF CONC TERM ENTRY      24300010
QCBEOSEQ DS    0XL2 .                   SCBOSEQ SAVED                   25200010
QCBEDAMT DS    H .                      AMOUNT OF DATA TO TAKE FROM Q   26100010
QCBETCIN DS    H .                      TTCIN OF LAST MSG FROM Q        27000010
QCBELGTH DS    XL1 .                    LENGTH OF ENTRY                 27900010
QCBENPLV DS    FL1 .                    NUMBER OF PRTY LEVELS           28800010
QCBESAVE DS    0CL5 .                   SAVE AREA              @Y17XAXF 29700010
QCBEPRI  DS    0XL1 .                   SCBPRI SAVED                    30600010
QCBEMACR DS    0XL3 .                   SCBMACR SAVED                   31500010
         DS    XL1 .                                                    32400010
QCBEFEFO DS    0XL3 .                   SCBFEFO SAVED                   33300010
         DS    XL2 .                                                    34200010
QCBEEOB  DS    0XL2 .                   SCBEOB SAVED                    35100010
         DS    XL1 .                                                    36000010
QCBEQTYP DS    XL1 .                    SCBQTYPE SAVED                  36900010
*                        BIT DEFINITIONS                                37800010
QCBEMM   EQU   X'01' .                  MIDDLE OF MSG                   38700010
QCBELCB  DS    0AL3 .                   QACTION LCB ADDRESS     SA52971 39600010
QCBEDEOB DS    XL4 .                    SCBDEOB SAVED                   40500010
QCBELRS  DS    XL1 .                    LENGTH OF CTB CHARS - MAX=8     41400010
QCBERS   DS    XL1 .                    START OF CTB CHARS              42300010
*                                                                       43200010
*         *******************************************************       44100010
*     0   *   FLG     **              CONC/HDR                  *       45000010
*         *******************************************************       45900010
*     4   *       DAMT/OSEQ         **           TCIN           *       46800010
*         *******************************************************       47700010
*     8   *   LGTH    **   NPLV     **  MACR/PRI  **  MACR/FEFO *       48600010
*         *******************************************************       49500010
*    12   * MACR/FEFO **   EOB/FEFO **  EOB/QTYPE **  LCB/DEOB  *       50400010
*         *******************************************************       51300010
*    16   *  LCB/DEOB **   LCB/DEOB **    DEOB    **     LRS    *       52200010
*         *******************************************************       53100010
*    20   *     RS    *                                                 54000010
*         *************                                                 54900010
         MEND   , */                                                    55800010
*%QCBEPLS : ;                                                           56700010
*/*      UPDATED 01/05/73                                      S22024*/ 57600010
*DECLARE                                                                58500010
* 1  IEDQQCBE BASED(IEDQEPTR) BDY(WORD),                                59400010
*   2 QCBEFLG    BIT(8),                /* FLAG BYTE                 */ 60300010
*     3 QCBESTAT BIT(1),                /* STATUS SPEC ON QCNTRL     */ 61200010
*     3 QCBECNT  BIT(1),                /* INTEGER SPECIFIED         */ 62100010
*     3 QCBEOPL  BIT(1),                /* PRIORITY LEVEL Q. DEFN    */ 63000010
*     3 QCBEHELD BIT(1),                /* TEMPORARY HOLD            */ 63900010
*     3 QCBESRVC BIT(1),                /* INDICATES QCB SERVICED    */ 64800010
*     3 QCBEOMSG BIT(1),                /* INDICATES OUTMSG PENDING  */ 65700010
*     3 QCBEDATA BIT(1),                /* INDICATES DATA IN MSG     */ 66600010
*     3 QCBEPEND BIT(1),                /* QACTION OPERATION PENDING */ 67500010
*   2 QCBECONC   PTR(24),               /* ADDR OF CONC TRM ENTRY    */ 68400010
*     3 QCBEHDR  CHAR(3),               /* SCBSCHDR SAVED            */ 69300010
*   2 QCBEDAMT   FIXED(15),             /* AMT OF DATA TO TAKE FROM Q*/ 70200010
*     3 QCBEOSEQ CHAR(2),               /* SCBOSEQ SAVED             */ 71100010
*   2 QCBETCIN   FIXED(15),             /* TTCIN OF LAST MSG FROM Q  */ 72000010
*   2 QCBELGTH   PTR(8),                /* LENGTH OF ENTRY           */ 72900010
*   2 QCBENPLV   PTR(8),                /* NUMBER OF PRIORITY LVLS   */ 73800010
*   2 QCBESAVE   CHAR(5) BDY(BYTE),     /* SAVE AREA         @Y17XAXF*/ 74700010
*     3 QCBEMACR   CHAR(3),             /* SCBMACR SAVED     @Y17XAXF*/ 75600010
*     3 QCBEEOB    FIXED(15) BDY(BYTE), /* SCBEOB SAVED      @Y17XAXF*/ 76500010
*   2 QCBEDEOB   CHAR(4),               /* SCBDEOB SAVED             */ 77400010
*     3 QCBELCB  PTR(24) BDY(BYTE),     /* QACTION LCB ADDR   SA52971*/ 78300010
*   2 QCBELRS    PTR(8),                /* LEN OF CTB CHARS - MAX=8  */ 79200010
*   2 QCBERS     (*) CHAR(1);           /* START OF CTB CHARS        */ 80100010
*DECLARE                                                                81000010
* 1  *           BASED(ADDR(QCBESAVE)) BDY(BYTE),          /*@Y17XAXF*/ 81900010
*   2 QCBEPRI    PTR(8),                /* SCBPRI SAVED              */ 82800010
*   2 QCBEFEFO   CHAR(3),               /* SCBFEFO SAVED             */ 83700010
*   2 QCBEQTYP   CHAR(1),               /* SCBQTYPE SAVED            */ 84600010
*     3 *        BIT(7),                                                85500010
*     3 QCBEMM   BIT(1);                /* MIDDLE OF MSG             */ 86400010
*/*                                                                  */ 87300010
*/*       ********************************************************   */ 88200010
*/*   0   *   FLG     **              CONC/HDR                       */ 89100010
*/*       ********************************************************   */ 90000010
*/*   4   *       DAMT/OSEQ         **            TCIN           *   */ 90900010
*/*       ********************************************************   */ 91800010
*/*   8   *   LGTH    **   NPLV     **  MACR/PRI   **  MACR/FEFO *   */ 92700010
*/*       ********************************************************   */ 93600010
*/*  12   * MACR/FEFO **   EOB/FEFO **  EOB/QTYPE  **  LCB/DEOB  *   */ 94500010
*/*       ********************************************************   */ 95400010
*/*  16   *  LCB/DEOB **   LCB/DEOB **     DEOB    **     LRS    *   */ 96300010
*/*      *********************************************************   */ 97200010
*/*  20  *      RS   *                                               */ 98100010
*/*      *************                                               */ 99000010
*/*                                                                  */ 99900010
./  ADD  SSI=62470491,NAME=TRDYD
*        %GOTO PLSRDY;                  /*                              02000010
         MACRO                                                          04000010
         TRDYD                                                          06000010
.*A000000-999999                                               @Y17XAXF 08000010
*                                                                       10000010
*        FORMAT OF READY MACRO GENERATION                               12000010
*                                                                       14000010
IEDRDY   DSECT                                                          16000010
RDYGMMA  DS    A                        GOOD MORNING MESSAGE            18000010
*                                        ROUTINE ADDRESS                20000010
RDYRSMA  DS    A                        RESTART MESSAGE                 22000010
*                                        ROUTINE ADDRESS                24000010
RDYPURGA DS    A                        PURGE EXIT ROUTINE              26000010
*                                        ADDRESS                        28000010
RDYPRIA  DS    A                        PRIORITY EXIT ROUTINE           30000010
*                                        ADDRESS                        32000010
RDYFLAGS DS    XL1                      FLAG BYTE                       34000010
RDYOPEND EQU   X'80'                     OPENCHK=OPEN SPECIFIED         36000010
RDYOPENI EQU   X'40'                     OPENCHK=IDLE SPECIFIED         38000010
*        EQU   X'20'-X'01'               RESERVED                       40000010
         DS    XL3                      RESERVED                        42000010
         MEND  */                                                       44000010
*%PLSRDY : ;                                                            46000010
*/*                                                                  */ 48000010
*/*      FORMAT OF READY MACRO GENERATION                            */ 50000010
*/*                                                                  */ 52000010
* DECLARE                                                               54000010
* 1 IEDRDY BASED(AVTRDYA),                                              56000010
*  2 RDYGMMA  PTR(31),                  /* GOOD MORNING MESSAGE         58000010
*                                          ROUTINE ADDRESS           */ 60000010
*  2 RDYRSMA  PTR(31),                  /* RESTART MESSAGE              62000010
*                                          ROUTINE ADDRESS           */ 64000010
*  2 RDYPURGA PTR(31),                  /* PURGE EXIT ROUTINE           66000010
*                                          ADDRESS                   */ 68000010
*  2 RDYPRIA  PTR(31),                  /* PIORITY EXIT ROUTINE         70000010
*                                          ADDRESS                   */ 72000010
*  2 RDYFLAGS BIT(8),                   /* FLAG BYTE                 */ 74000010
*   3 RDYOPEND BIT(1),                  /*  OPENCHK=OPEN SPECIFIED   */ 76000010
*   3 RDYOPENI BIT(1),                  /*  OPENCHK=IDLE SPECIFIED   */ 78000010
*   3 *        BIT(6),                  /*  RESERVED                 */ 80000010
*  2 *       CHAR(3);                   /* RESERVED                 */  82000010
./  ADD  SSI=61260119,NAME=TRECBD
*        %GOTO PLSRECB;                 /* BILINGUAL HEADER             03000010
         MACRO                                                          08000020
         TRECBD                                                         16000020
IEDQRECB DSECT .                        RESOURCE ELEMENT CNTRL BLOCK    24000020
*                                                                       32000020
*                                                 DISPLACEMENT          40000020
*                                                                       48000020
RECBKEY  DS    FL1 .                    KEY FIELD      0                56000020
RECBQCBA DS    3X .                     QCB ADDRESS   +1                64000020
RECBPRI  DS    FL1 .                    PRIORITY      +4                72000020
RECBLINK DS    3X .                     LINK FIELD    +5                80000020
         MEND  */                                                       88000010
*%PLSRECB:;                                                             89000010
* DECLARE                                                               90000010
*  1 IEDQRECB BASED BDY(WORD),          /*RESOURCE ELEMENT CNTRL BLK */ 91000010
*/*                                                                  */ 92000010
*/*                                               DISPLACEMENT       */ 93000010
*/*                                                                  */ 94000010
*    2 RECBKEY  PTR(8),                 /* KEY FIELD      0          */ 95000010
*    2 RECBQCBA PTR(24),                /* QCB ADDRESS   +1          */ 96000010
*    2 RECBPRI  PTR(8),                 /* PRIORITY      +4          */ 97000010
*    2 RECBLINK PTR(24);                /* LINK FIELD    +5          */ 98000010
./  ADD  SSI=63070660,NAME=TREQD
*        %GOTO PLSREQ;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TREQD                                                          03000010
         SPACE                                                          04000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          05000010
.*A-000000999999                                               @Y17XAXU 06000010
.*A440000,770000,870000                                        @Y17XAXF 06500010
         SPACE                                                          07000010
IEDREQD  DSECT                                                          08000010
*                                                                       09000010
*        GENERAL REQUEST ELEMENT                                        10000010
*                                                                       11000010
REQTYPE DS     XL1 .                    REQUEST TYPE                    12000010
REQLTRM  EQU   X'01' .                    TERMINATE SESSION REQUEST     13000010
*                                         (TO LUS FROM OP SERVICES      14000010
*                                         OR TOTE)                      15000010
REQLSHTD EQU   X'02' .                    SEND SHUTDOWN & TERMINATE     16000010
*                                         SESSION (TO LUS FROM OP       17000010
*                                         SERVICES)                     18000010
REQSGET EQU    X'03' .                    GET SIB REQUEST               19000010
REQSFREE EQU   X'04' .                    FREE SIB REQUEST              20000010
REQQCBA  DS    AL3 .                    QCB ADDRESS                     21000010
REQPRI   DS    XL1 .                    PRIORITY                        22000010
REQLINK  DS    XL3 .                    LINK ADDRESS                    23000010
REQRPRI  DS    XL1 .                    PRIOITY FOR RETURN TPOST        24000010
REQRQCBA DS    AL3 .                    QCB ADDRESS FOR  RETURN TPOST   25000010
REQROUTE DS    0XL2 .                   ROUTING FOR RETURN TPOST        26000010
REQFLAG  DS    XL1 .                    FLAG BYTE                       27000010
REQSWTCH DS    XL1 .                    SWITCH BYTE                     28000010
REQRCDS  DS    0XL2 .                   RETURN CODES                    29000010
REQRCD1  DS    XL1 .                    RETURN CODE 1                   30000010
REQRCD2  DS    XL1 .                    RETURN CODE 2                   31000010
REQDATA  DS    0CL1 .                   DATA - FORMAT DEPENDENT         32000010
* DATA DEFINITION FOR LUS REQUESTS (REQLTRM & REQLSHTD)                 33000010
REQLDATA EQU   REQDATA .                                                34000010
REQLTNT  EQU   REQDATA .                TNT OFFSET FOR LU               35000010
* DATA DEFINITION FOR SIB REQUESTS (REQSGET & REQSFREE)                 36000010
REQSDATA EQU   REQDATA .                                                37000010
REQSTTE  EQU   REQDATA .                ADDRESS OF TTE FOR RESOURCE     38000010
*                                       WHOSE SIB CHAIN WILL BE CHANGED 39000010
REQSTNT  EQU   REQDATA+4 .              TNT OFFSET OR MH INDEX USED     40000010
*                                       IN SIB TO IDENTIFY WHO THE      41000010
*                                       RESOURCE IS IN SESSION WITH     42000010
*                                       (TCAM,AN MH, SSCP, ETC., ETC.)  43000010
*                                       ON REQUEST TYPE                 44000010
REQLLEN  EQU   22 .                     LEN OF INTERTASK REQ   @Y17XAXF 44200010
*                                        ELEMENT FOR LUS REQ   @Y17XAXF 44400010
REQSLEN  EQU   26 .                     LEN OF INTERTASK REQ   @Y17XAXF 44600010
*                                        ELEMENT FOR SIB REQ   @Y17XAXF 44800010
REQTOTCL EQU   X'FE' .                  RQST FOR TOTE CLEANUP  @Y17XAXF 44900010
REQLEN   EQU   *-IEDREQD .              REQ LENGTH                      45000010
         MEND                                                           46000010
*        */                                                             47000010
*%PLSREQ : ;                                                            48000010
*DCL 1 IEDREQD  BASED,              /* GENERAL REQUEST ELEMENT       */ 49000010
*      2 REQTYPE  CHAR(1),          /* REQUEST TYPE                  */ 50000010
*      2 REQQCBA  PTR(24),          /* QCB ADDRESS                   */ 51000010
*      2 REQPRI   CHAR(1),          /* PRIORITY                      */ 52000010
*      2 REQLINK  PTR(24),          /* LINK ADDRESS                  */ 53000010
*      2 REQRPRI  CHAR(1),          /* PRIORITY FOR RETURN TPOST     */ 54000010
*      2 REQRQCBA PTR(24),          /* QCB ADDR FOR RETURN TPOST     */ 55000010
*      2 REQROUTE CHAR(2),          /* ROUTINE FOR RETURN TPOST      */ 56000010
*        3 REQFLAG  CHAR(1),        /* FLAG BYTE                     */ 57000010
*        3 REQSWTCH CHAR(1),        /* SWITCH BYTE                   */ 58000010
*      2 REQRCDS  CHAR(2),          /* RETURN CODES                  */ 59000010
*        3 REQRCD1  CHAR(1),        /* RETURN CODE 1                 */ 60000010
*        3 REQRCD2  CHAR(1),        /* RETURN CODE 2                 */ 61000010
*      2 REQDATA  CHAR(*);          /* DATA (FORMAT DEPENDENT ON        62000010
*                                      REQUEST TYPE)                 */ 63000010
* %REQLEN='LENGTH(IEDREQD';         /* REQ LENGTH                    */ 64000010
*/* REQUEST-TYPE DEFINITIONS (VALUES FOR REQTYPE FIELD)              */ 65000010
*DCL REQLTRM BIT(8) CONSTANT('01'X); /* TERMINATE-SESSION REQUEST       66000010
*                                      (TO LUS FROM OP  ERVICES OR      67000010
*                                      TOTE)                         */ 68000010
*DCL REQLSHTD BIT(8) CONSTANT('02'X); /* SEND SHUTDOWN & TERMINATE      69000010
*                                      SESSION (TO LUS FROM OP          70000010
*                                      SERVICES)                     */ 71000010
*DCL REQSGET  BIT(8) CONSTANT('03'X); /* GET SIB REQUEST (FROM SSCP) */ 72000010
*DCL REQSFREE BIT(8) CONSTANT('04'X); /* FREE SIB REQST  (FROM SSCP) */ 73000010
*/*                                                                  */ 74000010
*/* DATA DEFINITION FOR LUS REQUESTS (REQLTRM & REQLSHTD)            */ 75000010
*DCL 1 REQLDATA  DEF(REQDATA),                                          76000010
*      2 REQLTNT  CHAR(2);          /* TNT OFFSET FOR LU             */ 77000010
*DCL REQLLEN  FIXED(8) CONSTANT(22);/* LEN OF INTERTASK REQ  @Y17XAXF*/ 77300010
*                                   /* ELEMENT FOR LUS REQ   @Y17XAXF*/ 77600010
*/*                                                                  */ 78000010
*/* DATA DEFINITION FORSIB REQUESTS (REQSGET & REQSFREE)             */ 79000010
*DCL 1 REQSDATA  DEF(REQDATA),                                          80000010
*      2 REQSTTE  PTR(31),          /* ADDRESS OF TERMINAL TABLE ENTRY  81000010
*                                      FOR RESOURCE WHOSE SIB CHAIN     82000010
*                                      WILL BE CHANGED               */ 83000010
*      2 REQSTNT  CHAR(2);          /* TNT OFFSET OR MH INDEX USED      84000010
*                                      IN SIB TO IDENTIFY WHO THE       85000010
*                                      RESOURCE IS IN SESSION WITH      86000010
*                                      (TCAM, AN MH, THE SSCP, ETC)  */ 87000010
*DCL REQSLEN  FIXED(8) CONSTANT(26);/* LEN OF INTERTASK REQ  @Y17XAXF*/ 90000010
*                                   /* ELEMENT FOR SIB REQ   @Y17XAXF*/ 93000010
*DCL REQTOTCL BIT(8) CONSTANT('FE'X);/* RQST FOR TOTE CLEANUP @Y17XAXF*/96000010
./  ADD  SSI=60790047,NAME=TRHD
*        %GOTO RHPLS;              /* BILINGUAL HEADER                  01000010
         MACRO                                                          02000010
         TRHD                                                           03000010
.*A000000-999999                             @Y17XAXF                   04000010
IEDRH    DSECT                                                          05000010
.RH002   ANOP                                                           06000010
*                                                                       07000010
*        DSECT FOR SNA RH                                               08000010
*                                                                       09000010
TRHBYTE0 DS    CL1 .               BYTE 0 OF RH                         10000010
TRHTYPE  EQU   X'80' .                  ON-RSP, OFF-REQ                 11000010
* TRHRUCAT     2 BITS                   RU CATEGORY                     12000010
TRHFMD   EQU   X'00' .                       FM DATA                    13000010
TRHNC    EQU   X'20' .                       NETWORK CONTROL            14000010
TRHDFC   EQU   X'40' .                       DATA FLOW CONTROL          15000010
TRHSC    EQU   X'60' .                       SESSION CONTROL            16000010
*        EQU   X'10' .                  RESERVED                        17000010
TRHFI    EQU   X'08' .                  FORMAT INDICATOR                18000010
TRHSDI   EQU   X'04' .                  SENSE DATA INCLUDED             19000010
TRHBC    EQU   X'02' .                  BEGIN CHAIN                     20000010
TRHEC    EQU   X'01' .                  END CHAIN                       21000010
TRHBYTE1 DS    CL1 .               BYTE 1 OF RH                         22000010
TRHDR1   EQU   X'80' .                  DEFINITE RESPONSE 1             23000010
*        EQU   X'40' .                  RESERVED                        24000010
TRHDR2   EQU   X'20' .                  DEFINITE RESPONSE 2             25000010
TRHER    EQU   X'10' .                  EXCEPTION RESPONSE              26000010
*        EQU   X'08' .                  RESERVED                        27000010
*        EQU   X'04' .                  RESERVED                        28000010
*        EQU   X'02' .                  RESERVED                        29000010
TRHPI    EQU   X'01' .                  PACING INDICATOR                30000010
TRHBYTE2 DS    CL1 .               BYTE 2 OF RH                         31000010
TRHBB    EQU   X'80' .                  BEGIN BRACKET                   32000010
TRHEB    EQU   X'40' .                  END BRACKET                     33000010
TRHCDI   EQU   X'20' .                  CHANGE DIRECTION INDICATOR      34000010
*        EQU   X'10' .                  RESERVED                        35000010
TRHCSI   EQU   X'08' .                  CODE SELECTION INDICATOR        36000010
*        EQU   X'04' .                  RESERVED                        37000010
*        EQU   X'02' .                  RESERVED                        38000010
*        EQU   X'01' .                  RESERVED                        39000010
TRH1LEN  EQU   *-IEDRH .           LENGTH OF FID1 RH                    40000010
         MEND                                                           41000010
*        */                                                             42000010
*%RHPLS:;                                                               43000010
*DECLARE                                                                44000010
*  1 IEDRH  BASED BDY(BYTE),                                            45000010
*/*                                                                  */ 46000010
*/*      DSECT FOR SNA RH                                            */ 47000010
*/*                                                                  */ 48000010
*      2 TRHBYTE0 CHAR(1),              /* BYTE 0 OF RH              */ 49000010
*        3 TRHTYPE  BIT(1),             /*   ON-RSP, OFF-REQ         */ 50000010
*        3 TRHRUCAT BIT(2),             /*   RU CATEGORY             */ 51000010
*        3 *        BIT(1),             /*   RESERVED                */ 52000010
*        3 TRHFI    BIT(1),             /*   FORMAT INDICATOR        */ 53000010
*        3 TRHSDI   BIT(1),             /*   SENSE DATA INCLUDED     */ 54000010
*        3 TRHBC    BIT(1),             /*   BEGIN CHAIN             */ 55000010
*        3 TRHEC    BIT(1),             /*   END CHAIN               */ 56000010
*      2 TRHBYTE1 CHAR(1),              /*  BYTE 1 OF RH             */ 57000010
*        3 TRHDR1   BIT(1),             /*   DEFINITE RESPONSE 1     */ 58000010
*        3 *        BIT(1),             /*   RESERVED                */ 59000010
*        3 TRHDR2   BIT(1),             /*   DEFINITE RESPONSE 2     */ 60000010
*        3 TRHER    BIT(1),             /*   EXCEPTION RESPONSE      */ 61000010
*        3 *        BIT(1),             /*   RESERVED                */ 62000010
*        3 *        BIT(1),             /*   RESERVED                */ 63000010
*        3 *        BIT(1),             /*   RESERVED                */ 64000010
*        3 TRHPI    BIT(1),             /*   PACING INDICATOR        */ 65000010
*      2 TRHBYTE2 CHAR(1),              /* BYTE 2 OF RH              */ 66000010
*        3 TRHBB    BIT(1),             /*   BEGIN BRACKET           */ 67000010
*        3 TRHEB    BIT(1),             /*   END BRACKET             */ 68000010
*        3 TRHCDI   BIT(1),             /*   CHANGE DIRECTION IND    */ 69000010
*        3 *        BIT(1),             /*   RESERVED                */ 70000010
*        3 TRHCSI   BIT(1),             /*   CODE SELECTION IND      */ 71000010
*        3 *        BIT(1),             /*   RESERVED                */ 72000010
*        3 *        BIT(1),             /*   RESERVED                */ 73000010
*        3 *        BIT(1);             /*   RESERVED                */ 74000010
* %TRH1LEN='LENGTH(IEDRH)';             /* LEN OF FID1 RH            */ 75000010
*/* TRHRUCAT VALUES                                                  */ 76000010
* DCL TRHFMD  BIT(2) CONSTANT('00'B);   /*   FM DATA                 */ 77000010
* DCL TRHNC   BIT(2) CONSTANT('01'B);   /*   NETWORK CONTROL         */ 78000010
* DCL TRHDFC  BIT(2) CONSTANT('10'B);   /*   DATA FLOW CONTROL       */ 79000010
* DCL TRHSC   BIT(2) CONSTANT('11'B);   /*   SESSION CONTROL         */ 80000010
*/* RH CONSTANTS                                                     */ 81000010
* DCL TRHFID0  BIT(24) CONSTANT('0B8000'X);                             82000010
./  ADD  SSI=62430489,NAME=TRQED
*        %GOTO PLSRQE;                  /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TRQED                                                          09000010
.*A000000,999999                                               @Y17XAXF 12000010
*                                                                       15000010
*        ASSEMBLER VERSION NOT SUPPORTED                                18000010
*                                                                       21000010
         MEND  */                                                       24000010
*%PLSRQE:;                                                              27000010
*/*                                                                  */ 30000010
*/*      RQE PREFIX DSECT                                            */ 33000010
*/*                                                                  */ 36000010
* DECLARE                                                               39000010
* 1 IEDRQE BASED(RRQE),                                                 42000010
*  2 RQELNK   PTR(16),                  /* ADDR OF NEXT RQE          */ 45000010
*  2 RQEUCB   PTR(16),                  /* ADDRESS OF UCB            */ 48000010
*  2 RQETCB   FIXED(8),                 /* TASK ID                   */ 51000010
*  2 RQEIOB   PTR(24),                  /* ADDRESS OF IOB            */ 54000010
*  2 RQEPR    FIXED(8),                 /* PRIORITY                  */ 57000010
*  2 RQEDEB   PTR(24),                  /* ADDRESS OF DEB            */ 60000010
*  2 RQEKEY   FIXED(8),                 /* REQUESTER'S PROTECTION KEY*/ 63000010
*  2 RQETCBAD PTR(24),                  /* ADDRESS OF TCB            */ 66000010
*  2 RQEHDR   PTR(31);                  /* CCW TRANSLATION FLAGS AND    69000010
*                                          HEADER ADDRESS            */ 72000010
./  ADD  SSI=61270328,NAME=TRRTD
*        %GOTO BSLRRT;                                               /* 01000010
         MACRO                                                          02000010
         TRRTD                                                          03000010
         SPACE                                                          04000010
*        VERSION DATED 08/31/72                                         05000010
.*C150000-160000,200000,250000,300000,340000-350000,420000     @Y17XAXF 05200010
.*C580000,670000,760000,840000,770000                          @Y17XAXF 05400010
.*A420000,810000,840000                                        @Y17XAXF 05600010
         SPACE                                                          06000010
IEDNRRTD DSECT                                                          07000010
RRTHDRLN DS    H .                      LENGTH OF HEADER DATA           08000010
RRTKEYLN DS    H .                      HOST UNIT SIZE                  09000010
RRTUNITN DS    XL1 .                    NUMBER OF UNITS IN HOST BUFFER  10000010
RRTUNITR DS    XL1 .                    NUMBER OF 3705 UNITS INITIALLY  11000010
*                                        ALLOCATED FOR DATA TRANSFER    12000010
*                                        FROM THE HOST                  13000010
RRTKEYLR DS    XL1 .                    3705 UNIT SIZE                  14000010
RRTBUFPD DS    XL1 .                    BUFFER PAD SIZE        @Y17XAXF 15000010
RRTXTPD  DS    XL1 .                    ALWAYS EQUAL TO ZERO   @Y17XAXF 16000010
RRTNODEL DS    XL1 .                    SYSTEM NODE LENGTH              17000010
         SPACE 3                                                        19000010
IEDNRTRM DSECT                          START OF 1ST RRT ENTRY @Y17XAXF 20000010
*  NOTE - TO DETERMINE ACTUAL BEGINNING POINT, ADD RRTHDRLN TO ADDRESS  21000010
*         OF RESOURCE RESOLUTION TABLE                                  22000010
RRTERMNM DS    CL8 .                    NAME OF RESOURCE                23000010
RRTRSID  DS    AL2 .                    RESOURCE ID                     24000010
RRTRMTP1 DS    XL1 .                    TYPE OF RESOURCE-BYTE 1@Y17XAXF 25000010
         SPACE                                                          26000010
RRTLINE  EQU   X'80'                    RESOURCE IS A LINE              27000010
RRTDEVCE EQU   X'40'                    RESOURCE IS A CLUSTER, TERMINAL 28000010
*                                        OR COMPONENT                   29000010
RRTPU    EQU   X'20'                    ON-PU TYPE 1 OR 2      @Y17XAXF 30000010
*                                       OFF-PU TYPE 4          @Y17XAXF 31000010
RRTINPUT EQU   X'10'                    DEVICE IS CAPABLE OF INPUT      32000010
RRTOUTPT EQU   X'08'                    DEVICE IS CAPABLE OF OUTPUT     33000010
*                                        OR IS LU              @Y17XAXF 34000010
RRTSWTCH EQU   X'04'                    SWITCHED               @Y17XAXF 35000010
RRTAUTOC EQU   X'02'                    3705 CAN CALL THE DEVICE        36000010
RRTDVTYD EQU   X'01'                    DEVICE TYPE DEPENDENT -         37000010
*                                        2980 WITH ALTERNATE ADDRESSING 38000010
* SECOND TERMINAL TYPE BIT ASSIGNMENTS                                  39000010
RRTRMTP2 DS    XL1 .                    TYPE OF RESOURCE-BYTE2 @Y17XAXF 39500010
RRTCLSTR EQU   X'80'                    DEVICE IS A CLUSTER             40000010
RRTCTERM EQU   X'40'                    LOGICAL CONNECTION DEVICE       41000010
RRTSNA   EQU   X'20' .                  SNA RESOURCE           @Y17XAXF 42000010
RRTGPTRM EQU   X'08' .                  DEVICE ON GP CLUSTER   @Y17XAXF 42500010
*  BITS 3,5-7 RESERVED                                                  43000010
         MEND  , */                                                     44000010
*%BSLRRT:    ;                                                          45000010
*DECLARE                                                                46000010
*  1 IEDNRRT  BDY(WORD) BASED(IEDNRPTR), /*RESOURCE RESOLUTION TABLE */ 47000010
*   2 RRTHDRLN    FIXED(15),            /* LENGTH OF HEADER DATA     */ 48000010
*   2 RRTKEYLN    FIXED(15),            /* HOST UNIT SIZE            */ 49000010
*   2 RRTUNITN    PTR(8),               /* NUMBER OF UNITS IN HOST      50000010
*                                          BUFFER                    */ 51000010
*   2 RRTUNITR    PTR(8),               /* NUMBER OF 3705 UNITS         52000010
*                                          INITIALLY ALLOCATED FOR      53000010
*                                          DATA TRANSFER FROM THE       54000010
*                                          HOST                      */ 55000010
*   2 RRTKEYLR    PTR(8),               /* 3705 UNIT SIZE            */ 56000010
*   2 RRTBUFPD    PTR(8),               /* BUFFER PAD SIZE           */ 57000010
*   2 RRTXTPD     PTR(8),               /* ALWAYS = 0        @Y17XAXF*/ 58000010
*   2 RRTNODEL    PTR(8);               /* SYSTEM NODE LENGTH        */ 60000010
*                                                                       62000010
*DECLARE                                                                63000010
*  1 IEDNRTRM BDY(BYTE) BASED(IEDNRPTR + LENGTH(IEDNRRT)),              64000010
*   2 RRTERMNM    CHAR(8),              /* NAME OF RESOURCE          */ 65000010
*   2 RRTRSID     PTR(16),              /* RESOURCE ID               */ 66000010
*   2 RRTRMTP1    BIT(8),               /* TYPE OF RESOURCE-BYTE1    */ 67000010
*                                       /*                   @Y17XAXF*/ 67500010
*                                                                       68000010
*    3 RRTLINE     BIT(1),              /* RESOURCE IS A LINE        */ 69000010
*    3 RRTDEVCE    BIT(1),              /* RESOURCE IS A CLUSTER,       70000010
*                                          TERMINAL, OR COMPONENT    */ 71000010
*    3 RRTPU       BIT(1),              /* ON-PU TYPE 1 OR 2            72000010
*                                          OFF-PU TYPE 4     @Y17XAXF*/ 73000010
*    3 RRTINPUT    BIT(1),              /* DEVICE IS CAPABLE OF INPUT*/ 74000010
*    3 RRTOUTPT    BIT(1),              /* DEVICE IS CAPABLE OF         75000010
*                                          OUTPUT, OR IS LU  @Y17XAXF*/ 76000010
*    3 RRTSWTCH    BIT(1),              /* SWITCHED          @Y17XAXF*/ 77000010
*    3 RRTAUTOC    BIT(1),              /* 3705 CAN CALL THE DEVICE  */ 78000010
*    3 RRTDVTYD    BIT(1),              /* DEVICE TYPE DEPENDENT-       79000010
*                                          2980 WITH ALTERNATE          80000010
*                                          ADDRESSING                */ 81000010
*   2 RRTRMTP2  BIT(8),                 /* TYPE OF RESOURCE-BYTE2    */ 81300010
*                                       /*                   @Y17XAXF*/ 81600010
*    3 RRTCLSTR    BIT(1),              /* DEVICE IS A CLUSTER       */ 82000010
*    3 RRTCTERM    BIT(1),              /* LOGICAL CONNECTION DEVICE */ 83000010
*    3 RRTSNA      BIT(1),              /* SNA RESOURCE      @Y17XAXF*/ 84000010
*    3 *           BIT(1),              /* RESERVED          @Y17XAXF*/ 84200010
*    3 RRTGPTRM    BIT(1),              /* DEVICE ON GP CLUS @Y17XAXF*/ 84400010
*    3 *           BIT(3);              /* RESERVED          @Y17XAXF*/ 84600010
./  ADD  SSI=62040025,NAME=TRSPD
*        %GOTO RSPPLS;            /* BILINGUAL HEADER                   00300010
         MACRO                                                          00600010
         TRSPD                                                          00900010
.*A000000-999999                                               @Y17XAXF 01200010
*                                                                       01500010
*        FID0 PHASE 0 ERROR RESPONSES                                   01800010
*                                                                       02100010
RSP0E01  EQU   X'01' .                  INVALID RESOURCE ID             02400010
RSP0E02  EQU   X'02' .                  INVALID COMMAND                 02700010
RSP0E03  EQU   X'03' .                  INVALID MODIFIER                03000010
RSP0E04  EQU   X'04' .                  RESET OR DEACTIVATE IN PROGRESS 03300010
RSP0E05  EQU   X'05' .                  DEVICE INACTIVE                 03600010
RSP0E06  EQU   X'06' .                  LINE INACTIVE                   03900010
RSP0E07  EQU   X'07' .                  COMMAND NOT VALID FOR RESOURCE  04200010
RSP0E08  EQU   X'08' .                  COMMAND SYNTAX ERROR            04500010
RSP0E09  EQU   X'09' .                  COMMAND REJECTED                04800010
RSP0E0A  EQU   X'0A' .                  INVALID CONTROL DATA LENGTH     05100010
RSP0E0B  EQU   X'0B' .                  RESET NOT PERFORMED             05400010
RSP0E0C  EQU   X'0C' .                  DATA NOT RESIDENT IN STORAGE    05700010
RSP0E0D  EQU   X'0D' .                  DATA SET QUEUE LIMIT REACHED    06000010
RSP0E0E  EQU   X'0E' .                  LINE AND DEVICE INCOMPATIBILTY  06300010
*                                         ON SWITCHED CALL-OUT          06600010
RSP0E0F  EQU   X'0F' .                  INVALID TEXT LENGTH             06900010
RSP0E11  EQU   X'11' .                  INVALID CONTROL DATA            07200010
RSP0E12  EQU   X'12' .                  INCOMPLETE BTU                  07500010
RSP0E13  EQU   X'13' .                  DEACTIVATE LINE ORDERLY OR      07800010
*                                         DEACTIVATE DEVICE COMMAND     08100010
*                                         REJECTED BECAUSE OF ERROR     08400010
*                                         ON ONE OR MORE OF THE         08700010
*                                         DEVICES                       09000010
RSP0E14  EQU   X'14' .                  DATA IN USE                     09300010
RSP0E15  EQU   X'15' .                  INVALID CONTROL COMMAND         09600010
*                                         MODIFIER OR CONTROL COMMAND   09900010
*                                         NOT VALID FOR RESOURCE        10200010
RSP0E16  EQU   X'16' .                  OLTT COMMAND REJECTED,          10500010
*                                         QUEUE NO EMPTY                10800010
RSP0E17  EQU   X'17' .                  OLT ACTIVE. NON-OLT COMMAND     11100010
*                                         REJECTED                      11400010
RSP0E18  EQU   X'18' .                  MULTIPLE DIAL REQUESTS          11700010
RSP0E19  EQU   X'19' .                  MODE INCONSISTENCY              12000010
RSP0E1A  EQU   X'1A' .                  BUFFERS REQUIRED TO COMPLETE    12300010
*                                         THE OPERATION ARE NOT         12600010
*                                         AVAILABLE, SYSTEM IN          12900010
*                                         SLOWDOWN MODE                 13200010
RSP0E1B  EQU   X'1B' .                  COMMAND REJECT,SYSTEM IN        13500010
*                                         AUTO NETWORK SHUTDOWN         13800010
RSP0E1C  EQU   X'1C' .                  COMMAND REJECTED, ERROR         14100010
*                                         LOCK SET                      14400010
RSP0E1D  EQU   X'1D' .                  COMMAND REJECTED, SECONDARY     14700010
*                                         CHANNEL ADAPTER NOT           15000010
*                                         OPERATIVE                     15300010
RSP0E1E  EQU   X'1E' .                  COMMAND REJECTED, LINE          15600010
*                                         DEACTIVATED OR COMMAND        15900010
*                                         RESET                         16200010
         EJECT                                                          16500010
*                                                                       16800010
*        FID0 PHASE 0 UNSOLICITED RESPONSES                             17100010
*                                                                       17400010
RSPUNS00 EQU   X'00' .                  INVALID BIT CONFIGURATION       17700010
RSPUNS01 EQU   X'01' .                  ATTENTION TIME-OUT OR           18000010
*                                         UNRECOVERABLE ERROR ON        18300010
*                                         CURRENT PRIMARY CHANNEL       18600010
*                                         ADAPTER                       18900010
RSPUNS03 EQU   X'03' .                  DEVICE ASSOCATION COMPLETED     19200010
RSPUNS04 EQU   X'04' .                  MTA DEVICE IDENTIFIED           19500010
RSPUNS05 EQU   X'05' .                  CHANNEL ADAPTER SET TO          19800010
*                                         PRIMARY MODE                  20100010
RSPUNS06 EQU   X'06' .                  CHANNEL ADAPTER SET TO          20400010
*                                         SECONDARY MODE                20700010
RSPUNS07 EQU   X'07' .                  ENTERING SYSTEM SLOWDOWN        21000010
RSPUNS08 EQU   X'08' .                  LEAVING SYSTEM SLOWDOWN         21300010
RSPUNS09 EQU   X'09' .                  INITIALIZATION COMPLETE         21600010
RSPUNS0A EQU   X'0A' .                  MDR RECORDS ACCOMPANY THE BTU   21900010
RSPUNS1B EQU   X'1B' .                  AUTO NETWORK SHUTDOWN INITIATED 22200010
*                                         VIA CHANNEL TIME-OUT OR       22500010
*                                         CHANNEL ADAPTER FAILURE       22800010
RSPUNS1C EQU   X'1C' .                  AUTO NETWORK SHUTDOWN INITIATED 23100010
*                                         VIA PANEL                     23400010
RSPUNS1D EQU   X'1D' .                  NETWORK SHUT DOWN VIA AUTO      23700010
*                                         NETWORK SHUTDOWN              24000010
RSPUNS1E EQU   X'1E' .                  SERVICEABILITY AID-HOST LOGGING 24300010
         SPACE                                                          24600010
*                                                                       24900010
*        RESPONSE ERROR INDICATOR                                       25200010
*                                                                       25500010
RSPERR   EQU   X'80' .                  ERROR RESPONSE IND              25800010
         SPACE                                                          26100010
*                                                                       26400010
*        PHASE VALUES                                                   26700010
*                                                                       27000010
RSP00    EQU   X'00' .                  PHASE 0 IND                     27300010
RSP20    EQU   X'20'                    PHASE 1 IND                     27600010
RSP40    EQU   X'40'                    PHASE 2 IND                     27900010
RSP60    EQU   X'60'                    PHASE 3 IND                     28200010
         SPACE                                                          28500010
*                                                                       28800010
*        PHASE 1,2, AND 3 ERROR RESPONSES                               29100010
*                                                                       29400010
RSPE00   EQU   X'00' .                  DATA CHECK                      29700010
RSPE01   EQU   X'01' .                  POSSIBLE INTERVENTION REQUIED   30000010
RSPE02   EQU   X'02' .                  INTERVENTION REQUIRED           30300010
RSPE03   EQU   X'03' .                  NEGATIVE POLL LIMIT REACHED     30600010
RSPE04   EQU   X'04' .                  YIELDED TO CONTENTION           30900010
RSPE05   EQU   X'05' .                  DEVICE ERROR-BSC STATUS PENDING 31200010
RSPE06   EQU   X'06' .                  BSC ID ERROR                    31500010
RSPE07   EQU   X'07' .                  LINE TRACE TERMINATED DUE TO    31800010
*                                         ERROR                         32100010
RSPE08   EQU   X'08' .                  OLTT COMMAND OR RESET OLTT      32400010
*                                         CONTROL COMMAND PORCESSING    32700010
*                                         TERMINATED                    33000010
RSPE09   EQU   X'09' .                  SESSION NOT STARTED DUE TO      33300010
*                                         HARDWARE ERROR                33600010
RSPE0A   EQU   X'0A' .                  BSC ERROR STATUS MESSAGE        33900010
RSPE0B   EQU   X'0B' .                  GENERAL POLL OPERATION          34200010
*                                         ABORTED DUE TO ERROR          34500010
RSPE0C   EQU   X'0C' .                  FANOUT BACKUP LIMIT EXCEEDED    34800010
RSPE13   EQU   X'13' .                  BREAK RECEIVED ON THIS BLOCK    35100010
RSPE18   EQU   X'18' .                  CONTACT REJECTED-SESSION        35400010
*                                         STARTED                       35700010
RSPE19   EQU   X'19' .                  DIAL DATA INCONSISTENCY         36000010
RSPE1A   EQU   X'1A' .                  BUFFERS REQUIRED TO COMPLETE    36300010
*                                         OPERATION ARE NOT             36600010
*                                         AVAILABLE                     36900010
RSPE1E   EQU   X'1E' .                  COMMAND REJECTED, LINE          37200010
*                                         DEACTIVATED OR COMMAND        37500010
*                                         RESET                         37800010
         SPACE                                                          38100010
*                                                                       38400010
*        PHASE 1,2, AND 3 NORMAL RESPONSES                              38700010
*                                                                       39000010
RSPN00   EQU   X'00' .                  COMMAND EXECUTED OK THIS        39300010
*                                         FAR                           39600010
RSPN01   EQU   X'01' .                  LEADING GRAPHICS RECEIVED       39900010
RSPN02   EQU   X'02' .                  ONE OF THE FOLLOWING COMMANDS   40200010
*                                         EXECUTED OK THIS FAR:         40500010
*                                           READ OR INVITE              40800010
*                                           WRITE(IN CONV MODE)         41100010
*                                           WR OR WCR COMMANDS IN       41400010
*                                             READ PHASE                41700010
RSPN03   EQU   X'03' .                  NEGATIVE POLL LIMIT             42000010
*                                         REACHED-QUEUE OPTION          42300010
RSPN04   EQU   X'04' .                  OLTT REQUEST MESSAGE            42600010
RSPN05   EQU   X'05' .                  BSC STATUS MESSAGE              42900010
RSPN06   EQU   X'06' .                  NEGATIVE POLL LIMIT REACHED-    43200010
*                                         NOWAIT OPTION                 43500010
*                                                                       43800010
*        RESPONSE CODES (USED WITH BDUSYRSP)                            44100010
*                                                                       44400010
RSPSTPND EQU   X'A5' .                  BSC STAT PENDING                44700010
RSPERLCK EQU   X'9C' .                  ERROR LOCK SET                  45000010
RSPERRST EQU   X'EA' .                  ERROR BSC STATUS                45300010
RSPNRMST EQU   X'65' .                  NORMAL BSC STATUS               45600010
RSPCRSOT EQU   X'9E' .                  CMD RESET                       45900010
RSPQNEGR EQU   X'03' .                  Q-NEG POLL LIMIT REACHED        46200010
*                                                              @YM04625 46300010
RSPATTN  EQU   X'B3' .                  ATTENTION                       46500010
RSPHNGUP EQU   X'AC' .                  HANGUP                          46800010
RSPSYNER EQU   X'88' .                  COMMAND SYNTAX ERROR            46860010
RSPMTA0  EQU   X'04' .                  MTA PHASE 0                     46920010
RSPRJCTD EQU   X'B8' .                  CONTACT REJECTED-SESSION START  46980010
RSPCNTN  EQU   X'A4' .                  YIELDED TO CONTENTION           47040010
RSPINACT EQU   X'86' .                  LINE INACTIVE                   47070010
         MEND                                                           47100010
*        */                                                             47400010
*%RSPPLS:;                                                              47700010
*/*                                                                  */ 48000010
*/*      FID0 PHASE 0 ERROR RESPONSES                                */ 48300010
*/*                                                                  */ 48600010
*DCL RSP0E01 BIT(5) CONSTANT('00001'B); /* INVALID RESOURCE ID       */ 48900010
*DCL RSP0E02 BIT(5) CONSTANT('00010'B); /* INVALID COMMAND           */ 49200010
*DCL RSP0E03 BIT(5) CONSTANT('00011'B); /* INVALID MODIFIER          */ 49500010
*DCL RSP0E04 BIT(5) CONSTANT('00101'B); /* RESET OR DEACTIVATE IN PRG*/ 49800010
*DCL RSP0E05 BIT(5) CONSTANT('00101'B); /* DEVICE INACTIVE           */ 50100010
*DCL RSP0E06 BIT(5) CONSTANT('00110'B); /* LINE INACTIVE             */ 50400010
*DCL RSP0E07 BIT(5) CONSTANT('00111'B); /* COMMAND NOT VALID         */ 50700010
*DCL RSP0E08 BIT(5) CONSTANT('01000'B); /* COMMAND SYNTAX ERR        */ 51000010
*DCL RSP0E09 BIT(5) CONSTANT('01001'B); /* COMMAND REJECTED          */ 51300010
*DCL RSP0E0A BIT(5) CONSTANT('01010'B); /* INVALID CONTROL DATA      */ 51600010
*DCL RSP0E0B BIT(5) CONSTANT('01011'B); /* RESET NOT PERFORMED       */ 51900010
*DCL RSP0E0C BIT(5) CONSTANT('01100'B); /* DATA NOT RESIDENT IN      */ 52200010
*/*                                         STORAGE                  */ 52500010
*DCL RSP0E0D BIT(5) CONSTANT('01101'B); /* DATA SET QUEUE LIMIT REACH*/ 52800010
*DCL RSP0E0E BIT(5) CONSTANT('01110'B); /* LINE AND DEVICE INCOMPAT  */ 53100010
*/*                                          ON SWITCHED CALL-OUT    */ 53400010
*DCL RSP0E0F BIT(5) CONSTANT('01111'B); /* INVALID TEXT LENGTH       */ 53700010
*DCL RSP0E11 BIT(5) CONSTANT('10001'B); /* INVALID CONTROL DATA      */ 54000010
*DCL RSP0E12 BIT(5) CONSTANT('10010'B); /* INCOMPLETE BTU            */ 54300010
*DCL RSP0E13 BIT(5) CONSTANT('10011'B); /* DEACTIVATE LINE ORDERLY OR*/ 54600010
*/*                                          DEACTIVATE DEVICE CMD   */ 54900010
*/*                                          REJECTED BECAUSE OF ERR */ 55200010
*/*                                          ON ONE OR MORE OF THE   */ 55500010
*/*                                          DEVICES                 */ 55800010
*DCL RSP0E14 BIT(5) CONSTANT('10100'B); /* DATA IN USE               */ 56100010
*DCL RSP0E15 BIT(5) CONSTANT('10101'B); /* INVALID CONTROL COMMAND   */ 56400010
*/*                                          MODIFIER OR CONTROL CMD */ 56700010
*/*                                          NOT VALID FOR RESOURCE  */ 57000010
*DCL RSP0E16 BIT(5) CONSTANT('10110'B); /* OLTT COMMAND REJECTED     */ 57300010
*/*                                          QUEUE NO EMPTY          */ 57600010
*DCL RSP0E17 BIT(5) CONSTANT('10111'B); /* OLT ACTIVE. NON-OLT       */ 57900010
*/*                                          REJECTED                */ 58200010
*DCL RSP0E18 BIT(5) CONSTANT('11000'B); /* MULTIPLE DIAL REQUESTS    */ 58500010
*DCL RSP0E19 BIT(5) CONSTANT('11001'B); /* MODE INCONSISTENCY        */ 58800010
*DCL RSP0E1A BIT(5) CONSTANT('11010'B); /* BUFFERS REQUIRED TO       */ 59100010
*/*                                          THE OPERATION ARE NOT   */ 59400010
*/*                                          AVAILABLE, SYSTEM IN    */ 59700010
*/*                                          SLOWDOWN MODE           */ 60000010
*DCL RSP0E1B BIT(5) CONSTANT('11011'B); /* COMMAND REJECT,SYSTEM IN  */ 60300010
*/*                                          AUTO NETWORK SHUTDOWN   */ 60600010
*DCL RSP0E1C BIT(5) CONSTANT('11100'B); /* COMMAND REJECTED,         */ 60900010
*/*                                          LOCK SET                */ 61200010
*DCL RSP0E1D BIT(5) CONSTANT('11101'B); /* COMMAND REJECTED,SECONDARY*/ 61500010
*/*                                          CHANNEL ADAPTER NOT     */ 61800010
*/*                                          OPERATIVE               */ 62100010
*DCL RSP0E1E BIT(5) CONSTANT('11110'B); /* COMMAND REJECTED, LINE    */ 62400010
*/*                                          DEACTIVATED OR COMMAND  */ 62700010
*/*                                          RESET                   */ 63000010
         @EJECT;                                                        63300010
*/*                                                                  */ 63600010
*/*      FID0 PHASE 0 UNSOLICITED RESPONSES                          */ 63900010
*/*                                                                  */ 64200010
*DCL RSPUNS00 BIT(5) CONSTANT('00000'B); /* INVALID BIT CONFIGURATION*/ 64500010
*DCL RSPUNS01 BIT(5) CONSTANT('00001'B); /* ATTENTION TIME-OUT OR    */ 64800010
*/*                                          UNRECOVERABLE ERROR ON  */ 65100010
*/*                                          CURRENT PRIMARY CHANNEL */ 65400010
*/*                                          ADAPTER                 */ 65700010
*DCL RSPUNS03 BIT(5) CONSTANT('00011'B); /* DEVICE ASSOCATION COMPL  */ 66000010
*DCL RSPUNS04 BIT(5) CONSTANT('00100'B); /* MTA DEVICE IDENTIFIED    */ 66300010
*DCL RSPUNS05 BIT(5) CONSTANT('00101'B); /* CHANNEL ADAPTER SET TO   */ 66600010
*/*                                          PRIMARY MODE            */ 66900010
*DCL RSPUNS06 BIT(5) CONSTANT('00110'B); /* CHANNEL ADAPTER SET TO   */ 67200010
*/*                                          SECONDARY MODE          */ 67500010
*DCL RSPUNS07 BIT(5) CONSTANT('00111'B); /* ENTERING SYSTEM SLOWDOW  */ 67800010
*DCL RSPUNS08 BIT(5) CONSTANT('01000'B); /* LEAVING SYSTEM SLOWDOWN  */ 68100010
*DCL RSPUNS09 BIT(5) CONSTANT('01001'B); /* INITIALIZATION COMPLETE  */ 68400010
*DCL RSPUNS0A BIT(5) CONSTANT('01010'B); /* MDR RECORDS ACCOMPANY    */ 68700010
*/*                                          THE BTU                 */ 69000010
*DCL RSPUNS1B BIT(5) CONSTANT('11011'B); /* AUTO NETWORK SHUTDOWN    */ 69300010
*/*                                          INIT VIA CHL TME-OUT OR */ 69600010
*/*                                          CHANNEL ADAPTER FAILURE */ 69900010
*DCL RSPUNS1C BIT(5) CONSTANT('11100'B); /* AUTO NETWORK SHUTDOWN    */ 70200010
*/*                                          INIT VIA PANEL          */ 70500010
*DCL RSPUNS1D BIT(5) CONSTANT('11101'B); /* NETWORK SHUT DOWN VIA    */ 70800010
*/*                                          AUTO NETWORK SHUTDOWN   */ 71100010
*DCL RSPUNS1E BIT(5) CONSTANT('11110'B); /* SERVICEABILITY AID-HOST  */ 71400010
*/*                                          LOGGING                 */ 71700010
         @SPACE;                                                        72000010
*/*                                                                  */ 72300010
*/*      ERROR RESPONSE INDICATOR                                    */ 72600010
*/*                                                                  */ 72900010
*DCL RSPERR   BIT(1) CONSTANT('1'B);    /* ERROR RESPONSE IND        */ 73200010
         @SPACE;                                                        73500010
*/*                                                                  */ 73800010
*/*      PHASE VALUES                                                */ 74100010
*/*                                                                  */ 74400010
*DCL RSP00    BIT(2) CONSTANT('00'B);    /* PHASE 0 IND              */ 74700010
*DCL RSP20    BIT(2) CONSTANT('01'B);    /* PHASE 1 IND              */ 75000010
*DCL RSP40    BIT(2) CONSTANT('10'B);    /* PHASE 2 IND              */ 75300010
*DCL RSP60    BIT(2) CONSTANT('11'B);    /* PHASE 3 IND              */ 75600010
         @SPACE;                                                        75900010
*/*                                                                  */ 76200010
*/*      PHASE 1,2, AND 3 ERROR RESPONSES                            */ 76500010
*/*                                                                  */ 76800010
*DCL RSPE00   BIT(5) CONSTANT('00000'B); /* DATA CHECK               */ 77100010
*DCL RSPE01   BIT(5) CONSTANT('00001'B); /* POSSIBLE INTERVENTION REQ*/ 77400010
*DCL RSPE02   BIT(5) CONSTANT('00010'B); /* INTERVENTION REQUIRED    */ 77700010
*DCL RSPE03   BIT(5) CONSTANT('00011'B); /* NEGATIVE POLL LIM REACHED*/ 78000010
*DCL RSPE04   BIT(5) CONSTANT('00101'B); /* YIELDED TO CONTENTION    */ 78300010
*DCL RSPE05   BIT(5) CONSTANT('00101'B); /* DEVICE ERROR-BSC STATUS  */ 78600010
*DCL RSPE06   BIT(5) CONSTANT('00110'B); /* BSC ID ERROR             */ 78900010
*DCL RSPE07   BIT(5) CONSTANT('00111'B); /* LINE TRACE TERMINATED D  */ 79200010
*/*                                          ERROR                   */ 79500010
*DCL RSPE08   BIT(5) CONSTANT('01000'B); /* OLTT CMD OR RESET OLTT   */ 79800010
*/*                                          CONTROL CMD PROCESSING  */ 80100010
*/*                                          TERMINATED              */ 80400010
*DCL RSPE09   BIT(5) CONSTANT('01001'B); /* SESSION NOT STARTED DUE  */ 80700010
*/*                                          HARDWARE ERROR          */ 81000010
*DCL RSPE0A   BIT(5) CONSTANT('01010'B); /* BSC ERROR STATUS MESSAGE */ 81300010
*DCL RSPE0B   BIT(5) CONSTANT('01011'B); /* GENERAL POLL OPERATION   */ 81600010
*/*                                          ABORTED DUE TO ERROR    */ 81900010
*DCL RSPE0C   BIT(5) CONSTANT('01100'B); /* FANOUT BACKUP LIMIT EXC  */ 82200010
*DCL RSPE13   BIT(5) CONSTANT('10011'B); /* BREAK RECEIVED ON THIS   */ 82500010
*DCL RSPE18   BIT(5) CONSTANT('11000'B); /* CONTACT REJECTED-SESSION */ 82800010
*/*                                          STARTED                 */ 83100010
*DCL RSPE19   BIT(5) CONSTANT('11001'B); /* DIAL DATA INCONSISTENCY  */ 83400010
*DCL RSPE1A   BIT(5) CONSTANT('11010'B); /* BUFFERS REQUIRED TO CMPLT*/ 83700010
*/*                                          OPERATION ARE NOT       */ 84000010
*/*                                          AVAILABLE               */ 84300010
*DCL RSPE1E   BIT(5) CONSTANT('11110'B); /* COMMAND REJECTED, LINE   */ 84600010
*/*                                          DEACTIVATED OR COMMAND  */ 84900010
*/*                                          RESET                   */ 85200010
         @SPACE;                                                        85500010
*/*                                                                  */ 85800010
*/*      PHASE 1,2, AND 3 NORMAL RESPONSES                           */ 86100010
*/*                                                                  */ 86400010
*DCL RSPN00   BIT(5) CONSTANT('00000'B); /* COMMAND EXECUTED OK THIS */ 86700010
*/*                                          FAR                     */ 87000010
*DCL RSPN01   BIT(5) CONSTANT('00001'B); /* LEADING GRAPHICS RECEIVED*/ 87300010
*DCL RSPN02   BIT(5) CONSTANT('00010'B); /* ONE OF THE FOLLOWING CMD */ 87600010
*/*                                          EXECUTED OK THIS FAR:   */ 87900010
*/*                                           READ OR INVITE         */ 88200010
*/*                                           WRITE(IN CONV MODE)    */ 88500010
*/*                                           WR OR WCR COMMANDS IN  */ 88800010
*/*                                            READ PHASE            */ 89100010
*DCL RSPN03   BIT(5) CONSTANT('00101'B); /* NEGATIVE POLL LIMIT      */ 89400010
*/*                                          REACHED-QUEUE OPTION    */ 89700010
*DCL RSPN04   BIT(5) CONSTANT('00100'B); /* OLTT REQUEST MESSAGE     */ 90000010
*DCL RSPN05   BIT(5) CONSTANT('00101'B); /* BSC STATUS MESSAGE       */ 90300010
*DCL RSPN06   BIT(5) CONSTANT('00110'B); /* NEGATIVE POLL LIMIT REA  */ 90600010
*/*                                          NOWAIT OPTION           */ 90900010
         @SPACE;                                                        91200010
*/*                                                                  */ 91500010
*/*      RESPONSE CODE (USED WITH BDUSYRSP)                          */ 91800010
*/*                                                                  */ 92100010
* DCL RSPSTPND BIT(8) CONSTANT('A5'X);  /* BSC STAT PENDING          */ 92400010
* DCL RSPERLCK BIT(8) CONSTANT('9C'X);  /* ERROR LOCK SET            */ 92700010
* DCL RSPERRST BIT(8) CONSTANT('EA'X);  /* ERROR BSC STATUS          */ 93000010
* DCL RSPNRMST BIT(8) CONSTANT('65'X);  /* NORMAL BSC STATUS         */ 93300010
* DCL RSPCRSET BIT(8) CONSTANT('9E'X);  /* CMD RESET                 */ 93600010
* DCL RSPQNEGR BIT(8) CONSTANT('03'X);  /* Q-NEG POLL LIMIT REACHED     93900010
*                                                            @YM04625*/ 94000010
* DCL RSPATTN  BIT(8) CONSTANT('B3'X);  /* ATTENTION                 */ 94200010
* DCL RSPHNGUP BIT(8) CONSTANT('AC'X);  /* HANGUP                    */ 94500010
* DCL RSPSYNER BIT(8) CONSTANT('88'X);  /* COMMAND SYNTAX ERROR      */ 95400010
* DCL RSPMTA0  BIT(8) CONSTANT('04'X);  /* MTA PHASE 0               */ 96300010
* DCL RSPRJCTD BIT(8) CONSTANT('B8'X);  /* CONTACT REJECTED-SESSION  */ 97200010
*                                       /*  STARTED                  */ 98100010
* DCL RSPCNTN  BIT(8) CONSTANT('A4'X);  /* YIEDLED TO CONTENTION     */ 99000010
* DCL RSPINACT BIT(8) CONSTANT('86'X);  /* LINE INACTIVE             */ 99400010
./  ADD  SSI=61000098,NAME=TRSTD
*     %GOTO PLSRST;                     /* BILINGUAL HEADER             02000010
         MACRO                                                          04000010
         TRSTD                                                          06000010
.*A000000-999999                                               @Y17XAXF 08000010
         MEND                                                           10000010
*        */                                                             12000010
*%PLSRST:;                                                              14000010
*/*                                                                  */ 16000010
*/*      RESOURCE SEGMENT TABLE (POST NCP5)                          */ 18000010
*/*                                                                  */ 20000010
* DECLARE                                                               22000010
*   1 RSTSEG   BASED BDY(BYTE),         /* SEGMENT HDR FORMAT        */ 24000010
*    2 RSTTYPE  CHAR(1),                /* SEGMENT TYPE              */ 26000010
*    2 RSTSEGHL CHAR(1),                /* SEGMENT HDR SIZE          */ 28000010
*    2 RSTNOENT CHAR(2),                /* NO OF ENTRIES IN SEQMENT  */ 30000010
*    2 RSTSEGSZ CHAR(4),                /* SEGMENT SIZE              */ 32000010
*    2 RSTENTSZ CHAR(2),                /* ENTRY SIZE                */ 34000010
*    2 RSTHUNQE CHAR(4),                /* HDR UNIQUE FLD (VAR LEN)  */ 36000010
*     3 RSTPSNAN CHAR(2),               /*  NO OF PRE-SNA ENTRIES    */ 38000010
*     3 RSTOTENT CHAR(2);               /*  TOTAL NO. OF ENTRIES     */ 40000010
* DECLARE                                                               42000010
*   1 RSTHDR   BASED BDY(BYTE),         /* HEADER SEG ENTRY FORMAT   */ 44000010
*    2 RSTSEGTY CHAR(1),                /* SEGMENT TYPE              */ 46000010
*    2 RSTSGOFF CHAR(4),                /* OFFSET TO SEGMENT         */ 48000010
*    2 RSTNULL  CHAR(1);                /* HWORD ALIGNMENT PAD       */ 50000010
* DECLARE                                                               52000010
*   1 RSTSYSEN BASED BDY(BYTE),         /* SYSTEM SEG ENTRY FORMAT   */ 54000010
*    2 RSTRELSE CHAR(2),                /* RELEASE LEVEL             */ 56000010
*    2 RSTMODLV CHAR(2),                /* MODIFICATION LEVEL        */ 58000010
*    2 RSTGENTP CHAR(2),                /* TYPE OF GEN               */ 60000010
*    2 RSTNCPSA CHAR(2),                /* NCP SUBAREA               */ 62000010
*    2 RSTSALTH CHAR(2),                /* SUBAREA ID LENGTH         */ 64000010
*    2 RSTNBFSZ CHAR(2);                /* NCP BUFFER SIZE           */ 66000010
* DECLARE                                                               68000010
*   1 RSTHOST  BASED BDY(BYTE),         /* HOST SEG ENTRY FORMAT     */ 70000010
*    2 RSTHSTSA CHAR(2),                /* HOST NODE SUBAREA         */ 72000010
*    2 RSTKEYLN CHAR(2),                /* HOST UNIT SIZE            */ 74000010
*    2 RSTUNITN CHAR(2),                /* NO OF UNITS IN HOST BUFFER*/ 76000010
*    2 RSTBUFPD CHAR(2);                /* BUFFER PADSIZE            */ 78000010
*/*                                                                  */ 80000010
*/*      VALUES FOR RSTTYPE                                          */ 82000010
*/*                                                                  */ 84000010
* DCL RSTHDSEG BIT(8) CONSTANT('80'X);  /* HEADER SEGMENT            */ 86000010
* DCL RSTSYSEG BIT(8) CONSTANT('01'X);  /* SYSTEM SEGMENT            */ 88000010
* DCL RSTHSTSG BIT(8) CONSTANT('02'X);  /* HOST SEGMENT              */ 90000010
* DCL RSTPATHS BIT(8) CONSTANT('03'X);  /* PATH SEGMENT              */ 92000010
* DCL RSTRSORC BIT(8) CONSTANT('04'X);  /* RESOURCE SEGMENT          */ 94000010
* DCL RSTEND   BIT(8) CONSTANT('FF'X);  /* END OF RST SEGMENT        */ 96000010
./  ADD  SSI=60840008,NAME=TRVTD
*        %GOTO PLSRVT;                  /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TRVTD                                                          09000010
         SPACE                                                          12000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          15000010
.*A000000-999999                                               @Y17XAXU 18000010
         SPACE                                                          21000010
IEDRVTD  DSECT                                                          24000010
*                                                                       27000010
*        DSECT FOR RESOURCE VECTOR TABLE (RVT)                          30000010
*                                                                       33000010
RVTNUM   DS    H .                      NO. OF RVT ENTRIES     @Y17XAXU 34000010
RVTINDEX DS    AL2 .                    TNT/MH INDEX                    36000010
RVTLEN   EQU   *-RVTINDEX .             LENGTH OF RVT ENTRY             39000010
         SPACE 2                                                        42000010
         MEND                           */                              45000010
*%PLSRVT : ;                                                            48000010
*DECLARE                                                                51000010
*  1 IEDRVTD BDY(WORD) BASED(IEDQRVTP),                                 54000010
*/*                                                                  */ 57000010
*/*      DSECT FOR RESOURCE VECTOR TABLE (RVT)                       */ 60000010
*/*                                                                  */ 63000010
*    2 RVTNUM   FIXED(15),              /* NO. OF RVT ENTRIE @Y17XAXU*/ 64000010
*   2 RVTINDEX FIXED(15);               /* TNT/MH INDEX              */ 66000010
* %RVTLEN='LENGTH(RVTINDEX)';           /* LENGTH OF RVT ENTRY       */ 69000010
*                                                                       72000010
*%RVTEND: ;                                                             75000010
*                                                                       78000010
./  ADD  SSI=60840020,NAME=TSATD
*        %GOTO PLSSAT;                  /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TSATD                                                          09000010
         SPACE                                                          12000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          15000010
.*A000000-999999                                               @Y17XAXU 18000010
         SPACE                                                          21000010
IEDSATD  DSECT                                                          24000010
*                                                                       27000010
*        DSECT FOR SUBAREA TABLE (SAT)                                  30000010
*                                                                       33000010
SATRNLCB DS    A .                      IMMEDIATE 3705 LCB              36000010
SATRNRVT DS    A .                      ADDRESS OF 3705 RVT             39000010
SATLEN   EQU   *-IEDSATD                LENGTH OF SAT ENTRY             42000010
         SPACE 2                                                        45000010
         MEND                           */                              48000010
*%PLSSAT : ;                                                            51000010
*DECLARE                                                                54000010
*  1 IEDSATD BDY(WORD) BASED(IEDQSATP),                                 57000010
*/*                                                                  */ 60000010
*/*      DSECT FOR SUBAREA TABLE (SAT)                               */ 63000010
*/*                                                                  */ 66000010
*   2 SATRNLCB PTR(31),                 /* IMMEDIATE 3705 LCB        */ 69000010
*   2 SATRNRVT PTR(31);                 /* 3705 RVT ADDRESS          */ 72000010
* %SATLEN='LENGTH(IEDSATD)';            /* LENGTH OF SAT ENTRY       */ 75000010
*                                                                       78000010
*%SATEND: ;                                                             81000010
*                                                                       84000010
./  ADD  SSI=70210322,NAME=TSBTD
*        %GOTO PLSSBT;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TSBTD                                                          03000010
IEDQSBTD DSECT                                                          04000010
.* A000000-999999                                              @YM07020 05000010
SBTFLAGS DS    X                        FUNCTION FLAGS                  06000010
SBTECBN  EQU   X'80'                    REQUEST ECB POST WHEN COMPLETE  07000010
SBTBFRTN EQU   X'40'                    RETURN BFR CONTAINING PARM      08000010
*                                        LIST TO BFR RETURN WHEN        09000010
*                                        COMPLETE                       10000010
SBTOI    EQU   X'20'                    PERFORM OR FUNCTION             11000010
SBTNI    EQU   X'10'                    PERFORM AND FUNCTION            12000010
*              X'08'-X'01'              RESERVED                        13000010
SBTQCBA  DS    AL3                      QCB ADDRESS                     14000010
SBTPRI   DS    X                        PRIORITY                        15000010
SBTLINK  DS    AL3                      LINK FIELD                      16000010
         DS    A                        BUFFER TIC FIELD                17000010
SBTDATA  DS    X                        BIT CONFIGURATION FOR OR/AND    18000010
*                                        FUNCTION                       19000010
SBTADDR  DS    AL3                      ADDRESS OF BYTE FOR OR/AND      20000010
*                                        FUNCTION                       21000010
SBTECB   DS    A                        OPTIONAL ECB FOR POST           22000010
         MEND  ,   */                                                   23000010
*%PLSSBT:  ;                                                            24000010
*DECLARE                                /* IEDQSBT PARAMETER LIST    */ 25000010
*  1 IEDQSBTD  BASED(IEDQSBTR),         /* PARM LIST                 */ 26000010
*   2 SBTFLAGS     BIT(8),              /* FUNCTION FLAGS            */ 27000010
*    3 SBTECBN      BIT(1),             /* REQUEST ECB POST WHEN        28000010
*                                          COMPLETE                  */ 29000010
*    3 SBTBFRTN     BIT(1),             /* RETURN BFR CONTAINING PARM   30000010
*                                          LIST TO BFR RETURN WHEN      31000010
*                                          COMPLETE                  */ 32000010
*    3 SBTOI        BIT(1),             /* PERFORM OR FUNCTION       */ 33000010
*    3 SBTNI        BIT(1),             /* PERFORM AND FUNCTION      */ 34000010
*    3 *            BIT(4),             /* RESERVED                  */ 35000010
*                                                                       36000010
*   2 SBTQCBA      PTR(24),             /* QCB ADDRESS               */ 37000010
*                                                                       38000010
*   2 SBTPRI       CHAR(1),             /* PRIORITY                  */ 39000010
*   2 SBTLINK      PTR(24),             /* LINK FIELD                */ 40000010
*                                                                       41000010
*   2 *            PTR(31),             /* BUFFER TIC FIELD          */ 42000010
*                                                                       43000010
*   2 SBTDATA      BIT(8),              /* BIT CONFIGURATION FOR        44000010
*                                          OR/AND FUNCTION           */ 45000010
*   2 SBTADDR      PTR(24),             /* ADDRESS OF BYTE FOR          46000010
*                                          OR/AND FUNCTION           */ 47000010
*   2 SBTECB       PTR(31);             /* OPTIONAL ECB FOR POST     */ 48000010
*                                                                       49000010
*                                                                       50000010
./  ADD  SSI=63380548,NAME=TSCBD
*        %GOTO BSLSCB;                                               /* 00200022
         MACRO                                                          00400020
         TSCBD                                                          00800020
.*A 000000-999999                                              @X02X5X0 00802010
.*A384000                                                       SA53606 00805010
.*A452000                                                        S21101 00810020
.*C012000                                                        S21101 00820020
.*D460000                                                        S21101 00830020
.*A140000                                                        A42363 01000021
.*D168000                                                        S22026 01030022
.*C028000,108000,112000                                          S22026 01060022
.*A078000,110000,114000,130000,143500,158000,287000,434000       S22026 01090022
.*A442000,450000,474000,498000,524800-527200                     S22026 01120022
.*A552400-555600                                                 S22026 01150022
.*A056000                                                        A44887 01200021
.*C616000,864100                                                SA67142 01300054
.*A204000,825100                                               @OY13632 01320010
.*A160000,865000                                                 X03039 01350010
.*A624000,865000                                               @Y17XAXF 01370010
.*       UPDATED 11/5/74                                       @X02X5XE 01400010
.*       BILINGUAL CONVERSION OF THE SCB DSECT WAS DONE FOR      S22024 01470022
IEDQSCB  DSECT                                                          01600020
         SPACE                                                          02000020
SCBSTATE DS    XL1 .                    STATUS BITS                     02400020
*                        BIT DEFINITIONS                                02800022
SCBTRANP EQU   X'80' .                  MESSAGE IN TRANSPARENT MODE     03200020
SCBMGFMN EQU   X'40' .                  MSGFORM REQUESTED               03600020
SCBMGFMF EQU   X'BF' .                  MSGFORM NOT REQUESTED           04000020
SCBSEQIN EQU   X'40' .                  SEQUENCE IN HAS BEEN EXECUTED   04400020
*                                       CURRENT MESSAGE                 04800020
SCBLCK1N EQU   X'20' .                  FIRST LOCK BIT                  05200020
SCBLCK1F EQU   X'DF' .                  MSG NOT BEING RCVD IN LOCK      05600020
SCBERSDS EQU   X'10' .                  SCREEN ERASURE REQUESTED A44887 05800021
SCBMSGLN EQU   X'08' .                  MESSAGE LOCK                    06000020
SCBMSGLF EQU   X'F7' .                  EXTENDED LOCK                   06400020
SCBCKPT  EQU   X'04' .                  CHECKPOINT REQUESTED            06800020
SCBPRER  EQU   X'02' .                  PREVIOUS EOB/ETB ERROR          07200020
SCBCODE  EQU   X'01' .                  TRANSLATION REQUESTED           07600020
*                                                                       07800022
SCBDESTQ DS    AL3 .                    POINTER TO DESTINATION QCB      08000020
SCBSNDCT DS    0XL1 .                   MSGLIMIT ON THE SEND SIDE       08400020
SCBRCVCT DS    XL1 .                    MSGLIMIT ON THE RECEIVE SIDE    08800020
SCBMACR  DS    0AL3 .                   FIRST/NEXT IN/OUTMSG MACRO TO   09200020
*                                       BE EXECUTED                     09600020
SCBMBHEN DS    AL3 .                    ADDR MULT BFR HDR ENTRY         10000020
SCBPRI   DS    XL1 .                    PRIORITY INDEX TO QCB           10400020
SCBBKFCT DS    0XL3 .                   CNT OF MSG LNTH FOR BRK  S22026 10800022
         DS    XL1 .                                             S22026 11000022
SCBEOBSZ DS    0H .                     SIZE OF LOGICAL BLOCKS   S22026 11200022
SCBCTBSZ DS    H .                      SIZE OF CTB              S22026 11400022
SCBSALEV DS    0XL1 .                   SIMULATED ATTN LEVEL REQ    TSO 11600020
SCBQTYPE DS    XL1 .                                                    12000020
*                                       THIS MESSAGE HAS BEEN           12400020
*                                       QUEUED ON                       12800020
*                        BIT DEFINITIONS                                13000022
SCBNREUS EQU   X'10' .                  NON-REUSEABLE DISK QUEUES       13200020
SCBREUS  EQU   X'20' .                  REUSEABLE DISK QUEUES           13600020
SCBCOREQ EQU   X'40' .                  CORE QUEUES                     14000020
SCBNORCL EQU   X'80' .                  A RECALL FROM BD HAS     A42363 14060021
*                                       FAILED TO GET A BUFFER   A42363 14120021
*                                       BECAUSE THE MESSAGE HAD  A42363 14180021
*                                       ALREADY BEEN REMOVED FROMA42363 14240021
*                                       THE CORE QUEUE           A42363 14300021
SCBCONC  EQU   X'08' .                  CONC SCB                 S22026 14350022
SCBNOFF  EQU   X'04' .                  REUS HAS UPDATED SCBFEFO        14400020
SCBBBFTM EQU   X'02' .                  BUFFERRED TERMINAL SCB          14800020
SCBBFMM  EQU   X'01' .                  BUFFERRED TERMINAL IN MIDDLE    15200020
*                                       OF MESSAGE                      15600020
*                                                                       15800022
SCBMRFPL DS    AL3 .                    ADDR OF FORWARD PARAMETER LIST  16000020
SCBRNNME DS    0CL8 .                   NAME OF THE NCP          X03039 16200010
SCBERRST DS    0F .                     ERROR WORD BITS                 16400020
SCBERR1  DS    XL1 .                    FIRST BYTE                      17200020
*                        BIT DEFINITIONS                                17600020
SCBHDRRN EQU   X'80' .                  INCOMPLETE HEADER               18000020
SCBHDRRF EQU   X'7F' .                  NOT INCOMPLETE HEADER           18400020
SCBNOLOG EQU   SCBHDRRN .               INVALID LOGON MESSAGE       TSO 18800020
SCBORIGN EQU   X'40' .                  INVALID ORIGIN ON               19200020
SCBORIGF EQU   X'BF' .                  ORIGIN IS VALID                 19600020
SCBHANG  EQU   SCBORIGN .               LOGON REQUESTS HANGUP MSG   TSO 20000020
SCBNOTRM EQU   X'20' .                  NOT A TSO TERMINAL          TSO 20400020
SCBRVITX EQU   X'20'                    RVI TO TEXT RECEIVED   @OY13632 20600010
SCBSEQHN EQU   X'10' .                  SEQUENCE HIGH ON                20800020
SCBSEQHF EQU   X'EF' .                  SEQUENCE NOT HIGH               21200020
SCBNOTSO EQU   SCBSEQHN .               TSO NOT IN SYSTEM           TSO 21600020
SCBSEQLN EQU   X'08' .                  SEQUENCE LOW ON                 22000020
SCBSEQLF EQU   X'F7' .                  SEQUENCE NOT LOW                22400020
SCBNOVAC EQU   SCBSEQLN .               TOO MANY TSO USERS          TSO 22800020
SCBNOBFN EQU   X'02' .                  INSUFFICIENT BUFFERS            23600020
SCBCUTFN EQU   X'01' .                  CUTOFF ERROR                    24000020
SCBCUTFF EQU   X'FE' .                  NO CUTOFF ERROR                 24400020
SCBRVISL EQU   SCBCUTFN .               RVI TO SEL BUFRD TERM           24800020
*                                                                       25200020
SCBERR2  DS    XL1 .                    SECOND BYTE                     25600020
*                        BIT DEFINITIONS                                26000020
SCBCRMIN EQU   X'80' .                  CORE MINIMUM PASSED             26400020
SCBCRMAX EQU   X'40' .                  CORE MAXIMUM PASSED             26800020
SCBCODER EQU   X'20' .                  ERROR IN DYNAMIC TRANSLATE TSO  27200020
SCBALN   EQU   X'10' .                  AUTOMATIC LINE NUMBERING    TSO 27600020
SCBOLTR  EQU   X'08' .                  TOTE NOT IN SYSTEM              28000020
SCBABRTN EQU   X'04' .                  ABORT - BSC TERMINAL            28400020
SCBRRJN  EQU   X'04' .                  REQUEST REJECT - SNA     X03039 28500010
SCBFRWDN EQU   X'02' .                  'FORWARD' ERROR                 28600020
SCBSOHE  EQU   X'01' .                  SOH % E,C,R MESSAGE      S99238 28700022
*                                                                       28800020
SCBERR3  DS    XL1 .                    THIRD BYTE                      29200020
*                        BIT DEFINITIONS                                29600020
SCBLOSTN EQU   X'80' .                  MESSAGE LOST (OVERLAID)         30000020
SCBLOSTF EQU   X'7F' .                  MESSAGE PROCESSED               30400020
SCBXPI   EQU   SCBLOSTN .               ATTENTION - SEND !I         TSO 30800020
SCBTMIDN EQU   X'40' .                  ID FROM TERMINAL INVALID        31200020
SCBTMIDF EQU   X'BF' .                  TERMINAL IDENT OK               31600020
SCBXPD   EQU   SCBTMIDN .               ATTENTION - SEND !D         TSO 32000020
SCBTMINN EQU   X'20' .                  TERMINAL INOPERATIVE            32400020
SCBTMINF EQU   X'DF' .                  TERMINAL FUNCTIONAL             32800020
SCBSATTN EQU   X'10' .                  SIMULATED ATTENTION REC'VED TSO 33200020
SCBUSERN EQU   X'08' .                  USER ERROR ON                   33600020
SCBUSERF EQU   X'F7' .                  NO USER ERROR                   34000020
SCBFORMN EQU   X'04' .                  FORMAT ERROR-BSC MESSAGE        34400020
SCBFIERN EQU   X'04' .                  FUNCTION INTRP ERR - SNA X03039 34600010
SCBATTN  EQU   X'02' .                  HARDWARE ATTENTION          TSO 34800020
SCBTHRSN EQU   X'02' .                  THRESH REACHED ON CORE Q S22025 35000000
SCBXCEPN EQU   X'01' .                  UNIT EXCEPTION                  35200020
SCBXCEPF EQU   X'FE' .                  NO UNIT EXCEPTION               35600020
SCBPERRN EQU   X'01' .                  PATH ERROR - SNA         X03039 35800010
*                                                                       36000020
SCBERR4  DS    XL1 .                    FOURTH BYTE                     36400020
*                        BIT DEFINITIONS                                36800020
SCBSLCTN EQU   X'80' .                  ERROR DURING SELECTION          37200020
SCBSLCTF EQU   X'7F' .                  NO SELECTION ERROR              37600020
SCBTXTTN EQU   X'40' .                  ERROR DURING TEXT TRANSFER      38000020
SCBTXTTF EQU   X'BF' .                  NO TEXT TRANSFER ERROR          38400020
SCBAPERR EQU   X'40' .                  SET BY IGG02046 IF      SA53606 38480022
*                                       PARTIAL MESSAGE IS SENT SA53606 38560022
*                                       TO MH BY ABENDING       SA53606 38640022
*                                       APPLICATION PROGRAM     SA53606 38720022
SCBCONNN EQU   X'20' .                  ERROR IN CONNECT/DISCONNECT     38800020
SCBCONNF EQU   X'DF' .                  NO CONNECT/DISCONNECT ERROR     39200020
SCBTRMLN EQU   X'10' .                  TERMINAL ERROR                  39600020
SCBTRMLF EQU   X'EF' .                  NOT TERMINAL ERROR              40000020
SCBCTLUN EQU   X'04' .                  ERROR IN CONTROL UNIT           41200020
SCBCTLUF EQU   X'FB' .                  NO CONTROL UNIT ERROR           41600020
SCBCPMEN EQU   X'04' .                  CPM ERROR - SNA          X03039 41800010
SCBCHANN EQU   X'02' .                  ERROR IN CHANNEL                42000020
SCBCHANF EQU   X'FD' .                  NO CHANNEL ERROR                42400020
SCBSTERN EQU   X'02' .                  STATE ERROR - SNA        X03039 42600010
SCBUNDFN EQU   X'01' .                  UNDEFINED ERROR                 42800020
SCBUNDFF EQU   X'FE' .                  NO UNDEFINED ERROR              43200020
*                                                                       43400022
SCBMRFSD DS    H .                      MULT RT FIRST SECNDRY DEST      43600020
SCBEOBAC DS    0H .                     ACCUM COUNT BETWEEN BLOCKS      44000020
SCBCTBAC DS    0H .                     COUNT OF DATA INSERTED   S22026 44200022
SCBDLPTR DS    0H .                     DISTRUBUTION LIST PTR    S22025 44400000
SCBCRLEN DS    XL1 .                    LENGTH OF CHAR STRING    S22025 44500000
SCBENDCR DS    XL1 .                    ITB CHAR SPECIFIED       S22025 44600000
SCBBSCFM DS    XL1 .                    MSGFORM DYNAMIC BLK CHANGES     44800020
*                        BIT DEFINITIONS                                45000022
SCBTRNSP EQU   X'80' .                  RECEIVEING TRANSPARENT          45200020
SCBNONTR EQU   X'40' .                  RECEIVEING NON-TRANSPARENT      45250020
SCBRCVTX EQU   X'20' .                  ETX RECEVIED FROM BSC           45600020
SCBCNTEN EQU   X'10' .                  FOR SCHEDULER TO DETERMINS21101 46000020
*                                         NEXT OPERATION         S21101 46050020
SCBDATEN EQU   X'08' .                  AUTO DATE/TIME EXECUTED  S22065 46120022
*                                       INPUT ONLY               S99238 46190022
SCBNPDTR EQU   X'08' .                  NO PADDING TRANSPARENT   S99238 46260022
*                                       OUTPUT ONLY              S99238 46330022
SCBNOEOT EQU   X'02' .                  BSC DIAL NO EOT BEFORE READ     46400020
SCBMLMTN EQU   X'01' .                  MSGLIMIT HAS BEEN EXCEEDED      46800020
SCBMLMTF EQU   X'FE' .                  MSGLIMIT NOT EXCEEDED           47200020
*                                                                       47400022
SCBMBSSA DS    XL7 .                    MULT BFR SCAN SAVE AREA         47600020
SCBCPBNO DS    XL1 .                    NUMBER OF NEXT SEQUENTIAL CPB   48000020
*                                       TO BE READ FROM DISK            48400020
SCBDCHDR DS    AL3 .                    DISK ADDR CURRENT HEADER        48800020
SCBDESTL DS    XL1 .                    LENGTH OF DESTINATION NAMES     49200020
SCBCCHDR DS    AL3 .                    CORE ADDR CURRENT HEADER        49600020
SCBCTBSV DS    0XL1 .                   CTBFORM PARMS SAVED      S22026 49700022
SCBBCTR  DS    0XL1 .                   COUNTER OF BLKS REQ      S22025 49800000
SCBITBSZ DS    XL1 .                    SIZE OF LOGICAL SUBBLOCKS       50000020
SCBSCSEG DS    0AL3 .                   CURRENT SEGMENT BEING READ      50400020
SCBDNSEG DS    AL3 .                    DISK ADDR NEXT SEGMENT          50800020
*                                       FROM DISK TO SEND               51200020
SCBHBFNO DS    XL1 .                    NUMBER OF BUFFERS IN MULTI HDR  51600020
SCBSCHDR DS    0AL3 .                   CURRENT HEADER BEING SENT       52000020
SCBCLSEG DS    AL3 .                    CORE ADDR LAST MSG SEGMENT      52400020
SCBCTBFL DS    0XL1 .                   CONC FLAG BYTE           S22026 52440022
*                        BIT DEFINITIONS                         S22026 52480022
SCBCTBND EQU   X'80' .                  CTB END REACHED .        S22026 52520022
*                                                                S22026 52560022
SCBBLKCT DS    0XL1 .                   NO. OF BLKS REQUESTED    S22025 52600000
SCBITBAC DS    XL1 .                    ACCUM COUNT BETWEEN ITBS        52800020
SCBFEFO  DS    0AL3 .                   SAVED FEFO POINTER              53200020
SCBDCSEG DS    AL3 .                    DISK ADDR CURRENT SEGMENT       53600020
SCBDEOB  DS    F .                      DISK INFO ON LAST EOB           54000020
SCBSRCE  DS    H .                      MSG BFR SOURCE SAVED            54400020
SCBSIZE  DS    H .                      MSG BFR SIZE SAVED              54800020
SCBSTAT1 DS    XL1 .                    STATUS BYTE                     55200020
*                        BIT DEFINITIONS                         S22026 55240022
SCBCBGN  EQU   X'80' .                  CONC MSG BEGIN           S22026 55280022
SCBCEND  EQU   X'40' .                  CONC MSG END             S22026 55320022
SCBNIDLE EQU   X'20' .                  INDICATES THAT BUFFERS   S22026 55360022
*                                       ARE NOT TO BE HOOKED IN  S22026 55400022
*                                       IDLES LOOP YET           S22026 55440022
SCBNOPST EQU   X'10' .                  INDICATES THAT BUFFERS   S22026 55480022
*                                       SHOULD NOT BE POSTED     S22026 55520022
*                                                                S22026 55560022
SCBXTRA  DS    0AL3 .                   ADDR ADDL RCDS SAVED            55600020
SCBCORE  DS    AL3 .                    ADDR RCD IN CORE Q SAVED        56000020
SCBOSEQ  DS    0H .                     SEQUENCE OUT NUMBER             56400020
SCBSCAN  DS    H .                      SCAN POINTER                    56800020
SCBTQBCK DS    0XL3 .                   TEXT SEGMENT CHAIN SAVED        57200020
SCBNTXT  DS    AL3 .                    ADDR NEXT TEST SEG SAVED        57600020
SCBCRCD  DS    AL3 .                    ADDR CURR SEGMENT SAVED         58000020
SCBNHDR  DS    0AL3 .                   ADDR NEXT HDR SEG SAVED         58400020
SCBCHDR  DS    AL3 .                    ADDR CURR HDR SEG SAVED         58800020
SCBNXCPB DS    0AL1 .                   NEXT CPB NUMBER FROM DISK       59200020
*                                       IF ZERO - NO MULTIPLE ROUTING   59600020
SCBCCSEG DS    AL3 .                    CORE ADDR CURRENT SEGMENT       60000020
SCBEOB   DS    H .                      POINTER TO FIRST EOB SAVED      60400020
SCBUNTCT DS    AL1 .                    COUNT IN DISK RECORD OF FIRST   60800020
*                                       BYTE OF DATA                    61200020
SCBTRANS DS    AL3 .                    ADDR OF CODE MACRO      SA67142 61600054
*                                       PARAMETER LIST          SA67142 61800054
SCBRGSAV DS    0F .                     SAVE AREA FOR USER MH REGISTERS 62000020
*                                       IF SPECIFIED ON INTRO           62400020
SCBSCBL  EQU   *-IEDQSCB                LENGTH OF SCB          @Y17XAXF 62600010
*                                                                       62800020
*       *************************************************************   63200020
*   0   *     STATE    *                   DESTQ                    *   63600020
*       *************************************************************   64000020
*   4   *  SNDCT/RCVCT *                 MACR/MBHEN                 *   64400020
*       *************************************************************   64800020
*   8   *     PRI      *                   BKFCT                    *   65200020
*       *************************************************************   65600020
*  12   *     QTYPE    *                   MRFPL                    *   66000020
*       *************************************************************   66400020
*  16   *                           ERRST                           *   66800020
*       *************************************************************   67200020
*  20   *            MRFSD            *            DLPTR            *   67600020
*       *************************************************************   68000020
*  24   *     BSCFM    *                   MBSSA                    *   68400020
*       *************************************************************   68800020
*  28   *                           MBSSA                           *   69200020
*       *************************************************************   69600020
*  32   *     CPBNO    *                   DCHDR                    *   70000020
*       *************************************************************   70400020
*  36   *     DESTL    *                   CCHDR                    *   70800020
*       *************************************************************   71200020
*  40   *     ITBSZ    *                 SCSEG/DNSEG                *   71600020
*       *************************************************************   72000020
*  44   *     HBFNO    *                 SCHDR/CLSEG                *   72400020
*       *************************************************************   72800020
*  48   *     ITBAC    *                 FEFO/DCSEG                 *   73200020
*       *************************************************************   73600020
*  52   *                          DEOB                             *   74000020
*       *************************************************************   74400020
*  56   *            SRCE             *            SIZE             *   74800020
*       *************************************************************   75200020
*  60   *     STAT1    *                 XTRA/CORE                  *   75600020
*       *************************************************************   76000020
*  64   *         OSEQ/SCAN           *          NTXT/TQBCK         *   76400020
*       *************************************************************   76800020
*  68   *  NTXT/TQBCK  *                   CRCD                     *   77200020
*       *************************************************************   77600020
*  72   *                NHDR/CHDR                   *     CCSEG    *   78000020
*       *************************************************************   78400020
*  76   *            CCSEG            *             EOB             *   78800020
*       *************************************************************   79200020
*  80   *     UNTCT    *                   TRANS                    *   79600020
*       *************************************************************   80000020
*                                                                       80400020
         MEND  , */                                                     80800022
*%BSLSCB  :  ;                                                          80830022
*DECLARE                                                                80860022
*  1 IEDQSCB  BASED(IEDQSPTR),                                          80890022
*   2 SCBSTATE    CHAR(1),               /* STATUS BITS              */ 80920022
*    3 SCBTRANP    BIT(1),               /* MESSAGE IN TRANSPARENT      80950022
*                                           MODE                     */ 80980022
*    3 SCBSEQIN    BIT(1),               /* SEQUENCE IN HAS BEEN        81010022
*                                           EXECUTED CURRENT MESSAGE */ 81040022
*     4 SCBMGFMN    BIT(1),              /* MSGFORM REQUESTED        */ 81070022
*    3 SCBLCK1N    BIT(1),               /* FIRST LOCK BIT           */ 81100022
*    3 SCBERSDS    BIT(1),               /* SCREEN ERASURE REQ A44887*/ 81130022
*    3 SCBMSGLN    BIT(1),               /* MESSAGE LOCK             */ 81160022
*    3 SCBCKPT     BIT(1),               /* CHECKPOINT REQUESTED     */ 81190022
*    3 SCBPRER     BIT(1),               /* PREVIOUS EOB/ETB ERROR   */ 81220022
*    3 SCBCODE     BIT(1),               /* TRANSLATION REQUESTED    */ 81250022
*   2 SCBDESTQ    PTR(24)  BDY(BYTE),    /* POINTER TO DEST QCB      */ 81280022
*   2 SCBRCVCT    CHAR(1),               /* RECEIVE MSGLIMIT         */ 81310022
*    3 SCBSNDCT    CHAR(1),              /* SEND MSGLIMIT            */ 81340022
*   2 SCBMBHEN    PTR(24)  BDY(BYTE),    /* ADDR MULT BFR HDR ENTRY  */ 81370022
*    3 SCBMACR     PTR(24)  BDY(BYTE),   /* FIRST/NEXT IN/OUTMSG        81400022
*                                           MACRO TO BE EXECUTED     */ 81430022
*   2 SCBPRI      PTR(8),                /* PRIORITY INDEX TO QCB       81460022
*                                                              S22024*/ 81490022
*   2 SCBBKFCT    PTR(24)  BDY(BYTE),    /* MSG LENGTH COUNT FOR        81520022
*                                           BREAK              S22026*/ 81550022
*    3 *           PTR(8),               /*                    S22026*/ 81580022
*    3 SCBEOBSZ    FIXED(15) BDY(BYTE),  /* SIZE OF LOGICAL BLOCKS      81610022
*                                                              S22026*/ 81640022
*     4 SCBCTBSZ    FIXED(15) BDY(BYTE), /* SIZE OF CTB        S22026*/ 81670022
*   2 SCBSALEV    CHAR(1),               /* SIMULATED ATTN LEVEL REQ    81700022
*                                           TSO                      */ 81730022
*    3 SCBQTYPE    CHAR(1),              /* THIS MESSAGE HAS BEEN       81760022
*                                           QUEUED ON                */ 81790022
*     4 SCBNORCL    BIT(1),              /* A RECALL FROM BD HAS FAILED 81820022
*                                           TO GET A BUFFER BECAUSE THE 81850022
*                                           MESSAGE HAD ALREADY BEEN    81880022
*                                           REMOVED FROM THE CORE       81910022
*                                           QUEUE              A42363*/ 81940022
*     4 SCBCOREQ    BIT(1),              /* CORE QUEUES              */ 81970022
*     4 SCBREUS     BIT(1),              /* REUSEABLE DISK QUEUES    */ 82000022
*     4 SCBNREUS    BIT(1),              /* NON-REUSEABLE DISK QUEUES*/ 82030022
*     4 SCBCONC     BIT(1),              /* CONC SCB           S22026*/ 82060022
*     4 SCBNOFF     BIT(1),              /* REUS HAS UPDATED SCBFEFO */ 82090022
*     4 SCBBBFTM    BIT(1),              /* BUFFERRED TERMINAL SCB   */ 82120022
*     4 SCBBFMM     BIT(1),              /* BUFFERRED TERMINAL IN       82150022
*                                           MIDDLE OF MESSAGE        */ 82180022
*   2 SCBMRFPL    PTR(24)  BDY(BYTE),    /* ADDR OF FORWARD             82210022
*                                           PARAMETER LIST           */ 82240022
*   2 SCBERRST    FIXED(31),             /* ERROR WORD BITS          */ 82270022
*    3 SCBERR1     CHAR(1),              /* FIRST BYTE BIT              82300022
*                                           DEFINITIONS              */ 82330022
*     4 SCBHDRRN    BIT(1),              /* INCOMPLETE HEADER        */ 82360022
*      5 SCBNOLOG    BIT(1),             /* INVALID LOGON MSG  TSO   */ 82390022
*     4 SCBORIGN    BIT(1),              /* INVALID ORIGIN ON        */ 82420022
*      5 SCBHANG     BIT(1),             /* LOGON REQUEST HANGUP MSG    82450022
*                                                              TSO   */ 82480022
*     4 SCBNOTRM    BIT(1),              /* NOT A TSO TERMINAL  TSO  */ 82510022
*      5 SCBRVITX    BIT(1),            /*RVI TO TEXT REC    @OY13632*/ 82520010
*     4 SCBSEQHN    BIT(1),              /* SEQUENCE HIGH ON         */ 82540022
*      5 SCBNOTSO    BIT(1),             /* TSO NOT IN SYSTEM  TSO   */ 82570022
*     4 SCBSEQLN    BIT(1),              /* SEQUENCE LOW ON          */ 82600022
*      5 SCBNOVAC    BIT(1),             /* TOO MANY TSO USERS TSO   */ 82630022
*     4 *           BIT(1),              /* RESERVED                 */ 82660022
*     4 SCBNOBFN    BIT(1),              /* INSUFFICIENT BUFFERS     */ 82690022
*     4 SCBCUTFN    BIT(1),              /* CUTOFF ERROR             */ 82720022
*      5 SCBRVISL    BIT(1),             /* RVI TO SEL BUFRD TERM    */ 82750022
*    3 SCBERR2     CHAR(1),              /* SECOND BYTE BIT             82780022
*                                           DEFINITIONS              */ 82810022
*     4 SCBCRMIN    BIT(1),              /* CORE MINIMUM PASSED      */ 82840022
*     4 SCBCRMAX    BIT(1),              /* CORE MAXIMUM PASSED      */ 82870022
*     4 SCBCODER    BIT(1),              /* ERROR IN DYNAMIC            82900022
*                                           TRANSLATE          TSO   */ 82930022
*     4 SCBALN      BIT(1),              /* AUTOMATIC LINE              82960022
*                                           NUMBERING          TSO   */ 82990022
*     4 SCBOLTR     BIT(1),              /* TOTE NOT IN SYSTEM       */ 83020022
*     4 SCBABRTN    BIT(1),              /* ABORT - BSC TERMINAL     */ 83050022
*      5 SCBRRJN     BIT(1),             /* REQUEST REJECT -            83060010
*                                           SNA                X03039*/ 83070010
*     4 SCBFRWDN    BIT(1),              /* 'FORWARD' ERROR          */ 83080022
*     4 SCBSOHE BIT(1),                 /* SOH % E,C,R, MSG    S99238*/ 83110022
*    3 SCBERR3     CHAR(1),              /* THIRD BYTE BIT              83140022
*                                           DEFINITIONS              */ 83170022
*     4 SCBLOSTN    BIT(1),              /* MESSAGE LOST (OVERLAID)  */ 83200022
*      5 SCBXPI      BIT(1),             /* ATTENTION - SEND I TSO   */ 83230022
*     4 SCBTMIDN    BIT(1),              /* ID FROM TERMINAL INVALID */ 83260022
*      5 SCBXPD      BIT(1),             /* ATTENTION - SEND D TSO   */ 83290022
*     4 SCBTMINN    BIT(1),              /* TERMINAL INOPERATIVE     */ 83320022
*     4 SCBSATTN    BIT(1),              /* SIMULATED ATTENTION         83350022
*                                           RECEIVED           TSO   */ 83380022
*     4 SCBUSERN    BIT(1),              /* USER ERROR ON            */ 83410022
*     4 SCBFORMN    BIT(1),              /* FORMAT ERROR - BSC MSG   */ 83440022
*      5 SCBFIERN    BIT(1),             /* FUNCTION INTERPRETER        83450010
*                                           ERROR - SNA        X03039*/ 83460010
*     4 SCBATTN     BIT(1),              /* HARDWARE ATTENTION TSO   */ 83470022
*      5 SCBTHRSN    BIT(1),             /* CORE Q THRESH REACHED       83500022
*                                                              S22025*/ 83530022
*     4 SCBXCEPN    BIT(1),              /* UNIT EXCEPTION           */ 83560022
*      5 SCBPERRN    BIT(1),             /* PATH ERROR - SNA   X03039*/ 83570010
*    3 SCBERR4     CHAR(1),              /* FOURTH BYTE BIT             83590022
*                                           DEFINITIONS              */ 83620022
*     4 SCBSLCTN    BIT(1),              /* ERROR DURING SELECTION   */ 83650022
*     4 SCBTXTTN    BIT(1),              /* ERROR DURING TEXT           83680022
*                                           TRANSFER                 */ 83710022
*      5 SCBAPERR  BIT(1),              /* SET BY IGG02046 IF           83740022
*                                       PARTIAL MSG IS SENT TO MH       83770022
*                                       BY ABENDING APPLICATION         83800022
*                                       PROGRAM               SA53610*/ 83830022
*     4 SCBCONNN    BIT(1),              /* ERROR IN CONNECT OR         83860022
*                                           DISCONNECT               */ 83890022
*     4 SCBTRMLN    BIT(1),              /* TERMINAL ERROR           */ 83920022
*     4 *           BIT(1),              /* RESERVED                 */ 83950022
*     4 SCBCTLUN    BIT(1),              /* ERROR IN CONTROL UNIT    */ 83980022
*      5 SCBCPMEN    BIT(1),             /* CPM ERROR - SNA    X03039*/ 83990010
*     4 SCBCHANN    BIT(1),              /* ERROR IN CHANNEL         */ 84010022
*      5 SCBSTERN    BIT(1),             /* STATE ERROR - SNA  X03039*/ 84020010
*     4 SCBUNDFN    BIT(1),              /* UNDEFINED ERROR          */ 84040022
*   2 SCBMRFSD    FIXED(15),             /* MULT RT FIRST SECNDRY       84070022
*                                           DESTINATION              */ 84100022
*   2 SCBDLPTR    FIXED(15),             /* DISTR LIST PTR     S22025*/ 84130022
*    3 SCBEOBAC    FIXED(15),            /* ACCUMULATED COUNT           84160022
*                                           BETWEEN BLOCKS           */ 84190022
*     4 SCBCTBAC  FIXED(15),             /* COUNT OF DATA INSERTED      84220022
*                                                              S22026*/ 84250022
*      5 SCBCRLEN    CHAR(1),            /* LENGTH OF CHAR STRING       84280022
*                                                              S22025*/ 84310022
*      5 SCBENDCR    CHAR(1),            /* ITB CHAR SPECIFIED S22025*/ 84340022
*   2 SCBBSCFM    CHAR(1),               /* MSGFORM DYNAMIC BLK CHGS */ 84370022
*    3 SCBTRNSP    BIT(1),               /* RECEIVING TRANSPARENT    */ 84400022
*    3 SCBNONTR    BIT(1),               /* RECEIVING NON-TRANSPARENT*/ 84430022
*    3 SCBRCVTX    BIT(1),               /* ETX RECEIVED FROM BSC    */ 84460022
*    3 SCBCNTEN    BIT(1),               /* FOR SCHEDULER TO            84490022
*                                           DETERMINE NEXT              84520022
*                                           OPERATION          S21101*/ 84550022
*    3 SCBDATEN    BIT(1),               /* AUTO DATE/TIME EXECUTED     84580022
*                                                              S22025*/ 84610022
*                                       /* INPUT ONLY          S99238*/ 84640022
*     4 SCBNPDTR    BIT(1),             /* NO PADDING TRANSPARENT       84670022
*                                       OUTPUT ONLY            S99238*/ 84700022
*    3 *           BIT(1),               /* RESERVED                 */ 84730022
*    3 SCBNOEOT    BIT(1),               /* BSC DIAL NO EOT BEFORE      84760022
*                                           READ                     */ 84790022
*    3 SCBMLMTN    BIT(1),               /* MSGLIMIT EXCEEDED        */ 84820022
*   2 SCBMBSSA    CHAR(7),               /* MULT BFR SCAN SAVE AREA  */ 84850022
*   2 SCBCPBNO    PTR(8),                /* NEXT SEQUENTIAL CPB NO. TO  84880022
*                                           BE READ FROM DISK        */ 84910022
*   2 SCBDCHDR    PTR(24)  BDY(BYTE),    /* DISK ADDR CURRENT HDR    */ 84940022
*   2 SCBDESTL    PTR(8),                /* DEST NAME LENGTH         */ 84970022
*   2 SCBCCHDR    PTR(24)  BDY(BYTE),    /* CORE ADDR CURRENT HDR    */ 85000022
*   2 SCBITBSZ    PTR(8),                /* LOGICAL SUBBLOCK SIZE    */ 85030022
*    3 SCBCTBSV    CHAR(1),              /* CTBFORM PARMS SAVED         85060022
*                                                              S22026*/ 85090022
*     4 SCBBCTR     CHAR(1),             /* COUNTER OF BLOCKS REQ       85120022
*                                                              S22025*/ 85150022
*   2 SCBDNSEG    PTR(24)  BDY(BYTE),    /* DISK ADDR NEXT SEGMENT      85180022
*                                           FROM DISK TO SEND        */ 85210022
*    3 SCBSCSEG    PTR(24)  BDY(BYTE),   /* CURRENT SEGMENT GEING       85240022
*                                           READ                     */ 85270022
*   2 SCBHBFNO    CHAR(1),               /* MULTI-HDR BUFFER COUNT   */ 85300022
*   2 SCBCLSEG    PTR(24)  BDY(BYTE),    /* CORE ADDR LAST MSG SEG   */ 85330022
*    3 SCBSCHDR    PTR(24)  BDY(BYTE),   /* CURRENT HEADER BEING SENT*/ 85360022
*   2 SCBITBAC    PTR(8),                /* ACCUM COUNT BETWEEN ITBS */ 85390022
*    3 SCBCTBFL    CHAR(1),              /* CONC FLAG BYTE     S22026*/ 85420022
*     4 SCBBLKCT    CHAR(1),             /* NO. OF BLKS REQUESTED       85450022
*                                                              S22025*/ 85480022
*      5 SCBCTBND    BIT(1),             /* CTB END REACHED    S22026*/ 85510022
*   2 SCBDCSEG    PTR(24)  BDY(BYTE),    /* DISK ADDR CURRENT SEGMENT*/ 85540022
*    3 SCBFEFO     PTR(24)  BDY(BYTE),   /* SAVED FEFO POINTER       */ 85570022
*   2 SCBDEOB     FIXED(31),             /* DISK INFO ON LAST EOB    */ 85600022
*   2 SCBSRCE     FIXED(15),             /* MSG BFR SOURCE SAVED     */ 85630022
*   2 SCBSIZE     FIXED(15),             /* MSG BFR SIZE SAVED       */ 85660022
*   2 SCBSTAT1    CHAR(1),               /* STATUS BYTE              */ 85690022
*    3 SCBCBGN     BIT(1),               /* CONC MSG BEGIN     S22026*/ 85720022
*    3 SCBCEND     BIT(1),               /* CONC MSG END       S22026*/ 85750022
*    3 SCBNIDLE    BIT(1),               /* BFRS NOT TO BE HOOKED INTO  85780022
*                                           IDLES LOOP YET     S22026*/ 85810022
*    3 SCBNOPST    BIT(1),               /* BFRS SHOULD NOT BE POSTED   85840022
*                                                              S22026*/ 85870022
*   2 SCBCORE     PTR(24)  BDY(BYTE),    /* ADDR RCD IN CORE Q SAVED */ 85900022
*    3 SCBXTRA     PTR(24)  BDY(BYTE),   /* ADDR ADDL RCDS SAVED     */ 85930022
*   2 SCBSCAN     FIXED(15),             /* SCAN POINTER             */ 85960022
*    3 SCBOSEQ     FIXED(15),            /* SEQUENCE OUT NUMBER      */ 85990022
*   2 SCBNTXT     PTR(24)  BDY(BYTE),    /* ADDR NEXT TEST SEG SAVED */ 86020022
*    3 SCBTQBCK    CHAR(3),              /* TEXT SEG SHAIN SAVED     */ 86050022
*   2 SCBCRCD     PTR(24)  BDY(BYTE),    /* ADDR CURR SEG SAVED      */ 86080022
*   2 SCBCHDR     PTR(24)  BDY(BYTE),    /* ADDR CURR HDR SEG SAVED  */ 86110022
*    3 SCBNHDR     PTR(24)  BDY(BYTE),   /* ADDR NEXT HDR SEG SAVED  */ 86140022
*   2 SCBCCSEG    PTR(24)  BDY(BYTE),    /* CORE ADDR CURRENT SEGMENT*/ 86170022
*    3 SCBNXCPB    PTR(8),               /* NEXT CPB NUMBER FROM        86200022
*                                           DISK.  IF ZERO - NO         86230022
*                                           MULTIPLE ROUTING         */ 86260022
*   2 SCBEOB      FIXED(15),             /* POINTER TO FIRST EOB        86290022
*                                           SAVED                    */ 86320022
*   2 SCBUNTCT    PTR(8),                /* OFFSET INTO DISK RECORD OF  86350022
*                                           NEXT BYTE TO MOVE  S22024*/ 86380022
*   2 SCBTRANS    PTR(24)  BDY(BYTE),    /* ADDR OF CODE MACRO          86410054
*                                           PARAMETER LIST    SA67142*/ 86420054
*   2 SCBEND      CHAR(0);               /* END OF BASE SCB  @YM07716*/ 86430010
* DCL SCBRGSAV  CHAR(*) DEF(SCBEND);     /* SAVE AREA FOR USER MH       86440010
*                                           REGISTERS IF SPECIFIED      86470022
*                                           ON INTRO         @YM07716*/ 86500010
*%SCBSCBL='LENGTH(IEDQSCB)';            /* LENGTH OF SCB     @Y17XAXF*/ 86505010
*                                                                       86530022
*                                                                       86560022
*/*     ************************************************************ */ 86590022
*/* 0   *     STATE    *                   DESTQ                     */ 86620022
*/*     ************************************************************ */ 86650022
*/* 4   *  SNDCT/RCVCT *                 MACR/MBHEN                  */ 86680022
*/*     ************************************************************ */ 86710022
*/* 8   *     PRI      *                   BKFCT                     */ 86740022
*/*     ************************************************************ */ 86770022
*/* 2   *     QTYPE    *                   MRFPL                     */ 86800022
*/*     ************************************************************ */ 86830022
*/* 6   *                           ERRST                            */ 86860022
*/*     ************************************************************ */ 86890022
*/* 0   *            MRFSD            *            DLPTR             */ 86920022
*/*     ************************************************************ */ 86950022
*/* 4   *     BSCFM    *                   MBSSA                     */ 86980022
*/*     ************************************************************ */ 87010022
*/* 8   *                           MBSSA                            */ 87040022
*/*     ************************************************************ */ 87070022
*/* 2   *     CPBNO    *                   DCHDR                     */ 87100022
*/*     ************************************************************ */ 87130022
*/* 6   *     DESTL    *                   CCHDR                     */ 87160022
*/*     ************************************************************ */ 87190022
*/* 0   *     ITBSZ    *                 SCSEG/DNSEG                 */ 87220022
*/*     ************************************************************ */ 87250022
*/* 4   *     HBFNO    *                 SCHDR/CLSEG                 */ 87280022
*/*     ************************************************************ */ 87310022
*/* 8   *     ITBAC    *                 FEFO/DCSEG                  */ 87340022
*/*     ************************************************************ */ 87370022
*/* 2   *                          DEOB                              */ 87400022
*/*     ************************************************************ */ 87430022
*/* 6   *            SRCE             *            SIZE              */ 87460022
*/*     ************************************************************ */ 87490022
*/* 0   *     STAT1    *                 XTRA/CORE                   */ 87520022
*/*     ************************************************************ */ 87550022
*/* 4   *         OSEQ/SCAN           *          NTXT/TQBCK          */ 87580022
*/*     ************************************************************ */ 87610022
*/* 8   *  NTXT/TQBCK  *                   CRCD                      */ 87640022
*/*     ************************************************************ */ 87670022
*/* 2   *                NHDR/CHDR                   *     CCSEG     */ 87700022
*/*     ************************************************************ */ 87730022
*/* 6   *            CCSEG            *             EOB              */ 87760022
*/*     ************************************************************ */ 87790022
*/* 0   *     UNTCT    *                   TRANS                     */ 87820022
*/*     ************************************************************ */ 87850022
*/*                                                                  */ 87880022
./  ADD  SSI=71171004,NAME=TSIBD
*        %GOTO PLSSIB;                  /* BILINGUAL HEADER             01000000
         MACRO                                                          02000000
         TSIBD                                                          03000000
         SPACE                                                          04000000
.* CHANGE ACTIVITY AS FOLLOWS:                                          05000000
.*A000000-999999                                               @Y17XAXU 06000000
.*A110000,340000                                               @Y17XAXF 06300000
.*D130000,360000                                               @Y17XAXF 06600000
         SPACE                                                          07000000
IEDSIBD DSECT                                                           08000000
*                                                                       09000000
*        DSECT FOR SESSION INFORMATION BLOCK (SIB)                      10000000
*                                                                       11000000
SIBRUSEQ DS    A .                      RU SEGMENT CHAIN       @Y17XAXF 11500000
SIBCHAIN DS    A .                      NEXT SIB ADDRESS                12000000
SIBINDEX DS    H .                      TNT/MH INDEX                    14000000
SIBSESSN DS    XL1 .                    SESSION INFO FLAG               15000000
SIBLGOFF EQU   X'80' .                    LOGOFF REQUESTED              16000000
SIBSHUTC EQU   X'40' .                    SHUTDOWN COMPLETE             17000000
*                                         RECEIVED                      18000000
SIBINBIU EQU   X'20' .                    ON - IN BIU STATE             18500000
*                                         OFF-BETWEEN BIU STATE         18600000
*SIBSSTAT      X'10'-X'04'                SESSION STATE                 18700000
SIBSRSET EQU   X'0C' .                    RESET                         21180000
SIBSAPND EQU   X'04' .                    ACTIVE PENDING                21270000
SIBSRPND EQU   X'08' .                    RESET PENDING                 21330000
SIBSACTV EQU   X'1C' .                    ACTIVE                        21390000
SIBSFINL EQU   X'10' .                    FINAL                         21392000
SIBSINIT EQU   X'00' .                    INITIAL                       21394000
*SIBDSTAT      X'02'-X'01'                DATA TRAFFIC STATE            21396000
SIBDRSET EQU   X'00' .                    RESET                         21630000
SIBDAPND EQU   X'01' .                    ACTIVE PENDING                21720000
SIBDRPND EQU   X'02' .                    RESET PENDING                 21740000
SIBDACTV EQU   X'03' .                    ACTIVE                        21760000
SIBPACIN DS    XL1 .                    PACING COUNT                    21780000
SIBSEQN  DS    0F .                     SEQUENCE NUMBERS                21800000
SIBSEQI  DS    H .                      INBOUND SEQ NUMBER              21820000
SIBSEQO  DS    H .                      OUTBOUND SEQ NUMBER             21840000
SIBSTAT1 DS    XL1 .                    SNA STATE FLAG (TCAM)           21860000
SIBRQSHT EQU   X'80' .                   SHUTDOWN REQUEST ENQUEUED      21880000
SIBRQEND EQU   X'40' .                   END-SESSION REQUEST ENQUEUED   21885000
SIBFTERM EQU   X'20' .                   FORCED TERMINATE IN   @YM08991 21890010
*                                        PROGRESS              @YM08991 21910010
SIBRTRP  EQU   X'10' .                   RTR PENDING STATE              21930000
*SIBBSTAT      X'08'-X'01' .             BRACKET STATES                 21980000
SIBBETB  EQU   X'00' .                    BETWEEN BRACKET STATE(BETB)   21980900
SIBPINB  EQU   X'01' .           PENDING IN BRACKETS(PEND.INQ) @YM06886 21981800
SIBINB   EQU   X'02' .           IN BRACKET STATE(INC)         @YM06886 21982200
SIBPBB   EQU   X'03' .           PENDING BEGIN BRACKETS        @YM06886 21982700
*                                          (PEND.BB)                    21983600
SIBRSPR  EQU   X'04' .           PENDING BETWEEN BRACKETS      @YM06886 21984500
*                                          WAITING FOR RESPONSE TO BE   21985400
*                                          SENT(PEND.BETB.PSR.R)        21986300
SIBECR   EQU   X'05' .           PENDING BETWEEN BRACKETS      @YM06886 21987200
*                                          WAITING TO RECEIVE END CHAIN 21988100
*                                          (PEND.BETB.EC.R)             21989000
SIBPURGR EQU   X'06' .           PENDING BETWEEN BRACKETS      @YM06886 21989900
*                                          IN PURGING CHAIN STATE AND   21990800
*                                          WAITING TO RECEIVE END       21991700
*                                          CHAIN(PEND.BETB.PURGE.R)     21992600
SIBRSPS  EQU   X'07' .           PENDING BETWEEN BRACKETS      @YM06886 21993500
*                                          WAITING TO RECEIVE RESPONSE  21994400
*                                          (PEND.BETB.RSP.S)            21995300
SIBECS   EQU   X'08' .           PENDING BETWEEN BRACKETS      @YM06886 21996200
*                                          WAITING FOR END CHAIN TO     21997100
*                                          BE SENT(PEND.BETB.EC.S)      21998000
SIBSTAT2 DS    XL1 .                    SNA STATE FLAG (OP CONTROL)     22000000
SIBUSS   EQU   X'80' .                    ORIGINAL BUFFER WAS UNFORMAT  22200000
SIBTERM  EQU   X'40' .                    TERM IN PROGRESS              22400000
SIBRDSCN EQU   X'20' .                    REQUEST DISCONTACT (NORMAL)   22600000
*                                         IN PROGRESS                   22800000
SIBDACLU EQU   X'10' .                    DACTLU PENDING                22802000
*        EQU   X'08'-X'01'                RESERVED                      22804000
SIBTSPRO DS    XL1 .                    TS PROFILE                      22806000
SIBFMPRO DS    XL1 .                    FM PROFILE                      24000000
SIBBIND  DS    0XL3 .                   BIND PARAMETERS                 25000000
SIBBIND1 DS    XL1 .                     BYTE ONE                       25001000
SIBPCHN  EQU   X'80' .                    PLU CHAINING USE              25002000
SIBPRQM  EQU   X'40' .                    PLU REQUEST MODE              25003000
SIBPDEF  EQU   X'20' .                    PLU DEFINITE RESPONSE         25004000
SIBPEXC  EQU   X'10' .                    PLU EXCEPTION RESPONSE        25005000
SIBPCMP  EQU   X'08' .                    PLU COMPRESSION               25006000
SIBPEBI  EQU   X'04' .                    PLU EB INDICATOR              25007000
SIBSCHNG EQU   X'02' .                    SLU CHAINING USE              25008000
SIBSRQM  EQU   X'01' .                    SLU REQUEST MODE              25009000
SIBBIND2 DS    XL1 .                     BYTE TWO                       25010000
SIBSDEF  EQU   X'80' .                    SLU DEFINITE RESPONSE         25011000
SIBSEXC  EQU   X'40' .                    SLU EXCEPTION RESPONSE        25012000
SIBSCMP  EQU   X'20' .                    SLU COMPRESSION               25013000
SIBSEBI  EQU   X'10' .                    SLU EB INDICATOR              25014000
SIBFMUSE EQU   X'08' .                    FM HEADER USAGE               25015000
SIBBRACK EQU   X'04' .                    BRACKETS                      25016000
SIBBTERM EQU   X'02' .                    BRACKET TERMINATION           25017000
SIBALT   EQU   X'01' .                    ALTERNATE CODE                25018000
SIBBIND3 DS    XL1 .                     BYTE THREE                     25019000
*SIBFMODE EQU  X'80'-X'40'                FM TRANSACTION MODE           25020000
SIBHDXFF EQU   X'80' .                     HALF DUPLEX FLIP-FLOP        25020300
SIBHDXCN EQU   X'40' .                     HALF DUPLEX CONTENTION       25020600
SIBRECV  EQU   X'20' .                    RECOVERY RESPONSIBILITY       25021000
SIBSPKR  EQU   X'10' .                    BRACKETS 1ST SPEAKER          25022000
SIBCRES  EQU   X'08' .                    CONTENTION RESOLUTION         25023000
*        EQU   X'04'-X'01' .              RESERVED                      25024000
SIBSTAT0 DS    XL1 .                    SNA STATE FLAG(TCAM)            25025000
SIBCD    EQU   X'80'                      TERMINAL HAS CD STATE         25026000
*SIBLUTYP      X'40'-X'01'                LU TYPE                       25027000
SIBLU0   EQU   X'00' .                     LU TYPE 0                    25027700
SIBLU1   EQU   X'01' .                     LU TYPE 1                    25028400
SIBLU2   EQU   X'02' .                     LU TYPE 2                    25029100
SIBLEN   EQU   *-IEDSIBD .              LENGTH OF SIB                   25030000
         SPACE 2                                                        27000000
         MEND                           */                              28000000
*%PLSSIB : ;                                                            29000000
*DECLARE                                                                30000000
*  1 IEDSIBD BDY(WORD) BASED,                                           31000000
*/*                                                                  */ 32000000
*/*      DSECT FOR SESSION INFORMATION BLOCK (SIB)                   */ 33000000
*/*                                                                  */ 34000000
*   2 SIBRUSEG PTR(31),                 /* RU SEGMENT CHAIN  @Y17XAXF*/ 34500000
*   2 SIBCHAIN PTR(31),                 /* NEXT SIB ADDRESS          */ 35000000
*   2 SIBINDEX FIXED(16),               /* TNT/MH INDEX              */ 37000000
*   2 SIBSESSN CHAR(1),                 /* SESSION INFO FLAG         */ 38000000
*    3 SIBLGOFF BIT(1),                   /* LOGOFF REQUESTED        */ 39000000
*    3 SIBSHUTC BIT(1),                   /* SHUTDOWN COMPLETE          40000000
*                                            RECEIVED                */ 41000000
*    3 SIBINBIU BIT(1),                   /* ON -IN BIU STATE        */ 42000000
*                                         /* OFF-BETWEEN BIU STATE   */ 42600000
*    3 SIBSSTAT BIT(3),                   /* SESSION STATE           */ 42700000
*    3 SIBDSTAT BIT(2),                   /* DATA TRAFFIC STATE      */ 42800000
*   2 SIBPACIN BIT (8),                 /* PACING COUNT              */ 43000000
*    3 SIBMCNT BIT(4),                  /* M COUNT                   */ 43300000
*    3 SIBNCNT BIT(4),                  /* N COUNT                   */ 43600000
*   2 SIBSEQN FIXED(32),                /* SEQUENCE NUMBER           */ 44000000
*    3 SIBSEQI FIXED(16),               /* INBOUND SEQ NUMBER        */ 44300000
*    3 SIBSEQO FIXED(16),               /* OUTBOUND SEQ NUMBER       */ 44600000
*   2 SIBSTAT1 BIT(8),                  /* SNA STATE FLAG (TCAM)     */ 45000000
*    3 SIBRQSHT BIT(1),                   /* SHUTDOWN REQUEST ENQUEUED  45600000
*                                                                    */ 45605000
*    3 SIBRQEND BIT(1),                   /* END-SESSION REQUEST        45610000
*                                                                    */ 45615000
*    3 SIBFTERM BIT(1),                   /* FORCD TERMINATE @YM08991*/ 45620010
*                                         /* IN PROGRESS     @YM08991*/ 45660010
*    3 SIBRTRP  BIT(1),                   /* RTR PENDING STATE       */ 45710000
*    3 SIBBSTAT BIT(4),                   /* BRACKET STATES          */ 45800000
*   2 SIBSTAT2 BIT(8),                  /* SNA STATE FLAG (OP CTL)   */ 46000000
*    3 SIBUSS   BIT(1),                   /* ORIGINAL BUFFER WAS        46200000
*                                            UNFORMATTED             */ 46300000
*    3 SIBTERM  BIT(1),                   /* TERM IN PROGRESS        */ 46400000
*    3 SIBRDSCN BIT(1),                   /* REQUEST DISCONTACT (NORM)  46600000
*                                            IN PROGRESS             */ 46800000
*    3 SIBDACLU BIT(1),                   /* DEACTLU PENDING         */ 46802000
*    3 *        BIT(4),                   /* RESERVED                */ 46804000
*   2 SIBTSPRO FIXED(8),                /* TS PROFILE                */ 46806000
*   2 SIBFMPRO FIXED(8),                /* FM PROFILE                */ 48000000
*   2 SIBBIND CHAR(3),                  /* BIND PARAMETERS           */ 49000000
*    3 SIBBIND1 CHAR(1),                /*  BYTE 1                   */ 49001000
*     4 SIBPCHN  BIT(1),                /*   PLU CHAINING USE        */ 49002000
*     4 SIBPRQM  BIT(1),                /*   PLU REQUEST MODE        */ 49003000
*     4 SIBPDEF  BIT(1),                /*   PLU DEFINITE RESPONSE   */ 49004000
*     4 SIBPEXC  BIT(1),                /*   PLU EXCEPTION RESPONSE  */ 49005000
*     4 SIBPCMP  BIT(1),                /*   PLU COMPRESSION         */ 49006000
*     4 SIBPEBI  BIT(1),                /*   PLU EB INDICATOR        */ 49007000
*     4 SIBSCHNG BIT(1),                /*   SLU CHAINING USE        */ 49008000
*     4 SIBSRQM  BIT(1),                /*   SLU REQUEST MODE        */ 49009000
*    3 SIBBIND2 CHAR(1),                /*  BYTE 2                   */ 49010000
*     4 SIBSDEF  BIT(1),                /*   SLU DEFINITE RESPONSE   */ 49011000
*     4 SIBSEXC  BIT(1),                /*   SLU EXCEPTION RESPONSE  */ 49012000
*     4 SIBSCMP  BIT(1),                /*   SLU COMPRESSION         */ 49013000
*     4 SIBSEBI  BIT(1),                /*   SLU EB INDICATOR        */ 49014000
*     4 SIBFMUSE BIT(1),                /*   FM HEADER USAGE         */ 49015000
*     4 SIBBRACK BIT(1),                /*   BRACKETS                */ 49016000
*     4 SIBBTERM BIT(1),                /*   BRACKET TERMINATION     */ 49017000
*     4 SIBALT   BIT(1),                /*   ALTERNATE CODE          */ 49018000
*    3 SIBBIND3 CHAR(1),                /*  BYTE 3                   */ 49019000
*     4 SIBFMODE BIT(2),                /*   FM TRANSACTION MODE     */ 49020000
*     4 SIBRECOV BIT(1),                /*   RECOVERY RESPONSIBILITY */ 49021000
*     4 SIBSPKR  BIT(1),                /*   BRACKETS 1ST SPEAKER    */ 49022000
*     4 SIBCRES  BIT(1),                /*   CONTENTION RESOLUTION   */ 49023000
*     4 *        BIT(3),                /*   RESERVED                */ 49024000
*   2 SIBSTAT0 BIT(8),                  /* SNA STATE FLAG (TCAM)     */ 49025000
*    3 SIBCD    BIT(1),                 /*  TERMINAL HAS CD STATE    */ 49026000
*    3 SIBLUTYP BIT(7);                 /*  LU TYPE                  */ 49027000
* %SIBLEN='LENGTH(IEDSIBD)';            /* LENGTH OF SIB             */ 49030000
*                                                                       50080000
*/*      SIBLUTYP VALUES                                             */ 50090000
* DCL SIBLU0   BIT(7) CONSTANT('0000000'B); /* LU TYPE 0             */ 50100000
* DCL SIBLU1   BIT(7) CONSTANT('0000001'B); /* LU TYPE 1             */ 50110000
* DCL SIBLU2   BIT(7) CONSTANT('0000010'B); /* LU TYPE 2             */ 50120000
*/*      SIBFMODE VALUES                                             */ 50130000
* DCL SIBHDXFF BIT(2) CONSTANT('10'B); /* HALF DUPLEX FLIP-FLOP      */ 50140000
* DCL SIBHDXCN BIT(2) CONSTANT('01'B); /* HALF DUPLEX CONTENTION     */ 50150000
*/*      SIBSSTAT FLAGS                                              */ 50160000
* DCL SIBSINIT BIT(3) CONSTANT('000'B); /* INITIAL                   */ 50240000
* DCL SIBSAPND BIT(3) CONSTANT('001'B); /* ACTIVE PENDING            */ 50320000
* DCL SIBSRPND BIT(3) CONSTANT('010'B); /* RESET PENDING             */ 50400000
* DCL SIBSRSET BIT(3) CONSTANT('011'B); /* RESET                     */ 50480000
* DCL SIBSFINL BIT(3) CONSTANT('100'B); /* FINAL                     */ 50482000
* DCL SIBSACTV BIT(3) CONSTANT('111'B); /* ACTIVE                    */ 50484000
*/*      SIBBSTAT VALUES                                             */ 50484100
* DCL SIBBETB  BIT(4) CONSTANT('0000'B); /* BETWEEN BRACKET STATE       50484200
*                                          (BETB)                    */ 50484300
* DCL SIBPINB  BIT(4) CONSTANT('0001'B); /* PENDING IN BRACKETS         50484400
*                                          (PEND.IND)                */ 50484500
* DCL SIBPBB   BIT(4) CONSTANT('0011'B); /* PENDING BEGIN BRACKETS      50484600
*                                          (PEND.BB)                 */ 50484700
* DCL SIBRSPR  BIT(4) CONSTANT('0100'B); /* PENDING BETWEEN BRACKETS    50484800
*                                           WAITING FOR RESPONSE TO BE  50484900
*                                           SENT (PEND.BETB.RSP.R)   */ 50485000
* DCL SIBECR   BIT(4) CONSTANT('0101'B); /* PENDING BETWEEN BRACKETS    50485100
*                                           WAITING TO RECEIVE END      50485200
*                                           CHAIN(PEND.BETB.EC.R)    */ 50485300
* DCL SIBPURGR BIT(4) CONSTANT('0110'B); /* PENDING BETWEEN BRACKETS    50485400
*                                           IN PURGING CHAIN STATE AND  50486000
*                                           WAITING TO RECEIVE END      50496000
*                                           CHAIN(PEND.BETB.PURGE.R) */ 50506000
* DCL SIBRSPS  BIT(4) CONSTANT('0111'B); /* PENDING BETWEEN BRACKETS    50516000
*                                           WAITING TO RECEIVE RESPONSE 50526000
*                                           (PEND.BETB.RSP.S)        */ 50536000
* DCL SIBECS   BIT(4) CONSTANT('1000'B); /* PENDING BETWEEN BRACKETS    50546000
*                                           WAITING FOR END CHAIN TO    50556000
*                                           BE SENT(PEND.BETB.EC.S)  */ 50566000
* DCL SIBINB   BIT(4) CONSTANT('0010'B); /* IN BRACKET STATE(INC)    */ 50576000
*/*      SIBDSTAT FLAGS                                              */ 50586000
* DCL SIBDRSET BIT(2) CONSTANT('00'B);  /* RESET                     */ 50640000
* DCL SIBDAPND BIT(2) CONSTANT('01'B);  /* ACTIVE PENDING            */ 50720000
* DCL SIBDRPND BIT(2) CONSTANT('10'B);  /* RESET PENDING             */ 50800000
* DCL SIBDACTV BIT(2) CONSTANT('11'B);  /* ACTIVE                    */ 50880000
*                                                                       51000000
*%SIBEND: ;                             /* END OF SIB                */ 52000000
*                                                                       53000000
./  ADD  SSI=71181406,NAME=TSNSD
*        %GOTO PLSSNS;                                               /* 00000100
         MACRO                                                          01000100
         TSNSD                                                          02000100
.*A000000-999999                                               @Y17XAXG 03000100
IEDSNSD  DSECT                                                          04000100
*               SENSE BYTE DSECT                                        05000100
SNSSYSTM DS    0XL2                     SYSTEM SENSE BYTES              06000100
SNSMAJ   DS    XL1                      MAJOR SENSE BYTE                07000100
SNSPATH  EQU   X'80'                    PATH ERROR                      08000100
SNSRHUSE EQU   X'40'                    RH USAGE ERROR                  09000100
SNSSTERR EQU   X'20'                    STATE ERROR                     10000100
SNSRQERR EQU   X'10'                    REQUEST ERROR                   11000100
SNSRQREJ EQU   X'08'                    REQUEST REJECT                  12000100
SNSMIN   DS    XL1                      MINOR SENSE BYTE                13000100
*    REQUEST FOR PATH ERROR BYTES                                       14000100
SNSLNKF  EQU   X'02'                    DATA LINK FAILURE               15000100
SNSLUINP EQU   X'03'                    LU INOPERATIVE         @YM08991 15500110
SNSLOSCT EQU   X'0D'                    LOST CONTACT                    16000100
*    REQUEST ERROR MINOR SENSE BYTES                                    17000100
SNSRUDAT EQU   X'01'                    RU DATA ERROR                   18000100
SNSRULEN EQU   X'02'                    RU LENGTH ERROR                 19000100
SNSNFUNC EQU   X'03'                    FUNCTION NOT SUPPORTED          20000100
SNSNCAT  EQU   X'07'                    CATEGORY NOT SUPPORTED          21000100
SNSINVHD EQU   X'08'                    INVALID FM HEADER               22000100
*    REQUEST REJECT MINOR SENSE BYTES                                   23000100
SNSRNAV  EQU   X'01'                    RESOURCE NOT AVAILABLE          24000100
SNSIVREQ EQU   X'02'                    INTERVENTION REQUIRED           24500100
SNSMPSWD EQU   X'03'                    MISSING PASSWORD                25000100
SNSSLIM  EQU   X'05'                    SESSION LIMIT EXCEEDED          26000100
SNSMODIN EQU   X'09'                    MODE INCONSISTENCY              27000100
SNSBRACE EQU   X'0B'                    BRACKET RACE ERROR              28000100
SNSPRCNS EQU   X'0C'                    PROCEDURE NOT SUPPORTED         29000100
SNSCNCL  EQU   X'11'                    CANCEL KEY HIT                  30000100
SNSNRSCE EQU   X'12'                    INSUFFICIENT RESOURCE           31000100
SNSNACT  EQU   X'16'                    FUNCION INATIVE                 32000100
SNSNRTR  EQU   X'19'                    RTR NOT REQUIRED                33000100
SNSSRFER EQU   X'1E'                    SESSION REFERENCE ERROR         34000100
SNSUNCTL EQU   X'23'                    UNKNOWN CONTROL VECTOR          35000100
SNSINTRQ EQU   X'80'                    INTERVENTION REQUIRED           36000100
SNSRCXMT EQU   X'1B'                    RECEIVER IN TRANSMIT MODE       37000100
SNSNGRB  EQU   X'13'                    NEGATIVE RESP TO BID            38000100
SNSRTRY  EQU   X'27'                    RETRY REQUESTED                 39000100
SNSACTV  EQU   X'15'                    FUNCTION ALREADY ACTIVE         40000100
SNSUSER  DS    0XL2                     USER SENSE BYTES                41000100
SNSUSR1  DS    XL1                      FIRST USER BYTE                 42000100
SNSUSR2  DS    XL1                      SECOND USER BYTE                43000100
         MEND                                                        */ 44000100
*%PLSSNS : ;                                                            45000100
*DECLARE 1 IEDSNSD BASED(SNSPTR),       /* SENSE BYTE STRUCTURE      */ 46000100
*          2 SNSSYSTM  CHAR(2),        /* SYSTEM SENSE BYTES        */  47000100
*            3 SNSMAJ  BIT(8),          /* MAJOR SENSE BYTE          */ 48000100
*            3 SNSMIN  BIT(8),          /* MINOR SENSE BYTE          */ 49000100
*          2 SNSUSER   CHAR(2),        /* USER SENSE BYTES          */  50000100
*            3 SNSUSR1 BIT(8),          /* FIRST USER BYTE           */ 51000100
*            3 SNSUSR2 BIT(8);          /* SECOND USER BYTE          */ 52000100
*/*                                                                  */ 53000100
*/*            REQUEST FOR PATH ERROR BYTES                          */ 54000100
*/*                                                                  */ 55000100
*DCL SNSLNKF  BIT(8) CONSTANT('02'X);   /* DATA LINK FAILURE         */ 56000100
*DCL SNSLUINP BIT(8) CONSTANT('03'X);   /* LU INOPERATIVE    @YM08991*/ 56500110
*DCL SNSLOSCT BIT(8) CONSTANT('0D'X);   /* LOST CONTACT              */ 57000100
*/*                                                                  */ 58000100
*/*            CONSTANTS TO BE USED WITH MAJOR SENSE                 */ 59000100
*/*                                                                  */ 60000100
*DCL SNSPATH BIT(8) CONSTANT('80'X);    /* PATH ERROR               */  61000100
*DCL SNSRHUSE BIT(8) CONSTANT('40'X);   /* RH USAGE ERROR            */ 62000100
*DCL SNSSTERR BIT(8) CONSTANT('20'X);   /* STATE ERROR               */ 63000100
*DCL SNSRQERR BIT(8) CONSTANT('10'X);   /* REQUEST ERROR             */ 64000100
*DCL SNSRQREJ BIT(8) CONSTANT('08'X);   /* REQUEST REJECT            */ 65000100
*/*                                                                  */ 66000100
*/*            CONSTANTS TO BE USED WITH MINOR SENSE                 */ 67000100
*/*                                                                  */ 68000100
*/*                                                                  */ 69000100
*/*  REQUEST ERROR MINOR SENSE BYTES                                 */ 70000100
*/*                                                                  */ 71000100
*DCL SNSRUDAT BIT(8) CONSTANT('01'X);   /* RU DATA ERROR             */ 72000100
*DCL SNSRULEN BIT(8) CONSTANT('02'X);   /* RU LENGTH ERROR           */ 73000100
*DCL SNSNFUNC BIT(8) CONSTANT('03'X);   /* FUNCTION NOT SUPPORTED    */ 74000100
*DCL SNSNCAT  BIT(8) CONSTANT('07'X);   /* CATEGORY NOT SUPPORTED    */ 75000100
*DCL SNSINVHD BIT(8) CONSTANT('08'X);   /* INVALID FM HEADER         */ 76000100
*/*                                                                  */ 77000100
*/*  REQUEST REJECT MINOR SENSE BYTES                                */ 78000100
*/*                                                                  */ 79000100
*DCL SNSRNAV  BIT(8) CONSTANT('01'X);   /* RESOURCE NOT AVAILABLE    */ 80000100
*DCL SNSIVREQ BIT(8) CONSTANT('02'X);   /* INTERVENTION REQUIRED     */ 80500100
*DCL SNSMPSWD BIT(8) CONSTANT('03'X);   /* MISSING PASSWORD          */ 81000100
*DCL SNSSLIM  BIT(8) CONSTANT('05'X);   /* SESSION LIMIT EXCEEDED    */ 82000100
*DCL SNSMODIN BIT(8) CONSTANT('09'X);   /* MODE INCONSISTENCY        */ 83000100
*DCL SNSBRACE BIT(8) CONSTANT('0B'X);   /* BRACKET RACE ERROR        */ 84000100
*DCL SNSPRCNS BIT(8) CONSTANT('0C'X);   /* PROCEDURE NOT SUPPORTED   */ 85000100
*DCL SNSCNCL  BIT(8) CONSTANT('11'X);   /* CANCEL KEY HIT            */ 86000100
*DCL SNSNRSCE BIT(8) CONSTANT('12'X);   /* INSUFFICIENT RESOURCE     */ 87000100
*DCL SNSNACT  BIT(8) CONSTANT('16'X);   /* FUNCTION INACTIVE         */ 88000100
*DCL SNSNRTR  BIT(8) CONSTANT('19'X);   /* RTR NOT REQUIRED          */ 89000100
*DCL SNSSRFER BIT(8) CONSTANT('1E'X);   /* SESSION REFERENCE ERROR   */ 90000100
*DCL SNSUNCTL BIT(8) CONSTANT('23'X);   /* UNKNOWN CONTROL VECTOR    */ 91000100
*DCL SNSINTRQ BIT(8) CONSTANT('80'X);   /* INTERVENTION REQUIRED     */ 92000100
*DCL SNSRCXMT BIT(8) CONSTANT('1B'X);   /* RECEIVER IN TRANSMIT MODE */ 93000100
*DCL SNSNGRB  BIT(8) CONSTANT('13'X);   /* NEGATIVE RESP TO BID      */ 94000100
*DCL SNSRTRY  BIT(8) CONSTANT('27'X);   /* RETRY REQUESTED           */ 95000100
*DCL SNSACTV  BIT(8) CONSTANT('15'X);   /* FUNCTION ALREADY ACTIVE   */ 96000100
*/*                                                                  */ 97000100
./  ADD  SSI=61970031,NAME=TSOECDD
*        %GOTO PLSTSOEC;       /*                                       01000010
         MACRO                                                          02000010
         TSOECDD                                                        04000010
*   ENTRY FROM SEND SCHEDULER OR DESTINATION SCHEDULER ON QCB POST      05000010
TSOA01   EQU   1                                                        12000010
*   ENTRY FROM SEND SCHEDULER ON PLCB POST                              13000010
TSOA02   EQU   2                                                        16000010
*   ENTRY FROM RECEIVE SCHEDULER ON PLCB POST                           17000010
TSOA03   EQU   3                                                        20000010
         MEND  */                                                       20200010
*%PLSTSOEC : ;                                                          20400010
*/*  ENTRY FROM SEND SCHEDULER OR DESTINATION SCHEDULER ON QCB POST  */ 20600010
* DCL TSOA01   FIXED(8) CONSTANT(1);                                    20800010
*/*  ENTRY FROM SEND SCHEDULER ON PLCB POST                          */ 21000010
* DCL TSOA02   FIXED(8) CONSTANT(2);                                    21200010
*/*  ENTRY FROM RECEIVE SCHEDULER ON PLCB POST                       */ 21400010
* DCL TSOA03   FIXED(8) CONSTANT(3);                                    21600010
./  ADD  SSI=60241539,NAME=TSTCBD
*        %GOTO PLSSTCB; /*                                       X03039 03000010
         MACRO                                                          08000020
         TSTCBD                                                         16000020
.*A-000000-999999                                              @X31X8X0 17000010
.*D400000,640000                                                 S22027 18000022
.*A610000-660000                                                 S22027 20000022
.*C880000                                                        X03039 21000010
.*A890000-970000                                                 X03039 22000010
IEDQSTCB DSECT .                  SUBTASK CONTROL BLOCK                 24000020
         SPACE 2                                                        32000020
         SPACE 1                                                        48000020
STCBVTO  DS    XL1 .         ACTIVATION KEY          + 0                56000020
STCBINDX DS    XL1 .         INDEX TO COMMON BUFFER DATA AREA    S22027 61000022
STCBTCIN DS    H .           TTCIN OF DESTINATION TERMINAL       S22027 66000022
STCBPRI  DS    XL1 .         PRIORITY                + 4                72000020
STCBLINK DS    XL3 .         LINK FIELD              + 5                80000020
         MEND , */                                               X03039 88000010
*%PLSSTCB: ;                            /* STCB DSECT          X03039*/ 89000010
*DECLARE                                /*                     X03039*/ 90000010
*  1 IEDQSTCB BDY(WORD) BASED,          /*                     X03039*/ 91000010
*   2 STCBVTO  CHAR(1),                 /* ACTIVATION KEY      X03039*/ 92000010
*   2 STCBINDX CHAR(1),                 /* INDEX TO COMMON     X03039*/ 93000010
*                                       /* BUFFER DATA AREA    X03039*/ 94000010
*   2 STCBTCIN FIXED(15),               /* TTCIN OF DEST TRM   X03039*/ 95000010
*   2 STCBPRI  CHAR(1),                 /* PRIORITY            X03039*/ 96000010
*   2 STCBLINK PTR(24);                 /* LINK FIELD          X03039*/ 97000010
./  ADD  SSI=70110500,NAME=TSTMHD
*        %GOTO STMHPLS;                 /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TSTMHD &DSECT=YES                                              03000010
.*A000000-999999                                               @Y17XAXF 04000010
         AIF   ('&DSECT' EQ 'YES').STMH001   IS DSECT STATEMENT REQ?    05000010
IEDSTMH  DS    0F                                                       06000010
         AGO   .STMH002                                                 07000010
.STMH001 ANOP                                                           08000010
IEDSTMH  DSECT                                                          09000010
         DS    0F                                                       10000010
.STMH002 ANOP                                                           11000010
*                                                                       12000010
*        DSECT FOR STARTMH GENERATION                                   13000010
*                                                                       14000010
STMHALT  DS    AL4 .               ALTERNATE MH ADDR                    15000010
STMHFLG2 DS    XL1 .               MH FLAGS                             16000010
STMHLCIN EQU   X'80' .                  LINE CONTROL IN                 17000010
STMHCONT EQU   X'40' .                  CONT= SPECIFIED                 18000010
STMHSTC  EQU   X'20' .                  CONT= OR STOP= SPECIFIED OPTION 19000010
STMHCONV EQU   X'10' .                  CONV= SPECIFIED                 20000010
STMHCOP  EQU   X'08' .                  CONV= SPECIFIED OPTION FIELD    21000010
STMHLOG  EQU   X'04' .                  LOGICAL= SPECIFIED              22000010
STMHLOP  EQU   X'02' .                  LOGICAL= SPECIFIED 2ND OPTION   23000010
STMHTSFG EQU   X'01' .                  TSO FLAG                        24000010
STMHTSO  DS    AL3 .               TSO REENTRY ADDR                     25000010
STMHLENG DS    AL1 .               PARAMETER LIST LENGTH                26000010
STMHSTCB DS    AL3 .               STCB ADDRESS                         27000010
STMHAEIX DS    XL1 .               OFFSET TO LOCOPT IF REQ              28000010
STMHLMDO EQU   X'02' .              LMD SPECIFIED IN OPTION             29000010
STMHLMD  EQU   X'01' .              LMD SPECIFIED                       30000010
STMHROUT DS    AL3 .               ADDRESS OF STARTMH STCB              31000010
STMHLOPO DS    AL1 .               POINTER TO LOGICAL= OPTION           32000010
STMHLMOP DS    0AL1 .              OPTION FIELD INDEX                   33000010
STMHCOPO DS    AL1 .               POINTER TO CONV= OPTION              34000010
STMHOPT  EQU   * .                 START OF OPTION POINTERS             35000010
STMHLEN  EQU   *-IEDSTMH .         LENGTH OF DSECT                      36000010
         MEND                                                           37000010
*                                                                    */ 38000010
*%STMHPLS:;                                                             39000010
*        %IF STMHLEN¬=''                /* IS DCL STATEMENT REQUIRED */ 40000010
*          %THEN %GOTO STMHPLS1;                                        41000010
*DECLARE                                                                42000010
*  1 IEDSTMH  BASED BDY(WORD),                                          43000010
*        %GOTO STMHPLS2;                                                44000010
*%STMHPLS1:;                                                            45000010
*    2 IEDSTMH  CHAR(9) BDY(WORD),                                      46000010
*%STMHPLS2:;                                                            47000010
*/*                                                                  */ 48000010
*/*      DSECT FOR STARTMH GENERATION                                */ 49000010
*/*                                                                  */ 50000010
*      3 STMHALT  PTR(31),              /* ALTENTAE MH ADDR          */ 51000010
*      3 STMHFLG2 CHAR(1),              /* MH FLAGS                  */ 52000010
*        4 STMHLCIN BIT(1),             /*   LINE CONTROL IN         */ 53000010
*        4 STMHCONT BIT(1),             /*   CONT= SPECIFIED         */ 54000010
*        4 STMHSTC  BIT(1),             /*   CONT= OR STOP= SPEC OPT */ 55000010
*        4 STMHCONV BIT(1),             /*   CONV= SPECIFIED         */ 56000010
*        4 STMHCOP  BIT(1),             /*   CONV= SPECIFIED OPT FLD */ 57000010
*        4 STMHLOG  BIT(1),             /*   LOGICAL= SPECIFIED      */ 58000010
*        4 STMHLOP  BIT(1),             /*   LOGICAL= SPEC 2ND OPTION*/ 59000010
*        4 STMHTSFG BIT(1),             /*   TSO FLAG                */ 60000010
*      3 STMHTSO PTR(24),               /* TSO REENTRY ADDR          */ 61000010
*      3 STMHLENG CHAR(1),              /* PARAMETER LIST LENGTH     */ 62000010
*      3 STMHSTCB PTR(24),              /* STCB ADDRESS              */ 63000010
*      3 STMHAEIX BIT(8),               /* OFFSET TO LOCOPT IF REQ   */ 64000010
*        4 *        BIT(6),             /*  RESERVED                 */ 65000010
*        4 STMHLMDO BIT(1),             /*  LMD SPEC IF OPTION       */ 66000010
*        4 STMHLMD  BIT(1),             /*  LMD SPECIFIED            */ 67000010
*      3 STMHROUT PTR(24),              /* ADDR OF STARTMH STCB      */ 68000010
*      3 STMHLOPO PTR(8),               /* PTR TO LOGICAL OPTION     */ 69000010
*      3 STMHLMOP PTR(8),               /* OPTION FIELD INDEX        */ 70000010
*        4 STMHCOPO PTR(8),             /*  PTR TO CONV= OPT         */ 71000010
*      3 STMHOPT CHAR(0);               /* START OF OPTION FLD PTRS  */ 72000010
* %STMHLEN='LENGTH(IEDSTMH)';           /* LEN OF DSECT              */ 73000010
./  ADD  SSI=62530515,NAME=TSTMHND
*        %GOTO STMHNPLS;                /* BILINGUAL HEADER             03000010
         MACRO                                                          06000010
         TSTMHND                                                        09000010
.*A000000-999999                                               @Y17XAXF 12000010
IEDNSTMH DSECT                                                          15000010
         DS    0F                                                       18000010
*                                                                       21000010
*        DSECT FOR PREFIX OF STARTMH GENERATION                         24000010
*                                                                       27000010
STMHUNBR DS    A .                 VCON FOR IEDUNBND                    28000010
STMHUBXT DS    A .                 ADDR OF USERS UNBIND EXIT            29000010
STMHFLG0 DS    XL1 .               MH FLAGS                             30000010
STMHDFCP EQU   X'80' .                  PARTIAL DFC RESPONSE SUPPORT    33000010
STMHDFC  EQU   X'40' .                  FULL DFC RESPONSE SUPPORT       36000010
STMHUNBD EQU   X'20'                    UNBIND EXIT OPERAND SPECIFIED   39000010
*        EQU   X'10' THRU X'01' .       RESERVED                        40000010
STMHBEXT DS    XL3 .               BIND EXIT ADDR                       42000010
STMHNLEN EQU   *-IEDNSTMH .        LEN OF MH PREFIX                     45000010
         MEND                                                           48000010
*        */                                                             51000010
*%STMHNPLS:;                                                            54000010
*        %IF STMH9999¬=','              /* DECIDE IF CONCATENATION   */ 57000010
*            %THEN %STMH9999=';';       /*   IS REQUESTED            */ 60000010
*DECLARE                                                                63000010
*  1 IEDNSTMH BASED BDY(WORD),                                          66000010
*/*                                                                  */ 69000010
*/*      DSECT FOR PREFIX OF STARTMH GENERATION                      */ 72000010
*/*                                                                  */ 75000010
*    2 STMHUNBR PTR(31),                /* VCON TO IEDUNBND          */ 78000010
*    2 STMHUBXT PTR(31),                /* ADDR OF USERS UNBIND EXIT */ 79000010
*    2 STMHFLG0 CHAR(1),                /* MH FLAGS                  */ 80000010
*      3 STMHDFCP BIT(1),               /*   PARTIAL DFC RESPONSE SUP*/ 81000010
*      3 STMHDFC  BIT(1),               /*   FULL DFC RESPONSE SUP   */ 84000010
*      3 STMHUNBD BIT(1),               /*   UNBIND EXIT OPERAND        87000010
*                                             SPECIFIED              */ 88000010
*      3 *        BIT(5),               /*   RESERVED                */ 89000010
*                                                                       90000010
*    2 STMHBEXT PTR(24) STMH9999        /* BIND EXIT ADDR            */ 93000010
* %STMHNLEN='LENGTH(IEDNSTMH)';         /* LENGTH OF MH PREFIX       */ 96000010
./  ADD  SSI=60241602,NAME=TTCBD
         MACRO                                                          04000020
         TTCBD                                                          08000020
         SPACE                                                          12000020
IEDQTCB  DSECT                                                          16000020
TCBRBP   DS    F .                      ADDRESS OF THE RB               20000020
TCBPIE   DS    F .                      ADDRESS OF PROGRAM INTERRUPT    24000020
*                                         ELEMENT                       28000020
TCBDEB   DS    F .                      ADDRESS OF THE DEB QUEUE        32000020
TCBTIO   DS    F .                      ADDRESS OF TASK I/O TABLE       36000020
TCBCMP   DS    F .                      TASK COMPLETION CODE            40000020
TCBFLTRN DS    0FL1                                                     44000020
*                                                                       44050020
*                       BIT DEFINITIONS                                 44100020
*                                                                       44150020
TCBTCPP  EQU   X'08' .                  TCAM POST-PENDING BIT(RORI)     48000020
*                                                                       48050020
TCBTRN   DS    F .                      TESTRAN FIELD                   52000020
TCBNROC  DS    CL1 .                    JOB STEP TCB                    56000020
TCBMSS   DS    AL3 .                    ADDRESS OF DATA BLOCK           60000020
TCBPKF   DS    CL1 .                    STORAGE PROTECTION KEY          64000020
TCBFLGS  DS    CL5 .                    FLAG BYTES                      68000020
*                                                                       68050020
*                       BIT DEFINITIONS (5TH BYTE)                      68100020
*                                                                       68150020
TCBPNDSP EQU   X'01' .                  PRIMARY NON-DISPATCHABLE BIT    68200020
TCBLMP   DS    CL1 .                    LIMIT PRIORITY                  72000020
TCBDSP   DS    CL1 .                    DISPATCHING PRIORITY            76000020
TCBLLS   DS    F .                      ADDRESS OF THE LOAD LIST        80000020
*                                         ELEMENT                       84000020
TCBJLB   DS    F .                      ADDRESS OF JOBLIB DCB           88000020
TCBJPQ   DS    A .                      ADDRESS OF CDE                  88100020
TCBGRS   DS    16F .                    GENERAL REGS SAVEAREA           88200020
TCBQEL   DS    X .                      MVT - ENQUEUE COUNT             88300020
TCBFSA   DS    AL3 .                    ADDR OF 1ST PROG SAVEAREA       88400020
TCBTCB   DS    A .                      ADDR OF NEXT LOWER PRIORITY TCB 88500020
TCBTME   DS    A .                      ADDR OF TIMER ELEMENT           88600020
TCBJSTCB DS    A .                      MVT-ADDR OF 1ST TCB FOR TOP STP 88700020
TCBNTC   DS    A .                      MVT-PREVIOUS TCB ON SUBTASK Q   88800020
TCBOTC   DS    A .                      MVT-ORIGINATING TCB ADDR        88900020
TCBLTC   DS    A .                      MVT-LAST TCB ON SUBTASK Q       89000020
TCBIQE   DS    A .                      MVT-IQE ADDRESS                 89100020
TCBECB   DS    A .                      MVT-ECB ADDR                    89200020
         DS    A .                      RESERVED                        89300020
TCBPQE   DS    A .                      MVT-REGION DUMMY PQE-8          89400020
TCBAQE   DS    A .                      MVT-ALLOCATED Q ELEMENT ADDR    89500020
TCBNSTAE DS    A .                      STAE FLAGS ADDR                 89600020
TCBTCT   DS    A .                      TIMING CONTROL TABLE ADDR       89700020
TCBUSER  DS    A .                      USER FIELD                      89800020
TCBDAR   DS    X .                      DAR FLAGS                       89900020
TCBNDSP  DS    3X .                     SECONDARY NON-DISPATCHABLE BITS 90000020
*                                                                       90050020
TCBNDSP1 EQU   TCBNDSP .                  FIRST BYTE NON-DISPATCH BITS  90100020
TCBTPSP  EQU   X'04' .                      TCAM NON-DISPATCHABLE       90200020
TCBNDSP2 EQU   TCBNDSP+1 .                2ND BYTE - RESERVED           90300020
TCBNDSP3 EQU   TCBNDSP+2 .                3RD BYTE - RESERVED           90400020
         MEND                                                           92000020
./  ADD  SSI=70110504,NAME=TTCDSD
*        %GOTO PLSTCDS;           /* BILINGUAL HEADER                   01000010
         MACRO                                                          02000010
         TTCDSD                                                         03000010
         SPACE                                                          04000010
.* CHANGE ACTIVITY AS FOLLOWS:                                          05000010
.*A000000-999999                                               @Y17XAX0 05500010
         SPACE                                                          07000010
IEDTCDSD DSECT                                                          08000010
*                                                                       09000010
*        3705 RESOURCE CDS MAP                                          10000010
*                                                                       11000010
TCDSUCB  DS    CL4 .              CHANNEL ADDRESS                       12000010
TCDSFLG1 DS    XL1 .              TERMINAL FLAGS                        13000010
TCDSFEAT DS    XL1 .              FEATURE FLAG                          14000010
TCDSASCI EQU   X'80' .            ASCII CODE                            15000010
TCDSCLS  DS    XL1 .              CLASS                                 16000010
TCDSCL37 EQU   X'44' .            3705 RESOURCE CLASS                   17000010
TCDSTYP  DS    XL1 .              TYPE                                  18000010
TCDSTY37 EQU   X'20' .            3705 RESOURCE TYPE                    19000010
TCDSCNT  DS    XL1 .              CDS BYTE COUNT                        20000010
TCDSSNA  EQU   X'18' .            CDS BYTE COUNT FOR LU                 21000010
TCDSLINK EQU   X'24' .            CDS BYTE COUNT FOR LINK               22000010
TCDSFLG2 DS    XL1 .              FLAGS                                 22500010
TCDSSEC  EQU   X'0A'              SECURITY FLAGS                        24000010
         DS    XL2 .              RESERVED                              25000010
TCDSNAM  DS    CL8 .              3705 RESOURCE SYMBOLIC NAME           26000010
         DS    0XL4 .             RESERVED                              27000010
*        END OF 3767/3770 CDS MAP                                       28000010
*        LINE CDS MAPPING CONTINUES BELOW                               29000010
TCDSFXAR DS    XL1 .              OLTT CONTROL PROGRAM FIXED AREA LEN   30000010
TCDSFXLN EQU   X'10' .            LENGTH                                31000010
TCDSFLG3 DS    XL1 .              RESERVED                              32000010
TCDSFLG4 DS    XL1 .              RESERVED                              33000010
         DS    XL1 .              RESERVED                              34000010
TCDSDAF  DS    XL2 .              NETWORK ADDRESS                       35000010
         DS    XL2 .              RESERVED                              36000010
TCDSDEVT DS    XL1 .              DEVICE TYPE                           37000010
TCDSDVT  EQU   X'E0' .            LINE TYPE                             38000010
TCDSLNC  DS    XL1 .              LINE CONTROL                          39000010
TCDSLNCD DS    XL1 .              LINE CODE                             40000010
         DS    XL5 .              RESERVED                              41000010
         SPACE 2                                                        42000010
         MEND                     */                                    43000010
*%PLSTCDS : ;                                                           44000010
*DECLARE                                                                45000010
*  1 IEDTCDSD BDY(BYTE) BASED,                                          46000010
*/*                                                                  */ 47000010
*/*      3705 RESOURCE CDS MAP                                       */ 48000010
*/*                                                                  */ 49000010
*   3 TCDSUCB CHAR(4),            /* CHANNEL ADDRESS                 */ 50000010
*   3 TCDSFLG1 CHAR(1),           /* TERMINAL FLAGS                  */ 51000010
*   3 TCDSFEAT CHAR(1),           /* FEATURE FLAG                    */ 52000010
*   3 TCDSCLS CHAR(1),            /* CLASS                           */ 53000010
*   3 TCDSTYP CHAR(1),            /* TYPE                            */ 54000010
*   3 TCDSCNT CHAR(1),            /* CDS BYTE COUNT                  */ 55000010
*   3 TCDSFLG2 CHAR(1),           /* FLAGS                           */ 56000010
*   3 * CHAR(2),                  /* RESERVED                        */ 57000010
*   3 TCDSNAM CHAR(8),            /* 3705 RESOURCE SYMBOLIC NAME     */ 58000010
*   3 * CHAR(4),                  /* RESERVED                        */ 59000010
*/*      END OF 3767/3770 CDS MAP                                    */ 60000010
*/*      LINE CDS MAPPING CONTINUES BELOW                            */ 61000010
*    4 TCDSFXAR CHAR(1),          /* OLTT CONTROL PROGRAM FIXED AREA    62000010
*                                    LENGTH                          */ 63000010
*    4 TCDSFLG3 CHAR(1),          /* RESERVED                        */ 64000010
*    4 TCDSFLG4 CHAR(1),          /* RESERVED                        */ 65000010
*    4 * CHAR(1),                 /* RESERVED                        */ 66000010
*   3 TCDSDAF CHAR(2),            /* NETWORK ADDRESS                 */ 67000010
*   3 * CHAR(2),                  /* RESERVED                        */ 68000010
*   3 TCDSDEVT CHAR(1),           /* DEVICE TYPE                     */ 69000010
*   3 TCDSLNC CHAR(1),            /* LINE CODE                       */ 70000010
*   3 TCDSLNCD CHAR(1),           /* LINE CODE                       */ 71000010
*   3 * CHAR(5);                  /* RESERVED                        */ 72000010
*DECLARE TCDSASCI BIT(8) CONSTANT('80'X); /*ASCII CODE               */ 73000010
*DECLARE TCDSCL37 BIT(8) CONSTANT('44'X); /* 3705 RESOURCE CLASS     */ 74000010
*DECLARE TCDSTY37 BIT(8) CONSTANT('20'X); /* 3705 RESOURCE TYPE      */ 75000010
*DECLARE TCDSLINK BIT(8) CONSTANT('24'); /* LINK CDS BYTE COUNT      */ 76000010
*DECLARE TCDSSNA BIT(8) CONSTANT('18'X); /* LU CDS BYTE COUNT        */ 77000010
*DECLARE TCDSSEC BIT(8) CONSTANT('0A'X); /* SECURITY FLAGS           */ 78000010
*DECLARE TCDSFXLN BIT(8) CONSTANT('10'X); /* FIXED AREA LENGTH       */ 79000010
*DECLARE TCDSDVT BIT(8) CONSTANT('E0'X); /* LINE TYPE                */ 80000010
*%TCDSEND: ;                                                            81000010
./  ADD  SSI=71080451,NAME=TTCXD
*                                                                       00200010
*        %GOTO TCXL1; /*                                                00600010
         MACRO                                                          00800010
         TTCXD                                                          01000010
IEDQTCX  DSECT                                                          01100010
         SPACE 1 */                                                     01200010
*%TCXL1  : ;                                                            01400010
*                                                                       01800010
*/********************************************************************/ 02200010
*/*                                                                  */ 02600010
*/*            TCAM'S COMMUNICATION VECTOR TABLE EXTENSION           */ 03000010
*/*                                                                  */ 03400010
*/* OS/VS2 , TCAM LEVEL 9, 9/22/75                           @Z40X9NG*/ 03800010
*/*                                                                  */ 04200010
*/* METHOD OF ACCESS                                                 */ 04600010
*/*      BAL - USING ON TCX GIVES ADDRESSABILITY FOR ALL SYMBOLS.    */ 05000010
*/*                                                                  */ 05400010
*/*      PL/S - DCL TCXPTR PTR                                       */ 05800010
*/*                                                                  */ 06200010
*/*C040000,152000,340000,470000                              @ZA00227*/ 06300010
*/*C568000,768000,902400                                     @ZA00227*/ 06400010
*/*A154000,264200-264800,470200-471800                       @ZA00227*/ 06600010
*/*A570000,701200-701800,902500-903000                       @ZA00227*/ 06660010
*/*C255000,462000,687000,890000                              @ZA02601*/ 06740010
*/*A472000,903200                                            @Z40X9NG*/ 06748010
*/*C040000,265000,471800,702000,903000                       @Z40X9NG*/ 06756010
*/*A151500,567500                                            @ZA07083*/ 06764010
*/*C240000,265800,703600,903500                              @G36XRXG*/ 06772010
*/*A903650,903700,475400,475600,703650-703700,265850-265870  @G36XRXG*/ 06780010
*/*A903710,903720,475700,475800,265880,265890                @G36XRXG*/ 06788010
*/* ******************************************************************/ 06800010
*%GOTO TCXL2; /*                                                        07000010
         SPACE 1                                                        07400010
TCXAVT   DS    A                        ADDRESS OF TCAM'S AVT           07800010
TCXATTLN DS    0X                       LENGTH OF ATTENTION HANDLER     09800010
TCXATTEN DS    A                        ADDRESS OF TCAM'S ATTENTION RTN 10000010
TCXTCB   DS    A                        ADDRESS OF TCAM'S TCB           10200010
TCXDISP  DS    A                        ADDRESS OF TCAM'S DISPATCHER    10600010
TCXPASWD DS    CL8' '                   CONTAINS THE PASSWORD IF        11000010
*                                       SPECIFIED ON INTRO (INITIALIZED 11400010
*                                       BY LINE GROUP OPEN).            11800010
TCXREADY DS    A                        ASYNCHRONOUS READY QUEUE        12200010
TCXASCB  DS    A                        ADDRESS OF TCAM'S ADDRESS SPACE 12600010
*                                       CONTROL BLOCK                   13000010
TCXASID  DS    AL2                      TCAM'S ADDRESS SPACE ID         13400010
TCXFLAG1 DS AL1                         FIRST FLAG BYTE                 13800010
*                  TCXFLAG1 BIT DEFINITIONS                             14200010
TCXAUTH  EQU   X'80'                    APPL PGMS REQUIRE AUTHORIZATION 14600010
TCXMCPCD EQU   X'40'                    TCAM MCP IS TERMINATING         14800010
TCXRTM   EQU   X'20'                    TCAM'S RTM HAS BEEN CALLED      15000010
TCXAPPL  EQU   X'10'                    TCAM'S RTM IS WAITING FOR       15040010
*                                       APPLICATION PROGRAMS TO         15080010
*                                       TERMINATE                       15120010
TCXAPDMP EQU   X'04'                    APPL DUMP REQUESTED    @ZA07083 15160010
TCXCC3TS DS    AL1                      TEST AND SET LOCK FOR  @ZA00227 15200010
*                                       CONDITION CODE 3       @ZA00227 15400010
TCXRPT   DS    A                        ADDRESS OF TIOC REFERENCE       15600010
*                                       POINTER TABLE                   15800010
TCXTSI   DS    A                        ADDRESS OF TSINPUT QCB          16200010
TCXGETQ  DS    A                        ADDRESS OF QCB FOR GET/READ MCP 16600010
*                                       ROUTINE                         17000010
TCXPUTQ  DS    A                        ADDRESS OF QCB FOR PUT/WRITE    17400010
*                                       MCP ROUTINE                     17800010
TCXPNTQ  DS    A                        ADDRESS OF QCB FOR POINT MCP    18200010
*                                       ROUTINE                         18600010
TCXOCQ   DS    A                        ADDRESS OF QCB FOR OPEN/CLOSE   19000010
*                                       MCP ROUTINE                     19400010
TCXQRQ   DS    A                        ADDRESS OF QCB FOR QRESET       19800010
*                                       MCP ROUTINE.                    20200010
TCXPEWAC DS    A                        ADDRESS OF FIRST PEWA IN CHAIN  20600010
TCXPEBC  DS    A                        ADDRESS OF FIRST PEB IN CHAIN   21000010
TCXAIBC  DS    A                        ADDRESS OF FIRST AIB IN CHAIN   21400010
TCXSZAIB DS    AL2                      SIZE OF AIB                     21800010
TCXNCKPR DS    AL1                      NUMBER OF A.P. QUEUES FOR CKREQ 22200010
TCXCKPM  DS    AL1                      CHECK POINT IN MCP              22600010
TCXTOTE  DS    0XL1                     NUMBER OF TOTE ENTRIES - SET    22800010
*                                       BY IGG01932                     23000010
TCXBUFA  DS    A                        ADDRESS OF FIXED CORE FOR       23200010
*                                       TRACE,BUFFERS, AND CPBS.        23400010
         DS    A                        LNGTH OF FIXED CORE FOR@G36XRXG 23800010
*                                       TRACE, BUFFERS, AND CPBS.       24200010
TCXAVAIL DS    A                        ADDRESS OF CORE AVAILABLE FOR   24600010
*                                       LCB(S)/SCB(S).                  25000010
TCXCOMPT DS    A                        ADDRESS OF CSCB FOR MCP         25200010
TCXBIT1  DS    X                        AVTBIT1                         25400010
TCXSCBSZ DS    X                        STATION CONTROL BLOCK  @ZA02601 25430010
*                                       SIZE FOR RTM           @ZA02601 25470010
TCXBITS  DS    2X                       RESERVED               @ZA02601 25520010
TCXPLCB  DS    A                        ADDRESS OF TABLE OF 3705 PLCB   25530010
*                                       ADDRESSES                       25550010
TCXDSAVE DS    2A                       ADDRESS OF DISABLED SAVE AREA   25600010
*                                       USED BY THE PCI APPENDAGE       25800010
TCXSATTN DS    A                        SAVE AREA FOR ATTENTION TABLE   26200010
*                                       ROUTINE ADDRESS MODIFIED BY     26300010
*                                       TCAM OPEN                       26400010
TCXERPSV DS    3F                       ERP REGISTER SAVE AREA @ZA00227 26410010
TCXERPPM DS    F                        PARM AREA FOR IECVIOPM @ZA00227 26420010
TCXESAVE DS    18F                      SAVE AREA FOR LINKAGE  @ZA00227 26430010
*                                       TO IECVIOPM FROM ERP   @ZA00227 26440010
TCXSIOSB DS    A                        CHAIN OF SRB/IOSB'S    @Z40X9NG 26450010
*                                       FOR DISK QUEUES        @Z40X9NG 26460010
TCXSRBS  DS    A                        POINTER TO FIRST BLOCK @Z40X9NG 26470010
*                                       OF SRB'S FOR POST      @Z40X9NG 26480010
TCXABEPL DS    F                        ABEND PARM LIST        @G36XRXG 26490010
TCXACTE8 DS    0AL1                     ACTION CODE FOR IEDQE8 @G36XRXG 26500010
TCXQE8   DS    A                        KEY 0 CODE ADDRESS FOR @G36XRXG 26510010
*                                       IEDQE8                 @G36XRXG 26520010
TCXNCPIO DS    A                        PTR TO CHAIN OF ALL    @G36XRXG 26530010
*                                       3705 SRB/IOSB PAIRS    @G36XRXG 26540010
TCXEND   EQU   *                        END OF TCX                      26600010
TCXSIZE  EQU   TCXEND-IEDQTCX           SIZE OF TCX                     26800010
*                                                                       27000010
*********************************************************************** 27400010
*   0  *                               TCXAVT                         * 27800010
*********************************************************************** 28200010
*   4  *                               TCXATTEN                       * 28600010
*********************************************************************** 29000010
*   8  *                               TCXTCB                         * 29400010
*********************************************************************** 29800010
*  12  *                               TCXDISP                        * 30200010
*********************************************************************** 30600010
*  16  *                               TCXPASWD                       * 31000010
*      *                                                              * 31400010
*********************************************************************** 31800010
*  24  *                               TCXREADY                       * 32200010
*********************************************************************** 32600010
*  28  *                               TCXASCB                        * 33000010
*********************************************************************** 33400010
*  32  *   TCXASID                     *   TCXFLAG1    *   TCXCC3TS   * 33800010
*********************************************************************** 34200010
*  36  *                               TCXRPT                         * 34800010
*********************************************************************** 35000010
*  40  *                               TCXTSI                         * 35400010
*********************************************************************** 35800010
*  44  *                               TCXGETQ                        * 36200010
*********************************************************************** 36600010
*  48  *                               TCXPUTQ                        * 37000010
*********************************************************************** 37400010
*  52  *                               TCXPNTQ                        * 37800010
*********************************************************************** 38200010
*  56  *                               TCXOCQ                         * 38600010
*********************************************************************** 39000010
*  60  *                               TCXQRQ                         * 39400010
*********************************************************************** 39800010
*  64  *                               TCXPEWAC                       * 40200010
*********************************************************************** 40600010
*  68  *                               TCXPEBC                        * 41000010
*********************************************************************** 41600010
*  72  *                               TCXAIBC                        * 42000010
*********************************************************************** 42200010
*  76  *   TCXSZAIB                    *   TCXNCKPR    *   TCXKPM     * 42600010
*********************************************************************** 42900010
*  80  *                               TCXBUFA                        * 43400010
*********************************************************************** 43800010
*  84  *                               TCXBUFL                        * 44200010
*********************************************************************** 44600010
*  88  *                               TCXAVAIL                       * 45000010
*********************************************************************** 45400010
*  92  *                               TCXCOMPT                       * 45800010
*********************************************************************** 46000010
*  96  *   TCXBIT1   *   TCXSCBSZ  *   RESERVED                @ZA02601 46200010
*********************************************************************** 46250010
* 100  *                               TCXPLCB                        * 46300010
*********************************************************************** 46350010
* 104  *                               TCXDSAVE                       * 46400010
*      *                                                              * 46600010
*********************************************************************** 46700010
* 112  *                               TCXSATTN                       * 46800010
*********************************************************************** 46900010
* 116  *                               TCXERPSV                       * 47000010
*      *                                                              * 47020010
*********************************************************************** 47040010
* 128  *                               TCXERPPM                       * 47060010
*********************************************************************** 47080010
* 132  *                               TCXESAVE                       * 47100010
*      *                                                              * 47120010
*      *                                                              * 47140010
*********************************************************************** 47160010
* 204  *                               TCXSIOSB                       * 47180010
*********************************************************************** 47200010
* 208  *                               TCXSRBS                        * 47260010
*********************************************************************** 47320010
* 212  *                               TCXABEPL                       * 47400010
*********************************************************************** 47460010
* 216  *                               TCXQE8                         * 47500010
*********************************************************************** 47550010
* 220  *                               TCXCNPIO                       * 47560010
*********************************************************************** 47570010
         MEND                                                           47600010
*                                                                       47800010
* */                                                                    48200010
*%TCXL2  : ;                                                            48600010
*                                                                       49000010
*        DCL 1  IEDQTCXD BASED(TCXPTR) BDY(DWORD),                      49400010
*             2 TCXAVT   FIXED(31),    /* ADDRESS OF TCAM'S AVT      */ 49800010
*             2 TCXATTEN FIXED(31),    /* ADDRESS OF TCAM'S ATTENTION*/ 50200010
*                                      /* ROUTINE                    */ 50600010
*              3 TCXATTLN PTR(8),      /* LENGTH OF ATTN HANDLER     */ 51000010
*             2 TCXTCB   FIXED(31),    /* ADDDRESS OF TCAM'S TCB     */ 51200010
*             2 TCXDISP  FIXED(31),    /* ADDRESS OF TCAM'S          */ 51400010
*                                      /* DISPATCHER                 */ 51800010
*             2 TCXPASWD CHAR(8),      /* CONTAINS THE PASSWORD IF   */ 52200010
*                                      /* SPECIFIED ON INTRO         */ 52600010
*                                      /* (INITIALIZED BY LINE GROUP */ 53000010
*                                      /* OPEN).                     */ 53400010
*             2 TCXREADY FIXED(31),    /* ASYNCHRONOUS READY QUEUE   */ 53800010
*             2 TCXASCB  FIXED(31),    /* ADDRESS OF TCAM'S ADDRESS  */ 54200010
*                                      /* SPACE CONTROL BLOCK        */ 54600010
*             2 TCXASID  FIXED(15),    /* TCAM'S ADDRESS SPACE ID    */ 55000010
*             2 TCXFLAG1 PTR(8),       /* FIRST FLAG BYTE            */ 55400010
*              3 TCXAUTH BIT(1),       /* APPLICATION PROGRAMS       */ 55800010
*                                      /* REQUIRE AUTHORIZATION      */ 56200010
*              3 TCXMCPCD BIT(1),      /* TCAM MCP IS TERMINATING    */ 56400010
*              3 TCXRTM  BIT(1),       /* TCAM'S RTM HAS BEEN CALLED */ 56600010
*              3 TCXAPPL BIT(1),       /* TCAM'S RTM IS WAITING      */ 56640010
*                                      /* FOR APPLICATION PROGRAMS   */ 56680010
*                                      /* TO TERMINATE               */ 56720010
*              3 TCXAPDMP BIT(1),      /* APPL DUMP REQUESTED@ZA07083*/ 56760010
*             2 TCXCC3TS PTR(8),       /* TEST AND SET LOCK FOR         56800010
*                                         CONDITION CODE 3   @ZA00227*/ 57000010
*             2 TCXRPT   FIXED(31),    /* ADDRESS OF TIOC REFERENCE  */ 57200010
*                                      /* POINTER TABLE              */ 57400010
*             2 TCXTSI   FIXED(31),    /* ADDRESS OF TSINPUT QCB     */ 57800010
*             2 TCXGETQ  FIXED(31),    /* ADDRESS OF QCB FOR GET/READ*/ 58200010
*                                      /* MCP ROUTINE                */ 58600010
*             2 TCXPUTQ  FIXED(31),    /* ADDRESS OF QCB FOR PUT/    */ 59000010
*                                      /* WRITE MCP ROUTINE          */ 59400010
*             2 TCXPNTQ  FIXED(31),    /* ADDRESS OF QCB FOR POINT   */ 59800010
*                                      /* MCP ROUTINE                */ 60200010
*             2 TCXOCQ   FIXED(31),    /* ADDRESS OF QCB FOR OPEN/   */ 60600010
*                                      /* CLOSE MCP ROUTINE          */ 61000010
*             2 TCXQRQ   FIXED(31),     /* ADDRESS OF QCB FOR QRESET */ 61400010
*                                       /* MCP ROUTINE               */ 61800010
*             2 TCXPEWAC FIXED(31),    /* ADDRESS OF FIRST PEWA IN   */ 62200010
*                                      /* CHAIN                      */ 62600010
*             2 TCXPEBC  FIXED(31),    /* ADDRESS OF FIRST PEB IN    */ 63000010
*                                      /* CHAIN                      */ 63400010
*             2 TCXAIBC  FIXED(31),    /* ADDRESS OF FIRST AIB IN    */ 63800010
*                                      /* CHAIN                      */ 64200010
*             2 TCXSZAIB FIXED(15),    /* SIZE OF AIB                */ 64600010
*             2 TCXNCKPR PTR(8),       /* NUMBER OF A.P. QUEUES FOR  */ 65000010
*                                      /* CHECK REQUESTS             */ 65400010
*             2 TCXCKPM  PTR(8),       /* CHECK POINT IN MCP         */ 65800010
*             2 TCXBUFA  FIXED(31),    /* ADDRESS OF FIXED CORE FOR  */ 66200010
*                                      /* TRACE, BUFFERS, CPBS.      */ 66600010
*              3 TCXTOTE  PTR(8),      /* NUMBER OF TOTE ENTRIES -   */ 66800010
*                                      /* SET BY IGG01932            */ 67000010
*             2 TCXBUFL  FIXED(31),    /* LENGTH OF FIXED CORE FOR   */ 67200010
*                                      /* TRACE, BUFFERS, CPBS.      */ 67400010
*             2 TCXAVAIL FIXED(31),    /* ADDRESS OF CORE AVAILABLE  */ 67800010
*                                      /* FOR LCB(S)/SCB(S).         */ 68200010
*             2 TCXCOMPT FIXED(31),    /* ADDRESS OF CSCB FOR MCP    */ 68400010
*             2 TCXBIT1  PTR(8),       /* AVTBIT1                    */ 68600010
*              2 TCXSCBSZ PTR(8),       /* SCB SIZE          @ZA02601*/ 68640010
*              2 TCXBITS  PTR(16),      /* RESERVED          @ZA02601*/ 68680010
*             2 TCXPLCB  FIXED(31),    /* ADDRESS OF TABLE OF 3705   */ 68720010
*                                      /* PLCB ADDRESSES             */ 68760010
*             2 TCXDSAVE,              /* ADDRESS OF DISABLED SAVE   */ 68800010
*              3 * FIXED(31),          /*  AREA USED BY THE PCI      */ 69000010
*              3 * FIXED(31),          /*  APPENDAGE                 */ 69400010
*             2 TCXSATTN FIXED(31),    /* SAVE AREA FOR ATTENTION    */ 69700010
*                                      /* TABLE ROUTINE ADDRESS      */ 70000010
*                                      /* MODIFIED BY TCAM OPEM      */ 70030010
*             2 TCXERPSV (3) FIXED(31), /* ERP SAVE AREA     @ZA00227*/ 70060010
*             2 TCXERPPM FIXED(31),     /* IECVIOPM PARM AREA@ZA00227*/ 70090010
*             2 TCXESAVE (18) FIXED(31), /* SAVE AREA FOR LINKAGE       70120010
*                                       TO IECVIOPM FROM ERP @ZA00227*/ 70150010
*             2 TCXSIOSB PTR(31),      /* CHAIN OF SRB/IOSB'S  FOR      70200010
*                                         DISK QUEUES        @Z40X9NG*/ 70210010
*             2 TCXSRBS PTR(31),       /* POINTER TO FIRST BLOCK OF     70220010
*                                         SRB'S FOR POST     @Z40X9NG*/ 70230010
*             2 TCXABEPL FIXED(31),    /* ABEND PARM LIST    @G36XRXG*/ 70240010
*             2 TCXQE8  PTR(31),       /* KEY 0 CODE ADDRESS FOR        70250010
*                                         IEDQE8             @G36XRXG*/ 70260010
*               3 TCXACTE8 PTR(8),     /* ACTION CODE FOR IEDQE8        70270010
*                                                            @G36XRXG*/ 70280010
*             2 TCXNCPIO PTR(31),      /* PTR TO CHAIN OF ALL 3705      70290010
*                                         SRB/IOSB PAIRS     @G36XRXG*/ 70300010
* /*******************************************************************/ 70400010
* /*  0 *                              TCXAVT                        */ 70600010
* /*******************************************************************/ 71000010
* /*  4 *                              TCXATTEN                      */ 71400010
* /*******************************************************************/ 71800010
* /*  8 *                              TCXTCB                        */ 72200010
* /*******************************************************************/ 72600010
* /* 12 *                              TCXDISP                       */ 73000010
* /*******************************************************************/ 73400010
* /* 16 *                              TCXPASWD                      */ 73800010
* /*    *                                                            */ 74200010
* /*******************************************************************/ 74600010
* /* 24 *                              TCXREADY                      */ 75000010
* /*******************************************************************/ 75400010
* /* 28 *                              TCXASCB                       */ 75800010
* /*******************************************************************/ 76200010
* /* 32 *  TCXASID                     *   TCXFLAG1    *   TCXCC3TS  */ 76600010
* /*******************************************************************/ 77000010
* /* 36 *                              TCXRPT                        */ 77400010
* /*******************************************************************/ 77800010
* /* 40 *                              TCXTSI                        */ 78200010
* /*******************************************************************/ 78600010
* /* 44 *                              TCXGETQ                       */ 79000010
* /*******************************************************************/ 79400010
* /* 48 *                              TCXPUTQ                       */ 79800010
* /*******************************************************************/ 80200010
* /* 52 *                              TCXPNTQ                       */ 80600010
* /*******************************************************************/ 81000010
* /* 56 *                              TCXOCQ                        */ 81400010
* /*******************************************************************/ 81800010
* /* 60 *                              TCXQRQ                        */ 82200010
* /*******************************************************************/ 82600010
* /* 64 *                              TCXPEWAC                      */ 83000010
* /*******************************************************************/ 83400010
* /* 68 *                              TCXPEBC                       */ 83800010
* /*******************************************************************/ 84200010
* /* 72 *                              TCXAIBC                       */ 84600010
* /*******************************************************************/ 85000010
* /* 76 *  TCXSZAIB                    *   TCXNCKPR    *   TCXKPM    */ 85400010
* /*******************************************************************/ 85800010
* /* 80 *                              TCXBUFA                       */ 86200010
* /*******************************************************************/ 86600010
* /* 84 *                              TCXBUFL                       */ 87000010
* /*******************************************************************/ 87500010
* /* 88 *                              TCXAVAIL                      */ 88000010
* /*******************************************************************/ 88200010
* /* 92 *                              TCXCOMPT                      */ 88600010
* /*******************************************************************/ 88800010
* /* 96 *  TCXBIT1     *  TCXSCBSZ     *  RESERVED           @ZA02601*/ 89000010
* /*******************************************************************/ 89040010
* /*100 *                              TCXPLCB                       */ 89120010
* /*******************************************************************/ 89160010
* /*104 *                              TCXDSAVE                      */ 89180010
* /*    *                                                            */ 89210010
* /*******************************************************************/ 89600010
* /*112 *                              TCXSATTN                      */ 89800010
* /*******************************************************************/ 90000010
* /*116 *                              TCXERPSV                      */ 90200010
* /*******************************************************************/ 90250010
* /*128 *                              TCXERPPM                      */ 90260010
* /*******************************************************************/ 90270010
* /*132 *                              TCXESAVE                      */ 90280010
* /*******************************************************************/ 90290010
* /*204 *                              TCXSIOSB                      */ 90300010
* /*******************************************************************/ 90310010
* /*208 *                              TCXSRBS                       */ 90330010
* /*******************************************************************/ 90340010
* /*212 *                              TCXABEPL                      */ 90350010
* /*******************************************************************/ 90360010
* /*216 *                              TCXQE8                        */ 90365010
* /*******************************************************************/ 90370010
* /*220 *                              TCXNCPIO                      */ 90373010
* /*******************************************************************/ 90376010
*             2 TCXEND CHAR(0);        /* END OF TCX                 */ 90380010
./  ADD  SSI=60241604,NAME=TTECB
         MACRO                                                          07000020
         TTECB                                                          08000020
         SPACE                                                          10000020
*                                                                       15000020
*        TEST EVENT CONTROL BLOCK                                       20000020
*                                                                       25000020
TTECB    DSECT                                                          30000020
TECBFDCT DS    XL1           NUMBER OF EVENT FIELDS                     35000010
TECBFDLN DS    XL1           LENGTH OF EVENT FIELDS                     40000010
TECBSNLN DS    H             LENGTH OF SENSE FIELD                      45000010
TECBFLGS DS    BL1           FLAGS                                      50000010
TECBSNCT DS    XL1           NUMBER OF SENSE FIELDS                     55000010
TECBSNOC DS    XL1           NUMBER OF SENSES OCCURRED                  60000010
TECBEVOC DS    XL1           NUMBER OF EVENTS OCCURRED                  65000010
TECBFD01 DS    F             1ST EVENT FIELD                            70000010
         MEND                                                           80000020
./  ADD  SSI=62230029,NAME=TTHD
*        %GOTO THPLS;                   /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TTHD                                                           03000010
.*A000000-999999                                               @Y17XAXF 04000010
IEDTH    DSECT                                                          05000010
*                                                                       06000010
*        DSECT FOR SNA TH                                               07000010
*                                                                       08000010
TTHBYTE0 DS    XL1 .               BYTE 0 OF TH                         09000010
* TTHFTYPE     4 BITS                   FORMAT TYPE                     10000010
TTHFID0  EQU   X'00' .                       FID0 1ST FOUR              11000010
TTHFID1  EQU   X'10' .                       FID1   BITS INDICATE       12000010
TTHBBIU  EQU   X'08' .                  BEGIN SEGMENT                   13000010
TTHEBIU  EQU   X'04' .                  END SEGMENT                     14000010
*        EQU   X'02' .                  RESERVED                        15000010
TTHEFI   EQU   X'01' .                  EXPEDITED FLOW INDICATOR        16000010
TTHBYTE1 DS    CL1 .               RESERVED                             17000010
TTHDAF   DS    AL2 .               DESTINATION ADDR FIELD               18000010
TTHOAF   DS    AL2 .               ORIGIN ADDRESS FIELD                 19000010
TTHSNF   DS    0AL2 .              SEQUENCE NUMBER                      20000010
TTHTAG   DS    0AL2 .              TAG INFORMATION                      21000010
TTHTAG1  DS    XL1 .                    FIRST TAG BYTE                  22000010
*TTHTAGS       BITS 0-3                   TAG ROUTING AND TYPE          23000010
* THE FOLLOWING VALUES CAN BE USED FOR PRF1TAGS                         23500010
TTHOPCTL EQU   X'10' .                     OPER CONTROL                 24000010
*              BITS 4-7 .                 RESERVED                      27500010
TTHTAG2  DS    XL1 .                    SECOND TAG BYTE                 28000010
* TP OP CODE VALUES USED FOR TTHTAG2 OR PRF1TAG2                        28005010
TTHNULWR EQU   X'01' .                    NULL WRITE TRANS, ISSUED      28010010
*                                          BY DEBLOCK                   28015010
TTHRESET EQU   X'02' .                    RESET ISSUED BY DEBLOCK       28020010
TTHLSTWR EQU   X'03' .                    LAST WRITE BDU OF A MESS      28025010
*                                          -ISSUED BY OUTPUT DATA       28030010
*                                          NIR GENERATOR                28035010
TTHABORT EQU   X'04' .                    STOP=YES DISCONNECT OR NULL   28040010
*                                          WRITE TRANS. ABORT ISSUED    28045010
*                                          BY CONTROL NIR GENERATOR     28050010
TTHWRSMI EQU   X'05' .                    WRITE SMI ISSUED BY TSO       28055010
*                                          SCHEDULER AND TSO MSGGEN     28060010
TTHDCF   DS    AL2 .               DATA COUNT FILED                     29000010
*                                       (DOES NOT INCLUDE TH)           30000010
TTH0BYT0 EQU   X'0C' .             USED FOR FID0 TH INITIALIZATION      31000010
TTH0BYT1 EQU   X'00' .             USED FOR FID0 TH INITIALIZATION      32000010
*TTHTAG0       X'0000' .           USED WITH TTHTAG                     34000010
TTHLEN   EQU   *-IEDTH .           LENGTH OF TH                         35000010
         MEND                                                           36000010
*        */                                                             37000010
*%THPLS:;                                                               38000010
*DECLARE                                                                39000010
*  1 IEDTH  BASED BDY (BYTE),                                           40000010
*/*                                                                  */ 41000010
*/*      DSECT FOR SNA TH                                            */ 42000010
*/*                                                                  */ 43000010
*    2 TTHBYTE0 BIT(8),                 /* BYTE0 OF TH               */ 44000010
*      3 TTHFTYPE BIT(4),               /*   FORMAT TYPE             */ 45000010
*      3 TTHBBIU  BIT(1),               /*   BEGIN SEGMENT           */ 46000010
*      3 TTHEBIU  BIT(1),               /*   END SEGMENT             */ 47000010
*      3 *        BIT(1),               /*   RESERVED                */ 48000010
*      3 TTHEFI   BIT(1),               /*   EXPEDITED FLOW INDICATOR*/ 49000010
*    2 TTHBYTE1 CHAR(1),                /* RESERVED                  */ 50000010
*    2 TTHDAF   BIT(16),                /* DESTINATION ADDR FIELD    */ 51000010
*    2 TTHOAF   BIT(16),                /* ORIGIN ADDRESS FIELD      */ 52000010
*    2 TTHSNF   FIXED(16) BDY(BYTE),    /* SEQUENCE NUMBER           */ 53000010
*      3 TTHTAG FIXED(16) BDY(BYTE),    /* TAG INFORMATION           */ 54000010
*        4 TTHTAG1  BIT(8),             /*  FIRST TAG BYTE           */ 55000010
*          5 TTHTAGS  BIT(4),           /*   TAG ROUTING AND TYPE    */ 56000010
*          5 *        BIT(4),           /*   RESERVED                */ 57000010
*        4 TTHTAG2  BIT(8),             /* SECOND TAG BYTE           */ 58000010
*    2 TTHDCF   FIXED(16) BDY(BYTE);    /* DATA COUNT FIELD          */ 59000010
*                                       /*    (DOES NOT INCLUDE TH)  */ 60000010
* %TTHLEN='LENGTH(IEDTH)';              /* LENGTH OF TH              */ 61000010
*/* TTHFTYPE VALUES                                                  */ 62000010
* DCL TTHFID0  BIT(4) CONSTANT('0000'B);  /* FID0 INDICATOR          */ 63000010
* DCL TTHFID1  BIT(4) CONSTANT('0001'B);  /* FID1 INDICATOR          */ 64000010
*/* TTHTAGS OR PRF1TAGS VALUES                                       */ 65000010
* DCL TTHOPCTL BIT(4) CONSTANT('0001'B);  /* OPER CONTROL            */ 66000010
*/* TP OP CODE VALUES USED FOR TTHTAG2 OR PRF1TAG2                   */ 66200010
* DCL TTHNULWR BIT(8) CONSTANT('01'X);    /* NULL WRITE TRANS.       */ 67000010
*                                         /* ISSUED BY DEBLOCK       */ 67200010
* DCL TTHRESET BIT(8) CONSTANT('02'X);    /* RESET ISSUED BY DEBLOCK */ 68000010
* DCL TTHLSTWR BIT(8) CONSTANT('03'X);    /* LAST WRITE BDU OF A MES */ 69000010
*                                         /* ISSUED BY OUTPUT DATA   */ 69020010
*                                         /* NIR GENERATOR           */ 69040010
* DCL TTHABORT BIT(8) CONSTANT('04'X);    /* STOP=YES DISCONNECT OR  */ 69060010
*                                         /* NULL WRITE TRANS. ABORT */ 69080010
*                                         /* ISSUED BY CONTROL NIR   */ 69100010
*                                         /* GENERATOR               */ 69120010
* DCL TTHWRSMI BIT(8) CONSTANT('05'X);    /* WRITE SMI ISSUED BY TSO */ 69140010
*                                         /* SCHEDULR AND TSO MSGGEN */ 69160010
*/* TH CONSTANTS                                                     */ 70000010
* DCL TTH0BYT0 BIT(8) CONSTANT('0C'X);   /* USED FOR FID0 TH INITIAL */ 71000010
* DCL TTH0BYT1 BIT(8) CONSTANT('00'X);   /* USED FOR FID0 TH INITIAL */ 72000010
* DCL TTHTAG0  BIT(16) CONSTANT('0000'X); /* USED WITH TTHTAG        */ 74000010
./  ADD  SSI=70280499,NAME=TTNTD
*        %GOTO BSLTNT;                  /* BILINGUAL HEADER             01000010
         MACRO                                                          02000010
         TTNTD                                                          03000010
IEDQTNTD DSECT                                                          05000010
.*       UPDATED TO BILINGUAL DSECT 09/16/72                     S22024 07500010
TNTCODE  DS    XL38 .                   TERMNAME TABLE CODE             08000010
TNTSRCHX DS    H .                      SEARCH EXTENT FACTOR            08500010
TNTENLEN DS    XL1 .                    LENGTH OF COMPARAND FIELD       11000010
TNTMIDEN DS    AL3 .                    ADDRESS OF MIDDLE ENTRY         15000010
TNTLEN   DS    H .                      TOTAL NUMBER OF ENTRIES         16000010
TNTDCODE DS    XL36 .                   DISABLED TERMNAME CODE          19000010
TNTFIRST EQU   *                        START OF FIRST ENTRY            21000010
TNTOFF   EQU   TNTFIRST-TNTCODE .       OFFSET TO FIRST ENTRY           23000010
IEDTNTA  DSECT                                                 @Y17XAXF 23600010
TNTTRMAD DS    AL3 .                    ADDR OF TTE            @Y17XAXF 24200010
*     HEX                                    DEC                        27000010
*        *********************************                              29000010
*      0 *             CODE              *    0                         31000010
*        *                               *                              33000010
*      *****                           *****                            35000010
*                                                                       37000010
*      *****                           *****                            39000010
*        *                               *                              41000010
*        *               *****************                              43000010
*     24 *               *   SRCHX       * 36                           45000010
*        *********************************                              47000010
*     28 * ENLEN *         MIDEN         * 40                           49000010
*        *********************************                              51000010
*     2C *    LEN        *     DCODE     * 44                           53000010
*        *********************************                              55000010
*     30 *                               * 48                           57000010
*        *                               *                              59000010
*      *****                           *****                            63000010
*                                                                       65000010
*      *****                           *****                            67000010
*     52 *               *   FIRST       * 80                           69000010
*        *****************               *                              71000010
*                                                                       75000010
         MEND  , */                                                     77600010
*%BSLTNT:   ;                                                           78200010
*DECLARE                                /* TERMINAL NAME TABLE       */ 78800010
*  1 IEDQTNTD  BASED(IEDQNPTR),                                         79500010
*                                                                       79700010
*   2 IEDQTCDE     CHAR(38),            /* TERMNAME TABLE CODE       */ 80000010
*                                                                       80300010
*   2 TNTSRCHX     FIXED(16),           /* SEARCH EXT FACTOR @Y17XAXF*/ 80600010
*   2 TNTENLEN     FIXED(8),            /* LENGTH OF COMPARAND FIELD    81000010
*                                          IN AN ENTRY       @Y17XAXF*/ 81400010
*   2 TNTMIDEN     PTR(24),             /* ADDRESS OF MIDDLE ENTRY   */ 82000010
*   2 TNTLEN       FIXED(16),           /* TOTAL NO. ENTRIES @Y17XAXF*/ 82300010
*                                                                       82600010
*   2 IEDQTDCE     CHAR(36);            /* DISABLED TERMNAME CODE    */ 83500010
*DECLARE                                                                84000010
*  TNTFIRST (*)    CHAR(1)  BASED(ADDR(IEDQTNTD) + LENGTH(IEDQTNTD));   84300010
*                                                                       84600010
*DECLARE TNTCODE  LABEL  BASED(ADDR(IEDQTCDE)); /* TERMNAME TABLE       85500010
*                                          CODE                      */ 85700010
*DECLARE TNTDCODE LABEL  BASED(ADDR(IEDQTDCE)); /* DISABLED TERMNAME    86000010
*                                          CODE                      */ 86100010
*DECLARE                                                   /*@Y17XAXF*/ 86200010
*   1 IEDTNTA BASED BDY(BYTE),                             /*@Y17XAXF*/ 86300010
*    2 TNTTRMAD   PTR(24) BDY(BYTE);    /* ADDR OF TTE       @Y17XAXF*/ 86400010
*                                                                       86500010
*%DECLARE TNTOFF CHAR;                  /* OFFSET TO FIRST ENTRY     */ 87500010
*%TNTOFF='LENGTH(IEDQTNTD)';            /* EQUALS LENGTH OF STRUCTURE*/ 87700010
*                                                                       88000010
*/*      HEX                                               DEC       */ 88300010
*/*           ********************************************           */ 88600010
*/*       0   *                  CODE                    *   0       */ 89500010
*/*         *****                                      *****         */ 90000010
*/*                                                                  */ 90300010
*/*         *****                                      *****         */ 90600010
*/*           *                                          *           */ 91500010
*/*                                ***********************           */ 91700010
*/*      24   *                    *         SRCHX       *  36       */ 92000010
*/*           ********************************************           */ 92300010
*/*      28   *  ENLEN   *           MIDEN               *  40       */ 92600010
*/*           ********************************************           */ 93500010
*/*      2C   *       LEN          *         DCODE       *  44       */ 93700010
*/*           ********************************************           */ 94000010
*/*      30   *                                          *  48       */ 94300010
*/*           *                                          *           */ 94600010
*/*           *                                          *           */ 95500010
*/*         *****                                      *****         */ 95700010
*/*                                                                  */ 96000010
*/*         *****                                      *****         */ 96600010
*/*      52   *                    *         FIRST       *  80       */ 97200010
*/*           **********************                     *           */ 97800010
*/*                                                                  */ 98400010
*/*                                                                  */ 99000010
./  ADD  SSI=62890492,NAME=TTPD
         MACRO                                                          01000020
         TTPD                                                           02000010
.*                                                                      02500010
.********   CHANGE ACTIVITY   **********                                03000010
.*A660000                                                      @OY14057 03500010
*                                                                       04000020
TPWREOT  EQU   X'01' .                  EOT FOR SELECTION               05000020
*                                                                       06000020
TPOPEN   EQU   X'02' .                  OPEN TP OP CODE                 07000020
*                                                                       08000020
TPWRPOLL EQU   X'03' .                  WRITE POLLING CHARCTERS         09000020
*                                                                       10000020
TPRDRESP EQU   X'04' .                  READ RESPONSE TO POLLING        11000020
*                                                                       12000020
TPWRPAD  EQU   X'05' .                  WRITE PADS                      13000020
*                                                                       14000020
TPENABLE EQU   X'06' .                  ENABLE ON DIAL LINE             15000020
*                                                                       16000020
TPWRAD   EQU   X'07' .                  WRITE ADDRESSING SEQUENCE       17000020
*                                                                       18000020
TPRDRSPD EQU   X'08' .                  READ RESPONSE TO ADDRESSING     19000020
*                                                                       20000020
TPWREOA  EQU   X'09' .                  WRITE EOA SEQUENCE              21000020
*                                                                       22000020
TPRDRPEB EQU   X'0A' .                  READ RESPONSE TO EOB-NONBSC     23000020
*                                                                       24000020
TPWRCPU  EQU   X'0B' .                  WRITE CPU ID                    25000020
*                                                                       26000020
TPRDENQ  EQU   X'0C' .                  READ ENQ                        27000020
*                                                                       28000020
TPWRENQ  EQU   X'0D' .                  WRITE ENQ                       29000020
*                                                                       30000020
TPRSPENQ EQU   X'0E' .                  READ RESPONSE TO ENQ            31000020
*                                                                       32000020
TPWRDLET EQU   X'0F' .                  WRITE DLE EOT                   33000020
*                                                                       34000020
TPRDID   EQU   X'10' .                  READ ID                         35000020
*                                                                       36000020
TPNULL   EQU   X'11' .                  NON READ WRITE CCW'S FOR        37000020
*                                         WHICH NO INTERRUPTED IS       38000020
*                                         ANTICIPATED                   39000020
*                                                                       40000020
TPBREAK  EQU   X'12' .                 BREAK TP-CD                      41000020
*                                                                       42000020
TPENQAD  EQU   X'13' .                  ENQ AFTER SELECTION RESPONSE    43000020
*                                                                       44000020
TPRDLC   EQU   X'14' .                  READ LCOUT                      45000020
*                                                                       46000020
TPWRACK  EQU   X'15' .                  WRITE RESPONSE PRIOR TO TEXT    47000020
*                                                                       48000020
TPWRAKNK EQU   X'16' .                  WRITE RESPNSE                   49000020
*                                                                       50000020
TPWRTONE EQU   X'17' .                  WRITE TONE WTTA BSC             51000020
*                                                                     * 52000020
TPRDIDNQ EQU   X'18' .                  BSC READ ID ENQ                 53000020
*                                                                       54000020
TPRDIDAK EQU   X'1A' .                 BSC READ ID ACK                  55000020
*                                                                       56000020
TPRESET  EQU   X'1C' .                  ABORT FOR SEND/RECEIVE          57000020
*                                                                       58000020
TPTWXID  EQU   X'1E' .                  READ TWX ID                     59000020
*                                                                       60000020
TPBUFEOT EQU   X'20' .                  BUFF. TERM RESET AFTER BLK      61000020
*                                                                       62000020
TPCLOSE  EQU   X'22' .                  CLOSE SDR RECORDING             63000020
*                                                                       64000020
TPRSPAD  EQU   X'24' .                  RESET AFTER SLECTION            65000020
*                                                                       66000020
TPEAU    EQU   X'26'                    WRITE ERASE ALL        @OY14057 66100010
*                                         UNPROTECTED          @OY14057 66200010
*                                                              @OY14057 66300010
TPRSPMG  EQU   X'28'                    RD RESP MSGEN 2260R    @OY14057 66400010
*                                                              @OY14057 66500010
TPRS3270 EQU   X'2A'                    RESET AFTER 3270       @OY14057 66600010
*                                         POLLING ERROR        @OY14057 66700010
TPRDSKIP EQU   X'51' .                  READ SKIP LOOP                  67000020
*                                                                       68000020
TPWRIDLE EQU   X'53' .                  WRITE IDLES LLOP                69000020
*                                                                       70000020
TPDLESTX EQU   X'57' .                  WRITE DLE STX                   71000020
*                                                                       72000020
TPDLEETX EQU   X'59' .                  WRITE DLE ETB (ETX)             73000020
*                                                                       74000020
TPENQRSP EQU   X'5B' .                  ENQ IN RESPONSE TO TEXT         75000020
*                                                                       76000020
TPTEXT   EQU   X'FF' .                  TEXT CCW                        77000020
         MEND                                                           78000020
./  ADD  SSI=82080254,NAME=TTRMD
*        %GOTO BSLTRM;                                               /* 00100000
         MACRO                                                          00200000
         TTRMD                                                          00300000
.* A000000-999999                                              @Y17XAXF 00400000
*A152000,154000                                                         00400182
.******************* MICROFICHE FLAGS *********************** SUPT CODE 00500000
.*    THE FOLLOWING MICROFICHE FLAGS HAVE BEEN INCORPORATED IN @Y17XAXF 00700000
.*                                                               S22026 00800000
.*                                                              SA53610 01000000
.*                                                              SA67105 01100000
.*                                                              OY00539 01300000
.*                                                               X03039 01500000
.*                                                             @Z30X8XE 01600000
.*                                                             @X50X9XH 02100000
IEDTRM   DSECT                                                 @Y17XAXF 02200000
         DS    CL2                      NOT CREATED,DO NOT REF @Y17XAXF 02300000
IEDNTRM  EQU   *                        START OF NEG PREFIX    @Y17XAXF 02400000
TRMBYTE4 DS    0XL1 .                   STATUS BYTE            @Y17XAXF 02500000
         SPACE 2                                               @Y17XAXF 02600000
TRMPRE1  DS    0XL1 .                   STATUS BYTE (PRE-SNA)  @YM08120 02700000
TRMCONT  EQU   X'80' .                    CONTACT INIT SESS    @Y17XAXF 02800000
TRMSESSN EQU   X'40' .                    TERMINAL IN SESS     @Y17XAXF 02900000
TRMOCNI  EQU   X'20' .                    STOP LINE IN PROG    @Y17XAXF 03000000
TRMSPACT EQU   X'10' .                    TERM'S LINE ACTIVE   @Y17XAXF 03100000
TRMQNPL  EQU   X'08'                      Q'D NEG POLL LIM REC @Y17XAXF 03200000
TRMERLCK EQU   X'04' .                    TERM IN ERROR LCK    @Y17XAXF 03300000
TRMSPOUT EQU   X'02' .                    SPEC PROC REQ        @Y17XAXF 03400000
TRMLYNCH EQU   X'01' .                    DISCONNECT REC'VD    @Y17XAXF 03500000
         SPACE 1                                               @YM08120 03520000
TRMNCP1  DS    XL1 .                    STATUS BYTE NCP        @YM08120 03540000
TRMINOP  EQU   X'80' .                  CHAN INOP RECEIVED     @YM08120 03560000
*        EQU   X'40'-X'01'              RESERVED               @YM08120 03580000
         SPACE 3                                               @Y17XAXF 03600000
TRMBYTE3 DS    0XL1 .                   STATUS BYTE            @Y17XAXF 03700000
         SPACE 2                                               @Y17XAXF 03800000
TRMPRE   DS    0XL1 .                   STATUS BYTE (PRE-SNA)  @Y17XAXF 03900000
TRMSTPND EQU   X'80' .                    STATUS PENDING FLAG  @Y17XAXF 04000000
TRMCMODE EQU   X'40' .                    CHGE OF MODE REQUEST @Y17XAXF 04100000
TRMSTMM  EQU   X'20' .                    STOP MID MESS IN PRG @Y17XAXF 04200000
TRMASNXI EQU   X'10' .                    RESET IMMED INPRG    @Y17XAXF 04300000
TRMWROUT EQU   X'08' .                    WRITE OUTSTANDING    @Y17XAXF 04400000
TRMNLOUT EQU   X'04' .                    NULL WRT OR CONTACT  @Y17XAXF 04500000
*                                          OUTSTANDING         @Y17XAXF 04600000
TRMRDOUT EQU   X'02' .                    READ OUTSTANDING     @Y17XAXF 04700000
TRMINOUT EQU   X'01' .                    INVITE OUTSTANDING   @Y17XAXF 04800000
         SPACE 1                                               @Y17XAXF 04900000
TRMNCP   DS    0XL1 .            (ABNL) STATUS BYTE (NCP ONLY) @Y17XAXF 05000000
TRMIPLDM EQU   X'80' .           (ABNL)   IPL/DUMP IN PROGRESS @Y17XAXF 05100000
TRMNCPCL EQU   X'40' .                    NCP CLOSE DOWN IN-PRG@Y17XAXF 05200000
TRMSYGEN EQU   X'20' .                    SYSGEN NCP ACTIVE STATE       05300000
*                                                              @Y17XAXF 05400000
TRMSLOWN EQU   X'10' .                    3705 SLOWDOWN INPRG  @Y17XAXF 05500000
TRMQUCKN EQU   X'08'                      NCP QUICK CLOSEDWN   @Y17XAXF 05600000
* TRMNCONT     BITS 5-7                   NCP CONTACT STATES   @Y17XAXF 05700000
         SPACE 1                                               @Y17XAXF 05800000
TRMPU    DS    0XL1 .                   STATUS BYTE (PUNT ONLY)@Y17XAXF 05900000
*        EQU   X'80'-X'08' .              RESERVED             @Y17XAXF 06000000
* TRMPCONT     BITS 5-7                   PU  CONTACT STATES   @Y17XAXF 06100000
TRMCRSET EQU   X'00' .   TRMNCONT          RESET               @Y17XAXF 06200000
TRMCCSNT EQU   X'01' .        VALUES       CONTACT SENT        @Y17XAXF 06300000
TRMCAPND EQU   X'02' .        ALSO         ACTIVE PENDING      @Y17XAXF 06400000
TRMCRPND EQU   X'03' .                     RESET PENDING       @Y17XAXF 06500000
TRMCACTV EQU   X'04' .                     ACTIVE              @Y17XAXF 06600000
         SPACE 1                                               @Y17XAXF 06700000
TRMLU    DS    0XL1 .            (ABNL) STATUS BYTE (LUNT ONLY)@PI06917 06800000
TRMAUTO  EQU   X'80' .                    AUTO BIND TO TCAM    @Y17XAXF 06900000
TRMLUIT  EQU   X'40' .                    LU INITIATES SESSION @Y17XAXF 07000000
TRMLUTM  EQU   X'20' .                    LU TERMINATES SESSION@Y17XAXF 07100000
TRMTDIFF EQU   X'10' .                    TOTE TERM IND        @Y17XAXF 07200000
TRMSESRQ EQU   X'08' .                    LU-LU SESS REQ FROM  @Y17XAXF 07300000
*                                          IEDLUS              @Y17XAXF 07400000
TRMLUREQ EQU   X'04' .                    SESS INITIATED BY LU @Y17XAXF 07500000
TRMINERR EQU   X'02' .                    INITIATION ERROR PROCESSING   07600000
*                                           IN PROGRESS        @PI06917 07700000
TRMLULOG EQU   X'01'                      CAPABLE OF LOGON TO TCAM      07800000
*                                                              @Y17XAXF 07900000
         SPACE 1                                               @Y17XAXF 08000000
TRMLINK  DS    XL1 .                    STATUS BYTE (LINE ONLY)@Y17XAXF 08100000
TRMEPMOD EQU   X'80' .                    LINE IN EP MODE      @Y17XAXF 08200000
TRMLINT  EQU   X'40' .                    3705 LINE TRACE ACT  @Y17XAXF 08300000
*TRMLSTAT      BITS 2+3                   LINK STATUS          @Y17XAXF 08400000
TRMLRSET EQU   X'00' .                     RESET               @Y17XAXF 08500000
TRMLAPND EQU   X'10' .                     ACTIVE PENDING      @Y17XAXF 08600000
TRMLRPND EQU   X'20' .                     RESET PENDING       @Y17XAXF 08700000
TRMLACTV EQU   X'30' .                     ACTIVE              @Y17XAXF 08800000
*        EQU   X'08'-X'01' .               RESERVED            @Y17XAXF 08900000
         SPACE 3                                               @Y17XAXF 09000000
TRMBYTE2 DS    XL1 .             (ABNL) STATUS BYTE            @Y17XAXF 09100000
TRMRSACT EQU   X'80' .                    RESOURCE ACTIVE      @Y17XAXF 09200000
*                                            SNA - SSCP SESS   @Y17XAXF 09300000
*                                                  EXISTS      @Y17XAXF 09400000
*                                            PRE SNA - VARY    @Y17XAXF 09500000
*                                                  ONTP CMD    @Y17XAXF 09600000
TRMREMB  EQU   X'40' .           (ABNL)   ACTIVATE REMEMBER BIT@Y17XAXF 09700000
TRMINPG  EQU   X'20' .                    ACT/DEACT IN PROGRESS@Y17XAXF 09800000
*                                            FOR SSCP SESSION  @Y17XAXF 09900000
TRMCLOSN EQU   X'20' .                   CLOSEDOWN IN PROGRESS @YM06966 10000000
TRMANDL  EQU   X'10' .                    MANUAL DIAL IN PROCES@Y17XAXF 10100000
TRMGPACT EQU   X'08' .                    GENERAL POLL IS ACTVE@Y17XAXF 10200000
TRMPREP  EQU   X'04' .                    LINE BEING MONITORED @Y17XAXG 10300000
TRMNOSND EQU   X'02' .                    DO NOT CONTINUE SEND @Y17XAXF 10400000
*                                          OPERATION           @Y17XAXF 10500000
TRMWRBRK EQU   X'01' .                    WRITE BREAK IN       @Y17XAXG 10600000
*                                          PROGRESS            @Y17XAXG 10700000
         SPACE 1                                               @Y17XAXF 10800000
TRMBYTE1 DS    XL1 .                    STATUS BYTE            @Y17XAXF 10900000
TRMSCPRQ EQU   X'80' .                    SSCP REQ OUTSTANDING @Y17XAXF 11000000
TRMWTNEG EQU   X'80' .                    (PRE-SNA) WAITING    @Y17XAXF 11100000
*                                           FOR RSP TO NEG POLL@Y17XAXF 11200000
TRMINPTP EQU   X'40' .                    INPUT PENDING        @Y17XAXF 11300000
TRMAUTOC EQU   X'20' .                    CALL OUT FROM 3705   @Y17XAXF 11400000
TRMSWBCK EQU   X'10' .                    TERM ON BKUP CONN    @Y17XAXF 11500000
TRMTRACE EQU   X'08' .                    PIU TRACE ACTIVE     @Y17XAXF 11600000
TRMTSATN EQU   X'04' .                    INTERACTIVE ATTN CTL @Y17XAXF 11700000
TRMCKPRN EQU   X'02' .                    CKPT REC IND FOR 3705@Y17XAXF 11800000
*                                            RESOURCE          @Y17XAXF 11900000
TRMSTOTE EQU   X'01' .                    TOTE CONTROLS RESOURC@Y17XAXF 12000000
TRMCOHRT DS    H .                      TTCIN TO NEXT ENTRY OF @Y17XAXF 12100000
*                                         SAME TYPE            @Y17XAXF 12200000
         SPACE 1                                               @Y17XAXF 12300000
TRMBYTE0 DS    XL1 .                    STATUS BYTE            @Y17XAXF 12400000
TRMUDEF  EQU   X'80' .                    INVALID TSO MTA TERM @Y17XAXF 12500000
TRMINPUT EQU   X'40' .                    CAPABLE OF INPUT     @Y17XAXF 12600000
TRMOUTPT EQU   X'20' .                    CAPABLE OF OUTPUT    @Y17XAXF 12700000
*        EQU   X'10' .                    RESERVED             @Y17XAXF 12800000
TRMDIAL  EQU   X'08' .                    DIAL TERMINAL        @Y17XAXF 12900000
TRMGP    EQU   X'04' .                    GENERAL POLL RESOURCE@Y17XAXF 13000000
TRMSNA   EQU   X'02' .                    SNA RESOURCE         @Y17XAXF 13100000
TRMBUFRD EQU   X'01' .                    BUFFER RESOURCE      @Y17XAXF 13200000
         SPACE 1                                               @Y17XAXF 13300000
TRMSIBPT DS    0AL3 .                   ANCHOR FOR SIB CHAIN   @Y17XAXF 13400000
TRMGPCNT DS    CL1 .                    CNT OF OUTSTANDING     @Y17XAXF 13500000
*                                            GP OUTPUT OPER    @Y17XAXF 13600000
TRMCOHTG DS    H .                      TTCIN TO NEXT LINE     @Y17XAXF 13700000
*                                            WITHIN A GROUP    @Y17XAXF 13800000
TRMRLMCT DS    XL1 .                    RECEIVE MESS LIMIT CNT @Y17XAXF 13900000
TRMTYPE  DS    CL1 .                    RESOURCE TYPE          @Y17XAXF 14000000
*                                                              @Y17XAXF 14100000
*        GUIDE LINES FOR ASSIGNING TYPE VALUES                 @Y17XAXF 14200000
*         X'01' - X'0F'  NCP RANGE                             @Y17XAXF 14300000
*         X'10' - X'1F'  PUNT RANGE                            @Y17XAXF 14400000
*         X'20' - X'2F'  LINE RANGE                            @Y17XAXF 14500000
*         X'30' - X'3F'  LUNT RANGE                            @Y17XAXF 14600000
*         X'40' - X'4F'  PRE-SNA RANGE                         @Y17XAXF 14700000
*         X'50' - X'EF'  NEW TYPES                             @Y17XAXF 14800000
*         X'F0' - X'FF'  HOST ELEMENT RANGE                    @Y17XAXF 14900000
*                                                              @Y17XAXF 15000000
TRMGRP   EQU   X'00' .                    GROUP INDICATOR      @Y17XAXF 15100000
TRMLNCP  EQU   X'0F' .                    LOCAL NCP INDICATOR  @Y17XAXF 15200000
TRMPULO  EQU   X'10'                    LOW END OF PUNT RANGE           15250082
         SPACE 1                                               @Y17XAXF 15300000
TRMPUNT  EQU   X'18' .                    PUNT INDICATOR       @Y17XAXF 15400000
TRMPUHI  EQU   X'1F'                    HIGH END OF PUNT RANGE          15450082
         SPACE 1                                               @Y17XAXF 15500000
TRMNSDLC EQU   X'20' .                    BSC/SS LINE IND      @Y17XAXF 15600000
TRMSDLC  EQU   X'21' .                    SDLC LINE IND        @Y17XAXF 15700000
         SPACE 1                                               @Y17XAXF 15800000
TRMLUNT  EQU   X'30' .                    LUNT INDICATOR       @Y17XAXF 15900000
         SPACE 1                                               @Y17XAXF 16000000
TRMCLUST EQU   X'40' .                    PRE-SNA CLUSTER      @Y17XAXF 16100000
TRMCTERM EQU   X'48' .                    CTERM INDICATOR      @Y17XAXF 16200000
TRMPSNA  EQU   X'4F' .                    PRE-SNA TERM IND     @Y17XAXF 16300000
*                                                              @Y17XAXF 16400000
*              X'50'-X'EF'                RESERVED             @Y17XAXF 16500000
*                                                              @Y17XAXF 16600000
         SPACE 1                                               @Y17XAXF 16700000
TRMSSCP  EQU   X'FF' .                    SSCP INDICATOR       @Y17XAXF 16800000
         SPACE 1                                               @Y17XAXF 16900000
TRMSUBST DS    H .                      TTCIN TO FIRST ELEMENT @Y17XAXF 17000000
*                                         OF NEXT HIERARCHY    @Y17XAXF 17100000
*                                         LEVEL                @Y17XAXF 17200000
IEDQTRM  EQU   *                                                 S22024 17400000
         SPACE                                                          17500000
TRMSTATE DS    XL1 .                    STATUS BYTE                     17600000
*                        BIT DEFINITIONS                                17700000
*                                       TYPE OF ENTRY - BITS 0-2        17800000
*                                         SINGLE     000                17900000
*                                         PROCESS    001                18000000
*                                         LIST (C D) 010                18100000
*                                         LOGTYPE    011        SA53610 18200000
*                                         LINE ENTRY 100                18300000
TRMPROC  EQU   X'20'                    PROCESS ENTRY           SA53610 18400000
TRMLIST  EQU   X'40'                    LIST ENTRY              SA53610 18500000
TRMLOG   EQU   X'60'                    LOGTYPE ENTRY           SA53610 18600000
TRMLINE  EQU   X'80'                    LINE ENTRY              SA53610 18700000
TRMPREF  EQU   X'10' .                  TTE PREFIX EXISTS      @Y17XAXF 18800000
*                                        AND NON-270X RES      @Y17XAXF 18900000
TRMSNGLE EQU   X'E0' .                  MASK TO TEST FOR TPROC @Y17XAXF 19000000
*                                       LIST, LOG OR LINE.     @Y17XAXF 19100000
TRMACPTN EQU   X'08' .                  PROCESS ENTRY STATUS            19200000
TRMACPTF EQU   X'FF'-X'08' .            PROCESS ENTRY STATUS            19300000
TRMHELDN EQU   X'04' .                  TERMINAL IN HOLD MODE           19400000
TRMHELDF EQU   X'FF'-X'04' .            TERMINAL NOT INTERCEPTED        19500000
TRMOPTFN EQU   X'02' .                  OPTION FIELDS USED              19600000
TRMOPTFF EQU   X'FF'-X'02' .            NO OPTION FIELDS USED           19700000
TRMSCNYN EQU   X'01' .                  SECONDARY OPERATOR CTL TERM     19800000
TRMSCNYF EQU   X'FF'-X'01' .            NOT OPERATOR CONTROL TERM       19900000
*                                                                       20000000
TRMDESTQ DS    AL3 .                    ADDR OF DESTINATION QCB         20100000
TLISTCNT DS    0H .                     COUNT OF ENTRIES IN A TLIST     20200000
TRMUTERM DS    0H .                     CTERM TNT INDEX (LINE ONLY)     20300000
*                                                              @Y17XAXF 20400000
TRMINSEQ DS    H .                      INPUT SEQUENCE NUMBER           20500000
TLISTEN  DS    0H .                     FIRST ENTRY IN A TLIST          20600000
TRMDSORG DS    0XL1 .                   LGB IDENTIFIER         @Y17XAXF 20700000
TRMLGB   EQU   X'80' .                  INDICATES BLOCK IS AN    S22024 20800000
*                                       LGB RATHER THAN A        S22024 20900000
*                                       TERMINAL ENTRY           S22024 21000000
TRMOUTSQ DS    H .                      OUTPUT SEQUENCE NUMBER          21100000
TRMPRILK DS    0H .                     TTCIN OF LINE BEFORE BACKUP     21200000
*                                        OCCURRED (LINE ONLY)  @Y17XAXF 21300000
TRMALTD  DS    H .                      ALTERNATE DEST OFFSET    X03039 21400000
TRMDEVFL DS    H .                      DEVICE DEPENDENT FIELD FLAGS.   21500000
*                        BIT DEFINITIONS                                21600000
TRMBUFS  EQU   X'80' .               0    BUF SIZE SPECIFIED   @Y17XAXF 21700000
TRMDDIG  EQU   X'40' .               1    DIAL DIGITS PRESENT  @Y17XAXF 21800000
TRMADDC  EQU   X'20' .               2    ADDRESSING CHAR PRE  @Y17XAXF 21900000
TRMBLKS  EQU   X'10' .               3    BLK SPECIFIED        @Y17XAXF 22000000
TRMSBLK  EQU   X'08' .               4    SUBBLK SPECIFIED     @Y17XAXF 22100000
TRMTBLK  EQU   X'04' .               5    TRANSPARENT BLK LENG @Y17XAXF 22200000
TRMBFDY  EQU   X'02' .               6    BFDELAY SPECIFIED    @Y17XAXF 22300000
TRMTSOB  EQU   X'01' .               7    TIME SHARING FIELD   @Y17XAXF 22400000
TRMCONC  EQU   X'80' .               8    CONC OR TERMINAL       S22026 22500000
*                                         ATTACHED TO A CONC     S22026 22600000
TRMLMD   EQU   X'40' .               9    LMD=YES                S22026 22700000
*        EQU   X'20' .              10    RETRY                @Y17XAXF 22800000
TRMRNTRM EQU   X'10' .              11    3705 MODE            @Y17XAXF 22900000
TRMNCPI  EQU   X'08' .              12    3705 DEV DEP INFO    @Y17XAXF 23000000
TRMTPIN  EQU   X'04' .              13    TPROCESS INFO        @Y17XAXF 23100000
*        EQU   X'02'-X'01' .     14&15    RESERVED             @Y17XAXF 23200000
TRMSTAT  DS    0F .                     ERROR STATISTICS                23300000
TRMSIO   DS    H .                      NUMBER OF START I/OS   @Y17XAXF 23400000
TRMTEMPR DS    XL1 .                    NUMBER OF TEMPORARY ERRORS      23500000
TRMSENSE DS    XL1 .                    INTENSIVE MODE RECORDING        23600000
*                                       INDICATOR                       23700000
TRMCHCIN DS    XL1 .                    DEVICE CHARACTERISTIC TABLE     23800000
*                                       INDEX                           23900000
TRMOPNO  DS    XL1 .                    NUMBER OF OPTION ENTRIES        24000000
TRMOPTBL DS    H .                      OFFSET TO OPTION TABLE          24100000
TRMOPT   DS    0XL1 .                   START OF OPTION OFFSETS         24200000
*                                                                       24300000
*         ***************************************************           24400000
*     0   *   STATE   *                 DESTQ               *           24500000
*         ***************************************************           24600000
*     4   *   INSEQ/TLISTCNT       *     OUTSEQ/TLISTEN     *           24700000
*         ***************************************************           24800000
*     8   *         ALTD           *           DEVFL        *           24900000
*         ***************************************************           25000000
*    12   *                       STAT                      *           25100000
*         ***************************************************           25200000
*    16   *   CCHIN   *    OPNO    *           OPTBL        *           25300000
*         ***************************************************           25400000
*    20   *   OPT     *                                                 25500000
*         *************                                                 25600000
*                                                                       25700000
TRMPRFSZ EQU   IEDQTRM-IEDNTRM                                   S22024 25800000
         MEND  , */                                                     25900000
*%BSLTRM  :  ;                                                          26000000
*%IF NEGADDR='NO'                       /* IF NEW TTRMD IS   @Y17XAXF*/ 26100000
*   %THEN %GOTO BSLTRM1;                /*  NEEDED, BRANCH   @Y17XAXF*/ 26200000
*DECLARE                                                                26300000
*  1 IEDQTRM  BASED(IEDQTPTR) BDY(WORD),                  /* @Y17XAXF*/ 26400000
*                                                                       26500000
*/*      UPDATED 01/16/73                                      S22024*/ 26600000
*                                                                       26700000
*   2 TRMSTATE    BIT(8),               /* STATUS BYTE                  26800000
*                            BIT DEFINITIONS                            26900000
*                           TYPE OF ENTRY - BITS 0-2                    27000000
*                                SINGLE     000                         27100000
*                                PROCESS    001                         27200000
*                                LIST (C D) 010                         27300000
*                                LOGTYPE    011               SA53610   27400000
*                                LINE ENTRY 100                      */ 27500000
*    3 TRMLINE BIT(1),                  /* LINE ENTRY         SA53610*/ 27600000
*    3 TRMLOG BIT(2),                   /* LOGTYPE ENTRY      SA53610*/ 27700000
*     4 TRMLIST BIT(1),                 /* LIST ENTRY         SA53610*/ 27800000
*     4 TRMPROC BIT(1),                 /* PROCESS ENTRY      SA53610*/ 27900000
*    3 TRMPREF  BIT(1),                 /* TTE PREFIX EXISTS @Y17XAXF*/ 28000000
*                                       /*  AND NON-270X RES @Y17XAXF*/ 28100000
*    3 TRMACPTN BIT(1),                 /* PROCESS ENTRY STATUS      */ 28200000
*    3 TRMHELDN BIT(1),                 /* TERMINAL IN HOLD MODE     */ 28300000
*    3 TRMOPTFN BIT(1),                 /* OPTION FIELDS USED        */ 28400000
*    3 TRMSCNYN BIT(1),                 /* SECONDARY OPERATOR CTL       28500000
*                                       TERM                         */ 28600000
*/*                                                                  */ 28700000
*   2 TRMDESTQ    PTR(24),              /* ADDR OF DEST QCB  @Y17XAXF*/ 28800000
*   2 TRMINSEQ    FIXED(16),            /* INPUT SEQUENCE NUMBER     */ 28900000
*    3 TLISTCNT    FIXED(16),           /* COUNT OF ENTRIES IN A        29000000
*                                       TLIST                        */ 29100000
*     4 TRMUTERM    FIXED(16),          /* CTERM TNT INDEX (LINE ONLY)  29200000
*                                                            @Y17XAXF*/ 29300000
*   2 TRMOUTSQ    FIXED(16),            /* OUTPUT SEQUENCE NUMBER    */ 29400000
*    3 TLISTEN     FIXED(16),           /* FIRST ENTRY IN A TLIST    */ 29500000
*      5 TRMDSORG    CHAR(1),           /* LGB IDENTIFIER    @Y17XAXF*/ 29600000
*       6 TRMLGB   BIT(1),              /* INDICATES BLOCK IS AN LGB    29700000
*                                       RATHER THAN A TERMINAL          29800000
*                                       ENTRY                  S22024*/ 29900000
*   2 TRMALTD     FIXED(16),            /* ALTERNATE DESTINATION        30000000
*                                       OFFSET                       */ 30100000
*    3 TRMPRILK   FIXED(16),            /* TTCIN OF LINE BEFORE BACKUP  30200000
*                                          OCCURED (LINE ONLY)          30300000
*                                                            @Y17XAXF*/ 30400000
*   2 TRMDEVFL    BIT(16)  BDY(HWORD),  /* DEVICE DEPENDENT FLAGS       30500000
*                                           INDICATES WHICH FIELDS      30600000
*                                           ARE PRESENT      @Y17XAXF*/ 30700000
*    3 TRMBUFS  BIT(1),                 /* BUFSIZE SPEC      @Y17XAXF*/ 30800000
*    3 TRMDDIG  BIT(1),                 /* DIAL DIGITS PRE   @Y17XAXF*/ 30900000
*    3 TRMADDC  BIT(1),                 /* ADDR CHAR PRESENT @Y17XAXF*/ 31000000
*    3 TRMBLKS  BIT(1),                 /* BLK SPECIFIED     @Y17XAXF*/ 31100000
*    3 TRMSBLK  BIT(1),                 /* SUBBLK SPECIFIED  @Y17XAXF*/ 31200000
*    3 TRMTBLK  BIT(1),                 /* TRANSPARNT BLKLEN @Y17XAXF*/ 31300000
*    3 TRMBFDY  BIT(1),                 /* BFDELAY SPEC      @Y17XAXF*/ 31400000
*    3 TRMTSOB  BIT(1),                 /* TSO FIELD         @Y17XAXF*/ 31500000
*    3 TRMCONC  BIT(1),                 /* CONCENTRATOR TERM   S22026*/ 31600000
*    3 TRMLMD   BIT(1),                 /* LMD SPECIFIED       S22026*/ 31700000
*    3 *        BIT(1),                 /* RETRY SPECIFIED     S22025*/ 31800000
*    3 TRMRNTRM BIT(1),                 /* 3705 MODE         @Y17XAXF*/ 31900000
*    3 TRMNCPI  BIT(1),                 /* 3705 DEV DEP INFO @Y17XAXF*/ 32000000
*    3 TRMTPIN  BIT(1),                 /* TPROCESS INFO     @Y17XAXF*/ 32100000
*    3 *        BIT(2),                 /* RESERVED          @Y17XAXF*/ 32200000
*   2 TRMSTAT     FIXED(31),            /* ERROR STATISTICS          */ 32300000
*     4 TRMSIO      FIXED(15),          /* NUMBER OF START I/OS      */ 32400000
*     4 TRMTEMPR    PTR(8),             /* TEMPORARY ERROR COUNT     */ 32500000
*     4 TRMSENSE    CHAR(1),            /* INTENSIVE MODE RECORDING     32600000
*                                       INDICATOR                    */ 32700000
*   2 TRMCHCIN    FIXED(8),             /* DEVICE CHARACTERISTIC        32800000
*                                       INDEX                        */ 32900000
*   2 TRMOPNO     PTR(8),               /* NUMBER OF OPTION ENTRIES  */ 33000000
*   2 TRMOPTBL    FIXED(16);            /* OFFSET TO OPTION TABLE    */ 33100000
*DECLARE   TRMOPT  (*) CHAR(1) DEF(IEDQTRM)               /* @Y17XAXF*/ 33200000
*  POS(LENGTH(IEDQTRM)+1);                                              33300000
*                                       /* START OF OPTION OFFSETS   */ 33400000
*                                                                       33500000
*                                                                       33600000
*/*       ***************************************************        */ 33700000
*/*   0   *   STATE   *                 DESTQ               *        */ 33800000
*/*       ***************************************************        */ 33900000
*/*   4   *   INSEQ/TLISTCNT       *     OUTSEQ/TLISTEN     *        */ 34000000
*/*       ***************************************************        */ 34100000
*/*   8   *         ALTD           *           DEVFL        *        */ 34200000
*/*       ***************************************************        */ 34300000
*/*  12   *                       STAT                      *        */ 34400000
*/*       ***************************************************        */ 34500000
*/*  16   *   CCHIN   *    OPNO    *           OPTBL        *        */ 34600000
*/*       ***************************************************        */ 34700000
*/*  20   *   OPT     *                                              */ 34800000
*/*       *************                                              */ 34900000
*DECLARE                                                                35000000
*  1 IEDNTRM BASED(ADDR(IEDQTRM)-LENGTH(IEDNTRM)) BDY(HWORD),           35100000
*                                                         /* @Y17XAXF*/ 35200000
*   2 TRMBYTE4 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 35300000
*   2 TRMBYTE3 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 35400000
*   2 TRMBYTE2 BIT(8) ABNL,             /* STATUS BYTE       @Y17XAXF*/ 35500000
*     3 TRMRSACT BIT(1),                /*  RESOURCE ACTIVE  @Y17XAXF*/ 35600000
*                                       /*    SNA -SSCP SESS @Y17XAXF*/ 35700000
*                                       /*          EXISTS   @Y17XAXF*/ 35800000
*                                       /*    PRE SNA - VARY @Y17XAXF*/ 35900000
*                                       /*          ONTP CMD @Y17XAXF*/ 36000000
*     3 TRMREMB  BIT(1) ABNL,           /*  ACTIV REM'BR BIT @Y17XAXF*/ 36100000
*     3 TRMINPG  BIT(1),                /*  ACT/DEACT INPRG  @Y17XAXF*/ 36200000
*                                       /*    FOR SSCP SESS  @Y17XAXF*/ 36300000
*       4 TRMCLOSN BIT(1),         /* CLOSEDOWN IN PROGRESS  @YM06966*/ 36400000
*     3 TRMANDL  BIT(1),                /*  MANUAL DIAL INPG @Y17XAXF*/ 36500000
*     3 TRMGPACT BIT(1),                /*  WRITE OUTSTAND'G @Y17XAXF*/ 36600000
*     3 TRMPREP  BIT(1),                /*  LINE BEING       @Y17XAXG*/ 36700000
*                                       /*  MONITORED        @Y17XAXG*/ 36800000
*     3 TRMNOSND BIT(1),                /*  DO NOT CONTINUE  @Y17XAXF*/ 36900000
*                                       /*   SEND OPERATION  @Y17XAXF*/ 37000000
*     3 TRMWRBRK BIT(1),                /*  WRITE BREAK IN   @Y17XAXG*/ 37100000
*                                       /*  PROGRESS         @Y17XAXG*/ 37200000
*   2 TRMBYTE1 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 37300000
*     3 TRMSCPRQ BIT(1),                /*  SSCP REQ OUTST'G @Y17XAXF*/ 37400000
*       4 TRMWTNEG BIT(1),              /*  (PRE-SNA)WAITING @Y17XAXF*/ 37500000
*                                       /*    FOR RSP TO NEG @Y17XAXF*/ 37600000
*                                       /*    POLL           @Y17XAXF*/ 37700000
*     3 TRMINPTP BIT(1),                /*  INPUT PEND'G     @Y17XAXF*/ 37800000
*     3 TRMAUTOC BIT(1),                /*  CALLOUT FRM 3705 @Y17XAXF*/ 37900000
*     3 TRMSWBCK BIT(1),                /*  TERM ON BKUP     @Y17XAXF*/ 38000000
*                                       /*   CONNECTION      @Y17XAXF*/ 38100000
*     3 TRMTRACE BIT(1),                /*  PIU TRACE ACTIVE @Y17XAXF*/ 38200000
*     3 TRMTSATN BIT(1),                /*  INTERACT ATTENT  @Y17XAXF*/ 38300000
*                                       /*   CONTROL         @Y17XAXF*/ 38400000
*     3 TRMCKPRN BIT(1),                /*  CHKPT REC IND    @Y17XAXF*/ 38500000
*                                       /*   FOR 3705 RES    @Y17XAXF*/ 38600000
*     3 TRMSTOTE BIT(1),                /*  TOTE CTRLS RES   @Y17XAXF*/ 38700000
*   2 TRMCOHRT FIXED(16),               /* TTCIN TO NEXT ENT @Y17XAXF*/ 38800000
*                                       /*  OF SAVE TYPE     @Y17XAXF*/ 38900000
*   2 TRMBYTE0 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 39000000
*     3 TRMUDEF  BIT(1),                /*  INV TSO MTA TRM  @Y17XAXF*/ 39100000
*     3 TRMINPUT BIT(1),                /*  CAPABLE OF INPUT @Y17XAXF*/ 39200000
*     3 TRMOUTPT BIT(1),                /*  CAPABLE OF OUTPT @Y17XAXF*/ 39300000
*     3 *        BIT(1),                /*  RESERVED         @Y17XAXF*/ 39400000
*     3 TRMDIAL  BIT(1),                /*  DIAL TERMINAL    @Y17XAXF*/ 39500000
*     3 TRMGP    BIT(1),                /*  GEN POLL RES     @Y17XAXF*/ 39600000
*     3 TRMSNA   BIT(1),                /*  SNA RESOURCE     @Y17XAXF*/ 39700000
*     3 TRMBUFRD BIT(1),                /*  BUFFERED RES     @Y17XAXF*/ 39800000
*   2 TRMSIBPT PTR(24),                 /* SIB CHAIN PTR     @Y17XAXF*/ 39900000
*     3 TRMGPCNT CHAR(1),               /* CNT OF OUTSTAND'G @Y17XAXF*/ 40000000
*                                       /*   GP OUTPUT OPER  @Y17XAXF*/ 40100000
*     3 TRMCOHTG FIXED(16),             /* TTCIN TO NXT LINE @Y17XAXF*/ 40200000
*                                       /*   WITHIN A GRP    @Y17XAXF*/ 40300000
*   2 TRMRLMCT PTR(8),                  /* REC MES LIMIT CNT @Y17XAXF*/ 40400000
*   2 TRMTYPE  CHAR(1),                 /* RESOURCE TYPE     @Y17XAXF*/ 40500000
*   2 TRMSUBST FIXED(16);               /* TTCIN TO 1ST ELEMENT OF      40600000
*                                            NEXT HIERARCHY LEVEL       40700000
*                                                            @Y17XAXF*/ 40800000
*%GOTO BSLTRM2;                         /*                   @Y17XAXF*/ 54000000
*                                                                       54100000
*%BSLTRM1 : ;                           /*                   @Y17XAXF*/ 54200000
*DECLARE                                                  /* @Y17XAXF*/ 54300000
* 1 IEDTRM BASED(RTRM) BDY(HWORD),                        /* @Y17XAXF*/ 54400000
*/*                                                          @Y17XAXF*/ 54500000
*/*      FORMAT OF TTE PREFIX                                @Y17XAXF*/ 54600000
*/*                                                          @Y17XAXF*/ 54700000
*  2 IEDNTRM CHAR(14) BDY(HWORD),       /* TTE PREFIX        @Y17XAXF*/ 54800000
*   3 TRMBYTE4 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 54900000
*   3 TRMBYTE3 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 55000000
*   3 TRMBYTE2 BIT(8) ABNL,             /* STATUS BYTE       @Y17XAXF*/ 55100000
*     4 TRMRSACT BIT(1),                /*  RESOURCE ACTIVE  @Y17XAXF*/ 55200000
*                                       /*    SNA -SSCP SESS @Y17XAXF*/ 55300000
*                                       /*          EXISTS   @Y17XAXF*/ 55400000
*                                       /*    PRE SNA - VARY @Y17XAXF*/ 55500000
*                                       /*          ONTP CMD @Y17XAXF*/ 55600000
*     4 TRMREMB  BIT(1) ABNL,           /*  ACTIV REM'BR BIT @Y17XAXF*/ 55700000
*     4 TRMINPG  BIT(1),                /*  ACT/DEACT INPRG  @Y17XAXF*/ 55800000
*                                       /*    FOR SSCP SESS  @Y17XAXF*/ 55900000
*       5 TRMCLOSN BIT(1),         /* CLOSEDOWN IN PROGRESS  @YM06966*/ 56000000
*     4 TRMANDL  BIT(1),                /*  MANUAL DIAL INPG @Y17XAXF*/ 56100000
*     4 TRMGPACT BIT(1),                /*  WRITE OUTSTAND'G @Y17XAXF*/ 56200000
*     4 TRMPREP  BIT(1),                /*  LINE BEING       @Y17XAXG*/ 56300000
*                                       /*  MONITORED        @Y17XAXG*/ 56400000
*     4 TRMNOSND BIT(1),                /*  DO NOT CONTINUE  @Y17XAXF*/ 56500000
*                                       /*   SEND OPERATION  @Y17XAXF*/ 56600000
*     4 TRMWRBRK BIT(1),                /*  WRITE BREAK IN   @Y17XAXG*/ 56700000
*                                       /*  PROGRESS         @Y17XAXG*/ 56800000
*   3 TRMBYTE1 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 56900000
*     4 TRMSCPRQ BIT(1),                /*  SSCP REQ OUTST'G @Y17XAXF*/ 57000000
*       5 TRMWTNEG BIT(1),              /*  (PRE-SNA)WAITING @Y17XAXF*/ 57100000
*                                       /*    FOR RSP TO NEG @Y17XAXF*/ 57200000
*                                       /*    POLL           @Y17XAXF*/ 57300000
*     4 TRMINPTP BIT(1),                /*  INPUT PEND'G     @Y17XAXF*/ 57400000
*     4 TRMAUTOC BIT(1),                /*  CALLOUT FRM 3705 @Y17XAXF*/ 57500000
*     4 TRMSWBCK BIT(1),                /*  TERM ON BKUP     @Y17XAXF*/ 57600000
*                                       /*   CONNECTION      @Y17XAXF*/ 57700000
*     4 TRMTRACE BIT(1),                /*  PIU TRACE ACTIVE @Y17XAXF*/ 57800000
*     4 TRMTSATN BIT(1),                /*  INTERACT ATTENT  @Y17XAXF*/ 57900000
*                                       /*   CONTROL         @Y17XAXF*/ 58000000
*     4 TRMCKPRN BIT(1),                /*  CHKPT REC IND    @Y17XAXF*/ 58100000
*                                       /*   FOR 3705 RES    @Y17XAXF*/ 58200000
*     4 TRMSTOTE BIT(1),                /*  TOTE CTRLS RES   @Y17XAXF*/ 58300000
*   3 TRMCOHRT FIXED(16),               /* TTCIN TO NEXT ENT @Y17XAXF*/ 58400000
*                                       /*  OF SAVE TYPE     @Y17XAXF*/ 58500000
*   3 TRMBYTE0 BIT(8),                  /* STATUS BYTE       @Y17XAXF*/ 58600000
*     4 TRMUDEF  BIT(1),                /*  INV TSO MTA TRM  @Y17XAXF*/ 58700000
*     4 TRMINPUT BIT(1),                /*  CAPABLE OF INPUT @Y17XAXF*/ 58800000
*     4 TRMOUTPT BIT(1),                /*  CAPABLE OF OUTPT @Y17XAXF*/ 58900000
*     4 *        BIT(1),                /*  RESERVED         @Y17XAXF*/ 59000000
*     4 TRMDIAL  BIT(1),                /*  DIAL TERMINAL    @Y17XAXF*/ 59100000
*     4 TRMGP    BIT(1),                /*  GEN POLL RES     @Y17XAXF*/ 59200000
*     4 TRMSNA   BIT(1),                /*  SNA RESOURCE     @Y17XAXF*/ 59300000
*     4 TRMBUFRD BIT(1),                /*  BUFFERED RES     @Y17XAXF*/ 59400000
*   3 TRMSIBPT PTR(24),                 /* SIB CHAIN PTR     @Y17XAXF*/ 59500000
*     4 TRMGPCNT CHAR(1),               /* CNT OF OUTSTAND'G @Y17XAXF*/ 59600000
*                                       /*   GP OUTPUT OPER  @Y17XAXF*/ 59700000
*     4 TRMCOHTG FIXED(16),             /* TTCIN TO NXT LINE @Y17XAXF*/ 59800000
*                                       /*   WITHIN A GRP    @Y17XAXF*/ 59900000
*   3 TRMRLMCT PTR(8),                  /* REC MES LIMIT CNT @Y17XAXF*/ 60000000
*   3 TRMTYPE  CHAR(1),                 /* RESOURCE TYPE     @Y17XAXF*/ 60100000
*   3 TRMSUBST FIXED(16),               /* TTCIN TO 1ST ELEMENT OF      60200000
*                                            NEXT HIERARCHY LEVEL       60300000
*                                                            @Y17XAXF*/ 60400000
*  2 IEDQTRM  CHAR(20) BDY(WORD),       /* BEGINNING OF TTE  @Y17XAXF*/ 60500000
*   3 TRMSTATE    BIT(8),               /* STATUS BYTE                  60600000
*                            BIT DEFINITIONS                            60700000
*                           TYPE OF ENTRY - BITS 0-3                    60800000
*                                SINGLE     000                         60900000
*                                PROCESS    001                         61000000
*                                LIST (C D) 010                         61100000
*                                LOGTYPE    011               SA53610   61200000
*                                LINE ENTRY 100                      */ 61300000
*    4 TRMLINE BIT(1),                  /* LINE ENTRY         SA53610*/ 61400000
*    4 TRMLOG BIT(2),                   /* LOGTYPE ENTRY      SA53610*/ 61500000
*     5 TRMLIST BIT(1),                 /* LIST ENTRY         SA53610*/ 61600000
*     5 TRMPROC BIT(1),                 /* PROCESS ENTRY      SA53610*/ 61700000
*    4 TRMPREF  BIT(1),                 /* TTE PREFIX EXISTS @Y17XAXF*/ 61800000
*                                       /*  AND NON-270X RES @Y17XAXF*/ 61900000
*    4 TRMACPTN BIT(1),                 /* PROCESS ENTRY STATUS      */ 62000000
*    4 TRMHELDN BIT(1),                 /* TERMINAL IN HOLD MODE     */ 62100000
*    4 TRMOPTFN BIT(1),                 /* OPTION FIELDS USED        */ 62200000
*    4 TRMSCNYN BIT(1),                 /* SECONDARY OPERATOR CTL       62300000
*                                       TERM                         */ 62400000
*/*                                                                  */ 62500000
*   3 TRMDESTQ    PTR(24),              /* ADDR OF DEST QCB  @Y17XAXF*/ 62600000
*   3 TRMINSEQ    FIXED(16),            /* INPUT SEQUENCE NUMBER     */ 62700000
*    4 TLISTCNT    FIXED(16),           /* COUNT OF ENTRIES IN A        62800000
*                                       TLIST                        */ 62900000
*     5 TRMUTERM    FIXED(16),          /* CTERM TNT INDEX (LINE ONLY)  63000000
*                                                            @Y17XAXF*/ 63100000
*   3 TRMOUTSQ    FIXED(16),            /* OUTPUT SEQUENCE NUMBER    */ 63200000
*    4 TLISTEN     FIXED(16),           /* FIRST ENTRY IN A TLIST    */ 63300000
*      5 TRMDSORG    CHAR(1),           /* LGB IDENTIFIER    @Y17XAXF*/ 63400000
*       6 TRMLGB   BIT(1),              /* INDICATES BLOCK IS AN LGB    63500000
*                                       RATHER THAN A TERMINAL          63600000
*                                       ENTRY                  S22024*/ 63700000
*   3 TRMALTD     FIXED(16),            /* ALTERNATE DESTINATION        63800000
*                                       OFFSET                       */ 63900000
*    4 TRMPRILK   FIXED(16),            /* TTCIN OF LINE BEFORE BACKUP  64000000
*                                          OCCURRED (LINE ONLY)         64100000
*                                                            @Y17XAXF*/ 64200000
*   3 TRMDEVFL    BIT(16)  BDY(HWORD),  /* DEVICE DEPENDENT FLAGS       64300000
*                                           INDICATES WHICH FIELDS      64400000
*                                           ARE PRESENT      @Y17XAXF*/ 64500000
*    4 TRMBUFS  BIT(1),                 /* BUFSIZE SPEC      @Y17XAXF*/ 64600000
*    4 TRMDDIG  BIT(1),                 /* DIAL DIGITS PRE   @Y17XAXF*/ 64700000
*    4 TRMADDC  BIT(1),                 /* ADDR CHAR PRESENT @Y17XAXF*/ 64800000
*    4 TRMBLKS  BIT(1),                 /* BLK SPECIFIED     @Y17XAXF*/ 64900000
*    4 TRMSBLK  BIT(1),                 /* SUBBLK SPECIFIED  @Y17XAXF*/ 65000000
*    4 TRMTBLK  BIT(1),                 /* TRANSPARNT BLKLEN @Y17XAXF*/ 65100000
*    4 TRMBFDY  BIT(1),                 /* BFDELAY SPEC      @Y17XAXF*/ 65200000
*    4 TRMTSOB  BIT(1),                 /* TSO FIELD         @Y17XAXF*/ 65300000
*    4 TRMCONC  BIT(1),                 /* CONCENTRATOR TERM   S22026*/ 65400000
*    4 TRMLMD   BIT(1),                 /* LMD SPECIFIED       S22026*/ 65500000
*    4 *        BIT(1),                 /* RETRY SPECIFIED     S22025*/ 65600000
*    4 TRMRNTRM BIT(1),                 /* 3705 MODE         @Y17XAXF*/ 65700000
*    4 TRMNCPI  BIT(1),                 /* 3705 DEV DEP INFO @Y17XAXF*/ 65800000
*    4 TRMTPIN  BIT(1),                 /* TPROCESS INFO     @Y17XAXF*/ 65900000
*    4 *        BIT(2),                 /* RESERVED          @Y17XAXF*/ 66000000
*   3 TRMSTAT     FIXED(31),            /* ERROR STATISTICS          */ 66100000
*     4 TRMSIO      FIXED(15),          /* NUMBER OF START I/OS      */ 66200000
*     4 TRMTEMPR    PTR(8),             /* TEMPORARY ERROR COUNT     */ 66300000
*     4 TRMSENSE    CHAR(1),            /* INTENSIVE MODE RECORDING     66400000
*                                       INDICATOR                    */ 66500000
*   3 TRMCHCIN    FIXED(8),             /* DEVICE CHARACTERISTIC        66600000
*                                       INDEX                        */ 66700000
*   3 TRMOPNO     PTR(8),               /* NUMBER OF OPTION ENTRIES  */ 66800000
*   3 TRMOPTBL    FIXED(16),            /* OFFSET TO OPTION TABLE    */ 66900000
*  2 TRMOPT  (*) CHAR(1);               /* OPTION INFO       @Y17XAXF*/ 67000000
*                                       /*                   @Y17XAXF*/ 67100000
*%BSLTRM2 : ;                           /*                   @Y17XAXF*/ 67150000
*/*                                                          @Y17XAXF*/ 67200000
*/*      VALUES FOR TRMTYPE                                  @Y17XAXF*/ 67300000
*/*                                                          @Y17XAXF*/ 67400000
*/*            GUIDE LINES FOR ASSIGNING TYPE VALUES         @Y17XAXF*/ 67500000
*/*             X'01' - X'0F'  NCP RANGE                     @Y17XAXF*/ 67600000
*/*             X'10' - X'1F'  PUNT RANGE                    @Y17XAXF*/ 67700000
*/*             X'20' - X'2F'  LINE RANGE                    @Y17XAXF*/ 67800000
*/*             X'30' - X'3F'  LUNT RANGE                    @Y17XAXF*/ 67900000
*/*             X'40' - X'4F'  PRE-SNA RANGE                 @Y17XAXF*/ 68000000
*/*             X'50' - X'EF'  NEW TYPES                     @Y17XAXF*/ 68100000
*/*             X'F0' - X'FF'  HOST ELEMENT RANGE            @Y17XAXF*/ 68200000
*/*                                                          @Y17XAXF*/ 68300000
* DCL                                      /*                @Y17XAXF*/ 68400000
*       TRMGRP   BIT(8)  CONSTANT('00'X),  /*  GROUP IND     @Y17XAXF*/ 68500000
*       TRMLNCP  BIT(8)  CONSTANT('0F'X);  /*  NCP INDICATOR @Y17XAXF*/ 68600000
* DCL                                      /*                @Y17XAXF*/ 68700000
*       TRMPUNT  BIT(8)  CONSTANT('18'X);  /*  PUNT IND      @Y17XAXF*/ 68800000
* DCL                                      /*                @Y17XAXF*/ 68900000
*       TRMNSDLC BIT(8)  CONSTANT('20'X),  /*  BSC/SS LINE   @Y17XAXF*/ 69000000
*       TRMSDLC  BIT(8)  CONSTANT('21'X);  /*  SDLC LINE     @Y17XAXF*/ 69100000
* DCL                                      /*                @Y17XAXF*/ 69200000
*       TRMLUNT  BIT(8)  CONSTANT('30'X);  /*  LUNT IND      @Y17XAXF*/ 69300000
* DCL                                      /*                @Y17XAXF*/ 69400000
*       TRMCLUST BIT(8)  CONSTANT('40'X),  /*  PRE-SNA CLUST @Y17XAXF*/ 69500000
*       TRMCTERM BIT(8)  CONSTANT('48'X),  /*  CTERM IND     @Y17XAXF*/ 69600000
*       TRMPSNA  BIT(8)  CONSTANT('4F'X);  /*  PRE-SNA IND   @Y17XAXF*/ 69700000
*/*                                                          @Y17XAXF*/ 69800000
*/*      X'50'- X'EF'    RESERVED                            @Y17XAXF*/ 69900000
*/*                                                          @Y17XAXF*/ 70000000
* DCL                                      /*                @Y17XAXF*/ 70100000
*       TRMSSCP  BIT(8)  CONSTANT('FF'X);  /*  SSCP IND      @Y17XAXF*/ 70200000
*/*                                                          @Y17XAXF*/ 70300000
*/*      VALUES FOR TRMSTATE                                 @Y17XAXF*/ 70400000
*/*                                                          @Y17XAXF*/ 70500000
* DCL                                                     /* @Y17XAXF*/ 70600000
*        TRMSNGLE BIT(8) CONSTANT('E0'X);    /* MASK TO TEST @Y17XAXF*/ 70700000
*                                            /* FOR TPROC,   @Y17XAXF*/ 70800000
*                                            /* LOG, LIST OR @Y17XAXF*/ 70900000
*                                            /* LINE.        @Y17XAXG*/ 71000000
*/*                                                          @Y17XAXF*/ 71100000
*/*      CONTACT STATE VALUES (USED WITH TRMPCONT AND        @Y17XAXF*/ 71200000
*/*                                      TRMNCONT)           @Y17XAXF*/ 71300000
* DCL                                   /*                   @Y17XAXF*/ 71400000
*      TRMCRSET  BIT(3)  CONSTANT('000'B),  /* RESET         @Y17XAXF*/ 71500000
*      TRMCCSNT  BIT(3)  CONSTANT('001'B),  /* CONTACT SENT  @Y17XAXF*/ 71600000
*      TRMCAPND  BIT(3)  CONSTANT('010'B),  /* ACTIVE PEND'G @Y17XAXF*/ 71700000
*      TRMCRPND  BIT(3)  CONSTANT('011'B),  /* RESET PENDING @Y17XAXF*/ 71800000
*      TRMCACTV  BIT(3)  CONSTANT('100'B);  /* ACTIVE        @Y17XAXF*/ 71900000
*/*                                                          @Y17XAXF*/ 72000000
*/*      LINK STATES(USED WITH TRMLSTAT)                     @Y17XAXF*/ 72100000
*/*                                                          @Y17XAXF*/ 72200000
* DCL                                                     /* @Y17XAXF*/ 72300000
*        TRMLRSET BIT(2)  CONSTANT('00'B), /* RESET          @Y17XAXF*/ 72400000
*        TRMLAPND BIT(2)  CONSTANT('01'B), /* ACTIVE PENDING @Y17XAXF*/ 72500000
*        TRMLRPND BIT(2)  CONSTANT('10'B), /* RESET PENDING  @Y17XAXF*/ 72600000
*        TRMLACTV BIT(2)  CONSTANT('11'B); /* ACTIVE         @Y17XAXF*/ 72700000
*/*                                                          @Y17XAXF*/ 72800000
*/*      DEVICE DEPENDENT FIELD MASKS                        @Y17XAXF*/ 72900000
*/*                                                          @Y17XAXF*/ 73000000
* DCL                                                     /* @Y17XAXF*/ 73100000
*        TRMTPINM BIT(16) CONSTANT('0004'X),/* TPROCESS INFO MASK       73200000
*                                                            @Y17XAXF*/ 73300000
*        TRMNCPIM BIT(16) CONSTANT('0008'X),/* NCP INFO MASK @Y17XAXF*/ 73400000
*        TRMRNTMK BIT(16) CONSTANT('0010'X),/* 3705 MODE FLD @Y17XAXF*/ 73500000
*        TRMDDIGA BIT(16) CONSTANT('4000'X);/* DIAL DIGITS FIELD        73600000
*                                                            @Y17XAXF*/ 73700000
*                                                         /* @Y17XAXG*/ 73800000
* DECLARE                                                 /* @Y17XAXF*/ 73900000
*  1 TRMPRE1  BIT(8) DEFINED(TRMBYTE4), /* PRE-SNA STAT BYTE @Y17XAXF*/ 74000000
*    2 TRMCONT  BIT(1),                 /*  CONTACT INIT SES @Y17XAXF*/ 74100000
*    2 TRMSESSN BIT(1),                 /*  TERM IN SESSION  @Y17XAXF*/ 74200000
*    2 TRMOCNI  BIT(1),                 /*  STOP LINE INPRG  @Y17XAXF*/ 74300000
*    2 TRMSPACT BIT(1),                 /*  TERM'S LINE ACTV @Y17XAXF*/ 74400000
*    2 TRMQNPL  BIT(1),                 /*  Q'D NEG POLL LIM @Y17XAXF*/ 74500000
*                                       /*   RECEIVED        @Y17XAXF*/ 74600000
*    2 TRMERLCK BIT(1),                 /*  TERM IN ERR LOCK @Y17XAXF*/ 74700000
*    2 TRMSPOUT BIT(1),                 /*  SPEC PROC REQ    @Y17XAXF*/ 74800000
*    2 TRMLYNCH BIT(1);                 /*  DISCONN REC'VD   @Y17XAXF*/ 74900000
*DECLARE                                /*                   @YM08120*/ 74920000
* 1 TRMNCP1 BIT(8) DEF(TRMBYTE4),       /* STATUS BYTE       @YM08120*/ 74940000
*  2 TRMINOP BIT(1),                    /* INOP FOR NCP      @YM08120*/ 74960000
*  2    *    BIT(7);                    /* RESERVED          @YM08120*/ 74980000
* DECLARE                                                 /* @Y17XAXF*/ 75000000
*  1 TRMPRE  BIT(8) DEFINED(TRMBYTE3),  /* PRE-SNA STAT BYTE @Y17XAXF*/ 75100000
*    2 TRMSTPND BIT(1),                 /*  STAT PEND'G FLAG @Y17XAXF*/ 75200000
*    2 TRMCMODE BIT(1),                 /*  CHG MODE REQUEST @Y17XAXF*/ 75300000
*    2 TRMSTMM  BIT(1),                 /*  STOP MIDMES INPG @Y17XAXF*/ 75400000
*    2 TRMASNXI BIT(1),                 /*  RESET IMMED INPG @Y17XAXF*/ 75500000
*    2 TRMWROUT BIT(1),                 /*  WRITE OUTSTAND'G @Y17XAXF*/ 75600000
*    2 TRMNLOUT BIT(1),                 /*  NULL WRITE OR    @Y17XAXF*/ 75700000
*                                       /*   CONTACT OUTST'G @Y17XAXF*/ 75800000
*    2 TRMRDOUT BIT(1),                 /*  READ OUTSTAND'G  @Y17XAXF*/ 75900000
*    2 TRMINOUT BIT(1);                 /*  INVITE OUTST'G   @Y17XAXF*/ 76000000
* DECLARE                                                 /* @Y17XAXF*/ 76100000
*  1 TRMNCP BIT(8) DEF(TRMBYTE3) ABNL,  /* NCP STATUS BYTE   @Y17XAXF*/ 76200000
*    2 TRMIPLDM BIT(1) ABNL,            /*  IPL/DMP INPROG   @Y17XAXF*/ 76300000
*    2 TRMNCPCL BIT(1),                 /*  CLOSEDOWN INPRG  @Y17XAXF*/ 76400000
*    2 TRMSYGEN BIT(1),                 /*  SYSGEN NCP ACTIVE STATE     76500000
*                                                            @Y17XAXF*/ 76600000
*    2 TRMSLOWN BIT(1),                 /*  3705 SLOWDWN     @Y17XAXF*/ 76700000
*                                       /*   IN PROGRESS     @Y17XAXF*/ 76800000
*    2 TRMQUCKN BIT(1),                 /*  NCP QUICK        @Y17XAXF*/ 76900000
*                                       /*   CLOSEDOWN       @Y17XAXF*/ 77000000
*    2 TRMNCONT BIT(3);                 /*  NCP CONTACT      @Y17XAXF*/ 77100000
*                                       /*   STATE           @Y17XAXF*/ 77200000
* DECLARE                                                 /* @Y17XAXF*/ 77300000
*  1 TRMPU  BIT(8) DEFINED(TRMBYTE3),   /* PU STATUS BYTE    @Y17XAXF*/ 77400000
*    2 *        BIT(5),                 /*  RESERVED         @Y17XAXF*/ 77500000
*    2 TRMPCONT BIT(3);                 /*  PU CONTACT       @Y17XAXF*/ 77600000
*                                       /*   STATES          @Y17XAXF*/ 77700000
* DECLARE                                                 /* @Y17XAXF*/ 77800000
*  1 TRMLU BIT(8) DEFINED(TRMBYTE3) ABNL,/*LUNT STATUS BYTE  @PI06917*/ 77900000
*    2 TRMAUTO  BIT(1),                 /*  AUTO BIND TO     @Y17XAXF*/ 78000000
*                                       /*   TCAM            @Y17XAXF*/ 78100000
*    2 TRMLUIT  BIT(1),                 /*  LU INITIATES     @Y17XAXF*/ 78200000
*                                       /*   SESSION         @Y17XAXF*/ 78300000
*    2 TRMLUTM  BIT(1),                 /*  LU TERMINATES    @Y17XAXF*/ 78400000
*                                       /*   SESSION         @Y17XAXF*/ 78500000
*    2 TRMTDIFF BIT(1),                 /*  TOTE TERM IND    @Y17XAXF*/ 78600000
*    2 TRMSESRQ BIT(1),                 /*  LU-LU SESS REQ   @Y17XAXF*/ 78700000
*                                       /*   FROM IEDLUS     @Y17XAXF*/ 78800000
*    2 TRMLUREQ BIT(1),                 /*  SESS INITIATED   @Y17XAXF*/ 78900000
*                                       /*   BY LU           @Y17XAXF*/ 79000000
*    2 TRMINERR BIT(1),                 /*  INITIATION ERROR PROCESSING 79100000
*                                           IN PROGRESS      @PI06917*/ 79200000
*    2 TRMLULOG BIT(1);                 /*  CAPABLE OF LOGON TO TCAM    79300000
*                                                            @Y17XAXF*/ 79400000
* DECLARE                                                 /* @Y17XAXF*/ 79500000
*  1 TRMLINK BIT(8) DEFINED(TRMBYTE3),  /* LINE STATUS BYTE  @Y17XAXF*/ 79600000
*    2 TRMEPMOD BIT(1),                 /*  LINE IN EP MODE  @Y17XAXF*/ 79700000
*    2 TRMLINT  BIT(1),                 /*  3705 TRACE ACTVE @Y17XAXF*/ 79800000
*    2 TRMLSTAT BIT(2),                 /*  LINK STATUS      @Y17XAXF*/ 79900000
*    2 *        BIT(4);                 /*  RESERVED         @Y17XAXF*/ 80000000
*%TRMPRFSZ='LENGTH(IEDNTRM)';           /* MACRO VAR PRF LEN @Y17XAXF*/ 80100000
*/*                                                                  */ 80200000
./  ADD  SSI=62890495,NAME=TTSWD
*        %GOTO PLSTSW;                  /* BILINGUAL HEADER             00002010
         MACRO                                                          00004010
         TTSWD                                                          00006010
.*A000000-999999                                               @Y17XAXF 00008010
IEDQTSW  DSECT                                                          00010010
*                                                                       00012010
*        TSO WORK AREA                                                  00014010
*                                                                       00016010
TSWTSBFR DS    A .                      TSO BFR OR MSGGEN ADDR          00018010
TSWTCBFR DS    A .                      TCAM BFR OR SCB MSGGEN ADDR     00020010
TSWMOVED DS    H .                      NUMBER BYTES DATA MOVED         00022010
TSWLINE  DS    H .                      NUMBER BYTES REMAINING ON LINE  00024010
TSWTSBSZ DS    H .                      TSO BFR DATA SIZE               00026010
TSWMSGSZ DS    H .                      MESSAGE SIZE                    00028010
TSWTCBSZ DS    H .                      TCAM BFR SIZE                   00030010
TSWFCD   DS    X .                      3270 FUNCTION CODES             00032010
TSWSTFD  EQU   X'F0' .                   START FIELD INSERT             00034010
TSWRDAT  EQU   X'F1' .                   READ ATTRIBUTE INSERT          00036010
TSWSBA   EQU   X'F2' .                   SBA INSERT                     00038010
TSWCUR1  EQU   X'F3' .                   FIRST CURSOR INSERT            00040010
TSWCUR2  EQU   X'F4' .                   SECOND CURSOR INSERT           00042010
TSWINC   EQU   X'F5' .                   INC ORDER INSERT               00044010
TSWETX   EQU   X'F6' .                   ETX INSERT                     00046010
TSWEOT   EQU   X'F7' .                   EOT INSERT                     00048010
TSWETXOT EQU   X'F8' .                   ETX/EOT INSERT                 00050010
TSWBYP   EQU   X'F9' .                   BYPASS CHAR INSERT             00052010
TSWRES   EQU   X'FA' .                   RESTORE CHAR INSERT            00054010
TSWCARCT DS    X .                      CARRIAGE POSITION               00056010
TSWTSLNS DS    0H .                     TSB OR DEFAULT LINE SIZE        00058010
TSWLNN   DS    X .                      NUMBER OF LINES FOR DISPLAYS    00060010
TSWLNSZ  DS    X .                      LINE SIZE FOR DISPLAYS          00062010
TSWSWT1  DS    X .                      SWITCH 1                        00064010
TSWC2F   EQU   X'80' .                   SECOND CURSOR FLAG             00066010
TSWC1F   EQU   X'40' .                   FIRST CURSOR FLAG              00068010
TSWRDAF  EQU   X'20' .                   READ ATTRIBUTE FLAG            00070010
TSWSFF   EQU   X'10' .                   START FIELD FLAG               00072010
TSWBYPF  EQU   X'08' .                   BYPASS CHAR FLAG               00074010
TSWCRNLF EQU   X'04' .                   CARRIAGE RETURN/NEW LINE FLAG  00076010
TSWSBAF  EQU   X'02' .                   SET BUFFER ADDRESS FLAG        00078010
TSWWRAF  EQU   X'01' .                   WRITE ATTRIBUTE FLAG           00080010
TSWSWT2  DS    X .                      SWITCH 2                        00082010
TSWRC4   EQU   4 .                       CALCSIZE RC 4                  00084010
TSWRC8   EQU   8 .                       CALCSIZE RC 8                  00086010
TSWRC12  EQU   12 .                      CALCSIZE RC 12                 00088010
TSWRC16  EQU   16 .                      CALCSIZE RC 16                 00090010
TSWRC40  EQU   40 .                      CALCSIZE RC 40                 00092010
TSWRC44  EQU   44 .                      CALCSIZE RC 44                 00094010
TSWFLG1  DS    X .                      TSO FUNCTION FLAGS 1            00096010
TSWTSMSG EQU   X'80' .                   TSO MESSAGE                    00098010
TSWSASIS EQU   X'60' .                   ASIS SCREEN CONTROL            00100010
TSWCTL   EQU   X'40' .                   CONTROL MODE EDIT              00102010
TSWASIS  EQU   X'20' .                   ASIS EDIT                      00104010
TSWMSGN1 EQU   X'10' .                   FIRST MSGGEN SWITCH            00106010
TSWFMTI  EQU   X'08' .                   SCREEN FORMAT IN BFR           00108010
TSWNLEFT EQU   X'06' .                   NO LEFT JUSTIFICATION REQ      00110010
TSWLEFT  EQU   X'05' .                   LEFT JUSTIFICATION REQ         00112010
TSWFLG2  DS    X .                      TSO FUNCTION FLAGS 2            00114010
*        EQU   X'80'-'02'                RESERVED              @YM06885 00114510
TSWNROOM EQU   X'01' .                   NO ROOM IN TCAM BFR   @YM06885 00115010
*                                          FOR EDIT            @YM06885 00115510
TSWCURSV DS    H .                      SCREEN CURSOR ADDRESS           00116010
TSWEFLG1 DS    X .                      EDIT FLAGS 1                    00118010
TSWTRLR  EQU   X'80' .                   TRAILER BUFFER FLAG            00120010
TSWPRTMV EQU   X'40' .                   PARTIAL MOVE FLAG              00122010
TSWRESF  EQU   X'20' .                   RESTORE CHAR FLAG              00124010
TSWRECAL EQU   X'10' .                   BYPASS CODE AND RESET          00126010
TSWSYN   EQU   X'08' .                   SYN CHARS INSERTED    @YM06885 00128010
TSWINCF  EQU   X'04' .                   INSERT CURSOR FLAG             00130010
TSWEOTF  EQU   X'02' .                   EOT FLAG                       00132010
TSWETXF  EQU   X'01' .                   ETX FLAG                       00134010
TSWEFLG2 DS    X .                      EDIT FLAG 2                     00136010
TSW3705  EQU   X'80' .                   TERMINAL ON 3705               00138010
TSW1050  EQU   X'40' .                   TERMINAL IS 1050               00140010
TSWPRMPT EQU   X'20' .                   PROMPT STRING FLAG             00142010
TSWNLCRF EQU   X'10' .                   NL/CR COUNT FLAG               00144010
TSWLNCT  EQU   X'08' .                   LINE COUNT FLAG                00146010
TSWRDAP  EQU   X'04' .                   READ ATTRIBUTE LINE POS. FLAG  00148010
TSWHDRF  EQU   X'02' .                   FIRST BASIC UNIT FLAG          00150010
TSWNMVCT EQU   X'01' .                   NO MOVE COUNT FLAG             00152010
TSWFIRST DS    X .                      FIRST CHARACTER                 00154010
TSWLAST  DS    X .                      LAST CHARACTER                  00156010
TSWTOCT  DS    F .                      TO DATA COUNT                   00158010
TSWFRCT  DS    F .                      FROM DATA COUNT                 00160010
TSWTSCUR DS    F .                      CURRENT TSO BUFFER              00162010
TSWMSGNL DS    H .                      LENGTH OF MSGGEN DATA           00164010
TSWSBAI  EQU   X'EF' .                   SBA ALREADY INCLUDED           00166010
TSWCUR1I EQU   X'EE' .                   CUR1 ALREADY INCLUDED          00168010
TSWCUR2I EQU   X'ED' .                   CUR2 ALREADY INCLUDED          00170010
TSWSFI   EQU   X'EC' .                   START FIELD ALREADY INCLUDED   00172010
TSWWRAI  EQU   X'EB' .                   WRITE ATTRIBUTE INCLUDED       00174010
TSWDSAV  DS    D .                      DOUBLE WORD SAVE                00176010
TSWDCT   DS    CL6 .                    DCT ENTRY                       00176210
TSWLEN   EQU   *-IEDQTSW .              TSO WORKAREA LENGTH             00178010
         MEND  */                                                       00180010
*%PLSTSW:;                                                              00182010
* DECLARE                                                               00184010
*  1 IEDQTSW  BASED(RTSW),                                              00186010
*/*                                                                  */ 00188010
*/*      TSO WORK AREA                                               */ 00190010
*/*                                                                  */ 00192010
*   2 TSWTSBFR PTR(31),                 /* TSO BFR OR MSGGEN ADDR    */ 00194010
*   2 TSWTCBFR PTR(31),                 /* TCAM BFR OR SCB MSGGEN ADDR  00196010
*                                                                    */ 00198010
*   2 TSWMOVED FIXED(16),               /* NUMBER BYTES DATA MOVED   */ 00200010
*   2 TSWLINE  FIXED(16),               /* NUMBER BYTES REMAINING ON    00202010
*                                          LINE                      */ 00204010
*   2 TSWTSBSZ FIXED(16),               /* TSO BFR DATA SIZE         */ 00206010
*   2 TSWMSGSZ FIXED(16),               /* MESSAGE SIZE              */ 00208010
*   2 TSWTCBSZ FIXED(16),               /* TCAM BFR SIZE             */ 00210010
*   2 TSWFCD   BIT(8),                  /* 3270 FUNCTION CODES       */ 00212010
*   2 TSWCARCT FIXED(8),                /* CARRIAGE POSITION         */ 00214010
*   2 TSWTSLNS FIXED(16),               /* TSB OR DEFAULT LINE SIZE  */ 00216010
*    3 TSWLNN   FIXED(8),               /* NUM OF LINES FOR DISPLAYS */ 00218010
*    3 TSWLNSZ  FIXED(8),               /* LINE SIZE FOR DISPLAYS    */ 00220010
*   2 TSWSWT1  BIT(8),                  /* SWITCH 1                  */ 00222010
*    3 TSWC2F   BIT(1),                 /* SECOND CURSOR FLAG        */ 00224010
*    3 TSWC1F   BIT(1),                 /* FIRST CURSOR FLAG         */ 00226010
*    3 TSWRDAF  BIT(1),                 /* READ ATTRIBUTE FLAG       */ 00228010
*    3 TSWSFF   BIT(1),                 /* START FIELD FLAG          */ 00230010
*    3 TSWBYPF  BIT(1),                 /* BYPASS CHAR FLAG          */ 00232010
*    3 TSWCRNLF BIT(1),                 /* CARR RETURN/NEW LINE FLAG */ 00234010
*    3 TSWSBAF  BIT(1),                 /* SET BUFFER ADDRESS FLAG   */ 00236010
*    3 TSWWRAF  BIT(1),                 /* WRITE ATTRIBUTE FLAG      */ 00238010
*   2 TSWSWT2  BIT(8),                  /* SWITCH 2                  */ 00240010
*   2 TSWFLG1  BIT(8),           /* TSO FUNCTION FLAGS 1      @YM06885*/00242010
*    3 TSWTSMSG  BIT(1),         /* TSO MESSAGE               @YM06885*/00242210
*    3 TSWSCCTL  BIT(2),         /* SCREEN CONTROL            @YM06885*/00242410
*     4 TSWCTL   BIT(1),         /* CONTROL MODE EDIT         @YM06885*/00242610
*     4 TSWASIS BIT(1),          /* ASIS EDIT                 @YM06885*/00242810
*    3 TSWMSGN1  BIT(1),         /* FIRST MSGGEN SWITCH       @YM06885*/00243010
*    3 TSWFMTI   BIT(1),         /* SCREEN FORMAT IN BFR      @YM06885*/00243210
*    3 TSWJUSTI  BIT(3),         /* JUSTIFICATION FLAGS       @YM06885*/00243410
*   2 TSWFLG2  BIT(8),           /* TSO FUNCTION FLAGS 2      @YM06885*/00244010
*    3 *         BIT(7),         /* RESERVED                  @YM06885*/00244510
*    3 TSWNROOM  BIT(1),         /* NO ROOM IN TCAM BFR       @YM06885*/00245010
*                                /*   FOR EDIT                @YM06885*/00245510
*   2 TSWCURSV FIXED(16),               /* SCREEN CURSOR ADDRESS     */ 00246010
*   2 TSWEFLG1 BIT(8),                  /* EDIT FLAGS 1              */ 00248010
*    3 TSWTRLR  BIT(1),                 /* TRAILER BUFFER FLAG       */ 00250010
*    3 TSWPRTMV BIT(1),                 /* PARTIAL MOVE FLAG         */ 00252010
*    3 TSWRESF  BIT(1),                 /* RESTORE CHAR FLAG         */ 00254010
*    3 TSWRECAL BIT(1),                 /* BYPASS CODE AND RESET     */ 00256010
*    3 TSWSYN   BIT(1),                 /* SYN CHARS INSERTED @YM06885*/00258010
*    3 TSWINCF  BIT(1),                 /* INSERT CURSOR FLAG        */ 00260010
*    3 TSWEOTF  BIT(1),                 /* EOT FLAG                  */ 00262010
*    3 TSWETXF  BIT(1),                 /* ETX FLAG                  */ 00264010
*   2 TSWEFLG2 BIT(8),                  /* EDIT FLAG 2               */ 00266010
*    3 TSW3705  BIT(1),                 /* TERMINAL ON 3705          */ 00268010
*    3 TSW1050  BIT(1),                 /* TERMINAL IS 1050          */ 00270010
*    3 TSWPRMPT BIT(1),                 /* PROMPT STRING FLAG        */ 00272010
*    3 TSWNLCRF BIT(1),                 /* NL/CR COUNT FLAG          */ 00274010
*    3 TSWLNCT  BIT(1),                 /* LINE COUNT FLAG           */ 00276010
*    3 TSWRDAP  BIT(1),                 /* READ ATTRIBUTE LINE POS.     00278010
*                                          FLAG                      */ 00280010
*    3 TSWHDRF  BIT(1),                 /* FIRST BASIC UNIT FLAG     */ 00282010
*    3 TSWNMVCT BIT(1),                 /* NO MOVE COUNT FLAG        */ 00284010
*   2 TSWFIRST CHAR(1),                 /* FIRST CHARACTER           */ 00286010
*   2 TSWLAST  CHAR(1),                 /* LAST CHARACTER            */ 00288010
*   2 TSWTOCT  FIXED(31),               /* TO DATA COUNT             */ 00290010
*   2 TSWFRCT  FIXED(31),               /* FROM DATA COUNT           */ 00292010
*   2 TSWTSCUR FIXED(31),               /* CURRENT TSO BUFFER        */ 00294010
*   2 TSWMSGNL FIXED(16),               /* LENGTH OF MSGGEN DATA     */ 00296010
*   2 TSWDSAV  CHAR(8),                 /* DOUBLE WORD SAVE          */ 00298010
*   2 TSWDCT   CHAR(6);                 /* DCT ENTRY                 */ 00298210
*%TSWLEN='LENGTH(IEDQTSW)';             /* TSO WORKAREA LENGTH       */ 00300010
*                                                                       00302010
*/*                                                                  */ 00304010
*/*      TSWFCD VALUES                                               */ 00306010
*/*                                                                  */ 00308010
* DCL TSWSTFD  BIT(8) CONSTANT('F0'X);  /* START FIELD INSERT        */ 00310010
* DCL TSWRDAT  BIT(8) CONSTANT('F1'X);  /* READ ATTRIBUTE INSERT     */ 00312010
* DCL TSWSBA   BIT(8) CONSTANT('F2'X);  /* SBA INSERT                */ 00314010
* DCL TSWCUR1  BIT(8) CONSTANT('F3'X);  /* FIRST CURSOR INSERT       */ 00316010
* DCL TSWCUR2  BIT(8) CONSTANT('F4'X);  /* SECOND CURSOR INSERT      */ 00318010
* DCL TSWINC   BIT(8) CONSTANT('F5'X);  /* INC ORDER INSERT          */ 00320010
* DCL TSWETX   BIT(8) CONSTANT('F6'X);  /* ETX INSERT                */ 00322010
* DCL TSWEOT   BIT(8) CONSTANT('F7'X);  /* EOT INSERT                */ 00324010
* DCL TSWETXOT BIT(8) CONSTANT('F8'X);  /* ETX/EOT INSERT            */ 00326010
* DCL TSWBYP   BIT(8) CONSTANT('F9'X);  /* BYPASS CHAR INSERT        */ 00328010
* DCL TSWRES   BIT(8) CONSTANT('FA'X);  /* RESTORE CHAR INSERT       */ 00330010
*/*                                                                  */ 00332010
*/*      TSWSWT2 VALUES                                              */ 00334010
*/*                                                                  */ 00336010
* DCL TSWRC4   FIXED(8) CONSTANT(4);    /* CALCSIZE RC 4             */ 00338010
* DCL TSWRC8   FIXED(8) CONSTANT(8);    /* CALCSIZE RC 8             */ 00340010
* DCL TSWRC12  FIXED(8) CONSTANT(12);   /* CALCSIZE RC 12            */ 00342010
* DCL TSWRC16  FIXED(8) CONSTANT(16);   /* CALCSIZE RC 16            */ 00344010
* DCL TSWRC40  FIXED(8) CONSTANT(40);   /* CALCSIZE RC 40            */ 00346010
* DCL TSWRC44  FIXED(8) CONSTANT(44);   /* CALCSIZE RC 44            */ 00348010
*/*                                                                  */ 00350010
*/*     TSWSCCTL VALUES                                       @YMO6885*/00352010
*/*                                                                  */ 00354010
* DCL TSWSASIS BIT(2) CONSTANT('11'B);  /* ASIS SCREEN CNTRL  @YM06885*/00358010
*/*                                                                  */ 00358510
*/*     TSWJUSTI VALUES                                       @YM06885*/00359010
*/*                                                                  */ 00359510
* DCL TSWNLEFT BIT(3) CONSTANT('110'B); /*NO LEFT JUSTIFY RQD @YM06885*/00368010
* DCL TSWLEFT  BIT(3) CONSTANT('101'B); /* LEFT JUSTIFY REQD  @YM06885*/00370010
*/*                                                                  */ 00372010
*/*      TSWMSGNL VALUES                                             */ 00374010
*/*                                                                  */ 00376010
* DCL TSWSBAI  BIT(8) CONSTANT('EF'X);  /* SBA ALREADY INCLUDED      */ 00378010
* DCL TSWCUR1I BIT(8) CONSTANT('EE'X);  /* CUR1 ALREADY INCLUDED     */ 00380010
* DCL TSWCUR2I BIT(8) CONSTANT('ED'X);  /* CUR2 ALREADY INCLUDED     */ 00382010
* DCL TSWSFI   BIT(8) CONSTANT('EC'X);  /* START FIELD  INCLUDED     */ 00384010
* DCL TSWWRAI  BIT(8) CONSTANT('EB'X);  /* WRITE ATTRIBUTE INCLUDED  */ 00386010
./  ADD  SSI=71440462,NAME=TTTCD
*   %GOTO PLSTTTCD;               /* BILINGUAL HEADER                   01000000
         MACRO                                                          02000000
         TTTCD                                                          03000000
.*A000000-999999                                               @Y17XAXV 04000000
.*C160000,630000-640000                                        @G36XRXV 04500010
*                                 ... TOTE/TCAM CONTROL BLOCKS ...      05000000
IEDTTCD  DSECT                                                          06000000
TTCSTOFF EQU   LCBRCQCB-IEDQLCB         OFFSET INTO LCB OF LCBRCQCB     07000000
         ORG   IEDTTCD+L'LCBRCQCB                                       08000000
*                                                                       09000000
TTCSVCPL DS    0F                       SVC 102 PARM LIST               10000000
TTCSVCW1 DS    0A                       WORD 1                          11000000
TTCPCODE DS    CL1                      POST CODE                       12000000
TTCFIRST DS    AL3                      ADDR OF FIRST ELEMENT           13000000
TTCSVCW2 DS    0A                       WORD 2                          14000000
TTCLAST  DS    AL4                      ADDR OF LAST ELEMENT            15000000
TTCCHAIN EQU   X'B4'                    CHAIN AQCTL POST       @G36XRXV 16000010
*                                                                       17000000
         ORG   IEDTTCD+LCBSTAT1-LCBRCQCB DISPLACEMENT TO NEXT LCB FLDS  18000000
         ORG   IEDTTCD+LCBSCBA-LCBRCQCB+L'LCBSCBA LOCATION PAST LCB     19000000
*                                       FIELDS                          20000000
*                                                                       21000000
TTCQCB   DS    0F                       QCB                             22000000
TTCQBFLG DS    CL1                      QCB FLAG FIELD - X'02 INDICATES 23000000
*                                        ECB POST TO DISPATCHER         24000000
TTCQBELC DS    AL3                      QCB ELEMENT CHAIN POINTER       25000000
TTCQBECB DS    1F                       QCB ECB                         26000000
TTCQSTCB DS    1F                       QCB STCB CHAIN                  27000000
*                                                                       28000000
TTCSCB   DS    0F                       SCB START                       29000000
         MEND                     */                                    30000000
*%PLSTTTCD:;                                                            31000000
*/*                                                                  */ 32000000
*/*                                 ... TOTE/TCAM CONTROL BLOCKS ... */ 33000000
*/*                                                                  */ 34000000
*   DCL                                                                 35000000
*     1 IEDTTCD BASED (IEDTTCP),                                        36000000
*       2 * CHAR(*);                /* LENGTH OF LCBRCQCB FIELD      */ 37000000
*   DCL                                                                 38000000
*     1 IEDTTCPL BASED(ADDR(IEDTTCD)+LENGTH(LCBRCQCB)),                 39000000
*       2 TTCSVCPL BDY(WORD),       /* SVC 102 PARM LIST             */ 40000000
*         3 TTCSVCW1,               /* WORD 1                        */ 41000000
*           4 TTCPCODE CHAR(1),     /* POST CODE                     */ 42000000
*           4 TTCFIRST PTR(24),     /* ADDR OF FIRST ELEMENT         */ 43000000
*         3 TTCSVCW2 PTR(31),       /* WORD 2                        */ 44000000
*           4 TTCLAST PTR(31),      /* ADDR OF LAST ELEMENT          */ 45000000
*       2 * CHAR(*);                /* DISPLACEMENT OF NEXT LCB         46000000
*                                   FIELDS                           */ 47000000
*   DCL                                                                 48000000
*     1 IEDTTCFD BASED(ADDR(IEDTTCD)+(ADDR(LCBSTAT1)-ADDR(LCBRCQCB))),  49000000
*                                   /* START OF LCB FIELDS USED      */ 50000000
*       2 * CHAR(*);                                                    51000000
*   DCL                                                                 52000000
*     1 IEDTTCQB BASED(ADDR(IEDTTCD)+(ADDR(LCBSCBA)-ADDR(LCBRCQCB))+    53000000
*                      LENGTH(LCBSCBA)), /*LOCATION PAST LCB FIELDS  */ 54000000
*       2 TTCQCB BDY(WORD),         /* QCB                           */ 55000000
*         3 TTCQBFLG CHAR(1),       /* QCB FLAG FIELD - X'02'           56000000
*                                   INDICATES ECB POST TO DISPATCHER */ 57000000
*         3 TTCQBELC PTR(24),       /* QCB ELEMENT CHAIN POINTER     */ 58000000
*         3 TTCQBECB BIT(32),       /* QCB ECB                       */ 59000000
*         3 TTCQSTCB PTR(31),       /* QCB STCB POINTER              */ 60000000
*       2 TTCSCB CHAR(0) BDY(WORD); /* SCB START                     */ 61000000
*   DCL                                                                 62000000
*     TTCCHAIN BIT(8) CONSTANT('B4'X);/* POST CODE FOR CHAIN SVC 102    63000010
*                                   POST @G36XRXV                    */ 66000010
./  ADD  SSI=62710432,NAME=TXALKD
*        %GOTO PLSXALK;                                              /* 00004010
         MACRO                                                          00008010
         TXALKD                                                         00012010
.*A000000-999999                                               @Y17XAXG 00016010
*                       ... ACTIVATE LINK ...                           00020010
IEDXALKD DSECT                                                          00024010
XALKCMD  DS    0XL5                     ACTIVATE LINK COMMAND           00028010
XALKCODE DS    0XL3                     COMMAND CODE                    00032010
XALKNETS DS    XL1                      NETWORK SERVICES                00036010
XALKCONF DS    XL1                      CONFIGURATION SERVICES          00040010
XALKREQ  DS    XL1                      ACTIVATE LINK REQUEST           00044010
XALKADDR DS    XL2                      NETWORK ADDRESS OF LINK         00048010
         MEND                                                        */ 00052010
*%PLSXALK : ;                                                           00056010
*DECLARE                                                                00060010
*  1 IEDXALKD BASED(XALKPTR),                                           00064010
*    2 XALKCMD CHAR(5),                  /* ACTIVATE LINK COMMAND    */ 00068010
*     3 XALKCODE CHAR(3),                /* COMMAND CODE             */ 00072010
*      4 XALKNETS BIT(8),                /* NETWORK SERVICES         */ 00076010
*      4 XALKCONF BIT(8),                /* CONFIGURATION SERVICES   */ 00080010
*      4 XALKREQ BIT(8),                 /* ACTIVATE LINK REQUEST    */ 00084010
*     3 XALKADDR BIT(16);                /* NETWORK ADDRESS OF LINK  */ 00088010
*/*                                                                  */ 00092010
./  ADD  SSI=62710435,NAME=TXALUD
*        %GOTO PLSXALU;                                              /* 00100010
         MACRO                                                          00200010
         TXALUD                                                         00300010
.*A000000-999999                                               @Y17XAXG 00400010
*                       ... ACTIVATE LU ...                             00500010
IEDXALUD DSECT                                                          00600010
XALUCMD  DS    0XL3                     ACTLU COMMAND                   00700010
XALUCODE DS    XL1                      COMMAND                         00800010
XALUTYPE DS    XL1                      TYPE ACTIVATION                 00900010
XALUPROF DS    XL1                      FM AND TS PROFILES              01000010
         MEND                                                        */ 01100010
*%PLSXALU : ;                                                           01200010
*DECLARE                                                                01300010
*  1 IEDXALUD BASED(XALUPTR),                                           01400010
*    2 XALUCMD,                          /* ACTLU COMMAND            */ 01500010
*     3 XALUCODE CHAR(1),                /* COMMAND CODE             */ 01600010
*     3 XALUTYPE CHAR(1),                /* TYPE ACTIVATION          */ 01700010
*     3 XALUPROF CHAR(1),                /* FM AND TS PROFILES       */ 01800010
*      4 XALUFM BIT(4),                  /* FM PROFILE               */ 01900010
*      4 XALUTS BIT(4);                  /* TS PROFILE               */ 02000010
*/*                                                                  */ 02100010
./  ADD  SSI=62470498,NAME=TXAPUD
*        %GOTO PLSXAPU;                                      /*         03000010
         MACRO                                                          06000010
         TXAPUD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*                   ACTPU COMMAND DSECT                                 15000010
IEDXAPUD DSECT                                                          18000010
XAPUCMD  DS    0XL9                     ACTPU COMMAND                   21000010
XAPUCODE DS    XL1                      COMMAND CODE                    24000010
XAPUTYPE DS    XL1                      TYPE ACTIVATION                 27000010
XAPUPROF DS    XL1                      FM AND TS PROFILES              30000010
XAPUSSCP DS    0XL6                     SSCP ID                         33000010
         DS    XL1                      LAST FOUR BITS ARE PU TYPE      36000010
XAPUBID  DS    XL5                      BINARY ID                       39000010
         MEND                                                        */ 42000010
*%PLSXAPU : ;                                                           45000010
*DECLARE                                                                48000010
*  1 IEDXAPUD BASED(XAPUPTR),                                           51000010
*   2 XAPUCMD CHAR(9),                   /* ACTPU COMMAND            */ 54000010
*    3 XAPUCODE CHAR(1),                 /* COMMAND CODE             */ 57000010
*    3 XAPUTYPE CHAR(1),                 /* TYPE ACTIVATION          */ 60000010
*    3 XAPUPROF CHAR(1),                 /* FM AND TS PROFILES       */ 63000010
*     4 XAPUFM BIT(4),                   /* FM PROFILE               */ 66000010
*     4 XAPUTS BIT(4),                   /* TS PROFILE               */ 69000010
*    3 XAPUSSCP BIT(48),                 /* SSCP ID                  */ 72000010
*     4 *        BIT(4),                 /* RESERVED                 */ 75000010
*     4 XAPUPTYP BIT(4),                 /* PU TYPE CONTAINING SSCP  */ 78000010
*     4 XAPUBID  BIT(40);                /* BINARY ID                */ 81000010
*/*                                                                  */ 84000010
./  ADD  SSI=62470507,NAME=TXBFLD
*        %GOTO PLSBFLD;                 /*                              03000010
         MACRO                                                          06000010
         TXBFLD                                                         09000010
*        NO ASSEMBLER VERSION FOR THIS DSECT                            12000010
         MEND  */                                                       15000010
*%PLSBFLD:;                                                             18000010
*/*                                                                  */ 21000010
*/*      BIND FAILURE REQUEST DSECT                                  */ 24000010
*/*                                                                  */ 27000010
*DCL 1 IEDXBFLD BASED(XBFLPTR),          /* BIND FAILED              */ 30000010
*     2 XBFLCMD ,                                                       33000010
*      3 XBFLCODE CHAR(3),               /* COMMAND CODE             */ 36000010
*        4 XBFLNETS CHAR(1),             /* NETWORK SERVICES         */ 39000010
*        4 XBFLSESS CHAR(1),             /* SESSION SERVICES         */ 42000010
*        4 XBFLREQ CHAR(1),              /* BIND FAILED REQUEST      */ 45000010
*      3 XBFLSNS CHAR(4),                /* SENSE                    */ 48000010
*      3 XBFLRSN CHAR(1),                /* REASON                   */ 51000010
*      3 XBFLKEY CHAR(1),                /* KEY                      */ 54000010
*      3 XBFLPNA CHAR(2),                /* PRIMARY LU ID            */ 57000010
*      3 XBFLSNA CHAR(2);                /* SECONDARY LU ID          */ 60000010
./  ADD  SSI=62470510,NAME=TXCIND
*        %GOTO PLSXCIN;                 /*                              00010010
         MACRO                                                          00020010
         TXCIND                                                         00030010
.*A000000-999999                                               @Y17XAXF 00040010
*                                                                       00050010
*        CINIT COMMAND DSECT                                            00060010
*                                                                       00070010
IEDXCIND DSECT                                                          00080010
XCINFIXD EQU   *                         FIXED LENGTH DATA              00090010
XCINCODE DS    0CL3                      COMMAND CODE                   00100010
XCINNETS DS    CL1                       NETWORK SERVICES               00110010
XCINSESS DS    CL1                       SESSION SERVICES               00120010
XCINREQ  DS    CL1                       CINIT REQUEST                  00130010
XCINFMT  DS    CL1                       FORMAT                         00140010
XCINORG  DS    CL1                       INITIATE ORIGIN                00150010
XCINADDR DS    CL1                       NETWORK ADDRESS OF SLU         00160010
XCINBLEN DS    CL2                       LENGTH OF BIND IMAGE           00170010
XCINVAR  EQU   *                         VARIABLE LENGTH DATA           00180010
XCINBIMG EQU   *                         BIND IMAGE                     00190010
XCINNTNM EQU   *                         SECONDARY LU NAME FIELD        00200010
XCINNTYP DS    CL1                       RESOURCE TYPE                  00210010
XCINNLEN DS    XL1                       LENGTH OF NAME                 00220010
XCINNAME EQU   *                         SLU NAME                       00230010
XCINRQID EQU   *                         REQUESTOR ID FIELD             00240010
XCINRLEN DS    XL1                       LENGTH OF ID                   00250010
XCINRID  EQU   *                         REQUESTOR ID                   00260010
XCINPWRD EQU   *                         PASSWORD FIELD                 00270010
XCINPLEN DS    XL1                       LENGTH OF PASSWORD             00280010
XCINPSWD EQU   *                         PASSWORD                       00290010
XCINUFLD EQU   *                         USER FIELD                     00300010
XCINULEN DS    XL1                       LENGTH OF USER DATA            00310010
XCINUSFD EQU   *                         USER DATA                      00320010
         MEND  */                                                       00330010
*%PLSXCIN:;                                                             00340010
*/*                                                                  */ 00350010
*/*      CINIT COMMAND DSECT                                         */ 00360010
*/*                                                                  */ 00370010
*DCL 1 IEDXCIND BASED(XCINPTR),                                         00380010
*     2 XCINFIXD,                        /* FIXED LENGTH DATA        */ 00390010
*      3 XCINCODE CHAR(3),               /* COMMAND CODE             */ 00400010
*       4 XCINNETS CHAR(1),              /* NETWORK SERVICES         */ 00410010
*       4 XCINSESS CHAR(1),              /* SESSION SERVICES         */ 00420010
*       4 XCINREQ  CHAR(1),              /* CINIT REQUEST            */ 00430010
*      3 XCINFMT CHAR(1),                /* FORMAT                   */ 00440010
*      3 XCINORG CHAR(1),                /* INITIATE ORIGIN          */ 00450010
*      3 XCINADDR CHAR(2),               /* NETWORK ADDRESS OF SLU   */ 00460010
*      3 XCINBLEN CHAR(2),               /* LENGTH OF BIND IMAGE     */ 00470010
*     2 XCINVAR,                         /* VARIABLE LENGTH DATA     */ 00480010
*      3 XCINBIMG CHAR(0),               /* BIND IMAGE               */ 00490010
*      3 XCINNTNM,                       /* SECONDARY LU NAME FIELD  */ 00500010
*       4 XCINNTYP CHAR(1),              /* RESOURCE TYPE            */ 00510010
*       4 XCINNLEN FIXED(8),             /* LENGTH OF NAME           */ 00520010
*       4 XCINNAME CHAR(0),              /* SLU NAME                 */ 00530010
*      3 XCINRQID,                       /* REQUESTOR ID FIELD       */ 00540010
*       4 XCINRLEN FIXED(8),             /* LENGTH OF ID             */ 00550010
*       4 XCINRID CHAR(0),               /* REQUESTOR ID             */ 00560010
*      3 XCINPWRD,                       /* PASSWORD FIELD           */ 00570010
*       4 XCINPLEN FIXED(8),             /* LENGTH OF PASSWORD       */ 00580010
*       4 XCINPSWD CHAR(0),              /* PASSWORD                 */ 00590010
*      3 XCINUFLD,                       /* USER FIELD               */ 00600010
*       4 XCINULEN FIXED(8),             /* LENGTH OF USER DATA      */ 00610010
*       4 XCINUSFD CHAR(0);              /* USER DATA                */ 00620010
./  ADD  SSI=62230592,NAME=TXCOND
*        %GOTO PLSXCON;                                              /* 00100010
         MACRO                                                          00200010
         TXCOND                                                         00300010
.*A000000-999999                                               @Y17XAXG 00400010
*                       ... CONTACT ...                                 00500010
IEDXCOND DSECT                                                          00600010
XCONCMD  DS    0XL5                     CONTACT COMMAND                 00700010
XCONCODE DS    0XL3                     COMMAND CODE                    00800010
XCONNETS DS    XL1                      NETWORK SERVICES                00900010
XCONCONF DS    XL1                      CONFIGURATION SERVICES          01000010
XCONREQ  DS    XL1                      CONTACT REQUEST                 01100010
XCONADDR DS    XL2                      NETWORK ADDRESS OF PU           01200010
         MEND                                                        */ 01300010
*%PLSXCON : ;                                                           01400010
*DECLARE                                                                01500010
*  1 IEDXCOND BASED(XCONPTR),                                           01600010
*    2 XCONCMD CHAR(5),                  /* CONTACT COMMAND          */ 01700010
*     3 XCONCODE CHAR(3),                /* COMMAND CODE             */ 01800010
*      4 XCONNETS CHAR(1),               /* NETWORK SERVICES         */ 01900010
*      4 XCONCONF CHAR(1),               /* CONFIGURATION SERVICES   */ 02000010
*      4 XCONREQ CHAR(1),                /* CONTACT REQUEST          */ 02100010
*     3 XCONADDR CHAR(2);                /* NETWORK ADDRESS OF PU    */ 02200010
*/*                                                                  */ 02300010
./  ADD  SSI=62230593,NAME=TXCTDD
*        %GOTO PLSXCTD;                                              /* 00100010
         MACRO                                                          00200010
         TXCTDD                                                         00300010
.*A000000-999999                                               @Y17XAXG 00400010
*                       ... CONTACTED ...                               00500010
IEDXCTDD DSECT                                                          00600010
XCTDCMD  DS    0XL6                     CONTACTED COMMAND               00700010
XCTDCODE DS    0XL3                     COMMAND CODE                    00800010
XCTDNETS DS    XL1                      NETWORK SERVICES                00900010
XCTDCONF DS    XL1                      CONFIGURATION SERVICES          01000010
XCTDREQ  DS    XL1                      ACTIVATE LINK REQUEST           01100010
XCTDADDR DS    XL2                      NETWORK ADDRESS OF PU           01200010
XCTDSTAT DS    XL1                      STATUS                          01300010
         MEND                                                        */ 01400010
*%PLSXCTD : ;                                                           01500010
*DECLARE                                                                01600010
*  1 IEDXCTDD BASED(XCTDPTR),                                           01700010
*    2 XCTDCMD CHAR(6),                  /* CONTACTED COMMAND        */ 01800010
      3 XCTDCODE CHAR(3),                /* COMMAND CODE             */ 01900010
       4 XCTDNETS CHAR(1),               /* NETWORK SERVICES         */ 02000010
       4 XCTDCONF CHAR(1),               /* CONFIGURATION SERVICES   */ 02100010
       4 XCTDREQ CHAR(1),                /* ACTIVATE LINK REQUEST    */ 02200010
      3 XCTDADDR CHAR(2),                /* NETWORK ADDRESS OF PU    */ 02300010
      3 XCTDSTAT FIXED(8);               /* STATUS                   */ 02400010
*/*                                                                  */ 02500010
./  ADD  SSI=71171005,NAME=TXCTMD
*        %GOTO PLSCTM;                  /*                              03000000
         MACRO                                                          06000000
         TXCTMD                                                         09000000
*        ASSEMLBER VERION OF THIS DSECT NOT SUPPORTED                   12000000
         MEND  */                                                       15000000
*%PLSCTM:;                                                              18000000
*/*                                                                  */ 21000000
*/*      CTERM FORMAT                                                */ 24000000
*/*                                                                  */ 27000000
* DECLARE                                                               30000000
* 1 IEDXCTMD BASED(XCTMPTR),            /* CTERM COMMAND             */ 33000000
*  2 XCTMCMD,                                                           36000000
*   3 XCTMCODE CHAR(3),                 /* COMMAND CODE              */ 39000000
*    4 XCTMNETS CHAR(1),                /*  NETWORK SERVICES         */ 42000000
*    4 XCTMSESS CHAR(1),                /*  SESSION SERVICES         */ 45000000
*    4 XCTMREQ  CHAR(1),                /*  CTERM REQ                */ 48000000
*   3 XCTMFMT  CHAR(1),                 /* FORMAT                    */ 51000000
*   3 XCTMTYPE CHAR(1),                 /* TYPE                      */ 54000000
*    4 XCTMTERM BIT(4),                 /* TYPE OF TERMINATE @YM08991*/ 55000010
*    4 *        BIT(4),                 /* UNUSED            @YM08991*/ 56000010
*   3 XCTMSNA  CHAR(2),                 /* SECONDARY LU ADDR         */ 57000000
*   3 XCTMRSN  CHAR(1),                 /* REASON                    */ 60000000
*   3 XCTMRQID,                         /* REQUESTOR ID              */ 63000000
*    4 XCTMRLEN FIXED(8),               /*  LEN OF REQUESTOR ID DATA */ 66000000
*    4 XCTMRID  CHAR(0),                /*  REQUESTOR ID DATA        */ 69000000
*   3 XCTMPWRD,                         /* PASSWORD                  */ 72000000
*    4 XCTMPLEN FIXED(8),               /*  LEN OF PASSWORD DATA     */ 75000000
*    4 XCTMPSWD CHAR(0);                /*  PASSWORD DATA            */ 78000000
* DCL XCTMTRMF BIT(4) CONSTANT('0010'B);/* FORCED TERMINATE  @YM08991*/ 81000010
* DCL XCTMTRMO BIT(4) CONSTANT('0001'B);/* ORDERLY TERMINATE @YM08991*/ 84000010
./  ADD  SSI=62710411,NAME=TXDLKD
*        %GOTO PLSXDLK;                                              /* 00100010
         MACRO                                                          00200010
         TXDLKD                                                         00300010
.*A000000-999999                                               @Y17XAXG 00400010
*                       ... DEACTIVATE LINK ...                         00500010
IEDXDLKD DSECT                                                          00600010
XDLKCMD  DS    0XL5                     DEACTIVATE LINK COMMAND         00700010
XDLKCODE DS    0XL3                     COMMAND CODE                    00800010
XDLKNETS DS    XL1                      NETWORK SERVICES                00900010
XDLKCONF DS    XL1                      CONFIGURATION SERVICES          01000010
XDLKREQ  DS    XL1                      DEACTIVATE LINK REQUEST         01100010
XDLKADDR DS    XL2                      NETWORK ADDRESS OF LINK         01200010
         MEND                                                        */ 01300010
*%PLSXDLK : ;                                                           01400010
*DECLARE                                                                01500010
*  1 IEDXDLKD BASED(XDLKPTR),                                           01600010
*    2 XDLKCMD CHAR(5),                  /* DEACTIVATE LINK COMMAND  */ 01700010
*     3 XDLKCODE CHAR(3),                /* COMMAND CODE             */ 01800010
*      4 XDLKNETS CHAR(1),               /* NETWORK SERVICES         */ 01900010
*      4 XDLKCONF CHAR(1),               /* CONFIGURATION SERVICES   */ 02000010
*      4 XDLKREQ CHAR(1),                /* DEACTIVATE LINK REQUEST  */ 02100010
*     3 XDLKADDR CHAR(2);                /* NETWORK ADDRESS OF LINK  */ 02200010
*/*                                                                  */ 02300010
./  ADD  SSI=62470562,NAME=TXDPUD
*        %GOTO PLSXDPU;                                              /* 03000010
         MACRO                                                          06000010
         TXDPUD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*               ... DEACTIVATE PU ...                                   15000010
IEDXDPUD DSECT                                                          18000010
XDPUCMD  DS    0XL2                     DACTPU COMMAND                  21000010
XDPUCODE DS    XL1                      COMMAND CODE                    24000010
XDPUTYPE DS    XL1                      TYPE DEACTIVATION               27000010
         MEND                                                        */ 30000010
*%PLSXDPU : ;                                                           33000010
*DECLARE                                                                36000010
*  1 IEDXDPUD  BASED(XDPUPTR),                                          39000010
*    2 XDPUCMD CHAR(2),                  /* DACTPU COMMAND           */ 42000010
*     3 XDPUCODE BIT(8),                 /* COMMAND CODE             */ 45000010
*     3 XDPUTYPE BIT(8);                 /* TYPE DEACTIVATION        */ 48000010
*/*                                                                  */ 51000010
./  ADD  SSI=62470563,NAME=TXDSCD
*        %GOTO PLSXDSC;                                              /* 03000010
         MACRO                                                          06000010
         TXDSCD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*                       ... DISCONTACT ...                              15000010
IEDXDSCD DSECT                                                          18000010
XDSCCMD  DS    0XL5                     DISCONTACT COMMAND              21000010
XDSCCODE DS    0XL3                     COMMAND CODE                    24000010
XDSCNETS DS    XL1                      NETWORK SERVICES                27000010
XDSCCONF DS    XL1                      CONFIGURATION SERVICES          30000010
XDSCREQ  DS    XL1                      DISCONTACT REQUEST              33000010
XDSCADDR DS    XL2                      NETWORK ADDRESS OF PU           36000010
         MEND                                                        */ 39000010
*%PLSXDSC : ;                                                           42000010
*DECLARE                                                                45000010
*  1 IEDXDSCD BASED(XDSCPTR),                                           48000010
*    2 XDSCCMD CHAR(5),                  /* DISCONTACT COMMAND       */ 51000010
*     3 XDSCCODE CHAR(3),                /* COMMAND CODE             */ 54000010
*      4 XDSCNETS CHAR(1),               /* NETWORK SERVICES         */ 57000010
*      4 XDSCCONF CHAR(1),               /* CONFIGURATION SERVICES   */ 60000010
*      4 XDSCREQ CHAR(1),                /* DISCONTACT REQUEST       */ 63000010
*     3 XDSCADDR CHAR(2);                /* NETWORK ADDRESS OF PU    */ 66000010
*/*                                                                  */ 69000010
./  ADD  SSI=63170604,NAME=TXEXTD
*   %GOTO PLSXEXT;                /* BILINGUAL HEADER                   02000010
         MACRO                                                          04000010
         TXEXTD                                                         06000010
.*A000000-999999                                               @Y17XAXV 07000010
*                      ... EXECUTE TEST ...                             08000010
IEDXEXTD DSECT                                                          10000010
XEXTCODE DS    0XL3                     COMMAND CODE (FID1)             12000010
XEXTNETS DS    XL1                      NETWORK SERVICES                14000010
XEXTMAIN DS    XL1                      MAINTENANCE SERVICES            16000010
XEXTREQ  DS    XL1                      EXECUTE TEST  REQUEST           18000010
XEXTADDR DS    XL2                      NETWORK ADDRESS                 20000010
XEXTPBDU DS    0XL4                     PARTIAL BASIC DATA UNIT         22000010
XEXTCMD0 DS    XL1                      FID0 COMMAND                    24000010
XEXTMODF DS    XL1                      MODIFIER                        26000010
XEXTSYSR DS    XL1                      SYSTEM RESPONSE                 28000010
XEXTEXTR DS    XL1                      EXTENDED RESPONSE               30000010
XEXTEND  EQU   *                        END OF EXECUTE TEST COMMAND     32000010
XEXTTEXT EQU   *                        INTERPRETIVE COMMANDS TEXT      34000010
         MEND           */                                              36000010
*%PLSXEXT:;                                                             38000010
*/*                                                                  */ 40000010
*/*                          ... EXECUTE TEST ...                    */ 42000010
*/*                                                                  */ 44000010
*   DCL                                                                 46000010
*     1 IEDXEXTD BASED(IEDXEXTP),                                       48000010
*       2 XEXTCODE CHAR(3),       /*COMMAND CODE (FID1)*/               50000010
*         3 XEXTNETS CHAR(1),     /*NETWORK SERVICES*/                  52000010
*         3 XEXTMAIN CHAR(1),     /*MAINTENANCE SERVICES*/              54000010
*         3 XEXTREQ  CHAR(1),     /*EXECUTE TEST REQUEST*/              56000010
*       2 XEXTADDR BIT(16),       /*NETWORK ADDRESS*/                   58000010
*       2 XEXTPBDU CHAR(4),       /*PARTIAL BASIC DATA UNIT*/           60000010
*         3 XEXTCMD0 CHAR(1),     /*FID0 COMMAND*/                      62000010
*         3 XEXTMODF CHAR(1),     /*MODIFIER*/                          64000010
*         3 XEXTSYSR CHAR(1),     /*SYSTEM RESPONSE*/                   66000010
*         3 XEXTEXTR CHAR(1),     /*EXTENDED RESPONSE*/                 68000010
*       2 XEXTEND CHAR(0);        /*END OF EXECUTE TEST COMMAND*/       70000010
*   DCL                                                                 72000010
*     XEXTTEXT CHAR(*) DEF(XEXTEND);/*INTERPRETIVE COMMANDS TEXT*/      74000010
./  ADD  SSI=62130021,NAME=TXNPLD
*        %GOTO PLSXNPL;                                              /* 00100010
         MACRO                                                          00200010
         TXNPLD                                                         00300010
.*A000000-999999                                               @Y17XAXG 00400010
*              ... CHANGE NEGATIVE POLL LIMIT ...                       00500010
IEDXNPLD DSECT                                                          00600010
XNPLCMD  DS    0XL6                     CHANGE NEGATIVE POLL LIMIT      00700010
XNPLCODE DS    0XL3                     COMMAND CODE                    00800010
XNPLNETS DS    XL1                      NETWORK SERVICES                00900010
XNPLPRE  DS    XL1                      PRE SNA CODE                    01000010
XNPLREQ  DS    XL1                      NEG POLL LIM REQUEST            01100010
XNPLADDR DS    XL2                      NETWORK ADDRESS OF PU           01200010
XNPLVAL  DS    XL1                      NEW VALUE FOR NEG POLL LIMIT    01300010
         MEND                                                        */ 01400010
*%PLSXNPL : ;                                                           01500010
*DECLARE                                                                01600010
*  1 IEDXNPLD BASED(XNPLPTR),                                           01700010
*    2 XNPLCMD,                          /* CHANGE NEGATIVE POLL        01800010
*                                           LIMIT COMMAND            */ 01900010
*     3 XNPLCODE CHAR(3),                /* COMMAND CODE             */ 02000010
*      4 XNPLNETS CHAR(1),               /* NETWORK SERVICES         */ 02100010
*      4 XNPLPRE  CHAR(1),               /* PRE SNA CODE             */ 02200010
*      4 XNPLREQ CHAR(1),                /* NEG POLL LIM REQUEST     */ 02300010
*     3  XNPLADDR CHAR(2),               /* NETWORK ADDRESS OF PU    */ 02400010
*     3  XNPLVAL  CHAR(1);               /* NEW VAL FOR NEG POLL LIM */ 02500010
*/*                                                                  */ 02600010
./  ADD  SSI=62470564,NAME=TXNSPD
*        %GOTO PLSXNSP;                 /*                              00001010
         MACRO                                                          00002010
         TXNSPD                                                         00003010
*        NO ASSEMBLE VERSION FOR THIS DSECT                             00004010
         MEND  */                                                       00005010
*%PLSXNSP:;                                                             00006010
*%IF COMPRE='YES'                                                       00007010
*   %THEN %GOTO PLSXNSP1;                                               00008010
*/*                                                                  */ 00009010
*/*      N. S. PROC ERROR DSECT                                      */ 00010010
*/*                                                                  */ 00011010
*DCL 1 IEDXNSPD BASED(XNSPPTR),          /* N. S. PROC ERROR         */ 00012010
*     2 XNSPCMD,                                                        00013010
*       3 XNSPCODE CHAR(3),              /* COMMAND CODE             */ 00014010
*         4 XNSPNETS CHAR(1),            /* NETWORK SERVICES         */ 00015010
*         4 XNSPSESS CHAR(1),            /* SESSION SERVICES         */ 00016010
*         4 XNSPREQ  CHAR(1),            /* N.S. PROC REQUEST        */ 00017010
*       3 XNSPRSN  CHAR(1),              /* REASON                   */ 00018010
*       3 XNSPPLUN CHAR(10),             /* PRIMARY LU NAME FIELD    */ 00019010
*          4 XNSPPTYP CHAR(1),           /* TYPE                     */ 00020010
*          4 XNSPPLEN FIXED(8),          /* LENGTH OF NAME           */ 00021010
*          4 XNSPPNME CHAR(8),           /* PRIMARY LU NAME          */ 00022010
*       3 XNSPSLUN CHAR(10),             /* SECONDARY LU NAME FIELD  */ 00023010
*          4 XNSPSTYP CHAR(1),           /* TYPE                     */ 00024010
*          4 XNSPSLEN FIXED(8),          /* LENGTH                   */ 00025010
*          4 XNSPSNME CHAR(8);           /* SECONDARY LU NAME        */ 00026010
*%GOTO PLSXNSP2;                                                        00027010
*%PLSXNSP1:;                                                            00028010
*/*                                                                  */ 00029010
*/*      N. S. PROC ERROR DSECT (COMPREHENSIVE VERSION)              */ 00030010
*/*                                                                  */ 00031010
*DCL 1 IEDXNSPD BASED(XNSPPTR),          /* N. S. PROC ERROR         */ 00032010
*     2 XNSPCMD,                                                        00033010
*       3 XNSPCODE CHAR(3),              /* COMMAND CODE             */ 00034010
*         4 XNSPNETS CHAR(1),            /* NETWORK SERVICES         */ 00035010
*         4 XNSPSESS CHAR(1),            /* SESSION SERVICES         */ 00036010
*         4 XNSPREQ  CHAR(1),            /* N.S. PROC REQUEST        */ 00037010
*       3 XNSPRSN  FIXED(8),             /* REASON                   */ 00038010
*       3 XNSPPLUN,                      /* PRIMARY LU NAME FIELD    */ 00039010
*          4 XNSPPTYP CHAR(1),           /* TYPE                     */ 00040010
*       3 XNSPSLUN,                      /* SECONDARY LU NAME FIELD  */ 00041010
*          4 XNSPSTYP CHAR(1),           /* TYPE                     */ 00042010
*       3 XNSPSENS CHAR(4),              /* SENSE                    */ 00043010
*       3 XNSPSKEY CHAR(1),              /* SESSION KEY              */ 00044010
*       3 XNSPSNME CHAR(0);              /* SESSION KEY CONTENT      */ 00045010
* DCL XNSPCVT BIT(8) CONSTANT('21'X);    /* REASON CODE FOR CONVERT     00046010
*                                           ERROR                    */ 00047010
* DCL XNSPLEN FIXED(16) CONSTANT(11);    /* LENGTH OF COMPREHENSIVE     00048010
*                                           FORMAT                   */ 00049010
*%PLSXNSP2:;                                                            00050010
./  ADD  SSI=63170605,NAME=TXRTDD
*   %GOTO PLSXRTD;                /* BILINGUAL HEADER                   02000010
         MACRO                                                          04000010
         TXRTDD                                                         06000010
.*A000000-999999                                               @Y17XAXV 07000010
*                      ... RECORD TEST DATA ...                         08000010
IEDXRTDD DSECT                                                          10000010
XRTDCODE DS    0XL3                     COMMAND CODE (FID1)             12000010
XRTDNETS DS    XL1                      NETWORK SERVICES                14000010
XRTDMAIN DS    XL1                      MAINTENANCE SERVICES            16000010
XRTDREQ  DS    XL1                      RECORD TEST DATA REQUEST        18000010
XRTDADDR DS    XL2                      NETWORK ADDRESS                 20000010
XRTDPBDU DS    0XL4                     PARTIAL BASIC DATA UNIT         22000010
XRTDCMD0 DS    XL1                      FID0 COMMAND                    24000010
XRTDMODF DS    XL1                      MODIFIER                        26000010
XRTDSYSR DS    XL1                      SYSTEM RESPONSE                 28000010
XRTDEXTR DS    XL1                      EXTENDED RESPONSE               30000010
XRTDEND  EQU   *                        END OF RECORD TEST DATA COMMAND 32000010
XRTDTEXT EQU   *                        INTERPRETIVE COMMANDS TEXT      34000010
         MEND           */                                              36000010
*%PLSXRTD:;                                                             38000010
*/*                                                                  */ 40000010
*/*                          ... RECORD TEST DATA ...                */ 42000010
*/*                                                                  */ 44000010
*   DCL                                                                 46000010
*     1 IEDXRTDD BASED(IEDXRTDP),                                       48000010
*       2 XRTDCODE CHAR(3),       /*COMMAND CODE (FID1)*/               50000010
*         3 XRTDNETS CHAR(1),     /*NETWORK SERVICES*/                  52000010
*         3 XRTDMAIN CHAR(1),     /*MAINTENANCE SERVICES*/              54000010
*         3 XRTDREQ  CHAR(1),     /*RECORD TEST DATA REQUEST*/          56000010
*       2 XRTDADDR BIT(16),       /*NETWORK ADDRESS*/                   58000010
*       2 XRTDPBDU CHAR(4),       /*PARTIAL BASIC DATA UNIT*/           60000010
*         3 XRTDCMD0 CHAR(1),     /*FID0 COMMAND*/                      62000010
*         3 XRTDMODF CHAR(1),     /*MODIFIER*/                          64000010
*         3 XRTDSYSR CHAR(1),     /*SYSTEM RESPONSE*/                   66000010
*         3 XRTDEXTR CHAR(1),     /*EXTENDED RESPONSE*/                 68000010
*       2 XRTDEND CHAR(0);        /*END OF RECORD TEST DATA COMMAND*/   70000010
*   DCL                                                                 72000010
*     XRTDTEXT CHAR(*) DEF(XRTDEND);/*INTERPRETIVE COMMANDS TEXT*/      74000010
./  ADD  SSI=62470565,NAME=TXSCVD
*        %GOTO PLSXSCV;                                              /* 02000010
         MACRO                                                          04000010
         TXSCVD                                                         06000010
.*A000000-999999                                               @Y17XAXG 08000010
*                    ... SET CONTROL VECTOR...                          10000010
IEDXSCVD DSECT                                                          12000010
XSCVCMD  DS    0XL6                     SET CONTROL VECTOR CMD          14000010
XSCVCODE DS    0XL3                     COMMAND CODE                    16000010
XSCVNETS DS    XL1                      NETWORK SERVICES                18000010
XSCVCONF DS    XL1                      CONFIGURATION SERVICES          20000010
XSCVREQ  DS    XL1                      SET CONTROL VECTOR REQ          22000010
XSCVADDR DS    XL2                      NETWORK ADDRESS OF LINK         24000010
XSCVKEY  DS    XL1                      CONTROL VECTOR KEY              26000010
XSCVDATA EQU   *                        CONTROL VECTOR DATA             28000010
         MEND                                                        */ 30000010
*%PLSXSCV : ;                                                           32000010
*DECLARE                                                                34000010
*  1 IEDXSCVD BASED(XSCVPTR),                                           36000010
*    2 XSCVCMD  CHAR(6),                 /* SET CONTROL VECTOR CMD   */ 38000010
*     3 XSCVCODE CHAR(3),                /* COMMAND CODE             */ 40000010
*      4 XSCVNETS CHAR(1),               /* NETWORK SERVICES         */ 42000010
*      4 XSCVCONF CHAR(1),               /* CONFIGURATION SERVICES   */ 44000010
*      4 XSCVREQ CHAR(1),                /* SET CONTROL VECTOR REQ   */ 46000010
*     3 XSCVADDR CHAR(2),                /* NETWORK ADDRESS OF LINK  */ 48000010
*     3 XSCVKEY  CHAR(1),                /* CONTROL VECTOR KEY       */ 50000010
*    2 XSCVDATA CHAR(*);                 /* CONTROL VECTOR DATA      */ 52000010
*/*                                                                  */ 54000010
*DCL 1 XSCVTMDT DEF(XSCVDATA),           /* DATA FOR SET TIME & DATE */ 56000010
*     2 XSCVMON CHAR(2),                 /* MONTH                    */ 58000010
*     2 XSCVDLM1 CHAR(1),                /* DELIMITER                */ 60000010
*     2 XSCVCDAY CHAR(2),                /* CALENDAR DATE            */ 62000010
*     2 XSCVDLM2 CHAR(1),                /* DELIMITER                */ 64000010
*     2 XSCVYEAR CHAR(2),                /* YEAR                     */ 66000010
*     2 XSCVDLM3 CHAR(1),                /* DELIMITER                */ 68000010
*     2 XSCVJDAY CHAR(3),                /* JULIAN DATE              */ 70000010
*     2 XSCVHOUR CHAR(2),                /* HOUR                     */ 72000010
*     2 XSCVDLM4 CHAR(1),                /* DELIMITER                */ 74000010
*     2 XSCVMIN CHAR(2),                 /* MINUTES                  */ 76000010
*     2 XSCVDLM5 CHAR(1),                /* DELIMITER                */ 78000010
*     2 XSCVSEC CHAR(2);                 /* SECONDS                  */ 80000010
*/*                                                                  */ 82000010
*DCL XSCVTDLN FIXED(8) CONSTANT(26);     /* LENGTH FOR SET TIME AND     84000010
*                                           DATE SET CONTROL VECTOR  */ 86000010
*/*                                                                  */ 88000010
./  ADD  SSI=62470566,NAME=TXSEPD
*        %GOTO PLSXSEP;                                              /* 03000010
         MACRO                                                          06000010
         TXSEPD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*                       ... SWITCH TO EP ...                            15000010
IEDXSEP  DSECT                                                          18000010
XSEPCMD  DS    0XL3                     SWITCH TO EP COMMAND            21000010
XSEPCODE DS    XL1                      COMMAND CODE                    24000010
XSEPADDR DS    XL2                      NETWORK ADDRESS OF LINE         27000010
         MEND  */                                                       30000010
*%PLSXSEP : ;                                                           33000010
*DECLARE                                                                36000010
*  1 IEDXSEPD BASED(XSEPPTR),                                           39000010
*    2 XSEPCMD,                          /* SWITCH TO EP COMMAND     */ 42000010
*     3 XSEPCODE CHAR(1),                /* COMMAND CODE             */ 45000010
*     3 XSEPADDR CHAR(2);                /* NETWORK ADDRESS OF LINE  */ 48000010
*/*                                                                  */ 51000010
./  ADD  SSI=62470567,NAME=TXSNDD
*        %GOTO PLSXSND;                 /*                              03000010
         MACRO                                                          06000010
         TXSNDD                                                         09000010
*        NO ASSEMBLER VERSION FOR THE DSECT                             12000010
         MEND  */                                                       15000010
*%PLSXSND:;                                                             18000010
*/*                                                                  */ 21000010
*/*      SESSION ENDED REQUEST DSECT                                 */ 24000010
*/*                                                                  */ 27000010
*DCL 1 IEDXSNDD BASED(XSNDPTR),          /* SESSION ENDED            */ 30000010
*      2 XSNDCMD,                                                       33000010
*       3 XSNDCODE CHAR(3),              /* COMMAND CODE             */ 36000010
*         4 XSNDNETS CHAR(1),            /* NETWORK SERVICES         */ 39000010
*         4 XSNDSESS CHAR(1),            /* SESSION SERVICES         */ 42000010
*         4 XSNDREQ  CHAR(1),            /* SESSION ENDED REQUEST    */ 45000010
*       3 XSNDKEY  CHAR(1),              /* KEY                      */ 48000010
*       3 XSNDPNA  CHAR(2),              /* PRIMARY LU ID            */ 51000010
*       3 XSNDSNA  CHAR(2);              /* SECONDARY LU ID          */ 54000010
./  ADD  SSI=62530891,NAME=TXSNLD
*        %GOTO PLSXSNL;                                              /* 03000010
         MACRO                                                          06000010
         TXSNLD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*              ... CHANGE SESSION LIMIT ...                             15000010
IEDXSNLD DSECT                                                          18000010
XSNLCMD  DS    0XL6                     CHANGE SESSION LIMIT            21000010
XSNLCODE DS    0XL3                     COMMAND CODE                    24000010
XSNLNETS DS    XL1                      NETWORK SERVICES                27000010
XSNLPRE  DS    XL1                      RE SNA CODE                     30000010
XSNLREQ  DS    XL1                      SESSION LIMIT REQUEST           33000010
XSNLADDR DS    XL2                      NETWORK ADDRESS                 36000010
XSNLVAL  DS    XL1                      NEW VALUE FOR SESSION LIMIT     39000010
         MEND                                                        */ 42000010
*%PLSXSNL : ;                                                           45000010
*DECLARE                                                                48000010
*  1 IEDXSNLD BASED(XSNLPTR),                                           51000010
*    2 XSNLCMD,                          /* CHANGE SESSION LIMIT        54000010
*                                           COMMAND                  */ 57000010
*     3 XSNLCODE CHAR(3),                /* COMMAND CODE             */ 60000010
*      4 XSNLNETS CHAR(1),               /* NETWORK SERVICES         */ 63000010
*      4 XSNLPRE  CHAR(1),               /* PRE SNA CODE             */ 66000010
*      4 XSNLREQ CHAR(1),                /* SESSION LIMIT REQUEST    */ 69000010
*     3  XSNLADDR CHAR(2),               /* NETWORK ADDRESS          */ 72000010
*     3  XSNLVAL  CHAR(1);               /* NEW VAL FOR SESSION LIMIT*/ 75000010
*/*                                                                  */ 78000010
./  ADD  SSI=62470568,NAME=TXSNPD
*        %GOTO PLSXSNP;                                              /* 03000010
         MACRO                                                          06000010
         TXSNPD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*                       ... SWITCH TO NCP ...                           15000010
IEDXSNPD DSECT                                                          18000010
XSNPCMD  DS    0XL3                     SWITCH TO NCP COMMAND           21000010
XSNPCODE DS    XL1                      COMMAND CODE                    24000010
XSNPADDR DS    XL2                      NETWORK ADDRESS OF LINE         27000010
         MEND                                                        */ 30000010
*%PLSXSNP : ;                                                           33000010
*DECLARE                                                                36000010
*  1 IEDXSNPD BASED(XSNPPTR),                                           39000010
*    2 XSNPCMD,                          /* SWITCH TO NCP COMMAND    */ 42000010
*     3 XSNPCODE CHAR(1),                /* COMMAND CODE             */ 45000010
*     3 XSNPADDR CHAR(2);                /* NETWORK ADDRESS OF LINE  */ 48000010
*/*                                                                  */ 51000010
./  ADD  SSI=62470575,NAME=TXSSPD
*        %GOTO PLSXSSP;                                              /* 03000010
         MACRO                                                          06000010
         TXSSPD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*              ... CHANGE SERVICE SEEKING PAUSE ...                     15000010
IEDXSSPD DSECT                                                          18000010
XSSPCMD  DS    0XL5                     CHANGE SERVICE SEEKING PAUSE    21000010
*                                       COMMAND                         24000010
XSSPCODE DS    0XL3                     COMMAND                         27000010
XSSPNETS DS    XL1                      NETWORK SERVICES                30000010
XSSPPRE  DS    XL1                      PRE SNA CODE                    33000010
XSSPREQ  DS    XL1                      SERV SEEK PAUSE REQUEST         36000010
XSSPADDR DS    XL2                      NETWORK ADDRESS OF PU           39000010
XSSPVAL  DS    XL1                      VEW VALUE FOR SERV SEEK PAUSE   42000010
         MEND                                                        */ 45000010
*%PLSXSSP : ;                                                           48000010
*DECLARE                                                                51000010
*  1 IEDXSSPD BASED(XSSPPTR),                                           54000010
*    2 XSSPCMD,                          /* CHANGE SERVICE SEEKING      57000010
*                                           PAUSE COMMAND            */ 60000010
*     3 XSSPCODE CHAR(3),                /* COMMAND CODE             */ 63000010
*      4 XSSPNETS CHAR(1),               /* NETWORK SERVICES         */ 66000010
*      4 XSSPPRE  CHAR(1),               /* PRE SNA CODE             */ 69000010
*      4 XSSPREQ CHAR(1),                /* SERV SEEK PAUSE REQUEST  */ 72000010
*     3 XSSPADDR CHAR(2),                /* NETWORK ADDRESS OF PU    */ 75000010
*     3 XSSPVAL  CHAR(1);                /* NEW VAL FOR SERV SEEK PAU*/ 78000010
*/*                                                                  */ 81000010
./  ADD  SSI=62470578,NAME=TXSSTD
*        %GOTO PLSXSST;                 /*                              03000010
         MACRO                                                          06000010
         TXSSTD                                                         09000010
*        NO ASSEMBLER VERSION FOR THE DSECT                             12000010
         MEND  */                                                       15000010
*%PLSXSST:;                                                             18000010
*/*                                                                  */ 21000010
*/*      SESSION STARTED REQUEST DSECT                               */ 24000010
*/*                                                                  */ 27000010
*DCL 1 IEDXSSTD BASED(XSSTPTR),          /* SESSION STARTED          */ 30000010
*      2 XSSTCMD,                                                       33000010
*       3 XSSTCODE CHAR(3),              /* COMMAND CODE             */ 36000010
*         4 XSSTNETS CHAR(1),            /* NETWORK SERVICES         */ 39000010
*         4 XSSTSESS CHAR(1),            /* SESSION SERVICES         */ 42000010
*         4 XSSTREQ  CHAR(1),            /* SESSION STARTED REQUEST  */ 45000010
*       3 XSSTKEY  CHAR(1),              /* KEY                      */ 48000010
*       3 XSSTPNA  CHAR(2),              /* PRIMARY LU ID            */ 51000010
*       3 XSSTSNA  CHAR(2);              /* SECONDARY LU ID          */ 54000010
./  ADD  SSI=62720341,NAME=TXUNBD
*        %GOTO PLSXUNB;                                              /* 03000010
         MACRO                                                          06000010
         TXUNBD                                                         09000010
.*A000000-999999                                               @Y17XAXG 12000010
*                       ... UNBIND ...                                  15000010
IEDXUNBD DSECT                                                          18000010
XUNBCMD  DS    0XL2                     UNBIND COMMAND                  21000010
XUNBCODE DS    XL1                      COMMAND CODE                    24000010
XBNDTYPE DS    XL1                      TYPE ACTIVATION                 27000010
         MEND                                                        */ 30000010
*%PLSXUNB : ;                                                           33000010
*DECLARE                                                                36000010
*  1 IEDXUNBD BASED(XUNBPTR),                                           39000010
*    2 XUNBCMD CHAR(2),                  /* UNBIND COMMAND           */ 42000010
*     3 XUNBCODE CHAR(1),                /* COMMAND CODE             */ 45000010
*     3 XBNDTYPE CHAR(1);                /* TYPE ACTIVATION          */ 48000010
*/*                                                                  */ 51000010
