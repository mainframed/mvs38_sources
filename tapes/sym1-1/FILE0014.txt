./  ADD  SSI=23571908,NAME=IEFACT
**********************************************************************  05000015
*                                                                     * 10000015
*                    INTERPRETER ACCOUNTING ROUTINE                   * 15000015
*                                                                     * 20000015
**********************************************************************  25000015
*MODULE NAME= IEFACT                                             Y02940 30000002
*DESCRIPTIVE NAME= IEFACT                                        Y02940 30700002
*COPYRIGHT= N/A                                                  Y02940 31400002
*STATUS= REL. 02.0                                               Y02940 32100002
*FUNCTION= THIS IS A DUMMY MODULE WHERE USER'S ACCOUNTING        Y02940 32800002
*          ROUTINE  WOULD BE INSERTED.                           Y02940 33500002
*NOTES                                                           Y02940 34200002
*    CHARACTER-CODE DEPENDENCIES= EBCDIC                         Y02940 34900002
*    DEPENDENCIES= N/A                                           Y02940 35600002
*    RESTRICTIONS= N/A                                           Y02940 36300002
*    REGISTER-CONVENTIONS= DETERMINED BY USER.                   Y02940 37000002
*    PATCH-LABEL= N/A                                            Y02940 37700002
*MODULE TYPE=                                                    Y02940 38400002
*    PROCESSOR= ASSEM.                                           Y02940 39100002
*    MODULE SIZE= N/A                                            Y02940 39800002
*    ATTRIBUTES=  REENTRANT.                                     Y02940 40500002
*                 REFRESHABLE.                                   Y02940 41200002
*ENTRY POINT= IEFACT                                             Y02940 41900002
*    PURPOSE=  USER'S ACCOUNTING ROUTINE.                        Y02940 42600002
*    LINKAGE=  BALR FROM IEFVFA (SCAN ROUTINE)                   Y02940 43300002
*    INPUT DATA=  REGISTER 14 CONTAINS RETURN ADDRESS.           Y02940 44000002
*    REGISTERS SAVED=  ANY THAT ARE TO BE CHANGED BY USER.       Y02940 44700002
*    REGISTER CONTENTS DURING PROCESSING= N/A                    Y02940 45400002
*    REGISTERS RESTORED=  ANY THAT WERE CHANGED BY USER'S        Y02940 46100002
*    ROUTINE.                                                    Y02940 46150002
*                                                                Y02940 46800002
*EXIT - NORMAL= N/A                                              Y02940 47500002
*    CONDITIONS= N/A                                             Y02940 48200002
*        OUTPUT DATA= N/A                                        Y02940 48900002
*        RETURN CODES= N/A                                       Y02940 49600002
*                                                                Y02940 50300002
*EXIT - ERROR= N/A                                               Y02940 51000002
*   CONDITIONS= N/A                                              Y02940 51700002
*   OUTPUT DATA= N/A                                             Y02940 52400002
*   RETURN CODES= N/A                                            Y02940 53100002
*                                                                Y02940 53800002
*EXTERNAL REFERENCES= N/A                                        Y02940 54500002
*   ROUTINES= N/A                                                Y02940 55200002
*   DATA AREAS= N/A                                              Y02940 55900002
*   CONTROL BLOCKS= N/A                                          Y02940 56600002
*       KEY:  C=CREATE,U=USED,M=MODIFIED,D=DELETE                Y02940 57300002
*                                                                Y02940 58000002
*   TABLES= N/A                                                  Y02940 58700002
*   MACROS= N/A                                                  Y02940 59400002
*        ENQUEUE RESOURSES= N/A                                  Y02940 60100002
*   CHANGE LEVEL= N/A                                            Y02940 60800002
*                                                                Y02940 61500002
*MESSAGES= N/A                                                   Y02940 62200002
**********************************************************************  65000015
IEFACT   CSECT                                                          75000015
         USING *,15                                                     75050001
IEFACT   MODID BRANCH=YES                    MODULE IDENTIFIER   Y01886 75100001
         BR    14 RETURN TO CALLER                                      80000015
         END                                                            85000015
./  ADD  SSI=33300632,NAME=IEFNB9CR
         TITLE 'CONVERTER ESTAE RECOVERY ROUTINE                       *00001000
                        '                                               00002000
IEFNB9CR CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEFNB9CR  73.331'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   SAVER14=REG14;                  /* SAVE REGISTER 14 ON ENTRY     */ 00013000
         LR    SAVER14,REG14                                       0007 00014000
*/* IF REGISTER 0 HAS A CODE OF 12 IN IT,THEN AN SDWA IS NOT       0008 00015000
*   AVAILABLE.IN THIS CASE NO PROCESSING IS DONE BECUASE THE       0008 00016000
*   ABEND,OR PROBLEM ENCOUNTERED CANNOT BE HANDLED PROPERLY          */ 00017000
*                                                                  0008 00018000
*   IF REG0Â¬=TWELVE THEN                                           0008 00019000
         SLR   @15,@15                                             0008 00020000
         IC    @15,TWELVE                                          0008 00021000
         CR    REG0,@15                                            0008 00022000
         BE    @RF00008                                            0008 00023000
*     DO;                                                          0009 00024000
*       SDWAPTR=REG1;               /* SET UP PTR TO WORK AREA       */ 00025000
         LR    SDWAPTR,REG1                                        0010 00026000
*       EREPLPTR=SDWAPARM;          /* PTR TO USER PARAMETERS        */ 00027000
         L     EREPLPTR,SDWAPARM(,SDWAPTR)                         0011 00028000
*/* INITIALIZE RECORD AREA IN SDWA WITH PERTINENT INFORMATION        */ 00029000
*                                                                  0012 00030000
*       SDWAREXN=RTNAME;            /* MOVE EXIT NAME TO SDWA        */ 00031000
         MVC   SDWAREXN(8,SDWAPTR),RTNAME                          0012 00032000
*       SDWAMODN=BLANK8;            /* BLANK MODULE NAME INVOLVED    */ 00033000
         MVC   SDWAMODN(8,SDWAPTR),BLANK8                          0013 00034000
*       SDWACSCT=BLANK8;            /* BLANK CSECT NAME INVOLVED     */ 00035000
         MVC   SDWACSCT(8,SDWAPTR),BLANK8                          0014 00036000
*/* SET UP DUMP PARAMETER LIST SO A DUMP CAN BE PERFORMED AT WILL    */ 00037000
*                                                                  0015 00038000
*       REG0=LENDUMP;               /* LENGTH OF DUMP LIST HAS ZERO     00039000
*                                      IN HIGH ORDER BYTE THAT SERVES   00040000
*                                      AS SUBPOOL NUMBER             */ 00041000
         L     REG0,LENDUMP                                        0015 00042000
*       GEN(GETMAIN R,LV=(0));      /* GET CORE FOR DUMP LIST FORM   */ 00043000
         GETMAIN R,LV=(0)                                               00044000
*       DUMPLIST=REG1;              /* SAVE ADDRESS OF GOTTEN CORE   */ 00045000
         LR    DUMPLIST,REG1                                       0017 00046000
*/* MOVE DUMP LIST FROM CSECT TO GOTTEN CORE FOR EXECUTE FORM        */ 00047000
*                                                                  0018 00048000
*       DUMPCORE(1:LENDUMP)=DUMPMAC(1:LENDUMP);                    0018 00049000
*                                                                  0018 00050000
         L     @15,LENDUMP                                         0018 00051000
         BCTR  @15,0                                               0018 00052000
         EX    @15,@SM00468                                        0018 00053000
*/* DUMP FUNCTION IS INITIALIZED AND READY FOR SDUMP ISSUANCE        */ 00054000
*                                                                  0019 00055000
*                                                                  0019 00056000
*/*P E R C O L A T I O N                                             */ 00057000
*                                                                  0019 00058000
*       IF SDWAPERC=ON THEN         /* WAS THIS ROUTINE PERCOLATED 0019 00059000
*                                      TO?                           */ 00060000
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0019 00061000
         BNO   @RF00019                                            0019 00062000
*/* ISSUE SETRP MACRO FOR PERCOLATION AND RETURN                     */ 00063000
*                                                                  0020 00064000
*         DO;                       /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00065000
*                                      RC(0) RECORD(NO)              */ 00066000
*           RESPECIFY                                              0021 00067000
*            (GPR00P,                                              0021 00068000
*             GPR01P,                                              0021 00069000
*             GPR14P,                                              0021 00070000
*             GPR15P) RSTD;                                        0021 00071000
*           GPR01P=SDWAPTR;                                        0022 00072000
         LR    GPR01P,SDWAPTR                                      0022 00073000
*           GPR01P->SDWARCDE=0;     /* SAVE RC VALUE                 */ 00074000
         MVI   SDWARCDE(GPR01P),X'00'                              0023 00075000
*           GPR01P->SDWARCRD='0'B;  /* TURN OFF RECORD INDICATOR     */ 00076000
         NI    SDWARCRD(GPR01P),B'01111111'                        0024 00077000
*           GPR01P->SDWAREQ='0'B;   /* TURN OFF DUMP INDICATOR       */ 00078000
         NI    SDWAREQ(GPR01P),B'01111111'                         0025 00079000
*           RESPECIFY                                              0026 00080000
*            (GPR00P,                                              0026 00081000
*             GPR01P,                                              0026 00082000
*             GPR14P,                                              0026 00083000
*             GPR15P) UNRSTD;                                      0026 00084000
*         END;                                                     0027 00085000
*       ELSE                                                       0028 00086000
*         DO;                       /* NO,TEST FOR NEXT POSSIBILITY     00087000
*                                                                    */ 00088000
         B     @RC00019                                            0028 00089000
@RF00019 DS    0H                                                  0029 00090000
*                                                                  0029 00091000
*/* R E C U R S I O N                                                */ 00092000
*                                                                  0029 00093000
*           IF EREPRCUR=ON THEN     /* RECURSION WITHIN ESTAE      0029 00094000
*                                      ENVIRONMENT?                  */ 00095000
         TM    EREPRCUR(EREPLPTR),B'10000000'                      0029 00096000
         BNO   @RF00029                                            0029 00097000
*/* ISSUE SETRP MACRO FOR RECURSION AND RETURN                       */ 00098000
*                                                                  0030 00099000
*             DO;                   /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00100000
*                                      RC(0) RECORD(YES)             */ 00101000
*               RESPECIFY                                          0031 00102000
*                (GPR00P,                                          0031 00103000
*                 GPR01P,                                          0031 00104000
*                 GPR14P,                                          0031 00105000
*                 GPR15P) RSTD;                                    0031 00106000
*               GPR01P=SDWAPTR;                                    0032 00107000
         LR    GPR01P,SDWAPTR                                      0032 00108000
*               GPR01P->SDWARCDE=0; /* SAVE RC VALUE                 */ 00109000
         MVI   SDWARCDE(GPR01P),X'00'                              0033 00110000
*               GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR    */ 00111000
         OI    SDWARCRD(GPR01P),B'10000000'                        0034 00112000
*               GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP INDICATOR      */ 00113000
         NI    SDWAREQ(GPR01P),B'01111111'                         0035 00114000
*               RESPECIFY                                          0036 00115000
*                (GPR00P,                                          0036 00116000
*                 GPR01P,                                          0036 00117000
*                 GPR14P,                                          0036 00118000
*                 GPR15P) UNRSTD;                                  0036 00119000
*             END;                                                 0037 00120000
*           ELSE                                                   0038 00121000
*             DO;                                                  0038 00122000
*                                                                  0038 00123000
         B     @RC00029                                            0038 00124000
@RF00029 DS    0H                                                  0039 00125000
*/*      RECURSION BIT IS TURNED ON FOR ALL OTHER CONDITIONS.      0039 00126000
*        THIS WILL SIGNAL THAT THE EXIT ROUTINE WAS ENTERED        0039 00127000
*        BECAUSE OF AN ABEND IN THE RECOVERY PROCESS.                */ 00128000
*                                                                  0039 00129000
*               EREPRCUR=ON;        /* TURN ON RECURSION BIT       0039 00130000
*                                                                    */ 00131000
         OI    EREPRCUR(EREPLPTR),B'10000000'                      0039 00132000
*                                                                  0040 00133000
*/*R E S T A R T  I N T E R R U P T                                  */ 00134000
*                                                                  0040 00135000
*               IF SDWARKEY=ON THEN /* EXTERNAL INTERRUPT SIGNALLING    00136000
*                                      RESTART?                      */ 00137000
         TM    SDWARKEY(SDWAPTR),B'00100000'                       0040 00138000
         BNO   @RF00040                                            0040 00139000
*                 DO;                                              0041 00140000
*                                                                  0041 00141000
*/* ISSUE SETRP MACRO FOR RESTART AND RETURN                         */ 00142000
*                                                                  0042 00143000
*                   DO;             /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00144000
*                                      RC(0) RECORD(YES)             */ 00145000
*                     RESPECIFY                                    0043 00146000
*                      (GPR00P,                                    0043 00147000
*                       GPR01P,                                    0043 00148000
*                       GPR14P,                                    0043 00149000
*                       GPR15P) RSTD;                              0043 00150000
*                     GPR01P=SDWAPTR;                              0044 00151000
         LR    GPR01P,SDWAPTR                                      0044 00152000
*                     GPR01P->SDWARCDE=0;/* SAVE RC VALUE            */ 00153000
         MVI   SDWARCDE(GPR01P),X'00'                              0045 00154000
*                     GPR01P->SDWARCRD='1'B;/* TURN ON RECORD      0046 00155000
*                                      INDICATOR                     */ 00156000
         OI    SDWARCRD(GPR01P),B'10000000'                        0046 00157000
*                     GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP INDICATOR*/ 00158000
         NI    SDWAREQ(GPR01P),B'01111111'                         0047 00159000
*                     RESPECIFY                                    0048 00160000
*                      (GPR00P,                                    0048 00161000
*                       GPR01P,                                    0048 00162000
*                       GPR14P,                                    0048 00163000
*                       GPR15P) UNRSTD;                            0048 00164000
*                   END;                                           0049 00165000
*                   RESPECIFY                                      0050 00166000
*                     SDWA BASED(SDWAPTR);                         0050 00167000
*                                                                  0050 00168000
*/* ISSUE SDUMP TO PRODUCE DUMP FOR DEBUGGING.                       */ 00169000
*                                                                  0051 00170000
*                   GEN;                                           0051 00171000
          SDUMP HDR='RESTART INTERRUPT IN CONVERTER**IEFNB9CR**',MF=(E,,00172000
               (9))                                                     00173000
*                 END;                                             0052 00174000
*               ELSE                /* NO CONTINUE                   */ 00175000
*                 DO;                                              0053 00176000
         B     @RC00040                                            0053 00177000
@RF00040 DS    0H                                                  0054 00178000
*                                                                  0054 00179000
*/* U N E X P E C T E D  E R R O R S                                 */ 00180000
*/*      THE ONLY ABENDS THAT ARE EXPECTED IN THIS ROUTINE ARE     0054 00181000
*        A 0B0 AND PROGRAM CHECKS.ANY OTHER ABEND IS UNEXPECTED      */ 00182000
*                                                                  0054 00183000
*                   IF(SDWACMPCÂ¬=ZEROB0)&(SDWAPCHK=OFF) THEN       0054 00184000
*                                                                  0054 00185000
         CLC   SDWACMPC(3,SDWAPTR),ZEROB0                          0054 00186000
         BE    @RF00054                                            0054 00187000
         TM    SDWAPCHK(SDWAPTR),B'01000000'                       0054 00188000
         BNZ   @RF00054                                            0054 00189000
*/*      THE ABEND IS UNEXPECTED,SO ISSUE SETRP AND CAUSE          0055 00190000
*          ERROR MESSAGE TO BE ISSUED TO OPERATOR.                   */ 00191000
*                                                                  0055 00192000
*                     DO;           /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00193000
*                                      RC(0) RECORD(YES)             */ 00194000
*                       RESPECIFY                                  0056 00195000
*                        (GPR00P,                                  0056 00196000
*                         GPR01P,                                  0056 00197000
*                         GPR14P,                                  0056 00198000
*                         GPR15P) RSTD;                            0056 00199000
*                       GPR01P=SDWAPTR;                            0057 00200000
         LR    GPR01P,SDWAPTR                                      0057 00201000
*                       GPR01P->SDWARCDE=0;/* SAVE RC VALUE          */ 00202000
         MVI   SDWARCDE(GPR01P),X'00'                              0058 00203000
*                       GPR01P->SDWARCRD='1'B;/* TURN ON RECORD    0059 00204000
*                                      INDICATOR                     */ 00205000
         OI    SDWARCRD(GPR01P),B'10000000'                        0059 00206000
*                       GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP      0060 00207000
*                                      INDICATOR                     */ 00208000
         NI    SDWAREQ(GPR01P),B'01111111'                         0060 00209000
*                       RESPECIFY                                  0061 00210000
*                        (GPR00P,                                  0061 00211000
*                         GPR01P,                                  0061 00212000
*                         GPR14P,                                  0061 00213000
*                         GPR15P) UNRSTD;                          0061 00214000
*                     END;                                         0062 00215000
*                   ELSE            /* EXPECTED ABEND              0063 00216000
*                                                                    */ 00217000
*                                                                  0063 00218000
*/* 0 B 0  ABEND , E X P E C T E D  E R R O R S                      */ 00219000
*                                                                  0063 00220000
*                     DO;                                          0063 00221000
         B     @RC00054                                            0063 00222000
@RF00054 DS    0H                                                  0064 00223000
*                       RESPECIFY                                  0064 00224000
*                        (REG4,                                    0064 00225000
*                         COUNT,                                   0064 00226000
*                         REG6,                                    0064 00227000
*                         REG7) RSTD;                              0064 00228000
*                                                                  0064 00229000
*/* ISSUE SETRP MACRO FOR EXPECTED ERRORS @YM02460                   */ 00230000
*                                                                  0065 00231000
*                       DO;         /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00232000
*                                      RC(4) FRESDWA(YES) RECORD(YES)   00233000
*                                      RETADDR(IEFNB9CT)             */ 00234000
*                         RESPECIFY                                0066 00235000
*                          (GPR00P,                                0066 00236000
*                           GPR01P,                                0066 00237000
*                           GPR14P,                                0066 00238000
*                           GPR15P) RSTD;                          0066 00239000
*                         GPR01P=SDWAPTR;                          0067 00240000
         LR    GPR01P,SDWAPTR                                      0067 00241000
*                         GPR01P->SDWARCDE=4;/* STORE RC INTO SDWA   */ 00242000
         MVI   SDWARCDE(GPR01P),X'04'                              0068 00243000
*                         GPR01P->SDWARTYA=ADDR(IEFNB9CT);/* SAVE  0069 00244000
*                                      RETRY ADDRESS                 */ 00245000
         L     @11,@CV00422                                        0069 00246000
         ST    @11,SDWARTYA(,GPR01P)                               0069 00247000
*                         GPR01P->SDWAFREE='1'B;/* SET FLAG TO FREE     00248000
*                                      SDWA                          */ 00249000
*                         GPR01P->SDWARCRD='1'B;/* TURN ON RECORD  0071 00250000
*                                      INDICATOR                     */ 00251000
         OI    SDWAFREE(GPR01P),B'10000100'                        0071 00252000
*                         GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP    0072 00253000
*                                      INDICATOR                     */ 00254000
         NI    SDWAREQ(GPR01P),B'01111111'                         0072 00255000
*                         RESPECIFY                                0073 00256000
*                          (GPR00P,                                0073 00257000
*                           GPR01P,                                0073 00258000
*                           GPR14P,                                0073 00259000
*                           GPR15P) UNRSTD;                        0073 00260000
*                       END;                                       0074 00261000
*                       RESPECIFY                                  0075 00262000
*                         SDWA BASED(SDWAPTR);                     0075 00263000
*                                                                  0075 00264000
*/* ISSUE SDUMP FOR DEBUGGING PURPOSES                               */ 00265000
*                                                                  0076 00266000
*                       GEN                                        0076 00267000
*(SDUMP HDR='EXPECTED CONVERTER ABEND**IEFNB9CR**',MF=(E,(9)));    0076 00268000
         SDUMP HDR='EXPECTED CONVERTER ABEND**IEFNB9CR**',MF=(E,(9))    00269000
*                     END;                                         0077 00270000
*                                                                  0078 00271000
*/* I S S U E  E R R O R  M S G.  I E F 6 8 3 I                      */ 00272000
*/* CORE MUST BE GOTTEN FOR THE LIST FORM OF THE WRITE TO OPERATOR 0078 00273000
*   PARAMETER LIST.IT IS REQUESTED IN SUBPOOL ZERO.                  */ 00274000
*                                                                  0078 00275000
*                   REG0=WTOLEN;    /* ADCON FOR LENGTH OF EXPANDED     00276000
*                                      WTO LIST HAS ZERO IN HIGH   0078 00277000
*                                      ORDER BYTE WHICH SERVES AS  0078 00278000
*                                      SUBPOOL NUMBER                */ 00279000
@RC00054 L     REG0,WTOLEN                                         0078 00280000
*                   GEN(GETMAIN R,LV=(0));/* GET CORE FOR LIST FORM  */ 00281000
         GETMAIN R,LV=(0)                                               00282000
*                   REG4=REG1;      /* SETUP ADDRESS TO GOTTEN CORE  */ 00283000
         LR    REG4,REG1                                           0080 00284000
*/* THE MESSAGE LIST DEFINED IN THE CSECT MUST BE MOVED INTO THE   0081 00285000
*   GOTTEN CORE.                                                     */ 00286000
*                                                                  0081 00287000
*                   WTOCORE(1:WTOLEN)=WTOCSECT(1:WTOLEN);          0081 00288000
*                                                                  0081 00289000
         L     @15,WTOLEN                                          0081 00290000
         BCTR  @15,0                                               0081 00291000
         EX    @15,@SM00472                                        0081 00292000
*/* THE THREE 4 BIT DIGITS OF THE COMPLETION CODE ARE PLACED INTO THE   00293000
*   THREE BYTE COMPLETION CODE FIELD IN THE MESSAGE.THE 4 BIT CHARACT-  00294000
*   ERS ARE TRANSLATED INTO 8 BIT PRINTABLE CHARACTERS WITHIN THE  0082 00295000
*   MESSAGE ITSELF.THEN THE MESSAGE IS ISSUED.                       */ 00296000
*                                                                  0082 00297000
*                   REG7=SDWAABCC;  /* ABEND CODE TO LIST            */ 00298000
         L     REG7,SDWAABCC(,SDWAPTR)                             0082 00299000
*                   GEN(SLL REG7,8(0));                            0083 00300000
         SLL REG7,8(0)                                                  00301000
*                   DO COUNT=0 TO 2;/* TRANSLATE ABEND CODE INTO MSG */ 00302000
         SLR   COUNT,COUNT                                         0084 00303000
@DL00084 DS    0H                                                  0085 00304000
*                     GEN CODE REFS(COUNT,CHARSTRG);               0085 00305000
       SR    REG6,REG6     ZERO REG6 FOR NEXT CHARACTER.                00306000
       SLDL  REG6,4(0)     SHIFT THE 4 BIT MEMBER OF CODE INTO REG6     00307000
       IC    REG6,CHARSTRG(REG6)      PICK PRINTABLE CHARACTER          00308000
       STC   REG6,41(COUNT,REG4)     INSERT INTO MESSAGE TO PRINT       00309000
*                   END;                                           0086 00310000
*                                                                  0086 00311000
         AH    COUNT,@CH00040                                      0086 00312000
         CH    COUNT,@CH00061                                      0086 00313000
         BNH   @DL00084                                            0086 00314000
*/*      ISSUE WRITE TO OPERATOR MESSAGE                             */ 00315000
*                                                                  0087 00316000
*                   GEN(WTO MF=(E,(4)));                           0087 00317000
*                                                                  0087 00318000
         WTO MF=(E,(4))                                                 00319000
*/*     FREE THE WTO LIST IN GOTTEN CORE.                            */ 00320000
*                                                                  0088 00321000
*                   REG0=WTOLEN;    /* LENGTH AND SUBPOOL NUMBER     */ 00322000
         L     REG0,WTOLEN                                         0088 00323000
*                   REG1=REG4;      /* ADDRESS OF WTO LIST           */ 00324000
         LR    REG1,REG4                                           0089 00325000
*                   GEN(FREEMAIN R,LV=(0),A=(1));/* FREE CORE        */ 00326000
         FREEMAIN R,LV=(0),A=(1)                                        00327000
*                   RESPECIFY                                      0091 00328000
*                    (REG4,                                        0091 00329000
*                     COUNT,                                       0091 00330000
*                     REG6,                                        0091 00331000
*                     REG7) UNRSTD;                                0091 00332000
*                 END;                                             0092 00333000
*             END;                                                 0093 00334000
@RC00040 DS    0H                                                  0094 00335000
*         END;                                                     0094 00336000
@RC00029 DS    0H                                                  0095 00337000
*                                                                  0095 00338000
*/* FREE THE DUMP LIST IN CORE                                       */ 00339000
*                                                                  0095 00340000
*       REG0=LENDUMP;               /* LENGTH OF DUMP LIST WITH HIGH    00341000
*                                      ORDER BYTE OF ZERO SERVING AS    00342000
*                                      SUBPOOL NUMBER                */ 00343000
@RC00019 L     REG0,LENDUMP                                        0095 00344000
*       REG1=DUMPLIST;              /* ADDRESS OF DUMP LIST IN CORE  */ 00345000
         LR    REG1,DUMPLIST                                       0096 00346000
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE CORE                */ 00347000
         FREEMAIN R,LV=(0),A=(1)                                        00348000
*     END;                                                         0098 00349000
*                                                                  0098 00350000
*/* SET UP TO RETURN                                                 */ 00351000
*                                                                  0099 00352000
*   REG14=SAVER14;                  /* RESTORE REG14 TO RETURN TO RTM*/ 00353000
@RF00008 LR    REG14,SAVER14                                       0099 00354000
*/* RETURN CODE OF ZERO IS ALWAYS PASSED BACK IN REGISTER 15.      0100 00355000
*   UNDER NORMAL CONDITIONS RTM IGNORES REGISTER 15.IF NO SDWA     0100 00356000
*   WAS PASSED REGISTER 15 WITH A ZERO SIGNALS NO RETRY.             */ 00357000
*                                                                  0100 00358000
*   RETURN CODE(0);                                                0100 00359000
         SLR   @15,@15                                             0100 00360000
@EL00001 DS    0H                                                  0100 00361000
@EF00001 DS    0H                                                  0100 00362000
@ER00001 BR    @14                                                 0100 00363000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00364000
*     GPR00P PTR(31) REG(0),                                       0101 00365000
*     GPR01P PTR(31) REG(1),                                       0101 00366000
*     GPR14P PTR(31) REG(14),                                      0101 00367000
*     GPR15P PTR(31) REG(15);                                      0101 00368000
*   DECLARE                         /* COMMON VARIABLES              */ 00369000
*     I256C CHAR(256) BASED,                                       0102 00370000
*     I031F FIXED(31) BASED,                                       0102 00371000
*     I031P PTR(31) BASED,                                         0102 00372000
*     I015F FIXED(15) BASED,                                       0102 00373000
*     I015P PTR(15) BASED,                                         0102 00374000
*     I008P PTR(8) BASED,                                          0102 00375000
*     I001C CHAR(1) BASED;                                         0102 00376000
*   END IEFNB9CR                                                   0103 00377000
*                                                                  0103 00378000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00379000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 00380000
*/*%INCLUDE SYSLIB  (IEFZB9RD)                                       */ 00381000
*                                                                  0103 00382000
*       ;                                                          0103 00383000
@DATA    DS    0H                                                       00384000
@CH00040 DC    H'1'                                                     00385000
@CH00061 DC    H'2'                                                     00386000
@SM00468 MVC   DUMPCORE(0,DUMPLIST),DUMPMAC                             00387000
@SM00472 MVC   WTOCORE(0,REG4),WTOCSECT                                 00388000
@DATD    DSECT                                                          00389000
         DS    0F                                                       00390000
IEFNB9CR CSECT                                                          00391000
         DS    0F                                                       00392000
@DATD    DSECT                                                          00393000
         DS    0D                                                       00394000
IEFNB9CR CSECT                                                          00395000
         DS    0F                                                       00396000
@SIZDATD DC    AL1(0)                                                   00397000
         DC    AL3(@ENDDATD-@DATD)                                      00398000
@CV00422 DC    V(IEFNB9CT)                                              00399000
         DS    0D                                                       00400000
         DS    CL1                                                      00401000
ZEROB0   DC    XL3'0B0000'                                              00402000
NBCRPTCH DS    CL25                                                     00403000
         ORG   NBCRPTCH                                                 00404000
@NM00052 DC    25X'00'                                                  00405000
         ORG   NBCRPTCH+25                                              00406000
         DS    CL3                                                      00407000
CHARSTRG DC    CL16'0123456789ABCDEF'                                   00408000
TWELVE   DC    X'0C'                                                    00409000
RTNAME   DC    CL8'IEFNB9CR'                                            00410000
BLANK8   DC    CL8'        '                                            00411000
IEFNB9CR CSECT                                                          00412000
WTOCSECT WTO  'IEF683I CONVERTER TERMINATED DUE TO S    ABEND',DESC=6,RR00413000
               OUTCDE=2,MF=L                                            00414000
WTOLEN   DC   A(*-WTOCSECT)                                             00415000
DUMPMAC SDUMP BUFFER=NO,QUIESCE=YES,SDATA=(SQA,LSQA,SWA,RGN,LPA),MF=L   00416000
LENDUMP  DC   A(*-DUMPMAC)                                              00417000
@DATD    DSECT                                                          00418000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00419000
@ENDDATD EQU   *                                                        00420000
IEFNB9CR CSECT                                                          00421000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00422000
@01      EQU   01                                                       00423000
@02      EQU   02                                                       00424000
@03      EQU   03                                                       00425000
@04      EQU   04                                                       00426000
@05      EQU   05                                                       00427000
@06      EQU   06                                                       00428000
@07      EQU   07                                                       00429000
@08      EQU   08                                                       00430000
@09      EQU   09                                                       00431000
@10      EQU   10                                                       00432000
@11      EQU   11                                                       00433000
@12      EQU   12                                                       00434000
@13      EQU   13                                                       00435000
@14      EQU   14                                                       00436000
@15      EQU   15                                                       00437000
SDWAPTR  EQU   @02                                                      00438000
EREPLPTR EQU   @03                                                      00439000
REG0     EQU   @00                                                      00440000
REG1     EQU   @01                                                      00441000
REG4     EQU   @04                                                      00442000
COUNT    EQU   @05                                                      00443000
REG6     EQU   @06                                                      00444000
REG7     EQU   @07                                                      00445000
SAVER14  EQU   @08                                                      00446000
DUMPLIST EQU   @09                                                      00447000
REG14    EQU   @14                                                      00448000
GPR00P   EQU   @00                                                      00449000
GPR01P   EQU   @01                                                      00450000
GPR14P   EQU   @14                                                      00451000
GPR15P   EQU   @15                                                      00452000
SDWA     EQU   0                                                        00453000
SDWAPARM EQU   SDWA                                                     00454000
SDWAFIOB EQU   SDWA+4                                                   00455000
SDWAABCC EQU   SDWAFIOB                                                 00456000
SDWACMPF EQU   SDWAABCC                                                 00457000
SDWAREQ  EQU   SDWACMPF                                                 00458000
SDWACMPC EQU   SDWAABCC+1                                               00459000
SDWACTL1 EQU   SDWA+8                                                   00460000
SDWACMKA EQU   SDWACTL1                                                 00461000
SDWAMWPA EQU   SDWACTL1+1                                               00462000
SDWAPMKA EQU   SDWACTL1+4                                               00463000
SDWACTL2 EQU   SDWA+16                                                  00464000
SDWACMKP EQU   SDWACTL2                                                 00465000
SDWAMWPP EQU   SDWACTL2+1                                               00466000
SDWAPMKP EQU   SDWACTL2+4                                               00467000
SDWAGRSV EQU   SDWA+24                                                  00468000
SDWANAME EQU   SDWA+88                                                  00469000
SDWAEC1  EQU   SDWA+104                                                 00470000
SDWAEMK1 EQU   SDWAEC1                                                  00471000
SDWAMWP1 EQU   SDWAEC1+1                                                00472000
SDWAINT1 EQU   SDWAEC1+2                                                00473000
SDWANXT1 EQU   SDWAEC1+4                                                00474000
SDWAAEC1 EQU   SDWA+112                                                 00475000
SDWAILC1 EQU   SDWAAEC1+1                                               00476000
SDWAINC1 EQU   SDWAAEC1+2                                               00477000
SDWAICD1 EQU   SDWAINC1+1                                               00478000
SDWAEC2  EQU   SDWA+120                                                 00479000
SDWAEMK2 EQU   SDWAEC2                                                  00480000
SDWAMWP2 EQU   SDWAEC2+1                                                00481000
SDWAINT2 EQU   SDWAEC2+2                                                00482000
SDWANXT2 EQU   SDWAEC2+4                                                00483000
SDWAAEC2 EQU   SDWA+128                                                 00484000
SDWAILC2 EQU   SDWAAEC2+1                                               00485000
SDWAINC2 EQU   SDWAAEC2+2                                               00486000
SDWAICD2 EQU   SDWAINC2+1                                               00487000
SDWASRSV EQU   SDWA+136                                                 00488000
SDWAIDNT EQU   SDWA+200                                                 00489000
SDWAMCH  EQU   SDWA+204                                                 00490000
SDWASTCK EQU   SDWAMCH                                                  00491000
SDWAMCHI EQU   SDWAMCH+8                                                00492000
SDWAMCHS EQU   SDWAMCHI                                                 00493000
SDWAMCHD EQU   SDWAMCHI+1                                               00494000
SDWARSR1 EQU   SDWAMCH+12                                               00495000
SDWARSR2 EQU   SDWAMCH+13                                               00496000
SDWAFLGS EQU   SDWA+232                                                 00497000
SDWAERRA EQU   SDWAFLGS                                                 00498000
SDWAPCHK EQU   SDWAERRA                                                 00499000
SDWARKEY EQU   SDWAERRA                                                 00500000
SDWAERRB EQU   SDWAFLGS+1                                               00501000
SDWAERRC EQU   SDWAFLGS+2                                               00502000
SDWAPERC EQU   SDWAERRC                                                 00503000
SDWAERRD EQU   SDWAFLGS+3                                               00504000
SDWAIOFS EQU   SDWA+238                                                 00505000
SDWARTYA EQU   SDWA+240                                                 00506000
SDWACPUA EQU   SDWA+248                                                 00507000
SDWAPARQ EQU   SDWA+252                                                 00508000
SDWARCDE EQU   SDWAPARQ                                                 00509000
SDWAACF2 EQU   SDWAPARQ+1                                               00510000
SDWARCRD EQU   SDWAACF2                                                 00511000
SDWAFREE EQU   SDWAACF2                                                 00512000
SDWAACF3 EQU   SDWAPARQ+2                                               00513000
SDWAACF4 EQU   SDWAPARQ+3                                               00514000
SDWALKWA EQU   SDWA+256                                                 00515000
SDWALKWS EQU   SDWALKWA                                                 00516000
SDWARECP EQU   SDWA+292                                                 00517000
SDWAMODN EQU   SDWARECP                                                 00518000
SDWACSCT EQU   SDWARECP+8                                               00519000
SDWAREXN EQU   SDWARECP+16                                              00520000
SDWASNPA EQU   SDWA+320                                                 00521000
SDWADUMP EQU   SDWASNPA                                                 00522000
SDWADPFS EQU   SDWADUMP+1                                               00523000
SDWADDAT EQU   SDWASNPA+4                                               00524000
SDWASDAT EQU   SDWADDAT                                                 00525000
SDWAPDAT EQU   SDWADDAT+2                                               00526000
SDWADPSA EQU   SDWA+328                                                 00527000
SDWADPSL EQU   SDWADPSA                                                 00528000
SDWARA   EQU   SDWA+400                                                 00529000
SDWADPVA EQU   SDWARA+2                                                 00530000
EREPL    EQU   0                                                        00531000
EREPFLGS EQU   EREPL+12                                                 00532000
EREPFLG1 EQU   EREPFLGS                                                 00533000
EREPRCUR EQU   EREPFLG1                                                 00534000
WTOCORE  EQU   0                                                        00535000
DUMPCORE EQU   0                                                        00536000
I001C    EQU   0                                                        00537000
I008P    EQU   0                                                        00538000
I015F    EQU   0                                                        00539000
I015P    EQU   0                                                        00540000
I031F    EQU   0                                                        00541000
I031P    EQU   0                                                        00542000
I256C    EQU   0                                                        00543000
*                                      START UNREFERENCED COMPONENTS    00544000
@NM00051 EQU   EREPL+16                                                 00545000
@NM00050 EQU   EREPFLGS+1                                               00546000
@NM00049 EQU   EREPFLG1                                                 00547000
EREPLRSV EQU   EREPL+8                                                  00548000
EREPLIWA EQU   EREPL+4                                                  00549000
EREPLCWA EQU   EREPL                                                    00550000
@NM00048 EQU   SDWA+512                                                 00551000
SDWAVRA  EQU   SDWARA+4                                                 00552000
SDWAURAL EQU   SDWARA+3                                                 00553000
@NM00047 EQU   SDWADPVA                                                 00554000
SDWAEBC  EQU   SDWADPVA                                                 00555000
SDWAHEX  EQU   SDWADPVA                                                 00556000
SDWAVRAL EQU   SDWARA                                                   00557000
@NM00046 EQU   SDWA+396                                                 00558000
SDWACOMP EQU   SDWA+392                                                 00559000
SDWARCPL EQU   SDWA+364                                                 00560000
@NM00045 EQU   SDWADPSA+32                                              00561000
SDWATO4  EQU   SDWADPSL+28                                              00562000
SDWAFRM4 EQU   SDWADPSL+24                                              00563000
SDWATO3  EQU   SDWADPSL+20                                              00564000
SDWAFRM3 EQU   SDWADPSL+16                                              00565000
SDWATO2  EQU   SDWADPSL+12                                              00566000
SDWAFRM2 EQU   SDWADPSL+8                                               00567000
SDWATO1  EQU   SDWADPSL+4                                               00568000
SDWAFRM1 EQU   SDWADPSL                                                 00569000
@NM00044 EQU   SDWADDAT+3                                               00570000
@NM00043 EQU   SDWAPDAT                                                 00571000
SDWAUSPL EQU   SDWAPDAT                                                 00572000
SDWADPSW EQU   SDWAPDAT                                                 00573000
SDWATJPA EQU   SDWAPDAT                                                 00574000
SDWATLPA EQU   SDWAPDAT                                                 00575000
SDWADREG EQU   SDWAPDAT                                                 00576000
SDWADSAH EQU   SDWAPDAT                                                 00577000
SDWADSAS EQU   SDWAPDAT                                                 00578000
@NM00042 EQU   SDWADDAT+1                                               00579000
@NM00041 EQU   SDWASDAT                                                 00580000
SDWAQQS  EQU   SDWASDAT                                                 00581000
SDWACBS  EQU   SDWASDAT                                                 00582000
SDWAGTF  EQU   SDWASDAT                                                 00583000
SDWASWA  EQU   SDWASDAT                                                 00584000
SDWALSQA EQU   SDWASDAT                                                 00585000
SDWASQA  EQU   SDWASDAT                                                 00586000
SDWANUC  EQU   SDWASDAT                                                 00587000
@NM00040 EQU   SDWADUMP+2                                               00588000
@NM00039 EQU   SDWADPFS                                                 00589000
SDWASLST EQU   SDWADPFS                                                 00590000
@NM00038 EQU   SDWADPFS                                                 00591000
SDWADLST EQU   SDWADPFS                                                 00592000
SDWADPT  EQU   SDWADPFS                                                 00593000
SDWADPID EQU   SDWADUMP                                                 00594000
SDWADPLA EQU   SDWA+316                                                 00595000
@NM00037 EQU   SDWALKWA+32                                              00596000
SDWATALW EQU   SDWALKWS+28                                              00597000
SDWATDLW EQU   SDWALKWS+24                                              00598000
SDWATNLW EQU   SDWALKWS+20                                              00599000
SDWAAPLW EQU   SDWALKWS+16                                              00600000
SDWAIPLW EQU   SDWALKWS+12                                              00601000
SDWAILLW EQU   SDWALKWS+8                                               00602000
SDWAIULW EQU   SDWALKWS+4                                               00603000
SDWAICLW EQU   SDWALKWS                                                 00604000
SDWAFLLK EQU   SDWAACF4                                                 00605000
SDWACMS  EQU   SDWAACF4                                                 00606000
SDWAOPTM EQU   SDWAACF4                                                 00607000
SDWATADB EQU   SDWAACF4                                                 00608000
SDWATDNB EQU   SDWAACF4                                                 00609000
SDWATNCB EQU   SDWAACF4                                                 00610000
SDWAILCH EQU   SDWAACF4                                                 00611000
SDWAIUCB EQU   SDWAACF4                                                 00612000
SDWAICAT EQU   SDWAACF3                                                 00613000
SDWAIPRG EQU   SDWAACF3                                                 00614000
SDWASALL EQU   SDWAACF3                                                 00615000
SDWAASMP EQU   SDWAACF3                                                 00616000
SDWADISP EQU   SDWAACF3                                                 00617000
@NM00036 EQU   SDWAACF3                                                 00618000
@NM00035 EQU   SDWAACF2                                                 00619000
SDWAUPRG EQU   SDWAACF2                                                 00620000
@NM00034 EQU   SDWAACF2                                                 00621000
SDWASPIN EQU   SDWAACF2                                                 00622000
@NM00033 EQU   SDWAACF2                                                 00623000
SDWALCPU EQU   SDWACPUA+2                                               00624000
@NM00032 EQU   SDWACPUA                                                 00625000
SDWARECA EQU   SDWA+244                                                 00626000
@NM00031 EQU   SDWA+239                                                 00627000
@NM00030 EQU   SDWAIOFS                                                 00628000
SDWANIOP EQU   SDWAIOFS                                                 00629000
SDWANOIO EQU   SDWAIOFS                                                 00630000
SDWAIOHT EQU   SDWAIOFS                                                 00631000
SDWAIOQR EQU   SDWAIOFS                                                 00632000
SDWAFMID EQU   SDWA+236                                                 00633000
@NM00029 EQU   SDWAERRD                                                 00634000
SDWAMCIV EQU   SDWAERRD                                                 00635000
SDWARPIV EQU   SDWAERRD                                                 00636000
SDWAMABD EQU   SDWAERRD                                                 00637000
SDWACTS  EQU   SDWAERRD                                                 00638000
SDWASTAE EQU   SDWAERRD                                                 00639000
SDWANRBE EQU   SDWAERRD                                                 00640000
SDWACLUP EQU   SDWAERRD                                                 00641000
@NM00028 EQU   SDWAERRC                                                 00642000
SDWAEAS  EQU   SDWAERRC                                                 00643000
SDWAIRB  EQU   SDWAERRC                                                 00644000
SDWASTAI EQU   SDWAERRC                                                 00645000
SDWASTAF EQU   SDWAERRC                                                 00646000
SDWASRBM EQU   SDWAERRB                                                 00647000
SDWALDIS EQU   SDWAERRB                                                 00648000
SDWAENRB EQU   SDWAERRB                                                 00649000
SDWATYP1 EQU   SDWAERRB                                                 00650000
@NM00027 EQU   SDWAERRB                                                 00651000
SDWAPGIO EQU   SDWAERRA                                                 00652000
SDWATEXC EQU   SDWAERRA                                                 00653000
SDWASVCE EQU   SDWAERRA                                                 00654000
SDWAABTM EQU   SDWAERRA                                                 00655000
SDWASVCD EQU   SDWAERRA                                                 00656000
SDWAMCHK EQU   SDWAERRA                                                 00657000
SDWATIME EQU   SDWAMCH+20                                               00658000
SDWARFSA EQU   SDWAMCH+16                                               00659000
@NM00026 EQU   SDWAMCH+14                                               00660000
SDWAVEQR EQU   SDWARSR2                                                 00661000
SDWAPGFX EQU   SDWARSR2                                                 00662000
SDWAFLSQ EQU   SDWARSR2                                                 00663000
SDWAFSQA EQU   SDWARSR2                                                 00664000
SDWANUCL EQU   SDWARSR2                                                 00665000
SDWASPER EQU   SDWARSR2                                                 00666000
SDWAINTC EQU   SDWARSR2                                                 00667000
SDWAOFLN EQU   SDWARSR2                                                 00668000
SDWACHNG EQU   SDWARSR1                                                 00669000
SDWAMSER EQU   SDWARSR1                                                 00670000
@NM00025 EQU   SDWARSR1                                                 00671000
SDWACPID EQU   SDWAMCH+10                                               00672000
SDWATERR EQU   SDWAMCHD                                                 00673000
SDWAFPRX EQU   SDWAMCHD                                                 00674000
SDWAINSF EQU   SDWAMCHD                                                 00675000
SDWAACR  EQU   SDWAMCHD                                                 00676000
SDWASCK  EQU   SDWAMCHD                                                 00677000
SDWAPSWU EQU   SDWAMCHD                                                 00678000
SDWAREGU EQU   SDWAMCHD                                                 00679000
SDWASKYF EQU   SDWAMCHD                                                 00680000
@NM00024 EQU   SDWAMCHS                                                 00681000
SDWARSRF EQU   SDWAMCHS                                                 00682000
SDWARSRC EQU   SDWAMCHS                                                 00683000
SDWAINVP EQU   SDWAMCHS                                                 00684000
SDWATSVL EQU   SDWAMCHS                                                 00685000
SDWARCDF EQU   SDWAMCHS                                                 00686000
SDWASRVL EQU   SDWAMCHS                                                 00687000
SDWASCKE EQU   SDWASTCK+4                                               00688000
SDWASCKB EQU   SDWASTCK                                                 00689000
SDWALNTH EQU   SDWAIDNT+1                                               00690000
SDWASPID EQU   SDWAIDNT                                                 00691000
SDWASR15 EQU   SDWASRSV+60                                              00692000
SDWASR14 EQU   SDWASRSV+56                                              00693000
SDWASR13 EQU   SDWASRSV+52                                              00694000
SDWASR12 EQU   SDWASRSV+48                                              00695000
SDWASR11 EQU   SDWASRSV+44                                              00696000
SDWASR10 EQU   SDWASRSV+40                                              00697000
SDWASR09 EQU   SDWASRSV+36                                              00698000
SDWASR08 EQU   SDWASRSV+32                                              00699000
SDWASR07 EQU   SDWASRSV+28                                              00700000
SDWASR06 EQU   SDWASRSV+24                                              00701000
SDWASR05 EQU   SDWASRSV+20                                              00702000
SDWASR04 EQU   SDWASRSV+16                                              00703000
SDWASR03 EQU   SDWASRSV+12                                              00704000
SDWASR02 EQU   SDWASRSV+8                                               00705000
SDWASR01 EQU   SDWASRSV+4                                               00706000
SDWASR00 EQU   SDWASRSV                                                 00707000
SDWATRN2 EQU   SDWAAEC2+4                                               00708000
SDWAIPC2 EQU   SDWAICD2                                                 00709000
SDWAIMC2 EQU   SDWAICD2                                                 00710000
SDWAIPR2 EQU   SDWAICD2                                                 00711000
@NM00023 EQU   SDWAINC2                                                 00712000
@NM00022 EQU   SDWAILC2                                                 00713000
SDWAIL2  EQU   SDWAILC2                                                 00714000
@NM00021 EQU   SDWAILC2                                                 00715000
@NM00020 EQU   SDWAAEC2                                                 00716000
SDWAADD2 EQU   SDWANXT2+1                                               00717000
@NM00019 EQU   SDWANXT2                                                 00718000
@NM00018 EQU   SDWAEC2+3                                                00719000
SDWASGN2 EQU   SDWAINT2                                                 00720000
SDWAEXP2 EQU   SDWAINT2                                                 00721000
SDWADEC2 EQU   SDWAINT2                                                 00722000
SDWAFPO2 EQU   SDWAINT2                                                 00723000
SDWACC2  EQU   SDWAINT2                                                 00724000
@NM00017 EQU   SDWAINT2                                                 00725000
SDWAPGM2 EQU   SDWAMWP2                                                 00726000
SDWAWAT2 EQU   SDWAMWP2                                                 00727000
SDWAMCK2 EQU   SDWAMWP2                                                 00728000
SDWAECT2 EQU   SDWAMWP2                                                 00729000
SDWAKEY2 EQU   SDWAMWP2                                                 00730000
SDWAEXT2 EQU   SDWAEMK2                                                 00731000
SDWAIO2  EQU   SDWAEMK2                                                 00732000
SDWATRM2 EQU   SDWAEMK2                                                 00733000
@NM00016 EQU   SDWAEMK2                                                 00734000
SDWAPER2 EQU   SDWAEMK2                                                 00735000
@NM00015 EQU   SDWAEMK2                                                 00736000
SDWATRAN EQU   SDWAAEC1+4                                               00737000
SDWAIPC1 EQU   SDWAICD1                                                 00738000
SDWAIMC1 EQU   SDWAICD1                                                 00739000
SDWAIPR1 EQU   SDWAICD1                                                 00740000
@NM00014 EQU   SDWAINC1                                                 00741000
@NM00013 EQU   SDWAILC1                                                 00742000
SDWAIL1  EQU   SDWAILC1                                                 00743000
@NM00012 EQU   SDWAILC1                                                 00744000
@NM00011 EQU   SDWAAEC1                                                 00745000
SDWAADD1 EQU   SDWANXT1+1                                               00746000
@NM00010 EQU   SDWANXT1                                                 00747000
@NM00009 EQU   SDWAEC1+3                                                00748000
SDWASGN1 EQU   SDWAINT1                                                 00749000
SDWAEXP1 EQU   SDWAINT1                                                 00750000
SDWADEC1 EQU   SDWAINT1                                                 00751000
SDWAFPO1 EQU   SDWAINT1                                                 00752000
SDWACC1  EQU   SDWAINT1                                                 00753000
@NM00008 EQU   SDWAINT1                                                 00754000
SDWAPGM1 EQU   SDWAMWP1                                                 00755000
SDWAWAT1 EQU   SDWAMWP1                                                 00756000
SDWAMCK1 EQU   SDWAMWP1                                                 00757000
SDWAECT1 EQU   SDWAMWP1                                                 00758000
SDWAKEY1 EQU   SDWAMWP1                                                 00759000
SDWAEXT1 EQU   SDWAEMK1                                                 00760000
SDWAIO1  EQU   SDWAEMK1                                                 00761000
SDWATRM1 EQU   SDWAEMK1                                                 00762000
@NM00007 EQU   SDWAEMK1                                                 00763000
SDWAPER1 EQU   SDWAEMK1                                                 00764000
@NM00006 EQU   SDWAEMK1                                                 00765000
SDWAIOBR EQU   SDWA+100                                                 00766000
SDWAEPA  EQU   SDWA+96                                                  00767000
@NM00005 EQU   SDWANAME+4                                               00768000
SDWARBAD EQU   SDWANAME                                                 00769000
SDWAGR15 EQU   SDWAGRSV+60                                              00770000
SDWAGR14 EQU   SDWAGRSV+56                                              00771000
SDWAGR13 EQU   SDWAGRSV+52                                              00772000
SDWAGR12 EQU   SDWAGRSV+48                                              00773000
SDWAGR11 EQU   SDWAGRSV+44                                              00774000
SDWAGR10 EQU   SDWAGRSV+40                                              00775000
SDWAGR09 EQU   SDWAGRSV+36                                              00776000
SDWAGR08 EQU   SDWAGRSV+32                                              00777000
SDWAGR07 EQU   SDWAGRSV+28                                              00778000
SDWAGR06 EQU   SDWAGRSV+24                                              00779000
SDWAGR05 EQU   SDWAGRSV+20                                              00780000
SDWAGR04 EQU   SDWAGRSV+16                                              00781000
SDWAGR03 EQU   SDWAGRSV+12                                              00782000
SDWAGR02 EQU   SDWAGRSV+8                                               00783000
SDWAGR01 EQU   SDWAGRSV+4                                               00784000
SDWAGR00 EQU   SDWAGRSV                                                 00785000
SDWANXTP EQU   SDWACTL2+5                                               00786000
SDWASGP  EQU   SDWAPMKP                                                 00787000
SDWAEUP  EQU   SDWAPMKP                                                 00788000
SDWADOP  EQU   SDWAPMKP                                                 00789000
SDWAFPP  EQU   SDWAPMKP                                                 00790000
SDWACCP  EQU   SDWAPMKP                                                 00791000
SDWAILP  EQU   SDWAPMKP                                                 00792000
SDWAINTP EQU   SDWACTL2+2                                               00793000
SDWASPVP EQU   SDWAMWPP                                                 00794000
SDWAWATP EQU   SDWAMWPP                                                 00795000
SDWAMCKP EQU   SDWAMWPP                                                 00796000
@NM00004 EQU   SDWAMWPP                                                 00797000
SDWAKEYP EQU   SDWAMWPP                                                 00798000
SDWAEXTP EQU   SDWACMKP                                                 00799000
SDWAIOP  EQU   SDWACMKP                                                 00800000
SDWANXTA EQU   SDWACTL1+5                                               00801000
SDWASGA  EQU   SDWAPMKA                                                 00802000
SDWAEUA  EQU   SDWAPMKA                                                 00803000
SDWADOA  EQU   SDWAPMKA                                                 00804000
SDWAFPA  EQU   SDWAPMKA                                                 00805000
SDWACCA  EQU   SDWAPMKA                                                 00806000
SDWAILA  EQU   SDWAPMKA                                                 00807000
SDWAINTA EQU   SDWACTL1+2                                               00808000
SDWASPVA EQU   SDWAMWPA                                                 00809000
SDWAWATA EQU   SDWAMWPA                                                 00810000
SDWAMCKA EQU   SDWAMWPA                                                 00811000
@NM00003 EQU   SDWAMWPA                                                 00812000
SDWAKEYA EQU   SDWAMWPA                                                 00813000
SDWAEXTA EQU   SDWACMKA                                                 00814000
SDWAIOA  EQU   SDWACMKA                                                 00815000
@NM00002 EQU   SDWACMPF                                                 00816000
SDWASTCC EQU   SDWACMPF                                                 00817000
@NM00001 EQU   SDWACMPF                                                 00818000
SDWASTEP EQU   SDWACMPF                                                 00819000
*                                      END UNREFERENCED COMPONENTS      00820000
@ENDDATA EQU   *                                                        00821000
         END   IEFNB9CR                                                 00822000
./  ADD  SSI=33300634,NAME=IEFNB9CT
         TITLE 'CONVERTER ESTAE TERMINATION ROUTINE                    *00001000
                        '                                               00002000
IEFNB9CT CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEFNB9CT  73.331'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
*/* S E T U P  E R E P L  A D D R E S S A B I L I T Y*/            0006 00013000
*                                                                  0006 00014000
*        EREPLPTR=REG1;     /*REGISTER 1 PASSED TO RTNE.     @YM02460*/ 00015000
*                                                                  0006 00016000
         LR    EREPLPTR,REG1                                       0006 00017000
*/* G E T  D U M M Y  S A V E A R E A  */                          0007 00018000
*                                                                  0007 00019000
*        REG0=LENGTH(DUMMYSAV);   /*LENGTH WILL HAVE ZERO          0007 00020000
*                                    HIGH ORDER BYTE THAT WILL SERVE    00021000
*                                    AS SUBPOOL NUMBER. */         0007 00022000
         LA    REG0,72                                             0007 00023000
*        GEN(GETMAIN R,LV=(0));    /*GET SAVEAREA CORE*/           0008 00024000
         GETMAIN R,LV=(0)                                               00025000
*        REG13=REG1;             /*SAVEAREA ADDRESSABILITY*/       0009 00026000
         LR    REG13,REG1                                          0009 00027000
*        DUMMYSAV=''B;        /*ZERO SAVAREA FOR CLARITY.*/        0010 00028000
*                                                                  0010 00029000
         XC    DUMMYSAV(72,REG13),DUMMYSAV(REG13)                  0010 00030000
*/* S E T U P  S A V E A R E A  */                                 0011 00031000
*                                                                  0011 00032000
*        PREVSAVA=EREPLRSV;       /*SAVEAREA PTR FROM EREPL*/      0011 00033000
*                                                                  0011 00034000
         L     @10,EREPLRSV(,EREPLPTR)                             0011 00035000
         ST    @10,PREVSAVA(,REG13)                                0011 00036000
*/* S E T U P  C W A  */                                           0012 00037000
*                                                                  0012 00038000
*        WAPTR=EREPLCWA;         /*CWA PTR FROM EREPL*/            0012 00039000
         L     WAPTR,EREPLCWA(,EREPLPTR)                           0012 00040000
*        IWARET=RETURN36;           /*RETURN CODE FOR CONVERTER*/  0013 00041000
         MVC   IWARET(2,WAPTR),RETURN36                            0013 00042000
*        CWATERM=ON;           /*TURN ON CONVERTER TERM BIT*/      0014 00043000
*                                                                  0014 00044000
         OI    CWATERM(WAPTR),B'00000001'                          0014 00045000
*        IF CWASAVPT Â¬= EREPLRSV THEN  /*IF SAVEAREA POINTERS      0015 00046000
*                                        ARE NOT EQUAL,LOAD THE    0015 00047000
*                                        CWA POINTER FROM THE EREPL*/   00048000
         LA    @05,372                                             0015 00049000
         ALR   @05,WAPTR                                           0015 00050000
         C     @10,CWASAVPT(,@05)                                  0015 00051000
         BE    @RF00015                                            0015 00052000
*         CWASAVPT=EREPLRSV;                                       0016 00053000
*                                                                  0016 00054000
         ST    @10,CWASAVPT(,@05)                                  0016 00055000
*/* S E T U P  T E R M I N A T I O N  R E G I S T E R S  */        0017 00056000
*                                                                  0017 00057000
*/* REGISTER 13 HAS ALREADY BEEN LOADED WITH THE DUMMY SAVEAREA    0017 00058000
*   POINTER. */                                                    0017 00059000
*                                                                  0017 00060000
*        REG12=EREPLCWA;           /*CWA POINTER INTO R12*/        0017 00061000
*                                                                  0017 00062000
@RF00015 L     REG12,EREPLCWA(,EREPLPTR)                           0017 00063000
*/* C A L L  T E R M I N A T I O N  M O D U L E */                 0018 00064000
*                                                                  0018 00065000
*        CALL IEFVHF;              /*TERMINATE CONVERTER*/         0018 00066000
*                                                                  0018 00067000
         L     @15,@CV00306                                        0018 00068000
         BALR  @14,@15                                             0018 00069000
*        END IEFNB9CT                                              0019 00070000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00071000
*/*%INCLUDE SYSLIB  (IEFZB9RD)                                        * 00072000
*/*%INCLUDE SYSLIB  (IEFCOMWA)                                        * 00073000
*/*%INCLUDE SYSLIB  (IEFCVRWA)                                        * 00074000
*;                                                                 0019 00075000
@EL00001 DS    0H                                                  0019 00076000
@EF00001 DS    0H                                                  0019 00077000
@ER00001 BR    @14                                                 0019 00078000
@DATA    DS    0H                                                       00079000
@DATD    DSECT                                                          00080000
         DS    0F                                                       00081000
IEFNB9CT CSECT                                                          00082000
         DS    0F                                                       00083000
@DATD    DSECT                                                          00084000
         DS    0D                                                       00085000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00086000
@ENDDATD EQU   *                                                        00087000
IEFNB9CT CSECT                                                          00088000
         DS    0F                                                       00089000
@SIZDATD DC    AL1(0)                                                   00090000
         DC    AL3(@ENDDATD-@DATD)                                      00091000
@CV00306 DC    V(IEFVHF)                                                00092000
         DS    0D                                                       00093000
NBCTPTCH DS    CL25                                                     00094000
         ORG   NBCTPTCH                                                 00095000
@NM00032 DC    25X'00'                                                  00096000
         ORG   NBCTPTCH+25                                              00097000
RETURN36 DC    X'0024'                                                  00098000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00099000
@01      EQU   01                                                       00100000
@02      EQU   02                                                       00101000
@03      EQU   03                                                       00102000
@04      EQU   04                                                       00103000
@05      EQU   05                                                       00104000
@06      EQU   06                                                       00105000
@07      EQU   07                                                       00106000
@08      EQU   08                                                       00107000
@09      EQU   09                                                       00108000
@10      EQU   10                                                       00109000
@11      EQU   11                                                       00110000
@12      EQU   12                                                       00111000
@13      EQU   13                                                       00112000
@14      EQU   14                                                       00113000
@15      EQU   15                                                       00114000
EREPLPTR EQU   @03                                                      00115000
WAPTR    EQU   @04                                                      00116000
REG0     EQU   @00                                                      00117000
REG1     EQU   @01                                                      00118000
REG12    EQU   @12                                                      00119000
REG13    EQU   @13                                                      00120000
EREPL    EQU   0                                                        00121000
EREPLCWA EQU   EREPL                                                    00122000
EREPLRSV EQU   EREPL+8                                                  00123000
EREPFLGS EQU   EREPL+12                                                 00124000
EREPFLG1 EQU   EREPFLGS                                                 00125000
COMWA    EQU   0                                                        00126000
CWAL     EQU   COMWA                                                    00127000
CWAID    EQU   COMWA+4                                                  00128000
CWACONID EQU   COMWA+8                                                  00129000
IWAIOSA  EQU   COMWA+88                                                 00130000
WARPL    EQU   COMWA+160                                                00131000
CWARET   EQU   COMWA+344                                                00132000
IWARET   EQU   CWARET                                                   00133000
CWAMCSCA EQU   COMWA+346                                                00134000
CWAMSLEN EQU   COMWA+360                                                00135000
AOSW1    EQU   COMWA+361                                                00136000
AOSW4    EQU   COMWA+362                                                00137000
CWATERM  EQU   AOSW4                                                    00138000
SWE      EQU   COMWA+363                                                00139000
SWH      EQU   COMWA+364                                                00140000
SWI      EQU   COMWA+365                                                00141000
SWY2     EQU   COMWA+366                                                00142000
CVRWA    EQU   0                                                        00143000
IWAINTS4 EQU   CVRWA+8                                                  00144000
RSTMT    EQU   CVRWA+20                                                 00145000
VERB     EQU   RSTMT+4                                                  00146000
PSTMT    EQU   CVRWA+28                                                 00147000
VERBP    EQU   PSTMT+4                                                  00148000
AOKSCHSA EQU   CVRWA+304                                                00149000
CWASAVPT EQU   CVRWA+380                                                00150000
AOKSRPRM EQU   CVRWA+403                                                00151000
AOSW2    EQU   CVRWA+417                                                00152000
AOSW3    EQU   CVRWA+418                                                00153000
IWAEXTS  EQU   CVRWA+420                                                00154000
SWA      EQU   CVRWA+425                                                00155000
SWB      EQU   CVRWA+426                                                00156000
SWC      EQU   CVRWA+427                                                00157000
SWD      EQU   CVRWA+428                                                00158000
SWV      EQU   CVRWA+429                                                00159000
CRSW1    EQU   CVRWA+430                                                00160000
SWZ      EQU   CVRWA+438                                                00161000
DUMMYSAV EQU   0                                                        00162000
PREVSAVA EQU   DUMMYSAV+4                                               00163000
*                                      START UNREFERENCED COMPONENTS    00164000
@NM00034 EQU   DUMMYSAV+8                                               00165000
@NM00033 EQU   DUMMYSAV                                                 00166000
CWAPSENM EQU   CVRWA+448                                                00167000
CWALINKL EQU   CVRWA+444                                                00168000
CWALINK  EQU   CVRWA+440                                                00169000
RCHAR1   EQU   CVRWA+439                                                00170000
SNPSW    EQU   SWZ                                                      00171000
DDSW     EQU   SWZ                                                      00172000
EXECSW   EQU   SWZ                                                      00173000
JOBSW    EQU   SWZ                                                      00174000
COLST    EQU   SWZ                                                      00175000
ENDS     EQU   SWZ                                                      00176000
DDOV     EQU   SWZ                                                      00177000
CMT      EQU   SWZ                                                      00178000
SWY      EQU   CVRWA+437                                                00179000
IWANELEN EQU   CVRWA+436                                                00180000
SYMTTR   EQU   CVRWA+432                                                00181000
@NM00031 EQU   CVRWA+431                                                00182000
@NM00030 EQU   CRSW1                                                    00183000
CRRES1   EQU   CRSW1                                                    00184000
@NM00029 EQU   CRSW1                                                    00185000
CPFLG    EQU   CRSW1                                                    00186000
LPBYSW   EQU   SWV                                                      00187000
FPRNSW   EQU   SWV                                                      00188000
FBLITRL  EQU   SWV                                                      00189000
AMPSW    EQU   SWV                                                      00190000
FBFLUSH  EQU   SWV                                                      00191000
VERBCSW  EQU   SWV                                                      00192000
PROCERR  EQU   SWV                                                      00193000
OVKEYSW  EQU   SWV                                                      00194000
SYMPRC   EQU   SWD                                                      00195000
@NM00028 EQU   SWD                                                      00196000
FEXRCV   EQU   SWD                                                      00197000
@NM00027 EQU   SWD                                                      00198000
@NM00026 EQU   SWC                                                      00199000
PEXP     EQU   SWC                                                      00200000
NRCV     EQU   SWC                                                      00201000
IOERR    EQU   SWC                                                      00202000
@NM00025 EQU   SWC                                                      00203000
@NM00024 EQU   SWB                                                      00204000
FRCV     EQU   SWB                                                      00205000
@NM00023 EQU   SWB                                                      00206000
CXPC     EQU   SWB                                                      00207000
CXPN     EQU   SWB                                                      00208000
CXP      EQU   SWB                                                      00209000
@NM00022 EQU   SWA                                                      00210000
EOFR     EQU   SWA                                                      00211000
@NM00021 EQU   SWA                                                      00212000
JHS      EQU   SWA                                                      00213000
JTOP     EQU   SWA                                                      00214000
OSW2     EQU   CVRWA+424                                                00215000
IWAFINDP EQU   CVRWA+421                                                00216000
@NM00020 EQU   IWAEXTS                                                  00217000
IWASFIND EQU   IWAEXTS                                                  00218000
@NM00019 EQU   IWAEXTS                                                  00219000
AOFDPCL  EQU   CVRWA+419                                                00220000
AOBTCHSW EQU   AOSW3                                                    00221000
@NM00018 EQU   AOSW3                                                    00222000
@NM00017 EQU   AOSW2                                                    00223000
AOPROCNM EQU   AOSW2                                                    00224000
@NM00016 EQU   AOSW2                                                    00225000
IWAJMSGL EQU   CVRWA+416                                                00226000
CWACHIDL EQU   CVRWA+415                                                00227000
IWAWRNMS EQU   CVRWA+414                                                00228000
AOSTRLTH EQU   CVRWA+412                                                00229000
LASLE    EQU   CVRWA+410                                                00230000
CURLE    EQU   CVRWA+408                                                00231000
IWANLRC  EQU   CVRWA+406                                                00232000
AOKSRBY3 EQU   AOKSRPRM+2                                               00233000
AOKSRSCT EQU   AOKSRPRM+1                                               00234000
AOKSRNBR EQU   AOKSRPRM                                                 00235000
IWABPAM  EQU   CVRWA+400                                                00236000
AOSCHKYS EQU   CVRWA+392                                                00237000
AOFDPCSV EQU   CVRWA+384                                                00238000
AOBSKSA  EQU   CVRWA+376                                                00239000
AODFLTSA EQU   CVRWA+348                                                00240000
AOHEBSA  EQU   CVRWA+344                                                00241000
AOKSR1SA EQU   CVRWA+336                                                00242000
AOGACSA  EQU   AOKSCHSA                                                 00243000
AOFDTMP1 EQU   CVRWA+300                                                00244000
AODSPCSA EQU   CVRWA+296                                                00245000
TENDP    EQU   CVRWA+292                                                00246000
TLENP    EQU   CVRWA+288                                                00247000
TNUMP    EQU   CVRWA+284                                                00248000
TKEYP    EQU   CVRWA+280                                                00249000
TBEGP    EQU   CVRWA+276                                                00250000
IWANELJC EQU   CVRWA+272                                                00251000
CWAJMRPT EQU   CVRWA+268                                                00252000
IWASTAPL EQU   CVRWA+264                                                00253000
IWAWKBF  EQU   CVRWA+260                                                00254000
IWAJOBS5 EQU   CVRWA+256                                                00255000
DREFB    EQU   CVRWA+80                                                 00256000
IWAPARM  EQU   CVRWA+76                                                 00257000
PPSN     EQU   CVRWA+68                                                 00258000
RSNM     EQU   CVRWA+60                                                 00259000
RDNM     EQU   CVRWA+52                                                 00260000
PSNM     EQU   CVRWA+44                                                 00261000
PDNM     EQU   CVRWA+36                                                 00262000
@NM00015 EQU   PSTMT+7                                                  00263000
LISTPTRP EQU   PSTMT+6                                                  00264000
NAMELP   EQU   PSTMT+5                                                  00265000
@NM00014 EQU   VERBP                                                    00266000
CREP     EQU   VERBP                                                    00267000
SSEP     EQU   VERBP                                                    00268000
STMTPTRP EQU   PSTMT                                                    00269000
@NM00013 EQU   RSTMT+7                                                  00270000
LISTPTR  EQU   RSTMT+6                                                  00271000
NAMEL    EQU   RSTMT+5                                                  00272000
@NM00012 EQU   VERB                                                     00273000
CRE      EQU   VERB                                                     00274000
SSE      EQU   VERB                                                     00275000
RSTMTPTR EQU   RSTMT                                                    00276000
CWATXTEX EQU   CVRWA+16                                                 00277000
IWAINTS5 EQU   CVRWA+12                                                 00278000
CWABPROC EQU   IWAINTS4                                                 00279000
IWAINTS3 EQU   CVRWA+4                                                  00280000
PDCBP    EQU   CVRWA                                                    00281000
RBYTE5   EQU   COMWA+371                                                00282000
RBYTE4   EQU   COMWA+370                                                00283000
RBYTE3   EQU   COMWA+369                                                00284000
RBYTE2   EQU   COMWA+368                                                00285000
RBYTE1   EQU   COMWA+367                                                00286000
@NM00011 EQU   SWY2                                                     00287000
KEYNXTSW EQU   SWY2                                                     00288000
DYNAMSW  EQU   SWY2                                                     00289000
@NM00010 EQU   SWY2                                                     00290000
@NM00009 EQU   SWI                                                      00291000
DSNLIT   EQU   SWI                                                      00292000
BLKMLTER EQU   SWI                                                      00293000
@NM00008 EQU   SWI                                                      00294000
IWADDNM  EQU   SWI                                                      00295000
WAWRNWTO EQU   SWI                                                      00296000
BLKPRC   EQU   SWI                                                      00297000
@NM00007 EQU   SWH                                                      00298000
CPSTPFL  EQU   SWH                                                      00299000
PROCSW   EQU   SWH                                                      00300000
CPFLGXX  EQU   SWH                                                      00301000
CPSYSFLG EQU   SWH                                                      00302000
@NM00006 EQU   SWH                                                      00303000
SEQUENCE EQU   SWE                                                      00304000
POVRX    EQU   SWE                                                      00305000
POVRD    EQU   SWE                                                      00306000
CONCAT   EQU   SWE                                                      00307000
PRCV     EQU   SWE                                                      00308000
PREF     EQU   SWE                                                      00309000
GPI      EQU   SWE                                                      00310000
PROCPLS  EQU   SWE                                                      00311000
@NM00005 EQU   AOSW4                                                    00312000
AOTXTWRT EQU   AOSW1                                                    00313000
AOPRTSW  EQU   AOSW1                                                    00314000
AONOPLIB EQU   AOSW1                                                    00315000
AOILGLOP EQU   AOSW1                                                    00316000
AOIOERR  EQU   AOSW1                                                    00317000
AOVFBSW  EQU   AOSW1                                                    00318000
AOENDKSW EQU   AOSW1                                                    00319000
AOFSTPOS EQU   AOSW1                                                    00320000
IWAMSLEN EQU   CWAMSLEN                                                 00321000
RHALF5   EQU   COMWA+358                                                00322000
RHALF4   EQU   COMWA+356                                                00323000
RHALF3   EQU   COMWA+354                                                00324000
RHALF2   EQU   COMWA+352                                                00325000
RHALF1   EQU   COMWA+350                                                00326000
WASTMTNO EQU   COMWA+348                                                00327000
CWALABEL EQU   CWAMCSCA+1                                               00328000
IWAMCSCA EQU   CWAMCSCA                                                 00329000
RFULL5   EQU   COMWA+340                                                00330000
RFULL4   EQU   COMWA+336                                                00331000
RFULL3   EQU   COMWA+332                                                00332000
RFULL2   EQU   COMWA+328                                                00333000
RFULL1   EQU   COMWA+324                                                00334000
WAEXCPFX EQU   COMWA+316                                                00335000
WAJOBPFX EQU   COMWA+308                                                00336000
WAJBNAME EQU   COMWA+300                                                00337000
WAEXCRBA EQU   COMWA+292                                                00338000
WAJOBRBA EQU   COMWA+284                                                00339000
QPARM    EQU   COMWA+248                                                00340000
WAWRKLTH EQU   COMWA+244                                                00341000
WAMSGBUF EQU   COMWA+240                                                00342000
WANELPTR EQU   COMWA+236                                                00343000
RPLADDR  EQU   WARPL                                                    00344000
@NM00004 EQU   IWAIOSA+8                                                00345000
IWASACHN EQU   IWAIOSA+4                                                00346000
TRSAVE   EQU   IWAIOSA                                                  00347000
AOEPWORK EQU   COMWA+80                                                 00348000
AOSTAPRM EQU   COMWA+76                                                 00349000
AOJMRGEP EQU   COMWA+72                                                 00350000
NEXTPTR  EQU   COMWA+68                                                 00351000
BUFEND   EQU   COMWA+64                                                 00352000
BUFADDR  EQU   COMWA+60                                                 00353000
AOWSTMT  EQU   COMWA+56                                                 00354000
TERMRTN  EQU   COMWA+52                                                 00355000
TBUFCOPY EQU   COMWA+48                                                 00356000
TEXTBUFP EQU   COMWA+44                                                 00357000
JACTLPTR EQU   COMWA+40                                                 00358000
TNEXT2   EQU   COMWA+36                                                 00359000
TNEXT    EQU   COMWA+32                                                 00360000
IWAINTS0 EQU   COMWA+28                                                 00361000
QMGRP    EQU   COMWA+24                                                 00362000
CTRLWAP  EQU   COMWA+20                                                 00363000
SAVEPTR  EQU   COMWA+16                                                 00364000
QPARMP   EQU   COMWA+12                                                 00365000
IWACONID EQU   CWACONID                                                 00366000
IWAID    EQU   CWAID                                                    00367000
IWAL     EQU   CWAL                                                     00368000
@NM00003 EQU   EREPL+16                                                 00369000
@NM00002 EQU   EREPFLGS+1                                               00370000
@NM00001 EQU   EREPFLG1                                                 00371000
EREPRCUR EQU   EREPFLG1                                                 00372000
EREPLIWA EQU   EREPL+4                                                  00373000
*                                      END UNREFERENCED COMPONENTS      00374000
@ENDDATA EQU   *                                                        00375000
         END   IEFNB9CT                                                 00376000
./  ADD  SSI=33300636,NAME=IEFNB9IR
         TITLE 'INTERPRETER ESTAE RECOVERY ROUTINE                     *00001000
                        '                                               00002000
IEFNB9IR CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEFNB9IR  73.331'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   SAVER14=REG14;                  /* SAVE REGISTER 14 ON ENTRY     */ 00013000
         LR    SAVER14,REG14                                       0007 00014000
*/* IF REGISTER 0 HAS A CODE OF 12 IN IT,THEN AN SDWA IS NOT       0008 00015000
*   AVAILABLE.IN THIS CASE NO PROCESSING IS DONE BECAUSE THE       0008 00016000
*   ABEND,OR PROBLEM ENCOUNTERED CANNOT BE HANDLED PROPERLY.         */ 00017000
*                                                                  0008 00018000
*   IF REG0Â¬=TWELVE THEN                                           0008 00019000
         SLR   @15,@15                                             0008 00020000
         IC    @15,TWELVE                                          0008 00021000
         CR    REG0,@15                                            0008 00022000
         BE    @RF00008                                            0008 00023000
*     DO;                                                          0009 00024000
*       SDWAPTR=REG1;               /* SET UP PTR TO WORK AREA       */ 00025000
         LR    SDWAPTR,REG1                                        0010 00026000
*       EREPLPTR=SDWAPARM;          /* PTR TO USER PARAMETERS        */ 00027000
         L     EREPLPTR,SDWAPARM(,SDWAPTR)                         0011 00028000
*/* INITIALIZE RECORD AREA IN SDWA WITH PERTINENT INFORMATION        */ 00029000
*                                                                  0012 00030000
*       SDWAREXN=RTNAME;            /* MOVE EXIT NAME TO SDWA        */ 00031000
         MVC   SDWAREXN(8,SDWAPTR),RTNAME                          0012 00032000
*       SDWAMODN=BLANK8;            /* BLANK MODULE NAME INVOLVED    */ 00033000
         MVC   SDWAMODN(8,SDWAPTR),BLANK8                          0013 00034000
*       SDWACSCT=BLANK8;            /* BLANK CSECT NAME INVOLVED     */ 00035000
         MVC   SDWACSCT(8,SDWAPTR),BLANK8                          0014 00036000
*/* SET UP TO INITIALIZE DUMP FUNCTION                               */ 00037000
*                                                                  0015 00038000
*       REG0=LENDUMP;               /* LENGTH OF DUMP LIST WITH HIGH    00039000
*                                      ORDER BYTE OF ZERO SERVING AS    00040000
*                                      SUBPOOL NUMBER                */ 00041000
         L     REG0,LENDUMP                                        0015 00042000
*       GEN(GETMAIN R,LV=(0));      /* GET CORE FOR DUMP LIST        */ 00043000
         GETMAIN R,LV=(0)                                               00044000
*       DUMPLIST=REG1;              /* POINTER TO CORE FOR LIST      */ 00045000
         LR    DUMPLIST,REG1                                       0017 00046000
*/* MOVE DUMP LIST FROM CSECT TO GOTTEN CORE FOR EXECUTE FORMAT      */ 00047000
*                                                                  0018 00048000
*       DUMPCORE(1:LENDUMP)=DUMPMAC(1:LENDUMP);                    0018 00049000
*                                                                  0018 00050000
         L     @15,LENDUMP                                         0018 00051000
         BCTR  @15,0                                               0018 00052000
         EX    @15,@SM00468                                        0018 00053000
*/* DUMP FUNCTION IS NOW INITIALIZED AND READY FOR SDUMP ISSUANCE    */ 00054000
*                                                                  0019 00055000
*                                                                  0019 00056000
*/*P E R C O L A T I O N                                             */ 00057000
*                                                                  0019 00058000
*       IF SDWAPERC=ON THEN         /* WAS THIS ROUTINE PERCOLATED 0019 00059000
*                                      TO?                           */ 00060000
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0019 00061000
         BNO   @RF00019                                            0019 00062000
*/* ISSUE SETRP MACRO FOR PERCOLATION AND RETURN                     */ 00063000
*                                                                  0020 00064000
*         DO;                       /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00065000
*                                      RC(0) RECORD(NO)              */ 00066000
*           RESPECIFY                                              0021 00067000
*            (GPR00P,                                              0021 00068000
*             GPR01P,                                              0021 00069000
*             GPR14P,                                              0021 00070000
*             GPR15P) RSTD;                                        0021 00071000
*           GPR01P=SDWAPTR;                                        0022 00072000
         LR    GPR01P,SDWAPTR                                      0022 00073000
*           GPR01P->SDWARCDE=0;     /* SAVE RC VALUE                 */ 00074000
         MVI   SDWARCDE(GPR01P),X'00'                              0023 00075000
*           GPR01P->SDWARCRD='0'B;  /* TURN OFF RECORD INDICATOR     */ 00076000
         NI    SDWARCRD(GPR01P),B'01111111'                        0024 00077000
*           GPR01P->SDWAREQ='0'B;   /* TURN OFF DUMP INDICATOR       */ 00078000
         NI    SDWAREQ(GPR01P),B'01111111'                         0025 00079000
*           RESPECIFY                                              0026 00080000
*            (GPR00P,                                              0026 00081000
*             GPR01P,                                              0026 00082000
*             GPR14P,                                              0026 00083000
*             GPR15P) UNRSTD;                                      0026 00084000
*         END;                                                     0027 00085000
*       ELSE                        /* NO,CONTINUE PROCESSING        */ 00086000
*         DO;                                                      0028 00087000
         B     @RC00019                                            0028 00088000
@RF00019 DS    0H                                                  0029 00089000
*                                                                  0029 00090000
*/* R E C U R S I O N                                                */ 00091000
*                                                                  0029 00092000
*           IF EREPRCUR=ON THEN     /* RECURSION WITHIN ESTAE      0029 00093000
*                                      ENVIRONMENT?                  */ 00094000
         TM    EREPRCUR(EREPLPTR),B'10000000'                      0029 00095000
         BNO   @RF00029                                            0029 00096000
*/* ISSUE SETRP MACRO FOR RECURSION AND RETURN                       */ 00097000
*                                                                  0030 00098000
*             DO;                   /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00099000
*                                      RC(0) RECORD(YES)             */ 00100000
*               RESPECIFY                                          0031 00101000
*                (GPR00P,                                          0031 00102000
*                 GPR01P,                                          0031 00103000
*                 GPR14P,                                          0031 00104000
*                 GPR15P) RSTD;                                    0031 00105000
*               GPR01P=SDWAPTR;                                    0032 00106000
         LR    GPR01P,SDWAPTR                                      0032 00107000
*               GPR01P->SDWARCDE=0; /* SAVE RC VALUE                 */ 00108000
         MVI   SDWARCDE(GPR01P),X'00'                              0033 00109000
*               GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR    */ 00110000
         OI    SDWARCRD(GPR01P),B'10000000'                        0034 00111000
*               GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP INDICATOR      */ 00112000
         NI    SDWAREQ(GPR01P),B'01111111'                         0035 00113000
*               RESPECIFY                                          0036 00114000
*                (GPR00P,                                          0036 00115000
*                 GPR01P,                                          0036 00116000
*                 GPR14P,                                          0036 00117000
*                 GPR15P) UNRSTD;                                  0036 00118000
*             END;                                                 0037 00119000
*           ELSE                                                   0038 00120000
*                                                                  0038 00121000
*/*      TURN ON THE RECURSION BIT IN THE USER AREA.THIS WILL      0038 00122000
*        SIGNAL THAT AN ABEND OCCURRED DURING RECOVERY PROCESSING    */ 00123000
*                                                                  0038 00124000
*             DO;                                                  0038 00125000
         B     @RC00029                                            0038 00126000
@RF00029 DS    0H                                                  0039 00127000
*               EREPRCUR=ON;        /* TURN ON RECURSION BIT       0039 00128000
*                                                                    */ 00129000
         OI    EREPRCUR(EREPLPTR),B'10000000'                      0039 00130000
*                                                                  0040 00131000
*/*R E S T A R T  I N T E R R U P T                                  */ 00132000
*                                                                  0040 00133000
*               IF SDWARKEY=ON THEN /* EXTERNAL INTERRUPT SIGNALLING    00134000
*                                      RESTART                       */ 00135000
         TM    SDWARKEY(SDWAPTR),B'00100000'                       0040 00136000
         BNO   @RF00040                                            0040 00137000
*                 DO;                                              0041 00138000
*                                                                  0041 00139000
*/* ISSUE SETRP MACRO FOR RESTART INTERRUPT                          */ 00140000
*                                                                  0042 00141000
*                   DO;             /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00142000
*                                      RC(0) RECORD(YES)             */ 00143000
*                     RESPECIFY                                    0043 00144000
*                      (GPR00P,                                    0043 00145000
*                       GPR01P,                                    0043 00146000
*                       GPR14P,                                    0043 00147000
*                       GPR15P) RSTD;                              0043 00148000
*                     GPR01P=SDWAPTR;                              0044 00149000
         LR    GPR01P,SDWAPTR                                      0044 00150000
*                     GPR01P->SDWARCDE=0;/* SAVE RC VALUE            */ 00151000
         MVI   SDWARCDE(GPR01P),X'00'                              0045 00152000
*                     GPR01P->SDWARCRD='1'B;/* TURN ON RECORD      0046 00153000
*                                      INDICATOR                     */ 00154000
         OI    SDWARCRD(GPR01P),B'10000000'                        0046 00155000
*                     GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP INDICATOR*/ 00156000
         NI    SDWAREQ(GPR01P),B'01111111'                         0047 00157000
*                     RESPECIFY                                    0048 00158000
*                      (GPR00P,                                    0048 00159000
*                       GPR01P,                                    0048 00160000
*                       GPR14P,                                    0048 00161000
*                       GPR15P) UNRSTD;                            0048 00162000
*                   END;                                           0049 00163000
*                   RESPECIFY                                      0050 00164000
*                     SDWA BASED(SDWAPTR);                         0050 00165000
*                                                                  0050 00166000
*/* ISSUE SDUMP FOR DEBUGGING PURPOSES AND RETURN                    */ 00167000
*                                                                  0051 00168000
*                   GEN;                                           0051 00169000
        SDUMP HDR='RESTART INTERRUPT IN INTERPRETER**IEFNB9IR**',MF=(E,,00170000
               (9))                                                     00171000
*                 END;                                             0052 00172000
*               ELSE                /* NO CONTINUE PROCESSING        */ 00173000
*                 DO;                                              0053 00174000
         B     @RC00040                                            0053 00175000
@RF00040 DS    0H                                                  0054 00176000
*                                                                  0054 00177000
*/* U N E X P E C T E D  E R R O R S                                 */ 00178000
*/* ONLY THE 0B0 ABEND AND PROGRAM CHECKS ARE EXPECTED ERRORS FOR  0054 00179000
*   THIS RECOVERY ROUTINE.IF IT IS NEITHER,THEN THE SETRP IS       0054 00180000
*   ISSUED AND A RETURN IS MADE.                                     */ 00181000
*                                                                  0054 00182000
*                   IF(SDWACMPCÂ¬=ZEROB0)&(SDWAPCHK=OFF) THEN       0054 00183000
*                                                                  0054 00184000
         CLC   SDWACMPC(3,SDWAPTR),ZEROB0                          0054 00185000
         BE    @RF00054                                            0054 00186000
         TM    SDWAPCHK(SDWAPTR),B'01000000'                       0054 00187000
         BNZ   @RF00054                                            0054 00188000
*/* ISSUE SETRP AND ERROR MESSAGE FOR UNEXPECTED ERRORS              */ 00189000
*                                                                  0055 00190000
*                     DO;           /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00191000
*                                      RC(0) RECORD(YES)             */ 00192000
*                       RESPECIFY                                  0056 00193000
*                        (GPR00P,                                  0056 00194000
*                         GPR01P,                                  0056 00195000
*                         GPR14P,                                  0056 00196000
*                         GPR15P) RSTD;                            0056 00197000
*                       GPR01P=SDWAPTR;                            0057 00198000
         LR    GPR01P,SDWAPTR                                      0057 00199000
*                       GPR01P->SDWARCDE=0;/* SAVE RC VALUE          */ 00200000
         MVI   SDWARCDE(GPR01P),X'00'                              0058 00201000
*                       GPR01P->SDWARCRD='1'B;/* TURN ON RECORD    0059 00202000
*                                      INDICATOR                     */ 00203000
         OI    SDWARCRD(GPR01P),B'10000000'                        0059 00204000
*                       GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP      0060 00205000
*                                      INDICATOR                     */ 00206000
         NI    SDWAREQ(GPR01P),B'01111111'                         0060 00207000
*                       RESPECIFY                                  0061 00208000
*                        (GPR00P,                                  0061 00209000
*                         GPR01P,                                  0061 00210000
*                         GPR14P,                                  0061 00211000
*                         GPR15P) UNRSTD;                          0061 00212000
*                     END;                                         0062 00213000
*                   ELSE                                           0063 00214000
*                                                                  0063 00215000
*/* 0 B 0  ABEND , E X P E C T E D  E R R O R S                      */ 00216000
*                                                                  0063 00217000
*                     DO;                                          0063 00218000
         B     @RC00054                                            0063 00219000
@RF00054 DS    0H                                                  0064 00220000
*                       RESPECIFY                                  0064 00221000
*                        (REG4,                                    0064 00222000
*                         COUNT,                                   0064 00223000
*                         REG6,                                    0064 00224000
*                         REG7) RSTD;                              0064 00225000
*                                                                  0064 00226000
*/* ISSUE SETRP MACRO FOR EXPECTED ERRORS @YM02460                   */ 00227000
*                                                                  0065 00228000
*                       DO;         /* SETRP WKAREA(SDWAPTR) DUMP(NO)   00229000
*                                      RC(4) FRESDWA(YES) RECORD(YES)   00230000
*                                      RETADDR(IEFNB9IT)             */ 00231000
*                         RESPECIFY                                0066 00232000
*                          (GPR00P,                                0066 00233000
*                           GPR01P,                                0066 00234000
*                           GPR14P,                                0066 00235000
*                           GPR15P) RSTD;                          0066 00236000
*                         GPR01P=SDWAPTR;                          0067 00237000
         LR    GPR01P,SDWAPTR                                      0067 00238000
*                         GPR01P->SDWARCDE=4;/* STORE RC INTO SDWA   */ 00239000
         MVI   SDWARCDE(GPR01P),X'04'                              0068 00240000
*                         GPR01P->SDWARTYA=ADDR(IEFNB9IT);/* SAVE  0069 00241000
*                                      RETRY ADDRESS                 */ 00242000
         L     @11,@CV00422                                        0069 00243000
         ST    @11,SDWARTYA(,GPR01P)                               0069 00244000
*                         GPR01P->SDWAFREE='1'B;/* SET FLAG TO FREE     00245000
*                                      SDWA                          */ 00246000
*                         GPR01P->SDWARCRD='1'B;/* TURN ON RECORD  0071 00247000
*                                      INDICATOR                     */ 00248000
         OI    SDWAFREE(GPR01P),B'10000100'                        0071 00249000
*                         GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP    0072 00250000
*                                      INDICATOR                     */ 00251000
         NI    SDWAREQ(GPR01P),B'01111111'                         0072 00252000
*                         RESPECIFY                                0073 00253000
*                          (GPR00P,                                0073 00254000
*                           GPR01P,                                0073 00255000
*                           GPR14P,                                0073 00256000
*                           GPR15P) UNRSTD;                        0073 00257000
*                       END;                                       0074 00258000
*                       RESPECIFY                                  0075 00259000
*                         SDWA BASED(SDWAPTR);                     0075 00260000
*                                                                  0075 00261000
*/* ISSUE SDUMP FOR DEBUGGING PURPOSES                               */ 00262000
*                                                                  0076 00263000
*                       GEN                                        0076 00264000
*(SDUMP HDR='EXPECTED INTERPRETER ABEND**IEFNB9IR**',MF=(E,(9)));  0076 00265000
         SDUMP HDR='EXPECTED INTERPRETER ABEND**IEFNB9IR**',MF=(E,(9))  00266000
*                     END;                                         0077 00267000
*                                                                  0078 00268000
*/* I S S U E  E R R O R  M S G.  I E F 6 8 3 I                      */ 00269000
*/* CORE MUST BE GOTTEN FOR THE LIST FORM OF THE WRITE TO OPERATOR 0078 00270000
*   PARAMETER LIST.IT IS REQUESTED IN SUBPOOL ZERO.                  */ 00271000
*                                                                  0078 00272000
*                   REG0=WTOLEN;    /* ADCON FOR THE LENGTH OF THE 0078 00273000
*                                      LIST ALSO HAS A ZERO HIGH   0078 00274000
*                                      ORDER BYTE THAT SERVES AS   0078 00275000
*                                      SUBPOOL NUMBER.               */ 00276000
@RC00054 L     REG0,WTOLEN                                         0078 00277000
*                   GEN(GETMAIN R,LV=(0));/* GET CORE FOR LIST       */ 00278000
         GETMAIN R,LV=(0)                                               00279000
*                   REG4=REG1;      /* SETUP ADDRESSABILITY TO LIST  */ 00280000
         LR    REG4,REG1                                           0080 00281000
*/* THE MESSAGE LIST DEFINED IN THE CSECT MUST BE MOVED INTO THE   0081 00282000
*   GOTTEN CORE.                                                     */ 00283000
*                                                                  0081 00284000
*                   WTOCORE(1:WTOLEN)=WTOCSECT(1:WTOLEN);          0081 00285000
*                                                                  0081 00286000
         L     @15,WTOLEN                                          0081 00287000
         BCTR  @15,0                                               0081 00288000
         EX    @15,@SM00472                                        0081 00289000
*/* THE THREE 4 BIT DIGITS OF THE COMPLETION CODE ARE PLACED INTO THE   00290000
*   THREE BYTE COMPLETION CODE FIELD IN THE MESSAGE.THE 4 BIT CHARACT-  00291000
*   ERS ARE TRANSLATED INTO 8 BIT PRINTABLE CHARACTERS WITHIN THE  0082 00292000
*   MESSAGE ITSELF.THEN THE MESSAGE IS ISSUED.                       */ 00293000
*                                                                  0082 00294000
*                   REG7=SDWAABCC;  /* ABEND CODE TO LIST            */ 00295000
         L     REG7,SDWAABCC(,SDWAPTR)                             0082 00296000
*                   GEN(SLL REG7,8(0));                            0083 00297000
         SLL REG7,8(0)                                                  00298000
*                   DO COUNT=0 TO 2;/* TRANSLATE ABEND CODE INTO MSG */ 00299000
         SLR   COUNT,COUNT                                         0084 00300000
@DL00084 DS    0H                                                  0085 00301000
*                     GEN CODE REFS(COUNT,CHARSTRG);               0085 00302000
       SR    REG6,REG6     ZERO REG6 FOR NEXT CHARACTER.                00303000
       SLDL  REG6,4(0)     SHIFT THE 4 BIT MEMBER OF CODE INTO REG6     00304000
       IC    REG6,CHARSTRG(REG6)      PICK PRINTABLE CHARACTER          00305000
       STC   REG6,43(COUNT,REG4)     INSERT INTO MESSAGE TO PRINT       00306000
*                   END;                                           0086 00307000
*                                                                  0086 00308000
         AH    COUNT,@CH00040                                      0086 00309000
         CH    COUNT,@CH00061                                      0086 00310000
         BNH   @DL00084                                            0086 00311000
*/* ISSUE THE WRITE TO OPERATOR MESSAGE DESCRIBING ABEND.            */ 00312000
*                                                                  0087 00313000
*                   GEN(WTO MF=(E,(4)));                           0087 00314000
*                                                                  0087 00315000
         WTO MF=(E,(4))                                                 00316000
*/* FREE THE CORE GOTTEN FOR THE WTO LIST.                           */ 00317000
*                                                                  0088 00318000
*                   REG0=WTOLEN;    /* LENGTH AND SUBPOOL NUMBER     */ 00319000
         L     REG0,WTOLEN                                         0088 00320000
*                   REG1=REG4;      /* ADDRESS OF WTO LIST           */ 00321000
         LR    REG1,REG4                                           0089 00322000
*                   GEN(FREEMAIN R,LV=(0),A=(1));/* FREE CORE        */ 00323000
         FREEMAIN R,LV=(0),A=(1)                                        00324000
*                   RESPECIFY                                      0091 00325000
*                    (REG4,                                        0091 00326000
*                     COUNT,                                       0091 00327000
*                     REG6,                                        0091 00328000
*                     REG7) UNRSTD;                                0091 00329000
*                 END;                                             0092 00330000
*             END;                                                 0093 00331000
@RC00040 DS    0H                                                  0094 00332000
*         END;                                                     0094 00333000
@RC00029 DS    0H                                                  0095 00334000
*                                                                  0095 00335000
*/* FREE THE GOTTEN DUMP LIST                                        */ 00336000
*                                                                  0095 00337000
*       REG0=LENDUMP;               /* LENGTH OF DUMP LIST WITH HIGH    00338000
*                                      ORDER BYTE OF ZERO SERVING AS    00339000
*                                      SUBPOOL NUMBER                */ 00340000
@RC00019 L     REG0,LENDUMP                                        0095 00341000
*       REG1=DUMPLIST;              /* ADDRESS OF DUMP LIST IN CORE  */ 00342000
         LR    REG1,DUMPLIST                                       0096 00343000
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE CORE                */ 00344000
         FREEMAIN R,LV=(0),A=(1)                                        00345000
*     END;                                                         0098 00346000
*                                                                  0098 00347000
*/* SET UP TO RETURN                                                 */ 00348000
*                                                                  0099 00349000
*   REG14=SAVER14;                  /* RESTORE REGISTER 14 TO RETURN    00350000
*                                      TO RTM                        */ 00351000
@RF00008 LR    REG14,SAVER14                                       0099 00352000
*/* RETURN CODE OF ZERO IS ALWAYS PASSED BACK IN REGISTER 15.      0100 00353000
*   UNDER NORMAL CONDITIONS RTM IGNORES REGISTER 15.IF NO SDWA     0100 00354000
*   WAS PASSED ,REGISTER 15 WITH A ZERO CODE SIGNALS NO RETRY        */ 00355000
*                                                                  0100 00356000
*   RETURN CODE(0);                                                0100 00357000
         SLR   @15,@15                                             0100 00358000
@EL00001 DS    0H                                                  0100 00359000
@EF00001 DS    0H                                                  0100 00360000
@ER00001 BR    @14                                                 0100 00361000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00362000
*     GPR00P PTR(31) REG(0),                                       0101 00363000
*     GPR01P PTR(31) REG(1),                                       0101 00364000
*     GPR14P PTR(31) REG(14),                                      0101 00365000
*     GPR15P PTR(31) REG(15);                                      0101 00366000
*   DECLARE                         /* COMMON VARIABLES              */ 00367000
*     I256C CHAR(256) BASED,                                       0102 00368000
*     I031F FIXED(31) BASED,                                       0102 00369000
*     I031P PTR(31) BASED,                                         0102 00370000
*     I015F FIXED(15) BASED,                                       0102 00371000
*     I015P PTR(15) BASED,                                         0102 00372000
*     I008P PTR(8) BASED,                                          0102 00373000
*     I001C CHAR(1) BASED;                                         0102 00374000
*   END IEFNB9IR                                                   0103 00375000
*                                                                  0103 00376000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00377000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 00378000
*/*%INCLUDE SYSLIB  (IEFZB9RD)                                       */ 00379000
*                                                                  0103 00380000
*       ;                                                          0103 00381000
@DATA    DS    0H                                                       00382000
@CH00040 DC    H'1'                                                     00383000
@CH00061 DC    H'2'                                                     00384000
@SM00468 MVC   DUMPCORE(0,DUMPLIST),DUMPMAC                             00385000
@SM00472 MVC   WTOCORE(0,REG4),WTOCSECT                                 00386000
@DATD    DSECT                                                          00387000
         DS    0F                                                       00388000
IEFNB9IR CSECT                                                          00389000
         DS    0F                                                       00390000
@DATD    DSECT                                                          00391000
         DS    0D                                                       00392000
IEFNB9IR CSECT                                                          00393000
         DS    0F                                                       00394000
@SIZDATD DC    AL1(0)                                                   00395000
         DC    AL3(@ENDDATD-@DATD)                                      00396000
@CV00422 DC    V(IEFNB9IT)                                              00397000
         DS    0D                                                       00398000
         DS    CL1                                                      00399000
ZEROB0   DC    XL3'0B0000'                                              00400000
NBIRPTCH DS    CL25                                                     00401000
         ORG   NBIRPTCH                                                 00402000
@NM00052 DC    25X'00'                                                  00403000
         ORG   NBIRPTCH+25                                              00404000
         DS    CL3                                                      00405000
CHARSTRG DC    CL16'0123456789ABCDEF'                                   00406000
TWELVE   DC    X'0C'                                                    00407000
RTNAME   DC    CL8'IEFNB9IR'                                            00408000
BLANK8   DC    CL8'        '                                            00409000
IEFNB9IR CSECT                                                          00410000
WTOCSECT WTO  'IEF683I INTERPRETER TERMINATED DUE TO S    ABEND',DESC=6600411000
               ,ROUTCDE=2,MF=L                                          00412000
WTOLEN   DC   A(*-WTOCSECT)                                             00413000
DUMPMAC SDUMP BUFFER=NO,QUIESCE=YES,SDATA=(SQA,LSQA,SWA,RGN,LPA),MF=L   00414000
LENDUMP  DC   A(*-DUMPMAC)                                              00415000
@DATD    DSECT                                                          00416000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00417000
@ENDDATD EQU   *                                                        00418000
IEFNB9IR CSECT                                                          00419000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00420000
@01      EQU   01                                                       00421000
@02      EQU   02                                                       00422000
@03      EQU   03                                                       00423000
@04      EQU   04                                                       00424000
@05      EQU   05                                                       00425000
@06      EQU   06                                                       00426000
@07      EQU   07                                                       00427000
@08      EQU   08                                                       00428000
@09      EQU   09                                                       00429000
@10      EQU   10                                                       00430000
@11      EQU   11                                                       00431000
@12      EQU   12                                                       00432000
@13      EQU   13                                                       00433000
@14      EQU   14                                                       00434000
@15      EQU   15                                                       00435000
SDWAPTR  EQU   @02                                                      00436000
EREPLPTR EQU   @03                                                      00437000
REG0     EQU   @00                                                      00438000
REG1     EQU   @01                                                      00439000
REG4     EQU   @04                                                      00440000
COUNT    EQU   @05                                                      00441000
REG6     EQU   @06                                                      00442000
REG7     EQU   @07                                                      00443000
SAVER14  EQU   @08                                                      00444000
DUMPLIST EQU   @09                                                      00445000
REG14    EQU   @14                                                      00446000
GPR00P   EQU   @00                                                      00447000
GPR01P   EQU   @01                                                      00448000
GPR14P   EQU   @14                                                      00449000
GPR15P   EQU   @15                                                      00450000
SDWA     EQU   0                                                        00451000
SDWAPARM EQU   SDWA                                                     00452000
SDWAFIOB EQU   SDWA+4                                                   00453000
SDWAABCC EQU   SDWAFIOB                                                 00454000
SDWACMPF EQU   SDWAABCC                                                 00455000
SDWAREQ  EQU   SDWACMPF                                                 00456000
SDWACMPC EQU   SDWAABCC+1                                               00457000
SDWACTL1 EQU   SDWA+8                                                   00458000
SDWACMKA EQU   SDWACTL1                                                 00459000
SDWAMWPA EQU   SDWACTL1+1                                               00460000
SDWAPMKA EQU   SDWACTL1+4                                               00461000
SDWACTL2 EQU   SDWA+16                                                  00462000
SDWACMKP EQU   SDWACTL2                                                 00463000
SDWAMWPP EQU   SDWACTL2+1                                               00464000
SDWAPMKP EQU   SDWACTL2+4                                               00465000
SDWAGRSV EQU   SDWA+24                                                  00466000
SDWANAME EQU   SDWA+88                                                  00467000
SDWAEC1  EQU   SDWA+104                                                 00468000
SDWAEMK1 EQU   SDWAEC1                                                  00469000
SDWAMWP1 EQU   SDWAEC1+1                                                00470000
SDWAINT1 EQU   SDWAEC1+2                                                00471000
SDWANXT1 EQU   SDWAEC1+4                                                00472000
SDWAAEC1 EQU   SDWA+112                                                 00473000
SDWAILC1 EQU   SDWAAEC1+1                                               00474000
SDWAINC1 EQU   SDWAAEC1+2                                               00475000
SDWAICD1 EQU   SDWAINC1+1                                               00476000
SDWAEC2  EQU   SDWA+120                                                 00477000
SDWAEMK2 EQU   SDWAEC2                                                  00478000
SDWAMWP2 EQU   SDWAEC2+1                                                00479000
SDWAINT2 EQU   SDWAEC2+2                                                00480000
SDWANXT2 EQU   SDWAEC2+4                                                00481000
SDWAAEC2 EQU   SDWA+128                                                 00482000
SDWAILC2 EQU   SDWAAEC2+1                                               00483000
SDWAINC2 EQU   SDWAAEC2+2                                               00484000
SDWAICD2 EQU   SDWAINC2+1                                               00485000
SDWASRSV EQU   SDWA+136                                                 00486000
SDWAIDNT EQU   SDWA+200                                                 00487000
SDWAMCH  EQU   SDWA+204                                                 00488000
SDWASTCK EQU   SDWAMCH                                                  00489000
SDWAMCHI EQU   SDWAMCH+8                                                00490000
SDWAMCHS EQU   SDWAMCHI                                                 00491000
SDWAMCHD EQU   SDWAMCHI+1                                               00492000
SDWARSR1 EQU   SDWAMCH+12                                               00493000
SDWARSR2 EQU   SDWAMCH+13                                               00494000
SDWAFLGS EQU   SDWA+232                                                 00495000
SDWAERRA EQU   SDWAFLGS                                                 00496000
SDWAPCHK EQU   SDWAERRA                                                 00497000
SDWARKEY EQU   SDWAERRA                                                 00498000
SDWAERRB EQU   SDWAFLGS+1                                               00499000
SDWAERRC EQU   SDWAFLGS+2                                               00500000
SDWAPERC EQU   SDWAERRC                                                 00501000
SDWAERRD EQU   SDWAFLGS+3                                               00502000
SDWAIOFS EQU   SDWA+238                                                 00503000
SDWARTYA EQU   SDWA+240                                                 00504000
SDWACPUA EQU   SDWA+248                                                 00505000
SDWAPARQ EQU   SDWA+252                                                 00506000
SDWARCDE EQU   SDWAPARQ                                                 00507000
SDWAACF2 EQU   SDWAPARQ+1                                               00508000
SDWARCRD EQU   SDWAACF2                                                 00509000
SDWAFREE EQU   SDWAACF2                                                 00510000
SDWAACF3 EQU   SDWAPARQ+2                                               00511000
SDWAACF4 EQU   SDWAPARQ+3                                               00512000
SDWALKWA EQU   SDWA+256                                                 00513000
SDWALKWS EQU   SDWALKWA                                                 00514000
SDWARECP EQU   SDWA+292                                                 00515000
SDWAMODN EQU   SDWARECP                                                 00516000
SDWACSCT EQU   SDWARECP+8                                               00517000
SDWAREXN EQU   SDWARECP+16                                              00518000
SDWASNPA EQU   SDWA+320                                                 00519000
SDWADUMP EQU   SDWASNPA                                                 00520000
SDWADPFS EQU   SDWADUMP+1                                               00521000
SDWADDAT EQU   SDWASNPA+4                                               00522000
SDWASDAT EQU   SDWADDAT                                                 00523000
SDWAPDAT EQU   SDWADDAT+2                                               00524000
SDWADPSA EQU   SDWA+328                                                 00525000
SDWADPSL EQU   SDWADPSA                                                 00526000
SDWARA   EQU   SDWA+400                                                 00527000
SDWADPVA EQU   SDWARA+2                                                 00528000
EREPL    EQU   0                                                        00529000
EREPFLGS EQU   EREPL+12                                                 00530000
EREPFLG1 EQU   EREPFLGS                                                 00531000
EREPRCUR EQU   EREPFLG1                                                 00532000
WTOCORE  EQU   0                                                        00533000
DUMPCORE EQU   0                                                        00534000
I001C    EQU   0                                                        00535000
I008P    EQU   0                                                        00536000
I015F    EQU   0                                                        00537000
I015P    EQU   0                                                        00538000
I031F    EQU   0                                                        00539000
I031P    EQU   0                                                        00540000
I256C    EQU   0                                                        00541000
*                                      START UNREFERENCED COMPONENTS    00542000
@NM00051 EQU   EREPL+16                                                 00543000
@NM00050 EQU   EREPFLGS+1                                               00544000
@NM00049 EQU   EREPFLG1                                                 00545000
EREPLRSV EQU   EREPL+8                                                  00546000
EREPLIWA EQU   EREPL+4                                                  00547000
EREPLCWA EQU   EREPL                                                    00548000
@NM00048 EQU   SDWA+512                                                 00549000
SDWAVRA  EQU   SDWARA+4                                                 00550000
SDWAURAL EQU   SDWARA+3                                                 00551000
@NM00047 EQU   SDWADPVA                                                 00552000
SDWAEBC  EQU   SDWADPVA                                                 00553000
SDWAHEX  EQU   SDWADPVA                                                 00554000
SDWAVRAL EQU   SDWARA                                                   00555000
@NM00046 EQU   SDWA+396                                                 00556000
SDWACOMP EQU   SDWA+392                                                 00557000
SDWARCPL EQU   SDWA+364                                                 00558000
@NM00045 EQU   SDWADPSA+32                                              00559000
SDWATO4  EQU   SDWADPSL+28                                              00560000
SDWAFRM4 EQU   SDWADPSL+24                                              00561000
SDWATO3  EQU   SDWADPSL+20                                              00562000
SDWAFRM3 EQU   SDWADPSL+16                                              00563000
SDWATO2  EQU   SDWADPSL+12                                              00564000
SDWAFRM2 EQU   SDWADPSL+8                                               00565000
SDWATO1  EQU   SDWADPSL+4                                               00566000
SDWAFRM1 EQU   SDWADPSL                                                 00567000
@NM00044 EQU   SDWADDAT+3                                               00568000
@NM00043 EQU   SDWAPDAT                                                 00569000
SDWAUSPL EQU   SDWAPDAT                                                 00570000
SDWADPSW EQU   SDWAPDAT                                                 00571000
SDWATJPA EQU   SDWAPDAT                                                 00572000
SDWATLPA EQU   SDWAPDAT                                                 00573000
SDWADREG EQU   SDWAPDAT                                                 00574000
SDWADSAH EQU   SDWAPDAT                                                 00575000
SDWADSAS EQU   SDWAPDAT                                                 00576000
@NM00042 EQU   SDWADDAT+1                                               00577000
@NM00041 EQU   SDWASDAT                                                 00578000
SDWAQQS  EQU   SDWASDAT                                                 00579000
SDWACBS  EQU   SDWASDAT                                                 00580000
SDWAGTF  EQU   SDWASDAT                                                 00581000
SDWASWA  EQU   SDWASDAT                                                 00582000
SDWALSQA EQU   SDWASDAT                                                 00583000
SDWASQA  EQU   SDWASDAT                                                 00584000
SDWANUC  EQU   SDWASDAT                                                 00585000
@NM00040 EQU   SDWADUMP+2                                               00586000
@NM00039 EQU   SDWADPFS                                                 00587000
SDWASLST EQU   SDWADPFS                                                 00588000
@NM00038 EQU   SDWADPFS                                                 00589000
SDWADLST EQU   SDWADPFS                                                 00590000
SDWADPT  EQU   SDWADPFS                                                 00591000
SDWADPID EQU   SDWADUMP                                                 00592000
SDWADPLA EQU   SDWA+316                                                 00593000
@NM00037 EQU   SDWALKWA+32                                              00594000
SDWATALW EQU   SDWALKWS+28                                              00595000
SDWATDLW EQU   SDWALKWS+24                                              00596000
SDWATNLW EQU   SDWALKWS+20                                              00597000
SDWAAPLW EQU   SDWALKWS+16                                              00598000
SDWAIPLW EQU   SDWALKWS+12                                              00599000
SDWAILLW EQU   SDWALKWS+8                                               00600000
SDWAIULW EQU   SDWALKWS+4                                               00601000
SDWAICLW EQU   SDWALKWS                                                 00602000
SDWAFLLK EQU   SDWAACF4                                                 00603000
SDWACMS  EQU   SDWAACF4                                                 00604000
SDWAOPTM EQU   SDWAACF4                                                 00605000
SDWATADB EQU   SDWAACF4                                                 00606000
SDWATDNB EQU   SDWAACF4                                                 00607000
SDWATNCB EQU   SDWAACF4                                                 00608000
SDWAILCH EQU   SDWAACF4                                                 00609000
SDWAIUCB EQU   SDWAACF4                                                 00610000
SDWAICAT EQU   SDWAACF3                                                 00611000
SDWAIPRG EQU   SDWAACF3                                                 00612000
SDWASALL EQU   SDWAACF3                                                 00613000
SDWAASMP EQU   SDWAACF3                                                 00614000
SDWADISP EQU   SDWAACF3                                                 00615000
@NM00036 EQU   SDWAACF3                                                 00616000
@NM00035 EQU   SDWAACF2                                                 00617000
SDWAUPRG EQU   SDWAACF2                                                 00618000
@NM00034 EQU   SDWAACF2                                                 00619000
SDWASPIN EQU   SDWAACF2                                                 00620000
@NM00033 EQU   SDWAACF2                                                 00621000
SDWALCPU EQU   SDWACPUA+2                                               00622000
@NM00032 EQU   SDWACPUA                                                 00623000
SDWARECA EQU   SDWA+244                                                 00624000
@NM00031 EQU   SDWA+239                                                 00625000
@NM00030 EQU   SDWAIOFS                                                 00626000
SDWANIOP EQU   SDWAIOFS                                                 00627000
SDWANOIO EQU   SDWAIOFS                                                 00628000
SDWAIOHT EQU   SDWAIOFS                                                 00629000
SDWAIOQR EQU   SDWAIOFS                                                 00630000
SDWAFMID EQU   SDWA+236                                                 00631000
@NM00029 EQU   SDWAERRD                                                 00632000
SDWAMCIV EQU   SDWAERRD                                                 00633000
SDWARPIV EQU   SDWAERRD                                                 00634000
SDWAMABD EQU   SDWAERRD                                                 00635000
SDWACTS  EQU   SDWAERRD                                                 00636000
SDWASTAE EQU   SDWAERRD                                                 00637000
SDWANRBE EQU   SDWAERRD                                                 00638000
SDWACLUP EQU   SDWAERRD                                                 00639000
@NM00028 EQU   SDWAERRC                                                 00640000
SDWAEAS  EQU   SDWAERRC                                                 00641000
SDWAIRB  EQU   SDWAERRC                                                 00642000
SDWASTAI EQU   SDWAERRC                                                 00643000
SDWASTAF EQU   SDWAERRC                                                 00644000
SDWASRBM EQU   SDWAERRB                                                 00645000
SDWALDIS EQU   SDWAERRB                                                 00646000
SDWAENRB EQU   SDWAERRB                                                 00647000
SDWATYP1 EQU   SDWAERRB                                                 00648000
@NM00027 EQU   SDWAERRB                                                 00649000
SDWAPGIO EQU   SDWAERRA                                                 00650000
SDWATEXC EQU   SDWAERRA                                                 00651000
SDWASVCE EQU   SDWAERRA                                                 00652000
SDWAABTM EQU   SDWAERRA                                                 00653000
SDWASVCD EQU   SDWAERRA                                                 00654000
SDWAMCHK EQU   SDWAERRA                                                 00655000
SDWATIME EQU   SDWAMCH+20                                               00656000
SDWARFSA EQU   SDWAMCH+16                                               00657000
@NM00026 EQU   SDWAMCH+14                                               00658000
SDWAVEQR EQU   SDWARSR2                                                 00659000
SDWAPGFX EQU   SDWARSR2                                                 00660000
SDWAFLSQ EQU   SDWARSR2                                                 00661000
SDWAFSQA EQU   SDWARSR2                                                 00662000
SDWANUCL EQU   SDWARSR2                                                 00663000
SDWASPER EQU   SDWARSR2                                                 00664000
SDWAINTC EQU   SDWARSR2                                                 00665000
SDWAOFLN EQU   SDWARSR2                                                 00666000
SDWACHNG EQU   SDWARSR1                                                 00667000
SDWAMSER EQU   SDWARSR1                                                 00668000
@NM00025 EQU   SDWARSR1                                                 00669000
SDWACPID EQU   SDWAMCH+10                                               00670000
SDWATERR EQU   SDWAMCHD                                                 00671000
SDWAFPRX EQU   SDWAMCHD                                                 00672000
SDWAINSF EQU   SDWAMCHD                                                 00673000
SDWAACR  EQU   SDWAMCHD                                                 00674000
SDWASCK  EQU   SDWAMCHD                                                 00675000
SDWAPSWU EQU   SDWAMCHD                                                 00676000
SDWAREGU EQU   SDWAMCHD                                                 00677000
SDWASKYF EQU   SDWAMCHD                                                 00678000
@NM00024 EQU   SDWAMCHS                                                 00679000
SDWARSRF EQU   SDWAMCHS                                                 00680000
SDWARSRC EQU   SDWAMCHS                                                 00681000
SDWAINVP EQU   SDWAMCHS                                                 00682000
SDWATSVL EQU   SDWAMCHS                                                 00683000
SDWARCDF EQU   SDWAMCHS                                                 00684000
SDWASRVL EQU   SDWAMCHS                                                 00685000
SDWASCKE EQU   SDWASTCK+4                                               00686000
SDWASCKB EQU   SDWASTCK                                                 00687000
SDWALNTH EQU   SDWAIDNT+1                                               00688000
SDWASPID EQU   SDWAIDNT                                                 00689000
SDWASR15 EQU   SDWASRSV+60                                              00690000
SDWASR14 EQU   SDWASRSV+56                                              00691000
SDWASR13 EQU   SDWASRSV+52                                              00692000
SDWASR12 EQU   SDWASRSV+48                                              00693000
SDWASR11 EQU   SDWASRSV+44                                              00694000
SDWASR10 EQU   SDWASRSV+40                                              00695000
SDWASR09 EQU   SDWASRSV+36                                              00696000
SDWASR08 EQU   SDWASRSV+32                                              00697000
SDWASR07 EQU   SDWASRSV+28                                              00698000
SDWASR06 EQU   SDWASRSV+24                                              00699000
SDWASR05 EQU   SDWASRSV+20                                              00700000
SDWASR04 EQU   SDWASRSV+16                                              00701000
SDWASR03 EQU   SDWASRSV+12                                              00702000
SDWASR02 EQU   SDWASRSV+8                                               00703000
SDWASR01 EQU   SDWASRSV+4                                               00704000
SDWASR00 EQU   SDWASRSV                                                 00705000
SDWATRN2 EQU   SDWAAEC2+4                                               00706000
SDWAIPC2 EQU   SDWAICD2                                                 00707000
SDWAIMC2 EQU   SDWAICD2                                                 00708000
SDWAIPR2 EQU   SDWAICD2                                                 00709000
@NM00023 EQU   SDWAINC2                                                 00710000
@NM00022 EQU   SDWAILC2                                                 00711000
SDWAIL2  EQU   SDWAILC2                                                 00712000
@NM00021 EQU   SDWAILC2                                                 00713000
@NM00020 EQU   SDWAAEC2                                                 00714000
SDWAADD2 EQU   SDWANXT2+1                                               00715000
@NM00019 EQU   SDWANXT2                                                 00716000
@NM00018 EQU   SDWAEC2+3                                                00717000
SDWASGN2 EQU   SDWAINT2                                                 00718000
SDWAEXP2 EQU   SDWAINT2                                                 00719000
SDWADEC2 EQU   SDWAINT2                                                 00720000
SDWAFPO2 EQU   SDWAINT2                                                 00721000
SDWACC2  EQU   SDWAINT2                                                 00722000
@NM00017 EQU   SDWAINT2                                                 00723000
SDWAPGM2 EQU   SDWAMWP2                                                 00724000
SDWAWAT2 EQU   SDWAMWP2                                                 00725000
SDWAMCK2 EQU   SDWAMWP2                                                 00726000
SDWAECT2 EQU   SDWAMWP2                                                 00727000
SDWAKEY2 EQU   SDWAMWP2                                                 00728000
SDWAEXT2 EQU   SDWAEMK2                                                 00729000
SDWAIO2  EQU   SDWAEMK2                                                 00730000
SDWATRM2 EQU   SDWAEMK2                                                 00731000
@NM00016 EQU   SDWAEMK2                                                 00732000
SDWAPER2 EQU   SDWAEMK2                                                 00733000
@NM00015 EQU   SDWAEMK2                                                 00734000
SDWATRAN EQU   SDWAAEC1+4                                               00735000
SDWAIPC1 EQU   SDWAICD1                                                 00736000
SDWAIMC1 EQU   SDWAICD1                                                 00737000
SDWAIPR1 EQU   SDWAICD1                                                 00738000
@NM00014 EQU   SDWAINC1                                                 00739000
@NM00013 EQU   SDWAILC1                                                 00740000
SDWAIL1  EQU   SDWAILC1                                                 00741000
@NM00012 EQU   SDWAILC1                                                 00742000
@NM00011 EQU   SDWAAEC1                                                 00743000
SDWAADD1 EQU   SDWANXT1+1                                               00744000
@NM00010 EQU   SDWANXT1                                                 00745000
@NM00009 EQU   SDWAEC1+3                                                00746000
SDWASGN1 EQU   SDWAINT1                                                 00747000
SDWAEXP1 EQU   SDWAINT1                                                 00748000
SDWADEC1 EQU   SDWAINT1                                                 00749000
SDWAFPO1 EQU   SDWAINT1                                                 00750000
SDWACC1  EQU   SDWAINT1                                                 00751000
@NM00008 EQU   SDWAINT1                                                 00752000
SDWAPGM1 EQU   SDWAMWP1                                                 00753000
SDWAWAT1 EQU   SDWAMWP1                                                 00754000
SDWAMCK1 EQU   SDWAMWP1                                                 00755000
SDWAECT1 EQU   SDWAMWP1                                                 00756000
SDWAKEY1 EQU   SDWAMWP1                                                 00757000
SDWAEXT1 EQU   SDWAEMK1                                                 00758000
SDWAIO1  EQU   SDWAEMK1                                                 00759000
SDWATRM1 EQU   SDWAEMK1                                                 00760000
@NM00007 EQU   SDWAEMK1                                                 00761000
SDWAPER1 EQU   SDWAEMK1                                                 00762000
@NM00006 EQU   SDWAEMK1                                                 00763000
SDWAIOBR EQU   SDWA+100                                                 00764000
SDWAEPA  EQU   SDWA+96                                                  00765000
@NM00005 EQU   SDWANAME+4                                               00766000
SDWARBAD EQU   SDWANAME                                                 00767000
SDWAGR15 EQU   SDWAGRSV+60                                              00768000
SDWAGR14 EQU   SDWAGRSV+56                                              00769000
SDWAGR13 EQU   SDWAGRSV+52                                              00770000
SDWAGR12 EQU   SDWAGRSV+48                                              00771000
SDWAGR11 EQU   SDWAGRSV+44                                              00772000
SDWAGR10 EQU   SDWAGRSV+40                                              00773000
SDWAGR09 EQU   SDWAGRSV+36                                              00774000
SDWAGR08 EQU   SDWAGRSV+32                                              00775000
SDWAGR07 EQU   SDWAGRSV+28                                              00776000
SDWAGR06 EQU   SDWAGRSV+24                                              00777000
SDWAGR05 EQU   SDWAGRSV+20                                              00778000
SDWAGR04 EQU   SDWAGRSV+16                                              00779000
SDWAGR03 EQU   SDWAGRSV+12                                              00780000
SDWAGR02 EQU   SDWAGRSV+8                                               00781000
SDWAGR01 EQU   SDWAGRSV+4                                               00782000
SDWAGR00 EQU   SDWAGRSV                                                 00783000
SDWANXTP EQU   SDWACTL2+5                                               00784000
SDWASGP  EQU   SDWAPMKP                                                 00785000
SDWAEUP  EQU   SDWAPMKP                                                 00786000
SDWADOP  EQU   SDWAPMKP                                                 00787000
SDWAFPP  EQU   SDWAPMKP                                                 00788000
SDWACCP  EQU   SDWAPMKP                                                 00789000
SDWAILP  EQU   SDWAPMKP                                                 00790000
SDWAINTP EQU   SDWACTL2+2                                               00791000
SDWASPVP EQU   SDWAMWPP                                                 00792000
SDWAWATP EQU   SDWAMWPP                                                 00793000
SDWAMCKP EQU   SDWAMWPP                                                 00794000
@NM00004 EQU   SDWAMWPP                                                 00795000
SDWAKEYP EQU   SDWAMWPP                                                 00796000
SDWAEXTP EQU   SDWACMKP                                                 00797000
SDWAIOP  EQU   SDWACMKP                                                 00798000
SDWANXTA EQU   SDWACTL1+5                                               00799000
SDWASGA  EQU   SDWAPMKA                                                 00800000
SDWAEUA  EQU   SDWAPMKA                                                 00801000
SDWADOA  EQU   SDWAPMKA                                                 00802000
SDWAFPA  EQU   SDWAPMKA                                                 00803000
SDWACCA  EQU   SDWAPMKA                                                 00804000
SDWAILA  EQU   SDWAPMKA                                                 00805000
SDWAINTA EQU   SDWACTL1+2                                               00806000
SDWASPVA EQU   SDWAMWPA                                                 00807000
SDWAWATA EQU   SDWAMWPA                                                 00808000
SDWAMCKA EQU   SDWAMWPA                                                 00809000
@NM00003 EQU   SDWAMWPA                                                 00810000
SDWAKEYA EQU   SDWAMWPA                                                 00811000
SDWAEXTA EQU   SDWACMKA                                                 00812000
SDWAIOA  EQU   SDWACMKA                                                 00813000
@NM00002 EQU   SDWACMPF                                                 00814000
SDWASTCC EQU   SDWACMPF                                                 00815000
@NM00001 EQU   SDWACMPF                                                 00816000
SDWASTEP EQU   SDWACMPF                                                 00817000
*                                      END UNREFERENCED COMPONENTS      00818000
@ENDDATA EQU   *                                                        00819000
         END   IEFNB9IR                                                 00820000
./  ADD  SSI=80550259,NAME=IEFNB9IT
         TITLE 'INTERPRETER ESTAE TERMINATION ROUTINE                  *00001000
                        '                                               00002000
IEFNB9IT CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEFNB9IT  78.055'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
JSCBDISP EQU 188                                                        00013000
JSCBAOS1 EQU  72                                                        00014000
JSCBAOS2 EQU 192                                                        00015000
*/* S E T U P  S D W A,E R E P L  A D D R E S S A B I L I T Y*/    0015 00016000
*                                                                  0015 00017000
*        EREPLPTR=REG1;        /*REGISTER 1 PASSED TO RTNE.  @YM02460*/ 00018000
*                                                                  0015 00019000
         LR    EREPLPTR,REG1                                       0015 00020000
*/* G E T  D U M M Y  S A V E A R E A  */                          0016 00021000
*                                                                  0016 00022000
*        REG0=LENGTH(DUMMYSAV);    /*LENGTH WILL HAVE ZERO         0016 00023000
*                                    HIGH ORDER BYTE THAT WILL SERVE    00024000
*                                    AS SUBPOOL NUMBER.*/          0016 00025000
         LA    REG0,72                                             0016 00026000
*        GEN(GETMAIN R,LV=(0));    /*GET SAVEAREA CORE*/           0017 00027000
         GETMAIN R,LV=(0)                                               00028000
*        REG13=REG1;               /*SAVEAREA ADDRESSABILITY*/     0018 00029000
         LR    REG13,REG1                                          0018 00030000
*        DUMMYSAV=''B;        /*ZERO SAVEAREA FOR CLARITY*/        0019 00031000
*                                                                  0019 00032000
         XC    DUMMYSAV(72,REG13),DUMMYSAV(REG13)                  0019 00033000
*/* S E T U P  S A V E A R E A  */                                 0020 00034000
*                                                                  0020 00035000
*        PREVSAVA=EREPLRSV;       /*SAVEAREA PTR FROM EREPL*/      0020 00036000
*                                                                  0020 00037000
         L     @10,EREPLRSV(,EREPLPTR)                             0020 00038000
         ST    @10,PREVSAVA(,REG13)                                0020 00039000
*/* S E T U P  I W A  */                                           0021 00040000
*                                                                  0021 00041000
*        WAPTR=EREPLIWA;         /*IWA PTR FROM EREPL*/            0021 00042000
         L     WAPTR,EREPLIWA(,EREPLPTR)                           0021 00043000
*        IWARET=RETURN36;         /*RETURN CODE FOR INTERPRETER*/  0022 00044000
*                                                                  0022 00045000
         MVC   IWARET(2,WAPTR),RETURN36                            0022 00046000
*        IF IWASAVPT Â¬= EREPLRSV THEN  /*IF SAVEAREA POINTERS      0023 00047000
*                                        ARE NOT EQUAL,LOAD THE    0023 00048000
*                                        IWA POINTER FROM THE EREPL*/   00049000
         LA    @05,372                                             0023 00050000
         ALR   @05,WAPTR                                           0023 00051000
         C     @10,IWASAVPT(,@05)                                  0023 00052000
         BE    @RF00023                                            0023 00053000
*         IWASAVPT=EREPLRSV;                                       0024 00054000
*                                                                  0024 00055000
         ST    @10,IWASAVPT(,@05)                                  0024 00056000
*/* A C T I V E J S C B  P O I N T E R  S W I T C H          @YM04108*/ 00057000
*/*  IF FIRST AND ACTIVE JSCB POINTER NOT ZERO THEN SWITCH.  @YM04108*/ 00058000
*        IF (IWAJSCBF Â¬= 0) & (IWAJSCBA Â¬= 0) THEN        /* @YM04108*/ 00059000
@RF00023 SLR   @10,@10                                             0025 00060000
         LA    @05,372                                             0025 00061000
         ALR   @05,WAPTR                                           0025 00062000
         L     @02,IWAJSCBF(,@05)                                  0025 00063000
         CR    @02,@10                                             0025 00064000
         BE    @RF00025                                            0025 00065000
         L     @05,IWAJSCBA(,@05)                                  0025 00066000
         CR    @05,@10                                             0025 00067000
         BE    @RF00025                                            0025 00068000
*             DO;                                                  0026 00069000
*              RESPECIFY IEZJSCB BASED(IWAJSCBF);                  0027 00070000
*              JSCBACT = IWAJSCBA;   /*ACTIVE POINTER RESET  @YM04108*/ 00071000
         ST    @05,JSCBACT(,@02)                                   0028 00072000
*              RESPECIFY IEZJSCB BASED(TCBJSCB);                   0029 00073000
*             END;                                                 0030 00074000
*/* S E T U P  T E R M I N A T I O N  R E G I S T E R S  */        0031 00075000
*                                                                  0031 00076000
*/* REGISTER 13 HAS ALREADY BEEN LOADED WITH THE DUMMY SAVEAREA    0031 00077000
*   POINTER. */                                                    0031 00078000
*                                                                  0031 00079000
*        REG12=EREPLIWA;           /*IWA POINTER INTO R12*/        0031 00080000
*                                                                  0031 00081000
@RF00025 L     REG12,EREPLIWA(,EREPLPTR)                           0031 00082000
*/* C A L L  T E R M I N A T I O N  M O D U L E */                 0032 00083000
*                                                                  0032 00084000
*        CALL IEFVHN;              /*TERMINATE INTERPRETER*/       0032 00085000
*                                                                  0032 00086000
         L     @15,@CV00850                                        0032 00087000
         BALR  @14,@15                                             0032 00088000
*        END IEFNB9IT                                              0033 00089000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00090000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        * 00091000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        * 00092000
*/*%INCLUDE SYSLIB  (IEFZB9RD)                                        * 00093000
*/*%INCLUDE SYSLIB  (IEFCOMWA)                                        * 00094000
*/*%INCLUDE SYSLIB  (IEFVMIWA)                                        * 00095000
*;                                                                 0033 00096000
@EL00001 DS    0H                                                  0033 00097000
@EF00001 DS    0H                                                  0033 00098000
@ER00001 BR    @14                                                 0033 00099000
@DATA    DS    0H                                                       00100000
@DATD    DSECT                                                          00101000
         DS    0F                                                       00102000
IEFNB9IT CSECT                                                          00103000
         DS    0F                                                       00104000
@DATD    DSECT                                                          00105000
         DS    0D                                                       00106000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00107000
@ENDDATD EQU   *                                                        00108000
IEFNB9IT CSECT                                                          00109000
         DS    0F                                                       00110000
@SIZDATD DC    AL1(0)                                                   00111000
         DC    AL3(@ENDDATD-@DATD)                                      00112000
@CV00850 DC    V(IEFVHN)                                                00113000
         DS    0D                                                       00114000
NBITPTCH DS    CL25                                                     00115000
         ORG   NBITPTCH                                                 00116000
@NM00036 DC    25X'00'                                                  00117000
         ORG   NBITPTCH+25                                              00118000
RETURN36 DC    X'0024'                                                  00119000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00120000
@01      EQU   01                                                       00121000
@02      EQU   02                                                       00122000
@03      EQU   03                                                       00123000
@04      EQU   04                                                       00124000
@05      EQU   05                                                       00125000
@06      EQU   06                                                       00126000
@07      EQU   07                                                       00127000
@08      EQU   08                                                       00128000
@09      EQU   09                                                       00129000
@10      EQU   10                                                       00130000
@11      EQU   11                                                       00131000
@12      EQU   12                                                       00132000
@13      EQU   13                                                       00133000
@14      EQU   14                                                       00134000
@15      EQU   15                                                       00135000
EREPLPTR EQU   @03                                                      00136000
WAPTR    EQU   @04                                                      00137000
REG0     EQU   @00                                                      00138000
REG1     EQU   @01                                                      00139000
REG12    EQU   @12                                                      00140000
REG13    EQU   @13                                                      00141000
IEZJSCB  EQU   0                                                        00142000
JSCBSEC1 EQU   IEZJSCB+188                                              00143000
JSCHPCE  EQU   JSCBSEC1+4                                               00144000
JSCBDCB  EQU   JSCBSEC1+36                                              00145000
JSCBOPTS EQU   JSCBSEC1+48                                              00146000
JSCBSWT1 EQU   JSCBSEC1+55                                              00147000
JSCBWTP  EQU   JSCBSEC1+64                                              00148000
JSCBWTFG EQU   JSCBWTP                                                  00149000
JSCBEND1 EQU   IEZJSCB+260                                              00150000
TCBFIX   EQU   0                                                        00151000
TCBFRS   EQU   TCBFIX                                                   00152000
TCBPTR   EQU   0                                                        00153000
TCB      EQU   0                                                        00154000
TCBPIE   EQU   TCB+4                                                    00155000
TCBPMASK EQU   TCBPIE                                                   00156000
TCBCMP   EQU   TCB+16                                                   00157000
TCBCMPF  EQU   TCBCMP                                                   00158000
TCBCPP   EQU   TCBCMPF                                                  00159000
TCBSTCC  EQU   TCBCMPF                                                  00160000
TCBCDBL  EQU   TCBCMPF                                                  00161000
TCBCWTO  EQU   TCBCMPF                                                  00162000
TCBCIND  EQU   TCBCMPF                                                  00163000
TCBCMSG  EQU   TCBCMPF                                                  00164000
TCBTRN   EQU   TCB+20                                                   00165000
TCBABF   EQU   TCBTRN                                                   00166000
TCBMSS   EQU   TCB+24                                                   00167000
TCBPKF   EQU   TCB+28                                                   00168000
TCBFLGS  EQU   TCB+29                                                   00169000
TCBFLGS1 EQU   TCBFLGS                                                  00170000
TCBFLGS2 EQU   TCBFLGS+1                                                00171000
TCBFLGS3 EQU   TCBFLGS+2                                                00172000
TCBFLGS4 EQU   TCBFLGS+3                                                00173000
TCBFLGS5 EQU   TCBFLGS+4                                                00174000
TCBABWF  EQU   TCBFLGS5                                                 00175000
TCBJPQ   EQU   TCB+44                                                   00176000
TCBPURGE EQU   TCBJPQ                                                   00177000
TCBGRS   EQU   TCB+48                                                   00178000
TCBFSA   EQU   TCB+112                                                  00179000
TCBTME   EQU   TCB+120                                                  00180000
TCBJSTCB EQU   TCB+124                                                  00181000
TCBTSFLG EQU   TCB+148                                                  00182000
TCBTSTSK EQU   TCBTSFLG                                                 00183000
TCBSTAB  EQU   TCB+160                                                  00184000
TCBNSTAE EQU   TCBSTAB                                                  00185000
TCBTCT   EQU   TCB+164                                                  00186000
TCBTCTGF EQU   TCBTCT                                                   00187000
TCBSCNDY EQU   TCB+172                                                  00188000
TCBNDSP  EQU   TCBSCNDY                                                 00189000
TCBNDSP1 EQU   TCBNDSP+1                                                00190000
TCBNDSP2 EQU   TCBNDSP+2                                                00191000
TCBNDSP3 EQU   TCBNDSP+3                                                00192000
TCBJSCB  EQU   TCB+180                                                  00193000
TCBRECDE EQU   TCBJSCB                                                  00194000
TCBEXT1  EQU   TCB+196                                                  00195000
TCBBITS  EQU   TCB+200                                                  00196000
TCBNDSP4 EQU   TCBBITS                                                  00197000
TCBNDSP5 EQU   TCBBITS+1                                                00198000
TCBFLGS6 EQU   TCBBITS+2                                                00199000
TCBFLGS7 EQU   TCBBITS+3                                                00200000
TCBDAR   EQU   TCB+204                                                  00201000
TCBDARC  EQU   TCBDAR                                                   00202000
TCBEXT2  EQU   TCB+208                                                  00203000
TCBFOE   EQU   TCB+244                                                  00204000
TCBESTAE EQU   TCB+264                                                  00205000
TCBESTRM EQU   TCBESTAE+1                                               00206000
TCBFBYT1 EQU   TCB+276                                                  00207000
TCBFBYT2 EQU   TCB+277                                                  00208000
TCBRV124 EQU   TCB+278                                                  00209000
TCBRV133 EQU   TCB+279                                                  00210000
TCBXTNT2 EQU   0                                                        00211000
TCBGTF   EQU   TCBXTNT2                                                 00212000
TCBTFLG  EQU   TCBGTF                                                   00213000
TCBRV146 EQU   TCBXTNT2+28                                              00214000
TCBRV155 EQU   TCBXTNT2+29                                              00215000
TCBRV164 EQU   TCBXTNT2+30                                              00216000
TCBRV173 EQU   TCBXTNT2+31                                              00217000
EREPL    EQU   0                                                        00218000
EREPLIWA EQU   EREPL+4                                                  00219000
EREPLRSV EQU   EREPL+8                                                  00220000
EREPFLGS EQU   EREPL+12                                                 00221000
EREPFLG1 EQU   EREPFLGS                                                 00222000
COMWA    EQU   0                                                        00223000
CWAL     EQU   COMWA                                                    00224000
CWAID    EQU   COMWA+4                                                  00225000
CWACONID EQU   COMWA+8                                                  00226000
IWAIOSA  EQU   COMWA+88                                                 00227000
WARPL    EQU   COMWA+160                                                00228000
CWARET   EQU   COMWA+344                                                00229000
IWARET   EQU   CWARET                                                   00230000
CWAMCSCA EQU   COMWA+346                                                00231000
CWAMSLEN EQU   COMWA+360                                                00232000
AOSW1    EQU   COMWA+361                                                00233000
AOSW4    EQU   COMWA+362                                                00234000
SWE      EQU   COMWA+363                                                00235000
SWH      EQU   COMWA+364                                                00236000
SWI      EQU   COMWA+365                                                00237000
SWY2     EQU   COMWA+366                                                00238000
INTWA    EQU   0                                                        00239000
IWASAVPT EQU   INTWA+100                                                00240000
IWAEXTS  EQU   INTWA+179                                                00241000
SWA      EQU   INTWA+180                                                00242000
SWC      EQU   INTWA+181                                                00243000
SWD      EQU   INTWA+182                                                00244000
SWF      EQU   INTWA+183                                                00245000
SWG      EQU   INTWA+184                                                00246000
IWAINTS8 EQU   INTWA+185                                                00247000
CRSW1    EQU   INTWA+189                                                00248000
DDSWX1   EQU   INTWA+192                                                00249000
SDDNSWA  EQU   DDSWX1                                                   00250000
AOSW2    EQU   INTWA+194                                                00251000
IWAJSCBF EQU   INTWA+1432                                               00252000
IWAJSCBA EQU   INTWA+1436                                               00253000
DUMMYSAV EQU   0                                                        00254000
PREVSAVA EQU   DUMMYSAV+4                                               00255000
JSCBSEC2 EQU   JSCBEND1                                                 00256000
JSCBSEC3 EQU   JSCBEND1                                                 00257000
JSCBJCT  EQU   JSCBSEC3                                                 00258000
JSCBJCTA EQU   JSCBJCT+1                                                00259000
JSCBASID EQU   JSCBSEC3+8                                               00260000
JSCBFBYT EQU   JSCBSEC3+10                                              00261000
JSCBJNL  EQU   JSCBSEC3+28                                              00262000
JSCBJJSB EQU   JSCBJNL                                                  00263000
JSCBSUB  EQU   JSCBSEC3+40                                              00264000
JSCSCT   EQU   JSCBSEC3+68                                              00265000
JSCBACT  EQU   JSCBSEC3+88                                              00266000
JSCRSV45 EQU   JSCBSEC3+112                                             00267000
JSCRSV46 EQU   JSCRSV45                                                 00268000
JSCRSV47 EQU   JSCRSV45+2                                               00269000
*                                      START UNREFERENCED COMPONENTS    00270000
JSCBEND3 EQU   JSCBSEC3+120                                             00271000
JSCRSV52 EQU   JSCBSEC3+116                                             00272000
JSCRSV51 EQU   JSCRSV47+1                                               00273000
JSCRSV50 EQU   JSCRSV47                                                 00274000
JSCRSV49 EQU   JSCRSV46+1                                               00275000
JSCRSV48 EQU   JSCRSV46                                                 00276000
JSCRSV44 EQU   JSCBSEC3+108                                             00277000
JSCRSV43 EQU   JSCBSEC3+104                                             00278000
JSCRSV42 EQU   JSCBSEC3+100                                             00279000
JSCBASWA EQU   JSCBSEC3+96                                              00280000
JSCBUFPT EQU   JSCBSEC3+92                                              00281000
JSCBSWSP EQU   JSCBSEC3+87                                              00282000
JSCRSV33 EQU   JSCBSEC3+86                                              00283000
JSCDDNUM EQU   JSCBSEC3+84                                              00284000
JSCRSV53 EQU   JSCBSEC3+82                                              00285000
JSCDDNNO EQU   JSCBSEC3+80                                              00286000
JSCBVATA EQU   JSCBSEC3+76                                              00287000
JSCTMCOR EQU   JSCBSEC3+72                                              00288000
JSCSCTP  EQU   JSCSCT+1                                                 00289000
JSCRSV55 EQU   JSCSCT                                                   00290000
JSCRSV54 EQU   JSCBSEC3+64                                              00291000
JSCDSABQ EQU   JSCBSEC3+60                                              00292000
JSCBSSIB EQU   JSCBSEC3+56                                              00293000
JSCBFRBA EQU   JSCBSEC3+48                                              00294000
JSCRSV28 EQU   JSCBSEC3+46                                              00295000
JSCBSONO EQU   JSCBSEC3+44                                              00296000
JSCBSUBA EQU   JSCBSUB+1                                                00297000
JSCRSV31 EQU   JSCBSUB                                                  00298000
JSCBSMLR EQU   JSCBSEC3+36                                              00299000
JSCBJNLR EQU   JSCBSEC3+32                                              00300000
JSCBJNLA EQU   JSCBJNL+1                                                00301000
JSCBJSBT EQU   JSCBJJSB                                                 00302000
JSCBJSBX EQU   JSCBJJSB                                                 00303000
JSCBJSBA EQU   JSCBJJSB                                                 00304000
JSCBJSBI EQU   JSCBJJSB                                                 00305000
@NM00004 EQU   JSCBJJSB                                                 00306000
JSCBJNLE EQU   JSCBJJSB                                                 00307000
JSCBJNLF EQU   JSCBJJSB                                                 00308000
JSCBJNLN EQU   JSCBJJSB                                                 00309000
@NM00003 EQU   JSCBSEC3+24                                              00310000
JSCBJRBA EQU   JSCBSEC3+16                                              00311000
JSCBIECB EQU   JSCBSEC3+12                                              00312000
JSCBRV08 EQU   JSCBSEC3+11                                              00313000
JSCBRV07 EQU   JSCBFBYT                                                 00314000
JSCBRV06 EQU   JSCBFBYT                                                 00315000
JSCBRV05 EQU   JSCBFBYT                                                 00316000
JSCBRV04 EQU   JSCBFBYT                                                 00317000
JSCBRV03 EQU   JSCBFBYT                                                 00318000
JSCBRV02 EQU   JSCBFBYT                                                 00319000
JSCBADSP EQU   JSCBFBYT                                                 00320000
JSCBRV01 EQU   JSCBFBYT                                                 00321000
JSCBTJID EQU   JSCBASID                                                 00322000
JSCBPSCB EQU   JSCBSEC3+4                                               00323000
JSCJCTP  EQU   JSCBJCTA                                                 00324000
JSCRSV24 EQU   JSCBJCT                                                  00325000
JSCBEND2 EQU   JSCBSEC2                                                 00326000
@NM00038 EQU   DUMMYSAV+8                                               00327000
@NM00037 EQU   DUMMYSAV                                                 00328000
AOQLOCEX EQU   INTWA+1448                                               00329000
RFULLE   EQU   INTWA+1444                                               00330000
IWALWLGN EQU   INTWA+1440                                               00331000
RBLOCK   EQU   INTWA+1352                                               00332000
SPSAV    EQU   INTWA+1332                                               00333000
DSNAME   EQU   INTWA+1156                                               00334000
SCT      EQU   INTWA+980                                                00335000
@NM00035 EQU   INTWA+978                                                00336000
DNRT     EQU   INTWA+900                                                00337000
JCTX     EQU   INTWA+724                                                00338000
JCT      EQU   INTWA+548                                                00339000
DREFB    EQU   INTWA+372                                                00340000
SREF     EQU   INTWA+196                                                00341000
@NM00034 EQU   INTWA+195                                                00342000
AODFLTKW EQU   AOSW2                                                    00343000
AOMAXERR EQU   AOSW2                                                    00344000
AONOREAD EQU   AOSW2                                                    00345000
@NM00033 EQU   AOSW2                                                    00346000
IWASNUMB EQU   INTWA+193                                                00347000
@NM00032 EQU   SDDNSWA                                                  00348000
IWASCAT2 EQU   SDDNSWA                                                  00349000
IWASCAT  EQU   SDDNSWA                                                  00350000
IWAJCAT  EQU   SDDNSWA                                                  00351000
@NM00031 EQU   SDDNSWA                                                  00352000
SDDNSW   EQU   SDDNSWA                                                  00353000
DDINO    EQU   INTWA+191                                                00354000
IWANELEN EQU   INTWA+190                                                00355000
@NM00030 EQU   CRSW1                                                    00356000
CPDUM    EQU   CRSW1                                                    00357000
@NM00029 EQU   CRSW1                                                    00358000
IWAJBADR EQU   INTWA+188                                                00359000
IWAWRNMS EQU   INTWA+187                                                00360000
JBCONCAT EQU   INTWA+186                                                00361000
@NM00028 EQU   IWAINTS8                                                 00362000
JOBRDR   EQU   IWAINTS8                                                 00363000
JOBRDNC  EQU   IWAINTS8                                                 00364000
JOBRDNR  EQU   IWAINTS8                                                 00365000
@NM00027 EQU   IWAINTS8                                                 00366000
ORFLG2SW EQU   SWG                                                      00367000
@NM00026 EQU   SWG                                                      00368000
ORSDPOR  EQU   SWG                                                      00369000
ORRDOR   EQU   SWG                                                      00370000
ORADDROR EQU   SWF                                                      00371000
ORREGOR  EQU   SWF                                                      00372000
ORACTOR  EQU   SWF                                                      00373000
ORTIME0  EQU   SWF                                                      00374000
ORTIMEOR EQU   SWF                                                      00375000
ORCONDOR EQU   SWF                                                      00376000
ORPARMBL EQU   SWF                                                      00377000
ORPARMOR EQU   SWF                                                      00378000
TIMDFPRC EQU   SWD                                                      00379000
DCTFST   EQU   SWD                                                      00380000
@NM00025 EQU   SWD                                                      00381000
DBFST    EQU   SWD                                                      00382000
FDDRCV   EQU   SWD                                                      00383000
FEXRCV   EQU   SWD                                                      00384000
JOBREGNS EQU   SWD                                                      00385000
JOBADDRF EQU   SWD                                                      00386000
@NM00024 EQU   SWC                                                      00387000
VOLREF   EQU   SWC                                                      00388000
DSNTQ    EQU   SWC                                                      00389000
@NM00023 EQU   SWC                                                      00390000
@NM00022 EQU   SWA                                                      00391000
SCTTQ    EQU   SWA                                                      00392000
JCTTQ    EQU   SWA                                                      00393000
JHS      EQU   SWA                                                      00394000
@NM00021 EQU   SWA                                                      00395000
IWAQENTR EQU   IWAEXTS                                                  00396000
@NM00020 EQU   IWAEXTS                                                  00397000
DINBPLP1 EQU   INTWA+178                                                00398000
DJBCLAS  EQU   INTWA+177                                                00399000
IWACATCT EQU   INTWA+176                                                00400000
DDINTNO  EQU   INTWA+174                                                00401000
JCTXS    EQU   INTWA+172                                                00402000
JFCBES   EQU   INTWA+170                                                00403000
ACTS     EQU   INTWA+168                                                00404000
POVRRDS  EQU   INTWA+166                                                00405000
DREFBS   EQU   INTWA+164                                                00406000
SREFBS   EQU   INTWA+162                                                00407000
DSNAMES  EQU   INTWA+160                                                00408000
JFCBXS   EQU   INTWA+158                                                00409000
JFCBS    EQU   INTWA+156                                                00410000
SIOTS    EQU   INTWA+154                                                00411000
JACTS    EQU   INTWA+152                                                00412000
SCTS     EQU   INTWA+150                                                00413000
JCTS     EQU   INTWA+148                                                00414000
JEDSWS   EQU   INTWA+146                                                00415000
UNNU     EQU   INTWA+144                                                00416000
@NM00019 EQU   INTWA+143                                                00417000
UNQNAME  EQU   INTWA+120                                                00418000
ORIDSNM  EQU   INTWA+112                                                00419000
AOJRNLEX EQU   INTWA+104                                                00420000
DSNTPSA  EQU   INTWA+96                                                 00421000
IWAJFCBP EQU   INTWA+92                                                 00422000
IWASIOTP EQU   INTWA+88                                                 00423000
IWASCTAD EQU   INTWA+84                                                 00424000
IWAJSIOT EQU   INTWA+80                                                 00425000
TSAVEP   EQU   INTWA+72                                                 00426000
IWAJMRPT EQU   INTWA+68                                                 00427000
IWANXTSV EQU   INTWA+64                                                 00428000
IWAEXPNO EQU   INTWA+60                                                 00429000
IWASTAPL EQU   INTWA+56                                                 00430000
IWAJOBS6 EQU   INTWA+52                                                 00431000
IWAJOBS3 EQU   INTWA+44                                                 00432000
IWAJOBS1 EQU   INTWA+36                                                 00433000
DSENQTP  EQU   INTWA+32                                                 00434000
RELPGM   EQU   INTWA+28                                                 00435000
RELPROC  EQU   INTWA+24                                                 00436000
TPROC    EQU   INTWA+20                                                 00437000
TACT     EQU   INTWA+16                                                 00438000
TSREFB   EQU   INTWA+12                                                 00439000
TJOBLIB  EQU   INTWA+8                                                  00440000
TSIOT    EQU   INTWA+4                                                  00441000
IWAINTS5 EQU   INTWA                                                    00442000
RBYTE5   EQU   COMWA+371                                                00443000
RBYTE4   EQU   COMWA+370                                                00444000
RBYTE3   EQU   COMWA+369                                                00445000
RBYTE2   EQU   COMWA+368                                                00446000
RBYTE1   EQU   COMWA+367                                                00447000
@NM00018 EQU   SWY2                                                     00448000
KEYNXTSW EQU   SWY2                                                     00449000
DYNAMSW  EQU   SWY2                                                     00450000
DUMMYSW  EQU   SWY2                                                     00451000
@NM00017 EQU   SWI                                                      00452000
DSNLIT   EQU   SWI                                                      00453000
BLKMLTER EQU   SWI                                                      00454000
@NM00016 EQU   SWI                                                      00455000
IWADDNM  EQU   SWI                                                      00456000
WAWRNWTO EQU   SWI                                                      00457000
BLKPRC   EQU   SWI                                                      00458000
@NM00015 EQU   SWH                                                      00459000
CPSTPFL  EQU   SWH                                                      00460000
PROCSW   EQU   SWH                                                      00461000
CPFLGXX  EQU   SWH                                                      00462000
CPSYSFLG EQU   SWH                                                      00463000
@NM00014 EQU   SWH                                                      00464000
SEQUENCE EQU   SWE                                                      00465000
POVRX    EQU   SWE                                                      00466000
POVRD    EQU   SWE                                                      00467000
CONCAT   EQU   SWE                                                      00468000
PRCV     EQU   SWE                                                      00469000
PREF     EQU   SWE                                                      00470000
GPI      EQU   SWE                                                      00471000
PROCPLS  EQU   SWE                                                      00472000
CWATERM  EQU   AOSW4                                                    00473000
AODFWMSG EQU   AOSW4                                                    00474000
AOSWALOC EQU   AOSW4                                                    00475000
AOMSGTXT EQU   AOSW4                                                    00476000
AOWRNREQ EQU   AOSW4                                                    00477000
@NM00013 EQU   AOSW4                                                    00478000
AOTXTWRT EQU   AOSW1                                                    00479000
AOPRTSW  EQU   AOSW1                                                    00480000
AONOPLIB EQU   AOSW1                                                    00481000
AOILGLOP EQU   AOSW1                                                    00482000
AOIOERR  EQU   AOSW1                                                    00483000
AOVFBSW  EQU   AOSW1                                                    00484000
AOENDKSW EQU   AOSW1                                                    00485000
AOFSTPOS EQU   AOSW1                                                    00486000
IWAMSLEN EQU   CWAMSLEN                                                 00487000
RHALF5   EQU   COMWA+358                                                00488000
RHALF4   EQU   COMWA+356                                                00489000
RHALF3   EQU   COMWA+354                                                00490000
RHALF2   EQU   COMWA+352                                                00491000
RHALF1   EQU   COMWA+350                                                00492000
WASTMTNO EQU   COMWA+348                                                00493000
CWALABEL EQU   CWAMCSCA+1                                               00494000
IWAMCSCA EQU   CWAMCSCA                                                 00495000
AOLOCPL  EQU   COMWA+340                                                00496000
AOSUBSYS EQU   COMWA+336                                                00497000
AOSSOB   EQU   COMWA+332                                                00498000
AOSSIB   EQU   COMWA+328                                                00499000
AOQLOCEP EQU   COMWA+324                                                00500000
WAEXCPFX EQU   COMWA+316                                                00501000
WAJOBPFX EQU   COMWA+308                                                00502000
WAJBNAME EQU   COMWA+300                                                00503000
WAEXCRBA EQU   COMWA+292                                                00504000
WAJOBRBA EQU   COMWA+284                                                00505000
QPARM    EQU   COMWA+248                                                00506000
WAWRKLTH EQU   COMWA+244                                                00507000
WAMSGBUF EQU   COMWA+240                                                00508000
WANELPTR EQU   COMWA+236                                                00509000
RPLADDR  EQU   WARPL                                                    00510000
@NM00012 EQU   IWAIOSA+8                                                00511000
IWASACHN EQU   IWAIOSA+4                                                00512000
TRSAVE   EQU   IWAIOSA                                                  00513000
AOEPWORK EQU   COMWA+80                                                 00514000
AOSTAPRM EQU   COMWA+76                                                 00515000
AOJMRGEP EQU   COMWA+72                                                 00516000
NEXTPTR  EQU   COMWA+68                                                 00517000
BUFEND   EQU   COMWA+64                                                 00518000
BUFADDR  EQU   COMWA+60                                                 00519000
AOWSTMT  EQU   COMWA+56                                                 00520000
TERMRTN  EQU   COMWA+52                                                 00521000
TBUFCOPY EQU   COMWA+48                                                 00522000
TEXTBUFP EQU   COMWA+44                                                 00523000
JACTLPTR EQU   COMWA+40                                                 00524000
TNEXT2   EQU   COMWA+36                                                 00525000
TNEXT    EQU   COMWA+32                                                 00526000
IWAINTS0 EQU   COMWA+28                                                 00527000
QMGRP    EQU   COMWA+24                                                 00528000
CTRLWAP  EQU   COMWA+20                                                 00529000
SAVEPTR  EQU   COMWA+16                                                 00530000
QPARMP   EQU   COMWA+12                                                 00531000
IWACONID EQU   CWACONID                                                 00532000
IWAID    EQU   CWAID                                                    00533000
IWAL     EQU   CWAL                                                     00534000
@NM00011 EQU   EREPL+16                                                 00535000
@NM00010 EQU   EREPFLGS+1                                               00536000
@NM00009 EQU   EREPFLG1                                                 00537000
EREPRCUR EQU   EREPFLG1                                                 00538000
EREPLCWA EQU   EREPL                                                    00539000
@NM00008 EQU   TCBXTNT2+32                                              00540000
TCBRV181 EQU   TCBRV173                                                 00541000
TCBRV180 EQU   TCBRV173                                                 00542000
TCBRV179 EQU   TCBRV173                                                 00543000
TCBRV178 EQU   TCBRV173                                                 00544000
TCBRV177 EQU   TCBRV173                                                 00545000
TCBRV176 EQU   TCBRV173                                                 00546000
TCBRV175 EQU   TCBRV173                                                 00547000
TCBRV174 EQU   TCBRV173                                                 00548000
TCBRV172 EQU   TCBRV164                                                 00549000
TCBRV171 EQU   TCBRV164                                                 00550000
TCBRV170 EQU   TCBRV164                                                 00551000
TCBRV169 EQU   TCBRV164                                                 00552000
TCBRV168 EQU   TCBRV164                                                 00553000
TCBRV167 EQU   TCBRV164                                                 00554000
TCBRV166 EQU   TCBRV164                                                 00555000
TCBRV165 EQU   TCBRV164                                                 00556000
TCBRV163 EQU   TCBRV155                                                 00557000
TCBRV162 EQU   TCBRV155                                                 00558000
TCBRV161 EQU   TCBRV155                                                 00559000
TCBRV160 EQU   TCBRV155                                                 00560000
TCBRV159 EQU   TCBRV155                                                 00561000
TCBRV158 EQU   TCBRV155                                                 00562000
TCBRV157 EQU   TCBRV155                                                 00563000
TCBRV156 EQU   TCBRV155                                                 00564000
TCBRV154 EQU   TCBRV146                                                 00565000
TCBRV153 EQU   TCBRV146                                                 00566000
TCBRV152 EQU   TCBRV146                                                 00567000
TCBRV151 EQU   TCBRV146                                                 00568000
TCBRV150 EQU   TCBRV146                                                 00569000
TCBRV149 EQU   TCBRV146                                                 00570000
TCBRV148 EQU   TCBRV146                                                 00571000
TCBRV147 EQU   TCBRV146                                                 00572000
TCBRV145 EQU   TCBXTNT2+26                                              00573000
TCBRV144 EQU   TCBXTNT2+24                                              00574000
TCBCAUF  EQU   TCBXTNT2+20                                              00575000
TCBRV142 EQU   TCBXTNT2+16                                              00576000
TCBRSV49 EQU   TCBXTNT2+12                                              00577000
TCBEVENT EQU   TCBXTNT2+8                                               00578000
TCBRCMP  EQU   TCBXTNT2+5                                               00579000
TCBRSVAB EQU   TCBXTNT2+4                                               00580000
TCBGTFA  EQU   TCBGTF+1                                                 00581000
TCBRSV47 EQU   TCBTFLG                                                  00582000
TCBRSV46 EQU   TCBTFLG                                                  00583000
TCBRSV45 EQU   TCBTFLG                                                  00584000
TCBRSV44 EQU   TCBTFLG                                                  00585000
TCBRSV43 EQU   TCBTFLG                                                  00586000
TCBDSPIT EQU   TCBTFLG                                                  00587000
TCBERRTN EQU   TCBTFLG                                                  00588000
TCBASYNC EQU   TCBTFLG                                                  00589000
@NM00007 EQU   TCB+296                                                  00590000
TCBSVCA2 EQU   TCB+292                                                  00591000
TCBSWASA EQU   TCB+288                                                  00592000
TCBDBTB  EQU   TCB+284                                                  00593000
TCBRPT   EQU   TCB+280                                                  00594000
TCBRV141 EQU   TCBRV133                                                 00595000
TCBRV140 EQU   TCBRV133                                                 00596000
TCBRV139 EQU   TCBRV133                                                 00597000
TCBRV138 EQU   TCBRV133                                                 00598000
TCBRV137 EQU   TCBRV133                                                 00599000
TCBRV136 EQU   TCBRV133                                                 00600000
TCBRV135 EQU   TCBRV133                                                 00601000
TCBRV134 EQU   TCBRV133                                                 00602000
TCBRV132 EQU   TCBRV124                                                 00603000
TCBRV131 EQU   TCBRV124                                                 00604000
TCBRV130 EQU   TCBRV124                                                 00605000
TCBRV129 EQU   TCBRV124                                                 00606000
TCBRV128 EQU   TCBRV124                                                 00607000
TCBRV127 EQU   TCBRV124                                                 00608000
TCBRV126 EQU   TCBRV124                                                 00609000
TCBRV125 EQU   TCBRV124                                                 00610000
TCBRV123 EQU   TCBFBYT2                                                 00611000
TCBRV122 EQU   TCBFBYT2                                                 00612000
TCBECBNV EQU   TCBFBYT2                                                 00613000
TCBSSSYN EQU   TCBFBYT2                                                 00614000
TCBFPRAP EQU   TCBFBYT2                                                 00615000
TCBFDW   EQU   TCBFBYT2                                                 00616000
TCBFMW   EQU   TCBFBYT2                                                 00617000
TCBCNCB  EQU   TCBFBYT2                                                 00618000
TCBLLH   EQU   TCBFBYT1                                                 00619000
TCBRV113 EQU   TCBFBYT1                                                 00620000
TCBEOT   EQU   TCBFBYT1                                                 00621000
TCBRTM2  EQU   TCBFBYT1                                                 00622000
TCBPGNLY EQU   TCBFBYT1                                                 00623000
TCBNDIOS EQU   TCBFBYT1                                                 00624000
TCBACTIV EQU   TCBFBYT1                                                 00625000
TCBEOTFM EQU   TCBFBYT1                                                 00626000
TCBAFFN  EQU   TCB+274                                                  00627000
TCBCCPVI EQU   TCB+272                                                  00628000
TCBUKYSP EQU   TCB+268                                                  00629000
TCBMODE  EQU   TCBESTAE+3                                               00630000
TCBERTYP EQU   TCBESTAE+2                                               00631000
TCBRV314 EQU   TCBESTRM                                                 00632000
TCBRV313 EQU   TCBESTRM                                                 00633000
TCBRV312 EQU   TCBESTRM                                                 00634000
TCBRV311 EQU   TCBESTRM                                                 00635000
TCBRV310 EQU   TCBESTRM                                                 00636000
TCBRV309 EQU   TCBESTRM                                                 00637000
TCBRV308 EQU   TCBESTRM                                                 00638000
TCBETERM EQU   TCBESTRM                                                 00639000
TCBSCBKY EQU   TCBESTAE                                                 00640000
TCBRTM12 EQU   TCB+260                                                  00641000
TCBTCBID EQU   TCB+256                                                  00642000
TCBRSV96 EQU   TCB+252                                                  00643000
TCBSWA   EQU   TCB+248                                                  00644000
TCBFOEA  EQU   TCBFOE+1                                                 00645000
TCBRSV42 EQU   TCBFOE                                                   00646000
TCBRV306 EQU   TCB+240                                                  00647000
TCBRSV41 EQU   TCB+239                                                  00648000
TCBTID   EQU   TCB+238                                                  00649000
TCBRSVAA EQU   TCB+237                                                  00650000
TCBABCUR EQU   TCB+236                                                  00651000
TCBTMSAV EQU   TCB+232                                                  00652000
TCBIOTIM EQU   TCB+228                                                  00653000
TCBRTWA  EQU   TCB+224                                                  00654000
TCBBACK  EQU   TCB+220                                                  00655000
TCBTIRB  EQU   TCB+216                                                  00656000
TCBAECB  EQU   TCB+212                                                  00657000
TCBEXT2A EQU   TCBEXT2+1                                                00658000
TCBRSV39 EQU   TCBEXT2                                                  00659000
TCBSTMCT EQU   TCB+207                                                  00660000
TCBSYSCT EQU   TCB+206                                                  00661000
TCBRSV37 EQU   TCB+205                                                  00662000
TCBEXSVC EQU   TCBDAR                                                   00663000
TCBDARMS EQU   TCBDAR                                                   00664000
TCBDARWT EQU   TCBDAR                                                   00665000
TCBDARO  EQU   TCBDAR                                                   00666000
TCBDARMC EQU   TCBDARC                                                  00667000
TCBDARD  EQU   TCBDAR                                                   00668000
TCBDARS  EQU   TCBDAR                                                   00669000
TCBDARP  EQU   TCBDAR                                                   00670000
TCBGTOFM EQU   TCBFLGS7                                                 00671000
TCBADMP  EQU   TCBFLGS7                                                 00672000
TCBRSTSK EQU   TCBFLGS7                                                 00673000
TCBSVCS  EQU   TCBFLGS7                                                 00674000
TCBSTACK EQU   TCBFLGS7                                                 00675000
TCBRSV34 EQU   TCBFLGS7                                                 00676000
TCBRSV33 EQU   TCBFLGS7                                                 00677000
TCBGPECB EQU   TCBFLGS7                                                 00678000
TCBNTJS  EQU   TCBFLGS6                                                 00679000
TCBAPG   EQU   TCBFLGS6                                                 00680000
TCBMIGR  EQU   TCBFLGS6                                                 00681000
TCBRV303 EQU   TCBFLGS6                                                 00682000
TCBSPVLK EQU   TCBFLGS6                                                 00683000
TCBCPU   EQU   TCBFLGS6                                                 00684000
TCBPIE17 EQU   TCBFLGS6                                                 00685000
TCBRV    EQU   TCBFLGS6                                                 00686000
TCBRSV79 EQU   TCBNDSP5                                                 00687000
TCBRSV78 EQU   TCBNDSP5                                                 00688000
TCBRSV77 EQU   TCBNDSP5                                                 00689000
TCBRSV76 EQU   TCBNDSP5                                                 00690000
TCBRSV75 EQU   TCBNDSP5                                                 00691000
TCBRSV74 EQU   TCBNDSP5                                                 00692000
TCBRSV95 EQU   TCBNDSP5                                                 00693000
TCBRSV94 EQU   TCBNDSP5                                                 00694000
TCBRSV93 EQU   TCBNDSP4                                                 00695000
TCBRSV92 EQU   TCBNDSP4                                                 00696000
TCBRSV91 EQU   TCBNDSP4                                                 00697000
TCBRSV90 EQU   TCBNDSP4                                                 00698000
TCBRSV89 EQU   TCBNDSP4                                                 00699000
TCBRSV88 EQU   TCBNDSP4                                                 00700000
TCBRSV87 EQU   TCBNDSP4                                                 00701000
TCBRSV86 EQU   TCBNDSP4                                                 00702000
TCBEXT1A EQU   TCBEXT1+1                                                00703000
TCBRSV32 EQU   TCBEXT1                                                  00704000
TCBEXCPD EQU   TCB+192                                                  00705000
TCBIOBRC EQU   TCB+188                                                  00706000
TCBDDWTC EQU   TCB+186                                                  00707000
TCBDDEXC EQU   TCB+184                                                  00708000
TCBJSCBB EQU   TCBJSCB+1                                                00709000
@NM00006 EQU   TCBRECDE                                                 00710000
TCBREC   EQU   TCBRECDE                                                 00711000
TCBMDIDS EQU   TCB+176                                                  00712000
TCBNDINT EQU   TCBNDSP3                                                 00713000
TCBRSV27 EQU   TCBNDSP3                                                 00714000
TCBRSV26 EQU   TCBNDSP3                                                 00715000
TCBRSV25 EQU   TCBNDSP3                                                 00716000
TCBRSV24 EQU   TCBNDSP3                                                 00717000
TCBSRBND EQU   TCBNDSP3                                                 00718000
TCBRV302 EQU   TCBNDSP3                                                 00719000
TCBLJSND EQU   TCBNDSP3                                                 00720000
TCBABE   EQU   TCBNDSP2                                                 00721000
TCBDSS   EQU   TCBNDSP2                                                 00722000
TCBOWAIT EQU   TCBNDSP2                                                 00723000
TCBIWAIT EQU   TCBNDSP2                                                 00724000
TCBNDTS  EQU   TCBNDSP2                                                 00725000
TCBNDSVC EQU   TCBNDSP2                                                 00726000
TCBSTPP  EQU   TCBNDSP2                                                 00727000
TCBABD   EQU   TCBNDSP2                                                 00728000
TCBRSV22 EQU   TCBNDSP1                                                 00729000
TCBPIEND EQU   TCBNDSP1                                                 00730000
TCBTPSP  EQU   TCBNDSP1                                                 00731000
TCBDDRND EQU   TCBNDSP1                                                 00732000
TCBRSPND EQU   TCBNDSP1                                                 00733000
TCBRSTND EQU   TCBNDSP1                                                 00734000
TCBDARPN EQU   TCBNDSP1                                                 00735000
TCBDARTN EQU   TCBNDSP1                                                 00736000
TCBNDSP0 EQU   TCBNDSP                                                  00737000
TCBUSER  EQU   TCB+168                                                  00738000
TCBTCTB  EQU   TCBTCT+1                                                 00739000
TCBRSV9C EQU   TCBTCTGF                                                 00740000
TCBRSV9B EQU   TCBTCTGF                                                 00741000
TCBRSV9A EQU   TCBTCTGF                                                 00742000
TCBRSV99 EQU   TCBTCTGF                                                 00743000
TCBRSV98 EQU   TCBTCTGF                                                 00744000
TCBRSV97 EQU   TCBTCTGF                                                 00745000
TCBRSV20 EQU   TCBTCTGF                                                 00746000
TCBSMFGF EQU   TCBTCTGF                                                 00747000
TCBSTABB EQU   TCBSTAB+1                                                00748000
TCBSTCUR EQU   TCBNSTAE                                                 00749000
TCBRV301 EQU   TCBNSTAE                                                 00750000
TCBSYNCH EQU   TCBNSTAE                                                 00751000
TCBHALT  EQU   TCBNSTAE                                                 00752000
TCBPPSUP EQU   TCBNSTAE                                                 00753000
TCB33E   EQU   TCBNSTAE                                                 00754000
TCBQUIES EQU   TCBNSTAE                                                 00755000
TCBSTABE EQU   TCBNSTAE                                                 00756000
TCBAQE   EQU   TCB+156                                                  00757000
TCBPQE   EQU   TCB+152                                                  00758000
TCBTSDP  EQU   TCB+151                                                  00759000
TCBTSLP  EQU   TCB+150                                                  00760000
TCBSTPCT EQU   TCB+149                                                  00761000
TCBCPUBN EQU   TCBTSFLG                                                 00762000
TCBDYDSP EQU   TCBTSFLG                                                 00763000
TCBRSV18 EQU   TCBTSFLG                                                 00764000
TCBRSV17 EQU   TCBTSFLG                                                 00765000
TCBTIOTG EQU   TCBTSFLG                                                 00766000
TCBATT   EQU   TCBTSFLG                                                 00767000
TCBSTPPR EQU   TCBTSFLG                                                 00768000
TCBRV300 EQU   TCBTSTSK                                                 00769000
TCBECB   EQU   TCB+144                                                  00770000
TCBIQE   EQU   TCB+140                                                  00771000
TCBLTC   EQU   TCB+136                                                  00772000
TCBOTC   EQU   TCB+132                                                  00773000
TCBNTC   EQU   TCB+128                                                  00774000
TCBJSTCA EQU   TCBJSTCB+1                                               00775000
TCBRSV16 EQU   TCBJSTCB                                                 00776000
TCBTQET  EQU   TCBTME                                                   00777000
TCBTCB   EQU   TCB+116                                                  00778000
TCBFSAB  EQU   TCBFSA+1                                                 00779000
TCBQEL   EQU   TCBFSA                                                   00780000
TCBGRS15 EQU   TCBGRS+60                                                00781000
TCBGRS14 EQU   TCBGRS+56                                                00782000
TCBGRS13 EQU   TCBGRS+52                                                00783000
TCBGRS12 EQU   TCBGRS+48                                                00784000
TCBGRS11 EQU   TCBGRS+44                                                00785000
TCBGRS10 EQU   TCBGRS+40                                                00786000
TCBGRS9  EQU   TCBGRS+36                                                00787000
TCBGRS8  EQU   TCBGRS+32                                                00788000
TCBGRS7  EQU   TCBGRS+28                                                00789000
TCBGRS6  EQU   TCBGRS+24                                                00790000
TCBGRS5  EQU   TCBGRS+20                                                00791000
TCBGRS4  EQU   TCBGRS+16                                                00792000
TCBGRS3  EQU   TCBGRS+12                                                00793000
TCBGRS2  EQU   TCBGRS+8                                                 00794000
TCBGRS1  EQU   TCBGRS+4                                                 00795000
TCBGRS0  EQU   TCBGRS                                                   00796000
TCBJPQB  EQU   TCBJPQ+1                                                 00797000
TCBRSV15 EQU   TCBPURGE                                                 00798000
TCBRSV14 EQU   TCBPURGE                                                 00799000
TCBRSV13 EQU   TCBPURGE                                                 00800000
TCBRSV12 EQU   TCBPURGE                                                 00801000
TCBRSV11 EQU   TCBPURGE                                                 00802000
TCBRSV10 EQU   TCBPURGE                                                 00803000
TCBRSV09 EQU   TCBPURGE                                                 00804000
TCBJPQF  EQU   TCBPURGE                                                 00805000
TCBJLB   EQU   TCB+40                                                   00806000
TCBLLS   EQU   TCB+36                                                   00807000
TCBDSP   EQU   TCB+35                                                   00808000
TCBLMP   EQU   TCB+34                                                   00809000
TCBPNDSP EQU   TCBFLGS5                                                 00810000
TCBFCD1  EQU   TCBFLGS5                                                 00811000
TCBSTP   EQU   TCBFLGS5                                                 00812000
TCBSYS   EQU   TCBFLGS5                                                 00813000
TCBANDSP EQU   TCBFLGS5                                                 00814000
TCBPAGE  EQU   TCBFLGS5                                                 00815000
TCBUXNDF EQU   TCBABWF                                                  00816000
TCBFC    EQU   TCBFLGS5                                                 00817000
TCBONDSP EQU   TCBFLGS4                                                 00818000
TCBMPCND EQU   TCBFLGS4                                                 00819000
TCBMPCVQ EQU   TCBFLGS4                                                 00820000
TCBUXNDV EQU   TCBFLGS4                                                 00821000
TCBHNDSP EQU   TCBFLGS4                                                 00822000
TCBRQENA EQU   TCBFLGS4                                                 00823000
TCBSER   EQU   TCBFLGS4                                                 00824000
TCBNDUMP EQU   TCBFLGS4                                                 00825000
TCBDWSTA EQU   TCBFLGS3                                                 00826000
TCBRSV08 EQU   TCBFLGS3                                                 00827000
TCBRSV07 EQU   TCBFLGS3                                                 00828000
TCBRSV06 EQU   TCBFLGS3                                                 00829000
TCBABGM  EQU   TCBFLGS3                                                 00830000
TCBABTRM EQU   TCBFLGS3                                                 00831000
TCBADINP EQU   TCBFLGS3                                                 00832000
TCBFSM   EQU   TCBFLGS3                                                 00833000
TCBFTS   EQU   TCBFLGS2                                                 00834000
TCBFETXR EQU   TCBFLGS2                                                 00835000
TCBFDSOP EQU   TCBFLGS2                                                 00836000
TCBFJMC  EQU   TCBFLGS2                                                 00837000
TCBFSMC  EQU   TCBFLGS2                                                 00838000
TCBFABOP EQU   TCBFLGS2                                                 00839000
TCBFSTI  EQU   TCBFLGS2                                                 00840000
TCBFOINP EQU   TCBFLGS2                                                 00841000
TCBFX    EQU   TCBFLGS1                                                 00842000
TCBFS    EQU   TCBFLGS1                                                 00843000
TCBFT    EQU   TCBFLGS1                                                 00844000
TCBPDUMP EQU   TCBFLGS1                                                 00845000
TCBNONPR EQU   TCBFLGS1                                                 00846000
TCBFERA  EQU   TCBFLGS1                                                 00847000
TCBFE    EQU   TCBFLGS1                                                 00848000
TCBFA    EQU   TCBFLGS1                                                 00849000
TCBZERO  EQU   TCBPKF                                                   00850000
TCBFLAG  EQU   TCBPKF                                                   00851000
TCBMSSB  EQU   TCBMSS+1                                                 00852000
TCBRSV03 EQU   TCBMSS                                                   00853000
TCBTRNB  EQU   TCBTRN+1                                                 00854000
TCBRSV02 EQU   TCBABF                                                   00855000
TCBOLTEP EQU   TCBABF                                                   00856000
TCBTCP   EQU   TCBABF                                                   00857000
TCBTCPP  EQU   TCBABF                                                   00858000
TCBRSV01 EQU   TCBABF                                                   00859000
TCBGRPH  EQU   TCBABF                                                   00860000
TCBNOCHK EQU   TCBABF                                                   00861000
TCBMOD91 EQU   TCBABF                                                   00862000
TCBCMPC  EQU   TCBCMP+1                                                 00863000
TCBRV318 EQU   TCBCMSG                                                  00864000
TCBRV317 EQU   TCBCIND                                                  00865000
TCBRV316 EQU   TCBCWTO                                                  00866000
TCBCASID EQU   TCBCDBL                                                  00867000
TCBNOCC  EQU   TCBSTCC                                                  00868000
TCBDMPO  EQU   TCBCPP                                                   00869000
TCBCSTEP EQU   TCBCMPF                                                  00870000
TCBCREQ  EQU   TCBCMPF                                                  00871000
TCBTIO   EQU   TCB+12                                                   00872000
TCBDEB   EQU   TCB+8                                                    00873000
TCBPIEA  EQU   TCBPIE+1                                                 00874000
TCBPM    EQU   TCBPMASK                                                 00875000
@NM00005 EQU   TCBPMASK                                                 00876000
TCBRBP   EQU   TCB                                                      00877000
TCBFRS6  EQU   TCBFRS+24                                                00878000
TCBFRS4  EQU   TCBFRS+16                                                00879000
TCBFRS2  EQU   TCBFRS+8                                                 00880000
TCBFRS0  EQU   TCBFRS                                                   00881000
JSCBCSCB EQU   JSCBSEC1+68                                              00882000
JSCBPMG  EQU   JSCBWTP+2                                                00883000
JSCBWTSP EQU   JSCBWTP+1                                                00884000
JSCRSV23 EQU   JSCBWTFG                                                 00885000
JSCRSV22 EQU   JSCBWTFG                                                 00886000
JSCRSV21 EQU   JSCBWTFG                                                 00887000
JSCRSV20 EQU   JSCBWTFG                                                 00888000
JSCRSV19 EQU   JSCBWTFG                                                 00889000
JSCRSV18 EQU   JSCBWTFG                                                 00890000
JSCBRET  EQU   JSCBWTFG                                                 00891000
JSCBIOFG EQU   JSCBWTFG                                                 00892000
@NM00002 EQU   JSCBSEC1+60                                              00893000
JSCBQMPI EQU   JSCBSEC1+56                                              00894000
JSCBPMSG EQU   JSCBSWT1                                                 00895000
JSCRSV16 EQU   JSCBSWT1                                                 00896000
JSCRSV15 EQU   JSCBSWT1                                                 00897000
JSCRSV14 EQU   JSCBSWT1                                                 00898000
JSCRSV13 EQU   JSCBSWT1                                                 00899000
JSCRSV12 EQU   JSCBSWT1                                                 00900000
JSCRSV11 EQU   JSCBSWT1                                                 00901000
JSCBPASS EQU   JSCBSWT1                                                 00902000
JSCBTTTR EQU   JSCBSEC1+52                                              00903000
JSCRSV10 EQU   JSCBSEC1+49                                              00904000
JSCBAUTH EQU   JSCBOPTS                                                 00905000
JSCSIOTS EQU   JSCBOPTS                                                 00906000
JSCRSV08 EQU   JSCBOPTS                                                 00907000
JSCRSV07 EQU   JSCBOPTS                                                 00908000
JSCRSV06 EQU   JSCBOPTS                                                 00909000
JSCBLONG EQU   JSCBOPTS                                                 00910000
JSCRSV05 EQU   JSCBOPTS                                                 00911000
JSCRSV04 EQU   JSCBOPTS                                                 00912000
JSCBSECB EQU   JSCBSEC1+44                                              00913000
JSCRSV03 EQU   JSCBSEC1+41                                              00914000
JSCBSTEP EQU   JSCBSEC1+40                                              00915000
JSCBDCBA EQU   JSCBDCB+1                                                00916000
JSCRSV02 EQU   JSCBDCB                                                  00917000
JSCBID   EQU   JSCBSEC1+32                                              00918000
JSCBDBTB EQU   JSCBSEC1+28                                              00919000
JSCBIJSC EQU   JSCBSEC1+24                                              00920000
JSCBTCBP EQU   JSCBSEC1+20                                              00921000
JSCBPCC  EQU   JSCBSEC1+16                                              00922000
JSCBTCP  EQU   JSCBSEC1+12                                              00923000
JSCBSHR  EQU   JSCBSEC1+8                                               00924000
JSCHPCEA EQU   JSCHPCE+1                                                00925000
JSCRSV32 EQU   JSCHPCE                                                  00926000
JSCRSV01 EQU   JSCBSEC1                                                 00927000
@NM00001 EQU   IEZJSCB                                                  00928000
*                                      END UNREFERENCED COMPONENTS      00929000
@ENDDATA EQU   *                                                        00930000
         END   IEFNB9IT,(C'PLS2127',0701,78055)                         00931000
./  ADD  SSI=80550267,NAME=IEFNB901
         TITLE '    %DCL                                               *00001000
                        '                                               00002000
IEFNB901 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEFNB901  78.055'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @08,@01                                             0001 00016000
         USING @DATD,@08                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @08,8(,@13)                                         0001 00020000
         LR    @13,@08                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
****************************************************************Y02668  00023000
*MODULE TRACE CODE - FOR TESTING.                               Y02668  00024000
        L     15,TRACEV           LOAD TRACE RTNE ADDR.         Y02668  00025000
        CNOP  2,4                                               Y02668  00026000
        BALR  14,15               ENTER MOD ID IN TRACE RECORD. Y02668  00027000
TRACEV  DC    V(TRACE)            TRACE RTNE ADDR.              Y02668  00028000
        DC    C'B901'             MOD ID USED BY TRACE.         Y02668  00029000
*TRACE RETURNS HERE.                                            Y02668  00030000
****************************************************************Y02668  00031000
*   REGSAVE = R1;                   /* SAVE REG 1 CONTENTS           */ 00032000
         ST    R1,REGSAVE                                          0055 00033000
*   LWAPTR = R10;                   /* EST. ADDR. TO LWA             */ 00034000
         LR    LWAPTR,R10                                          0056 00035000
*   AMPRMPTR = ADDR(AMPRMLST);      /* INIT @ OF PARM LIST           */ 00036000
         LA    AMPRMPTR,AMPRMLST                                   0057 00037000
*   DATACT = TEXTNUM;               /* SAVE TEXT COUNT OF SUBPARMS   */ 00038000
         L     @14,TNUMPX(,LWAPTR)                                 0058 00039000
         MVC   DATACT(1),TEXTNUM(@14)                              0058 00040000
*   AMPRMLST = AMPRMLST &&AMPRMLST; /* CLEAR PARM LIST               */ 00041000
         XC    AMPRMLST(24),AMPRMLST                               0059 00042000
*   TOTLNGTH = TOTLNGTH && TOTLNGTH;                               0060 00043000
         LH    @14,TOTLNGTH                                        0060 00044000
         LR    @09,@14                                             0060 00045000
         XR    @09,@14                                             0060 00046000
         STH   @09,TOTLNGTH                                        0060 00047000
*   SWITCHES = SWITCHES && SWITCHES; /* CLEAR INTERNAL SWITCHES      */ 00048000
         XC    SWITCHES(1),SWITCHES                                0061 00049000
*   INTXTLPT = TLENPX;              /* @ OF FIRST LENGTH BYTE IN   0062 00050000
*                                      INTERNAL TEXT                 */ 00051000
*                                                                  0062 00052000
         L     INTXTLPT,TLENPX(,LWAPTR)                            0062 00053000
*   /*****************************************************************/ 00054000
*   /*                                                               */ 00055000
*   /* THE FOLLOWING CODE CHECKS FOR A NULL AMP PARAMETER. IF THE JCL*/ 00056000
*   /* TEXT COUNT FIELD IS ZERO THEN AMP='' WAS SPECIFIED. IN THIS   */ 00057000
*   /* CASE THE NEXT LOOP IS BYPASSED SINCE NO DATA HAS TO BE MOVED  */ 00058000
*   /* FOR THE EXIT BUFFER. THE LENGTH OF ZERO IN THE EXIT DATA      */ 00059000
*   /* BUFFER INDICATES A NULL PARAMETER TO THE EXIT ROUTINE         */ 00060000
*   /*                                                               */ 00061000
*   /*****************************************************************/ 00062000
*                                                                  0063 00063000
*   IF DATALEN = 0 THEN                                            0063 00064000
         CLI   DATALEN(INTXTLPT),0                                 0063 00065000
         BNE   @RF00063                                            0063 00066000
*     DO;                                                          0064 00067000
*       R0 = 16;                                                   0065 00068000
         LA    R0,16                                               0065 00069000
*       GEN (GETMAIN R,LV=(0));     /* GET CORE FOR AMP BUFFER       */ 00070000
         GETMAIN R,LV=(0)                                               00071000
*       AMDATAPT = R1;                                             0067 00072000
         ST    R1,AMDATAPT                                         0067 00073000
*       R1 = REGSAVE;                                              0068 00074000
         L     R1,REGSAVE                                          0068 00075000
*       FREELEN = 16;     /* SAVE LENGTH FOR FREEMAIN AFTER EXIT */     00076000
         LA    FREELEN,16                                          0069 00077000
*       DBUFLEN = 0;                                               0070 00078000
         L     @14,AMDATAPT                                        0070 00079000
         SLR   @09,@09                                             0070 00080000
         STH   @09,DBUFLEN(,@14)                                   0070 00081000
*       GO TO CALLEXIT;                                            0071 00082000
         B     CALLEXIT                                            0071 00083000
*     END;                                                         0072 00084000
*                                                                  0072 00085000
*MOVEDATA:                                                         0073 00086000
*                                                                  0073 00087000
*   /*****************************************************************/ 00088000
*   /*                                                               */ 00089000
*   /* MOVEDATA LOOP IS EXECUTED TWICE FOR EACH INTERNAL TEXT COUNT. */ 00090000
*   /* THE FIRST TIME THROUGH THE TOTAL LENGTH OF ALL AMP            */ 00091000
*   /* SUBPARAMETERS ( A JCL CONTINUATION IS COUNTED AS A            */ 00092000
*   /* SUBPARAMETER IN JCL INTERNAL TEXT) IS CALCULATED. THEN A      */ 00093000
*   /* GETMAIN IS ISSUED FOR THE TOTAL LENGTH OF THE AMP PARAMETER   */ 00094000
*   /* DATA PLUS A 2 BYTE LENGTH FIELD. ON THE SECOND PASS THROUGH   */ 00095000
*   /* THE LOOP THE AMP DATA IS MOVED FROM THE JCL INTERNAL TEXT     */ 00096000
*   /* BUFFER(S) INTO THE OBTAINED CORE. THIS BUFFER IS THEN POINTED */ 00097000
*   /* TO FROM THE FIRST WORD OF THE INTERFACE WITH THE EXIT RTN.    */ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0073 00101000
*   DO I = DATACT + DATACT TO 2 BY -1;                             0073 00102000
@RF00063 DS    0H                                                  0073 00103000
MOVEDATA SLR   @14,@14                                             0073 00104000
         IC    @14,DATACT                                          0073 00105000
         LR    I,@14                                               0073 00106000
         ALR   I,@14                                               0073 00107000
         B     @DE00073                                            0073 00108000
@DL00073 DS    0H                                                  0074 00109000
*     TOTLNGTH=TOTLNGTH+DATALEN+1;  /* PLUS ONE FOR COMMA            */ 00110000
*                                                                  0074 00111000
         LA    @14,1                                               0074 00112000
         SLR   @09,@09                                             0074 00113000
         IC    @09,DATALEN(,INTXTLPT)                              0074 00114000
         AH    @09,TOTLNGTH                                        0074 00115000
         ALR   @09,@14                                             0074 00116000
         STH   @09,TOTLNGTH                                        0074 00117000
*     /***************************************************************/ 00118000
*     /*                                                             */ 00119000
*     /* OBTAIN SPACE FOR AMP DATA BUFFER                            */ 00120000
*     /*                                                             */ 00121000
*     /***************************************************************/ 00122000
*                                                                  0075 00123000
*     IF I = DATACT +1 THEN                                        0075 00124000
         SLR   @05,@05                                             0075 00125000
         IC    @05,DATACT                                          0075 00126000
         ALR   @14,@05                                             0075 00127000
         CR    I,@14                                               0075 00128000
         BNE   @RF00075                                            0075 00129000
*       DO;                                                        0076 00130000
*         TOTLNGTH=TOTLNGTH-1;      /*  -1 NO COMMA ON THE END       */ 00131000
         BCTR  @09,0                                               0077 00132000
         STH   @09,TOTLNGTH                                        0077 00133000
*         R0 = TOTLNGTH + 2;        /* LENGTH OF ALL AMP DATA +    0078 00134000
*                                      LENGTH FIELD                  */ 00135000
         AH    @09,@CH00143                                        0078 00136000
         LR    R0,@09                                              0078 00137000
*         GEN (GETMAIN  R,LV=(0));  /* GET CORE FOR AMP DATA BUFFER  */ 00138000
         GETMAIN  R,LV=(0)                                              00139000
*         AMDATAPT = R1;                                           0080 00140000
         ST    R1,AMDATAPT                                         0080 00141000
*         R1 = REGSAVE;                                            0081 00142000
         L     R1,REGSAVE                                          0081 00143000
*         INTXTLPT = TLENPX;                                       0082 00144000
         L     INTXTLPT,TLENPX(,LWAPTR)                            0082 00145000
*         DBUFLEN = TOTLNGTH;                                      0083 00146000
         L     @14,AMDATAPT                                        0083 00147000
         MVC   DBUFLEN(2,@14),TOTLNGTH                             0083 00148000
*         DATADISP = '03'X;                                        0084 00149000
         LA    @14,3                                               0084 00150000
         STH   @14,DATADISP                                        0084 00151000
*       END;                                                       0085 00152000
*                                                                  0085 00153000
*     /***************************************************************/ 00154000
*     /*                                                             */ 00155000
*     /* THIS CODE MOVES ONE AMP SUBPARM INTO BUFFER FOR EXIT        */ 00156000
*     /*                                                             */ 00157000
*     /***************************************************************/ 00158000
*                                                                  0086 00159000
*     IF I <= DATACT + 1 THEN                                      0086 00160000
@RF00075 LA    @14,1                                               0086 00161000
         SLR   @09,@09                                             0086 00162000
         IC    @09,DATACT                                          0086 00163000
         ALR   @09,@14                                             0086 00164000
         CR    I,@09                                               0086 00165000
         BH    @RF00086                                            0086 00166000
*       DO;                         /* MOVE AMP DATA                 */ 00167000
*         DATABUF (DATADISP:DATADISP+DATALEN-1) = AMEQTEXT;        0088 00168000
         L     @09,AMDATAPT                                        0088 00169000
         LH    @05,DATADISP                                        0088 00170000
         ALR   @05,@09                                             0088 00171000
         BCTR  @05,0                                               0088 00172000
         SLR   @07,@07                                             0088 00173000
         IC    @07,DATALEN(,INTXTLPT)                              0088 00174000
         LR    @06,@07                                             0088 00175000
         BCTR  @06,0                                               0088 00176000
         LR    @09,INTXTLPT                                        0088 00177000
         ALR   @09,@14                                             0088 00178000
         EX    @06,@SM00843                                        0088 00179000
*         DATADISP = DATADISP + DATALEN; /* INCR OFFSET INTO AMP DATA   00180000
*                                      BUFF                          */ 00181000
         LH    @09,DATADISP                                        0089 00182000
         ALR   @09,@07                                             0089 00183000
         STH   @09,DATADISP                                        0089 00184000
*         IF I > 2 THEN             /* IF NOT LAST SUBPARAMETER      */ 00185000
         CH    I,@CH00143                                          0090 00186000
         BNH   @RF00090                                            0090 00187000
*           DO;                     /* THEN EXECUTE THE FOLLOWING    */ 00188000
*             DATABUF(DATADISP:DATADISP)=','; /* INSERT COMMA        */ 00189000
         L     @05,AMDATAPT                                        0092 00190000
         ALR   @05,@09                                             0092 00191000
         BCTR  @05,0                                               0092 00192000
         MVI   DATABUF(@05),C','                                   0092 00193000
*             DATADISP=DATADISP+1;  /* UPDATE POINTER PAST COMMA     */ 00194000
         ALR   @09,@14                                             0093 00195000
         STH   @09,DATADISP                                        0093 00196000
*           END;                                                   0094 00197000
*       END;                                                       0095 00198000
*                                                                  0095 00199000
@RF00090 DS    0H                                                  0096 00200000
*     /***************************************************************/ 00201000
*     /*                                                             */ 00202000
*     /* THIS CODE RESETS POINTERS IN LWA FOR VGK TO FIND NEXT KEY   */ 00203000
*     /*       .RESET @ OF TEXT LENGTH BYTE (TLENPX).                */ 00204000
*     /*       .RESET LENGTH OF CURRENT TEXT FIELD (TLEN)            */ 00205000
*     /*       .RESET COUNT OF NUMBER OF SUBPARAMETERS TO PROCESS    */ 00206000
*     /* (TCT)                                                       */ 00207000
*     /*                                                             */ 00208000
*     /***************************************************************/ 00209000
*                                                                  0096 00210000
*     IF I = '02'X THEN                                            0096 00211000
@RF00086 CH    I,@CH00825                                          0096 00212000
         BNE   @RF00096                                            0096 00213000
*       DO;                                                        0097 00214000
*         TLENPX = INTXTLPT;                                       0098 00215000
         ST    INTXTLPT,TLENPX(,LWAPTR)                            0098 00216000
*         TLEN = DATALEN;                                          0099 00217000
         SLR   @14,@14                                             0099 00218000
         IC    @14,DATALEN(,INTXTLPT)                              0099 00219000
         ST    @14,TLEN(,LWAPTR)                                   0099 00220000
*         TCT = TNUM;                                              0100 00221000
         MVC   TCT(4,LWAPTR),TNUM(LWAPTR)                          0100 00222000
*       END;                                                       0101 00223000
*     INTXTLPT = INTXTLPT + DATALEN + 1;                           0102 00224000
@RF00096 LR    @14,INTXTLPT                                        0102 00225000
         SLR   @09,@09                                             0102 00226000
         IC    @09,DATALEN(,INTXTLPT)                              0102 00227000
         ALR   @14,@09                                             0102 00228000
         AH    @14,@CH00101                                        0102 00229000
         LR    INTXTLPT,@14                                        0102 00230000
*   END MOVEDATA;                                                  0103 00231000
         BCTR  I,0                                                 0103 00232000
@DE00073 CH    I,@CH00143                                          0103 00233000
         BNL   @DL00073                                            0103 00234000
*   FREELEN = DBUFLEN+'02'X;/* SAVE LENGTH FOR FREEMAIN AFTER EXIT */   00235000
*                                                                  0104 00236000
         LA    FREELEN,2                                           0104 00237000
         L     @14,AMDATAPT                                        0104 00238000
         AH    FREELEN,DBUFLEN(,@14)                               0104 00239000
*CALLEXIT:                                                         0105 00240000
*   CNBLKPTR = ADDR(JFCB);          /* INIT @ OF CONTROL BLOCK       */ 00241000
*                                                                  0105 00242000
CALLEXIT LA    @14,JFCB(,LWAPTR)                                   0105 00243000
         ST    @14,CNBLKPTR                                        0105 00244000
*   /*****************************************************************/ 00245000
*   /*                                                               */ 00246000
*   /* EXIT TO AMP KEYWORD PROCESSSING ROUTINE                       */ 00247000
*   /*                                                               */ 00248000
*   /*****************************************************************/ 00249000
*                                                                  0106 00250000
*   GENERATE;                                                      0106 00251000
        LOAD  EP=IEFVAMP       LOAD AMP INTERPRETER                     00252000
*   AMPADDR = R0;                   /* SET UP ADDR TO CALL EXIT      */ 00253000
         LR    AMPADDR,R0                                          0107 00254000
*   CALL IEFNB902 (AMPRMLST);       /* GO TO AM= INTERPRETER         */ 00255000
         LA    @14,AMPRMLST                                        0108 00256000
         ST    @14,@AL00001                                        0108 00257000
         LR    @15,AMPADDR                                         0108 00258000
         LA    @01,@AL00001                                        0108 00259000
         BALR  @14,@15                                             0108 00260000
*   RETCODE = RF;                   /* SAVE RETURN CODE              */ 00261000
         ST    RF,RETCODE                                          0109 00262000
*   GENERATE;                                                      0110 00263000
        DELETE  EP=IEFVAMP    DELETE AMP INTERPRETER                    00264000
*   R1 = REGSAVE;                                                  0111 00265000
*                                                                  0111 00266000
         L     R1,REGSAVE                                          0111 00267000
*   /*****************************************************************/ 00268000
*   /*                                                               */ 00269000
*   /* UPON RETURN FROM THE DATA MANAGEMENT INTERPRETER ROUTINE:     */ 00270000
*   /*       .FREE THE BUFFER FOR THE AM= JCL DATA.                  */ 00271000
*   /*       .PUT OUT ANY MESSAGES IN MESSAGE LIST.                  */ 00272000
*   /*       .FREE EACH MESSAGE BUFFER IN LIST.                      */ 00273000
*   /*       .IF EXTENSION BLOCKS EXIST ASSIGN A TTR FOR EACH, AND   */ 00274000
*   /* CHAIN IT FROM THE JFCB ACCORDING TO THE OFFSET ADDRESS IN THE */ 00275000
*   /* PARAMETER LIST.                                               */ 00276000
*   /*       ..WRITE ANY EXTENSION BLOCKS TO THE QUEUE.              */ 00277000
*   /*       ..FREE THE IN CORE BUFFER FOR THE EXTENSION BLOCK.      */ 00278000
*   /*       .IF THE RETURN CODE IN REGISTER 15 IS NON-ZERO THE      */ 00279000
*   /* JOBFAIL BIT IS SET IN THE IWA.                                */ 00280000
*   /*                                                               */ 00281000
*   /*****************************************************************/ 00282000
*                                                                  0112 00283000
*   R0 = FREELEN;               /* SET LENGTH OF DATA BUFFER     */     00284000
         LR    R0,FREELEN                                          0112 00285000
*   R1 = AMDATAPT;                  /* INIT @ OF DATA BUFFER         */ 00286000
         L     R1,AMDATAPT                                         0113 00287000
*   GENERATE;                                                      0114 00288000
         FREEMAIN R,LV=(0),A=(1) FREE JCL DATA BUFFER                   00289000
*   R1 = REGSAVE;                   /* RESTORE CONTENTS OF REG 1     */ 00290000
*                                                                  0115 00291000
         L     R1,REGSAVE                                          0115 00292000
*   /*****************************************************************/ 00293000
*   /*                                                               */ 00294000
*   /* DO WHILE MSGBUFPT Â¬= 0 LOOP THROUGH MESSAGE LIST. GO TO MSG   */ 00295000
*   /* RTN FOR EACH MESSAGE IN LIST. FREE MSG BUFFER UPON RETURN FROM*/ 00296000
*   /* MSG RTN                                                       */ 00297000
*   /*                                                               */ 00298000
*   /*****************************************************************/ 00299000
*                                                                  0116 00300000
*                                                                  0116 00301000
*DOWHILE1:                                                         0116 00302000
*   IF MSGBUFPT Â¬= 0 THEN                                          0116 00303000
DOWHILE1 L     @14,MSGBUFPT                                        0116 00304000
         LTR   @14,@14                                             0116 00305000
         BZ    @RF00116                                            0116 00306000
*     DO;                           /* MESSAGES EXIST IF NON-ZERO    */ 00307000
*       RFY R9 RSTD;                /*                        YM1547*/  00308000
*       R9=MSGBUFPT+8;              /* GET POINTER TO MSG     YM1547*/  00309000
         AH    @14,@CH00033                                        0119 00310000
         LR    R9,@14                                              0119 00311000
*       IWAMSLEN=80;                /* PUT MESSAGE LTH IN IWA YM1547*/  00312000
         MVI   IWAMSLEN(WAPTR),X'50'                               0120 00313000
*       AOVFBSW='1'B;               /* TELL VGM TO PUT MSG    YM1547*/  00314000
         OI    AOVFBSW(WAPTR),B'00100000'                          0121 00315000
*       CALL IEFVGM;                /* GO TO MESSAGE ROUTINE         */ 00316000
         L     @15,@CV00830                                        0122 00317000
         BALR  @14,@15                                             0122 00318000
*       RFY R9 UNRSTD;              /*                        YM1547*/  00319000
*       R0 = MSGLEN;                                               0124 00320000
         L     @14,MSGBUFPT                                        0124 00321000
         LH    R0,MSGLEN(,@14)                                     0124 00322000
*       R1 = MSGBUFPT;              /* @ OF MESSAGE BUFFER TO BE   0125 00323000
*                                      FREED                         */ 00324000
         LR    R1,@14                                              0125 00325000
*       MSGBUFPT = MSGNEXT;         /* SAVE @ OF NEXT MSG BUFFER/ OR    00326000
*                                      ZERO                          */ 00327000
         L     @14,MSGNEXT(,@14)                                   0126 00328000
         ST    @14,MSGBUFPT                                        0126 00329000
*       GENERATE;                                                  0127 00330000
        FREEMAIN R,LV=(0),A=(1)   FREE MESSAGE BUFFER                   00331000
*       R1 = REGSAVE;                                              0128 00332000
         L     R1,REGSAVE                                          0128 00333000
*       GOTO DOWHILE1;              /* IF MSGBUFPT IS NOW ZERO LOOP     00334000
*                                      EXIT WILL OCCUR               */ 00335000
         B     DOWHILE1                                            0129 00336000
*     END;                          /* END OF DOWHILE1 LOOP          */ 00337000
*   OVFBLKPT = ADDR(JFCB);          /* INIT FOR NEXT LOOP IF NEEDED  */ 00338000
@RF00116 LA    OVFBLKPT,JFCB(,LWAPTR)                              0131 00339000
*   ONCESW = '1'B;                  /* INIT 1ST TIME SW FOR NEXT LOOP*/ 00340000
*                                                                  0132 00341000
         OI    ONCESW,B'00000010'                                  0132 00342000
*/*      DO WHILE CHNBLKPT Â¬= 0                                      */ 00343000
*                                                                  0133 00344000
*                                                                  0133 00345000
*DOWHILE2:                                                         0133 00346000
*                                                                  0133 00347000
*   /*****************************************************************/ 00348000
*   /*                                                               */ 00349000
*   /* GET CHN OFFSET @ INTO JFCB FROM THE PARAMETER LIST, ASSIGN A  */ 00350000
*   /* TTR, AND PLACE IT INTO THE JFCB CHAIN TTR FIELD. PUT THE SAME */ 00351000
*   /* TTR INTO THE SELF-TTR FIELD OF THE CHAINED (TO JFCB) CONTROL  */ 00352000
*   /* BLOCK. WRITE THE CONTROL BLOCK TO THE QUE, AND FREE CORE SPACE*/ 00353000
*   /* USED FOR THE CHAINED CONTROL BLOCK.                           */ 00354000
*   /*                                                               */ 00355000
*   /*****************************************************************/ 00356000
*                                                                  0133 00357000
*   IF CHNBLKPT Â¬= 0 THEN                                          0133 00358000
DOWHILE2 ICM   @14,15,CHNBLKPT                                     0133 00359000
         BZ    @RF00133                                            0133 00360000
*     DO;                           /* NO EXT BLK IF PTR STILL ZERO  */ 00361000
*       IF ONCESW = '1'B THEN                                      0135 00362000
         TM    ONCESW,B'00000010'                                  0135 00363000
         BNO   @RF00135                                            0135 00364000
*         DO;                       /* CHAIN BLOCK TO JFCB           */ 00365000
*           OVFBLOCK (CHNOFFPT:CHNOFFPT+3) = TNEXT2; /* MOVE TTR TO     00366000
*                                      CHAIN FIELD                   */ 00367000
         LH    @14,CHNOFFPT                                        0137 00368000
         L     @09,TNEXT2(,WAPTR)                                  0137 00369000
         BCTR  @14,0                                               0137 00370000
         ST    @09,OVFBLOCK(@14,OVFBLKPT)                          0137 00371000
*           SAVTBUF = TNEXT2;       /* SAVE CURRENT TTR              */ 00372000
         ST    @09,SAVTBUF                                         0138 00373000
*           QMPOP = '01'X;                                         0139 00374000
         LA    @14,248                                             0139 00375000
         ALR   @14,WAPTR                                           0139 00376000
         MVI   QMPOP(@14),X'01'                                    0139 00377000
*           QMPCMNC = '10'X;        /* SET FOR ONE ASSIGN            */ 00378000
         MVI   QMPCMNC(@14),X'10'                                  0140 00379000
*           CALL IEFVHQ;            /* ASSIGN ONE TTR                */ 00380000
         L     @15,@CV00835                                        0141 00381000
         BALR  @14,@15                                             0141 00382000
*           TNEXT2 = QLINKWA (1:4); /* RESTORE NEXT TTR              */ 00383000
         MVC   TNEXT2(4,WAPTR),QLINKWA(LWAPTR)                     0142 00384000
*         END;                                                     0143 00385000
*       ONCESW = '0'B;              /* TURN OFF 1ST TIME SWITCH      */ 00386000
*                                                                  0144 00387000
@RF00135 NI    ONCESW,B'11111101'                                  0144 00388000
*       /*************************************************************/ 00389000
*       /*                                                           */ 00390000
*       /* CHAIN OVERFLOW BLOCK TO JFCB ON FIRST TIME THROUGH, TO    */ 00391000
*       /* PRIOR OVERFLOW BLOCKS ON SUBSEQUENT LOOPS.                */ 00392000
*       /*                                                           */ 00393000
*       /*************************************************************/ 00394000
*                                                                  0145 00395000
*       OVFBLKPT = CHNBLKPT;        /* POINT BASE AT CURRENT OVERFLOW   00396000
*                                      BLOCK                         */ 00397000
         L     @14,CHNBLKPT                                        0145 00398000
         LR    OVFBLKPT,@14                                        0145 00399000
*       QLINKWA (5:8) = SAVTBUF;    /* MOVE TTR FOR WRITE            */ 00400000
         MVC   QLINKWA+4(4,LWAPTR),SAVTBUF                         0146 00401000
*       QLINKWA (1:4) = CHNBLKPT;   /* @ OF BUFFER TO BE WRITTEN     */ 00402000
         ST    @14,QLINKWA(,LWAPTR)                                0147 00403000
*       QLINKWA(8:8)='28'X;         /*AMP OVERFLOW BLOCK ID  Y02668  */ 00404000
         MVI   QLINKWA+7(LWAPTR),X'28'                             0148 00405000
*       FREEBKPT = CHNBLKPT;        /* SAVE @ TO FREE BUFFER SPACE 0149 00406000
*                                      LATER                         */ 00407000
         LR    FREEBKPT,@14                                        0149 00408000
*       CHNBLKPT = CHAINADR;        /* SAVE @ OF NEXT BLOCK IN CHAIN */ 00409000
         L     @14,CHAINADR(,OVFBLKPT)                             0150 00410000
         ST    @14,CHNBLKPT                                        0150 00411000
*       IF CHNBLKPT Â¬= 0 THEN                                      0151 00412000
         LTR   @14,@14                                             0151 00413000
         BZ    @RF00151                                            0151 00414000
*         OVFBLOCK (CHNOFPT2:CHNOFPT2+3) = TNEXT2; /* SET NEXT TTR   */ 00415000
         LH    @14,CHNOFPT2                                        0152 00416000
         L     @09,TNEXT2(,WAPTR)                                  0152 00417000
         BCTR  @14,0                                               0152 00418000
         ST    @09,OVFBLOCK(@14,OVFBLKPT)                          0152 00419000
*       ELSE                                                       0153 00420000
*         OVFBLOCK (CHNOFPT2:CHNOFPT2+3) = 0; /* FLAG END OF CHAIN   */ 00421000
         B     @RC00151                                            0153 00422000
@RF00151 LH    @14,CHNOFPT2                                        0153 00423000
         SLR   @09,@09                                             0153 00424000
         BCTR  @14,0                                               0153 00425000
         ST    @09,OVFBLOCK(@14,OVFBLKPT)                          0153 00426000
*       CHAINADR = SAVTBUF;         /* SET SELF-TTR IN OVERFLOW BLOCK*/ 00427000
@RC00151 MVC   CHAINADR(4,OVFBLKPT),SAVTBUF                        0154 00428000
*       SAVTBUF = TNEXT2;           /* SAVE NEXT TTR                 */ 00429000
         MVC   SAVTBUF(4),TNEXT2(WAPTR)                            0155 00430000
*       SELFID = OVFBLKID;          /* SET ID FIELD OF OVERFLOW BLOCK*/ 00431000
         MVC   SELFID(1,OVFBLKPT),OVFBLKID                         0156 00432000
*       QMPOP = '02'X;              /* SET WRITE & ASSIGN FLAGS      */ 00433000
         LA    @14,248                                             0157 00434000
         ALR   @14,WAPTR                                           0157 00435000
         MVI   QMPOP(@14),X'02'                                    0157 00436000
*       QMPCMNC = '11'X;            /* SET QMPA FOR 1 WRITE & 1 ASGN */ 00437000
         MVI   QMPCMNC(@14),X'11'                                  0158 00438000
*       CALL IEFVHQ;                /* WRITE OUT OVERFLOW BLOCK      */ 00439000
         L     @15,@CV00835                                        0159 00440000
         BALR  @14,@15                                             0159 00441000
*       TNEXT2 = QLINKWA(1:4);      /* RESTORE NEXT TTR              */ 00442000
         MVC   TNEXT2(4,WAPTR),QLINKWA(LWAPTR)                     0160 00443000
*       CHNOFFPT = CHNOFPT2;        /* RESET OFFSET WHERE CHAINING IS   00444000
*                                      DONE FROM SO THAT IT WILL BE     00445000
*                                      DONE FROM CHAIN FIELD IN    0161 00446000
*                                      EXTENSION BLOCK               */ 00447000
         MVC   CHNOFFPT(2),CHNOFPT2                                0161 00448000
*       R0 = 176;                                                  0162 00449000
         LA    R0,176                                              0162 00450000
*       R1 = FREEBKPT;              /* SET TO @ OF BLOCK JUST WRITTEN   00451000
*                                      OUT                           */ 00452000
         LR    R1,FREEBKPT                                         0163 00453000
*       GENERATE;                                                  0164 00454000
        FREEMAIN R,LV=(0),A=(1)  FREE OVERFLOW BLOCK BUFFER             00455000
*       R1 = REGSAVE;                                              0165 00456000
         L     R1,REGSAVE                                          0165 00457000
*       GO TO DOWHILE2;             /* COMPLETE SIMULATED DOWHILE  0166 00458000
*                                      LOOP                          */ 00459000
         B     DOWHILE2                                            0166 00460000
*     END;                                                         0167 00461000
*   IF RETCODE Â¬= 0 THEN                                           0168 00462000
@RF00133 ICM   @14,15,RETCODE                                      0168 00463000
         BZ    @RF00168                                            0168 00464000
*     DO;                           /* NORMAL RETURN IS ZERO         */ 00465000
*                                                                  0169 00466000
*       /*************************************************************/ 00467000
*       /*                                                           */ 00468000
*       /* SET JOBFAIL BIT IN IWA                                    */ 00469000
*       /*                                                           */ 00470000
*       /*************************************************************/ 00471000
*                                                                  0170 00472000
*       INCMSTS = '1'B;                                            0170 00473000
         OI    INCMSTS+920(WAPTR),B'00000100'                      0170 00474000
*     END;                                                         0171 00475000
*   END IEFNB901                                                   0172 00476000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00477000
*/*%INCLUDE SYSLIB  (IEFCOMWA)                                        * 00478000
*/*%INCLUDE SYSLIB  (IEFVMIWA)                                        * 00479000
*/*%INCLUDE SYSLIB  (IEFQMNGR)                                        * 00480000
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        * 00481000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        * 00482000
*;                                                                 0172 00483000
@EL00001 L     @13,4(,@13)                                         0172 00484000
@EF00001 L     @00,@SIZDATD                                        0172 00485000
         LR    @01,@08                                             0172 00486000
         FREEMAIN R,LV=(0),A=(1)                                        00487000
@ER00001 LM    @14,@12,12(@13)                                     0172 00488000
         BR    @14                                                 0172 00489000
@DATA    DS    0H                                                       00490000
@CH00101 DC    H'1'                                                     00491000
@CH00143 DC    H'2'                                                     00492000
@CH00033 DC    H'8'                                                     00493000
@CH00825 DC    XL2'02'                                                  00494000
@SM00843 MVC   DATABUF(0,@05),AMEQTEXT(@09)                             00495000
@DATD    DSECT                                                          00496000
         DS    0F                                                       00497000
@SA00001 DS    18F                                                      00498000
@PC00001 DS    1F                                                       00499000
@AL00001 DS    1A                                                       00500000
IEFNB901 CSECT                                                          00501000
         DS    0F                                                       00502000
@DATD    DSECT                                                          00503000
         DS    0D                                                       00504000
SAVTBUF  DS    A                                                        00505000
REGSAVE  DS    F                                                        00506000
RETCODE  DS    F                                                        00507000
SAVEREG9 DS    A                                                        00508000
TOTLNGTH DS    H                                                        00509000
DATADISP DS    H                                                        00510000
DATACT   DS    AL1                                                      00511000
         DS    CL3                                                      00512000
AMPRMLST DS    CL24                                                     00513000
         ORG   AMPRMLST                                                 00514000
AMDATAPT DS    AL4                                                      00515000
CNBLKPTR DS    AL4                                                      00516000
MSGBUFPT DS    AL4                                                      00517000
CHNBLKPT DS    AL4                                                      00518000
CHNOFFPT DS    FL2                                                      00519000
CHNOFPT2 DS    FL2                                                      00520000
@NM00054 DS    CL2                                                      00521000
OVFBLKID DS    CL1                                                      00522000
SUBPLNUM DS    AL1                                                      00523000
         ORG   AMPRMLST+24                                              00524000
SWITCHES DS    BL1                                                      00525000
         ORG   SWITCHES                                                 00526000
@NM00057 DS    BL1                                                      00527000
ONCESW   EQU   SWITCHES+0                                               00528000
TBUFOVF  EQU   SWITCHES+0                                               00529000
         ORG   SWITCHES+1                                               00530000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00531000
@ENDDATD EQU   *                                                        00532000
IEFNB901 CSECT                                                          00533000
         DS    0F                                                       00534000
@SIZDATD DC    AL1(0)                                                   00535000
         DC    AL3(@ENDDATD-@DATD)                                      00536000
@CV00830 DC    V(IEFVGM)                                                00537000
@CV00835 DC    V(IEFVHQ)                                                00538000
         DS    0D                                                       00539000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00540000
@01      EQU   01                                                       00541000
@02      EQU   02                                                       00542000
@03      EQU   03                                                       00543000
@04      EQU   04                                                       00544000
@05      EQU   05                                                       00545000
@06      EQU   06                                                       00546000
@07      EQU   07                                                       00547000
@08      EQU   08                                                       00548000
@09      EQU   09                                                       00549000
@10      EQU   10                                                       00550000
@11      EQU   11                                                       00551000
@12      EQU   12                                                       00552000
@13      EQU   13                                                       00553000
@14      EQU   14                                                       00554000
@15      EQU   15                                                       00555000
I        EQU   @04                                                      00556000
FREELEN  EQU   @02                                                      00557000
AMPADDR  EQU   @04                                                      00558000
OVFBLKPT EQU   @02                                                      00559000
FREEBKPT EQU   @04                                                      00560000
INTXTLPT EQU   @02                                                      00561000
AMPRMPTR EQU   @02                                                      00562000
LWAPTR   EQU   @03                                                      00563000
WAPTR    EQU   @12                                                      00564000
R1       EQU   @01                                                      00565000
R0       EQU   @00                                                      00566000
R9       EQU   @09                                                      00567000
R10      EQU   @10                                                      00568000
RF       EQU   @15                                                      00569000
R2       EQU   @02                                                      00570000
R3       EQU   @03                                                      00571000
R4       EQU   @04                                                      00572000
R5       EQU   @05                                                      00573000
R6       EQU   @06                                                      00574000
R7       EQU   @07                                                      00575000
R8       EQU   @08                                                      00576000
COMWA    EQU   0                                                        00577000
CWAL     EQU   COMWA                                                    00578000
CWAID    EQU   COMWA+4                                                  00579000
CWACONID EQU   COMWA+8                                                  00580000
TNEXT2   EQU   COMWA+36                                                 00581000
IWAIOSA  EQU   COMWA+88                                                 00582000
WARPL    EQU   COMWA+160                                                00583000
QPARM    EQU   COMWA+248                                                00584000
CWARET   EQU   COMWA+344                                                00585000
CWAMCSCA EQU   COMWA+346                                                00586000
CWAMSLEN EQU   COMWA+360                                                00587000
IWAMSLEN EQU   CWAMSLEN                                                 00588000
AOSW1    EQU   COMWA+361                                                00589000
AOVFBSW  EQU   AOSW1                                                    00590000
AOSW4    EQU   COMWA+362                                                00591000
SWE      EQU   COMWA+363                                                00592000
SWH      EQU   COMWA+364                                                00593000
SWI      EQU   COMWA+365                                                00594000
SWY2     EQU   COMWA+366                                                00595000
INTWA    EQU   0                                                        00596000
IWAEXTS  EQU   INTWA+179                                                00597000
SWA      EQU   INTWA+180                                                00598000
SWC      EQU   INTWA+181                                                00599000
SWD      EQU   INTWA+182                                                00600000
SWF      EQU   INTWA+183                                                00601000
SWG      EQU   INTWA+184                                                00602000
IWAINTS8 EQU   INTWA+185                                                00603000
CRSW1    EQU   INTWA+189                                                00604000
DDSWX1   EQU   INTWA+192                                                00605000
SDDNSWA  EQU   DDSWX1                                                   00606000
AOSW2    EQU   INTWA+194                                                00607000
JCT      EQU   INTWA+548                                                00608000
LWA      EQU   0                                                        00609000
QLINKWA  EQU   LWA                                                      00610000
TNUMPX   EQU   LWA+72                                                   00611000
TLEN     EQU   LWA+76                                                   00612000
TLENPX   EQU   LWA+80                                                   00613000
TNUM     EQU   LWA+88                                                   00614000
TCT      EQU   LWA+92                                                   00615000
JFCB     EQU   LWA+392                                                  00616000
QMPA     EQU   0                                                        00617000
QMNAM    EQU   QMPA                                                     00618000
QMPOP    EQU   QMPA+8                                                   00619000
QMSTA    EQU   QMPA+16                                                  00620000
QMPCL    EQU   QMPA+32                                                  00621000
QMPCMNC  EQU   QMPCL                                                    00622000
QMPACL   EQU   QMPCL+1                                                  00623000
SWAQMPA  EQU   0                                                        00624000
INJMJCT  EQU   0                                                        00625000
JCTJSTAT EQU   INJMJCT+5                                                00626000
INCMSTS  EQU   JCTJSTAT                                                 00627000
INDMCTLG EQU   JCTJSTAT                                                 00628000
JCTJBYTE EQU   INJMJCT+7                                                00629000
JCTJMGLV EQU   JCTJBYTE                                                 00630000
JCTCCODE EQU   INJMJCT+54                                               00631000
JCTRSW1  EQU   INJMJCT+86                                               00632000
JCTRSW2  EQU   INJMJCT+87                                               00633000
JCTJSB   EQU   INJMJCT+111                                              00634000
JCTSTAT2 EQU   INJMJCT+116                                              00635000
IEFAACTB EQU   0                                                        00636000
INFMJFCB EQU   0                                                        00637000
JFCBDSNM EQU   INFMJFCB                                                 00638000
JFCBELNM EQU   INFMJFCB+44                                              00639000
JFCBTSDM EQU   INFMJFCB+52                                              00640000
JFCFCBID EQU   INFMJFCB+56                                              00641000
JFCBFRID EQU   JFCFCBID                                                 00642000
JFCBLTYP EQU   INFMJFCB+66                                              00643000
JFCBOTTR EQU   INFMJFCB+67                                              00644000
JFCBUFOF EQU   JFCBOTTR                                                 00645000
JFCBFLSQ EQU   JFCBOTTR+1                                               00646000
JFCFUNC  EQU   JFCBFLSQ                                                 00647000
JFCBMASK EQU   INFMJFCB+72                                              00648000
JFCBFLG1 EQU   JFCBMASK+5                                               00649000
JFCOPEN  EQU   JFCBFLG1                                                 00650000
JFCBFLG2 EQU   JFCBMASK+6                                               00651000
JFCDEFER EQU   JFCBFLG2                                                 00652000
JFCBIND1 EQU   INFMJFCB+86                                              00653000
JFCBIND2 EQU   INFMJFCB+87                                              00654000
JFCAMPTR EQU   INFMJFCB+88                                              00655000
JFCBUFRQ EQU   JFCAMPTR                                                 00656000
JFCBUFNO EQU   JFCBUFRQ                                                 00657000
JFCBGNCP EQU   JFCAMPTR+1                                               00658000
JFCBHIAR EQU   JFCBGNCP                                                 00659000
JFCBFALN EQU   JFCBHIAR                                                 00660000
JFCBFTEK EQU   JFCBFALN                                                 00661000
JFCBBFTA EQU   JFCBFTEK                                                 00662000
JFCEROPT EQU   INFMJFCB+92                                              00663000
JFCTRTCH EQU   INFMJFCB+93                                              00664000
QMPEXPTR EQU   0                                                        00665000
MSGBUF   EQU   0                                                        00666000
MSGLEN   EQU   MSGBUF                                                   00667000
MSGNEXT  EQU   MSGBUF+4                                                 00668000
TEXTNUM  EQU   0                                                        00669000
DATALEN  EQU   0                                                        00670000
DATABUF  EQU   0                                                        00671000
DBUFLEN  EQU   DATABUF                                                  00672000
AMEQTEXT EQU   0                                                        00673000
OVFBLOCK EQU   0                                                        00674000
CHAINADR EQU   OVFBLOCK                                                 00675000
SELFID   EQU   CHAINADR+3                                               00676000
IEFNB902 EQU   0                                                        00677000
NEXTKEY  EQU   0                                                        00678000
QMPEX    EQU   0                                                        00679000
INPUT    EQU   0                                                        00680000
JFCKEYLE EQU   JFCTRTCH                                                 00681000
JFCCODE  EQU   JFCKEYLE                                                 00682000
JFCSTACK EQU   JFCTRTCH                                                 00683000
JFCMODE  EQU   JFCSTACK                                                 00684000
JFCSPPRT EQU   JFCTRTCH                                                 00685000
JFCBABFS EQU   JFCSPPRT+2                                               00686000
JFCLIMCT EQU   JFCBABFS                                                 00687000
JFCDSORG EQU   JFCSPPRT+5                                               00688000
JFCDSRG1 EQU   JFCDSORG                                                 00689000
JFCDSRG2 EQU   JFCDSORG+1                                               00690000
JFCRECFM EQU   JFCSPPRT+7                                               00691000
JFCRCFM  EQU   JFCRECFM                                                 00692000
JFCOPTCD EQU   JFCSPPRT+8                                               00693000
JFCWVCSP EQU   JFCOPTCD                                                 00694000
JFCWVCIS EQU   JFCWVCSP                                                 00695000
JFCWVCBD EQU   JFCWVCIS                                                 00696000
JFCALLOW EQU   JFCOPTCD                                                 00697000
JFCRSV17 EQU   JFCALLOW                                                 00698000
JFCOVER  EQU   JFCRSV17                                                 00699000
JFCPCIBT EQU   JFCOPTCD                                                 00700000
JFCMAST  EQU   JFCPCIBT                                                 00701000
JFCEXT   EQU   JFCMAST                                                  00702000
JFCBCKPT EQU   JFCOPTCD                                                 00703000
JFCIND   EQU   JFCBCKPT                                                 00704000
JFCRSV18 EQU   JFCOPTCD                                                 00705000
JFCCYL   EQU   JFCRSV18                                                 00706000
JFCACT   EQU   JFCCYL                                                   00707000
JFCREDUC EQU   JFCOPTCD                                                 00708000
JFCRSV19 EQU   JFCREDUC                                                 00709000
JFCRSV20 EQU   JFCRSV19                                                 00710000
JFCRSV21 EQU   JFCOPTCD                                                 00711000
JFCDEL   EQU   JFCRSV21                                                 00712000
JFCOPTJ  EQU   JFCOPTCD                                                 00713000
JFCREORG EQU   JFCOPTJ                                                  00714000
JFCBLKSI EQU   JFCSPPRT+9                                               00715000
JFCBUFSI EQU   JFCBLKSI                                                 00716000
JFCAMSYN EQU   JFCSPPRT+11                                              00717000
JFCNCP   EQU   JFCAMSYN+2                                               00718000
JFCNTM   EQU   JFCAMSYN+3                                               00719000
JFCBFSEQ EQU   JFCNTM                                                   00720000
JFCPCI   EQU   JFCBFSEQ                                                 00721000
JFCRESRV EQU   JFCAMSYN+4                                               00722000
JFCUCSEG EQU   JFCRESRV                                                 00723000
JFCUCSOP EQU   JFCUCSEG+4                                               00724000
JFCOUTLI EQU   JFCUCSEG+5                                               00725000
JFCTHRSH EQU   JFCOUTLI                                                 00726000
JFCCPRI  EQU   JFCTHRSH                                                 00727000
JFCBVOLS EQU   JFCUCSEG+10                                              00728000
JFCBS001 EQU   JFCBVOLS                                                 00729000
JFCBPQTY EQU   JFCBS001+34                                              00730000
JFCBCTRI EQU   JFCBS001+37                                              00731000
JFCBSQTY EQU   JFCBS001+38                                              00732000
JFCFLGS1 EQU   JFCBS001+41                                              00733000
JFCBSPNM EQU   JFCBS001+45                                              00734000
JFCBFLG3 EQU   JFCBSPNM                                                 00735000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00736000
JFCBEND  EQU   JFCBS001+58                                              00737000
JFCBSPTN EQU   JFCBS001+57                                              00738000
JFCBVLCT EQU   JFCBS001+56                                              00739000
JFCBDRLH EQU   JFCBS001+53                                              00740000
JFCBSBNM EQU   JFCBS001+50                                              00741000
JFCBABST EQU   JFCBS001+48                                              00742000
JFCBRV08 EQU   JFCBSPNM+1                                               00743000
JFCBRV07 EQU   JFCBFLG3                                                 00744000
JFCBRV06 EQU   JFCBFLG3                                                 00745000
JFCBRV05 EQU   JFCBFLG3                                                 00746000
JFCBRV04 EQU   JFCBFLG3                                                 00747000
JFCBRV03 EQU   JFCBFLG3                                                 00748000
JFCBRV02 EQU   JFCBFLG3                                                 00749000
JFCBEXP  EQU   JFCBFLG3                                                 00750000
JFCDQDSP EQU   JFCBFLG3                                                 00751000
JFCBDQTY EQU   JFCBS001+42                                              00752000
JFCBUAFF EQU   JFCFLGS1                                                 00753000
JFCRSV45 EQU   JFCFLGS1                                                 00754000
JFCVRDS  EQU   JFCFLGS1                                                 00755000
JFCBCEOV EQU   JFCFLGS1                                                 00756000
JFCRSV42 EQU   JFCFLGS1                                                 00757000
JFCBADSP EQU   JFCFLGS1                                                 00758000
JFCTOPEN EQU   JFCFLGS1                                                 00759000
JFCBDLET EQU   JFCFLGS1                                                 00760000
JFCRQID  EQU   JFCBSQTY                                                 00761000
JFCROUND EQU   JFCBCTRI                                                 00762000
JFCALX   EQU   JFCBCTRI                                                 00763000
JFCMIXG  EQU   JFCBCTRI                                                 00764000
JFCONTIG EQU   JFCBCTRI                                                 00765000
JFCRSV29 EQU   JFCBCTRI                                                 00766000
JFCBMSGP EQU   JFCBCTRI                                                 00767000
JFCBSPAC EQU   JFCBCTRI                                                 00768000
JFCRUNIT EQU   JFCBPQTY                                                 00769000
JFCBEXAD EQU   JFCBS001+31                                              00770000
JFCBEXTL EQU   JFCBS001+30                                              00771000
JFCMSVGP EQU   JFCBS001+22                                              00772000
@NM00053 EQU   JFCBS001                                                 00773000
JFCAVOLS EQU   JFCBVOLS                                                 00774000
JFCBNVOL EQU   JFCUCSEG+9                                               00775000
JFCBNTCS EQU   JFCUCSEG+8                                               00776000
JFCSOWA  EQU   JFCOUTLI+1                                               00777000
JFCSEND  EQU   JFCCPRI                                                  00778000
JFCEQUAL EQU   JFCCPRI                                                  00779000
JFCRECV  EQU   JFCCPRI                                                  00780000
JFCRSV34 EQU   JFCCPRI                                                  00781000
JFCRSV33 EQU   JFCCPRI                                                  00782000
JFCRSV55 EQU   JFCCPRI                                                  00783000
JFCRSV54 EQU   JFCCPRI                                                  00784000
JFCRSV53 EQU   JFCCPRI                                                  00785000
JFCRSV27 EQU   JFCUCSOP                                                 00786000
JFCRSV26 EQU   JFCUCSOP                                                 00787000
JFCFCBVR EQU   JFCUCSOP                                                 00788000
JFCFCBAL EQU   JFCUCSOP                                                 00789000
JFCVER   EQU   JFCUCSOP                                                 00790000
JFCRSV25 EQU   JFCUCSOP                                                 00791000
JFCFOLD  EQU   JFCUCSOP                                                 00792000
JFCBEXTP EQU   JFCUCSOP                                                 00793000
JFCUCSID EQU   JFCUCSEG                                                 00794000
JFCINTVL EQU   JFCSPPRT+19                                              00795000
JFCDBUFN EQU   JFCRESRV+3                                               00796000
JFCCYLOF EQU   JFCRESRV+2                                               00797000
JFCRKP   EQU   JFCRESRV                                                 00798000
JFCPCIR2 EQU   JFCPCI                                                   00799000
JFCPCIR1 EQU   JFCPCI                                                   00800000
JFCPCIN2 EQU   JFCPCI                                                   00801000
JFCPCIN1 EQU   JFCPCI                                                   00802000
JFCPCIA2 EQU   JFCPCI                                                   00803000
JFCPCIA1 EQU   JFCPCI                                                   00804000
JFCPCIX2 EQU   JFCPCI                                                   00805000
JFCPCIX1 EQU   JFCPCI                                                   00806000
JFCBUFMX EQU   JFCNCP                                                   00807000
JFCLRECL EQU   JFCAMSYN                                                 00808000
JFCBAXBF EQU   JFCBUFSI                                                 00809000
JFCREL   EQU   JFCREORG                                                 00810000
JFCRSV22 EQU   JFCDEL                                                   00811000
JFCSRCHD EQU   JFCRSV20                                                 00812000
JFCOPTQ  EQU   JFCACT                                                   00813000
JFCFEED  EQU   JFCIND                                                   00814000
JFCCBWU  EQU   JFCEXT                                                   00815000
JFCWUMSG EQU   JFCOVER                                                  00816000
JFCSDNAM EQU   JFCWVCBD                                                 00817000
@NM00052 EQU   JFCRECFM                                                 00818000
JFCCHAR  EQU   JFCRECFM                                                 00819000
JFCRFS   EQU   JFCRECFM                                                 00820000
JFCRFB   EQU   JFCRECFM                                                 00821000
JFCRFO   EQU   JFCRCFM                                                  00822000
JFCFMREC EQU   JFCRCFM                                                  00823000
JFCRSV16 EQU   JFCDSRG2                                                 00824000
JFCRSV15 EQU   JFCDSRG2                                                 00825000
JFCORGTR EQU   JFCDSRG2                                                 00826000
JFCORGAM EQU   JFCDSRG2                                                 00827000
JFCRSV13 EQU   JFCDSRG2                                                 00828000
JFCORGTQ EQU   JFCDSRG2                                                 00829000
JFCORGTX EQU   JFCDSRG2                                                 00830000
JFCORGGS EQU   JFCDSRG2                                                 00831000
JFCORGU  EQU   JFCDSRG1                                                 00832000
JFCORGPO EQU   JFCDSRG1                                                 00833000
JFCORGMQ EQU   JFCDSRG1                                                 00834000
JFCORGCQ EQU   JFCDSRG1                                                 00835000
JFCORGCX EQU   JFCDSRG1                                                 00836000
JFCORGDA EQU   JFCDSRG1                                                 00837000
JFCORGPS EQU   JFCDSRG1                                                 00838000
JFCORGIS EQU   JFCDSRG1                                                 00839000
JFCTRKBL EQU   JFCLIMCT+1                                               00840000
@NM00051 EQU   JFCLIMCT                                                 00841000
JFCDEN   EQU   JFCSPPRT+1                                               00842000
JFCPRTSP EQU   JFCSPPRT                                                 00843000
JFCONE   EQU   JFCMODE                                                  00844000
JFCTWO   EQU   JFCMODE                                                  00845000
JFCRSV07 EQU   JFCMODE                                                  00846000
JFCRSV06 EQU   JFCMODE                                                  00847000
JFCMODER EQU   JFCMODE                                                  00848000
JFCMODEO EQU   JFCMODE                                                  00849000
JFCEBCD  EQU   JFCMODE                                                  00850000
JFCBIN   EQU   JFCMODE                                                  00851000
JFCRSV32 EQU   JFCCODE                                                  00852000
JFCTTY   EQU   JFCCODE                                                  00853000
JFCASCII EQU   JFCCODE                                                  00854000
JFCNCR   EQU   JFCCODE                                                  00855000
JFCBUR   EQU   JFCCODE                                                  00856000
JFCFRI   EQU   JFCCODE                                                  00857000
JFCBCD   EQU   JFCCODE                                                  00858000
JFCNOCON EQU   JFCCODE                                                  00859000
@NM00056 EQU   OVFBLOCK+4                                               00860000
SELFTTR  EQU   CHAINADR                                                 00861000
@NM00055 EQU   DATABUF+2                                                00862000
MSGBUFF  EQU   MSGBUF+8                                                 00863000
MSGZERO  EQU   MSGBUF+2                                                 00864000
JFCRSV05 EQU   JFCEROPT                                                 00865000
JFCRSV04 EQU   JFCEROPT                                                 00866000
JFCRSV03 EQU   JFCEROPT                                                 00867000
JFCRSV02 EQU   JFCEROPT                                                 00868000
JFCTOPT  EQU   JFCEROPT                                                 00869000
JFCABN   EQU   JFCEROPT                                                 00870000
JFCSKP   EQU   JFCEROPT                                                 00871000
JFCACC   EQU   JFCEROPT                                                 00872000
JFCBUFL  EQU   JFCAMPTR+2                                               00873000
JFCFWORD EQU   JFCBFTEK                                                 00874000
JFCDWORD EQU   JFCBFTEK                                                 00875000
JFCHIER1 EQU   JFCBFTEK                                                 00876000
JFCDYN   EQU   JFCBFTEK                                                 00877000
JFCEXC   EQU   JFCBFTEK                                                 00878000
JFCBBFTR EQU   JFCBBFTA                                                 00879000
JFCSIM   EQU   JFCBBFTA                                                 00880000
JFCHIER  EQU   JFCBFTEK                                                 00881000
JFCBFOUT EQU   JFCBUFNO                                                 00882000
JFCBUFIN EQU   JFCBUFNO                                                 00883000
JFCTEMP  EQU   JFCBIND2                                                 00884000
JFCREQ   EQU   JFCBIND2                                                 00885000
JFCENT   EQU   JFCBIND2                                                 00886000
JFCSHARE EQU   JFCBIND2                                                 00887000
JFCSECUR EQU   JFCBIND2                                                 00888000
JFCDISP  EQU   JFCBIND2                                                 00889000
JFCPDS   EQU   JFCBIND1                                                 00890000
JFCGDG   EQU   JFCBIND1                                                 00891000
JFCADDED EQU   JFCBIND1                                                 00892000
JFCLOC   EQU   JFCBIND1                                                 00893000
JFCRLSE  EQU   JFCBIND1                                                 00894000
JFCBXPDT EQU   INFMJFCB+83                                              00895000
JFCBCRDT EQU   INFMJFCB+80                                              00896000
JFCBOPS2 EQU   JFCBMASK+7                                               00897000
JFCRCTLG EQU   JFCBFLG2                                                 00898000
JFCBBUFF EQU   JFCBFLG2                                                 00899000
JFCTRACE EQU   JFCBFLG2                                                 00900000
JFCSDRPS EQU   JFCBFLG2                                                 00901000
JFCMODNW EQU   JFCBFLG2                                                 00902000
JFCNRPS  EQU   JFCDEFER                                                 00903000
JFCOUTOP EQU   JFCBFLG2                                                 00904000
JFCINOP  EQU   JFCBFLG2                                                 00905000
JFCBPWBP EQU   JFCOPEN                                                  00906000
@NM00050 EQU   JFCOPEN                                                  00907000
JFCDUAL  EQU   JFCBFLG1                                                 00908000
JFCSLDES EQU   JFCBFLG1                                                 00909000
JFCSLCRE EQU   JFCBFLG1                                                 00910000
JFCSTAND EQU   JFCBFLG1                                                 00911000
JFCBOPS1 EQU   JFCBMASK                                                 00912000
JFCBVLSQ EQU   INFMJFCB+70                                              00913000
JFCRSV31 EQU   JFCFUNC                                                  00914000
JFCFNCBT EQU   JFCFUNC                                                  00915000
JFCFNCBX EQU   JFCFUNC                                                  00916000
JFCFNCBD EQU   JFCFUNC                                                  00917000
JFCFNCBW EQU   JFCFUNC                                                  00918000
JFCFNCBP EQU   JFCFUNC                                                  00919000
JFCFNCBR EQU   JFCFUNC                                                  00920000
JFCFNCBI EQU   JFCFUNC                                                  00921000
JFCBFOFL EQU   JFCBUFOF                                                 00922000
JFCNL    EQU   JFCBLTYP                                                 00923000
JFCSL    EQU   JFCBLTYP                                                 00924000
JFCNSL   EQU   JFCBLTYP                                                 00925000
JFCSUL   EQU   JFCBLTYP                                                 00926000
JFCBLP   EQU   JFCBLTYP                                                 00927000
JFCBLTM  EQU   JFCBLTYP                                                 00928000
JFCBAL   EQU   JFCBLTYP                                                 00929000
JFCRSV38 EQU   JFCBLTYP                                                 00930000
JFCVINDX EQU   INFMJFCB+64                                              00931000
JFCNLREC EQU   INFMJFCB+62                                              00932000
JFCBADBF EQU   INFMJFCB+60                                              00933000
JFCAMSTR EQU   JFCBFRID+2                                               00934000
JFCAMCRO EQU   JFCBFRID                                                 00935000
JFCBDSCB EQU   INFMJFCB+53                                              00936000
JFCPAT   EQU   JFCBTSDM                                                 00937000
JFCNDCB  EQU   JFCBTSDM                                                 00938000
JFCNDSCB EQU   JFCBTSDM                                                 00939000
JFCNWRIT EQU   JFCBTSDM                                                 00940000
JFCTTR   EQU   JFCBTSDM                                                 00941000
JFCSDS   EQU   JFCBTSDM                                                 00942000
JFCVSL   EQU   JFCBTSDM                                                 00943000
JFCCAT   EQU   JFCBTSDM                                                 00944000
JFCIPLTX EQU   JFCBELNM                                                 00945000
JFCBQNAM EQU   JFCBDSNM                                                 00946000
ACTACCNT EQU   IEFAACTB+32                                              00947000
ACTJNFLD EQU   IEFAACTB+31                                              00948000
ACTJTIME EQU   IEFAACTB+28                                              00949000
ACTPRGNM EQU   IEFAACTB+8                                               00950000
@NM00049 EQU   IEFAACTB+7                                               00951000
ACTNEXT  EQU   IEFAACTB+4                                               00952000
ACTIDENT EQU   IEFAACTB+3                                               00953000
ACTDSKAD EQU   IEFAACTB                                                 00954000
@NM00048 EQU   INJMJCT+175                                              00955000
JCTVULDP EQU   INJMJCT+172                                              00956000
JCTACODE EQU   INJMJCT+168                                              00957000
JCTPRFMF EQU   INJMJCT+167                                              00958000
JCTUSER  EQU   INJMJCT+160                                              00959000
JCTSSD   EQU   INJMJCT+157                                              00960000
@NM00047 EQU   INJMJCT+156                                              00961000
JCTSRBT  EQU   INJMJCT+152                                              00962000
JCTJMRJD EQU   INJMJCT+149                                              00963000
JCTJMRJT EQU   INJMJCT+146                                              00964000
JCTJMRSS EQU   INJMJCT+143                                              00965000
JCTJMRTL EQU   INJMJCT+140                                              00966000
JCTJMRCL EQU   INJMJCT+139                                              00967000
JCTJMROP EQU   INJMJCT+138                                              00968000
JCTJMRD  EQU   INJMJCT+137                                              00969000
JCTJMR   EQU   INJMJCT+134                                              00970000
JCTCKIDT EQU   INJMJCT+118                                              00971000
JCTCKIDL EQU   INJMJCT+117                                              00972000
@NM00046 EQU   JCTSTAT2                                                 00973000
JCTBLP   EQU   JCTSTAT2                                                 00974000
JCTPERFM EQU   JCTSTAT2                                                 00975000
JCTSWSM  EQU   JCTSTAT2                                                 00976000
JCTENDIT EQU   JCTSTAT2                                                 00977000
JCTADSPC EQU   JCTSTAT2                                                 00978000
JCTSPSYS EQU   JCTSTAT2                                                 00979000
@NM00045 EQU   INJMJCT+115                                              00980000
JCTSSTR  EQU   INJMJCT+112                                              00981000
JCTJSBTM EQU   JCTJSB                                                   00982000
JCTJSBEX EQU   JCTJSB                                                   00983000
JCTJSBAL EQU   JCTJSB                                                   00984000
JCTJSBIN EQU   JCTJSB                                                   00985000
@NM00044 EQU   JCTJSB                                                   00986000
JCTVOLSQ EQU   INJMJCT+110                                              00987000
JCTNRCKP EQU   INJMJCT+108                                              00988000
JCTNTRK  EQU   INJMJCT+107                                              00989000
JCTCKTTR EQU   INJMJCT+104                                              00990000
JCTDEVT  EQU   INJMJCT+100                                              00991000
@NM00043 EQU   INJMJCT+99                                               00992000
JCTSTIOT EQU   INJMJCT+96                                               00993000
JCTSNUMB EQU   INJMJCT+95                                               00994000
JCTQIDNT EQU   INJMJCT+94                                               00995000
JCTEQREG EQU   INJMJCT+92                                               00996000
@NM00042 EQU   INJMJCT+91                                               00997000
JCTDETDA EQU   INJMJCT+88                                               00998000
JCTDSDRA EQU   JCTRSW2                                                  00999000
JCTDSOJB EQU   JCTRSW2                                                  01000000
JCTDSOCR EQU   JCTRSW2                                                  01001000
JCTRESTT EQU   JCTRSW2                                                  01002000
JCTNOCKP EQU   JCTRSW2                                                  01003000
JCTNORST EQU   JCTRSW2                                                  01004000
JCTNARST EQU   JCTRSW2                                                  01005000
JCTSYSCK EQU   JCTRSW2                                                  01006000
@NM00041 EQU   JCTRSW1                                                  01007000
JCTSTEPR EQU   JCTRSW1                                                  01008000
JCTCKPTR EQU   JCTRSW1                                                  01009000
JCTCKFT  EQU   JCTRSW1                                                  01010000
JCTCONTR EQU   JCTRSW1                                                  01011000
JCTSTERM EQU   JCTRSW1                                                  01012000
JCTWARMS EQU   JCTRSW1                                                  01013000
@NM00040 EQU   JCTCCODE+3                                               01014000
JCTJDPOP EQU   JCTCCODE+2                                               01015000
JCTJDPCD EQU   JCTCCODE                                                 01016000
@NM00039 EQU   INJMJCT+53                                               01017000
JCTSCT   EQU   INJMJCT+52                                               01018000
JCTSMRBA EQU   INJMJCT+44                                               01019000
@NM00038 EQU   INJMJCT+43                                               01020000
JCTACTAD EQU   INJMJCT+40                                               01021000
@NM00037 EQU   INJMJCT+39                                               01022000
JCTJCTX  EQU   INJMJCT+36                                               01023000
@NM00036 EQU   INJMJCT+35                                               01024000
JCTSDKAD EQU   INJMJCT+32                                               01025000
JCTJCSMF EQU   INJMJCT+31                                               01026000
JCTGDGNT EQU   INJMJCT+28                                               01027000
@NM00035 EQU   INJMJCT+27                                               01028000
JCTPDIP  EQU   INJMJCT+24                                               01029000
JCTJTPTN EQU   INJMJCT+16                                               01030000
JCTJNAME EQU   INJMJCT+8                                                01031000
JCTJPRTY EQU   JCTJBYTE                                                 01032000
INCMMGL1 EQU   JCTJMGLV                                                 01033000
INCMMGL2 EQU   JCTJMGLV                                                 01034000
@NM00034 EQU   JCTJMGLV                                                 01035000
INCMALL  EQU   JCTJMGLV                                                 01036000
JCTJMGPO EQU   INJMJCT+6                                                01037000
INCMNSET EQU   JCTJSTAT                                                 01038000
INCMCAT  EQU   INDMCTLG                                                 01039000
JCTABEND EQU   JCTJSTAT                                                 01040000
@NM00033 EQU   JCTJSTAT                                                 01041000
JCTJSTPC EQU   JCTJSTAT                                                 01042000
@NM00032 EQU   JCTJSTAT                                                 01043000
JCTJBLBS EQU   JCTJSTAT                                                 01044000
JCTJSRNO EQU   INJMJCT+4                                                01045000
JCTIDENT EQU   INJMJCT+3                                                01046000
JCTDSKAD EQU   INJMJCT                                                  01047000
QMRBN    EQU   SWAQMPA+12                                               01048000
@NM00031 EQU   SWAQMPA+1                                                01049000
QMSWSP   EQU   SWAQMPA                                                  01050000
QMPNC    EQU   QMPCMNC                                                  01051000
QMPCM    EQU   QMPCMNC                                                  01052000
QMEIA    EQU   QMPA+28                                                  01053000
QMWTQ    EQU   QMPA+24                                                  01054000
QMRSD1   EQU   QMPA+22                                                  01055000
QMTID    EQU   QMPA+20                                                  01056000
QMLNK    EQU   QMPA+18                                                  01057000
QMPRI    EQU   QMPA+17                                                  01058000
@NM00030 EQU   QMSTA                                                    01059000
QMSJNL   EQU   QMSTA                                                    01060000
@NM00029 EQU   QMSTA                                                    01061000
QMTPY    EQU   QMPA+15                                                  01062000
QMNOT    EQU   QMPA+14                                                  01063000
QMTLN    EQU   QMPA+12                                                  01064000
QMTST    EQU   QMPA+11                                                  01065000
QMFLT    EQU   QMPA+9                                                   01066000
QMPEB    EQU   QMNAM+4                                                  01067000
QMCAN    EQU   QMNAM                                                    01068000
JFCBX    EQU   LWA+568                                                  01069000
@NM00028 EQU   LWA+176                                                  01070000
@NM00027 EQU   LWA+96                                                   01071000
TPDTSAVE EQU   LWA+84                                                   01072000
TKEYPX   EQU   LWA+68                                                   01073000
TSP2     EQU   LWA+67                                                   01074000
TSP1     EQU   LWA+66                                                   01075000
@NM00026 EQU   LWA+60                                                   01076000
TCLEANUP EQU   LWA+56                                                   01077000
TBEGPX   EQU   LWA+52                                                   01078000
TRR1     EQU   LWA+48                                                   01079000
@NM00025 EQU   LWA+42                                                   01080000
MSGKEY   EQU   LWA+41                                                   01081000
MSGSEC   EQU   LWA+40                                                   01082000
AOQLOCEX EQU   INTWA+1448                                               01083000
RFULLE   EQU   INTWA+1444                                               01084000
IWALWLGN EQU   INTWA+1440                                               01085000
IWAJSCBA EQU   INTWA+1436                                               01086000
IWAJSCBF EQU   INTWA+1432                                               01087000
RBLOCK   EQU   INTWA+1352                                               01088000
SPSAV    EQU   INTWA+1332                                               01089000
DSNAME   EQU   INTWA+1156                                               01090000
SCT      EQU   INTWA+980                                                01091000
@NM00024 EQU   INTWA+978                                                01092000
DNRT     EQU   INTWA+900                                                01093000
JCTX     EQU   INTWA+724                                                01094000
DREFB    EQU   INTWA+372                                                01095000
SREF     EQU   INTWA+196                                                01096000
@NM00023 EQU   INTWA+195                                                01097000
AODFLTKW EQU   AOSW2                                                    01098000
AOMAXERR EQU   AOSW2                                                    01099000
AONOREAD EQU   AOSW2                                                    01100000
@NM00022 EQU   AOSW2                                                    01101000
IWASNUMB EQU   INTWA+193                                                01102000
@NM00021 EQU   SDDNSWA                                                  01103000
IWASCAT2 EQU   SDDNSWA                                                  01104000
IWASCAT  EQU   SDDNSWA                                                  01105000
IWAJCAT  EQU   SDDNSWA                                                  01106000
@NM00020 EQU   SDDNSWA                                                  01107000
SDDNSW   EQU   SDDNSWA                                                  01108000
DDINO    EQU   INTWA+191                                                01109000
IWANELEN EQU   INTWA+190                                                01110000
@NM00019 EQU   CRSW1                                                    01111000
CPDUM    EQU   CRSW1                                                    01112000
@NM00018 EQU   CRSW1                                                    01113000
IWAJBADR EQU   INTWA+188                                                01114000
IWAWRNMS EQU   INTWA+187                                                01115000
JBCONCAT EQU   INTWA+186                                                01116000
@NM00017 EQU   IWAINTS8                                                 01117000
JOBRDR   EQU   IWAINTS8                                                 01118000
JOBRDNC  EQU   IWAINTS8                                                 01119000
JOBRDNR  EQU   IWAINTS8                                                 01120000
@NM00016 EQU   IWAINTS8                                                 01121000
ORFLG2SW EQU   SWG                                                      01122000
@NM00015 EQU   SWG                                                      01123000
ORSDPOR  EQU   SWG                                                      01124000
ORRDOR   EQU   SWG                                                      01125000
ORADDROR EQU   SWF                                                      01126000
ORREGOR  EQU   SWF                                                      01127000
ORACTOR  EQU   SWF                                                      01128000
ORTIME0  EQU   SWF                                                      01129000
ORTIMEOR EQU   SWF                                                      01130000
ORCONDOR EQU   SWF                                                      01131000
ORPARMBL EQU   SWF                                                      01132000
ORPARMOR EQU   SWF                                                      01133000
TIMDFPRC EQU   SWD                                                      01134000
DCTFST   EQU   SWD                                                      01135000
@NM00014 EQU   SWD                                                      01136000
DBFST    EQU   SWD                                                      01137000
FDDRCV   EQU   SWD                                                      01138000
FEXRCV   EQU   SWD                                                      01139000
JOBREGNS EQU   SWD                                                      01140000
JOBADDRF EQU   SWD                                                      01141000
@NM00013 EQU   SWC                                                      01142000
VOLREF   EQU   SWC                                                      01143000
DSNTQ    EQU   SWC                                                      01144000
@NM00012 EQU   SWC                                                      01145000
@NM00011 EQU   SWA                                                      01146000
SCTTQ    EQU   SWA                                                      01147000
JCTTQ    EQU   SWA                                                      01148000
JHS      EQU   SWA                                                      01149000
@NM00010 EQU   SWA                                                      01150000
IWAQENTR EQU   IWAEXTS                                                  01151000
@NM00009 EQU   IWAEXTS                                                  01152000
DINBPLP1 EQU   INTWA+178                                                01153000
DJBCLAS  EQU   INTWA+177                                                01154000
IWACATCT EQU   INTWA+176                                                01155000
DDINTNO  EQU   INTWA+174                                                01156000
JCTXS    EQU   INTWA+172                                                01157000
JFCBES   EQU   INTWA+170                                                01158000
ACTS     EQU   INTWA+168                                                01159000
POVRRDS  EQU   INTWA+166                                                01160000
DREFBS   EQU   INTWA+164                                                01161000
SREFBS   EQU   INTWA+162                                                01162000
DSNAMES  EQU   INTWA+160                                                01163000
JFCBXS   EQU   INTWA+158                                                01164000
JFCBS    EQU   INTWA+156                                                01165000
SIOTS    EQU   INTWA+154                                                01166000
JACTS    EQU   INTWA+152                                                01167000
SCTS     EQU   INTWA+150                                                01168000
JCTS     EQU   INTWA+148                                                01169000
JEDSWS   EQU   INTWA+146                                                01170000
UNNU     EQU   INTWA+144                                                01171000
@NM00008 EQU   INTWA+143                                                01172000
UNQNAME  EQU   INTWA+120                                                01173000
ORIDSNM  EQU   INTWA+112                                                01174000
AOJRNLEX EQU   INTWA+104                                                01175000
IWASAVPT EQU   INTWA+100                                                01176000
DSNTPSA  EQU   INTWA+96                                                 01177000
IWAJFCBP EQU   INTWA+92                                                 01178000
IWASIOTP EQU   INTWA+88                                                 01179000
IWASCTAD EQU   INTWA+84                                                 01180000
IWAJSIOT EQU   INTWA+80                                                 01181000
TSAVEP   EQU   INTWA+72                                                 01182000
IWAJMRPT EQU   INTWA+68                                                 01183000
IWANXTSV EQU   INTWA+64                                                 01184000
IWAEXPNO EQU   INTWA+60                                                 01185000
IWASTAPL EQU   INTWA+56                                                 01186000
IWAJOBS6 EQU   INTWA+52                                                 01187000
IWAJOBS3 EQU   INTWA+44                                                 01188000
IWAJOBS1 EQU   INTWA+36                                                 01189000
DSENQTP  EQU   INTWA+32                                                 01190000
RELPGM   EQU   INTWA+28                                                 01191000
RELPROC  EQU   INTWA+24                                                 01192000
TPROC    EQU   INTWA+20                                                 01193000
TACT     EQU   INTWA+16                                                 01194000
TSREFB   EQU   INTWA+12                                                 01195000
TJOBLIB  EQU   INTWA+8                                                  01196000
TSIOT    EQU   INTWA+4                                                  01197000
IWAINTS5 EQU   INTWA                                                    01198000
RBYTE5   EQU   COMWA+371                                                01199000
RBYTE4   EQU   COMWA+370                                                01200000
RBYTE3   EQU   COMWA+369                                                01201000
RBYTE2   EQU   COMWA+368                                                01202000
RBYTE1   EQU   COMWA+367                                                01203000
@NM00007 EQU   SWY2                                                     01204000
KEYNXTSW EQU   SWY2                                                     01205000
DYNAMSW  EQU   SWY2                                                     01206000
DUMMYSW  EQU   SWY2                                                     01207000
@NM00006 EQU   SWI                                                      01208000
DSNLIT   EQU   SWI                                                      01209000
BLKMLTER EQU   SWI                                                      01210000
@NM00005 EQU   SWI                                                      01211000
IWADDNM  EQU   SWI                                                      01212000
WAWRNWTO EQU   SWI                                                      01213000
BLKPRC   EQU   SWI                                                      01214000
@NM00004 EQU   SWH                                                      01215000
CPSTPFL  EQU   SWH                                                      01216000
PROCSW   EQU   SWH                                                      01217000
CPFLGXX  EQU   SWH                                                      01218000
CPSYSFLG EQU   SWH                                                      01219000
@NM00003 EQU   SWH                                                      01220000
SEQUENCE EQU   SWE                                                      01221000
POVRX    EQU   SWE                                                      01222000
POVRD    EQU   SWE                                                      01223000
CONCAT   EQU   SWE                                                      01224000
PRCV     EQU   SWE                                                      01225000
PREF     EQU   SWE                                                      01226000
GPI      EQU   SWE                                                      01227000
PROCPLS  EQU   SWE                                                      01228000
CWATERM  EQU   AOSW4                                                    01229000
AODFWMSG EQU   AOSW4                                                    01230000
AOSWALOC EQU   AOSW4                                                    01231000
AOMSGTXT EQU   AOSW4                                                    01232000
AOWRNREQ EQU   AOSW4                                                    01233000
@NM00002 EQU   AOSW4                                                    01234000
AOTXTWRT EQU   AOSW1                                                    01235000
AOPRTSW  EQU   AOSW1                                                    01236000
AONOPLIB EQU   AOSW1                                                    01237000
AOILGLOP EQU   AOSW1                                                    01238000
AOIOERR  EQU   AOSW1                                                    01239000
AOENDKSW EQU   AOSW1                                                    01240000
AOFSTPOS EQU   AOSW1                                                    01241000
RHALF5   EQU   COMWA+358                                                01242000
RHALF4   EQU   COMWA+356                                                01243000
RHALF3   EQU   COMWA+354                                                01244000
RHALF2   EQU   COMWA+352                                                01245000
RHALF1   EQU   COMWA+350                                                01246000
WASTMTNO EQU   COMWA+348                                                01247000
CWALABEL EQU   CWAMCSCA+1                                               01248000
IWAMCSCA EQU   CWAMCSCA                                                 01249000
IWARET   EQU   CWARET                                                   01250000
AOLOCPL  EQU   COMWA+340                                                01251000
AOSUBSYS EQU   COMWA+336                                                01252000
AOSSOB   EQU   COMWA+332                                                01253000
AOSSIB   EQU   COMWA+328                                                01254000
AOQLOCEP EQU   COMWA+324                                                01255000
WAEXCPFX EQU   COMWA+316                                                01256000
WAJOBPFX EQU   COMWA+308                                                01257000
WAJBNAME EQU   COMWA+300                                                01258000
WAEXCRBA EQU   COMWA+292                                                01259000
WAJOBRBA EQU   COMWA+284                                                01260000
WAWRKLTH EQU   COMWA+244                                                01261000
WAMSGBUF EQU   COMWA+240                                                01262000
WANELPTR EQU   COMWA+236                                                01263000
RPLADDR  EQU   WARPL                                                    01264000
@NM00001 EQU   IWAIOSA+8                                                01265000
IWASACHN EQU   IWAIOSA+4                                                01266000
TRSAVE   EQU   IWAIOSA                                                  01267000
AOEPWORK EQU   COMWA+80                                                 01268000
AOSTAPRM EQU   COMWA+76                                                 01269000
AOJMRGEP EQU   COMWA+72                                                 01270000
NEXTPTR  EQU   COMWA+68                                                 01271000
BUFEND   EQU   COMWA+64                                                 01272000
BUFADDR  EQU   COMWA+60                                                 01273000
AOWSTMT  EQU   COMWA+56                                                 01274000
TERMRTN  EQU   COMWA+52                                                 01275000
TBUFCOPY EQU   COMWA+48                                                 01276000
TEXTBUFP EQU   COMWA+44                                                 01277000
JACTLPTR EQU   COMWA+40                                                 01278000
TNEXT    EQU   COMWA+32                                                 01279000
IWAINTS0 EQU   COMWA+28                                                 01280000
QMGRP    EQU   COMWA+24                                                 01281000
CTRLWAP  EQU   COMWA+20                                                 01282000
SAVEPTR  EQU   COMWA+16                                                 01283000
QPARMP   EQU   COMWA+12                                                 01284000
IWACONID EQU   CWACONID                                                 01285000
IWAID    EQU   CWAID                                                    01286000
IWAL     EQU   CWAL                                                     01287000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01288000
@RF00168 EQU   @EL00001                                                 01289000
@ENDDATA EQU   *                                                        01290000
         END   IEFNB901,(C'PLS2130',0701,78055)                         01291000
./  ADD  SSI=80550270,NAME=IEFNB903
*****************************************************************Y02668 00201002
*                                                                       00202002
*                                                                       00203002
*  MODULE NAME - IEFNB903                                               00204002
*                                                                       00205002
*                                                                       00206002
*  DESCRIPTIVE NAME - INTERPRETER INITIALIZATION ROUTINE                00207002
*                                                                       00208002
*                                                                       00209002
*  COPYRIGHT - N/A                                                      00210002
*                                                                       00211002
*                                                                       00212002
*  STATUS - VS2 SU16 -IN THIS MODULE, SU 16 SUPPORTS           @G16AP2F 00213003
*           VPSS SUPPORT (SU 29 - @G29AN2F).                   @G16AP2F 00213303
*           MERGE SU4,10,16 CODE TO REL 037 PTF                @ZA27750 00213603
*                                                                       00214002
*                                                                       00215002
*  FUNCTION - THIS ROUTINE GETS AND PARTIALLY INITIALIZES INTERPRETER   00216002
*             WORK AREAS AND CONTROL BLOCKS.                            00217002
*                                                                       00218002
*     OPERATION - . SAVES CALLER'S REGISTERS AND BEGINS INITIALIZATION  00219002
*                 . CORE IS GOTTEN AND INITIALIZED FOR THE INTERPRETER  00220002
*                   WORK AREA(IWA), I/O BUFFER, JMR, LOCAL WORK AREA    00221002
*                   (MAPPED BY EWA,DWA,JWA), DSENQ TABLE, AND SYSOUT    00222002
*                   MESSAGE BUFFER.   REG12 IS SET TO POINT TO THE      00223002
*                   IWA FOR THE LIFE OF THE INTERPRETER.                00224002
*                 . A REG SAVE AREA IS GOTTEN, CHAINED AND THE          00225002
*                   POINTER TO IT SAVED IN THE IWA.                     00226002
*                 . A PTR TO THE INTERPRETER TERMINATION RTN IS         00227002
*                   SAVED IN THE IWA.                                   00228002
*                 . THE QMPA PASSED BY THE CALLER IS MOVED INTO THE     00229002
*                   IWA.                                                00230002
*                 . IF USING SMF THE JMR IS MOVED FROM THE CALLER'S     00231002
*                   CORE.                                               00232002
*                 . THE UNIQUE DSN FIELD (FOR TEMP DATA SET NAMES) IS   00233002
*                   INITIALIZED IN THE IWA.                             00234002
*                 . SCONS FOR THE KEYWORD SERVICE RTNS ARE CALCULATED   00235002
*                   AND SAVED IN THE IWA.                               00236002
*                 . AN ESTAE ENVIRONMENT IS ESTABLISHED FOR THE         00237002
*                   INTERPRETER.                                        00238002
*                 . SWA SUPPORT - THE NEL EXIT LIST IS SCANNED @G29AN2F 00239003
*                   FOR AN ALTERNATE SWA MANAGER MOVE MODE AND @G29AN2F 00239803
*                   LOCATE MODE ENTRY POINTS.                  @G29AN2F 00240603
*                   AN ALTERNATE ENTRY FOR THE MOVE MODE       @G29AN2F 00241403
*                   POINTS TO THE JOURNAL MERGE INTERFACE ROUTINE.      00243002
*                   IF THE ENTRY DOES NOT EXIST NO JOURNAL              00244002
*                   MERGE CAN TAKE PLACE.   IF THE ENTRY IS FOUND       00245002
*                   THE JOURNAL MERGE RTN IS LOADED AND ITS ADDR        00246002
*                   SAVED IN THE IWA.   IEFVHQ TESTS THIS ADDR FIELD    00247002
*                   AND IF INITIALIZED, EXITS TO IT INSTEAD OF GOING    00248002
*                   DIRECTLY TO THE SWA MANAGER.   THE JOURNAL MERGE    00249002
*                   RTN IS DELETED BY IEFVHN AT TERMINATION.            00250002
*                   AN ALTERNATE ENTRY FOR THE LOCATE MODE     @G29AN2F 00250103
*                   CAUSES THE ROUTINE TO BE LOADED AND ITS    @G29AN2F 00250203
*                   ADDR SAVED IN THE COMWA. IEFVHQ TESTS THIS @G29AN2F 00250303
*                   ADDR FIELD AND IF INITIALIZED, EXITS TO IT @G29AN2F 00250403
*                   INSTEAD OF GOING DIRECTLY TO THE SWA MNGR  @G29AN2F 00250503
*                   FOR LOCATE MODE. THE ALTERNATE SWA MANAGER @G29AN2F 00250603
*                   LOCATE MODE IS DELETED BY IEFVHN AT TERMIN-@G29AN2F 00250703
*                   ATION.                                     @G29AN2F 00250803
*                                                                       00251002
*                                                                       00252002
*  NOTES -                                                              00253002
*                                                                       00254002
*     DEPENDENCIES - NONE                                               00255002
*     CHARACTER-CODE DEPENDENCIES - EBCDIC                              00256002
*     RESTRICTIONS - NONE                                               00257002
*     REGISTER CONVENTIONS - REG 11 - MODULE BASE                       00258002
*                            REG 12 - IWA PTR                           00259002
*                            REG 13 - REG SAVE AREA PTR                 00260002
*     PATCH-LABEL - PATCH                                               00261002
*                                                                       00262002
*                                                                       00263002
*  MODULE TYPE - PLS                                                    00264002
*     PROCESSOR - PLSII COMPILER                                        00265002
*     ATTRIBUTES - REFRESHABLE, PRIVILEGED, REENTRANT, KEY 0,           00266002
*                  PAGEABLE LPA                                         00267002
*                                                                       00268002
*                                                                       00269002
*  ENTRY POINT - IEFNB903 FROM IEFIB600 (SWA CREATE)                    00270002
*     PURPOSE - TO HAVE INTERPRETER CREATE JOB CONTROL BLOCKS IN        00271002
*               SWA.                                                    00272002
*     LINKAGE - LINK                                                    00273002
*     INPUT - R1 - PTR TO NEL, R13 - PTR TO REG SAVE AREA               00274002
*     REGISTERS SAVED - REG14-REG12                                     00275002
*     REGISTER USAGE -                                                  00276002
*                     R0  - WORK REG                                    00277002
*                     R1  - WORK REG                                    00278002
*                     R2  - WORK REG( ADDRESSES SEVERAL CONTROL         00279002
*                           BLOCKS AT DIFFERENT TIMES)                  00280002
*                     R3  - POINTS TO NEL                               00281002
*                     R4  - WORK REG                                    00282002
*                     R5  - WORK REG                                    00283002
*                     R6  - UNUSED                                      00284002
*                     R7  - UNUSED                                      00285002
*                     R8  - UNUSED                                      00286002
*                     R9  - UNUSED                                      00287002
*                     R10 - LINKAGE REG                                 00288002
*                     R11 - MODULE BASE                                 00289002
*                     R12 - PTR TO IWA                                  00290002
*                     R13 - REG SAVE AREA PTR                           00291002
*                     R14 - LINKAGE AND WORK REG                        00292002
*                     R15 - LINKAGE AND WORK REG                        00293002
*     REGISTERS RESTORED - NONE                                         00294002
*                                                                       00295002
*                                                                       00296002
*  EXIT - NORMAL  - IEFVHE                                              00297002
*     CONDITIONS - INITIALIZATION COMPLETE AND READY TO GET             00298002
*                  FIRST TEXT STRING                                    00299002
*     OUTPUT - REG 12 - PTR TO IWA, REG 13 - PTR TO REG SAVE AREA       00300002
*     RETURN CODES - NONE                                               00301002
*                                                                       00302002
*                                                                       00303002
*  EXIT - ERROR - NONE                                                  00304002
*                                                                       00305002
*                                                                       00306002
*  EXTERNAL REFERENCES -                                                00307002
*     ROUTINES - IEFVHQ (TO ASSIGN SVA'S)                               00308002
*                IEFVHN (TO GET TERM RTN ADDR AND SAVE IN IWA)          00309002
*     DATA AREAS - IWA, LWA, QMPA                                       00310002
*     CONTROL BLOCKS - JMR, JCT, SCT                                    00311002
*     TABLES - INTERNAL KEYS (IEFVKEYS)                                 00312002
*     MACROS - LOAD, GETMAIN, FREEMAIN, IEFVMIWA, IEFVMDWA,             00313002
*              IEFVMEWA, IEFVMJWA, IEFJMR, IEFAJCTB, IEFASCTB,          00314002
*              IEFNEL, IEFQMNGR                                         00315002
*     SERIALIZATION - NONE                                              00316002
*                                                                       00317002
*                                                                       00318002
*  CHANGE ACTIVITY - Z40MPTH,Z40RPSM,@G29AN2F,ZA27750          @ZA27750 00319003
*                                                                       00320002
*                                                                       00321002
*  MESSAGES - NONE                                                      00322002
*                                                                       00323002
*                                                                       00324002
*****************************************************************Y02668 00325002
         EJECT                                                          00326002
         SPACE 5                                                        00400002
JCTD     DSECT                                                          00600002
         IEFAJCTB                                                       00800002
         EJECT                                                          00900002
JCTXD    DSECT                                                 @Z40RPSM 00907003
         IEFJCTX                                               @Z40RPSM 00914003
         EJECT                                                          00921003
         IEFCOMWA                                                       00930002
         IEFVMIWA                                                       00960002
         SPACE 5                                                        01000002
NEL      DSECT                                                          01200002
         IEFNEL  SUBCOM=I,EXITS=(QEP,SMF,RTN)                           01400002
         SPACE 5                                                        01600002
         IFGRPL                                                         01800002
         SPACE 5                                                        02000002
SCTD     DSECT                                                          02200002
         IEFASCTB                                                       02400002
         SPACE 5                                                        02600002
         IEFVMEWA NA                                           @Z40MPTH 02800003
         SPACE 5                                                        03000002
         IEFVMJWA  NA                                                   03200002
         SPACE 5                                                        03400002
         IEFVMDWA  NA                                                   03600002
ENDWA    EQU   *                                               @Z40MPTH 03640003
         SPACE 5                                                        03680003
AWA      DSECT               ADDRESSABILITY TO AWA....         @Z40MPTH 03720003
         IEFVMAWA                                              @Z40MPTH 03760003
         SPACE 5                                                        03800002
         IEFQMNGR                                                       04000002
         SPACE 5                                                        04200002
         IEFJMR                                                         04400002
         SPACE 5                                                        04600002
         IEFZB9RD                                                       04660002
         SPACE 5                                                        04720002
         IEFVKEYS                                                       04800002
         SPACE 5                                                        05000002
         SPACE 5                                                        05400002
GENDSNAM DSECT                                                   Y02668 05600002
PREFIX   DS    CL3                                               Y02668 05800002
DATE     DS    CL5                                               Y02668 06000002
PERIOD   DS    CL1                                               Y02668 06200002
PREFIX1  DS    CL1                                               Y02668 06400002
TIME     DS    CL6                                               Y02668 06600002
PERIOD2  DS    CL1                                               Y02668 06800002
DSTYPE   DS    CL1                                               Y02668 07000002
SYSTYPE  DS    CL1                                               Y02668 07200002
FILLER   DS    CL3                                               Y02668 07400002
PERIOD3  DS    CL1                                               Y02668 07600002
         EJECT                                                          07800002
IEFNB903 CSECT                                                          08000002
         ENTRY TRACE                                                    08200002
         STM   14,12,12(13)        SAVE CALLER'S REGS            Y02668 08400002
         BALR  RB,0                MODULE BASE REG               Y02668 08600002
         USING *,RB                GET ADDRESSABILITY            Y02668 08800002
         B     NB903BGN            BYPASS DECLARED STORAGE       Y02668 09000002
         MODID BR=NO                                             Y02668 09100002
*        DC    C'SU16'            FUNCTION ID                  @G16AP2F 09200003
*        DC    C'01'              LEVEL # (SU16)               @G16AP2F 09250003
         DC    C'02'   LEV # (MERGE SU4,10,16 CODE TO 037 PTF) @ZA27750 09300003
NB903BGN DS    0H                                                Y02668 09800002
*                                                                Y02668 10000002
*  INITIALIZE INTERPRETER                                        Y02668 10200002
*                                                                Y02668 10400002
         SPACE 2                                                 Y02668 10600002
         LR    R3,R1               SAVE NEL ADDR BECAUSE R1      Y02668 10800002
         USING NEL,R3              IS CLOBBERED BY GETMAIN       Y02668 11000002
         EJECT                                                   Y02668 11200002
*****************************************************************Y02668 11400002
*                                                               *Y02668 11600002
*  GET CORE FOR WORK AREAS AND INITIALIZE                       *Y02668 11800002
*                                                               *Y02668 12000002
*****************************************************************Y02668 12200002
         SPACE 2                                                 Y02668 12400002
         IEFSAVER  ,               GET INTERPRETER SAVE AREA     Y02668 12600002
         LA    R0,WALTH            LOAD WORK AREA LENGTH.        Y02668 12700002
         BAL   RA,VHEGAC           GET CORE FOR IWA AND CLEAR IT.Y02668 13000002
         LR    RC,R1               INITIALIZE REG12 TO POINT TO  Y02668 19000002
*                                  IWA. R12  POINTS TO IWA THRU  Y02668 19200002
*                                  LIFE OF INTERPRETER           Y02668 19400002
         XC    BUFADDR(4),BUFADDR  INIT TO 0 FOR INTERP *TEMP****Y02668 19600002
         LA    R0,WALTH            LOAD WORK AREA LENGTH.        Y02668 19800002
         ST    R0,IWAL             SAVE LENGTH IN FIRST WORD     Y02668 20000002
         MVC   IWAID,ID            INITIALIZE IWA IDENTIFIER     Y02668 20200002
         ST    R3,WANELPTR         SAVE NEL PTR IN IWA           Y02668 20400002
         ST    RD,SAVEPTR          SAVE PTR TO CURRENT SAVE AREA Y02668 20600002
         MVC   IWASAVPT(WORDLEN),WORDLEN(RD)   SAVE PTR TO       Y02668 20660002
*                                  CALLER'S SAVE AREA            Y02668 20720002
         L     R0,IEFVHNV          GET PTR TO INTERPRETER        Y02668 20800002
*                                  TERMINATION ROUTINE           Y02668 21000002
         ST    R0,TERMRTN          SAVE IN IWA FOR C/I COMMON    Y02668 21200002
*                                  SERVICE RTNS                  Y02668 21400002
         MVC   IWACONID(WORDLEN),NELCOMID UNCONDITIONALLY MOVE   Y02668 21600002
*                                  CONSOLE ID TO IWA - ZERO VALUEY02668 21800002
*                                  RESULTS IN A DEFAULT TO THE   Y02668 22000002
*                                  MASTER CONSOLE - USED BY WTO  Y02668 22200002
*        CALCULATE THE LONGEST WORKAREA AND GETCORE FOR THAT   @Z40MPTH 22400003
*        LENGTH...                                             @Z40MPTH 22410003
         SPACE 1                                                        22420003
         LA    R0,LJWA            LENGTH OF JWA                @Z40MPTH 22430003
         LA    R5,LEWA            LENGTH OF EWA                @Z40MPTH 22440003
         CR    R0,R5              IS EWA LONGER THAN JWA?      @Z40MPTH 22450003
         BH    NB9JWA             JWA IS LONGER,LEAVE R0 SAME  @Z40MPTH 22460003
         LR    R0,R5              R5(EWA) GREATER THAN R0(JWA) @Z40MPTH 22470003
NB9JWA   EQU   *                                               @Z40MPTH 22480003
         LA    R5,LDWA            LENGTH OF DWA                @Z40MPTH 22490003
         CR    R0,R5              IS DWA LONGER THAN  R0 LENTH @Z40MPTH 22500003
         BH    NB9GET             R0 LENGTH IS GREATER,ADD AWA @Z40MPTH 22510003
         LR    R0,R5              DWA LONGER THAN LENGTH IN R0.@Z40MPTH 22520003
NB9GET   EQU   *                  LENGTH OF AWA ADDED TO LENGTH@Z40MPTH 22530003
*                                 OF LONGEST WORKAREA.         @Z40MPTH 22540003
         LA    R5,LNGTHAWA        LENGTH OF AWA                @Z40MPTH 22550003
         AR    R0,R5              ADD AWA LEN TO LONGEST WKAREA@Z40MPTH 22560003
         ST    R0,IWALWLGN      STORE LWA LENGTH INTO IWA FOR  @Z40MPTH 22570003
*                                 IEFVHN TO FREE IT WITH       @Z40MPTH 22580003
         BAL   RA,VHEGAC           GET CORE FOR LOCAL WORK AREA  Y02668 22600002
*                                  AND CLEAR IT                  Y02668 22800002
         ST    R1,CTRLWAP          SAVE PTR TO LWA IN IWA        Y02668 23000002
         EJECT                                                          23400002
*****************************************************************Y02653 23405002
*                                                                Y02653 23410002
* SETUP ESTAE ENVIRONMENT OVER INTERPRETER                       Y02653 23415002
*                                                                Y02653 23420002
*****************************************************************Y02653 23425002
        SPACE 1                                                         23430002
         L     R0,LENESTAE         GET CORE FOR ESTAE LIST FORM  Y02653 23435002
         BAL   RA,VHEGAC           GET CORE SUBROUTINE           Y02653 23440002
         LR    R5,R1               ADDRESSABILITY FOR ESTAE LIST Y02653 23445002
         L     R4,LENESTAE         LENGHT OF LIST FORM FOR MOVE  Y02653 23450002
         BCTR  R4,0          DECREMENT FOR MOVE INTO CORE.      YM02681 23452002
         EX    R4,MOVESTAE         MOVE LIST TO GOTTEN CORE      Y02653 23455002
         LA    R0,EREPLEN          LENGTH OF USER PARAMETER AREA Y02653 23460002
         BAL   RA,VHEGAC           GET CORE SUBROUTINE           Y02653 23465002
         LR    R4,R1               ADDRESSABILITY TO PARAM AREA  Y02653 23470002
         ST    R4,AOSTAPRM         ADDRESS OF USER PARAM AREA    Y02653 23475002
         USING EREPL,R4      ADDRESSABILITY TO USER PARMAETERS   Y02653 23480002
         ST    RC,EREPLIWA         IWA ADDR IN PARAM AREA ESTAE  Y02653 23485002
         MVC   EREPLRSV(LEN4),IWASAVPT   CALLERS S/A PTR TO EREPLY02653 23490002
         DROP  R4                  DROP ADDRESSABILITY PARAM AREAY02653 23495002
         L     R6,IEFNB9IR         ADDRESS OF ESTAE EXIT         Y02653 23500002
*                                                                Y02653 23505002
         ESTAE (6),PARAM=(4),MF=(E,(5))                          Y02653 23510002
         LTR   RF,RF          WAS ESTAE SUCCESSFUL?              Y02653 23515002
         BZ    NB903ES       YES,CONTINUE NORMALLY               Y02653 23520002
*        IF ESTAE WAS NOT SUCCESSFUL,FREE THE USER PARAMETER     Y02653 23525002
*        AREA AND ZERO THE POINTER TO IT IN THE IWA.             Y02653 23530002
         L     R1,AOSTAPRM        ADDRESS OF USER AREA GOTTEN    Y02653 23535002
         LA    R0,EREPLEN         LENGTH OF USER AREA            Y02653 23540002
         FREEMAIN R,LV=(0),A=(1)  FREE USER PARAMETER LIST       Y02653 23545002
         XC    AOSTAPRM(4),AOSTAPRM  ZERO USER PARAM PTR.        Y02653 23550002
NB903ES  DS    0H                                                Y02653 23555002
*        FREE ESTAE EXIT LIST IN GOTTEN CORE                            23560002
         LR    R1,R5              ADDRESS OF LIST IN CORE        Y02653 23565002
         L     R0,LENESTAE        LENGTH OF LIST IN CORE         Y02653 23570002
         FREEMAIN R,LV=(0),A=(1)   FREE CORE                     Y02653 23575002
         EJECT                                                          23585002
*****************************************************************Y02668 23600002
*                                                               *Y02668 23800002
*  SET UP QMPA, JMR AND DSENQ TABLE IN INTERPRETER'S  CORE      *Y02668 24000002
*  LOAD IEFUJV                                                  *YM0581 24100002
*                                                               *Y02668 24200002
*****************************************************************Y02668 24400002
         SPACE 2                                                 Y02668 24600002
         L     R1,NELQMPA          GET PTR TO QMPA PASSED BY     Y02668 24800002
*                                  THE INTERPRETER'S CALLER      Y02668 25000002
         MVC   QPARM(QMPALEN),NONE(R1)  MOVE CALLER'S QMPA       Y02668 25200002
*                                  INTO INTERPRETER WORK AREA    Y02668 25400002
*                                  THIS ALLOWS CALLER TO SPECIFY Y02668 25600002
*                                  SWA SUBPOOL FOR INTERPRETER   Y02668 25800002
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 26000002
         BZ    VHEDSENQ            NO, BYPASS JMR PROCESSING     Y02668 26200002
         LA    R0,TABLEN           GET LENGTH OF JMR             Y02668 26400002
         BAL   RA,VHEGAC           GET CORE AND CLEAR FOR JMR    Y02668 26600002
         ST    R1,IWAJMRPT         SAVE JMR PTR IN IWA           Y02668 26800002
         USING JMR,R1              ADDRESS NEWLY GOTTEN CORE     Y02668 27000002
         L     RE,NELJMR           GET PTR TO CALLER'S JMR       Y02668 27200002
         MVC   JMRJOB(JESSJMR),NONE(RE)  MOVE JMR INTO           Y02668 27400002
*                                  INTERPRETER'S CORE-SO THE USERY02668 27600002
*                                  CANNOT ACCESS JESS CORE       Y02668 27800002
         LOAD  EP=IEFUJV           LOAD USER ROUTINE.           YM00581 27860002
         L     R1,IWAJMRPT         RESTORE R1,DESTROYED BY LOAD YM00581 27900002
         ST    R0,JMRUJVP                                       YM00581 27940002
         LA    R2,JCT              GET JCT PTR                  YM00388 28000002
         USING JCTD,R2             ADDRESS JCT                   Y02668 28200002
         MVC   JCTJMROP(1),JMROPT  PUT SMF OPTIONS IN JCT        Y02668 28400002
         DROP  R2                                                       28600002
         DROP  R1                                                Y02668 28800002
VHEDSENQ DS    0H                                                Y02668 29000002
         LA    R0,TABLEN           GET DSENQ TABLE LENGTH        Y02668 29200002
         BAL   RA,VHEGAC           GET AND CLEAR CORE FOR TABLE  Y02668 29400002
         ST    R1,DSENQTP          SAVE DSENQ TABL PTR IN IWA    Y02668 29600002
         EJECT                                                   Y02668 29800002
*****************************************************************Y02668 30000002
*                                                               *Y02668 30200002
*  GET I/O BUFFERS AND INITIALIZE PTRS IN IQA                   *Y02668 30400002
*                                                               *Y02668 30600002
*****************************************************************Y02668 30800002
         SPACE 2                                                 Y02668 31000002
         LH    R0,TXTBUFLT         GET LENGTH OF TEXT BUFFER     Y02668 31200002
         BAL   RA,VHEGAC           GET AND CLEAR CORE FOR        Y02668 31400002
*                                  INTERNAL TEXT BUFFER          Y02668 31600002
         LH    R0,TXTBUFLT         GET TEXT BUFFER LENGTH AGAIN  Y02668 31800002
         ST    R0,NONE(R1)         PUT LENGTH IN HEADER          Y02668 31880002
         MVC   WORDLEN(WORDLEN,R1),TEXTID PUT ID IN TEXT BUF     Y02668 31960002
         LA    R1,DBLEWORD(R1)     ALLOW FOR DOUBLE WORD HEADER  Y02668 32040002
         ST    R1,TEXTBUFP         SAVE PTR TO 1ST AVAILABLE BYTEY02668 32120002
         LA    R0,AOWBFLTH         GET LENGTH OF SYSTEM OUTPUT   Y02668 32200002
*                                  BUFFER                        Y02668 32400002
         BAL   RA,VHEGAC           GET CORE FOR BUFFER AND CLEAR Y02668 32600002
         ST    R1,AOWSTMT          SAVE BUFFER PTR IN IWA        Y02668 32800002
         LA    R0,MSBUFLEN         GET MSG BUFFER LENGTH         Y02668 32840002
         BAL   RA,VHEGAC           GET AND CLEAR CORE FOR MSG    Y02668 32880002
*                                  BUFFER FOR VGM                Y02668 32920002
         ST    R1,WAMSGBUF         SAVE MSG BUF PTR IN IWA       Y02668 32960002
         EJECT                                                   Y02668 33000002
*****************************************************************Y02668 33200002
*                                                               *Y02668 33400002
*  CREATE UNIQUE DSN QUALIFIER - USED FOR SYSTEM GENERATED DSNS *Y02668 33600002
*                                                               *Y02668 33800002
*****************************************************************Y02668 34000002
         SPACE 2                                                 Y02668 34200002
         LA    R2,UNQNAME          GET PTR TO UNIQUE NAME FIELD  Y02668 34400002
*                                  IN IWA                        Y02668 34600002
         USING GENDSNAM,R2         ADDRESS GENERATED DSNAME      Y02668 34800002
*                                  STRUCTURE AND MAP IT INTO IWA Y02668 35000002
         MVC   PREFIX,SYS          INSERT PREFIX INTO NAME(SYS)  Y02668 35200002
         SPACE 1                                                 Y02668 35400002
*****************************************************************Y02668 35600002
*                                                               *Y02668 35800002
* GET DATE AND TIME BY ISSUING TIME MACRO-                      *Y02668 36000002
*                     R0 RETURNS WITH TIME                      *Y02668 36200002
*                     R1 RETURNS WITH DATE                      *Y02668 36400002
*                                                                Y02668 36600002
*****************************************************************Y02668 36800002
         SPACE 1                                                 Y02668 37000002
         LA    R0,DBLEWORD         GET WORK AREA FOR UNPACK      Y02668 37200002
         BAL   RA,VHEGAC           INSTRUCTION                   Y02668 37400002
         LR    R4,R1               SAVE WORK AREA ADDRESS        Y02668 37600002
         SR    R0,R0               ????  TEMP ***********        Y02668 37800002
         TIME  DEC                 IN DECIMAL, READY TO UNPACK   Y02668 38000002
         ST    R1,NONE(R4)         PREPARE TO UNPACK DATE IN WORKY02668 38200002
*                                  AREA                          Y02668 38400002
         UNPK  NONE(LEN8,R4),NONE(LEN4,R4) UNPACK DATE           Y02668 38600002
         OI    SIGNDIGT(R4),SIGN   CHANGE SIGN DIGIT             Y02668 38800002
         MVC   DATE(LEN5),DATEDSPL(R4) DATE TO NAME FIELD        Y02668 39000002
         MVI   PERIOD,DOT          INSERT QUALIFYING PERIOD      Y02668 39200002
*  TIME                                                          Y02668 39400002
         XC    NONE(LEN8,R4),NONE(R4) ZERO WORK AREA FOR NEXT    Y02668 39600002
*                                  UNPACK                        Y02668 39800002
         ST    R0,NONE(R4)         SET UP TO UNPACK TIME         Y02668 40000002
         MVI   PREFIX1,T           MOVE TIME PREFIX(T) TO NAME   Y02668 40200002
         OI    DISPL3(R4),BSIGN    SIGN LAST DIGIT               Y02668 40400002
         UNPK  NONE(LEN8,R4),NONE(LEN4,R4) UNPACK TIME           Y02668 40600002
         MVC   TIME(LEN6),1(R4)    MOVE TIME INTO NAME           Y02668 40800002
         MVI   PERIOD2,DOT         INSERT SECOND QUALIFYING      Y02668 41000002
*                                  PERIOD                        Y02668 41200002
         MVI   DSTYPE,R            INDICATE SYSIN D.S.-VDA CAN   Y02668 41400002
*                                  CHANGE                        Y02668 41600002
         MVI   SYSTYPE,A           INDICATE AOS OR VIRTUAL SYSTEMY02668 41800002
         MVC   FILLER(LEN3),ZEROS  SUPPLY FILLER                 Y02668 42000002
         MVI   PERIOD3,DOT         INSERT 3RD AUALIFYING PERIOD  Y02668 42200002
         LR    R1,R4               SET UP TO FREE UNPACK WORK    Y02668 42400002
*                                  AREA                          Y02668 42600002
         FREEMAIN R,LV=DBLEWORD,A=(1) FREE IT                    Y02668 42800002
         DROP  R2                                                Y02668 43000002
         EJECT                                                   Y02668 43200002
*****************************************************************Y02668 43400002
*                                                               *Y02668 43600002
*  SCONS FOR CONTROL BLOCKS IN IWA                              *Y02668 43800002
*                                                               *Y02668 44000002
*****************************************************************Y02668 44200002
         LH    R4,SCONREG2         SET UP SCON BASED ON IWA(R12)        44400002
         LA    R5,JCT-COMWA        RELATIVE PTR TO JCT.          Y02668 44600002
         OR    R5,R4               CREATE JCT SCON                      44800002
         STH   R5,JCTS             SAVE IN IWA                          45000002
         LA    R5,JCTX-COMWA       RELATIVE PTR TO JCTX        @Z40RPSM 45050003
         OR    R5,R4               CREATE JCTX SCON            @Z40RPSM 45100003
         STH   R5,JCTXS            SAVE IN IWA                 @Z40RPSM 45150003
         LA    R5,SCT-COMWA        RELATIVE PTR TO SCT.          Y02668 45200002
         OR    R5,R4               CREATE SCT SCON                      45400002
         STH   R5,SCTS             SAVE IN IWA                          45600002
         LA    R5,DSNAME-COMWA     RELATIVE PTR TO DSN TABLE.    Y02668 45800002
         OR    R5,R4               CREATE DSN TABLE SCON                46000002
         STH   R5,DSNAMES          SAVE IN IWA                          46200002
         LA    R5,SREFB-COMWA      RELATIVE PTR TO 1ST REFERBACK.Y02668 46400002
*                                  DICTIONARY                           46600002
         OR    R5,R4               CREATE DICTIONARY SCON               46800002
         STH   R5,SREFBS           SAVE IN IWA                          47000002
         LA    R5,DREFB-COMWA      RELATIVE PTR TO 2ND REFERBACK.Y02668 47200002
*                                  DICTIONARY                           47400002
         OR    R5,R4               CREATE DICTIONARY SCON               47600002
         STH   R5,DREFBS           SAVE IN IWA                          47800002
*                                                                       48000002
         LH    R4,SCONREG1         SET UP SCON BASED ON LWA(R10)        48200002
         SR    R5,R5               CLEAR REGS                           48400002
         OR    R5,R4               CREATE SCON FOR SWITCHES             48600002
         STH   R5,JEDSWS           SAVE IN IWA                          48800002
         LA    R5,LNGJACT+LNGTHAWA RELATIVE PTR TO JACT                 49000002
         OR    R5,R4               CREATE SCON FOR JACT                 49200002
         STH   R5,JACTS            SAVE IN IWA.                  Y02668 49400002
         LA    R5,LNGTHACT+LNGTHAWA  RELATIVE PTR TO STEP ACT. @Z40MPTH 49600003
         OR    R5,R4               CREATE SCON FORACT                   49650003
         STH   R5,ACTS             SAVE IN IWA                          49700003
         LA    R5,LNGORTAB+LNGTHAWA  RELATIVE PTR TO ORIDE TAB.@Z40MPTH 49750003
         OR R5,R4                  CREATE O'RIDE TABLE SCON             50400002
         STH   R5,POVRRDS          SAVE IN IWA                          50600002
         LA    R5,LNGSIOT+LNGTHAWA RELATIVE PTR TO SIOT                 50800002
         OR    R5,R4               CREATE SIOT SCON                     51000002
         STH   R5,SIOTS            SAVE IN IWA                          51200002
         LA    R5,LNGJFCB+LNGTHAWA RELATIVE PTR TO JFCB                 51400002
         OR    R5,R4               CREATE JFCBX SCON                    51600002
         STH   R5,JFCBS            SAVE IN IWA                          51800002
         LA    R5,LNGJFCBX+LNGTHAWA RELATIVE PTR TO JFCBX               52000002
         OR    R5,R4               CREATE JFCBX SCON                    52200002
         STH   R5,JFCBXS           SAVE IN IWA                          52400002
         LA    R5,LNGJFCBE+LNGTHAWA  RELATIVE PTR TO JFCBE.    @Z40MPTH 52450003
         OR    R5,R4              CREATE JFCB SCON             @Z40MPTH 52500003
         STH   R5,JFCBES          STORE INTO IWA...            @Z40MPTH 52550003
         LA    R5,QPARM            INITIALIZE PTR TO                    52600002
         ST    R5,QPARMP           SWA-MANAGER PARM AREA                52800002
         EJECT                                                          53000002
*****************************************************************       53200002
*                                                               *       53400002
*  ASSIGN SVA'S FOR INTERPRETER CONTROL BLOCKS RESIDING IN SWA  *       53600002
*                                                               *       53800002
*****************************************************************       54000002
         SPACE 2                                                        54200002
         L     R2,QPARMP           GET PTR TO SWA MANAGER               54400002
*                                  PARAMETER AREA                       54600002
         USING IOPARAMS,R2         ADDRESS QMPA                         54800002
         L     RA,CTRLWAP          GET LOCAL WORK AREA PTR       Y02668 55000002
         USING AWA,RA        ADDRESS AWA FOR PARMLIST          @Z40MPTH 55200003
*                                  CONTAINS EXTERNAL PARM LIST   Y02668 55250003
*                                  FOR SWA MANAGER               Y02668 55300003
         XC    QLINKWA(32),QLINKWA ZERO AREA                   @Z40RPSM 55350003
         LA    R5,QLINKWA          GET PTR TO SWA MANAGER               56000002
*                                  EXTERNAL(USER) PARM LIST             56200002
         ST    R5,QMPCL            TELL SWA MANAGER WHERE IT IS         56400002
*                                  BY INITIALIZING FIELD IN QMPA        56600002
         MVI   QMPOP,QMASGS        INDICATE ASSIGN STARTS ARE TO Y02668 56800002
*                                  BE DONE                              57000002
         MVI   QMPCM,RECNO         INDICATE NUMBER OF RECORDS           57200002
*                                  TO ASSIGN                            57400002
         DROP  R2                                                       57600002
         L     RF,IEFVHQV          PTR TO SWA-MNGR INTERFACE RTN        57800002
         BALR  RE,RF               GO TO ASSIGN RECORDS                 58000002
         EJECT                                                   Y02668 58200002
*****************************************************************       58400002
*  INITIALIZE CONTROL BLOCKS/WORK AREAS WITH SVA'S ASSIGNED     *       58600002
*****************************************************************       58800002
         SPACE 1                                                        59000002
         LA    R2,JCT              PTR TO JCT                           59200002
         USING JCTD,R2             ADDRESS JCT                          59400002
         MVC   JCTDSKAD(SVALEN),NONE(R5) MOVE 1ST SVA TO JCT            59600002
         MVC   JCTJCTX(WORDLEN),DISPL28(R5)  MOVE 8TH SVA      @Z40RPSM 59650003
*                               INTO PTR TO JCTX.              @Z40RPSM 59700003
         TM    NELOPSWT,NELSMF     IS SMF BEING USED            YM01587 59750003
         BZ    NB9NOSMF            NO, DON'T INIT JCT WITH JMR  YM01587 59800003
*                                  SVA                          YM01587 59850003
         MVC   JCTJMR(SVALEN),DISPL20(R5) USE 7TH  SVA RETURNED         59900003
*                                  FOR JMR - PUT IT IN JCT              60000002
NB9NOSMF DS    0H                                               YM01587 60100002
         DROP  R2                                                       60200002
         LA    R2,SCT              PTR TO SCT                           60400002
         USING SCTD,R2             ADDRESS SCT                          60600002
         MVC   SCTANSCT(SVALEN),WORDLEN(R5) MOVE 2ND SVA TO SCT         60800002
         DROP  R2                                                       61000002
         MVC   TNEXT(WORDLEN*2),DISPL8(R5)  MOVE 3RD AND 4TH SVA        61200002
*                                  TO IWA TO BE USED LATER              61400002
         MVC   TSIOT(WORDLEN),DISPL16(R5) MOVE 5TH SVA TO IWA TO Y02668 61600002
*                                  LATER BE USED FOR SIOT               61800002
         MVC   IWANXTSV(WORDLEN),DISPL24(R5) MOVE 7TH SVA TO    YM02716*61860002
                                   IWA FOR LATER USE IN DSENQT  YM02716*61900002
                                   AND REFERBACK DICT.          YM02716 61940002
         LA    R2,JCTX            PTR TO JCTX.                 @Z40RPSM 61950003
         USING JCTXD,R2          ADDRESS JCTX.                 @Z40RPSM 61960003
         MVC   JCTXDSKA(WORDLEN),DISPL28(R5)  MOVE 8TH SVA     @Z40RPSM 61970003
*                                  INTO JCTX SELF PTR.         @Z40RPSM 61980003
         DROP  R2                                              @Z40RPSM 61990003
         EJECT                                                          62000002
*****************************************************************       62200002
*                                                               *       62400002
*  EXIT LIST PROCESSING                                         *       62600002
*                                                               *       62800002
*****************************************************************       63000002
         SPACE 2                                                        63200002
VHEEXLST DS    0H                                                       63400002
         L     R2,NELEXLST        LOAD POINTER TO EXIT LIST      Y02621 63420002
         LTR   R2,R2               DOES EXIT LIST EXIST FOR NEL  Y02621 63440002
         BZ    VHEEXOUT            NO,EXIT LIST PROCESSING BYPASSY02621 63460002
         USING NELEXITS,R2                                              63480002
         LH    R4,NELEXLEN         LENGTH OF EXIT LIST           Y02621 63500002
         DROP  R2                                                       63520002
         SRA   R4,3(0)             SHIFT DIVIDEND INTO REGISTER 5Y02621 63540002
         BCTR  R4,0       DECREMENT 1 FOR HEADER,INCLUDED IN LEN Y02621 63560002
*        REGISTER 4 NOW HAS NUMBER OF ENTRIES IN THE EXIT LIST.  Y02621 63580002
         SPACE 1                                                        63600002
VHELOOP1 LA    R2,LEN8(R2)         LOOK AT FIRST EXIT LIST ENTRY Y02621 63620002
         USING NELEXENT,R2                                              63640002
*                                                                       63660002
*   EXIT LIST SEARCH                                                    63680002
*                                                                       63700002
         CLI   NELEXID,NELQEPEX   IS IT JOURNAL MERGE ENTRY?     Y02621 63720002
         BE    VHEJRNLX           YES,PROCESS THE ENTRY          Y02621 63740002
         CLI   NELEXID,NELQLPEX   QUEUE MNGR LOC MODE ENTRY?   @G29AN2F 63746003
         BE    VHEQLPEX           YES, PROCESS THE ENTRY       @G29AN2F 63752003
VHENXTEX BCT   R4,VHELOOP1        CHECK NEXT ENTRY               Y02621 63760002
         B     VHEEXOUT           NO JOURNAL MERGE ENTRY FOUND   Y02621 63780002
         SPACE  2                                                       63800002
VHEJRNLX DS    0H    JOURNAL MERGE EXIT PROCESSING               Y02621 63820002
         CLI   NELEXLK,NELEXNOP   SHOULD ENTRY BE IGNORED?       Y02621 63840002
         BE    VHENXTEX           YES,DO NOT PROCESS ENTRY.    @G29AN2F 63860003
         CLI   NELEXLK,NELEXNAM   ENTRY HAVE 6 BYTE NAME?        Y02621 63880002
         BNE   VHEXTADD           THEN CONTAINS ADDR OF LOAD.    Y02621 63900002
         MVC   AOJRNLEX(6),NELEXEP  MOVE NAME INTO FIELD TO LOAD Y02621 63920002
         MVC   AOJRNLEX+6(2),BLANK2 BLANK TRAILING 2 BYTES.      Y02621 63940002
         LA    R6,AOJRNLEX        ADDRESS OF NAME PARAMETER      Y02621 63960002
         LOAD  EPLOC=(6)          LOAD JOURNAL MERGE ROUTINE.    Y02621 63980002
         ST    R0,AOJMRGEP        EP ADDRESS INTO IWA FIELD      Y02621 64000002
         EJECT                                                          64002002
*****************************************************************Y02668 64004002
*                                                               *Y02668 64006002
*   EXIT TO START PROCESSING TEXT                               *Y02668 64008002
*                                                               *Y02668 64010002
*****************************************************************Y02668 64012002
         SPACE 5                                                        64014002
         B     VHELSTMV           MOVE WHOLE EXIT LIST ENTRY     Y02621 64020002
VHEXTADD MVC   AOJMRGEP(4),NELEXEPA  MOVE ADDRESS TO IWA         Y02621 64040002
VHELSTMV MVC   AOJRNLEX(8),NELEXLK  MOVE EXIT LIST ENTRY TO IWA  Y02621 64060002
         B     VHENXTEX            PROCESS NEXT ENTRY,IF ANY     Y02621 64080002
         SPACE 1                                                        64100002
VHEQLPEX DS    0H                QUEUE MNGR LOCATE MODE EXIT   @G29AN2F 64101003
         CLI   NELEXLK,NELEXNOP  SHOULD ENTRY BE IGNORED?      @G29AN2F 64102003
         BE    VHENXTEX          YES, DO NOT PROCESS ENTRY     @G29AN2F 64103003
         CLI   NELEXLK,NELEXNAM  ENTRY HAVE 6 BYTE NAME?       @G29AN2F 64104003
         BNE   VHEQLADD          THEN CONTAINS ADDR OF LOAD    @G29AN2F 64105003
         MVC   AOQLOCEX(6),NELEXEP MOVE NAME TO IWA FIELD      @G29AN2F 64106003
         MVC   AOQLOCEX+6(2),BLANK2 BLANK TRAILING 2 BYTES     @G29AN2F 64107003
         LA    R6,AOQLOCEX       GET ADDR OF NAME OF EXIT      @G29AN2F 64108003
         LOAD  EPLOC=(6)         LOAD QUEUE MNGR LOC ROUTINE   @G29AN2F 64109003
         ST    R0,AOQLOCEP       EP ADDR INTO COMWA FIELD      @G29AN2F 64110003
         B     VHELOCMV          MOVE WHOLE EXIT LIST ENTRY    @G29AN2F 64111003
VHEQLADD MVC   AOQLOCEP(4),NELEXEPA MOVE ADDR TO COMWA         @G29AN2F 64112003
VHELOCMV MVC   AOQLOCEX(8),NELEXLK  MOVE EXIT LIST ENTRY TO IWA@G29AN2F 64113003
         B     VHENXTEX          PROCESS NEXT ENTRY, IF ANY    @G29AN2F 64114003
VHEEXOUT DS    0H       EXIT LIST PROCESSING FINISHED            Y02621 64120002
         DROP  R2                                                Y02621 64140002
         EJECT                                                          64160002
         L     RF,IEFVHEV          ADDR OF INTERP ROUTER         Y02668 64200002
         BR    RF                  EXIT TO GET 1ST TEXT STRING   Y02668 64400002
         EJECT                                                          64600002
*****************************************************************Y02668 64800002
*                                                               *Y02668 65000002
*  ROUTINE TO GET AND CLEAR CORE                                *Y02668 65200002
*                                                               *Y02668 65400002
*****************************************************************Y02668 65600002
         SPACE 2                                                 Y02668 65800002
VHEGAC   DS    0H                                                Y02668 66000002
         STM   R4,R7,12(RD)        SAVE REGS CLOBBERED BY MVCL   Y02668 66100002
         LR    R5,R0               PUT LENGTH IN ODD REG FOR MVCLY02668 66200002
         GETMAIN  R,LV=(0)         GET REQUESTED CORE            Y02668 66300002
         LR    R4,R1               SET UP TARGET OF MVCL AND     Y02668 66400002
*                                  PRESERVE REG1 FOR RETURN      Y02668 66500002
         SR    R7,R7               INDICATE PADDING CHAR OF 0    Y02668 66600002
*                                  FOR MVCL AND OBJECT COUNT OF 0Y02668 66700002
         SR    R6,R6               INDICATE NO MVCL OBJECT ADDR  Y02668 66800002
         MVCL  R4,R6               CLEAR REQUESTED CORE          Y02668 66900002
         LM    R4,R7,12(RD)        RESTORE REGS CLOBBERED        Y02668 67100002
*                                  BY MOVE CHAR LONG(MVCL)       Y02668 67300002
         BR    RA                                                Y02668 67600002
         EJECT                                                          67800002
*****************************************************************Y02668 68000002
*   DECLARED  STORAGE                                           *Y02668 68200002
*****************************************************************Y02668 68400002
MOVESTAE MVC   LEN0(LEN0,R5),NB9ESTAE    MOVE LIST FORM TO AREA  Y02653 68500002
ID       DC    X'11111111'         IDENTIFIER                    Y02668 68600002
BLANK2   DC    X'4040'             TWO BLANKS FOR PADDING        Y02621 68700002
TXTBUFLT DC    H'8192'             8K INTERNAL TEXT BUFFER       Y02668 68800002
TEXTID   DC    X'EEEEEEEE'         TEXT BUFFER IDENTIFIER        Y02668 68900002
SYS      DC    C'SYS'                                            Y02668 69000002
ZEROS    DC    X'F0F0F0'                                         Y02668 69200002
SCONREG1 DC    XL2'A000'           LOCAL WORK AREA BASE          Y02668 69400002
SCONREG2 DC    XL2'C000'           IWA BASE                      Y02668 69600002
IEFVHEV  DC    V(IEFVHE)           INTERPRETER ROUTER            Y02668 69800002
IEFVHNV  DC    V(IEFVHN)           INTERPRETER TERMINATION RTN   Y02668 70000002
IEFVHQV  DC    V(IEFVHQ)           SWA MANGER INTERFACE RTN             70200002
IEFNB9IR DC    V(IEFNB9IR)         ESTAE RECOVERY EXIT ROUTINE   Y02653 70240002
         SPACE 1                                                        70280002
NB9ESTAE ESTAE XCTL=NO,PURGE=NONE,ASYNCH=YES,RECORD=YES,MF=L            70320002
LENESTAE DC    A(*-NB9ESTAE)       LENGTH OF ESTAE LIST MACRO    Y02653 70360002
PATCH    DC    25F'0'                                                   70400002
         EJECT                                                          70600002
*****************************************************************Y02668 70800002
*                                                               *Y02668 71000002
*                        EQUATES                                *Y02668 71200002
*                                                               *Y02668 71400002
*****************************************************************Y02668 71600002
         SPACE 2                                                 Y02668 71800002
MSBUFLEN EQU   160        MSG BUFFER LENGTH FOR VGM              Y02668 72060002
LNGTHAWA EQU   ENDAWA-QLINKWA                                    Y02668 73200002
LDWA     EQU   ENDWA-DWA                                       @Z40MPTH 73250003
LNGJACT  EQU   JACT-JASW1                                        Y02668 73400002
LNGSIOT  EQU   SIOT-DWA                                          Y02668 73600002
LNGJFCB  EQU   JFCB-DWA                                          Y02668 73800002
LNGJFCBX EQU   JFCBX-DWA                                         Y02668 74000002
LNGORTAB EQU   EAORTABL-EWA       DISPLACEMENT OF ORIDE TABLE  @Z40MPTH 74050003
LNGTHACT EQU   ACT-EWA            DISPLACEMENT OF ACT IN EWA.  @Z40MPTH 74100003
LNGJFCBE EQU   JFCBEX-DWA         DISPLACEMENT OF JFCBE IN DWA.@Z40MPTH 74150003
WORDLEN  EQU   4                                                 Y02668 75000002
QMPALEN  EQU   32                                                Y02668 75200002
NONE     EQU   0                                                 Y02668 75400002
JESSJMR  EQU   56                  LENGTH OF JESS JMR            Y02668 75600002
TABLEN   EQU   176                                               Y02668 75800002
AOWBFLTH EQU   90                                                Y02668 76200002
DBLEWORD EQU   8                                                 Y02668 76400002
SIGNDIGT EQU   7                                                 Y02668 76600002
BYTE0    EQU   0                                                 Y02668 76800002
HEX00    EQU   0                                                 Y02668 77000002
NEXT     EQU   1                                                 Y02668 77200002
SIGN     EQU   X'F0'                                             Y02668 77400002
DATEDSPL EQU   3                                                 Y02668 77600002
DOT      EQU   C'.'                                              Y02668 77800002
T        EQU   C'T'                                              Y02668 78000002
R        EQU   C'R'                                              Y02668 78200002
A        EQU   C'A'                                              Y02668 78400002
BSIGN    EQU   X'0F'                                             Y02668 78600002
LEN0     EQU   0                                                 Y02653 78700002
LEN3     EQU   3                                                 Y02668 78800002
LEN4     EQU   4                                                 Y02668 79000002
LEN5     EQU   5                                                 Y02668 79200002
LEN6     EQU   6                                                 Y02668 79400002
LEN8     EQU   8                                                 Y02668 79600002
RECNO    EQU   X'80'               RECORD NUMBER               @Z40RPSM 79800003
SVALEN   EQU   3                   SWA VIRTUAL ADDR LENGTH              80000002
DISPL20  EQU   20                                                       80200002
DISPL24  EQU   24                                                       80300002
DISPL3   EQU   3                                                 Y02668 80400002
DISPL8   EQU   8                                                        80600002
DISPL16  EQU   16                                                       80800002
DISPL28  EQU   28                                              @Z40RPSM 80850003
         EJECT                                                          81000002
TRACE    DS    0H                                                       81200002
         BALR  15,0                SET BASE REG.                        81400002
         USING *,15                                                     81600002
****************************************************************YM08105 81700002
         B     TRNOP               DEACTIVATE TRACE             YM08105 81800002
*                                  ZAP THIS INSTR TO '47000000' YM08105 81900002
*                                  TO TRACE MODULE FLOW.        YM08105 82000002
****************************************************************YM08105 82100002
         STM   11,1,TRSAVE         SAVE CALLER'S REGS.                  82600002
*  REGISTER 12 CONTAINS ADDRESS OF WORK AREA.                    Y02668 82800002
         L     1,BUFADDR           LOAD CONTENTS.                       83200002
         LTR   1,1                 TRACE BUFFER OBTAINED ?              83400002
         BNZ   TR5                 BRANCH YES.                          83600002
* TRACE BUFFER NOT YET OBTAINED.                                        83800002
         LR    11,15               SAVE BASE REGISTER.                  84000002
         LH    0,BUFLTH            LOAD BUF LENTH.                      84200002
         GETMAIN  R,LV=(0)                                              84400002
         LR    15,11               RESTORE BASE REGISTER.               84600002
         ST    1,BUFADDR           SAVE BUFFER ADDRESS.                 84800002
         ST    1,NEXTPTR           INIT NEXT ENTRY PTR.                 85000002
         AH    1,BUFLTH            ADD LENGTH TO                        85200002
         ST    1,BUFEND            COMPUTE BUFFER END ADDR.             85400002
* TRACE BUFFER EXISTS AND PTRS ARE INITIALIZED.                         85600002
TR5      DS    0H                                                       85800002
         CLC   NEXTPTR(4),BUFEND   IS BUFFER FILLED ?                   86000002
         BNE   TR10                BRANCH NO.                           86200002
* BUFFER HAS BEEN FILLED. START OVER.                                   86400002
         MVC   NEXTPTR(4),BUFADDR  SET NEXT ENTRY TO START OF BUF.      86600002
TR10     DS    0H                                                       86800002
         L     1,NEXTPTR           LOAD PTR TO NEXT ENTRY.              87000002
         L     14,TRSAVE+12        LOAD ADDR OF CALLER.                 87200002
         MVC   0(4,1),4(14)        MOD ID IS 2ND WD AFTER CALLING      *87400002
                                   ADDR. MOVE ID TO BUF.                87600002
         LA    1,4(1)              SET ENTRY PTR TO NEXT LOC AND        87800002
         ST    1,NEXTPTR           SAVE.                                88000002
         LM    11,1,TRSAVE         RESTORE REGS.                        88200002
TRNOP    DS    0H                                               YM08105 88300002
         LA    14,8(14)            PT LINK REG BEYOND PARM LIST.        88400002
         BR    14                  RETURN TO NEXT EXECUTABLE INSTR.     88600002
         SPACE 2                                                        88800002
         DS    0H                                                       89000002
BUFLTH   DC    AL2(2048)           BUFFER LENGTH.                       89200002
         EJECT                                                          90000002
         END   IEFNB903                                                 90200002
./  ADD  SSI=20720367,NAME=IEFUJV
* DUMMY JCL VALIDATION EXIT ROUTINE                                     10000018
IEFUJV   CSECT                                                          20000018
         SR    15,15               ZERO OUT R/C REGISTER                30000018
         BR    14                  RETURN                               40000018
         MODID BR=NO                                                    40050000
         END                                                            50000018
./  ADD  SSI=81500179,NAME=IEFVDA
*                                                                       00050003
**********************************************************************  02000002
*                                                                       02010002
*MODULE NAME= IEFVDA                                                    02040002
*                                                                       02050002
*DESCRIPTIVE NAME= DD CARD PROCESSOR                                    02090002
*                                                                       02100002
*COPYRIGHT= N/A                                                         02140002
*                                                                       02150002
*STATUS= VS2 REL 037 PTF                                       @ZA32059 02160003
*                                                                       02210002
*FUNCTION= GENERAL DESCRIPTION                                          02260002
*          IEFVDA IS THE MAIN PROCESSING MODULE FOR DD STATEMENTS.      02270002
*          IT 1. INITIALIZES AND CREATES TABLES AND CONTROL BLOCKS.     02280002
*             2. CHECKS VALIDITY OF DD CARD KEYWORDS AND IN SOME        02282002
*             CASES THEIR VALUES.                                       02284002
*             3. SETS JOB-FAIL BIT FOR INVALID KEYWORDS.                02286002
*                                                                       02362002
*          AM/0 SUPPORT                                                 02370002
*                                                                       02372002
*          *JOBCAT,STEPCAT ASSOCIATION BITS(SIOTJSCT,SIOTCATL)          02380002
*          WHEN A CARD IS IDENTIFIED AS A JOBCAT STEPCAT OR             02382002
*          A CONTINUATION OF EITHER,THE SIOTJSCT BIT IS TURNED          02384002
*          ON TO SIGNAL THE RELATIONSHIP.THE SIOTCATL BIT IS            02386002
*          ALSO TURNED ON TO INDICATE THAT THE SIOT DEFINES             02386402
*          A CATALOG DATA SET.                                          02386802
*          (THE SIOTCATL BIT WILL BE TURNED ON BY DYNAMIC ALLOC-        02387202
*          ATION WHEN IT CREATES A CATALOG DD DEFINITION,THE            02387602
*          SIOTJSCT BIT WILL NOT BE TURNED ON BY THEM.)                 02387702
*                                                                       02387802
*          * UNIQUE DD NAME FOR JOBCAT,STEPCAT CONCATENATIONS.          02388002
*          A UNIQUE DD NAME IS GENERATED FOR THOSE DATA SETS            02388402
*          CONCATENATED TO JOBCAT AND STEPCAT DD CARDS.DURING           02388802
*          THE CLEANUP OPERATION,A TEST IS MADE OF THE SIOTCATL AND     02389202
*          SIOTJSCT BITS.IF BOTH ARE ON AND THE DDNAME IS BLANK         02389602
*          IN THE SIOT,THE UNIQUE NAME WILL BE GENERATED AND            02389702
*          PLACED IN THE SIOT DDNAME FIELD.                             02391102
*          THE FORMAT OF THE UNIQUE NAME IS:                            02393102
*                       HEX ' 7C0000DD40404040 '                        02393502
*          DD=DD NUMBER(UNIQUE TO EACH STEP)                            02394002
*          LENGTH OF NAME IS 8 BYTES.                                   02394402
*                                                                       02396402
*          * QUALIFIED DSNAMES SIGNALED BY BIT(SIOTQDSN)                02400002
*          IF A PERIOD IS ENCOUNTERED IN A DSNAME OTHER THAN            02401402
*          A LITERAL,OR A TEMPORARY DSNAME IS CREATED,THE SIOTQDSN      02403402
*          IN THE SIOT WILL BE TURNED ON.                               02403502
*          IF A REFERBACK IS MADE TO A QUALIFIED DSNAME,THE SIOTQDSN    02403802
*          BIT WILL BE TURNED ON IN THE SIOT BEING CREATED.             02403902
*          THE REFERBACK APPLIES NOT ONLY TO DSNAME REFERBACKS,         02404002
*          BUT ALSO TO DCB DSNAME REFERBACKS.                           02404102
*                                                                       02404902
*          *MERGE OF SCTPCAT AND SCTPCATR FIELDS                        02406002
*          THE SPLIT DEFINITION OF THE PRIVATE CATALOG SIOT             02406402
*          POSITION IN SWA WILL BE MERGED INTO ONE FIELD NAMED          02406802
*          SCTPCAT.                                                     02407202
*OPERATION= IT RECEIVES THE INTERNAL TEXT AND USES IT TO CREATE THE     02407302
*          CONTROL BLOCKS NECESSARY TO ALLOCATE THE DATA SETS           02407402
*          DESCRIBED BY THE DD CARDS.                                   02407502
*          THE INTERNAL TEXT IS THEN PROCESSED BY THE APPROPRIATE       02407902
*          KEYWORD ROUTINE. EXTERNAL ROUTINES IEFVGT AND IEFVGK         02409902
*          PROCESS THE PARAMETER DESCRIPTOR TABLE (PDT) AND THE         02410302
*          KEYWORD BRANCH TABLE, RESPECTIVELY.                          02410702
*          IF THE KEYWORD IS INVALID, THE PROCESSING ROUTINE GOES       02411102
*          TO THE CLEANUP ROUTINE WHICH SETS THE JOB-FAIL BIT IN        02411302
*          THE JCT AND PLACES THE APPROPRIATE ERROR MESSAGE IN          02411702
*          MSGSEC.                                                      02412102
*NOTES                                                                  02412302
*    CHARACTER-CODE DEPENDENCIES= EBCDIC                                02412502
*    DEPENDENCIES=  NONE                                                02412702
*    RESTRICTIONS=   NONE                                               02412902
*    REGISTER-CONVENTIONS=   AFTER INITIALIZATION:                      02413102
*                            R0-R4 WORK REGISTERS FOR TEXT.             02413302
*                            R5- PTR TO REMOTE PARAM LIST OF Q-MGR      02413602
*                            R6- VCON TO IEFVHQ,Q-MGR ROUTINE.          02414002
*                            R7- SECOND BASE REGISTER.                  02414402
*                            R8- VCON TO IEFVGT,TEST AND STORE RTNE.    02414802
*                            R9- VCON TO IEFVGK,GET KEY ROUTINE.        02415202
*                            RA- LOCAL WORKAREA POINTER,IEFVMDWA        02415602
*                            RB- BASE REGISTER FOR IEFVDA.              02416002
*                            RC- INTERPRETER WORKAREA PTR,IEFVMIWA.     02416402
*                            RD- SAVEAREA POINTER.                      02416802
*                            RE-RF- WORK REGISTERS.                     02417202
*    PATCH-LABEL= N/A                                                   02417602
*MODULE TYPE=  PROCEDURE                                                02418002
*    PROCESSOR= ASSEMBLER                                               02418402
*    MODULE SIZE= N/A                                                   02418802
*    ATTRIBUTES=                                                        02419202
*                                                                       02419602
*ENTRY POINT=  IEFVDA                                                   02420002
*    PURPOSE=  MAIN ENTRY                                               02420402
*    LINKAGE=  NONE                                                     02420802
*    INPUT DATA=  INTERNAL TEXT,IWA INFORMATION                         02421202
*    REGISTERS SAVED=  NONE                                             02421602
*    REGISTER CONTENTS DURING PROCESSING=                               02422002
*                            R0-R4 WORK REGISTERS FOR TEXT.             02422102
*                            R5- PTR TO REMOTE PARAM LIST OF Q-MGR      02422202
*                            R6- VCON TO IEFVHQ,Q-MGR ROUTINE.          02422302
*                            R7- SECOND BASE REGISTER.                  02422602
*                            R8- VCON TO IEFVGT,TEST AND STORE RTNE.    02423002
*                            R9- VCON TO IEFVGK,GET KEY ROUTINE.        02423402
*                            RA- LOCAL WORKAREA POINTER,IEFVMDWA        02423502
*                            RB- BASE REGISTER FOR IEFVDA.              02423602
*                            RC- INTERPRETER WORKAREA PTR,IEFVMIWA.     02423702
*                            RD- SAVEAREA POINTER.                      02423802
*                            RE-RF- WORK REGISTERS.                     02424002
*    REGISTERS RESTORED=  NONE                                          02424402
*                                                                       02424602
*EXIT - NORMAL=  IEFVHE                                                 02424802
*    CONDITIONS=  WHEN PROCESSING FOR DD CARD COMPLETED.                02425002
*    OUTPUT DATA=  CONTROL BLOCKS FOR ALLOCATION.                       02425202
*    RETURN CODES=  NONE                                                02425402
*                                                                       02425602
*EXIT - ERROR=  IEFVHE                                                  02425802
*   CONDITIONS=  AFTER AN ERROR HAS BEEN DETECTED.                      02425902
*                MODULE BRANCHES TO IEFVGM TO ISSUE AN ERROR            02426002
*                MESSAGE,AND THE JOB FAILED BIT IS TURNED ON IN THE     02426802
*                JCT IN THE IWA.                                        02427202
*   OUTPUT DATA=  AN ERROR MESSAGE AFTER THE CARD IMAGE IN SYSOUT.      02427602
*   RETURN CODES=  NONE                                                 02428002
*                                                                       02428402
*EXTERNAL REFERENCES=                                                   02428502
*   ROUTINES=  IEFVHQ,IEFVGS,IEFVGT,IEFVGK,IEFVGI,IEFVGM                02428802
*              IEFVDBSD                                                 02429202
*   DATA AREAS=  IWA,LWA,NEL                                            02429602
*   CONTROL BLOCKS=  JCT - U,M                                          02430002
*                    SCT - U,M                                          02430402
*                    SIOT - C,U,M                                       02430802
*                    JFCB - C,U,M                                       02431202
*                    QMPA - U,M                                         02431602
*                    DSNT - C,U,M                                       02432402
*                    NEL - U                                            02433202
*                    TIOT - U                                           02433602
*                    UCB - U                                            02434002
*                    ACT - C,U,M                                        02434402
*                    SSWA - C,U,M                              @G29AN2E 02434503
*                    CVT  - U                                  @G24LPSJ 02434603
*                    SUBIT - U                                 @G24LPSJ 02434703
*       KEY:  C=CREATE,U=USED,M=MODIFIED,D=DELETE                       02434802
*   TABLES=  TABLE OF VALID KEYS.                                       02435202
*   MACROS= GETMAIN,FREEMAIN                                     Y02668 02435602
*        ENQUEUE RESOURCES=  NONE                                       02436403
*   CHANGE LEVEL= Z40MPTH, ZM40101,ZD03010,ZA03532,ZM40103,ZM40457,     02436803
*                 Z40RPSM,ZA06978,ZA07483,ZA07503,ZA05806,ZA08159,      02437003
*                 ZA08690,ZA08164,ZA08756,ZA08746,ZA10112,     @ZA10112 02437203
*                 ZA10487,ZA10649,G29AN2E,G24LPSJ,G32HPPJ      @G32HPPJ 02437403
*                 ZA14270,ZA14276,ZA15012,ZA15344,ZM44657               02437603
*                 ZA15388,ZA16387,ZA1641Y,ZA16056,ZA20550,     @ZA20550 02437803
*                 ZA20610,ZA24607,ZA27071,ZA27750,ZA28079,     @ZA28079 02438003
*                 ZA31245,ZA32059                              @ZA32059 02438203
*                                                                       02438803
*          IEF606I- MISPLACED DD STATEMENT                     @ZA14276 02439103
*          IEF617I- NUMBER NAMES ON 1ST DD STMT AFTER EXEC STMT         02439402
*          IEF624I- INCORRECT USE OF PERIOD                             02445402
*          IEF627I- INCORRECT USE OF AMPERSAND                 @ZA14270 02445603
*          IEF630I- UNIDENTIFIED KEYWORD                                02445802
*          IEF631I- NUMBER OF DDNAMES EXCEEDS MAXIMUM                   02445902
*          IEF632I- FORMAT ERROR                                        02447302
*          IEF636I- MISPLACED JOBLIB STATEMENT                          02449302
*          IEF640I- EXCESSIVE NUMBER OF POSITIONAL PARAMETERS           02449702
*          IEF642I- EXCESSIVE PARAMETER LENGTH                          02450102
*          IEF643I- UNIDENTIFIED POSITIONAL PARAMETER                   02450902
*          IEF645I- INVALID REFERBACK                                   02451302
*          IEF646I- REQUIRED POSITIONAL PARAMETER MISSING               02451702
*          IEF647I- NON ALPHABETIC 1ST CHARACTER OF NAME                02452102
*          IEF648I- INVALID DISP FIELD                                  02452502
*          IEF649I- EXCESSIVE NUMBER OF DD STATEMENTS                   02452602
*          IEF654I- MULTIPLE DDNAMES REFER TO ONE DD STMT               02452702
*          IEF655I- DSNAME INVALID WHEN SYSOUT SPECIFIED                02452802
*          IEF659I- MISPLACED SYSCHK DD STATEMENT                       02452902
*          IEF757I- ILLEGAL DATASET NAME ON JCL STATEMENT      @ZA16056 02453103
*          SOME OF THE ABOVE MESSAGES ARE FOLLOWED BY SECONDARY         02453302
*          MESSAGES THAT KEY OFF THE KEYWORD'S 'KEY'.                   02453702
         EJECT                                                          02455402
         IEFQMNGR                                                       02455802
         EJECT                                                          02456002
DDJCT    DSECT                                                          02457202
         IEFAJCTB                                                       02458602
         EJECT                                                          02460002
DDSCT    DSECT                                                          02462002
         IEFASCTB                                                       02465002
         EJECT                                                          02468002
DDSIOT   DSECT                                                          02471002
         IEFASIOT                                                       02474002
         EJECT                                                          02477002
DDJFCB   DSECT                                                          02480000
         IEFJFCBN  LIST=YES                                     YM00362 02500002
*                                                                 M0491 02506018
         EJECT                                                          02506503
         IEFJFCBE                                              @Z40MPTH 02507003
         EJECT                                                          02507503
DDDSNT   DSECT                                                   Y02668 02508002
         IEFDSNT                                                 Y02668 02510002
         IEFVKEYS                                                       02512018
         EJECT                                                          02520000
         IEFCOMWA                                                       02540002
         IEFVMIWA                                                       02540302
*********************************************************************** 02540702
*                                                                       02541402
*                                                                       02542102
*  THE FOLLOWING DSECT MAPS A WORKAREA USED BY THE SPLIT PROCESSOR      02542802
*                                                                       02543502
*                                                                       02544202
*********************************************************************** 02544902
DSPLIT   DSECT                                                          02545602
         DS    0D                                                       02546302
SPLITBLK EQU   *                                                 Y02661 02547002
SPLITBLN DS    CL3                      AVG BLOCK LENGTH REQUEST Y02661 02547702
SPLITPQY DS    CL3                      PRIMARY QUANITY OF SPACE Y02661 02548402
SPLITRSV DS    CL1                      RESERVED                 Y02661 02549102
SPLITSQY DS    CL3                      SECONDARY QUANITY SPACE  Y02661 02549802
SPLITBYT DS    CL1                      INDICATOR BYTE           Y02661 02550502
SPLITCYL EQU   X'C0'                    CYLINDER REQUEST         Y02661 02551202
SPLITAVB EQU   X'40'                    AVERAGE BLOCK LENGTH REQ.Y02661 02551902
SPLITMTR DS    CL3                      MODEL TTR                Y02661 02552602
SPLITBY2 DS    CL1                      INDICATOR BYTE 2         Y02661 02553302
SPLITMDL EQU   X'C0'                    MODEL SPLIT DD           Y02661 02554002
SPLITNML EQU   X'40'                    SPLIT SUB-DD             Y02661 02554702
CLEARBY2 EQU   X'00'                    CLEAR BYTE               Y02661 02555402
SPLITTRK DS    XL1                      NO. TRKS(OR %)/CYL.      Y02661 02556102
SPLITWKA DS    CL4                      WORK AREA                Y02661 02556802
SPLITLST EQU   *                                                 Y02661 02557502
INEMJFCX EQU   SPLITBLK                 START JFCBX AREA         Y02661 02558202
         EJECT                                                          02560000
         IEFVMDWA                                                       02580000
VDANEL   DSECT                                                   A26488 02594120
         IEFNEL SUBCOM=I                                         Y02668 02594202
         EJECT                                                   A26488 02594420
         EJECT                                                   A26488 02608820
         IEFTXTFT                                                       02617602
         EJECT                                                   A26488 02618420
         IEFZB505                                              @G29AN2E 02618503
         EJECT                                                          02618603
         IEFJSSWA                                              @G29AN2E 02618703
         EJECT                                                          02618803
         CVT   DSECT=YES               CVT MAP                 @G24LPSJ 02618903
         EJECT                                                 @G24LPSJ 02619003
         IHASUBIT                      SUBIT MAP               @G24LPSJ 02619103
         EJECT                                                 @G24LPSJ 02619203
*             ****************************************************      02620000
*             ****************************************************      02640000
*             **                                                **      02660000
*             **             DD ROUTINE DEFINITIONS             **      02680000
*             **                                                **      02700000
*             ****************************************************      02720000
*             ****************************************************      02740000
         SPACE 3                                                        02760000
         SPACE 2                                                        02780000
*                       OPERATION DEFINITIONS.                          02800000
*                                                                       02820000
OR1      EQU   X'00'              OR ONE BYTE.                          02840000
CVB1     EQU   X'01'              CONVERT ONE BYTE.                     02860000
CVB2     EQU   X'02'              CONVERT TWO BYTES.                    02880000
CVB3     EQU   X'03'              CONVERT THREE BYTES.                  02900000
AND1     EQU   X'04'              AND ONE BYTE.                         02920000
MVCN     EQU   X'05'              MOVE CHARACTERS.                      02940000
AMVCN    EQU   X'06'              FIRST CHARACTER ALPHA & MOVE.         02960000
AMVCN1   EQU   X'07'              FIRST CHAR ALPHA NUMERIC & MOVE   060 02980000
AMVCN2  EQU   X'08'               ALL CHARACTER ALPHA/NUMERIC &         02990003
*                                 NATIONAL CHECK & MVC         @ZA20550 02993003
*                                                                       03000000
*                       TABLE DEFINITIONS.                              03020000
*                                                                       03040000
INAM     EQU   X'00'              DD ROUTINE WORK AREA.                 03060000
INDM     EQU   X'04'              SIOT TABLE.                           03120000
INFM     EQU   X'05'              JFCB TABLE.                           03140000
INEM     EQU   X'06'                    JFCBX TABLE              Y02661 03190002
INGM     EQU   X'0C'              JFCBE DEFINITION...          @Z40MPTH 03240003
INIM     EQU   X'0F'              INTERPRETOR WORK AREA.                03245003
*                                                                  AADA 03250003
INIMIWA  EQU   COMWA               START OF WORK AREA.           Y02668 03255003
INGMJFCE EQU   JFCBE         START OF JFCBE... FOR PDT DEFIN.  @Z40MPTH 03260003
*                                                                  AADA 03265003
*                                                                       03270003
*                       MISCELLANEOUS DEFINITIONS.                      03275003
CVTADDR  EQU   16                      CVT ADDRESS             @G24LPSJ 03280003
*                                                              @G24LPSJ 03285003
*                                                                       03300000
*                       NUMBERS USED                                    03320000
DD0      EQU   0                                                        03340000
DD1      EQU   1                                                        03360000
DD2      EQU   2                                                        03380000
DD3      EQU   3                                                        03400000
DD4      EQU   4                                                        03420000
DD5      EQU   5                                                        03440000
DD6      EQU   6                                                        03460000
DD7      EQU   7                                                        03480000
DD8      EQU   8                                                        03500000
DD10     EQU   10                                                       03530019
DD11     EQU   11                                                       03540000
DD12     EQU   12                                                       03560000
DD14     EQU   14                                                       03580000
DD15     EQU   15                                                       03600000
DD16     EQU   16                                                       03620000
DD20     EQU   20                                                       03660000
DD23     EQU   23                                                       03680000
DD24     EQU   24                                                       03700000
DD29     EQU   29                                                       03740000
DD32     EQU   32                                              @Z40MPTH 03750003
DD43     EQU   43                                                       03760000
DD44     EQU   44                                                       03780000
DD51     EQU   51                                                       03800000
DD62     EQU   62                                                A26488 03810020
DD128    EQU   128                                                      03820000
DD129    EQU   129                                                      03840000
DD130    EQU   130                                                      03860000
DD131    EQU   131                                                      03880000
DD168    EQU   168                                                      03940000
DD255    EQU   255                                                      03980000
DD366    EQU   366                                                21615 04010018
DD365    EQU   365                                                      04015001
DISPLID  EQU   7        DISPLACEMENT OF BLOCK ID -FIRST BLOCK    Y02621 04016002
DISPL2ID EQU   15       DISPLACEMENT OF BLOCK ID -SECOND BLOCK   Y02621 04017002
*                                                                       04018002
*                            REMOTE LIST CONTROL BLOCK ID'S      Y02621 04019002
JFCBSID  EQU   X'1C'         ID FOR WRITING JFCB TO SWA          Y02621 04020002
JFCBXID  EQU   X'1D'         ID FOR WRITING JFCBX TO SWA         Y02621 04030002
JFCBEID  EQU   X'29'    ID FOR WRITING JFCBE TO SWA...         @Z40MPTH 04032003
NULLID   EQU   X'00'              NULL ID FOR SWA MGR.           Y02621 04035002
QMDFLT   EQU   X'11'    DEFAULT-WRITE 1,ASSIGN 1 RECORD...     @YA00900 04037003
*                                                                       04040002
*                            FOR CONDITION TESTS                        04050002
HIGH     EQU   DD2                                                      04060000
LOW      EQU   DD4                                                      04080000
EQUAL    EQU   DD8                                                      04100000
ZERO     EQU   DD8                                                      04120000
NOT      EQU   DD15                                                     04140000
HIOREQ   EQU   DD10                                                     04150019
*                            CHARACTERS USED                            04160000
DDBLANK  EQU   C' '                                                     04180000
DDPERIOD EQU   C'.'                                                     04200000
DDPLUS   EQU   C'+'                                                     04220000
DDAMP    EQU   C'&&'                                                    04240000
DDASTER  EQU   C'*'                                                     04260000
DDMINUS  EQU   C'-'                                                     04280000
DDCK     EQU   C'K'                                                     04300000
DDCL     EQU   C'L'                                                     04320000
DDCR     EQU   C'R'                                                     04340000
DDN0     EQU   C'0'                                                     04380000
DDCA     EQU   C'A'                                                3565 04390016
DDN9     EQU   C'9'                                                     04400000
*                            FOR PPT TABLE                              04420000
HEX      EQU   DD16                                                     04440000
*                                                                       04460000
*                       IEFVMDWA                                        04680000
LDWA     EQU   DDWA8-DWA          LENGTH OF DA WORK AREA                04860000
*                                                                       04880000
*                       ERROR MESSAGE NUMBERS.                          04900000
*                                                                       04920000
ERMES27  EQU   X'1B'     INCORRECT USE OF AMPERSAND            @ZA14270 04930003
ERMES36  EQU   X'24'                                                    04940001
ERMES17  EQU   X'11'                                                    04960001
ERMES43  EQU   X'2B'                                                    04980001
ERMES46  EQU   X'2E'                                                    05020001
ERMES42  EQU   X'2A'                                                    05040001
ERMES40  EQU   X'28'                                                    05120001
ERMES48  EQU   X'30'                                                    05240001
ERMES31  EQU   X'1F'                                                    05360001
ERMES06  EQU   X'06'                                                    05380001
ERMES49  EQU   X'31'                                                    05400001
ERMES54  EQU   X'36'     MULTIPLE DDNAMES REFER TO ONE DD               05460001
ERMES55  EQU   X'37'     DSNAME INVALID WHEN SYSOUT SPECIFIED           05480001
ERMES24  EQU   X'18'    INCORRECT USE OF PERIOD                    3565 05485001
ERMES47  EQU   X'2F'    NON-ALPHA FIRST CHARACTER OF NAME          3565 05495001
ERMES45  EQU   X'2D'         INVALID REFERBACK TO DUMMY DS        16670 05497001
ERMES30  EQU   X'1E'               INVALID KEYWORD                19874 05498001
ERMES110 EQU   X'6E'               ON THE DD STATEMENT           A40259 05499001
ERMES69  EQU   X'45'    INVALID REFER FORWARD TO DYNAM DS         20029 05499501
ERMES19  EQU   X'13'         NO IEFDATA CARD IN RDR PROC.        A30585 05499701
ERMES32  EQU   X'20'    FORMAT ERROR                              21009 05499801
ERMES133 EQU   X'47'              MISPLACED JOBCAT ERROR MSSG    Y01113 05509801
ERMES134 EQU   X'48'              DUPLICATE STEPCAT IN STEP MSSG Y01113 05511801
ERMES135 EQU   X'2C'              INVALID NUMERICS               Y02668 05512002
ERMES67  EQU   X'43'              ILLEGAL DATASET NAME         @ZA16056 05512103
*                                 ON JCL STATEMENT - IEF757I   @ZA16056 05512203
WRNMSG01 EQU   X'42'              FREE VALUE INVALID             Y02668 05512703
WRNMSG02 EQU   X'38'              INVALID COPIES VALUE           Y02668 05512802
WRNMSG06 EQU   X'4A'              HOLD VALUE INVALID             Y02668 05513002
*                                                                       05513301
*                       KEY WORD DEFINITIONS.                           05520000
*                                                                       05540000
JJCT2    EQU   X'80'              BIT FOR JOBLIB.                       05580000
*                                                                       05600000
JDICTI1  EQU   X'10'              BIT FOR DD VERB                       05620000
JDICTI2  EQU   X'08'              BIT FOR DCB DSNAME                    05640000
JDICTI3  EQU   X'04'              BIT FOR DDNAME SWITCH                 05660000
JDICTI5  EQU   X'01'              BIT FOR ABSTR.                        05680000
*                                                                       05700000
DDN      EQU   X'01'         MAXIMUM NUMBER OF DD PARAMETERS.    Y02028 05720002
DDS      EQU   X'00'              SUBLIST DD KEY.                       05740000
JDDT1    EQU   X'08'              MAX LENGTH OF DD LABEL.               05760000
JDDT2    EQU   X'01'              BIT FOR * IN SIOT AT SCTSBYT3.        05780000
JDDT4    EQU   X'04'              BIT FOR * IN SIOT AT SCTSDISP.        05820000
JDDT5    EQU   X'20'               BIT FOR * IN JFCB AT JFCBTSDM   AACA 05830017
JDDT6    EQU   X'40'               BIT FOR * IN JFCB AT JFCBIND2.Y02668 05850002
*                                                                       05880000
TRTCHN   EQU   X'01'              NUMBER TRTCH KEY PARAMETERS.          05900000
TRTCHS   EQU   X'00'              SUBLIST TRTCH KEY.                    05920000
*                                                                       06040000
STACKN   EQU   X'01'              NUMBER STACK KEY PARAMETERS.          06060000
STACKS   EQU   X'00'              SUBLIST STACK KEY.                    06080000
DDMS1    EQU   X'F0'                                                    06130017
*                                                                       06140000
SOWAN    EQU   X'01'              NUMBER SOWA KEY PARAMETERS.           06160000
SOWAS    EQU   X'00'              SUBLIST SOWA KEY.                     06180000
JSOWA1   EQU   32767              MAX VALUE SOWA IN JFCB AT JFCSOWA.    06200000
*                                                                       06220000
RKPN     EQU   X'01'              NUMBER RKP KEY PARAMETERS.            06240000
RKPS     EQU   X'00'              SUBLIST RKP KEY.                      06260000
JRKP1    EQU   65535              MAX VALUE RKP IN JFCB AT JFCRKP.      06280000
*                                                                       06300000
IPLTXIDN EQU   X'01'              NUMBER OF IPLTXID KEY PARAMS.  Y01948 06302001
IPLTXIDS EQU   X'00'               SUBLIST IPLTXID KEYWORD.      Y01948 06304001
JIPLTXID EQU   X'07'              MAX NAME LENGTH FOR IPLTXID KEYY01948 06306001
FUNCN    EQU   X'01'               NUMBER FUNC KEY PARAMETERS     21088 06310001
FUNCS    EQU   X'00'              SUBLIST FUNC KEY                21088 06312001
JFUNC1   EQU   X'80'              BIT FOR FUNC=I IN JFCB, JFCBFUNC21088 06314001
JFUNC2   EQU   X'40'              BIT FOR FUNC=R IN JFCB, JFCBFUNC21088 06316001
JFUNC3   EQU   X'20'              BIT FOR FUNC=P IN JFCB, JFCBFUNC21088 06318001
JFUNC4   EQU   X'10'              BIT FOR FUNC=W IN JFCB, JFCBFUNC21088 06318401
JFUNC5   EQU   X'12'              FUNC=WT IN JFCB AT JFCBFUNC     21088 06318801
JFUNC6   EQU   X'16'              FUNC=WXT IN JFCB AT JFCBFUNC    21088 06319201
JFUNC7   EQU   X'60'              FUNC=RP IN JFCB AT JFCBFUNC     21088 06319601
JFUNC8   EQU   X'68'              FUNC=RPD IN JFCB AT JFCBFUNC    21088 06319701
JFUNC9   EQU   X'50'              FUNC=RW IN JFCB AT JFCBFUNC     21088 06319801
JFUNC10  EQU   X'52'              FUNC=RWT IN JFCB AT JFCBFUNC    21088 06319901
JFUNC11  EQU   X'56'              FUNC=RWXT IN JFCB AT JFCBFUNC   21088 06326601
JFUNC12  EQU   X'30'              FUNC=PW IN JFCB AT JFCBFUNC     21088 06328601
JFUNC13  EQU   X'34'              FUNC=PWX IN JFCB AT JFCBFUNC    21088 06330601
JFUNC14  EQU   X'36'              FUNC=PWXT IN JFCB AT JFCBFUNC   21088 06332601
JFUNC15  EQU   X'70'              FUNC=RPW IN JFCB AT JFCBFUNC    21088 06333001
JFUNC16  EQU   X'74'              FUNC=RPWX IN JFCB AT JFCBFUNC   21088 06333101
JFUNC17  EQU   X'76'              FUNC=RPWXT IN JFCB AT JFCBFUNC  21088 06333201
JFUNC18  EQU   X'78'              FUNC=RPWD IN JFCB AT JFCBFUNC   21088 06339901
JFUNC19  EQU   X'14'              FUNC=WX IN JFCB AT JFCBFUNC     21088 06340001
JFUNC20  EQU   X'54'              FUNC=RWX IN JFCB AT JFCBFUNC    21088 06342001
*                                                                       06344001
RECFMN   EQU   X'01'              NUMBER RECFM KEY PARAMETERS.          06346601
RECFMS   EQU   X'00'              SUBLIST RECFM KEY.                    06353301
JRECFM1  EQU   X'80'              BIT FOR RECFM=F IN JFCB AT JFCRECFM.  06360000
JRECFM2  EQU   X'40'              BIT FOR RECFM=V IN JFCB AT JFCRECFM.  06380000
JRECFM3  EQU   X'C0'              BITS FOR RECFM=U IN JFCB AT JFCRECFM. 06400000
JRECFM4  EQU   X'20'              BIT FOR RECFM=T IN JFCB AT JFCRECFM.  06420000
JRECFM5  EQU   X'10'              BIT FOR RECFM=B IN JFCB AT JFCRECFM.  06440000
JRECFM6  EQU   X'08'              BIT FOR RECFM=S IN JFCB AT JFCRECFM.  06460000
JRECFM7  EQU   X'04'              BIT FOR RECFM=A IN JFCB AT JFCRECFM.  06480000
JRECFM9  EQU   X'02'              BIT FOR RECFM=M IN JFCB AT JFCRECFM.  06500003
JRECFMB  EQU   X'01'              BIT FOR RECFM=K IN JFCB AT JFCRECFM.  06560000
JRECFMC  EQU   X'20'              BIT FOR RECFM=D AT JFCRECFM     19200 06570019
*                                                                       06580000
PRTSPN   EQU   X'01'              NUMBER PRTSP KEY PARAMETERS.          06600000
PRTSPS   EQU   X'00'              SUBLIST PRTSP KEY.                    06620000
*                                                                       06720000
OPTCDN   EQU   X'01'              NUMBER OPTCD KEY PARAMETERS.          06740000
OPTCDS   EQU   X'00'              SUBLIST OPTCD KEY.                    06760000
JOPTCD1  EQU   X'80'              BIT FOR OPTCD=W IN JFCB AT JFCOPTCD.  06780000
JOPTCD2  EQU   X'20'              BIT FOR OPTCD=P IN JFCB AT JFCOPTCD.  06800000
JOPTCD3  EQU   X'20'              BIT FOR OPTCD=M IN JFCB AT JFCOPTCD.  06820000
JOPTCD4  EQU   X'20'              BIT FOR OPTCD=E IN JFCB AT JFCOPTCD.  06840000
JOPTCD5  EQU   X'10'              BIT FOR OPTCD=I IN JFCB AT JFCOPTCD.  06860000
JOPTCD6  EQU   X'10'              BIT FOR OPTCD=F IN JFCB AT JFCOPTCD.  06880000
JOPTCD7  EQU   X'20'              BIT FOR OPTCD=C AT JFCDPTCD   PTM111  06900000
JOPTCD8  EQU   X'08'              BIT FOR OPTCD=A IN JFCB AT JFCOPTCD.  06920000
JOPTCD9  EQU   X'02'              BIT FOR OPTCD=L IN JFCB AT JFCOPTCD.  06940000
JOPTCDA  EQU   X'01'              BIT FOR OPTCD=R IN JFCB AT JFCOPTCD.  06960000
JOPTCDB  EQU   X'08'                                                    06980000
JOPTCDC  EQU   X'40'                                                    07000000
JPTCDD   EQU   X'04'               BIT FOR OPTCD=Z IN JFCB AT JFCOPTD.  07006017
JPTCDE   EQU   X'02'               BIT FOR OPTCD=T IN JFCB AT JFCOPTD   07012017
JPTCDH   EQU   X'08'              BIT FOR OPTCD=Q AT JFCOPTCD     19200 07013019
JPTCDI   EQU   JFCOPTJ             BIT FOR OPTCD=J IN JFCDPTCD @Z40MPTH 07013503
*                                      FOLLOWING TWO PATTERNS  EC 19017 07014019
*                                      ADDED FOR OCR SUPPORT   EC 19017 07015019
*                                      FORUSE WITH BSAM AND    EC 19017 07016019
*                                      QSAM RESPECTIVELY.      EC 19017 07017019
JPTCDF   EQU   X'10'         BIT FOR OPTCD=H IN JFCB AT JFCOPTCD  19017 07018019
JPTCDG   EQU   X'10'         BIT FOR OPTCD=O IN JFCB AT JFCOPTCD  19017 07019019
*                                                                       07020000
NTMN     EQU   X'01'              NUMBER NTM KEY PARAMETERS.            07040000
NTMS     EQU   X'00'              SUBLIST NTM KEY.                      07060000
JNTM1    EQU   99                 MAX VALUE NTM IN JFCB AT JFCNTM.      07080000
*                                                                       07100000
NCPN     EQU   X'01'              NUMBER NCP KEY PARAMETERS.            07120000
NCPS     EQU   X'00'              SUBLIST NCP KEY.                      07140000
JNCP1    EQU   99                 MAX VALUE NCP IN JFCB AT JFCNCP.      07160000
*                                                                       07180000
GNCPN    EQU   X'01'              NUMBER GNCP KEY PARAMS                07184000
GNCPS    EQU   X'00'              SUBLISTS                              07188000
JGNCP1   EQU   99                 MAX VALUE NCP IN JFCB AT JFCBFTEK     07192000
*                                                                       07196000
MODEN    EQU   X'01'              NUMBER MODE KEY PARAMETERS.           07200000
MODES    EQU   X'00'              SUBLIST MODE KEY.                     07220000
JMODE1   EQU   X'80'              BIT FOR MODE=C IN JFCB AT JFCMODE.    07240000
JMODE2   EQU   X'40'              BIT FOR MODE=E IN JFCB AT JFCMODE.    07260000
JMODE3   EQU   X'A0'              MODE=CO IN JFCB AT JFCMODE      21088 07262001
JMODE4   EQU   X'90'              MODE=CR IN JFCB AT JFCMODE      21088 07264001
JMODE5   EQU   X'60'              MODE=EO IN JFCB AT JFCMODE      21088 07266001
JMODE6   EQU   X'50'              MODE=ER IN JFCB AT JFCMODE      21088 07268001
DDMS2    EQU   255-DDMS1                                                07270017
*                                                                       07280000
LRECLN   EQU   X'01'              NUMBER LRECL KEY PARAMETERS.          07300000
LRECLS   EQU   X'00'              SUBLIST LRECL KEY.                    07320000
JLRECL1  EQU   32760              MAX VALUE LRECL IN JFCB / JFCLRECL.   07340000
JLRECLX  EQU   C'X'               LRECL EXCEPTION PARAMETER        AAAA 07350015
JLRECLXN EQU   1                   NUMBER OF CHARS / LRECL EXCEPTION    07355015
*                                                                       07360000
LIMCTN   EQU   X'01'              NUMBER LIMCT KEY PARAMETERS.          07380000
LIMCTS   EQU   X'00'              SUBLIST LIMCT KEY.                    07400000
JLIMCT1  EQU   32760              MAX VALUE LIMCT IN JFCB / JFCLIMCT.   07420000
*                                                                       07440000
KEYLENN  EQU   X'01'              NUMBER KEYLEN KEY PARAMETERS.         07460000
KEYLENS  EQU   X'00'              SUBLIST KEYLEN KEY.                   07480000
JKEYLEN1 EQU   255                MAX VALUE KEYLEN IN JFCB / JFCKEYLE.  07500000
*                                                                       07520000
INTVLN   EQU   X'01'              NUMBER INTVL KEY PARAMETERS.          07540000
INTVLS   EQU   X'00'              SUBLIST INTVL KEY.                    07560000
JINTVL1  EQU   255                MAX VALUE INTVL IN JFCB / JFCINTVL.   07580000
*                                                                       07600000
FRIDN    EQU   X'01'              NUMBER FRID KEY PARAMETERS     Y02670 07604002
FRIDS    EQU   X'00'              SUBLIST FRID KEY               Y02670 07608002
JFRID1   EQU   4                  MAXIMUM LENGTH OF FRID         Y02670 07612002
*                                                                       07616002
MSVGPN   EQU   X'02'              NUMBER OF MSVGP PARAMETERS   @G24LPSJ 07616803
MSVGPS   EQU   X'00'              SUBLIST CODE-NO SUBLIST      @Y30LPSB 07617603
MSVGPLN  EQU   X'08'              MAXIMUM LENGTH OF MSVGP ID   @Y30LPSB 07618403
*                                                              @Y30LPSB 07619203
EROPTN   EQU   X'01'              NUMBER EROPT KEY PARAMETERS.          07620000
EROPTS   EQU   X'00'              SUBLIST EROPT KEY.                    07640000
JEROPT4  EQU   X'08'              BIT FOR EROPT=CLS IN JFCB / JFCEROPT. 07720000
*                                                                       07740000
DSORGN   EQU   X'01'              NUMBER DSORG KEY PARAMETERS.          07760000
DSORGS   EQU   X'00'              SUBLIST DSORG KEY.                    07780000
JDSORG1  EQU   X'81'              BIT FOR DSORG=ISU IN JFCB / JFCDSORG. 07800000
JDSORG2  EQU   X'80'              BIT FOR DSORG=IS IN JFCB / JFCDSORG.  07820000
JDSORG3  EQU   X'41'              BIT FOR DSORG=PSU IN JFCB / JFCDSORG. 07840000
JDSORG4  EQU   X'40'              BIT FOR DSORG=PS IN JFCB / JFCDSORG.  07860000
JDSORG5  EQU   X'21'              BIT FOR DSORG=DAU IN JFCB / JFCDSORG. 07880000
JDSORG6  EQU   X'20'              BIT FOR DSORG=DA IN JFCB / JFCDSORG.  07900000
JDSORG7  EQU   X'10'              BIT FOR DSORG=CX IN JFCB / JFCDSORG.  07920000
JDSORG8  EQU   X'08'              BIT FOR DSORG=CQ IN JFCB / JFCDSORG.  07940000
JDSORG9  EQU   X'04'              BIT FOR DSORG=MQ IN JFCB / JFCDSORG.  07960000
JDSORGA  EQU   X'03'              BIT FOR DSORG=POR IN JFCB / JFCDSORG. 07980000
JDSORGB  EQU   X'02'              BIT FOR DSORG=PO IN JFCB / JFCDSORG.  08000000
*                                                                  AAAA 08032815
HIARCHYN EQU   X'01'              NUMBER HIARCHY KEY PARAMS        AAAA 08033615
HIARCHYS EQU   X'00'              SUBLISTS                         AAAA 08034415
JHIAR1   EQU   X'00'              BIT FOR HIARCHY=0                AABA 08035016
JHIAR2   EQU   X'04'              BIT FOR HIARCHY=1                AABA 08035316
JHIAR3   EQU   255-JHIAR1-JHIAR2  BIT PATTERN TO CLEAR HIARCHY BITSAABA 08035616
*                                                                       08036000
DENN     EQU   X'01'              NUMBER DEN KEY PARAMETERS.            08040000
DENS     EQU   X'00'              SUBLIST KEY.                          08060000
*                                                                       08140000
CYLOFLN  EQU   X'01'              NUMBER CYLOFL KEY PARAMETERS.         08240000
CYLOFLS  EQU   X'00'              SUBLIST CYLOFL KEY.                   08260000
JCYLOFL1 EQU   99                 MAX VALUE CYLOFL IN JFCB AT JFCCYLOF. 08280000
*                                                                       08300000
CPRIN    EQU   X'01'              NUMBER CPRI KEY PARAMETERS.           08320000
CPRIS    EQU   X'00'              SUBLIST CPRI KEY.                     08340000
JCPRI1   EQU   X'04'              BIT FOR CPRI=R IN JFCB AT JFCCPRI 696 08360000
JCPRI2   EQU   X'02'              BIT FOR CPRI=E IN JFCB AT JFCCPRI 696 08380000
JCPRI3   EQU   X'01'              BIT FOR CPRI=S IN JFCB AT JFCCPRI 696 08400000
*                                                                       08420000
CODEN    EQU   X'01'              NUMBER CODE KEY PARAMETERS.           08440000
CODES    EQU   X'00'              SUBLIST CODE KEY.                     08460000
*                                                                       08620000
HOLDN    EQU   X'01'              NUMBER HOLD KEY PARAMETERS     Y02668 08625002
HOLDS    EQU   X'00'              SUBLIST HOLD KEY               Y02668 08630002
*                                                                Y02668 08635002
BUFRQN   EQU   X'01'              NUMBER BUFRQ KEY PARAMETERS.          08640000
BUFRQS   EQU   X'00'              SUBLIST BUFRQ KEY.                    08660000
JBUFRQ1  EQU   255                MAX VALUE BUFRQ IN JFCB AT JFCBUFRQ.  08680000
*                                                                       08700000
BUFNON   EQU   X'01'              NUMBER BUFNO KEY PARAMETERS.          08720000
BUFNOS   EQU   X'00'              SUBLIST BUFNO KEY.                    08740000
JBUFNO1  EQU   255                MAX VALUE BUFNO IN JFCB AT JFCBUFNO.  08760000
*                                                                       08780000
BUFLN    EQU   X'01'              NUMBER BUFLN KEY PARAMETERS.          08800000
BUFLS    EQU   X'00'              SUBLIST BUFLN KEY.                    08820000
JBUFL1   EQU   32760              MAX VALUR BUFL IN JFCB AT JFCBUFL.    08840000
*                                                                       08860000
BLKSIZEN EQU   X'01'              NUMBER BLKSIZE KEY PARAMETERS.        08880000
BLKSIZES EQU   X'00'              SUBLIST BLKSIZE KEY.                  08900000
JBLKSIZ1 EQU   32760              MAX VALUE BLKSIZE IN JFCB / JFCBLKSI. 08920000
*                                                                       08940000
BFTEKN   EQU   X'01'              NUMBER BFTEK KEY PARAMETERS.          08960000
BFTEKS   EQU   X'00'              SUBLIST BFTEK KEY.                    08980000
JBFTEK4  EQU   X'80'              BIT FOR BFTEK=B IN JFCB AT JFCBFTEK.  09060000
JBFTEK5  EQU   X'60'    BIT FOR BFTEK=A IN JFCB AT JFCBFTEK       19015 09072019
JBFTEK6  EQU   X'20'    BIT FOR BFTEK=R IN JFCB AT JFCBFTEK.      19015 09073019
*                                                                A30036 09079019
JBFTEK7  EQU   (255-JFCSIM-JFCEXC-JFCDYN-JBFTEK4-JBFTEK5-JBFTEK6)       09085001
*              CLEAR THE PROPER BITS CONNECTED TO THIS DCB PARM  A30036 09091019
BFALNN   EQU   X'01'              NUMBER BFALN KEY PARAMETERS.          09100000
BFALNS   EQU   X'00'              SUBLIST BFALN KEY.                    09120000
JBFALN3  EQU   (255-JFCFWORD-JFCDWORD) TO ZERO OUT THE PROPER    A30036 09166001
*                                      BITS FOR THIS DCB PARAMET A30036 09172019
*                                                                       09180000
RETPDN   EQU   X'01'              NUMBER RETPD KEY PARAMETERS.          09200000
RETPDS   EQU   X'00'              SUBLIST RETPD KEY.                    09220000
JRETPD1  EQU   9999               MAX VALUE RETPD IN DDWA / DDETPD      09240000
*                                                                       09260000
COPIESN  EQU   X'02'              NUMBER OF COPIES PARAMETERS  @Z40MPTH 09260603
COPIESS  EQU   X'40'         SUBLIST CODE,SUBLIST ALLOWED IN   @Z40MPTH 09260903
*                                 SECOND POSITION....          @Z40MPTH 09261203
JCOPIES1 EQU  255                 MAXIMUM NUMBER OF COPIES       Y02668 09261802
JCOPIES2 EQU   X'01'              DEFAULT NO. OF COPIES          Y02668 09262402
*                                                                       09263002
DESTN    EQU   X'01'              NUMBER DEST KEY PARAMETERS     Y02668 09264002
DESTS    EQU   X'00'              SUBLIST DEST KEY               Y02668 09268002
JDEST1   EQU   8                  MAXIMUM LENGTH OF DEST       @ZA03532 09272003
*                                                                       09276002
EXPDTN   EQU   X'01'              NUMBER EXPDT KEY PARAMETERS.          09280000
EXPDTS   EQU   X'00'              SUBLIST EXPDT KEY.                    09300000
JEXPDT1  EQU   99                 MAX VALUE EXPDT IN JFCB AT JFCBXPDT.  09320000
JEXPDT2  EQU   366                MAX VALUE EXPDT IN JFCB/JFCBXPDT+1    09340000
JEXTEST  EQU   X'03'              IF BITS 0,1 OR 2 ON THEN YEAR  A46693 09350001
*                                 NOT DIVISIBLE BY 4,THEREFORE   A46693 09352001
*                                 NOT LEAP YEAR.                 A46693 09354001
*                                                                       09360000
FLASHN   EQU   X'02'               NUMBER FLASH KEY PARAMETERS @Z40MPTH 09360803
FLASHS   EQU   X'00'               SUBLISTS FLASH KEY          @Z40MPTH 09361603
FLASL    EQU   X'04'               LENGTH OF FLASH ID FIELD    @Z40MPTH 09362403
FLASHCNT EQU   X'FF'               MAXIMUM COUNT - 255         @Z40MPTH 09363203
*                                                              @Z40MPTH 09364003
BURSTN   EQU   X'01'               NUMBER BURST KEY PARAMETERS @Z40MPTH 09364803
BURSTS   EQU   X'00'               SUBLISTS BURST KEY          @Z40MPTH 09365603
*                                                              @Z40MPTH 09366403
MODIFYN  EQU   X'02'               NUMBER MODIFY KEY PARAMETERS@Z40MPTH 09367203
MODIFYS  EQU   X'00'               SUBLISTS MODIFY KEY         @Z40MPTH 09368003
MODIFL   EQU   X'04'               LENGTH OF MODIFY ID FIELD   @Z40MPTH 09368803
MODFYTRC EQU   X'03'               MAXIMUM TRC - 3             @Z40MPTH 09369603
CHARSN   EQU   X'04'               NUMBER CHARS KEY PARAMETERS @Z40MPTH 09370403
*                                                              @Z40MPTH 09371203
CHARSS   EQU   X'00'               SUBLISTS CHARS KEY          @Z40MPTH 09372003
CHARSL   EQU   X'04'               LENGTH OF CHARS ID FIELD    @Z40MPTH 09372803
*                                                              @Z40MPTH 09373603
SUBSYSN  EQU   X'FF'              NUMBER SUBSYS KEY PARAMETERS @G29AN2E 09374403
SUBSYSS  EQU   X'00'              SUBLISTS SUBSYS KEY          @G29AN2E 09375203
JSUBSYS1 EQU   4                  MAXIMUM LENGTH OF SSNAME     @G29AN2E 09376003
PROTECTN EQU   X'01'              NUMBER OF PROTECT KEY PARMS  @G32HPPJ 09376803
PROTECTS EQU   X'00'              SUBLISTS FOR PROTECT         @G32HPPJ 09377603
REFN     EQU   X'01'              NUMBER REF KEY PARAMETERS.            09380000
REFS     EQU   X'80'              SUBLIST REF KEY.                      09400000
*                                                                       09480000
SERN     EQU   X'FF'              NUMBER SER KEY PARAMETERS.            09500000
SERS     EQU   X'00'              SUBLIST SER KEY.                      09520000
*                                                                       09540000
SEPMN    EQU   X'08'              NUMBER SEP MINOR KEY PARAMETERS.      09560000
SEPMS    EQU   X'00'              SUBLIST SEP MINOR KEY.                09580000
JSEPM1   EQU   0                  VALUE FOR UNCONDITIONAL BIT SET.      09600000
*                                                                       09640000
AFFMN    EQU   X'01'              NUMBER AFF MINOR KEY PARAMETERS.      09660000
AFFMS    EQU   X'00'              SUBLIST AFF MINOR KEY.                09680000
JAFFM1   EQU   0                  VALUE FOR UNCONDITIONAL BIT SET.      09700000
*                                                                       09740000
SUBALLON EQU   X'03'              NUMBER SUBALLOC KEY PARAMETERS.       09760000
SUBALLOS EQU   X'60'              SUBLIST SUBALLOC KEY.                 09780000
JSUBAL1  EQU   0                  VALUE FOR UNCONDITIONAL BIT SET.      09800000
JSUBAL6  EQU   5                  MAX LENGTH OF AVERAGE RECORD          09880000
JSUBAL8  EQU   65535              MAX VALUE FOR AVERAGE RECORD.         09920000
JSUBAL9  EQU   8                  MAX LENGTH OF PRIMARY QUANTITY.       09940000
JSUBAL10 EQU   16777215           MAX VALUE FOR PRIMARY QUANTITY.       09960000
JSUBAL11 EQU   8                  MAX LENGTH OF SECONDARY QUANTITY.     09980000
JSUBAL12 EQU   16777215           MAX VALUE FOR SECONDARY QUANTITY.     10000000
JSUBAL13 EQU   8                  MAX LENGTH OF DIRECTORY QUANTITY.     10020000
JSUBAL14 EQU   16777215           MAX VALUE FOR DIRECTORY QUANTITY.     10040000
*                                                                       10060000
SYSOUTN  EQU   X'03'              NUMBER SYSOUT KEY PARAMETERS.         10080000
SYSOUTS  EQU   X'00'              SUBLIST SYSOUT KEY.                   10100000
JSYSOUT3 EQU   X'08'              BIT FOR SYSOUT SIOT / SCTSBYT3        10140000
JSYSOUT6 EQU   X'02'              BIT FOR SYSOUT JFCB / JFCBLTYP.       10180000
JSYSOUT7 EQU   1                  MAX LENGTH CLASSNAME SIOT / SCTOUTPN. 10200000
JSYSOUT8 EQU   8                  MAX LENGTH PGM NAME SIOT / SCTOUTNM.  10220000
JSYSOUT9 EQU   4                  MAX LENGTH FORM SIOT / SCTOUTNO.      10240000
JSYSOUT0 EQU   X'20'              BIT FOR SYSOUT JFCB / JFCBTSDM.       10250000
*                                                                       10260000
DSNAMEN  EQU   X'02'              NUMBER DSNAME KEY PARAMETERS.         10280000
DSNAMES1 EQU   X'80'              SUBLIST DSNAME KEY.                   10300000
JDSNAME1 EQU   44                 MAX LENGTH OF DSNAME                  10320000
JDSNAME2 EQU   8                  MAX LENGTH OF ELEMENT NAME            10340000
JDSNAME3 EQU   8                  MAX LENGTH OF GENERATION NUMBER       10360000
JDSNAME4 EQU   X'80'              BIT FOR GENERATION NUMBER.            10380000
JDSNAME5 EQU   X'01'              BIT FOR PDS JFCB / JFCBIND1           10400000
JDSNAME6 EQU   X'02'              BIT FOR GDG  JFCB/JFCBIND1     210271 10410001
*                                                                       10420000
QNAMEN   EQU   X'01'     NUMBER OF QNAME KEY PARAMS               20002 10424020
QNAMES   EQU  X'00'     SUBLIST QNAME KEY                         20002 10428020
JQNAME1  EQU   8          MAX LENGTH OF QNAME                     20002 10432020
*                                                                 20002 10436020
DDNAMEN  EQU   X'01'              NUMBER DDNAME KEY PARAMETERS.         10440000
DDNAMES  EQU   X'00'              SUBLIST DDNAME KEY.                   10460000
*                                                                       10480000
SPLITN   EQU   X'03'              NUMBER SPLIT KEY PARAMETERS.          10500000
SPLITS   EQU   X'20'              SUBLIST SPLIT KEY.                    10520000
JSPLIT5  EQU   3                  MAX LENGTH OF SPLIT=N                 10620000
JSPLIT6  EQU   255                MAX VALUE SPLIT=                      10640000
JSPLIT8  EQU   5                  MAX LENGTH OF AVERAGE RECORD          10680000
JSPLIT9  EQU   65535              MAX VALUE FOR AVERAGE RECORD          10700000
JSPLIT10 EQU   8                  MAX LENGTH OF PRIMARY QUANTITY.       10720000
JSPLIT11 EQU   16777215           MAX VALUE FOR PRIMARY QUANTITY.       10740000
JSPLIT12 EQU   8                  MAX LENGTH OF SECONDARY QUANTITY.     10760000
JSPLIT13 EQU   16777215           MAX VALUE FOR SECONDARY QUANTITY.     10780000
*                                                                       10800000
SPACEN   EQU   X'05'              NUMBER SPACE KEY PARAMETERS.          10820000
SPACES   EQU   X'40'              SUBLIST SPACE KEY.                    10840000
JSPACE06 EQU   5                  MAX LENGTH OF AVERAGE RECORD.         10940000
JSPACE07 EQU   65535              MAX VALUE FOR AVERAGE RECORD.         10960000
JSPACE08 EQU   8                  MAX LENGTH OF PRIMARY QUANTITY.       10980000
JSPACE09 EQU   16777215           MAX VALUE FOR PRIMARY QUANTITY.       11000000
JSPACE10 EQU   8                  MAX LENGTH OF SECONDARY QUANTITY.     11020000
JSPACE11 EQU   16777215           MAX VALUE FOR SECONDARY QUANTITY.     11040000
JSPACE12 EQU   8                  MAX LENGTH OF DIRECTORY QUANTITY.     11060000
JSPACE13 EQU   16777215           MAX VALUE FOR DIRECTORY QUANTITY.     11080000
JSPACE19 EQU   8                  MAX LENGTH OF QUANTITY                11200000
JSPACE20 EQU   16777215           MAX VALUE FOR QUANTITY                11220000
JSPACE21 EQU   5                  MAX LENGTH OF BEGINNING ADDRESS.      11240000
JSPACE22 EQU   65535              MAX VALUE FOR BEGINNING ADDRESS.      11260000
JSPACE23 EQU   8                  MAX LENGTH OF DIRECTORY QUANTITY      11280000
JSPACE24 EQU   16777215           MAX VALUE FOR DIRECTORY QUANTITY.     11300000
*                                                                       11320000
DISPN    EQU   X'03'              NUMBER OF DISP KEY PARAMETERS    000B 11340000
DISPS    EQU   X'00'              SUBLIST DISP KEY.                     11360000
JDISP2   EQU   X'04'              BIT FOR DISP=NEW SIOT / SCTSBYT3.     11420000
JDISP4   EQU   X'01'              BIT FOR DISP=OLD SIOT / SCTSBYT3.     11460000
JDISP6   EQU   X'02'              BIT FOR DISP=MOD SIOT / SCTSBYT3.     11500000
JDISP8   EQU   X'01'              BIT FOR DISP=SHARE SIOT / SCTSBYT3.   11540000
JDISP9   EQU   X'04'              BIT FOR DISP=DELETE SIOT / SCTSDISP.  11560000
JDISP10  EQU   X'08'              BIT FOR DISP=KEEP SIOT / SCTSDISP.    11580000
JDISP11  EQU   X'10'              BIT FOR DISP=PASS SIOT / SCTSDISP.    11600000
JDISP12  EQU   X'02'              BIT FOR DISP=CATLG SIOT / SCTSDISP.   11620000
JDISP13  EQU   X'01'              BIT FOR DISP=UNCATLG SIOT / SCTSDISP. 11640000
JDISP14  EQU   JDISP2+JDISP4+JDISP6 BITS FOR NEW OLD MOD AND SHARE.     11660000
JDISP15  EQU   JDISP9+JDISP10+JDISP11+JDISP12+JDISP13 2ND OPERAND BITS. 11680000
JDISP17  EQU   JDISP9+JDISP11     BITS FOR DELETE PASS.                 11720000
JDISP18  EQU   JDISP4             BITS FOR OLD AND SHARE.               11740000
*                                                                       11760000
JSTORE   EQU   X'02'              STORAGE BIT IN JFCB / JFCBIND2   892  11780000
JSTORE1  EQU   X'24'              BITS FOR PRIVATE, DELETE       A23901 11800019
JSTORE2  EQU   X'1B'              BITS FOR PASS,KEEP,CATLG,UNCATLG 892  11820000
*                                                                       11840000
DSIDN    EQU   X'02'              NUMBER OF DSID KEY PARAMETER @Y30OPSB 11843003
DSIDS    EQU   X'00'              CODE FOR NO SUBLISTS IN KEY  @Y30OPSB 11846003
DSIDLEN  EQU   X'08'              MAXIMUM LENGTH OF DSID ID..  @Y30OPSB 11849003
DSIDWORK EQU   SPLITBLK           USE JFCBX AREA TO MOVE DSID  @Y30OPSB 11852003
*                                 ID.THIS ENABLES USE OF PDT.. @Y30OPSB 11855003
SEPN     EQU   X'08'              NUMBER SEP KEY PARAMETERS.            11860000
SEPS     EQU   X'00'              SUBLIST SEP KEY.                      11880000
JSEP1    EQU   0                  VALUE FOR UNCONDITIONAL BIT SET.      11900000
*                                                                       11940000
AFFN     EQU   X'01'              NUMBER AFF KEY PARAMETERS.            11960000
AFFS     EQU   X'00'              SUBLIST AFF KEY.                      11980000
JAFF1    EQU   0                  VALUE FOR UNCONDITIONAL BIT SET.      12000000
*                                                                       12040000
VOLUMEN  EQU   X'04'              NUMBER VOLUME KEY PARAMETERS.         12060000
VOLUMES  EQU   X'00'              SUBLIST VOLUME KEY.                   12080000
JVOLUMT1 EQU   X'A0'               FOR PRIVATE BIT                16875 12120016
JVOLUMT2 EQU   X'40'              BIT FOR VOLUME=RETAIN SIOT SCTSDISP.  12140000
JVOLUMT3 EQU   4                  MAX LENGTH VOL SEQ NUM JFCB JFCBVLSQ. 12160000
JVOLUMT4 EQU   255                MAX VALUE VOL SEQ NUM JFCBVLSQ A29152 12180019
JVOLUMT5 EQU   3                  MAX LENGTH VOL COUNT JFCB JFCBVLCT.   12200000
JVOLUMT6 EQU   255                MAX VALUE VOL COUNT JFCB JFCBVLCT.    12220000
*                                                                       12240000
LABELN   EQU   X'04'              NUMBER OF LABEL PARAMETERS       AADA 12260017
LABELS   EQU   X'00'              SUBLIST LABEL KEY.                    12280000
JLABEL1  EQU   4                  MAX LENGTH OF FILE SEQUENCE NUMBER    12300000
JLABEL2  EQU   9999               MAX VALUE FOR FILE SEQUENCE NUMBER.   12320000
JLABEL3  EQU   X'08'              BIT SET FOR LABEL=NL SIOT / SCTSBYT2. 12340000
JLABEL6  EQU   4                   BIT SET FOR LABEL=SIOT/SCTSBYT2 000D 12400016
JLABEL8  EQU   X'08'              BIT SET FOR LABEL=SUL JFCB / JFCBLTYP 12480000
*                                  JFCB/JFCBIND2                   RWPW 12522020
JLABELA  EQU   X'08'              BIT SET FOR LABEL=BLP SIOT / SCTSBYT2 12525000
JLABELD1 EQU   X'FD'              USED TO TURN OFF SL DEFAULT     19200 12537819
JLABELE  EQU   X'10'              BIT FOR LABEL=AL AT SCTSBYT4    19200 12538219
JLABELF  EQU   X'48'               BIT FOR LABEL=AUL AT JFCBLTYP  M0254 12538620
JLABELF1 EQU   X'FD'              USED TO TURN OFF SL DEFAULT     19200 12539019
JLABELG  EQU   X'10'              BIT FOR LABEL=AUL AT SCTSBYT4   19200 12539401
JLABLTM  EQU   X'21'              LABEL=LTM  JFCB/JFCBLTYP       210271 12539701
*                                                                       12540000
UNITN    EQU   X'03'              NUMBER UNIT KEY PARAMETERS.           12560000
UNITS    EQU   X'00'              SUBLIST UNIT KEY.                     12580000
JUNIT3   EQU   8                  MAX LENGTH OF UNIT NAME.              12600000
JUNIT4   EQU   X'04'              BIT FOR UNIT=P SIOT / SCTSBYT1.       12620000
JUNIT5   EQU   3                  MAX LENGTH OF NUMBER OF UNITS.        12640000
JUNIT6   EQU   59        MAX NUMBER OF UNITS.                      000G 12660018
JUNIT7   EQU   X'02'              BIT FOR UNIT=DEFER SIOT / SCTSBYT2.   12680000
*                                                                       12700000
DCBN     EQU   X'01'              NUMBER DCB KEY PARAMETERS.            12720000
DCBS     EQU   X'80'              SUBLIST DCB KEY                       12740000
JDCB1    EQU   44                 MAX LENGTH DSNAME IN SIOT / SIOTDCBR. 12760000
*                                                                       12780000
CHKPTN   EQU   X'01'              NUMBER CHKPT KEY PARAMETERS. @Z30JPSF 12800003
CHKPTS   EQU   X'00'              SUBLIST CHKPT KEY.           @Z30JPSF 12810003
*                                                                 21009 12830001
DLMN     EQU   X'01'              NUMBER OF DLM PARAMETERS        21009 12832001
DLMS     EQU   X'00'              SUBLIST OF DLM                  21009 12834001
JDLMT1   EQU   2                  MAX LENGTH OF DLM                     12884001
*                                                                       12886001
FREEN    EQU   X'01'              NUMBER FREE KEY PARAMETERS     Y02670 12886502
FREES    EQU   X'00'              SUBLIST FREE KEY               Y02670 12887002
*                                                                       12887502
DUMMYN   EQU   X'01'              NUMBER OF DUMMY PARAMETERS            12888001
DUMMYS   EQU   X'00'              SUBLISTS FOR DUMMY                    12888401
*                                                                       12888801
DYNAMN   EQU   X'01'              KEY PARAMETERS                        12889201
DYNAMS   EQU   X'00'              SUBLISTS FOR DYNAM                    12889601
*                                                                       12889701
TERMN    EQU   X'01'              KEY PARAMETERS                        12889801
TERMS    EQU   X'00'              SUBLISTS FOR TERM                     12889901
*                                                                       12890401
UCSN     EQU   X'03'              NUMBER OF UCS PARAMETERS              12890801
UCSS     EQU   X'00'              SUBLISTS FOR UCS                      12891201
JUCS1    EQU   4                  MAX LENGTH CHARACTER SET ID FOR UCS   12891301
JUCS2    EQU   X'40'              BIT FOR UCS=FOLD AT JFCB/JFCINTVL     12891601
JUCS3    EQU   X'10'              BIT FOR UCS=VERIFY IN JFCB/JFCINTVL   12892101
FCBN     EQU   X'02'               NUMBER FCB KEY PARAMETERS      20202 12892220
FCBS     EQU   X'00'               SUBLIST FCB                    20202 12892320
JAFCB1   EQU   4                   MAX LEN OF ID                  20202 12892420
JAFCB2   EQU   X'08'               ALIGN BIT                      20202 12892520
JAFCB3   EQU   X'04'               VERIFY BIT                     20202 12892620
BUFOFFN  EQU   X'01'               NUMBER OF BUFFER PARAMETERS    19200 12892820
BUFOFFS  EQU   X'00'              SUBLIST MASK                    19200 12892919
JFCBUFSW EQU   JFCBMASK+6         BIT TO INDICATE BUFOFF          M2050 12893020
JBUFOFF1 EQU   X'02'              BUFOFF FIELD MAX LENGTH         19200 12893219
JBUFOFF2 EQU   X'63'              BUFOFF MAX VALUE                19200 12893519
JBUFOFF3 EQU   X'80'                   JFCB BUFFER OFFSET MASK    M4321 12893819
JBUFOFF4 EQU   X'02'              TO INDICATE BUFOFF SPECIFIED    M2050 12893920
*                                                                 O0101 12894119
*                                                                 19028 12896819
OUTLIMN  EQU   X'01'              NUMBER OF PARAMETERS (OUTLIM)   19028 12897119
OUTLIMS  EQU   X'00'              SUBLISTS FOR OUTLIM (NONE)      19028 12897419
JOUTLIM1 EQU   8                  MAX. PARAMETER LENGTH JFCB/     19028 12897719
JOUTLIM2 EQU   16777215           MAX. PARAMETER VALUE  JFCB/     19028 12898019
DIAGNSN  EQU   X'01'              NUMBER DIAGNS PARAMETERS       I21042 12898401
DIAGNSS  EQU   X'00'              SUBLIST DIAGNS KEY             I21042 12898801
*                       JCT TABLE SWITCHES.                             12900000
BUFINN   EQU   X'01'                   NUMBER BUFIN PARAMETERS    20002 12900720
BUFINS   EQU   X'00'                   SUBLIST BUFIN KEY          20002 12901420
JBUFINT1 EQU   15                      MAX VALUE BUFIN,OUT,MAX    20002 12902120
BUFOUTN  EQU   X'01'                   NUMBER BUFOUT PARAMETERS   20002 12902820
BUFOUTS  EQU   X'00'                   SUNLIST BUFOUT KEY         20002 12903520
BUFMAXN  EQU   X'01'                   NUMBER BUFMAX PARAMETERS   20002 12904220
BUFMAXS  EQU   X'00'                   SUBLIST BUFMAX KEY         20002 12904920
BUFSIZEN EQU   X'01'                   NUMBER BUFSIZE PARAMETERS  20002 12905620
BUFSIZES EQU   X'00'                   SUBLIST BUFSIZE KEY        20002 12906320
JBUFSIZE EQU   65535                   MAX VALUE BUFSIZE          20002 12907020
PCIN     EQU   X'02'                   NUMBER PCI PARAMETERS      20002 12907720
PCIS     EQU   X'00'                   SUBLIST PCI KEY            20002 12908420
JPCI1    EQU   X'20'                   A-FIRST PARAMETER          20002 12909120
JPCI2    EQU   X'10'                   A-SECOND PARAMETER         20002 12909820
JPCI3    EQU   X'08'                   N-FIRST PARAMETER          20002 12910520
JPCI4    EQU   X'04'                   N-SECOND PARAMETER         20002 12911220
JPCI5    EQU   X'02'                   R-FIRST PARAMETER          20002 12911920
JPCI6    EQU   X'01'                   R-SECOND PARAMETER         20002 12912620
JPCI7    EQU   X'80'              X-FIRST PARAMETER              Y01948 12913001
JPCI8    EQU   X'40'              X-SECOND PARAMETER             Y01948 12913101
RESERVEN EQU X'02'                NUMBER RESERVE PARAMETERS      Y02668 12913302
RESERVES EQU   X'00'                   SUBLIST RESERVE KEY        20002 12914020
JRESERV1 EQU   3                       MAX LENGTH INTEGER-RESERVE 20002 12914720
JRESERV2 EQU   255                     MAX VALUE INTEGER-RESERVE  20002 12915420
THRESHN  EQU   X'01'                   NUMBER THRESH PARAMETERS   20002 12916120
THRESHS  EQU   X'00'                   SUBLIST THRESH KEY         20002 12916820
JTHRESHT EQU   100                     MAX VALUE THRESH           20002 12917520
AMPN     EQU   X'15'              AMP PARAMETER EQUATES FOR KBT  Y01113 12930601
AMPS     EQU   X'80'                                             Y01113 12932601
SYSINCTN EQU   X'01'               NUMBER OF PARMS ALLOWED       Y02668 12932802
SYSINCTS EQU   X'00'               SUBLISTS ALLOWED FOR SYSIN CT Y02668 12933002
JOBFAILA EQU   JCT+JCTJSTAT-INJMJCT BYTE FOR JOB FAIL SWITCH.           12933301
JBLBSW   EQU   JJCT2              BIT FOR JOBLIB SWITCH                 12980000
*                       DICTIONARY INDICATOR SWITCHES                   13760000
ABSTR    EQU   JDICTI5            ABSTR BIT.                            13920000
DCBCNT   EQU   X'30'              CONTROL BYTES FOR DCB MINOR PDT       13980000
DCBINIT  EQU   X'00'              INDICATE CLEAR BYTE FOR DCB MINORS    14000000
* THE FOLLOWING ARE BIT SETTINGS FOR DDSWA FLAG BYTE IN DWA    @ZM44657 14040003
DSDUMSW  EQU   128                DSNAME/DUMMY SWITCH                   14041003
*                                                                       14042003
DDSUBSW  EQU   64                SUBSYS KEYWORD PROCESSED      @ZM44657 14043003
*                                                                 M0491 14048818
DDSPSW   EQU   32                SWITCH FOR SPACE KEYWORD PRESENT M0491 14049618
DDUNSW   EQU   16                     UNIT=(,,,AFF=DDNAME,,)      M0491 14050418
DSSYSSW  EQU   8                  OVERRIDE DUMMY AND DYNAM        20029 14050620
* END OF BIT SETTINGS FOR DDSWA FLAG BYTE IN DWA               @ZM44657 14050703
SUBPASS  EQU   INTKEY4           'PASS SUBSTITUTED' SECONDARY MSG 19874 14050819
SUBKEEP  EQU   INTKEY5           'KEEP SUBSTITUTED' SECONDARY MSG 19874 14051219
DWRNMSG  EQU   DDWAA              1 BYTE FOR WARNING MSG CODES     AABA 14052016
DWRNKEY  EQU   DDWAA+1            WARNING SECONDARY MSG CODE       AABA 14054016
HIOFF    EQU   X'7F'             TO TURN OFF HIGH ORDER BIT      A27935 14059219
NUMBYTE  EQU   TNUM1+3     POINTS TO NUM SUBPARAMS THIS KEYWORD  A39041 14059601
SCTSPMNT EQU   4                   PARALLEL MOUNT BIT FOR SIOT   Y02668 14059902
SIOTDREF EQU 128                   DCB REFERBACK WITHIN        @ZA06978 14065903
*                                  STEP - FOR SIOT             @ZA06978 14071903
ATSIGN   EQU   X'7C'       ATSIGN FOR MOVE INTO UNIQUE NAME.     Y02113 14080803
IEFVDA   CSECT                                                   A34497 14086801
* A-252370-252510,252900, C-337915                             @ZA01890 14091803
* A-040370,378204-378264  C-376884                             @YA00900 14096803
* D-600800                                                     @ZA02144 14106803
* A-140659,140719                                              @ZA06978 14115803
* CODE ADDED TO DCB KEYWORD PROCESSING ROUTINE                 @ZA06978 14117803
* CODE CHANGED IN REF KEYWORD PROCESSING ROUTINE               @ZA06978 14119803
* CODE ADDED TO AND CHANGED IN SYSOUT KEYWORD                  @ZA07483 14120803
*  PROCESSING ROUTINE                                          @ZA07483 14121803
* ADD CODE AFTER LABEL-CLEAN02A                                @ZA07503 14122603
* ADDED LABEL-CLEAN02B                                         @ZA07503 14123403
* CHANGED CODE AFTER LABEL-CLEAN02A                            @ZA07503 14124203
* DELETED TWO LINES OF CODE AFTER LABEL 'SERP'                 @ZA08159 14124703
* ADDED CODE AFTER LABEL CLEAN015                              @ZA08690 14124803
* ADDED CODE AFTER LABEL SERP22                                @ZA08164 14124903
* ADDED CODE TO SYSOUT KEYWORD ROUTINE                         @ZA08756 14125003
* ADDED CODE TO UNIT KEYWORD ROUTINE                           @ZA08746 14126003
* ADDED CODE TO AFF KEYWORD ROUTINE                            @ZA08746 14127003
* ADDED CODE TO SYSOUT KEYWORD ROUTINE                         @ZA10112 14128003
* ADDED CODE TO CONVERT SUBALLOC TO NORMAL SPACE REQUEST       @ZA10487 14128503
* ADDED CODE AFTER LABEL REFP01                                @ZA10649 14128703
* ADDED CODE AFTER LABEL DSNP011 AND EQU FOR ERMSG27           @ZA14270 14128803
* ADDED CODE AFTER LABEL DDP                                   @ZA14276 14128903
* ADDED CODE TO SYSOUT KEYWORD ROUTINE                         @ZA15012 14129403
* ADDED CODE AFTER LABEL SUB08                                 @ZA15344 14129503
* ADDED CODE AFTER LABEL DCBP05                                @ZA15388 14129603
* ADDED CODE AFTER LABEL DCBP02                                @ZA16387 14129703
* CHANGED FUNCTION BYTE IN PDT FOR DEST                        @ZA16418 14129803
* ADDED CODE AFTER LABEL DSNAMEP                               @ZA16056 14130803
* CHANGED PDT FUNCTION BYTE FOR SYSOUT 3RD POSITION            @ZA20550 14131803
* ADDITION TO PDT FOR DSID KEYWORD                             @ZA20610 14134503
* CHANGED PDT FOR RECFM KEYWORD                                @ZA24607 14135203
* ADDED CODE IN EXPDT ROUTINE                                  @ZA27071 14135603
* ADDED CODE TO SER KEYWORD ROUTINE                            @ZA28079 14135803
* ADDED CODE TO REF KEYWORD ROUTINE                            @ZA31245 14135903
* CHANGED MASK AND BRANCH VALUES AT DDP01                      @ZA32059 14136003
         BALR  RB,DD0             ESTABLISH ADDRESSABLITY.              14136603
         USING *,RB,R7     BASE REGS                               AACA 14138003
VDA1     DS    0H                                                  AACA 14140017
*****************************************************************Y02668 14141002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 14142002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 14143002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 14144002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 14145002
         DC    C'VDA '             MOD ID USED BY TRACE.         Y02668 14146002
* TRACE RETURNS HERE.                                            Y02668 14147002
*****************************************************************Y02668 14148002
         L     R7,DVDA1           BASE                             AACA 14150017
         B     DAHEADER           TRANSFER TO DA HEADER ROUTINE         14160000
DVDA1    DC    A(VDA1+4096)         VALUE FOR 2ND BASE REG         AACA 14170017
         MODID  BR=NO                                          @G24LPSJ 14220003
         DC    C'SU32'            FUNCTION ID                  @G32HPPJ 14224003
*        DC    C'01'              LEVEL # (PROTECT)            @G32HPPJ 14228003
*        DC    C'02'              INTER STEP REFERBACK TO DD   @ZA15388 14232003
*                                 WITH DCB=DSNAME IS VALID     @ZA15388 14236003
*        DC    C'03'              DCB REFERBACK COPIES FUNC    @ZA16387 14240003
*                                 INFORMATION                  @ZA16387 14244003
*        DC    C'04'              ALLOW ANY CHARACTER IN FIRST          14248003
*                                 BYTE OF DEST PARAMETER       @ZA16418 14252003
*        DC    C'05'              JCL ERROR IF VTOC NAME IN JCL@ZA16056 14256003
*        DC    C'06'              JCL ERROR IF SYSOUT FORMS IS NOT      14260003
*                                 ALPHA/NUMERIC OR NATIONAL    @ZA20550 14264003
*        DC    C'07'  TURN ON SIOTDSID FOR DSID KEYWORD        @ZA20610 14268003
*                     REMOVE INVALID PARMS IN RECFM PDT        @ZA24607 14272003
*        DC    C'08'  TURN ON JFCBEXP IF EXPDT SPECIFIED       @ZA27071 14276003
*        DC    C'09'  MERGE SU4,10,16 CODE TO REL 037 PTF      @ZA27750 14276303
*        DC    C'10'  CHECK FOR FIRST POSITIONAL PARM IN SER   @ZA28079 14277303
*        DC    C'11'  CHECK FOR REF=*, ERROR                   @ZA31245 14278203
         DC    C'12'  CHECK FOR JOBLIB IN CATALOGED PROC       @ZA32059 14278803
         EJECT                                                 @G24LPSJ 14280003
*              **************************************************       14300000
*              *                                                *       14320000
*              *                  HEADER ROUTINE                *       14340000
*              *                                                *       14360000
*              *        REGISTER USAGE.                         *       14380000
*              *                                                *       14400000
*              *             RC INTERPRETOR WORK AREA.          *       14420000
*              *             RB BASE FOR DA ROUTINE.            *       14440000
*              *             RA DA WORK AREA.                   *       14460000
*              *             R9 VCON TO GET KEY.                *       14480000
*              *             R8 VCON TO TEST & STORE.           *       14500000
*              *             R7 SECOND BASE REG                 *  AACA 14520017
*              *             R6 VCON TO Q MANAGER.              *       14540000
*              *             R5 POINTER TO REMOTE PARAMETER     *       14560000
*              *                  LIST OF Q MANAGER.            *       14580000
*              *             R4 POINTER TO PARAMETER DESCRIPTOR.*       14600000
*              *                  TABLE.                        *       14620000
*              *             R3 POINTER TO LENGTH BYTE IN TEXT. *       14640000
*              *             R2 LENGTH VALUE OF LENGTH BYTE.    *       14660000
*              *                                                *       14680000
*              **************************************************       14700000
         SPACE 2                                                        14720000
DAHEADER DS    0H                 INITIALIZE DA ROUTINE                 14740000
         L     RA,CTRLWAP         ESTABLISH ADDRESSABLITY TO DA WORK.   14760000
         XC    DWA(LDWA),DWA      ZERO DA WORK AREA                     14780000
         XC    SIOT(JFCB-SIOT),SIOT  ZERO SIOT                          14786000
         XC    JFCB(JFCBX-JFCB),JFCB ZERO JFCB                          14792000
         XC    JFCBEX(L'JFCBEX),JFCBEX   ZERO JFCBE IN LWA...  @Z40MPTH 14792203
         LA    R2,SIOT                                           Y02668 14792402
         ST    R2,IWASIOTP                                       Y02668 14792802
         LA    R2,JFCB                                           Y02668 14793202
         ST    R2,IWAJFCBP                                       Y02668 14793602
         L     R6,TEXTBUFP         ADDRESSABILITY FOR            Y02668 14794302
         L     R6,DIEFVHQ         LOAD VCONS                       AACA 14796017
         LM    R8,R9,DIEFVGT                                       AACA 14800017
*                                  R6= ADDR OF QUEUE MANAGER       AACA 14804017
*                                  R7= SECOND BASE REG             AACA 14808017
*                                  R8= ADDR OF TEST & STORE RTN    AACA 14812017
*                                  R9= ADDR OF GET KEY RTN         AACA 14816017
         LA    R5,CLEANUP         GET ADDRESS OF CLEANUP ROUTINE        14820000
         ST    R5,TCLEANUP        SAVE ADDRESS FOR TEST AND STORE.      14840000
         L     R5,ADABTABL        GET ADDRESS OF BRANCH TABLE.          14860000
         ST    R5,TBRANCH         SAVE ADDRESS FOR TEST AND STORE       14880000
         L     R5,QPARM+QMPCL-QMNAM GET REMOTE PARM ADDRESS FOR Q MAN.  14900000
         BALR  RE,R9              GO TO GET KEY                         14920000
         EJECT                                                          14940000
*              **************************************************       14960000
*              *                                                *       14980000
*              *       GENERAL KEYWORD PROCESSING ROUTINE       *       15000000
*              *                                                *       15020000
*              **************************************************       15040000
         SPACE 1                                                        15050001
********* ENTRY FOR EACH KEYWORD LISTED.POSITIONALS ARE PROCESSED       15052001
********* BY GOING TO TEST AND STORE AND GET KEY UNTIL A NEW KEY        15054001
********* IS ENCOUNTERED.                                               15056001
         SPACE 2                                                        15060000
DDNORM   DS    0H                 ENTRY.                                15080000
SOWAP    DS    0H                 SOWA.                                 15100000
RKPP     DS    0H                 RKP.                                  15120000
NTMP     DS    0H                 NTM.                                  15140000
NCPP     DS    0H                 NCP.                                  15160000
LIMCTP   DS    0H                 LIMCT.                                15200000
KEYLENP  DS    0H                 KEYLEN.                               15220000
INTVLP   DS    0H                 INTVL.                                15240000
CYLOFLP  DS    0H                 CYLOFL.                               15280000
BUFRQP   DS    0H                 BUFRQ.                                15300000
BUFNOP   DS    0H                 BUFNO.                                15320000
BUFOFFP  DS    0H                      BUFOFF.                    19200 15330019
BUFLP    DS    0H                 BUFL.                                 15340000
BLKSIZEP DS    0H                 BLKSIZE.                              15360000
VOLUMEP  DS    0H                 VOLUME.                               15380000
LABELP   DS    0H                 LABEL.                                15400000
DISPP    DS    0H                 DISP.                                 15420000
BURSTP   DS    0H                                              @Z40MPTH 15450003
PROTECTP DS    0H                 PROTECT.                     @G32HPPJ 15460003
GNCPP    DS    0H                                                       15490000
BUFSIZEP DS    0H                      BUFSIZE                    20002 15490820
THRESHP  DS    0H                      THRESH                     20002 15491220
QNAMEP   DS    0H    QNAME                                        20002 15491620
OUTLIMP  DS    0H                 OUTLIM.                         19028 15496019
DIAGNSP  DS    0H                 DIAGNS.                        I21042 15498001
IPLTXIDP DS    0H                 IPLTXID.                       Y01948 15498401
FRIDP    DS    0H                 FRID                           Y02670 15499202
CHKPTP   DS    0H                 CHKPT                        @Z30JPSF 15499603
         BALR  RE,R8              GO TO TEST & STORE                    15500000
         BALR  RE,R9              GO TO GET KEY.                        15520000
         B     DDNORM             LOOP BACK.                            15540000
*********************************************************************** 15540102
*                                                                       15540202
*                                                                       15540302
*                  SPLIT PROCESSOR                                      15540402
*                                                                       15540502
*                                                                       15540602
*                                                                       15540702
*********************************************************************** 15540802
*                                                                       15540902
*                                                                       15541002
*                  EQUATES                                              15541102
*                                                                       15541202
*                                                                       15541302
*********************************************************************** 15541402
JFCBPRIM EQU   JFCB+JFCBPQTY-INFMJFCB                            Y02661 15541502
JFCBSECQ EQU   JFCB+JFCBSQTY-INFMJFCB                            Y02661 15541602
JFCBCNTR EQU   JFCB+JFCBCTRI-INFMJFCB                            Y02661 15541702
JFCBDBLK EQU   JFCB+JFCBDRLH-INFMJFCB                            Y02661 15541802
SPLITPRM EQU   SPSAV+SPLITPQY-SPLITBLK                           Y02661 15542002
SPLITSEC EQU   SPSAV+SPLITSQY-SPLITBLK                           Y02661 15542102
SPLITTTR EQU   SPSAV+SPLITMTR-SPLITBLK                           Y02661 15542202
PARMBYTE EQU   SWD                                                      15542302
LASTINDC EQU   4                                                        15542402
*********************************************************************** 15542502
SPLITP   DS    0H                                                Y02661 15542602
         CLI   DD0(R3),DD0              PARM LENGTH = ZERO?      Y02661 15542702
         BZ    SPLIT04                  GET NEXT KEY             Y02661 15542802
SPLIT01  DS    0H                                                Y02661 15542902
         XC    JFCBX(DD20),JFCBX        CLEAR TEMP WORKAREA      Y02661 15543002
         BCTR  R3,R0                    POINT TO COUNT FIELD     Y02661 15543102
         CLI   DD0(R3),DD1              PARM COUNT = ONE         Y02661 15543202
         LA    R3,DD1(R3)               RESTORE POINTER          Y02661 15543302
         BE    SPLIT015                 IF ONE PARM NOT MODEL    Y02661 15543402
*********************************************************************** 15543502
*                                                                       15543602
*                                                                       15543702
*   THE FOLLOWING HANDLES A MODEL REQUEST                               15543802
*                                                                       15543902
*********************************************************************** 15544002
         XC    SPSAV(DD20),SPSAV        CLEAR SPLIT WORK AREA    Y02661 15544102
         MVC   SPLITTTR(DD3),TSIOT      SAVE MODEL SIOT TTR      Y02661 15544202
         MVI   SPSAV+SPLITBY2-SPLITBLK,SPLITMDL INDICATE MODEL   Y02661 15544302
         B     SPLIT02                                           Y02661 15544402
*****************************************************************Y02661 15544502
*                                                               *Y02661 15544602
*  THE FOLLOWING PROCESSES A SIOT WHICH IS NOT A MODEL          *Y02661 15544702
*                                                               *Y02661 15544802
*****************************************************************Y02661 15544902
SPLIT015 DS    0H                                                Y02661 15545002
         MVI   SPSAV+SPLITBY2-SPLITBLK,SPLITNML NOT MODEL IND    Y02661 15545102
         MVC   SIOT+SIOTVRSB-INDMSIOT(DD3),SPLITTTR MDL SIOT TTR Y02661 15545202
         OI    SIOT+SCTSBYT3-INDMSIOT,SCTVREF SET VOLREF IN STP YM05425 15545302
         OI    SIOT+SCTSBYT2-INDMSIOT,SCTVOLAF  SET VOL AFFINITY Y02661 15545502
         MVI   SIOT+SCTUTYPE-INDMSIOT,DDBLANK BLANK UNIT TYPE    Y02661 15545602
         MVC   SIOT+SCTUTYPE-INDMSIOT+1(DD7),SIOT+SCTUTYPE-INDMSIOT     15545702
**********************************************************************  15545802
SPLIT02  DS    0H                                                Y02661 15545902
         BALR  RE,R8                    TEST AND STORE           Y02661 15546002
**********************************************************************  15546102
         NI    PARMBYTE,255-LASTINDC   TURN OFF LAST PARM INDC   Y02661 15546202
         LM    R0,R1,TNUM              PARAMETER COUNT           Y02661 15546302
         CLR   R0,R1                   ANY MORE PARMS            Y02661 15546402
         BNE   MORE                    YES MORE PARMS            Y02661 15546502
         LM    R0,R1,TNUM+8            SUBPARAMETER COUNT        Y02661 15546602
         CLR   R0,R1                   ANY MORE SUBPARMS         Y02661 15546702
         BNE   MORE                    YES MORE SUBPARMS         Y02661 15546802
         OI    PARMBYTE,LASTINDC       INDICATE LAST PARM        Y02661 15546902
MORE     DS    0H                                                Y02661 15547002
**********************************************************************  15547102
         TM    PARMBYTE,LASTINDC        LAST PARM ON KEYWORD     Y02661 15547202
         BO    SPLITC00                 PROCESS SPLIT KEYWORD    Y02661 15547302
SPLIT04  BALR  RE,R9                    GET NEXT PARM            Y02661 15547402
         B     SPLIT02                  PROCESS IT               Y02661 15547502
*********************************************************************** 15547602
SPLITC00 DS    0H                                                Y02661 15547702
         TM    SPSAV+SPLITBY2-SPLITBLK,SPLITMDL SPLIT DD         Y02661 15547802
         BM    SPLITC20                 NOT SPLIT SUB DD         Y02661 15547902
         MVC   SPSAV(DD11),JFCBX        MOVE MODEL INFO TO SAVE  Y02661 15548002
SPLITC20 DS    0H                                                Y02661 15548102
         MVC   SPLITWRK(DD3),SPLITPRM  TOTAL SPACE FOR SPLIT DDS Y02661 15548202
         BAL   RE,SPLITC40             CALCULATE PRIM.SPACE      Y02661 15548302
         MVC   JFCBPRIM(DD3),SPLITWRK  MOVE PRIMARY SPACE        Y02661 15548402
         TM    SPSAV+SPLITBYT-SPLITBLK,SPLITCYL BLOCK REQUEST    Y02661 15548502
         BM    SPLITC30                BRANCH IF BLOCK           Y02661 15548602
         MVC   SPLITWRK(DD3),SPLITSEC  TOTAL SECONDARY SPACE     Y02661 15548702
         BAL   RE,SPLITC40             CALCULATE SEC. SPACE      Y02661 15548802
         MVC   JFCBSECQ(DD3),SPLITWRK  MOVE SECONDARY SPACE      Y02661 15548902
         B     SPLITC60                EXIT SPLIT                Y02661 15549002
SPLITC30 DS    0H                                                Y02661 15549102
         MVC   JFCBSECQ(DD3),SPLITSEC  MOVE SEC SPACE FOR BLOCK  Y02661 15549202
         B     SPLITC60                EXIT SPLIT                Y02661 15549302
*********************************************************************** 15549402
SPLITWRK EQU   JFCBX+SPLITWKA-SPLITBLK+1 SPLIT WORK AREA         Y02661 15549502
*********************************************************************** 15549602
SPLITC40 DS    0H                                                Y02661 15549702
         SR    R0,R0                    CLEAR REG 0              Y02661 15549802
         SR    R1,R1                    CLEAR REG 1              Y02661 15549902
         IC    R1,JFCBX+SPLITTRK-SPLITBLK   GET % OR NO. TRACKS  Y02661 15550002
         TM    SPSAV+SPLITBYT-SPLITBLK,SPLITCYL BLOCK REQUEST    Y02661 15550102
         BM    SPLIT05                    PROCESS BLK REQUEST    Y02661 15550202
         OI    JFCBCNTR,JFCBTRK           INDICATE TRK REQUEST   Y02661 15550302
         MH    R1,SPLITWRK+1            MULTIPLY TRKS TIMES CYL  Y02661 15550402
         B     SPLIT06                                           Y02661 15550502
HUNDRED  DC    F'100'                   DIVIDE CONSTANT          Y02661 15550602
**********************************************************************  15550702
*                                                                       15550802
*     PROCESS BLOCK REQUEST                                             15550902
*                                                                       15551002
*********************************************************************** 15551102
SPLIT05  MVC   JFCBDBLK(DD3),SPSAV+SPLITBLN-SPLITBLK AVG BLK LEN Y02661 15551202
         OI    JFCBCNTR,JFCBAVR         INDIC AVG BLK REQ        Y02661 15551302
         MH    R1,SPLITWRK+1            CAL. NO. OF BLOCKS       Y02661 15551402
         D     R0,HUNDRED              AND CONVERT %             Y02661 15551502
*********************************************************************** 15551602
*                                                                       15551702
SPLIT06  ST    R1,JFCBX+SPLITWKA-SPLITBLK  STORE VALUE           Y02661 15551802
         BR    RE                  RETURN VALUE                  Y02661 15551902
SPLITC60 DS    0H                                                Y02661 15552002
         B     SPLIT04                                                  15552102
         EJECT                                                          15560000
*              **************************************************       15580000
*              *                                                *       15600000
*              *   AFF AND SEP KEYWORD PROCESSING ROUTINE.      *       15620000
*              *                                                *       15640000
*              **************************************************       15660000
         SPACE 1                                                        15670001
********* AFF AND SEP MAJOR KEYWORD - FOR CHANNEL SEPARATION AND        15672001
********* AFFINITY SPECIFICATION.                                       15674001
********* SEP MINOR KEYWORD FOR UNIT SEPARATION                 YM01578 15677002
         SPACE 2                                                        15680000
AFFP     DS    0H                 PROCESS AFF KEY.                      15700000
SEPP     DS    0H                 PROCESS SEP KEY.                      15720000
SEPMP    DS    0H                                               YM01578 15723002
         LTR   R2,R2               IS REQ. PARM PRESENT           19432 15726017
         BZ    SPACE10             NO, PUT OUT ERROR MSG.       YM01578 15732002
SEPLOOP  DS    0H                                               YM01578 15760002
         BALR  RE,R9              GO TO GET KEY.                        15820000
         B     SEPLOOP       TO PASS THRU SEP DATA TO NEXT KEY  YM01578 15820402
*                                                                 M0491 15820918
*********************************************************************** 15821818
*                                                                 M0491 15822718
*                     UNIT  KEYWORD  PROCESSING  ROUTINE          M0491 15823618
*                                                                 M0491 15824518
*********************************************************************** 15825418
UNITP    DS    0H                PROCESS UNIT KEY                 M0491 15826318
         L     RE,TEXTBUFP       LOAD TEXT STRING POINTER      @ZA08746 15826403
         USING TEXT,RE           SET ADDRESSABILITY TO PREFIX  @ZA08746 15826503
         TM    STRDINDC,DTXSYOUT WAS SYSOUT SPECIFIED?         @ZA08746 15826603
         BO    UNITP02           YES, IGNORE UNIT PARAMETER    @ZA08746 15826703
         DROP  RE                RELEASE THE REGISTER          @ZA08746 15826803
         CLI   TNUM+3,DD0        IS NUMBER BYTE = 0               M0491 15827218
         BE    UNITP01           IF = 0, TAKE BRANCH              M0491 15828101
         OI    DDSWA,DDUNSW      SET BIT SO UNITAFF MINOR KEYWORD M0491 15829001
*                                PROCESSOR CAN DETECT ERROR       M0491 15829918
*                                (POSITIONAL PARAMETERS ARE       M0491 15830818
*                                INVALID WITH UNIT=AFF=)          M0491 15831718
UNITP01  DS    0H                                                 M0491 15832618
         BALR  RE,R8             GO TO TEST & STORE ROUTINE       M0491 15833518
*                                TEST AND STORE WILL NULLIFY THE        15833901
*                                UNIT KEY IF NULL PARAMETER PASSED.     15834301
         BALR  RE,R9             GO TO GET KEY ROUTINE            M0491 15834403
         B     UNITP01           LOOP BACK TO TEST & STORE UNTIL  M0491 15835318
*                                ALL POSITIONALS ARE PROCESSED,   M0491 15836218
*                                AND A NEW KEY IS FOUND AND       M0491 15837118
*                                A BRANCH TAKEN                   M0491 15838018
UNITP02  BALR  RE,R9             GO TO KEY ROUTINE             @ZA08746 15838303
         B     UNITP02           LOOP TO GET KEY UNTIL ALL     @ZA08746 15838503
*                                POSITIONALS ARE PROCESSED AND @ZA08746 15838703
*                                A NEW KEY IS FOUND AND        @ZA08746 15838903
*                                ANOTHER BRANCH IS TAKEN       @ZA08746 15839103
         EJECT                                                          15840000
*              **************************************************       15860000
*              *                                                *       15880000
*              *         DCB KEYWORD PROCESSING ROUTINE         *       15900000
*              *                                                *       15920000
*              **************************************************       15940000
         SPACE 2                                                        15960000
DCBP     DS    0H                 PROCESS DCB KEY.                      15980000
         CLI   DD0(R3),DD0        IS LENGTH BYTE ZERO                   16000000
         BC    NOT-ZERO,DCBP01    NO TRANSFER.                          16020000
         BALR  RE,R9              YES GO TO GET KEY.                    16040000
DCBP01   DS    0H                 ENTER                                 16060000
         TM    SWI,IWADDNM        IS THERE DDNAME= THIS CARD       AABA 16070016
         BO    DCBP08             TRANS YES - ERROR                AABA 16075001
         CLI   DD1(R3),DDASTER    IS OPERAND AN ASTERICK                16080000
         BC    EQUAL,DCBP02       YES TRANSFER.                         16100000
         L     RE,TNUMPX          LOAD CURRENT NUMBER POINTER     M0377 16102020
         CLI   DD0(RE),DD1        ARE THERE POSITIONAL PARMS      M0377 16104020
         BNE   DCBP01A            NO - BRANCH                     M0377 16106020
         CLI   DD1(RE),DD129      TRANSFER IF MORE THAN ONE       M0377 16108020
         BH    DCBP08             POSITIONAL SUBPARAMETER         M0377 16110020
DCBP01A  DS    0H                                                 M0377 16112020
         BAL   RE,DSNTP           GO PROCESS DSNAME TABLE        Y02668 16130002
         BALR  RE,R9              GO TO GET KEY                   M0377 16140020
DCBP02   DS    0H                 ENTER.                                16160000
*                                                                       16162017
*  IF ASTERISK IS FOLLOWED BY PERIOD ( *.DD ) WHICH INDICATES           16164017
*      A REFERBACK, THE LENGTH FIELD MUST HAVE A LENGTH OF ONE.         16166017
*    IF NOT LENGTH OF ONE THEN PERIOD MUST BE MISSING.                  16168017
*                                                                       16170017
         CLI   DD0(R3),X'01'                                      18768 16172017
         BNE   DCBP10                                             18768 16174017
         BCTR  R3,R0              DECREMENT TEXT POINTER                16180000
         TM    DD0(R3),DD128      IS HIGH ORDER BIT ON.                 16200000
         BZ    DCBP06             YES TRANSFER ERROR.                   16220001
         BAL   RE,INTRSTEP         GO CHECK TYPE OF REFERBACK  @ZA06978 16224003
*   RETURN FOR WITHIN STEP REFERBACK                           @ZA06978 16228003
         OI    SIOT+SIODDSNL-INDMSIOT,SIOTDREF                 @ZA06978 16232003
*   RETURN FOR INTER STEP REFERBACK                            @ZA06978 16236003
         BALR  RE,R9              GO TO GET KEY.                        16240000
         BAL   RE,DSRTN            GO TO DICTIONARY SEARCH RTN     AACA 16260017
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                        16280000
         MVI   QPARM+QMPNC-QMNAM,DD1 SET FOR ONE READ                   16300000
         LA    RF,JFCBX           GET ADDRESS FOR JFCB                  16320000
         ST    RF,DD0(R5)         PUT ADDRESS IN REMOTE PARM LIST       16340000
         MVC   DD4(DD3,R5),DD5(R1) PUT TTR OF JFCB IN REMOTE PARM LIST. 16360000
         BALR  RE,R6              GO TO Q MANAGER                       16380000
         MVC   JFCB+JFCFCBID-INFMJFCB(DD4),JFCBX+JFCFCBID-INFMJFCB      16386002
*              MOVE JFCB FCB IMAGE INTO JFCB BEING BUILT....    YA61281 16392002
         MVC   JFCB+JFCBUFNO-INFMJFCB(JFCBNTCS-JFCBUFNO),JFCBX+JFCBUFNO116400000
               -INFMJFCB          MOVE DCB PARM.                        16420000
         MVC   JFCB+JFCFUNC-INFMJFCB(DD1),JFCBX+JFCFUNC-INFMJFCB        16423003
*                                 MOVE FUNC INFORMATION        @ZA16387 16426003
         TM    JFCBX+JFCBUFSW-INFMJFCB,JFCBBUFF WAS BUFOFF CODED  M2050 16430001
*              BIT MUST BE TESTED DUE TO JFCBOTTR CONFLICT IN PCP M2050 16430420
*              IN MFT AND MVT THIS JFCBOTTR FIELD IS NEVER FILLED M2050 16430820
*              IN BEFOR THE READER FINISHES PROCESSING            M2050 16431220
*              ALL STEPS OF A JOB                                 M2050 16431620
         BZ    DCBP05             IF NOT DON'T MERG IT            M2050 16432020
         MVC   JFCB+JFCBUFOF-INFMJFCB(JFCBFLSQ-JFCBUFOF),JFCBX+JFCBUFOFX16434020
               -INFMJFCB          MOVE BUFOFF DCB PARM            M2050 16436020
         OI    JFCB+JFCBUFSW-INFMJFCB,JFCBBUFF INDICATE BUFOFF    M2050 16436501
DCBP05   EQU   *                                                  M2050 16438020
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                        16460000
         MVI   QPARM+QMPNC-QMNAM,DD1 SET READ FOR ONE                   16480000
         LA    RF,JFCBX           GET ADDRESS FOR SIOT                  16500000
         ST    RF,DD0(R5)         PUT ADDRESS IN REMOTE PARM LIST.      16520000
         MVC   DD4(DD3,R5),DD2(R1) PUT TTR OF SIOT IN REMOTE PARM LIST  16540000
         BALR  RE,R6              GO TO Q MANAGER                       16560000
         MVC   SIOT+SIODSNTE-INDMSIOT(DD2),JFCBX+SIODSNTE-INDMSIOT      16568002
*              MOVE THE DISPLACEMENT INTO DSNT INTO NEW SIOT.   YA02512 16576002
         CLI   JFCBX+SIODDSNL-INDMSIOT,DD0  IF REFERBACK       @ZA15388 16576103
         BE    DCBP03              IS NOT DCB = DSNAME,BRANCH  @ZA15388 16576503
         TM    SIOT+SIODDSNL-INDMSIOT,SIOTDREF   IS INTRA STEP @ZA15388 16576903
         BO    DCBP03             BRANCH TO SKIP DSNT PROCESS  @ZA15388 16577303
         MVC   SIOT+SIODDSNL-INDMSIOT(DD1),JFCBX+SIODDSNL-INDMSIOT      16578603
*              COPY LENGTH OF NAME INTO NEW SIOT               @ZA15388 16579003
         STM   R2,R3,DDWA7        SAVE LENGTH AND PTR TO LENGTH@ZA15388 16579203
         OI    SRCHSW1,SRCHF2     INDICATE SCT SEARCH          @ZA15388 16579403
         LA    RE,DD3             WANT TO BACK UP 3 BYTES      @ZA15388 16579603
         SR    R3,RE              BACK UP TO SUBPARM # BYTE    @ZA15388 16579803
         IC    R2,0(R3)           GET SUBPARM NUMBER           @ZA15388 16580003
         BCTR  R2,R0              DECREMENT COUNT              @ZA15388 16580203
         STC   R2,0(R3)           TEMPORARILY ALTER TEXT       @ZA15388 16580403
         LM    R2,R3,DDWA7        RESTORE REGISTERS            @ZA15388 16580603
         BAL   RE,DSRTN           GO TO VGS                    @ZA15388 16580803
         LA    RE,DD3             WANT TO BACK UP 3 BYTES      @ZA15388 16581003
         SR    R3,RE              BACKUP TO SUBPARM # BYTE     @ZA15388 16581203
         IC    R2,DD0(R3)         GET SUBPARM NUMBER           @ZA15388 16581403
         LA    R2,DD1(R2)         ADD 1 TO RESTORE ORIGINAL #  @ZA15388 16581603
         STC   R2,DD0(R3)         CHANGE TEXT BACK TO ORIGINAL @ZA15388 16581803
         LM    R2,R3,DDWA7        RESTORE REGS                 @ZA15388 16582003
         MVI   QPARM+QMPOP-QMNAM,QMREAD  SET READ              @ZA15388 16582203
         LA    RF,JFCBX           GET ADDR FOR SCT             @ZA15388 16582403
         ST    RF,DD0(R5)         PUT ADDR IN REMOTE PARM LIST @ZA15388 16582603
         MVC   DD4(DD3,R5),DD2(R1)  TTR OF SCT IN REMOTE LIST  @ZA15388 16582803
         BALR  RE,R6              GO TO Q MANAGER TO READ SCT  @ZA15388 16583003
         MVI   QPARM+QMPOP-QMNAM,QMREAD  SET READ              @ZA15388 16583203
         LA    RF,JFCBX           GET ADDR OF READ IN AREA     @ZA15388 16583403
         ST    RF,DD0(R5)         PUT ADDR IN REMOTE PARM LIST @ZA15388 16583603
         MVC   DD4(DD3,R5),JFCBX+SCTADSTB-INSMSCT  PUT TTR OF  @ZA15388 16583803
*                                 DSNT IN REMOTE PARM LIST     @ZA15388 16584003
         BALR  RE,R6              GO TO Q MNGR TO READ DSNT    @ZA15388 16584203
DCBP053  DS    0H                 IS THIS CORRECT DSNT?        @ZA15388 16584403
         CLC   SIOT+SIODSNTE-INDMSIOT(DD2),DSNTLEN COMPARE 168 @ZA15388 16584603
         BL    DCBP055            IF LESS THAN 168 TO COPY NAME@ZA15388 16584803
         XR    RE,RE              CLEAR REGISTER               @ZA15388 16584903
         LH    RE,SIOT+SIODSNTE-INDMSIOT  OBTAIN OFFSET        @ZA15388 16585003
         SH    RE,DSNTLEN         SUBTRACT 168 FROM OFFSET     @ZA15388 16585403
         STH   RE,SIOT+SIODSNTE-INDMSIOT STORE ADJUSTED OFFSET @ZA15388 16585603
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ               @ZA15388 16585803
         LA    RF,JFCBX           GET ADDR OF READ IN AREA     @ZA15388 16586003
         ST    RF,DD0(R5)         STORE IN REMOTE PARM LIST    @ZA15388 16586203
         MVC   DD4(DD3,R5),JFCBX+DSNTNSVA-DSNTABLE             @ZA15388 16586403
*                                 GET TTR OF NEXT DSNT         @ZA15388 16586603
         BALR  RE,R6              GO TO Q MNGR TO READ DSNT    @ZA15388 16586803
         B     DCBP053            CHECK FOR CORRECT DSNT       @ZA15388 16587003
DCBP055  DS    0H                 THIS IS THE CORRECT DSNT     @ZA15388 16587203
         LA    RF,JFCBX+DSNENTRY-DSNTABLE GET ADDR OF 1ST ENTRY@ZA15388 16587403
         XR    R3,R3              CLEAR REGISTER               @ZA15388 16587603
         LH    R3,SIOT+SIODSNTE-INDMSIOT OBTAIN OFFSET TO ENTRY@ZA15388 16587803
         AR    R3,RF              R3 HAS ADDR OF NAME          @ZA15388 16588003
         BCTR  R3,R0              R3 HAS ADDR WHERE LENGTH     @ZA15388 16588203
*                                 BYTE MUST BE MOVED           @ZA15388 16588403
         MVC   DD0(DD1,R3),SIOT+SIODDSNL-INDMSIOT  MOVE LENGTH @ZA15388 16588603
         XR    R2,R2              CLEAR REGISTER               @ZA15388 16588803
         IC    R2,DD0(R3)         R2 HAS LENGTH VALUE          @ZA15388 16589003
         BAL   RE,DSNTP           PROCESS DSNT                 @ZA15388 16589203
         LM    R2,R3,DDWA7        RESTORE REGISTERS            @ZA15388 16589403
         B     DCBP04             GO TO GET NEXT KEY           @ZA15388 16589603
DCBP03   DS    0H                                              @ZA15388 16591603
         MVC   SIOT+SIODDSNL-INDMSIOT(DD1),JFCBX+SIODDSNL-INDMSIOT      16591803
*              MOVE DCB DSNAME LENGTH TO NEW SIOT               YA02512 16592002
DCBP04   DS    0H                 ENTER                                 16600000
         BALR  RE,R9              GO TO GET KEY.                        16620000
         B     DCBP04             LOOP BACK.                            16640000
DCBP06   DS    0H                 ENTER                                 16660000
         MVI   MSGSEC,ERMES43     IMPROPER QUALIFICATION.               16680001
         B     CLEANUP            GO TO CLEANUP.                        16700000
DCBP08   DS    0H                                                  AABA 16700216
         MVI   MSGSEC,ERMES40     EXCESSIVE PARAMETER              AABA 16700401
         B     CLEANUP                                             AABA 16700616
DCBP10   DS    0H                                                 18769 16700717
         MVI   MSGSEC,ERMES45                                     18768 16700801
         B     CLEANUP                                            18768 16700917
DSNTLEN  DC    H'168'    LENGTH OF DATA SET NAME AREA          @ZA15388 16701103
*                        IN DSNT                               @ZA15388 16701303
         EJECT                                                          16701803
*              **************************************************  AAAA 16702015
*              *                                                *  AAAA 16703015
*              *    LRECL PROCESSING RTN                        *  AAAA 16704015
*              *                                                *  AAAA 16705015
*              **************************************************  AAAA 16706015
         SPACE 1                                                        16706401
********* SPECIAL PROCESSING FOR LRECL=X SPECIFICATION.                 16706801
         SPACE 2                                                        16707015
LRECLP   DS    0H                                                  AAAA 16708015
         CLI   1(R3),JLRECLX      IS THIS THE EXCEPTION PARAMETER  AAAA 16710015
         BNE   DDNORM             NO PROCESS AS NORMAL             AAAA 16711015
         CLI   0(R3),JLRECLXN      ONE CHARACTER                   AAAA 16712015
         BNE   DDNORM              NO -TRANSFER                    AAAA 16713015
         XC   JFCB+JFCLRECL-INFMJFCB(DD2),JFCB+JFCLRECL-INFMJFCB        16713401
*              CLEAR THE TWO BYTE LRECL INDICATOR FIELD.                16713801
         OI    JFCB+JFCLRECL-INFMJFCB,DD128  SET HIGH ORDER BIT ON.     16714201
         BALR  RE,R9              GO TO GET KEY                    AAAA 16715015
         EJECT                                                          16720000
*              **********************************************           16740000
*              *                                            *           16760000
*              *    GENERAL DCB MINOR KEYWORD PROCESSING    *           16780000
*              *                                            *           16800000
*              **********************************************           16820000
         SPACE 1                                                        16830001
********* FIRST POSITION IN PDT CLEARS JFCB BYTE WHERE INDICATOR WILL   16832001
********* BE PLACED.PDT IS UPDATED TO NEXT POSITION.ONLY ONE PARAMTER   16834001
********* PER KEYWORD IN THIS SECTION.                                  16836001
         SPACE 2                                                        16840000
DCBNORM  DS    0H                         ENTRY                  YM2366 16850001
TRTCHP   DS    0H                 PROCESS TRTCH                         16860000
STACKP   DS    0H                         STACK                         16880000
PRTSPP   DS    0H                         PRTSP                         16900000
MODEP    DS    0H                         MODE                          16920000
EROPTP   DS    0H                         EROPT                         16940000
DENP     DS    0H                         DEN                           16980000
CODEP    DS    0H                         CODE                          17000000
BFALNP   DS    0H                         BFALN                         17020000
CPRIP    DS    0H                                                   696 17040000
HIARCHYP DS    0H                                                  AABA 17055016
         BALR  RE,R8              CLEAR BYTE IN JFCB                    17060000
         SR    R1,R1                                                    17080000
         IC    R1,0(R4)           COUNT BYTE IN PDT                     17100000
         LA    R4,0(R1,R4)        BUMP TEST AND STORE POINTER           17120000
         BALR  RE,R8              SET BITS                              17140000
         BALR  RE,R9              GET KEY                               17160000
         EJECT                                                          17160401
*        ********************************************************YM2366 17162001
*        *                                                      *YM2366 17164001
*        *                DSORG PROCESSING                      *YM2366 17166001
*        *                                                      *YM2366 17168001
*        ********************************************************YM2366 17168401
         SPACE 1                                                        17168801
DSORGP   DS    0H                                                YM2366 17169201
         CLC   1(2,R3),JDSORGGS  IS THIS THE GS VALUE?           YM2366 17169601
         BNE   DCBNORM           NO, CHECK FOR OTHER ACCEPTABLE  YM2366 17169701
*                                VALUES                          YM2366 17171701
         OI    JFCB+JFCDSRG2-INFMJFCB,JFCORGGS YES, SET INDICATORYM2366 17174001
         BALR  RE,R9             GO TO GET KEY                   YM2366 17176001
JDSORGGS DC    C'GS'             GS IS VALID VALUE FOR DCB=DSORG YM2366 17176401
         EJECT                                                          17178001
*        ********************************************************Y01113 17180001
*        *                                                       Y01113 17182001
*        *             AMP KEYWORD PROCESSING ROUTINE            Y01113 17184001
*        *                                                       Y01113 17186001
*        ********************************************************Y01113 17188001
         SPACE 2                                                        17190001
AMPP     DS    0H                                                Y01113 17192001
         L     RF,DIENB901         GET AMP PROCESSOR ADDRESS     Y02668 17194002
         BALR  RE,RF               GO TO PROCESS AMP PARM.       Y02668 17195002
         BALR  RE,R9               GO TO GET KEY                 Y02668 17196002
         EJECT                                                          17198001
*              **************************************************       17200000
*              *                                                *       17220000
*              *         DD KEYWORD PROCESSING ROUTINE          *       17240000
*              *                                                *       17260000
*              **************************************************       17280000
         SPACE 2                                                        17300000
DDP      DS    0H                 PROCESS DD KEY.                       17320000
         TM    SWD,FEXRCV         HAS FIRST EXEC CARD BEEN RECEIVED?    17330001
         BO    DDP02              YES,CONTINUE PROCESSING.              17340001
         CLC   DD0(DD7,R3),DDP10   IS LABEL JOBLIB                 163  17360000
         BC    EQUAL,DDP01        YES TRANSFER.                         17380000
*                                                                  AACA 17382017
         CLC   DD0(DD7,R3),DDP20   IS LABEL SYSCHK                 AACA 17384017
*      IF THE FIRST EXEC RCVD SW IS OFF THEN THE FOLLOWING IS TRUE      17386017
*        .  NO RESTART=  KEYWORD WAS ENCOUNTERED ON THE JOB STMT        17388017
*        .  NO PGM=IEFDSDRP STEP GENERATED BY CONVERTER         YM02717 17390002
*        .  THE SYSCHK DD STMT IS TO BE IGNORED BY THIS RTN             17392017
*                                                                  AACA 17394017
         BE    CLEAN156            YES, IGNORE DD, BYPASS       YM02717*17396002
                                   CREATING SIOT.               YM02717 17397002
         CLC   DD0(DD7,R3),DDP17  IS LABEL JOBCAT                Y01113 17398001
         BE    DDP05              IF YES, BRANCH TO PROCESS      Y01113 17398401
         LTR   R2,R2              IS LENGTH OF LABEL NOT ZERO.          17400000
         BC    NOT-ZERO,DDP12     YES TRANSFER ERROR.                   17420000
         TM    SWE,PROC           IS DD CARD IN PROC?          @ZA14276 17423003
         BO    DDP12              YES, TRANSFER ERROR          @ZA14276 17425003
         TM    DDSWX1,IWAJCAT     IF JOBCAT SW ON GO TO PROCESS  Y01113 17430001
         BO    DDP051             BRANCH IF ON.                  Y01113 17435001
         TM    JCT+JCTJBLBS-INJMJCT,JBLBSW  JOBLIB BEEN ENCOUNTERED.?   17440001
*                                 A CARD WITHOUT A NAME HAS BEEN READ.  17445001
         BZ    DDP12              NO-CANNOT BE JOBLIB CONCATINATION.    17450001
         SPACE 1                                                        17452001
********* A CONCATENATION TO A JOBLIB HAS BEEN ENCOUNTERED.             17454001
********* UPDATE JOBLIB COUNT AND MAKE SIOT REFLECT FACT.               17456001
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTCCAT   CONCAT DD CARD  Y02668 17457002
*              HAS BLANK DD NAME BIT ON IN IT.                   Y02668 17458002
         SR    R1,R1              CLEAR REGISTER.                       17460000
         IC    R1,JBCONCAT        GET JOBLIB COUNT.                     17480001
         LA    R1,DD1(R1)         ADD ONE.                              17500000
         STC   R1,JBCONCAT        SAVE JOBLIB COUNT.                    17520001
         OI    SIOT+SCTSBYT2-INDMSIOT,SCTJOBLB SET JOBLIB BIT / SIOT    17540000
         B     DDP07              TRANSFER.                             17560000
DDP01    DS    0H                 ENTER FOR JOBLIB                      17580000
         TM    SWE,PROC+PRCV   BRANCH IF JOBLIB IS IN A PROC   @ZA32059 17586003
         BC    NOT-ZERO,DDP14                                  @ZA32059 17591003
         TM    JCT+JCTJBLBS-INJMJCT,JBLBSW  JOBLIB ALREADY FOUND.?      17602001
         BO    DDP14              YES ISSUE ERROR MSG IEF636I           17604001
         TM    DDSWX1,IWAJCAT     IS JOBCAT BEFORE JOBLIB        Y01113 17610001
         BO    DDP14              YES- ISSUE ERROR MSG IEF636I.         17612001
         TM    SWY2,DYNAMSW        DD DYNAM FOR JOBLIB?         YM02717 17613002
         BO    DDP03               YES,BYPASS JOBLIB PROCESSING YM02717 17614002
*                                  AS NO SIOT BUILT FOR DYNAM.  YM02717 17615002
*                                  JOBLIB PROCESSING REQUIRES   YM02717 17616002
*                                  A SIOT.                      YM02717 17617002
         OI    JCT+JCTJBLBS-INJMJCT,JBLBSW  TURN ON JOBLIB FOUND SW.    17622001
         MVI   JBCONCAT,DD1         SET JOBLIB COUNT                    17640001
         MVC   TJOBLIB(DD4),TSIOT SAVE JOBLIB TTR                       17660000
         OI    SIOT+SCTSBYT2-INDMSIOT,SCTJOBLB SET JOBLIB BIT / SIOT    17680000
         B     DDP03              TRANSFER                              17700000
DDP02    DS    0H                 ENTER FOR FIRST EXEC RECEIVED.        17720000
         CLC   DD0(DD7,R3),DDP17  IS LABEL JOBCAT                Y01113 17730001
         BC    EQUAL,DDP19        IF YES, MISPLACED JOBCAT ERROR Y01113 17732001
         CLC   DD0(DD7,R3),DDP10   IS LABEL JOBLIB                 163  17740000
         BC    EQUAL,DDP14        YES TRANSFER ERROR.                   17760000
         CLC   DD0(DD8,R3),DDP18  IS LABEL STEPCAT               Y01113 17770001
         BNE   DDP021             IF NO, BYPASS                  Y01113 17772001
         TM    DDSWX1,IWASCAT2  IF BIT IS ON THIS IS A DUPLICATE Y01113 17772401
         BO    DDP21            GO PUT OUT WARNING MSG CODE      Y01113 17773201
         MVC   SCT+SCTPCAT-INSMSCT(DD4),TSIOT   INIT DISK @      Y02668 17775202
         OI    DDSWX1,IWASCAT     SET STEPCAT PVT CAT SWITCH IWA.Y01113 17776401
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTJSCT  TURN ON JOBCAT,  Y02113 17776802
*              STEPCAT ASSOCIATION BIT FOR AM/0 D.S.             Y02113 17777202
         OI    SIOT+SCTSBYT2-INDMSIOT,SIOTCATL  TURN ON          Y02113 17777602
*              CATALOG AM/0 DATA SET BIT                         Y02113 17778002
         OI    DDSWX1,IWASCAT2    SET SW, CLEARED IN VEA         Y01113 17778401
         MVI   SCT+SCTCATCT-INSMSCT,DD0 ZERO FIRST BYTE          Y02668 17780402
         MVI   SCT+SCTCATCT-INSMSCT+1,DD1 START CONCAT COUNT     Y02668 17780602
         NI    SCT+SCTSTYPE-INSMSCT,255-SCTJSCAT  JOBCAT BIT OFF Y01113 17780801
         B     DDP023             CONTINUE TO PROCESS DD VERB    Y01113 17780901
DDP021   DS    0H                                                Y01113 17781201
         LTR   R2,R2              IS LABEL LENGTH ZERO?          Y01113 17781601
         BNZ   DDP022             Â¬ ZERO MEANS NO CONCATENATIONS Y01113 17781701
         TM    DDSWX1,IWASCAT     IS STEPCAT SWITCH ON?          Y01113 17785802
         BZ    DDP021A       NORMAL DD CONCATENATION-CONTINUE    Y02668 17787802
         SR    R1,R1              CLEAR REG TO INCREMENT STEPCAT Y01113 17792001
         LH    R1,SCT+SCTCATCT-INSMSCT GET CAT COUNT             Y02668 17794002
         LA    R1,DD1(R1)         INCREMENT COUNT BY 1           Y01113 17795002
         STH   R1,SCT+SCTCATCT-INSMSCT RESTORE UPDATED COUNT     Y02668 17796002
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTJSCT  TURN ON JOBCAT,  Y02113 17797002
*              STEPCAT ASSOCIATION BIT FOR AM/0 D.S.             Y02113 17798002
         OI    SIOT+SCTSBYT2-INDMSIOT,SIOTCATL  TURN ON          Y02113 17799002
*              CATALOG AM/0 DATA SET BIT                         Y02113 17800002
         B     DDP023    CONTINUE TO PROCESS DD VERB..           Y01113 17801002
DDP021A  DS    0H      NORMAL DD CONCATENATION PROCESS CODE.     Y02668 17802002
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTCCAT   CONCAT DD CARD  Y02668 17803002
*              HAS BLANK DD NAME BIT ON IN IT.                   Y02668 17804002
         B     DDP023    CONTINUE TO PROCESS DD VERB..           Y02668 17805002
DDP022   DS    0H  ENTRY TO TURN OFF STEPCAT SWITCH              Y01113 17806002
         NI    DDSWX1,255-IWASCAT  TURN OFF AT END OF CONCAT.    Y01113 17807002
DDP023   DS    0H                 CONTINUE PROCESSING DD VERB    Y01113 17814001
         TM    SWD,FDDRCV         HAS FIRST DD BEEN RECEIVED?           17816401
         BO    DDP04              YES,BRANCH TO CONTINUE.               17816801
DDP03    DS    0H                 ENTER.                                17818001
         OI    SWD,FDDRCV         SET FIRST DD RECEIVED SWITCH.         17850001
         NI    SDDNSWA,255-SDDNSW CLEAR SEARCH DDNAME TABLE SWITCH.     17852001
         XC    DNRT(SCT-DNRT),DNRT ZERO DDNAME TABLE                    17860000
         LTR   R2,R2              IS LABEL LENGTH ZERO.                 17880000
         BC    ZERO,DDP13         YES TRANSFER ERROR.                   17900000
         B     DDP07              TRANSFER                              17920000
DDP04    DS    0H                 ENTER FOR FIRST DD RECEIVED           17940000
         LTR   R2,R2              IS THE NAME ZERO LENGTH          AAAA 17946015
         BZ    DDP07              TRANSFER ZERO                    AAAA 17952015
         TM    SDDNSWA,SDDNSW     SEARCH DDNAME TABLE SWITCH ON?        17962001
         BZ    DDP07              NO,GO TO SET UP NEW SIOT AND JFCB.    17972001
         XC    DDWA7(8),DDWA7     CLEAR DDNAME WORK AREA                17980001
         BCTR  R2,R0              DECREMENT LENGTH                      18000000
         EX    R2,DDNAMEP3        MOVE NAME TO WORK AREA                18020000
         LA    R2,1(R2)           RESTORE LENGTH                        18040000
         BAL   RE,DDNAMEPA        IS NAME IN TABLE                      18060000
         B     DDP06              YES                                   18080000
         B     DDP07              NO                                    18100000
*****************************************************************Y01113 18102001
*        *          PROCESS JOBCAT LABEL FIRST TIME              Y01113 18104001
*****************************************************************Y01113 18106001
DDP05    DS    0H                 ENTRY TO PROCESS JOBCAT LABEL  Y01113 18110001
         TM    SWY2,DYNAMSW        DD DYNAM FOR JOBCAT?         YM02717 18110302
         BO    DDP03               YES,BYPASS JOBCAT PROCESSING YM02717 18110602
*                                  AS NO SIOT BUILT FOR DYNAM.  YM02717 18110902
*                                  JOBCAT PROCESSING REQUIRES   YM02717 18111202
*                                  A SIOT.                      YM02717 18111502
         TM    SWE,PROC           IS JOBCAT FROM A PROC?         Y01113 18112001
         BO    DDP19              IF YES, MISPLACED JOBCAT MSG   Y01113 18114001
         TM    DDSWX1,IWAJCAT     SWITCH ON MEANS PRIOR JOBCAT.  Y01113 18116001
         BO    DDP19              ON,ERROR CONDITION.            Y01113 18118001
         OI    DDSWX1,IWAJCAT     TURN ON JOBCAT SWITCH.         Y01113 18119301
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTJSCT  TURN ON JOBCAT,  Y02113 18120002
*              STEPCAT ASSOCIATION BIT FOR AM/0 D.S.             Y02113 18120702
         OI    SIOT+SCTSBYT2-INDMSIOT,SIOTCATL  TURN ON          Y02113 18121402
*              CATALOG AM/0 DATA SET BIT                         Y02113 18122102
         OI    SIOT+SIOTALTD-INDMSIOT,SIOJCATS  SET SIOT SW      Y01113 18123101
         MVI   IWACATCT,DD1       INIT COUNT OF JOBCAT P.C. IN   Y01113 18124401
*                   IWA SO THAT IT MAY BE PUT INTO EVERY SCT     Y01113 18125701
         MVC   IWAJSIOT,TSIOT     SAVE DISK @ OF JOBCAT SIOT     Y01113 18127001
         B     DDP03              CONTINUE TO PROCESS DD VERB    Y01113 18128301
DDP051   DS    0H                 PROCESS CONCATENATED JOBCATS   Y01113 18129601
         SR    R1,R1              CLEAR REG TO INCREMENT JCAT CT Y01113 18130901
         IC    R1,IWACATCT        GET COUNT FROM IWA             Y01113 18132201
         LA    R1,DD1(R1)         ADD ONE TO COUNT               Y01113 18133501
         STC   R1,IWACATCT        SAVE UPDATED COUNT IN IWA      Y01113 18134801
         OI    SIOT+SIOTALTD-INDMSIOT,SIOJCATS  SET SIOT SW      Y01113 18136101
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTJSCT  TURN ON JOBCAT,  Y02113 18136602
*              STEPCAT ASSOCIATION BIT FOR AM/0 D.S.             Y02113 18137102
         OI    SIOT+SCTSBYT2-INDMSIOT,SIOTCATL  TURN ON          Y02113 18137602
*              CATALOG AM/0 DATA SET BIT                         Y02113 18138102
         B     DDP07              CONTINUE TO PROCESS DD VERB    Y01113 18138701
DDP06    DS    0H                 ENTRY FOR FOUND DDNAME.               18140001
         OI    DDWA2,JDICTI3      SET DDNAME SWITCH IN LWA ON.          18150001
         MVC   DD4(DD3,R5),DD8(R1) PUT SIOT TTR IN REMOTE LIST.         18160000
         MVC   DD12(DD3,R5),DD11(R1) PUT JFCB TTR IN REMOTE LIST.       18180000
         XC    DD0(DD14,R1),DD0(R1) ZERO ENTRY IN DDNAME TABLE          18200000
         LA    R0,SIOT            GET ADDRESS OF SIOT TABLE             18220000
         ST    R0,DD0(R5)         PUT SIOT ADDRESS IN REMOTE LIST       18240000
         LA    R0,JFCB            GET ADDRESS OF JFCB TABLE             18260000
         ST    R0,DD8(R5)         PUT JFCB ADDRESS IN REMOTE LIST       18280000
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                        18300000
         MVI   QPARM+QMPNC-QMNAM,DD2*DD1 SET FOR TWO READS.             18320000
         BALR  RE,R6              GO TO Q MANAGER                       18340000
         NI    SIOT+SCTSBYT1-INDMSIOT,DD255-SCTDUMMY                    18360001
*                                 CLEAR DUMMY BIT IN SIOT.              18370001
         MVI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK CLEAR NULLFILE            18380000
         MVC   JFCB+JFCBDSNM-INFMJFCB+DD1(7),JFCB+JFCBDSNM-INFMJFCB     18400000
         B     AOLKDP39      STORE DD NAME INTO SIOT           @ZM40101 18420003
DDP07    DS    0H                 ENTER TO SETUP NEW SIOT & JFCB        18500000
*                                 SIOT AND JFCB WERE CLEARED IN         18520000
*                                 HEADER INITIALIZATION ROUTINE.        18540000
         MVI   SIOT+SIOTTYPE-INDMSIOT,SIOTID    SET SIOT ID.            18560001
         MVI   DDWA2,JDICTI1      SET DICTIONARY INDICATOR BIT          18580001
         LA    R1,DD8             GET LENGTH TO DICTIONARY DDNAME.      18600000
         AR    R1,R2              COMPUTE LENGTH BYTE.                  18620000
         STC   R1,DDWA1           SET DICTIONARY LENGTH BYTE            18640001
         TM    SWY2,DYNAMSW        IS THIS A DD DYNAM?           Y02668 18645002
         BO    AODDP10             YES, BYPASS STATIC DD CODE.  YM02717 18650002
         LH    R1,DDINTNO         GET DD INTERNAL NUMBER         Y02668 18660002
         LH    RF,DDLIMIT         GET 1635                       Y02668 18680002
         CLR   R1,RF              IS DD INTERNAL EQUAL 1635      Y02668 18700002
         BC    EQUAL,DDP15        YES TRANSFER ERROR             Y02668 18720002
         LA    R1,DD1(R1)         BUMP DD INTERNAL NUMBER ONE           18740000
         STH   R1,DDINTNO         SAVE NUMBER.                   Y02668 18760002
         STH   R1,SCT+SCTLALOC-INSMSCT     PUT NUMBER IN SCT.    Y02668 18780002
         STH   R1,SIOT+SCTDDINO-INDMSIOT   PUT NUMBER IN SIOT.   Y02668 18800002
         MVI   SIOT+SCTDDNAM-INDMSIOT,DDBLANK BLANKS                    18840000
         MVC   SIOT+SCTDDNAM-INDMSIOT+1(DD7),SIOT+SCTDDNAM-INDMSIOT     18860000
         MVC   SIOT+SCTANAME-INDMSIOT(DD8),SIOT+SCTDDNAM-INDMSIOT  I242 18870018
         MVC   SIOT+SIOTDEST-INDMSIOT(DD8),SIOT+SCTANAME-INDMSIOT       18873002
*                                 NLANK DEST FIELD               Y02668 18876002
         MVI   SIOT+SCTUTYPE-INDMSIOT,DDBLANK BLANKS                    18880000
         MVC   SIOT+SCTUTYPE-INDMSIOT+1(DD20),SIOT+SCTUTYPE-INDMSIOT    18900000
         MVI   SIOT+SIOTOUTC-INDMSIOT,DD1 INIT COPIES FIELD TO 1 Y02668 18908002
         MVI   SIOT+SIOTSSNM-INDMSIOT,DDBLANK                    Y02668 18916002
         MVC   SIOT+SIOTSSNM-INDMSIOT+1(DD3),SIOT+SIOTSSNM-INDMSIOT     18924002
*                                 INIT SUBSYSTEM FIELD TO BLANKS Y02668 18932002
         MVI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK BLANKS.                   18960000
         MVC   JFCB+JFCBDSNM-INFMJFCB+1(DD51),JFCB+JFCBDSNM-INFMJFCB    18980000
         MVI   JFCB+JFCBVOLS-INFMJFCB,DDBLANK BLANK.                    19000000
         MVC   JFCB+JFCBVOLS-INFMJFCB+DD1(DD29),JFCB+JFCBVOLS-INFMJFCB  19020000
*    INITIALIZE JFCBE CHARACTER FIELDS TO BLANKS...            @Z40MPTH 19023003
AOLKDP39 MVC   JFCBEX+JFCBMAGT-INGMJFCE(L'JFCBMAGT+L'JFCMODIF),BLANK16  19026003
*                                                              @ZM40101 19029003
         MVC   JFCBEX+JFCBTRS1-INGMJFCE(L'JFCBTRS1+L'JFCBTRS2+L'JFCBTRS*19032003
               3+L'JFCBTRS4),BLANK16                           @Z40MPTH 19035003
         CLI   MSGSEC,DD0          IS THERE AN ERROR               163  19040000
         BNE   CLEANUP             YES GO TO CLEANUP               163  19060000
*****************************************************************Y02668 19062002
* ESTABLISH ADDRESSABILITY TO CURRENT TEXT STRING PREFIX        *Y02668 19064002
* IN ORDER TO USE DSECT FOR TEXT PREFIX.                        *Y02668 19066002
*****************************************************************Y02668 19068002
AOLKDP40 DS    0H                                                Y02028 19069002
         L     R3,TEXTBUFP         GET ADDR OF NEXT TEXT STRING. Y02668 19070002
         USING TEXT,R3             TEXT PREFIX ADDRESSABILITY.   Y02668 19072002
         TM    STRDINDC,DTXSYSIN   IS THIS A DD */DATA STMT?    YM01605 19077002
         BZ    AOLKDP45            BRANCH NO.                    Y02668 19082002
         DROP  R3                                                Y02668 19083002
* SET SPOOL FLAGS IN JCT, SCT, JFCB.                             Y02668 19084002
         OI    JCT+JCTSTAT2-INJMJCT,JCTSPSYS SPOOL FLAG - JCT.   Y02668 19086002
         OI    SCT+SCTSTAT2-INSMSCT,SCTSPSYS SPOOL FLAG - SCT.   Y02668 19088002
*                                  SET SYSIN BIT IN JFCB AND     Y02668 19090002
         OI    JFCB+JFCBTSDM-INFMJFCB,JDDT5+JDDT1 TELL OPEN NOT  Y02668 19091002
         OI    JFCB+JFCBIND2-INFMJFCB,JDDT6       TO WRITE JFCB  Y02668 19092002
         OI    SIOT+SCTSBYT1-INDMSIOT,SCTSYSIN+SCTSPMNT TO QUEUE.Y02668 19094002
         OI    SIOT+SIOTBYT0-INDMSIOT,SIOTSSDS SUBSYSTEM WILL    Y02668 19094602
*                                     PROCESS THIS DATA SET      Y02668 19095202
AOLKDP45 DS    0H                                                Y02668 19100002
         L     R3,TLENPX           RESTORE PTR FOR VGT.          Y02668 19102002
         OI    JFCB+JFCBLTYP-INFMJFCB,JFCSL     SET LABEL=SL DEFAULT    19210001
         TM    DDWA2,JDICTI3       DDNAME PROCESSING SW ON?     YM00375 19211002
         BO    AODDP10             YES, DON'T MOVE DDNAME OF    YM00375 19212002
*                                  REFERENCED DD TO SIOT, WHICH YM00375 19213002
*                                  ALREADY CONTAINS DDNAME OF   YM00375 19214002
*                                  REFERRING DD (I.E.,          YM00375 19215002
*                                  //SYSLIN  DD  DDNAME=SYSIN). YM00375 19216002
         BALR  RE,R8              GO TO TEST & STORE                    19220000
AODDP10  DS    0H                                               YM00375 19230002
         BALR  RE,R9              GO TO GET KEY                         19240000
DDP10    DS    0H                 NO ENTRY                              19280000
         DC    X'06'               FOR JOBLIB COMPARE              163  19300000
         DC    C'JOBLIB'          FOR COMPARE                           19320000
DDP12    DS    0H                 ENTER                                 19380000
         MVI   MSGSEC,ERMES06     IMPROPER LABEL.                       19400001
         B     DDP16                                               163  19420000
DDP13    DS    0H                 ENTER.                                19440000
         MVI   MSGSEC,ERMES17     IMPROPER NULL LABEL                   19460001
         B     DDP16                                               163  19480000
DDP14    DS    0H                 ENTER                                 19500000
         MVI   MSGSEC,ERMES36     IMPROPER JOBLIB                       19520001
         B     DDP16                                               163  19540000
DDP15    DS    0H                 ENTER                                 19560000
         OI    AOSW2,AOMAXERR     TURN ON MAX DD EXCEEDED BIT    Y02668 19580002
         MVI   MSGSEC,ERMES49     1636 DD VERB                   Y02668 19590002
         MVI   MSGKEY,DD0          CLEAR SECOND MSG                325  19600000
         B     CLEANUP               SIOT BUILT, GO TO CLEANUP     325  19620000
DDP16    DS    0H                                                  163  19640000
         MVI   MSGKEY,DD0          CLEAR SECOND MSG                163  19660000
          B     DDP07              BUILD SIOT ANS JFCB             163  19680000
DDP17    DS    0H                                                Y01113 19682001
         DC    X'06'              FOR COMPARE OF TEXT LENGTH BYTEY01113 19684001
         DC    C'JOBCAT'          AND DDNAME LABEL.              Y01113 19684401
DDP18    DS    0H                                                Y01113 19684801
         DC    X'07'              FOR COMPARE OF TEXT LENGTH BYTEY01113 19684901
         DC    C'STEPCAT'         AND DDNAME LABEL.              Y01113 19690701
DDP19    DS    0H                                                Y01113 19692701
         MVI   MSGSEC,ERMES133    CODE FOR MISPLACED JOBCAT MSG  Y01113 19694701
         B     DDP16              CONTINUE PROCESSING            Y01113 19696701
DDP20    DS    0H                                                  AAAA 19696801
         DC    X'06'                                               AAAA 19702601
         DC    C'SYSCHK'           SYSCHK COMPARE                  AAAA 19708401
DDP21    DS    0H                                                Y01113 19710401
         MVI   DWRNMSG,ERMES134    DUPLICATE STEPCAT WARNING     Y01113 19712401
         MVI   DWRNKEY,DD0        FLAG NO SECONDARY MSG          Y01113 19712501
         B     DDP07              DO NOT USE DUPLICATE STEPCAT   Y01113 19712801
*                                 FOR PRIVATE CATALOG, CONTINUE. Y01113 19713201
         EJECT                                                          19714201
*              **************************************************       19720000
*              *                                                *       19740000
*              *       DDNAME KEYWORD PROCESSING ROUTINE        *       19760000
*              *                                                *       19780000
*              **************************************************       19800000
         SPACE 2                                                        19820000
DDNAMEP  DS    0H                 PROCESS DDNAME KEY.                   19840000
         LTR   R2,R2              IS LENGTH ZERO                        19860000
         BC    ZERO,DDNAMEP4      YES  ERROR                            19880000
         CLI   DD0(R3),DD8        IS LENGTH GREATER THAN 8              19900000
         BC    HIGH,DDNAMEP5      YES  ERROR                            19920000
         XC    DDWA7(8),DDWA7     CLEAR DDNAME WORK AREA                19940001
         BCTR  R2,R0                                                    19960000
         EX    R2,DDNAMEP3        MOVE NAME TO DD WORK AREA             19980000
         BAL   RE,DDNAMEPA        SEARCH DDNAME TABLE                   20000000
         B     DDNAMP61           ERROR  DUPLICATE DDNAMES              20020000
         XC    DDWA7(8),DDWA7     SET FIELD TO ZERO                     20040001
         BAL   RE,DDNAMEPA        FIND EMPTY SLOT IN TABLE              20060000
         B     DDNAMEP2           THERE IS ROOM                         20080000
         B     DDNAMEP6           NO ROOM - ERROR                       20100000
DDNAMEP2 DS    0H                 ENTRY FOR ROOM IN TABLE               20120000
         EX    R2,DDNAMEP8        MOVE DDNAME TO TABLE                  20140000
* TEST IF CURRENT DD CONTAINS DDNAME= . IF THE SEQUENCE IS       A27239 20141019
*                     //DD1  DD  DDNAME=DD2                      A27239 20142019
*                     //DD2  DD  DDNAME=DD3                      A27239 20143019
* CARRY OVER THE TTR'S FOR DD1 TO DD2, SINCE NO NEW SIOT WILL    A27239 20144019
* BE CREATED FOR DD2                                             A27239 20145019
*                                  TEST IF DD2 HAS BEEN          A27239 20146019
         TM    DDWA2,JDICTI3      REFERENCED IN PREVIOUS DDNAME= PARAM  20146401
         BZ    DDNAMEPQ           NO-ENTER TTRS INTO DDNAME TABLE.      20146801
* IT HAS BEEN. MOVE DD1 TTR'S TO THE DNRT ENTRY FOR DD2          A27239 20148019
         MVC   8(DD3,R1),DD4(R5)   FIRST THE SIOT TTR,           A27239 20149019
         MVC   11(DD3,R1),DD12(R5) THEN THE ONE FOR JFCB         A27239 20150019
         B     DDNAMEPR            AND BRANCH                    A27239 20151019
DDNAMEPQ DS    0H                                                A27239 20152019
         MVC   8(DD3,R1),TSIOT    SIOT TTR TO TABLE                     20160000
         MVC   11(DD3,R1),TNEXT+DD4 JFCB TTR TO TABLE                   20180000
DDNAMEPR DS    0H                                                A27239 20190019
         OI    SDDNSWA,SDDNSW     SET DDNAME SEARCH SWITCH IN IWA.      20200001
         MVC   JFCB+JFCBDSNM-INFMJFCB(8),DDNAMEP9 NULLFILE              20220000
         OI    SIOT+SCTSBYT1-INDMSIOT,SCTDUMMY   SET DUMMY BIT          20240001
         BALR  RE,R9                                                    20260000
DDNAMEP3 DS    0H                                                       20280000
         MVC   DDWA7(DD0),DD1(R3) EXECUTED MOVE                         20300001
DDNAMEP4 DS    0H                                                       20320000
         MVI   MSGSEC,ERMES46     NULL OPERAND                          20340001
         B     CLEANUP                                                  20360000
DDNAMEP5 DS    0H                                                       20380000
         MVI   MSGSEC,ERMES42     GREATER THAN 8 CHARS                  20400001
         B     DDNAMEP7                                                 20420000
DDNAMP61 DS    0H                                                       20440000
         MVI   MSGSEC,ERMES54                                           20460001
         B     DDNAMEP7                                                 20480000
DDNAMEP6 DS    0H                                                       20500000
         MVI   MSGSEC,ERMES31     DUPLICATE DDNAMES                     20520001
DDNAMEP7 DS    0H                                                       20540000
         MVI   MSGKEY,DD0                                               20560000
         B     CLEANUP                                                  20580000
DDNAMEP8 DS    0H                 EXECUTED                              20600000
         MVC   0(0,R1),DD1(R3)    MOVE NAME TO TABLE                    20620000
DDNAMEPD DC    X'08'               LENGTH OF NULL FILE CONSTANT    AACA 20630017
DDNAMEP9 DC    C'NULLFILE'                                              20650017
*                                                                       20680000
*     ROUTINE USED TO SEARCH DDNAME TABLE FOR DDNAME OR ZEROES          20700000
*                                                                       20720000
DDNAMEPA DS    0H                 ENTRY TO SEARCH TABLE                 20740000
         LA    R1,DNRT            ADDRESS OF DDNAME TABLE               20760000
         LA    RF,DD5             SET LOOP FOR 5                        20780000
DDNAMEPB DS    0H                 ENTRY FOR LOOP                        20800000
         CLC   0(8,R1),DDWA7      COMPARE TABLE TO WORK AREA            20820001
         BC    EQUAL,DDNAMEPC                                           20840000
         LA    R1,14(R1)                                                20860000
         BCT   RF,DDNAMEPB        LOOP BACK                             20880000
         LA    RE,4(RE)           NOT IN TABLE - RETURN NSI PLUS 4      20900000
DDNAMEPC DS    0H                 ENTRY FOR HIT IN TABLE                20920000
         BR    RE                 RETURN                                20940000
         EJECT                                                          20950001
*              ************************************************** 21009 20952001
*              *                                                * 21009 20954001
*              *     DLM PROCESSING ROUTINE                     * 21009 20956001
*              *                                                * 21009 20958001
*              ************************************************** 21009 20958401
         SPACE                                                          20958801
DLMP     DS    0H                                                 21009 20959201
         CLI   0(R3),JDLMT1            IS PARM LENGTH = 2 ?       21009 20959601
         BNL   DDNORM                  NORMAL PROCESSING          21009 20959701
         MVI   MSGSEC,ERMES32          FORMAT ERROR               21009 20968001
         B     CLEANUP                                            21009 20972001
         EJECT                                                          20976001
*              **************************************************       20980000
*              *                                                *       21000000
*              *        DSNAME KEYWORD PROCESSING ROUTINE.      *       21020000
*              *                                                *       21040000
*              **************************************************       21060000
         SPACE 2                                                        21080000
DSNAMEP  DS    0H                 PROCESS DSNAME KEY                    21100000
*                                  BYPASS DSNAME IF DUMMY OR      20029 21106020
         TM    DDSWA,DSDUMSW      DYNAM SPECIFIED ON CARD ALREADY.      21116001
         BO    DSNP15             DYNAM OR DUMMY SPECIFIED.BRANCH.      21126001
         OI    DDSWA,DSSYSSW      SET DSNAME SPECIFIED SW IN LWA.       21128001
         L     RF,TEXTBUFP         SET UP ADDRESSABILITY FOR     Y02668 21130002
         USING TEXT,RF             THE TEXT STRING PREFIX        Y02668 21130802
         CLC   DD0(45,R3),DSNMVTOC TRYING TO ACCESS VTOC       @ZA16056 21130903
*                                  DATA SET VIA JCL?           @ZA16056 21131003
         BNE   DSNP01              NO , CONTINUE               @ZA16056 21131103
         MVI   MSGSEC,ERMES67      YES, ILLEGAL DSNAME MSG     @ZA16056 21131203
         B     CLEANUP                                         @ZA16056 21131303
DSNP01   DS    0H                                              @ZA16056 21131403
         TM    STRDINDC,DTXSYOUT   SYSOUT SPECIFIED?             Y02668 21131602
         BO    DSNP14              YES, TAKE BRANCH              Y02668 21132402
         DROP  RF                                                       21133202
         LTR   R2,R2              CHECK FOR ZERO LENGTH           20077 21134017
         BZ    DSNP090            GET NEXT KEY IF ZERO            20077 21136017
         CLC   0(9,R3),DDNAMEPD    DSN=NULLFILE/'NULLFILE'?     YM02716 21136402
         BNE   DSNP1               BRANCH NO.                   YM02716 21136802
         OI    SIOT+SCTSBYT1-INDMSIOT,SCTDUMMY YES, SET DUMMYSW YM02716 21137202
DSNP1    DS    0H                                               YM02716 21137602
         TM    SWI,DSNLIT          IS THIS DSN IN QUOTES           AACA 21138017
         BO    DSNP16              YES, GO DO SPECIAL PROCESSING   AACA 21144017
         SPACE                                                          21150017
         CLI   1(R3),DDAMP        IS FIRST CHAR AMPERSAND          3565 21160316
         BE    DSNP07             TRANS YES                        3565 21160616
*                  SYNTAX CHECK FOR LENGTH                         3565 21160916
         MVC   DDWA7(1),NUMBYTE   NUMBER OF SUBFIELDS            A39041 21161501
         NI    DDWA7,HIOFF        TURN OFF HIGH ORDER BIT        A27935 21161819
         CLI   DD1(R3),DDASTER    IS 1ST CHARACTER AN ASTERISK   A39041 21162001
         BE    DSNP00             YES - BRANCH                   A27935 21162219
         CLI   DDWA7,DD2          MORE THAN TWO SUBFIELDS?       A27935 21162419
         BH    DSNP091            YES - BRANCH TO ERROR MESSAGE  A27935 21162619
DSNP00   DS    0H                                                A27935 21162719
         SR    R0,R0                                               3565 21163019
         IC    R0,DDWA7           SUBFIELD COUNT                   3565 21163319
         SR    RF,RF                                               3565 21163919
         IC    RF,0(R3)           LENGTH OF SUBFIELD               3565 21164219
         LA    R4,1(0,0)          INITIALIZE COUNT OF CHARACTERS   3565 21164519
         LA    R1,1(0,0)          INITIALIZE DISPLACEMENT          3565 21164819
DSNP011  DS    0H                                                  3565 21165119
         LR    R2,R3                                               3565 21165419
         AR    R2,R1              ALLRESS FOR COMPARE              3565 21165719
         CLC   DSNPRD(1),0(R2)    IS CHARACTER A '.'               3565 21166019
         BC    8,DSNP013                                           3565 21166319
         CLI   0(R2),DDAMP        TEST FOR AMPERSAND           @ZA14270 21166403
         BNE   DSNP0113           TRANSFER NOT AN &            @ZA14270 21166803
         MVI   MSGSEC,ERMES27     INCORRECT USE OF AMPERSAND   @ZA14270 21166903
         B     CLEANUP            WRITE MESSAGE                @ZA14270 21167003
DSNP0113 DS    0H                                                       21167103
         CH    R4,DSNP80          EIGHT CHARACTERS                 3565 21167603
         BC    12,DSNP0112                                         3565 21167703
DSNP0110 DS    0H                                                  3565 21167803
         MVI   MSGSEC,ERMES42     EXCESSIVE PARAMETER LENGTH       3565 21167903
         B     CLEANUP            WRITE MESSAGE                    3565 21168003
DSNP0112 DS    0H                                                  3565 21168119
         CR    R1,RF              END OF FIELD                     3565 21168419
         BC    8,DSNP012          GET NEXT FIELD                   3565 21168719
         LA    R4,1(R4)           INCREMENT COUNT                  3565 21169019
         LA    R1,1(R1)           INCREMENT DISPLACEMENT           3565 21169319
         B     DSNP011                                             3565 21169619
DSNP012  DS    0H                                                  3565 21169919
         BCTR  R0,R0              DECREMENT SUBFIELD COUNT         3565 21170219
         BZ    DSNP014                                             3565 21170519
         LA    R3,1(R1,R3)        RESET BASE                       3565 21170819
         LA    R1,1(0)            RESET DISPLACEMENT               3565 21171119
         IC    RF,0(R3)           LENGTH OF NEW SUBFIELD           3565 21171419
         LA    R4,1(0)            RESET COUNT                      3565 21171719
         B     DSNP011                                             3565 21172019
DSNP013  DS    0H                                                  3565 21172319
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTQDSN TURN ON QUALIFIED Y02113 21172402
*              DSN BIT WHEN PERIOD FOUND IN DATA SET NAME.       Y02113 21172502
         CR    R1,RF              END OF FIELD                     3565 21172619
         BC    7,DSNP0132                                          3565 21172919
         MVI   MSGSEC,ERMES24     INCORRECT USE OF PERIOD          3565 21173201
         B     CLEANUP            WRITE MESSAGE                    3565 21173519
DSNP0132 DS    0H                                                  3565 21173819
         LA    R4,1(R1,R3)        ADDRESS OF CHARACTER AFTER '.'   3565 21174119
         CLI   0(R4),DDCA         COMPARE TO CHARACTER 'A'         3565 21174419
         BC    4,DSNP0134         BRANCH IF LESS THAN C'A'         3565 21174719
         CLI   0(R4),DDN0     COMPARE TO CHARACTER '0'             3565 21174819
         BC    4,DSNP0136     BRANCH IF LESS THAN C'0'             3565 21174919
DSNP0134 DS    0H                                                  3565 21175019
         CLI   0(R4),C'$'     TEST FOR NATIONAL CHAR. DOLLAR SIGNPTM617 21175119
         BE    DSNP0136                                          PTM617 21175219
         CLI   0(R4),C'#'    TEST FOR NATIONAL CHAR. POUND SIGN  PTM617 21175319
         BE    DSNP0136                                          PTM617 21175419
         CLI   0(R4),C'@'    TEST FOR NATIONAL CHAR. 'AT' SIGN   PTM617 21175519
         BE    DSNP0136                                          PTM617 21175619
         MVI   MSGSEC,ERMES47     NON-ALPHA FIRST CHARACTER OF NAME3565 21175901
         B     CLEANUP            WRITE MESSAGE                    3565 21176219
DSNP0136 DS    0H                                                  3565 21176519
         LA    R4,1(R0)           RESET COUNT                      3565 21176819
         LA    R1,1(R1)           INCREMENT DISPLACEMENT           3565 21177119
         B     DSNP011                                             3565 21177419
DSNP014  DS    0H                                                  3565 21177719
         LM    R2,R4,TLEN         RESTORE REGISTERS                3565 21178019
         CLI   DD1(R3),DDASTER    IS CHARACTER ASTERICK                 21260000
         BC    EQUAL,DSNP05       YES TRANSFER                          21280000
DSNP02   DS    0H                 ENTER                                 21340000
         BALR  RE,R8              GO TO TEST AND STORE                  21360000
         BALR  RE,R9              GO TO GET KEY                         21380000
         LTR   R2,R2              IS THIS A NULL PARAMETER       A51048 21390001
         BNE   DSNP021            BRANCH IF OK                   A51048 21392001
         MVI   MSGSEC,ERMES46     NULL PARAMETER                 A51048 21394001
         B     CLEANUP                                           A51048 21396001
DSNP021  DS    0H                                                A51048 21398001
         CLI   DD1(R3),DDPLUS     IS CHARACTER PLUS                     21400000
         BC    EQUAL,DSNP03       YES TRANSFER                          21420000
         CLI   DD1(R3),DDMINUS    IS CHARACTER MINUS                    21440000
         BC    EQUAL,DSNP03       YES TRANSFER                          21460000
         CLI   DD1(R3),DDN0       IS CHARACTER ZERO.                    21480000
         BC    NOT-EQUAL,DSNP02   NO TRANSFER                           21500000
DSNP03   DS    0H                 ENTER                                 21520000
         L     R1,ADSNAMT3        RESET POINTER TO PDT                  21540000
         ST    R1,TCPDTP          SAVE PDT POINTER                      21580000
         B     DSNP02             TRANSFER                              21600000
DSNP05   DS    0H                 ENTER FOR REFER BACK.                 21620000
*                                                                       21622017
*  IF ASTERISK IS FOLLOWED BY PERIOD ( *.DD ) WHICH INDICATES           21624017
*      A REFERBACK, THE LENGTH FIELD MUST HAVE A LENGTH OF ONE.         21626017
*    IF NOT LENGTH OF ONE THEN PERIOD MUST BE MISSING.                  21628017
*                                                                       21630017
         CLI   DD0(R3),X'01'                                      18768 21632017
         BNE   DCBP10                                             18768 21634017
         BCTR  R3,R0              DECREMENT TEXT POINTER                21640000
         TM    DD0(R3),DD128      IS THIS A SUBLIST                     21660000
         BZ    DSNP13             NO TRANSFER ERROR.                    21680001
         BALR  RE,R9              GO TO GET KEY                         21700000
         BAL   RE,DSRTN            GO TO DICTIONARY SEARCH RTN     AACA 21720017
         MVI   QPARM+QMPOP-QMNAM,QMREAD    SET READ                     21722018
         MVI   QPARM+QMPNC-QMNAM,DD1      READ SET FOR ONE         I242 21724018
         MVC   DD4(DD3,R5),DD2(R1)    MOVE SIOT TTR TO REMOTE LIST I242 21726018
         LA    RF,JFCBX       ADDRESSOF READ AREA                  I242 21728018
         ST    RF,DD0(R5)    PUT ADDRESS IN REMOTE LIST            I242 21730018
         BALR  RE,R6       GO TO Q MANAGER                         I242 21732018
         MVC   SIOT+SCTANAME-INDMSIOT(DD8),JFCBX+SCTANAME-INDMSIOT I242 21734018
         TM    JFCBX+SCTSBYT1-INDMSIOT,SIOTQDSN IS DSNAME BEING  Y02113 21734102
*              REFERRED TO A QUALIFIED DSNAME?                   Y02113 21734202
         BZ    DSNP050   NO,DO NOT SET QUALIFIED DSN SWITCH ON.  Y02113 21734302
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTQDSN TURN ON QUALIFIED Y02113 21734402
*              DSNAME BIT IN SIOT BEING CREATED.                 Y02113 21734502
DSNP050  DS    0H                                                Y02113 21734602
         TM    JFCBX+SCTSBYT1-INDMSIOT,SIOTGDSN  IS TEMP DSNAME  Y02668 21735002
*                                     BIT ON IN REFERENCED SIOT  Y02668 21736002
         BZ    DSNP05A                NO, GO READ IN JFCB        Y02668 21737002
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTGDSN SET TEMP DSN BIT  Y02668 21738002
DSNP05A  DS    0H                                                Y02668 21740002
         TM    JFCBX+SCTSBYT1-INDMSIOT,SCTDUMMY    REFERBACK    YA57513 21741002
*                            TO A DUMMY DATA SET?               YA57513 21742002
         BZ    DSNP05B       NO,CONTINUE PROCESSING...          YA57513 21743002
         OI    SIOT+SCTSBYT1-INDMSIOT,SCTDUMMY  SET DUMMY BIT   YA57513 21744002
*                            ON IN SIOT BEING BUILT.....        YA57513 21745002
DSNP05B  DS    0H                                               YA57513 21746002
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                 Y02668 21750002
         MVI   QPARM+QMPNC-QMNAM,DD1 READ SET FOR ONE                   21760000
         MVC   DD4(DD3,R5),DD5(R1) MOVE JFCB TTR TO REMOTE LIST         21780000
         LA    R1,JFCBX           GET ADDRESS OF AREA FOR READ          21800000
         ST    R1,DD0(R5)         PUT ADDRESS IN REMOTE LIST            21820000
         BALR  RE,R6              GO TO Q MANAGER                       21840000
         MVC   JFCB+JFCBDSNM-INFMJFCB(JFCBTSDM-JFCBDSNM),JFCBX+JFCBDSNM121860000
               -INFMJFCB          MOVE DSNAME AND ELEMENT NAME          21880000
         CLI   JFCBX+JFCBELNM-INFMJFCB,C'+'  TEST FOR GDG          413  21900000
         BE    DSNP051                       IN THE REF'D JFCB.    413  21920000
         CLI   JFCBX+JFCBELNM-INFMJFCB,C'-'  IF IT IS A            413  21940000
         BE    DSNP051                       GDG  THEN SET THE     413  21960000
         CLI   JFCBX+JFCBELNM-INFMJFCB,C'0'  GDG BIT IN THE        413  21980000
         BNE   DSNP052                       CURRENT SIOT.         413  22000000
DSNP051  DS    0H                                                  413  22020000
         OI    SIOT+SCTSBYT4-INDMSIOT,JDSNAME4 INDICATE GDG IN SIOT 413 22040000
DSNP052  DS    0H                                                  413  22060000
         TM    JFCBX+JFCBIND1-INFMJFCB,JFCPDS  GDG OR PDS ?       7030  22063001
         BZ    DSNP054                         NOT GDG OR PDS      7030 22066016
         OI    JFCB+JFCBIND1-INFMJFCB,JFCPDS   SET GDG OR PDS BIT       22069001
*                                 IN NEW JFCB BEING BUILT FOR CARD.     22071001
         SPACE                                                          22072016
DSNP054  DS    0H                                                       22075016
         TM    JFCBX+JFCBIND2-INFMJFCB,JFCTEMP   TEMPORARY DSNAME BIT   22085001
*                                 OFF IN JFCB REFERRED TO BY DSNAME     22095001
         BZ    DSNP06             YES,IGNORE ANY OTHER POSITIONALS.     22105001
         OI    JFCB+JFCBIND2-INFMJFCB,JFCTEMP  SET TEMPORARY DSNAME     22115001
*                                 BIT IN NEW JFCB BEING BUILT.          22117001
DSNP06   DS    0H                 FOR LOOP.                             22120000
         BALR  RE,R9              GO TO GET KEY                         22140000
         B     DSNP06             LOOP.                                 22160000
DSNP07   DS    0H                 ENTER FOR AMPERSAND                   22180000
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTGDSN  TEMP DSNAME BIT  Y02668 22185002
         OI    JFCB+JFCBIND2-INFMJFCB,JFCTEMP  SET TEMPORARY DSNAME     22190001
*                                 BIT IN NEW JFCB BEING BUILT.          22200001
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTQDSN TURN ON QUALIFIED Y02113 22205002
*              QUALIFIED DSN INDICATOR BECAUSE ALL CREATED       Y02113 22210002
*              TEMPORARY DSNAMES ARE QUALIFIED BY DEFINITION.    Y02113 22215002
         MVC   JFCB+JFCBDSNM-INFMJFCB(DD23),UNQNAME MOVE UNIQUE NAME    22220000
         LA    RF,JCT+JCTJTPTN-INJMJCT-DD1 GET LAST BYTE JOB NAME FIELD 22240000
         LA    R1,DD8             SET COUNT TO EIGHT.                   22260000
DSNP08   DS    0H                 ENTER FOR LOOP                        22280000
         CLI   DD0(RF),DDBLANK    IS CHARACTER BLANK                    22300000
         BC    NOT-EQUAL,DSNP09   NO TRANSFER                           22320000
         BCTR  RF,R0              YES DECREMENT POINTER                 22340000
         BCT   R1,DSNP08          LOOP BACK.                            22360000
DSNP09   DS    0H                 ENTER                                 22380000
         BCTR  R1,R0              DECREMENT LENGTH OF JOB NAME          22400000
         EX    R1,DSNP11          EXECUTE MOVE                          22420000
         LA    R1,JFCB+JFCBDSNM-INFMJFCB+DD24(R1) SET POINTER           22440000
         MVI   DD0(R1),DDPERIOD   MOVE IN PERIOD                        22460000
         CLI   DD0(R3),DD1        IS LENGTH ONE                         22480000
         BC    EQUAL,DSNP10       YES TRANSFER ERROR                    22500000
         BCTR  R2,R0              DECREMENT LENGTH BY ONE               22520000
         CH    R2,DSNP80          8 CHARS                          3565 22526016
         BH    DSNP0110           TRANS OVER 8                     3565 22532016
         CLI   DD2(R3),DDCA       COMPARE FOR CHARACTER 'A'.     A50808 22532601
         BL    DSNP09A            BRANCH IF LESS THAN 'A'.       A50808 22533201
         CLI   DD2(R3),DDN0       COMPARE FOR NUMERIC '0'.       A50808 22533801
         BL    DSNP09B            BRANCH IF LESS THAN '0'.       A50808 22534401
DSNP09A  DS    0H                                                A50808 22535001
         CLI   DD2(R3),C'$'       TEST FOR NATIONAL DOLLAR SIGN. A50808 22535601
         BE    DSNP09B            VALID IF EQUAL IN &DSN.        A50808 22536201
         CLI   DD2(R3),C'#'       TEST FOR NATIONAL POUND SIGN.  A50808 22536801
         BE    DSNP09B            VALID IF EQUAL IN &DSN.        A50808 22537401
         CLI   DD2(R3),C'@'       TEST FOR NATIONAL AT SIGN.     A50808 22538001
         BE    DSNP09B            VALID IF EQUAL IN &DSN         A50808 22538601
         MVI   MSGSEC,ERMES47     NON-ALPHA 1ST CHARACTER OF NAMEA50808 22540001
         B     CLEANUP            FAIL JOB WITH ABOVE MESSAGE.   A50808 22545001
DSNP09B  DS    0H                                                A50808 22550001
         BCTR  R2,R0              DO IT AGAIN                           22555001
         EX    R2,DSNP12          EXECUTE MOVE                          22560000
         EX    R2,DSNP125         MOVE &NAME TO SIOT               I242 22570018
         BALR  RE,R9              GO TO GET KEY                         22580000
         LTR   R2,R2              IS THIS A NULL PARAMETER      YA02511 22583002
         BNE   DSNP09C            BRANCH IF OK                  YA02511 22586002
         MVI   MSGSEC,ERMES46     SET ERROR CODE                YA02511 22589002
         B     CLEANUP                                          YA02511 22592002
DSNP09C  DS    0H                                               YA02511 22595002
         L     R1,ADSNAMT1                                              22600000
         ST    R1,TCPDTP          SAVE PTR                              22620000
         ST    R4,TPDTP           SET A PTR TO START OF PDT FOR DSNAME  22640000
         BALR  RE,R8              GO TO TEST AND STORE                  22660000
DSNP090  DS    0H                                                       22670017
         BALR  RE,R9              GO TO GET KEY                         22680000
DSNP091  DS    0H                                                A27935 22690019
         MVI   MSGSEC,ERMES40     ERROR   TOO MANY PARAMS               22700001
         B     CLEANUP            GO TO CLEANUP                         22720000
DSNP10   DS    0H                 ENTER                                 22740000
         MVI   MSGSEC,ERMES43     ERROR ONLY AMPERSAND                  22760001
         B     CLEANUP            GO TO CLEANUP                         22780000
DSNP11   DS    0H                 NO ENTRY                              22800000
         MVC   JFCB+JFCBDSNM-INFMJFCB+DD23(DD1),JCT+JCTJNAME-INJMJCT    22820000
DSNP12   DS    0H                 NO ENTRY                              22840000
         MVC   DD1(DD1,R1),DD2(R3) MOVE AMPERSAND NAME.                 22860000
DSNP125  DS    0H                       NO ENTRY                   I242 22866018
      MVC   SIOT+SCTANAME-INDMSIOT(0),DD2(R3)   MOVE &NAME TO SIOT I242 22872018
DSNP13   DS    0H                 ENTER                                 22880000
         MVI   MSGSEC,ERMES43     ERROR NO SUBLIST.                     22900001
         B     CLEANUP            GO TO CLEANUP                         22920000
DSNP14   DS    0H                 ENTRY FOR SYSOUT THIS STATEMENT       22940000
         LTR   R2,R2               CHECK FOR ZERO LENGTH         Y02668 22941002
         BZ    DSNP14B             ZERO GO TO SET WARNING MSG    Y02668 22942002
         LA    R1,JDSNAME1         GET MAX LENGTH                Y02668 22943002
         CR    R2,R1               LENGTH GREATER THAN 44 ?      Y02668 22944002
         BH    DSNP14B             GREATER GO TO SET WARNING MSG Y02668 22945002
         CLI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK                    Y02668 22946002
*                                  HAS DSNAME BEEN MOVED IN YET  Y02668 22947002
         BNE   DSNP14A             YES GO TO OVER LAY NAME       Y02668 22948002
         BCTR  R2,R0               DECREMENT FOR EXECUTE STMT    Y02668 22949002
         EX    R2,DSNP1604         MOVE DSNAME INTO JFCB         Y02668 22950002
         B     DSNP14C             GO TO CHECK QUAL DSN         YM01548 22951002
DSNP14A  DS    0H                                                Y02668 22952002
         MVI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK  BLANK DSNAME FIELDY02668 22953002
         MVC   JFCB+JFCBDSNM-INFMJFCB+1(DD51),JFCB+JFCBDSNM-INFMJFCB    22954002
         BCTR  R2,R0               DECREMENT FOR EXECUTE STMT    Y02668 22955002
         EX    R2,DSNP1604         MOVE DSNAME INTO JFCB         Y02668 22956002
DSNP14B  DS    0H                                                Y02668 22957002
         MVI   DWRNMSG,ERMES55    SET WARNING MSG CODE             AABA 22960001
         MVI   DWRNKEY,0          CLEAR SECONDARY MSG              AABA 22980016
*                                       JOB NOT FAILED             AABA 23000016
DSNP14C  DS    0H                                               YM01548 23002002
         NI    SIOT+SCTSBYT1-INDMSIOT,255-SIOTQDSN              YM01548 23004002
*                      UNCONDITIONALLY CLEAR QUAL DSN BIT       YM01548 23006002
         LA    R1,8                GET MAX NONQUAL DSN LTH      YM01548 23008002
         CR    R2,R1               IS THIS LENGTH > 8           YM01548 23010002
         BNL   DSNP14E             YES. GO TO SET QUAL DSN BIT  YM01548 23012002
DSNP14D  DS    0H                                               YM01548 23014002
         LA    R1,0(R2,R3)         GET POINTER TO BYTE TO CHECK YM01548 23016002
         CLI   0(R1),C'.'          IS THIS A PERIOD             YM01548 23018002
         BE    DSNP14E             YES GO TO SET QUAL DSN BIT   YM01548 23020002
         BCT   R2,DSNP14D    DECREMENT LTH TO SEARCH BACKWARDS  YM01548 23022002
         B     DSNP15              NOT A QUAL DSN  CONTINUE     YM01548 23024002
DSNP14E  DS    0H                                               YM01548 23026002
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTQDSN SET QUAL DSN     YM01548 23028002
DSNP15   DS    0H                 LOOP TO BYPASS ALL DSNAME PARAMS      23040000
         NI    SWI,255-DSNLIT      CLEAR LIT SW TO AVOID DISP      AACA 23046017
*                                       CHECKS IN CLEANUP RTN.     AACA 23052017
         BALR  RE,R9              GET KEY                               23060000
         B     DSNP15             BYPASS DSNAME                         23080000
         SPACE 2                                                        23080217
*                                                                  AACA 23080417
*    DSN MAY APPEAR IN QUOTES.  IF THE DSN IS IN QUOTES THEN-      AACA 23080617
*        . SCAN RTN SET 'LITERAL SW' IN IWA                        AACA 23080817
*        . QUOTES MUST ENCLOSE ENTIRE NAME                         AACA 23081017
*        . THE NAME CANNOT EXCEED 44 CHARS                         AACA 23081217
*        . ONLY SEQUENTIAL DATA SETS CAN BE SPECIFIED              AACA 23081417
*        . DISP=CATLG CANNOT BE SPECIFIED ( CHECKED IN CLEANUP RTN)AACA 23081617
         SPACE                                                          23081817
DSNP16   DS    0H                                                  AACA 23082017
         CLI   0(R3),JDSNAME1      MAX LENGTH                      AACA 23082217
         BH    DSNP0110            NAME TOO LONG - GO TO ERR RTN   AACA 23082417
         LTR   R2,R2               NULL NAME                       AACA 23082617
         BZ    DSNP15              GO TO GET NEXT KEY              AACA 23082817
         BCTR  R2,R0               FOR EXECUTE OF MOVE             AACA 23083017
         EX    R2,DSNP1604         MOVE NAME TO JFCB               AACA 23083217
         B     DSNP090             GO GET NEXT KEY                 AACA 23083417
         SPACE                                                          23083617
DSNP1604 MVC   JFCB+JFCBDSNM-INFMJFCB(1),1(R3)                     AACA 23083817
         SPACE 2                                                        23084017
DSNP80   DC    H'8'                                                3565 23086016
DSNPRD   DC    AL1(DDPERIOD)                                       3565 23092016
DSNMVTOC DC    X'2C'          LENGTH OF DSNAME FIELD           @ZA16056 23092103
         DC    44X'04'        VTOC DSNAME                      @ZA16056 23092203
         EJECT                                                          23092420
*              ************************************************** 20001 23092820
*              *                                                * 20001 23093220
*              *           PROCESSING ROUTINE FOR TERM          * 20001 23093620
*              *                   A TSO KEYWORD                * 20001 23094020
*              ************************************************** 20001 23094420
         SPACE 3                                                        23094820
TERMP    DS    0H                                                 20001 23095220
         BALR  RE,R8               GO TO TEST AND STORE    TSO    20001 23095620
         L     RE,WANELPTR         LOAD ADDRESS OF NEL.          Y02668 23096002
         USING VDANEL,RE                                                23096420
         TM    NELOPSWT,NELTSOP   SHOLUD TERM BE PROCESSED        20010 23096820
         DROP  RE                                                       23097220
         BNO   DUMMY1              NO - SKIP TERM KEYWORD  TSO    20001 23097620
         OI    SIOT+SIOTTSTC-INDMSIOT,SIOTTERM    SET TERM BIT  TSO     23098001
         B     DUMMY0        PROCESS AS DUMMY-SET DUMMY SWITCH    M4105 23098420
*                            TO PREVENT OVERLAYING NULLFILE DSNAMEM4105 23098820
*                            IF DSNAME PARAMETER IS SPECIFIED ON  M4105 23099220
*                            THE DD CARD.                         M4105 23099620
         EJECT                                                          23100000
*              ***************************************************      23120000
*              *                                                 *      23140000
*              *      PROCESSING ROUTINE FOR DUMMY               *      23160000
*              *                                                 *      23180000
*              ***************************************************      23200000
         SPACE 2                                                        23220000
DUMMYP   DS    0H                                                       23240000
         TM    SWY2,DUMMYSW        LEGAL DUMMY PARM SPECIFIED?  YM02716 23246002
         BZ    COMMON              NO, DUMM= SPEC'D. JCL ERROR. YM02716 23251002
*                                  BYPASS DUMMY PROCESSING IF     20029 23256020
         TM    DDSWA,DSSYSSW      SYSOUT OR DSNAME KEYWORD SPECIFIED?   23258001
         BO    DUMMY1             YES,IGNORE DUMMY SPECIFICATION.       23260001
         TM    DDSWA,DDSUBSW       HAS SUBSYS BEEN PROCESSED?  @ZM44657 23261003
         BO    DUMMY1              YES,IGNORE DUMMY PARM       @ZM44657 23262003
DUMMY0   DS    0H                  BLANK DSNAME FIELD OF JFCB     16670 23265017
         OI    DDSWA,DSDUMSW      SET LWA SWITCH FOR DUMMY.             23265401
         MVI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK                     16670 23270017
         MVC   JFCB+JFCBDSNM-INFMJFCB+1(DD51),JFCB+JFCBDSNM-INFMJFCB    23275017
         MVC   JFCB+JFCBDSNM-INFMJFCB(8),DDNAMEP9 NULLFILE TO JFCB      23300000
         OI    SIOT+SCTSBYT1-INDMSIOT,SCTDUMMY    SET DUMMY BIT         23320001
DUMMY1   DS    0H                                                       23340000
         BALR  RE,R9              GET KEY                               23360000
         B     DUMMY1                                                   23380000
         SPACE 3                                                        23381019
*              ************************************************** 19874 23382019
*              *                                                * 19874 23383019
*              *    ERROR PROCESSING ROUTINE FOR DUMMY - DYNAM  * 19874 23384019
*              *                                                * 19874 23385019
*              ************************************************** 19874 23386019
         SPACE 3                                                        23387019
COMMON   DS    0H                                                 19874 23388019
         MVI   MSGSEC,ERMES30      INVALID KEYWORD                19874 23389001
         MVI   MSGKEY,ERMES110     ON THE DD STATEMENT            19874 23390001
         B     CLEANUP                                            19874 23391019
         EJECT                                                          23400000
*              ************************************************** 20001 23400920
*              *                                                * 20001 23401820
*              *           PROCESSING ROUTINE FOR DYNAM         * 20001 23402720
*              *                                                *Y02668 23403602
*              ************************************************** 20001 23404520
         SPACE 3                                                        23405420
DYNAMP   DS    0H                                          TSO    20001 23406320
         TM    SWY2,DYNAMSW        IEFVFA PROCESS DYNAM    TSO    20001 23407220
         BZ    COMMON              NO - KEYWORD IN ERROR   TSO    20001 23408120
*                                  BYPASS DYNAM PROCESSING IF     20029 23409020
         TM    DDSWA,DSSYSSW      SYSOUT OR DSNAME KEYWORD SPECIFIED?   23409401
         BO    DUMMY1             YES,IGNORE DYNAM SPECIFICATION        23409801
         TM    DDWA2,JDICTI3      WAS DD REFERRED TO BY DDNAME=         23410801
*                                  PARAMETER                      20029 23411720
         BO    DYNAMP1             YES, ERROR                     20029 23412602
         LH    RF,SCT+SCTNIUSL-INSMSCT GET CURRENT COUNT OF      Y02668 23412802
*                                  DYNAMS FOR THIS STEP(INCLUD   Y02668 23413002
*                                  VALUE OF DYNAMNBR)            Y02668 23413202
         LA    RF,DD1(RF)          INCREMENT COUNT FOR THIS DYNAMY02668 23413402
         STH   RF,SCT+SCTNIUSL-INSMSCT SAVE UPD COUNT IN SCT.THISY02668 23413602
*                                  FIELD IS LATER ADDED TO A     Y02668 23413802
*                                  FIELD CONTAINING THE TOTAL    Y02668 23414002
*                                  NUMBER OF STATIC DD'S IN      Y02668 23414202
*                                  A STEP(SCTLALOC)              Y02668 23414402
         BALR  RE,R9               GO TO GET NEXT KEY            Y02668 23414602
DYNAMP1  DS    0H                                                 20029 23415320
         MVI   MSGSEC,ERMES69      INVALID REFER FORWARD TO DYNAM 20029 23416201
         MVI   MSGKEY,DD0          CLEAR SECONDARY MSG            20029 23417120
         B     CLEANUP             WRITE MESSAGE                  20029 23418020
         EJECT                                                          23418920
*              **************************************************       23420000
*              *                                                *       23440000
*              *        EXPDT KEYWORD PROCESSING ROUTINE        *       23460000
*              *                                                *       23480000
*              **************************************************       23500000
         SPACE 2                                                        23520000
EXPDTP   DS    0H                 PROCESS EXPDT KEY.                    23540000
         LTR   R2,R2              IS THERE AN OPERAND                   23560000
         BC    ZERO,EXPDTP01      NO TRANSFER ERROR.                    23580000
         CLI   DD0(R3),DD5        IS OPERAND LENGTH 5.                  23600000
         BC    NOT-EQUAL,EXPDTP02 NO TRANSFER ERROR                     23620000
         OI    JFCB+JFCBFLG3-INFMJFCB,JFCBEXP                  @ZA27071 23626003
*                 INDICATE EXPDT SPECIFIED                     @ZA27071 23632003
         LA    R2,DD2             LOAD REGISTER WITH 2                  23640000
         BALR  RE,R8              GO TO TEST AND STORE                  23660000
         LA    R3,DD2(R3)         BUMP TEXT POINTER                     23680000
         LA    R2,DD3             LOAD REGISTER WITH 3.                 23700000
         BALR  RE,R8              GO TO TEST AND STORE.                 23720000
* TEST TO DETERMINE IF AN EXPDT OF ZERO WAS SPECIFIED            A23350 23723019
         OC    JFCB+JFCBXPDT-INFMJFCB(3),JFCB+JFCBXPDT-INFMJFCB  A23350 23726019
         BNZ   EXPDTP00                 IF 0 NOT STORED BRANCH   A23350 23729019
         OC    JFCB+JFCBXPDT-INFMJFCB(3),XPDTZERO SYMBOLIC 0     A23350 23732019
EXPDTP00 DS    0H                                                A23350 23735019
         BAL   R1,CLEAN20         SET CREATE DATE.                      23740000
         BALR  RE,R9              GO TO GET KEY                         23760000
EXPDTP01 DS    0H                 ENTER                                 23780000
         MVI   MSGSEC,ERMES46     ERROR NO OPERAND.                     23800001
         B     CLEANUP            GO TO CLEAN UP                        23820000
EXPDTP02 DS    0H                 ENTER                                 23840000
         MVI   MSGSEC,ERMES43     ERROR OPERAND NOT LENGTH 5            23860001
         B     CLEANUP            GO TO CLEAN UP                        23880000
         EJECT                                                          23881002
************************************************************     Y02670 23882002
*                                                          *     Y02670 23883002
*             FREE KEYWORD PROCESSING ROUTINE              *     Y02670 23884002
*                                                          *     Y02670 23885002
************************************************************     Y02670 23886002
FREEP    DS    0H                                                Y02670 23887002
         BALR  RE,R8               GO TO TEST AND STORE RTNE     Y02670 23888002
         CLI   MSGSEC,DD0          CHECK FOR ERROR MESSAGE       Y02670 23889002
         BE    FREEP1              NO MSG, GO GET NEXT KEY       Y02670 23890002
         MVI   MSGSEC,DD0          ZERO MSGSEC                   Y02670 23891002
         MVI   MSGKEY,DD0         CLEAR MSG FIELD                Y02670 23892002
         LA    R2,WRNMSG01         LOAD ERROR MSG CODE.         YM01592 23892702
         L     RF,DIEFVGM          GET MESSAGE MODULE ADDRESS    Y02670 23894002
         BALR  RE,RF               GO PRINT OUT MESSAGE          Y02670 23895002
FREEP1   BALR  RE,R9               GO GET NEXT KEY               Y02670 23897002
         EJECT                                                          23900000
*              ******************************************************** 23900900
*              *                                                      * 23901800
*              *   UCS AND FCB PROCESSING                        20202* 23902720
*              *                                                      * 23903600
*              ******************************************************** 23904500
UCSP     DS    0H                 PROCESS UCS                           23905400
         XC    JFCB+JFCUCSID-INFMJFCB(JFCUCSOP-JFCUCSID),JFCB+JFCUCSID-X23906320
               INFMJFCB                CLEAR UCS ID FIELD         20202 23906720
         NI    JFCB+JFCUCSOP-INFMJFCB,255-JFCFOLD-JFCVER                23907101
*              CLEAR UCS OPERATION BITS IN THE JFCB FIELD.              23907201
         B     UCSP0A                  BRANCH AROUND FCB          20202 23907620
FCBP     DS    0H                 FCB.                            20202 23908020
         NI    JFCB+JFCUCSOP-INFMJFCB,255-JFCFCBAL-JFCFCBVR             23908101
*              CLEAR FCB OPERATION BITS IN THE JFCB FIELD               23908501
         LTR   R2,R2              IS FIRST PARAMETER NULL     @ZM40457  23908903
         BE    UCSP0B             YES,CHECK FOR OVERRIDE      @ZM40457  23909003
         MVI   JFCB+JFCFCBID-INFMJFCB,DDBLANK  MOVE 1 BLANK   @ZM40457  23909103
        MVC   JFCB+JFCFCBID-INFMJFCB+1(DD3),JFCB+JFCFCBID-INFMJFCB      23909203
*                      INITIALIZE FCB ID TO BLANKS           @ZM40457   23909303
         B     UCSP01           GO TO TEST AND STORE          @ZM40457  23909403
UCSP0A   LTR   R2,R2                   IS FIRST PARAM NULL        20202 23909503
         BNE   UCSP01             NO  - TRANS                           23909603
UCSP0B   L     R1,TNUMPX          YES - GET NUMBER BYTE PTR    @ZM40457 23909703
         CLI   0(R1),1            IS IT ONE PARAM                       23910800
         BE    UCSP02             YES - THIS IS O'RIDE                  23911700
         MVI   MSGSEC,ERMES46     ERROR FIRST PARAM IS NULL             23912601
         B     CLEANUP                                                  23913500
UCSP01  DS     0H                                                       23914400
         BALR  RE,R8              TEST AND STORE                        23915300
UCSP02   DS    0H                                                       23916200
         BALR  RE,R9              GET KEY                               23917100
         B     UCSP01             LOOP                                  23918000
         EJECT                                                          24080000
*              *************************************************        24100000
*              *                                                *       24120000
*              *     RECFM AND OPTCD KEYWORD PROCESSING         *       24140000
*              *                                                *       24160000
*              **************************************************       24180000
         SPACE 2                                                        24200000
RECFMP   DS    0H                 PROCESS RECFM KEY.                    24220000
         CLI   DD0(R3),DD5        IS OPERAND GREATER THAN FIVE          24240000
         BC    HIGH,RECFMP04      YES TRANSFER ERROR                    24260000
OPTCDP   DS    0H                                                       24280000
BFTEKP   DS    0H                         BFTEK                         24300000
         BALR  RE,R8              CLEAR BYTE IN JFCB                    24320000
         SR    R1,R1                                                    24340000
         IC    R1,0(R4)           COUNT BYTE IN PDT                     24360000
         LA    R4,0(R1,R4)        BUMP TEST AND STORE POINTER           24380000
         LTR   R2,R2                                                    24400000
         BC    ZERO,RECFMP03                                            24420000
         LR    R1,R2              SAVE LENGTH FOR COUNTER               24440000
         LA    R2,DD1             SET REGISTER TO ONE FOR TEST & STORE  24460000
         B     RECFMP02           TRANSFER                              24480000
RECFMP01 DS    0H                 ENTER FOR LOOP.                       24500000
         LA    R3,DD1(R3)         BUMP POINTER                          24520000
         SR    RF,RF              CLEAR REGISTER                        24540000
         ST    RF,TPDTP           SET PDT POINTER FOR TEST AND STORE.   24560000
RECFMP02 DS    0H                 ENTER                                 24580000
         BALR  RE,R8              GO TO TEST & STORE.                   24600000
         BCT   R1,RECFMP01        LOOP BACK.                            24620000
RECFMP03 DS    0H                 ENTER.                                24640000
         BALR  RE,R9              GO TO GET KEY                         24660000
RECFMP04 DS    0H                 ENTER                                 24680000
         MVI   MSGSEC,ERMES42     OPERAND TOO LONG                      24700001
         B     CLEANUP            GO TO CLEANUP.                        24720000
         EJECT                                                          24740000
*              **************************************************       24760000
*              *                                                *       24780000
*              *         REF KEYWORD PROCESSING ROUTINE         *       24800000
*              *                                                *       24820000
*              **************************************************       24840000
         SPACE 2                                                        24860000
REFP     DS    0H                 PROCESS REF KEY.                      24880000
         OI    SIOT+SCTSBYT2-INDMSIOT,SCTVOLAF  SET VOL REF AFFINITY ON 24890001
         LTR   R2,R2              IS LENGTH ZERO                        24920000
         BC    ZERO,REFP04        YES TRANSFER ERROR             Y02668 24940002
         CLI   DD1(R3),DDASTER    IS CHARACTER ASTERICK                 24960000
         BC    NOT-EQUAL,REFP03   NO TRANSFER.                          24980000
*                                                                       24982017
*  IF ASTERISK IS FOLLOWED BY PERIOD ( *.DD ) WHICH INDICATES           24984017
*      A REFERBACK, THE LENGTH FIELD MUST HAVE A LENGTH OF ONE.         24986017
*    IF NOT LENGTH OF ONE THEN PERIOD MUST BE MISSING.                  24988017
*                                                                       24990017
         CLI   DD0(R3),X'01'                                      18768 24992017
         BNE   DCBP10                                             18768 24994017
         BCTR  R3,R0              DECREMENT TEXT POINTER                25000000
****                                                           @ZA31245 25000603
*  IF ASTERISK FOLLOWED BY COMMA LENGTH FIELD WILL BE ONE, BUT @ZA31245 25001203
*  COUNT FIELD WILL BE X'81' FOR A SUB-LIST WITH A COUNT OF ONE@ZA31245 25001803
*  AN ERROR MESSAGE WILL BE ISSUED FOR REF=*,                  @ZA31245 25002403
****                                                           @ZA31245 25003003
         CLI   DD0(R3),X'81'      IS COUNT ONE                 @ZA31245 25003603
         BE    DCBP10             INVALID REFERBACK ERROR MSG  @ZA31245 25004203
         BAL   RE,INTRSTEP                                     @ZA06978 25005003
*   RETURN FOR WITHIN STEP REFERBACK                           @ZA06978 25010003
         OI    SIOT+SCTSBYT3-INDMSIOT,SCTVREF SET REFBACK IN ST YM05425 25054402
*   RETURN FOR INTRASTEP REFERBACK                             @ZA06978 25055203
         SPACE                                                          25056016
REFP01   DS    0H                 ENTER                                 25080000
         BALR  RE,R9              GO TO GET KEY                         25100000
         BAL   RE,DSRTN            GO TO DICTIONARY SEARCH RTN     AACA 25120017
         MVC   SIOT+SIOTVRSB-INDMSIOT(DD3),DD2(R1) MOVE SIOT TTR.       25140000
         MVI   QPARM+QMPOP-QMNAM,QMREAD  SET READ                 21670 25141018
         MVI   QPARM+QMPNC-QMNAM,DD1    SET FOR ONE READ          21670 25142018
         MVC   DD4(DD3,R5),DD2(R1) PUT TTR OF SIOT IN REMOTE LIST 21670 25143018
         LA    R1,JFCBX           GET ADDRESS OF AREA FOR SIOT    21670 25144018
         ST    R1,DD0(R5)          PUT ADDRESS IN REMOTE LIST     21670 25145018
         BALR  RE,R6              GO TO Q MANAGER                 21670 25146018
         MVI   DISPLID(R5),DD0    ZERO BLOCK ID IN REMOTE LIST TO       25146103
*                                 PREVENT INCORRECT IDENTIFICATION      25146203
*                                 OF NEXT BLOCK WRITTEN.  SWA MGR USES  25146303
*                                 THIS ID, IF NONZERO.  IF ZERO, IT     25146403
*                                 USES ID AT OFFSET OF 3 BYTES IN       25146803
*                                 BLOCK WRITTEN.               @ZA10649 25146903
*  TEST SIOT TO SEE IF VOL=REF REQUESTED TO DUMMY DATA SET        21670 25147018
         TM    JFCBX+SCTSBYT1-INDMSIOT,SCTDUMMY   IS THE SIOT READ IN   25148001
*                                          BY QMGR FOR DD DUMMY   21670 25149018
         BO    DUMMY0     GO SET DUMMY BIT IF VOL=REF TO DUMMY    21670 25150018
REFP02   DS    0H                 ENTER LOOP                            25160000
         BALR  RE,R9              GO TO GET KEY                         25180000
         B     REFP02             LOOP BACK                             25200000
         SPACE                                                          25216016
REFP03   DS    0H                 ENTRY FOR DSNAME                      25220000
         OI    SIOT+SCTSBYT3-INDMSIOT,SCTDSNRF  SET DSN VOL REF SW ON   25230001
         OI    SWC,VOLREF    SET INDICATOR FOR DSN TABLE       @ZA01890 25237003
*                            SUBROUTINE THAT CALL IS FOR       @ZA01890 25244003
*                            DSN VOL REF                       @ZA01890 25251003
         BAL   RE,DSNTP           BRANCH TO PROCESS DSN TABLE    Y02668 25260002
         NI    SWC,DD255-VOLREF TURN OFF DSN VOL REF INDICATOR @ZA01890 25290003
         BALR  RE,R9              GO GET NEXT KEY                Y02668 25320002
REFP04   DS    0H                 ENTER                          Y02668 25340002
         MVI   MSGSEC,ERMES46     ERROR NO OPERANDS                     26360001
         B     CLEANUP            GO TO CLEANUP.                        26380000
         EJECT                                                          26381003
*              **************************************************       26382003
*              THIS CODE TESTS FOR INTRASTEP REFERBACK         @ZA06978 26383003
*              (*.DDNAME OR *.STEPNAME.PROCNAME.DDNAME OR      @ZA06978 26384003
*              *.STEPNAME.DDNAME). RETURN ADDRESS IS IN        @ZA06978 26385003
*              REGISTER RE. IF INTRASTEP REFERBACK, THE        @ZA06978 26386003
*              RETURN ADDRESS IS UPDATED BY 4.                 @ZA06978 26387003
*              THE JFCBX FIELD IS USED HERE AS WORK SPACE          AACA 26388003
DDPROCNM EQU   JFCBX                                               AACA 26389003
DDSTEPNM EQU   DDPROCNM+8                                          AACA 26390003
*              **************************************************       26391003
         SPACE                                                          26392003
INTRSTEP CLI   DD0(R3),DD130       IS THIS HEX 82              @ZA06978 26393003
         BE    REFP007                 YES (*.DDNAME)          @ZA06978 26394003
         MVI   DDPROCNM,C' '           PUT BLANK IN 1ST BYTE       AACA 26395003
         MVC   DDPROCNM+1(15),DDPROCNM BLANK 4 WDS                 AACA 26396003
         SR    R2,R2                   ZERO REG2                 PTM671 26397003
         IC    R2,DD3(R3)              LENGTH OF STEPNAME        PTM671 26398003
         BCTR  R2,0                    LESS 1 FOR EXECUTE        PTM671 26399003
         CLI   DD0(R3),DD131           IS KEY=83?                PTM671 26400003
         BE    REFP003                 YES/BRANCH                PTM671 26401003
         EX    R2,BUFF1                MOVE PROCSTEPNAME         PTM671 26402003
         LA    R4,DD5(R2,R3)           POINT TO PROC STEPNAME    PTM671 26403003
         IC    R2,0(R4)                GET LENGTH OF PROCNAME    PTM671 26404003
         BCTR  R2,0                    LESS 1 FOR EXECUTE        PTM671 26405003
         EX    R2,BUFF2                MOVE STEPNAME             PTM671 26406003
         B     REFP005                                           PTM671 26407003
REFP003  DS    0H                                                PTM671 26408003
         EX    R2,BUFF3                MOVE STEPNAMETO BUFF2     PTM671 26409003
REFP005  DS    0H                                                PTM671 26410003
         CLC   SCT+SCTSNAME-INSMSCT(DD8),DDSTEPNM                  AACA 26411003
         BNE   REFP006                 STEPNAMES EQUAL NO-BR   @ZA06978 26412003
         CLC   SCT+SCTSCLPC-INSMSCT(DD8),DDPROCNM                  AACA 26413003
         BE    REFP007                 PROCSTPNAMES EQUAL,YES BR PTM671 26414003
         CLI   DDPROCNM,C' '       IS PROCSTEPNAME = BLANK         AACA 26415003
         BE    REFP007             YES - BRANCH                @ZA06978 26416003
REFP006  DS    0H                  INTRASTEP REFERBACK,        @ZA06978 26417003
         LA    RE,4(,RE)           UPDATE RETURN ADDRESS       @ZA06978 26418003
REFP007  DS    0H                                              @ZA06978 26419003
         BR    RE                  RETURN TO CALLER            @ZA06978 26420003
         SPACE                                                          26421003
BUFF1    MVC   DDPROCNM(0),DD4(R3) CALLING STEPNAME                AACA 26422003
BUFF2    MVC   DDSTEPNM(0),DD1(R4) STEPNAME IN PROC                AACA 26423003
BUFF3    MVC   DDSTEPNM(0),DD4(R3) STEPNAME NOT IN PROC            AACA 26424003
         EJECT                                                          26460000
*              **************************************************       26480000
*              *                                                *       26500000
*              *        RETPD KEYWORD PROCESSING ROUTINE.       *       26520000
*              *                                                *       26540000
*              **************************************************       26560000
         SPACE 2                                                        26580000
RETPDP   DS    0H                 ENTRY FOR RETPD PROCESSING            26600000
         LTR   R2,R2              IS LENGTH ZERO                        26620000
         BC    ZERO,RETPDP03      YES TRANSFER ERROR                    26640000
         CLI   DD0(R3),DD4        IS LENGTH GREATER THAN 4              26660000
         BC    HIGH,RETPDP04      YES TRANSFER ERROR                    26680000
         BALR  RE,R8              GO TO TEST AND STORE                  26700000
         L     R4,AEXPDTT         RESET POINTER TO PDT.                 26720000
         BAL   R1,CLEAN19         SET EXP AND CREATE DATE               26740000
         LH    R1,DDWA6           GET NUMBER OF DAYS                    26760001
         LH    R2,JFCB+JFCBXPDT-INFMJFCB+DD1 GET DAYS                   26780000
         LA    R4,JEXPDT1         DECIMAL 99 IS THE MAXIMUM      R00398 26790001
*                                 VALUE TO BE ENTERED IN THE     R00398 26794001
*                                 EXPIRATION DATE (YEAR PORTION) R00398 26798001
         AR    R2,R1              ADD DAYS                              26800000
         LA    R1,DD365                                          A50000 26828001
RETPDP01 DS    0H                 FOR LOOP                              26840000
         SR    R2,R1              SUBTRACT 365                          26860000
         BC    LOW+ZERO,RETPDP02  TRANSFER ON ZERO OR NEGATIVE          26880000
         SR    R3,R3              R3 TO BE USED FOR YEAR         YM4003 26890001
         IC    R3,JFCB+JFCBXPDT-INFMJFCB GET YEAR                       26900000
         LA    R3,DD1(R3)         ADD ONE TO YEAR                       26920000
         CR    R3,R4              HAS THE MAXIMUM YEAR DATE BEEN R00398 26930001
*                                 REACHED? (JFCBXPDT=X'63')DEC99)R00398 26932001
         BNL   RETPDEFT           ASSUME THE DEFAULT RETPD=99.365R00398 26934001
         STC   R3,JFCB+JFCBXPDT-INFMJFCB PUT BACK YEAR                  26940000
         B     RETPDP01           LOOP BACK                             26960000
         SPACE                                                          26969001
         SPACE                                                          26970001
* THE FOLLOWING CODE WAS ADDED TO PREVENT DATA SETS WITH LONG  * R00398 26972001
* RETENTION PERIODS FROM HAVING EXPIRATION DATES LOWER THAN    * R00398 26974001
         SPACE                                                          26974101
* THEIR CREATION DATE. THIS SITUATION CAN ARISE AFTER AUG 1972 * R00398 26976001
* BECAUSE WHEN THE RETENTION PERIOD OF 9999 DAYS IS ADDED TO   * R00398 26978001
* THE DATE SET AT IPL, AN EXPIRATION DATE IN THE 21ST CENTURY  * R00398 26978401
* IS CALCULATED. THE LAST TWO DIGITS OF THE YEAR ARE STORED,   * R00398 26978801
* THEREFORE, ANY DATA SET CREATED UNDER SIMILIAR CONDITIONS    * R00398 26979201
* COULD BE IMMEDIATELY SCRATCHED.                              * R00398 26979301
         SPACE                                                          26979401
RETPDEFT DS    0H                                                R00298 26979501
         LA    R3,JEXPDT1        DEFAULT YEAR EXPIRATION DATE=99 R00398 26979601
         STC   R3,JFCB+JFCBXPDT-INFMJFCB DEFAULT DATE TO JFCB    R00398 26979701
         SR    R2,R2              DEFAULT DAYS = 365 WHEN ADDED  R00398 26979801
         SPACE                                                          26979901
RETPDP02 DS    0H                 ENTER                                 26980101
         AR    R2,R1              RESTORE POSITIVE DAYS                 27000000
         STH   R2,JFCB+JFCBXPDT-INFMJFCB+DD1 PUT DAYS AWAY              27020000
         BALR  RE,R9              GO TO GET KEY                         27040000
RETPDP03 DS    0H                 ENTER                                 27060000
         MVI   MSGSEC,ERMES46     ERROR NO OPERAND                      27080001
         B     CLEANUP            GO TO CLEAN UP                        27100000
RETPDP04 DS    0H                 ENTER                                 27120000
         MVI   MSGSEC,ERMES42     ERROR OPERAND GREATER THAN 4.         27140001
         B     CLEANUP            GO TO CLEAN UP                        27160000
         EJECT                                                          27161002
************************************************************     Y02668 27162002
*                                                          *     Y02668 27163002
*              HOLD KEYWORD PROCESSING ROUTINE             *     Y02668 27164002
*                                                          *     Y02668 27165002
************************************************************     Y02668 27166002
         SPACE                                                          27167002
HOLDP    DS    0H                 HOLD                           Y02668 27168002
         L     RF,TEXTBUFP        ESTABLISH ADDRESSIBILITY       Y02668 27168202
         USING TEXT,RF            ON THE INTERNAL TEXT STRING    Y02668 27168402
         TM    STRDINDC,DTXSYOUT  SYSOUT SPECIFIED?              Y02668 27168602
         BZ    HOLDP1             NO, IGNORE KEY                 Y02668 27168802
         BALR  RE,R8              GO TO TEST AND STORE           Y02668 27169002
         CLI   MSGSEC,DD0         CHECK FOR ERROR MSG            Y02668 27170002
         BE    HOLDP1             NO GO TO GET NEXT KEY          Y02668 27171002
         MVI   MSGSEC,DD0         CLEAR MSGSEC                   Y02668 27172002
         MVI   MSGKEY,DD0         CLEAR MSG FIELD                Y02668 27172502
         LA    R2,WRNMSG06        PUT MSG IN REG. FOR VGM        Y02668 27173002
         L     RF,DIEFVGM         GET MSG MOD ADDRESS            Y02668 27174002
         BALR  RE,RF              BRANCH TO MSG MODULE           Y02668 27175002
HOLDP1   DS    0H                                                Y02668 27176002
         BALR  RE,R9              GO TO GET NEXT KEY             Y02668 27177002
         EJECT                                                          27180000
*              **************************************************       27200000
*              *                                                *       27220000
*              *         SER KEYWORD PROCESSING ROUTINE         *       27240000
*              *                                                *       27260000
*              **************************************************       27280000
         SPACE 2                                                        27300000
SERP     DS    0H                 ENTRY FOR SER PROCESSING              27320000
         BCTR  R3,R0              DECREMENT POINTER                     27340000
         CLI   DD0(R3),DD0        IS NUMBER BYTE ZERO                   27360000
         BC    EQUAL,SERP13       YES TRANSFER ERROR                    27380000
         SR    R0,R0              CLEAR REGISTER                        27400000
         IC    R0,DD0(R3)         GET COUNT OF OPERANDS.                27420000
         LA    R3,DD1(R3)         RESTORE POINTER                       27440000
         CLI   DD0(R3),DD0             IS LENGTH BYTE ZERO?      A34497 27446020
         BC    EQUAL,SERP001       IS LENGTH BYTE ZERO?        @ZA28079 27452003
         MVI   JFCB+JFCBVOLS-INFMJFCB,DDBLANK MOVE IN BLANK             27520000
         MVC   JFCB+JFCBVOLS-INFMJFCB+DD1(JFCBEXTL-JFCBVOLS-DD1),JFCB+J127540000
               FCBVOLS-INFMJFCB   PROPIGATE BLANKS IN JFCB              27560000
         B     SERP02             TRANSFER.                             27580000
SERP001  DS    0H                  ENTRY FOR NEXT OPERAND      @ZA28079 27600003
         LA    R1,DD1             LOAD REGISTER WITH ONE       @ZA28079 27603003
         CLR   R0,R1              MORE THAN ONE OPERAND?       @ZA28079 27606003
         BC    HIGH,SERP13        YES ERROR                    @ZA28079 27609003
SERP01   DS    0H                  ENTER                       @ZA28079 27612003
         BALR  RE,R9              GO TO GET KEY.                        27620000
SERP02   DS    0H                 ENTRY FOR FIRST TIME.                 27640000
         CLI   DD0(R3),DD6        IS LENGTH GREATER THAN SIX      17006 27646017
         BC    HIGH,DSNP0110      YES ERROR                       17006 27652017
         CLI   DD0(R3),DD0        IS LENGTH BYTE ZERO.                  27660000
         BC    EQUAL,SERP14       YES TRANSFER ERROR.                   27680000
         BCTR  R2,R0              DECREMENT LENGTH FOR MOVE             27700000
         SR    RF,RF              CLEAR REGISTER                        27720000
         IC    RF,SIOT+SCTVOLCT-INDMSIOT GET VOL SER COUNT.             27740000
         LA    R1,DD5             LOAD REGISTER WITH FIVE               27760000
         CLR   RF,R1              IS VOL SER COUNT LESS THAN FIVE       27780000
         BC    LOW,SERP07         YES TRANSFER.                         27800000
         SR    RF,R1              SUBTRACT FIVE FROM VOL SER COUNT.     27820000
         BC    NOT-ZERO,SERP03    TRANSFER GREATER THAN FIVE            27840000
         BAL   R1,SERP21          SET UP FIRST EXTENT                   27860000
         B     SERP06             TRANSFER                              27880000
SERP03   DS    0H                 ENTER.                                27900000
         LA    R1,DD15                                                  27920000
SERP04   DS    0H                 FOR LOOR                              27940000
         SR    RF,R1              SUBTRACT 28 FROM VOL SER COUNT.       27960000
         BC    LOW,SERP05         TRANSFER THERE IS SPACE.              27980000
         BC    HIGH,SERP04        LOOP BACK.                            28000000
         BAL   R1,SERP22          SET UP ADDITIONAL EXTENT              28020000
         B     SERP06             TRANSFER                              28040000
SERP05   DS    0H                 ENTER                                 28060000
         AR    RF,R1              RESTORE VOL SER COUNT.                28080000
SERP06   DS    0H                 ENTER FOR JFCBX                       28100000
         BAL   RE,SERP17          SIX TIMES VOL SER COUNT               28120000
         LA    R4,JFCBX           JFCBX ADDRESS.                        28140000
         LA    RF,DD4(R4,RF)      COMPUTE OFFSET INTO JFCBX             28160000
         B     SERP08              BR TO MOVE VOL SER.           Y02668 28180002
SERP07   DS    0H                 ENTER FOR JFCB                        28200000
         BAL   RE,SERP17          SIX TIMES VOL SER COUNT               28220000
         LA    R4,JFCB+JFCBVOLS-INFMJFCB JFCB ADDRESS                   28240000
         LA    RF,DD0(R4,RF)      COMPUTE OFF SET INTO JFCB             28260000
SERP08   DS    0H                                                Y02670 28360002
         EX    R2,SERP18           MOVE VOL SER NUMBER           Y02670 28460002
SERP11   DS    0H                 ENTER.                                28820000
         SR    R1,R1              CLEAR REGISTER.                       28960000
         IC    R1,SIOT+SCTVOLCT-INDMSIOT GET VOL SER COUNT FROM SIOT    28980000
         LA    R1,DD1(R1)         BUMP COUNT BY ONE                     29000000
         STC   R1,SIOT+SCTVOLCT-INDMSIOT PUT VOL SER COUNT IN SIOT      29020000
         STC   R1,JFCB+JFCBNVOL-INFMJFCB PUT VOL SER COUNT IN JFCB      29040000
         BCT   R0,SERP01          LOOP BACK FOR NEXT OPERAND            29060000
         CLC   SERP20(DD3),JFCB+JFCBEXAD-INFMJFCB IS THERE JFCBX TABLE. 29080000
         BC    EQUAL,SERP12       NO TRANSFER                           29100000
         BAL   R1,SERP23          WRITE JFCBX TO Q                      29120000
SERP12   DS    0H                 ENTER                                 29140000
         BALR  RE,R9              GO TO GET KEY                         29160000
SERP13   DS    0H                 ENTER                                 29180000
         MVI   MSGSEC,ERMES46     ERROR NO OPERAND                      29200001
         B     CLEANUP            GO TO CLEANUP                         29220000
SERP14   DS    0H                 ENTER                                 29240000
         MVI   MSGSEC,ERMES46     ERROR NULL OPERAND                    29260001
         B     CLEANUP            GO TO CLEANUP.                        29280000
SERP15   DS    0H                 ENTER FOR JFCBX SET UP.               29300000
         XC    JFCBX(DD8),JFCBX   CLEAR FIRST EIGHT BYTES.              29320000
         MVI   JFCBX+DD4,DDBLANK                                        29340000
         MVC   JFCBX+DD5(171),JFCBX+DD4 BLANK JFCBX                     29360000
         BR    RE                 RETURN                                29380000
SERP16   DS    0H                 ENTER FOR ASSIGN SET UP               29400000
         MVI   QPARM+QMPOP-QMNAM,QMASGN SET ASSIGN.                     29420000
         MVI   QPARM+QMPNC-QMNAM,DD1*DD16 SET ONE ASSIGN                29440000
         BR    RE                 RETURN                                29460000
SERP17   DS    0H                 ENTER FOR COMPUTE OF COUNT            29480000
         LR    R1,RF              PUT COUNT IN TWO REGISTERS            29500000
         SLL   RF,DD2             FOUR TIMES COUNT.                     29520000
         SLL   R1,DD1             TWO TIMES COUNT                       29540000
         AR    RF,R1              SIX TIMES COUNT                       29560000
         BR    RE                 RETURN                                29580000
SERP18   DS    0H                                                Y02670 29640002
         MVC   DD0(DD0,RF),DD1(R3) EXECUTED MOVE                 Y02670 29700002
SERP20   DS    0H                                                       29780000
         DC    X'00000000'                                              29800000
SERP21   DS    0H                 SUBROUTINE FOR FIRST EXTENT           29820000
         MVC   TTRS(DD3),TNEXT    SAVE TTR FOR CHAIN                    29840000
         MVC   JFCB+JFCBEXAD-INFMJFCB(DD3),TNEXT TTR IN JFCB            29860000
         BAL   RE,SERP15          FIRST JFCBX TABLE                     29880000
         BAL   RE,SERP16          ASSIGN                                29900000
         BALR  RE,R6              Q MANAGER                             29920000
         MVC   TNEXT(DD4),DD0(R5) SAVE ASSIGNED TTR                     29940000
         BR    R1                 RETURN                                29960000
SERP22   DS    0H                 SUBROUTINE TO ASSIGN EXTENSION        29980000
         MVC   DD4(DD3,R5),TTRS   TTR FOR THIS EXTENSION                30000000
         MVC   TTRS(DD3),TNEXT                                          30020000
         MVC   JFCBX(DD3),TNEXT                                         30040000
         LA    R4,JFCBX                                                 30060000
         MVI   DISPLID(R5),JFCBXID PUT BLOCK ID INTOR REMOTE   @ZA08164 30066003
*                                  LIST OF QMPA.  DESTINATION  @ZA08164 30071003
*                                  IS SWA PREFIX FOR BLOCK     @ZA08164 30076003
         ST    R4,DD0(R5)         ADDRESS TO REMOTE LIST                30081003
         BALR  RE,R6              Q MANAGER                             30086003
         MVI   DISPLID(R5),DD0    CLEAR BLOCK ID FIELD         @ZA08164 30091003
*                                 PREVENT INCORRECT            @ZA08164 30096003
*                                 IDENTIFICATION OF NEXT BLOCK @ZA08164 30101003
*                                 WRITTEN                      @ZA08164 30106003
         BAL   RE,SERP15          SET UP JFCB                           30120000
         MVC   TNEXT(DD4),DD0(R5) SAVE TTR                              30140000
         BR    R1                 RETURN TO CALLER             @ZA08164 30160003
SERP23   DS    0H                                                       30180000
         MVI   QPARM+QMPOP-QMNAM,QMWRTE SET WRITE                       30200000
         LA    R4,JFCBX                                                 30220000
         ST    R4,DD0(R5)         IN REMOTE LIST                        30240000
         MVC   DD4(DD3,R5),TTRS         TTR IN LIST                     30260000
         MVI   DISPLID(R5),JFCBXID PUT BLOCK ID INTO REMOTE LIST Y02621 30270002
         BALR  RE,R6              Q MANAGER                             30280000
* AFTER BLOCK IS WRITTEN, CLEAR BLOCK ID IN REMOTE LIST TO       Y02621 30284002
* PREVENT INCORRECT IDENTIFICATION OF NEXT BLOCK WRITTEN. SWA    Y02621 30288002
* MGR USES  THIS ID IF NONZERO. IF ZERO, IT WILL USE ID IN BLOCK.Y02621 30292002
         MVI   DISPLID(R5),DD0     ZERO ID IN REMOTE LIST        Y02621 30296002
         BAL   RE,SERP15          CLEAR JFCBX BUFFER           @ZA08164 30298003
         BR    R1                                                       30300000
         EJECT                                                          30301002
***********************************************************      Y02668 30302002
*                                                         *      Y02668 30303002
*                DEST KEYWORD PROCESSING ROUTINE          *      Y02668 30304002
*                                                         *      Y02668 30305002
***********************************************************      Y02668 30306002
         SPACE                                                          30307002
DESTP    DS    0H                                                Y02668 30308002
         L     RF,TEXTBUFP         ESTABLISH ADDRESSABILITY      Y02668 30309002
         USING TEXT,RF             ON INTERNAL TEXT STRING       Y02668 30310002
         TM    STRDINDC,DTXSYOUT   SYSOUT SPECIFIED?             Y02668 30311002
         BZ   DESTP1               NO, IGNORE KEY                Y02668 30312002
         DROP  RF                                                Y02668 30313002
         BALR  RE,R8               GO TO TEST AND STORE ROUTINE  Y02668 30314002
DESTP1   DS    0H                                                Y02668 30315002
         BALR  RE,R9               GO GET NEXT KEY               Y02668 30316002
         EJECT                                                          30316102
*        ***************************************************     Y02668 30316202
*        *                                                 *     Y02668 30316302
*        *         BUFMAX KEYWORD PROCESSING ROUTINE       *     Y02668 30316402
*        *                                                 *     Y02668 30316502
*        ***************************************************     Y02668 30316602
BUFMAXP  DS    0H                                                Y02668 30317302
         BALR  RE,R8              GO TO TEST & STORE             Y02668 30317602
         CLI   JFCB+JFCBUFMX-INFMJFCB,DD2 BUFMAX LESS THAN TWO?  Y02668 30317902
         BL    BUFMAXP1           YES ERROR                      Y02668 30318202
         BALR  RE,R9              GO GET NEXT KEY                Y02668 30318502
BUFMAXP1 DS    0H                                                Y02668 30318802
         MVI   JFCB+JFCBUFMX-INFMJFCB,DD0 ZERO BUFMAX FIELD      Y02668 30319102
         MVI   MSGSEC,ERMES135    MOVE IN ERROR MSG              Y02668 30319402
         B     CLEANUP                                           Y02668 30319702
         EJECT                                                          30320000
***********************************************************      Y02668 30320602
*                                                         *      Y02668 30321202
*              COPIES KEYWORD PROCESSING ROUTINE          *      Y02668 30321802
*                                                         *      Y02668 30322402
***********************************************************      Y02668 30323002
         SPACE                                                          30323602
COPIESP  DS    0H                                                Y02668 30324202
         BALR  RE,R8               GO TO TEST AND STORE ROUTINE  Y02668 30327802
         CLI   MSGSEC,DD0          CHECK FOR ERROR MESSAGE       Y02668 30328402
         BE    COPIESP1           NO, GO CHECK FOR ZERO VALUE    Y02668 30329002
         MVI   MSGSEC,DD0          ZERO MSGSEC                   Y02668 30329602
         B     COPIESP2                                          Y02668 30330202
COPIESP1 DS    0H                                                Y02668 30330802
         CLI   SIOT+SIOTOUTC-INDMSIOT,DD0 ZERO VALUE SPEC'D?     Y02668 30331402
         BNE   COPIESP3           NO, GO TO GET NEXT KEY         Y02668 30332002
COPIESP2 DS    0H                                                Y02668 30332602
         MVI   SIOT+SIOTOUTC-INDMSIOT,JCOPIES2 MOVE IN DEFAULT   Y02668 30333202
         MVI   MSGKEY,DD0         CLEAR MSG FIELD                Y02668 30333802
         LA    R2,WRNMSG02        PUT MSG IN REG. FOR VGM        Y02668 30335002
         L     RF,DIEFVGM          GET MESSAGE MODULE ADDRESS    Y02668 30335602
         BALR  RE,RF               GO PRINT OUT MESSAGE          Y02668 30336202
         MVI   MSGKEY,COPIESK      RESTORE KEY FOR POSSIBLE    @Z40MPTH 30337403
*                                  ERROR MESSAGE               @Z40MPTH 30338003
COPIESP3 DS    0H                                              @Z40MPTH 30338603
         BALR  RE,R9              GET NEXT KEY OR PARAMETER    @Z40MPTH 30339203
         MVI   MSGSEC,DD0         DEFAULT PROCESSING REQUIRES  @Z40MPTH 30339803
*              THAT AN ERROR MSG BE DETECTED FROM IEFVGT.      @Z40MPTH 30340403
         SR    RF,RF              CLEAR WORK REGISTER...       @Z40MPTH 30341003
         LA    RF,JFCBEX+JFCGROUP-INGMJFCE  ADDRESS OF SUB N   @Z40MPTH 30341603
*              FIELD IN ORDER TO STEP THRU ONE AT A TIME..     @Z40MPTH 30342203
COPIESP4 DS    0H                 LOOP TO STEP THRU SUB N'S    @Z40MPTH 30342803
         LTR   R2,R2              IS SUBLIST POSIT. NULL       @Z40MPTH 30343403
         BZ    COPIESR1           YES,INVALID FORMAT ERROR..   @Z40MPTH 30344003
         BALR  RE,R8              PUT SUBLIST VALUE INTO JFCBE.@Z40MPTH 30344603
         CLI   MSGSEC,DD0         DID IEFVGT DETECT AN ERRO ?  @Z40MPTH 30345203
         BNE   CLEANUP            YES,GO TO CLEANUP WITH MSG   @Z40MPTH 30345803
*              CODE INSERTED BY IEFVGT.NO DEFAULTS FOR SUBLISTS@Z40MPTH 30346403
         CLI   DD0(RF),DD0        BINARY SUBLIST VALUE ZERO ?  @Z40MPTH 30347003
         BE    COPIESR2           YES,INVALID NUMERIC ERROR..  @Z40MPTH 30347603
         LA    RF,DD1(RF)         POINT TO NEXT STORE POSITION @Z40MPTH 30348203
         BALR  RE,R9              GET NEXT SUBLIST VALUE OR KEY@Z40MPTH 30348803
         B     COPIESP4           CONTINUE INTERROGATING THE   @Z40MPTH 30349403
*              SUBLIST VALUES UNTIL ALL ARE FINISHED.IF MORE   @Z40MPTH 30350003
*              THAN 8 PARAMETERS ARE GIVEN,IEFVGT WILL FLAG AS @Z40MPTH 30350603
*              ERROR WHEN IT RUNS OUT OF PDT ENTRIES FOR KEY.. @Z40MPTH 30351203
         SPACE 3                                                        30351803
COPIESR1 DS    0H                                              @Z40MPTH 30352403
         MVI   MSGSEC,ERMES32     FORMAT ERROR IN COPIES KEY   @Z40MPTH 30353003
         B     CLEANUP          FAIL JOB AND EXIT....          @Z40MPTH 30353603
COPIESR2 DS    0H                                              @Z40MPTH 30354203
         MVI   MSGSEC,ERMES135    INVALID NUMERICS IN COPIES.. @Z40MPTH 30354803
         B     CLEANUP            FAIL JOB AND EXIT...         @Z40MPTH 30355403
         EJECT                                                          30356003
*              **************************************************       30356603
*              *                                                *       30360000
*              *        SPACE KEYWORD PROCESSING ROUTINE        *       30380000
*              *                                                *       30400000
*              **************************************************       30420000
         SPACE 2                                                        30440000
SPACEP   DS    0H                 PROCESS SPACE KEY.                    30460000
         LTR   R2,R2               IS REQ. SPACE PARM PRESENT           30480000
         BZ    SPACEP09            NO                                   30500000
         OI    DDSWA,DDSPSW       SET SPACE INDICATOR IN LWA.           30510001
         BCTR  R3,R0              BACK UP POINTER                Y02668 30512002
         CLI   0(R3),DD2          AT LEAST TWO PARAMETERS?      YM01593 30514002
         LA    R3,DD1(R3)         RESTORE POINTER                Y02668 30516002
         BL    SPACE10            NO, ERROR                      Y02668 30518002
         SR    RE,RE              CLEAR REGISTER                YM01865 30518202
         IC    RE,0(R3)           INSERT LTH INTO REGISTER      YM01865 30518402
         LA RE,1(RE)              ADJUST TO START OF FIELD      YM01865 30518602
         AR    RE,R3              INDEX TO NEXT LTH FIELD       YM01865 30518802
         CLI   0(RE),DD0          LENGTH EQUAL TO ZERO?         YM01865 30519002
         BE    SPACE10            YES,ERROR                     YM01865 30519202
         BALR  RE,R8              GO TO TEST & STORE                    30520000
SPACEP00 EQU   *                                                   4003 30530016
         BALR  RE,R9              GO TO GET KEY                         30540000
         TM    DDWA2,JDICTI5      WAS ABSTR SPECIFIED AS POSITIONAL?    30550001
         BO    SPACEP07           YES,RESET PDT PTR FOR ABSTR           30560001
         LTR   R2,R2              IS PRIMARY QUANTITY PRESENT?   A47563 30566001
         BZ    SPACEP09           NO,ERROR MSG-REQ. POS. MISSING A47563 30572001
         BCTR  R3,R0              DECREMENT POINTER                     30580000
         CLI   DD0(R3),DDCK       IS CHARACTER K                        30600000
         BC    EQUAL,SPACEP02     YES TRANSFER                          30620000
         CLI   DD0(R3),DDCL       IS CHARACTER L.                       30640000
         BC    EQUAL,SPACEP02     YES TRANSFER                          30660000
         CLI   DD0(R3),DDN9       IS HEX GREATER THAN NINE              30680000
         BC    HIGH,SPACEP01      YES TRANSFER                          30700000
         CLI   DD0(R3),DDN0       IS HEX CHARACTER NUMERIC.             30720000
         BC    HIGH+EQUAL,SPACEP02 YES TRANSFER                         30740000
SPACEP01 DS    0H                 ENTER                                 30760000
         CLI   DD0(R3),DD130      IS THIS SUBLIST TWO OPERANDS          30780000
         BC    EQUAL,SPACEP03     YES TRANSFER                          30800000
         CLI   DD0(R3),DD131      IS THIS SUBLIST THREE OPERANDS        30820000
         BC    NOT-EQUAL,SPACEP08 NO TRANSFER ERROR                     30840000
         LA    R3,DD1(R3)         RESTORE POINTER                       30860000
         B     SPACEP06           TRANSFER FOR SUBLIST THREE OPERANDS   30880000
SPACEP02 DS    0H                 ENTER FOR ONE OPERAND                 30900000
         LA    R3,DD1(R3)         RESTORE POINTER                       30920000
         B     SPACEP04           TRANSFER FOR ONE OPERAND.             30940000
SPACEP03 DS    0H                 ENTER FOR SUBLIST TWO OPERANDS        30960000
         LA    R3,DD1(R3)         RESTORE POINTER                       30980000
         BALR  RE,R8              GO TO TEST & STORE                    31000000
         BALR  RE,R9              GO TO GET KEY                         31020000
SPACEP04 DS    0H                 ENTER FOR ONE OPERAND                 31040000
         BALR  RE,R8              GO TO TEST & STORE                    31060000
         BALR  RE,R9              GO TO GET KEY                         31080000
         L     R1,ASPACT18        RESET POINTER TO PDT.                 31100000
SPACEP05 DS    0H                 ENTER FROM ABSTR                      31120000
         ST    R1,TCPDTP          SET LOCATION FOR TEST & STORE         31140000
SPACEP06 DS    0H                 ENTER FOR SUBLIST THREE OPERANDS      31160000
         BALR  RE,R8              GO TO TEST & STORE                    31180000
         BALR  RE,R9              GO TO GET KEY                         31200000
         B     SPACEP06           LOOP BACK                             31220000
SPACEP07 DS    0H                 ENTER FOR ABSTR                       31240000
         L    R1,ASPACT32         RESET POINTER TO PDT.                 31260000
         B     SPACEP05           TRANSFER                              31280000
SPACEP08 DS    0H                 ENTER                                 31300000
         MVI   MSGSEC,ERMES40     SUBLIST HAS TOO MANY OPERANDS.        31320001
         B     CLEANUP            GO TO CLEANUP.                        31340000
SPACEP09 DS    0H                                                       31360000
         L     R1,TNUMPX           GET NUMBER BYTE PTR             4003 31365016
         CLI   0(R1),1             IS IT ONE PARAMETER             4003 31370016
         BE    SPACEP00            YES - OVERRIDE                  4003 31375016
SPACE10  EQU   *                                                 Y02668 31377002
         MVI   MSGSEC,ERMES46      REQ. POS. PARM MISSING               31380001
         B     CLEANUP                                                  31400000
         EJECT                                                          31400502
*              **************************************************Y02668 31401002
*              *                                                *Y02668 31401502
*              *   SYSIN COUNT PROCESSING ROUTINE               *Y02668 31402002
*              *                                                *Y02668 31402502
*              **************************************************Y02668 31403002
         SPACE 2                                                        31403502
SYSINCTP DS    0H                  THE SYSIN COUNT KEY IS        Y02668 31404002
*                                  INTERNALLY USED TO COMMUNICATEY02668 31404502
*                                  TO THE INTERPRETER, THE       Y02668 31405002
*                                  NUMBER OF SYSIN RECORDS       Y02668 31405502
*                                  SPOOLED BY THE JOB ENTRY      Y02668 31406002
*                                  SUBSYSTEM.   JESS INSERTS THE Y02668 31406502
*                                  KEY AND VALUE IN TEXT AT THE  Y02668 31407002
*                                  POST SCAN EXIT (VFA), IN THE  Y02668 31407502
*                                  CONVERTER, FOR EACH DD*/DATA  Y02668 31408002
         CLI   DD0(R3),DD4         IS THE LENGTH OF THE SYSIN    Y02668 31408502
*                                  COUNT EQUAL TO 4?             Y02668 31409002
         BE    SYSINCT1            YES, CONTINUE                 Y02668 31409502
*   GO TO VHR    NO, THERE IS A SYSTEM ERROR - TREAT AS I/O ERRORY02668 31410002
*                                  PUT WTO                       Y02668 31410502
         MVI   IWARET+DD1,DD8      INDICATE I/O ERROR            Y02668 31411002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 31411502
         BR    RF                  GO TO TERMINATION             Y02668 31412002
*                                  INTERPRETER                   Y02668 31412502
SYSINCT1 DS    0H                                                Y02668 31413002
         L     RF,SCT+SCTSMF-INSMSCT GET CURRENT COUNT OF SYSIN  Y02668 31413502
*                                  RECORDS FOR THIS STEP         Y02668 31414002
         MVC   SCT+SCTSMF-INSMSCT(DD4),DD1(R3) OVERLAY WITH SYSINY02668 31414502
*                                  COUNT FOR THIS DD */DATA      Y02668 31415002
         A     RF,SCT+SCTSMF-INSMSCT INCREMENT CURRENT STEP COUNTY02668 31415502
*                                  WITH CURRENT DD */DATA COUNT  Y02668 31416002
         ST    RF,SCT+SCTSMF-INSMSCT SAVE UPDATED COUNT IN SCT   Y02668 31416502
*                                  THE INDIVIDUAL STEP COUNTS    Y02668 31417002
*                                  ARE LATER TOTALED AND PLACED  Y02668 31417502
*                                  IN THE JMR (VHH)              Y02668 31418002
         BALR  RE,R9               GO TO GET THE NEXT KEY        Y02668 31418502
         EJECT                                                          31420000
*              **************************************************       31440000
*              *                                                *       31460000
*              *      SUBALLOC KEYWORD PROCESSING ROUTINE       *       31480000
*              *                                                *       31500000
*              **************************************************       31520000
         SPACE 2                                                        31540000
SUBALLOP DS    0H                 PROCESS SUBALLOC KEY.                 31560000
         CLI   DD0(R3),DD0        IS PARAMETER LENGTH ZERO?      A37598 31570020
         BZ    SUBALLO            YES, NULLIFY SUBALLOC= PARM.   A37598 31572020
         BALR  RE,R8              GO TO TEST & STORE                    31580000
SUBALLO  BALR  RE,R9              GO TO GET KEY                  A37598 31600020
         BCTR  R3,R0              DECREMENT POINTER                     31620000
         CLI   DD0(R3),DDCK       IS CHARACTER K.                       31640000
         BC    EQUAL,SUB02        YES TRANSFER                          31660000
         CLI   DD0(R3),DDCL       IS CHARACTER L.                       31680000
         BC    EQUAL,SUB02        YES TRANSFER                          31700000
         CLI   DD0(R3),DDN9       IS HEX GREATER THAN NINE              31720000
         BC    HIGH,SUB01         YES TRANSFER.                         31740000
         CLI   DD0(R3),DDN0       IS HEX GREATER OR EQUAL ZERO.         31760000
         BC    HIGH+EQUAL,SUB02   YES TRANSFER                          31780000
SUB01    DS    0H                 ENTER                                 31800000
         CLI   DD0(R3),DD131      IS THIS HEX 83.                       31820000
         BC    EQUAL,SUB03        YES TRANSFER                          31840000
         CLI   DD0(R3),DD130      IS THIS HEX 82.                       31860000
         BC    NOT-EQUAL,SUB10    NO TRANSFER ERROR.                    31880000
         LA    R3,DD1(R3)         RESTORE POINTER                       31900000
         B     SUB04              TRANSFER                              31920000
SUB02    DS    0H                 ENTER FOR ONE OPERAND                 31940000
         LA    R3,DD1(R3)         RESTORE POINTER                       31960000
         B     SUB05              TRANSFER                              31980000
SUB03    DS    0H                 ENTER FOR SUBLIST THREE OPERANDS.     32000000
         LA    R3,DD1(R3)         RESTORE POINTER.                      32020000
         BALR  RE,R8              GO TO TEST & STORE                    32040000
         BALR  RE,R9              GO TO GET KEY.                        32060000
SUB04    DS    0H                 ENTER TWO OPERANDS                    32080000
         BALR  RE,R8              GO TO TEST & STORE                    32100000
         BALR  RE,R9              GO TO GET KEY                         32120000
SUB05    DS    0H                 ENTER ONE OPERAND                     32140000
         BALR  RE,R8              GO TO TEST & STORE                    32160000
         BALR  RE,R9              GO TO GET KEY.                        32180000
         CLI   DD0(R3),DD0        IS LENGTH BYTE ZERO.                  32200000
         BC    EQUAL,SUB11        YES TRANSFER ERROR.                   32220000
         BCTR  R3,R0              DECREMENT POINTER                     32240000
         CLI   DD0(R3),DDN9       IS CHARACTER GREATER THAN NINE        32260000
         BC    HIGH,SUB06         YES TRANSFER                          32280000
         CLI   DD0(R3),DDN0       IS CHARACTER GREATER EQUAL ZERO       32300000
         BC    HIGH+EQUAL,SUB07   YES TRANSFER.                         32320000
SUB06    DS    0H                 ENTER                                 32340000
         CLI   DD0(R3),DD130      IS THIS HEX 82.                       32360000
         BC    EQUAL,SUB06A       YES, TEST IF THIS STEP         A27043 32380019
         CLI   DD0(R3),DD131      IS THIS HEX 83                        32400000
         BC    NOT-EQUAL,SUB12    NO, TRANSFER ERROR             A27043 32402019
*                                 TESTING FOR STEPNMME.PROCSTEP. A27043 32404019
*                                 DDNAME                         A27043 32406019
*                                                                A27043 32408019
*                                 R2 HAS  LNGTH OF FIRST PARM    A27043 32410019
         BCTR  R2,R0              DECREMENT FOR COMPARE          A27043 32412019
*                                 THE IWA FIELDS TENDP,CURLE AND A43671 32412401
*                                 LASLE HAVE BEEN EQUATED TO     A43671 32412801
*                                 TSAVEP TO PROVIDE AN AREA FOR  A43671 32413201
*                                 THE NAME COMPARISON.           A43671 32413601
         MVC   TSAVEP(DD8),BLANKS CLEAR NAME EXPANSION FIELD.    A43671 32414001
         EX    R2,SUBMOVE         MOVE NAME TO FIELD FOR CMPR.   A43671 32416001
         CLC   SCT+SCTSCLPC-INSMSCT(DD8),TSAVEP  COMPARE NAME OF A43671 32416401
*                                 STEP WHICH CALLED PROC TO PARM A43671 32416801
         BC    NOT-EQUAL,SUB08    REFERENCE TO ANOTHER STEP      A27043 32418019
         LA    R3,DD1(R3)         RESTORE POINTER                A27043 32420019
         BALR  RE,R9              GO TO GET KEY                  A27043 32422019
         BCTR  R3,R0              DECREMENT POINTER              A27043 32424019
SUB06A   DS    0H                 TEST FOR REFERENCE THIS STEP   A27043 32426019
         BCTR  R2,R0              DECREMENT FOR COMPARE          A27043 32428019
         MVI   DD0(R3),DD130       MOVE IN HEX '82' FOR SEARCH   A27043 32430019
         MVC   TSAVEP(DD8),BLANKS CLEAR NAME COMPARISON FIELD    A43671 32432001
         EX    R2,SUBMOVE         MOVE NAME TO FIELD FOR COMPR.  A43671 32434001
         CLC   SCT+SCTSNAME-INSMSCT(DD8),TSAVEP COMPARE STEPNAME A43671 32434401
*                                 IN SCT WITH NAME IN PARAMETER. A43671 32436401
         BC    NOT-EQUAL,SUB08    REFERENCE TO ANOTHER STEP.     A43671 32436801
         LA    R3,DD1(R3)         RESTORE POINTER                A27043 32438019
         BALR  RE,R9              GO TO GET KEY                  A27043 32440019
         BCTR  R3,R0              DECREMENT POINTER              A27043 32442019
SUB07    DS    0H                 ENTER FOR REFER BACK IN STEP          32460000
         OI    SIOT+SCTSBYT3-INDMSIOT,SCTVREF SET VOLREF IN STP YM05425 32470002
         MVI   DD0(R3),DD129      MOVE IN HEX 81 FOR SEARCH             32500000
SUB08    DS    0H                 ENTER                                 32520000
         LA    R3,DD1(R3)         RESTORE POINTER                       32540000
         BAL   RE,DSRTN            GO TO DICTIONARY SEARCH RTN     AACA 32560017
         MVC   SIOT+SIOTVRSB-INDMSIOT(DD3),DD2(R1) MOVE SIOT TTR.       32580000
**********************************************************************  32580502
*                                                                       32581002
*              CONVERT SUBALLOC TO NORMAL SPACE REQUEST                 32581502
*              BY MARKING MODEL DUMMY AND SETTING VOL                   32582002
*              AFFINITY BIT IN CURRENT SIOT                             32582502
*                                                                       32583002
**********************************************************************  32583502
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                 Y02661 32584002
         MVI   QPARM+QMPNC-QMNAM,DD1   SET READ FOR ONE          Y02661 32584502
         LA    RF,JFCBX                ADDRESS SIOT READ-IN AREA Y02661 32585002
         ST    RF,DD0(R5)              STORE ADDRESS IN PARM AREAY02661 32585502
         MVC   DD4(DD3,R5),DD2(R1)     PUT SIOT TTR IN PARM AREA YO2661 32586002
         BALR  RE,R6                   Q-MNGR READ MODEL DD SIOT Y02661 32586502
**********************************************************************  32587002
         OI    JFCBX+SCTSBYT1-INDMSIOT,SCTDUMMY MARK MODEL DUMMY Y02661 32587502
         NI    JFCBX+SCTSBYT1-INDMSIOT,255-SIOTGDSN-SIOTQDSN   @ZA10487 32587603
*              SO ALLOCATION WILL NOT ENQUEUE ON NULLFILE      @ZA10487 32587903
         OI    SIOT+SCTSBYT2-INDMSIOT,SCTVOLAF  SET VOL AFFINITY Y02661 32588303
         MVI   SIOT+SCTUTYPE-INDMSIOT,DDBLANK   BLANK SIOT TYPE  Y02661 32588502
         MVC   SIOT+SCTUTYPE-INDMSIOT+1(DD7),SIOT+SCTUTYPE-INDMSIOT     32589002
         LA    R0,JFCBX                         ADDRESS OF MODEL Y02661 32589502
         ST    R0,0(R5)                         TO REMOTE LIST   Y02661 32590002
         MVI   QPARM+QMPOP-QMNAM,QMWRTE         SET WRITE        Y02661 32590502
         BALR  RE,R6                    HAVE Q-MNGR WRITE MODEL  Y02661 32591002
         MVC   DD4(DD3,R5),JFCBX+SCTPJFCB-INDMSIOT JFCB TTR TO   Y02661 32591502
*                                                  REMOTE LIST   Y02661 32592002
         LA    R0,JFCBX                MODEL JFCB READ-IN AREA   Y02661 32592502
         ST    R0,DD0(R5)              STORE IN REMOTE LIST      Y02661 32593002
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                 Y02661 32593502
         BALR  RE,R6           HAVE Q-MNGR READ MODEL JFCB       Y02661 32594002
         MVI   JFCBX+JFCBDSNM-INFMJFCB,DDBLANK BLANK OUT DSNAME YM05584*32594102
                                               FOR MODEL.       YM05584 32594202
         MVC   JFCBX+JFCBDSNM-INFMJFCB+1(43),JFCBX+JFCBDSNM-INFMJFCB    32594302
         MVC   JFCBX+JFCBDSNM-INFMJFCB(8),DDNAMEP9 DSN=NULLFILE  Y02661 32594502
         CLC   JFCBX+JFCMSVGP-INFMJFCB(8),BLANKS IS MASS STORAGE VOL    32594603
*                                      GROUP SPECIFIED?        @ZA15344 32594903
         BE    SUB085                  NO,BYPASS MSVGP PROC    @ZA15344 32595003
         MVC   JFCB+JFCMSVGP-INFMJFCB(8),JFCBX+JFCMSVGP-INFMJFCB        32595403
*                                      COPY GROUP NAME FROM MODEL       32595603
*                                      JFCB TO NEW JFCB        @ZA15344 32595703
         OI    JFCB+JFCBCTRI-INFMJFCB,JFCBMSGP                          32595803
*                                      REQUEST MSVGP VOL       @ZA15344 32595903
         OI    SIOT+SCTSDISP-INDMSIOT,PRIVATE REQUEST PRIVATE  @ZA15344 32596003
SUB085   DS    0H                                              @ZA15344 32596103
         LA    R0,JFCBX                MODEL JFCB LOCATION       Y02661 32596603
         ST    R0,DD0(R5)              PUT IN REMOTE LIST        Y02661 32596703
         MVI   QPARM+QMPOP-QMNAM,QMWRTE SET WRITE JFCB           Y02661 32596803
         BALR  RE,R6           HAVE Q-MNGR WRITE JFCB            Y02661 32596903
**********************************************************************  32597002
SUB09    DS    0H                 ENTER FOR LOOP                        32600000
         BALR  RE,R9              GO TO GET KEY                         32620000
         B     SUB09              LOOP BACK                             32640000
SUBMOVE  MVC   TSAVEP(0),DD2(R3)  MOVE PARM INTO COMPARE FIELD.  A43671 32650001
SUB10    DS    0H                 ENTER                                 32660000
         MVI   MSGSEC,ERMES40     TOO MANY OPERANDS IN SPACE.           32680001
         B     CLEANUP            GO TO CLEANUP                         32700000
SUB11    DS    0H                 ENTER                                 32720000
         MVI   MSGSEC,ERMES46     NULL OPERAND IN REFER BACK            32740001
         B     CLEANUP            GO TO CLEANUP                         32760000
SUB12    DS    0H                 ENTER                                 32780000
         MVI   MSGSEC,ERMES40     TOO MANY OPERANDS IN REFER BACK       32800001
         B     CLEANUP            GO TO CLEANUP                         32820000
         EJECT                                                          32821020
*              **************************************************       32822020
*              *                                                *       32823020
*              *       SYSOUT KEYWORD PROCESSING ROUTINE        *       32824020
*              *                                                *       32825020
*              **************************************************       32826020
         SPACE  3                                                       32827020
SYSOUTP  DS    0H                  PROCESS SYSOUT KEY             20029 32828020
*                                  BYPASS SYSOUT PROCESSING IF    20029 32829020
         TM    DDSWA,DSDUMSW      DUMMY OR DYNAM SPECIFIED ON CARD?     32831001
         BO    SYSOUTP3           YES,IGNORE SYSOUT KEYWORD.   @ZA08756 32831403
         OI    DDSWA,DSSYSSW      SET SYSOUT OVERRIDE SWITCH IN LWA.    32831801
         CLI   DD0(R3),DD0         IS LENGTH OF 1ST POSITION ZERO?      32832003
*                                                              @ZA08756 32832203
         BNZ   SYSOUTP4            NO, CLASS IS SPECIFIED      @ZA08756 32832403
         LR    RE,R3               WORK REG FOR TEXT PTR       @ZA07483 32832703
         BCTR  RE,R0              DECREMENT PTR TO LOOK        @ZA07483 32832803
* AT # OF PARMS BYTE IN TEXT                                   @ZA07483 32833003
         CLI   DD0(RE),DD1         IS SYSOUT NULLIFIED?        @ZA08756 32833103
         BE    SYSOUTP1            YES,DONT MARK AS SYSOUT     @ZA07483 32833303
* CONDITION OF SYSOUT WITH FIRST POSITION NULL AND ANOTHER     @ZA15012 32833503
* PARAMETER SPECIFIED. DEFAULT SYSOUT CLASS TO MSGCLASS        @ZA15012 32834003
         MVC   SIOT+SCTOUTPN-INDMSIOT(DD1),JCT+JCTJMGPO-INJMJCT         32834503
*                                                              @ZA15012 32835003
*                                 MOVE MSGCLASS FROM JCT       @ZA15012 32835503
         OI    SIOT+SCTSBYT3-INDMSIOT,JSYSOUT3  SYSOUT BIT ON  @ZA15012 32836003
         OI    JFCB+JFCBTSDM-INFMJFCB,JSYSOUT0  MARK JFCB      @ZA15012 32836503
         OI    JFCB+JFCBLTYP-INFMJFCB,JSYSOUT6  STANDARD LABEL @ZA15012 32837003
SYSOUTP4 DS    0H                                              @ZA08756 32838803
         OI    SIOT+SIOTBYT0-INDMSIOT,SIOTSSDS SUBSYSTEM WILL    Y02668 32839103
*                                     PROCESS THIS DATA SET      Y02668 32839403
SYSOUTP2 EQU   *                                               @ZA07483 32839703
         BALR  RE,R8               GO TO TEST AND STORE          Y02668 32840002
SYSOUTP1 BALR  RE,R9               GO TO GET KEY                 Y02668 32845002
         B     SYSOUTP2            LOOP BACK                   @ZA07483 32850003
SYSOUTP3 DS    0H                                              @ZA08756 32851003
         BALR  RE,R9               GO TO GET KEY               @ZA08756 32852003
         B     SYSOUTP3            LOOP THRU GET KEY TO SPACE  @ZA08756 32853003
*                                  BEYOND INTERNAL TEXT FOR    @ZA08756 32854003
*                                  SYSOUT WITH MULTIPLE        @ZA08756 32855003
*                                  PARAMETERS                  @ZA08756 32856003
         EJECT                                                          32858003
*              *****************************************       @Y30OPTD 32860003
*              *                                       *       @Y30OPTD 32863003
*              *    COMMON MULTIOPERAND ROUTINE        *       @Y30OPTD 32866003
*              *    DOESN'T FLAG NULL KEYWORDS         *       @Y30OPTD 32869003
*              *    FLAGS NULL POSITIONS AS ERRORS     *       @Y30OPTD 32872003
*              *                                       *       @Y30OPTD 32875003
*              *****************************************       @Y30OPTD 32878003
         SPACE 2                                               @Z40MPTH 32878603
FLASHP   DS    0H                                              @Z40MPTH 32879203
MODIFYP  DS    0H                                              @Z40MPTH 32879803
CHARSP   DS    0H                                              @Z40MPTH 32880403
         SPACE 2                                               @Y30OPTD 32881003
DSIDP    DS    0H                                              @Y30OPSB 32884003
         LTR   R2,R2               IS OPERAND LENGTH ZERO      @Y30OPTD 32887003
         BNZ   VDACOM2             NO - GO TO PROCESS OPERAND  @Y30OPTD 32890003
         BCTR  R3,0                YES - GET PARAMETER # PTR   @Y30OPTD 32893003
         CLI   DD0(R3),DD1         IS THIS A NULL OPERAND      @Y30OPTD 32896003
         BNE   VDACOM3             NO - GO TO ERROR            @Y30OPTD 32899003
         BALR  RE,R9               YES - GO TO GET NEXT KEY    @Y30OPTD 32902003
VDACOM1  DS    0H                  LOOP TO PROCESS OPERANDS    @Y30OPTD 32905003
         LTR   R2,R2               IS OPERAND LENGTH ZERO      @Y30OPTD 32908003
         BZ    VDACOM3             YES - GO TO ERROR           @Y30OPTD 32911003
VDACOM2  DS    0H                  NO - PROCESS OPERAND        @Y30OPTD 32914003
         BALR  RE,R8               GO TO TEST & STORE          @Y30OPTD 32917003
         BALR  RE,R9               GO TO GET KEY               @Y30OPTD 32920003
         B     VDACOM1             LOOP TO PROCESS NEXT OPERAND@Y30OPTD 32923003
VDACOM3  DS    0H                  ERROR EXIT                  @Y30OPTD 32926003
         MVI   MSGSEC,ERMES43      1EF643I UNDEF. POSIT.PARAM. @Y30OPTD 32929003
         B     CLEANUP             GO TO CLEAN UP ROUTINE      @Y30OPTD 32932003
         EJECT                                                          32935003
*              *********************************************            32938003
*              *                                           *            32941003
*              * UNIT AFF AND SEP KEYWORD PROCESSING RTN.  *            32944003
*              *                                           *            32947003
*              *********************************************            32950003
         SPACE 2                                                        32960000
AFFMP    DS    0H                 PROCESS UNIT AFF KEY                  32980000
         L     RE,TEXTBUFP        LOAD TEXT STRING POINTER     @ZA08746 32980203
         USING TEXT,RE            SET ADDRESSABILITY TO PREFIX @ZA08746 32980403
         TM    STRDINDC,DTXSYOUT  WAS SYSOUT SPECIFIED?        @ZA08746 32980603
         BO    AFFSEP02           YES, IEGNORE AFF/SEP         @ZA08746 32980903
         DROP  RE                 RELEASE THE REGISTER         @ZA08746 32981603
         TM    DDSWA,DDUNSW       INVALID UNIT AFFINITY SETUP DETECTED? 32982001
*                                 UNIT=(,,,AFF=DDNAME,,) IS EXAMPLE.    32984001
         BZ    AFF00               NO, CONTINUE NORMALLY.       YM01578 32984402
         MVI   MSGKEY,UNITK      PUT UNIT KEY IN FOR ERROR        M0491 32986018
*                                MESSAGE                          M0491 32988018
         B     SUB12             GO PUT OUT ERROR MSSG, EXCESSIVE M0491 32990018
*                                NUMBER OF POSITIONAL PARAMETERS  M0491 32992018
*                                IN UNIT PARM                     M0491 32994018
AFF00    DS    0H                                               YM01578 33000002
         LTR   R2,R2               IS REQ. PARM PRESENT           19432 33006017
         BZ    SPACEP09            NO                             19432 33012017
         LA    RF,SIOT+SCTUSADD-INDMSIOT GET ADDRESS IN SIOT            33020000
         BCTR  R3,R0              DECREMENT TEXT POINTER                33040000
         CLI   DD0(R3),DD0        IS THE NUMBER BYTE ZERO               33060000
         BC    NOT-ZERO,AFFSEP01  NO TRANSFER TO COMMON ROUTINE         33080000
         MVI   MSGSEC,ERMES46     ERROR NO OPERAND                      33100001
         B     CLEANUP            GO TO CLEANUP                         33120000
AFFSEP01 DS    0H                 ENTRY FOR COMMON PROCESSING.          33140000
         SR    R0,R0              CLEAR REGISTER.                       33160000
         IC    R0,DD0(R3)         GET NUMBER BYTE                       33180000
         LA    R3,DD1(R3)         RESTORE TEXT POINTER                  33200000
         B     AFFSEP03           TRANSFER                              33220000
AFFSEP02 DS    0H                 ENTRY FOR LOOP.                       33240000
         BALR  RE,R9              GO TO GET KEY.                        33260000
AFFSEP03 DS    0H                 FIRST ENTRY.                          33280000
         CLI   DD0(R3),DD0        IS LENGTH BYTE ZERO.                  33300000
         BC    EQUAL,AFFSEP04     YES TRANSFER ERROR.                   33320000
         BCTR  R3,R0              DECREMENT TEXT POINTER.               33340000
         MVI   DD0(R3),DD129      PUT HEX 81 FOR DICTIONARY SEARCH.     33360000
         LA    R3,DD1(R3)         RESTORE TEXT POINTER                  33380000
         BAL   RE,DSRTN            GO TO DICTIONARY SEARCH RTN     AACA 33400017
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ                        33420000
         MVI   QPARM+QMPNC-QMNAM,DD1 SET FOR ONE READ                   33440000
         MVC   DD4(DD3,R5),DD2(R1) PUT TTR OF SIOT IN REMOTE LIST       33460000
         LA    R1,JFCBX           GET ADDRESS OF AREA FOR SIOT.         33480000
         ST    R1,DD0(R5)         PUT ADDRESS IN REMOTE LIST.           33500000
         BALR  RE,R6              GO TO Q MANAGER                       33520000
*                            ENSURE AFF/SEP TO EARLIER DD STMT:   20602 33523018
*                            PREVENT SLIP THRU DSRTN ERROR CHECK  20602 33526018
*                            BY USE OF KEYWORD PARAMETER 'DDNAME' 20602 33529018
         CLC   SIOT+SCTDDINO-INDMSIOT(2),JFCBX+SCTDDINO-INDMSIOT Y02668 33532002
         BNH   DCBP10        TO SET UP ERRMSG & GO TO CLEANUP     20602 33535018
         MVC   DD0(DD2,RF),JFCBX+SCTDDINO-INDMSIOT MOVE DD NO.  YM00392 33540002
         LA    RF,DD1(RF)         BUMP POINTER TO SIOT                  33560000
         BCT   R0,AFFSEP02        LOOP BACK FOR NEXT OPERAND.           33580000
         BALR  RE,R8               GO TO TEST AND STORE.        YM01578 33600002
         TM    SIOT+SCTSBYT1-INDMSIOT,SCTUNAFF UNIT AFF SPEC?    A42970 33602001
         BZ    AFFSEP3A           NO                             A42970 33602401
         MVC   SIOT+SCTUTYPE-INDMSIOT+5(DD3),JFCBX+SIOTDSKA-INDMSIOT   *33602802
                                   MOVE SVA OF REFERENCED SIOT. YM00384 33604802
         MVI   SIOT+SCTUTYPE-INDMSIOT+4,X'FF'                    Y02668 33606802
*                                  INDICATE TTR PRESENT          Y02668 33608802
* TEST SIOT TO SEE IF AFF OR SEP REQUESTED TO DUMMY DATA SET      16670 33612401
AFFSEP3A TM    JFCBX+SCTSBYT1-INDMSIOT,SCTDUMMY   SIOT READ IN   A42970 33617001
*                                              BY QMGR FOR DD DUMMY6670 33621601
         BO    AFFSEP10       IF AFF OR SEP ATTEMPTED TO DUMMY    16670 33626201
AFFSEP05  DS   0H                                                 16670 33630801
         BALR  RE,R9              GO TO GET KEY                         33635401
AFFSEP04 DS    0H                 ENTRY FOR ERROR                       33640000
         MVI   MSGSEC,ERMES46     ERROR NULL OPERAND                    33660001
         B     CLEANUP            GO TO CLEANUP.                        33680000
AFFSEP10 DS    0H   SPECIAL PROCESSING FOR REFERBACK TO DD DUMMY  16670 33681017
         TM    SIOT+SCTSBYT1-INDMSIOT,SCTUNAFF    UNIT AFF SPECIFIED?   33682001
         BO    DUMMY0        GO SET DUMMY BIT IF UNIT AFF TO DUMMY16670 33683017
         B     AFFSEP05            RETURN TO NORMAL PROCESSING    16670 33684017
         EJECT                                                          33685017
*                                                                       33686017
*    GET VCON FOR DICTIONARY SEARCH RTN AND GO THERE               AACA 33687017
*       ( RE HAS RET ADDR )                                        AACA 33688017
*                                                                       33689017
DSRTN    DS    0H                                                       33690017
         STM   RE,RF,TSAVEP        TEMP SAVE                       AACA 33691017
         L     RF,DIEFVGS          DICTIONARY SEARCH RTN           AACA 33692017
         BALR  RE,RF               GO TO DICTIONARY SEARCH         AACA 33693017
         LM    RE,RF,TSAVEP        RESTORE                         AACA 33694017
         BR    RE                  RET                             AACA 33695017
         EJECT                                                    20002 33695120
*              ************************************************** 20002 33695220
*              *                                                * 20002 33695320
*              * BUFIN KEYWORD PROCESSING ROUTINE               * 20002 33695420
*              *                                                * 20002 33695520
*              ************************************************** 20002 33695620
BUFINP   DS    0H                                                 20002 33695720
         BALR  RE,R8                   GOTO TEST AND STORE        20002 33695820
         IC    R0,DDWA61               GET CVBED BYTE             20002 33695920
         SLL   R0,4          MOVE INTO HIGH ORDER 4 BITS          20002 33696020
         STC   R0,DDWA61               INTO WORK AREA FOR BUFIN   20002 33696120
         MVZ   JFCB+JFCBUFIN-INFMJFCB(1),DDWA61   INTO JFCB       20002 33696220
         BALR  RE,R9                   GOTO GETKEY                20002 33696320
         EJECT                                                    20002 33696420
*              ************************************************** 20002 33696520
*              *                                                * 20002 33696620
*              *BUFOUT KEYWORD PROCESSING ROUTINE               * 20002 33696720
*              *                                                * 20002 33696820
*              ************************************************** 20002 33696920
BUFOUTP  DS    0H                                                 20002 33697020
         BALR  RE,R8                   GOTO TEST AND STORE        20002 33697120
         MVN   JFCB+JFCBFOUT-INFMJFCB(1),DDWA61  LOW 4 BITS       20002 33697220
         BALR  RE,R9                   GOTO GETKEY                20002 33697320
         EJECT                                                    20002 33697420
*              ************************************************** 20002 33697520
*              *                                                  20002 33697620
*              * PCI KEYWORD PROCESSING ROUTINE                   20002 33697720
*              *                                                  20002 33697820
*              ************************************************** 20002 33697920
PCIP     DS    0H                                                 20002 33698020
*                   ZERO OUT IN JFCB TO CLEAR BYTE FOR REFERBACKS 20002 33698120
         XC    JFCB+JFCPCI-INFMJFCB(1),JFCB+JFCPCI-INFMJFCB       20002 33698220
PCIP1    BALR  RE,R8                   GOTO TEST AND STORE        20002 33698301
         BALR  RE,R9                   GOTO GETKEY                20002 33698420
         B     PCIP1              LOOP TO GET NEXT POSITIONAL PARAM.    33699101
         EJECT                                                    20002 33700901
*        ******************************************************** 20002 33701601
*        *                                                        20002 33702301
*        * RESERVE KEYWORD PROCESSING ROUTINE                     20002 33703001
*        *                                                        20002 33703701
*        ******************************************************** 20002 33704401
RESERVEP  DS   0H                                                 20002 33705101
*                  ZERO OUT FOUR BYTES IN JFCB FOR REFERBACKS     20002 33705801
         XC    JFCB+JFCRESRV-INFMJFCB(2),JFCB+JFCRESRV-INFMJFCB  Y02668 33706502
NXPARM   BALR  RE,R8                   GOTO TEST AND STORE        20002 33707201
         BALR  RE,R9                   GOTO GET KEY               20002 33707901
         B     NXPARM                  PROCESS NEXT SUBPARAMETER  20002 33708601
         EJECT                                                          33709301
*              **************************************************21088  33710001
*              *                                                 *21088 33712001
*              *     FUNC KEYWORD PROCESSING ROUTINE             *21088 33714001
*              *                                                 *21088 33716001
*              ***************************************************21088 33718001
FUNCP    DS    0H                                                 21088 33718401
         BALR  RE,R8              CLEAR BYTE IN JFCB              21088 33718801
         LTR   R2,R2              IS PARM NULL                    21088 33719201
         BZ    FUNCP01            YES                             21088 33719601
         OI    JFCB+JFCBFLG2-INFMJFCB,JFCBBUFF SET BIT TO INDICATE21088 33719701
*                                 TO OPEN THAT A NON-ZERO VALUE   21088 33719801
*                                 IN JFCBOTTR FIELD IS NOT A      21088 33719901
*                                 TTR                             21088 33726601
FUNCP01  SR    R1,R1                                              21088 33728601
         IC    R1,0(R4)           COUNT BYTE IN PDT               21088 33730601
         LA    R4,0(R1,R4)        BUMP TEST AND STORE POINTER     21088 33732601
         BALR  RE,R8              SET BITS                        21088 33733001
         BALR  RE,R9              GET KEY                        Y02668 33733102
         EJECT                                                          33734102
*               ***********************************************@G29AN2E 33735103
*               *                                             *@G29AN2E 33735203
*               *    SUBSYS KEYWORD PROCESSING ROUTINE        *@G29AN2E 33735303
*               *                                             *@G29AN2E 33735403
*               ***********************************************@G29AN2E 33735503
         SPACE 1                                                        33735603
SUBSYSP  DS    0H                                              @G29AN2E 33735703
         SPACE 1                                                        33735803
***************************************************************@G29AN2E 33735903
*                                                             *@G29AN2E 33736003
*   ON ENTRY, R2=LENGTH OF PARM                               *@G29AN2E 33736103
*             R3=POINTER TO LENGTH BYTE                       *@G29AN2E 33736203
*                                                             *@G29AN2E 33736303
*   THIS ROUTINE DETERMINES THE LENGTH OF THE SSWA THAT IS    *@G29AN2E 33736403
*   NEEDED. THE LENGTH OF THE SSWA= LENGTH OF THE SSWA HEADER *@G29AN2E 33736503
*   + THE LENGTHS OF EACH LEN-SSPARM PAIR. (THE LENGTH OF THE *@G29AN2E 33736603
*   LEN BYTE=1.  THE LENGTH OF THE SSPARM IS THE VALUE IN     *@G29AN2E 33736703
*   THE LEN BYTE.)                                            *@G29AN2E 33736803
*                                                             *@G29AN2E 33736903
*   AS INTERNAL TEXT IS SCANNED TO DETERMINE THE SIZE OF THE  *@G29AN2E 33737003
*   SSWA THE FOLLOWING INFORMATION IS GATHERED AND STORED IN  *@G29AN2E 33737103
*   THE FOLLOWING FIELDS:                                     *@G29AN2E 33737203
*                                                             *@G29AN2E 33737303
*            NUMBER OF SSPARMS - SSPRMNO                      *@G29AN2E 33737403
*            LENGTH OF SSNAME - SSNML                         *@G29AN2E 33737503
*            ADDRESS OF SSNAME - SSNMPTR                      *@G29AN2E 33737603
*            ADDRESS OF FIRST LEN-SSPARM PAIR - SSPRMPTR      *@G29AN2E 33737703
*                                                             *@G29AN2E 33737803
*   AFTER THE FIRST LEN-SSPARM PAIR IS REACHED, REGISTER USAGE*@G29AN2E 33737903
*   IS AS FOLLOWS:                                            *@G29AN2E 33738003
*             R1  COUNT OF SSPARMS REMAINING TO BE ACCOUNTED  *@G29AN2E 33738103
*             RE  RUNNING TOTAL LENGTH OF SSWA                *@G29AN2E 33738203
*             RF  MOVING POINTER TO POSITION IN INTERNAL TEXT *@G29AN2E 33738303
*                                                             *@G29AN2E 33738403
*   AFTER THE LENGTH OF THE SSWA IS DETERMINED,A PARM LIST    *@G29AN2E 33738503
*   AND AN EXTERNAL PARM AREA IS BUILT FOR THE SWA MANAGER    *@G29AN2E 33738603
*   FOR LOCATE MODE. THE SWA LOCATE MODE FLAG IS SET IN THE   *@G29AN2E 33738703
*   COMWA AND BALR TO VHQ IS TAKEN TO ASSIGN LOCATE THE SSWA. *@G29AN2E 33738803
*   ON RETURN THE SSWA IS BUILT AND WRITTEN TO SWA. THEN      *@G29AN2E 33738903
*   THE SSWA IS LINKED TO THE SIOT.                           *@G29AN2E 33739003
*                                                             *@G29AN2E 33739103
*   A BALR TO TEST AND STORE ROUTINE TO PROCESS THE PDT IS    *@G29AN2E 33739203
*   TAKEN. THE SUBSYSTEM NAME IS MOVED TO THE SIOT, THE       *@G29AN2E 33739303
*   SIOTSSGP AND SIOTSSDS FLAGS ARE TURNED ON IN THE SIOT AND *@G29AN2E 33739403
*   THE JFCSDS FLAG TURNED ON IN THE JFCB.                    *@G29AN2E 33739503
*                                                             *@G29AN2E 33739603
*   NOTE: DURING THE CLEANUP ROUTINE, IF SUBSYS HAS BEEN      *@G29AN2E 33739703
*   SPECIFIED, THE JFCBIND2 IS SET FOR MOD DISPOSITION.       *@G29AN2E 33739803
*                                                             *@G29AN2E 33739903
***************************************************************@G29AN2E 33740003
         SPACE 1                                                        33740103
         TM    DDSWA,DSDUMSW  HAS DUMMY BEEN PROCESSED?        @ZM44657 33740203
         BO    SUBSYSP3       YES, IGNORE SUBSYS PARM          @ZM44657 33740303
         OI    DDSWA,DDSUBSW  INDICATE SUBSYS PROCESSING       @ZM44657 33740403
         XC    SUBSYSWA,SUBSYSWA CLEAR WORK AREA               @G29AN2E 33740503
         BCTR  R3,DD0         POINT TO # BYTE                  @G29AN2E 33740603
         XR    R1,R1          CLEAR WORK REG                   @G29AN2E 33740703
         IC    R1,DD0(R3)     GET TOTAL NUMBER OF PARMS        @G29AN2E 33740803
*                             (SSNAME + ALL SSPARMS)           @G29AN2E 33740903
         BCTR  R1,DD0         GET NO. OF SSPARMS               @G29AN2E 33741003
         STC   R1,SSPRMNO     SAVE NO. OF SSPARMS              @G29AN2E 33741103
         LA    R3,DD1(R3)     POINT TO LENGTH BYTE             @G29AN2E 33741203
         LR    RF,R3          GET ADDR OF LENGTH BYTE          @G29AN2E 33741303
         LA    RE,DD1(RF)     GET ADDR OF SSNAME IN INT. TEXT  @G29AN2E 33741403
         ST    RE,SSNMPTR     SAVE ADDR OF SSNAME              @G29AN2E 33741503
         STC   R2,SSNML       SAVE LENGTH OF SSNAME            @G29AN2E 33741603
         AR    RF,R2          ADD LENGTH OF THIS PARM TO ADDR  @G29AN2E 33741703
*                             OF LENGTH BYTE                   @G29AN2E 33741803
         LA    RF,DD1(RF)      ADD IN 1 TO ACCT FOR LEN BYTE   @G29AN2E 33741903
         ST    RF,SSPRMPTR     RF NOW POINTS TO FIRST LEN-PARM @G29AN2E 33742003
*                              PAIR                            @G29AN2E 33742103
         XR    RE,RE           INITIALIZE TO ZERO LENGTH       @G29AN2E 33742203
         LTR   R1,R1           ARE THERE ANY SSPARMS TO PROCESS@G29AN2E 33742303
         BZ    SUBSYSP2        NO, JUST NEED SSWA HEADER       @G29AN2E 33742403
         XR    R0,R0           CLEAR WORK REG                  @G29AN2E 33742503
SUBSYSP1 DS   0H                                               @G29AN2E 33742603
         IC    R0,DD0(RF)      GET LEN BYTE                    @G29AN2E 33742703
         AR    RE,R0           ADD LENGTH OF PARM TO TOTAL     @G29AN2E 33742803
         LA    RE,DD1(RE)      ADD IN LENGTH OF LEN BYTE       @G29AN2E 33742903
         AR    RF,R0           MOVE PTR BY NO. OF CHAR IN PARM @G29AN2E 33743003
         LA    RF,DD1(RF)      SHIFT OVER 1 MORE BYTE          @G29AN2E 33743103
*        RF NOW POINTS TO NEXT LEN-SSPARM PAIR IF IT EXISTS    @G29AN2E 33743203
         BCT   R1,SUBSYSP1     MORE TO PROCESS?                @G29AN2E 33743303
SUBSYSP2 DS   0H                                               @G29AN2E 33743403
         LA    RE,SSWAHDRL(RE) ADD LENGTH OF SSWA HEADER       @G29AN2E 33743503
*                              RE NOW HAS SIZE OF SSWA         @G29AN2E 33743603
*        REGISTER 5 POINTS TO THE REMOTE PARM LIST AREA,QLINKWA@G29AN2E 33743703
         USING ZB505,R5        SUBSYSWA=QLINKWA=SWA LOC EPA    @G29AN2E 33743803
         ST    RE,SWLNGTH      SAVE LENGTH OF SSWA             @G29AN2E 33743903
         MVI   SWBLKID,SSWAID  INDICATE SSWA TYPE              @G29AN2E 33744003
         DROP  R5                                              @G29AN2E 33744103
         MVC   LOCFNCD,AL      FUNC CODE = ASSIGN LOCATE MODE  @G29AN2E 33744203
         LA    R0,SSEPA        GET ADDR OF EPA                 @G29AN2E 33744303
         ST    R0,SSEPAP       SAVE ADDR OF EPA                @G29AN2E 33744403
         LA    R0,SSEPAP       GET ADDR OF EPAPTR              @G29AN2E 33744503
         ST    R0,SSEPAPTR     STORE ADDR OF EPAPTR            @G29AN2E 33744603
         LA    R0,LOCFNCD      GET ADDR OF FUNC CODE           @G29AN2E 33744703
         ST    R0,LOCFNCP      SAVE ADDR TO FUNC CODE          @G29AN2E 33744803
         OI    LOCFNCP,X'80'   TURN ON HIGH ORDER BIT TO       @G29AN2E 33744903
*                              SIGNIFY END OF PARMLIST         @G29AN2E 33745003
         LA    R0,LOCPLIST     GET ADDR OF PARM LIST           @G29AN2E 33745103
         ST    R0,AOLOCPL      SAVE ADDR IN COMWA              @G29AN2E 33745203
         OI    AOSW4,AOSWALOC  INDICATE LOCATE MODE TO VHQ     @G29AN2E 33745303
         BALR  RE,R6           GO TO IEFVHQ                    @G29AN2E 33745403
         USING ZB505,R5        R5 POINTS TO SUBSYSWA           @G29AN2E 33745503
         L     RF,SWBLKPTR     GET ADDR OF SSWA                @G29AN2E 33745603
         USING SSWA,RF                                         @G29AN2E 33745703
         OI    SSWATYPE+1,SSWASYST SHOW SYSTEM CREATED SSWA    @G29AN2E 33745803
         MVI   SSWASSNM,C' '   BLANK OUT FIRST BYTE            @G29AN2E 33745903
         MVC   SSWASSNM+1(DD3),SSWASSNM BLANK OUT FIELD        @G29AN2E 33746003
         L     R1,SSNMPTR      GET ADDR OF SSNAME IN INT. TEXT @G29AN2E 33746103
         XR    RE,RE           CLEAR WORK REG                  @G29AN2E 33746203
         IC    RE,SSNML        GET LENGTH OF SSNAME            @G29AN2E 33746303
         BCTR  RE,DD0          DECREMENT FOR MOVE              @G29AN2E 33746403
         EX    RE,MVCSSNM      MOVE SSNAME TO SSWA             @G29AN2E 33746503
         MVC   SSWAPRNO+1(DD1),SSPRMNO MOVE NUMBER OF SSPARMS  @G29AN2E 33746603
         LA    R0,SSWAHDRL     GET SSWA HDR LENGTH             @G29AN2E 33746703
         L     R1,SWLNGTH      GET LEN OF SSWA                 @G29AN2E 33746803
         SR    R1,R0           SUBTRACT THE LENGTH OF HEADER   @G29AN2E 33746903
         LA    R0,SSWAPREN     GET ADDR OF 'TO' MOVE POSITION  @G29AN2E 33747003
         DROP  RF                                              @G29AN2E 33747103
         LR    RF,R1           GET LENGTH TO BE MOVED          @G29AN2E 33747203
         L     RE,SSPRMPTR     GET ADDR OF 'FROM' POSITION     @G29AN2E 33747303
         MVCL  R0,RE           MOVE ALL LEN-SSPARM PAIRS       @G29AN2E 33747403
         MVC   LOCFNCD,WL      FUNC CODE = WRITE LOCATE        @G29AN2E 33747503
         OI    AOSW4,AOSWALOC  INDICATE LOCATE MODE TO VHQ     @G29AN2E 33747603
         BALR  RE,R6          GO TO IEFVHQ TO WRITE SSWA TO SWA@G29AN2E 33747703
         MVC   SIOT+SIOTSSWA-INDMSIOT(DD3),SWVA                @G29AN2E 33747803
*                              LINK SSWA TO SIOT               @G29AN2E 33747903
         BALR  RE,R8           GO TO TEST AND STORE            @G29AN2E 33748003
SUBSYSP3 DS    0H                                              @G29AN2E 33748103
         BALR  RE,R9           GO TO GET KEY ROUTINE           @G29AN2E 33748203
         B     SUBSYSP3        LOOP TO GET KEY UNTIL ALL       @G29AN2E 33748303
*                              POSITIONALS ARE PROCESSED AND A @G29AN2E 33748403
*                              NEW KEY IS FOUND AND ANOTHER    @G29AN2E 33748503
*                              BRANCH TAKEN                    @G29AN2E 33748603
         USING SSWA,RF                                         @G29AN2E 33748703
         SPACE 1                                               @G29AN2E 33748803
MVCSSNM  MVC   SSWASSNM(DD0),DD0(R1) MOVE SSNAME FROM INTERNAL @G29AN2E 33748903
*                             TEXT TO SSWA                     @G29AN2E 33749003
         DROP  R5                                              @G29AN2E 33749103
         DROP  RF                                              @G29AN2E 33749203
AL       DC    CL2'AL'         ASSIGN LOCATE FUNC CODE         @G29AN2E 33749303
WL       DC    CL2'WL'         WRITE LOCATE FUNC CODE          @G29AN2E 33749403
         EJECT                                                 @G29AN2E 33749503
************************************************************   @G24LPSJ 33749603
*                                                          *   @G24LPSJ 33749703
*         SUBROUTINE TO PROCESS MSVGP KEYWORD              *   @G24LPSJ 33749803
*                                                          *   @G24LPSJ 33749903
************************************************************   @G24LPSJ 33750003
MSVGPP   DS    0H                                              @G24LPSJ 33750103
         LR    RF,R2           SAVE LENGTH OF FIRST PARM       @G24LPSJ 33750203
         BALR  RE,R8           GO TO TEST & STORE ROUTINE      @G24LPSJ 33750303
*                              FOR PDT PROCESSING              @G24LPSJ 33750403
         BALR  RE,R9           GET NEXT KEY                    @G24LPSJ 33750503
         L     R1,CVTADDR      LOAD CVT ADDRESS                @G24LPSJ 33750603
         USING CVT,R1          ESTABLISH CVT ADDRESSIBILITY    @G24LPSJ 33750703
         L     R1,CVTIHASU     LOAD SUBMIT MASK ADDRESS        @G24LPSJ 33750803
         USING SUBITS,R1       ESTABLISH SUBIT ADDRESSABILITY  @G24LPSJ 33750903
         TM    SUBYTE4,SU24BIT TEST FOR MSS R3 (SU24)          @G24LPSJ 33751003
         BNO   MSVGP640        BRANCH TO ERROR IF NO SU24      @G24LPSJ 33751103
         LTR   RF,RF           TEST LANGTH OF 1ST PARAMETER    @G24LPSJ 33751203
         BZ    MSVGP646        BRANCH TO ERROR IF NO 1ST PARM  @G24LPSJ 33751303
         LTR   R2,R2           TEST FOR 2ND PARAMETER          @G24LPSJ 33751403
         BZ    MSVGPNKY        IF NONE, GO TO NEXT KEY         @G24LPSJ 33751503
         BCTR  R3,R0           DECREMENT TEXT POINTER          @G24LPSJ 33751603
         MVI   DD0(R3),DD129   PUT HEX 81 FOR DICTIONARY       @G24LPSJ 33751703
         LA    R3,DD1(R3)      RESTORE TEXT POINTER            @G24LPSJ 33751803
         BAL   RE,DSRTN        GO TO DICTIONARY SEARCH RTN     @G24LPSJ 33751903
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET QMGR READ          @G24LPSJ 33752003
         MVI   QPARM+QMPNC-QMNAM,DD1    SET FOR ONE READ       @G24LPSJ 33752103
         MVC   DD4(DD3,R5),DD2(R1) PUT SVA ON SIOT IN REMOTE LIST       33752203
*                                                              @G24LPSJ 33752303
         LA    R1,JFCBX        GET ADDRESS OF AREA FOR SIOT    @G24LPSJ 33752403
         ST    R1,DD0(R5)      STORE ADDRESS IN REMOTE LIST    @G24LPSJ 33752503
         BALR  RE,R6           GO TO QMGR FOR READ             @G24LPSJ 33752603
         CLC   JFCBX+SCTDDINO-INDMSIOT(DD2),SIOT+SCTDDINO-INDMSIOT      33752703
*                              VERIFY REFER BACK TO EARLIER DD          33752803
*                                                              @G24LPSJ 33752903
         BNL   MSVGP645        IF NOT, GO TO ERROR             @G24LPSJ 33753003
         MVC   SIOT+SIOTVLSP-INDMSIOT(DD2),JFCBX+SCTDDINO-INDMSIOT      33753103
*                              INSERT SIOT NUMBER FOR VL SEP   @G24LPSJ 33753203
MSVGPNKY BALR  RE,R9           GO TO GET NEXT KEY              @G24LPSJ 33753303
MSVGP640 MVI   MSGSEC,ERMES40  SET IEF640I MSG KEY             @G24LPSJ 33753403
         B     CLEANUP         GO TO CLEANUP RTN               @G24LPSJ 33753503
MSVGP646 MVI   MSGSEC,ERMES46  SET IEF646I MSG KEY             @G24LPSJ 33753603
         B     CLEANUP         GO TO CLEANUP RTN               @G24LPSJ 33753703
MSVGP645 MVI   MSGSEC,ERMES45  SET IEF645I MSG KEY             @G24LPSJ 33753803
         B     CLEANUP         GO TO CLEANUP RTN               @G24LPSJ 33753903
         EJECT                                                 @G24LPSJ 33754003
************************************************************     Y02668 33754103
*                                                          *     Y02668 33754203
*         SUBROUTINE TO PROCESS DATA SET NAME TABLE        *     Y02668 33754303
*                                                          *     Y02668 33754403
************************************************************     Y02668 33754503
         SPACE                                                          33754603
DSNTP    DS    0H                                                Y02668 33754703
         ST    RE,DSNTPSA          SAVE CALLER'S ADDRESS         Y02668 33754803
         CLI   DD0(R3),DD44       IS DSNAME LONGER THAN 44       Y02668 33754903
         BC    HIGH,DSNTP7        YES TRANSFER ERROR.            Y02668 33755003
         LA    R4,DSNAME          GET DSN TABLE ADDRESS          Y02668 33755103
         USING DSNTABLE,R4        ESTABLISH ADDRESSIBILITY       Y02668 33755203
         LA    R1,DD168           LOAD REGISTER WITH 168         Y02668 33755303
         L     RF,SCT+SCTLDSTB-INSMSCT GET RELATIVE LENGTH       Y02668 33755403
*                                       DSNAME TABLE             Y02668 33755503
         LTR   RF,RF              IS IT ZERO.                    Y02668 33755603
         BC    NOT-ZERO,DSNTP1    NO TRANSFER                    Y02668 33755703
         OI    SWC,DSNTQ          SET DSNAME TO ENQUEUE SWITCH.  Y02668 33755803
         MVC   SCT+SCTADSTB-INSMSCT(DD4),TNEXT  DSN TTR IN SCT   Y02668 33755903
         BAL   RE,DSNTP6          SET UP DSNAME TABLE            Y02668 33756003
         BAL   RE,SERP16          SET UP ASSIGN                  Y02668 33756103
         BALR  RE,R6              GO TO Q MANAGER                Y02668 33756203
         MVC   TNEXT(DD4),DD0(R5) SAVE ASSIGNED TTR              Y02668 33756303
         B     DSNTP3             TRANSFER                       Y02668 33756403
DSNTP1   DS    0H                 ENTER                          Y02668 33756503
         SR    RF,R1              SUBTRACT 168 FROM REL LENGTH   Y02668 33756603
         BC    LOW,DSNTP2         TRANSFER OUT                   Y02668 33757302
         BC    HIGH,DSNTP1        LOOP BACK                      Y02668 33758202
         MVC   DSNTNSVA,TNEXT     GET NEW DSNAME TABLE           Y02668 33759102
         ST    R4,DD0(R5)         PUT ADDR IN REMOTE PARM LIST   Y02668 33760902
         MVC   DD4(DD3,R5),DSNTSVA PUT TTR IN REMOTE LIST        Y02668 33761802
         BALR  RE,R6              GO TO Q MANAGER                Y02668 33762702
         BAL   RE,DSNTP6          SET UP DSNAME TABLE            Y02668 33763602
         MVC   TNEXT(DD4),DD0(R5) SAVE ASSIGNED TTR              Y02668 33764502
         B     DSNTP3             TRANSFER                       Y02668 33765402
DSNTP2   DS    0H                 ENTER                          Y02668 33766302
         AR    RF,R1              RESTORE LENGTH POSITIVE        Y02668 33767202
DSNTP3   DS    0H                 ENTER                          Y02668 33768102
         SR    R1,RF              GET SPACE AVAIL IN DSN TABLE.  Y02668 33769002
         CLR   R2,R1              IS ROOM IN TABLE FOR DSNAME    Y02668 33769902
         BC    LOW+EQUAL,DSNTP4   YES TRANSFER                   Y02668 33770802
         L     RF,SCT+SCTLDSTB-INSMSCT NO GET RELATIVE LENGTH    Y02668 33771702
         AR    RF,R1              ADD TO GET TO END OF TABLE     Y02668 33772602
         ST    RF,SCT+SCTLDSTB-INSMSCT RESET RELATIVE LENGTH     Y02668 33773502
         B     DSNTP              TRANSFER                       Y02668 33774402
DSNTP4   DS    0H                 ENTER                          Y02668 33775302
         LA    R1,DSNENTRY        GET ENTRY ADDRESS              Y02668 33776202
         USING DSNENTRY,R1                                       Y02668 33776802
         LA    R1,0(RF,R1)        UPDATE PTR TO NEXT ENTRY       Y02668 33777402
         BCTR  R2,R0              DECREMENT LENGTH FOR EXECUTE   Y02668 33786102
         EX    R2,DSNTP5          EXECUTE MOVE                   Y02668 33787002
         LA    R2,DD1(R2)         RESTORE LENGTH                 Y02668 33787902
         L     RF,SCT+SCTLDSTB-INSMSCT GET RELATIVE LTH FROM SCT Y02668 33788802
         AR    RF,R2              BUMP RELATIVE LENGTH           Y02668 33789702
         ST    RF,SCT+SCTLDSTB-INSMSCT PUT NEW REL LENGTH IN SCT Y02668 33790602
         SR    RF,R2         RESET TO ORIGINAL OFFSET TO STORE  YM05563 33791002
         TM    SWC,VOLREF         VOL REF DSN?                 @ZA01890 33791503
         BZ    DSNTP4C            NO, GO PROCESS DCB DSN         Y02668 33792402
         STH   RF,SIOT+SIOVDSNT-INDMSIOT    VOL REF OFFSET-SIOT YM05563 33792802
         STC   R2,SIOT+SIOVDSNL-INDMSIOT PUT LENGTH IN SIOT      Y02668 33793302
         L     RE,DSNTPSA         RESTORE CALLER'S ADDRESS       Y02668 33794202
         BR    RE                RETURN TO CALLER                Y02668 33795102
DSNTP4C  DS    0H                                                Y02668 33796002
         STH   RF,SIOT+SIODSNTE-INDMSIOT  DCB DSN OFFSET-SIOT   YM05563 33796402
         STC   R2,SIOT+SIODDSNL-INDMSIOT DCB DSN LENGTH IN SIOT  Y02668 33796902
         L     RE,DSNTPSA         RESTORE CALLER'S ADDRESS       Y02668 33797802
         BR    RE                 RETURN TO CALLER               Y02668 33798702
DSNTP5   DS    0H                 NOT ENTER                      Y02668 33799602
         MVC   DSNENTRY(DD0),DD1(R3)   EXECUTED MOVE             Y02668 33800502
DSNTP6   DS    0H                 ENTER                          Y02668 33801402
         XC    DSNTABLE(176),DSNTABLE ZERO DSNAME TABLE          Y02668 33802302
         MVC   DSNTSVA(DD3),TNEXT PUT TTR IN DSNAME TABLE        Y02668 33803202
         OI    DSNTID,DSNTTID     PUT ID IN TABLE                Y02668 33804102
         BR    RE                 RETURN                         Y02668 33805002
         DROP  R1                                                Y02668 33805302
         DROP  R4                                                Y02668 33805602
DSNTP7   DS    0H                 ENTER                          Y02668 33805902
         MVI   MSGSEC,ERMES42     ERROR DSNAME TOO LONG          Y02668 33806802
         B     CLEANUP            GO TO CLEANUP.                 Y02668 33807702
         EJECT                                                          33810102
*              **************************************************       33811102
*              *                                                *       33812102
*              *                 CLEANUP ROUTINE                *       33813102
*              *                                                *       33814102
*              **************************************************       33815102
         SPACE 2                                                        33820000
CLEANUP  DS    0H                 CLEAN UP PROCESSING                   33840000
         SR    R2,R2              CLEAR IT                         AABA 33843016
         IC    R2,MSGSEC          GET ERROR MSG CODE               AABA 33846016
         LTR   R2,R2              IS THERE ERROR  (ZERO = NO ERROR)AABA 33849016
         BZ    CLEAN00            NO - 60 CHECK FOR WARNING MSG    AABA 33852016
         OI    JCT+JCTJSTAT-INJMJCT,INCMSTS  TURN ON JCT JOB FAIL BIT.  33854001
         L     RF,DIEFVGM         GET MESSAGE ROUTINE              AABA 33858016
         BALR  RE,RF              GO TO MSG RTN - ISSUE MSG        AABA 33861016
CLEAN00  DS    0H                 ENTRY TO CHECK FOR WARNING MSG   AABA 33864016
         IC    R2,DWRNMSG         GET WARNING MSG CODE             AABA 33867016
         LTR   R2,R2              IS THERE A WARNING MSG           AABA 33870016
         BZ    CLEAN004            NO, CONTINUE.                 Y02668 33873002
         MVC   MSGKEY(1),DWRNKEY   YES- GET SECONDARY MSG          AABA 33876016
         L     RF,DIEFVGM         GET MESSAGE ROUTINE              AABA 33879016
         BALR  RE,RF                   AND GO TO MSG ROUTINE AND   AABA 33882016
*                                      DO NOT FAIL JOB.            AABA 33885016
CLEAN004 DS    0H                  CHECK IF DD DYNAM             Y02668 33990002
         TM    SWY2,DYNAMSW        IS THIS A DD DYNAM STMT?      Y02668 33990702
         BO    CLEAN156            BR YES TO UPDATE SIOT CHAIN, YM02717*33991402
                                   BYPASS CREATING SIOT FOR     YM02717*33991802
                                   DYNAMIC DD.                  YM02717 33992202
*  NON-DYNAM DD.                                                YM02717 33992602
         TM    SIOT+SCTSBYT1-INDMSIOT,SIOTJSCT  IS JOBCAT,       Y02113 33993002
*             STEPCAT ASSOCIATION BIT ON.IF YES TEST FOR CATL.  Y02113  33993302
         BZ    CLEANA04    BITS BOTH NOT ON- CONTINUE NORMALLY   Y02113 33993602
         TM    SIOT+SCTSBYT2-INDMSIOT,SIOTCATL  IS THE CATALOG   Y02113 33993902
*              BIT ON.IF YES,THEN BOTH SIOTJSCT AND SIOTCATL     Y02113 33994202
*              ARE ON.                                           Y02113 33994502
         BZ    CLEANA04    BITS BOTH NOT ON- CONTINUE NORMALLY   Y02113 33994802
         CLI   SIOT+SCTDDNAM-INDMSIOT,DDBLANK IS DDNAME BLANK?   Y02113 33995102
         BNE   CLEANA04     NOT BLANK-CONTINUE NORMALLY.         Y02113 33995402
*****************************************************************Y02113 33995702
*                                                                       33996002
*              UNIQUE NAME FORMAT IS AS FOLLOWS:                        33996302
*                                                                       33996602
*              HEX '7CDDDD4040404040'                                   33996902
*              DDDD - TWO BYTE DD NUMBER ASSIGNED TO SIOT PER STEP      33997202
*                                                                       33997502
*****************************************************************Y02113 33997802
         MVI   SIOT+SCTDDNAM-INDMSIOT,ATSIGN PUT IN SPECIAL CHAR Y02113 33998102
         MVC   SIOT+SCTDDNAM-INDMSIOT+1(DD2),SIOT+SCTDDINO-INDMSIOT     33998402
*        MOVE DD NUMBER FROM SIOT DDNUMBER FIELD TO NAME FIELD   Y02113 33998702
CLEANA04 DS    0H                                                Y02668 33999002
         TM    AOSW2,AOMAXERR      OVER 1635 STATIC DD'S  ?      Y02668 33999102
         BO    CLEAN154            YES  BYPASS CLEANUP , EXIT    Y02668 33999702
         TM    SWI,DSNLIT          IS THIS DSN IN QUOTES                34000417
         BZ    CLEAN009            NO BYPASS                            34000817
         SPACE                                                          34001217
         SR    R2,R2               INITIALIZE R2 (USED AS SWITCH)       34001617
         TM    SIOT+SIOTALTD-INDMSIOT,JDISP12  IS ALT DISP=CATLG        34002017
         BZ    CLEAN007                                                 34002417
         LA    R2,ERMES48          INVALID DISP MSG                AACA 34002801
         MVI   SIOT+SIOTALTD-INDMSIOT,JDISP10  SET DISP TO KEEP    AACA 34003217
CLEAN007 DS    0H                                                  AACA 34003617
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP12  IS DISP=CATLG       AACA 34004017
         BZ    CLEAN008                                            AACA 34004417
         LA    R2,ERMES48                                          AACA 34004801
         MVI   SIOT+SCTSDISP-INDMSIOT,JDISP10  SET DISP TO KEEP    AACA 34005217
CLEAN008 DS    0H                                                  AACA 34005617
         LTR   R2,R2               ANY DISP=CATLG DETECTED         AACA 34006017
         BZ    CLEAN009            NO                              AACA 34006417
*                                  YES- ISSUE WARNING MSG          AACA 34006817
         MVI   MSGKEY,SUBKEEP                                      AACA 34007217
         L     RF,DIEFVGM                                          AACA 34007617
         BALR  RE,RF                                               AACA 34008017
CLEAN009 DS    0H                                                  AACA 34008417
         CLI   SIOT+SCTNMBUT-INDMSIOT,DD0 IS UNIT NUMBER ZERO.          34060000
         BC    NOT-EQUAL,CLEAN011 NO TRANSFER.                          34080000
         MVI   SIOT+SCTNMBUT-INDMSIOT,DD1 YES. SET UNIT NUMBER TO ONE.  34100000
CLEAN011 DS    0H                 ENTER.                                34120000
         TM    SWI,IWADDNM         IS THIS DDNAME =             PTM1028 34126018
         BO    CLEAN08             YES, TRANS                   PTM1028 34132018
         CLI   JFCB+JFCBVLCT-INFMJFCB,DD1 IS VOLUME COUNT ONE           34160000
         BC    HIOREQ,CLEAN013   TRANSFER IF = OR> THAN 1        A26075 34190019
         MVI   JFCB+JFCBVLCT-INFMJFCB,DD1 ZERO SET TO ONE               34220000
CLEAN013 DS    0H                 ENTER.                                34340000
         TM    JFCB+JFCBLTYP-INFMJFCB,JFCBLP  IS LABEL=BLP SPECIFIED    34350001
         BZ    CLEAN014                        NO - TRANSFER            34360000
         NI    JFCB+JFCBLTYP-INFMJFCB,255-JFCBLP   CLEAR LABEL=BLP BIT  34370001
         OC    JFCB+JFCBLTYP-INFMJFCB(1),DINBPLP1  SET BLP DEFAULT      34380000
CLEAN014 DS    0H                 ENTER.                                34420000
         CLI   JFCB+JFCBCRDT-INFMJFCB,DD0 IS THERE A CREATE DATE        34440000
         BC    NOT-EQUAL,CLEAN015 YES TRANSFER.                         34460000
         L     R4,AEXPDTT         RESET POINTER TO PDT                  34480000
         ST    R4,TPDTP           PROCESSING IN PDT                168  34500000
         L     R1,AEXPDTT2         ADR OFCREATE DATE IN PDT        168  34520000
         ST    R1,TCPDTP                                           168  34540000
         BAL   R1,CLEAN20         SET UP CREATE DATE                    34560000
CLEAN015 DS    0H                 ENTER.                                34580000
*                                                                       34600000
*   CHECK IF ENOUGH JFCB EXTENSIONS HAVE BEEN ASSIGNED                  34620000
*                                                                       34640000
         CLI   MSGSEC,X'00'        ARE THERE ANY ERRORS?       @ZA08690 34646003
         BNZ   CLEAN01D            YES, DON'T DO JFCBX PROC.   @ZA08690 34650003
         SR    R2,R2                                                    34660000
         SR    R3,R3                                                    34680000
         CLC   JFCB+JFCBVLCT-INFMJFCB(DD1),SIOT+SCTNMBUT-INDMSIOT 02668 34700002
*                                  IS THE VOL CT GREATER THAN    Y02668 34702002
*                                  THE UNIT COUNT?               Y02668 34704002
         BH    CLEAN016            YES, USE IT TO CALCULATE      Y02668 34706002
*                                  NUMBER OF JFCBX'S NEEDED      Y02668 34708002
         IC    R2,SIOT+SCTNMBUT-INDMSIOT NO,USE UNIT COUNT       Y02668 34710002
         B     CLEAN017            CHECK AGAINST VOL SER COUNT   Y02668 34712002
CLEAN016 DS    0H                                                Y02668 34714002
         IC    R2,JFCB+JFCBVLCT-INFMJFCB INSERT VOL COUNT        Y02668 34716002
CLEAN017 DS    0H                                                Y02668 34718002
         IC    R3,JFCB+JFCBNVOL-INFMJFCB VOLUME SERIAL COUNT            34720000
         CLR   R2,R3              MORE JFCB EXTENTS NEEDED              34740000
         BC    LOW+EQUAL,CLEAN01D  NO-CONTINUE CLEANUP            18931 34760017
         LA    R1,DD5             YES -  IS VOL COUNT                   34780000
         SR    R2,R1                     GREATER THAN 5.                34800000
         BC    NOT-HIGH,CLEAN01D  NO -  CONTINUE CLEANUP                34820000
         SR    R3,R1              YES - HAS ONE EXTENT ALREADY          34840000
         BC    HIGH,CLEAN01A            BEEN ASSIGNED.                  34860000
         BAL   R1,SERP21          NO - ASSIGN ONE                       34880000
         BAL   R1,SERP23          WRITE JFCBX TO Q                      34900000
CLEAN01A DS    0H                 ENTRY - AT LEAST ONE EXTENT ASSIGNED  34920000
         LA    R1,DD15                                                  34940000
CLEAN01B DS    0H                 ENTRY FOR LOOP TO DETERMIN            34980000
         SR    R2,R1                    NUMBER OF EXTENTS               35000000
         SR    R3,R1                    ALREADY ASSIGNED.               35020000
         BC    HIGH,CLEAN01B      LOOP BACK IF VOL SER COUNT POSITIVE   35040000
         LTR   R2,R2              IS VOL COUNT (JFCBVLCT) POSITIVE      35060000
CLEAN01C DS    0H                                                       35080000
         BC    LOW+EQUAL,CLEAN01D TRANSFER ENOUGH ASSIGNED              35100000
*                                 SET FIELD JFCBX TO CONTENTS OF A22532 35102018
*                                 PREVIOUSLY CHAINED EXTENSION TOA22532 35104018
*                                 PRESERVE CHAINED JFCBX'S DATA  A22532 35106018
         MVI   QPARM+QMPOP-QMNAM,QMREAD      SET READ            A22532 35108018
         MVI   QPARM+QMPNC-QMNAM,DD1     SET FOR 1 READ          A22532 35110018
         MVC   DD4(DD3,R5),TTRS    PUT JFCBX TTR IN REMOTE LIST  A22532 35112018
         LA    R1,JFCBX                GET ADDR OF JFCBX AREA    A22532 35114018
         ST    R1,DD0(R5)              PUT ADDR IN REMOTE LIST   A22532 35116018
         BALR  RE,R6                   GO TO Q MGR               A22532 35118018
         BAL   R1,SERP22          VOL COUNT POSITIVE - ASSIGN EXTENT    35120000
         BAL   R1,SERP23                                       @ZA08164 35130003
         LA    R1,DD15                                                  35140000
         SR    R2,R1                                                    35160000
         B     CLEAN01C                                                 35180000
CLEAN01D DS    0H                 ENTRY - ALL EXTENTS ASSIGNED OK       35200000
         TM    SIOT+SCTSBYT3-INDMSIOT,JDISP14  IS FIRST DISP OPERAND?   35210001
         BM    CLEAN02            YES,CHECK DISP VALUE.                 35220001
         OI    SIOT+SCTSBYT3-INDMSIOT,JDISP2   TURN ON BIT FOR NEW.     35230001
         OI    JFCB+JFCBIND2-INFMJFCB,JFCNEW   TURN ON BIT FOR NEW.     35240001
CLEAN02  DS    0H                 ENTER                                 35244018
         TM    SIOT+SCTSBYT3-INDMSIOT,JDISP2   DISP=NEW SPECIFIED?      35252001
         BZ    CLEAN02A           NO - CONTINUE                   18874 35260001
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP15      HAS A SECONDARY      35268001
*                                 DISPOSITION BEEN SPECIFIED?           35270001
         BNZ   CLEAN02A           YES - CONTINUE                  18874 35276001
         OI    SIOT+SCTSDISP-INDMSIOT,JDISP9   TURN ON SECONDARY        35284001
*                                 DISPOSITION OF DELETE IN SIOT.        35286001
CLEAN02A   DS   0H                                                18874 35292018
         CLI   JFCB+JFCBDSNM-INFMJFCB,DDBLANK IS THERE DSNAME           35340000
         BC    EQUAL,CLEAN05      NO TRANSFER.                          35360000
         CLC   JFCB+JFCBDSNM-INFMJFCB(8),UNQNAME IS THIS A         0750 35380000
*                                 A UNIQUE NAME                    0750 35400000
         BE    CLEAN08            YES TRANSFER                     0750 35420000
         TM    SIOT+SCTSBYT1-INDMSIOT,SCTDUMMY      IS THIS DUMMY?      35440001
         BNO   CLEAN02B           NO CONTINUE                  @ZA07503 35460003
         NI    JFCB+JFCBIND1-INFMJFCB,DD255-JFCGDG  TURN OFF GDG-       35461003
*                                  JFCB                        @ZA07503 35461103
         NI    SIOT+SCTSBYT4-INDMSIOT,DD255-JDSNAME4 TURN OFF GDG IN    35461303
*                                        SIOT INDICATOR        @ZA07503 35462003
         B     CLEAN08                        TRANSFER         @ZA07503 35463003
CLEAN02B TM    SIOT+SIOTBYT0-INDMSIOT,SIOTSSDS SUBSYSTEM DS?   @ZA07503 35466003
         BO    CLEAN08             YES, DO NOT ENTER IN DSENQT. YM00362 35472002
         L     RF,DIEFVDB         GET VCON FOR DATA INTEGRITY           35480000
         BALR  RE,RF              GO TO DATA INTEGRITY.                 35500000
         B     CLEAN08            TRANSFER                              35520000
CLEAN04  DS    0H                 NOT ENTERED BUT EXECUTED.             35540000
         MVC   JFCB+JFCBDSNM-INFMJFCB+DD23(DD1),JCT+JCTJNAME-INJMJCT    35560000
CLEAN05  DS    0H                 ENTERED                               35580000
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTGDSN  TEMP DSNMAE BIT  Y02668 35590002
         CLI   SIOT+SCTOUTPN-INDMSIOT,DDBLANK IS THERE SYSOUT           35600000
         BC    NOT-EQUAL,CLEAN051 YES TRANSFER                          35620000
         TM    SIOT+SCTSBYT2-INDMSIOT,JUNIT7  UNIT DEFER BIT SET?       35670001
         BO    CLEAN051           YES,BRANCH TO CONTINUE.               35680001
         TM    SIOT+SCTSBYT3-INDMSIOT,JDISP18  OLD OR SHARE SPECIFIED?  35690001
         BO    CLEAN051           YES,BRANCH TO CONTINUE.               35692001
         OI    JFCB+JFCBIND2-INFMJFCB,JFCTEMP  SET TEMP. D.S. BIT.      35694001
CLEAN051 DS    0H                 ENTER                                 35700000
         LH    R1,UNNU            GET UNIQUE NAME SERIAL NUMBER         35720000
         LA    R1,DD1(R1)         BUMP NUMBER                           35740000
         STH   R1,UNNU            SAVE NUMBER                           35760000
         CVD   R1,DDWA7           CONVERT NUMBER                        35780001
         MVC   DDWA7(DD4),DDWA7+DD4 SET UP TO UNPACK                    35800001
         UNPK  DDWA7(DD8),DDWA7(DD4) UNPACK NUMBER.                     35820001
         MVC   JFCB+JFCBDSNM-INFMJFCB(DD23),UNQNAME MOVE UNIQUE NAME.   35840000
         LA    R1,JCT+JCTJTPTN-INJMJCT-DD1 GET END OF JOB NAME          35860000
         LA    R2,DD8             SET UP LOOP COUNT                     35880000
CLEAN06  DS    0H                 ENTRY FOR LOOP.                       35900000
         CLI   DD0(R1),DDBLANK    IS CHARACTER NON BLANK                35920000
         BC    NOT-EQUAL,CLEAN07  YES TRANSFER                          35940000
         BCTR  R1,R0              DECREMENT POINTER                     35960000
         BCT   R2,CLEAN06         LOOP BACK                             35980000
CLEAN07  DS    0H                 ENTER.                                36000000
         BCTR  R2,R0              DECREMENT COUNT FOR MOVE              36020000
         EX    R2,CLEAN04         EXECUTE MOVE OF JOB NAME              36040000
         LA    R2,JFCB+JFCBDSNM-INFMJFCB+DD24(R2) GET ADDRESS END NAME. 36060000
         MVI   DD0(R2),DDPERIOD   MOVE IN PERIOD                        36080000
         MVI   DD1(R2),DDCR       MOVE IN CHARACTER R                   36100000
         NI    DDWA7+DD7,DD15     CLEAR ZONE BITS                       36120001
         OI    DDWA7+DD7,DDN0     PUT IN PROPER ZONE BITS               36140001
         MVC   DD2(DD7,R2),DDWA7+DD1 MOVE IN CONVERTED NUMBER           36160001
         OI    SIOT+SCTSBYT1-INDMSIOT,SIOTQDSN TURN ON QUALIFIED Y02113 36165002
*              QUALIFIED DSN INDICATOR BECAUSE ALL CREATED       Y02113 36170002
*              TEMPORARY DSNAMES ARE QUALIFIED BY DEFINITION.    Y02113 36175002
CLEAN08  DS    0H                 ENTER                                 36180000
         TM    DDWA2,JDICTI3      DDNAME SWITCH ON IN LOCAL WORK AREA?  36190001
         BO    CLEAN08C           YES,BRANCH TO CONTINUE.               36200003
         MVC   SIOT+SIOTDSKA-INDMSIOT(DD3),TSIOT PUT TTR OF SIOT / SIOT 36220000
         MVC   SCT+SCTLSIOT-INSMSCT(DD3),SIOT+SIOTDSKA-INDMSIOT  Y02668 36226002
*                               PUT TTR LAST SIOT IN STEP IN SCT Y02668 36232002
         MVC   SIOT+SCTPJFCB-INDMSIOT(DD3),TNEXT+DD4             Y02668 36232102
*                                 PUT TTR JFCB IN SIOT           Y02668 36232202
         MVC   SIOT+SCTPSIOT-INDMSIOT(DD3),TNEXT PUT TTR NEXT SIOT      36240000
         MVC   TSIOT(DD3),TNEXT    SET SVA FOR NEXT SIOT...    @Z40MPTH 36260003
         MVI   QPARM+QMPOP-QMNAM,QMASGN     SET ASSIGN CODE    @Z40MPTH 36270003
         MVI   QPARM+QMPNC-QMNAM,DD32   SET FOR TWO ASSIGNS..  @Z40MPTH 36280003
         BALR  RE,R6         GO TO THE SWA SWA MANAGER..       @Z40MPTH 36290003
         MVC   TNEXT(DD4),DD0(R5)    SAVE ASSIGNED SVA IN TNEXT@Z40MPTH 36300003
         MVC   TNEXT+DD4(DD4),DD4(R5)  SAVE ASSIGNED SVA...    @Z40MPTH 36310003
CLEAN08C DS    0H                      CHECK FOR JFCBE         @Z40MPTH 36320003
         TM    JFCB+JFCUCSOP-INFMJFCB,JFCBEXTP  HAS A JFCBE    @Z40MPTH 36330003
*              BEEN CREATED,BIT ON SIGNALS IT HAS BEEN BUILT.. @Z40MPTH 36340003
         BZ    CLEAN08B           DO NOT ASSIGN IT AN SVA..    @Z40MPTH 36350003
         MVC   JFCB+JFCBEXAD-INFMJFCB(DD3),TNEXT  SVA PTR TO EXT        36360003
*                                                              @Z40MPTH 36370003
         MVI   QPARM+QMPOP-QMNAM,QMASGN   SET ASSIGN CODE..    @Z40MPTH 36380003
         MVI   QPARM+QMPNC-QMNAM,DD16   SET TO ASSIGN ONE SVA..@Z40MPTH 36390003
         BALR  RE,R6         GO TO THE SWA MANAGER..           @Z40MPTH 36400003
         MVC   TNEXT(DD4),DD0(R5)      REPLACE SVA USED....    @Z40MPTH 36410003
CLEAN08B TM    DDWA2,JDICTI3      DDNAME SWITCH ON IN LOCAL    @Z40MPTH 36420003
*                                 WORK AREA?                   @Z40MPTH 36430003
         BO    CLEAN09            YES, TRANSFER                @Z40MPTH 36440003
CLEAN08A DS    0H                                              @Z40MPTH 36450003
         CLI   SIOT+SCTOUTPN-INDMSIOT,DDBLANK IS THIS SYSOUT ?   Y02668 36486002
         BC    NOT-EQUAL,CLEAN10   YES TRANSFER                  Y02668 36492002
         B     CLEAN13            TRANSFER.                             36500000
CLEAN09  DS    0H                 ENTER.                                36520000
         CLI   SIOT+SCTOUTPN-INDMSIOT,DDBLANK IS THIS SYSOUT.           36540000
         BC    EQUAL,CLEAN15      NO TRANSFER                           36560000
CLEAN10  DS    0H                 ENTER.                                36580000
         OI    SCT+SCTSTYPE-INSMSCT,X'20'  SET SYSOUT BIT IN SCT Y02668 36850002
         OI    JFCB+JFCBIND2-INFMJFCB,JFCMOD SET DISP=MOD IND.   Y02668 36860002
         NI    JFCB+JFCBIND2-INFMJFCB,X'BF' FOR SYSOUT JFCB.     Y02668 36870002
CLEAN13  DS    0H                 ENTER                                 36900000
         TM    DDWA2,JDICTI3      DDNAME SWITCH ON IN LWA.?             36910001
         BO    CLEAN15            YES,BRANCH TO CONTINUE.               36920001
         CLI   DDWA5,DD0          IS THERE A LABEL ON DD VERB           36940001
         BC    EQUAL,CLEAN15      NO TRANSFER                           36960000
         CLI   SIOT+SIODDSNL-INDMSIOT,DD0 IS THERE DCB DSN?     YM00367 36980002
         BE    CLEAN13A                 NO TRANSFER              A23350 36990019
         OI    DDWA2,JDICTI2      SET DCB DSNAME SPECIFIED SWITCH.      37000001
         B     CLEAN14                                           A23350 37022019
CLEAN13A DS    0H                                                A23350 37024019
         CLC   JFCB+JFCBXPDT-INFMJFCB(3),XPDTZERO SYMBOLIC 0?    A23350 37026019
         BNE   CLEAN14                  NO TRANSFER              A23350 37028019
* IF EXPDT IS SYMBOLIC ZERO, BUT PATTERNING ISN'T SPECIFIED,     A23350 37030019
* RESET TO ABSOLUTE ZERO                                         A23350 37032019
         XC    JFCB+JFCBXPDT-INFMJFCB(3),JFCB+JFCBXPDT-INFMJFCB  A23350 37034019
CLEAN14  DS    0H                 ENTER                                 37040000
*        JOBCAT DD CARDS ARE ENTERED INTO REFERBACK DICTIONARY  YM01882 37044002
*        BY IEFVEA ONLY IF THEY ARE CHAINED INTO STEP..         YM01882 37048002
         TM    SIOT+SIOTALTD-INDMSIOT,SIOJCATS   IS IT A JOBCAT YM01882 37052002
         BO    CLEAN15       YES,DO NOT ENTER INTO DICTIONARY.. YM01882 37056002
         MVC   DDWA3(DD3),SIOT+SIOTDSKA-INDMSIOT    MOVE SIOT TTR DICT. 37060001
         MVC   DDWA4(DD3),SIOT+SCTPJFCB-INDMSIOT    MOVE JFCBTTR DICT   37080001
         LA    R1,DDWA1           SET REGISTER FOR DICTIONARY           37100001
         L     RF,DIEFVGI         GET VCON FOR DICTIONARY               37120000
         BALR  RE,RF              GO TO ENTER DICTIONARY                37140000
CLEAN15  DS    0H                 ENTER.                                37160000
         TM    JFCB+JFCBIND2-INFMJFCB,JFCTEMP  TEMP. D.S. BIT SET?      37210001
         BZ    CLEAN152           NO,BRANCHA TO CONTINUE.               37220001
         TM    SIOT+SCTSBYT3-INDMSIOT,JDISP2   DISP NEW FOR D.S.?       37230001
         BZ    CLEAN15B           NO,BRANCH TO CONTINUE.                37232001
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP15  2ND OPERAND SPECIFIED?   37234001
         BZ    CLEAN151           NO,BRANCH TO CONTINUE.                37236001
CLEAN15B DS    0H                                                   942 37240000
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP17  PASS OR DELETE GIVEN?    37290001
         BM    CLEAN151           IF EITHER SET BRANCH TO CONTINUE.     37300001
         NI    SIOT+SCTSDISP-INDMSIOT,255-JDISP15                       37302001
*                                 CLEAR 2ND DISP OPERAND BITS.          37302401
         OI    SIOT+SCTSDISP-INDMSIOT,JDISP11  SET PASS BIT.            37304001
         CLI   MSGSEC,0      HAS THIS STMT BEEN FAILED            21349 37310018
         BNE   CLEAN151      YES-DO NOT PRINT WARNING MESSAGE     21349 37320018
         MVI   MSGKEY,SUBPASS      PASS SUB  MSG                   AACA 37330017
         LA    R2,ERMES48          INVALID DISP MSG                AACA 37360001
         L     R3,DIEFVGM         GET VCON                              37400000
         BALR  RE,R3              GO TO MESSAGE MODULE                  37420000
CLEAN151 DS    0H                 ENTER                                 37440000
         OI    SIOT+SCTSDISP-INDMSIOT,JDISP9  SET DELETE BIT.           37450001
         TM    SIOT+SIOTALTD-INDMSIOT,X'0F'  IS THERE A COND DISP  000B 37463000
         BZ    CLEAN152           NO, BRANCH                       000B 37466000
           MVI SIOT+SIOTALTD-INDMSIOT,JDISP9  INDICATE DELETE      000B 37475000
CLEAN152 DS    0H                 ENTER                                 37480000
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP15   SECONDARY DISPOSITION?  37481001
         BC    4,CLEAN52A                    BRANCH YES            000D 37482016
         TM    SIOT+SCTSBYT3-INDMSIOT,JDISP2  NEW SPECIFIED?            37482401
         BO    CLEAN52B                      BRANCH YES PUT TEMP ON     37484001
CLEAN52A EQU   *                                                   000D 37485016
         TM    SIOT+SCTSDISP-INDMSIOT,JDISP9  DISP=DELETE SPECIFIED?    37486001
         BZ    CLEAN52C            BR NO TO CONTINUE.          @G29AN2E 37487003
CLEAN52B EQU   *                                                   000D 37487603
         TM    SIOT+SCTSBYT4-INDMSIOT,JDSNAME4 IS THIS A GDG D.S.A49970 37488203
         BO    CLEAN52C            YES, DON'T SET TEMP DS BIT. @G29AN2E 37488803
         OI    JFCB+JFCBIND2-INFMJFCB,JFCTEMP SET TEM DS BIT ON YM02717 37489403
CLEAN52C DS    0H                                              @G29AN2E 37490003
         L     R1,TEXTBUFP         ADDRESSABILITY FOR          @G29AN2E 37490603
         USING TEXT,R1             TEXT STRING PREFIX          @G29AN2E 37491203
         TM    STRDINDC,DTXSUBSK   WAS SUBSYS SPECIFIED?       @G29AN2E 37491803
         BZ    CLEAN156            NO, PROCEED NORMALLY        @G29AN2E 37492403
         DROP  R1                                              @G29AN2E 37493003
         OI    JFCB+JFCBIND2-INFMJFCB,JFCMOD TURN ON MOD FLAG  @G29AN2E 37493603
         NI    JFCB+JFCBIND2-INFMJFCB,X'FF'-JFCOLD TURN OFF OLD@G29AN2E 37494203
CLEAN156 DS    0H                                               YM02717 37494803
         TM    JFCB+JFCUCSOP-INFMJFCB,JFCBEXTP  HAS A JFCBE    @Z40MPTH 37495403
*              BEEN CREATED,BIT ON SIGNALS IT HAS BEEN BUILT.. @Z40MPTH 37496003
         BZ    CLEAN56A           NO,DON'T WRITE IT TO SWA...  @Z40MPTH 37496603
         CLI   JFCBEX+JFCBMAGT-INGMJFCE,X'40' FLASH ID PRESENT?@Z40MPTH 37497203
         BE    CLEAN55A            NO - BYPASS FLASH DEFAULT   @Z40MPTH 37497803
         CLI   JFCBEX+JFCIMTOT-INGMJFCE,X'00' COUNT PRESENT ?  @Z40MPTH 37498403
         BNE   CLEAN55A            YES - BYPASS FLASH DEFAULT  @Z40MPTH 37499003
         MVI   JFCBEX+JFCIMTOT-INGMJFCE,FLASHCNT               @ZM40103 37499603
*                        DEFAULT FLASH COUNT TO 255            @ZM40103 37500203
CLEAN55A DS    0H                                              @Z40MPTH 37500803
         LA    R0,JFCBEX     ADDRESS OF JFCBE                  @Z40MPTH 37501403
         ST    R0,DD0(R5)    STORE JFCBE ADDRESS IN PARAM LIST @Z40MPTH 37502003
         MVC   DD4(DD3,R5),JFCB+JFCBEXAD-INFMJFCB  EXTENSION   @Z40MPTH 37502603
*              ADDRESS INTO PARAMETER LIST FOR SWA MANAGER     @Z40MPTH 37503203
         MVI   DISPLID(R5),JFCBEID   MOVE JFCBE ID INTO PARAM  @Z40MPTH 37503803
         MVI   QPARM+QMPOP-QMNAM,QMWRTE     WRITE CODE         @Z40MPTH 37504403
         MVI   QPARM+QMPNC-QMNAM,DD1   WRITE ONE BLOCK TO SWA  @Z40MPTH 37505003
         BALR  RE,R6         GO TO SWA MANAGER                 @Z40MPTH 37505603
CLEAN56A DS    0H                                              @Z40MPTH 37506203
*  INITIALIZE REMOTE LIST TO WRITE SIOT AND JFCB TO SWA.        YM02717 37508402
         LA    R0,SIOT             ADDR OF SIOT TO              YM02717 37518402
         ST    R0,0(R5)            REMOTE LIST.                 YM02717 37528402
         LA    R0,JFCB             ADDR OF JFCB                 YM02717 37538402
         ST    R0,DD8(R5)          TO REMOTE LIST.              YM02717 37548402
         MVC   DD4(DD3,R5),SIOT+SIOTDSKA-INDMSIOT MOVE SIOT TTR YM02717 37558402
         MVI   DISPLID(R5),NULLID  INSURE ZERO ID FOR SIOT       Y02621 37568402
         MVC   DD12(DD3,R5),SIOT+SCTPJFCB-INDMSIOT MVE JFCB TTR YM02717 37578402
         MVI   DISPL2ID(R5),JFCBSID BLOCK ID INTO REMOTE LIST    Y02621 37588402
         MVI   QPARM+QMPOP-QMNAM,QMWRTE SET WRITE               YM02717 37598402
         MVI   QPARM+QMPNC-QMNAM,DD2 SET TWO WRITES             YM02717 37608402
         L     R1,TEXTBUFP         ADDRESSIBILITY FOR           YM02709 37618402
         USING TEXT,R1             TEXT STRING PREFIX.          YM02709 37628402
         TM    STRINDCS,LASTSTMT   LAST DD STMT FOR THIS STEP?  YM02709 37638402
         BO    CLEAN155            BR YES TO LAST DD PROCESSING.YM02717 37648402
         DROP  R1                                               YM02717 37658402
*  NOT LAST DD. CHECK IF SIOT WAS CREATED FOR CURRENT DD.       YM02717 37668402
         OC    SIOT+SIOTDSKA-INDMSIOT(3),SIOT+SIOTDSKA-INDMSIOT YM02717 37678402
         BZ    CLEAN159      SET DEFAULTS AND EXIT ON NO       @YA00900 37688403
         B     CLEAN158            BR YES TO WRITE SIOT TO SWA. YM02717 37698402
CLEAN155 DS    0H                                               YM02717 37708402
****************************************************************YM02717 37718402
*  LAST DD FOR THE STEP PROCESSING.                            *YM02717 37728402
*  SIOTS ARE NOT CHAINED ACROSS STEPS. VDA INSURES THAT THE    *YM02717 37738402
*  NEXT SIOT PTR (SCTPSIOT) FOR THE LAST SIOT  IS ZERO.        *YM02717 37748402
****************************************************************YM02717 37758402
         OC    SCT+SCTLSIOT-INSMSCT(3),SCT+SCTLSIOT-INSMSCT     YM02717*37768402
                                   ANY NON-DYNAM DD THIS STEP?  YM02717 37778402
         BNZ   CLEAN160            BR YES TO UPDATE SIOT CHAIN. YM02717 37788402
*  NO SIOTS FOR THIS STEP. CLEAR 1ST SIOT POINTER IN THE SCT,   YM02717 37798402
*  INITIALIZED BY VEA.                                          YM02717 37808402
         XC    SCT+SCTFSIOT-INSMSCT(3),SCT+SCTFSIOT-INSMSCT     YM02717 37818402
CLEAN159 DS    0H            RESET SWAMGR DEFAULTS WHEN NO     @YA00900 37820403
*              OPERATION IS REQUESTED AFTER QMPA SETUP...      @YA00900 37822403
         MVI   QPARM+QMPOP-QMNAM,QMWRTA   DFLT-WRITE,ASSIGN    @YA00900 37824403
         MVI   QPARM+QMPCM-QMNAM,QMDFLT   DFLT-WRITE 1,ASSIGN 1@YA00900 37826403
         B     CLEAN154            BRANCH TO EXIT.              YM02717 37828402
CLEAN160 DS    0H                                               YM02717 37838402
*  A CHECK IS MADE TO SEE IF THE LAST SIOT LOGGED IN THE SCT    YM02717 37848402
*  CORRESPONDS TO THE SIOT FOR THE DD NOW BEING PROCESSED.      YM02717 37858402
*  (THIS WILL BE TRUE FOR MOST DD'S.)                           YM02717 37868402
         CLC   SIOT+SIOTDSKA-INDMSIOT(3),SCT+SCTLSIOT-INSMSCT   YM02717 37878402
         BE    CLEAN157            BR IF CURR SIOT IS LAST SIOT-YM02717*37888402
                                   (STANDARD NON-DYNAM DD).     YM02717 37898402
*  CURRENT SIOT IS NOT THE LAST SIOT LOGGED IN THE SCT. THIS    YM02717 37908402
*  WILL BE THE CASE FOR:                                        YM02717 37918402
*     1. A DD WHICH IS THE OBJECT OF A DDNAME PARAM ON A        YM02717 37928402
*        PREVIOUS DD STATEMENT.                                 YM02717 37938402
*     2. A DD CONTAINING THE DYNAM PARAM.                       YM02717 37948402
*     3. A SYSCHK DD WITHOUT RESTART SPECIFICATION ON JOB CARD. YM02717 37958402
*  FOR THE ABOVE CASES, NO NEW SIOT IS CREATED. THEREFORE THE   YM02717 37968402
*  LAST SIOT PTR (SCTLSIOT) CONTAINS THE SVA FOR THE SIOT OF    YM02717 37978402
*  THE DD PRIOR TO THE CURRENT DD.                              YM02717 37988402
         TM    DDWA2,JDICTI3       DD OBJECT OF DDNAME= PARAM?  YM02717 37998402
         BZ    CLEAN170            NO, GO UPDATE SIOT CHAIN.    YM02717 38008402
*  FOR A DD WHICH IS THE OBJECT OF DDNAME PARAM, THE SIOT AND   YM02717 38018402
*  JFCB OF THE REFERRING DD HAVE BEEN READ BACK AND PROCESSED.  YM02717 38028402
*  THEY ARE NOW REWRITTEN TO SWA.                               YM02717 38038402
         BALR  RE,R6               WRITE SIOT AND JFCB TO SWA.  YM02717 38048402
CLEAN170 DS    0H                                               YM02717 38058402
*  AS NO NEW SIOT HAS BEEN CREATED FOR THE SPECIAL DD'S ABOVE,  YM02717 38068402
*  THE SIOT FOR THE DD IMMEDIATELY PRECEDING THE CURRENT DD     YM02717 38078402
*  BECOMES IN FACT THE LAST DD FOR THE STEP. AS THE SIOT FOR    YM02717 38088402
*  THIS PRECEDING DD ALREADY CONTAINS A PTR TO A NEXT SIOT AND  YM02717 38098402
*  HAS BEEN WRITTEN TO SWA, IT MUST BE READ BACK AND THE NEXT   YM02717 38108402
*  SIOT PTR ZEROED.                                             YM02717 38118402
         MVI   QPARM+QMPOP-QMNAM,QMREAD SET READ CODE.          YM02717 38128402
         MVI   QPARM+QMPNC-QMNAM,DD1     SET TO READ 1          YM02709 38150002
         MVC   4(3,R5),SCT+SCTLSIOT-INSMSCT MOVE SVA FOR SIOT   YM02717*38151002
                                   FOR PREVIOUS DD TO REM LIST. YM02717 38151502
         BALR  RE,R6               GO GET SIOT FROM SWA         YM02709 38152002
         MVI   QPARM+QMPOP-QMNAM,QMWRTE  SET WRITE              YM02709 38153002
CLEAN157 DS    0H                                               YM02709 38154002
* CLEAR NEXT SIOT PTR OF THE LAST SIOT IN THE CHAIN             YM02709 38154502
         XC    SIOT+SCTPSIOT-INDMSIOT(DD3),SIOT+SCTPSIOT-INDMSIOT       38155002
CLEAN158 DS    0H                                               YM02717 38156002
*  ENTRY FOR ALL SIOT PROCESSING - LAST DD AND NOT LAST DD'S.   YM02717 38160002
         BALR  RE,R6               WRITE SIOT AND JFCB TO SWA.  YM02717 38164002
* AFTER BLOCK IS WRITTEN, CLEAR BLOCK ID IN REMOTE LIST TO       Y02621 38170002
* PREVENT INCORRECT IDENTIFICATION OF NEXT BLOCK WRITTEN. SWA    Y02621 38180002
* MGR USES  THIS ID IF NONZERO. IF ZERO, IT WILL USE ID IN BLOCK.Y02621 38190002
         MVI   DISPL2ID(R5),0      ZERO ID IN REMOTE LIST.       Y02621 38200002
CLEAN154 DS    0H                  ENTER                           121  38240000
         L     RF,DIEFVHE          EXIT                          Y02668 38260002
         BR    RF                  TO ROUTER.                    Y02668 38280002
*                                                                       38300000
CLEAN16  DS    0H                 ENTER                                 38320000
         LA    R3,UNQNAME+DD2     GET YEAR                              38340000
         LA    R2,DD2             SET TWO.                              38360000
         B     CLEAN18            TRANSFER                              38380000
CLEAN17  DS    0H                 ENTER                                 38400000
         LA    R3,UNQNAME+DD4     GET DAY.                              38420000
         LA    R2,DD3             SET THREE                             38440000
CLEAN18  DS    0H                 ENTER                                 38460000
         BALR  RE,R8              GO TO TEST AND STORE                  38480000
         BR    RF                 RETURN                                38500000
CLEAN19  DS    0H                 ENTER                                 38520000
         BAL   RF,CLEAN16         SET EXP YEAR.                         38540000
         BAL   RF,CLEAN17         SET EXP DAY.                          38560000
CLEAN20  DS    0H                 ENTER.                                38580000
         BAL   RF,CLEAN16         SET CREATE YEAR                       38600000
         BAL   RF,CLEAN17         SET CREATE DAY                        38620000
         BR    R1                 RETURN                                38640000
         DS    0H                                                Y02668 38689902
DDLIMIT  DC    X'0663'            MAX. NUMBER OF DD'S            Y02668 38690802
HWDZERO  DC    X'0000'            HALF WORD OF ZERO'S            Y02668 38691702
XPDTZERO DC    X'FFFFFF'                SYMBOLIC ZERO EXPDT      A23350 38694019
* USED TO INDICATE TO IEFVM5LS THAT A ZERO EXPDT WAS             A23350 38696019
* SPECIFICALLY REQUESTED. X'FFFFFF' CAN NOT BE A VALID EXPDT     A23350 38698019
BLANKS   DC    CL8' '             BLANKS USED TO INITIALIZE NAME  M0784 38698401
*                                 COMPARISON FIELD.              A43671 38698801
BLANK16  DC    CL16' '     BLANKS TO INITIALIZE JFCBE          @Z40MPTH 38699403
         EJECT                                                          38700000
*              **************************************************       38720000
*              *                                                *       38740000
*              *    A AND V CONSTANT TABLE.                     *       38760000
*              *                                                *       38780000
*              **************************************************       38800000
*                                                                       38820000
*                       V CONSTANTS.                                    38840000
*                                                                       38860000
DIEFVHQ  DC    V(IEFVHQ)          Q MANAGER.                            38920000
DIENB901 DC    V(IEFNB901)         AMP PROCESSING RTN.           Y02668 38930002
DIEFVGS  DC    V(IEFVGS)          DICTIONARY SEARCH                     38940000
DIEFVGT  DC    V(IEFVGT)          TEST AND STORE                        38960000
DIEFVGK  DC    V(IEFVGK)          GET KEY.                              38980000
DIEFVHE  DC    V(IEFVHE)           ROUTER.                       Y02668 39000002
DIEFVDB  DC    V(IEFVDBSD)        DATA INTEGITY.                        39020000
DIEFVGI  DC    V(IEFVGI)          ENTER DICTIONARY.                     39040000
DIEFVGM  DC    V(IEFVGM)          MESSAGE.                              39060000
DIEFVHR  DC    V(IEFVHR)           WTO/WTOR MODULE               Y02668 39066002
*                                                                       39080000
*                       A CONSTANTS.                                    39100000
*                                                                       39120000
ADABTABL DC    A(DABTABLE)        ADDRESS OF BRANCH TABLE.              39140000
ADSNAMT1 DC    A(DSNAMET1)        ADDRESS OF LABEL IN PDT TABLE         39160000
ADSNAMT3 DC    A(DSNAMET3)        ADDRESS OF LABEL IN PDT TABLE.        39180000
AEXPDTT  DC    A(EXPDTT)          ADDRESS OF LABEL IN PDT TABLE.        39200000
AEXPDTT2 DC    A(EXPDTT2)         ADDRESS OF LABEL IN PDT          168  39220000
ASPACT18 DC    A(SPACET18)        ADDRESS OF LABEL IN PDT TABLE.        39240000
ASPACT32 DC    A(SPACET32)        ADDRESS OF LABEL IN PDT TABLE.        39260000
ADDT1    DC    A(DDT1)            ADDRESS OF LABEL IN PDT TABLE         39280000
ADDNAMET DC    A(DDNAMET)         ADDRESS OF LABEL IN PDT TABLE.        39300000
PATCH    DC    25F'0'   ********** ZAP SPACE *******************YM02717 39350002
         EJECT                                                          39400000
*             ****************************************************      39420000
*             ****************************************************      39440000
*             **                                                **      39460000
*             **     DD ROUTINE PARAMETER DESCRIPTOR TABLE      **      39480000
*             **                                                **      39500000
*             ****************************************************      39520000
*             ****************************************************      39540000
         SPACE 2                                                        39560000
*              **************************************************       39580000
*              *                                                *       39600000
*              *    PARAMETER DESCRIPTION ENTRY FOR DD.         *       39620000
*              *                                                *       39640000
*              **************************************************       39660000
DDT      DS    0C                 START OF INTRY.                       39680000
         DC    AL1(DDT3-DDT)       LENGTH OF ENTRY.              Y02668 39700002
*              *                                                        39720000
*              *    FIRST POSITION FOR KEY WORD                         39740000
*              *                                                        39760000
DDT1     DS    0C                 START OF FIRST POSITONS.              39780000
         DC    AL1(DDT3-DDT1)     LENGTH OF FIRST POSTION.              39800000
         DC    AL1((DDT3-DDT2)*HEX)  CONTROL BYTE.                      39820000
         DC    AL1(JDDT1)         MAX LENGTH OF DD LABEL.               39840000
DDT2     DS    0C                 START OF CONTROL BYTES.               39860000
         TAS   OR1,JFCB,JFCBLTYP,JFCSL                                  39880001
         TAS   AMVCN,SIOT,SCTDDNAM                                      39900000
         TAS   AMVCN,DDWA,DDWA5                                         39920001
*              *                                                        39940000
*              *                                                        39980000
DDT3     DS    0C                 END FIRST POSITION AND CONTROL BYTES. 40000000
         EJECT                                                          40220000
*              **************************************************       40240000
*              *                                                *       40260000
*              *    PARAMETER DESCRIPTION ENTRY FOR TRTCH.      *       40280000
*              *                                                *       40300000
*              **************************************************       40320000
TRTCHT   DS    0C START OF ENTRY                                        40340000
         DC    AL1(TRTCHT04-TRTCHT) LENGHT OF ENTRY                     40360000
*              *                                                        40380000
*              *    FIRST POSITION FOR KEY WORD                         40400000
*              *                                                        40420000
TRTCHT01 DS    0C START OF POSITION                                     40440000
         DC    AL1(TRTCHT03-TRTCHT01) LENGTH OF POSITION                40460000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      40480000
         DC    AL1(DCBINIT)                                             40500000
TRTCHT02 TAS   AND1,JFCB,JFCTRTCH,DD0                                   40520000
*        *                                                              40540000
*        *     SECOND POSITION                                          40560000
*        *                                                              40580000
TRTCHT04 DS    0C END OF ENTRY                                          40600000
TRTCHT03 TASCT OR1,JFCB,JFCTRTCH,                                      140620000
               (JFCTREV,JFCTREV,JFCCONV,JFCEVEN,JFCTRAN),              *40640001
               (ET,TE,C,E,T)                                            40660000
         EJECT                                                          40680000
*              **************************************************       40700000
*              *                                                *       40720000
*              *    PARAMETER DESCRIPTION ENTRY FOR STACK.      *       40740000
*              *                                                *       40760000
*              **************************************************       40780000
STACKT   DS    0C START OF ENTRY                                        40800000
         DC    AL1(STACKT04-STACKT) LENGTH OF ENTRY                     40820000
*              *                                                        40840000
*              *    FIRST POSITION FOR KEY WORD                         40860000
*              *                                                        40880000
STACKT01 DS    0C START OF POSITION                                     40900000
         DC    AL1(STACKT03-STACKT01) LENGTH OF POSITION                40920000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      40940000
         DC    AL1(DCBINIT)                                             40960000
STACKT02 TAS   AND1,JFCB,JFCSTACK,DDMS1                                 40980017
*        *                                                              41000000
*        *     SECOND POSITION                                          41020000
*        *                                                              41040000
STACKT04 DS    0C END OF ENTRY                                          41060000
STACKT03 TASCT OR1,JFCB,JFCSTACK,                                      141080000
               (JFCONE,JFCTWO),                                        241100001
               (1,2)                                                    41120000
         EJECT                                                          41140000
*              **************************************************       41160000
*              *                                                *       41180000
*              *    PARAMETER DESCRIPTION ENTRY FOR SOWA.       *       41200000
*              *                                                *       41220000
*              **************************************************       41240000
*              *                                                        41260000
*              *    FIRST POSITION FOR KEY WORD                         41280000
*              *                                                        41300000
SOWAT    TASCD CVB2,JFCB,JFCSOWA,JSOWA1,32767                           41320000
         EJECT                                                          41320502
*             ***********************************************    Y02668 41321002
*             *                                             *    Y02668 41322002
*             *    PARAMETER DESCRIPTION ENTRY FOR FREE     *    Y02670 41323002
*             *                                             *    Y02668 41324002
*             ***********************************************    Y02668 41325002
FREET    DS    0C                       START OF ENTRY           Y02670 41326002
         DC    AL1(FREET7-FREET)  LENGTH OF ENTRY               YM00391 41327002
FREET1   DS    0C                       START OF POSITION        Y02670 41328002
         DC    AL1(FREET7-FREET1) LENGTH OF POSITION            YM00391 41329002
         DC    AL1((FREET4-FREET3)*HEX+L'FREET2)                 Y02670 41330002
FREET2   DC    C'CLOSE'                 COMPARE BYTE             Y02670 41331002
FREET3   DS    0C                                                Y02670 41332002
         TAS   OR1,SIOT,SCTSBYT2,SIOCLUNL                        Y02670 41333002
FREET4   DS    0C                       END OF CONTROL BYTE      Y02670 41334002
         DC    AL1((FREET7-FREET6)*HEX+L'FREET5)                YM00391 41335002
FREET5    DC    C'END'            COMPARE BYTES                 YM00391 41336002
FREET6   DS    0C                                               YM00391 41337002
         TAS    OR1,SIOT,SCTSBYT2,DD0                           YM00391 41338002
FREET7   DS    0H                                               YM00391 41339002
         EJECT                                                          41340000
*              **************************************************       41360000
*              *                                                *       41380000
*              *    PARAMETER DESCRIPTION ENTRY FOR RKP.        *       41400000
*              *                                                *       41420000
*              **************************************************       41440000
*              *                                                        41460000
*              *    FIRST POSITION FOR KEY WORD                         41480000
*              *                                                        41500000
RKPT     TASCD CVB2,JFCB,JFCRKP,JRKP1,65535                             41520000
         EJECT                                                          41540000
*              **************************************************       41560000
*              *                                                *       41580000
*              *    PARAMETER DESCRIPTION ENTRY FOR RECFM.      *       41600000
*              *                                                *       41620000
*              **************************************************       41640000
RECFMT   DS    0C   START OF ENTRY                                      41660000
         DC    AL1(RECFMT04-RECFMT) LENGTH OF ENTRY                     41680000
*              *                                                        41700000
*              *    FIRST POSITION FOR KEY WORD                         41720000
*              *                                                        41740000
RECFMT01 DS    0C START OF POSITION                                     41760000
         DC    AL1(RECFMT03-RECFMT01) LENGTH OF POSITION                41780000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      41800000
         DC    AL1(DCBINIT)                                             41820000
RECFMT02 TAS   AND1,JFCB,JFCRECFM,DD0                                   41840000
*        *                                                              41860000
*        *     SECOND POSITION                                          41880000
*        *                                                              41900000
RECFMT04 DS    0C END OF ENTRY                                          41920000
RECFMT03 TASCT OR1,JFCB,JFCRECFM,                                      141940000
               (JRECFM1,JRECFM2,JRECFM3,JRECFM4,JRECFM5,JRECFM6,JRECFM7241960000
               ,JRECFM9,JRECFMC),                              @ZA24607C41980003
               (F,V,U,T,B,S,A,M,D)                             @ZA24607 41986003
         EJECT                                                 @Y30OPSB 42000703
*              *********************************************   @Y30OPSB 42001403
*              *                                           *   @Y30OPSB 42002103
*              *   PARAMETER DESCRIPTION ENTRY FOR DSID    *   @Y30OPSB 42002803
*              *                                           *   @Y30OPSB 42003503
*              *********************************************   @Y30OPSB 42004203
         SPACE 2                                               @Y30OPSB 42004903
DSIDT    DS    0C            START OF ENTRY                    @Y30OPSB 42005603
         DC    AL1(DSIDT6-DSIDT)  LENGTH OF ENTRY              @Y30OPSB 42006303
*              *                                               @Y30OPSB 42007003
*              *        FIRST POSITION                         @Y30OPSB 42007703
*              *                                               @Y30OPSB 42008403
DSIDT1   DS    0C            START OF POSITION                 @Y30OPSB 42009103
         DC    AL1(DSIDT3-DSIDT1)  LENGTH OF POSITION          @Y30OPSB 42009803
         DC    AL1((DSIDT3-DSIDT2)*HEX)  CONTROL BYTE          @Y30OPSB 42010503
         DC    AL1(DSIDLEN)  MAX LENGTH OF DSID ID....         @Y30OPSB 42011203
DSIDT2   DS    0C            START OF CONTROL BYTES            @Y30OPSB 42011903
         TAS   AMVCN,JFCX,DSIDWORK                             @Y30OPSB 42012603
         TAS   OR1,SIOT,SIOTBYT3,DD8                           @ZA20610 42012903
DSIDT3   DS    0C            END OF FIRST POSITION             @Y30OPSB 42013303
*              *                                               @Y30OPSB 42014003
*              *        SECOND POSITION                        @Y30OPSB 42014703
*              *                                               @Y30OPSB 42015403
DSIDT4   DS    0C            START OF POSITION                 @Y30OPSB 42016103
         DC    AL1(DSIDT6-DSIDT4)  LENGTH OF POSITION          @Y30OPSB 42016803
         DC    AL1((DSIDT6-DSIDT6)*HEX+L'DSIDT5)  CONTROL BYTE @Y30OPSB 42017503
DSIDT5   DC    C'V'     CONPARE BYTE                           @Y30OPSB 42018203
DSIDT6   DS    0C            END OF SECOND POSITION AND ENTRY..@Y30OPSB 42018903
         EJECT                                                          42020000
*              **************************************************       42040000
*              *                                                *       42060000
*              *    PARAMETER DESCRIPTION ENTRY FOR PRTSP.      *       42080000
*              *                                                *       42100000
*              **************************************************       42120000
PRTSPT   DS    0C START OF ENTRY                                        42140000
         DC    AL1(PRTSPT04-PRTSPT) LENGTH OF ENTRY                     42160000
*              *                                                        42180000
*              *    FIRST POSITION FOR KEY WORD.                        42200000
*              *                                                        42220000
PRTSPT01 DS    0C START OF POSITION                                     42240000
         DC    AL1(PRTSPT03-PRTSPT01) LENGTH OF POSITION                42260000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      42280000
         DC    AL1(DCBINIT)                                             42300000
PRTSPT02 TAS   AND1,JFCB,JFCPRTSP,DD0                                   42320000
*        *                                                              42340000
*        *     SECOND POSITION                                          42360000
*        *                                                              42380000
PRTSPT04 DS    0C END OF ENTRY                                          42400000
PRTSPT03 TASCT OR1,JFCB,JFCPRTSP,                                      142420000
               (JFCSPNO,JFCSPONE,JFCSPTWO,JFCSPTHR),                   *42440001
               (0,1,2,3)                                                42460000
         EJECT                                                          42480000
*              **************************************************       42500000
*              *                                                *       42520000
*              *    PARAMETER DESCRIPTION ENTRY FOR OPTCD.      *       42540000
*              *                                                *       42560000
*              **************************************************       42580000
OPTCDT   DS    0C START OF POSITION                                     42600000
         DC    AL1(OPTCDT04-OPTCDT) LENGTH OF ENTRY                     42620000
*              *                                                        42640000
*              *    FIRST POSITION FOR KEY WORD                         42660000
*              *                                                        42680000
OPTCDT01 DS    0C START OF POSITION                                     42700000
         DC    AL1(OPTCDT03-OPTCDT01) LENGTH OF POSITION                42720000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      42740000
         DC    AL1(DCBINIT)                                             42760000
OPTCDT02 TAS   AND1,JFCB,JFCOPTCD,DD0                                   42780000
*        *                                                              42800000
*        *     SECOND POSITION                                          42820000
*        *                                                              42840000
OPTCDT04 DS    0C END OF ENTRY                                          42860000
OPTCDT03 TASCT OR1,JFCB,JFCOPTCD,                                      142880000
               (JOPTCD1,JOPTCD3,JOPTCD4,JOPTCD5,JOPTCD6,JOPTCD7, S22367242900002
               JOPTCD8,JOPTCD9,JOPTCDA,JOPTCDB,JOPTCDC,JOPTCDC, AS22367342910002
               JPTCDD,JPTCDE,JPTCDF,JPTCDG,JPTCDH,JPTCDI),     @Z40MPTH442920003
               (W,M,E,I,F,C,A,L,R,Y,U,B,Z,T,H,O,Q,J)           @Z40MPTH 42930003
         EJECT                                                          42960000
*              **************************************************       42980000
*              *                                                *       43000000
*              *    PARAMETER DESCRIPTION ENTRY FOR NTM.        *       43020000
*              *                                                *       43040000
*              **************************************************       43060000
*              *                                                        43080000
*              *    FIRST POSITION FOR KEY WORD                         43100000
*              *                                                        43120000
NTMT     TASCD CVB1,JFCB,JFCNTM,JNTM1,99                                43140000
         EJECT                                                          43160000
*              **************************************************       43180000
*              *                                                *       43200000
*              *    PARAMETER DESCRIPTION ENTRY FOR NCP.        *       43220000
*              *                                                *       43240000
*              **************************************************       43260000
*              *                                                        43280000
*              *    FIRST POSITION FOR KEY WORD                         43300000
*              *                                                        43320000
NCPT     TASCD CVB1,JFCB,JFCNCP,JNCP1,99                                43340000
         EJECT                                                          43360000
*              **************************************************       43361000
*              *                                                *       43362000
*              *      PARAMETER DESCRIPTION ENTRY FOR GNCP      *       43363000
*              *                                                *       43364000
*              **************************************************       43365000
*              *                                                        43366000
*              *    FIRST POSITION                                      43367000
*              *                                                        43368000
GNCPT    TASCD CVB1,JFCB,JFCBFTEK,JGNCP1,99                             43369000
         EJECT                                                          43370000
*              **************************************************       43380000
*              *                                                *       43400000
*              *    PARAMETER DESCRIPTION ENTRY FOR MODE.       *       43420000
*              *                                                *       43440000
*              **************************************************       43460000
MODET    DS    0C START OF POSITION                                     43480000
         DC    AL1(MODET04-MODET) LENGTH OF ENTRY                       43500000
*              *                                                        43520000
*              *    FIRST POSITION FOR KEY WORD                         43540000
*              *                                                        43560000
MODET01  DS    0C START OF POSITION                                     43580000
         DC    AL1(MODET03-MODET01) LENGTH OF POSITION                  43600000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      43620000
         DC    AL1(DCBINIT)                                             43640000
MODET02  TAS   AND1,JFCB,JFCMODE,DDMS2                                  43660017
*        *                                                              43680000
*        *     SECOND POSITION                                          43700000
*        *                                                              43720000
MODET04  DS    0C END OF ENTRY                                          43740000
MODET03  TASCT OR1,JFCB,JFCMODE,                                       143760000
               (JMODE1,JMODE2,JMODE3,JMODE4,JMODE5,JMODE6),       21088X43780001
               (C,E,CO,CR,EO,ER)                                  21088 43800001
         EJECT                                                          43820000
*              **************************************************Y01948 43820101
*              *                                                *Y01948 43820201
*              *   PARAMETER DESCRIPTION TABLE FOR IPLTXID      *Y01948 43820301
*              *                                                *Y01948 43820401
*              **************************************************Y01948 43820501
IPLTXIDT DS    0C    START OF ENTRY                              Y01948 43820601
         DC    AL1(IPLTXID5-IPLTXIDT)    LENGTH OF ENTRY        YM00383 43820702
*                                                                       43820801
*        *     FIRST POSITION FOR KEYWORD                        Y01948 43820901
*                                                                       43821001
IPLTXID1 DS    0C    START OF POSITION                           Y01948 43821101
         DC    AL1(IPLTXID3-IPLTXID1)    LENGTH OF P0SITION     YM00383 43821202
         DC    AL1(DCBCNT)          NUMBER OF CONTROL BYTE      YM00383 43821702
         DC    AL1(DCBINIT)                                     YM00383 43822202
IPLTXID2 TAS   AND1,JFCB,JFCIPLTX,DD0                           YM00383 43822702
*                                                               YM00383 43823202
*        *     SECOND POSITION                                  YM00383 43823702
*                                                               YM00383 43824202
IPLTXID3 DS    0C                   START OF POSITION           YM00383 43824702
         DC    AL1(IPLTXID5-IPLTXID3) LENGTH OF POSITION        YM00383 43825202
         DC    AL1((IPLTXID5-IPLTXID4)*HEX)   CONTROL BYTE      YM00383 43825702
         DC    AL1(JIPLTXID)    MAXIMUM LENGTH OF PARAMETER     YM00383 43826202
IPLTXID4 DS    0C    START OF CONTROL BYTES                     YM00383 43826702
         TAS   AMVCN,JFCB,JFCIPLTX                              YM00383 43827202
IPLTXID5 DS    0C    END OF ENTRY                               YM00383 43827702
         EJECT                                                          43828202
*              ***************************************************21088 43830001
*              *                                                 *21088 43832001
*              *  PARAMETER DESCRIPTION ENTRY FOR FUNC.          *21088 43834001
*              *                                                 *21088 43836001
*              ***************************************************21088 43838001
*                                                                       43838401
FUNCT    DS    0C                 START OF POSITION               21088 43838801
         DC    AL1(FUNCT04-FUNCT) LENGTH OF ENTRY                 21088 43839201
*              *                                                        43839601
*              *    FIRST POSITION FOR KEY WORD                   21088 43839701
*              *                                                        43839801
FUNCT01  DS    0C                 START OF POSITION               21088 43839901
         DC    AL1(FUNCT03-FUNCT01) LENGTH OF POSITION            21088 43846601
         DC    AL1(DCBCNT)          NUMBER OF CONTROL BYTES       21088 43848601
         DC    AL1(DCBINIT)                                       21088 43850601
FUNCT02  TAS   AND1,JFCB,JFCFUNC,DD1                              21088 43852601
FUNCT04  DS    0C                    END OF FIRST ENTRY           M0083 43852701
*              *                                                        43853001
*              *    SECOND POSITION                               21088 43853101
*              *                                                        43853201
FUNCT03  TASCT OR1,JFCB,JFCFUNC,                                  21088X43862001
               (JFUNC1,JFUNC2,JFUNC3,JFUNC4,JFUNC5,JFUNC6,JFUNC7,JFUNC8X43864001
               ,JFUNC9,JFUNC10,JFUNC11,JFUNC12,JFUNC13,JFUNC14,JFUNC15,X43866001
               JFUNC16,JFUNC17,JFUNC18,JFUNC19,JFUNC20),               X43866401
               (I,R,P,W,WT,WXT,RP,RPD,RW,RWT,RWXT,PW,PWX,PWXT,RPW,RPWX,X43866501
               RPWXT,RPWD,WX,RWX)                                 21088 43873201
          EJECT                                                         43875301
*              **************************************************       43879901
*              *                                                *       43886601
*              *    PARAMETER DESCRIPTION ENTRY FOR LRECL.      *       43893301
*              *                                                *       43900000
*              **************************************************       43920000
*              *                                                        43940000
*              *    FIRST POSITION FOR KEY WORD                         43960000
*              *                                                        43980000
LRECLT   TASCD CVB2,JFCB,JFCLRECL,JLRECL1,32760                         44000000
         EJECT                                                          44020000
*              **************************************************       44040000
*              *                                                *       44060000
*              *    PARAMETER DESCRIPTION ENTRY FOR LIMCT.      *       44080000
*              *                                                *       44100000
*              **************************************************       44120000
*              *                                                        44140000
*              *    FIRST POSITION FOR KEY WORD                         44160000
*              *                                                        44180000
LIMCTT   TASCD CVB2,JFCB,JFCLIMCT+1,JLIMCT1,32760                  AAAA 44200015
         EJECT                                                          44220000
*              **************************************************       44240000
*              *                                                *       44260000
*              *    PARAMETER DESCRIPTION ENTRY FOR KEYLEN.     *       44280000
*              *                                                *       44300000
*              **************************************************       44320000
*              *                                                        44340000
*              *    FIRST POSITION FOR KEY WORD                         44360000
*              *                                                        44380000
KEYLENT  TASCD CVB1,JFCB,JFCKEYLE,JKEYLEN1,255                          44400000
         EJECT                                                          44420000
*              **************************************************       44440000
*              *                                                *       44460000
*              *    PARAMETER DESCRIPTION ENTRY FOR INTVL.      *       44480000
*              *                                                *       44500000
*              **************************************************       44520000
*              *                                                        44540000
*              *    FIRST POSITION FOR KEY WORD                         44560000
*              *                                                        44580000
INTVLT   TASCD CVB1,JFCB,JFCINTVL,JINTVL1,255                           44600000
         EJECT                                                          44620000
*              ******************************************************** 44620500
*              *                                                      * 44621000
*              *   PARAMETER DESCRIPTION ENTRY FOR UCS                * 44621500
*              *                                                      * 44622000
*              ******************************************************** 44622500
UCST     DS    0C START OF ENTRY                                        44623000
         DC    AL1(UCST09-UCST) LENGTH ENTRY                            44623500
*        *                                                              44624000
*        *     FIRST ENTRY                                              44624500
*        *                                                              44625000
UCST01   DS    0C                                                       44625500
         DC    AL1(UCST03-UCST01) LENGTH POSITION                       44626000
         DC    AL1((UCST03-UCST02)*HEX) CONTROL BYTES                   44626500
         DC    AL1(JUCS1) MAX LENGTH                                    44627000
UCST02   DS    0C START OF CONTROL BYTES                                44627500
         TAS   MVCN,JFCB,JFCRKP                                         44628000
*        *                                                              44628500
*        *     SECOND ENTRY                                             44629000
*        *                                                              44629500
UCST03   DS    0C START OF POSITION                                     44630000
         DC    AL1(UCST06-UCST03) LENGTH POSITION                       44630500
         DC    AL1((UCST06-UCST05)*HEX+L'UCST04) CONTROL BYTE           44631000
UCST04   DC    C'FOLD' COMPARE BYTES                                    44631500
UCST05   DS    0C START CONTROL BYTES                                   44632000
         TAS   OR1,JFCB,JFCINTVL,JUCS2                                  44632500
*        *                                                              44633000
*        *     THIRD POSITION                                           44633500
*        *                                                              44634000
UCST06   DS    0C START OF POSITION                                     44634500
         DC    AL1(UCST09-UCST06) LENGTH OF POSITION                    44635000
         DC    AL1((UCST09-UCST08)*HEX+L'UCST07) CONTROL BYTES          44635500
UCST07   DC    C'VERIFY' COMPARE BYTES                                  44636000
UCST08   DS    0C START OF CONTROL BYTES                                44636500
         TAS   OR1,JFCB,JFCINTVL,JUCS3                                  44637000
UCST09   DS    0C END OF ENTRY                                          44637500
         EJECT                                                          44638000
*              **************************************************       44640000
*              *                                                * 20202 44650020
*              *    PARAMETER DESCRIPTION ENTRY FOR FCB         * 20202 44652020
*              *                                                * 20202 44654020
*              ************************************************** 20202 44656020
FCBT     DS    0C                  START OF ENTRY                 20202 44658020
         DC    AL1(FCBT09-FCBT)    LENGTH OF ENTRY                20202 44658420
*              *                                                  20202 44658820
*              *    FIRST POSITION                                20202 44659220
*              *                                                  20202 44659620
FCBT01   DS    0C                  START OF POSITION              20202 44659720
         DC    AL1(FCBT03-FCBT01)  LENGTH OF POSITION             20202 44659820
         DC    AL1((FCBT03-FCBT02)*HEX) CONTROL BYTE              20202 44659920
         DC    AL1(JAFCB1)         MAXIMUM LENGTH OF ENTRY        20202 44666620
FCBT02   DS    0C                                                 20202 44668620
         TAS   MVCN,JFCB,JFCFCBID                                A50455 44670601
*              *                                                  20202 44672620
*              *    SECOND POSITION                               20202 44673020
*              *                                                  20202 44673120
FCBT03   DS    0C                  START OF POSITION              20202 44673220
         DC    AL1(FCBT09-FCBT03)  LENGTH OF POSITION             20202 44679920
         DC    AL1((FCBT06-FCBT05)*HEX+L'FCBT04) CONTROL BYTE     20202 44680020
FCBT04   DC    C'ALIGN'                                           20202 44682020
FCBT05   DS    0C                  START OF CONTROL BYTES         20202 44684020
         TAS   OR1,JFCB,JFCUCSOP,JAFCB2                           20202 44686020
FCBT06   DS    0C                                                 20202 44686420
         DC    AL1((FCBT09-FCBT08)*HEX+L'FCBT07)  CONTROL BYTE    20202 44686520
FCBT07   DC    C'VERIFY'                                          20202 44693220
FCBT08   DS    0C                  START OF CONTROL BYTES         20202 44693320
         TAS   OR1,JFCB,JFCUCSOP,JAFCB3                           20202 44695320
FCBT09   DS    0C                  END OF ENTRY                   20202 44697320
         EJECT                                                          44699320
*              **************************************************       44699720
*              *                                                *       44699920
*              *    PARAMETER DESCRIPTION ENTRY FOR EROP.       *       44706620
*              *                                                *       44713320
*              **************************************************       44720000
EROPTT   DS    0C START OF POSITION                                     44740000
         DC    AL1(EROPTT04-EROPTT) LENGTH OF ENTRY                     44760000
*              *                                                        44780000
*              *    FIRST POSITION FOR KEY WORD                         44800000
*              *                                                        44820000
EROPTT01 DS    0C START OF POSITION                                     44840000
         DC    AL1(EROPTT03-EROPTT01) LENGTH OF POSITION                44860000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      44880000
         DC    AL1(DCBINIT)                                             44900000
EROPTT02 TAS   AND1,JFCB,JFCEROPT,DD0                                   44920000
*        *                                                              44940000
*        *     SECOND POSITION                                          44960000
*        *                                                              44980000
EROPTT04 DS    0C END OF ENTRY                                          45000000
EROPTT03 TASCT OR1,JFCB,JFCEROPT,                                      145020000
               (JFCACC,JFCSKP,JFCABN,JFCTOPT),                  AS22365*45040002
               (ACC,SKP,ABE,T)                                  AS22365 45060002
         EJECT                                                          45080000
*              **************************************************       45100000
*              *                                                *       45120000
*              *    PARAMETER DESCRIPTION ENTRY FOR DSORG.      *       45140000
*              *                                                *       45160000
*              **************************************************       45180000
DSORGT   DS    0C START OF ENTRY                                        45200000
         DC    AL1(DSORGT04-DSORGT) LENGTH OF ENTRY                     45220000
*              *                                                        45240000
*              *    FIRST POSITION FOR KEY WORD                         45260000
*              *                                                        45280000
DSORGT01 DS    0C START OF POSITION                                     45300000
         DC    AL1(DSORGT03-DSORGT01) LENGTH OF POSITION                45320000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      45340000
         DC    AL1(DCBINIT)                                             45360000
DSORGT02 TAS   AND1,JFCB,JFCDSORG,DD0                                   45380000
*        *                                                              45400000
*        *     SECOND POSITION                                          45420000
*        *                                                              45440000
DSORGT04 DS    0C END OF ENTRY                                          45460000
DSORGT03 TASCT OR1,JFCB,JFCDSORG,                                      145480000
               (JDSORG1,JDSORG2,JDSORG3,JDSORG4,JDSORG5,JDSORG6,JDSORG7245500000
               ,JDSORG8,JDSORG9,JDSORGA,JDSORGB),                      345520000
               (ISU,IS,PSU,PS,DAU,DA,CX,CQ,MQ,POU,PO)                   45540000
         EJECT                                                          45560000
*              **************************************************       45580000
*              *                                                *       45600000
*              *    PARAMETER DESCRIPTION ENTRY FOR DEN.        *       45620000
*              *                                                *       45640000
*              **************************************************       45660000
DENT     DS    0C START OF ENTRY                                        45680000
         DC    AL1(DENT04-DENT) LENGTH OF ENTRY                         45700000
*              *                                                        45720000
*              *    FIRST POSITION FOR KEY WORD                         45740000
*              *                                                        45760000
DENT01   DS    0C START OF POSITION                                     45780000
         DC    AL1(DENT03-DENT01) LENGTH OF POSITION                    45800000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      45820000
         DC    AL1(DCBINIT)                                             45840000
DENT02   TAS   AND1,JFCB,JFCDEN,DD0                                     45860000
*        *                                                              45880000
*        *     SECOND POSITION                                          45900000
*        *                                                              45920000
DENT04   DS    0C END OF ENTRY                                          45940000
DENT03   TASCT OR1,JFCB,JFCDEN,                                        145960000
               (JFC200,JFC556,JFC800,JFC1600,JFC6250),           Y02670*45980002
               (0,1,2,3,4)                                       Y02670 46000002
         EJECT                                                          46020000
*              **************************************************       46040000
*              *                                                *       46060000
*              *    PARAMETER DESCRIPTION ENTRY FOR DBUFNO.     *       46080000
*              *                                                *       46100000
*              **************************************************       46120000
*              *                                                        46140000
*              *    FIRST POSITION FOR KEY WORD                         46160000
*              *                                                        46180000
*                                                                  AAAA 46190015
*DBUFNOT TASCD CVB1,JFCB,JFCDBUFN,JDBUFNO1,255   DBUFNO NOT SUPPORTED   46200015
*                                                                  AAAA 46210015
         EJECT                                                          46220000
*              **************************************************       46240000
*              *                                                *       46260000
*              *    PARAMETER DESCRIPTION ENTRY FOR CYLOFL.     *       46280000
*              *                                                *       46300000
*              **************************************************       46320000
*              *                                                        46340000
*              *    FIRST POSITION FOR KEY WORD                         46360000
*              *                                                        46380000
CYLOFLT  TASCD CVB1,JFCB,JFCCYLOF,JCYLOFL1,99                           46400000
         EJECT                                                          46420000
*              **************************************************       46440000
*              *                                                *       46460000
*              *    PARAMETER DESCRIPTION ENTRY FOR CPRI.       *       46480000
*              *                                                *       46500000
*              **************************************************       46520000
CPRIT    DS    0C START OF ENTRY                                    696 46540000
         DC    AL1(CPRIT04-CPRIT) LENGTH OF ENTRY                   696 46560000
*              *                                                        46580000
*              *    FIRST POSITION FOR KEY WORD                         46600000
*              *                                                        46620000
CPRIT01  DS    0C START OF POSITION                                 696 46640000
         DC    AL1(CPRIT03-CPRIT01) LENGTH OF ENTRY                 696 46660000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                  696 46680000
         DC    AL1(DCBINIT)                                         696 46700000
CPRIT02  TAS   AND1,JFCB,JFCCPRI,DD0                                696 46720000
*        *                                                              46740000
*        *     SECOND POSITION                                          46760000
*        *                                                              46780000
CPRIT04  DS    0C END OF ENTRY                                      696 46800000
CPRIT03  TASCT OR1,JFCB,JFCCPRI,                                   696 146820000
               (JCPRI1,JCPRI2,JCPRI3),                             696 246840000
               (R,E,S)                                              696 46860000
         EJECT                                                          46861002
*             **********************************************     Y02668 46862002
*             *                                            *     Y02668 46863002
*             *   PARAMETER DESCRIPTION ENTRY FOR HOLD     *     Y02668 46864002
*             *                                            *     Y02668 46865002
*             **********************************************     Y02668 46866002
         SPACE                                                          46867002
HOLDT    DS    0C                 START OF ENTRY                 Y02668 46868002
         DC    AL1(HOLDT6-HOLDT)  LENGTH OF ENTRY                Y02668 46869002
HOLDT1   DS    0C                 START OF POSITION              Y02668 46870002
         DC    AL1(HOLDT6-HOLDT1) LENGTH OF POSITION             Y02668 46871002
         DC    AL1((HOLDT4-HOLDT3)*HEX+L'HOLDT2) CONTROL BYTE    Y02668 46872002
HOLDT2   DC    C'YES'             COMPARE BYTES                  Y02668 46873002
HOLDT3   DS    0C                                                Y02668 46874002
         TAS   OR1,SIOT,SIOTBYT1,SIOTHOLD                        Y02668 46875002
HOLDT4   DS    0C                 END CONTROL BYTE               Y02668 46876002
         DC    AL1((HOLDT6-HOLDT6)*HEX+L'HOLDT5)                 Y02668 46877002
HOLDT5   DC    C'NO'              COMPARE BYTE                   Y02668 46878002
HOLDT6   DS    0C                 END OF ENTRY                   Y02668 46879002
         EJECT                                                          46880000
*              **************************************************       46900000
*              *                                                *       46920000
*              *    PARAMETER DESCRIPTION ENTRY FOR CODE.       *       46940000
*              *                                                *       46960000
*              **************************************************       46980000
CODET    DS    0C START OF ENTRY                                        47000000
         DC    AL1(CODET04-CODET) LENGTH OF ENTRY                       47020000
*              *                                                        47040000
*              *    FIRST POSITION FOR KEY WORD                         47060000
*              *                                                        47080000
CODET01  DS    0C START OF POSITION                                     47100000
         DC    AL1(CODET03-CODET01) LENGTH OF POSITION                  47120000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      47140000
         DC    AL1(DCBINIT)                                             47160000
CODET02  TAS   AND1,JFCB,JFCCODE,DD0                                    47180000
*        *                                                              47200000
*        *     SECOND POSITION                                          47220000
*        *                                                              47240000
CODET04  DS    0C END OF ENTRY                                          47260000
CODET03  TASCT OR1,JFCB,JFCCODE,                                       147280000
               (JFCNOCON,JFCBCD,JFCFRI,JFCBUR,JFCNCR,JFCASCII,JFCTTY), *47300001
               (N,I,F,B,C,A,T)                                          47320000
         EJECT                                                          47340000
*              **************************************************       47360000
*              *                                                *       47380000
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFRQ.      *       47400000
*              *                                                *       47420000
*              **************************************************       47440000
*              *                                                        47460000
*              *    FIRST POSITION FOR KEY WORD                         47480000
*              *                                                        47500000
BUFRQT   TASCD CVB1,JFCB,JFCBUFRQ,JBUFRQ1,255                           47520000
         EJECT                                                          47540000
*              **************************************************       47560000
*              *                                                *       47580000
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFNO.      *       47600000
*              *                                                *       47620000
*              **************************************************       47640000
*              *                                                        47660000
*              *    FIRST POSITION FOR KEY WORD                         47680000
*              *                                                        47700000
BUFNOT   TASCD CVB1,JFCB,JFCBUFNO,JBUFNO1,255                           47720000
         EJECT                                                          47740000
*              **************************************************       47760000
*              *                                                *       47780000
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFL.       *       47800000
*              *                                                *       47820000
*              **************************************************       47840000
*              *                                                        47860000
*              *    FIRST POSITION FOR KEY WORD                         47880000
*              *                                                        47900000
BUFLT    TASCD CVB2,JFCB,JFCBUFL,JBUFL1,32760                           47920000
         EJECT                                                          47940000
*              *************************************************  19200 47940719
*              *                                               *  19200 47941419
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFOFF.    *  19200 47942119
*              *                                               *  19200 47942819
*              *************************************************  19200 47943519
         SPACE                                                    19200 47944219
BUFOFFT  DS    0C START OF ENTRY.                                 19200 47944919
         DC    AL1(BUFOFFT6-BUFOFFT) LENGTH OF ENTRY.             19200 47945619
*              *                                                  19200 47946319
*              *    FIRST POSITION FOR KEY WORD                   19200 47947019
*              *                                                  19200 47947719
BUFOFFT1 DS    0C START OF POSITION                               19200 47948419
         DC    AL1(BUFOFFT6-BUFOFFT1) LENGTH OF POSITION          19200 47949119
         DC    AL1((BUFOFFT4-BUFOFFT3)*HEX+L'BUFOFFT2) CONTROL    19200 47949819
BUFOFFT2 DC    C'L' COMPARE BYTE                                  19200 47950519
BUFOFFT3 DS    0C START OF CONTROL BYTES                          19200 47951219
         TAS   OR1,JFCB,JFCBUFOF,JBUFOFF3  INDICATE TYPE L        19200 47951919
         TAS   OR1,JFCB,JFCBUFSW,JBUFOFF4  INDICATE BUFOFF        M2050 47952320
BUFOFFT4 DS    0C END OF CONTROL BYTES                            19200 47952619
         DC    AL1((BUFOFFT6-BUFOFFT5)*HEX) CONTROL BYTE          19200 47953319
         DC    AL1(JBUFOFF1) MAXIMUM LENGTH                       19200 47954019
BUFOFFT5 DS    0C START OF CONTROL BYTES                          19200 47954719
         TAS   CVB1,JFCB,JFCBUFOF,JBUFOFF2                        19200 47955419
         TAS   OR1,JFCB,JFCBUFSW,JBUFOFF4  INDICATE BUFOFF        M2050 47955820
         DS    0C END OF CONTROL BYTES                            19200 47956119
         DS    0C END OF POSITION                                 19200 47956819
BUFOFFT6 DS    0C END OF ENTRY                                    19200 47957519
         EJECT                                                    19200 47958219
*              **************************************************       47960000
*              *                                                *       47980000
*              *    PARAMETER DESCRIPTION ENTRY FOR BLKSIZE.    *       48000000
*              *                                                *       48020000
*              **************************************************       48040000
*              *                                                        48060000
*              *    FIRST POSITION FOR KEY WORD                         48080000
*              *                                                        48100000
BLKSIZET TASCD CVB2,JFCB,JFCBLKSI,JBLKSIZ1,32760                        48120000
         EJECT                                                          48140000
*              **************************************************       48160000
*              *                                                *       48180000
*              *    PARAMETER DESCRIPTION ENTRY FOR BFTEK.      *       48200000
*              *                                                *       48220000
*              **************************************************       48240000
BFTEKT   DS    0C START OF ENTRY                                        48260000
         DC    AL1(BFTEKT04-BFTEKT) LENGTH OF ENTRY                     48280000
*              *                                                        48300000
*              *    FIRST POSITION FOR KEY WORD                         48320000
*              *                                                        48340000
BFTEKT01 DS    0C START OF ENTRY                                        48360000
         DC    AL1(BFTEKT03-BFTEKT01) LENGTH OF POSITION                48380000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      48400000
         DC    AL1(DCBINIT)                                             48420000
BFTEKT02 TAS   AND1,JFCB,JFCBFTEK,JBFTEK7                        A30036 48440019
*        *                                                              48460000
*        *     SECOND POSITION                                          48480000
*        *                                                              48500000
BFTEKT04 DS    0C END OF ENTRY                                          48520000
BFTEKT03 TASCT OR1,JFCB,JFCBFTEK,                                      148540000
               (JFCSIM,JFCEXC,JFCDYN,JBFTEK5,JBFTEK6),          AS24014248560002
               (S,E,D,A,R)                                      AS24014 48580002
         EJECT                                                          48600000
*              **************************************************       48620000
*              *                                                *       48640000
*              *    PARAMETER DESCRIPTION ENTRY FOR BFALN.      *       48660000
*              *                                                *       48680000
*              **************************************************       48700000
BFALNT   DS    0C START OF ENTRY                                        48720000
         DC    AL1(BFALNT04-BFALNT) LENGTH OF ENTRY                     48740000
*              *                                                        48760000
*              *    FIRST POSITION FOR KEY WORD                         48780000
*              *                                                        48800000
BFALNT01 DS    0C START OF ENTRY                                        48820000
         DC    AL1(BFALNT03-BFALNT01) LENGTH OF POSITION                48840000
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                      48860000
         DC    AL1(DCBINIT)                                             48880000
BFALNT02 TAS   AND1,JFCB,JFCBFALN,JBFALN3                        A30036 48900019
*        *                                                              48920000
*        *     SECOND POSITION                                          48940000
*        *                                                              48960000
BFALNT04 DS    0C END OF ENTRY                                          48980000
BFALNT03 TASCT OR1,JFCB,JFCBFALN,                                      149000000
               (JFCDWORD,JFCFWORD),                                    249020001
               (D,F)                                                    49040000
         EJECT                                                          49060000
*              **************************************************       49080000
*              *                                                *       49100000
*              *    PARAMETER DESCRIPTION ENTRY FOR RETPD.      *       49120000
*              *                                                *       49140000
*              **************************************************       49160000
*              *                                                        49180000
*              *    FIRST POSITION FOR KEY WORD                         49200000
*              *                                                        49220000
RETPDT   TASCD CVB2,DDWA,DDWA6,JRETPD1,9999                             49240001
         EJECT                                                          49260000
*              **************************************************       49280000
*              *                                                *       49300000
*              *    PARAMETER DESCRIPTION ENTRY FOR EXPD.       *       49320000
*              *                                                *       49340000
*              **************************************************       49360000
EXPDTT   DS    0C                                                       49380000
         DC    AL1(EXPDTT5-EXPDTT)                                      49400000
*              *                                                        49420000
*              *    FIRST POSITION FOR KEY WORD                         49440000
*              *                                                        49460000
EXPDTT1  DS    0C                                                       49480000
         TASCE CVB1,JFCB,JFCBXPDT,JEXPDT1,99                            49500000
*              *                                                        49520000
*              *    SECOND POSITION FOR KEY WORD.                       49540000
*              *                                                        49560000
EXPDTT2  DS    0C                                                       49580000
         TASCE CVB2,JFCB,JFCBXPDT+1,JEXPDT2,366                         49600000
*              *                                                        49620000
*              *    THIRD POSITION FOR KEY WORD.                        49640000
*              *                                                        49660000
EXPDTT3  DS    0C                                                       49680000
         TASCE CVB1,JFCB,JFCBCRDT,JEXPDT1,99                            49700000
*              *                                                        49720000
*              *    FOURTH POSITION FOR KEY WORD.                       49740000
*              *                                                        49760000
EXPDTT4  DS    0C                                                       49780000
         TASCE CVB2,JFCB,JFCBCRDT+1,JEXPDT2,366                         49800000
EXPDTT5  DS    0C                                                       49820000
         EJECT                                                          49840000
*              **************************************************  AAAA 49860015
*              *                                                *  AAAA 49861015
*              *    PARAMETER DESCRIPTION TABLE HIARCHY         *  AAAA 49862015
*              *                                                *  AAAA 49863015
*              **************************************************  AAAA 49864015
HIARCHYT DS    0C START OF ENTRY                                   AABA 49864216
         DC    AL1(HIAR04-HIARCHYT) LENGTH OF ENTRY                AABA 49864416
*              *                                                   AABA 49864616
*              *    FIRST POSITION                                 AABA 49864816
*              *                                                   AABA 49865016
HIAR01   DS    0C START OF POSITION                                AABA 49865216
         DC    AL1(HIAR03-HIAR01) LENGTH OF POSITION               AABA 49865416
         DC    AL1(DCBCNT) NUMBER OF CONTROL BYTES                 AABA 49865616
         DC    AL1(DCBINIT)                                        AABA 49865816
HIAR02   TAS   AND1,JFCB,JFCBHIAR,JHIAR3                           AABA 49866016
*              *                                                   AABA 49866216
*              *    SECOND POSITION                                AABA 49866416
*              *                                                   AABA 49866616
HIAR04   DS    0C                                                  AABA 49866816
HIAR03   TASCT OR1,JFCB,JFCBHIAR,                                  AABA149867016
               (JHIAR1,JHIAR2),                                    AABA249867216
               (0,1)                                               AABA 49867416
         EJECT                                                          49869015
*              **************************************************  AAAA 49870015
*              *                                                *       49880000
*              *    PARAMETER DESCRIPTION ENTRY FOR REF.        *       49900000
*              *                                                *       49920000
*              **************************************************       49940000
REFT     DS    0C                                                       49960000
         EJECT                                                          49980000
*              **************************************************       50000000
*              *                                                *       50020000
*              *    PARAMETER DESCRIPTION ENTRY FOR SER.        *       50040000
*              *                                                *       50060000
*              **************************************************       50080000
SERT     DS    0C                                                       50100000
         EJECT                                                          50120000
*              **************************************************       50140000
*              *                                                *       50160000
*              *    PARAMETER DESCRIPTION ENTRY FOR SEP MINOR.  *       50180000
*              *                                                *       50200000
*              **************************************************       50220000
SEPMT    DS    0C START OF ENTRY.                                       50240000
         DC    AL1(SEPMT3-SEPMT) LENGTH OF ENTRY.                       50260000
*              *                                                        50280000
*              *    FIRST POSITION FOR KEY WORD                         50300000
*              *                                                        50320000
SEPMT1   DS    0C START OF POSITION                                     50340000
         DC    AL1(SEPMT3-SEPMT1) LENGTH OF POSITION.                   50360000
         DC    AL1((SEPMT3-SEPMT2)*HEX) CONTROL BYTE                    50380000
         DC    AL1(JSEPM1) LENGTH ZERO.                                 50400000
SEPMT2   DS    0C START OF CONTROL BYTES                                50420000
SEPMT3   DS    0C END OF ENTRY                                          50460000
         EJECT                                                          50480000
*              **************************************************       50500000
*              *                                                *       50520000
*              *    PARAMETER DESCRIPTION ENTRY FOR AFF MINOR.  *       50540000
*              *                                                *       50560000
*              **************************************************       50580000
AFFMT    DS    0C START OF ENTRY.                                       50600000
         DC    AL1(AFFMT3-AFFMT) LENGTH OF ENTRY                        50620000
*              *                                                        50640000
*              *    FIRST POSITION FOR KEY WORD                         50660000
*              *                                                        50680000
AFFMT1   DS    0C START OF POSITION.                                    50700000
         DC    AL1(AFFMT3-AFFMT1) LENGTH OF POSITION.                   50720000
         DC    AL1((AFFMT3-AFFMT2)*HEX) CONTROL BYTE                    50740000
         DC    AL1(JAFFM1) LENGTH ZERO                                  50760000
AFFMT2   DS    0C START OF CONTROL BYTES                                50780000
         TAS   OR1,SIOT,SCTSBYT1,SCTUNAFF                               50800001
AFFMT3   DS    0C END OF ENTRY                                          50820000
         EJECT                                                          50840000
*              **************************************************       50860000
*              *                                                *       50880000
*              *    PARAMETER DESCRIPTION ENTRY FOR SUBALLOC.   *       50900000
*              *                                                *       50920000
*              **************************************************       50940000
SUBALLOT DS    0C START OF ENTRY.                                       50960000
         DC    AL1(SUBALT17-SUBALLOT) LENGTH OF ENTRY                   50980000
*              *                                                        51120000
*              *    FIRST POSITION FOR KEY WORD                         51140000
*              *                                                        51160000
SUBALT03 DS    0C END OF CONTROL CONTROL BYTES                          51180000
         DC    AL1(SUBALT11-SUBALT03)  LENGTH OF POSITION.              51200000
         DC    AL1((SUBALT06-SUBALT05)*HEX+L'SUBALT04) CONTROL BYTE.    51220000
SUBALT04 DC    C'TRK' COMPARE BYTES                                     51240000
SUBALT05 DS    0C START OF CONTROL BYTES                                51260000
         TAS   OR1,JFCB,JFCBCTRI,JFCBTRK                                51280001
SUBALT06 DS    0C END OF CONTROL BYTES.                                 51300000
         DC    AL1((SUBALT09-SUBALT08)*HEX+L'SUBALT07) CONTROL BYTE     51320000
SUBALT07 DC    C'CYL' COMPARE BYTES                                     51340000
SUBALT08 DS    0C START OF CONTROL BYTES.                               51360000
         TAS   OR1,JFCB,JFCBCTRI,JFCBCYL                                51380001
SUBALT09 DS    0C END OF CONTROL BYTES.                                 51400000
         DC    AL1((SUBALT11-SUBALT10)*HEX) CONTROL BYTE                51420000
         DC    AL1(JSUBAL6) MAX LENGTH.                                 51440000
SUBALT10 DS    0C START OF CONTROL BYTES                                51460000
         TAS   OR1,JFCB,JFCBCTRI,JFCBAVR                                51480001
         TAS   CVB3,JFCB,JFCBDRLH,JSUBAL8                               51500000
*              *                                                        51520000
*              *    SECOND POSITION FOR KEY WORD.                       51540000
*              *                                                        51560000
SUBALT11 DS    0C START OF POSITION.                                    51580000
         DC    AL1(SUBALT13-SUBALT11) LENGTH OF POSITION                51600000
         DC    AL1((SUBALT13-SUBALT12)*HEX) CONTROL BYTE.               51620000
         DC    AL1(JSUBAL9) MAX LENGTH                                  51640000
SUBALT12 DS    0C START OF CONTROL BYTES.                               51660000
         TAS   CVB3,JFCB,JFCBPQTY,JSUBAL10                              51680000
*              *                                                        51700000
*              *    THIRD POSITION FOR KEY WORD.                        51720000
*              *                                                        51740000
SUBALT13 DS    0C START OF POSITION.                                    51760000
         DC    AL1(SUBALT15-SUBALT13) LENGTH OF POSITION                51780000
         DC    AL1((SUBALT15-SUBALT14)*HEX) CONTROL BYTE                51800000
         DC    AL1(JSUBAL11) MAX LENGTH.                                51820000
SUBALT14 DS    0C START OF CONTROL BYTES                                51840000
         TAS   CVB3,JFCB,JFCBSQTY,JSUBAL12                              51860000
*              *                                                        51880000
*              *    FOURTH POSITION FOR KEY WORD.                       51900000
*              *                                                        51920000
SUBALT15 DS    0C START OF POSITION                                     51940000
         DC    AL1(SUBALT17-SUBALT15) LENGTH OF POSITION                51960000
         DC    AL1((SUBALT17-SUBALT16)*HEX) CONTROL BYTE                51980000
         DC    AL1(JSUBAL13) MAX LENGTH.                                52000000
SUBALT16 DS    0C START OF CONTROL BYTES                                52020000
         TAS   CVB3,JFCB,JFCBDQTY,JSUBAL14                              52040000
SUBALT17 DS    0C END OF ENTRY                                          52060000
         EJECT                                                          52080000
*              **************************************************       52100000
*              *                                                *       52120000
*              *    PARAMETER DESCRIPTION ENTRY FOR SYSOUT.     *       52140000
*              *                                                *       52160000
*              **************************************************       52180000
SYSOUTT  DS    0C START OF ENTRY.                                       52200000
         DC    AL1(SYSOUT09-SYSOUTT) LENGTH OF ENTRY                    52220000
*              *                                                        52240000
*              *    FIRST POSITION FOR KEYWORD.                         52260000
*              *                                                        52280000
SYSOUT01 DS    0C START OF POSITION                                437  52300000
         DC    AL1(SYSOUT05-SYSOUT01) LENGTH OF POSITION.          437  52320000
         DC    AL1((SYSOUT05-SYSOUT02)*HEX) CONTROL BYTES.         437  52340000
         DC    AL1(JSYSOUT7) MAXIMUM LENGTH.                       437  52360000
SYSOUT02 DS    0C START OF CONTROL BYTES                                52380000
         TAS   OR1,SIOT,SCTSBYT3,JSYSOUT3                               52400000
         TAS   OR1,JFCB,JFCBTSDM,JSYSOUT0                               52410000
         TAS   OR1,JFCB,JFCBLTYP,JSYSOUT6                               52420000
         DC    AL1(AMVCN1*HEX+INDM) FUNCTION AND TABLE BYTE             52430000
         TAS   MVCN,SIOT,SCTOUTPN                                       52440000
*              *                                                        52460000
*              *    SECOND POSITION FOR KEY WORD.                       52480000
*              *                                                        52500000
SYSOUT05 DS    0C START OF POSITION                                     52520000
         DC    AL1(SYSOUT07-SYSOUT05) LENGTH OF POSITION                52540000
         DC    AL1((SYSOUT07-SYSOUT06)*HEX) CONTROL BYTE                52560000
         DC    AL1(JSYSOUT8) MAX LENGTH.                                52580000
SYSOUT06 DS    0C START OF CONTROL BYTES.                               52600000
         TAS   AMVCN,SIOT,SCTOUTNM                                      52640000
*              *                                                        52660000
*              *    THIRD POSITION FOR KEY WORD.                        52680000
*              *                                                        52700000
SYSOUT07 DS    0C START OF POSITION                                     52720000
         DC    AL1(SYSOUT09-SYSOUT08) LENGTH OF POSITION                52740000
         DC    AL1((SYSOUT09-SYSOUT08)*HEX) CONTROL BYTE                52760000
         DC    AL1(JSYSOUT9) MAX LENGTH.                                52780000
SYSOUT08 DS    0C START OF CONTROL BYTES                                52800000
         TAS   AMVCN2,SIOT,SCTOUTNO                            @ZA20550 52820003
SYSOUT09 DS    0C END OF ENTRY                                          52840000
         EJECT                                                          52860000
*              **************************************************       52880000
*              *                                                *       52900000
*              *    PARAMETER DESCRIPTION ENTRY FOR DSNAME.     *       52920000
*              *                                                *       52940000
*              **************************************************       52960000
DSNAMET  DS    0C START OF ENTRY                                        52980000
         DC    AL1(DSNAMET7-DSNAMET) LENGTH OF ENTRY                    53000000
*              *                                                        53020000
*              *    FIRST POSITION FOR KEY WORD                         53040000
*              *                                                        53060000
DSNAMET1 DS    0C START OF POSITION                                     53080000
         DC    AL1(DSNAMET3-DSNAMET1) LENGTH OF POSITION                53100000
         DC    AL1((DSNAMET3-DSNAMET2)*HEX) CONTROL BYTE                53120000
         DC    AL1(JDSNAME1) MAX LENGTH OF DSNAME                       53140000
DSNAMET2 DS    0C START OF CONTROL BYTES                                53160000
         TAS   AMVCN,JFCB,JFCBDSNM                                      53180000
*              *                                                        53200000
*              *    SECOND POSITION FOR KEY WORD.                       53220000
*              *                                                        53240000
DSNAMET3 DS    0C START OF POSITION                                     53260000
         DC    AL1(DSNAMET5-DSNAMET3) LENGTH OF POSITION                53280000
         DC    AL1((DSNAMET5-DSNAMET4)*HEX) CONTROL BYTE                53300000
         DC    AL1(JDSNAME2) MAX LENGTH OF ELEMENT NAME                 53320000
DSNAMET4 DS    0C START OF CONTROL BYTES                                53340000
         TAS   AMVCN,JFCB,JFCBELNM                                      53360000
         TAS   OR1,JFCB,JFCBIND1,JDSNAME5                               53380000
*              *                                                        53400000
*              *    THIRD POSITION FOR KEY WORD.                        53420000
*              *                                                        53440000
DSNAMET5 DS    0C START OF POSITION                                     53460000
         DC    AL1(DSNAMET7-DSNAMET5) LENGTH OF POSITION                53480000
         DC    AL1((DSNAMET7-DSNAMET6)*HEX) CONTROL BYTE                53500000
         DC    AL1(JDSNAME3) MAX LENGTH OF GENERATION NUMBER            53520000
DSNAMET6 DS    0C START OF CONTROL BYTES                                53540000
         TAS   MVCN,JFCB,JFCBELNM                                       53560000
         TAS   OR1,SIOT,SCTSBYT4,JDSNAME4                               53580000
         TAS   OR1,JFCB,JFCBIND1,JDSNAME6   SET GDG INDICATOR    210271 53590001
DSNAMET7 DS    0C END OF ENTRY                                          53600000
         EJECT                                                          53600520
*              ************************************************** 20001 53601020
*              *                                                * 20001 53601520
*              *      PARAMETER DESCRIPTION TABLE FOR TERM      * 20001 53602020
*              *                  A TSO KEYWORD                 * 20001 53602520
*              ************************************************** 20001 53603020
         SPACE 3                                                        53603520
TERMT    DS    0C                  START OF ENTRY          TSO    20001 53604020
         DC    AL1(TERMT03-TERMT)  LENGTH OF ENTRY         TSO    20001 53604520
TERMT01  DS    0C                  START OF POSITION       TSO    20001 53605020
         DC    AL1(TERMT03-TERMT01) LENGTH OF POSITION     TSO    20001 53605520
         DC    AL1((TERMT03-TERMT03)*HEX+L'TERMT02)        TSO    20001 53606020
TERMT02  DC    C'TS'               COMPARE BYTES           TSO    20001 53606520
TERMT03  DS    0C                  END OF ENTRY            TSO    20001 53607020
         EJECT                                                    20002 53607520
*              ************************************************** 20002 53608020
*              *                                                * 20002 53608520
*              *    PARAMETER DESCRIPTION TABLE FOR QNAME       * 20002 53609020
*              *                                                * 20002 53609520
*              ************************************************** 20002 53610020
QNAMET   DS    0C   START OF ENTRY                                20002 53610520
         DC    AL1(QNAMET3-QNAMET)  LENGTH OF ENTRY               20002 53611020
*              *                                                  20002 53611520
*              *    FIRST POSITION FOR KEYWORD                    20002 53612020
*              *                                                  20002 53612520
QNAMET1  DS   0C   START OF POSITION                              20002 53613020
         DC   AL1(QNAMET3-QNAMET1)  LENGTH OF POSITION            20002 53613520
         DC    AL1((QNAMET3-QNAMET2)*HEX)   CONTROL BYTE          20002 53614020
         DC    AL1(JQNAME1)   MAX LENGTH OF QNAME                 20002 53614520
QNAMET2  DS    0C   START OF CONTROL BYTES                        2002  53615020
         TAS   AMVCN,JFCB,JFCBDSNM                                20002 53615520
         TAS   OR1,SIOT,SIOTTSTC,SIOTQNAM  TCAM SUPPORT           20002 53616020
         TAS   OR1,SIOT,SCTSBYT1,SCTDUMMY                         20002 53616520
QNAMET3  DS    0C   END OF ENTRY                                  20002 53617020
         EJECT                                                          53620000
*              ***************************************************      53640000
*              *                                                 *      53660000
*              *    PARAMETER DESCRIPTION TABLE FOR DUMMY        *      53680000
*              *                                                 *      53700000
*              ***************************************************      53720000
DUMMYT   DS    0C                 START OF ENTRY                        53740000
         EJECT                                                          53742020
*              ************************************************** 20001 53744020
*              *                                                * 20001 53746020
*              *     PARAMETER DESCRIPTION TABLE FOR DYNAM      * 20001 53748020
*              *                  A TSO KEYWORD                 * 20001 53750020
*              ************************************************** 20001 53752020
         SPACE 3                                                        53754020
DYNAMT   DS    0C                  START OF ENTRY          TSO    20001 53756020
DYNAMZ   DS    0C                  END OF ENTRY            TSO    20001 53758020
         EJECT                                                          53760000
*              **************************************************       53780000
*              *                                                *       53800000
*              *    PARAMETER DESCRIPTION ENTRY FOR CHKPT.      *       53820003
*              *                                                *       53840000
*              **************************************************       53860000
CHKPTT   DS    0C                    START OF ENTRY            @Z30JPSF 53880003
         DC    AL1(CHKPTT4-CHKPTT)   LENGTH OF ENTRY           @Z30JPSF 53880603
CHKPTT1  DS    0C                    START OF POSITION         @Z30JPSF 53881203
         DC    AL1(CHKPTT4-CHKPTT1)  LENGTH OF POSITION        @Z30JPSF 53881803
         DC    AL1((CHKPTT4-CHKPTT3)*HEX+L'CHKPTT2)   CTL      @Z30JPSF 53882403
CHKPTT2  DC    C'EOV'                COMPARE BYTES             @Z30JPSF 53883003
CHKPTT3  DS    0C                    START OF CTL BYTES        @Z30JPSF 53883603
         TAS   OR1,JFCB,JFCFLGS1,JFCBCEOV  CTL FUNCTION        @Z30JPSF 53884203
CHKPTT4  DS    0C                    END OF ENTRY              @Z30JPSF 53884803
         EJECT                                                          53886003
*              **************************************************Y02668 53888003
*              *                                                *Y02668 53892003
*              *   PARAMETER DESCRIPTION TABLE FOR SYSIN COUNT  *Y02668 53894003
*              *                                                *Y02668 53897003
*              **************************************************Y02668 53900003
SYSINCTT DS    0C                  DUMMY PDT FOR INTERNAL KEY    Y02668 53903003
         EJECT                                                          53906003
*              **************************************************       53910001
*              *                                                *       53912001
*              *    PARAMETER DESCRIPTION ENTRY FOR AMP.        *       53914001
*              *                                                *       53916001
*              **************************************************       53918001
         SPACE                                                          53918401
AMPTT    DS    0C                 START OF ENTRY                 Y01113 53918801
         EJECT                                                          53919201
*              **************************************************       53920000
*              *                                                *       53940000
*              *    PARAMETER DESCRIPTION ENTRY FOR SPLIT.      *       53960000
*              *                                                *       53980000
*              **************************************************       54000000
SPLITT   DS    0C START OF ENTRY.                                       54020000
         DC    AL1(SPLITT14-SPLITT) LENGTH OF ENTRY.                    54040000
*              *                                                        54060000
*              *    FIRST POSITION FOR KEY WORD                         54080000
*              *                                                        54100000
SPLITT03 DS    0C END OF CONTROL BYTES                                  54120000
         DC    AL1(SPLITT05-SPLITT03)  LENGTH OF POSITION.              54140000
         DC    AL1((SPLITT05-SPLITT04)*HEX) CONTROL BYTE                54160000
         DC    AL1(JSPLIT5) MAX LENGTH.                                 54180000
SPLITT04 DS    0C START OF CONTROL BYTES                                54200000
         TAS   CVB1,JFCX,SPLITTRK,JSPLIT6                        Y02661 54240002
*              *                                                        54260000
*              *    SECOND POSITION FOR KEY WORD.                       54280000
*              *                                                        54300000
SPLITT05 DS    0C START OF POSITION.                                    54320000
         DC    AL1(SPLITT10-SPLITT05) LENGTH OF POSITION                54340000
         DC    AL1((SPLITT08-SPLITT07)*HEX+L'SPLITT06) CONTROL BYTE.    54360000
SPLITT06 DC    C'CYL' COMPARE BYTES                                     54380000
SPLITT07 DS    0C START OF CONTROL BYTES.                               54400000
         TAS   OR1,JFCX,SPLITBYT,JFCBCYL                         Y02661 54440002
SPLITT08 DS    0C END OF CONTROL BYTES.                                 54480000
         DC    AL1((SPLITT10-SPLITT09)*HEX) CONTROL BYTE                54500000
         DC    AL1(JSPLIT8) MAX LENGTH.                                 54520000
SPLITT09 DS    0C START OF CONTROL BYTES.                               54540000
         TAS   CVB3,JFCX,SPLITBLN,JSPLIT9                        Y02661 54600002
         TAS   OR1,JFCX,SPLITBYT,JFCBAVR                         Y02661 54610002
*              *                                                        54620000
*              *    THIRD POSITION FOR KEY WORD.                        54640000
*              *                                                        54660000
SPLITT10 DS    0C START OF POSITION                                     54680000
         DC    AL1(SPLITT12-SPLITT10) LENGTH OF POSITION                54700000
         DC    AL1((SPLITT12-SPLITT11)*HEX) CONTROL BYTE                54720000
         DC    AL1(JSPLIT10) MAX LENGTH                                 54740000
SPLITT11 DS    0C START OF CONTROL BYTES.                               54760000
         TAS   CVB3,JFCX,SPLITPQY,JSPLIT11                       Y02661 54780002
*              *                                                        54800000
*              *    FOURTH POSITION FOR KEY WORD.                       54820000
*              *                                                        54840000
SPLITT12 DS    0C START OF POSITIONAL                                   54860000
         DC    AL1(SPLITT14-SPLITT12) LENGTH OF POSITION                54880000
         DC    AL1((SPLITT14-SPLITT13)*HEX) CONTROL BYTE                54900000
         DC    AL1(JSPLIT12) MAX LENGTH                                 54920000
SPLITT13 DS    0C START OF CONTROL BYTES                                54940000
         TAS   CVB3,JFCX,SPLITSQY,JSPLIT13                       Y02661 54960002
SPLITT14 DS    0C END OF ENTRY.                                         54980000
         EJECT                                                          55000000
*              **************************************************       55020000
*              *                                                *       55040000
*              *    PARAMETER DESCRIPTION ENTRY FOR SPACE.      *       55060000
*              *                                                *       55080000
*              **************************************************       55100000
SPACET   DS    0C START OF ENTRY.                                       55120000
         DC    AL1(SPACET41-SPACET) LENGTH OF ENTRY                     55140000
*              *                                                        55160000
*              *    FIRST POSITION FOR KEY WORD                         55180000
*              *                                                        55200000
SPACET01 DS    0C START OF POSITION.                                    55220000
SPACET03 DS    0C EN                                                    55240000
         DC    AL1(SPACET14-SPACET03)  LENGTH OF POSITION).             55260000
         DC    AL1((SPACET06-SPACET05)*HEX+L'SPACET04)                  55280000
SPACET04 DC    C'TRK'                                                   55300000
SPACET05 DS    0C                                                       55320000
         TAS   OR1,JFCB,JFCBCTRI,JFCBTRK                                55340001
SPACET06 DS    0C                                                       55360000
         DC    AL1((SPACET09-SPACET08)*HEX+L'SPACET07)                  55380000
SPACET07 DC    C'CYL'                                                   55400000
SPACET08 DS    0C                                                       55420000
         TAS   OR1,JFCB,JFCBCTRI,JFCBCYL                                55440001
SPACET09 DS    0C                                                       55460000
         DC    AL1((SPACET12-SPACET11)*HEX+L'SPACET10)                  55480000
SPACET10 DC    C'ABSTR'                                                 55500000
SPACET11 DS    0C                                                       55520000
         TAS   OR1,DDWA,DDWA2,JDICTI5                                   55540001
SPACET12 DS    0C                                                       55560000
         DC    AL1((SPACET14-SPACET13)*HEX)                             55580000
         DC    AL1(JSPACE06)                                            55600000
SPACET13 DS    0C                                                       55620000
         TAS   CVB3,JFCB,JFCBDRLH,JSPACE07                              55640000
         TAS   OR1,JFCB,JFCBCTRI,JFCBAVR                                55660001
*              *                                                        55680000
*              *    SECOND POSITION FOR KEY WORD.                       55700000
*              *                                                        55720000
SPACET14 DS    0C START OF POSITION                                     55740000
         DC    AL1(SPACET16-SPACET14)                                   55760000
         DC    AL1((SPACET16-SPACET15)*HEX)                             55780000
         DC    AL1(JSPACE08)                                            55800000
SPACET15 DS    0C                                                       55820000
         TAS   CVB3,JFCB,JFCBPQTY,JSPACE09                              55840000
SPACET16 DS    0C                                                       55860000
         DC    AL1(SPACET18-SPACET16)                                   55880000
         DC    AL1((SPACET18-SPACET17)*HEX)                             55900000
         DC    AL1(JSPACE10)                                            55920000
SPACET17 DS    0C                                                       55940000
         TAS   CVB3,JFCB,JFCBSQTY,JSPACE11                              55960000
SPACET18 DS    0C                                                       55980000
         DC    AL1(SPACET20-SPACET18)                                   56000000
         DC    AL1((SPACET20-SPACET19)*HEX)                             56020000
         DC    AL1(JSPACE12)                                            56040000
SPACET19 DS    0C                                                       56060000
         TAS   CVB3,JFCB,JFCBDQTY,JSPACE13                              56080000
*              *                                                        56100000
*              *    THIRD POSITION FOR KEY WORD.                        56120000
*              *                                                        56140000
SPACET20 DS    0C                                                       56160000
         DC    AL1(SPACET23-SPACET20)                                   56180000
         DC    AL1((SPACET23-SPACET22)*HEX+L'SPACET21)                  56200000
SPACET21 DC    C'RLSE'                                                  56220000
SPACET22 DS    0C                                                       56240000
         TAS   OR1,JFCB,JFCBIND1,JFCRLSE                                56260001
*              *                                                        56280000
*              *    FOURTH POSITION FOR KEY WORD.                       56300000
*              *                                                        56320000
SPACET23 DS    0C                                                       56340000
         DC    AL1(SPACET32-SPACET23)                                   56360000
         DC    AL1((SPACET26-SPACET25)*HEX+L'SPACET24)                  56380000
SPACET24 DC    C'MXIG'                                                  56400000
SPACET25 DS    0C                                                       56420000
         TAS   OR1,JFCB,JFCBCTRI,JFCMIXG                                56440001
SPACET26 DS    0C                                                       56460000
         DC    AL1((SPACET29-SPACET28)*HEX+L'SPACET27)                  56480000
SPACET27 DC    C'ALX'                                                   56500000
SPACET28 DS    0C                                                       56520000
         TAS   OR1,JFCB,JFCBCTRI,JFCALX                                 56540001
SPACET29 DS    0C                                                       56560000
         DC    AL1((SPACET32-SPACET31)*HEX+L'SPACET30)                  56580000
SPACET30 DC    C'CONTIG'                                                56600000
SPACET31 DS    0C                                                       56620000
         TAS   OR1,JFCB,JFCBCTRI,JFCONTIG                               56640001
*              *                                                        56660000
*              *    FIFTH POSION FOR KEY WORD.                          56680000
*              *                                                        56700000
SPACET32 DS    0C                                                       56720000
         DC    AL1(SPACET35-SPACET32)                                   56740000
         DC    AL1((SPACET35-SPACET34)*HEX+L'SPACET33)                  56760000
SPACET33 DC    C'ROUND'                                                 56780000
SPACET34 DS    0C                                                       56800000
         TAS   OR1,JFCB,JFCBCTRI,JFCROUND                               56820001
*              *                                                        56840000
*              *    SECOND POSITION FOR KEY WORD.                       56860000
*              *                                                        56880000
SPACET35 DS    0C                                                       56900000
         DC    AL1(SPACET37-SPACET35)                                   56920000
         DC    AL1((SPACET37-SPACET36)*HEX)                             56940000
         DC    AL1(JSPACE19)                                            56960000
SPACET36 DS    0C                                                       56980000
         TAS   CVB3,JFCB,JFCBPQTY,JSPACE20                              57000000
*              *                                                        57020000
*              *    THIRD POSITION FOR KEY WORD.                        57040000
*              *                                                        57060000
SPACET37 DS    0C                                                       57080000
         DC    AL1(SPACET39-SPACET37)                                   57100000
         DC    AL1((SPACET39-SPACET38)*HEX)                             57120000
         DC    AL1(JSPACE21)                                            57140000
SPACET38 DS    0C                                                       57160000
         TAS   CVB2,JFCB,JFCBABST,JSPACE22                              57180000
*              *                                                        57200000
*              *    FOURTH POSITION FOR KEY WORD.                       57220000
*              *                                                        57240000
SPACET39 DS    0C START OF POSITION                                     57260000
         DC    AL1(SPACET41-SPACET39) LENGTH OF POSITION                57280000
         DC    AL1((SPACET41-SPACET40)*HEX) CONTROL BYTE.               57300000
         DC    AL1(JSPACE23) MAX LENGTH                                 57320000
SPACET40 DS    0C START OF CONTROL BYTES.                               57340000
         TAS   CVB3,JFCB,JFCBDQTY,JSPACE24                              57360000
SPACET41 DS    0C END OF ENTRY.                                         57380000
         EJECT                                                 @Y30LPSB 57381003
*              *********************************************** @Y30LPSB 57382003
*              *                                             * @Y30LPSB 57383003
*              *     PARAMETER DESCRIPTOR TABLE FOR MSVGP    * @Y30LPSB 57384003
*              *                                             * @Y30LPSB 57385003
*              *********************************************** @Y30LPSB 57386003
MSVGPT   DS    0C   START OF ENTRY                             @Y30LPSB 57387003
         DC    AL1(MSVGP3-MSVGPT)  LENGTH OF ENTRY             @Y30LPSB 57388003
*                   *                                          @Y30LPSB 57389003
*                   *  ONE POSITION FOR KEYWORD                @Y30LPSB 57390003
*                   *                                          @Y30LPSB 57391003
MSVGP1   DS    0C                                              @Y30LPSB 57392003
         DC    AL1(MSVGP3-MSVGP1)  START OF POSITION           @Y30LPSB 57393003
         DC    AL1((MSVGP3-MSVGP2)*HEX)  CONTROL BYTE          @Y30LPSB 57394003
         DC    AL1(MSVGPLN)  MAX LENGTH OF MSVGP ID            @Y30LPSB 57395003
MSVGP2   DS    0C    START OF CONTROL BYTES                    @Y30LPSB 57396003
         TAS   MVCN,JFCB,JFCMSVGP                              @Y30LPSB 57397003
         TAS   OR1,JFCB,JFCBCTRI,JFCBMSGP                      @Y30LPSB 57398003
         TAS   OR1,SIOT,SCTSDISP,PRIVATE                       @Y30LPSB 57398503
MSVGP3   DS    0C  END OF ENTRY                                @Y30LPSB 57399003
         EJECT                                                          57400000
*              **************************************************       57420000
*              *                                                *       57440000
*              *    PARAMETER DESCRIPTION ENTRY FOR DISP.       *       57460000
*              *                                                *       57480000
*              **************************************************       57500000
DISPT    DS    0C START OF ENTRY.                                       57520000
         DC    AL1(DISPT41-DISPT)  LENGTH OF ENTRY                 000B 57540000
*              *                                                        57560000
*              *    FIRST POSITION FOR KEY WORD                         57580000
*              *                                                        57600000
DISPT1   DS    0C START OF POSITION.                                    57620000
         DC    AL1(DISPT13-DISPT1) LENGTH OF POSITION.                  57640000
         DC    AL1((DISPT4-DISPT3)*HEX+L'DISPT2) CONTROL BYTE.          57660000
DISPT2   DC    C'NEW' COMPARE BYTES.                                    57680000
DISPT3   DS    0C START OF CONTROL BYTES.                               57700000
         TAS   OR1,JFCB,JFCBIND2,JFCNEW                                 57720001
         TAS   OR1,SIOT,SCTSBYT3,JDISP2                                 57740000
DISPT4   DS    0C END OF CONTROL BYTES.                                 57760000
         DC    AL1((DISPT7-DISPT6)*HEX+L'DISPT5) CONTROL BYTE.          57780000
DISPT5   DC    C'OLD' COMPARE BYTES.                                    57800000
DISPT6   DS    0C START OF CONTROL BYTES.                               57820000
         TAS   OR1,JFCB,JFCBIND2,JFCOLD                                 57840001
         TAS   OR1,SIOT,SCTSBYT3,JDISP4                                 57860000
DISPT7   DS    0C END OF CONTROL BYTES.                                 57880000
         DC    AL1((DISPT10-DISPT9)*HEX+L'DISPT8) CONTROL BYTE.         57900000
DISPT8   DC    C'MOD' COMPARE BYTES.                                    57920000
DISPT9   DS    0C START OF CONTROL BYTES.                               57940000
         TAS   OR1,JFCB,JFCBIND2,JFCMOD                                 57960001
         TAS   OR1,SIOT,SCTSBYT3,JDISP6                                 57980000
DISPT10  DS    0C END OF CONTROL BYTES.                                 58000000
DISPT91  DS    0C END OF CONTROL.                                       58020000
         DC    AL1((DISPT94-DISPT93)*HEX+L'DISPT92) CONTROL BYTE.       58040000
DISPT92  DC    C'SHR' COMPARE BYTES.                                    58060000
DISPT93  DS    0C START OF CONTROL BYTES.                               58080000
         TAS   OR1,JFCB,JFCBIND2,JFCSHARE+JFCOLD                        58100001
         TAS   OR1,SIOT,SCTSBYT3,JDISP8                                 58120000
DISPT94  DS    0C END OF CONTROL BYTES.                                 58140000
         DC    AL1((DISPT13-DISPT12)*HEX+L'DISPT11) CONTROL BYTE.       58160000
DISPT11  DC    C'SHARE' COMPARE BYTE.                                   58180000
DISPT12  DS    0C START OF CONTROL BYTES.                               58200000
         TAS   OR1,JFCB,JFCBIND2,JFCSHARE+JFCOLD                        58220001
         TAS   OR1,SIOT,SCTSBYT3,JDISP8                                 58240000
*              *                                                        58260000
*              *    SECOND POSITION FOR KEY WORD.                       58280000
*              *                                                        58300000
DISPT13  DS    0C START OF POSITION.                                    58320000
         DC    AL1(DISPT28-DISPT13) LENGTH OF POSITION.                 58340000
         DC    AL1((DISPT16-DISPT15)*HEX+L'DISPT14) CONTROL BYTR.       58360000
DISPT14  DC    C'DELETE' COMPARE BYTES.                                 58380000
DISPT15  DS    0C START OF CONTROL BYTES.                               58400000
         TAS   OR1,SIOT,SCTSDISP,JDISP9                                 58420000
DISPT16  DS    0C END OF CONTROL BYTES.                                 58440000
         DC    AL1((DISPT19-DISPT18)*HEX+L'DISPT17) CONTROL BYTE.       58460000
DISPT17  DC    C'KEEP' COMPARE BYTES.                                   58480000
DISPT18  DS    0C START OF CONTROL BYTES.                               58500000
         TAS   OR1,SIOT,SCTSDISP,JDISP10                                58520000
DISPT19  DS    0C END OF CONTROL BYTES.                                 58540000
         DC    AL1((DISPT22-DISPT21)*HEX+L'DISPT20) CONTROL BYTE.       58560000
DISPT20  DC    C'PASS' COMPARE BYTES.                                   58580000
DISPT21  DS    0C START OF CONTROL BYTES.                               58600000
         TAS   OR1,SIOT,SCTSDISP,JDISP11                                58620000
DISPT22  DS    0C END OF CONTROL BYTES.                                 58640000
         DC    AL1((DISPT25-DISPT24)*HEX+L'DISPT23) CONTROL BYTE.       58660000
DISPT23  DC    C'CATLG' COMPARE BYTES.                                  58680000
DISPT24  DS    0C START OF CONTROL BYTES.                               58700000
         TAS   OR1,SIOT,SCTSDISP,JDISP12                                58720000
DISPT25  DS    0C END OF CONTROL BYTES.                                 58740000
         DC    AL1((DISPT28-DISPT27)*HEX+L'DISPT26) CONTROL BYTE.       58760000
DISPT26  DC    C'UNCATLG' COMPARE BYTES.                                58780000
DISPT27  DS    0C START OF CONTROL BYTES.                               58800000
         TAS   OR1,SIOT,SCTSDISP,JDISP13                                58820000
DISPT28  DS    0C END OF ENTRY.                                         58840000
*              *                                                   000B 58840700
*              *         THIRD POSITION FOR KEYWORD                000B 58841400
*              *                                                   000B 58842100
DISPT29  DS    0C       STSRT OF POSITION                          000B 58842800
         DC    AL1(DISPT41-DISPT29)  LENGTH OF POSITION            000B 58843500
         DC    AL1((DISPT32-DISPT31)*HEX+L'DISPT30)  CONTROL BYTE  000B 58844200
DISPT30  DC    C'DELETE'  COMPARE BYTES                            000B 58844900
DISPT31  DS    0C  START OF CONTROL BYTES                          000B 58845600
         TAS   OR1,SIOT,SIOTALTD,JDISP9                            000B 58846300
DISPT32  DS    0C  END OF CONTROL BYTES                            000B 58847000
         DC    AL1((DISPT35-DISPT34)*HEX+L'DISPT33)  CONTROL BYTE  000B 58847700
DISPT33  DC    C'KEEP'  COMPARE BYTES                              000B 58848400
DISPT34  DS    0C  START OF CONTROL BYTES                          000B 58849100
         TAS   OR1,SIOT,SIOTALTD,JDISP10                           000B 58849800
DISPT35  DS    0C  END OF CONTROL BYTES                            000B 58850500
         DC    AL1((DISPT38-DISPT37)*HEX+L'DISPT36)  CONTROL BYTE  000B 58851200
DISPT36  DC    C'CATLG'  COMPARE BYTES                             000B 58851900
DISPT37  DS    0C  START OF CONTROL BYTES                          000B 58852600
         TAS   OR1,SIOT,SIOTALTD,JDISP12                           000B 58853300
DISPT38  DS    0C  END OF CONTROL BYTES                            000B 58854000
         DC    AL1((DISPT41-DISPT40)*HEX+L'DISPT39)  CONTROL BYTE  000B 58854700
DISPT39  DC    C'UNCATLG'  COMPARE BYTES                           000B 58855400
DISPT40  DS    0C  START OF CONTROL BYTES                          000B 58856100
         TAS   OR1,SIOT,SIOTALTD,JDISP13                           000B 58856800
DISPT41  DS    0C  END OF ENTRY                                    000B 58857500
         EJECT                                                          58860000
*              **************************************************       58880000
*              *                                                *       58900000
*              *    PARAMETER DESCRIPTION ENTRY FOR SEP.        *       58920000
*              *                                                *       58940000
*              **************************************************       58960000
SEPT     DS    0C START OF ENTRY                                        58980000
         DC    AL1(SEPT3-SEPT) LENGTH OF ENTRY.                         59000000
*              *                                                        59020000
*              *    FIRST POSITION FOR KEY WORD                         59040000
*              *                                                        59060000
SEPT1    DS    0C START OF POSITION.                                    59080000
         DC    AL1(SEPT3-SEPT1) LENGTH OF POSITION.                     59100000
         DC    AL1((SEPT3-SEPT2)*HEX) CONTROL BYTE.                     59120000
         DC    AL1(JSEP1) LENGTH ZERO.                                  59140000
SEPT2    DS    0C START OF CONTROL BYTES                                59160000
SEPT3    DS    0C END OF ENTRY.                                         59200000
         EJECT                                                          59220000
*              **************************************************       59240000
*              *                                                *       59260000
*              *    PARAMETER DESCRIPTION ENTRY FOR AFF.        *       59280000
*              *                                                *       59300000
*              **************************************************       59320000
AFFT     DS    0C START OF ENTRY                                        59340000
         DC    AL1(AFFT3-AFFT) LENGTH OF ENTRY                          59360000
*              *                                                        59380000
*              *    FIRST POSITION FOR KEY WORD                         59400000
*              *                                                        59420000
AFFT1    DS    0C START OF POSITION.                                    59440000
         DC    AL1(AFFT3-AFFT1) LENGTH OF POSITION.                     59460000
         DC    AL1((AFFT3-AFFT2)*HEX) CONTROL BYTE.                     59480000
         DC    AL1(JAFF1) LENGTH ZERO.                                  59500000
AFFT2    DS    0C START OF CONTROL BYTES.                               59520000
AFFT3    DS    0C END OF ENTRY.                                         59560000
         EJECT                                                          59580000
*              **************************************************       59600000
*              *                                                *       59620000
*              *    PARAMETER DESCRIPTION ENTRY FOR VOLUME.     *       59640000
*              *                                                *       59660000
*              **************************************************       59680000
VOLUMET  DS    0C START OF ENTRY.                                       59700000
         DC    AL1(VOLUMETB-VOLUMET) LENGTH OF ENTRY.                   59720000
*              *                                                        59740000
*              *    FIRST POSITION FOR KEY WORD                         59760000
*              *                                                        59780000
VOLUMET1 DS    0C START OF POSITION                                     59800000
         DC    AL1(VOLUMET4-VOLUMET1) LENGTH OF POSITION.               59820000
         DC    AL1((VOLUMET4-VOLUMET3)*HEX+L'VOLUMET2) CONTROL & COMP.  59840000
VOLUMET2 DC    C'PRIVATE' COMPARE BYTES.                                59860000
VOLUMET3 DS    0C START OF CONTROL BYTES.                               59880000
         TAS   OR1,SIOT,SCTSDISP,PRIVATE                         Y02668 59900002
*              *                                                        59920000
*              *    SECOND POSITION FOR KEY WORD.                       59940000
*              *                                                        59960000
VOLUMET4 DS    0C START OF POSITION.                                    59980000
         DC    AL1(VOLUMET7-VOLUMET4) LENGTH OF POSITION.               60000000
         DC    AL1((VOLUMET7-VOLUMET6)*HEX+L'VOLUMET5) CONTROL & COMP.  60020000
VOLUMET5 DC    C'RETAIN' COMPARE BYTES.                                 60040000
VOLUMET6 DS    0C START OF CONTROL BYTES.                               60060000
         TAS   OR1,SIOT,SCTSDISP,SIOTRETN                      @ZD03010 60070003
         TAS   OR1,SIOT,SCTSDISP,SIOTRETN                      @ZA03600 60080003
*              *                                                        60100000
*              *    THIRD POSITION FOR KEY WORD.                        60120000
*              *                                                        60140000
VOLUMET7 DS    0C START OF POSITION.                                    60160000
         DC    AL1(VOLUMET9-VOLUMET7) LENGTH OF POSITION.               60180000
         DC    AL1((VOLUMET9-VOLUMET8)*HEX) CONTROL BYTE                60200000
         DC    AL1(JVOLUMT3) MAXIMUM LENGTH.                            60220000
VOLUMET8 DS    0C START OF CONTROL BYTES.                               60240000
         TAS   CVB2,JFCB,JFCBVLSQ,JVOLUMT4                              60260000
*              *                                                        60280000
*              *    FOURTH POSITION FOR KEY WORD.                       60300000
*              *                                                        60320000
VOLUMET9 DS    0C START OF POSITION.                                    60340000
         DC    AL1(VOLUMETB-VOLUMET9) LENGTH OF POSITION.               60360000
         DC    AL1((VOLUMETB-VOLUMETA)*HEX) CONTROL BYTE.               60380000
         DC    AL1(JVOLUMT5) MAXIMUM LENGTH                             60400000
VOLUMETA DS    0C START OF CONTROL BYTES.                               60420000
         TAS   CVB1,JFCB,JFCBVLCT,JVOLUMT6                              60440000
VOLUMETC DS    0C START OF CONTROL BYTES                            694 60460000
         TAS   CVB1,SIOT,SIOTVLCT,JVOLUMT6                          694 60480000
VOLUMETB DS    0C END OF ENTRY.                                         60500000
         EJECT                                                          60520000
*              **************************************************       60540000
*              *                                                *       60560000
*              *    PARAMETER DESCRIPTION ENTRY FOR LABEL.      *       60580000
*              *                                                *       60600000
*              **************************************************       60620000
LABELT   DS    0C START OF ENTRY                                        60640000
         DC    AL1(LABELT24-LABELT)                                AADA 60660017
*              *                                                        60680000
*              *    FIRST POSITION FOR KEY WORD                         60700000
*              *                                                        60720000
LABELT01 DS    0C START OF POSITION                                     60740000
         DC    AL1(LABELT03-LABELT01) LENGTH OF POSITION.               60760000
         DC    AL1((LABELT03-LABELT02)*HEX) CONTROL BYTE                60780000
         DC    AL1(JLABEL1) MAX LENGTH.                                 60800000
LABELT02 DS    0C START OF CONTROL BYTES                                60820000
         TAS   CVB2,JFCB,JFCBFLSQ,JLABEL2                               60840000
*              *                                                        60860000
*              *    SECOND POSITION FOR KEY WORD.                       60880000
*              *                                                        60900000
LABELT03 DS    0C START OF POSITION.                                    60920000
         DC    AL1(LABELT15-LABELT03)                                   60940000
         DC    AL1((LABELT06-LABELT05)*HEX+L'LABELT04) CONTROL BYTE     60960000
LABELT04 DC    C'NL' COMPARE BYTES                                      60980000
LABELT05 DS    0C START OF CONTROL BYTES                                61000000
         TAS   OR1,SIOT,SCTSBYT2,JLABEL3                                61020000
         TAS   OR1,JFCB,JFCBLTYP,JFCNL                                  61040001
         TAS   AND1,JFCB,JFCBLTYP,DD255-JFCSL                           61060001
LABELT06 DS    0C END OF CONTROL BYTES                                  61080000
         DC    AL1((LABELT09-LABELT08)*HEX+L'LABELT07) CONTROL BYTE     61100000
LABELT07 DC    C'SL' COMPARE BYTES.                                     61120000
LABELT08 DS    0C START OF CONTROL BYTES.                               61140000
         TAS   OR1,JFCB,JFCBLTYP,JFCSL                                  61160001
LABELT09 DS    0C END OF CONTROL BYTES.                                 61180000
         DC    AL1((LABELT12-LABELT11)*HEX+L'LABELT10) CONTROL BYTE     61200000
LABELT10 DC    C'NSL' COMPARE BYTES                                     61220000
LABELT11 DS    0C START OF CONTROL BYTES                                61240000
         TAS   OR1,SIOT,SCTSBYT2,JLABEL6                                61260000
         TAS   OR1,JFCB,JFCBLTYP,JFCNSL                                 61280001
         TAS   AND1,JFCB,JFCBLTYP,DD255-JFCSL                           61300001
LABELT12 DS    0C END OF CONTROL BYTES                                  61320000
         DC    AL1((LABELT3C-LABELT3B)*HEX+L'LABELT3A) CONTROL BYTE     61322000
LABELT3A DC    C'BLP' COMPARE BYTES                                     61324000
LABELT3B DS    0C START OF CONTROL BYTES                                61326000
         TAS   OR1,SIOT,SCTSBYT2,JLABELA                                61328000
         TAS   OR1,JFCB,JFCBLTYP,JFCBLP                                 61330001
         TAS   AND1,JFCB,JFCBLTYP,DD255-JFCSL                           61332001
LABELT3C DS    0C END OD CONTROL BYTES                                  61334000
         DC    AL1((LABELT3D-LABELT14)*HEX+L'LABELT13) CONTROL    19200 61344019
LABELT13 DC    C'SUL' COMPARE BYTE                                      61360000
LABELT14 DS    0C START OF CONTROL BYTES.                               61380000
         TAS   OR1,JFCB,JFCBLTYP,JLABEL8                                61400000
LABELT3D DS    0C END OF CONTROL BYTES                            19200 61402019
         DC    AL1((LABELT3G-LABELT3F)*HEX+L'LABELT3E) CONTROL    19200 61404019
LABELT3E DC    C'AL' COMPARE BYTES                                19200 61406019
LABELT3F DS    0C START OF CONTROL BYTES.                         19200 61408019
         TAS   AND1,JFCB,JFCBLTYP,JLABELD1 REMOVE DEFAULT SL      19200 61410019
         TAS   OR1,JFCB,JFCBLTYP,JFCBAL  INDICATE USASI LABEL     19200 61412001
         TAS   OR1,SIOT,SCTSBYT4,JLABELE INDICATE USASI LABEL     19200 61414019
LABELT3G DS    0C END OF CONTROL BYTES.                           19200 61416019
         DC    AL1((LABELT3J-LABELT3I)*HEX+L'LABELT3H) CONTROL    19200 61418019
LABELT3H DC    C'AUL' COMPARE BYTES.                              19200 61420019
LABELT3I DS    0C START OF CONTROL BYTES.                         19200 61422019
         TAS   AND1,JFCB,JFCBLTYP,JLABELF1 TURN OFF SL DEFAULT    19200 61424019
         TAS   OR1,JFCB,JFCBLTYP,JLABELF INDICATE USASI LABEL     19200 61426019
         TAS   OR1,SIOT,SCTSBYT4,JLABELG INDICATE USASI LABEL     19200 61428019
LABELT3J DS    0C END OF CONTROL BYTES.                           19200 61430019
         DC    AL1((LABELT32-LABELT31)*HEX+L'LABELT30) CONTROL   210271 61431001
LABELT30 DC    C'LTM' COMPARE BYTES                              210271 61432001
LABELT31 DS    0C START OF CONTROL BYTES                         210271 61433001
         TAS   OR1,SIOT,SCTSBYT2,JLABEL3                         Y02668 61433502
         TAS   AND1,JFCB,JFCBLTYP,JLABELF1 TURN OFF SL DEFAULT   210271 61434001
         TAS   OR1,JFCB,JFCBLTYP,JLABLTM  INDICATE LTM           210271 61435001
         TAS   OR1,SIOT,SCTSBYT2,SCTUNLBD                        Y02668 61435502
LABELT32 DS    0C END OF CONTROL BYTES                           210271 61436001
*              *                                                        61440000
*              *    THIRD POSITION FOR KEY WORD.                        61460000
*              *                                                        61480000
LABELT15 DS    0C END OF ENTRY.                                         61500000
         DC    AL1(LABELT18-LABELT15)                                   61520000
         DC    AL1((LABELT1A-LABELT17)*HEX+L'LABELT16) CONTRL BYTE RWPW 61540020
LABELT16 DC    C'PASSWORD'                                              61560000
LABELT17 DS    0C                                                       61580000
         TAS   OR1,JFCB,JFCBIND2,JFCBSCTY                               61600001
LABELT1A DS    0C START OF CONTROL BYTES                          M0659 61600820
         DC    AL1((LABELT18-LABELT1C)*HEX+L'LABELT1B) CONTROL    M0659 61601620
LABELT1B DC    C'NOPWREAD' COMPARE BYTE                           M0659 61602420
LABELT1C DS    0C                                                 M0659 61603220
         TAS   OR1,JFCB,JFCBIND2,JFCBRWPW                         M0659 61604001
*              *                                                   AADA 61605017
*              *     FOURTH POSITION                               AADA 61610017
*              *                                                   AADA 61615017
LABELT18 DS    0C START OF POSITION                                AADA 61616017
         DC    AL1(LABELT24-LABELT18) LENGTH OF POSITION           AADA 61617017
         DC    AL1((LABELT21-LABELT20)*HEX+L'LABELT19)             AADA 61618017
LABELT19 DC    C'IN' COMPARE BYTES                                 AADA 61619017
LABELT20 DS    0C START OF CONTROL BYTES                           AADA 61620017
         TAS    OR1,JFCB,JFCBFLG2,JFCINOP                               61621001
LABELT21 DS    0C END OF CONTROL BYTES                             AADA 61622017
         DC    AL1((LABELT24-LABELT23)*HEX+L'LABELT22)             AADA 61623017
LABELT22 DC    C'OUT' COMPARE BYTES                                AADA 61624017
LABELT23 DS    0C START OF CONTROL BYTES                           AADA 61625017
         TAS    OR1,JFCB,JFCBFLG2,JFCOUTOP                              61626001
LABELT24 DS    0C END OF ENTRY                                     AADA 61627017
         EJECT                                                          61640000
*              **************************************************       61660000
*              *                                                *       61680000
*              *    PARAMETER DESCRIPTION ENTRY FOR UNIT.       *       61700000
*              *                                                *       61720000
*              **************************************************       61740000
UNITT    DS    0C START OF ENTRY.                                       61760000
         DC    AL1(UNITT13-UNITT) LENGTH OF ENTRY.                      61780000
*              *                                                        61800000
*              *    FIRST POSITION FOR KEY WORD                         61820000
*              *                                                        61840000
UNITT03  DS    0C END OF CONTROL BYTES                                  61860000
         DC    AL1(UNITT05-UNITT03) LENGTH OF POSITION.                 61880000
         DC    AL1((UNITT05-UNITT04)*HEX) CONTROL BYTE                  61900000
         DC    AL1(JUNIT3) MAX LENGTH                                   61920000
UNITT04  DS    0C START OF CONTROL BYTES                                61940000
         TAS   MVCN,SIOT,SCTUTYPE                                       61960000
*              *                                                        61980000
*              *    SECOND POSITION FOR KEY WORD.                       62000000
*              *                                                        62020000
UNITT05  DS    0C START OF POSITION                                     62040000
         DC    AL1(UNITT10-UNITT05) LENGTH OF POSITION                  62060000
         DC    AL1((UNITT08-UNITT07)*HEX+L'UNITT06) CONTROL BYTE        62080000
UNITT06  DC    C'P' COMPARE BYTE                                        62100000
UNITT07  DS    0C START OF CONTROL BYTES                                62120000
         TAS   OR1,SIOT,SCTSBYT1,JUNIT4                                 62140000
UNITT08  DS    0C END OF CONTROL BYTES                                  62160000
         DC    AL1((UNITT10-UNITT09)*HEX) CONTROL BYTE                  62180000
         DC    AL1(JUNIT5) MAX LENGTH                                   62200000
UNITT09  DS    0C START OF CONTROL BYTES                                62220000
         TAS   CVB1,SIOT,SCTNMBUT,JUNIT6                                62240000
*              *                                                        62260000
*              *    THIRD POSITION FOR KEY WORD.                        62280000
*              *                                                        62300000
UNITT10  DS    0C START OF POSITION                                     62320000
         DC    AL1(UNITT13-UNITT10) LENGTH OF POSITION                  62340000
         DC    AL1((UNITT13-UNITT12)*HEX+L'UNITT11) CONTROL BYTE        62360000
UNITT11  DC    C'DEFER' COMPARE BYTES                                   62380000
UNITT12  DS    0C START OF CONTROL BYTES                                62400000
         TAS   OR1,SIOT,SCTSBYT2,JUNIT7                                 62420000
UNITT13  DS    0C END OF ENTRY.                                         62440000
         EJECT                                                          62460000
*              **************************************************       62480000
*              *                                                *       62500000
*              *    PARAMETER DESCRIPTION ENTRY FOR DCB.        *       62520000
*              *                                                *       62540000
*              **************************************************       62560000
DCBT     DS    0C START OF ENTRY.                                       62580000
*              *********************************************   @Z40MPTH 62800303
*              *                                           *   @Z40MPTH 62800403
*              *   PARAMETER DESCRIPTION TABLE FOR FLASH   *   @Z40MPTH 62800503
*              *                                           *   @Z40MPTH 62800603
*              *********************************************   @Z40MPTH 62800703
         SPACE 2                                               @Z40MPTH 62800803
FLASHT   DS    0C  START OF ENTRY                              @Z40MPTH 62800903
         DC    AL1(FLASH5-FLASHT)  LENGTH OF ENTRY             @Z40MPTH 62801003
*              *                                               @Z40MPTH 62801103
*              *    FIRST POSITION FOR KEYWORD                 @Z40MPTH 62801203
*              *                                               @Z40MPTH 62801303
FLASH1   DS    0C START OF POSITION                            @Z40MPTH 62801403
         DC    AL1(FLASH3-FLASH1) LENGTH OF POSITION           @Z40MPTH 62801503
         DC    AL1((FLASH3-FLASH2)*HEX) CONTROL BYTE           @Z40MPTH 62801603
         DC    AL1(FLASL)  MAX LENGTH OF FLASH ID              @Z40MPTH 62801703
FLASH2   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62801803
         TAS   MVCN,JFCE,JFCBMAGT                              @Z40MPTH 62801903
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62802003
FLASH3   DS    0C END OF FIRST ENTRY                           @Z40MPTH 62802103
*              *                                               @Z40MPTH 62802203
*              *    SECOND POSITION                            @Z40MPTH 62802303
*              *                                               @Z40MPTH 62802403
FLASH4   TASCE CVB1,JFCE,JFCIMTOT,FLASHCNT,255                 @Z40MPTH 62802503
FLASH5   DS    0C END OF ENTRY                                 @Z40MPTH 62802603
         EJECT                                                 @Z40MPTH 62802703
*              *********************************************   @Z40MPTH 62802803
*              *                                           *   @Z40MPTH 62802903
*              *   PARAMETER DESCRIPTION TABLE FOR BURST   *   @Z40MPTH 62803003
*              *                                           *   @Z40MPTH 62803103
*              *********************************************   @Z40MPTH 62803203
         SPACE 2                                               @Z40MPTH 62803303
BURSTT   DS    0C  START OF ENTRY                              @Z40MPTH 62803403
         DC    AL1(BURST7-BURSTT)  LENGTH OF ENTRY             @Z40MPTH 62803503
*              *                                               @Z40MPTH 62803603
*              *    FIRST POSITION FOR KEYWORD                 @Z40MPTH 62803703
*              *                                               @Z40MPTH 62803803
BURST1   DS    0C START OF POSITION                            @Z40MPTH 62803903
         DC    AL1(BURST7-BURST1)  LENGTH OF POSITION          @Z40MPTH 62804003
         DC    AL1((BURST4-BURST3)*HEX+L'BURST2) CONTROL BYTE  @Z40MPTH 62804103
BURST2   DC    C'Y' COMPARE BYTES                              @Z40MPTH 62804203
BURST3   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62804303
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62804403
         TAS   OR1,JFCE,JFCBFLAG,JFCBBST                       @Z40MPTH 62804503
BURST4   DS    0C END OF CONTROL BYTES                         @Z40MPTH 62804603
         DC    AL1((BURST7-BURST6)*HEX+L'BURST5) CONTROL BYTE  @Z40MPTH 62804703
BURST5   DC    C'N' COMPARE BYTES                              @Z40MPTH 62804803
BURST6   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62804903
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62805003
         TAS   OR1,JFCE,JFCBFLAG,JFCBCFS                       @Z40MPTH 62805103
BURST7   DS    0C END OF ENTRY                                 @Z40MPTH 62805203
         EJECT                                                 @Z40MPTH 62805303
*              *********************************************   @Z40MPTH 62805403
*              *                                           *   @Z40MPTH 62805503
*              *   PARAMETER DESCRIPTION TABLE FOR MODIFY  *   @Z40MPTH 62805603
*              *                                           *   @Z40MPTH 62805703
*              *********************************************   @Z40MPTH 62805803
         SPACE 2                                               @Z40MPTH 62805903
MODIFYT  DS    0C  START OF ENTRY                                       62806003
         DC    AL1(MODIFY5-MODIFYT) LENGTH OF ENTRY            @Z40MPTH 62806103
*              *                                               @Z40MPTH 62806203
*              *    FIRST POSITION FOR KEYWORD                 @Z40MPTH 62806303
*              *                                               @Z40MPTH 62806403
MODIFY1  DS    0C START OF POSITION                            @Z40MPTH 62806503
         DC    AL1(MODIFY3-MODIFY1) LENGTH OF POSITION         @Z40MPTH 62806603
         DC    AL1((MODIFY3-MODIFY2)*HEX) CONTROL BYTE         @Z40MPTH 62806703
         DC    AL1(MODIFL)  MAX LENGTH OF MODIFY ID            @Z40MPTH 62806803
MODIFY2  DS    0C START OF CONTROL BYTES                       @Z40MPTH 62806903
         TAS   MVCN,JFCE,JFCMODIF                              @Z40MPTH 62807003
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62807103
MODIFY3  DS    0C END OF FIRST ENTRY                           @Z40MPTH 62807203
*              *                                               @Z40MPTH 62807303
*              *    SECOND POSITION                            @Z40MPTH 62807403
*              *                                               @Z40MPTH 62807503
MODIFY4  TASCE CVB1,JFCE,JFCIDTRC,MODFYTRC,3                   @Z40MPTH 62807603
MODIFY5  DS    0C END OF ENTRY                                 @Z40MPTH 62807703
         EJECT                                                          62807803
*              *********************************************            62807903
*              *                                           *            62808003
*              *   PARAMETER DESCRIPTION TABLE FOR CHARS   *            62808103
*              *                                           *            62808203
*              *********************************************            62808303
         SPACE 2                                                        62808403
CHARST   DS    0C                                                       62808503
         DC    AL1(CHARS12-CHARST) LENGTH OF ENTRY             @Z40MPTH 62808603
*              *                                               @Z40MPTH 62808703
*              *    FIRST POSITION FOR KEYWORD                 @Z40MPTH 62808803
*              *                                               @Z40MPTH 62808903
CHARS1   DS    0C START OF POSITION                            @Z40MPTH 62809003
         DC    AL1(CHARS3-CHARS1)   LENGTH OF POSITION         @Z40MPTH 62809103
         DC    AL1((CHARS3-CHARS2)*HEX)  CONTROL BYTE          @Z40MPTH 62809203
         DC    AL1(CHARSL)  MAX LENGTH OF CHARS ID             @Z40MPTH 62809303
CHARS2   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62809403
         TAS   MVCN,JFCE,JFCBTRS1                              @Z40MPTH 62809503
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62809603
CHARS3   DS    0C END OF FIRST ENTRY                           @Z40MPTH 62809703
*              *                                               @Z40MPTH 62809803
*              *    SECOND POSITION FOR KEYWORD                @Z40MPTH 62809903
*              *                                               @Z40MPTH 62810003
CHARS4   DS    0C START OF POSITION                            @Z40MPTH 62810103
         DC    AL1(CHARS6-CHARS4) LENGTH OF POSITION           @Z40MPTH 62810203
         DC    AL1((CHARS6-CHARS5)*HEX) CONTROL BYTE           @Z40MPTH 62810303
         DC    AL1(CHARSL) MAX LENGTH OF CHARS ID              @Z40MPTH 62810403
CHARS5   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62810503
         TAS   MVCN,JFCE,JFCBTRS2                              @Z40MPTH 62810603
CHARS6   DS    0C END OF SECOND ENTRY                          @Z40MPTH 62810703
*              *                                               @Z40MPTH 62810803
*              *    THIRD POSITION FOR KEYWORD                 @Z40MPTH 62810903
*              *                                               @Z40MPTH 62811003
CHARS7   DS    0C START OF POSITION                            @Z40MPTH 62811103
         DC    AL1(CHARS9-CHARS7) LENGTH OF POSITION           @Z40MPTH 62811203
         DC    AL1((CHARS9-CHARS8)*HEX) CONTROL BYTE           @Z40MPTH 62811303
         DC    AL1(CHARSL) MAX LENGTH OF CHARS ID              @Z40MPTH 62811403
CHARS8   DS    0C START OF CONTROL BYTES                       @Z40MPTH 62811503
         TAS   MVCN,JFCE,JFCBTRS3                              @Z40MPTH 62811603
CHARS9   DS    0C END OF THIRD ENTRY                           @Z40MPTH 62811703
*              *                                               @Z40MPTH 62811803
*              *    FOURTH POSITION FOR KEYWORDS               @Z40MPTH 62811903
*              *                                               @Z40MPTH 62812003
CHARS10  DS    0C START OF POSITION                            @Z40MPTH 62812103
         DC    AL1(CHARS12-CHARS10) LENGTH OF POSITION         @Z40MPTH 62812203
         DC    AL1((CHARS12-CHARS11)*HEX) CONTROL BYTE         @Z40MPTH 62812303
         DC    AL1(CHARSL) MAX LENGTH OF CHARS ID              @Z40MPTH 62812403
CHARS11  DS    0C START OF CONTROL BYTES                       @Z40MPTH 62812503
         TAS   MVCN,JFCE,JFCBTRS4                              @Z40MPTH 62812603
CHARS12  DS    0C END OF FOURTH ENTRY                          @Z40MPTH 62812703
         EJECT 1                                                        62812803
*              ************************************************@G32HPPJ 62812903
*              *                                              *@G32HPPJ 62813003
*              *    PARAMETER DESCRIPTOR TABLE FOR PROTECT    *@G32HPPJ 62813103
*              *                                              *@G32HPPJ 62813203
*              ************************************************@G32HPPJ 62813303
PROTECTT DS    0C             START OF ENTRY                   @G32HPPJ 62813403
         DC    AL1(PROTET04-PROTECTT) LENGTH OF ENTRY          @G32HPPJ 62813503
PROTET01 DS    0C                       START OF POSITION      @G32HPPJ 62813603
         DC    AL1(PROTET04-PROTET01) LENGTH OF POSITION       @G32HPPJ 62813703
         DC    AL1((PROTET04-PROTET03)*HEX+L'PROTET02) CTL     @G32HPPJ 62813803
PROTET02 DC    C'YES'                COMPARE BYTES             @G32HPPJ 62813903
PROTET03 DS    0C                    START OF CONTROL BYTES    @G32HPPJ 62814003
         TAS   OR1,SIOT,SIOTBYT4,SIOTPROT  CTL FUNCTION        @G32HPPJ 62814103
PROTET04 DS    0C                    END OF ENTRY              @G32HPPJ 62814203
         EJECT                                                          62814303
***************************************************************@G29AN2E 62814403
*              *                                              *@G29AN2E 62814503
*              *    PARAMETER DESCRIPTION ENTRY FOR SUBSYS    *@G29AN2E 62814603
*              *                                              *@G29AN2E 62814703
***************************************************************@G29AN2E 62814803
         SPACE 1                                               @G29AN2E 62814903
SUBSYST  DS    0C                       START OF ENTRY         @G29AN2E 62815003
         DC    AL1(SUBSYST3-SUBSYST)    LENGTH OF ENTRY        @G29AN2E 62815103
SUBSYST1 DS    0C                       START OF POSITION      @G29AN2E 62815203
         DC    AL1(SUBSYST3-SUBSYST1)   LENGTH OF POSITION     @G29AN2E 62815303
         DC    AL1((SUBSYST3-SUBSYST2)*HEX) CONTROL BYTE       @G29AN2E 62815403
         DC    AL1(JSUBSYS1)            MAX LENGTH OF FIRST    @G29AN2E 62815503
*                                       POSITION OF SUBSYS,    @G29AN2E 62815603
*                                       THE SSNAME             @G29AN2E 62815703
SUBSYST2 DS    0C                       START OF CONTROL BYTES @G29AN2E 62815803
         TAS   MVCN,SIOT,SIOTSSNM                              @G29AN2E 62815903
         TAS   OR1,SIOT,SIOTTSTC,SIOTSSGP                      @G29AN2E 62816003
         TAS   OR1,SIOT,SIOTBYT0,SIOTSSDS                      @G29AN2E 62816103
         TAS   OR1,JFCB,JFCBTSDM,JFCSDS                        @G29AN2E 62816203
SUBSYST3 DS    0C                       END OF ENTRY           @G29AN2E 62816303
         EJECT                                                 @G29AN2E 62816403
*              **********************************************    Y02668 62816503
*              *                                            *    Y02668 62816603
*              *    PARAMETER DESCRIPTION ENTRY FOR DEST    *    Y02668 62816703
*              *                                            *    Y02668 62816803
*              **********************************************    Y02668 62816903
         SPACE                                                          62817003
DESTT    DS    0C                       START OF ENTRY           Y02668 62817103
         DC    AL1(DESTT3-DESTT)        LENGTH OF ENTRY          Y02668 62817203
DESTT1   DS    0C                       START OF POSITION        Y02668 62817303
         DC    AL1(DESTT3-DESTT1)       LENGTH OF POSITION       Y02668 62817403
         DC    AL1((DESTT3-DESTT2)*HEX) CONTROL BYTE             Y02668 62817503
         DC    AL1(JDEST1)              MAXIMUM LENGTH OF DEST   Y02668 62817603
DESTT2   DS    0C                                                Y02668 62817703
         TAS   MVCN,SIOT,SIOTDEST                              @ZA16418 62817803
DESTT3   DS    0C                                                Y02668 62817903
         EJECT                                                          62818003
*             **********************************************     Y02670 62818103
*             *                                            *     Y02670 62818203
*             *   PARAMETER DESCRIPTION ENTRY FOR FRID     *     Y02670 62818303
*             *                                            *     Y02670 62818403
*             **********************************************     Y02670 62818503
         SPACE                                                          62818603
FRIDT    DS    0C                       START OF ENTRY           Y02670 62818703
         DC    AL1(FRIDT03-FRIDT)       LENGTH OF ENTRY          Y02670 62818803
FRIDT01  DS    0C                       START OF POSITION        Y02670 62818903
         DC    AL1(FRIDT03-FRIDT01)     LENGTH OF POSITION       Y02670 62819003
         DC    AL1((FRIDT03-FRIDT02)*HEX) CONTROL BYTE           Y02670 62819103
         DC    AL1(JFRID1)              MAX. PARAMETER LENGTH    Y02670 62819203
FRIDT02  DS    0C                       START OF CONTROL BYTE    Y02670 62819303
         TAS   AMVCN,JFCB,JFCFCBID                               Y02670 62819403
FRIDT03  DS    0C                       END OF ENTRY             Y02670 62819503
         EJECT                                                          62819603
*              ************************************************** 19028 62819703
*              *                                                * 19028 62819803
*              *    PARAMETER DESCRIPTION ENTRY FOR OUTLIM      * 19028 62819903
*              *                                                * 19028 62820003
*              ************************************************** 19028 62820103
OUTLIMT  DS    0C                           START OF ENTRY        19028 62820203
         DC    AL1(OUTLIMT3-OUTLIMT)        LENGTH OF ENTRY       19028 62820303
*              *                                                  19028 62820403
*              *    FIRST POSITION FOR KEYWORD                    19028 62820503
*              *                                                  19028 62820603
OUTLIMT1 DS    0C                           START OF POSITION     19028 62820703
         DC    AL1(OUTLIMT3-OUTLIMT1)       LENGTH OF POSITION    19028 62820803
         DC    AL1((OUTLIMT3-OUTLIMT2)*HEX)  CONTROL/COMPARE BYTE 19028 62820903
         DC    AL1(JOUTLIM1)                 MAX. LENGTH          19028 62821003
OUTLIMT2 DS    0C                                                 19028 62821103
         TAS   CVB3,JFCB,JFCOUTLI,JOUTLIM2                        19028 62821203
OUTLIMT3 DS    0C                                                 19028 62821303
         EJECT                                                          62821403
*             ***********************************************    Y02668 62822002
*             *                                             *    Y02668 62824002
*             *    PARAMETER DESCRIPTION ENTRY FOR COPIES   *    Y02668 62826002
*             *                                             *    Y02668 62828002
*             ***********************************************    Y02668 62830002
         SPACE                                                          62832002
COPIEST  DS    0C                 START OF ENTRY               @Z40MPTH 62834003
         DC    AL1(COPIES20-COPIEST)  LENGTH OF ENTRY          @Z40MPTH 62834303
*                                                              @Z40MPTH 62834603
*              FIRST POSITION--PRIMARY N VALUE                 @Z40MPTH 62834903
*                                                              @Z40MPTH 62835203
COPIES1  DS    0C                 START OF POSITION            @Z40MPTH 62835503
         DC    AL1(COPIES3-COPIES1)  LENGTH OF POSITION        @Z40MPTH 62835803
         DC    AL1((COPIES3-COPIES2)*HEX)  CONTROL BYTE        @Z40MPTH 62836103
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62836403
COPIES2  DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62836703
         TAS   CVB1,SIOT,SIOTOUTC,JCOPIES1                     @Z40MPTH 62837003
COPIES3  DS    0C                 END OF FIRST POSITION        @Z40MPTH 62837303
*                                                              @Z40MPTH 62837603
*              SECOND POSITION--SUB N VALUES                   @Z40MPTH 62837903
*                                                              @Z40MPTH 62838203
COPIES4  DS    0C                 START OF FIRST SUBLIST       @Z40MPTH 62838503
         DC    AL1(COPIES6-COPIES4)  LENGTH OF POSITION        @Z40MPTH 62838803
         DC    AL1((COPIES6-COPIES5)*HEX)  CONTROL BYTE        @Z40MPTH 62839103
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62839403
COPIES5  DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62839703
         TAS   CVB1,JFCE,JFCGRP1,JCOPIES1                      @Z40MPTH 62840003
         TAS   OR1,JFCB,JFCUCSOP,JFCBEXTP                      @Z40MPTH 62840303
COPIES6  DS    0C                 START OF SECOND SUBLIST      @Z40MPTH 62840603
         DC    AL1(COPIES8-COPIES6)  LENGTH OF POSITION        @Z40MPTH 62840903
         DC    AL1((COPIES8-COPIES7)*HEX)  CONTROL BYTE        @Z40MPTH 62841203
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62841503
COPIES7  DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62841803
         TAS   CVB1,JFCE,JFCGRP2,JCOPIES1                      @Z40MPTH 62842103
COPIES8  DS    0C                 START OF THIRD SUBLIST       @Z40MPTH 62842403
         DC    AL1(COPIES10-COPIES8)  LENGTH OF POSITION       @Z40MPTH 62842703
         DC    AL1((COPIES10-COPIES9)*HEX)  CONTROL BYTE       @Z40MPTH 62843003
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62843303
COPIES9  DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62843603
         TAS   CVB1,JFCE,JFCGRP3,JCOPIES1                      @Z40MPTH 62843903
COPIES10 DS    0C                 START OF FOURTH SUBLIST      @Z40MPTH 62844203
         DC    AL1(COPIES12-COPIES10)  LENGTH OF POSITION      @Z40MPTH 62844503
         DC    AL1((COPIES12-COPIES11)*HEX)  CONTROL BYTE      @Z40MPTH 62844803
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62845103
COPIES11 DS    0C                 START OF CONTROL BYT E       @Z40MPTH 62845403
         TAS   CVB1,JFCE,JFCGRP4,JCOPIES1                      @Z40MPTH 62845703
COPIES12 DS    0C                 START OF FIFTH SUBLIST       @Z40MPTH 62846003
         DC    AL1(COPIES14-COPIES12)  LENGTH OF POSITION      @Z40MPTH 62846303
         DC    AL1((COPIES14-COPIES13)*HEX)  CONTROL BYTE      @Z40MPTH 62846603
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62846903
COPIES13 DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62847203
         TAS   CVB1,JFCE,JFCGRP5,JCOPIES1                      @Z40MPTH 62847503
COPIES14 DS    0C                 START OF SIXTH SUBLIST       @Z40MPTH 62847803
         DC    AL1(COPIES16-COPIES14)  LENGTH OF POSITION      @Z40MPTH 62848103
         DC    AL1((COPIES16-COPIES15)*HEX)  CONTROL BYTE      @Z40MPTH 62848403
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62848703
COPIES15 DS    0C                 START OF CONTROL BYTES       @Z40MPTH 62849003
         TAS   CVB1,JFCE,JFCGRP6,JCOPIES1                      @Z40MPTH 62849303
COPIES16 DS    0C                 START OF SEVENTH SUBLIST     @Z40MPTH 62849603
         DC    AL1(COPIES18-COPIES16)  LENGTH OF POSITION      @Z40MPTH 62849903
         DC    AL1((COPIES18-COPIES17)*HEX)  CONTROL BYTE      @Z40MPTH 62850203
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62850503
COPIES17 DS    0C                 START OF  CNTROL BYTES       @Z40MPTH 62850803
         TAS   CVB1,JFCE,JFCGRP7,JCOPIES1                      @Z40MPTH 62851103
COPIES18 DS    0C                 START OF EIGTH SUBLIST       @Z40MPTH 62851403
         DC    AL1(COPIES20-COPIES18)  LENGTH OF POSITION      @Z40MPTH 62851703
         DC    AL1((COPIES20-COPIES19)*HEX)  CONTROL BYTE      @Z40MPTH 62852003
         DC    AL1(DD3)           MAX CONVERSION LENGTH        @Z40MPTH 62852303
COPIES19 DS    0C                 START OF  CNTROL BYTES       @Z40MPTH 62852603
         TAS   CVB1,JFCE,JFCGRP8,JCOPIES1                      @Z40MPTH 62852903
COPIES20 DS    0C                 END OF POSITION AND ENTRY    @Z40MPTH 62853203
         EJECT                                                          62853503
*              **************************************************       62853803
*              *                                                *       62860000
*              *    PARAMETER DESCRIPTION ENTRY FOR DDNAME.     *       62880000
*              *                                                *       62900000
*              **************************************************       62920000
DDNAMET  DS    0C                                                       62940000
         EJECT                                                    20002 62940120
*              ************************************************** 20002 62940220
*              *                                                * 20002 62940320
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFIN       * 20002 62940420
*              *                                                * 20002 62940520
*              ************************************************** 20002 62940620
*        *                                                        20002 62940720
*        *     FIRST POSITION FOR KEYWORD                         20002 62940820
*        *                                                        20002 62940920
BUFINT   TASCD CVB1,DDWA,DDWA61,JBUFINT1,15                       20002 62941020
         EJECT                                                    20002 62941120
*              ************************************************** 20002 62941220
*              *                                                * 20002 62941320
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFOUT      * 20002 62941420
*              *                                                * 20002 62941520
*              ************************************************** 20002 62941620
*        *                                                        20002 62941720
*        *     FIRST POSITION FOR KEYWORD                         20002 62941820
*        *                                                        20002 62941920
BUFOUTT  TASCD CVB1,DDWA,DDWA61,JBUFINT1,15                       20002 62942020
         EJECT                                                    20002 62942120
*              ************************************************** 20002 62942220
*              *                                                * 20002 62942320
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFMAX      * 20002 62942420
*              *                                                * 20002 62942520
*              ************************************************** 20002 62942620
*        *                                                        20002 62942720
*        *     FIRST POSITION FOR KEYWORD                         20002 62942820
*        *                                                        20002 62942920
BUFMAXT  TASCD CVB1,JFCB,JFCBUFMX,JBUFINT1,15                     20002 62943020
         EJECT                                                    20002 62943120
*              ************************************************** 20002 62943220
*              *                                                * 20002 62943320
*              *    PARAMETER DESCRIPTION ENTRY FOR BUFSIZE     * 20002 62943420
*              *                                                * 20002 62943520
*              ************************************************** 20002 62943620
*              *                                                * 20002 62943720
*        *     FIRST POSITION FOR KEYWORD                         20002 62943820
*              *                                                * 20002 62943920
BUFSIZET TASCD CVB2,JFCB,JFCBUFSI,JBUFSIZE,65535                  20002 62944020
         EJECT                                                    20002 62944120
*              ************************************************** 20002 62944220
*              *                                                * 20002 62944320
*              *    PARAMETER DESCRIPTION ENTRY FOR PCI         * 20002 62944420
*              *                                                * 20002 62944520
*              ************************************************** 20002 62944620
PCIT     DS    0C                      START OF ENTRY             20002 62944720
         DC    AL1(PCIT19-PCIT)        LENGTH OF ENTRY            20002 62944820
*        *                                                        20002 62944920
*        *     FIRST POSITION FOR KEYWORD                         20002 62945020
*        *                                                        20002 62945120
PCIT01   DS    0C                      START OF POSITION          20002 62945220
         DC    AL1(PCIT10-PCIT01)      LENGTH OF POSITION         20002 62945320
         DC    AL1((PCIT04-PCIT03)*HEX+L'PCIT02)  CONTROL BYTE    20002 62945420
PCIT02   DC    C'A'                    COMPARE BYTE               20002 62945520
PCIT03   DS    0C                      START OF CONTROL BYTES     20002 62945620
         TAS   OR1,JFCB,JFCPCI,JPCI1                              20002 62945720
PCIT04   DS    0C                      END OF CONTROL BYTES       20002 62945820
         DC    AL1((PCIT07-PCIT06)*HEX+L'PCIT05)  CONTROL BYTE    20002 62945920
PCIT05   DC    C'N'                    COMPARE BYTE               20002 62946020
PCIT06   DS    0C                      START OF CONTROL BYTES     20002 62946120
         TAS   OR1,JFCB,JFCPCI,JPCI3                              20002 62946220
PCIT07   DS    0C                      END OF CONTROL BYTES       20002 62946320
         DC    AL1((PCIT9A-PCIT09)*HEX+L'PCIT08)  CONTROL BYTE   Y01948 62946401
PCIT08   DC    C'R'                    COMPARE BYTE               20002 62946520
PCIT09   DS    0C                      START OF CONTROL BYTES     20002 62946620
         TAS   OR1,JFCB,JFCPCI,JPCI5                              20002 62946720
PCIT9A   DS    0C                      END OF CONTROL BYTES      Y01948 62946801
         DC    AL1((PCIT10-PCIT9C)*HEX+L'PCIT9B) CONTROL BYTE    Y01948 62946901
PCIT9B   DC    C'X'                    COMPARE BYTE              Y01948 62947101
PCIT9C   DS    0C                      START OF CONTROL BYTES    Y01948 62947301
         TAS   OR1,JFCB,JFCPCI,JPCI7                             Y01948 62947401
*        *                                                        20002 62947501
*        *     SECOND POSITION FOR KEYWORD                        20002 62947601
*        *                                                        20002 62947701
PCIT10   DS    0C                      START OF POSITION          20002 62947801
         DC    AL1(PCIT19-PCIT10)      LENGTH OF POSITION         20002 62947901
         DC    AL1((PCIT13-PCIT12)*HEX+L'PCIT11)  CONTROL BYTE    20002 62948001
PCIT11   DC    C'A'                    COMPARE BYTE               20002 62948101
PCIT12   DS    0C                      START OF CONTROL BYTES     20002 62948201
         TAS   OR1,JFCB,JFCPCI,JPCI2                              20002 62948301
PCIT13   DS    0C                      END OF CONTROL BYTES       20002 62948401
         DC    AL1((PCIT16-PCIT15)*HEX+L'PCIT14)  CONTROL BYTE    20002 62948501
PCIT14   DC    C'N'                    COMPARE BYTE               20002 62948601
PCIT15   DS    0C                      START OF CONTROL BYTES     20002 62948701
         TAS   OR1,JFCB,JFCPCI,JPCI4                              20002 62948801
PCIT16   DS    0C                      END OF CONTROL BYTES       20002 62948901
         DC    AL1((PCIT18A-PCIT18)*HEX+L'PCIT17) CONTROL BYTE   Y01948 62949001
PCIT17   DC    C'R'                    COMPARE BYTE               20002 62949101
PCIT18   DS    0C                      START OF CONTROL BYTES     20002 62949201
         TAS   OR1,JFCB,JFCPCI,JPCI6                              20002 62949301
PCIT18A  DS    0C                      END OF CONTROL BYTES      Y01948 62949401
         DC    AL1((PCIT19-PCIT18C)*HEX+L'PCIT18B) CONTROL BYTE  Y01948 62949501
PCIT18B  DC    C'X'                    COMPARE BYTE              Y01948 62949601
PCIT18C  DS    0C                      START OF CONTROL BYTES    Y01948 62949701
         TAS   OR1,JFCB,JFCPCI,JPCI8                             Y01948 62949801
PCIT19   DS    0C                      END OF ENTRY               20002 62949901
         EJECT                                                    20002 62950001
*              ************************************************** 20002 62950101
*              *                                                * 20002 62950201
*              *    PARAMETER DESCRIPTION ENTRY FOR RESERVE     * 20002 62950301
*              *                                                * 20002 62950401
*              ************************************************** 20002 62950501
RESERVET DS    0C                      START OF ENTRY             20002 62950601
         DC    AL1(RESRVT05-RESERVET) LENGTH OF ENTRY           Y02668  62950702
*        *                                                        20002 62950801
*        *     FIRST POSITION FOR KEYWORD                         20002 62950901
*        *                                                        20002 62951001
RESRVT01 DS    0C                      START OF FIRST POSITION    20002 62951101
         DC    AL1(RESRVT03-RESRVT01)  LENGTH OF FIRST POSITION   20002 62951201
         DC    AL1((RESRVT03-RESRVT02)*HEX)      CONTROL BYTE     20002 62951301
         DC    AL1(JRESERV1)           MAX LENGTH 1 PARAM         20002 62951401
RESRVT02 DS    0C                      START OF CONTROL BYTES     20002 62951501
         TAS   CVB1,JFCB,JFCRESRV,JRESERV2                        20002 62951601
*        *                                                        20002 62951701
*        *     SECOND POSITION FOR KEYWORD                        20002 62951801
*        *                                                        20002 62951901
RESRVT03 DS    0C                      END FIRST POSITION         20002 62952001
         DC    AL1(RESRVT05-RESRVT03)  LENGTH OF SECOND POSITION  20002 62952101
         DC    AL1((RESRVT05-RESRVT04)*HEX)      CONTROL BYTE     20002 62952201
         DC    AL1(JRESERV1)           MAX LENGTH 2 PARAM         20002 62952301
RESRVT04 DS    0C                      START OF CONTROL BYTES     20002 62952401
         TAS   CVB1,JFCB,JFCRESRV+1,JRESERV2                      20002 62952501
*        *                                                        20002 62952601
*        *     THIRD POSITION FOR KEYWORD                         20002 62952701
*        *                                                        20002 62952801
RESRVT05 DS    0C                      END SECOND POSITION        20002 62952901
         EJECT                                                    20002 62954501
*              ************************************************** 20002 62954601
*              *                                                * 20002 62954701
*              *    PARAMETER DESCRIPTION ENTRY FOR THRESH      * 20002 62954801
*              *                                                * 20002 62954901
*              ************************************************** 20002 62955001
THRESHT  TASCD CVB1,JFCB,JFCTHRSH,JTHRESHT,100                    20002 62955101
         EJECT                                                          62955901
*              *************************************************  21009 62957901
*              *                                               *  21009 62959901
*              *   PARAMETER DESCRIPTION ENTRY FOR DLM.        *  21009 62966601
*              *                                               *  21009 62968601
*              ************************************************   21009 62970601
*                                                                 21009 62972601
DLMT     DS    0C                                                 21009 62973001
         DC    AL1(DLMT3-DLMT)         START OF ENTRY             21009 62973401
*              *                                                  21009 62973501
*              *    FIRST POSITION FOR KEYWORD                    21009 62979901
*              *                                                  21009 62980101
DLMT1    DS    0C                      START OF POSITION          21009 62982001
         DC    AL1(DLMT3-DLMT1)        LENGTH OF POSITION         21009 62984001
         DC    AL1((DLMT3-DLMT2)*HEX)  CONTROL / COMPARE BYTE     21009 62986001
DLMT2    DS    0C                      START OF CONTROL BYTES     21009 62986501
DLMT3    DS    0C                                                 21009 62995301
         EJECT                                                   I21042 62995401
*              **************************************************I21042 62995701
*              *                                                *I21042 62995801
*              *    PARAMETER DESCRIPTION ENTRY FOR DIAGNS      *I21042 62996101
*              *                                                *I21042 62996501
*              **************************************************I21042 62996901
DIAGNST  DS    0C                       START OF ENTRY           I21042 62997001
         DC    AL1(DIAGNST4-DIAGNST)    LENGTH OF ENTRY          I21042 62997101
DIAGNST1 DS    0C                       START OF POSITION        I21042 62997201
         DC    AL1(DIAGNST4-DIAGNST1)   LENGTH OF POSITION       I21042 62997901
         DC    AL1((DIAGNST4-DIAGNST3)*HEX+L'DIAGNST2) CNTRL BYTE M0071 62998001
DIAGNST2 DC    C'TRACE'                 COMPARE BYTES            I21042 62998301
DIAGNST3 DS    0C                       START OF CNTRL BYTES     I21042 62998701
         TAS   OR1,JFCB,JFCBFLG2,JFCTRACE                        I21042 62999101
DIAGNST4 DS    0C                       END OF ENTRY             I21042 62999201
         EJECT                                                          63000001
*             ****************************************************      63006601
*             ****************************************************      63013301
*             **                                                **      63020000
*             **         DD ROUTINE KEYWORD BRANCH TABLE        **      63040000
*             **                                                **      63060000
*             ****************************************************      63080000
*             ****************************************************      63100000
         SPACE 3                                                        63120000
DABTABLE DS    0H                                                       63140000
DDL      TRAT  DDN,DDS,DDP,DDT                                          63160000
TRTCHL   TRAT  TRTCHN,TRTCHS,TRTCHP,TRTCHT                              63180000
STACKL   TRAT  STACKN,STACKS,STACKP,STACKT                              63200000
SOWAL    TRAT  SOWAN,SOWAS,SOWAP,SOWAT                                  63220000
RKPL     TRAT  RKPN,RKPS,RKPP,RKPT                                      63240000
RECFML   TRAT  RECFMN,RECFMS,RECFMP,RECFMT                              63260000
PRTSPL   TRAT  PRTSPN,PRTSPS,PRTSPP,PRTSPT                              63280000
OPTCDL   TRAT  OPTCDN,OPTCDS,OPTCDP,OPTCDT                              63300000
NTML     TRAT  NTMN,NTMS,NTMP,NTMT                                      63320000
NCPL     TRAT  NCPN,NCPS,NCPP,NCPT                                      63340000
MODEL    TRAT  MODEN,MODES,MODEP,MODET                                  63360000
LRECLL   TRAT  LRECLN,LRECLS,LRECLP,LRECLT                              63380000
LIMCTL   TRAT  LIMCTN,LIMCTS,LIMCTP,LIMCTT                              63400000
KEYLENL  TRAT  KEYLENN,KEYLENS,KEYLENP,KEYLENT                          63420000
INTVLL   TRAT  INTVLN,INTVLS,INTVLP,INTVLT                              63440000
EROPTL   TRAT  EROPTN,EROPTS,EROPTP,EROPTT                              63460000
DSORGL   TRAT  DSORGN,DSORGS,DSORGP,DSORGT                              63480000
DENL     TRAT  DENN,DENS,DENP,DENT                                      63500000
*                                                                  AAAA 63506015
*                                                                  AAAA 63512015
*DBUFNOL TRAT DBUFNON,DBUFNOS,DBUFNOP,DBUFNOT  DBUFNO NOT SUPPORTED     63518015
*                                                                  AAAA 63524015
HIARCHYL TRAT  HIARCHYN,HIARCHYS,HIARCHYP,HIARCHYT                 AAAA 63530015
CYLOFLL  TRAT  CYLOFLN,CYLOFLS,CYLOFLP,CYLOFLT                          63540000
CPRIL    TRAT  CPRIN,CPRIS,CPRIP,CPRIT                                  63560000
CODEL    TRAT  CODEN,CODES,CODEP,CODET                                  63580000
BUFRQL   TRAT  BUFRQN,BUFRQS,BUFRQP,BUFRQT                              63600000
BUFNOL   TRAT  BUFNON,BUFNOS,BUFNOP,BUFNOT                              63620000
BUFLL    TRAT  BUFLN,BUFLS,BUFLP,BUFLT                                  63640000
BLKSIZEL TRAT  BLKSIZEN,BLKSIZES,BLKSIZEP,BLKSIZET                      63660000
BFTEKL   TRAT  BFTEKN,BFTEKS,BFTEKP,BFTEKT                              63680000
BFALNL   TRAT  BFALNN,BFALNS,BFALNP,BFALNT                              63700000
RETPDL   TRAT  RETPDN,RETPDS,RETPDP,RETPDT                              63720000
EXPDTL   TRAT  EXPDTN,EXPDTS,EXPDTP,EXPDTT                              63740000
REFL     TRAT  REFN,REFS,REFP,REFT                                      63760000
SERL     TRAT  SERN,SERS,SERP,SERT                                      63780000
SEPML    TRAT  SEPMN,SEPMS,SEPMP,SEPMT                                  63800000
AFFML    TRAT  AFFMN,AFFMS,AFFMP,AFFMT                                  63820000
SUBALLOL TRAT  SUBALLON,SUBALLOS,SUBALLOP,SUBALLOT                      63840000
SYSOUTL  TRAT  SYSOUTN,SYSOUTS,SYSOUTP,SYSOUTT                          63860000
DSNAMEL  TRAT  DSNAMEN,DSNAMES1,DSNAMEP,DSNAMET                         63880000
DDNAMEL  TRAT  DDNAMEN,DDNAMES,DDNAMEP,DDNAMET                          63900000
SPLITL   TRAT  SPLITN,SPLITS,SPLITP,SPLITT                              63920000
SPACEL   TRAT  SPACEN,SPACES,SPACEP,SPACET                              63940000
DISPL    TRAT  DISPN,DISPS,DISPP,DISPT                                  63960000
SEPL     TRAT  SEPN,SEPS,SEPP,SEPT                                      63980000
AFFL     TRAT  AFFN,AFFS,AFFP,AFFT                                      64000000
VOLUMEL  TRAT  VOLUMEN,VOLUMES,VOLUMEP,VOLUMET                          64020000
LABELL   TRAT  LABELN,LABELS,LABELP,LABELT                              64040000
UNITL    TRAT  UNITN,UNITS,UNITP,UNITT                                  64060000
DCBL     TRAT  DCBN,DCBS,DCBP,DCBT                                      64080000
CHKPTL   TRAT  CHKPTN,CHKPTS,CHKPTP,CHKPTT                     @Z30JPSF 64100003
DUMMYL   TRAT  DUMMYN,DUMMYS,DUMMYP,DUMMYT                              64120000
UCSL     TRAT  UCSN,UCSS,UCSP,UCST                                      64130000
GNCPL    TRAT  GNCPN,GNCPS,GNCPP,GNCPT                                  64136000
         DC    X'00'      RESERVED     KEY X'3B'                 YM2366 64186001
         DC    X'00'      RESERVED     KEY X'3B'                 YM2366 64236001
         DC    X'0000'    RESERVED     KEY X'3B'                 YM2366 64238001
         DC    X'0000'    RESERVED     KEY X'3B'                 YM2366 64238401
COPIESL  TRAT  COPIESN,COPIESS,COPIESP,COPIEST                   Y02668 64238702
IPLTXIDL TRAT  IPLTXIDN,IPLTXIDS,IPLTXIDP,IPLTXIDT               Y01948 64388801
OUTLIML  TRAT  OUTLIMN,OUTLIMS,OUTLIMP,OUTLIMT                    19028 64438701
BUFOFFL  TRAT  BUFOFFN,BUFOFFS,BUFOFFP,BUFOFFT                    19200 64488701
QNAMEL   TRAT  QNAMEN,QNAMES,QNAMEP,QNAMET                        20002 66139620
DYNAML   TRAT  DYNAMN,DYNAMS,DYNAMP,DYNAMT                 TSO    20001 68139620
BUFSIZEL TRAT  BUFSIZEN,BUFSIZES,BUFSIZEP,BUFSIZET                20002 70139620
BUFINL   TRAT  BUFINN,BUFINS,BUFINP,BUFINT                        20002 72139620
BUFOUTL  TRAT  BUFOUTN,BUFOUTS,BUFOUTP,BUFOUTT                    20002 74139620
BUFMAXL  TRAT  BUFMAXN,BUFMAXS,BUFMAXP,BUFMAXT                    20002 76139620
PCIL     TRAT  PCIN,PCIS,PCIP,PCIT                                20002 78139620
RESERVEL TRAT  RESERVEN,RESERVES,RESERVEP,RESERVET                20002 80139620
THRESHL  TRAT  THRESHN,THRESHS,THRESHP,THRESHT                    20002 82139620
TERML    TRAT  TERMN,TERMS,TERMP,TERMT                     TSO    20001 84139620
FCBL     TRAT  FCBN,FCBS,FCBP,FCBT                                20202 84149601
DLML     TRAT  DLMN,DLMS,DLMP,DLMT                                21009 86189701
DIAGNSL  TRAT  DIAGNSN,DIAGNSS,DIAGNSP,DIAGNST                   I21042 86191701
FUNCL    TRAT  FUNCN,FUNCS,FUNCP,FUNCT                            21088 86199701
AMPL     TRAT  AMPN,AMPS,AMPP,AMPTT          AM/0 KEYWORD        Y01113 86209701
FREEL    TRAT  FREEN,FREES,FREEP,FREET                           Y02670 88419702
FRIDL    TRAT  FRIDN,FRIDS,FRIDP,FRIDT                           Y02670 88619702
DESTL    TRAT  DESTN,DESTS,DESTP,DESTT                           Y02668 91619702
*                                                                       93219702
SYSINCTL TRAT  SYSINCTN,SYSINCTS,SYSINCTP,SYSINCTT                      94219702
HOLDL    TRAT  HOLDN,HOLDS,HOLDP,HOLDT                           Y02668 94719702
MSVGPL   TRAT  MSVGPN,MSVGPS,MSVGPP,MSVGPT                     @Y30LPSB 94819703
DSIDL    TRAT  DSIDN,DSIDS,DSIDP,DSIDT                         @Y30OPSB 94919703
BURSTL   TRAT  BURSTN,BURSTS,BURSTP,BURSTT                     @Z40MPTH 96219703
FLASHL   TRAT  FLASHN,FLASHS,FLASHP,FLASHT                     @Z40MPTH 96269703
MODIFYL  TRAT  MODIFYN,MODIFYS,MODIFYP,MODIFYT                 @Z40MPTH 96319703
CHARS    TRAT  CHARSN,CHARSS,CHARSP,CHARST                     @Z40MPTH 96369703
SUBSYSL  TRAT  SUBSYSN,SUBSYSS,SUBSYSP,SUBSYST                 @G29AN2E 96419703
PROTECTL TRAT  PROTECTN,PROTECTS,PROTECTP,PROTECTT             @G32HPPJ 96469703
         END                                                            96519703
./  ADD  SSI=80550278,NAME=IEFVDBSD
**********************************************************************  00030002
*                                                                       00032002
*   MODULE NAME= IEFVDBSD                                               00034002
*                                                                       00036002
*   DESCRIPTIVE NAME= DSENQ TABLE PROCESSOR                             00038002
*                                                                       00038402
*   COPYRIGHT=  N/A                                                     00038802
*                                                                       00039202
*   STATUS= OS/VS2 REL.037 PTF                                 @ZA27750 00039603
*                                                                       00040403
*   FUNCTION= TO CREATE A DSENQ TABLE FOR ALL EXPLICIT DSNAMES DATA     00040803
*             SETS AND INDICATE EACH AS EITHER EXCLUSIVE OR SHARED.     00041203
*      OPERATION= SCANS JFCB DSNAME ENTRY FROM END TO BEGINING FOR      00041603
*                 1ST NON-BLANK CHARACTER. THEN, SCANS DOWN TABLE FOR   00042002
*                 DUPLICATE NAMES OR AVAILABLE SPACE. IF DUPLICATE      00044002
*                 NAME IS FOUND, A TEST IS MADE TO SEE IF NEW ENTRY IS  00046002
*                 EXCLUSIVE OR SHARED. IF EXCLUSIVE,OVERLAY OLD ENTRY;  00046402
*                 IF SHARED, EXIT LEAVING OLD ENTRY IN TACT. TEST FOR   00046502
*                 ROOM IN TABLE, IF SO MOVE IN ENTRY; ELSE CREATE A     00047202
*                 NEW TABLE.                                            00047602
*                                                                       00049102
*   NOTES                                                               00049802
*      CHARACTER CODE DEPENDENCIES= EBCIDIC                             00050602
*      DEPENDENCIES= NONE                                               00052602
*      RESTRICTIONS= NONE                                               00053002
*      REGISTER CONVENTIONS= RB- BASE REGISTER                          00053102
*                            RE- RETURN REGISTER                        00053202
*      PATCH-LABEL= PATCH SPACE                                         00053302
*                                                                       00059902
*   MODULE TYPE= PROCEDURE                                              00061902
*      PROCESSOR= ASSEMBLER                                             00063902
*      MODULE SIZE= N/A                                                 00065902
*      ATTRIBUTES= REENTRANT                                            00066302
*                                                                       00066402
*   ENTRY POINT= IEFVDBSD                                               00066502
*      PURPOSE= MAIN ENTRY POINT                                        00073102
*      LINKAGE= STANDARD ENTRY LINKAGE                                  00075102
*      INPUT DATA= REG 12 POINTS TO IWA                                 00077102
*      REGISTERS SAVED= ALL                                             00079102
*      REGISTER CONTENTS DURING PROCESSING=                             00079502
*               R2- DSENQ TABLE POINTER                                 00079602
*               R3- LENGTH OF NEW ENTRY                                 00079702
*               R4- WORK REGISTER                                       00079802
*               R5- POINTER TO TABLE SPACE                              00079902
*               R6- TOTAL SPACE OCCUPIED IN TABLE                       00080002
*               R7- WORK REGISTER                                       00080102
*               R9- S CON OF SIOT                                       00080202
*               RA- S CON OF JFCB                                       00080702
*               RB- BASE REGISTER                                       00081102
*               RE- RETURN REGISTER                                     00081502
*      REGISTERS RESTORED= ALL                                          00082002
*                                                                       00082502
*   EXIT - NORMAL= REGISTER 14                                          00083002
*      CONDITIONS= WHEN DSNAME IS PROCESSED                             00084202
*      OUTPUT DATA= DSENQ TABLE ENTRY IF NEW DSNAME; ELSE UPDATE REFER- 00084602
*                   ENCE COUNT                                          00084702
*      RETURN CODES= NONE                                               00085002
*                                                                       00085402
*   EXIT - ERROR= N/A                                                   00085802
*      CONDITIONS=                                                      00086002
*      OUTPUT DATA=                                                     00087402
*      RETURN CODES=                                                    00089402
*                                                                       00089802
*   EXTERNAL REFERENCES=                                                00090202
*      ROUTINES= IEFVHQ                                                 00090302
*      DATA AREAS= IWA,LWA                                              00090402
*      CONTROL BLOCKS= SIOT,JFCB                                        00092302
*      TABLE= DSENQ TABLE                                               00094302
*      MACROS= IEFSAVER,IEFRELSE                                        00094702
*      ENQUEUE RESOURCES= N/A                                           00095102
*      CHANGE LEVEL= N/A                                                00095502
*                                                                       00095902
*   MESSAGES= NONE                                                      00096002
*                                                                       00096102
*   CHANGE LEVEL = Z40MPTH                                              00097103
*                = Z40RPSM                                              00098103
*                = ZA27750                                     @ZA27750 00098603
*                                                                       00099103
**********************************************************************  00100902
         EJECT                                                          00101902
         IEFCOMWA                                                       00102902
         IEFVMIWA                                                       00103902
         IEFVMDWA                                                       00106402
         EJECT                                                          00107002
DDSCT    DSECT                                                   Y02668 00107602
         IEFASCTB                                                Y02668 00108202
         EJECT                                                          00108802
VDBDSNQT DSECT                                                   Y02668 00109402
         IEFZB902                                                       00110002
JFD      DSECT                                                          00111202
         IEFJFCBN                                                       00116002
DDSIOT   DSECT                                                     3480 00120802
         IEFASIOT                                                  3480 00125602
         IEFQMNGR                                                       00130402
DSNSHR   EQU   X'08'         EQUATE FOR DATA SET SHARE FLAG             00780000
IEFVDBSD CSECT                                                          00800000
         SAVE  (14,12)                                                  00820000
         BALR  RB,0                                                     00840000
         USING *,RB                                                     00860000
*****************************************************************Y02668 00870002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 00870702
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 00871402
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 00872102
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 00872802
         DC    C'DBSD'             MOD ID USED BY TRACE.         Y02668 00873502
* TRACE RETURNS HERE.                                            Y02668 00874202
*****************************************************************Y02668 00874902
         B     DB100               MODULE ID.                    Y02668 00875602
         MODID BR=NO                                             Y02668 00876302
*        DC    C'REL4'             FUNCTION ID AND             @Z40MPTH 00877003
*        DC    C'02' LEV # (RACF)                              @Z40RPSM 00877203
         DC    C'03' LEV # (MERGE SU4,10,16 CODE TO 037 PTF)   @ZA27750 00877403
DB100    DS    0H                                                Y02668 00878402
         L     R9,IWASIOTP                                       Y02668 00880002
         L     RA,IWAJFCBP                                       Y02668 00888002
         USING INDMSIOT,R9                                         3480 00896015
         USING INFMJFCB,RA                                              00940000
         LA    R1,SCT             GET ADDRESS OS SCT             Y02668 00980002
         USING INSMSCT,R1                                        Y02668 01060002
         L     R2,DSENQTP              DSN ENQ TABLE PTR                01100000
         TM    SWD,DBFST               FIRST TIME SWITCH                01120000
         BO    DB200                                                    01140000
         B     DB400                   JUST A DSN TO PROCESS            01160000
*                                                                       01180000
*                                                                       01200000
*********************************************************************** 01220000
*             FIRST TIME MODULE ENTRY                                   01240000
*             .ZERO AREA                                                01260000
*             .SAVE TABLE ID                                            01280000
*             .BCH TO ROUTINE TO PROCESS DSNAME                         01300000
*********************************************************************** 01320000
*                                                                       01340000
DB200    EQU   *                                                        01360000
         XI    SWD,DBFST        TURN OFF FIRST TIME SWITCH              01380000
         XC    0(176,R2),0(R2)         ZERO AREA                        01400000
         USING DSNQTABL,R2                                       Y02668 01420002
         MVI   DSNQID,X'0F'                 TABLE  ID            Y02668 01440002
*********************************************************************** 01480000
*             PROCESS DSNAME-                                           01500000
*             .SCAN JFCB DSNAME ENTRY FROM END TO BEGIN'G  A32735,33487 01520020
*              FOR 1ST NON-BLANK CHARACTER                 A32735,33487 01530020
*             .SCAN DOWN TABLE FOR DUPLICATES OR AVAILABLE SPACE        01540000
*             .JFCB IN LWA POINTED TO BY RA                             01560000
*********************************************************************** 01580000
*                                                                       01600000
DB400    EQU   *                                                        01620000
         XR    R3,R3                   SETUP SCAN REGS                  01640000
         XR    R4,R4                                                    01660000
         LA    R3,43                                       A32735,33487 01680020
DB405    LA    R4,JFCBDSNM(R3)  SCAN JFCBDSNM END TO       A32735,33487 01700020
         CLI   0(R4),C' '       BEGIN FOR 1ST NON BLANK    A32735,33487 01720020
         BNE   DB420            NON BLANK CHAR FOUND, BR   A32735,33487 01740020
         BCT   R3,DB405         BLANK-REDUCE INDEX-RESCAN  A32735,33487 01746020
*                                                                       01800000
*********************************************************************** 01820000
*         NON-BLANK FOUND-REG 3 CONTAINS ONE LESS          A32735,33487 01840020
*             THAN ACTUAL DSNAME                           A32735,33487 01850020
*             SCAN TABLE ENTRIES FOR DUPLICATES OR SPACE AVAILABLE      01880000
*             .R4 AND R5 USED FOR CALCULATING LENGTH OF ENTRIES AND     01900000
*              NEXT ADDR TO COMPARE                                     01920000
*             .R6 TOTALS SPACE OCCUPIED IN TABLE-TO SEE IF NEW ENTRY    01940000
*              WILL FIT                                                 01960000
*********************************************************************** 01980000
DB420    EQU   *                                                        02000000
         LA    R5,DSNQNTRY                                       Y02668 02020002
         USING DSNQNTRY,R5       GET TABLE ADDRESSABILITY        Y02668 02030002
         XR    R4,R4                                                    02040000
         LA    R7,1(R3)          SAVE COUNT-R3 IS 1 LESS   A32735,33487 02050020
*                              THAN ACTUAL DSNAME LENGTH   A32735,33487 02051020
         XR    R6,R6                                                    02080000
DB430    EQU   *                                                        02100000
         IC    R4,DSNQDSNL                                       Y02668 02120002
         CR    R7,R4              COMPARE COUNTS                 A23637 02126018
         BC    7,DB440            GET NEXT ENTRY                 A23637 02132018
         EX    R3,COMPARE              SCAN FOR DUPLICATE               02140000
         BE    DB490                   BCH YES                          02160000
DB440    CLC   DSNQSTEP(3),CF0F       3 BYTES OF ZERO            Y02668 02180002
         BE    DB500                   BCH AVAILABLE                    02200000
         LA    R5,3(R4,R5)             ADJUST TO NEXT ENTRY     Y02668  02220002
         LA    R6,3(R6,R4)                                       Y02668 02240002
         B     DB430                   RETEST                           02260000
*                                                                       02280000
COMPARE  CLC   JFCBDSNM(0),DSNQDSN COMPARE FOR DUPLICATES        Y02668 02300002
*                                                                       02320000
*                                                                       02340000
*********************************************************************** 02360000
*             ENTERED ON DUPLICATE DSNAME FOUND                         02380000
*             TEST IF NEW ENTRY EXCLUSIVE                               02400000
*              .IF NEW ENTRY EXCLUSIVE - OVERLAY OLD ENTRY              02420000
*              .IF NEW ENTRY SHARED - EXIT LEAVING OLD ENTRY IN TACT    02440000
**********************************************************************  02460000
DB490    EQU   *                                                        02480000
         MVC   DSNQSTEP(1),SCTSNUMB   UPDATE REFERRING STEP NBR  Y02668 02490002
         TM    JFCBIND2,DSNSHR             TEST DSNAME SHARE            02500000
         BZ    DB530      NOT SHARE-GO SET EXCLUSIVE INDICATOR     0750 02520000
         TM    SCTSDISP,X'04'      IF DISP=(SHR,DELETE)            3480 02524015
         BO   DB530               SET EXCLUSIVE INDICATOR          3480 02528015
       TM  SIOTALTD,X'04'    TEST ALTERNATE DISP FOR DELETE        3480 02532015
         BO   DB530   YES,SET EXCLUSIVE INDICATOR                  3480 02536015
         B     DB900                                                    02540000
*********************************************************************** 02560000
*             MOVE ENTRY INTO TABLE                                     02580000
*              TEST FOR TABLE ROOM                                      02600000
*             .JFCBDSNM CONTAINS NEW DSN                                02620000
*             .R3 CONTAINS LENGTH OF NEW ENTRY                          02640000
*             .R5 POINTS TO TABLE SPACE                                 02660000
*             .R6 CONTAINS TOTAL SPACE OCCUPIED                         02680000
*********************************************************************** 02700000
DB500    EQU   *                                                        02720000
         LA    R7,159              159=MAX AVAILABLE SPACE,     YM04472*02740002
                                  BASED ON TBL LTH(176)-HDR(14) YM04472*02743002
                                  - NEXT ENTRY INDIC(3).        YM04472 02746002
         LA    R6,4(R6,R3)     ADD ENTRY LENGTH BEFORE COMPARE   Y02668 02750002
         CR    R6,R7                   TEST IF ENTRY WILL FIT           02800000
         BNH   DB525                BCH ON ENOUGH ROOM                  02820000
         BAL   R4,DB600             GO WRITE/ASSIGN                     02840000
DB525    EQU   *                                                        02860000
         EX    R3,MOVE                 EXEC MOVE-R3 CONTAINS LESS 1     02880000
         LA    R3,1(R3)                ADD 1 TO EXEC. LEN               02900000
         STC   R3,DSNQDSNL                SAVE LENGTH BYTE       Y02668 02920002
         MVC   DSNQSTEP(1),SCTSNUMB    MOVE IN STEP NUMBER       Y02668 02940002
         SR    R7,R6                    GET NUMBER BYTES LEFT    Y02668 02960002
         STH   R7,DSNQFREE              STORE NO. FREE BYTES     Y02668 03020002
         TM    JFCBIND2,DSNSHR             TEST DSNAME SHARE            03080000
         BZ    DB530              GO INDICATE EXCLUSIVE                 03100000
         TM    SCTSDISP,X'04'      IF DISP=(SHR,DELETE)            3480 03104015
         BO   DB530               SET EXCLUSIVE INDICATOR          3480 03108015
       TM  SIOTALTD,X'04'    TEST ALTERNATE DISP FOR DELETE        3480 03112015
         BO   DB530   YES,SET EXCLUSIVE INDICATOR                  3480 03116015
         MVI   DSNQFLG1,X'80'              INDICATE SHARED       Y02668 03120002
         B     DB900                                                    03140000
DB530    EQU   *                                                        03160000
         MVI   DSNQFLG1,X'00'      ZERO INDICATES EXCLUSIVE     Y02668  03180002
         B     DB900             NOW GO EXIT                            03200000
*                                                                       03220000
MOVE     MVC   DSNQDSN(0),JFCBDSNM              MOVE IN ENTRY    Y02668 03240002
*                                                                       03260000
*                                                                       03280000
*********************************************************************** 03300000
*                                                                       03320000
*             WRITE AND ASSIGN VIA IEFVHQ                               03340000
*             .PARAMETER LIST SHOULD BE PRESET FOR WRITE/ASSIGN         03360000
*                                                                       03380000
*********************************************************************** 03400000
DB600    EQU   *                                                        03420000
         ST    R1,IWASCTAD        SAVE SCT ADDRESS               Y02668 03430002
         LA    R8,QPARM           LOC OF QUEUE MAN                      03440000
         USING IOPARAMS,R8                                              03460000
         L     R8,QMPCL           PTS TO QMPCA                   Y02668 03480002
         MVC   DSNQSVA(3),IWANXTSV SVA FOR THIS TABLE.          YM02716 03500002
         MVC   4(4,R8),IWANXTSV    SAVE IN QMPEX.               YM02716 03520002
         ST    R2,0(R8)           STORE ADDR INTO QMPCA          Y02668 03550002
         IEFSAVER                                                       03580000
         L     RF,VHQ                  VCON HQ                          03600000
         BALR  RE,RF                                                    03620000
         IEFRELSE                                                       03640000
         MVC   IWANXTSV(4),0(R8)   REPLACE SVA.                 YM02716 03660002
         MVC   DSNQNSVA(3),DSNQSVA     CHAIN DSENQ TABLES        Y02668 03680002
         LA    R5,14(R2)          RESET PTR TO START             Y02668 03690002
         XC    DSNQNTRY(162),DSNQNTRY  ZERO TABLE                Y02668 03700002
         L     R1,IWASCTAD        RESTORE SCT ADDRESS            Y02668 03720002
         BR    R4                                                       03740000
*                                                                       03760000
**********************************************************************  03780000
*             EXIT                                                      03800000
*********************************************************************** 03820000
DB900    EQU   *                                                        03840000
         RETURN (14,12)                                                 03860000
*                                                                       03880000
*                                                                       03900000
*********************************************************************** 03920000
*             MODULE CONSTANTS                                          03940000
         DS    0F                                                       03960000
CF0F     DC    X'00000000'                                       Y02668 03980002
CF00F    DC    X'00000FFF'                                              04000000
VHQ      DC    V(IEFVHQ)                                                04020000
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 04040002
         END                                                            04220000
./  ADD  SSI=81740029,NAME=IEFVEA
*********************************************************************** 00020000
*                                                                       00070002
*   MODULE NAME= IEFVEA                                                 00120002
*                                                                       00170002
*   DESCRIPTIVE NAME= EXECUTE STATEMENT PROCESSOR                       00220002
*                                                                       00270002
*   COPYRIGHT= N/A                                                      00320002
*                                                                       00370002
*   STATUS= REL 037 PTF                                        @ZA29589 00420003
*                                                                       00470002
*   FUNCTION= GENERAL DESCRIPTION                                       00520002
*             IEFVEA IS THE MAIN PROCESSOR FOR EXECUTE CARDS.           00530002
*             IT CREATES THE SCT FOR THE STEP WHILE ALSO CREATING       00540002
*             OVERRIDE TABLES FOR STEP OVERRIDES,AND REFERBACK TABLES   00550002
*             FOR STEP REFERBACKS.                                      00560002
*             IT CONVERTS KEYWORD INTERNAL TEXT TO CONTROL BLOCK        00562002
*             REPRESENTATIONS.                                          00564002
*             IT CHAINS THE JOBLIB SIOT AND JFCB,AND ANY CONCATEN-      00566002
*             ATIONS INTO THE SCT - SIOT CHAIN.                         00568002
*                                                                       00568102
*             AM/0 SUPPORT                                              00568402
*             IF THE CONVERTER FINDS A STEPCAT CARD IN THE              00568502
*             JCL INPUT IT WILL INTERROGATE THE INTERNAL TEXT           00568602
*             TO FIND THE EXEC CARD FOR THAT STEP.WHEN                  00568702
*             THE EXEC CARD TEXT IS FOUND,A BIT WILL BE                 00570602
*             TURNED ON IN THE PREFIX TO SIGNAL THAT A STEPCAT EXISTS.  00572602
*             IEFVEA WILL TEST THIS BIT (STRESTPC) TO                   00572702
*             DETERMINE WHETHER TO CHAIN THE JOBCAT SIOT AND JFCB       00572802
*             INTO THE CHAIN OFF THE PRESENT STEP SCT.                  00572902
*             THE BIT ON SIGNALS NOT TO CHAIN THE JOBCAT BLOCKS.        00573002
*                                                                       00573102
*             THE SCTCAT AND SCTCATR FIELDS IN THE SCT HAVE BEEN        00573202
*             COMBINED INTO ONE FIELD.(SCTPCAT)                         00574802
*                                                                       00575202
*             SWA SUPPORT                                               00576702
*             ALL REFERENCES TO THE 3RD BYTE OF A TTR HAS BEEN          00578602
*             REMOVED.USING THAT TEST TO DETERMINE IF A CONTROL         00580502
*             BLOCK EXISTS IS NOT VALID WITH SWA VIRTUAL ADDRESSES      00582402
*                                                                       00584302
*      OPERATION=                                                       00586202
*                 IEFVEA USES IEFVGK TO POINT TO THE NEXT PIECE         00588102
*                 OF DATA IN THE TEXT CREATED BY IEFVFA.IT THEN         00590002
*                 GAINS CONTROL FROM IEFVGK VIA THE BRANCH TABLE        00600002
*                 IF IT IS A NEW KEYWORD BEING PROCESSED,OR TO          00610002
*                 THE NEXT EXECUTABLE INSTRUCTION IF PROCESSING         00612002
*                 POSITIONAL DATA.                                      00614002
*                 EACH KEYWORD HAS A KEYWORD SUBROUTINE TO HANDLE       00616002
*                 ANY SPECIAL PROCESSING.MOST OF THE PROCESSING         00618002
*                 IS HANDLED BY GOING TO IEFVGT TO TEST AND STORE       00618402
*                 ACCORDING TO THE PDT ENTRIES FOR THE KEYWORD.         00618802
*                 WHEN THE LAST PIECE OF DATA HAS BEEN HANDLED,         00619202
*                 IEFVGK GOES TO IEFVEA'S CLEANUP ROUTINE WHERE         00619602
*                 HOUSEKEEPING IS PERFORMED.                            00619702
*                 IF AN ERROR OCCURS,IEFVEA LOADS AN ERROR CODE         00619802
*                 AND GOES TO IEFVGM TO PUT OUT A MESSAGE.IT            00619902
*                 REGAINS CONTROL AND EXITS TO IEFVHE.                  00626602
*                                                                       00640002
*   NOTES                                                               00670002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00720002
*      DEPENDENCIES= NONE                                               00770002
*      RESTRICTIONS= NONE                                               00820002
*      REGISTER CONVENTIONS= REGISTERS AFTER INITIALIZATION:            00870002
*             R0- WORK REGISTER                                         00870402
*             R1- WORK REGISTER                                         00872002
*             R2- WORK REGISTER                                         00874002
*             R3- WORK REGISTER                                         00876002
*             R4- WORK REGISTER                                         00878002
*             R5- PTR TO SWA MANAGER REMOTE PARAM LIST                  00878402
*             R6- ADDRESS OF IEFVHQ                                     00878802
*             R7-                                                       00879202
*             R8- ADDRESS OF IEFVGT                                     00879602
*             R9- ADDRESS OF IEFVGK                                     00879702
*             RA- LOCAL WORK AREA POINTER                               00879802
*             RB- BASE REGISTER                                         00879902
*             RC- IWA POINTER                                           00883202
*             RD- SAVE AREA POINTER                                     00885202
*             RE- WORK REGISTER                                         00885602
*             RF- WORK REGISTER                                         00886002
*                                                                       00886402
*      PATCH-LABEL= PATCH                                               00886702
*                                                                       00890002
*   MODULE TYPE= PROCEDURE                                              00892002
*      PROCESSOR= ASSEMBLER                                             00894002
*      MODULE SIZE= N/A                                                 00896002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR,PAGED LPA               00898002
*                                                                       00898402
*   ENTRY POINT= IEFVEA                                                 00898802
*      PURPOSE= TO PROCESS EXEC CARD TEXT                               00899202
*      LINKAGE= BRANCH                                                  00899602
*      INPUT DATA= IWA                                                  00899702
*      REGISTERS SAVED= 14-12                                           00899802
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00899902
*      REGISTERS RESTORED= 14-12                                        00906602
*                                                                       00908602
*   EXIT - NORMAL= IEFVHE                                               00910602
*      CONDITIONS= EXEC CARD PROCESSING COMPLETED                       00912602
*      OUTPUT DATA= CONTROL BLOCKS CREATED.                             00913002
*      RETURN CODES= NONE                                               00913102
*                                                                       00913202
*   EXIT - ERROR= IEFVHE                                                00919902
*      CONDITIONS= AFTER AN ERROR IS DETECTED.                          00921902
*                  AN EXIT IS TAKEN TO IEFVGM WITH A MESSAGE CODE       00922302
*                  AND THE MESSAGE IS PUT INTO THE MESSAGE              00922702
*                  DATA SET.CONTROL IS GIVEN BACK TO IEFVEA             00923102
*                  AND AFTER CLEANUP IT GOES TO IEFVHE.                 00923502
*      OUTPUT DATA= ERROR MESSAGE                                       00923902
*      RETURN CODES= NONE                                               00925902
*                                                                       00926302
*   EXTERNAL REFERENCES=                                                00926402
*      ROUTINES= IEFVGI,IEFVGS,IEFVGT,IEFVGK,IEFVHQ,IEFVHF,IEFVGM       00926502
*      DATA AREAS= IWA.EWA,ORWA,QMPA                                    00933202
*      CONTROL BLOCKS= JCT,SCT,SIOT,QMPA,JFCB                           00935203
*      TABLE= IEFVKEYS                                                  00937202
*      MACROS= IEFAJCTB, IEFASCTB, IEFQMNGR, IEFJFCB, IEFSIOT           00939203
*      ENQUEUE RESOURCES= NONE                                          00939602
*      CHANGE LEVEL= Y02668,ZA03866,Z40MPTH,Z40RPSM,                    00939703
*                    ZA07749,OZ07749,ZA08776,OZ09444                    00940003
*                    OZ10064,OZ12397,OZ16392,OZ15772,OZ27750            00940303
*                    OZ30305,OZ29589                           @ZA29589 00940703
*                                                                       00941103
*  MESSAGES= IEF632I - FORMAT ERROR 'COND'                            * 00941802
*            IEF637I - EXCESSIVE ACCOUNT FIELD LENGTH                 * 00943802
*            IEF613I - PROCEDURE WITHIN PROCEDURE                     * 00945802
*            IEF639I - INVALID O'RIDE KEYWORD                         * 00946402
*            IEF632I - FORMAT ERROR 'PGM'                             * 00949802
*            IEF615I - EXCESSIVE PROCSTEP NAME                        * 00951802
*            IEF642I - EXCESSIVE PARAMETER LENGTH                     * 00953802
*            IEF632I - FORMAT ERROR 'TIME'                            * 00955802
*            IEF638I - SPECIFIED NUMBER EXCEEDS MAX                   * 00956202
*            IEF645I - INVALID REFERBACK                              * 00956302
*            IEF646I - REQUIRED POSITIONAL PARAMETER MISSING          * 00956402
*            IEF670I - NO VALUE ASSIGNED TO SYMBOLIC PARAMETER        * 00956502
*                      ON PROC STATEMENT VIA EXEC STMT                * 00961902
*                                                                       00967602
*                                                                       00969603
*********************************************************************** 00973002
*                                                                     * 00978402
         EJECT                                                          00983802
         MACRO                                                          00989202
&A       KKK   &B,&C,&D,&E                                              00994602
&A       EQU   *                                                        01000000
         DC    FL1'&B'            NBR PARAMS THIS KEY.                  01020000
         DC    BL1'&C'      1 MEANS SUBPARAM OK THIS POSITION           01040000
         DC    Y(&D-EABASE)   OFFSET TO KEY PROCESSOR.                  01060000
         DC    Y(&E-EABASE)    OFFSET TO PDT.                           01080000
         SPACE                                                          01100000
         MEND                                                           01120000
         MACRO                                                          01140000
         CCC   &A,&B                                                    01160000
         DC    XL1'32'                 CONTROL INFO/COMPARE BYTES.      01180000
         DC    C'&A'                   COMPARE PATTERN.                 01200000
         DC    XL1'00'                 FUNCT/TABLE - OR/EWA.            01220000
         DC    AL1(EATEMP1+2-EAWORK)   OFFSET IN EWA.                   01240000
         DC    AL1(&B)               BIT PATTERN.                       01260000
         MEND                                                           01280000
         TITLE 'IEFVEA - NEL'                                           01290001
EANEL    DSECT                                                          01292001
         IEFNEL SUBCOM=I                                         Y02668 01294002
         TITLE 'IEFVEA - KEYS'                                          01300000
         IEFVKEYS                                                       01320000
         TITLE 'IEFVEA - JCT'                                           01340000
EAJCT    DSECT                                                          01360000
         IEFAJCTB                                                       01380000
         TITLE 'IEFVEA - IEFQMNGR'                                      01400000
         IEFQMNGR                                                       01420000
         TITLE 'IEFVEA - SIOT'                                          01440000
EASIOT   DSECT                                                          01460000
         IEFASIOT                                                       01480000
         TITLE 'IEFVEA - JFCB'                                          01500000
EAJFCB   DSECT                                                          01520000
         IEFJFCBN                                                       01540000
         TITLE 'IEFVEA - SCT'                                           01560000
EASCT    DSECT                                                          01580000
         IEFASCTB                                                       01600000
         TITLE 'IEFVEA - IWA'                                           01620000
         IEFCOMWA                                                       01640002
         IEFVMIWA                                                       01645002
         IEFTXTFT                                                Y02668 01650002
         TITLE 'IEFVEA - EWA'                                           01660000
         IEFVMEWA                                                       01680000
EAWORK   EQU   EWA                                                      01700000
SIOT     EQU   ACT                                                      01720000
JFCB     EQU   EAAUXWK                                                  01740000
         TITLE 'IEFVEA - ORWA'                                          01760000
ORTABLE  DSECT                                                          01770002
         IEFVORWA                                                       01780000
         TITLE 'IEFVEA - DSNT'                                          01780103
DDDSNT   DSECT                                                 @ZA15772 01783103
         IEFDSNT                                               @ZA15772 01786103
         EJECT                                                          01789103
         TITLE 'IEFVEA - EQUATES'                                       01800000
*                                                                     * 01820000
*********************************************************************** 01840000
*                                                                     * 01860000
*        ERROR MESSAGE NUMBERS                                        * 01880000
*                                                                     * 01900000
*********************************************************************** 01920000
*                                                                     * 01940000
EAR40    EQU   X'20'              IEF632I FORMAT ERROR 'COND'.          01960000
EAR45    EQU   X'25'              IEF637I EXCESSIVE ACCT FIELD LENGTH.  01980000
EAR50    EQU   X'0D'              IEF613I PROCEDURE WITHIN PROCEDURE.   02000000
EAR51    EQU   X'0C'              IEF612I PROCEDURE NOT FOUND IN PROC.  02020000
EAR52    EQU   X'0E'              IEF614I I/O ERROR SEARCHING FOR PRO.  02040000
EAR53    EQU   X'09'              IEF639I INVALID O'RIDE KEYWORD.       02060000
EAR54    EQU   X'20'              IEF632I FORMAT ERROR 'PGM'            02080000
EAR55    EQU   X'0F'              IEF615I EXCESSIVE PROCSTEP NAME.      02100000
EAR56    EQU   X'2A'              IEF642I EXCESSIVE PARAMETER LENGTH.   02120000
EAR57    EQU   X'20'              IEF632I FORMAT ERROR 'TIME'.          02140000
EAR58    EQU   X'26'              EIF638I SPECIFIED NUMERIC EXCEEDS MAX 02160000
EAR59    EQU   X'2D'              IEF645I INVALID REFERBACK.        394 02180000
EAR60    EQU   X'2E'              IEF646I REQUIRED POS. PARAM MISSING.  02190014
EAR61    EQU   X'46'              IEF670I NO VALUE ASSIGNED TO    21016 02195001
*                                 SYMBOLIC PARAM. ON PROC         21016 02197001
*                                 STMT VIA EXEC STMT              21016 02199001
EAR62    EQU   X'49'              IEF673I ADDRSPC=REAL INVALID   Y01029 02199401
WRNMSG04 EQU   X'02'              IEF674I - INVALID DYNAMNBR     Y02670 02199502
WRNMSG03 EQU   X'04'                                             Y02655 02199602
WRNMSG05 EQU   X'13'              IEF675I PERFORM VALUE UNDEF'D YM00368 02199802
         SPACE                                                          02200000
*                                                                     * 02220000
*********************************************************************** 02240000
*                                                                     * 02260000
*        OTHER EQUATED SYMBOLS.                                       * 02280000
*                                                                     * 02300000
*********************************************************************** 02320000
*                                                                     * 02340000
DICTLEN  EQU   0             LENGTH OF DICTIONARY ENTRY.        YM01882 02342002
DICTID   EQU   1             ENTRY IDENTIFIER.                  YM01882 02344002
DICTSIOT EQU   2             3 BYTE SVA OF SIOT FOR ENTRY..     YM01882 02346002
DICTJFCB EQU   5             3 BYTE SVA OF NEW JFCB FOR ENTRY   YM01882 02348002
DICTNAME EQU   8             NAME OF DD CARD FOR ENTRY.         YM01882 02350002
DDVERB   EQU   X'10'         DD CARD ID FOR DICTIONARY ENTRY..  YM01882 02352002
DENLEN   EQU   14            LENGTH OF JOBCAT ENTRY IN DICTIONARYM01882 02354002
EASCTID  EQU   X'02'              SCT ID.                               02360000
EASMBLST EQU   173                OFFSET TO LAST SMB PTR IN SCT.   AACA 02365017
EABIT5   EQU   4                  BIT-5  FOR SYSFLGS - CHECK POINT.AACA 02370017
EABIT6   EQU   2                  BIT-6  FOR SYSFLGS - ABEND.      AACA 02375017
EAJBLIB  EQU   128                JOBLIB BIT IN JCT.                    02380000
EADCTPRC EQU   X'80'              EXEC PROC DICT INDICATOR.             02400000
EADCTPGM EQU   X'40'              EXEC PGM DICT INDICATOR.              02420000
EADCTPPM EQU   X'20'              PGM WITHIN PROC DICT INDICATOR.       02440000
EAJCTREG EQU   92                 REGION OFFSET IN JCT.                 02480000
VOLTID   EQU   X'06'              ID OF VOLUME TABLE.                   02500000
EAJFNEW  EQU   X'C0'              DISP = NEW BIT SETTING IN JFCB.       02520000
EASINEW  EQU   X'04'              DISP = NEW BIT SETTING IN SIOT.       02540000
EAJFOLD  EQU   X'40'              DISP = OLD BIT SETTING IN JFCB. 010   02560000
EASIOLD  EQU   X'01'              DISP = OLD BIT SETTING IN SIOT.       02580000
EAJFSHR  EQU   X'08'              DISP = SHR  BIT SETTING IN JFCB. 010  02600000
EASIPAS  EQU   X'10'              DISP = PASS BIT IN SIOT.          010 02620000
EASYSOUT EQU   X'08'              SYSOUT BIT IN SCTSBYT3 OF SIOT.   394 02640000
EASDISPC EQU   X'10'    MASK TO CLEAR ALL DISP SETTINGS BUT PASS Y02113 02644002
EASBYTE3 EQU   X'F9'    MASK TO CLEAR NEW MOD DISP SETTING.      Y02113 02648002
VOLAFOFF EQU   X'DF'    MASK TO TURN VOL.AFF. OFF              @ZA02726 02651003
SCTSTEND EQU   INSMSCT+172         STEP START AND END BYTE         AACA 02654017
STEPEND  EQU   X'40'                                               AACA 02656017
ONE      EQU   1                                                   I283 02656519
EVEN     EQU   X'01'                                               I283 02657019
E3       EQU   3                                                        02657102
E6       EQU   6                                                        02657202
E7       EQU   7                                                        02657302
E16      EQU   16                                                  I283 02657519
E8       EQU   8                                                        02657702
LCSBIT   EQU   X'04'                                               I283 02658019
E182     EQU   182                                                 I283 02658519
E0       EQU   0                                                 Y01029 02658601
E1       EQU   1                                                 Y01029 02658901
E2       EQU   2                                                   I283 02659019
E4       EQU   4                                                   I283 02659519
STMINSEC EQU   X'03'              TIME KEYWORD CONTAINS STEP,    A49826 02660003
TJOBCAT  EQU   IWAJSIOT           TTR OF JOBCAT SIOT             Y01113 02660203
*                                 MINUTE AND SECOND PARAMETERS.  A49826 02660401
MINUTES  EQU   X'01'              TIME KEYWORD CONTAINS MINUTE   A49826 02660801
*                                 PARAMETER ONLY.                A49826 02661201
ZERO     EQU   X'00'              SECOND PARAMETER IN TIME       A49826 02661601
*                                 KEYWORD HAS ZERO VALUE.        A49826 02661701
JCATSWZ  EQU   DDSWX1         AM/0 SWITCH FIELD                  Y01113 02662001
JCATSW   EQU   IWAJCAT            JOBCAT SWITCH                  Y01113 02663001
ORBYT2KY EQU   PRFMEEK             1ST KEYWD IN ORID FL BYTE 2. YM00368 02663502
DISPLID  EQU   7     DISPLACEMENT OF BLOCK ID IN REMOTE LIST     Y02621 02664002
PROCORID EQU   X'0A'  ID OF PROC OVERRIDE TABLE FOR SWA WRITES   Y02621 02665002
JFCBSID  EQU   X'1C'   ID OF JFCB FOR SWA WRITES                 Y02621 02666002
DICTRYID EQU   X'25'              ID OF REFERBACK DISTIONARY   @ZA12397 02666103
ORDYNMOR EQU   16                                                Y02670 02666603
EADYNM   EQU   X'04'              DYNAMNBR FLAG                  Y02670 02666703
EAPRFM   EQU   X'02'              PERFORM FLAG                  YM00368 02666803
ORPRFMOR EQU   32                                                Y02655 02666903
SWADSNT  EQU   TWORK              DSNT SVA SAVE AREA           @ZA15772 02667903
DSNCOUNT EQU   TWORK+4            COUNT OF DSNT BLOCKS         @ZA15772 02668903
         EJECT                                                          02670903
         TITLE 'IEFVEA - EXECUTE ROUTINE'                               02673301
IEFVEA   CSECT                                                          02680000
*                                                                       02700003
*A 026510,077430,077460,247310                                 @ZA02726 02730103
*C 030000,030100,078080                                        @ZA02726 02740103
* AFTER EAREG4 CHANGE BRANCH TARGET                            @ZA03866 02745103
* DEFINE SWITCH FOR FIRST STEP EXEC ON DEFERRED STP RSTRT      @ZA07749 02746103
* NEAR- EAPGM001 - SET SW WHEN RESTART FIRST STEP FOUND        @ZA07749 02746803
* AT -EARWA21B -TEST AND CLEAR SWITCH BEFORE PROCESSING JOBLIB @ZA07749 02747503
* AFTER EAPGM85 INSERT ONE INSTRUCTION TO INIT.ACT ID          @ZA08776 02748203
* D DO NOT RESET EAFRSTEP UNTIL CLEARED BY INITIALIZATION      @ZA09444 02749603
* CODE AFTER LABELS EAPRFMP & EAPRFME MOVED AFTER EAPRFM3      @ZA10064 02749803
* A EQU FOR DICTRYID AND CODE AT LABELS EARWA6 AND EARWA60     @ZA12397 02749903
* CHANGED BRANCH TARGET TO EARWA6 NEAR EARWA21A                @ZA12397 02756103
* CHANGED R5 TO R6 AFTER LABEL EARWA6                          @ZA16392 02757103
* ADDED CODE AFTER LABEL EARWA6                                @ZA15772 02757403
* DELETE INSTREAM PROCS AND DCB DSECTS                         @ZA18864 02757703
* MERGE SU4,10,16 CODE TO REL 037 BASE PTF                     @ZA27750 02757803
* SET FIRST EXEC PGM= RECEIVED SWITCH                          @ZA30305 02757903
* UPDATE JOBLIB SVA IN VOL=REF=*.JOBLIB SIOT                   @ZA29589 02758003
*                                                                       02758103
*********************************************************************   02760103
*                       INPUT TO THIS ROUTINE                       *   02780101
*                                                                   *   02830101
*                  RC = ADDRESS OF INTERPRETER WORK AREA            *   02840101
*                  RD = CURRENT REGISTER SAVE AREA                  *   02850101
*                                                                   *   02852101
*********************************************************************   02854101
         BALR  RB,0               REGISTER 11 IS THE BASE REGISTER      02860000
         USING *,RB,R8                                                  02870019
EABASE   EQU   *                                                  O106  02880019
EASNBS0  DS    0H                                                       02890019
*****************************************************************Y02668 02891002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 02892002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 02893002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 02894002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 02895002
         DC    C'VEA '             MOD ID USED BY TRACE.         Y02668 02896002
* TRACE RETURNS HERE.                                            Y02668 02897002
*****************************************************************Y02668 02898002
         L     R8,EASNBS1              SECOND BASE                O106  02900019
         B     EAA1                    BRANCH AROUND ID           O106  02910019
EASNBS1  DC    A(EASNBS0+MAX)          VALUE OF SECOND BASE             02920019
         MODID BR=NO                                             Y01886 02960001
         DC    C'SU10'              FUNCTION ID AND            @Z40MPTH 03000003
*        DC    C'02' LEV # (PROC O'RIDE OF PERFORM KWRD ON EXEC@ZA10064 03003003
*              (WITH PERFORM KEYWORD ON JOB CARD ALSO)         @ZA10064 03006003
*        DC    C'03' LEV # (SEARCH,UPDATE,REWRITE JOBLIB DICT           03009003
*              ON DEFERRED STEP RESTART WITH JOBLIB DD)        @ZA12397 03012003
*        DC    C'04' LEV # (LOCATION 0 OVERLAY FIXED)          @ZA16392 03015003
*        DC    C'05' LEV # (SUPPORT VOL REF TO DSN ON JOBLIB)  @ZA15772 03018003
*        DC    C'06' LEV # (DELETE UNUSED DSECTS)              @ZA18864 03021003
*        DC    C'07' LEV # (MERGE SU4,10,16 TO 037 PTF)        @ZA27750 03024003
*        DC    C'08' LEV # (SET FIRST EXEC RECEIVED SWITCH     @ZA30305 03028003
         DC    C'09' LEV # (UPDATE JOBLIB SVA FOR VOL=REF)     @ZA29589 03030003
         EJECT                                                          03036003
*********************************************************************** 03040000
**                                                                   ** 03060000
**             HEADER PORTION OF EXEC ROUTINE.                       ** 03080000
**                                                                   ** 03100000
*********************************************************************** 03120000
*                                                                       03140000
*        REGISTER USAGE.                                                03160000
*                                                                       03180000
*                                                                       03200000
*              R8 = SCT ADDRESS.                                        03220000
*              R9 = TEST AND STORE ADDRESS.                             03240000
*              RA = LOCAL AND GET/T+S WORK AREA.                        03260000
*              RB = EXEC ROUTINE BASE REGISTER.                         03280000
*              RC = INTERPRETER WORK AREA.                              03300000
*              RD = CURRENT REGISTER SAVE AREA.                         03320000
*              RE = LINK RETURN REGISTER.                               03340000
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                     03360000
*                                                                       03380000
         SPACE 2                                                        03400000
EAA1     DS    0H                                                       03420000
         L     RA,CTRLWAP         WORK AREA                             03460000
         USING EAWORK,RA          LWA ADDRESSING.                       03480000
         L     R9,EATESTOR        TEST & STORE ADDRESSING.              03500000
         L     RF,EAGETKEP        GET KEY/POS ADDRESSING.               03520000
*                                                                       03570001
         NI    SCT+SCTSTAT2-INSMSCT,FF-SCTSPSYS INITIALIZE SYSIN A41722 03572001
*              BIT IN SCT TO ZERO FOR EACH NEW SCT.              A41722 03574001
*                                                                       03574101
* ZERO OUT ANY STEPCAT INDICATORS LEFT IN THE SCT AND IWA FROM   Y01113 03574401
* THE PREVIOUS STEP TO INSURE THAT THEY ARE NOT PROPOGATED TO    Y01113 03574801
* SUCCEEDING STEPS                                               Y01113 03575201
         XC    SCT+SCTPCAT-INSMSCT(MVTHREE),SCT+SCTPCAT-INSMSCT  Y02113*03576002
                                   ZERO FIRST PRIVATE CATALOG    Y02113*03576402
                                   POINTER IN SCT.               Y02113 03576802
* CLEAR LAST SIOT FIELD IN CASE THERE ARE NO DD'S FOR THIS STEP. Y02668 03577202
         XC    SCT+SCTLSIOT-INSMSCT(4),SCT+SCTLSIOT-INSMSCT      Y02668*03577602
                                   CASE NO DD'S FOR THIS STEP.   Y02668 03578002
         XC    SCT+SCTCATCT-INSMSCT(E2),SCT+SCTCATCT-INSMSCT            03578402
*                                 ZERO CAT COUNT                 Y02668 03578602
         NI    DDSWX1,FF-IWASCAT            ZERO THE STEPCAT     Y01113 03578801
*              INDICATOR IN THE IWA                              Y01113 03579601
*   INITIALIZE WORK AREA.                                               03600000
*                                                                       03620000
         XC    0(EAREGSV-EWA,RA),0(RA) CLEAR EWA                   AACA 03640017
         MVC   EASNSV(8),EABLANK  BLANK STEPNAME.                       03660000
         MVC   EAPCSV(8),EABLANK  BLANK PROCNAME.                       03680000
         MVC   EAPRSV(8),EABLANK  BLANK OVERRIDDEN PROCSTEP.            03700000
         LA    R7,SIOT                                           Y02668 03720002
         ST    R7,IWASIOTP                                       Y02668 03740002
         LA    R7,JFCB                                           Y02668 03760002
         ST    R7,IWAJFCBP                                       Y02668 03780002
*                                                                       03800000
*   INITIALIZE CORE FOR GET KEY/POS AND TEST & STORE.                   03820000
*                                                                       03840000
         LA    R7,EACLEANP        CLEANUP ADDRESS.                      03860000
         ST    R7,TCLEANUP                                              03880000
         LA    R7,EABRANCH        BRANCH TABLE.                         03900000
         ST    R7,TBRANCH                                               03920000
         NI    SWD,FF-FDDRCV      CLEAR FIRST DD RECEIVED SWITCH.       03940000
         TM    SWH,CPSYSFLG       IS THIS CHCKPT/RSTRT EXEC STMT.  AACA 03950017
         BO    EAA2A              YES. CONTINUE                    AACA 03960017
         OC    JCT+JCTSDKAD-INJMJCT(MVFOUR),JCT+JCTSDKAD-INJMJCT Y02621 03970002
*              DOES AN SCT CHAIN EXIST OFF THIS JCT?             Y02621 03976002
         BNZ   EAE3    YES,CONTINUE-NO CHAIN ONE IT              Y02621 03982002
*                                                                  AACA 03990017
*   FIRST EXEC- POINT JCTSDKAD AT SCT TTR, IF NO RESTART POINT     AACA 04000017
*        JCTSSTR AT SCT TTR ALSO.                                  AACA 04010017
*                                                                  AACA 04020017
         MVC   JCT+JCTSDKAD-INJMJCT(MVTHREE),SCT+SCTANSCT-INSMSCT O106  04026019
*                                      CHAIN IN FIRST STEP        O106  04032019
         OC    JCT+JCTSSTR-INJMJCT(MVFOUR),JCT+JCTSSTR-INJMJCT   Y02621 04040002
*              IS THERE A FIRST STEP TO RESTART ALREADY IN JCT?  Y02621 04046002
         BNZ   EAE3                    YES. CONTINUE.            Y02621 04052002
EAA2A    DS    0H                                                  AACA 04060017
         MVC   JCT+JCTSSTR-INJMJCT(MVTHREE),SCT+SCTANSCT-INSMSCT  O106  04080019
*                                      NO,MOVE FIRST STEP TO STRT O106  04100019
*                                                                       04140000
*   CHECK FOR PROCLIB BEING USED.                                       04160000
*                                                                       04180000
EAE3     DS    0H                                                       04200000
         TM    SWE,PROC           PROCLIB BEING USED.                   04220000
         BO    EAG3               YES.GO TO GET FIRST KEY/POS.          04240000
*                                                                       04260000
*   PROCLIB NOT BEING USED. EXEC SWITCHES OFF, CLEAR CALLING            04280000
*        STEPNAME IN SCT.                                               04300000
*                                                                       04320000
         XC    SWF(1),SWF          CLEAR OVERRIDE FLAGS.         Y02668 04340002
         NI    SWG,FF-ORRDOR-ORSDPOR-ORDYNMOR-ORPRFMOR          YM00368 04348002
*                                 CLEAR O'RIDE FLAGS            YM00368 04352002
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EABLANK              O106  04357019
*                                      BLANK CALLING STEPNAME IN  O106  04364019
*                                      SCT                        O106  04371019
*                                                                       04380000
*   GET FIRST KEY.                                                      04400000
*                                                                       04420000
EAG3     DS    0H                                                       04440000
         BALR  RE,RF              LINK TO IEFVGK.                       04460000
         EJECT                                                          04480000
*********************************************************************** 04500000
*                                                                     * 04520000
*              EXEC KEY PROCESSING.                                   * 04540000
*                                                                     * 04560000
*********************************************************************** 04580000
EAEXEC   DS    0H                                                       04600000
*                                                                       04620000
*   STEPNAME - CHECK FOR FIRST CHAR ALPHA AND MOVE TO EASNSV IN EAWORK. 04640000
*                                                                       04660000
         L     R6,TKEYPX          GET KEY ADDRESS.             @ZA30305 04680003
         LA    R6,1(R6)           POINT AT NUMBER BYTE.        @ZA30305 04690003
         CLI   0(R6),X'02'        EXEC PROC STATEMENT          @ZA30305 04700003
         BE    EAEXEC2            YES. EXEC PROCEDURE STMT.    @ZA30305 04710003
         LA    R6,1(R2,R3)        POINT AT NEXT KEY            @ZA30305 04720003
         CLI   0(R6),PGMEK        IS NEXT KEY PGM=             @ZA30305 04730003
         BE    EAEXEC1            YES GO GET IT.                    438 04740003
         CLI   0(R6),PROCEK       IS NEXT KEY PROC=            @ZA30305 04750003
         BNE   EAPGM10            NO - FORMAT ERROR.                438 04840000
         BE    EAEXEC2                                         @ZA30305 04860003
EAEXEC1  DS    0H                                                   438 04862003
         TM    SWD,FEXRCV         IS THIS FIRST EXEC PGM=      @ZA30305 04864003
         BO    EAEXEC2            NO, BRANCH                   @ZA30305 04866003
         OI    SWD,FEXRCV         YES, SET INDICATOR           @ZA30305 04868003
EAEXEC2  DS    0H                                              @ZA30305 04870003
         BALR  RE,9               TEST AND STORE STEPNAME      @ZA30305 04872003
         STC   R2,EASNSVL         STORE STEPNAME LENGTH        @ZA30305 04874003
*                                                                     * 04880000
*   GET NEXT KEY OR PROCNAME.                                           04900000
*                                                                       04920000
         BALR  RE,RF              GET KEY/POS.                          04940000
         SPACE                                                          04960000
         L     R4,PROCBADD         POINT PDT REG TO PROC PDT BY  Y02668 04980002
         AR    R4,RB               ADDING BASE AND DISPACEMENT.  Y02668 04990002
         B     EAPROC             IF PROCNAME. GO TO PROCESS.           05000000
         EJECT                                                          05020000
*********************************************************************** 05040000
*                                                                     * 05060000
*              PROC KEY PROCESSING.                                   * 05080000
*                                                                     * 05100000
*********************************************************************** 05120000
EAPROC   DS    0H                                                       05140000
*                                                                       05140717
         NI    SCT+SCTSSTAT-INSMSCT,ZEROPRKY  TURN OFF ZERO PRO-  O106  05141119
*                                      TECT KEY                   O106  05141519
*                                                                       05142117
*                                                                       05143014
*   CHECK FOR SYMBOLIC PARAMETER DEFAULT OPTION.                        05146014
*                                                                       05149014
         L     RE,TEXTBUFP         ADDR OF TEXT STRING PFX.     YM01546 05152002
         USING TEXT,RE             PREFIX ADDRESSABILITY.       YM01563 05153002
         TM    STRINDCS,PROCSTR    PROC STATEMENT?               Y02668 05154002
         BO    EAPROC2             YES, CHECK FOR CONFLICTING KEYY02668 05155002
         DROP  RE                                               YM01563 05156002
* GET NEXT KEY. EXEC PROC HAS BEEN HANDLED IN VFA.               Y02668 05160002
EAPROC0  DS    0H                                                Y02668 05260002
         SPACE                                                          05500000
         SR    R6,R6                                                    05520000
         IC    R6,EASNSVL         PICK UP LENGTH OF STEPNAME.           05540000
         EX    R6,EAMVC1          MOVE TO WORK SPACE FOR DICT BUILD.    05560000
         MVI   EAREGSV+1,EADCTPRC SET INDICATOR FOR EXEC PROC.          05580000
         LA    R6,2(R6)           INCREMENT TO GET LENGTH OF DICT ENTRY 05600000
         STC   R6,EAREGSV         SET LENGTH.                           05620000
         LA    R1,EAREGSV         POINT TO START OF DICT ENTRY.         05640000
         L     R6,EAINPUT         LOAD DICT BUILD ROUTINE ADDRESS.      05660000
         SPACE                                                          05680000
         BALR  RE,R6              LINK TO ENTER EXEC PROC INTO DICT.    05700000
         SPACE                                                          05720000
         SPACE                                                          05740000
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EASNSV               O106  05750019
*                                      MOVE CALLING STEPNAME      O106  05760019
*                                      TO SCT                     O106  05770019
         SPACE                                                          05780000
         LA    R6,EAORTABL        ORIDE TABLE ADDRESS TO R6.            05800000
         XC    0(176,R6),0(R6)    ZERO OVERRIDE TABLE.                  05820000
         BALR  RE,RF               EXEC PROC HANDLED IN VFA. GET Y02668*05826002
                                   NEXT KEY.                     Y02668 05832002
         SPACE                                                          05840000
         SPACE                                                          06320914
*                                                                       06321814
*   SYMBOLIC PROC STATEMENT - CHECK FOR ANY EXEC KEYWORDS ON STATEMENT  06322714
*        BY TESTING FOR ENDKEY IN TEXTBUFFER.  ALSO, TURN OFF SYMBOLIC  06323614
*        PROC STMT FLAG IN IWA.                                         06324514
*                                                                       06325414
EAPROC2  DS    0H                                                       06326314
         TM    SWE,PROC           PROC SWITCH ON                   AABA 06326916
         BZ    EAPROC0             BRANCH NO TO TEST AND STORE.  Y02668 06327502
         LA    R6,1(R2,R3)         POINT AT NEXT KEYWORD.               06328114
         CLI   0(R6),ENDK          IS IT AN ENDKEY.                     06329014
         BE    EAEXITHF           YES. EXIT TO IEFVHF              AACA 06329917
*                                                                       06330814
*   SYMBOLIC KEYWORD ERROR - FAIL JOB ISSUE MESSAGE              A47546 06331701
*                                                                       06332614
         MVI   MSGKEY,X'00'        SET NO SECONDARY MESSAGE.      21016 06333501
         MVI   MSGSEC,EAR61        SET ERROR MESSAGE.                   06334414
         B     EAERRTN             ISSUE MSG AND FAIL JOB.       A47546 06338101
         SPACE 2                                                        06340000
EAMVC1   MVC   EAREGSV+1(1),EASNSVL    MOVE NAME OF STEP TO DICT BUILD. 06360000
         EJECT                                                          06380000
*********************************************************************** 06400000
*                                                                     * 06420000
*              PGM KEYWORD ROUTINE.                                   * 06440000
*                                                                     * 06460000
*********************************************************************** 06480000
EAPGM    DS    0H                                                       06500000
         LTR   R2,R2              PGMNAME PRESENT.                 438  06520000
         BZ    EAPGM10            PROGRAM NAME MISSING.            438  06540000
         IC    R6,IWASNUMB         MOVE IN STEP NO. FROM IWA     Y02668 06560002
         LA    R6,1(R6)            INCREMENT STEP NUMBER         Y02668 06580002
         STC   R6,IWASNUMB         PUT UPDATED STEP NO. IN IWA   Y02668 06600002
         STC   R6,SCT+SCTSNUMB-INSMSCT STEP NO. PUT IN SCT       Y02668 06620002
         OI    SWA,SCTTQ           INDICATE SCT TO BE PUT TO Q.  Y02668 06680002
*   MOVE NEXT SCT TTR TO SCTDISKA, SET SCT ID=2, ADD ONE TO SCTCNT IN   06800000
*        IWA &  CLEAR REST OF SCT EXCEPT SCTINPVL(PARM),SCTSTIME(TIME), 06820000
*        SCTSDPCD(COND) ABD BYTES 167 &168 (REGION SLOT).               06840000
*                                                                       06860000
         MVC   SCT+SCTDISKA-INSMSCT(MVTHREE),SCT+SCTANSCT-INSMSCT O106  06890019
*                                      MOVE NEXT TTR TO NEW SCT   O106  06920019
         MVI   SCT+SCTTBLID-INSMSCT,EASCTID  SET SCT ID TO TWO    O106  06950019
*                                                                       07000000
*   ENTER STEPNAME AND SCT TTR INTO DICTIONARY.                         07020000
*                                                                       07040000
         SR    R6,R6                                                    07060000
         IC    R6,EASNSVL         GET LENGTH OF STEPNAME.               07080000
         EX    R6,EAMVC2          MOVE TO WORK SPACE FOR DICT BUILD.    07100000
         MVI   EAREGSV+1,EADCTPGM SET INDICATOR FOR EXEC PGM.           07120000
         TM    SWE,PROC           IS THIS A PROCEDURE.                  07140000
         BZ    EAPGM0             NO. GO TO MOVE SCT TTR TO DICT.       07160000
         MVI   EAREGSV+1,EADCTPPM YES. OVERLAY PGM IND WITH PROC PGM.   07180000
EAPGM0   DS    0H                                                       07200000
         MVC   EAREGSV+DISPLTWO(MVTHREE),SCT+SCTDISKA-INSMSCT     O106  07210019
*                                      MOVE SCT TTR TO DICT BUILD O106  07220019
         LA    R6,5(R6)           INCREMENT FOR PROPER LENGTH OF DICT   07240000
         STC   R6,EAREGSV              ENTRY.                           07260000
         LA    R1,EAREGSV         POINT TO START OF DICTIONARY ENTRY.   07280000
         L     R6,EAINPUT         GET DICT BUILD ROUTINE ADDRESS.       07300000
         SPACE                                                          07320000
         BALR  RE,R6              LINK TO ENTER PGM INTO DICTIONARY.    07340000
         SPACE                                                          07360000
*                                                                       07380000
*   CLEAR SCT.                                                          07400000
*                                                                       07420000
         XC    SCT+SCTLALOC-INSMSCT(CLTHIRTN),SCT+SCTLALOC-INSMSCT O106 07450019
         SR    R6,R6                                                    07480000
         ST    R6,SCT+SCTAFACT-INSMSCT  CLEAR ACT TTR             O106  07490019
*  CLEAR FIELDS FOR NEXT STEP.                                  YM00366 07510002
         XC    SCT+SCTNSMSG-INSMSCT(1),SCT+SCTNSMSG-INSMSCT     YM00366 07516002
         XC    SCT+SCTSTYPE-INSMSCT(1),SCT+SCTSTYPE-INSMSCT     YM00366 07522002
         STH   R6,SCT+SCTRPACT-INSMSCT CLEAR RELATIVE PTR TOACT   O106  07530019
*                                      STEP ENTRY                 O106  07540019
         MVC   SCT+SCTSNAME-INSMSCT(MVEIGHT),EABLANK BLANK STEPNAMEO106 07550019
         TM    SWE,PROC           READING FROM PROCLIB.             248 07580000
         BO    EAPGM00            YES.                              248 07600000
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EABLANK  NO BLANK    O106  07608019
*                                      CALLING STEP NAME          O106  07616019
         MVI   SCT+SCTSSTAT-INSMSCT,INITBLK  CLEAR INTERNAL STEP  O106  07624019
*                                      STATUS                     O106  07632019
EAPGM00  DS    0H                                                   248 07640000
         MVC   SCT+SCTPGMNM-INSMSCT(MVEIGHT),EABLANK BLANK PGMNM  O106  07660019
         OI    EASW1,EAERLYER     INDICATE FAKE SCT NOT NEEDED.         07680000
*                                                                  AACA 07680517
*   CHECK FOR STEPFLUSH - IF STEPNAME OF THIS STEP MATCHES         AACA 07681017
*        STEPNAME FROM RESTART PARAMETER ON THE JOB STATEMENT,     AACA 07681517
*        INDICATE STEP FOUND BY TURNING OFF CPSTPFL IN SWH OF IWA. AACA 07682017
*        IF CHECKID WAS SPECIFIED LINK TO EARSTSUB TO REARRANGE    AACA 07682517
*        SCT/SMB CHAIN.  IF NOT, MOVE THIS SCT TTR TO JCTSSTR.     AACA 07683017
         TM    SWH,CPSTPFL         FLUSHING TO A SPECIFIC STEP? YM00371 07683502
         BZ    EAPGM005            NO, CONTINUE.                YM00371 07683602
         CLI   IWAJOBS3,C'*'       RESTART THIS STEP? (REST=*). YM00371 07683702
         BNE   EAPGM001            BR NO TO CHECK STEPNAMES.    YM00371 07683802
*  RESTART AT FIRST STEP - RESTART=*.                           YM00371 07683902
         NI    SWH,255-CPSTPFL     CLEAR C/R FLUSH FLAG.        YM00371 07684002
         B     EAPGM005            TREAT AS IF NO RESTART FOR   YM00371*07684102
                                   CHAINING PURPOSES.           YM00371 07684202
EAPGM001 DS    0H                                               YM00371 07684302
         CLC   IWAJOBS1(MVEIGHT),SCT+SCTSCLPC-INSMSCT  IS THE     O106  07684819
*                                      CALLING STEPNAME           O106  07685119
*              THE SAME AS THE ONE SPECIFIED IN THE JOB RESTART    AACA 07685517
*              PARAMETER.  (IN THE CASE OF A NON-PROCEDURE STEP    AACA 07686017
*              BOTH FIELDS ARE BLANK.)                             AACA 07686517
         BNE   EAPGM004            NO CONTINUE                     AACA 07687017
         CLC   IWAJOBS3(8),EASNSV YES. ARE THE STEPNAMES THE SAME. AACA 07687517
         BNE   EAPGM004            NO CONTINUE                     AACA 07688017
*                                                                  AACA 07688517
*   RESTART STEP FOUND                                             AACA 07689017
*                                                                  AACA 07689517
         NI    SWH,FF-CPSTPFL     INDICATE RESTART STEP FOUND      AACA 07690017
         MVC   JCTSNUMB+JCT-INJMJCT,IWASNUMB MOVE RESTART STEP  YA01834 07690202
         OI    EASW2,EACLCOND      THIS SWITCH INDICATES        YM00371 07690502
* TO THE SUBRTN WHICH CONNECTS JOBLIB SIOTS TO THIS SCT THAT       AACA 07691017
* THIS WILL BE THE 1ST STEP RUN IN THE RESTARTED JOB AND THAT      AACA 07691517
* THE STEP CONDITION CODES ARE TO BE ZEROED IN THE CLEAN-UP RTN.   AACA 07692017
         OI    EASW2,EAFRSTEP     INDICATE FIRST STEP FOR A    @ZA07749 07692103
*                                 DEFERRED STEP RESTART        @ZA07749 07692203
         CLI   JCT+JCTCKIDL-INJMJCT,X'00'   IS CHECKID PRESENT.    AACA 07692517
         BE    EAPGM003           NO GO TO MOVE SCT TTR TO JCTSSTR AACA 07693017
         IC    R6,JCTSNUMB+JCT-INJMJCT  YES...DECREMENT THE     YA01834 07693102
         BCTR  R6,0                     JCT RESTART STEP        YA01834 07693202
         STC   R6,JCTSNUMB+JCT-INJMJCT  NUMBER BY ONE           YA01834 07693302
*                                                                  AACA 07693517
         BAL   RE,EARSTSUB        FOUND THE RESTART STEP - LINK TO AACA 07694017
*                                      CHAIN SCT + SMB TTRS.       AACA 07694517
         B     EAPGM005           CONTINUE                         AACA 07695017
EAPGM003 DS    0H                                                  AACA 07695517
         MVC   JCT+JCTSSTR-INJMJCT(MVTHREE),SCT+SCTDISKA-INSMSCT  O106  07695819
*                                      SCT TTR TO JCTSSTR         O106  07696119
*              TO INDICATE TO INITIATOR THAT THIS IS THE FIRSTSTEP AACA 07696517
*              OF THE JOB TO BE RUN WHEN IT IS RESTARTED.          AACA 07697017
         B     EAPGM005            CONTINUE                        AACA 07697117
EAPGM004 DS 0H                                                          07697217
         OI    SCT+SCTSTEND-INSMSCT,STEPEND  SET STEP ENDED BIT   O106  07700219
*                                      IN SCT.  BIT MUST BE SET   O106  07703219
*                                      FOR WARM START             O106  07706219
         SPACE                                                          07709219
EAPGM005 DS    0H                                                       07712219
*                                                                       07715219
         XC    EATEMP3(E4),EATEMP3   ZERO 1ST JOBCAT PTR FILED   Y02113 07720002
         SR    R0,R0              SETUP R0 FOR JOBCAT COUNT      Y02113 07730002
         SR    R6,R6              CLEAR REG FOR JOBLIB COUNT     Y02113 07740002
         CLI   SCT+SCTSNUMB-INSMSCT,FRSTSTEP   1ST STEP?       @ZA02726 07743003
         BE    SKIP      YES-BRANCH AROUND CLEAR DSNT INSTRS.  @ZA02726 07746003
*      I N I T I A L I Z E  C O M M O N  S C T  F I E L D S      Y02113 07750002
         XC    SCT+SCTLDSTB-INSMSCT(E4),SCT+SCTLDSTB-INSMSCT     Y02668 07760002
*                                      CLEAR LEN OF DSNAME TABLE Y02113 07770002
         XC    SCT+SCTADSTB-INSMSCT(CLFOUR),SCT+SCTADSTB-INSMSCT Y02668 07780002
*              CLEAR DSN POINTER IN SCT.                         Y02668 07790002
*  INITIALIZATION OF SCT FIELDS IS COMPLETE.                    YM04927 07800002
*  CHECK IF SCT IS FOR CHECKPT/RESTART EXEC - PGM=IEFDSDRP.     YM04927 07804002
SKIP     TM    SWH,CPSYSFLG        THIS A CHECKPT/RESTART EXEC @ZA02726 07808003
         BO    EAPGM011            BR YES, BYPASS CHAINING.     YM04927 07812002
*  STANDARD EXEC. CHAIN JOBLIB/JOBCAT SIOTS, IF ANY.            YM04927 07816002
*                                                                       07820002
         TM    JCT+JCTJSTAT-INJMJCT,EAJBLIB  DOES A JOBLIB              07830003
*                                            EXIST               Y02113 07835003
         BZ    EAPGM010     NO,NO JOBLIB SIOTS TO CHAIN TO STEP. Y02113 07840002
*                           YES,SET UP TO CHAIN JOBLIB SIOTS.    Y02113 07850002
         MVC   EATTRSV(MVFOUR),TJOBLIB  MOVE JOBLIB POINTER TO   Y02113 07860002
*              START READING FROM FIRST JOBLIB SIOT THRU COUNT.  Y02113 07870002
         IC    R6,JBCONCAT    GET THE NUMBER OF JOBLIB SIOTS.    Y02113 07880002
         L     R5,TEXTBUFP   LOAD ADDRESS OF TEXT BUFFER TO SET  Y02113 07890002
         USING TEXT,R5                                                  07900002
         TM    STREINDC,ETXSTPCT   DOES STEP HAVE A STEPCAT DD?  Y02668 07910002
         BO    EAPGM007    YES,DO NOT INCLUDE JOBCAT SIOT COUNT. Y02113 07920002
EAPGM006 DS    0H                                                Y02668 07930002
         IC    R0,IWACATCT  GET THE NUMBER OF JOBCAT SIOTS.      Y02113 07940002
EAPGM007 DS    0H                                                Y02668 07950002
         DROP  R5                                                Y02668 07960002
*        CALCULATE THE NUMBER OF SIOTS TO BE READ AND CHAINED    Y02113 07970002
*   JOBLIB. SET SCTLALOG, AND DDINTNO = NBR JOBLIB SIOTS.        Y02668 07980002
*        SCT AND IWA.                                            Y02113 07990002
*                                                                Y02113 08000002
         AR    R6,R0  ADD THE JOBLIB AND JOBCAT COUNTS TO GET    Y02113 08010002
*              TOTAL NUMBER OF SIOTS THAT WILL BE READ IN.       Y02113 08020002
         STH   R0,SCT+SCTCATCT-INSMSCT SET CATALOG SIOT COUNT    Y02668 08030002
         STH   R6,SCT+SCTLALOC-INSMSCT  SET NUMBER OF SIOTS FOR  Y02113 08040002
*              CALCULATION OF ALLOCATE WORK AREA.                Y02113 08050002
         STH   R6,DDINTNO         DD INTERNAL NBR.               Y02668 08060002
         MVC   SCT+SCTFSIOT-INSMSCT(MVFOUR),TSIOT  SET UP FOR    Y02113 08070002
*              STARTING SIOT CHAIN FROM FIRST SIOT CREATED NO    Y02113 08080002
*              MATTER WHICH ONE IT WILL BE.                      Y02113 08090002
EAPGM008 DS    0H                                                Y02668 08100002
*        READ CHAIN AND WRITE CODE.THE SUBROUTINE USED WILL READ Y02113 08110002
*        CHAIN AND WRITE OUT AGAIN JOBLIB AND JOBCAT SIOTS.THE   Y02113 08120002
*        ORIGINAL JOBCAT AND /OR JOBLIB SIOTS ARE USED AS MODELS.Y02113 08130002
         SPACE                                                          08140002
         SR    R5,R5     ZERO IN REGISTER 5 INDICATES READ.      Y02113 08150002
         SPACE                                                          08160002
         BAL   RE,EARWA  READ IN THE SIOT AND JFCB AND CHAIN.    Y02113 08170002
*        JOBLIB AND JOBCAT DSNAMES MUST BE CHECKED FOR DSENQ     Y02668 08172002
*        ENTRIES TO BE BUILT,IF THEY DON'T EXIST                 Y02668 08174002
         L     R5,EAVDBSD         ADDR OF DSENQ TABLE ROUTINE.   Y02668 08176002
         BALR  RE,R5              CHECK DSNAME IN DSENQ TABLE    Y02668 08178002
         SPACE                                                          08180002
*        LAST JOBLIB OR JOBCAT SIOT IN STEP,IF NO OTHER DD CARDS Y02668 08180702
*        EXIST FOR STEP,MUST HAVE A ZERO NEXT SIOT POINTER.      Y02668 08181402
         LA    R5,E1     LOAD A ONE INTO REGISTER 5.             Y02668 08182102
         CR    R6,R5     HAVE WE READ IN THE LAST SIOT TO BE     Y02668 08182802
*              CHAINED TO THIS STEP?                             Y02668 08183502
         BNE   EAWRITES  NO,CONTINUE NORMAL PROCESSING.          Y02668 08184202
         LA    R5,WAEXCPFX  LOAD ADDRESS OF EXEC CARD PREFIX     Y02668 08184902
         USING TEXT,R5                                                  08185602
         TM    STREINDC,ETXNODD  IS THE NO DD INDICATOR ON FOR   Y02668 08186302
*                                THIS STEP?(NO DD CARDS).        Y02668 08187002
         DROP  R5                                                Y02668 08187702
         BZ    EAWRITES  NO,THEN DD CARDS FOLLOW FOR STEP        Y02668 08188402
         CLI   E1(R3),C'*'         IS THIS PGM=*. ?             YM00365 08188602
         BE    EAWRITES         YES.  DO NOT ZERO NEXT SOIT PTR YM00365 08188802
         LA    R5,SIOT     LOAD ADDRESS OF CURRENT SIOT.         Y02668 08189102
         USING INDMSIOT,R5                                       Y02668 08190002
         XC    SCTPSIOT(MVFOUR),SCTPSIOT                         Y02668 08192002
*              ZERO THE NEXT SIOT POINTER TO SIGNAL LAST SIOT    Y02668 08194002
*              FOR THE STEP.                                     Y02668 08196002
         DROP  R5                                                Y02668 08200002
         SPACE                                                          08202002
EAWRITES DS    0H    WRITE NEXT SIOT/JFCB OUT                    Y02668 08204002
         LA    R5,E4     4 IN REGISTER 5 INDICATES WRITE,ASSIGN. Y02113 08206002
         SPACE                                                          08208002
         BAL   RE,EARWA  WRITE AND ASSIGN SIOT AND ITS JFCB.     Y02113 08210002
         SPACE                                                          08220002
         BCT   R6,EAPGM008  CONTINUE READING AND CHAINING UNTIL  Y02113 08230002
*              CALCULATED NUMBER OF SIOTS HAS BEEN PROCESSED.    Y02113 08240002
*                                                                       08250002
         OC    EATEMP3(MVFOUR),EATEMP3 WAS A JOBCAT SIOT FOUND   Y02113 08260002
*              DURING THE READ,CHAIN,WRITE PROCESS?              Y02113 08270002
         BZ    EAPGM009  NO,DO NOT SET UP JOBCAT POINTERS.       Y02113 08280002
         MVC   SCT+SCTPCAT-INSMSCT(MVFOUR),EATEMP3  MOVE IN      Y02113 08290002
*              FIRST SIOT POINTER FOR STEPCAT                    Y02113 08300002
         OI    SCT+SCTSTYPE-INSMSCT,SCTJSCAT  TURN ON JOBCAT BIT Y02113 08310002
*                                                                       08320002
EAPGM009 DS    0H                                                Y02668 08330002
         TM    SWD,FEXRCV  IS THIS THE FIRST STEP FOR THE JOB.   Y02113 08340002
         BZ    EAPGM22     YES,PROCESS FIRST STEP LOGIC.         Y02113 08350002
         B     EAPGM5      NO,FIRST STEP ALREADY ENCOUNTERED.    Y02113 08360002
*                                                                       08370002
EAPGM010 DS    0H                                                Y02668 08380002
         TM    JCATSWZ,JCATSW    DOES A JOBCAT EXIST?            Y02113 08390002
         BZ    EAPGM011    NO,NO CHAINING OF JOBCAT OR JOBLIB.   Y02113 08400002
         L     R5,TEXTBUFP        LOAD POINTER TO EXEC CARD TEXT Y02113 08410002
         USING TEXT,R5                                           Y02668 08420002
         TM    STREINDC,ETXSTPCT   DOES STEP HAVE A STEPCAT DD?  Y02668 08430002
         DROP  R5                                                Y02668 08440002
         BO    EAPGM011            YES,IGNORE JOBCAT CHAINING.   Y02113 08450002
*        JOBCAT EXISTS,START CHAINING FROM FIRST JOBCAT SIOT.    Y02113 08460002
         MVC   EATTRSV(MVFOUR),TJOBCAT SET UP TO CHAIN FROM FIRSTY02113 08470002
         B     EAPGM006   GET JOBCAT COUNT AND READ,CHAIN,WRITE. Y02113 08480002
*                                                                       08490002
EAPGM011 DS    0H                                                Y02668 08500002
*        NO JOBCAT OR JOBLIB SIOTS ARE TO BE CHAINED FROM THE    Y02113 08510002
*        SCT.INITIALIZATION HAS BEEN DONE.                       Y02113 08520002
*                                                                Y02113 08530002
         XC    DDINTNO(2),DDINTNO   NO. CLEAR NBR SIOTS IN IWA.  Y02668 08540002
         LA    R5,WAEXCPFX         GET SAVED EXEC PFX BASE       Y02668 08541002
         USING TEXT,R5             SET ADDRESSABILITY            Y02668 08542002
         TM    STREINDC,ETXNODD    ANY DD'S IN THIS STEP?        Y02668 08543002
         DROP  R5                                                Y02668 08544002
         BO    EAPGM009            YES  DON'T SET SIOT PTR       Y02668 08545002
         MVC   SCT+SCTFSIOT-INSMSCT(MVFOUR),TSIOT  PUT NEXT SIOT Y02113 08550002
*              AS FIRST SIOT TO START CHAINING STEP'S DD CARDS.  Y02113 08560002
         B     EAPGM009 TEST FOR FIRST STEP AND CONTINUE.        Y02113 08570002
         SPACE                                                          08580002
EAPGM22  DS   0H                                                 Y02113 08590002
         TM    SWH,CPSTPFL        FLUSHING TO A SPECIFIC STEP      AACA 09128001
         BZ    EAPGM4             NO. CONTINUE                     AACA 09132001
*                                                                  AACA 09136001
         L     RF,EAGETKEP        RESTORE GET KEY/POS ADDRESS.     AACA 09210001
EAPGM4   DS    0H                                                       09215001
         OI    SWD,FEXRCV         SET FIRST EXEC RECVD THIS JOB SWITCH. 09220000
*                                                                       09240000
*   CHECK FOR OVERRIDES.                                                09260000
EAPGM5   DS    0H                                                       09280000
*                                                                       09300000
*   PARM O'RIDE CHECK.                                                  09320000
*                                                                       09340000
         TM    SWF,ORPARMOR       CHECK PARM O'RIDE.                    09360000
         BO    EAPGM5A            YES. GO TO SWITCHES SET.              09380000
         SPACE                                                          09400000
         XC    SCT+SCTXBTTR-INSMSCT(CLTHREE),SCT+SCTXBTTR-INSMSCT O106  09410019
*                                      NO, ZERO PARM TTR          O106  09420019
         XC    SCT+SCTSEXEC-INSMSCT(CLTWO),SCT+SCTSEXEC-INSMSCT   O106  09430019
*                                      CLEAR LENGTH OF PARM FIELD O106  09440019
         B     EAPGM6             GO TO CHECK COND O'RIDE.              09460000
EAPGM5A  DS    0H                                                       09480000
         OI    SWF,ORPARMBL       PARM BLOCK ON.                        09500000
         NI    SWF,FF-ORPARMOR    PARM O'RIDE OFF.                      09520000
*                                                                       09540000
*   COND O'RIDE CHECK.                                                  09560000
*                                                                       09580000
EAPGM6   DS    0H                                                       09600000
         TM    SWF,ORCONDOR       COND O'RIDE ON.                       09620000
         BO    EAPGM7             YES. GO TO TIME O'RIDE CHECK.         09640000
         XC    SCT+SCTSDPCD-INSMSCT(CL48),SCT+SCTSDPCD-INSMSCT    O106  09650019
*                                      NO, ZERO COND FIELDS IN SC<O106  09660019
*                                                                       09680000
*   TIME O'RIDE CHECK.                                                  09700000
*                                                                       09720000
EAPGM7   DS    0H                                                       09740000
         TM    SWF,ORTIMEOR       TIME O'RIDE ON.                       09760000
         BO    EAPGM7A            YES. GO TO SET TIME SWITCHES.         09780000
         TM    SWF,ORTIME0        NO. IS TIME ZERO ON.                  09800000
         BO    EAPGM7B            YES. GO TO ZERO STEP TIME IN SCT.     09820000
         B     EAPGM8             GO TO CHECK ACCT O'RIDE.              09860000
EAPGM7A  DS    0H                                                       09880000
         OI    SWF,ORTIME0        TIME ZERO ON.                         09900000
         TM    SWH,CPSTPFL             STEP FLUSH SW ON          A30886 09906020
         BO    EAPGM8                  YES,TIME FROM PRIOR SCT   A30886 09912020
         NI    SWF,FF-ORTIMEOR    TIME O'RIDE OFF.                      09920000
         B     EAPGM8             GO TO CHECK ACCT O'RIDE.              09940000
EAPGM7B  DS    0H                                                       09960000
         XC    SCT+SCTSTIME-INSMSCT(CLTHREE),SCT+SCTSTIME-INSMSCT O106  09970019
*                                      ZERO STEP EXECUTION TIME   O106  09980019
*                                      IN SCT                     O106  09990019
*                                                                       10000000
*   ACCT O'RIDE CHECK.                                                  10020000
*                                                                       10040000
EAPGM8   DS    0H                                                       10060000
         TM    SWF,ORACTOR        ACCT O'RIDE ON.                       10080000
         BZ    EAPGM8A            NO. GO TO CHECK REGION O'RIDE.        10100000
         TM    EASW2,EAEACCTE          IS ACCT=  SWITCH SET ON   A22206 10101018
         BZ    EAPGM85                 NO, BR TO CREATE A ACT    A22206 10102018
         NI    EASW2,FF-EAEACCTE       TURN OFF ACCT=  SWITCH    A22206 10103018
         MVC   SCT+SCTAFACT-INSMSCT(E4),TACT                 A22206O106 10103619
***  MOVE TTR OF OVERRIDE ACT TO SCT FOR FIRST PROCSTEP ONLY.    A38608 10104201
         B     EAPGM8A                 BR TO REGION O'RIDE CHECK A22206 10105018
EAPGM85  DS    0H                                                A22206 10106018
***   FOR REMAINING PROCSTEPS,READ OVERRIDE ACT,OBTAIN NEXT      A38608 10106401
***   AVAILABLE TTR FOR NEW ACT,CHAIN NEW ACT TO PROCSTEP'S      A38608 10106801
***   SCT,AND WRITE COPY OF OVERRIDE ACT AS PROCSTEP'S ACT.      A38608 10106901
         LA    R7,QPARM                QMGR PARAMETER AREA       A22206 10107018
         USING IOPARAMS,R7                                       A22206 10108018
         L     R6,QMPCL                QMPCA ADDRESS             A22206 10109018
         LA    R5,EAAUXWK              AUX. WORKAREA ADDRESS     A22206 10110018
         ST    R5,0(R6)                TO QMPCA                  A22206 10111018
         MVC   4(4,R6),TACT            MOVE ACT TTR TO QMPEX     A22206 10112018
         MVI   QMPOP,QMREAD            INDICATE READ FUNCTION    A22206 10113018
         L     R5,EAVHQ                IEFVHQ ADDRESS            A22206 10114018
         BALR  RE,R5                   LINK TO QMGR TO READ      A22206 10115018
         MVC   E4(E4,R6),TNEXT       MOVE NEXT AVAILABLE TTR TO  A38608 10115401
*                                    QMPEX FOR WRITE.            A38608 10115801
         MVC   SCT+SCTAFACT-INSMSCT(E4),TNEXT CHAIN TO SCT       A38608 10115901
         LA    R5,EAAUXWK              AUX. WORKAREA ADDRESS     A22206 10118018
         USING ACTDSKAD,R5                                       A22206 10119018
         MVC   ACTDSKAD(E4),TNEXT      UPDATE SELF TTR NEW ACT   A38608 10119401
         MVI   ACTIDENT,ACTID        SET SWA BLOCK ID FOR ACT  @ZA08776 10120203
         L     R5,EAVHQ                IEFVHQ ADDRESS            A22206 10121018
         BALR  RE,R5                   LINK TO QMGR TO WRITE/ASN A22206 10122018
         MVC   TNEXT(4),0(R6)          UPDATE TNEXT TTR          A22206 10123018
*   FALL THRU TO EAPGM8A                                                10140000
*                                                                       10160000
*   REGION O'RIDE CHECK.                                                10180000
*                                                                       10200000
EAPGM8A  DS    0H                                                       10220000
         TM    SWF,ORREGOR        REGION O'RIDE ON.                     10240000
         BO    EAPGM8B            YES. GO TO SET EXEC REGION FLAG.  354 10260000
         XC    SCT+SCTMSSZE-INSMSCT(E2),SCT+SCTMSSZE-INSMSCT     Y02668 10270002
*                                      NO, ZERO REGION SIOT       O106  10280019
         B     EAPGM8H            GO TO CONTINUE CHECK           Y02670 10300002
EAPGM8B  DS    0H                                                   354 10320000
         OI    EASW2,EAREGION     TURN ON REGION SPECIFIED FLAG.        10328014
*                                                                Y02670 10328602
*   DYNAMNBR O'RIDE CHECK                                        Y02670 10329202
*                                                                Y02670 10329802
EAPGM8H  DS    0H                                                Y02670 10330402
         TM    SWG,ORDYNMOR       DYNAMNBR O'RIDE ON?            Y02670 10331002
         BO    EAPGM8I            YES, CONTINUE                  Y02670 10331602
         XC    SCT+SCTNIUSL-INSMSCT(E2),SCT+SCTNIUSL-INSMSCT     Y02670 10332202
*                                 CLEAR DYNAMNBR FIELD           Y02670 10332802
         B     EAPGM8M                                          YM00368 10333402
EAPGM8I  DS    0H                                                Y02670 10334002
         OI    EASW2,EADYNM       TURN ON DYNAMNBR FLAG          Y02670 10334602
*                                                               YM00368 10334702
*    PERFORM O'RIDE CHECK                                       YM00368 10334802
*                                                               YM00368 10334902
EAPGM8M  DS    0H                                               YM00368 10335002
         TM    SWG,ORPRFMOR       PERFORM O'RIDE ON?            YM00368 10335102
         BO    EAPGM8L            YES GO SET PERFORM EXEC FLAG  YM00368 10335202
         XC    SCT+SCTPRFMF-INSMSCT(E1),SCT+SCTPRFMF-INSMSCT    YM00368 10335302
         B    EAPGM8C             CONTINUE                      YM00368 10335402
EAPGM8L  DS    0H                                               YM00368 10335502
         OI    EASW2,EAPRFM       SET EXEC PERFORM FLAG         YM00368 10335602
*                                                                       10336014
*   ADDRSPC O'RIDE CHECK.                                        Y01029 10344001
*                                                                       10352014
EAPGM8C  DS    0H                                                Y01029 10360001
         TM    SWF,ORADDROR          ADDRSPC OVERRIDE ON?        Y01029 10364001
         BO    EAPGM8D               YES, SET EXEC ADDRSPC FLAG  Y01029 10368001
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                  Y01029 10370001
*                                 NO, CLEAR ADDRSPC FLAG         Y01029 10372001
         B     EAPGM8E            CONTINUE.                      Y01029 10374001
EAPGM8D  DS    0H                                                Y01029 10376001
         OI    EASW2,EAADDR       SET EXEC ADDRSPC FLAG.         Y01029 10377001
*                                                                  AACA 10377217
*   RD O'RIDE CHECK                                                AACA 10377417
*                                                                  AACA 10377617
EAPGM8E  DS    0H                                                       10378014
         TM    SWG,ORRDOR         RD O'RIDE ON.                    AACA 10378417
         BO    EAPGM8F            YES. CONTINUE                    AACA 10378817
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS  NO CLEAR FLAGS       O106  10379519
*                                                                  I241 10380218
*   SDP O'RIDE CHECK                                               I241 10381218
*                                                                  I241 10382218
EAPGM8F  DS    0H                                                  I241 10383218
         TM    SWG,ORSDPOR         SDP O'RIDE ON                   I241 10384218
         BO    EAPGM8G             YES, CONTINUE                   I241 10385218
         OI    SCT+SCTSDP-INSMSCT,INIT1   INITIALIZE FIELD        O106  10386219
         NI    SCT+SCTSDP-INSMSCT,INIT2   INITIALIZE FIELD        O106  10387219
         NI    SCT+SCTSDP-INSMSCT+DISPLONE,INIT3 INIT FIELD       O106  10388219
         OI    SCT+SCTSDP-INSMSCT+DISPLONE,INIT4 INIT FIELD       O106  10389219
EAPGM8G  DS    0H                                                  I241 10390218
*                                                                  I241 10391218
*   MOVE STEPNAME (OR BLANKS) TO SCT.                                   10400000
*                                                                       10420000
         MVC   SCT+SCTSNAME-INSMSCT(MVEIGHT),EASNSV STEPNAME TO SCTO106 10440019
*                                                                       10460000
*   LINK TO TEST & STORE. CHECK FOR *. - SET EAPGMSDF FLAG IN LWA.      10480000
*        IF NOT *.- CHECK PGMNM FOR 8 CHAR & ALPHA & MVC TO SCT.        10500000
*        AND SET EAPGMEF IN LWA.                                        10520000
*                                                                       10540000
         BALR  RE,R9              LINK TO TEST & STORE                  10560000
         SPACE                                                          10580000
         TM    EASW1,EAPGMSDF     TEST FOR *.                           10600000
         BZ    EAPGM9             NO. GO TO GET NEXT KEY.               10620000
*                                                                       10640000
*   PGM=*.  LINK TO SEARCH DICTIONARY ROUTINE.  R1 = PTR TO DICT. ENTRY 10660000
*                                                                       10680000
         BALR RE,RF               GET STEPNAME.                         10700000
         SPACE                                                          10720000
         L     R6,EASEARCH                                              10740000
         BALR RE,R6               LINK TO SEARCH DICTIONARY.            10760000
         SPACE                                                          10780000
         MVC   EATTRSV(3),2(R1)   MOVE SIOT TTR TO TEMP SAVE AREA.      10800000
         SPACE                                                          10820000
*                                                                       10840000
*   LINK TO READ IN PGM= *. SIOT.   ASSIGN A NEW TTR.                   10860000
*                                                                       10880000
         SR    R5,R5              SET R5 FOR READ.                      10900000
         BAL   RE,EARWA           LINK TO QMGR READ INTERFACE.          10920000
         L     R5,EAVDBSD         ADDR OF DSENQ TABLE ROUTINE.   Y02668 10926002
         BALR  RE,R5              CHECK DSNAME IN DSENQ TABLE    Y02668 10932002
         SPACE                                                          10940000
         LA    R4,SIOT            SIOT ADDRESSING.                      10960000
         USING INDMSIOT,R4                                              10980000
         MVC   SCT+SCTGOTTR-INSMSCT(MVTHREE),EATEMP1  SAVE TTR OF O106  10990019
*                                      REF SIOT                   O106  11000019
         OC    SCT+SCTFSIOT-INSMSCT(MVFOUR),SCT+SCTFSIOT-INSMSCT       *11020002
                                   1ST SIOT PTR INITIALIZED?    YM01562 11024002
         BNZ   EAPGM8K       FIRST SIOT PTR INIT,CONTINUE...    YM00365 11028002
         MVC   SCT+SCTFSIOT-INSMSCT(MVTHREE),SIOTDSKA MOVE SIOT YM01562 11032002
*              SVA TO FIRST SIOT PTR IN SCT.                    YM01562 11036002
EAPGM8K  DS    0H                                               YM00365 11038002
         LA    R5,WAEXCPFX   LOAD ADDRESS OF EXEC PREFIX.       YM01562 11040002
         USING TEXT,R5                                          YM01562 11044002
         TM    STREINDC,ETXNODD    ANY DD CARDS IN STEP ?       YM01562 11048002
         DROP  R5                                               YM01562 11052002
         BZ    EAPGM8J       YES,DON'T ZERO NEXT SIOT PTR...    YM01586 11056002
         XC    SCTPSIOT(MVFOUR),SCTPSIOT    ZERO NEXT SIOT PTR, YM01562 11060002
*              BECAUSE READ ROUTINE INITIALIZED IT WITH TNEXT+4 YM01562 11064002
EAPGM8J  DS    0H                                               YM01562 11068002
         OI    SCT+SCTSTYPE-INSMSCT,GOSTEP  SCTGOSTP IN SCT ON    O106  11080019
         SR    R2,R2                                                    11100000
         LA    R3,1                                                     11120000
         LH    R2,SCT+SCTLALOC-INSMSCT                           Y02668 11140002
         AR    R2,R3              *    ADD ONE TO SCTLALOC.             11160000
         STH   R2,SCT+SCTLALOC-INSMSCT                           Y02668 11180002
         LH    R2,DDINTNO         *                              Y02668 11210002
         AR    R2,R3              *    ADD ONE TO DDINTNO.       Y02668 11240002
         STH   R2,DDINTNO         *                              Y02668 11270002
         STH   R2,SCTDDINO        SET DD INTERNAL NBR IN SIOT.   Y02668 11300002
         MVC   SCTDDNAM(8),EAPGMSD MOVE 'PGM=*.DD' TO DDNAME FIELD.     11340000
         NI    SCTSBYT2,SCTUNLBD+SCTRECVD                        A32757 11352020
         NI    SCTSBYT1,SCTDUMMY                                 A32757 11356020
*                                                                       11360000
*   WRITE AND ASSIGN SIOT   UPDATE TNEXT.                               11380000
*                                                                       11400000
         LA    R5,4               SET R5 FOR WRITE & ASSIGN.            11420000
         BAL   RE,EARWA           LINK TO QMGR W&A INTERFACE.           11440000
*                                                                       11460000
*   GET NEXT KEYWORD.                                                   11480000
*                                                                       11500000
         BALR  RE,RF              *    MAKE GET ROUTINE STEP THRU TO    11520000
         BALR  RE,RF              *         END OF PGM=*. PARAMETERS.   11540000
EAPGM9   DS    0H                                                       11560000
         BALR  RE,RF              LINK TO GET KEY.                      11580000
EAPGM10  DS    0H                                                       11600000
         SPACE                                                          11620000
         MVI   MSGSEC,EAR54       - ERROR - PGM FIELD FORMAT ERROR.     11640000
         B     EACLEANP           GO TO FAIL JOB & PUT OUTMSG.          11660000
         SPACE                                                          11680000
EAPGM11  DS    0H                                                   438 11700000
         MVI   MSGKEY,EXECK       SET SECONDARY ERROR MSG TO EXEC.  438 11720000
         B     EAPGM10            GO SET FORMAT ERROR.              438 11740000
         SPACE 2                                                        11760000
EAMVC2   MVC   EAREGSV+4(1),EASNSVL    MOVE NAME OF STEP TO DICT BUILD. 11780000
         EJECT                                                          11783016
         EJECT                                                          11813016
*********************************************************************** 11820000
*                                                                     * 11840000
*              ACCT/ACCT. KEYWORD ROUTINE.                            * 11860000
*                                                                     * 11880000
*********************************************************************** 11900000
EAACTP   DS    0H                 (ACCT.) KEYWORD.                      11920000
         SPACE                                                          11940000
         BAL   RE,EAORIDE         LINK TO UPDATE O'RIDE TABLES AND SET  11960000
*                                      ACT O'RIDE FLAG IN TABLE.        11980000
         BALR  RE,RF              LINK TO GET 1ST ACCT FIELD.           12000000
         L     R6,TNUM            R6 (CNTR2) MAINTAINS TOTAL LENGTH 220 12020000
         BCTR  R6,0               EACH ACCNT FIELD + NBR ACCT FLDS. 220 12040000
         B     EAACT2             GO TO MOVE ACTNG INFO TO ACT.         12060000
         SPACE 2                                                        12080000
EAACTE   DS    0H                 (ACCT) KEYWORD.                       12100000
         SPACE                                                          12120000
         L     R6,TNUM            R6 (CNTR2) = TOTAL LENG ACT FLD.  220 12140000
         TM    SWE,PRCV           IS PRIME PROC BUFFER SW ON.           12160000
         BZ    EAACT1             NO.  GO TO CHECK ACCT ORIDE SW.       12180000
         OI    SWF,ORACTOR        YES.  PUT ON ACT O'RIDE SW.           12200000
         OI    EASW2,EAEACCTE          SET ACCT=  SWITCH         A22206 12210018
         B     EAACT2             GO TO MOVE ACTNG INFO TO ACT.         12220000
         SPACE                                                          12240000
EAACT1   DS    0H                                                       12260000
         TM    SWF,ORACTOR        IS ACT O'RIDE FLAG ON.                12280000
         BZ    EAACT2             NO.  GO TO MOVE ACTNG INFO TO ACT.    12300000
         OI    EASW1,EAACTORF     SET FLAG TO INDICATE O'RIDE FLAG ON.  12320000
*                                                                       12340000
*   ACCOUNTING INFORMATION TO BE MOVED TO ACT.                          12360000
*                                                                       12380000
EAACT2   DS    0H                                                       12400000
         LA    R1,ACT             STEP ACT ADDRESS.                     12420000
         XC    0(176,R1),0(R1)    CLEAR ACT.                            12440000
         LA    R7,ACTJNFLD-ACTDSKAD+1(R1)   ACT FLD ADDRESS TO R7.      12460000
         SR    R5,R5         R5 = CNTR1. - NBR ACTNG FIELDS.            12480000
EAACT3   DS    0H                                                       12500000
         AR    R6,R2              INCREMENT CNTR 2 BY ACTNG FLD LEN.    12520000
         LA    R0,144                                                   12540000
         CLR   R6,R0              DOES ACCTNG INFO EXCEED 144 BYTES.    12560000
         BH    EAACT4A            YES. GO TO SET ERROR MESSAGE.         12580000
         SPACE                                                          12600000
         LTR   R2,R2              IS THIS A NULL PARAMETER.             12620000
         BZ    EAACT4             YES. GO TO CHECK FOR LAST PARAM.      12640000
         SPACE                                                          12660000
         EX    R2,EAACTMV1        MOVE ACCOUNTING INFO TO ACT.          12680000
         SPACE                                                          12700000
EAACT4   DS    0H                                                   220 12720000
         LA    R5,1(R5,0)         ADD ONE TO CNTR /.                    12740000
         LA    R7,1(R7,R2)        POINT TO NEXT ACT STORE POSITION.     12760000
         CLC   TNUM(4),TCT        ACCTNG FIELDS COMPLETED.              12780000
         BE    EAACT5             YES. GO TO SET NBR ACT FIELDS.        12800000
         SPACE                                                          12820000
         BALR  RE,RF              GET NEXT ACCNTG INFO.                 12840000
         SPACE                                                          12860000
         B     EAACT3             GO TO CHECK NEXT ACCTNG INFO.         12880000
         SPACE                                                          12900000
*   ERROR - ACTNG FIELD EXCEEDS 144 CHARACTERS.                         12920000
EAACT4A  DS    0H                                                       12940000
         MVI   MSGSEC,EAR45       MOVE MSG NBR TO IWA.                  12960000
         B     EAERRTN            GO TO ERROR RETURN.                   12980000
         SPACE                                                          13000000
EAACT5   DS    0H                                                       13020000
         STC   R5,ACTJNFLD-ACTDSKAD(R1)     STORE NBR ACT FLDS.         13040000
         SPACE                                                          13060000
         TM    EASW1,EAACTORF     WAS THIS AN OVERRIDE ACT.             13080000
         BO    EAACTXIT           YES. GO TO GET NEXT KEY.              13100000
*                                                                       13120000
*   PUT ACT IN Q.  WRITE AND ASSIGN.                                    13140000
*                                                                       13160000
         LA    R7,QPARM           QMANAGER PARAMETER AREA.              13180000
         USING IOPARAMS,R7                                              13200000
         L     R6,QMPCL           QMPCA ADDRESS TO R6.                  13220000
         ST    R1,0(R6)           ACT ADDRESS TO QMPCA.                 13240000
         MVC   4(4,R6),TNEXT      TTR TO QMPEX.                         13260000
         MVC   0(3,R1),TNEXT      TTR TO ACT.                           13280000
         MVI   3(R1),ACTID        SET ACT ID.                           13300000
         SPACE                                                          13340000
         L     RF,EAVHQ           IEFVHQ ADDRESS TO R15.                13360000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE.           13380000
         SPACE                                                          13400000
         L     RF,EAGETKEP        RESTORE GET KEY/POS ADDRESS.          13420000
         SPACE                                                          13440000
         TM    EASW1,EAPGMSDF+EAPGMEF  IS THIS PGM= OR PGM=*.     17583 13460017
         BZ    EAACT6             NO. GO TO CHECK FOR ACT./ACT.         13480000
         MVC   SCT+SCTAFACT-INSMSCT(MVFOUR),TNEXT  YES, MOVE ACT  O106  13490019
*                                      TTR TO SCT                 O106  13500019
         B     EAACT8             GO TO UPDATE TNEXT.                   13520000
EAACT6   DS    0H                                                       13540000
         CLI   MSGKEY,ACCTPEK     IS THIS AN ACT. KEY.                  13560000
         BNE   EAACT7             NO (ACT) GO TO MOVE ACT TTR TO IWA.   13580000
         LA    R4,EAORTABL        O'RIDE TABLE ADDRESSING.              13600000
         USING ORTABLE,R4                                               13620000
         MVC   ORACTTTR(3),TNEXT  (ACT.)-MOVE ACT TTR TO O'RIDE TABLE.  13640000
         B     EAACT8             GO TO UPDATE TNEXT.                   13660000
         SPACE                                                          13680000
EAACT7   DS    0H                                                       13700000
         MVC   TACT(4),TNEXT      (ACT) MOVE ACT TTR TO TACT OF IWA.    13720000
EAACT8   DS    0H                                                       13740000
         MVC   TNEXT(4),0(R6)     UPDATE TNEXT.                         13760000
EAACTXIT DS    0H                                                       13780000
         BALR  RE,RF              GO GET NEXT KEY.                      13800000
         SPACE 2                                                        13820000
EAACTMV1 MVC   0(1,R7),0(R3)      ACTNG FIELD & LENGTH TO ACT. EXECUTED 13840000
         EJECT                                                          13860000
*********************************************************************** 13880000
*                                                                     * 13900000
*              PARM/PARM. KEYWORD ROUTINE.                            * 13920000
*                                                                     * 13940000
*********************************************************************** 13960000
         SPACE                                                          13980000
EAPARMP  DS    0H                 (PARM.) KEYWORD.                      14000000
         SPACE                                                          14020000
         BAL   RE,EAORIDE         LINK TO UPDATE O'RIDE TABLES AND SET  14040000
*                                      PARM O'RIDE FLAG IN TABLE.       14060000
         BALR  RE,RF              LINK TO GET PARM FIELD.               14080000
         SPACE                                                          14100000
         MVC   EAORTABL+ORPARM-ORTABLE(3),TNEXT  SET UP TTR FOR PARM X  14120017
         LA    R5,EAORTABL+ORPARMSZ-ORTABLE PARM SIZE ADDR TO R5.       14140000
         B     EAPARM2A           GO TO ENTER PARM IN O'RIDE TABLE.     14160000
         SPACE 2                                                        14180000
EAPARME  DS    0H                 (PARM) KEYWORD.                       14200000
         SPACE                                                          14220000
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER.               14240000
         BO    EAPARM1            YES. GO TO PUT PARM O'RIDE ON IN IWA. 14260000
         SPACE                                                          14280000
         TM    SWF,ORPARMBL       IS PARM BLOCK SET.                    14300000
         BZ    EAPARM2            NO.  GO TO ENTER PARM IN SCT.         14320000
         B     EAPARM4            YES. GO TO GET NEXT KEY.              14340000
         SPACE                                                          14360000
EAPARM1  DS    0H                                                       14380000
         OI    SWF,ORPARMOR       TURN ON PARM O'RIDE FLAG.             14400000
EAPARM2  DS    0H                                                       14420000
         MVC   SCT+SCTXBTTR-INSMSCT(MVTHREE),TNEXT  SET UP TTR FOR O106 14430019
*                                      PARM EXTENSION             O106  14440019
         LA    R5,SCT+SCTSEXEC-INSMSCT ADDR OF PARM SIZE SLOT IN  O106  14450019
*                                      SCT                        O106  14460019
EAPARM2A DS    0H                                                       14480000
         SR    R6,R6              SET R6 FOR LENGTH OF PARM FIELD.      14500000
         XC    EAAUXWK(176),EAAUXWK     CLEAR PARM TABLE           AACA 14508017
         MVC   EAAUXWK(3),TNEXT         TTR TO PARM TABLE          AACA 14516017
         MVI   EAAUXWK+3,EAPXID   MOVE IN PARM EXT ID              AACA 14524017
         LA    R7,EAAUXWK+4                                        AACA 14532017
         NI    EASW1,FF-EAPARMF1  TURN OFF POSIBLE PREVIOUS BYPASS SW.  14540000
EAPARM2B DS    0H                                                       14560000
         AR    R6,R2              R6 = LENGTH OF PARM FIELD.            14580000
         LA    R0,100             MAX LENGTH=100                   AACA 14600017
         CLR   R6,R0              DOES PARM FIELD EXCEED MAXIMUM.       14620000
         BH    EAPARM3            YES. GO TO SET ERROR MESSAGE.         14640000
         SPACE                                                          14660000
         TM    EASW1,EAPARMF1     BYPASS STORE SWITCH ON.               14680000
         BO    EAPARM2D           YES. GO TO CHECK LENGTH & GET KEY.    14700000
         SPACE                                                          14720000
         LTR   R2,R2              NULL PARAMETER.                       14740000
         BZ    EAPARM2C           YES. GO TO CHECK OF FIELD.            14760000
         SPACE                                                          14780000
         BCTR  R2,0                                                     14800000
         EX    R2,EAPARMV1        MOVE PARM FIELD TO TABLE.             14820000
         LA    R7,1(R2,R7)         POINT TO NEXT STORAGE LOC      RE511 14830014
         SPACE                                                          14840000
EAPARM2C DS    0H                                                       14860000
         CLC   TNUM(4),TCT        END OF PARM FIELD.                    14880000
         BE    EAPARM2E           YES. GO TO MOVE IN PARM FIELD LENGTH. 14900000
         SPACE                                                          14920000
         MVI   0(R7),C','         RESTORE COMMA.                        14960000
         LA    R7,1(0,R7)         POINT TO NEXT STORE LOCATION.         14980000
         SPACE                                                          15000000
EAPARM2D DS    0H                                                       15020000
         LA    R6,1(0,R6)         INDEX R6 FOR COMMA COUNT.             15040000
         SPACE                                                          15060000
         BALR  RE,RF              LINK TO GET NEXT PARAM/KEY.           15080000
         SPACE                                                          15100000
         B     EAPARM2B           GO TO ERROR CHECK & STORE PARM FIELD. 15120000
         SPACE                                                          15140000
EAPARM2E DS    0H                                                       15160000
         ST    R6,EATEMP1         STORE PARM FIELD LENGTH INTO SCT.     15180000
         MVC   0(2,R5),EATEMP1+2       OR O'RIDE TABLE.                 15200000
         LA    R7,QPARM                                            AACA 15201017
         USING IOPARAMS,R7                                         AACA 15202017
         L     R6,QMPCL                 REMOTE LIST ADDRESS        AACA 15203017
         LA    R5,EAAUXWK               PARM TABLE ADDRESS         AACA 15204017
         ST    R5,0(R6)                 PARM ADDR TO REMOTE LIST   AACA 15205017
         MVC   4(4,R6),TNEXT            TTR TO REMOTE LIST         AACA 15206017
         SPACE                                                          15207017
         L     R5,EAVHQ                 LINK TO IEFVHQ             AACA 15208017
         BALR  RE,R5                                               AACA 15209017
         SPACE                                                          15210017
         MVC   TNEXT(4),0(R6)           REPLACE TNEXT              AACA 15211017
         BALR  RE,RF              GO GET NEXT KEY.                      15220000
         SPACE                                                          15240000
EAPARM3  DS    0H                                                       15260000
         MVI   MSGSEC,EAR56       PARM FIELD FORMAT ERROR.              15280000
         B     EACLEANP                                                 15300000
         SPACE                                                          15320000
EAPARM4  DS    0H                                                       15340000
         SR    R6,R6              SET R6 FOR LENGTH OF PARM FIELD.      15360000
         OI    EASW1,EAPARMF1     SET PARM STORE BYPASS SWITCH.         15380000
         B     EAPARM2B           GO TO STEP THRU PARM FIELDS.          15400000
         SPACE 2                                                        15420000
EAPARMV1 MVC   0(1,R7),1(R3)      PARM FIELD TO SCT/O'RIDE (EXECUTED).  15440000
         EJECT                                                          15460000
*********************************************************************** 15480000
*                                                                     * 15500000
*              TIME./TIME KEYWORD ROUTINE.                            * 15520000
*                                                                     * 15540000
*********************************************************************** 15560000
         SPACE                                                          15580000
EATIMEP  DS    0H                 (TIME.) KEYWORD.                      15600000
         SPACE                                                          15620000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE      15640000
*                                      TABLE & TURN ON TIME O'RIDE FLAG 15660000
         BALR  RE,RF              LINK TO GET TIME FIELD.               15680000
         B     EATIME2            GO TO CONVERT TIME.                   15700000
         SPACE 2                                                        15720000
EATIMEE  DS    0H                 (TIME) KEYWORD.                       15740000
         SPACE                                                          15760000
         TM    SWE,PRCV           PRIME PROC BUFFER.                    15780000
         BZ    EATIME1            NO. GO TO CHECK FOR TIME 0.           15800000
         OI    SWF,ORTIMEOR       YES. PUT ON TIME O'RIDE FLAG IN IWA.  15820000
         B     EATIME2            GO TO CONVERT TIME.                   15840000
EATIME1  DS    0H                                                       15860000
         TM    SWF,ORTIME0        TIME ZERO ON.                         15880000
         BO    EATIME4A           YES. GO TO GET NEXT KEY.              15900000
*  FALL THROUGH TO CONVERT TIME.                                YM01546 15940002
*                                                                       15950001
EATIME2  DS    0H                                                       15960000
*                                                                       16032001
*   CONVERT (MINS,SECONDS) TO 100THS OF SECONDS.                        16035001
         XC    EATEMP1(8),EATEMP1 ZERO TEMPORARY SLOTS TO SAVE TIMES.   16040000
         SPACE                                                          16060000
         BALR  RE,R9              CONVERT MINS TO BINARY,MVC TO TEMP1.  16080000
         SPACE                                                          16100000
         CLC   TNUM(4),TCT        ARE THERE SECONDS TO CONVERT.         16120000
         BE    EATIME3            NO. GO TO STORE MINUTES.              16140000
         SPACE                                                          16160000
         BALR  RE,RF              GET SECONDS.                          16180000
         SPACE                                                          16200000
         BALR  RE,R9              CONVERT SECS TO BINARY, MVC TO TEMP2. 16220000
         SPACE                                                          16240000
         L     R6,EATEMP2         *                                     16260000
         MH    R6,EA100           *    CONVERT SECS TO 100THS SECS.     16280000
         ST    R6,EATEMP2         *                                     16300000
         SPACE                                                          16320000
EATIME3  DS    0H                                                       16340000
         L     R6,EATEMP1         CONVERT MINUTES TO                    16360000
         MH    R6,EA6000               100THS SECONDS.                  16380000
         SPACE                                                          16400000
         AL    R6,EATEMP2         ADD SECONDS TO MINUTES.               16420000
         SPACE                                                          16440000
         ST    R6,EATEMP1         SAVE CONVERTED TIME.                  16460000
*                                                                       16480000
*   CHECK FOR (TIME/TIME.).                                             16500000
*                                                                       16520000
EATIME3A EQU   *                       CHECK FOR (TIME/TIME.).  A49826  16526001
*                                                               A49826  16532001
         CLI   MSGKEY,TIMEEEK     IS THIS A (TIME) KEY.                 16540000
         BNE   EATIME4            NO. (TIME.) GO TO MOVE TIME TO O'RIDE 16560000
*                                                                       16580000
*   (TIME) KEY - PUT TIME IN SCT.                                       16600000
*                                                                       16620000
         MVC   SCT+SCTSTIME-INSMSCT(MVTHREE),EATEMP1+DISPLONE     O106  16630019
*                                      MOVE TIME TO SCT           O106  16640019
         B     EATIME5            GO TO GET NEXT KEY.                   16660000
*                                                                       16680000
*   (TIME.) - PUT TIME IN O'RIDE TABLE.                                 16700000
*                                                                       16720000
EATIME4  DS    0H                                                       16740000
         LA    R6,EAORTABL        O'RIDE PABLE ADDRESS TO R6.           16760000
         USING ORTABLE,R6                                               16780000
         MVC   ORMAXTIM(3),EATEMP1+1   MOVE TIME TO O'RIDE TABLE.       16800000
         DROP  R6                                                       16820000
         B     EATIME5            GO TO GET NEXT KEY.                   16840000
*                                                                       16860000
*   TIME ZERO - LINK TO STEP THRU MINS.                                 16880000
*                                                                       16900000
EATIME4A DS    0H                                                       16920000
         BALR  RE,RF              LINK TO STEP THRU MINS.               16940000
*                                                                       16960000
*   TIME EXIT - GET NEXT KEYWORD.                                       16980000
*                                                                       17000000
EATIME5  DS    0H                                                       17020000
         BALR  RE,RF              LINK TO GET NEXT KEY.                 17040000
*                                                                       17060000
*   ERROR - GET SHOULD NOT RETURN HERE.  FORMAT ERROR.                  17080000
*                                                                       17100000
         MVI   MSGSEC,EAR57       TIME FIELD FORMAT ERROR.              17120000
         B     EACLEANP           GO TO CLEANUP.                        17140000
         EJECT                                                          17160000
*********************************************************************** 17180000
*                                                                     * 17200000
*              COND/COND. KEYWORD ROUTINE.                            * 17220000
*                                                                     * 17240000
*********************************************************************** 17260000
         SPACE                                                          17280000
EACONDP  DS    0H                 (COND.) KEYWORD.                      17300000
         SPACE                                                          17320000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE      17340000
*                                      TABLE & TURN ON COND O'RIDE FLAG 17360000
         BALR  RE,RF              LINK TO GET COND FIELD.               17380000
         B     EACOND2            GO TO SET UP PTR TO O'RIDE TABLE.     17400000
         SPACE 2                                                        17420000
EACONDE  DS    0H                 (COND) KEYWORD.                       17440000
*                                                                       17460000
*   CHECK FOR PRIME PROC BUFFER.                                        17480000
*                                                                       17500000
         TM    SWE,PRCV           IS PRCV ON.                           17520000
         BO    EACOND1            YES. GO TO SET COND O'RIDE SW IN IWA. 17540000
*                                                                       17560000
*   NOT PRIME PROC BUFFER - CHECK FOR COND O'RIDE SW ON IN IWA.         17580000
*                                                                       17600000
         TM    SWF,ORCONDOR       IS ORCONDOR ON.                       17620000
         BO    EACOND4            YES. GO TO SET COND STORE BYPASS SW.  17640000
*                                                                       17660000
*   NOT PRIME PROC BUFFER - NOT COND O'RIDE - SET TO STORE INTO SCT.    17680000
*        IF PRIME PROC BUFFER - SET TO STORE INTO DUMMY SCT.            17700000
*                                                                       17720000
EACOND0  DS    0H                                                       17740000
         LA    R7,SCT+SCTSDPCD-INSMSCT POINT R7 TO SCT DEPENDENCY CODE  17760000
*                                          STORE LOCATION.              17780000
         B     EACOND3            GO TO PROCESS COND FIELDS.            17800000
*                                                                       17820000
*                                                                       17840000
*   COND WITH PRCV ON - SET COND O'RIDE SWITCH IN IWA.                  17860000
*                                                                       17880000
EACOND1  DS    0H                                                       17900000
         OI    SWF,ORCONDOR       SET COND O'RIDE SW IN IWA.            17920000
         B     EACOND0            GO TO SET R7 = DUMMY SCT ADDRESS.     17940000
*                                                                       17960000
*   SET R7 TO STORE COND PARAMETERS INTO O'RIDE TABLE.                  17980000
*                                                                       18000000
EACOND2  DS    0H                                                       18020000
         LA    R7,EAORTABL+ORCONDCD-ORTABLE R7=STORE ADDR IN O'RIDE TAB 18040000
*                                                                       18060000
*   CLEAR OLD COND FIELDS IN SCT (O'RIDE COND FIELDS ALREADY CLEARED)   18080000
*   TURN OFF EACONORF - BYPASS STORE FLAG.                              18100000
*                                                                       18120000
EACOND3  DS    0H                                                       18140000
         XC    0(48,R7),0(R7)     CLEAR OLD SCT COND FIELDS.            18160000
         NI    EASW1,FF-EACONORF  TURN OFF BYPASS STORE FLAG.           18180000
         SPACE                                                          18200000
         B     EACOND5            GO TO PROCESS COND FIELDS.            18220000
*                                                                       18240000
*   COND - PRCV OFF - COND O'RIDE SW ON - SET STORE BYPASS SWITCH.      18260000
*                                                                       18280000
EACOND4  DS    0H                                                       18300000
         OI    EASW1,EACONORF     SET BYPASS STORE SWITCH.              18320000
*                                                                       18340000
*   PROCESS COND PARAMETERS - EVEN,ONLY,(CODE,OPERATOR,STEPNAME.   HW16 18350016
*                                                       PROCSTEP)  HW16 18360016
*                                                                       18380000
EACOND5  DS    0H                                                       18400000
         XC    EATEMP1(6),EATEMP1 CLEAR TEMP SAVE FOR DEPENDENCIES.     18420000
         MVI   MSGSEC,EAR40       SET ERROR CODE IF EXIT THRU GET       18440000
*                                      OCCURS BEFORE COND IS COMPLETE.  18460000
         LTR   R2,R2               IS IT NULL PARAMETER            3974 18460816
         BNZ   EACOND5A            NO, OK                          3974 18461616
*                                  IF THERE IS A NULL PARAMETER,   3974 18462416
*                                    THE NUMBER OF SUCH PARAMETERS 3974 18463216
*                                    MUST BE ZERO (COND.STEP=BLANK)3974 18464016
*                                    OR ONE (COND=BLANK)           3974 18464816
         CLI   TNUM1+3,X'01'       IS THE NUMBER OF SUBPARAMETERS  3974 18465616
*                                    ZERO OR ONE                   3974 18466416
         BH    EAERRTN             NO, COND FIELD FORMAT ERROR     3974 18467216
         MVI   MSGSEC,X'00'        CLEAR ERROR CODE                3974 18468016
         BALR  RE,RF               GO GET NEXT KEYWORD             3974 18468816
EACOND5A EQU   *                                                   3974 18469616
*                                                                  HW16 18470416
*   CHECK EVEN OR ONLY PARAMETERS, SET INDICATORS IN SCT           HW16 18471216
*                                                                  HW16 18472016
         CLC   0(5,R3),EAEVEN      TEST FOR EVEN PARAMETER         HW16 18472816
         BE    EACOND9B            YES, GO SET SCT EVEN BIT        HW16 18473616
*                                                                  HW16 18474416
         CLC   0(5,R3),EAONLY      TEST FOR ONLY PARAMETER         HW16 18475216
         BE    EACOND9C            YES, GO SET SCT ONLY BIT        HW16 18476016
*                                                                  HW16 18476816
*   PROCESS (CODE,OPERATOR,STEPNAME.PROCSTEP) PARAMETER            HW16 18477616
*                                                                  HW16 18478416
*                                                                       18480000
*   CODE - CVB, CHECK FOR 4095 MAX AND MOVE TO EATEMP1(2).              18500000
*                                                                       18520000
         BALR  RE,R9              LINK TO TEST & STORE CODE.            18540000
*                                                                       18560000
*   CHECK FOR PROPER FORMAT FOR CONDITION FIELDS.                       18580000
*                                                                       18600000
         BCTR  R3,0               POINT TO SUBPARAMETER INDICATOR BYTE. 18620000
         TM    0(R3),X'80'        IS HIGH ORDER BIT ON.             438 18640000
         BZ    EAERRTN            NO.- COND FIELD FORMAT ERROR.         18660000
*                                                                       18680000
*   GET OPERATOR.                                                       18700000
*                                                                       18720000
         BALR  RE,RF              LINK TO GET OPERATOR.                 18740000
         LTR   R2,R2              IS THERE AN OPERATOR.                 18760000
         BZ    EAERRTN            NO.  ERROR.                           18780000
*                                                                       18800000
*   OPERATOR - CHECK OPERATOR SPELLING AND MOVE HEX BIT PATTERN         18820000
*        TO EATEMP1+2(1).                                               18840000
*                                                                       18860000
         BALR  RE,R9              LINK TO TEST & STORE OPERATOR.        18880000
*                                                                       18900000
*   CHECK FOR STEPNAME.                                                 18920000
*                                                                       18940000
         CLC   TNUM1(4),TCT1      IS THERE A STEPNAME AFTER OPERATOR.   18960000
         BE    EACOND17           NO. GO TO PUT IN ZERO TTR.            18980000
*                                                                       19000000
*   GET STEPNAME.                                                       19020000
*                                                                       19040000
         BALR  RE,RF              LINK TO GET STEPNAME.                 19060000
*                                                                       19080000
*                                                                       19100000
*   BLANK 8 CHAR SLOT IN WORK AREA & SAVE STEPNAME (THRU T&S) FOR       19120000
*        FUTURE REFERENCE.                                              19140000
*                                                                       19160000
         MVC   EAREGSV(8),EABLANK BLANK WORK SPACE.                     19180000
         BALR  RE,R9              LINK TO MOVE STEPNAME TO EAREGSV.     19200000
         SPACE                                                          19220000
*                                                                       19240000
*   CHECK FOR STEPNAME.PROCSTEP.                                        19260000
*                                                                       19280000
         CLC   TNUM1(4),TCT1      DOES PROCSTEP FOLLOW STEPNAME.        19300000
         BE    EACOND7            NO. GO TO CHECK PROCEDURE.            19320000
*                                                                       19340000
         OI    EASW1,EACNDF1      INDICATE PROCSTEP FOLLOWS STEP YM4022 19390001
*                                                                YM4022 19440001
         LA    R0,2               SET UP NBR OF ARGUMENTS FOR    YM4022 19450001
*                                 SEARCH.                        YM4022 19460001
*     SET UP NBR OF ARGUMENTS, INDICATE SEARCH FOR SCT AND       YM4022 19470001
*        LOAD R4 WITH ADDRESS OF SEARCH ROUTINE.                        19480000
*                                                                       19500000
EACOND6  DS    0H                                                       19520000
         LR    R1,R3              LENGTH PTR TO R1.                     19540000
         BCTR  R1,0               POINT BYTE BEFORE LENGTH.             19560000
         STC   R0,0(R1)           SET NBR OF PARAMETERS.                19580000
         OI    SRCHSW1,SRCHF2     INDICATE SCT SEARCH.                  19600000
         L     R4,EASEARCH        SEARCH ADDRESS TO R4.                 19620000
         B     EACOND9            GO TO CHECK BYPASS.                   19640000
*                                                                       19660000
*   NO PROCSTEP - CHECK FOR PRCV ON.                                    19680000
*                                                                       19700000
EACOND7  DS    0H                                                       19720000
         CLI   MSGKEY,CONDPEK     IS THIS A (COND.).                    19740000
         BE    EACOND8            YES. GO TO SET QUALIFYING INDICATOR.  19760000
         CLC   EAREGSV(8),EASNSV  IS STEPNAME IN COND FIELD       M1726 19765020
*                                 SAME AS NAME OF THIS STEP       M1726 19770020
         BE    EAERRTN            YES,FORMAT ERROR IN COND FIELD  M1726 19775020
         SPACE                                                          19780000
         LA    R0,1               SET NBR PARAMETERS = 1.               19800000
         B     EACOND6            GO TO SET UP SEARCH PARAMS.           19820000
*                                                                       19840000
*   STEPNAME ONLY - PRCV ON - INDICATE PROCEDURE STEPNAME IS TO BE      19860000
*        USED TO QUALIFY REFER BACK.                                    19880000
*                                                                       19900000
EACOND8  DS    0H                                                       19920000
         OI    EASW1,EACNDF2      SET QUALIFY INDICATOR.                19940000
*   FALL THRU FOR NEXT TWO TESTS - TAKE BRANCH TO EACOND10 IF THE       19960000
*        BYPASS STORE SWITCH IS NOT ON.                                 19980000
         SPACE                                                          20000000
*                                                                       20020000
*   CHECK FOR BYPASS STORE SWITCH.                                      20040000
*                                                                       20060000
EACOND9  DS    0H                                                       20080000
         TM    EASW1,EACONORF     IS BYPASS SWITCH ON.                  20100000
         BO    EACOND15           YES. GO TO GET NEXT KEY.              20120000
*                                                                       20140000
*   CHECK FOR (COND.) KEY - SEARCH DICT IF NOT AND MOVE SCT TTR + CODE  20160000
*        AND OPERATOR TO SCT. (OR DUMMY SCT).                           20180000
*                                                                       20200000
         CLI   MSGKEY,CONDPEK     IS THIS A (COND.).                    20220000
         BE    EACOND10           YES. GO TO CHECK QUALIFYING STEPNAMES 20240000
         SPACE                                                          20260000
         BALR  RE,R4              LINK TO SEARCH FOR SCT TTR.           20280000
         SPACE                                                          20300000
         MVC   EATEMP1+3(3),2(R1) MOVE SCT TTR TO TEMP SAVE.            20320000
*                                                                       20340000
*   MOVE CODE, OPERATOR & TTR TO SCT.                                   20360000
*                                                                       20380000
EACOND9A DS    0H                                                       20382016
         MVC   0(6,R7),EATEMP1    MOVE CODE,OPERATOR & TTR TO SCT.      20384016
         LA    R7,6(R7)           INCREMENT SCT STORE POINTER.          20386016
         B     EACOND15           GO TO CYCLE THRU AGAIN.               20388016
EACOND9B DS    0H                                                  HW16 20390016
         OI    EATEMP1,SCTEVEN     SET EVEN INDICATOR IN EATEMP1   HW16 20392016
         B     EACOND9D            CONTINUE                        HW16 20394016
EACOND9C DS    0H                                                  HW16 20396016
         OI    EATEMP1,SCTONLY     SET ONLY INDICATOR IN EATEMP1   HW16 20398016
EACOND9D DS    0H                                                  HW16 20400016
         CLI   MSGKEY,CONDPEK      O'RIDE IN PROGRESS?             HW16 20402016
         BE    EACOND9E            YES, STORE INTO O'RIDE TABLE    HW16 20404016
*                                                                  HW16 20406016
*   STORE EATEMP1 IN SCT (EIGHTH COND SLOT) - EVEN OR ONLY         HW16 20408016
*                                                                  HW16 20410016
         TM    EASW1,EACONORF      TEST BYPASS STORE SWITCH        HW16 20412016
         BO    EACOND15            IF ON, GET NEXT PARAM/KEY       HW16 20414016
*                                  IF OFF, PROCEED                 HW16 20416016
         OC    SCT+SCTABCND-INSMSCT(OC6),SCT+SCTABCND-INSMSCT     O106  20417019
*                                      IF SLOT IS NON ZERO        O106  20418019
*              EITHER TOO MANY COND OR MULTIPLE EVEN'S/ONLY'S      HW16 20420016
         BC    7,EAERRTN           GO TO ERROR ROUTINE             HW16 20422016
         OC    SCT+SCTABCND-INSMSCT(OC6),EATEMP1                  O106  20423019
*                                      EVEN OR ONLY INTO SLOT     O106  20424019
         B     EACOND15            GET NEXT PARAMETER / KEY        HW16 20426016
EACOND9E DS    0H                                                  HW16 20428016
*                                                                  HW16 20430016
*   STORE EATEMP1 IN O'RIDE TABLE (EIGHTH COND SLOT) - EVEN OR ONLYHW16 20432016
*                                                                  HW16 20434016
         OC    EAORTABL+ORCONDCD-ORTABLE+84(12),EAORTABL+ORCONDCD-ORTABX20436016
               LE+84               IF THIS FIELD ALREADY NON-ZERO, HW16 20438016
*              EITHER TOO MANY COND OR MULTIPLE EVEN'S/ONLY'S      HW16 20440016
         BC    7,EAERRTN           GO TO ERROR ROUTINE             HW16 20442016
         OC    EAORTABL+ORCONDCD-ORTABLE+84(1),EATEMP1      PUT    HW16 20444016
*                                  EVEN OR ONLY INTO O'RIDE TABLE  HW16 20446016
         B     EACOND15            GET NEXT PARAMETER / KEY        HW16 20448016
*                                                                       20480000
*   CHECK FOR REFERENCES WITHIN CALLING PROCEDURE. - IF NOT SEARCH DICT 20500000
*                                                                       20520000
EACOND10 DS    0H                                                       20540000
         CLC   EAREGSV(8),EASNSV  IS STEPNAME IN COND FIELD SAME AS     20560000
*                                      THE NAME OF THIS STEP.           20580000
         BE    EACOND11           YES. GO TO GET PROCSTEP.              20600000
         SPACE                                                          20620000
         TM    EASW1,EACNDF2      IS STEPNAME TO BE QUALIFIED.          20640000
         BO    EACOND14           YES. GO TO QUALIFY SINGLE STEPNAME.   20660000
         SPACE                                                          20680000
         BALR  RE,R4              LINK TO SEARCH DICTIONARY.            20700000
         SPACE                                                          20720000
         MVC   EATEMP1+3(3),2(R1) MOVE SCT TTR TO TEMP SAVE.            20740000
*                                                                       20760000
*   MOVE CODE, OPERATOR & TTR TO O'RIDE TABLE.                          20780000
*                                                                       20800000
EACOND1A DS    0H                                                       20820000
         MVC   0(6,R7),EATEMP1    MOVE CODE,OPERATOR & TTR TO O'RIDE.   20840000
         B     EACOND13           GO TO INCREMENT O'RIDE PTR.           20860000
*                                                                       20880000
*   GET PROCSTEP AND WITHIN THIS PROCEDURE.                             20900000
*                                                                       20920000
EACOND11 DS    0H                                                       20940000
         TM    EASW1,EACNDF1      IS THE NAME OF THIS PROCEDURE THE     20960000
*                                      ONLY NAME IN COND FIELD.         20980000
         BZ    EACOND14            GO TO QUALIFY SINGLE NAME    YA02850 21000002
         SPACE                                                          21020000
         BALR  RE,RF              GET PROCSTEP.                         21040000
         NI    EASW1,FF-EACNDF1   TURN OFF EACNDF1.                     21060000
*                                                                       21080000
*   STORE PARAMETERS IN ORIDE TABLE.                                    21100000
*                                                                       21120000
EACOND12 DS    0H                                                       21140000
         MVC   11(1,R7),0(R3)     STORE LENGTH.                         21160000
         MVC   0(3,R7),EATEMP1    STORE CODE & OPERATOR.                21180000
         MVC   3(8,R7),1(R3)      STORE STEPNAME.                       21200000
         LA    RE,EAORTABL        START OF O'RIDE TABLE ADDR TO RE.     21220000
         MVC   ORSTEPL-ORTABLE(9,RE),EASNSVL  MOVE PROC STEPNAME TO TAB 21240000
*                                                                       21260000
*   INCREMENT O'RIDE STORE POINTER.                                     21280000
*                                                                       21300000
EACOND13 DS    0H                                                       21320000
         LA    R7,12(R7)          POINT R7 TO NEXT O'RIDE STORE.        21340000
         B     EACOND15           GO TO CYCLE THRU AGAIN.               21360000
*                                                                       21380000
*   SET HIGH ORDER BIT OF LENGTH BYTE TO INDICATE QUALIFYING CONDITONAL 21400000
*        STEPNAME.                                                      21420000
*                                                                       21440000
EACOND14 DS    0H                                                       21460000
         OI    0(R3),X'80'        SET HIGH ORDER BIT OF LENGTH.         21480000
         B     EACOND12           GO TO STORE INTO O'RIDE TABLE.        21500000
*                                                                       21520000
*   SET UP PARAMETERS TO GET NEXT COND OR NEXT KEY.                     21540000
*                                                                       21560000
EACOND15 DS    0H                                                       21580000
         TM    EASW1,EACNDF1      IS THERE A PROCSTEP.           YM4022 21590001
         BZ    EACOND16           NO GO TO CLEAR FLAGS           YM4022 21592001
         BALR  RE,RF              YES POINT TO PROCSTEP          YM4022 21594001
EACOND16 DS    0H                                                YM4022 21596001
         ST    RB,TPDTP           FORCE TEST & STORE TO RE-CYCLE.       21600000
         NI    EASW1,FF-EACNDF1-EACNDF2   TURN OFF HSKPNG FLAGS.        21700000
         MVI   MSGSEC,X'00'       CLEAR ERROR MSG SLOT.                 21720000
         BALR  RE,RF              GET NEXT KEY OR NEXT COND.            21740000
         B     EACOND5            COND - GO TO RE-CYCLE.                21760000
*                                                                       21780000
*   NO STEPNAME AFTER OPERATOR - INDICATE DEPENDENCY ON COMPLETION      21800000
*        CODES OF ALL PREVIOUS STEPS.                                   21820000
*                                                                       21840000
EACOND17 DS    0H                                                       21860000
         TM    EASW1,EACONORF     ARE WE BYPASSING STORE.               21880000
         BO    EACOND15           YES GO TO RE-CYCLE.                   21900000
         SPACE                                                          21920000
         CLI   MSGKEY,CONDPEK      IS THIS A (COND.) KEYWORD       HW16 21940016
         BE    EACOND1A           YES. GO TO MOVE CODE, OPERATOR &      21960016
*                                           ZERO TTR TO O'RIDE TABLE.   21980000
         B     EACOND9A           NOT PROC. GO TO MOVE CODE,OPERATOR &  22000000
*                                  ZERO TTR TO SCT                      22020002
         EJECT                                                          22021002
***********************************************************     YM00368 22022002
*                                                         *     YM00368 22023002
*              PERFORM./PERFORM KEYWORD ROUTINE           *     YM00368 22024002
*                                                         *     YM00368 22025002
***********************************************************     YM00368 22026002
*                                                         *     YM00368 22027002
*  THE EXEC PERFORM VALUE IS USED ONLY IF THE PERFORM     *     YM00368 22028002
*  KEYWORD WAS NOT SPECIFIED ON THE JOB STMT. IF SPECIFIED*     YM00368 22029002
*  THE JOB PERFORM VALUE (OR A DEFAULT IF THE JOB VALUE   *     YM00360 22030002
*  NULL OR INVALID) OVERRIDES EXEC PERFORM SPECIFICATIONS.*     YM00368 22031002
*                                                         *     YM00368 22032002
*  IF THE PERFORM KEYWORD WAS NOT SPECIFIED ON THE JOB    *     YM00368 22033002
*  STMT, IEFVJA OBTAINS A DEFAULT VALUE FOR USE BY IEFVEA *     YM00368 22034002
*  IN THE EVENT EXEC PERFORM VALUES WERE OMITTED OR       *     YM00368 22035002
*  INVALID.                                               *     YM00368 22036002
*                                                         *     YM00368 22037002
***********************************************************     YM00368 22038002
EAPRFMP  DS    0H                                               YM00368 22039002
         OI    SWG,ORFLG2SW        SET NEW KEYWORD O'RIDE FLAG. YM00368 22040702
         BAL   RE,EAORIDE         LINK TO O'RIDE RTNE TO UPDATE  Y02655 22040802
*                                 TABLE & TURN ON PERFORM O'RIDE Y02655 22041002
*                                 FLAG                           Y02655 22041202
         BALR  RE,RF              LINK TO GET PERFORM FIELD      Y02655 22041402
         LA    R7,EAORTABL+ORPRMVAL-ORTABLE POINT TO PERFORM     Y02655 22041602
*                                 IN O'RIDE                      Y02655 22041802
         B     EAPRFM3                                           Y02655 22042002
EAPRFME  DS    0H                 (PERFORM) KEYWORD              Y02655 22042202
         TM    SWE,PRCV            STMT INVOKE A PROCEDURE?     YM00368 22042802
         BO    EAPRFM1            YES GO TURN ON PERFORM O'RIDE  Y02655 22043002
*                                 IN IWA                         Y02655 22043202
         TM    SWG,ORPRFMOR       IS IWA O'RIDE FLAG ON?         Y02655 22043402
         BZ    EAPRFM2            NO GO ENTER PERFORM INTO SCT   Y02655 22043602
         BALR  RE,RF              YES GO GET NEXT KEY            Y02655 22043802
EAPRFM1  DS    0H                                                Y02655 22044002
         OI    SWG,ORPRFMOR       TURN ON IWA O'RIDE FLAG        Y02655 22044202
EAPRFM2  DS    0H                                                Y02655 22044402
         LA    R7,SCT+SCTPRFMF-INSMSCT PERFORM ADDR IN SCT       Y02655 22044602
EAPRFM3  DS    0H                                                Y02655 22044802
         TM    JCT+JCTSTAT2-INJMJCT,JCTPERFM PERFORM ON JOBCARD@ZA10064 22044903
         BO    EAPRFM9            YES, BRANCH TO EXIT          @ZA10064 22045003
         MVI   EATEMP1,E0         ZERO TEMP STORAGE             YM00368 22045203
         MVI   SCT+SCTPRFMF-INSMSCT,E0 ZERO PERFORM FIELD       YM00368 22045303
         LTR   R2,R2              PERFORM VALUE SPEC'D?         YM00368 22045402
         BZ    EAPRFM7            NO, BYPASS KEY PROCESSING     YM00368 22045602
         BALR  RE,R9               GO TO TEST AND STORE.        YM00368 22045802
         CLI   MSGSEC,E0           VGT ENTERS MSG CODE IF ERROR.YM00368 22046002
         BNE   EAPRFM7             BRANCH ON ERROR.             YM00368 22047002
*  IEFVGT WILL ACCEPT VALUES IN THE RANGE OF 0-255.             YM00368 22048002
         CLI   EATEMP1,E0         ZERO SPEC'D?                   Y02655 22049802
         BE    EAPRFM7             BRANCH YES, ZERO IS INVALID. YM00368 22050002
         SR    R1,R1              CLEAR REGISTER                 Y02655 22050202
         IC    R1,EATEMP1         LOAD VALUE FOR SYSEVENT        Y02655 22050402
         SYSEVENT VERIFYPG                                       Y02655 22050802
         L     RF,EAGETKEP        GET KEY ADDRESS                Y02655 22051002
*  SRM RETURNS ZERO IN BYTE 2 IF SPECIFIED VALUE IS DEFINED TO  YM00368 22051202
*  SYSTEM, OR A DEFAULT VALUE IF SPECIFIED VALUE IS UNDEFINED.  YM00368 22051302
         CLM   R1,E2,CONHZERO      ZERO RETURN CODE?            YM00376 22051402
         BE    EAPRFM6             BRANCH YES, VALID VALUE.     YM00368 22051502
         STCM  R1,E2,EATEMP1       SAVE DEFAULT VALUE.          YM00376 22051602
         MVC   E0(E1,R7),EATEMP1  PUT VALUE IN SCT/O'RIDE TABLE  Y02655 22052002
         LA    R2,WRNMSG05         PRF VALUE UNDEFINED MSG CODE.YM00368 22052202
         B     EAPRFM8             BR TO ISSUE WARNING MSG.     YM00368 22052302
EAPRFM6  DS    0H                                               YM00368 22052402
         MVC   0(1,R7),EATEMP1     PUT VAL IN SCT/O'RIDE TABLE. YM00368 22052502
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 22052602
*  ERROR ENTRY - PERFORM VALUE INVALID OR OMITTED.              YM00368 22052702
EAPRFM7  DS    0H                                               YM00368 22052802
*  PERFORM ERROR.                                                       22052902
*  ERROR MAY BE ON EXEC PGM OR EXEC PROC STMT. A WARNING MSG IS YM00368 22053002
*  ISSUED AND A DEFAULT VALUE IS UNCONDITIONALLY ENTERED IN     YM00368 22053102
*  BOTH THE OVERRIDE TABLE AND THE SCT, TO COVER BOTH CASES.    YM00368 22053202
         MVC   EAORTABL+ORPRMVAL-ORTABLE(1),JCT+JCTPRFMF-INJMJCT        22053302
*                                  DEFAULT FOR PERFORM.STEP=    YM00368 22053402
         MVC   SCT+SCTPRFMF-INSMSCT(1),JCT+JCTPRFMF-INJMJCT     YM00368 22053502
*                                  DFLT FOR PERF= ON EXEC PROC  YM00368 22053602
         LA    R2,WRNMSG03         PRF VAL INVALID/OMITTED MSG. YM00368 22053702
EAPRFM8  DS    0H                                               YM00368 22053802
         MVI   MSGKEY,E0          CLEAR SECONDARY MSG FIELD     YM00368 22053902
         L     R5,EAVGM            MESSAGE MODULE ADDRESS.      YM00368 22054002
         BALR  RE,R5               ISSUE WARNING MSG. JOB IS    YM00368 22054102
*                                  NOT FAILED.                  YM00368 22054202
EAPRFM9  DS    0H                                               YM00368 22054302
         MVI   MSGSEC,0            CLEAR MSG CODE FOR NEXT TIME YM00368 22054402
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 22054502
         EJECT                                                          22054602
************************************************************     Y02670 22054702
*                                                          *     Y02670 22055202
*        DYNAMNBR./DYNAMNBR KEYWORD ROUTINE                *     Y02670 22055302
*                                                          *     Y02670 22055402
************************************************************     Y02670 22055502
         SPACE                                                          22055602
EADYNMP  DS    0H                 (DYNAMNBR.) KEYWORD            Y02670 22055702
         OI    SWG,ORFLG2SW       TURN ON NEW O'RIDE KEY FLAG    Y02670 22055802
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UP-  Y02670 22055902
*                                 DATE TABLE AND TURN ON DYNAMNBRY02670 22056002
*                                 O'RIDE FLAG                    Y02670 22056102
         BALR  RE,RF              LINK TO GET DYNAMNBR FIELD     Y02670 22056202
         LA    R7,EAORTABL+ORDYNVAL-ORTABLE POINT TO DYNAMNBR    Y02670 22056302
*                                 IN O'RIDE                      Y02670 22056402
         B     EADYNM3                                           Y02670 22056502
EADYNME  DS    0H                 (DYNAMNBR) KEYWORD             Y02670 22056602
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER?        Y02670 22056702
         BO    EADYNM1            YES GO TURN ON DYNAMNBR O'RIDE Y02670 22056802
*                                 IN IWA                         Y02670 22056902
         TM    SWG,ORDYNMOR       IS O'RIDE FLAG ON IN IWA       Y02670 22057002
         BZ    EADYNM2            YES GO TO GET NEXT KEY         Y02670 22057102
         BALR  RE,RF              GO GET NEXT KEY                Y02670 22057202
EADYNM1  DS    0H                                                Y02670 22057302
         OI    SWG,ORDYNMOR       TURN ON IWA O'RIDE FLAG        Y02670 22057402
EADYNM2  DS    0H                                                Y02670 22057502
         LA    R7,SCT+SCTNIUSL-INSMSCT DYNAMNBR ADDR IN SCT      Y02670 22057602
EADYNM3  DS    0H                                                Y02670 22057702
         LTR   R2,R2              DYNAMNBR SPEC'D?               Y02670 22057802
         BZ    EADYNM5            NO, GO TO GET NEXT KEY         Y02670 22057902
         XC    EATEMP1(E2),EATEMP1 ZERO TEMP STORAGE             Y02670 22058002
         XC    SCT+SCTNIUSL-INSMSCT(E2),SCT+SCTNIUSL-INSMSCT     Y02670 22058102
*                                 CLEAR DYNAMNBR FIELD           Y02670 22058202
         BALR  RE,R9              GO TO TEST & STORE             Y02670 22058302
         CLI   MSGSEC,E0          ERROR DETECTED?                Y02670 22058402
         BE    EADYNM4            NO GO MOVE IN VALUE            Y02670 22058502
         MVI   MSGSEC,E0          CLEAR MSG FIELD                Y02670 22058602
         MVI   MSGKEY,E0          CLEAR SECONDARY MSG FIELD     YM00369 22058702
         LA    R2,WRNMSG04        LOAD WRN MSG FOR VGM          YM00369 22058802
         L     R5,EAVGM           GET MSG MODULE ADDR            Y02670 22058902
         BALR  RE,R5              GO PRINT MSG                   Y02670 22059002
         B     EADYNM5                                           Y02670 22059102
EADYNM4  DS    0H                                                Y02670 22059202
         MVC   E0(E2,R7),EATEMP1 PUT VALUE IN SCT/O'RIDE TABLE   Y02670 22059302
EADYNM5  DS    0H                                                Y02670 22059402
         BALR  RE,RF              GO GET NEXT KEY                Y02670 22059502
         EJECT                                                          22059602
*********************************************************************** 22060000
*                                                                     * 22080000
*              REGION./REGION KEYWORD ROUTINE.                        * 22100000
*                                                                     * 22120000
*********************************************************************** 22140000
         SPACE                                                          22160000
EAREGP   DS    0H                 (REGION.) KEYWORD.                    22180000
         SPACE                                                          22200000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE TAB  22220000
*                                      AND TURN ON REGION O'RIDE FLAG.  22240000
         BALR  RE,RF              LINK TO GET REGION FIELD.             22260000
         SPACE                                                          22280000
         LA    R7,EAORTABL+ORREG-ORTABLE POINT AT REGION IN O'RIDE AACA 22300017
         B     EAREG3             GO TO ENTER REGION INTO O'RIDE TABLE. 22320000
         SPACE 2                                                        22340000
EAREGE   DS    0H                 (REGION) KEYWORD.                     22360000
         SPACE                                                          22380000
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER.               22400000
         BO    EAREG1             YES. GO TURN ON REGION O'RIDE IN IWA. 22420000
         SPACE                                                          22440000
         TM    SWF,ORREGOR        IS REGION O'RIDE FLAG ON IN IWA.      22460000
         BZ    EAREG2             NO. GO TO ENTER REGION IN SCT.        22480000
         BALR  RE,RF              YES. GO GET NEXT KEY.                 22500000
         SPACE                                                          22520000
EAREG1   DS    0H                                                       22540000
         OI    SWF,ORREGOR        TURN ON REGION O'RIDE FLAG IN IWA.    22560000
EAREG2   DS    0H                                                       22580000
         XC    SCT+SCTMSSZE-INSMSCT(E2),SCT+SCTMSSZE-INSMSCT     Y02668 22590002
*                                 CLEAR REGION REQ FLDS IN SCT.  A41178 22592001
         LA    R7,SCT+SCTMSSZE-INSMSCT ADDR OF REGION SLOT IN SCT O106  22600019
         SPACE                                                          22620000
EAREG3   DS    0H                                                       22640000
         XC    EATEMP2(E2),EATEMP2      ZERO FLAG FIELD          Y01029 22642001
         LTR   R2,R2              IS PRIMARY REGION SPECIFIED.     AACA 22645017
         BZ    EAREG5             NO. GO TO SET UP LCS.            AACA 22650017
EAREG3A  DS    0H                                                  AACA 22655017
         LA    R6,0(R2,R3)        POINT TO LAST CHAR. IN REGION FIELD.  22660000
         CLI   0(R6),C'K'         IS IT A 'K'.                          22680000
         BNE   EAPGM10            NO. -FORMAT ERROR (REGION)-  @ZA03866 22700003
         SPACE                                                          22720000
EAREG4   DS    0H                                                       22840000
         BCTR  R2,0               DECREMENT R2 TO GET NBRS ONLY.        22860000
         LTR   R2,R2         WAS 'K' ONLY SOECIFICATION?        YA02009 22866002
         BZ    EAPGM10       YES,FORMAT ERROR IN REGION FIELD.. YA02009 22872002
         BALR  RE,R9              LINK TO CVB AND MVC TO EATEMP1.       22880000
         SPACE                                                          22900000
         TM    EATEMP2,EAREGION   FIRST PASS ?                   Y01029 22950001
         BZ    EAREG4A            YES, MVC INTO SCT/O'RIDE       Y01029 22952001
         SPACE                                                          22954001
         AH    R5,EATEMP1          NO,ADD H1 TO H0               Y01029 22956001
         C     R5,MAXVAL           MAX REGION SPECIFIED?         Y01029 22956401
         BH    REGERR              YES, ERROR                    Y01029 22956801
         STH    R5,E0(R7)         SCT/O'RIDE REGION SIZE         Y01029 22958001
         B     EAREG5             CONTINUE REGION PROCESSING     Y01029 22958401
         SPACE                                                          22958801
EAREG4A  LH    R5,EATEMP1         H0 - LATER COMPUTE H0 + H1     Y01029 22959201
         MVC   E0(E2,R7),EATEMP1  MOVE H0 REGION TO SCT/O'RIDE   Y01029 22959601
         OI    EATEMP2,EAREGION   FIRST PASS - H0 SPECIFIED      Y01029 22959701
         SPACE                                                          22960001
EAREG5   DS    0H                                                       22980000
         OI    EASW2,EAREGION     REGION SPECIFIED ON EXEC       Y01029 22990001
         BALR  RE,RF              LINK TO GET NEXT KEY.                 23000000
         SPACE                                                          23003017
EAREG6   DS    0H                                                  AACA 23006017
         ST    RB,TPDTP           SET PDT TO TOP.                  AACA 23009017
         B     EAREG3A            GO TO PROCESS LCS REGION.        AACA 23015017
REGERR   MVI  MSGSEC,EAR58        MOVE IN REGION ERROR NUM       Y01029 23017001
         B    EAERRTN             PROCESS ERROR MSG              Y01029 23019001
         EJECT                                                          23020000
*********************************************************************** 23020314
*                                                                     * 23020614
*              ROLL./ROLL KEYWORD ROUTINE.                            * 23020914
*                                                                     * 23021214
*********************************************************************** 23021514
EAROLLP  DS    0H                 (ROLL.) KEYWORD.                      23021814
EAROLLE  DS    0H                 (ROLL) KEYWORD.                       23024514
         BALR  RE,RF              LINK TO GET NEXT KEY.                 23033814
         B     EAROLLP                                           Y01029 23035001
         EJECT                                                          23035101
*********************************************************************** 23035401
*                                                                    ** 23035501
*             ADDRSPC./ADDRSPC= KEYWORD ROUTINE                      ** 23035601
*                                                                    ** 23035901
*********************************************************************** 23037901
EAADDRP  DS    0H                 (ADDRSPC.) KEYWORD             Y01029 23038301
         SPACE                                                          23038801
         BAL   RE,EAORIDE         LINK TO O'RIDE RTN TO UP TAB   Y01029 23039901
         BALR  RE,RF              LINK TO GET ADDRSPC FIELD      Y01029 23040201
         LA    R7,EAORTABL+ORADDR-ORTABLE                        Y01029 23040601
*                                 ADDRSPC LOC IN O;RIDE TAB      Y01029 23041001
         B     EAADDR3            PUT ADDRSPC FLAGS IN TAB       Y01029 23041201
EAADDRE  DS    0H                 (ADDRSPC) KEYWORD              Y01029 23041601
         SPACE                                                          23041701
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER         Y01029 23041801
         BO    EAADDR1            YES, TURN ON O'RIDE IN IWA     Y01029 23041901
         TM    SWF,ORADDROR       ADDRSPC O'RIDE IN IWA ?        Y0102  23042001
         BZ    EAADDR2            NO, ENTER ADDRSPC IN SCT       Y01029 23042101
         BALR  RE,RF              GET NEXT KEY                   Y01029 23042201
EAADDR1  DS    0H                                                       23042501
         OI    SWF,ORADDROR       TURN ON ADDRSPC O'RIDE IN IWA  Y01029 23042601
EAADDR2  DS    0H                                                Y01029 23042701
         LA    R7,SCT+SCTSSTAT-INSMSCT                           Y01029 23042801
*                                 ADDRESS OF ADDRSPC FLAG IN SCT        23043201
EAADDR3  DS    0H                                                Y01029 23043601
         LTR   R2,R2              ADDRSPC KEY SPECIFIED?         Y01029 23043701
         BZ    EAGETK             GET  NEXT KEY(NULLIFY)         Y01029 23043801
         MVI   EATEMP1,E0         CLEAR TEMP STORAGE             Y01029 23043901
         BALR  RE,R9              TEST AND STORE                 Y01029 23044001
EAADDR4  DS    0H                                                Y01029 23045301
         TM    EATEMP1,EAADDRBT   ADDRSPC = REAL?                Y01029 23045401
         BZ    EAADDR6            NO, INDICATE ADDRSPC ON EXEC   Y01029 23045501
         L     R3,WANELPTR         ADDRESS OF NEL.               Y02668 23046202
         USING EANEL,R3           NEL ADDRESSABILITY             Y01029 23047701
         TM    NELOPSW2,NELADSPC  IS THIS A TSO USER ?           Y01029 23048101
         BO    EAADRER1           YES, NOT PERMITTED - ERROR MSG Y01029 23048501
         DROP  R3                                                       23048701
         TM    SWD,JOBADDRF       ADDRSPC SPECIFIED ON JOB ?     Y01029 23049401
         BO    EAADDR6            YES, SET ADDRSPC ON EXEC       Y01029 23049601
         OI    JCT+JCTSTAT2-INJMJCT,JCTADSPC   SET JCT ADDR = REAL      23050001
EAADDR5  DS    0H                                                Y01029 23050701
         OC    E0(E1,R7),EATEMP1  SET ADDRSPC INFO IN SCT/O'RIDE TABLE  23051401
         SPACE                                                          23052101
EAADDR6  DS    0H                                                Y01029 23052801
         OI    EASW2,EAADDR       INDICATE ADDRSPC ON EXEC       Y01029 23053501
EAGETK   DS    0H                                                Y01029 23053901
         BALR  RE,RF              GET KEY                        Y01029 23054201
EAADRER1 DS    0H                                                Y01029 23054901
         MVI   MSGSEC,EAR62       ADDRSPC=REAL INVALID           Y01029 23055601
         MVI   MSGKEY,EXECK       ON EXEC STATEMENT              Y01029 23056001
         B     EAERRTN                                           Y01029 23056301
EAADRERR DS    0H                                                Y01029 23056701
         MVI   MSGSEC,EAR60        REQ. PARM MISSING             Y01029 23057101
         B     EAERRTN             GO TO ERROR RTN               Y01029 23057501
*********************************************************************** 23058401
*                                                                 *AACA 23059101
*              RD./RD KEYWORD ROUTINE                             *AACA 23059801
*                                                                 *AACA 23060501
*******************************************************************AACA 23061201
EARDP    DS    0H                 (RD.) KEYWORD                    AACA 23061901
         SPACE                                                          23062601
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE AACA 23063301
*                                 TABLE AND TURN ON RD O'RIDE      AACA 23064001
*                                 FLAG.                            AACA 23064701
         BALR  RE,RF              LINK TO GET RD FIELD.            AACA 23065401
         SPACE                                                          23066101
         LA    R7,EAORTABL+ORRD-ORTABLE POINT AT RD FIELD IN TABLE AACA 23066801
         B     EARD3              ENTER RD FLAGS IN O'RIDE TABLE   AACA 23067501
         SPACE 3                                                        23068201
EARDE    DS    0H                 (RD) KEYWORD                     AACA 23068901
         SPACE                                                          23069601
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER           AACA 23070301
         BO    EARD1              YES GO TURN ON RD O'RIDE IN IWA  AACA 23071001
         SPACE                                                          23071701
         TM    SWG,ORRDOR         RD O'RIDE ON IN IWA.             AACA 23072401
         BZ    EARD2              NO. GO TO ENTER RD FLAGS IN SCT. AACA 23073101
         BALR  RE,RF              YES. GO TO GET NEXT KEY          AACA 23073801
         SPACE                                                          23074501
EARD1    DS    0H                                                  AACA 23075201
         OI    SWG,ORRDOR         SET RD O'RIDE FLAG IN IWA        AACA 23075901
EARD2    DS    0H                                                  AACA 23076601
         LA    R7,SCT+SCTSSTAT-INSMSCT POINT AT R0 FLAGS IN SCT   O106  23077301
         SPACE 3                                                        23078001
EARD3    DS    0H                                                  AACA 23078701
         MVI   EATEMP1,X'00'      CLEAR TEMP STORAGE.              AACA 23079401
         SPACE                                                          23080101
         BALR  RE,R9              LINK TO GT TO SET BITS IN TEMP1  AACA 23080801
         SPACE                                                          23081501
         OC    0(1,R7),EATEMP1    SET BITS IN SCT/O'RIDE TABLE     AACA 23082201
         SPACE                                                          23082901
         BALR  RE,RF              LINK TO GK TO GET NEXT KEY       AACA 23083601
         EJECT                                                     7777 23084301
*******************************************************************I241 23085001
*                                                                  I241 23085701
*              SDP./SDP KEYWORD ROUTINE                            I241 23086401
*                                                                  I241 23087101
*******************************************************************I241 23087801
EASDPP   DS    0H                  (SDP.) KEYWORD                  I241 23088501
         BAL   RE,EAORIDE          LINK TO O'RIDE ROUTINE TO UPDATEI241 23089201
*                                     TABLE AND TURN ON SDP O'RIDE I241 23089901
*                                     FLAG                         I241 23090601
         BALR  RE,RF               LINK TO GET SDP FIELD           I241 23091301
         LA    R7,EAORTABL+ORSDP-ORTABLE POINT AT SDP IN O'RIDE    I241 23092001
         B     EASDP3              GO TO ENTER SDP IN O'RIDE TABLE I241 23092701
EASDPE   DS    0H                  (SDP) KEYWORD                   I241 23093401
         TM    SWE,PRCV            IS THIS PROC STATEMENT          I241 23094101
         BO    EASDP1              YES, GO TURN ON SDP O'RIDE IN   I241 23094801
*                                     IWA                          I241 23095501
         TM    SWG,ORSDPOR         IS SDP O'RIDE FLAG ON IN IWA    I241 23096201
         BZ    EASDP2              NO, GO ENTER SDP INTO SCT       I241 23096901
EASDP6   DS    0H                                                  I241 23097601
         BALR  RE,RF               YES, GO GET NEXT KEY            I241 23098301
         B     EASDP6              GO GET NEXT KEY                 I241 23099001
EASDP1   DS    0H                                                  I241 23099701
         OI    SWG,ORSDPOR         TURN ON SDP O'RIDE FLAG IN IWA  I241 23100401
EASDP2   DS    0H                                                  I241 23101101
         LA    R7,SCT+SCTSDP-INSMSCT   ADDR OF SDP IN SCT         O106  23101801
EASDP3   DS    0H                                                  I241 23102501
         OI    0(R7),X'10'         SET NO PRTY BIT                 I241 23103201
         MVI   1(R7),X'0B'         SET DEFAULT                     I241 23103901
         LTR   R2,R2               IS THERE PRTY SPECIFIED         I241 23104601
         BNZ   EASDP4              YES, GO CONVERT                 I241 23105301
         CLC   TNUM(4),TCT         NUMBER PARAMETERS EQUAL TO      I241 23106001
*                                     NUMBER PROCESSED             I241 23106701
         BE    EASDP6              YES, GO GET NEXT KEY            I241 23107401
EASDP4   DS    0H                                                  I241 23108101
         NI    0(R7),B'11101111'   TURN OFF NO PARM  BIT           I241 23108801
         LTR   R2,R2                    IS THERE PRTY SPECIFIED    I241 23109501
         BZ    EASDP5                   NO, GO GET NEXT KEY        I241 23110201
         MVI   EATEMP1,X'00'       CLEAR TEMP FIELD                I241 23110901
         BALR  RE,R9                    LINK TO CVB AND MVC TO TEMPI241 23111601
         MVN   0(1,R7),EATEMP1          MOVE SDP TO SCT OR O'RIDE  I241 23112301
EASDP5   DS    0H                                                  I241 23113001
         BALR  RE,RF                    LINK TO GET NEXT KEY       I241 23113701
         ST    RB,TPDTP                 SET PDT TO TOP             I241 23114401
         LA    R7,1(R7)                 POINT R7 AT NEXT SAVE SLOT I241 23115101
         B     EASDP4                   GO PROCESS SECOND FIELD    I241 23115801
         EJECT                                                     I241 23116501
*******************************************************************I241 23117201
*                                                                  I241 23117901
*              READ/WRITE & ASSIGN.                                   * 23118601
*                                                                     * 23119301
*                 R5 = 0  READ IN SIOT & JFCB USING EATTRSV.          * 23120000
*                         ASSIGN:                                     * 23140000
*                            1. TSIOT TO SIOT.                        * 23160000
*                            2. TNEXT TO JFCB.                        * 23180000
*                            3. MVC TNEXT+4 TO TSIOT & TO SCTPSIOT.   * 23200000
*                                                                     * 23220000
*                 R5 = 4  WRITE AND ASSIGN SIOT & JFCB.               * 23240000
*                         UPDATE TNEXT & TNEXT+4.                     * 23260000
*                                                                     * 23280000
*********************************************************************** 23300000
EARWA    DS    0H                                                       23320000
         STM   RE,R7,EAREGSV      SAVE REGS 14 - 7.                     23340000
         SPACE                                                          23360000
         LA    R7,QPARM           QMANAGER PARAMETER                    23380000
         USING IOPARAMS,R7             LIST ADDRESSING.                 23400000
         L     R3,EAVHQ           QMNGR (IEFVHQ) ADDRESS.               23420000
         L     R6,QMPCL           DATA RECORD POINTER.                  23440000
         LA    R4,SIOT            SIOT ADDRESS.                         23460000
         USING INDMSIOT,R4             ADDRESSING.                      23480000
         ST    R4,0(R6)           SIOT ADDRESS TO QMPCA.                23500000
         LA    R2,JFCB            JFCB ADDRESS.                         23520000
         USING EAJFCB,R2                                                23540000
*                                                                       23560000
*   CHECK FOR READ / WRITE & ASSIGN.                                    23580000
*                                                                       23600000
         B     *+4(R5)                                                  23620000
         B     EARWA2             READ.                                 23640000
*                                                                       23660000
*   WRITE AND ASSIGN.                                                   23680000
*                                                                       23700000
EARWA1   DS    0H                                                       23720000
         MVI   DISPLID(R6),ZERO     ZERO OUT BLOCK ID IN QMPA    Y02621 23726002
*              FOR WRITE OF SIOT                                 Y02621 23732002
         MVC   4(3,R6),SIOTDSKA   MOVE SIOT TTR TO QMPEX.               23740000
         MVC   SCT+SCTLSIOT-INSMSCT(MVTHREE),SIOTDSKA            Y02668 23746002
*                                  MOVE SIOT TTR TO SCT          Y02668 23752002
*                                                                       23760000
*   WRITE AND ASSIGN SIOT.                                              23780000
*                                                                       23800000
         BALR  RE,R3              LINK TO QMGR. W&A SIOT.               23820000
         SPACE                                                          23840000
         MVC   TNEXT(4),0(R6)     MOVE NEW TTR TO TNEXT.                23860000
         SPACE                                                          23880000
         TM    EASW1,EAPGMSDF     PGM = *.                              23900000
         BO    EARWA3             YES. RETURN.                          23920000
         MVC   4(4,R6),SCTPJFCB   JFCB TTR TO QMPEX.                    23940000
         MVI   DISPLID(R6),JFCBSID BLOCK ID TO REMOTE LIST       Y02621 23950002
         ST    R2,0(R6)           JFCB ADDR TO QMPCA.                   23960000
*                                                                       23980000
*   WRITE AND ASSIGN JFCB.                                              24000000
*                                                                       24020000
         BALR  RE,R3              LINK TO QMGR. W&A JFCB.               24040000
         SPACE                                                          24060000
         MVC   TNEXT+4(4),0(R6)   MOVE NEW TTR TO TNEXT+4.              24080000
         SPACE                                                          24100000
         B     EARWA3             GO TO RESTORE REGS & RETURN.          24120000
         SPACE                                                          24140000
*                                                                       24160000
*   READ.                                                               24180000
*                                                                       24200000
EARWA2   DS    0H                                                       24220000
         MVC   4(4,R6),EATTRSV    MOVE SIOT TTR TO QMPEX.               24240000
         MVI   QMPOP,QMREAD       SET QMPOP TO READ.                    24260000
*                                                                       24280000
*   READ SIOT.                                                          24300000
*                                                                       24320000
         BALR  RE,R3              LINK TO QMGR. READ SIOT.              24340000
         TM    EASW1,EAPGMSDF      IS THIS A PGM=*. REF ?       YA56859 24360002
         BZ    EARWA2A             NO  BYPASS SYSIN SYSOUT TEST YA56859 24370002
         TM    SCTSBYT3,EASYSOUT  IS THIS REFERENCE TO A SYSOUT DD. 394 24380000
         BO    EARWA4             YES. ERROR.                       394 24400000
         TM    SCTSBYT1,SCTSYSIN  IS THIS REFERENCE TO A SYSIN DD.  394 24420000
         BO    EARWA4             YES. ERROR.                       394 24440000
EARWA2A  DS    0H                                               YA56859 24450002
         MVC   EATEMP1(3),SIOTDSKA     MOVE SIOT TTR FOR PGM=*.         24460000
         MVC   EATTRSV(4),SCTPSIOT     MOVE TTR OF NEXT SIOT TO SAVE.   24480000
         MVC   SIOTDSKA(3),TSIOT  ASSIGN NEW TTR TO THIS SIOT.          24500000
         MVC   TSIOT(4),TNEXT     UPDATE POINTER TO NEXT SIOT           24520000
         MVC   SCTPSIOT(4),TNEXT       IN IWA & IN THIS SIOT.           24522001
         CLC   SCTDDNAM(8),EARWA50  IS THIS FIRST JOBCAT SIOT    Y01113 24530001
         BNE   EARWA20              IF NO, BYPASS SAVING TTR     Y01113 24532001
         MVC   EATEMP3(3),SIOTDSKA  SAV TTR OF 1ST JBCAT         Y01113 24534001
EARWA20  DS     0H                                               Y01113 24544001
         TM    EASW1,EAPGMSDF     PGM=*.                           AACA 24545017
         BO    EARWA22            YES. GO TO READ JFCB           Y02668 24550002
EARWA21  DS    0H                                                  AACA 24665017
         TM    SIOTALTD,SIOJCATS   IS THIS A JOBCAT SIOT         Y01113 24710001
         BZ    EARWA21A      NO,CHECK FOR FIRST STEP FOR JOBLIB YM01882 24712002
*        SETUP TO ENTER JOBCAT INTO REFERBACK DICTIONARY...     YM01882 24712102
         LA    R1,DICTDD        AREA TO BUILD DICT. ENTRY.      YM01882 24712202
         MVI   DICTLEN(R1),DENLEN  MOVE IN ENTRY LENGTH...      YM01882 24712302
         MVI   DICTID(R1),DDVERB  IDENTIFY ENTRY AS DD CARD.    YM01882 24712402
         MVC   DICTSIOT(E3,R1),SIOTDSKA  MOVE SIOT SVA TO ENTRY YM01882 24712502
         MVC   DICTJFCB(E3,R1),TNEXT+4  MOVE JFCB SVA TO ENTRY  YM01882 24712602
         MVC   DICTNAME(E6,R1),EARWA50  MOVE NAME TO ENTRY..    YM01882 24712702
         L     RF,EAINPUT    ADDRESS OF IEFVGI,DICTIONARY INSERTYM01882 24712802
         BALR  RE,RF         GO TO IEFVGI...                    YM01882 24712902
         B     EARWA22       CONTINUE PROCESSING..              YM01882 24713002
EARWA21A DS    0H                                               YM01882 24713102
         CLI   SCT+SCTSNUMB-INSMSCT,FRSTSTEP  THIS THE FIRST STEPY02113 24714002
         BE    EARWA5      POINT JOBLIB DICT. ENTRY TO NEW SIOT YM01882 24716002
         TM    EASW2,EAFRSTEP     CHECK FOR FIRST STEP OF A    @ZA07749 24716503
*                                 DEFERRED STEP RESTART        @ZA07749 24717303
         BO    EARWA6             PROCESS JOBLIB FOR 1ST STEP  @ZA12397 24718103
         OI    SCTSDISP,EASIPAS   TURN ON PASS INDICATOR-JOBLIB  Y02113 24720002
         NI    SCTSDISP,EASDISPC  CLEAR OTHER DISP SETTINGIN BYTEY02113 24722002
         OI    SCTSBYT2,SCTJOBLB  TURN ON JOBLIB INDICATOR       Y02113 24724002
         OI    SCTSBYT3,EASIOLD   TURN ON OLD INDICATOR-JOBLIB   Y02113 24726002
         NI    SCTSBYT3,EASBYTE3  CLEAR NEW,MOD SETTING IN FIELD Y02113 24728002
         NI    SCTSBYT2,VOLAFOFF     TURN VOL AFFINITY OFF     @ZA02726 24731003
         XC    SCTVOLCT(1),SCTVOLCT  ZERO VOL COUNT FIELD       YM00396 24734002
         MVC   SCTUTYPE(8),EABLANK   BLANK UNIT TYPE                010 24740000
EARWA22  DS    0H                                                  AACA 24750017
***************************************************************@ZA29589 24750203
**                                                             @ZA29589 24750403
**       IF VOL=REF=*.JOBLIB IS SPECIFIED ON A DD THAT IS      @ZA29589 24750603
**       CONCATENATED TO JOBLIB, WE MUST INSURE THAT THE SVA   @ZA29589 24750803
**       OF REFERED TO SIOT IS UPDATED TO POINT TO THE NEWLY   @ZA29589 24751003
**       CREATED JOBLIB SIOT.                                  @ZA29589 24751203
**                                                             @ZA29589 24751403
***************************************************************@ZA29589 24751603
         TM    SCTSBYT2,SCTJOBLB        JOBLIB?                @ZA29589 24751803
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752003
         TM    SCTSBYT1,SIOTCCAT        JOBLIB CONCATENATION?  @ZA29589 24752203
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752403
         TM    SCTSBYT3,SCTVREF         VOL=REF=*.JOBLIB ?     @ZA29589 24752603
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752703
**                                                                      24752803
***************************************************************@ZA29589 24753003
**                                                                      24753203
**       THERE ARE TWO INCORE BUFFERS FOR THE REFERBACK DICT-  @ZA29589 24753403
**       IONARY. THEY ARE POINTED TO BY SREFB AND DREFB. WHEN  @ZA29589 24753603
**       THE FIRST BUFFER IS FULL, IT IS WRITTEN OUT AND THE   @ZA29589 24753803
**       BUFFER SPACE POINTED TO BY SREFB WILL NOW BE USED TO  @ZA29589 24754003
**       CONTAIN THE THIRD SECTION OF THE DICTIONARY. SINCE    @ZA29589 24754203
**       THE JOBLIB DD ENTRY ALWAYS THE FIRST ENTRY IN THE     @ZA29589 24754403
**       FIRST SECTION OF THE DICTIONARY, WE MUST SEARCH THE   @ZA29589 24754603
**       DICTIONARY FOR THE JOBLIB ENTRY. WHEN THE SEARCH IS   @ZA29589 24754803
**       COMPLETE,DREFB WILL CONTAIN THE POINTER TO THE BUFFER @ZA29589 24755003
**                                                                      24755203
***************************************************************@ZA29589 24755403
**                                                                      24755603
         LA    R3,EARWA60+1             SET UP TO REREAD THE   @ZA29589 24755803
         L     RF,EASEARCH              REFERBACK DICTIONARY   @ZA29589 24756003
         BALR  RE,RF                    CALL VGS TO SEARCH     @ZA29589 24756503
         LA    R1,DREFB+E7              POINT TO JOBLIB SVA    @ZA29589 24757003
         MVC   SIOTVRSB(E3),DICTSIOT(R1) COPY JOBLIB SVA       @ZA29589 24757503
         L     R3,EAVHQ                 RELOAD QMGR INTERFACE  @ZA29589 24758003
EARWA22A DS    0H                                                       24758503
         MVC   4(4,R6),SCTPJFCB   MOVE JFCB TTR TO QMPEX.               24760000
         ST    R2,0(R6)           JFCB ADDRESS TO QMPCA.                24780000
         MVI   QMPOP,QMREAD       SET QMPOP TO READ.                    24800000
*                                                                       24820000
*   READ JFCB.                                                          24840000
*                                                                       24860000
         BALR  RE,R3              LINK TO QMGR. READ JFCB.              24880000
         TM    EASW1,EAPGMSDF     PGM=*.?                        Y02668 24886002
         BO    EARWA3             YES, GO TO RETURN              Y02668 24892002
         SPACE                                                          24900000
         MVC   SCTPJFCB(4),TNEXT+4     ASSIGN NEW TTR TO JFCB.          24920000
         SPACE                                                          24940000
*                                                                       25020000
*   RESTORE REGISTERS - RETURN.                                         25040000
*                                                                       25060000
EARWA3   DS    0H                                                       25080000
         LM    RE,R7,EAREGSV      RESTORE REGISTERS 14 - 7.             25100000
         SPACE                                                          25120000
         BR    RE                 RETURN.                               25140000
         SPACE                                                          25160000
*                                                                       25180000
*   INVALID REFERBACK TO A SYSOUT/SYSIN DD STATEMENT.               394 25200000
*                                                                       25220000
EARWA4   DS    0H                                                   394 25240000
         MVI   MSGSEC,EAR59       SET ERROR MESSAGE CODE.           394 25260000
         B     EAERRTN            GO TO CLEANUP.                    394 25280000
EARWA5   DS    0H                                                       25282002
         TM    SCTSBYT1,SIOTCCAT  CONCATENATION TO JOBLIB ?     YM07752 25282602
         BO    EARWA22       YES,BYPASS UPDATE OF SVA IN DICT.  YM07752 25283202
*        CHANGE  REFERBACK DICTIONARY FOR NEW JOBLIB SVAS       YM01882 25284002
         LA    R1,SREFB+E7   POINT TO INPUT  DISCTIONARY JOBLIB YM01882 25286002
         MVC   DICTSIOT(E3,R1),SIOTDSKA SIOT SVA TO ENTRY       YM01882 25288002
         MVC   DICTJFCB(E3,R1),TNEXT+E4   JFCB SVA TO DICT ENTRYYM01882 25290002
         B     EARWA22       CONTINUE WITH NORMAL PROCESS       YM01882 25292002
EARWA6   DS    0H                                              @ZA12397 25292103
*  THE FOLLOWING CODE WAS ADDED TO SUPPORT VOL REF TO DSNAME   @ZA15772 25292203
*  ON JOBLIB FOR DEFERRED RESTART                              @ZA15772 25292303
         TM    SCTSBYT3,SCTDSNRF  VOL REF TO DSNAME PRESENT    @ZA15772 25292403
         BZ    EARWA603           NO, CONTINUE                 @ZA15772 25293303
         TM    SCTSBYT1,SIOTCCAT  CONCATENATION TO JOBLIB      @ZA15772 25293603
         BZ    EARWA600           NO, READ 1ST STEP SCT        @ZA15772 25293903
         L     R5,SCT+SCTADSTB-INSMSCT  GET SVA OF DSNT        @ZA15772 25295603
         ST    R5,SWADSNT        SET TO READ IN DSNT IF NEEDED @ZA15772 25295703
         LTR   R5,R5              HAVE WE FOUND DSNT CHAIN YET?@ZA15772 25296003
         BNZ   EARWA601           YES, BYPASS READ OF SCT      @ZA15772 25296103
EARWA600 EQU   *                                               @ZA15772 25296203
*  READ IN 1ST STEP SCT TO FIND VALID DSNT CHAIN ADDR          @ZA15772 25296303
         MVC   E4(E4,R6),JCT+JCTSDKAD-INJMJCT  SVA OF 1ST SCT  @ZA15772 25296403
         ST    R2,E0(R6)          SET TO READ INTO JFCB SLOT   @ZA15772 25296503
         MVI   QMPOP,QMREAD       SET SWA PARM TO READ         @ZA15772 25296603
         BALR  RE,R3              GO TO VHQ TO READ IN 1ST SCT @ZA15772 25296703
         XC    TWORK(E8),TWORK    CLEAR TEMPORARY WORK AREA    @ZA15772 25296803
*  THIS CODE MOVES HEAD OF DSNT CHAIN FROM 1ST STEP SCT TO     @ZA15772 25296903
*  CURRENT STEP SCT (1ST STEP OF DEFERRED RESTART)             @ZA15772 25297003
         MVC   SCT+SCTADSTB-INSMSCT(E4),JFCB+SCTADSTB-INSMSCT  DSNT SVA 25297603
*                                  TO CURRENT SCT              @ZA15772 25299603
         MVC   SWADSNT(E4),JFCB+SCTADSTB-INSMSCT  SAVE DSNT SVA@ZA15772 25301603
EARWA601 EQU   *                  ENTER FOR JOBLIB CONCAT. AND @ZA15772 25303603
         LA    R5,DSNAME                                       @ZA15772 25311303
         USING DSNTABLE,R5                                     @ZA15772 25311403
         OI    SWC,DSNTQ          TELL VHH TO WRITE LAST DSNT  @ZA15772 25311503
*                                                              @ZA15772 25311703
*  LOOP TO READ IN LAST DSNT FOR JOBLIB.  THERE MAY BE ADDED   @ZA15772 25311803
*  VOL REFS TO DSNAME IN NON-JOBLIB DDS IN RESTART STEP TO BE  @ZA15772 25311903
*  ADDED TO LAST DSNT.                                         @ZA15772 25312003
*                                                              @ZA15772 25312103
         LH    R0,SIOVDSNT        GET OFFSET TO DSNT ENTRY     @ZA15772 25312203
         SRDA  R0,32              SET UP TO DIVIDE BY 168      @ZA15772 25314203
         D     R0,DSNTLEN                                      @ZA15772 25314303
*  R1=QUOTIENT.  NUMBER BLOCKS, MINUS 1, FOR CURRENT ENTRY     @ZA15772 25314403
*  R0=REMAINDER. THIS IS OFFSET TO CURRENT DSNAME ENTRY.       @ZA15772 25314503
         LA    R1,E1(R1)          INCREMENT READ COUNT         @ZA15772 25314803
         STH   R1,DSNCOUNT        SAVE COUNT OF DSNTS TO READ  @ZA15772 25314903
         SR    R1,R1              CLEAR REG FOR LOOP CONTROL   @ZA15772 25315003
EARWA602 EQU   *                                               @ZA15772 25315103
         MVC   E4(E4,R6),SWADSNT  DSNT SVA INTO EXT PARM       @ZA15772 25315203
         ST    R5,E0(R6)          READ INTO DSNT BUFFER        @ZA15772 25315303
         MVI   QMPOP,QMREAD       SET TO READ                  @ZA15772 25315403
         BALR  RE,R3              GO TO VHQ TO READ IN DSNT    @ZA15772 25315503
         MVC   SWADSNT(E4),DSNTNSVA    SAVE ADDR NEXT DSNT     @ZA15772 25315603
         LA    R1,E1(R1)          INCREMENT COUNT OF BLOCKS    @ZA15772 25315803
         CH    R1,DSNCOUNT        HAS CORRECT BLOCK BEEN READ? @ZA15772 25315903
         BL    EARWA602           NO, GO READ NEXT ONE         @ZA15772 25316003
         SR    R1,R1              CLEAR REG                    @ZA15772 25316103
         IC    R1,SIOVDSNL        GET LENGTH DSN IN VOL REF    @ZA15772 25316203
         AH    R1,SIOVDSNT        ADD OFFSET TO DSN ENTRY      @ZA15772 25316303
         ST    R1,SCT+SCTLDSTB-INSMSCT  UPDATE DSNT REL LENGTH @ZA15772 25316403
EARWA603 EQU   *                  NON VOL REF ON JOBLIB ENTRY  @ZA15772 25316503
         XR    RF,RF               ZERO REG                    @ZA12397 25316603
         CL    RF,TSREFB           HAS 1ST DICT BEEN WRITTEN   @ZA12397 25316703
*                                  OUT TO SWA?                 @ZA12397 25316803
         BE    EARWA5              NO, 1ST DICT IN INPUT BUFFER@ZA12397 25316903
         TM    SCTSBYT1,SIOTCCAT   CONCATENATION TO JOBLIB?    @ZA12397 25317003
         BO    EARWA22             YES, BYPASS UPDATE OF SVA   @ZA12397 25317103
         LA    R3,EARWA60+1        POINT TO LENGTH BYTE        @ZA12397 25317203
         L     RF,EASEARCH         LOAD VGS VCON               @ZA12397 25317303
         BALR  RE,RF               GO TO SEARCH FOR JOBLIB     @ZA12397 25317403
         LA    R1,DREFB+E7         POINT TO SEARCH DICT. JOBLIB@ZA12397 25317503
         MVC   DICTSIOT(E3,R1),SIOTDSKA SIOT SVA TO ENTRY      @ZA12397 25317603
         MVC   DICTJFCB(E3,R1),TNEXT+E4 JFCB SVA TO ENTRY      @ZA12397 25317703
         LA    R1,DREFB            POINT TO BEGINNING OF DICT. @ZA12397 25317803
         ST    R1,E0(R6)           ADDR TO REMOTE PARM LIST    @ZA16392 25317903
         MVI   QPARM+QMPOP-QMNAM,QMWRTE INDICATE WRITE         @ZA12397 25318103
         MVC   E4(E3,R6),TSREFB   REWRITING FIRST DICT.        @ZA16392 25318203
         MVI   E7(R6),DICTRYID    INDICATE ID FOR DICTIONARY   @ZA16392 25318303
         L     R3,EAVHQ           LOAD VHQ VCON                @ZA12397 25318403
         BALR  RE,R3              LINK TO VHQ TO WRITE BACK    @ZA12397 25318503
*                                 UPDATED DICTIONARY           @ZA12397 25318603
         B     EARWA22            CONTINUE WITH NORMAL PROCESS @ZA12397 25318703
         DROP  R2                                                       25318803
         DROP  R4                                                       25318903
         DROP  R7                                                       25319003
EARWA50  DS    0H                                                Y01113 25319103
         DC    CL8'JOBCAT  '       FOR COMPARE WITH SIOT DDNAME  Y01113 25319203
EARWA60  DC    FL1'1'              ONE SEARCH ARGUMENT         @ZA12397 25319303
         DC    FL1'6'              LENGTH OF 6                 @ZA12397 25319403
         DC    CL6'JOBLIB'         SEARCH ARGUMENT = JOBLIB    @ZA12397 25319503
         EJECT                                                          25319803
*********************************************************************** 25320000
*                                                                     * 25340000
*              O'RIDE TABLES HANDLING.                                * 25360000
*                                                                     * 25380000
*********************************************************************** 25400000
EAORIDE  DS    0H                                                       25420000
         SPACE                                                          25440000
         STM   RE,R7,EAREGSV      SAVE REGISTERS 14THRU 7.              25460000
         ST    RB,TPDTP           INITIALIZE TO START AT PDT TOP.       25480000
         SPACE                                                          25500000
         TM    EASW1,EAPGMSDF+EAPGMEF  IS THIS AN EXEC PGM STATEMENT.   25520000
         BM    EAPGM10            YES. ERROR.                           25540000
         SPACE                                                          25560000
         CLI   0(R3),X'08'        DOES PROCSTEP EXCEED 8 BYTES.         25580000
         BH    EAORIDE4           YES -ERROR-.                          25600000
         LTR   R2,R2               DOES PROCSTEP NAME FOLLOW      18053 25606017
         BNE   EAORIDE8            THE OVERRIDE.  YES             18053 25612017
         MVI   MSGSEC,EAR60        PROCSTEP NAME LENGTH IS ZERO   180   25618001
         B     EAERRTN             SET POSITIONAL PARAM MISSING         25622001
*                                                                       25624017
EAORIDE8 DS    0H                                                 18053 25630017
         LA    R7,EAORTABL        ORIDE TABLE ADDRESS.                  25640000
         USING ORTABLE,R7                                               25660000
*                                                                       25680000
*   SET UP QMANAGER PARAMETER AREA.                                     25700000
*                                                                       25720000
         LA    R6,QPARM           QMANAGER PARAMETER                    25740000
         USING IOPARAMS,R6             LIST ADDRESSING.                 25760000
         L     R5,QMPCL           QMPCA ADDRESS TO R5.                  25780000
         SPACE                                                          25800000
*                                                                       25820000
*   INITIALIZE WORK SPACE AND SET R4 = PDT O'RIDE SLOT.                 25840000
*                                                                       25860000
         BCTR  R4,0               POINT TO O'RIDE FLAG FOR THIS KEY.    25880000
         SPACE                                                          25900000
         L     RF,EAVHQ           SET RF TO IEFVHQ ADDRESS              25920000
         MVC   EAPRSV(8),EABLANK  BLANK OUT PROCSTEP TEMP SAVE.         25940000
         BCTR  R2,0                                                     25960000
         EX    R2,EAORIDMV        MOVE PROCSTEP TO TEMP SAVE.           25980000
         SPACE                                                          26000000
*                                                                       26020000
*   CHECK FOR FIRST ENTRY INTO O'RIDE TABLE.                            26040000
*                                                                       26060000
         CLI   ORNMNXST,X'00'     STEPNAME IN O'RIDE TABLE EQUAL ZERO.  26080000
         BE    EAORIDE2           YES. GO TO INITIALIZE TABLE.          26100000
*                                                                       26120000
*   CHECK FOR MATCHING STEPNAMES.                                       26140000
*                                                                       26160000
         CLC   ORNMNXST(8),EAPRSV IS STEP TO BE O'RIDDEN SAME AS STEP   26180000
*                                      ALREADY ENTERED IN O'RIDE TABLE. 26200000
         BE    EAORIDE3           YES. GO TO CHECK FOR DUPLICATE KEYS.  26220000
*                                                                       26240000
*   NEW STEPNAME - PUT OUT PREVIOUS OVERRIDE TABLE.                     26260000
*                                                                       26280000
         MVC   ORNMNXST(8),EAPRSV PUT THIS STEPNAME INTO O'RIDE TABLE   26300000
*                                      SLOT 'NEXT STEP TO BE O'RIDDEN'. 26320000
         MVC   ORCHAIN(3),TNEXT   MOVE TNEXT TO CHAIN TTR.              26340000
         ST    R7,0(R5)           O'RIDE TABLE ADDRESS TO QMPCA.        26360000
         MVC   4(3,R5),ORTTR      O'RIDE TABLE TTR TO QMPEX.            26380000
         MVI   DISPLID(R5),PROCORID    BLOCK ID TO REMOTE LIST   Y02621 26390002
*                                                                       26400000
*   LINK TO IEFVHQ TO WRITE & ASSIGN PREVIOUS O'RIDE TABLE.             26420000
*                                                                       26440000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE MODULE.    26460000
         SPACE                                                          26480000
         MVC   TNEXT(4),0(R5)     UPDATE TNEXT.                         26500000
*                                                                       26520000
*   MOVE O'RIDE CHAIN TTR TO BE TTR OF NEW O'RIDE TABLE, ZERO REST OF   26540000
*        O'RIDE TABLE AND PUT IN NEW STEPNAME.                          26560000
*                                                                       26580000
         MVC   ORTTR(3),ORCHAIN   MOVE CHAIN TTR TO THIS TTR.           26600000
         XC    ORCHAIN(ORTABEND-ORCHAIN),ORCHAIN ZERO REST OF TABLE.    26620000
         MVC   ORNMNXST(8),EAPRSV MOVE STEPNAME TO O'RIDE TABLE.        26640000
         MVI   EAPRSVF,X'00'      CLEAR DUPLICATE FLAG SW.          303 26660000
         MVI   EAPRSVF2,0          CLEAR DUPLIC FLAG BYTE 2.    YM00368 26670002
*                                                                       26680000
*   SET OVERRIDE FLAG IN TABLE, RESTORE REGS & RETURN.                  26700000
*                                                                       26720000
EAORIDE1 DS    0H                                                       26740000
         TM    SWG,ORFLG2SW       NEW O'RIDE KEYWORD?            Y02668 26742002
         BZ    EAORID1A           NO, CONTINUE PROCESSING        Y02668 26744002
         NI    SWG,FF-ORFLG2SW    TURN NEW O'RIDE FLAG OFF       Y02668 26746002
         OC    ORFLAGS2(1),0(R4)  SET UP O'RIDE FLAG FOR KEY     Y02668 26748002
         OC    EAPRSVF2(1),ORFLAGS2 SET UP BYTE 2 DUPLIC CHECK. YM00368 26750002
         B     EAORID2A           GO TO RETURN                   Y02668 26752002
EAORID1A DS    0H                                                Y02668 26754002
         OC    ORFLAGS(1),0(R4)   SET O'RIDE FLAGS FOR THIS KEY.        26760000
         OC    EAPRSVF(1),ORFLAGS SET UP DUPLICATE CHECK.           303 26780000
EAORID2A DS    0H                                                Y02668 26790002
         LM    RE,R7,EAREGSV      RESTORE REGISTERS.                    26800000
         BR    RE                 RETURN.                               26820000
         SPACE                                                          26840000
*                                                                       26860000
*   FIRST ENTRY INTO O'RIDE TABLE. MOVE STEPNAME TO O'RIDE TABLE AND    26880000
*        TO ORIDSNM IN IWA.  ASSIGN A TTR TO THE O'RIDE TABLE AND SAVE  26900000
*        IT IN TPROC OF THE IWA.  SET POVRX IN IWA.  SET O'RIDE ID.     26920000
*                                                                       26940000
EAORIDE2 DS    0H                                                       26960000
         XC    ORTABLE(176),ORTABLE    BE SURE O'RIDE TABLE SLOT CLEAR. 26980000
         MVI   QMPOP,QMASGN       SET QMPOP TO ASSIGN TTR.              27000000
         SPACE                                                          27020000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE (IEFVHQ).  27040000
         SPACE                                                          27060000
         MVC   TPROC(4),0(R5)     MOVE TTR TO IWA.                      27080000
         MVC   ORTTR(3),0(R5)     MOVE TTR TO O'RIDE TABLE.             27100000
         MVI   ORID,ORIDFLAG      SET PROCEDURE O'RIDE TABLE ID.        27120000
         MVC   ORNMNXST(8),EAPRSV MOVE STEPNAME TO O'RIDE TABLE.        27140000
         MVC   ORIDSNM(8),EAPRSV  MOVE STEPNAME TO IWA.                 27160000
         OI    SWE,POVRX          SET O'RIDE PROC EXEC STMT SW IN IWA.  27180000
         B     EAORIDE1           GO TO SET O'RIDE FLAG &RETURN.        27200000
*                                                                       27220000
*   STEPNAME = STEPNAME IN O'RIDE TABLE-CHECK FOR DUPLICATE USE OF      27240000
*        KEYWORDS.                                                      27260000
*                                                                       27280000
EAORIDE3 DS    0H                                                       27300000
         CLI   MSGKEY,ORBYT2KY     ORIDE FLAG FOR THIS KEYWD    YM00368*27320002
                                   IN FLAG BYTE 2?              YM00368 27322002
         BH    EAORID3A            BRANCH NO.                   YM00368 27324002
         NC    EAPRSVF2(1),0(R4)   CHECK FOR DUPLIC ORIDE IN    YM00368*27326002
                                   FLAG BYTE 2.                 YM00368 27328002
         BC    8,EAORIDE1          NO DUP, BRANCH TO EXIT.      YM00368 27330002
         B     EAORID3G            YES DUP, BR TO ISSUE ERR MSG.YM00368 27332002
EAORID3A DS    0H                                               YM00368 27334002
         NC    EAPRSVF(1),0(R4)   CHECK FOR DUPLICATE OVERRIDE.     303 27340000
         BC    8,EAORIDE1         NO. - OK. GO TO RESTORE REGS &EXIT.   27360000
*                                                                       27380000
*   ERROR -DUPLICATE USE OF KEYWORD-                                    27400000
*                                                                       27420000
EAORID3G DS    0H                                               YM00368 27430002
         MVI   MSGSEC,EAR53       SET ERROR MSG NBR.                    27440000
         B     EACLEANP           GO TO CLEANUP ROUTINE.                27460000
         SPACE                                                          27480000
*                                                                       27500000
*   ERROR -PROCSTEP EXCEEDS EIGHT CHARACTERS-                           27520000
*                                                                       27540000
EAORIDE4 DS    0H                                                       27560000
         MVI   MSGSEC,EAR55       SET ERROR MSG NBR.                    27580000
         B     EACLEANP           GO TO CLEANUP ROUTINE.                27600000
         SPACE 2                                                        27620000
EAORIDMV MVC   EAPRSV(1),1(R3)    MOVE PROCSTEP TO TEMP SAVE.(EXECUTED) 27640000
         EJECT                                                          27641017
*******************************************************************AACA 27642017
*                                                                 *AACA 27643017
*              CHECKPOINT/RESTART SCT/SMB CHAINING SUBROUTINE.    *AACA 27644017
*                                                                 *AACA 27645017
*******************************************************************AACA 27646017
EARSTSUB DS    0H                                                  AACA 27647017
         STM   RE,R7,EAREGSV      SAVE REGISTERS 14 THRU 7.        AACA 27648017
         SPACE                                                          27649017
         L     R5,QPARM+QMPCL-IOPARAMS  REMOTE LIST ADDRESS        AACA 27650017
         LA    R6,EAAUXWK         SPACE FOR C/R SCT.               AACA 27651017
         ST    R6,0(R5)           ADDR TO REMOTE LIST              AACA 27652017
         MVC   4(3,R5),JCT+JCTSSTR-INJMJCT C/R SCT TTR             AACA 27653017
         MVI   7(R5),X'00'        JUST TO BE SURE LAST BYTE ZERO   AACA 27654017
         MVI   QPARM+QMPOP-IOPARAMS,QMREAD  SET TO READ.           AACA 27655017
         L     R7,EAVHQ           ADDR OF QMNGR INTERFACE -IEFVHQ  AACA 27656017
         SPACE                                                          27657017
         BALR  RE,R7              LINK TO QMNGR - READ IN C/R SCT  AACA 27658017
         SPACE                                                          27659017
         MVC   EAAUXWK+SCTANSCT-INSMSCT(MVTHREE),SCT+SCTDISKA-INSMSCT   27659619
*                                      CHAIN R/I C/R SCT          O106  27660219
*                                                   TO THIS STEP.  AACA 27661017
         SPACE                                                          27665017
         MVI   QPARM+QMPOP-IOPARAMS,QMWRTE  SET TO WRITE C/R SCT.  AACA 27666017
         SPACE                                                          27667017
         BALR  RE,R7              LINK TO QMNGR - WRITE C/R SCT.   AACA 27668017
         SPACE                                                          27669017
         LM    RE,R7,EAREGSV      RESTORE REGS.                    AACA 27670017
         BR    RE                 RETURN.                          AACA 27671017
         EJECT                                                          27672017
*******************************************************************AACA 27673017
**                                                                   ** 27700000
**             CLEANUP PORTION OF EXECUTE ROUTINE.                   ** 27720000
**                                                                   ** 27740000
*********************************************************************** 27760000
EAERRTN0 DS    0H                                                       27780000
         MVI   MSGKEY,X'00'       CLEAR SECONDARY MESSAGE SLOT.         27800000
EACLEANP DS    0H                                                       27820000
EAERRTN  EQU   *                                                        27840000
         LA    R7,JCT             JCT ADDRESSING.                       27860000
         USING EAJCT,R7                                                 27880000
         SPACE                                                          27900000
         LA    R4,EAORTABL        O'RIDE TABLE ADDRESS TO R4.           27920000
         USING ORTABLE,R4                                               27940000
         SPACE                                                          27960000
         LA    R6,QPARM           Q-MANAGER PARAMETER                   27980000
         USING IOPARAMS,R6             AREA ADDRESSING.                 28000000
         L     R5,QMPCL           QMPCA ADDRESS TO R5.                  28020000
         ST    R4,0(R5)           O'RIDE TABLE ADDRESS TO QMPCA.        28040000
         SPACE                                                          28060000
         CLI   MSGSEC,X'00'       HAS AN ERROR OCCURRED.                28080000
         BNE   EAERRTNA           YES. GO TO FAIL JOB AND PUT OUT MSG.  28100000
EAERRTN1 DS    0H                                               YM00382 28110002
*                                                                       28120000
*   NO ERRORS.  CHECK FOR POVRX ON AND O'RIDES FOR THIS STEP.           28140000
*                                                                       28160000
         TM    SWE,POVRX          O'RIDE PROC EXEC STMT.                28180000
         BZ    EAEXIT             NO.  EXIT TO IEFVHF.                  28200000
*                                                                       28220000
*        POVRX ON - ARE THERE OVERRIDES.                                28240000
*                                                                       28260000
         TM    SWE,PROC            STATEMENT FROM A PROC?        Y02668 28266002
         BZ    EACL1              NO-CANNOT BE OVERRIDDEN         17163 28272016
         CLC   ORIDSNM(8),EASNSV  IS THERE AN OVERRIDE TABLE FOR STEP.  28280000
         BNE   EACL1               NO. DO NOT READ IN POT       YM08035 28300002
         CLC   TPROC(3),EAENDOR    IS POT PTR ZERO ?            YM08035 28310002
         BNE   EACL4               NO. GO TO READ IN POT        YM08035 28320002
*                                                                       28340000
*   NO O'RIDES - CHECK FOR PRIME PROC BUFF & PUT OUT LAST O'RIDE TABLE. 28360000
*                                                                       28380000
EACL1    DS    0H                                                       28400000
         TM    SWE,PRCV            STATEMENT INVOKE A PROC?      Y02668 28420002
         BZ    EAEXIT              BR NO, NO O'RIDE TABLE BUILT. Y02668 28450002
*                                                                       28480000
*   PUT OUT LAST O'RIDE TABLE.                                          28500000
*                                                                       28520000
EACL2    DS    0H                                                       28540000
         TM    JCTJSTAT,INCMSTS   CHECK FOR JOB FAILED.                 28560000
         BZ    EACL3              JOB OK - GO TO PUT OUT TABLE.         28580000
*        FAILED JOB - ZERO O'RIDE FLAGS.                                28600000
         MVI   ORFLAGS,X'00'      ZERO O'RIDE FLAGS.                    28620000
         MVI   ORFLAGS2,X'00'     ZERO NEW O'RIDE FLAGS         YM00368 28630002
         SPACE                                                          28640000
*        Q-MANAGER LINK.                                                28660000
EACL3    DS    0H                                                       28680000
         MVC   4(3,R5),ORTTR      TTR TO QMPEX.                         28700000
         MVI   DISPLID(R5),PROCORID    BLOCK ID TO REMOTE LIST   Y02621 28710002
         MVI   QMPOP,QMWRTE       SET QMPOP FOR WRITE ONLY.             28720000
         SPACE                                                          28740000
         L     RF,EAVHQ           IEFVHQ ADDRESS.                       28760000
         BALR  RE,RF              LINK TO Q-MANAGER INTERFACE.          28780000
         B     EAEXIT             GO TO EXIT.                           28800000
*                                                                       28820000
*   O'RIDE TABLE IN AND MOVE PARAMETERS TO SCT.                         28840000
*                                                                       28860000
EACL4    DS    0H                                                       28880000
         SPACE                                                          28900000
         MVC   4(3,R5),TPROC      MOVE TTR OF PROC O'RIDE TABLE TO      28920000
*                                      Q-MANAGER PARAM AREA (QMPEX).    28940000
         MVI   QMPOP,QMREAD       INDICATE READ.                        28960000
         SPACE                                                          28980000
         L     RF,EAVHQ           IEFVHQ ADDRESS.                       29000000
         BALR  RE,RF              LINK TO IEFVHQ (Q-MNGR INTERFACE).    29020000
         SPACE                                                          29040000
         MVC   TPROC(3),ORCHAIN   MOVE TTR OF NEXT O'RIDE TABLE TO IWA. 29060000
         MVC   ORIDSNM(8),ORNMNXST     MOVE NAME OF NEXT STEP TO IWA.   29080000
         SPACE                                                          29100000
*                                                                       29120000
*   CHECK FOR COND OVERRIDES.                                           29140000
*                                                                       29160000
         TM    ORFLAGS,EACONDOR   ARE THERE COND O'RIDES.               29180000
         BZ    EACL5              NO. GO TO CHECK FOR PARM O'RIDES.     29200000
         SPACE                                                          29220000
         MVI   MSGKEY,CONDPEK     YES. SET SECONDARY MSG NBR.           29240000
         XC    SCT+SCTSDPCD-INSMSCT(MV48),SCT+SCTSDPCD-INSMSCT    O106  29260019
*                                      ZERO OUT SCT DEPENDENCIES  O106  29280019
         LA    R3,SCT+SCTSDPCD-INSMSCT SCT STORE LOCATION         O106  29300019
         LA    R2,ORCONDCD        O'RIDE TABLE PICK UP ADDRESS.         29320000
*                                                                  HW16 29322016
*   EVEN OR ONLY TO EIGHTH COND SLOT IN SCT                        HW16 29324016
*                                                                  HW16 29326016
         MVC   42(1,R3),84(R2)     MOVE SCTABCND BYTE,             HW16 29328016
*                                  WHETHER SPECIFIED OR NOT        HW16 29330016
*                                                                  HW16 29332016
         SPACE                                                          29340000
EACL4A   DS    0H                                                       29360000
         CLI   2(R2),X'00'        HAVE WE FINISHED ALL CONDS.           29380000
         BE    EACL5              YES. GO TO CHECK FOR PARM O'RIDES.    29400000
         SPACE                                                          29420000
         CLI   11(R2),X'00'       IS LENGTH ZERO/SCT TTR RESOLVED.      29440000
         BNE   EACL4C             NO. GO TO SEARCH DICT FOR SCT TTR.    29460000
*                                                                       29480000
*   SCT TTR RESOLVED - MOVE O'RIDE COND FIELD TO SCT.                   29500000
*                                                                       29520000
EACL4B   DS    0H                                                       29540000
         SPACE                                                          29560000
         MVC   0(6,R3),0(R2)      MOVE O'RIDE COND FIELD TO SCT.        29580000
         SPACE                                                          29600000
         LA    R2,12(R2)          POINT R2 AT NEXT O'RIDE COND FIELD.   29620000
         LA    R3,6(R3)           POINT R3 AT NEXT SCT COND FIELD.      29640000
         B     EACL4A             GO TO CHECK FOR MORE COND FIELDS.     29660000
*                                                                       29680000
*   SEARCH DICTIONARY TO RESOLVE SCT TTR.                               29700000
*                                                                       29720000
EACL4C   DS    0H                                                       29740000
         SPACE                                                          29760000
         SR    R1,R1                                                    29780000
         IC    R1,ORSTEPL         *    SET UP NAME OF PROCEDURE FOR     29800000
         EX    R1,EACLMV1         *         SEARCH. LENGTH+STEPNAME.    29820000
         SPACE                                                          29840000
         LA    RE,EAREGSV+2(R1)   POINT AT NEXT STORE BYTE.             29860000
*                                                                       29880000
*   CHECK FOR CONDITIONAL SEARCH ON PROCEDURE STEPNAME.                 29900000
*                                                                       29920000
         IC    R1,11(R2)          PICK UP PROCSTEP LENGTH BYTE.         29940000
         STC   R1,EATEMP2         PUT COPY OF LENGTH IN TEMP FOR TEST.  29960000
         NI    EATEMP2,X'80'      CHECK FOR HIGH ORDER BIT ON.          29980000
         BC    8,EACL4D           NO. GO TO SET UP UNCONDITIONAL SEARCH 30000000
*                                                                       30020000
*   CONDITIONAL SEARCH ON (STEPNAME).PROCSTEP - PROCSTEP MAY BE OUTSIDE 30040000
*        THE PROCEDURE NAMED BY (STEPNAME).  THIS IS USED SO THAT A     30060000
*        REFERENCE CAN BE MADE TO A STEP OF A PROCEDURE WITHOUT         30080000
*        NAMING THE PROCEDURE.                                          30100000
*                                                                       30120000
         STC   R1,EATEMP2         COPY OF LENGTH TO TEMP TO TURN OFF    30140000
         NI    EATEMP2,X'7F'           HIGH ORDER BIT.                  30160000
         IC    R1,EATEMP2         PICK UP LENGTH ONLY.                  30180000
         OI    SRCHSW1,SRCHF1     INDICATE CONDITIONAL SEARCH.          30200000
         B     EACL4E             GO TO SEARCH.                         30220000
*                                                                       30240000
*   UNCONDITIONAL SEARCH ON STEPNAME.PROCSTEP.                          30260000
*                                                                       30280000
EACL4D   DS    0H                                                       30300000
*                                                                       30320000
*   SET UP REGS AND LINK TO SEARCH DICTIONARY FOR SCT TTR.              30340000
*                                                                       30360000
EACL4E   DS    0H                                                       30380000
         EX    R1,EACLMV2         MOVE PROCSTEP TO SEARCH SETUP.        30400000
         STC   R1,0(RE)           PUT IN PROCSTEP LENGTH.               30420000
         ST    R3,EATEMP1         SAVE R3.                              30440000
         LA    R3,EAREGSV+1       POINT R3 AT STEPNAME.PROCSTEP.        30460000
         MVI   EAREGSV,X'02'      INDICATE NBR PARAMETERS.              30480000
         OI    SRCHSW1,SRCHF2     INDICATE SEARCH FOR SCT.              30500000
         SPACE                                                          30520000
         L     RF,EASEARCH        LINK TO SEARCH.                       30540000
         BALR  RE,RF                                                    30560000
         SPACE                                                          30580000
         MVC   3(3,R2),2(R1)      MOVE TTR FROM DICT TO O'RIDE.         30600000
         L     R3,EATEMP1         RESTORE R3.                           30620000
         B     EACL4B             GO TO MOVE O'RIDE ENTRY TO SCT.       30640000
         SPACE 2                                                        30660000
EACLMV1  MVC   EAREGSV+1(1),ORSTEPL                                     30680000
EACLMV2  MVC   1(1,RE),3(R2)                                            30700000
         SPACE 2                                                        30720000
*                                                                       30740000
*   PARM O'RIDE CHECK.                                                  30760000
*                                                                       30780000
EACL5    DS    0H                                                       30800000
         TM    ORFLAGS,EAPARMOR   ARE THERE PARM O'RIDES.               30820000
         BZ    EACL6              NO. GO TO CHECK FOR TIME O'RIDES.     30840000
         SPACE                                                          30860000
         MVC   SCT+SCTXBTTR-INSMSCT(MVTHREE),ORPARM               O106  30870019
*                                      MOVE PARM ORIDES TTRO TO SCTO106 30880019
         MVC   SCT+SCTSEXEC-INSMSCT(MVTWO),ORPARMSZ               O106  30890019
*                                      MOVE PARM SIZE TO SCT      O106  30900019
         SPACE                                                          30920000
*                                                                       30940000
*   TIME O'RIDE CHECK.                                                  30960000
*                                                                       30980000
EACL6    DS    0H                                                       31000000
         TM    ORFLAGS,EATIMEOR   ARE THERE TIME O'RIDES.               31020000
         BZ    EACL7              NO. GO TO CHECK FOR ACT O'RIDES.      31040000
         SPACE                                                          31060000
         MVC   SCT+SCTSTIME-INSMSCT(MVTHREE),ORMAXTIM             O106  31070019
*                                      MOVE TIME O'RIDES TO SCT   O106  31080019
         SPACE                                                          31100000
*                                                                       31120000
*   ACT O'RIDES CHECK.                                                  31140000
*                                                                       31160000
EACL7    DS    0H                                                       31180000
         TM    ORFLAGS,EAACCTOR   ARE THERE ACT O'RIDES.                31200000
         BZ    EACL8              NO. GO TO CHECK REGION O'RIDES.       31220000
         SPACE                                                          31240000
         MVC   SCT+SCTAFACT-INSMSCT(MVTHREE),ORACTTTR             O106  31250019
*                                      MOVE ACT TTR TO SCT        O106  31260019
         SPACE                                                          31280000
*                                                                       31300000
*   REGION O'RIDES CHECK.                                               31320000
*                                                                       31340000
EACL8    DS    0H                                                       31360000
         TM    ORFLAGS,EAREGOR    IS THERE A REGION O'RIDE.             31380000
         BZ    EACL9              NO. GO TO CHECK FOR ADDRSPC O'RIDES.  31400001
         SPACE                                                          31420000
         MVC   SCT+SCTMSSZE-INSMSCT(E2),ORREG                    Y02668 31427002
*                                 MOVE REGION PARM TO SCT    O106       31434001
         OI    EASW2,EAREGION     INDICATE REGION ON EXEC STMT.         31443014
         SPACE                                                          31446014
*                                                                       31449014
*   ADDRSPC O'RIDES CHECK.                                              31452001
*                                                                       31455014
EACL9    DS    0H                                                       31458014
         TM    ORFLAGS,EAADDROR   IS THERE  ADDRSPC O'RIDE?.     Y01029 31461001
         BZ    EACL10             NO. GO TO CHECK RD O'RIDES       AACA 31464017
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                  Y01029 31465001
*                                 CLEAR SCTSSTAT                 Y01029 31466001
         OC    SCT+SCTSSTAT-INSMSCT(OC1),ORADDR                  Y01029 31467001
*                                 SET  ADDRSPC O'RIDE FLAGS             31468001
         OI    EASW2,EAADDR       SET ADDRSPC ON EXEC STMT FLAG. Y01029 31473001
*                                                                  AACA 31476017
*   RD O'RIDES CHECK                                               AACA 31479017
*                                                                  AACA 31482017
EACL10   DS    0H                                                  AACA 31485017
         TM    ORFLAGS,EARDOR     IS THERE A RD O'RIDE             AACA 31488017
         BZ    EACL11             NO. CONTINUE                     AACA 31491017
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS   CLEAR RD FLAGS      O106  31493019
         OC    SCT+SCTSSTAT-INSMSCT(OC1),ORRD SET RD O'RIDE FLAGS O106  31495019
*                                                                  I241 31498018
*   SDP O'RIDES CHECK                                              I241 31500018
EACL11   DS    0H                                                  I241 31502018
         TM    ORFLAGS,EASDPOR     IS THERE AN SDP O'RIDE          I241 31504018
         BZ    EACL12              NO, CONTINUE                    I241 31506018
         NI    SCT+SCTSDP-INSMSCT,ZERSDP  ZERO SDP FIELD          O106  31507019
         OC    SCT+SCTSDP-INSMSCT(OC1),ORSDP  MOVE IN O'RIDES     O106  31508019
         MVC   SCT+SCTSDP-INSMSCT+DISPLONE(MVONE),ORSDP+DISPLONE  O106  31509019
*                                      MOVE IN O'RIDES            O106  31510019
*                                                                Y02655 31510102
*    PERFORM O'RIDES CHECK                                       Y02655 31510202
EACL12   DS    0H                                                Y02655 31510502
         TM    ORFLAGS2,EAPRFMOR IS THERE PERFORM O'RIDE         Y02655 31511002
         BZ    EACL13             NO CONTINUE                    Y02655 31511502
         MVC   SCT+SCTPRFMF-INSMSCT(MVONE),ORPRMVAL              Y02655 31512002
*                                 MOVE IN O'RIDE                 Y02655 31512502
*                                                                Y02670 31513002
*    DYNAMNBR O'RIDES CHECK                                      Y02670 31513802
EACL13   DS    0H                                                Y02670 31514602
         TM    ORFLAGS2,EADYNMOR  IS THERE DYNAMNBR O'RIDE       Y02670 31515402
         BZ    EACL14             NO, CONTINUE                   Y02670 31516202
         MVC   SCT+SCTNIUSL-INSMSCT(MVTWO),ORDYNVAL              Y02670 31517002
*                                 MOVE IN O'RIDE                 Y02670 31517802
EACL14   DS    0H                                                Y02668 31518602
*   CHECK FOR END OF OVERRIDE CHAIN.                                    31520000
*                                                                       31540000
         CLC   ORCHAIN(3),EAENDOR IS THE CHAIN TTR ZERO.                31580000
         BNE   EAEXIT             NO. GO TO EXIT.                       31600000
         SPACE                                                          31620000
         NI    SWE,FF-POVRX       END OF O'RIDE CHAIN - TURN OFF FLAG   31640000
*                                      INDICATING O'RIDE PROC EXEC STMT 31660000
         SPACE 3                                                        31680000
EAEXIT   DS    0H                                                  I283 31688019
*************************************************************** YM02711 31704002
*        STEP DEFAULTS FOR REGION AND ADDRSPC                   YM02711 31711002
*************************************************************** YM02711 31718002
*  ADDRSPC=REAL AND NO REGION SPECIFIED ON JOB OR EXEC          YM02711 31725002
*  REGION LEFT ZERO                                             YM02711 31732002
*************************************************************** YM02711 31739002
         TM    SWD,JOBADDRF        ADDRSPC ON JOB STMT ?        YM02711 31746002
         BZ    EAEXIT2             NO - CHECK JOB REGION        YM02711 31753002
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                 YM02711 31760002
*                                  CLEAR POSSIBLE EXEC SETTING  YM02711 31767002
         TM    IWAJBADR,JCTADSPC   JOB ADDRSPC=REAL ?           YM02711 31774002
         BZ    EAEXIT2             NO - CHECK FOR JOB REGION    YM02711 31781002
         OI    SCT+SCTSSTAT-INSMSCT,EAADDRBT                    YM02711 31788002
*                                  SET SCT ADDRSPC=REAL         YM02711 31795002
EAEXIT2  DS    0H                                               YM02711 31802002
         LA    RF,WAJOBPFX         ADDR OF PSEUDO JOB PFX       YM02711 31809002
         USING TEXT,RF             TEXT PREFIX ADDRESSABILITY   YM02711 31816002
         TM    STRJINDC,JTXREGDF   IS JOB REGION A DEFAULT ?    YM02711 31823002
         BZ    EAEXIT2A            NO - MOVE JOB REGION         YM02711 31830002
         DROP  RF                                               YM02711 31837002
         CLC   SCT+SCTMSSZE-INSMSCT(E2),EAENDOR REGION ON EXEC  YM02711 31844002
         BNE   EAEXIT3             YES - CHECK FOR JOB RD       YM02711 31851002
         TM    SCT+SCTSSTAT-INSMSCT,EAADDRBT ADRSPC=REAL IN SCT YM02711 31858002
         BO    EAEXIT3             NO - CHECK FOR JOB RD        YM02711 31865002
EAEXIT2A DS    0H                                               YM02711 31872002
         MVC   SCT+SCTMSSZE-INSMSCT(E2),IWAJOBS6                YM02711 31879002
*                                  MOVE IN JOB REGION           YM02711 31886002
EAEXIT3  DS    0H                                                       31896001
         TM    IWAINTS8,JOBRDNR+JOBRDNC+JOBRDR  RD ON JOB STMT.    AACA 31897201
         BZ    EAEXIT4            NO. GO TO EXIT                   AACA 31898401
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS CLEAR SCTSSTAT        O106  31899601
         OC    SCT+SCTSSTAT-INSMSCT(OC1),IWAINTS8  SET JOB RD FLG O106  31900801
EAEXIT4  DS    0H                                                  AACA 31902001
         TM    SWH,CPSYSFLG       IS THIS CHCKPT/RSTRT EXEC STMT   AACA 31903201
         BZ    EAEXIT5            NO. CONTINUE.                    AACA 31904401
         OI    SCT+SCTSSTAT-INSMSCT,PROTKEY  ALLOW DSDRP PROTECT  O106  31905601
*                                      KEY OF ZERO                O106  31906801
EAEXIT5  DS    0H                                                  AACA 31908001
         TM    EASW2,EACLCOND      Q. RESTARTING JOB               AACA 31909201
         BZ    EAEXIT6              BR - NO                        AACA 31910401
         XC    SCT+SCTSDPCD-INSMSCT(CL48),SCT+SCTSDPCD-INSMSCT    O106  31911601
*                                      CLEAR STEP CONDITION CODES O106  31912801
         NI    EASW2,255-EACLCOND  CLEAR COND. CODE SW.            AACA 31914001
EAEXIT6  EQU   *                                                   AACA 31915201
         SPACE 3                                                        31916401
EAEXITHF DS    0H                                                  AACA 31917601
*  PERFORM KEYWORD CHECK.                                       YM00368 31918802
         L     RE,TEXTBUFP        ADDR TEXT STRING PREFIX       YM00368 31923802
         USING TEXT,RE            PREFIX ADDRESSABILITY         YM00368 31928802
         TM    STRINDCS,PROCSTR   PROC STMT?                    YM00368 31933802
         BO    EAEXITB            YES, SKIP PERF PROCESSING.    YM00368 31938802
         TM    STREINDC,ETXPRCV    STMT INVOKE A PROCEDURE?     YM00368 31943802
         BO    EAEXITB             BR YES,PRF ALREADY PROCESSED YM00368*31948802
                                   IN PERFORM ROUTINE.          YM00368 31953802
         DROP  RE                                                       31958802
         CLI   SCT+SCTPRFMF-INSMSCT,E0 PERFORM SPEC'D ON EXEC?  YM00368 31963802
         BNE   EAEXITB            YES, CONTINUE                 YM00368 31968802
*  ENTER PERFORM VALUE SPECIFIED ON JOB STMT, OR DEFAULT IF     YM00368 31973802
*  JOB VALUE INVALID OR OMITTED.                                YM00368 31978802
         MVC   SCT+SCTPRFMF-INSMSCT(E1),JCT+JCTPRFMF-INJMJCT    YM00376 31983802
EAEXITB  DS    0H                                               YM00368 31988802
         L     RF,EAVHE           SET EXIT                      YM00368 31993802
         BR    RF                  TO ROUTER.                   YM00368 31998802
*                                                               YM00368 32003802
*  ERROR - FAIL JOB AND ISSUE ERROR MESSAGE.                    YM00368 32008802
*                                                               YM00368 32013802
EAERRTNA DS    0H                                                       32020000
         SR    R2,R2                                                    32040000
         IC    R2,MSGSEC          ERROR MESSAGE NBR TO R2.              32060000
         OI    JCTJSTAT,INCMSTS   FAIL JOB.                             32080000
         L     RF,EAVGM           LINK TO PUT OUT                       32100000
         BALR  RE,RF                   ERROR MESSAGE.                   32120000
         B     EAERRTN1            CONTINUE CLEANUP             YM00382 32122002
*********************************************************************   32340219
*                                                                   *   32340419
*                    CONSTANTS                                      *   32340619
*                                                                   *   32340819
*********************************************************************   32341019
         SPACE                                                          32341219
FF       EQU   X'FF'                   ALL ONES                         32341419
         DS    0F                                                       32344201
EABLANK  DC    CL8'        '           8 BLANKS                         32344501
EATESTOR DC    V(IEFVGT)               TEST AND STORE                   32345001
EAGETKEP DC    V(IEFVGK)               GET KEY/POS                      32345501
EAVGM    DC    V(IEFVGM)               MESSAGE MODULE                   32346001
EAINPUT  DC    V(IEFVGI)               DICTIONARY INPUT ROUTINE         32346501
EASEARCH DC    V(IEFVGS)               DICTIONARY SEARCH ROUTINE        32347001
EAVHQ    DC    V(IEFVHQ)               Q-MANAGER INTERFACE              32347501
EAVHE    DC    V(IEFVHE)           ROUTER.                       Y02668 32348002
EAVDBSD  DC    V(IEFVDBSD)        ADDRESS OF DSENQ TABLE RTNE,   Y02668 32348202
EAVHR    DC    V(IEFVHR)               ERROR MSG WTO ROUTINE            32348501
PROCBADD DC    A(EAPROCB-EABASE)   DISPLACEMENT OF PROC PDT.     Y02668 32348702
EA100    DC    H'100'                  CONVERSION OF SECS TO 100THS     32349001
*                                      SECS                             32349501
EA6000   DC    H'6000'                 CONVERSION OF MINS TO 100THS     32350001
*                                      SECS                             32350501
CONHZERO DC    H'0'                HALFWORD ZERO.               YM00368 32350702
EAENDOR  DC    XL3'000000'             INDICATES END OF COND FIELDS     32351001
EAPGMSD  DC    C'PGM=*.DD'             DDNAME INTO PGM=*.SIOT           32351501
EAEVEN   DC    XL5'04C5E5C5D5'         TEXT BUFFER COND 'EVEN' ENTRY    32352001
EAONLY   DC    XL5'04D6D5D3E8'         TEXT BUFFER COND 'ONLY' ENTRY    32352501
         DS    0F                                                       32352601
MAXVAL   DC    XL4'00003FFF'           MAX REGION SIZE           Y01029 32352901
EASIOTBT DS    0C                      MASK FOR DISP=(OLD,PASS) NOT     32355201
*                                      EQUAL JOBLIB                     32356001
         DC    AL1(EASIPAS)            SCTSDISP  DISP=  PASS            32356801
         DC    X'00'                   SCTSBYT1                         32357601
         DC    AL1(SCTJOBLB)           SCRSBYT2 JOBLIB                  32358401
         DC    AL1(EASIOLD)            SCTSBYT3  DISP=  OLD             32359201
         DC    X'00'                   SCTBYT4                          32360001
DSNTLEN  DC    F'168'                  USED TO DIVIDE DSNT REL LEN      32364003
*                                                              @ZA15772 32365003
EAPXID   EQU   X'0C'                   PARM FIELD EXTENSION ID          32368001
MVONE    EQU   1                       LENGTH OF MOVE             O106  32368801
MVTWO    EQU   2                       LENGTH OF MOVE             O106  32369601
MVTHREE  EQU   3                       LENGTH OF MOVE             O106  32370401
MVFOUR   EQU   4                       LENGTH OF MOVE             O106  32371201
MVEIGHT  EQU   8                       LENGTH OF MOVE             O106  32372001
MV48     EQU   48                      LENGTH OF MOVE             O106  32372801
ZEROPRKY EQU   X'FB'                   ZERO PROTECT KEY BIT       O106  32373601
INSTPROC EQU   X'80'                                              M4763 32374401
DISPLONE EQU   1                       DISPLACEMENT               O106  32375201
DISPLZER EQU    0                      DISPLACEMENT                4327 32376001
DISPLTWO EQU   2                       DISPLACEMENT               O106  32376801
DISPLFOR EQU   4                       DISPLACEMENT             O106    32377601
DISPLATE EQU   8                       DISPLACEMENT                4327 32378401
DISPLELE EQU   11                      DISPLACEMENT                4327 32379201
COMPATE  EQU   8                       LENGTH OF COMPARE           4327 32380001
CLTWO    EQU   2                       LENGTH OF CLEAR            O106  32380801
CLTHREE  EQU   3                       LENGTH OF CLEAR            O106  32381601
CLFOUR   EQU   4                       LENGTH OF CLEAR            O106  32382401
CLEIGHT  EQU   8                       LENGTH OF CLEAR            O106  32383201
CLTHIRTN EQU   13                      LENGTH OF CLEAR            O106  32384001
CL48     EQU   48                      LENGTH OF CLEAR            O106  32384801
OC1      EQU   1                                                  O106  32385601
OC6      EQU   6                       CHECK FOR TOO MANY COND OR O106  32386401
*                                      MULTIPLE OF EVENHS/ONLYS'S O106  32387201
COMTWO   EQU   2                       LENGTH OF COMPARE          O106  32388001
FRSTSTEP EQU   X'01'         TEST FOR FIRST STEP IN SCT.         Y02113 32388402
INITBLK  EQU   X'00'                   INITIALIZE TO ZEROS        O106  32388801
CLFLAGS  EQU   X'C7'                   CLEAR FLAGS IN SCTSSTWAT   O106  32389601
INIT1    EQU   B'00010000'                                        O106  32390401
INIT2    EQU   B'11110000'                                        O106  32391201
MAX      EQU   4096                    VALUE OF SECOND BASE       O106  32392001
INIT3    EQU   X'0'                                               O106  32392801
INIT4    EQU   X'0B'                                              O106  32393601
GOSTEP   EQU   X'80'                   EQU IN SCT,SCTGOSTP        O106  32394401
ZERSDP   EQU   X'E0'                   ZERO SDP FIELD             O106  32395201
LCSREG   EQU   X'01'                   LCS REGION                 O106  32396001
PROTKEY  EQU   X'04'                   DSDRP PROTECT KEY          O106  32396801
CZERO    DC    CL2'00'                                                  32397601
         EJECT                                                          32398401
*********************************************************************** 32399201
**                                                                   ** 32400000
**             TABLES FOR EXEC ROUTINE                               ** 32420000
**                                                                   ** 32440000
*********************************************************************** 32460000
*                                                                       32480000
*   BRANCHING TABLE FOR GET KEY/POS.                                    32500000
*                                                                       32520000
EABRANCH DS    0H                                                       32540000
         SPACE                                                          32560000
*   EXEC KEY                                                            32580000
EAEXECA  KKK   02,0,EAEXEC,EAEXECB                                      32600000
*   TIME= KEY                                                           32620000
EATIMEEA KKK   02,0,EATIMEE,EATIMEEB                                    32640000
*   PARM= KEY                                                           32660000
EAPARMEA KKK   100,0,EAPARME,EAPARMEB                              AACA 32680017
*   COND= KEY                                                           32700000
EACONDEA KKK   08,11111111,EACONDE,EACONDEB                             32720000
*   ACCT= KEY                                                           32740000
EAACTEA  KKK   72,0,EAACTE,EAACTEB                                      32760000
*   TIME. KEY                                                           32780000
EATIMEPA KKK   03,0,EATIMEP,EATIMEPB                                    32800000
*   PARM. KEY                                                           32820000
EAPARMPA KKK   101,0,EAPARMP,EAPARMPB                              AACA 32840017
*   COND. KEY                                                           32860000
EACONDPA KKK   09,11111111,EACONDP,EACONDPB                             32880000
*   ACCT. KEY                                                           32900000
EAACTPA  KKK   73,0,EAACTP,EAACTPB                                      32920000
*   PROC KEY                                                            32940000
EAPROCA  KKK   01,00000000,EAPROC,EAPROCB                               32960000
*   PGM KEY                                                             32980000
EAPGMA   KKK   01,10000000,EAPGM,EAPGMB                                 33000000
*   REGION= KEY                                                         33020000
EAREGEA  KKK   02,0,EAREGE,EAREGEB                                 AACA 33040017
*   REGION. KEY                                                         33060000
EAREGPA  KKK   03,0,EAREGP,EAREGPB                                 AACA 33070017
*   ROLL= KEY                                                           33084014
EAROLLEA KKK   02,0,EAROLLE,EAROLLEB                                    33088014
*   ROLL. KEY                                                           33092014
EAROLLPA KKK   03,0,EAROLLP,EAROLLPB                                    33096014
*   RD. KEY                                                        AACA 33096417
EARDPA   KKK   02,0,EARDP,EARDPB                                   AACA 33096817
*   RD= KEY                                                        AACA 33097217
EARDEA   KKK   01,0,EARDE,EARDEB                                   AACA 33097617
*************************DUMMY ENTRY*****************************Y02668 33098402
         DC    XL6'0'                                            Y02668 33098702
*****************************************************************Y02668 33099002
         SPACE                                                     7777 33099318
*   SDP= KEY                                                       I241 33099418
EASDPEA  KKK   02,0,EASDPE,EASDPEB                                 I241 33099518
         SPACE                                                          33099618
*   SDP. KEY                                                       I241 33099718
EASDPPA  KKK   03,0,EASDPP,EASDPPB                                 I241 33099818
         SPACE                                                          33099901
*    ADDRSPC= KEY                                                Y01029 33106601
EAADDREA KKK   01,0,EAADDRE,EAADDREB                             Y01029 33108601
         SPACE                                                          33110601
*     ADDRSPC. KEY                                               Y01029 33112601
EAADDRPA KKK   02,0,EAADDRP,EAADDRPB                             Y01029 33113001
*    PERFORM= KEY                                                Y02655 33113302
EAPRFMEA KKK  01,0,EAPRFME,EAPRFMEB                              Y02655 33114302
*    PERFORM.= KEY                                               Y02655 33115302
EAPRFMPA KKK   02,0,EAPRFMP,EAPRFMPB                             Y02655 33116302
*    DYNAMNBR= KEY                                               Y02670 33116502
EADYNMEA KKK   01,0,EADYNME,EADYNMEB                             Y02670 33116702
*    DYNAMNBR.= KEY                                              Y02670 33116902
EADYNMPA KKK   02,0,EADYNMP,EADYNMPB                             Y02670 33117102
         EJECT                                                          33117302
*                                                                       33120000
*   PARAMETER DESCRIPTER TABLE FOR TEST & STORE.                        33140000
*                                                                       33160000
         SPACE 2                                                        33180000
*********************************************************************** 33200000
*                                                                       33220000
*****    EXEC  KEYWORD PARAMETER DESCRIPTER TABLE.                      33240000
*                                                                       33260000
EAEXECB  EQU   *                  EXEC PDT.                             33280000
         DC    AL1(EAENDK1-EAEXECB)    LENGTH OF EXEC PDT.              33300000
*   STEPNAME - MAX LENGTH = 8 - 1ST CHAR ALPHA - MVC TO EAWORK.         33320000
EAST1    EQU   *                                                        33340000
         DC    AL1(EAEND1-EAST1)       LENGTH OF STEPNAME PDT.          33360000
         DC    XL1'20'                 BYTES CNTRL INFO/BYTES TO COMP.  33380000
         DC    FL1'8'                  MAX PARAMETER LENGTH.            33400000
         DC    XL1'60'                 FUNCT/TABLE.                     33420000
         DC    AL1(EASNSV-EAWORK)      OFFSET IN TABLE.                 33440000
EAEND1   EQU   *                       END STEPNAME POS PDT.            33460000
EAENDK1  EQU   *                       END EXEC KEY PDT.                33480000
*********************************************************************** 33500000
         SPACE 2                                                        33520000
*********************************************************************** 33540000
*                                                                       33560000
*****    PROC  KEYWORD PARAMETER DESCRIPTER TABLE.                      33580000
*                                                                       33600000
EAPROCB  EQU   *                  PROC PDT.                             33620000
         DC    AL1(EAENDK2-EAPROCB)    LENGTH OF PROC PDT.              33640000
*   PROCNAME - MAX LENGTH = 8 - 1ST CHAR ALPHA - MOVE TO EAWORK.        33660000
EAST2    EQU   *                                                        33680000
         DC    AL1(EAEND2-EAST2)       LENGTH OF 1ST PROCNAME PDT.      33700000
         DC    XL1'20'                 CONTROL INFO/COMPARE BYTES.      33720000
         DC    FL1'8'                  MAXIMUM LENGTH OF PROCNAME.      33740000
         DC    XL1'60'                 FUNCT/TABLE.                     33760000
         DC    AL1(EAPCSV-EAWORK)      OFFSET IN TABLE.                 33780000
EAEND2   EQU   *                                                        33800000
EAENDK2  EQU   *                                                        33820000
*********************************************************************** 33840000
         SPACE 2                                                        33860000
*********************************************************************** 33880000
*                                                                       33900000
*****    PGM   KEYWORD PARAMETER DESCRIPTER TABLE.                      33920000
*                                                                       33940000
EAPGMB   EQU   *                  PGM PDT.                              33960000
         DC    AL1(EAENDK3-EAPGMB)     LENGTH OF PGM PDT.               33980000
*   PROGRAMNAME - CHECK FOR *. - NOT *. MAX LENGTH=8 - MVC TO SCT.      34000000
EAST4    EQU   *                                                        34020000
         DC    AL1(EAEND4-EAST4)       LENGTH OF 1ST PGMNM PDT.         34040000
         DC    XL1'31'                 CONTROL INFO/COMPARE BYTES.      34060000
         DC    C'*'                    COMPARE PATTERN.                 34080000
         DC    XL1'00'                 FUNCT/TABLE.  OR/LWA             34100000
         DC    AL1(EASW1-EAWORK)       OFFSET IN TABLE.                 34120000
         DC    AL1(EAPGMSDF)           BIT PATTERN.                     34140000
         DC    XL1'50'                 CONTROL INFO/COMPARE BYTES.      34160000
         DC    FL1'8'                  MAXIMUM PARAM LENGTH.            34180000
         DC    XL1'62'                 FUNCT/TABLE. 1ST ALPHA & MVC/SCT 34200000
         DC    AL1(SCTPGMNM-INSMSCT)   OFFSET IN TABLE.                 34220000
         DC    XL1'00'                 FUNCT/TABLE.  OR/LWA.            34240000
         DC    AL1(EASW1-EAWORK)       OFFSET IN TABLE.                 34260000
         DC    AL1(EAPGMEF)            BIT PATTERN.                     34280000
EAEND4   EQU   *                                                        34300000
EAENDK3  EQU   *                                                        34320000
*******************************************************************AABA 34323016
         SPACE 2                                                        34326016
         SPACE 2                                                        34392016
*******************************************************************AABA 34395016
*                                                                       34400000
*****    ACCT  KEYWORD PARAMETER DESCRIPTER TABLE.                      34420000
*****    ACCT. KEYWORD PARAMETER DESCRIPTER TABLE.                      34440000
*                                                                       34460000
         DC    AL1(EAACCTOR)      ACT O'RIDE FLAG (USED BY EAORIDE).    34480000
EAACTPB  EQU   *                                                        34500000
EAACTEB  EQU   *             (ACT) PDT.  ** NOT USED FOR TEST & STORE** 34520000
*********************************************************************** 34540000
         SPACE 2                                                        34560000
*********************************************************************** 34580000
*                                                                       34600000
*****    PARM  KEYWORD PARAMETER DESCRIPTER TABLE.                      34620000
*****    PARM. KEYWORD PARAMETER DESCRIPTER TABLE.                      34640000
*                                                                       34660000
         DC    AL1(EAPARMOR)      PARM O'RIDE FLAG (USED BY EAORIDE).   34680000
EAPARMPB EQU   *                                                        34700000
EAPARMEB EQU   *             (PARM) PDT.                                34720000
*********************************************************************** 34740000
         SPACE 2                                                        34760000
*********************************************************************** 34780000
*                                                                       34800000
*****    TIME  KEYWORD PARAMETER DESCRIPTER TABLE.                      34820000
*****    TIME. KEYWORD PARAMETER DESCRIPTER TABLE.                      34840000
*                                                                       34860000
         DC    AL1(EATIMEOR)      TIME O'RIDE FLAG (USED BY EAORIDE).   34880000
EATIMEPB EQU   *                                                        34900000
EATIMEEB EQU   *                                                        34920000
         DC    AL1(EAENDK6-EATIMEPB)   LENGTH OF (TIME/TIME.) PDT.      34940000
*   MINS - CONVERT TO BINARY MOVE TO EATEMP1+1.                         34960000
EAST7    EQU   *                                                        34980000
         DC    AL1(EAEND7-EAST7)       LENGTH OF MINS PDT.              35000000
         DC    XL1'50'            BYTES CONTROL INFO/COMPARE BYTES      35020000
         DC    FL1'4'             MAXIMUM PARAMETER LENGTH.             35040000
         DC    XL1'30'            FUNCT/TABLE. (CVB(3)/EWA)             35060000
         DC    AL1(EATEMP1+1-EAWORK)   OFFSET IN EWA.                   35080000
         DC    FL3'1440'          MAXIMUM NUMBER OF MINUTES.            35100000
EAEND7   EQU   *                                                        35120000
EAST8    EQU   *                                                        35140000
         DC    AL1(EAEND8-EAST8)       LENGTH OF SECS PDT.              35160000
         DC    XL1'50'            BYTES CONTROL INFO/COMPARE BYTES      35180000
         DC    FL1'2'             MAXIMUM PARAMETER LENGTH.             35200000
         DC    XL1'30'            FUNCT/TABLE. (CVB(3)/EWA)             35220000
         DC    AL1(EATEMP2+1-EAWORK)   OFFSET IN EWA.                   35240000
         DC    FL3'59'            MAX NBR CVB.                          35260000
EAEND8   EQU   *                                                        35280000
EAENDK6  EQU   *                                                        35300000
*********************************************************************** 35320000
         SPACE 2                                                        35340000
*********************************************************************** 35360000
*                                                                       35380000
*****    COND  KEYWORD PARAMETER DESCRIPTER TABLE.                      35400000
*****    COND. KEYWORD PARAMETER DESCRIPTER TABLE.                      35420000
*                                                                       35440000
*   OPERATOR BIT PATTERNS FOR COND KEYWORD.                             35460000
EAGT     EQU   X'20'              GT OPERATOR.                          35480000
EAGE     EQU   X'B0'              GE OPERATOR.                          35500000
EAEQ     EQU   X'80'              EQ OPERATOR.                          35520000
EANE     EQU   X'70'              NE OPERATOR.                          35540000
EALE     EQU   X'D0'              LE OPERATOR.                          35560000
EALT     EQU   X'40'              LT OPERATOR.                          35580000
*                                                                       35600000
         DC    AL1(EACONDOR)      COND O'RIDE FLAG (USED BY EAORIDE).   35620000
EACONDPB EQU   *                                                        35640000
EACONDEB EQU   *                                                        35660000
         DC    AL1(EAENDK7-EACONDPB)   LENGTH OF (COND/COND.) PDT.      35680000
*   CODE - CONVERT TO BINARY MVC TO EATEMP1(2).                         35700000
EAST9    EQU   *                                                        35720000
         DC    AL1(EAEND9-EAST9)       LENGTH OF CODE PDT.              35740000
         DC    XL1'40'                 BYTES CONTROL INFO/COMPARE BYTES 35760000
         DC    FL1'4'                  MAXIMUM PARAMETER LENGTH.        35780000
         DC    XL1'20'                 FUNCT/TABLE - CVB(2)/EWA.        35800000
         DC    AL1(EATEMP1-EAWORK)     OFFSET IN EWA.                   35820000
         DC    FL2'4095'               MAXIMUM NUMBER FOR CODE.         35840000
EAEND9   EQU   *                                                        35860000
         SPACE                                                          35880000
*   OPERATORS - SEARCH FOR OPERATOR - MVC HEX PATTERN TO EATEMP1+2.     35900000
EAST10   EQU   *                                                        35920000
         DC    AL1(EAEND10-EAST10)     LENGTH OF OPERATORS PDT.         35940000
*   GT                                                                  35960000
         CCC   GT,EAGT                                                  35980000
*   GE                                                                  36000000
         CCC   GE,EAGE                                                  36020000
*   EQ                                                                  36040000
         CCC   EQ,EAEQ                                                  36060000
*   NE                                                                  36080000
         CCC   NE,EANE                                                  36100000
*   LE                                                                  36120000
         CCC   LE,EALE                                                  36140000
*   LT                                                                  36160000
         CCC   LT,EALT                                                  36180000
EAEND10  EQU   *                                                        36200000
         SPACE                                                          36220000
*   STEPNAME - MOVE TO WORK AREA.                                       36240000
EAST11   EQU   *                                                        36260000
         DC    AL1(EAEND11-EAST11)     LENGTH OF STEPNAME PDT.          36280000
         DC    XL1'20'                 CONTROL BYTES/COMPARE BYTES.     36300000
         DC    FL1'8'                  MAXIMUM PARAMETER LENGTH.        36320000
         DC    XL1'50'                 FUNCT/TABLE. (MVC/EWA).          36340000
         DC    AL1(EAREGSV-EAWORK)     OFFSET IN EWA.                   36360000
EAEND11  EQU   *                                                        36380000
EAENDK7  EQU   *                                                        36400000
*********************************************************************** 36420000
         SPACE 2                                                        36440000
*********************************************************************** 36460000
*                                                                       36480000
*****    REGION  KEYWORD PARAMETER DESCRIPTER TABLE.                    36500000
*****    REGION. KEYWORD PARAMETER DESCRIPTER TABLE.                    36520000
*                                                                       36540000
         DC    AL1(EAREGOR)       REGION O'RIDE FLAG (USED BY EAORIDE). 36560000
EAREGPB  EQU   *                                                        36580000
EAREGEB  EQU   *                                                        36600000
         DC    AL1(EAENDK8-EAREGPB)    LENGTH OF (REGION/REGION.) PDT.  36620000
*   CONVERT TO BINARY - MVC TO SCT.                                     36640000
EAST12   EQU   *                                                        36660000
         DC    AL1(EAEND12-EAST12)     LENGTH OF REGION PDT.            36680000
         DC    XL1'40'                 BYTES CONTROL INFO/COMPARE BYTES 36700000
         DC    FL1'5'                  MAXIMUM PARAMETER LENGTH.        36720000
         DC    XL1'20'                 FUNCT/TABLE. (CVB(2)/EWA)        36740000
         DC    AL1(EATEMP1-EAWORK)     OFFSET IN EWA.                   36760000
         DC    XL2'3FFF'          16383 - MAXIMUM K FOR REGION     1500 36780014
EAEND12 EQU    *                                                        36800000
EAENDK8 EQU    *                                                        36820000
*********************************************************************** 36840000
         SPACE 3                                                        36840514
*********************************************************************** 36841014
*                                                                       36841514
*****    ROLL= KEYWORD PARAMETER DESCRIPTER TABLE.               Y01029 36842001
*****    ROLL. KEYWORD PARAMETER DESCRIPTER TABLE.                      36842514
*                                                                       36843014
EAROLLEB EQU   *                                                        36844014
EAROLLPB EQU   *                                                        36844514
         DC    AL1(EAENDK9-EAROLLPB)                                    36854501
EAEND14  EQU   *                                                        36856514
EAENDK9  EQU   *                                                        36857014
*******************************************************************AACA 36857517
         SPACE 2                                                        36858017
*******************************************************************AACA 36858517
*                                                                  AACA 36859017
****   RD= KEYWORD PARAMETER DESCRIPTOR TABLE                      AACA 36859517
****   RD. KEYWORD PARAMETER DESCRIPTOR TABLE                      AACA 36860017
*                                                                  AACA 36860517
         DC    AL1(EARDOR)  RD O'RIDE FLAG (USED BY EAORIDE)       AACA 36861017
EARDEB   EQU   *                                                   AACA 36861517
EARDPB   EQU   *                                                   AACA 36862017
         DC    AL1(EAENDK10-EARDPB)  LENGTH OF (RD/RD.) PDT        AACA 36862517
EAST15   EQU   *                                                   AACA 36863017
         DC    AL1(EAEND15-EAST15)   LENGTH OF POSITIONAL PDT      AACA 36863517
         DC    XL1'31'               CTRL BYTES/COMPARE BYTES      AACA 36864017
         DC    C'R'                  COMPARE PATTERN               AACA 36864517
         DC    XL1'00'               OR / EWA                      AACA 36865017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36865517
         DC    AL1(SCTDORST)           BIT.  CR                    AACA 36866017
         DC    XL1'32'               CTRL/COMPARE                  AACA 36866517
         DC    C'NR'                 COMPARE PATTERN               AACA 36867017
         DC    XL1'00'               OR/EWA                        AACA 36867517
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36868017
         DC    AL1(SCTNORST)           BIT.  CR                    AACA 36868517
         DC    XL1'32'               CTRL/COMPARE                  AACA 36869017
         DC    C'NC'                 COMPARE PATTERN               AACA 36869517
         DC    XL1'00'               OR/EWA                        AACA 36870017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36870517
         DC    AL1(SCTNOCKP)           BIT.  CR                    AACA 36871017
         DC    XL1'63'               CTRL/COMPARE                  AACA 36871517
         DC    C'RNC'                COMPARE PATTERN               AACA 36872017
         DC    XL1'00'               OR/EWA                        AACA 36872517
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36873017
         DC    AL1(SCTNOCKP)           BIT.  CR                    AACA 36873517
         DC    XL1'00'               OR/EWA                        AACA 36874017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36874517
         DC    AL1(SCTDORST)           BIT.  CR                    AACA 36875017
EAEND15  EQU   *                                                   AACA 36875517
EAENDK10 EQU   *                                                   AACA 36876017
         SPACE                                                     7777 36906018
*******************************************************************I241 36936018
*                                                                  I241 36966018
*****    SDP  KEYWORD PAPAMETER DESCRIPTER TABLE                   I241 36996018
*****    SDP.  KEWORD PAPAMETER DESCRIPTER TABLE                   I241 37026018
*                                                                  I241 37056018
         DC    AL1(EASDPOR)       SDP O'RIDE FLAG (USED BY EAORIDE)I241 37086018
EASDPEB  EQU   *                                                   I241 37116018
EASDPPB  EQU   *                                                   I241 37146018
         DC    AL1(EAENDK12-EASDPEB) LENGTH OF (SDP/SDP.) PDT      I241 37176018
*   CONVERT TO BINARY - CHECK MAXIMUM                              I241 37206018
EAST17   EQU   *                                                   I241 37236018
         DC    AL1(EAEND17-EAST17) LENGTH OF SDP PDT               I241 37266018
         DC    XL1'30'             BYTES CONTROL INFO/COMPARE BYTESI241 37296018
         DC    FL1'2'              MAXIMUM PARAMETER LENGTH        I241 37326018
         DC    XL1'10'             FUNCTION/TABLE  (CVB(1)/EWA)    I241 37356018
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                   I241 37386018
         DC    XL1'0F'             MAXIMUM  PRIORITY NUMBER        I241 37416018
EAEND17  EQU   *                                                   I241 37446018
EAENDK12 EQU   *                                                   I241 37476018
         EJECT                                                     I241 37506018
*******************************************************************I241 37508001
*******************************************************************I241 37516001
*          ADDRSPC= KEYWORD PARAMETER DESCRIPTOR TABLE           Y01029 37526001
*          ADDRSPC. KEYWORD PARAMETER DESCRIPTOR TABLE           Y01029 37528001
*****************************************************************Y01029 37536001
         DC    AL1(EAADDROR)      ADDRSPC O'RIDE FLAG            Y01029 37636001
EAADDRPB EQU   *                                                 Y01029 37636401
EAADDREB EQU   *                                                 Y01029 37638001
         DC    AL1(EAENDK13-EAADDRPB)                            Y01029 37638401
*                                 LENGTH POSITIONAL PDT                 37638801
EAST18   EQU   *                                                        37639201
         DC    AL1(EAEND18-EAST18)                                      37639601
*                                 LENGTH POSITIONAL PDT                 37639701
         DC    XL1'34'            CONTROL INFO BYTES                    37639801
         DC    C'REAL'            COMPARE PATTERN                       37639901
         DC    XL1'00'            FUNC-TABLE (OR/EWA)                   37689901
         DC    AL1(EATEMP1-EAWORK)                                      37699901
*                                 OFFSET IN EWA                         37709901
         DC    AL1(EAADDRBT)      BIT PATTERN                           37719901
         DC    XL1'04'            CONTROL INFO/COMPARE BYTE             37729901
         DC    C'VIRT'            COMPARE PATTERN                       37731901
EAEND18  EQU   *                                                        37733901
EAENDK13 EQU   *                                                        37735901
         EJECT                                                          37736002
         DC    AL1(EAPRFMOR)                                     Y02655 37736102
EAPRFMPB EQU   *                                                 Y02655 37736202
EAPRFMEB EQU   *                                                 Y02655 37736302
         DC   AL1(EAENDK14-EAPRFMPB) LENGTH POSITIONAL PARAMETER Y02655 37736402
EAST19   EQU   *                                                 Y02655 37736502
         DC    AL1(EAEND19-EAST19) LENGTH POSITIONAL PARAMETER   Y02655 37736602
         DC    XL1'30'            CONTROL INFO/COMPARE BYTES     Y02655 37736702
         DC    FL1'3'             MAX PARAMETER LENGTH           Y02655 37736802
         DC    XL1'10'            FUNCTION/TABLE                 Y02655 37736902
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                 Y02655 37737002
         DC    XL1'FF'            MAX NUMBER                     Y02655 37737102
EAEND19  EQU   *                                                 Y02655 37737202
EAENDK14 EQU   *                                                 Y02655 37737302
         EJECT                                                          37737402
************************************************************     Y02670 37737502
*        DYNAMNBR= KEYWORD PARAMETER DESCRIPTOR TABLE      *     Y02670 37737602
*        DYNAMNBR. KEYWORD PARAMETER DESCRIPTOR TABLE      *     Y02670 37737702
************************************************************     Y02670 37737802
         SPACE                                                          37737902
         DC    AL1(EADYNMOR)                                     Y02670 37738002
EADYNMPB EQU   *                                                 Y02670 37738102
EADYNMEB EQU   *                                                 Y02670 37738202
         DC    AL1(EAENDK15-EADYNMPB) LENGTH POSITIONAL PDT      Y02670 37738302
EAST20   EQU   *                                                 Y02670 37738402
         DC    AL1(EAEND20-EAST20) LENGTH POSITIONAL PDT         Y02670 37738502
         DC    XL1'40'            CONTROL INFO/COMPARE BYTES     Y02670 37738602
         DC    FL1'4'             MAX PARAMETER LENGTH           Y02670 37738702
         DC    XL1'20'            FUNCTION/TABLE                 Y02670 37738802
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                 Y02670 37738902
         DC    XL2'0663'          MAX NBR                        Y02670 37739002
EAEND20  EQU   *                                                 Y02670 37739102
EAENDK15 EQU   *                                                 Y02670 37739202
PATCH    DC    25F'0'             **********PATCH SPACE**********Y02668 37739302
         END                                                            37739901
./  ADD  SSI=82020058,NAME=IEFVFA
*********************************************************************** 00040002
*                                                                       00050002
*   MODULE NAME= IEFVFA                                                 00060002
*                                                                       00070002
*   DESCRIPTIVE NAME= SCAN ROUTINE                                      00080002
*                                                                       00090002
*   COPYRIGHT= N/A                                                      00100002
*                                                                       00110002
*   STATUS= VS2 REL037 PTF                                     @ZA31145 00120003
*                                                                       00130002
*   FUNCTION= 1. SCANS JCL CARD IMAGE FOR SYNTAX ERRORS.                00140002
*             2. CONVERTS JCL STATEMENT TO INTERNAL TEXT.               00150002
*     OPERATION= 1. AT ENTRY, MODULE CHECKS IF THE STATEMENT IS         00160002
*                   CONTINUED ON ANOTHER CARD. IF IT IS, THE CONTINU-   00170002
*                   ATION EXPECTED SWITCH IS SET ON, AND THE SCAN       00180002
*                   STARTS WITH THE STATEMENT NAME. IF THE CARD IMAGE   00190002
*                   IS ITSELF A CONTINUATION, THE SCAN IS CONTINUED     00200002
*                   AT THE OPERAND FIELD.                               00210002
*                2. THE MODULE SCANS ACROSS GROUPINGS OF ALPHANUMERIC   00220002
*                   AND NATIONAL CHARACTERS TERMINATING IN A DELIMITER. 00230002
*                   CONTROL IS PASSED TO THE ROUTINE FOR THE            00240002
*                   PARTICULAR DELIMITER ENCOUNTERED.                   00250002
*                3. GROUPINGS TERMINATING IN THE '=' DELIMITER ARE      00260002
*                   CHECKED AGAINST A DICTIONARY OF VALID KEYWORDS.     00270002
*                   WHEN A VALID KEYWORD HAS BEEN IDENTIFIED, THE       00280002
*                   CHARACTERS FOLLOWING ARE CHECKED FOR CORRECT        00290002
*                   SYNTAX. INVALID KEYWORDS, AND VALID KEYWORDS WHOSE  00300002
*                   OPERANDS ARE NOT SYNTACTICALLY CORRECT, CAUSE THE   00310002
*                   JOB TO BE FAILED AND ERROR MESSAGES TO BE ISSUED.   00320002
*                4. WHEN AN AMPERSAND IS ENCOUNTERED, THE MODULE        00330002
*                   ASSUMES A SYMBOLIC PARAMETER FOLLOWS, AND BRANCHES  00340002
*                   TO THE SYMBOLIC PARAMETER ROUTINE (IEFVFB) TO       00350002
*                   PROCESS IT.                                         00360002
*                5. FOR A JOB STATEMENT, A CHECK IS MADE FOR THE SPECI- 00370002
*                   FICATION OF KEYWORDS FOR WHICH DEFAULTS MAY BE      00380002
*                   SUPPLIED VIA THE NEL (E.G., MSGLEVEL, MSGCLASS,     00390002
*                   ETC.). FOR THOSE OMITTED, PREBUILT TEXT, INTO WHICH 00400002
*                   THE DEFAULT VALUES ARE PLUGGED, IS APPENDED TO THE  00410002
*                   TEXT STRING FOR THE STATEMENT.                      00420002
*                6. FOR A JOB STATEMENT, AFTER TEXT FOR THE STATEMENT   00430002
*                   HAS BEEN COMPLETED, THE TEXT IS SEARCHED FOR THE    00440002
*                   MSGLEVEL KEY. FLAGS INDICATING THE MSGLEVEL         00450002
*                   SPECIFIED ARE SET FOR USE BY THE PRESCAN ROUTINE.   00460002
*                7. FOR AN EXEC STATEMENT A CHECK IS MADE FOR THE       00470002
*                   SPECIFICATION OF A PROCEDURE NAME. IF ONE HAS BEEN  00480002
*                   SPECIFIED, THE MODULE PERFORMS A 'FIND' ON THE      00490002
*                   PROCEDURE IN THE PROCEDURE LIBRARY, AND SETS        00500002
*                   APPROPRIATE SWITCHES TO CAUSE READS FROM THE        00510002
*                   PROCEDURE LIBRARY.                                  00520002
*                8. CORRECT PARAMETERS ARE CONVERTED TO INTERNAL TEXT.  00530002
*                   THIS CONTINUES UNTIL THE ENTIRE STATEMENT HAS BEEN  00540002
*                   SCANNED, OR AN ERROR HAS BEEN ENCOUNTERED. AN ERROR 00550002
*                   CAUSES TERMINATION OF THE SCAN AND GENERATION       00560002
*                   OF INTERNAL TEXT.                                   00570002
*                9. FOR A DD STATEMENT (AFTER THE INTERNAL     @G29AN2E 00571003
*                   TEXT HAS BEEN CREATED) A CHECK IS MADE FOR @G29AN2E 00572003
*                   THE SPECIFICATION OF THE SUBSYS KEYWORD. IF@G29AN2E 00573003
*                   IT HAS BEEN SPECIFIED THE SUBSYS NAME IS   @G29AN2E 00574003
*                   CHECKED FOR VALID CHARACTERS.  IF THE      @G29AN2E 00575003
*                   CHARACTERS ARE VALID THE SUBSYSTEM INTER-  @G29AN2E 00576003
*                   FACE REQUEST ROUTINE REQUESTS THE SUBSYSTEM@G29AN2E 00577003
*                   TO CHECK THE INTERNAL TEXT OF THE SUBSYS   @G29AN2E 00578003
*                   PARAMETER.                                 @G29AN2E 00579003
*                                                                       00580002
*   NOTES                                                               00590002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00600002
*      DEPENDENCIES= NONE                                               00610002
*      RESTRICTIONS= NONE                                               00620002
*      REGISTER CONVENTIONS=                                            00630002
*                            R2- ERROR MESSAGE CODE WHEN ERROR FOUND    00640002
*                            R9- CARD IMAGE SCAN POINTER                00650002
*                            RA- BASE REGISTER 2                        00660002
*                            RB- BASE REGISTER 1                        00670002
*                            RC- CONVERTER WORK AREA POINTER            00680002
*                            RD- SAVE AREA POINTER                      00690002
*      PATCH-LABEL= PATCH                                               00700002
*                                                                       00710002
*   MODULE TYPE= BAL                                                    00720002
*      PROCESSOR= ASSEMBLER                                             00730002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00740002
*                                                                       00750002
*   ENTRY POINT= IEFVFA                                                 00760002
*      PURPOSE= SCAN STATEMENT                                          00770002
*      LINKAGE= BRANCH ON REGISTER                                      00780002
*      INPUT DATA= JCL STATEMENT                                        00790002
*                  CONVERTER WORK AREA                                  00800002
*                  R9- ADDRESS OF JCL STATEMENT                         00810002
*                  RA- ADDRESS OF STATEMENT PARAMETER LIST              00820002
*                  RC- ADDRESS OF CWA                                   00830002
*      REGISTERS SAVED= RA                                              00840002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVERNTIONS   00850002
*      REGISTERS RESTORED= NONE                                         00860002
*                                                                       00870002
*   EXIT - NORMAL= BRANCH TO IEFVHF                                     00880002
*      CONDITIONS= BLANK DELIMITER FOUND                                00890002
*      OUTPUT DATA= UPDATED FIELDS IN CWA                               00900002
*                   INTERNAL TEXT FOR STATEMENT                         00910002
*      RETURN CODES= NONE                                               00920002
*                                                                       00930002
*   EXIT - ERROR= BRANCH TO IEFVHF                                      00940002
*      CONDITIONS= ERROR FOUND                                          00950002
*      OUTPUT DATA= UPDATED FIELDS IN CWA (JOB FAILED BIT ON)           00960002
*                   INTERNAL TEXT FOR CORRECT PARAMETERS                00970002
*                   ERROR MESSAGE WRITTEN TO MESSAGE DATA SET           00980002
*      RETURN CODES= NONE                                               00990002
*                                                                       01000002
*   EXTERNAL REFERENCES=                                                01010002
*      ROUTINES= IEFVGM VIA BRANCH - WRITE ERROR MSG TO MSG DATA SET    01020002
*                IEFVHR VIA BRANCH - WRITE I/O ERROR MSG TO CONSOLE     01030002
*                IEFVHQ VIA BRANCH - WRITE SYMBOLIC PARAMETER TABLE     01040002
*                                    TO SWA                             01050002
*                IEFVFB VIA BRANCH - PROCESS SYMBOLIC PARAMETERS        01060002
*                IEFACT VIA BRANCH - POST SCAN EXIT TO USER ROUTINE     01070002
*                IEFNB900 VIA BRANCH - SEARCH INTERNAL TEXT FOR SPECFIC 01080002
*                                      KEYWORD KEYS                     01090002
*      DATA AREAS= CONVERTER WORK AREA                                  01100002
*                  JCL DATA SET INPUT BUFFER                            01110002
*                  PROCEDURE LIBRARY INPUT BUFFER                       01120002
*                  INTERNAL TEXT BUFFER                                 01130002
*      CONTROL BLOCKS= QMPA,SSOB,SSIB                          @G29AN2E 01140003
*      TABLES= NONE                                                     01144003
*      MACROS= IEFZB900,IEFQMNGR,IEFVKEYS,IEFVMCWA,IEFJMR,CVT,          01148003
*              IEFSSREQ,IEFJESCT                               @G29AN2E 01152003
*      ENQUEUE RESOURCES= NONE                                          01156003
*       CHANGE LEVEL=Y30LPSB,Y30OPSB,Y30LPTD,Y30OPTD,Z30JPSF,           01160003
*                    Z40MPTH,OZ03299,OZ05366,ZA04797,ZA06243            01164003
*                    Z40RPTH,Z40RPSM,ZA10120,ZA11328,G29AN2E   @G29AN2E 01168003
*                    G32HPPJ,ZA12458,ZA13371,ZA13424,ZA13667   @G32HPPJ 01172003
*                    ZA13844,ZA14268,ZA15003,ZA16422,ZA20640   @ZA20640 01176003
*                    ZA24749,ZA26148,ZA27753,ZA31145           @ZA31145 01180003
*                                                                       01184003
*   MESSAGES=                                                           01200002
*             IEF601I INVALID STATEMENT IN PROCEDURE                    01210002
*             IEF609I INVALID OVERRIDE KEYWORD                          01220002
*             IEF612I PROCEDURE NOT FOUND                               01230002
*             IEF613I PROCEDURE WITHIN A PROCEDURE                      01240002
*             IEF614I I/O ERROR SEARCHING FOR PROCEDURE                 01250002
*             IEF616I SUBLIST WITHIN SUBLIST INCORRECT                  01260002
*             IEF618I OPERAND FIELD NOT TERMINATED IN COMMA OR BLANK    01270002
*             IEF620I CONTINUATION INVALID ON DD *                      01280002
*             IEF622I UNBALANCED PARENTHESES                            01290002
*             IEF623I SOURCE TEXT CONTAINS UNDEFINED CHARACTERS         01300002
*             IEF624I INCORRECT USE OF PERIOD                           01310002
*             IEF625I INCORRECT USE OF LEFT PAREN                       01320002
*             IEF626I INCORRECT USE OF PLUS                             01330002
*             IEF627I INCORRECT USE OF AMPERSAND                        01340002
*             IEF628I INCORRECT USE OF ASTERISK                         01350002
*             IEF629I INCORRECT USE OF APOSTROPHE                       01360002
*             IEF630I UNIDENTIFIED KEYWORD                              01370002
*             IEF632I FORMAT ERROR                                      01380002
*             IEF639I INVALID CLASS DESIGNATION                         01385002
*             IEF640I EXCESSIVE NUMBER OF POSITIONAL PARAMETERS         01390002
*             IEF641I IMPROPER SUBPARAMETER LIST               @G29AN2E 01392003
*             IEF646I REQUIRED POSITIONAL PARAMETER MISSING    @ZA13367 01395003
*             IEF647I NON-ALPHABETIC FIRST CHARACTER                    01400002
*             IEF650I INCORRECT USE OF SLASH                            01410002
*             IEF651I INCORRECT USE OF MINUS                            01420002
*             IEF652I MUTUALLY EXCLUSIVE KEYWORDS                       01430002
*             IEF677I WARNING MESSAGE(S) FOR JOB JJJ ISSUED    @G29AN2E 01430803
*             IEF744I SUBSYSTEM NOT SPECIFIED                  @G29AN2E 01431603
*             IEF745I SUBSYSTEM SSSS DOES NOT EXIST            @G29AN2E 01432403
*             IEF746I SUBSYSTEM SSSS IS NOT OPERATIONAL        @G29AN2E 01433203
*             IEF747I SUBSYSTEM SSSS DOES NOT SUPPORT JCL      @G29AN2E 01434003
*                     PARAMETERS                               @G29AN2E 01434803
*             IEF748I SUBSYSTEM NAME INVALID                   @G29AN2E 01435603
*             IEF749I JCL STATEMENT BUFFER CAPACITY EXCEEDED   @G29AN2E 01436403
*             IEF750I SYSTEM ERROR IN PROCESSING SUBSYS        @G29AN2E 01437203
*                     DD PARAMETER                             @G29AN2E 01438003
*                                                                       01438803
*                                                                       01440002
*********************************************************************** 01450002
         EJECT                                                          01460002
         MACRO                                                          02420000
         JCLD                                                           02440000
**************************************************                      02461018
*                                                                       02462018
* ANY MAJOR DD KEYWORD THAT IS ADDED TO THIS MACRO SHOULD      OCIP39A  02463018
*   ALSO BE ADDED TO IEEVSTAR, WHICH CONTAINS A TABLE OF       OCIP39A  02464018
*   DD MAJOR KEYWORDS. THE REASON FOR THIS IS THE FOLLOWING:   OCIP39A  02465018
*        WHEN USING SYMBOLIC PARAMETERS ON THE START COMMAND,  OCIP39A  02466018
*        MAJOR DD KEYWORDS PARAMETERS CANNOT BE USED TO        OCIP39A  02467018
*        DEFINE SYMBOLIC PARAMETERS                            OCIP39A  02468018
*                                                                       02469018
**************************************************                      02470018
*        EACH GROUP OF KEYWORDS IS TERMINATED WITH 'ETEND' IN     20002 02472020
*        THE LAST PARAMETER OF THE LAST DENT MACRO IN THE GROUP   20002 02474020
******************************************************************20002 02476020
J5L      DENT  (COND),(CONDJK)                                          02480000
         DENT  (ADDRSPC),(ADRSPJK)                               Y01029 02490001
         DENT  (PRTY),(PRTYJK)                                          02500000
         DENT  (PERFORM),(PRFMJK)                                Y02655 02510002
         DENT  (TYPRUN),(TYPRUNJK)                                      02520000
         DENT  (CLASS),(CLASSJK)                                   AAAA 02524015
         DENT  (ROLL),(ROLLJK)                                     AAAA 02528015
         DENT  (RESTART),(RESTARJK)                                AACA 02532017
         DENT  (RD),(RDJK)                                         AACA 02536017
         DENT  (REGION),(REGINJK)                                       02540000
         DENT  (MSGCLASS),(MSGCLAJK)                                    02560000
         DENT  (TIME),(TIMEJK)                                          02570018
         DENT  (NOTIFY),(NOTIFYJK)                                20001 02575020
         DENT  (USER),(USERK)                                  @Z40RPTH 02576003
         DENT  (PASSWORD),(PASWORDK)                           @Z40RPSM 02577003
         DENT  (GROUP),(GROUPK)                                @Z40RPSM 02578003
         DENT  (MSGLEVEL),(MSGLEVJK),,(ETEND)                           02580000
E4L      DENT  (PGM),(PGMEK,PROCEK)                                     02600000
         DENT  (PROC),(PROCEK,PGMEK)                                    02620000
         DENT  (ACCT),(ACCTEEK,ACCTPEK)                                 02640000
         DENT  (COND),(CONDEEK,CONDPEK)                                 02660000
         DENT  (RD),(RDEEK,RDPEK)                                  AACA 02666017
         DENT  (RD,.),(RDPEK,RDEEK)                                AACA 02672017
         DENT  (PARM),(PARMEEK,PARMPEK)                                 02680001
         DENT  (PERFORM),(PRFMEEK,PRFMPEK)                       Y02655 02684002
         DENT  (PERFORM,.),(PRFMPEK,PRFMEEK)                     Y02655 02688002
         DENT  (DYNAMNBR),(DYNMEEK,DYNMPEK)                      Y02670 02692002
         DENT  (DYNAMNBR,.),(DYNMPEK,DYNMEEK)                    Y02670 02696002
         DENT  (TIME),(TIMEEEK,TIMEPEK)                                 02700000
         DENT  (ACCT,.),(ACCTPEK,ACCTEEK)                               02720000
         DENT  (COND,.),(CONDPEK,CONDEEK)                               02740000
         DENT  (PARM,.),(PARMPEK,PARMEEK)                               02760000
         DENT  (TIME,.),(TIMEPEK,TIMEEEK)                               02780000
         DENT  (DPRTY,.),(SDPPEK,SDPEEK)                           I241 02782018
         DENT  (DPRTY),(SDPEEK,SDPPEK)                             I241 02784018
         DENT  (ROLL),(ROLLEEK,ROLLPEK)                            AAAA 02786015
         DENT  (ROLL,.),(ROLLPEK,ROLLEEK)                          AAAA 02792015
         DENT  (ADDRSPC,.),(ADRSPPEK,ADRSPEEK)                   Y01029 02794001
         DENT  (ADDRSPC),(ADRSPEEK,ADRSPPEK)                     Y01029 02796001
         DENT  (REGION),(REGINEEK,REGINPEK)                             02800000
         DENT  (REGION,.),(REGINPEK,REGINEEK),,(ETEND)                  02820000
D4L      DENT  (AFF),(AFFK,SEPK,DDNAMEK,SYSOUTK,COPIESK,BURSTK, Z40MPTHX02840003
               MODIFYK,FLASHK,CHARSK)                           Z40MPTH 02844003
         DENT  (SEP),(SEPK,AFFK,DDNAMEK,SYSOUTK,COPIESK,BURSTK, Z40MPTHX02848003
               MODIFYK,FLASHK,CHARSK)                           Z40MPTH 02852003
         DENT  (DCB),(DCBK,AMPK)                                   AABA 02856003
         DENT  (DLM),(DLMK,DDNAMEK,PROTECTK,QNAMEK)            @ZA24749 02860003
         DENT  (HOLD),(HOLDK,DDNAMEK,QNAMEK)                   @ZA24749 02864003
         DENT  (DSN),(DSNAMEK,DDNAMEK,QNAMEK,IPLTXIDK,COPIESK, @Z40MPTHX02868003
               BURSTK,MODIFYK,FLASHK,CHARSK)                   @Z40MPTH 02872003
         DENT  (VOL),(VOLUMEK,DDNAMEK,SYSOUTK,COPIESK,BURSTK,  @Z40MPTHX02876003
               MODIFYK,FLASHK,CHARSK,QNAMEK),(SERMK,REFMK)     @ZA24749 02880003
         DENT  (MSVGP),(MSVGPK,SERMK,BURSTK,MODIFYK,CHARSK,     Y30LPTDX02884003
               FLASHK,DSIDK,SYSOUTK,COPIESK,QNAMEK,DDNAMEK)     Y30LPTD 02888003
         DENT  (DSID),(DSIDK,BURSTK,FLASHK,MODIFYK,CHARSK,      Y30OPTDX02892003
               DDNAMEK,MSVGPK,QNAMEK)                          @ZA24749 02896003
         DENT  (BURST),(BURSTK,DSNAMEK,LABELK,VOLUMEK,MSVGPK,  @Z40MPTHX02900003
               DSIDK,QNAMEK,DISPK,AFFK,SEPK,SPLITK,SUBALLOK,   @Z40MPTHX02904003
               AMPK,DDNAMEK,PROTECTK)                          @G32HPPJ 02908003
         DENT  (MODIFY),(MODIFYK,DSNAMEK,LABELK,VOLUMEK,MSVGPK, Z40MPTHX02912003
               DSIDK,QNAMEK,DISPK,AFFK,SEPK,SPLITK,SUBALLOK,   @Z40MPTHX02916003
               AMPK,DDNAMEK,PROTECTK)                          @G32HPPJ 02920003
         DENT  (FLASH),(FLASHK,DSNAMEK,LABELK,VOLUMEK,MSVGPK,   Z40MPTHX02924003
               DSIDK,QNAMEK,DISPK,AFFK,SEPK,SPLITK,SUBALLOK,   @Z40MPTHX02928003
               AMPK,DDNAMEK,PROTECTK)                          @G32HPPJ 02932003
         DENT  (CHARS),(CHARSK,DSNAMEK,LABELK,VOLUMEK,MSVGPK,  @Z40MPTHX02936003
               DSIDK,QNAMEK,DISPK,AFFK,SEPK,SPLITK,SUBALLOK,   @Z40MPTHX02940003
               AMPK,DDNAMEK,PROTECTK)                          @G32HPPJ 02944003
         DENT  (UNIT),(UNITK,DDNAMEK,QNAMEK),(AFFMK,SEPMK)     @ZA24749 02948003
         DENT  (DISP),(DISPK,SYSOUTK,DDNAMEK,BURSTK,MODIFYK,   @Z40MPTHX02952003
               FLASHK,CHARSK,COPIESK,QNAMEK)                   @ZA24749 02956003
         DENT  (SPACE),(SPACEK,SPLITK,SUBALLOK,DDNAMEK,AMPK,QNAMEK)     02972003
*                                                              @ZA24749 02981003
         DENT  (AMP),(AMPK,DYNAK,UCSK,FCBK,  AM/O KEYWORD KEY   YA03225X03006002
               TERMK,DCBK,SYSOUTK,QNAMEK,SPACEK,SPLITK,         YA03225X03007002
               SUBALLOK,BFALNMK,BFTEKMK,BLKSIZMK,BUFLMK,        YA03225X03008002
               BUFNOMK,BUFRQMK,CODEMK,CPRIMK,CYLOFLMK,HIARCHMK, YA03225X03009002
               DENMK,DIAGNSK,DSORGMK,EROPTMK,INTVLMK,KEYLENMK,  YA03225X03010002
               LIMCTMK,LRECLMK,MODEMK,NCPMK,NTMMK,OPTCDMK),,,  @ZA11328X03011003
               (PRTSPMK,RECFMMK,RKPMK,SOWAMK,STACKMK,TRTCHMK,  @ZA11328X03013003
               GNCPMK,GDSORGMK,BUFOFFMK,BUFINMK,BUFOUTMK,       YA03225X03015003
               BUFMAXMK,BUFSIZMK,PCIMK,RESERVMK,THRESHMK,       YA03225X03017003
               IPLTXIDK,BURSTK,MODIFYK,FLASHK,CHARSK,COPIESK)  @Z40MPTH 03019003
         DENT  (LABEL),(LABELK,DDNAMEK,SYSOUTK,BURSTK,MODIFYK, @Z40MPTHX03021003
               FLASHK,CHARSK,COPIESK,QNAMEK),(EXPDTMK,RETPDMK) @ZA24749 03023003
         DENT  (SPLIT),(SPLITK,SPACEK,SUBALLOK,DDNAMEK,AMPK,   @Z40MPTHX03025003
               SYSOUTK,BURSTK,MODIFYK,FLASHK,CHARSK,COPIESK,QNAMEK)     03027003
*                                                              @ZA24749 03029003
         DENT  (COPIES),(COPIESK,DSNAMEK,LABELK,VOLUMEK,MSVGPK, Z40MPTHX03031003
               QNAMEK,DISPK,AFFK,SEPK,SPLITK,SUBALLOK,         @Z40MPTHX03033003
               AMPK,DDNAMEK)                                   @Z40MPTH 03035003
         DENT  (DEST),(DESTK,DDNAMEK,QNAMEK)                   @ZA24749 03037003
         DENT  (FREE),(FREEK,DDNAMEK,QNAMEK)                   @ZA24749 03039003
         DENT  (DSNAME),(DSNAMEK,DDNAMEK,QNAMEK,IPLTXIDK,      @Z40MPTHX03041003
               COPIESK,BURSTK,MODIFYK,FLASHK,CHARSK)           @Z40MPTH 03043003
         DENT  (SUBSYS),(SUBSYSK,SYSOUTK,DDNAMEK,QNAMEK)       @ZA24749 03045003
         DENT  (DUMM),(DUMMK,DYNAK,DDNAMEK,QNAMEK)             @ZA24749 03056003
         DENT  (DYNA),(DYNAK,DUMMK,DSNAMEK,DDNAMEK,VOLUMEK,UNITK, M3131*03067020
               DISPK,SPACEK,DCBK,LABELK,SPLITK,AFFK,SEPK,SYSOUTK, M3131*03070020
               UCSK,SUBALLOK,TERMK,QNAMEK,OUTLIMK,FCBK,DLMK,    YM02710*03073002
               AMPK,COPIESK,DESTK,HOLDK,FREEK,MSVGPK,DSIDK,    @Y30OPSB*03076003
               CHKPTK,BURSTK,MODIFYK,FLASHK,CHARSK,PROTECTK)   @G32HPPJ 03078003
         DENT  (TERM),(TERMK,AMPK,DDNAMEK,PROTECTK,QNAMEK)     @ZA24749 03080003
         DENT  (PROTECT),(PROTECTK,MODIFYK,QNAMEK,UCSK,FCBK,DDNAMEK,   *03082003
               SYSOUTK,TERMK,DYNAK,DLMK,CHARSK,FLASHK,BURSTK)  @G32HPPJ 03084003
         DENT  (SYSOUT),(SYSOUTK,DISPK,DDNAMEK,AFFK,SEPK,VOLUMEK,      C03086003
               LABELK,SPLITK,SUBALLOK,MSVGPK,SUBSYSK,          @G29AN2EC03088003
               QNAMEK,AMPK,CHKPTK,PROTECTK)                    @G32HPPJ 03090003
         DENT  (VOLUME),(VOLUMEK,DDNAMEK,SYSOUTK,COPIESK,      @Z40MPTHX03092003
               BURSTK,MODIFYK,FLASHK,CHARSK,QNAMEK),(SERMK,REFMK)       03094003
*                                                              @ZA24749 03105003
         DENT  (CHKPT),(CHKPTK,SYSOUTK,DDNAMEK,QNAMEK)         @ZA24749 03110003
*  DDNAME IS MUTUALLY EXCLUSIVE WITH THE SAME DD KEYWORDS AS    YM02710 03122002
*  THOSE WITH WHICH DD */DATA ARE MUTUALLY EXCLUSIVE. MUTUAL    YM02710 03124002
*  EXCLUSIVITY FOR DDNAME IS DETERMINED BY MEANS OF A BIT TABLE YM02710 03126002
*  (DASTAB) RATHER THAN BY CHECKING DICTIONARY ENTRIES.         YM02710 03128002
         DENT  (DDNAME),(DDNAMEK,UNITK,LABELK,VOLUMEK,AFFK,SEPK,DISPK,S103130016
               PACEK,SPLITK,DSNAMEK,SYSOUTK,SUBALLOK,UCSK,        O0101X03140019
               QNAMEK,FCBK,FUNCMK,FREEK,SUBSYSK,PROTECTK)      @G32HPPJ 03150003
         DENT  (FCB),(FCBK,DDNAMEK,RKPMK,CYLOFLMK,INTVLMK,AMPK,  Y01113X03152003
               FRIDMK,PROTECTK,QNAMEK)                         @ZA24749 03154003
         DENT  (UCS),(UCSK,RKPMK,CYLOFLMK,INTVLMK,DDNAMEK,        20002X03156003
               RESERVMK,AMPK,PROTECTK,QNAMEK)                  @ZA24749 03158003
         DENT  (QNAME),(QNAMEK,DDNAMEK,DSNAMEK,SYSOUTK,AMPK,   @Z40MPTHX03160003
               IPLTXIDK,MSVGPK,BURSTK,MODIFYK,FLASHK,CHARSK,   @Z40MPTHX03162003
               COPIESK,PROTECTK,CHKPTK,DESTK,DISPK,DLMK,       @ZA24749C03164003
               DSIDK,DUMMK,FCBK,FREEK,HOLDK,LABELK,OUTLIMK,    @ZA24749C03166003
               SPACEK,TERMK,UCSK,UNITK,VOLUMEK,SUBSYSK,        @ZA24749C03168003
               SPLITK,SUBALLOK)                                @ZA24749 03170003
         DENT  (OUTLIM),(OUTLIMK,DDNAMEK,QNAMEK,CPRIMK,        @ZA31145X03172003
               THRESHMK)                                       @ZA31145 03172603
         DENT  (SUBALLOC),(SUBALLOK,SPACEK,SPLITK,DDNAMEK,     @Z40MPTHX03174003
               SYSOUTK,AMPK,BURSTK,MODIFYK,FLASHK,CHARSK,      @Z40MPTHX03176003
               COPIESK,QNAMEK),,(ETEND)                        @ZA24749 03178003
D4LD     DENT  (DEN),(DENMK,DDNAMEK)                               AABA 03190016
         DENT  (FRID),(FRIDMK,FCBK,DDNAMEK)                     YM02710 03195002
         DENT  (NCP),(NCPMK,DDNAMEK,BUFMAXMK)                     20002 03200020
         DENT  (NTM),(NTMMK,DDNAMEK,PCIMK)                        20002 03210020
         DENT  (RKP),(RKPMK,UCSK,DDNAMEK,RESERVMK,FCBK)           20202 03220020
         DENT  (GDSORG),(GDSORGMK,DDNAMEK)                         AABA 03230016
         DENT  (GNCP),(GNCPMK,BFTEKMK,BFALNMK,HIARCHMK,DDNAMEK)  A30036 03240019
         DENT  (BUFL),(BUFLMK,DDNAMEK)                             AABA 03250016
         DENT  (CODE),(CODEMK,KEYLENMK,MODEMK,PRTSPMK,STACKMK,DDNAMEK, C03256018
               TRTCHMK)                                           19373 03262018
         DENT  (CPRI),(CPRIMK,DDNAMEK,THRESHMK,OUTLIMK)        @ZA31145 03266003
         DENT  (MODE),(MODEMK,CODEMK,KEYLENMK,PRTSPMK,DDNAMEK,TRTCHMK)  03276018
*                                                                19373* 03282018
         DENT  (SOWA),(SOWAMK,DDNAMEK)                             AABA 03290016
         DENT  (BFALN),(BFALNMK,GNCPMK,DDNAMEK)                  A30036 03300019
         DENT  (BFTEK),(BFTEKMK,GNCPMK,DDNAMEK)                  A30036 03310019
         DENT  (BUFNO),(BUFNOMK,BUFRQMK,BUFINMK,BUFOUTMK)         20002 03317020
         DENT  (BUFOFF),(BUFOFFMK,DDNAMEK)                        19200 03325019
         DENT  (BUFRQ),(BUFRQMK,BUFNOMK,DDNAMEK,BUFINMK,BUFOUTMK) 20002 03332020
         DENT  (DIAGNS),(DIAGNSK)                                 21042 03332101
         DENT  (DSORG),(DSORGMK,DDNAMEK)                           AABA 03340016
         DENT  (EROPT),(EROPTMK,DDNAMEK)                           AABA 03350016
         DENT  (INTVL),(INTVLMK,UCSK,DDNAMEK,FCBK)                20202 03360020
         DENT  (LIMCT),(LIMCTMK,DDNAMEK)                           AABA 03370016
         DENT  (LRECL),(LRECLMK,DDNAMEK)                           AABA 03380016
         DENT  (OPTCD),(OPTCDMK,DDNAMEK)                           AABA 03390016
         DENT  (PRTSP),(PRTSPMK,CODEMK,KEYLENMK,MODEMK,STACKMK,DDNAMEK,C03396018
               TRTCHMK)                                           19373 03402018
         DENT  (RECFM),(RECFMMK,DDNAMEK)                           AABA 03410016
         DENT  (STACK),(STACKMK,CODEMK,KEYLENMK,PRTSPMK,DDNAMEK,       C03416018
               TRTCHMK)                                           19373 03422018
         DENT  (TRTCH),(TRTCHMK,DDNAMEK,KEYLENMK,MODEMK,CODEMK,STACKMK,C03428018
               PRTSPMK)                                           19373 03434018
         DENT  (CYLOFL),(CYLOFLMK,UCSK,DDNAMEK,RESERVMK,FCBK)     20202 03444020
         DENT  (KEYLEN),(KEYLENMK,CODEMK,MODEMK,PRTSPMK,STACKMK,       C03470018
               DDNAMEK,TRTCHMK)                                   19373 03500018
         DENT  (BUFIN),(BUFINMK,BUFNOMK,BUFRQMK,DDNAMEK)          20002 03510020
         DENT  (BUFOUT),(BUFOUTMK,BUFNOMK,BUFRQMK,DDNAMEK)        20002 03520020
         DENT  (BUFMAX),(BUFMAXMK,NCPMK,DDNAMEK)                  20002 03530020
         DENT  (BUFSIZE),(BUFSIZMK,BLKSIZMK,DDNAMEK)              20002 03540020
         DENT  (PCI),(PCIMK,NTMMK,DDNAMEK)                        20002 03550020
         DENT  (RESERVE),(RESERVMK,RKPMK,UCSK,CYLOFLMK,DDNAMEK)   20002 03560020
         DENT  (THRESH),(THRESHMK,CPRIMK,DDNAMEK,OUTLIMK)      @ZA31145 03570003
         DENT  (IPLTXID),(IPLTXIDK,DDNAMEK,DSNAMEK,QNAMEK)       Y01948 03580001
         DENT  (HIARCHY),(HIARCHMK,GNCPMK,DDNAMEK)               A30036 03600019
         DENT  (FUNC),(FUNCMK,DDNAMEK)                            21088 03650001
         DENT  (BLKSIZE),(BLKSIZMK,BUFSIZMK),,(ETEND)             20002 03670020
D4LUS    DENT  (SEP),(SEPMK,AFFMK)                                      03740000
D4LUA    DENT  (AFF),(AFFMK,SEPMK),,(ETEND)                             03760000
D4LV     DENT  (REF),(REFMK,SERMK)                                      03780000
         DENT  (SER),(SERMK,REFMK,MSVGPK),,(ETEND)             @Y30LPSB 03800003
D6LL     DENT  (EXPDT),(EXPDTMK,RETPDMK)                                03820000
         DENT  (RETPD),(RETPDMK,EXPDTMK),,(ETEND)                       03840000
         MEND                                                           03860000
         EJECT                                                          03880000
         MACRO                                                          03900000
&L       DENT  &A,&B,&C,&D,&E 5TH PARM CONTIN. FOR 2ND PARM    @ZA11328 03920003
         LCLA  &Y,&Z                                                    03940000
         LCLC  &X                                                       03960000
A&SYSNDX DS    0C                                                       03980000
&L       DC    AL1(B&SYSNDX-A&SYSNDX)                                   04000000
&X       SETC  '='                                                      04020000
         AIF   (N'&A LE 1).L1                                           04040000
&X       SETC  '&A(2)'                                                  04060000
.L1      ANOP                                                           04080000
         DC    C'&A(1)&X'                                               04100000
.L2      ANOP                                                           04120000
&Y       SETA  &Y+1                                                     04140000
         DC    AL1(&B(&Y))                                              04160000
         AIF   (&Y LT N'&B).L2                                          04180000
         AIF   (N'&E LT 1).L2B IF NO 5TH PARM., PROCESS 3RD    @ZA11328 04182003
&Y       SETA  0                                               @ZA11328 04184003
.L2A     ANOP                                                  @ZA11328 04186003
&Y       SETA  &Y+1            INCREMENT LOOP CONTROL          @ZA11328 04188003
         DC    AL1(&E(&Y))                                     @ZA11328 04190003
         AIF   (&Y LT N'&E).L2A LOOP IF ALL 5TH NOT DONE       @ZA11328 04192003
.L2B     ANOP                                                  @ZA11328 04194003
&Y       SETA  128                                                      04200000
.L3      AIF   (&Z GE N'&C).L4                                          04220000
&Z       SETA  &Z+1                                                     04240000
         DC    AL1(&Y+&C(&Z))                                           04260000
         AGO   .L3                                                      04280000
.L4      ANOP                                                           04300000
B&SYSNDX DS    0C                                                       04320000
         AIF   ('&D' EQ '').L5                                          04340000
         DC    AL1(ETEND)                                               04360000
.L5      ANOP                                                           04380000
         MEND                                                           04400000
         EJECT                                                          04420000
         MACRO                                                          04440000
&L       JTRT  &A,&B,&C,&D                                              04460000
         LCLA  &X                                                       04480000
BK       EQU   4                   BLANK CHARACTER.                     04500000
PR       EQU   8                   PERIOD CHARACTER.                    04520000
TT       EQU   12                  ILLEGAL CHARACTER.                   04540000
LP       EQU  16                 LEFT PAREN CHARACTER.                  04560000
PL       EQU   20                 PLUS CHARACTER.                       04580000
AM      EQU   24                 AMPERSAND CHARACTER.                   04600000
AS       EQU   28                 ASTERICK CHARACTER.                   04620000
RP      EQU   32                 RIGHT PAREN CHARACTER.                 04640000
MI       EQU   48                 MINUS CHARACTER                       04660000
SL       EQU   52                 SLASH CHARACTER                       04680000
CO       EQU   36                 COMMA CHARACTER.                      04700000
AP       EQU   40                 APOST CHARACTER.                      04720000
EQ      EQU   44                 EQUAL CHARACTER.                       04740000
AL      EQU   0                  ALPHA CHARACTER.                       04760000
NC       EQU   0                  NUMERIC CHARACTER.                    04780000
&L      DC    AL1(&A)            ILLEGAL.                               04800000
         DC    255AL1(&A)         ILLEGAL.                              04820000
         ORG   &L+C' '                 BLANK.                           04840000
         DC    AL1(&B(1))                                               04860000
         ORG   &L+C'.'                 PERIOD.                          04880000
         DC    AL1(&B(2))                                               04900000
         ORG   &L+C'('                                                  04920000
         DC    AL1(&B(3))                                               04940000
         ORG   &L+C'+'                 PLUS.                            04960000
         DC    AL1(&B(4))                                               04980000
         ORG   &L+C'&&'                AMPERSAND.                       05000000
         DC    AL1(&B(5))                                               05020000
         ORG   &L+C'*'                 ASTERICK.                        05040000
         DC    AL1(&B(6))                                               05060000
         ORG   &L+C')'                 RIGHT PAREN.                     05080000
         DC    AL1(&B(7))                                               05100000
         ORG   &L+C'-'                 MINUS.                           05120000
         DC    AL1(&B(8))                                               05140000
         ORG   &L+C'/'                 SLASH.                           05160000
         DC    AL1(&B(9))                                               05180000
         ORG   &L+C','                 COMMA.                           05200000
         DC    AL1(&B(10))                                              05220000
         ORG   &L+C''''                APOST.                           05240000
         DC    AL1(&B(11))                                              05260000
         ORG   &L+C'='                 EQUAL.                           05280000
         DC    AL1(&B(12))                                              05300000
         ORG   &L+C'$'                 ALPHA.                           05320000
         DC    AL1(&C)                                                  05340000
         ORG   &L+C'#'                                                  05360000
         DC    AL1(&C)                                                  05380000
         ORG   &L+C'@'                                                  05400000
         DC    AL1(&C)                                                  05420000
&X       SETA  0                                                        05440000
         ORG   &L+C'A'                 ALPHA.                           05460000
.L2      ANOP                                                           05480000
&X       SETA  &X+1                                                     05500000
         DC    AL1(&C)                                                  05520000
         AIF   (&X LT 9).L2                                             05540000
&X       SETA  0                                                        05560000
         ORG   &L+C'J'                 ALPHA.                           05580000
.L3      ANOP                                                           05600000
&X       SETA  &X+1                                                     05620000
         DC    AL1(&C)                                                  05640000
         AIF   (&X LT 9).L3                                             05660000
&X       SETA  0                                                        05680000
         ORG   &L+C'S'                 ALPHA.                           05700000
.L4      ANOP                                                           05720000
&X       SETA  &X+1                                                     05740000
         DC    AL1(&C)                                                  05760000
         AIF   (&X LT 8).L4                                             05780000
&X       SETA  0                                                        05800000
         ORG   &L+C'0'                 NUMERIC.                         05820000
.L5      ANOP                                                           05840000
&X       SETA  &X+1                                                     05860000
         DC    AL1(&D)                                                  05880000
         AIF   (&X LT 10).L5                                            05900000
         MEND                                                           05920000
         EJECT                                                          05940000
         MACRO                                                          05960000
&L       SCSW  &A,&B,&C                                                 05980000
         GBLB  &Z                                                       06000000
         LCLA  &X                                                       06020000
         LCLC  &Y                                                       06040000
         AIF   (&Z).T1                                                  06060000
O        EQU   1                   ONES.                                06080000
M        EQU   4                   MIXED.                               06100000
Z        EQU   8                   ZEROS.                               06120000
&Z       SETB  1                                                        06140000
.T1      ANOP                                                           06160000
&X       SETA  K'&B-1                                                   06180000
&Y       SETC  '&B'(1,&X)                                               06200000
         AIF   ('&A' EQ 'C').L1                                         06220000
         AIF   ('&A' EQ 'S').L2                                         06240000
&L       TM    &B,&Y                                                    06260000
         BC    &A,&C                                                    06280000
         MEXIT                                                          06300000
.L1      ANOP                                                           06320000
&L       NI    &B,255-&Y                                                06340000
         MEXIT                                                          06360000
.L2      ANOP                                                           06380000
&L       OI    &B,&Y                                                    06400000
         MEND                                                           06420000
         EJECT                                                          06440000
         IEFQMNGR                                                       06460000
         EJECT                                                    19874 06466019
         IEFVKEYS                                                 19874 06472019
         EJECT                                                          06480000
WORKAREA DSECT                                                   Y02668 06520802
         USING WORKAREA,R7                                       Y02668 06521202
WKTTR    DS    CL4                     POINTER TO NEXT RECORD    Y02668 06521602
WKQMPAPT DS    CL4                     ADDRESS OF QMPA           Y02668 06522002
WKRECORD DS    CL168                   COMPRESSED RECORD         Y02668 06522402
WKPTR1   DS    CL4                     POINTER TO ITSELF         Y02668 06522802
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN Y02668 06523202
WKPTR2   DS    CL3                     HOLDER FOR TTR ASSIGNED FRY02668 06523602
*                                      THE QUEUE MANAGER         Y02668 06524002
WKPROCN1 DS    CL8                     PROCEDURE NAME            Y02668 06524402
WKTTR1   DS    CL3                     TTR OF FIRST RECORD       Y02668 06524802
WKPROCN2 DS    CL8                     PROCEDURE NAME            Y02668 06525202
WKTTR2   DS    CL3                     TTR OF FIRST RECORD       Y02668 06525602
WKPROCN3 DS    CL8                     PROCEDURE NAME            Y02668 06526002
WKTTR3   DS    CL3                     TTR OF FIRST RECORD       Y02668 06526402
WKPROCN4 DS    CL8                     PROCEDURE NAME            Y02668 06526802
WKTTR4   DS    CL3                     TTR OF FIRST RECORD       Y02668 06527202
WKPROCN5 DS    CL8                     PROCEDURE NAME            Y02668 06527602
WKTTR5   DS    CL3                     TTR OF FIRST RECORD       Y02668 06528002
WKPROCN6 DS    CL8                     PROCEDURE NAME            Y02668 06528402
WKTTR6   DS    CL3                     TTR OF FIRST RECORD       Y02668 06528802
WKPROCN7 DS    CL8                     PROCEDURE NAME            Y02668 06529202
WKTTR7   DS    CL3                     TTR OF FIRST RECORD       Y02668 06529602
WKPROCN8 DS    CL8                     PROCEDURE NAME            Y02668 06530002
WKTTR8   DS    CL3                     TTR OF FIRST RECORD       Y02668 06530402
WKPROCN9 DS    CL8                     PROCEDURE NAME            Y02668 06530802
WKTTR9   DS    CL3                     TTR OF FIRST RECORD       Y02668 06531202
WKPROCNA DS    CL8                     PROCEDURE NAME            Y02668 06531602
WKTTRA   DS    CL3                     TTR OF FIRST RECORD       Y02668 06532002
WKPROCNB DS    CL8                     PROCEDURE NAME            Y02668 06532402
WKTTRB   DS    CL3                     TTR OF FIRST RECORD       Y02668 06532802
WKPROCNC DS    CL8                     PROCEDURE NAME            Y02668 06533202
WKTTRC   DS    CL3                     TTR OF FIRST RECORD       Y02668 06533602
WKPROCND DS    CL8                     PROCEDURE NAME            Y02668 06534002
WKTTRD   DS    CL3                     TTR OF FIRST RECORD       Y02668 06534402
WKPROCNE DS    CL8                     PROCEDURE NAME            Y02668 06534802
WKTTRE   DS    CL3                     TTR OF FIRST RECORD       Y02668 06535202
WKPROCNF DS    CL8                     PROCEDURE NAME            Y02668 06535602
WKTTRF   DS    CL3                     TTR OF FIRST RECORD       Y02668 06536002
         EJECT                                                          06536102
NEL      DSECT                                                          06537102
         IEFNEL  SUBCOM=C                                               06538102
         EJECT                                                          06540000
         IEFCOMWA                                                Y02668 06560002
         IEFCVRWA                                                       06570002
         EJECT                                                          06580000
         IEFVMSWA                                                       06600000
CVT      DSECT                                                          06603001
         CVT                                                            06606001
         EJECT                                                          06609001
         IEFJMR                                                         06612001
         EJECT                                                          06612502
         IEFTXTFT                                                       06613002
         EJECT                                                          06620000
         IEFJSSOB (CI)                                         @G29AN2E 06625003
         EJECT                                                 @G29AN2E 06630003
         IEFJSSIB                                              @G29AN2E 06635003
         EJECT                                                 @G29AN2E 06640003
         IEFJESCT                                              @G29AN2E 06645003
         EJECT                                                 @G29AN2E 06650003
         IHASUBIT                                              @G29AN2E 06655003
         EJECT                                                 @G29AN2E 06660003
IEFVFA   CSECT                                                          06670020
*C209181                                                       @ZA01934 06670203
*A209182,210410-210720                                         @ZA01934 06670403
*C258484                                                       @ZA01931 06670703
* ADDED CODE NEAR LABEL PRR0                                   @ZA10120 06670803
* ADDED MACRO CODE FOR PROPER ASSEMBLY                         @ZA11328 06670903
* ADDED CODE AFTER LABELS AOFECHCK AOFDERR3                    @ZA13367 06671303
* ADDED STMTS NEAR LABEL FA9 AND BKR3                          @ZA12458 06671403
* CHANGED MVC TO OC WHEN DDNAME= KEY FOUND AFTER LABEL EQRF    @ZA13371 06671503
* CHANGED BNE TO BL NEAR LABEL AOFACC5                         @ZA13424 06671603
* MOVE OI INSTRUCTION FROM COMMA ROUTINE TO EQUAL ROUTINE      @ZA14268 06671803
* CHANGE COMMENT IN MIR ROUTINE                                @ZA14268 06672003
* ADDED CODE AFTER LABEL FAFF1                                 @ZA13844 06672103
* ADDED CODE AFTER LABEL E3                                    @ZA15003 06672203
* SU32 RACF PROTECT SUPPORT                                    @G32HPPJ 06672303
* DELETED 3 INSTRUCTIONS AFTER LABEL T102                      @ZA16422 06672403
* CHANGED CODE IN PERIOD ROUTINE                               @ZA20640 06672503
* CHANGED DENT MACRO FOR QNAME                                 @ZA24749 06672603
* CHANGED AND ADDED CODE AFTER LABEL E3                        @ZA25564 06672703
* ADDED CODE BEFORE AND AFTER LABEL FA32                       @ZA26148 06672903
* MERGE SU4,10,16 CODE TO RELEASE 037 PTF                      @ZA27753 06673203
* CHANGED DENT MACRO FOR OUTLIM,CPRI AND THRESH                @ZA31145 06673303
* ADDED PARAMETERS TO THE DENT MACRO INVOCATIONS FOR OUTLIM,   @ZA31145 06673403
*   THRESH, AND CPRI TO MAKE THEM MUTUALLY EXCLUSIVE WITH EACH @ZA31145 06673503
*   OTHER                                                      @ZA31145 06673603
* ERROR MESSAGE CODES -                                          Y02668 06673703
ERMSG601 EQU   X'01'               IEF601I-INVALID STMT IN PROC. Y02668 06673803
ERMSG612 EQU   X'0C'               IEF612I - PROCEDURE NOT FOUND.Y02668 06673903
ERMSG613 EQU   X'0D'               IEF613I - PROC WITHIN A PROC. Y02668 06674003
ERMSG614 EQU   X'0E'               IEF614I - I/O ERR SEARCHING   Y02668*06674903
                                             FOR PROC.           Y02668 06675002
ERMSG632 EQU   X'20'               IEF632I - FORMAT ERR - 'PGM'. Y02668 06676002
ERMSG639 EQU   X'27'               IEF639I-INVALID CLASS DESIG. YM01546 06676502
ERMSG609 EQU   X'09'               IEF609I - INVALID O'RIDE KEYWDY02668 06677002
ERMSG640 EQU   X'28'               IEF640I - EXCESS # POS PARAM YM03459 06677302
ERMSG641 EQU   X'29'               IEF641I - IMPROPER SUBP LST @G29AN2E 06677403
ERMSG642 EQU   X'2A'               IEF642I - EXCESSIVE PARM LTH YM03459 06677602
ERMSG646 EQU   X'2E'               IEF646I - REQ'D POSIT PARM MISSING   06677703
*                                                              @ZA13367 06677803
ERMSG647 EQU   X'2F'               IEF647I - NON-ALPHA 1ST CHAR. Y02668 06678002
ERMSG744 EQU   X'4C'               IEF744I - SUBSYS. NOT SPEC. @G29AN2E 06678103
ERMSG748 EQU   X'4D'               IEF748I - SUBSYS. NAME INV. @G29AN2E 06678203
ERMSG749 EQU   X'4E'               IEF749I - BUFFER CAPACITY EX@G29AN2E 06678303
ERMSG750 EQU   X'4F'               IEF750I - SYSTEM ERROR      @G29AN2E 06678403
ERWTO417 EQU   X'02'               PROCLIB DEVICE I/O ERROR      Y02668 06678502
INSTPROC EQU   X'80'               PROCESSING INSTREAM PROC BIT. Y02668 06679002
AOMSLONE EQU   C'1'                MSGLEVEL CODE 1.              Y02668 06680002
AOMSLTWO EQU   C'2'                MSGLEVEL CODE 2.              Y02668 06690002
DISPLID  EQU   7                  DISPLACEMENT OF BLOCK ID IN    Y02621 06692002
*                                 SWA QMPA REMOTE LIST.          Y02621 06694002
SYMBUFID EQU   X'25'              ID OF SYMBUF BLOCKS IN SWA     Y02621 06696002
TXTBUFID EQU   X'25'              ID OF TEXTBUF BLOCKS IN SWA    Y02621 06698002
ENDLISTK EQU   X'00'                                             Y02668 06700002
D12      EQU   12                                                  I272 06726101
LAST     EQU   X'80'               TO TURN HI-ORDER BIT ON         I272 06727401
SWAWTOFF EQU   X'7F'               TO TURN OFF AOSWAWRT        @ZA05366 06727503
VFA4     EQU   4             COUNT OF FOUR                       Y02621 06727803
NOKEY    EQU   X'00'               NO SECONDARY MSG            @G29AN2E 06728103
OFFNUM   EQU   1                   OFFSET TO NUM BYTE          @G29AN2E 06728403
OFFLEN   EQU   2                   OFFSET TO LENGTH BYTE       @G29AN2E 06728703
OFFSSNM  EQU   3                   OFFSET TO SSNAME            @G29AN2E 06729003
TWLVZERO EQU   X'C0'               12/0 MULTIPUNCH             @G29AN2E 06729303
M745OO   EQU   0                   OFFSET TO MSG IEF745I       @G29AN2E 06729603
M745OL   EQU   2                   OFFSET TO LEN FOR IEF745I   @G29AN2E 06729903
M746OO   EQU   4                   OFFSET TO MSG IEF746I       @G29AN2E 06730203
M746OL   EQU   6                   OFFSET TO LEN FOR IEF746I   @G29AN2E 06730503
M747OO   EQU   8                   OFFSET TO MSG IEF747I       @G29AN2E 06730803
M747OL   EQU   10                  OFFSET TO LEN FOR IEF747I   @G29AN2E 06731103
L3       EQU   3                   LENGTH 3                    @G29AN2E 06731403
AOLEN    EQU   8                   OFFSET TO LENGTH AREA       @G29AN2E 06731703
AOTXT    EQU   10                  OFFSET TO TEXT AREA         @G29AN2E 06732003
AOTXT1   EQU   11                  OFFSET TO TEXT AREA +1      @G29AN2E 06732303
SSNAMEL  EQU   4                   MAX LENGTH OF SSNAME        @G29AN2E 06732603
AOSSNM   EQU   28                  OFFSET TO SSNAME AREA       @G29AN2E 06732903
         EXTRN VGM90TXT                                        @G29AN2E 06733203
         EXTRN VGM90MOT                                        @G29AN2E 06733503
         SPACE 1                                                 Y0266  06733803
         BALR  RB,0                BASE FOR SCAN CODE.           Y02668 06735802
         USING *,RB,RA             ESTABLISH ADDRESSABILITY.     Y02668 06737802
VFA01    DS    0H                                                  AADA 06740018
*****************************************************************Y02668 06742002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 06744002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 06746002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 06748002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 06750002
         DC    C'VFA '             MOD ID USED BY TRACE.         Y02668 06752002
* TRACE RETURNS HERE.                                            Y02668 06754002
*****************************************************************Y02668 06756002
         B     FA1                 TRANSFER.                            06760000
VFA02    DC    A(VFA01+4096)            SECOND BASE                AADA 06770018
         MODID BRANCH=NO                                         Y02668 06820002
*        DC    C'SU32'            FUNCTION ID                  @G32HPPJ 06830003
*        DC    C'01'              LEVEL # (PROTECT)            @G32HPPJ 06833003
*        DC    C'02'        REMOVE UNNEEDED INSTRUCTIONS IN    @ZA16422 06836003
*                           PAREN ROUTINE                      @ZA16422 06839003
*        DC    C'03'        EQUAL FOLLOWED BY PERIOD SHOULD BE @ZA20640 06842003
*                           AN ERROR                           @ZA20640 06845003
*        DC    C'04'     QNAME MUTUAL EXCLUSIVITY FIX          @ZA24749 06848003
*        DC    C'05'     DO NOT CLEAR SYMBUF IF ERROR ON EXEC           06851003
*                        STATEMENT WITHIN A PROC.              @ZA25564 06854003
*                        (REMOVES PART OF ZA15003)             @ZA25564 06857003
*        DC    C'06'     JCL ERROR IF NON-ALPHA CHAR IN NAME            06860003
*                        WITH EMBEDDED PERIOD                  @ZA26148 06861003
*        DC    C'07'      MERGE SU4,10,16 CODE TO 037 PTF      @ZA27753 06862003
         DC    C'08'  OUTLIM,THRESH & CPRI MUTUAL EXCLUSIVE FIX@ZA31145 06862503
*                                                                       06866003
         EJECT                                                          06869003
*          **********************************************************   06880000
*          *                                                        *   06900000
*          *   ENTERED  FROM INTERP CONTROL RTNS.     INITIALIZES   *   06920000
*          *   POINTERS,  CHECKS COL 72 FOR  NONBLANK  CHARACTER.   *   06940000
*          *                                                        *   06960000
*          **********************************************************   06980000
FA1      DS    0H                 START OF SCAN.                        07000000
         L     R8,CTRLWAP            LOCAL WORK AREA POINTER            07020000
         ST    RA,DELPTR           RA IS PTR TO 'RSTMT' OR         AADA 07020318
*                                     'PSTMT' IN IWA.              AADA 07020618
*                                      SAVE RA IN LOCAL WORK AREA  AADA 07020918
*                                      TO FREE IT FOR USE AS BASE. AADA 07021218
         L     RA,VFA02            LOAD BASE.                      AADA 07021518
         MVI   DLMFBYTE,INITVAL    INITIALIZE THE DELIMITER FUNC-  7821 07022017
*                                  TION BYTE.  X'7F' IS NOT EQUAL  7821 07024017
*                                  TO ANY OF THE FUNCTION BYTE     7821 07026017
*                                  VALUES IN THE TRT TABLE USED BY 7821 07028017
*                                  THE FB1 ROUTINE.  NOTE THAT THE 7821 07030017
*                                  HIGH ORDER BIT OR EQUAL SIGN    7821 07032017
*                                  DELIMITER(EQDELSW) IS TURNED    7821 07034017
*                                  OFF ALSO.                       7821 07036017
         ST    R9,CBEGP            SAVE POINTER TO START OF CARD AREA.  07120000
         LR    R7,R9               SAVE POINTER.                        07140000
         LA    R7,SVO(R7)          COMPUTE CARD COLUMN 72.              07160000
         MVC   FAWA1(1),0(R7)     SAVE PUNCH IN COL 72                  07180000
         SCSW  C,COLSTY            ZERO COLUMN 72 SW.                   07200000
         SCSW  O,CXPNZ,FA3        TRANSFER CONTIN NOT RCVD              07220000
         CLI   0(R7),C' '          IS COLUMN 72 BLANK.                  07240000
         BC    EQUAL,FA3           YES TRANSFER.                        07260000
         SCSW  S,COLSTY            NO SET COLUMN 72 SW ON.              07280000
         MVI   0(R7),C' '         BLANK COL 72                          07300000
FA3      DS    0H                  ENTRY.                               07320000
*          **********************************************************   07340000
*          *                                                        *   07360000
*          *   TRANSFER TO PREPARE  FOR  CONTINUE OF SCAN IF CON-   *   07380000
*          *   TINUATION OF  PRECEDING CARD IS EXPECTED.   OTHER-   *   07400000
*          *   WISE  ZERO LOCAL SWITCHES.   TRANSFER  TO SCAN  IF   *   07420000
*          *   CARD IS FROM PROC AND IS TO BE OVERRIDDEN,  IF NOT   *   07440000
*          *   FROM PROC ETC, CLEAR DUPLICATE TABLE (DUPTB),  AND   *   07460000
*          *   PROCESS THIS CARD.                                   *   07480000
*          *                                                        *   07500000
*          **********************************************************   07520000
         ST    R7,CENDP            SAVE END POINTER FOR LENGTH.         07540000
         L     R7,AFB7            ADDRESS OF TRANSLATE TABLE            07544000
         ST    R7,FATRP           SAVE FOR SYMBOLIC PARAM RTN           07548000
         LA    R7,E1              ADDRESS OF SCAN ERROR RTN             07552000
         ST    R7,FERRP           SAVE FOR SYMBOLIC PARAMETER RTN       07556000
         MVI   INTBUF,0           ZERO LENGTH OF INTERMEDIATE BUFFER    07560000
         SR    R7,R7                                                    07564000
         ST    R7,INTBUF-ITBMSGL  CLEAR TTR FIELD OF BUFFER             07568000
*                                      USED BY INTBUF (INTBUF EQUATE)   07572000
         L     RF,DELPTR                GET PTR SAVED ON ENTRY TO  AADA 07582018
*                                         THIS ROUTINE.            AADA 07588018
         IC    R7,LISTPTR(RF)           GET OFFSET TO OPERANDS     AADA 07594018
         BCTR  R7,R0               DECREMENT OFF SET BY ONE.            07600000
         AR    R7,R9               COMPUTE STRING POINTER.              07620000
         ST    R7,CSTRP            SAVE STRING POINTER.                 07640000
         MVC   MSGKEY(1),FAWA2     GET MOST RECENT KEY FOR         AACA 07646017
*                                      SECONDARY MESSAGE           AACA 07652017
         SCSW  O,CXPZ,FA9          TRANSFER CONT EXP SW ON.             07660000
         SCSW  C,CLEARSWW         ZERO SWITCHES.                        07680000
         NI    SWY2,255-KEYNXTSW  CLEAR SW FOR NO MORE POSITIONAL M0297 07681020
         TM    DDOVZ,DDOV         IS IT OVERRIDDEN PROCEDURE      M0297 07682020
         BO    FA3001              YES, NO NEED FOR NEW PREFIX.  Y02668 07683002
* NOT CONTINUTATION AND NOT OVERRIDE - START OF NEW TEXT STRING. Y02668 07685302
         BAL   RE,AOPX             CREATE TEXT STRING PREFIX.    Y02668 07685602
FA3001   DS    0H                                                 M0297 07686020
         NI    ENDKYSWP,255-ENDKYSW TURN OFF SWITCH               M0482 07692020
         CLI   VERB(RF),4               IS VERB DD                 AADA 07700018
         BNE   FA3B                NO THEN TRANSFER               20033 07710020
*                                                                       07721000
*        IF THE OPERAND FIELD BEGINS WITH A SYMBOLIC PARAMETER          07722000
*        GO TO IEFVFB TO BUILD TEXT IN INTBUF.  (IF FIRST SYMBOLIC      07723000
*        IS DUMMY IT WILL BE CHANGED TO A KEYWORD, DUMM=).              07724000
*                                                                       07725000
         SPACE                                                          07725217
         OC    SYMTTR(VFA4),SYMTTR   DOES SYMBUF HAVE A TTR?     Y02621 07725402
         BZ    FA3002              NO - THEREFOR.NO SYMBOLICS    Y02621 07725602
         SPACE                                                          07725817
         CLI   1(R7),C'&&'        IS FIRST CHAR = AMPERSAND             07726000
         BNE   FA3002             NO  - TRANSFER, NO SYMBOLIC           07727000
         NI    AMPSWZ,255-AMPSW   TURN OFF SYMBOLIC BIT          A27310 07727519
         LA    R1,1(R7)           YES- GET PTR TO AMPERSAND             07728000
         XC    SYMBUF(VFA4),SYMBUF  INDICATE NO TTR IN SYMBUF    Y02621 07728502
         ST    R1,CBSYP           POINTER FOR SYMBOLIC PARAM RTN        07729000
         L     RF,FIEFVFB         GET SYMBOLIC PARAM RTN                07730000
         BALR  RE,RF              GO TO SYMBOLIC PARAM RTN              07731000
         L     R7,CSTRP           RESTORE REGISTER                      07732000
FA3002   DS    0H                                                       07733000
         L     R1,TEXTBUFP         ADDR OF TEXT STRING.          Y02668 07735002
         USING TEXT,R1             PREFIX ADDRESSABILITY.        Y02668 07737002
         CLC   FAI(5),1(R7)       IS OPERAND DUMMY                      07740000
         BC    NOT-EQUAL,FA3A     NO - CONTINUE                         07760000
         OI    STRDINDC,DTXDUMMY   INDICATE DUMMY DD FOR IEFVDA. Y02668 07774002
         MVI   5(R7),C'='         YES - MAKE DUMMY A KEYWORD            07780000
FA3A     DS    0H                                                       07800000
         CLC   FAJ(5),1(R7)        IS OPERAND DYNAM               20033 07803020
         BC    NOT-EQUAL,FA3B      NO CONTINUE                    20033 07806020
         SCSW  Z,DDOVZ,FA3A01      TRANSFER NOT O'RIDDEN PROC  @ZA04797 07806603
         SCSW  S,FLUSHSWW          FLUSH DYNAM IF PROC O'RIDE  @ZA04797 07807003
         B     FA3B                BYPASS DYNAM                @ZA04797 07807803
FA3A01   DS    0H                                              @ZA04797 07808203
         OI    STRDINDC,DTXDYNAM   SET DYNAM BIT.                Y02668 07809002
         DROP  R1                                                Y02668 07810002
         MVI   5(R7),C'='          YES MAKE IT A KEYWORD          20033 07812020
FA3B     DS    0H                                                 20033 07815020
         SCSW  Z,DDOVZ,FA31       TRANSFER NOT OVERRIDDEN PROC          07820000
         SCSW  Z,PROCERRZ,FA91    TRANSFER NO ERROR THIS STATEMENT      07840000
         SCSW  S,CMTZ             YES- SET COMMENT SW                   07860000
         SCSW  S,FERRORA             - SET DD ERROR                     07880000
         B     FAC                                                      07900000
FA31     DS    0H                 ENTRY NO OVERRIDE                     07920000
         OI    LPBYSWZ,LPBYSW     INITIALIZE TO ON                 AACA 07926017
*                                      ( LEFT PAREN CHECK NOT      AACA 07932017
*                                        MADE FOR VERB KEYS )      AACA 07938017
         SCSW  C,CLEARVZ          ZERO SWITCHES                         07944018
         SCSW  C,PROCSWZ          CLEAR EXEC PROC INDICATOR             07950000
         CLI   INTBUF,0           IS TEXT IN INTBUF                     07952000
         BNE   FA3102             YES - TRANSFER                        07954000
         XC    SYMBUF(VFA4),SYMBUF  INDICATE NO TTR IN SYMBUF    Y02621 07956002
*              BY ZEROING TTR FIELD IN SYMBOLIC BUFFER           Y02621 07957002
FA3102   DS    0H                                                       07958000
         XC    DUPTAB(L'KEYTAB+L'DUPTAB),DUPTAB     INITIALIZE  YM02705 07976002
*                                 THE DUPTAB AND KEYTAB TABLES. YM02705 07986002
         SR    R7,R7               CLEAR REGISTER.                      08000000
         STH   R7,CURLE            ZERO CURRENT LEVEL.                  08020000
         STH   R7,LASLE            ZERO LAST LEVEL.                     08040000
         L     R6,TBEGP            GET TEXT BEGIN POINTER.              08060000
         ST    R6,TKEYP            SET TEXT KEY POINTER.                08120000
         ST    R6,TLENP            INITIALIZE WITH KEY ADDR. KEY Y02668*08126002
                                   RTNE (K1) MAKES IT COME OUT OKY02668 08132002
         LA    R6,1(R6)            BUMP BY ONE TO INIT.                 08140000
         ST    R6,TNUMP            SET TEXT NUMBER POINTER.             08160000
         LA    R6,1(R6)            BUMP BY ONE TO INIT.                 08180000
         STC   R7,0(R6)            ZERO TLENP BYTE.                     08200000
         LA    R6,2(R9)            BUMP CHAR BEG POINTER.               08240000
         L     RF,DELPTR                GET PTR SAVED ON ENTRY     AADA 08250018
         IC    R7,NAMEL(RF)                                        AADA 08260018
         LA    R5,0(R7,R6)        COMPUTE CHARACTER END SYMBOL POINTER. 08280000
         ST    R5,CESYP           SAVE POINTER.                         08300000
*          **********************************************************   08320000
*          *                                                        *   08340000
*          *   EXAMINE  LABEL AND SET POINTER (CBSYP) AS FOLLOWS:   *   08360000
*          *                                                        *   08380000
*          *   CARD IMAGE=//     - CBSYP POINTS TO COL. 3           *   08400000
*          *             =//A    -                 CHAR 'A'         *   08420000
*          *             =//A.B  -                 CHAR 'B'         *   08440000
*          *                                                        *   08460000
*          **********************************************************   08480000
         CLI   0(R6),C'A'         IS 1ST CHAR ALPHA-NUMERIC    @ZA26148 08486003
         BC    LOW,FA32B          NO,CHECK OTHER VALID CHARS   @ZA26148 08490003
FA32     DS    0H                 FOR LOOP.                             08500000
         CLI   0(R6),C'.'         IS CHARACTER PERIOD.                  08520000
         BNE   FA32A              NO,CONTINUE                     22553 08524018
         SCSW  C,VERBSWY          CLEAR VERB SWITCHES             22553 08528018
         TM    VERB(RF),4         IS VERB 'DD'                   A27940 08530019
         BNO   FA33               NO, INCLUDE PERIOD IN LABEL    A27940 08532019
         B     FA34               YES,PROCESS LABEL AFTER '.'    A27940 08534019
FA32A    CLI   0(R6),C' '         IS CHARACTER BLANK.             22553 08556018
         BC    EQUAL,FA33         YES TRANSFER.                         08580000
         LA    R6,1(R6)           NO BUMP POINTER.                      08600000
         B     FA32               TRANSFER BACK.                        08620000
FA32B    CLI   0(R6),C' '         NAME FIELD BLANK?            @ZA26148 08626003
         BE    FA32               YES,CONTINUE                 @ZA26148 08627003
         CLI   0(R6),C'$'         NATIONAL CHARACTER?          @ZA26148 08628003
         BE    FA32               YES,OK                       @ZA26148 08629003
         CLI   0(R6),C'#'         NATIONAL CHARACTER?          @ZA26148 08630003
         BE    FA32               YES,OK                       @ZA26148 08631003
         CLI   0(R6),C'@'         NATIONAL CHARACTER?          @ZA26148 08632003
         BE    FA32               YES,OK                       @ZA26148 08633003
         LA    R2,ERMSG647        NON-ALPHA 1ST CHAR OF NAME   @ZA26148 08634003
         B     E1                 BRANCH TO ERROR ROUTINE      @ZA26148 08635003
FA33     DS    0H                 ENTER.                                08640000
         LA    R6,1(R9)           RESTORE POINTER BEFORE LABEL.         08660000
*          **********************************************************   08680000
*          *                                                        *   08700000
*          *   IDENTIFY VERB AND SET APPROPRIATE   SWITCH.          *   08720000
*          *                                                        *   08740000
*          **********************************************************   08760000
FA34     DS    0H                 ENTER.                                08780000
         LA    R6,1(R6)           BUMP POINTER TO 1ST CHARACTER LABEL.  08800000
         ST    R6,CBSYP           SAVE CHARACTER BEGIN SYM POINTER.     08820000
         SCSW  C,VERBSWY           CLEAR VERB SWITCHES.                 08840000
         CLI   VERB(RF),X'08'           IS THIS PROC VERB          AADA 08856018
         BE    FA402                    YES-  GO PROCESS AS EXEC   AADA 08864018
         CLI   VERB(RF),2               NO -  COMPARE TO CODE FOR EXEC  08872018
         BC    HIGH,FA5            TRANSFER DD CARD.                    08880000
         BC    EQUAL,FA4           TRANSFER EXEC CARD.                  08900000
         SCSW  S,JOBSWY            SET JOB CARD SWITCH.                 08920000
         MVI   IWAJMSGL,AOMSGLV1   INITIALIZE TO MSGLEVEL=1 TO  YM06865*08925002
                                   PRINT COMMENT CARDS BETWEEN  YM06865*08930002
                                   JOB CARD CONTINUATIONS.      YM06865 08935002
         LA    R7,JOBK             GET JOB KEY.                         08940000
         B     FA6                 TRANSFER.                            08960000
FA402    DS    0H                                                       08966000
         SCSW  S,VERBCSWZ         INDICATE A PROC VERB                  08972000
FA4      DS    0H                  ENTRY FOR EXEC CARD.                 08980000
         SCSW  S,EXECSWY           SET EXEC CARD SWITCH.                09000000
         NI    AOSW2,255-AOPROCNM  CLEAR POSITIONAL PROCNM SW.   Y02668 09000102
         L     R7,TEXTBUFP         TEXT STRING ADDRESS.         YM00379 09000202
         USING TEXT,R7             TEXT PREFIX ADDRESSABILITY.  YM00379 09000402
         TM    SWH,CPSYSFLG        CHECKPT/RESTART EXEC?        YM00379 09000602
         BZ    FA406               BRANCH NO.                   YM00379 09000802
         OI    STREINDC,ETXCPFLG   SET C/R FLAG IN PREFIX.       Y02668 09001002
         NI    SWH,255-CPSYSFLG    CLEAR C/R EXEC FLAG.         YM00371 09001102
FA406    DS    0H                                                Y02668 09001402
         TM    SWE,PROC            EXEC READ FROM PROC?          Y02668 09002002
         BZ    FA404               BRANCH NO.                    Y02668 09004002
         OI    STREINDC,ETXPROC    SET PROC BIT IN PREFIX.       Y02668 09010002
         DROP  R7                                                Y02668 09012002
FA404    DS    0H                                                Y02668 09014002
         TM    SWE,PREF            IS THIS PROC END OF FILE ?   YA02705 09015002
         BZ    FA408               NO - DO NOT RESET PROC SW    YA02705 09016002
         NI    SWE,255-PROC-GPI-PREF-PRCV-CONCAT-POVRD-POVRX-SEQUENCE   09017002
*      EXEC ENCOUNTERED NOT FROM PROC  CLEAR PROC SWITCH        YA02705 09018002
         XC    SYMTTR(VFA4),SYMTTR CLEAR BUFFER FOR NEXT PROC   YM02713 09018502
         NI    AOSW2,SWAWTOFF      CLEAR INDICATOR FOR IEFVHA  @ZA05366 09018703
FA408    DS    0H                                               YM02705 09019002
         LA    R7,EXECK            GET EXEC KEY.                        09020000
         B     FA6                 TRANSFER.                            09040000
FA5      DS    0H                  ENTRY FOR DD CARD.                   09060000
         SCSW  S,DDSWY             SET DD CARD SWITCH.                  09080000
         LA    R7,DDK              GET DD KEY.                          09100000
*          **********************************************************   09120000
*          *                                                        *   09140000
*          *   PUT VERB KEY INTO TEXT BUFFER,   TRANSLATE   LABEL   *   09160000
*          *   FOR VALIDITY,  AND  PUT LABEL IN  TEXT  BUFFER.      *   09180000
*          *                                                        *   09200000
*          **********************************************************   09220000
FA6      DS    0H                  ENTRY.                               09240000
         BAL   R9,K1               PUT KEY IN TEXT.                     09260000
         SCSW  Z,VERBCSWZ,FA60    TRANSFER NOT PROC VERB                09265000
         MVI   MSGKEY,PSECMSG      PROC SECONDARY MSG CODE        19874 09270019
FA60     DS    0H                                                       09275000
         L     R1,CBSYP           GET BEGIN SYMBOL POINTER FOR LABEL.   09280000
         SR    R2,R2              CLEAR REGISTER.                       09300000
         L     R3,AFB7            GET ADDRESS OF TRANSLATE TABLE.       09320000
         L     R5,CESYP           GET END SYMBOL POINTER FOR LABEL.     09340000
         SR    R5,R1              COMPUTE LENGTH OF LABEL.              09360000
         EX    R5,FB6             EXECUTE TRANSLATE.                    09380000
         BC    13,FA61            IS LAST FUNCTION BYTE NONZERO.        09400000
         LA    R1,4               YES LOAD REGISTER WITH FOUR.          09420000
         CLR   R1,R2              IS DELIMITER A BLANK.                 09440000
         BC    EQUAL,FA62         YES TRANSFER.                         09460000
FA61     DS    0H                 ENTRY FOR ERROR.                      09480000
         LA    R2,ERMES4          GET ERROR NUMBER.                     09500000
         B     E1                 GO TO ERROR ROUTINE.                  09520000
FA62     DS    0H                 ENTER.                                09540000
         SCSW  S,LDLX              SET SWITCH FOR SUBLIST.              09560000
         BAL   R7,T1               PUT LABEL IN TEXT.                   09580000
*          **********************************************************   09600000
*          *                                                        *   09620000
*          *   TRANSFER TO BEGIN SCAN IF JOB OR EXEC CARD           *   09640000
*          *                                                        *   09660000
*          **********************************************************   09680000
         SCSW  Z,DDSWY,FA91        TRANSFER FOR JOB OR EXEC CARD.       09700000
         L     R7,TKEYP           LOAD POINTER TO DD KEY IN TEXT.Y02113 09701002
         LA    R7,2(R7)           ADD 2 TO POINT TO NAME LENGTH. Y02113 09702002
         CLI   0(R7),STPCTLEN     IS LENGTH OF NAME 7?           Y02113 09703002
         BNE   FA63               NO,CANNOT BE STEPCAT DD CARD.  Y02113 09704002
         LA    R7,1(R7)           ADD 1 TO POINT TO NAME ITSELF. Y02113 09705002
         CLC   0(7,R7),STEPCATN   IS THE NAME STEPCAT?           Y02113 09706002
         BNE   FA63               NO,CONTINUE NORMAL DD PROCESS. Y02113 09707002
         LA    R7,WAEXCPFX       YES,ADDRESS OF EXEC CARD PREFIX Y02113 09708002
         USING TEXT,R7                                                  09709002
         OI    STREINDC,ETXSTPCT   INDICATE STEP HAS STEPCAT DD. Y02668 09710002
         DROP  R7                                                       09712002
FA63     DS    0H                                                Y02113 09713002
         L     R7,CSTRP            GET CHARACTER STRING POINTER.        09720000
         CLI   1(R7),C'*'        IS THIS DD*                       AABA 09730016
         BE    FA7                YES- GO PROCESS DD*              AABA 09740016
         CLC   1(4,R7),FAG        NO - CHECK FOR DD DATA           AABA 09750016
         BNE   FA91               TRANSFER NOT * OR DATA           AABA 09760016
         LA    R7,3(R7)           ADJUST R7 FOR THE COMPARE BELOW  AABA 09780016
FA7      DS    0H                                                  AABA 09790016
         CLI   2(R7),C' '          DELIMITER A BLANK?            Y02668 09796002
         BE    FA701               BRANCH YES.                   Y02668 09800002
         CLI   2(R7),C','          DELIMITER A COMMA?            Y02668 09804002
         BNE   FA91                BR TO TRANSLATE. ERROR, BUT   Y02668*09808002
                                   WILL BE CAUGHT FURTHER ON.    Y02668 09812002
* DD */DATA STATEMENT.                                           Y02668 09816002
FA701    DS    0H                                                Y02668 09820002
         TM    SWE,GPI             PROC INPUT SWITCH ON?         Y02668 09824002
         BZ    FA702               BRANCH NO TO CONTINUE SCAN.   Y02668 09828002
* DD */DATA FOUND IN PROCEDURE - ERROR.                          Y02668 09832002
         LA    R2,ERMSG601         LOAD MESSAGE CODE.            Y02668 09836002
         B     E1                  BRANCH TO ERROR ROUTINE.      Y02668 09840002
FA702    DS    0H                                                Y02668 09844002
         L     R1,TEXTBUFP         TEXT STRING ADDRESS.          Y02668 09848002
         USING TEXT,R1             PREFIX ADDRESSABILITY.        Y02668 09852002
         OI    STRDINDC,DTXSYSIN   SET SYSIN BIT.                Y02668 09856002
         DROP  R1                                                Y02668 09860002
         MVC   DUPTAB(EDASTAB-DASTAB),DASTAB SET BITS IN DUPTAB    AABA 09880016
*                                            FOR ALL KEYWORDS      AABA 09890016
*                                            MUTUALLY EXCLUSIVE    AABA 09900016
*                                            WITH DD* OR DATA.     AABA 09910016
         B     FA91                                                AABA 09920016
*                                                                  AABA 09930016
         EJECT                                                          09935002
DASTAB   DS    0H                                                  AABA 09940016
*        DASTAB IS A TABLE OF BITS USED TO REPLACE THE DD          AABA 09950016
*        KEYWORD ENTIRES IN THE DUPLICATE TABLE.  EACH BIT         AABA 09960016
*        CORRESPONDS TO HEX VALUE FOR A KEYWORD AS ASSIGNED        AABA 09970016
*        IN THE IEFVKEYS MACRO.  THOSE BITS CORRESPONDING TO       AABA 09980016
*        KEYWORDS PERMITTED ON DD* STATEMENTS ARE SET TO ZERO.     AABA 09990016
*        THOSE MUTUALLY EXCLUSIVE WITH DD* ARE SET TO ONE.         AABA 10000016
*                                                                  AABA 10010016
         SPACE                                                          10020016
*  KEYS                                KEYWORDS ALLOWED ON DD*     AABA 10030016
*  -----                                -------- ------- -- ---    AABA 10040016
         SPACE                                                          10050016
*  00-07 **************************                                AABA 10060016
         DC    BL1'11111111'                                       AABA 10070016
         SPACE                                                          10080016
*  08-0F **************************                                AABA 10090016
         DC    BL1'11111111'                                      19874 10100019
         SPACE                                                          10110016
*  10-17 **************************                                AABA 10120016
         DC    BL1'11111111'                                       AABA 10130016
         SPACE                                                          10140016
*  18-1F **************************                                AABA 10150016
         DC    BL1'11111111'                                       AABA 10160016
         SPACE                                                          10170016
*  20-27 **************************                                AABA 10180016
         DC    BL1'10111111'     DSID                          @Y30OPSB 10190003
         SPACE                                                          10200016
*  28-2F **************************                                AABA 10210016
         DC    BL1'11101111'       DLM                          YM02719 10220002
         SPACE                                                          10230016
*  30-37                                                                10240016
         DC    BL1'11111111'                                       AABA 10250016
         SPACE                                                          10260016
*  38-3F                                                                10270016
         DC    BL1'11111111'                                       AABA 10280016
*    40-47 ************                                           19874 10280719
         DC    BL1'01101111'      DCB,VOL                      @Y30OPSB 10281403
*    48-4F ************                                           19874 10282119
         DC    BL1'11111110'      SER                          @Y30OPSB 10282803
*    50-57 ************                                           19874 10283519
         DC    BL1'11111010' BLKSIZE,BUFNO                        19874 10284219
*    58-5F ************                                           19874 10284919
         DC    BL1'11111111'                                      19874 10285619
*    60-67 ************                                           19874 10286319
         DC    BL1'11101111'      LRECL                        @Y30OPSB 10287003
*    68-6F ************                                           19874 10287719
         DC    BL1'11111111'                                      19874 10288419
         SPACE                                                          10290016
EDASTAB  DS    0H END OF TABLE                                     AABA 10300016
         EJECT                                                  YM02719 10310002
DASTAB1  DS    0H                                               YM02719 10316002
*        DASTAB1 TABLE IS A BIT MASK REPRESENTING THE           YM02719 10322002
*        MUTUALLY EXCLUSIVE BIT SETTINGS IN DUPTAB FOR          YM02719 10328002
*        THE DDNAME KEYWORD.                                    YM02719 10334002
*                                                               YM02719 10340002
* KEYS                             KEYWORDS ALLOWED ON DDNAME   YM02719 10346002
*                                                               YM02719 10352002
* 00-07                                                         YM02719 10358002
         DC    BL1'11111111'                                    YM02719 10364002
* 08-0F                                                         YM02719 10370002
         DC    BL1'11111111'                                    YM02719 10376002
* 10-17                                                         YM02719 10382002
         DC    BL1'11111111'                                    YM02719 10388002
* 18-1F                                                         YM02719 10394002
         DC    BL1'11111111'                                    YM02719 10400002
* 20-27                                                         YM02719 10406002
         DC    BL1'11111111'                                    YM02719 10412002
* 28-2F                                                         YM02719 10418002
         DC    BL1'11011111'       DIAGNS                       YM02719 10424002
* 30-37                                                         YM02719 10430002
         DC    BL1'11111111'                                    YM02719 10436002
* 38-3F                                                         YM02719 10442002
         DC    BL1'11111111'                                    YM02719 10448002
* 40-47                                                         YM02719 10454002
         DC    BL1'01111111'       DCB                          YM02719 10460002
* 48-4F                                                         YM02719 10466002
         DC    BL1'11111111'                                    YM02719 10472002
* 50-57                                                         YM02719 10478002
         DC    BL1'11111010'       BLKSIZE,BUFNO                YM02719 10484002
* 58-5F                                                         YM02719 10490002
         DC    BL1'11111111'                                    YM02719 10496002
* 60-67                                                         YM02719 10502002
         DC    BL1'11111111'                                    YM02719 10508002
* 68-6F                                                         YM02719 10514002
         DC    BL1'11111111'                                    YM02719 10520002
         SPACE 1                                                YM02719 10526002
EDASTAB1 DS    0H                  END OF TABLE                 YM02719 10532002
         EJECT                                                  YM02719 10538002
*          **********************************************************   10560000
*          *                                                        *   10580000
*          *   ENTRY IF CARD IS AN EXPECTED CONTINUATION.           *   10600000
*          *                                                        *   10620000
*          **********************************************************   10640000
FA9      DS    0H                  ENTRY.                               10645003
         SCSW  C,CXPOPZ            TURN OFF CONT EXP OPERAND   @ZA12458 10650003
         SCSW  C,CXPZ              TURN OFF CONT EXP SWITCH.            10680000
         SCSW  S,ENDSZ             TURN ON END SCAN SWITCH.             10700000
         SCSW  O,CMTZ,FAC          TRANSFER COMMENT SWITCH ON.          10720000
         SCSW  O,CXPNZ,E1         CONTIN EXPECTED - NOT RCVD            10740000
         SCSW  Z,CXPCZ,FA91       TRANSFER NOT CONT EXP & CANC     AACA 10748016
        LA    R7,ENDK            GET END KEY                       AACA 10756016
        BAL   R9,K1              PUT END KEY IN TEXT               AACA 10764016
        B     FAB                                                  AACA 10772016
*          **********************************************************   10780000
*          *                                                        *   10800000
*          *   ENTRY TO PREPARE FOR SCAN.                           *   10820000
*          *                                                        *   10840000
*          **********************************************************   10860000
FA91     DS    0H                  ENTRY.                               10880000
         SCSW  C,ENDSZ             TURN OFF END SCAN SWITCH.            10900000
         TM    JOBSWY,JOBSW       IS THIS A JOB CARD?            A49636 10950001
         BZ    FB1                NO. GO TO ELEMENT SCAN.        A49636 10960001
*                                 YES. TEST FOR OPERANDS.        A49636 10970001
         L     R1,CSTRP           GET CHAR. STRING PTR.          A49636 10980001
         LA    R1,DEC1(R1)        ADJUST PLUS ONE.               A49636 10990001
         L     R5,CENDP           GET COL. 72 LOCATION.          A49636 10992001
         LA    R5,DEC0(R5)        CLEAR HI ORDER BYTE.           A49636 10994001
         CR    R5,R1              IS CSTRP NOW AT COL. 72?       A49636 10996001
         BE    BKR2               YES. NO OPERANDS EXIST.        A49636 10998001
*                                 GO SET END KEY.                A49636 10998401
         B     FB1                NO. GO TO ELEMENT SCAN.        A49636 11000001
         EJECT                                                          11020000
*          *********************************************************    11040000
*          *                                                       *    11060000
*          *      SCAN EXIT ROUTINE                                *    11080000
*          *                                                       *    11100000
*          *********************************************************    11120000
FAA      DS    0H                  RETURN FOR ELEMENT SCAN ROUTINES.    11140000
         SCSW  Z,ENDSZ,FAC         TRANSFER END SCAN SW OFF.            11160000
FAB      DS    0H                  ENTRY FOR CONT EXP & CANCELLED.      11180000
         SR    R7,R7               CLEAR REGISTER.                      11200000
         AH    R7,CURLE            IS CURRENT LEVEL ZERO.               11220000
         BC    ZERO,FAC            TRANSFER CURRENT LEVEL ZERO.         11240000
         LA    R2,ERMES7           GET ERROR MESSAGE NUMBER.            11260000
         L     R5,TBEGP            GET VERB KEY FOR THIS STMT.   Y02668 11280002
         MVC   MSGKEY(1),0(R5)     FOR ENTRY IN SECONDARY MSG.   Y02668 11290002
         B     E1                 TRANSFER ERROR                        11300000
FAC      DS    0H                  ENTRY.                               11320000
         SCSW  Z,COLSTY,FAD        TRANSFER COL 72 BLANK.               11340000
         SCSW  S,CXPZ              TURN ON CONT EXP SW.                 11360000
         SCSW  Z,ENDSZ,FAE         TRANSFER END SCAN SW OFF.            11380000
         SCSW  S,CMTZ              TURN ON COMMENT SWITCH.              11400000
         B     FAE                 TRANSFER.                            11420000
FAD      DS    0H                  ENTRY.                               11440000
         SCSW  C,CMTZ              TURN OFF COMMENT SWITCH.             11460000
FAD1     DS    0H                 ENTRY FROM ERROR RTN FOR CXPN         11480000
         L     RF,QPARM+QMPCL-QMNAM REMOTE LIST ADDRESS            AADA 11481018
         OC    SYMBUF(VFA4),SYMBUF IS THERE  A SYMBUF TO WRITE?  Y02621 11483002
         BZ    FAFF                IF ZERO FIELD NO - TRANSFER   Y02621 11484002
         MVC   4(4,RF),SYMBUF      YES- GET SYMBUF TTR             AADA 11485018
         MVI   DISPLID(RF),SYMBUFID  BLOCK ID INTO REMOTE LIST   Y02621 11485502
         LA    R9,SYMBUF              AND PTR TO SYMBUF                 11486000
         ST    R9,0(RF)                    TO REMOTE LIST          AADA 11487018
         MVI   QPARM+QMPOP-QMNAM,QMWRTE WRITE ONLY                      11488000
         L     RF,FIEFVHQ          Q-MNGR ADDRESS                  AADA 11488518
         BALR  RE,RF              GO TO Q MANAGER TO WRITE SYMBUF       11489000
FAFF     DS    0H                                                       11490000
         SCSW  Z,POVRDZ,FAF        TRANSFER NO DD OVER RIDE.            11500000
         SCSW  S,DDOVZ             TURN ON DD OVER RIDE FOR SCAN.       11520000
*                                 CLEAR THE COMMENT SW THAT WAS         11526016
         SCSW  C,CMTZ                  SET BY BKR RTN                   11532016
FAE      DS    0H                  ENTRY TO GET ANOTHER CARD            11540000
         L     R7,CBEGP                                                 11566000
         LA    R7,SVO(R7)         COMPUTE COL 72.                       11572000
         MVC   0(1,R7),FAWA1      RESTORE PUNCH IN COL 72               11580000
         MVC   FAWA2(1),MSGKEY     SAVE MOST RECENT KEY            AACA 11586017
*                                      FOR SECONDARY MSG           AACA 11592017
         B     AOEXIT              BR TO GET REMAINDER OF STMT.  Y02668 11600002
FAF      DS    0H                  ENTRY TO GO PROCESS TEXT.            11640000
         SCSW  C,DDOVZ             TURN OFF SCAN DD OVER RIDE SW.       11660000
         SCSW  Z,FERRORA,FASUB    ERROR SWITCH ZERO TRANSFER   @G29AN2E 11680003
         SCSW  C,FERRORA          CLEAR ERROR SWITCH                    11680203
         B     FAE                TRANSFER DO NOT PASS INTERNAL TEXT    11680403
         EJECT                                                          11680603
***************************************************************@G29AN2E 11680803
*                                                             *@G29AN2E 11681003
*        SUBSYS KEYWORD EXIT                                  *@G29AN2E 11681203
*                                                             *@G29AN2E 11681403
***************************************************************@G29AN2E 11681603
*                                                             *@G29AN2E 11681803
*    A CHECK IS MADE FOR THE SUBSYS KEY.  IF IT DOES NOT      *@G29AN2E 11682003
*    EXIST THE POST SCAN EXIT IS TAKEN IMMEDIATELY.  OTHER-   *@G29AN2E 11682203
*    WISE AN SSOB IS BUILT SO THAT SUBSYS PROCESSING CAN BE   *@G29AN2E 11682403
*    DONE BY THE SUBSYSTEM.  THE SSNAME IS CHECKED FOR VALID  *@G29AN2E 11682603
*    CHARACTERS, THE SSOB AND SSIB ARE INITIALIZED, AND THE   *@G29AN2E 11682803
*    SUBSYSTEM INTERFACE REQUEST ROUTINE IS CALLED TO CALL    *@G29AN2E 11683003
*    THE APPROPRIATE SUBSYSTEM.  ON RETURN, THE RETURN CODES  *@G29AN2E 11683203
*    ARE CHECKED AND ERROR MESSAGES ARE ISSUED AS NECESSARY.  *@G29AN2E 11683403
*    IF NO ERRORS HAVE BEEN FOUND THE POST SCAN EXIT IS       *@G29AN2E 11683603
*    TAKEN.                                                   *@G29AN2E 11683803
*                                                             *@G29AN2E 11684003
*                                                             *@G29AN2E 11684203
*        REGISTERS ARE USED AS FOLLOWS:                       *@G29AN2E 11684403
*              R1=WORK REG                                    *@G29AN2E 11684603
*              R5=PTR TO SSOB                                 *@G29AN2E 11684803
*              R6=PTR TO SUBSYS KEY IN INTERNAL TEXT          *@G29AN2E 11685003
*              R7=WORK REG                                    *@G29AN2E 11685203
*              R8=WORK REG                                    *@G29AN2E 11685403
*                                                             *@G29AN2E 11685603
FASUB    DS    0H                                              @G29AN2E 11685803
*          ****************************************************@G29AN2E 11686003
*          *                                                  *@G29AN2E 11686203
*          *   CHECK IF SUBSYS PROCESSING IS REQUIRED. IF IT  *@G29AN2E 11686403
*          *   IS PROCEED WITH BUILDING THE SSOB, OTHERWISE   *@G29AN2E 11686603
*          *   GO TO POST SCAN EXIT.                          *@G29AN2E 11686803
*          *                                                  *@G29AN2E 11687003
*          ****************************************************@G29AN2E 11687203
         L     R1,TEXTBUFP        ESTABLISH ADDRESSABILITY     @G29AN2E 11687403
         USING TEXT,R1            TO INTERNAL TEXT             @G29AN2E 11687603
         TM    STRINDCS,DDSTR     IS THIS A DD CARD?           @G29AN2E 11687803
         BNO   FAFF1              NO,GO TO POST SCAN EXIT      @G29AN2E 11688003
         TM    STRDINDC,DTXSUBSK  WAS SUBSYS SPECIFIED         @G29AN2E 11688203
         BNO   FAFF1              NO, GO TO POST SCAN EXIT     @G29AN2E 11688403
         DROP  R1                                              @G29AN2E 11688603
         BAL   RE,AOTXTLTH        GO UPDATE TEXT LENGTH        @G29AN2E 11688803
         CLC   AOSTRLTH,TXTBFLEN  HAS BUFFER OVERFLOWED?       @G29AN2E 11689003
         BNH   FASUB0             NO, PROCEED WITH SSOB        @G29AN2E 11689203
         LA    R2,ERMSG749        BUFFER CAPACITY EXCEEDED     @G29AN2E 11689403
         MVI   MSGKEY,NOKEY       INDICATE NO SECONDARY MSG    @G29AN2E 11689603
         B     E1                 ISSUE ERROR MESSAGE          @G29AN2E 11689803
FASUB0   DS    0H                                              @G29AN2E 11690003
         L     R5,AOSSOB          GET ADDR OF SSOB             @G29AN2E 11690203
         USING SSOB,R5            ESTABLISH ADDR. FOR SSOB     @G29AN2E 11690403
         XC    SSOB(SSOBLN19),SSOB CLEAR ENTIRE SSOB           @G29AN2E 11690603
         MVC   SSOBID,SSOBCHAR    SET SSOB IDENTIFIER          @G29AN2E 11690803
         MVI   SSOBLEN+1,SSOBHSIZ  INIT LEN OF SSOB HEADER     @G29AN2E 11691003
         MVI   SSOBFUNC+1,SSOBCONV INIT SSOB FUNCTION ID       @G29AN2E 11691203
         LA    R7,SSCIBGN         GET ADDR OF CONV SUBSYS EXT. @G29AN2E 11691403
         ST    R7,SSOBINDV        INIT FUNCTION AREA PTR       @G29AN2E 11691603
         MVI   SSCILEN+1,SSCISIZE INIT LENGTH FIELD            @G29AN2E 11691803
         MVI   SSCISSNM,C' '      BEGIN BLANK OUT OF NAME      @G29AN2E 11692003
         MVC   SSCISSNM+1(L3),SSCISSNM PROPAGATE BLANK         @G29AN2E 11692203
         MVC   SSOBSSIB,AOSSIB    INIT PTR TO SSIB             @G29AN2E 11692403
         MVC   SSCIINTP,TEXTBUFP  SET INTERNAL TEXT PTR        @G29AN2E 11692603
*                                 IN SSCI                      @G29AN2E 11692803
*          ****************************************************@G29AN2E 11693003
*          *                                                  *@G29AN2E 11693203
*          *   CHECK THAT AT LEAST ONE PARAMETER HAS BEEN     *@G29AN2E 11693403
*          *   SPECIFIED.  CHECK FOR VALID NUMBER OF CHARS IN *@G29AN2E 11693603
*          *   THE SUBSYS NAME.                               *@G29AN2E 11693803
*          *                                                  *@G29AN2E 11694003
*          ****************************************************@G29AN2E 11694203
         L     R6,AOSUBSYS        POINT TO SUBSYS KEY          @G29AN2E 11694403
         XR    R7,R7              CLEAR WORK REG               @G29AN2E 11694603
         IC    R7,OFFNUM(R6)      GET NUMBER OF PARMS          @G29AN2E 11694803
         CH    R7,ONE             NO. OF PARMS GREATER/= TO 1  @G29AN2E 11695003
         BL    FASERR1            NO- 0 PARMS SPECIFIED        @G29AN2E 11695203
         BCTR  R7,0               FIND NO. OF SSPARMS          @G29AN2E 11695403
         STH   R7,SSCINPRM        SAVE NO. OF SSPARMS IN SSCI  @G29AN2E 11695603
         IC    R7,OFFLEN(R6)      GET LENGTH OF SSNAME         @G29AN2E 11695803
         CH    R7,MAXSSNML        IS LENGTH OF SSNAME NO MORE  @G29AN2E 11696003
*                                 THAN 4 CHARS?                @G29AN2E 11696203
         BH    FASERR2            NO, TOO MANY CHARS.          @G29AN2E 11696403
         CH    R7,ONE             IS THERE AT LEAST ONE CHAR   @G29AN2E 11696603
         BL    FASERR1            NO, SSNAME NOT SPECIFIED     @G29AN2E 11696803
         LA    RE,OFFSSNM(R6)     GET ADDR OF SSNAME           @G29AN2E 11697003
         AR    R7,RE              R7 NOW POINTS TO 1 BYTE      @G29AN2E 11697203
*                                 BEYOND SSNAME                @G29AN2E 11697403
         ST    R7,SSCISUBS        SAVE ADDR OF FIRST           @G29AN2E 11697603
*                                 LEN-SSPARM PAIR              @G29AN2E 11697803
         SPACE 2                                                        11698003
*        ******************************************************@G29AN2E 11698203
*        *                                                    *@G29AN2E 11698403
*        *   CHECK FOR VALID CHARACTERS IN SSNAME             *@G29AN2E 11698603
*        * (TEST IS BASED ON THE FACT THAT ONLY ALPHA/NUMERIC *@G29AN2E 11698803
*        * CHARS AND CERTAIN SPECIAL CHARS ARE ALLOWED THROUGH*@G29AN2E 11699003
*        * THE SCAN ROUTINE)                                  *@G29AN2E 11699203
*        *                                                    *@G29AN2E 11699403
*        ******************************************************@G29AN2E 11699603
         SPACE 1                                                        11699803
FASUB1   DS    0H                                              @G29AN2E 11700003
         BCTR  R7,0               GET ADDR OF LAST BYTE        @G29AN2E 11700203
*                                 OF SSNAME                    @G29AN2E 11700403
         CLI   0(R7),C'*'         ASTERISK?                    @G29AN2E 11700603
         BE    FASERR2            YES,ERROR                    @G29AN2E 11700803
         CLI   0(R7),C'/'         SLASH?                       @G29AN2E 11701003
         BE    FASERR2            YES,ERROR                    @G29AN2E 11701203
         CLI   0(R7),C'+'         PLUS?                        @G29AN2E 11701403
         BE    FASERR2            YES,ERROR                    @G29AN2E 11701603
         CLI   0(R7),C'-'         MINUS?                       @G29AN2E 11701803
         BE    FASERR2            YES,ERROR                    @G29AN2E 11702003
         CLI   0(R7),C' '         BLANK?                       @G29AN2E 11702203
         BE    FASERR2            YES,ERROR                    @G29AN2E 11702403
         CLI   0(R7),TWLVZERO     12/0 MULTIPUNCH?             @G29AN2E 11702603
         BE    FASERR2            YES,ERROR                    @G29AN2E 11702803
         CLI   0(R7),C','         COMMA?                       @G29AN2E 11703003
         BE    FASERR2            YES,ERROR                    @G29AN2E 11703203
         CLI   0(R7),C'.'         PERIOD?                      @G29AN2E 11703403
         BE    FASERR2            YES,ERROR                    @G29AN2E 11703603
         CLI   0(R7),C'('         LEFT PAREN?                  @G29AN2E 11703803
         BE    FASERR2            YES,ERROR                    @G29AN2E 11704003
         CLI   0(R7),C')'         RIGHT PAREN?                 @G29AN2E 11704203
         BE    FASERR2            YES,ERROR                    @G29AN2E 11704403
         CLI   0(R7),C'&&'        AMPERSAND?                   @G29AN2E 11704603
         BE    FASERR2            YES,ERROR                    @G29AN2E 11704803
         CLI   0(R7),C'='         EQUAL SIGN?                  @G29AN2E 11705003
         BE    FASERR2            YES,ERROR                    @G29AN2E 11705203
         CR    R7,RE              IS THIS THE FIRST CHAR       @G29AN2E 11705403
*                                 IN SSNAME?                   @G29AN2E 11705603
         BE    FASUB2             YES, TEST FOR NUMERIC        @G29AN2E 11705803
         B     FASUB1             CHECK PRECEDING CHAR         @G29AN2E 11706003
         SPACE 1                                                        11706203
FASUB2   DS    0H                                              @G29AN2E 11706403
         MVC   SSNMWA(1),0(RE)    MOVE FIRST CHAR TO WORKSPACE @G29AN2E 11706603
         NI    SSNMWA,X'F0'       ZERO LOW ORDER BITS          @G29AN2E 11706803
         XI    SSNMWA,C'0'        TEST FOR DIFFERENCE IN ZONE  @G29AN2E 11707003
         BZ    FASERR2            ERROR, NUMERICS INVALID      @G29AN2E 11707203
         XR    RE,RE              ZERO WORK REG                @G29AN2E 11707403
         IC    RE,OFFLEN(R6)      GET LENGTH                   @G29AN2E 11707603
         BCTR  RE,0               DECREMENT FOR EXECUTE        @G29AN2E 11707803
         EX    RE,FASNMVE1        MOVE NAME FROM INTERNAL      @G29AN2E 11708003
*                                 TEXT INTO SSOB               @G29AN2E 11708203
         L     R7,AOSSIB          ESTABLISH ADDR               @G29AN2E 11708403
         USING SSIB,R7            FOR SSIB                     @G29AN2E 11708603
         XC    SSIB(SSIBSIZE),SSIB CLEAR ENTIRE SSIB           @G29AN2E 11708803
         MVC   SSIBID,SSIBCHAR    SET SSIB IDENTIFIER          @G29AN2E 11709003
         MVI   SSIBLEN+1,SSIBSIZE INIT SSIB LENGTH             @G29AN2E 11709203
         MVC   SSIBSSNM,SSCISSNM  GET NAME FORM SSOB           @G29AN2E 11709403
         DROP  R7                                              @G29AN2E 11709603
         L     R1,WAMSGBUF        GET ADDR OF MSG BUFFER       @G29AN2E 11709803
         LA    R1,AOLEN(R1)       ALLOW FOR EIGHT BYTE OFFSET  @G29AN2E 11710003
         ST    R1,SSCIMPTR        SAVE ADDR IN SSOB            @G29AN2E 11710203
         MVC   SSCIMLEN,MLEN      STORE MAX. MSG LENGTH        @G29AN2E 11710403
         OI    AOSSOB,X'80'       SET HIGH ORDER BIT FOR       @G29AN2E 11710603
*                                 JESSSREQ                     @G29AN2E 11710803
         LA    R1,AOSSOB          POINT TO ADDR OF SSOB        @G29AN2E 11711003
         IEFSSREQ                                              @G29AN2E 11711203
         NI    AOSSOB,X'FF'-X'80' TURN OFF HIGH ORDER BIT      @G29AN2E 11711403
*          ****************************************************@G29AN2E 11711603
*          *   CHECK RETURN CODE FROM SUBSYSTEM INTERFACE     *@G29AN2E 11711803
*          *   REQUEST ROUTINE.  IF SUCCESSFUL COMPLETION     *@G29AN2E 11712003
*          *   CODE IS RETURNED, THEN TEST RETURN CODE FROM   *@G29AN2E 11712203
*          *   THE SUBSYSTEM.  OTHERWISE, ISSUE ERROR MESSAGE *@G29AN2E 11712403
*          *   AND FAIL JOB.                                  *@G29AN2E 11712603
*          *                                                  *@G29AN2E 11712803
*          ****************************************************@G29AN2E 11713003
         SPACE 1                                                        11713203
         B     *+4(RF)                                         @G29AN2E 11713403
         B     FASUB3             SUCCESSFUL RETURN CODE       @G29AN2E 11713603
         B     FASERR3            SUBSYS KEY NOT SUPPORTED     @G29AN2E 11713803
         B     FASERR5            SUBSYSTEM NOT OPERATIONAL    @G29AN2E 11714003
         B     FASERR4            SUBSYSTEM DOES NOT EXIST     @G29AN2E 11714203
         B     FASERR6            SYSTEM ERROR/FUNC NOT COMP.  @G29AN2E 11714403
         B     FASERR6            SYSTEM ERROR/LOGICAL         @G29AN2E 11714603
*          ****************************************************@G29AN2E 11714803
*          *                                                  *@G29AN2E 11715003
*          *   CHECK RETURN CODE FROM SUBSYSTEM PASSED IN THE *@G29AN2E 11715203
*          *   SSOB.  IF EQUAL TO ZERO, GO TO POST SCAN EXIT. *@G29AN2E 11715403
*          *   IF > 0 GO TO VGM TO ISSUE MSG RETURNED BY SUB- *@G29AN2E 11715603
*          *   SYSTEM.  IF RETURN CODE =4 OR 8 ALSO ISSUE     *@G29AN2E 11715803
*          *   WARNING MESSAGE.  THE JOB IS FAILED IF THE     *@G29AN2E 11716003
*          *   SUBSYSTEM HAS FOUND A SYNTAX ERROR, SYSTEM     *@G29AN2E 11716203
*          *   ERROR, OR UNKNOWN PROBLEM.                     *@G29AN2E 11716403
*          *                                                  *@G29AN2E 11716603
*          ****************************************************@G29AN2E 11716803
         SPACE 1                                                        11717003
FASUB3   DS    0H                                              @G29AN2E 11717203
         NC    SSOBRETN,SSOBRETN  SET CONDITION CODE           @G29AN2E 11717403
         BZ    FAFF1              SUCCESSFUL SYNTAX CHECK      @G29AN2E 11717603
         LA    R2,SSCICMOD        GET TEXT MOD. RETURN CODE    @G29AN2E 11717803
         C     R2,SSOBRETN        CHECK FOR TEXT MODIFIED      @G29AN2E 11718003
         BE    FASWARN            GO SET UP FOR WARNING        @G29AN2E 11718203
         LA    R2,SSCISYNC        GET SYNTAX ERROR-CONT. CODE  @G29AN2E 11718403
         C     R2,SSOBRETN        CHECK FOR SYNTAX ERROR-CONT. @G29AN2E 11718603
         BE    FASWARN            GO SET UP FOR WARNING        @G29AN2E 11718803
         OI    AOSW4,AOMSGTXT     INDICATE TEXT IS PASSED      @G29AN2E 11719003
         XR    R2,R2              CLEAR REGISTER               @G29AN2E 11719203
         L     RF,IEFVGMV         LOAD VCON                    @G29AN2E 11719403
         BALR  RE,RF              GO TO ISSUE MSG FROM SUBSYS  @G29AN2E 11719603
         NI    AOSW4,X'FF'-AOMSGTXT RESET FLAG                 @G29AN2E 11719803
         LA    R2,SSCISYNT        GET SYNTAX ERROR- TERMINATE  @G29AN2E 11720003
         C     R2,SSOBRETN        CHECK FOR SYNTAX ERR-TERM    @G29AN2E 11720203
         BE    E102               TERMINATE JOB                @G29AN2E 11720403
         B     FASERR6            SYSTEM ERROR                 @G29AN2E 11720603
FASERR1  DS    0H                                              @G29AN2E 11720803
         LA    R2,ERMSG744        SUBSYSTEM NOT SPECIFIED      @G29AN2E 11721003
         B     FASUB4                                          @G29AN2E 11721203
FASERR2  DS    0H                                              @G29AN2E 11721403
         LA    R2,ERMSG748        SUBSYSTEM NAME INVALID       @G29AN2E 11721603
         B     FASUB4                                          @G29AN2E 11721803
FASERR6  DS    0H                                              @G29AN2E 11722003
         LA    R2,ERMSG750        SYSTEM ERROR IN PROCESSING   @G29AN2E 11722203
*                                 SUBSYS DD PARAMETER          @G29AN2E 11722403
FASUB4   DS    0H                                              @G29AN2E 11722603
         MVI   MSGKEY,NOKEY       INDICATE NO SECONDARY MSG    @G29AN2E 11722803
         B     E1                 ISSUE ERROR MESSAGE          @G29AN2E 11723003
FASERR3  DS    0H                                              @G29AN2E 11723203
         L     R2,AVGM90OT        GET ADDR OF VGM90 MSG OFFSET @G29AN2E 11723403
*                                 TABLE                        @G29AN2E 11723603
         LH    R7,M745OO(R2)      GET OFFSET TO MSG TEXT       @G29AN2E 11723803
         LH    RE,M745OL(R2)      GET LENGTH OF MSG            @G29AN2E 11724003
         B     FASSM1                                          @G29AN2E 11724203
FASERR4  DS    0H                                              @G29AN2E 11724403
         L     R2,AVGM90OT        GET ADDR OF VGM90 MSG OFFSET @G29AN2E 11724603
*                                 TABLE                        @G29AN2E 11724803
         LH    R7,M746OO(R2)      GET OFFSET TO MSG TEXT       @G29AN2E 11725003
         LH    RE,M746OL(R2)      GET LENGTH OF MSG            @G29AN2E 11725203
         B     FASSM1                                          @G29AN2E 11725403
FASERR5  DS    0H                                              @G29AN2E 11725603
         L     R2,AVGM90OT        GET ADDR OF VGM90 MSG OFFSET @G29AN2E 11725803
*                                 TABLE                        @G29AN2E 11726003
         LH    R7,M747OO(R2)      GET OFFSET TO MSG TEXT       @G29AN2E 11726203
         LH    RE,M747OL(R2)      GET LENGTH OF MSG            @G29AN2E 11726403
*          ****************************************************@G29AN2E 11726603
*          *                                                  *@G29AN2E 11726803
*          *   INITIALIZE MESSAGE BUFFER FOR MESSAGES         *@G29AN2E 11727003
*          *   IEF745I-IEF747I.  MOVE THE SSNAME FROM THE     *@G29AN2E 11727203
*          *   SSIB POINTED TO BY THE SSOB TO THE MESSAGE     *@G29AN2E 11727403
*          *   BUFFER                                         *@G29AN2E 11727603
*          *                                                  *@G29AN2E 11727803
*          ****************************************************@G29AN2E 11728003
         SPACE 1                                                        11728203
FASSM1   DS    0H                                              @G29AN2E 11728403
         L     R1,WAMSGBUF        GET ADDR OF MSG BUFFER       @G29AN2E 11728603
         MVI   AOTXT(R1),C' '     MOVE BLANK TO POSITION OF    @G29AN2E 11728803
*                                 TEXT AREA                    @G29AN2E 11729003
         MVC   AOTXT1(149,R1),AOTXT(R1) BLANK REST OF TEXT AREA@G29AN2E 11729203
         MVC   AOLEN(2,R1),MLEN   INDICATE MAX LENGTH          @G29AN2E 11729403
         L     R2,AVGM90TX        GET ADDR OF VGM90 TEXT TABLE @G29AN2E 11729603
         AR    R2,R7              ADD OFFSET OF MSG TO GET     @G29AN2E 11729803
*                                 ADDR OF MSG                  @G29AN2E 11730003
         BCTR  RE,0               DECREMENT FOR EXECUTE        @G29AN2E 11730203
         EX    RE,FASNMVE2        MOVE MSG TO BUFFER           @G29AN2E 11730403
         L     R7,AOSSOB          GET ADDR OF SSOB             @G29AN2E 11730603
         USING SSOB,R7            ESTABLISH ADDRESSABILITY     @G29AN2E 11730803
         L     R2,SSOBSSIB        GET ADDR OF SSIB             @G29AN2E 11731003
         DROP  R7                                              @G29AN2E 11731203
         USING SSIB,R2            ESTABLISH ADDR TO SSIB       @G29AN2E 11731403
         MVC   AOSSNM(SSNAMEL,R1),SSIBSSNM MOVE SSNAME FROM    @G29AN2E 11731603
*                                 SSIB TO CORRECT POISTION IN  @G29AN2E 11731803
*                                 MESSAGE                      @G29AN2E 11732003
         OI    AOSW4,AOMSGTXT     INDICATE TEXT IS PASSED      @G29AN2E 11732203
         XR    R2,R2              CLEAR REG 2                  @G29AN2E 11732403
         L     RF,IEFVGMV         LOAD VCON                    @G29AN2E 11732603
         BALR  RE,RF              GO ISSUE MESSAGE             @G29AN2E 11732803
         NI    AOSW4,X'FF'-AOMSGTXT                            @G29AN2E 11733003
         B     E102               GO SET JOB FAIL              @G29AN2E 11733203
*          ****************************************************@G29AN2E 11733403
*          *                                                  *@G29AN2E 11733603
*          *   SET UP TO ISSUE WARNING MESSAGE.  GO TO        *@G29AN2E 11733803
*          *   VGM THEN TO POST SCAN EXIT.                    *@G29AN2E 11734003
*          *                                                  *@G29AN2E 11734203
*          ****************************************************@G29AN2E 11734403
FASWARN  DS    0H                                              @G29AN2E 11734603
         LH    R2,ONE             PLACE DUMMY WARNING NO IN REG@G29AN2E 11734803
         OI    AOSW4,AOWRNREQ     WARNING ONLY                 @G29AN2E 11735003
         OI    AOSW4,AOMSGTXT     TEXT IS BEING PASSED         @G29AN2E 11735203
         L     RF,IEFVGMV         LOAD VCON                    @G29AN2E 11735403
         BALR  RE,RF              GO ISSUE WARNING             @G29AN2E 11735603
         NI    AOSW4,X'FF'-AOMSGTXT TURN OFF TEXT INDICATOR    @G29AN2E 11735803
         B     FAFF1              TAKE POST SCAN EXIT          @G29AN2E 11736003
         SPACE 2                                                        11736203
***** SUBSYS PROCESSING STORAGE                                @G29AN2E 11736403
FASNMVE1 MVC   SSCISSNM(0),OFFSSNM(R6) MOVE NAME FROM INTERNAL @G29AN2E 11736603
*                                 TEXT INTO SSOB               @G29AN2E 11736803
FASNMVE2 MVC   AOTXT(0,R1),0(R2)  MOVE MSG INTO VGM BUFFER     @G29AN2E 11737003
ONE      DC    H'1'               ONE                          @G29AN2E 11737203
MAXSSNML DC    H'4'               MAXIMUM SSNAME LENGTH        @G29AN2E 11737403
MLEN     DC    H'110'             MAX MSG LENGTH               @G29AN2E 11737603
SSOBCHAR DC    C'SSOB'            SSOB IDENTIFIER              @G29AN2E 11737803
SSIBCHAR DC    C'SSIB'            SSIB IDENTIFIER              @G29AN2E 11738003
AVGM90OT DC    A(VGM90MOT)        ADDR OF MESSAGE OFFSET TABLE @G29AN2E 11738203
AVGM90TX DC    A(VGM90TXT)        ADDR OF MESSAGE OFFSET TABLE @G29AN2E 11738403
TXTBFLEN DC    H'8192'             INTERNAL TEXT BUFFER LENGTH @G29AN2E 11738603
         DROP  R5                                              @G29AN2E 11738803
         EJECT                                                          11739003
FAFF1    DS    0H                 ENTER                                 11740000
*****************************************************************Y02668 11847002
*          *                                                    *Y02668 11848002
*          *  POST SCAN EXIT - TAKEN BY JOB ENTRY SUBSYSTEM     *Y02668 11849002
*          *                                                    *Y02668 11850002
*****************************************************************Y02668 11851002
         SPACE 2                                                 Y02668 11852002
         BAL   RE,AOTXTLTH         GO TO UPDATE TEXT LENGTH      Y02668 11852402
* CHECK IF PGM=KEY IN EXEC TEXT STRING                         @ZA13844 11857003
         TM    SWZ,EXECSW          IS THIS AN EXEC STMT?       @ZA13844 11858003
         BZ    FACC1               BRANCH IF NOT               @ZA13844 11858803
         MVI   AOSCHKYS,PGMEK      PGM=KEY IN SEARCH LIST      @ZA13844 11859603
         MVI   AOSCHKYS+1,ENDLISTK  FLAG END OF SEARCH LIST    @ZA13844 11860403
         BAL   RE,AOKSRCHR         FIND PGM=KEY IN TEXT        @ZA13844 11861203
* R9 HAS ADDR OF PGM=KEY IF FOUND, ZERO IF NOT FOUND           @ZA13844 11862003
         LTR   R9,R9               PGM= KEY FOUND              @ZA13844 11862803
         BNZ   FACC1               YES, BRANCH                 @ZA13844 11863603
* EXEC TEST IS FOR PROCNAME, PROC= , OR ERROR CONDITION        @ZA13844 11864403
         L     RF,TEXTBUFP         TEXT STRING ADDRESS         @ZA13844 11865203
         USING TEXT,RF             PREFIX ADDRESSABILITY       @ZA13844 11866003
         OI    STREINDC,ETXPRCV    INDICATE STMT INVOKES PROC  @ZA13844 11866803
         DROP  RF                                              @ZA13844 11869503
* JES2 REQUIRES TEXT PREFIX INTERFACE                          @ZA13844 11870003
FACC1    DS    0H                                              @ZA13844 11871003
         L     RF,CWATXTEX         GET PTR TO POST SCAN RTN      Y02668 11872003
*                                  ENTRY IN NEL EXIT LIST        Y02668 11873003
         LTR   RF,RF               WAS AN ENTRY FOUND IN VH1     Y02668 11874003
         BZ    FACC3               NO, BYPASS EXIT               Y02668 11875003
         LA    R1,TEXTBUFP         GET PARM LIST PTR            YM00373 11876003
*                                  CONTAINING A 1 WORD TEXT PTR YM00373 11877002
         TM    0(RF),X'40'        Q. ADDR. DEFINITION              AAAA 11897015
         BO    FACC2               BR - YES                        AAAA 11900015
         LA    R3,CWAPSENM         GET PTR TO EXIT NAME         YM00373 11903002
         L     RF,CWALINK          GET LINK LIST FORM PTR       YM00373 11908002
         LINK  EPLOC=(3),MF=(E,(1)),SF=(E,(15)) TAKE NAME EXIT  YM00373 11913002
         B     FACC3                                               AAAA 11918015
FACC2    DS    0H                                                  AAAA 11921015
         L     RF,4(RF)           TAKE ADDR. EXIT                  AAAA 11924015
         BALR  RE,RF                                               AAAA 11927015
         EJECT                                                   Y02668 11928002
FACC3    DS    0H                                                  AAAA 11930015
         SCSW  Z,JOBSWY,AOMS01     BRANCH IF NOT JOB CARD        Y02668 11934002
         MVI   AOSCHKYS,MSGLEVJK   PUT MSGLEVEL KEY IN SEARCH    Y02668 11942002
*                                  PARMLIST                      Y02668 11946002
         MVI   AOSCHKYS+1,ENDLISTK INDICATE END OF LIST          Y02668 11950002
         BAL   RE,AOKSRCHR         FIND PTR TO MSGLEVEL KEY      Y02668 11958002
         LTR   R9,R9               WAS MSGLEVEL FOUND?           Y02668 11962002
         BZ    AOMS01              NO, BR. TO NORM PROCESSING    Y02668 11966002
         LA    R9,2(R9)            BUMP PTR TO PARM VALUE        Y02668 11970002
AOMS02   DS    0H                                                Y02668 11974002
         CLI   1(R9),AOMSLONE      IS MSGLEVEL=1?                Y02668 11978002
         BL    AOMS04              MSGLEVEL IS 0                 Y02668 11982002
         BH    AOMS03              MSGLEVEL IS 2                 Y02668 11986002
         MVI   IWAJMSGL,AOMSGLV1   SET BIT FOR MSGLEVEL=1.       Y02668 11990002
         B     AOMS01              BRANCH TO NORM PROCESSING     Y02668 11994002
AOMS03   DS    0H                                                Y02668 11998002
         CLI   1(R9),AOMSLTWO      MSGLEVEL>2 ?                  Y02668 12002002
         BH    AOMS01              YES, LEAVE IN DEFAULT         Y02668 12006002
         MVI   IWAJMSGL,AOMSGLV2   SET BIT FOR MSGLEVEL=2.       Y02668 12010002
         B     AOMS01              BRANCH TO NORM PROCESSING     Y02668 12014002
AOMS04   DS    0H                                                Y02668 12018002
         MVI   IWAJMSGL,AOMSGLV0   SET BIT FOR MSGLEVEL=0.       Y02668 12022002
AOMS01   DS    0H                                                Y02668 12026002
* CHECK IF RESTART= SPECIFIED.                                   Y02668 12026302
         MVI   AOSCHKYS,RESTARJK   RESTART KEY IN SEARCH LIST.   Y02668 12026602
         MVI   AOSCHKYS+1,ENDLISTK END OF LIST INDICATOR.        Y02668 12026902
         BAL   RE,AOKSRCHR         FIND RESTART KEY IN TEXT.     Y02668 12027502
* AOKSRCHR RETURNS ADDR IN R9 IF KEY FOUND, ZERO IF NOT FOUND.   Y02668 12027802
         LTR   R9,R9               RESTART KEY FOUND?            Y02668 12028102
         BZ    AOFACC5             BRANCH NO.                    Y02668 12028402
* RESTART= HAS BEEN SPECIFIED.                                   Y02668 12028702
* FORMAT IS - RESTART=(STEPNAME,CHECKID).                        Y02668 12029002
         OI    SWH,CPFLGXX         SET RESTART FLAG             YM01573 12029302
         L     RE,TEXTBUFP         GET PTR TO PREFIX            YM01573 12029402
         USING TEXT,RE             ADDRESS JOB PREFIX           YM01573 12029502
         OI    STRJINDC,JTXCPSTF   FLUSH JOB 'TIL RESTART STEP  YM01573 12029602
*                                  IS FOUND                     YM01573 12029702
         DROP  RE                                                       12029802
         CLI   2(R9),0             STEPNAME SPECIFIED?          YM01573 12029902
         BE    AORST09             NO, --ERROR, NEED STEPNAME   YM01573 12030002
* STEPNAME HAS BEEN SUPPLIED                                    YM01573 12030102
         CLI   3(R9),C'*'          RESTART FOR FIRST STEP?       Y02668 12030802
         BNE   AORST01             BR NO - ACTUAL NAME SPECIFIED.Y02668 12031102
         CLI   2(R9),1             IS '*' PART OF A STEPNAME?    Y02668 12031402
         BNE   AORST09             BR YES - ERROR. '*' MUST      Y02668*12031702
                                   BE SPECIFIED ALONE.           Y02668 12032002
* RESTART=* HAS BEEN SPECIFIED.                                  Y02668 12032302
         OI    CRSW1,CRRES1        INDICATE RESTART FIRST STEP.  Y02668 12032602
* CHECK FOR CHECKID (CHECKPOINT NAME).                           Y02668 12032902
AORST01  DS    0H                                                Y02668 12033202
         CLI   1(R9),2             CHECKID SPECIFIED?            Y02668 12033502
         BNE   AOFACC5             EXIT IF NOT.                  Y02668 12033802
* CHECKID HAS BEEN SPECIFIED.                                    Y02668 12034102
         SR    R1,R1               CLEAR LENGTH REG.             Y02668 12034402
         IC    R1,2(R9)            INSERT STEPNAME LENGTH.       Y02668 12034702
         LA    R9,3(R1,R9)         COMPUTE ADDR OF CHECKID -     Y02668*12035002
                                   (ADDR = 3 (KEY+NUMBER+LENGTH  Y02668*12035302
                                   BYTES + LENGTH OF STEPNAME).  Y02668 12035602
         MVC   CWACHIDL(1),0(R9)   SAVE CHECKID LENGTH.          Y02668 12035902
         B     AOFACC5             EXIT FROM RESTART CHECK.      Y02668 12036202
*                                                                Y02668 12036502
* ENTRY FOR RESTART FORMAT ERRORS.                               Y02668 12036802
AORST09  DS    0H                                                Y02668 12037102
         MVI   MSGKEY,RESTARJK      RESTART KEY FOR SECONDRY MSG.Y02668 12037402
         LA    R2,ERMSG632         LOAD MESSAGE NUMBER.          Y02668 12037702
         B     E1                                                Y02668 12038002
*                                                                Y02668 12038302
* END OF RESTART PROCESSING.                                     Y02668 12038602
*                                                                Y02668 12038902
AOFACC5  DS    0H                                                Y02668 12039202
         TM    SWZ,EXECSW          PROCESSING AN EXEC STMT?      Y02668 12040002
         BNO   FAC1                NOT AN EXEC CARD-NO FIND.     Y02668 12040402
* EXEC STATEMENT.                                                Y02668 12040802
         TM    PSTMT+4,X'08'       EXEC CONVERTED FROM PROC STMT?Y02668 12040902
         BO    FAC1                DUMMY EXEC, DON'T TRY FIND.   Y02668 12041002
         L     R9,TBEGP            POINT TO BASE KEY.            Y02668 12041202
         LA    R9,1(R9)            POINT TO PARAM COUNT.         Y02668 12041602
         CLI   0(R9),2             TWO PARAMS? EXEC PROC HAS 2.  Y02668 12042002
         BL    AOFDSRCH            BRANCH IF LESS THAN 2 TO CHECK       12042403
*                                  FOR PROC=PROCNAME CONDITION.@ZA13424 12042603
* EXEC PROCNAME STATEMENT.                                       Y02668 12043202
         LA    R9,1(R9)            STEP TO STEPNAME LTH BYTE.    Y02668 12043602
         SR    R1,R1               CLEAR FOR INSERTION OF        Y02668 12044002
         IC    R1,0(R9)            STEPNAME LTH.                 Y02668 12044402
         LA    R9,1(R9)            POINT TO STEPNAME.            Y02668 12044802
         AR    R9,R1               POINT TO PROCNAME LTH BYTE.   Y02668 12045202
         B     AOFDCHCK            ERROR CHECK PROCNAME.         Y02668 12045602
* CHECK FOR EXEC PROC=PROCNAME STATEMENT.                        Y02668 12046002
AOFDSRCH DS    0H                                                Y02668 12046402
         MVI   AOSCHKYS,PROCEK     PROC= KEY IN PARM LIST.       Y02668 12046802
         MVI   AOSCHKYS+1,ENDLISTI SET END OF LIST INDICATOR.    Y02668 12047202
         BAL   RE,AOKSRCHR         SEARCH FOR KEY IN TEXT.       Y02668 12048002
* AOKSRCHR RETURNS ADDRESS OF FOUND KEY IN R9, ZERO IF KEY       Y02668 12048402
* NOT FOUND.                                                     Y02668 12048802
         LTR   R9,R9               CHECK IF KEY FOUND.           Y02668 12049202
         BZ    FAC1                BRANCH NOT FOUND.             Y02668 12049602
* EXEC PROC=PROCNAME STATEMENT.                                  Y02668 12050002
* R9 POINTS TO PROC= KEY.                                        Y02668 12050402
         LA    R9,2(R9)            POINT TO PROCNAME LTH.        Y02668 12050802
* CHECK PROCEDURE NAME LENGTH.                                   Y02668 12051202
AOFDCHCK DS    0H                                                Y02668 12051602
         CLI   0(R9),8             LENGTH EXCEED MAX?            Y02668 12052002
         BH    AOFDERR2            BRANCH YES TO ISSUE IEF642I.  Y02668 12052402
         CLI   0(R9),0             IS PROC NAME MISSING?       @ZA13367 12052503
         BE    AOFDERR4            YES,ISSUE ERROR MSG IEF646I @ZA13367 12052703
         MVC   TWORK(1),1(R9)      VALIDITY CHECK 1ST CHAR. MUST Y02668*12052802
                                   BE ALPHABETIC.                Y02668 12053202
         NI    TWORK,X'F0'         ZERO LOW ORDER BITS.          Y02668 12053602
         XI    TWORK,C'0'          TEST FOR NUMERIC ZONE BITS.   Y02668 12054002
         BE    AOFDERR3            NUMERIC - ISSUE IEF644I.      Y02668 12054402
         CLI   1(R9),C'*'          ASTERISK?                     Y02668 12054802
         BE    AOFDERR3            YES, ERROR.                   Y02668 12055202
         CLI   1(R9),C'/'          SLASH?                        Y02668 12055602
         BE    AOFDERR3            YES, ERROR.                   Y02668 12056002
         CLI   1(R9),C'+'          PLUS?                         Y02668 12056402
         BE    AOFDERR3            YES, ERROR.                   Y02668 12056802
         CLI   1(R9),C'-'          MINUS?                        Y02668 12057202
         BE    AOFDERR3            YES, ERROR.                   Y02668 12057602
         SR    R1,R1               CLEAR FOR INSERTION OF        Y02668 12058002
         IC    R1,0(R9)            PROCNAME LTH.                 Y02668 12058402
         BCTR  R1,0                DECREMENT FOR EXECUTED MOVE   Y02668 12058802
         MVC   AOFDPCSV(8),AOPCSVBL BLANK PROCNAME AREA.         Y02668 12059202
         EX    R1,AOFDMOVE         MOVE PROCNAME TO BUF FOR FIND.Y02668 12059602
         MVC   AOFDPCL(1),0(R9)    MOVE NAME LTH TO BUF FOR FIND.Y02668 12060002
         TM    SWE,PROC            PROC SWITCH ON?               Y02668 12060402
         BZ    AOFDIST1            BR NO TO PROCESS PROCEDURE.   Y02668 12060802
* PROCEDURE WITHIN PROCEDURE ERROR.                              Y02668 12062002
         LA    R2,ERMSG613         LOAD ERR MSG CODE.            Y02668 12062402
         B     E1                  BRANCH TO PROCESS ERROR.      Y02668 12063202
AOFDIST1 DS    0H                                                Y02668 12064002
         L     R7,IWAWKBF          ADDRESS OF INSTRM WORK AREA.  Y02668 12064402
         LTR   R7,R7               INSTRM WORK AREA ?           YM06865 12064502
         BZ    AOFDIST3            NO - GO TO FIND RTN.         YM06865 12064602
         USING WORKAREA,R7                                       Y02668 12064802
         SR    R1,R1               CHECK                         Y02668 12065202
         IC    R1,WKCT             IF ANY INSTREAM PROCS         Y02668 12065602
         LTR   R1,R1               ARE LISTED IN THE DIRECTORY.  Y02668 12066002
         BZ    AOFDIST3            NONE LISTED.                  Y02668 12066402
* SEARCH THE DIRECTORY FOR THE PROCEDURE NAME.                   Y02668 12066802
         LA    R6,WKPROCN1         LOAD ADDR OF 1ST PROCNAME.    Y02668 12067202
AOFDIST2 DS    0H                                                Y02668 12067602
         CLC   0(8,R6),AOFDPCSV    INSTREAM PROC?                Y02668 12068002
         BE    AOFDIST4            BR YES TO BUILD PARM LIST FOR Y02668*12068402
                                   EXPAND RTNE.                  Y02668 12068802
         LA    R6,11(R6)           POINT TO NEXT PROCNAME.       Y02668 12069202
         BCT   R1,AOFDIST2         CHECK NEXT ENTRY.             Y02668 12069602
AOFDIST3 DS    0H                                                Y02668 12070002
         LA    R0,AOFDPCSV         LOAD PROCNAME ADDRESS.        Y02668 12070802
         L     R1,PDCBP            LOAD PROC DCB ADDRESS.        Y02668 12071202
         TM    IWAEXTS,IWASFIND    SPECIAL FIND EXIT SPECIFIED?  Y02668 12071602
         BO    AOFDSPFD            BRANCH YES.                   Y02668 12072002
         FIND  (1),(0),D                                         Y02668 12072402
AOFDBRNC DS    0H                                                Y02668 12072802
         B     *+4(RF)             BRNACH ON RETURN CODE.        Y02668 12073202
         B     AOFDSWCH            PROCEDURE FOUND.              Y02668 12073602
         B     AOFDERR1            PROCEDURE NOT FOUND.          Y02668 12074002
         LA    R5,2                PROC LIB DEVICE I/O ERROR    YM02700 12074402
         L     RF,IEFVHRV          ISSUE                         Y02668 12074802
         BALR  RE,RF               WTO ERROR MESSAGE.            Y02668 12075202
         LA    R2,ERMSG614         LOAD ERR MSG CODE.            Y02668 12075602
         B     E1                  ISSUED ON SYSOUT.             Y02668 12076402
AOFDERR1 DS    0H                                                Y02668 12076802
         XC    SYMTTR(VFA4),SYMTTR CLEAR PTR TO SYMBOLIC PARAMETER      12076903
*                                  TABLE                       @ZA06243 12077103
         LA    R2,ERMSG612         LOAD ERR MSG CODE.            Y02668 12077202
         B     E1                  ISSUED ON SYSOUT.             Y02668 12077602
AOFDERR2 DS    0H                                                Y02668 12078002
         LA    R2,ERMSG632         LOAD ERR MSG CODE.            Y02668 12078402
         B     E1                  BRANCH TO ERROR EXIT.         Y02668 12079202
AOFDERR3 DS    0H                                                Y02668 12079602
         LA    R2,ERMSG647         LOAD ERR MSG CODE.            Y02668 12080002
         B     E1                  ERROR EXIT.                   Y02668 12080802
AOFDERR4 DS    0H                  PROC NAME MISSING           @ZA13367 12080903
         LA    R2,ERMSG646         ERROR MSG CODE.             @ZA13367 12081003
         B     E1                  ERROR EXIT.                 @ZA13367 12081103
AOFDIST4 DS    0H                                                Y02668 12081503
         MVC   WKPTR2(3),8(R6)     MOVE TTR OF INSTREAM PROC.    Y02668 12081602
         OI    IWAPARM,INSTPROC    SET INSTR PROC SWITCH.        Y02668 12082402
         XR    RF,RF               INDICATE PROC FOUND.          Y02668 12082802
         B     AOFDBRNC            BRANCH TO CHECK RETURN CODE.  Y02668 12083202
AOFDMOVE MVC   AOFDPCSV(0),1(R9)   EXECUTED MOVE - PROCNM TO BUF.Y02668 12083602
*                                                                Y02668 12084002
*  SPECIAL FIND ROUTINE - SAVE INTERFACE AS FIND SVC.            Y02668 12084402
*                                                                Y02668 12084802
AOFDSPFD DS    0H                                                Y02668 12085202
         XC    AOFDTMP1(4),AOFDTMP1 CLAAR LOAD SPACE             Y02668 12085602
         MVC   AOFDTMP1+1(3),IWAFINDP MOVE PTR FOR LOAD.         Y02668 12086002
         L     RF,AOFDTMP1         LOAD PTR TO SPECIAL FIND RTNE.Y02668 12086402
         BALR  RE,RF               BRANCH TO RTNE.               Y02668 12086802
         B     AOFDBRNC            BRANCH TO CHECK RETURN CODE.  Y02668 12087202
*                                                                Y02668 12087602
*  PROCEDURE FOUND - SET PROC (PROCLIB BEING USED) AND PRCV      Y02668 12088002
*     (PRIME PROCEDURE BUFFER) SWITCHES IN THE IWA.              Y02668 12088402
*                                                                Y02668 12088802
AOFDSWCH DS    0H                                                       12089202
         MVI   SWE,PROC+PRCV       INIT PROC SWITCHES           YM02703 12089302
         XC    PDNM(L'PDNM+L'PSNM+L'RDNM+L'RSNM+L'PPSN),PDNM    YM02703 12089402
*                                  CLEAR O'RIDE WORK AREA       YM02703 12089502
         OI    SWC,PEXP            SET PROC EXEC STMT EXPECTED.  Y02668 12089802
         L     RF,TEXTBUFP         TEXT STRING ADDRESS.          Y02668 12090002
         USING TEXT,RF             PREFIX ADDRESSABILITY.        Y02668 12091002
         OI    STREINDC,ETXPRCV    INDICATE STMT INVOKES PROC.   Y02668 12092002
         DROP  RF                                                Y02668 12093002
FAC1     DS    0H                                                Y02668 12094002
         TM    SWA,DLM             DLM FOUND THIS CARD ?        YM03459 12094902
         BZ    AOEXIT              NO. GO TO EXIT               YM03459 12095802
         MVI   AOSCHKYS,DLMK       PUT DLM KEY IN SEARCH LIST   YM03459 12096702
         MVI   AOSCHKYS+1,ENDLISTK INDICATE END OF LIST         YM03459 12097602
         BAL   RE,AOKSRCHR         GO TO FIND DLM KEY           YM03459 12098502
         LTR   R9,R9               WAS DLM KEY FOUND ?          YM03459 12099402
         BZ    AOEXIT              NO. GO TO EXIT               YM03459 12100702
         CLI   1(R9),X'01'         DLM PARAMETER EXCEED 1 ?     YM03459 12101702
         BNH   FAC2                NO. GO CHECK FOR DLM LTH     YM03459 12102702
         LA    R2,ERMSG640         SET EXCESSIVE PARMS MSG CODE YM03459 12103702
         B     FAC3                GO TO PUT OUT MSG            YM03459 12104702
FAC2     DS    0H                                               YM03459 12105702
         CLI   2(R9),X'02'         DLM OPERAND GREATER THAN 2 ? YM03459 12106702
         BNH   AOEXIT              NO. GO TO EXIT               YM03459 12107702
         LA    R2,ERMSG642         SET EXCESSIVE PARM LTH CODE  YM03459 12108702
FAC3     DS    0H                                               YM03459 12117502
         MVI   MSGKEY,DLMK         SET DLM SECONDARY MSG CODE   YM03459 12118002
         B     E1                  GO TO ERROR EXIT             YM06094 12118502
         EJECT                                                          12119502
AOEXIT   DS    0H                                                Y02668 12120002
         L     RF,IEFVHFHA         RETURN                        Y02668 12125002
         BR    RF                  TO VHF.                       Y02668 12130002
         DS    0H                                                Y02668 12140002
TBUFLTH  DC    H'2000'             CONSTANT FOR TEXTBUF LENGTH.  Y02668 12150002
FAG      DC    C'DATA'                                                  12170016
FAI      DC    C'DUMMY '          CONSTANT FOR DD.                      12200000
FAJ      DC    C'DYNAM'            CONSTANT FOR DD                20033 12210020
STPCTLEN EQU   X'07'              LENGTH OF STEPCAT NAME.        Y02113 12210602
STEPCATN DC    C'STEPCAT'         NAME FOR COMPARE.              Y02113 12211202
         EJECT                                                          12220000
*          **********************************************************   12240000
*          *                                                        *   12260000
*          *   THIS ROUTINE MOVES PARAMETERS AND SUBPARAMETERS      *   12280000
*          *   FROM THE JCL STATEMENT INTO THE TEXT BUFFER.         *   12300000
*          *                                                        *   12320000
*          **********************************************************   12340000
T1       DS    0H                                                       12360000
         LM    R2,R5,TKEYP         GET TEXT PTRS                        12363017
*                                  R2= TKEYP                            12366017
*                                  R3=TNUMP ( NOT USED )                12369017
*                                  R4=TLENP                             12372017
*                                  R5=TENDP                             12375017
*                                                                  AACA 12378017
         SCSW  O,LPBYSWZ,T102     BR IF BYPASS SW ON               AACA 12381017
*   NOW CHECK FOR MORE THAN ONE PARAM                              AACA 12384017
*                                                                  AACA 12387017
         CLI   1(R2),1             IS THERE AT LEAST ONE PARAM     AACA 12390017
         BL    T102                NO, BYPASS FURTHER CHECKS       AACA 12393017
*                                                                  AACA 12396017
*   MORE THAN ONE PARAM - CHECK IF IN PARENS                       AACA 12399017
*                                                                  AACA 12402017
         LH    R3,CURLE            CHECK IF CURRENT LEVEL OF PARENSAACA 12405017
         LTR   R3,R3                   IS MORE THAN ONE            AACA 12408017
         BNZ   T102                OK, BYPASS                      AACA 12411017
*                                                                       12414017
         XI    FPRNSWZ,FPRNSW      FLIP THE LEFT PAREN BIT         AACA 12417017
         BZ    T102                RESULT=0 LAST PARAMETER IN PARENS    12420017
*                                  RESULT=1 ERROR OUTSIDE PARENS   AACA 12423017
*                                                                       12426017
         LA    R2,ERMES19          FORMAT ERROR                         12429017
         B     E1                                                       12432017
         SPACE                                                          12435017
T102     DS    0H                                                       12438017
         LM    R2,R3,CBSYP    GET CHAR STRING PTRS                      12441017
         SR    R3,R2               COMPUTE LENGTH OF SYMBOL             12460000
*  THREE INSTRUCTIONS DELETED HERE                             @ZA16422 12490003
         L     R5,TNUMP            GET NUMBER POINTER.                  12640000
         CLI   0(R5),X'FF'         IS PARAM CT ALREADY AT 255?   Y02668 12642002
         BL    AOT1                BRANCH NO.                    Y02668 12644002
* PARAMETERS EXCEED ONE BYTE MAXIMUM COUNT OF 255.               Y02668 12646002
         LA    R2,ERMES3           SET CODE FOR EXCESSIVE PARAMS.Y02668 12648002
         B     E1                  TAKE ERROR EXIT.              Y02668 12650002
AOT1     DS    0H                                                Y02668 12652002
         SCSW  O,PDASSWW,T3        PERIOD AND AST SWITCHES ON.          12660000
         SCSW  Z,LDLX,T6           LAST DEL SWITCH OFF.                 12680000
         SR    R6,R6               CLEAR REGISTER.                      12700000
         AH    R6,CURLE            CURRENT LEVEL.                       12720000
         SH    R6,LASLE            LAST LEVEL.                          12740000
         BC    EQUAL+LOW,T6        TRANSFER.                            12760000
         L     R6,TKEYP            GET TEXT KEY POINTER.                12780000
         LA    R6,1(R6)            BUMP POINTER.                        12800000
         SR    R6,R5               TKEYP EQUAL TO TNUMP.                12820000
         BNH   T3A                 TRANS TNUMP NOT HIGH        @G29AN2E 12840003
         LA    R2,ERMES1           GET ERROR NUMBER.                    12860000
         B     E1                  GO TO ERROR ROUTINE.                 12880000
T3       DS    0H                  ENTRY FOR PERD AND AST.              12900000
         SCSW  O,JGCY,T6           SWITCH ON TRANSFER.                  12920000
         SCSW  S,JGCY              SET SWITCH ON.                       12940000
T3A      DS    0H                                              @G29AN2E 12942003
         L     R5,TKEYP            GET ADDR OF KEY             @G29AN2E 12944003
         CLI   0(R5),SUBSYSK       IS IT THE SUBSYS KEY        @G29AN2E 12946003
         BNE   T4                  NO, PROCEED NORMALLY        @G29AN2E 12948003
         LA    R2,ERMSG641         IMPROPER SUBPARM. LIST      @G29AN2E 12950003
         MVI   MSGKEY,SUBSYSK      IN THE SUBSYS FIELD         @G29AN2E 12952003
         B     E1                  GO ISSUE MESSAGE            @G29AN2E 12954003
T4       DS    0H                  ENTRY                                12960000
         L     R5,TKEYP            INSURE REG. 5 POINTS TO      YA24040 12966002
         LA    R5,1(R5)            REAL NBR BYTE, NOT SUBLIST.  YA24040 12972002
         IC    R6,0(R5)            GET TEXT NUMBER BYTE                 12980000
         LA    R6,1(R6)            ADD ONE TO NUMBER BYTE.              13000000
         STC   R6,0(R5)            PUT NUMBER BYTE BACK.                13020000
         OI    0(R4),HONE          OR HIGH ONE IN LENGTH BYTE.          13040000
         SR    R6,R6               CLEAR REGISTER.                      13060000
         LR    R5,R4               SET REG WITH TNUMP.                  13080000
         LA    R4,1(R4)            BUMP TO NEW TLENP.                   13100000
         STC   R6,0(R4)            ZERO TEXT LENGTH BYTE.               13120000
T6       DS    0H                  ENTRY                                13140000
         STC   R3,0(R4)            PUT LENGTH IN TEXT LENGTH BYTE.      13160000
         LA    R4,1(R4)            BUMP TLENP BY ONE.                   13180000
         LPR   R6,R3               SAVE LENGTH                          13200000
         BC    8,T7                TRANSFER LENGTH IS ZERO              13220000
         BCTR  R3,R0              DECREMENT LENGTH.                     13240000
         EX    R3,T8               EXECUTE MOVE.                        13260000
T7       DS    0H                  ENTRY.                               13280000
         AR    R4,R6               COMPUTE NEW LENGTH BYTE.             13300000
         SR    R6,R6               CLEAR REGISTER                       13320000
         STC   R6,0(R4)            ZERO NEW LENGTH BYTE.                13340000
         ST    R4,TLENP            SAVE LENGTH ADDRESS.                 13360000
         IC    R6,0(R5)            GET NUMBER BYTE.                     13380000
         LA    R6,1(R6)            ADD ONE TO NUMBER BYTE.              13400000
         STC   R6,0(R5)            PUT BACK NUMBER BYTE                 13420000
         SR    R6,R6               CLEAR REGISTER.                      13440000
         AH    R6,CURLE            CURRENT LEVEL.                       13460000
         SH    R6,LASLE            LAST LEVEL.                          13480000
         BC    NOT-LOW,T71         TRANSFER HIGH AND EQUAL.             13500000
         L     R5,TKEYP            GET TEXT KEY POINTER.                13520000
         LA    R5,1(R5)            BUMP POINTER.                        13540000
T71      DS    0H                  ENTRY.                               13560000
         ST    R5,TNUMP            SAVE TEXT NUMBER POINTER.            13580000
         SR    R6,R6                                                    13600000
         AH    R6,CURLE                                                 13620000
         STH   R6,LASLE                                                 13640000
         BR    R7                  RETURN.                              13660000
T8       MVC   0(0,R4),0(R2)                                            13680000
         EJECT                                                          13682002
*          ******************************************************Y02668 13690002
*          *                                                    *Y02668 13692002
*          *                 AOTXTLTH                           *Y02668 13694002
*          *                                                    *Y02668 13696002
*          *   THIS ROUTINE CALCULATES THE LENGTH OF AN         *Y02668 13698002
*          *   INTERNAL TEXT STRING(INCLUDING PREFIX). IT THEN  *Y02668 13698402
*          *   PLACES THIS LENGTH INTO THE STRLTH FIELD OF THE  *Y02668 13698802
*          *   PREFIX.                                          *Y02668 13699202
*          *                                                    *Y02668 13699602
*          ******************************************************Y02668 13699702
         SPACE 2                                                        13699802
AOTXTLTH DS    0H                                                Y02668 13708602
         L     R5,TEXTBUFP         SET UP ADDRESSABILITY FOR     Y02668 13710602
         USING TEXT,R5             TEXT STRING PREFIX            Y02668 13712602
         L     R1,TLENP            GET THE END OF TEXT STRING    Y02668 13713002
         LA    R1,1(R1)            PLUS END KEY                  Y02668 13713102
         SR    R1,R5               CALC TEXT STRING LENGTH       Y02668 13713202
         STH   R1,AOSTRLTH         MOVE TEXT STRING LENGTH       Y02668 13719902
         MVC   STRLTH(AONUML),AOSTRLTH  INTO TEXT PREFIX         Y02668 13722002
         DROP  R5                                                Y02668 13724002
         BR    RE                  RETURN TO CALLER              Y02668 13726002
         EJECT                                                          13726602
*          **********************************************************   13733302
*          *                                                        *   13740000
*          *   THIS ROUTINE INSERTS KEY INTO TEXT BUFFER AND        *   13760000
*          *   STORES ZERO IN THE NUMBER AND LENGTH BYTES.          *   13780000
*          *   ALSO CHECK FOR BUFFER OVERFLOW AND TRANSFERS         *   13800000
*          *   TO B1 ROUTINE IF OVERFLOW OCCURS.                    *   13820000
*          *                                                        *   13840000
*          **********************************************************   13860000
K1       DS    0H                                                       13880000
         L     R4,TLENP            GET ADDRESS OF LENGTH BYTE.          13900000
         L     R6,TENDP            GET ADDRESS OF END BYTE.             13920000
         LA    R3,1(R4)            COMP ADDR OF NEW LTH BYTE     Y02668 13940002
         STC   R7,0(R4)            ENTER KEY IN KEY BYTE.        Y02668 14090002
         CLI   0(R4),ENDK          WAS IT AN END KEY?            Y02668 14100002
         BC    NOT-EQUAL,K4        THIS STATEMENT. NO, CONTINUE. Y02668 14110002
* END OF TEXT FOR STATEMENT.                                     Y02668 14110402
         TM    SWZ,JOBSW+EXECSW    JOB OR EXEC STATEMENT?       YM01546 14110802
         BZ    AOK10               BRANCH IF NEITHER.           YM01546 14110902
         SCSW  O,VERBCSWZ,AOK10    BR IF PROC STMT-NO DEFAULTS. YM01546 14111002
         LA    R6,WAJOBPFX         ADDRESS OF PSEUEDO JOB PFX.   Y02668 14111202
         USING TEXT,R6             PREFIX ADDRESSABILITY.        Y02668 14111302
         TM    STRJINDC,JTXJOBFL   WAS JOB FAILED?               Y02668 14111402
         BO    AOK10               BR YES, BYPASS DEFAULT RTNE.  Y02668 14111602
* JOB OR EXEC STATEMENT AND JOB HAS NOT BEEN FAILED.            YM01546 14112002
* CHECK FOR OMITTED PARAMETERS FOR WHICH DEFAULTS ARE SUPPLIED.  Y02668 14112402
         BAL   R6,AODFAULT         PERFORM DEFAULT PROCESSING.   Y02668 14112802
         L     R6,TEXTBUFP         ADDR OF TEXT PREFIX.         YM01546 14113202
         TM    STRJINDC,JTXJOBFL   JOB FAILED BY DEFAULT RTNE?   Y02668 14113302
         BO    E1                  BR YES, ERR CODES ALL SET UP. Y02668 14113402
         DROP  R6                                                Y02668 14113502
AOK10    DS    0H                                                Y02668 14113702
         XC    MSGKEY,MSGKEY       TELL VGM NO SECONDARY MSG    YM00393 14115002
         OI    AOSW1,AOTXTWRT      SET TEXT WRITE SW. FOR VHCB   Y02668 14116002
         ST    R4,TLENP            SET PTR FOR NEXT VERB KEY     Y02668 14120002
*                                 IN CASE E1 ENTERS ON DFLT ERR YM01536 14121002
         BR    R9                  RETURN.                      YM01536 14130002
         SPACE 1                                                 Y02668 14140002
* TEXT STRING NOT YET COMPLETED. ENTER NEXT KEY.                 Y02668 14145002
K4       DS    0H                                                Y02668 14150002
         STC   R7,MSGKEY           SAVE KEY FOR SECONDARY MSG.   Y02668 14155002
         ST    R4,TKEYP            SAVE POINTER FOR NEXT KEY.    Y02668 14160002
         XC    1(2,R4),1(R4)       ZERO NUMBER AND LENGTH BYTES. Y02668 14170002
         LA    R4,2(R4)            POINT TO LENGTH BYTE AND      Y02668 14180002
         ST    R4,TLENP            SAVE POINTER.                 Y02668 14190002
         BCTR  R4,0                POINT TO NUMBER BYTE AND      Y02668 14200002
         ST    R4,TNUMP            SAVE POINTER.                 Y02668 14210002
         BR    R9                  RETURN.                       Y02668 14220002
         EJECT                                                          14222002
*          *******************************************************      14224002
*          *                                                    *Y02668 14226002
*          *            TEXT STRING PREFIX CREATION             *Y02668 14228002
*          *                                                    *Y02668 14230002
*          *******************************************************      14232002
         SPACE 2                                                        14234002
AOPX     DS    0H                                                Y02668 14236002
         ST    RE,AODSPCSA         SAVE RETURN ADDR              Y02668 14238002
         L     R1,TEXTBUFP         GET BEGINNING OF TEXT BUFFER  Y02668 14240002
         USING TEXT,R1             TEXT STRING ADDRESS ABILITY   Y02668 14244002
         L     R0,TENDP            GET ADDR OF TEXT BUF END      Y02668 14246002
         CLI   VERB(RF),JOB        Q. JOB VERB                   Y02668 14248002
         BNE   AOPX2               NO, CHECK FOR EXEC            Y02668 14250002
         XC    STRLTH(STRJPFXL),STRLTH ZERO PREFIX BYTES         Y02668 14252002
         OI    STRINDCS,JOBSTR     INDICATE JOB STNT IN PREFIX   Y02668 14254002
         LA    R1,STRJPFXL(R1)     BUMP PTR BY JOB PREFIX LTH    Y02668 14256002
         B     AOPX10              STORE UPDATED TBEGP           Y02668 14258002
AOPX2    DS    0H                                                Y02668 14260002
         CLI   VERB(RF),PROCV      Q. PROC VERB                  Y02668 14262002
         BNE   AOPX3               NO, CHECK FOR EXEC            Y02668 14264002
         XC    STRLTH(STREPFXL),STRLTH ZERO PREFIX               Y02668 14266002
         OI    STRINDCS,PROCSTR    INDICATE PROC STMT, IN PREFIX Y02668 14268002
         OI    STREINDC,ETXPRCV    IND POSSIBLE PROC O'RIDES    YM00382 14269002
         LA    R1,STREPFXL(R1)     BUMP PTR BY PROC/EXEC PFX LTH Y02668 14270002
         B     AOPX10              STORE UPDATED TBEGP           Y02668 14272002
AOPX3    DS    0H                                                Y02668 14274002
         CLI   VERB(RF),EXEC       Q. EXEC VERB                  Y02668 14276002
         BNE   AOPX5               NO, ASSUME DD STMT            Y02668 14278002
         XC    STRLTH(STREPFXL),STRLTH ZERO PREFIX               Y02668 14280002
         OI    STRINDCS,EXECSTR    INDICATE EXEC STMT,IN PREFIX  Y02668 14282002
         LA    R1,STREPFXL(R1)     BUMP PTR BY PROC/EXEC PFX LTH Y02668 14284002
         B     AOPX10              STORE UPDATED TBEGP           Y02668 14286002
AOPX5    DS    0H                                                Y02668 14288002
         XC    STRLTH(STRDPFXL),STRLTH  ZERO PREFIX              Y02668 14290002
         OI    STRINDCS,DDSTR      INDICATE DD STMT IN PREFIX    Y02668 14292002
         LA    R1,STRDPFXL(R1)     BUMP PTR BY DD PFX LTH        Y02668 14294002
AOPX10   DS    0H                                                Y02668 14296002
         ST    R1,TBEGP            SET PTR TO BYTE AT WHICH      Y02668 14298002
*                                  VERB KEY WILL BE INSERTED     Y02668 14300002
         L     RE,AODSPCSA         RESTORE RETURN ADDR           Y02668 14302002
         BR    RE                  RETURN TO CALLER              Y02668 14304002
         DROP  R1                                                Y02668 14305002
         EJECT                                                   Y02668 14748002
*          ******************************************************Y02668 14750002
*          *                                                    *Y02668 14752002
*          * AODFAULT - DEFAULT PROCESSING ROUTINE.             *Y02668 14754002
*          *                                                    *Y02668 14756002
*          * AODFAULT IS ENTERED AFTER ALL THE JCL PARAMETERS   *Y02668 14758002
*          * FOR A JOB STATEMENT HAVE BEEN PROCESSED AND CON-   *Y02668 14760002
*          * VERTED TO INTERNAL TEXT. AODFAULT CHECKS IF PARTI- *Y02668 14762002
*          * CULAR PARAMS HAVE BEEN SPECIFIED ON THE STATEMENT. *Y02668 14764002
*          *                                                    *Y02668 14766002
*          * FOR THOSE PARAMS WHICH HAVE BEEN OMITTED,  AODFAULT*Y02668 14768002
*          * SUPPLIES A DEFAULT IN THE FOLLOWING WAY: A PREBUILT*Y02668 14770002
*          * TEXT SEGMENT FOR A PARTICULAR PARAM IS APPENDED TO *Y02668 14772002
*          * THE TEXT STRING FOR THE STATEMENT. THE ACTUAL      *Y02668 14774002
*          * DEFAULT VALUE FOR THE PARAM IS THEN OBTAINED FROM  *Y02668 14776002
*          * THE NEL AND IS ENTERED IN THE APPROPRIATE PLACE IN *Y02668 14778002
*          * THE APPENDED SEGMENT. THE TEXT POINTER IS UPDATED  *Y02668 14780002
*          * WITH EACH ADDITION OF DEFAULT TEXT. AFTER ALL      *Y02668 14782002
*          * DEFAULT PROCESSING IS COMPLETE, THE K1 ROUTINE     *Y02668 14784002
*          * ENTERS AN END KEY IN TEXT AFTER THE LAST APPENDED  *Y02668 14786002
*          * SEGMENT.                                           *Y02668 14788002
*          *                                                    *Y02668 14790002
*          * IN ADDITION, THE ACCOUNT NUMBER AND PROGRAMMER NAME*Y02668 14790302
*          * OPTIONS, IF SPECIFIED, ARE PROPAGATED FROM THE NEL *Y02668 14790602
*          * TO THE JOB STRING PREFIX, FOR PROCESSING BY THE    *Y02668 14790902
*          * INTERPRETER (IEFVJA).                              *Y02668 14791202
*          *                                                    *Y02668 14791502
*          * INPUT -                                            *Y02668 14792002
*          * .R4 - ADDRESS FOR APPENDED TEXT.                   *Y02668 14794002
*          *                                                    *Y02668 14796002
*          * OUTPUT -                                           *Y02668 14798002
*          * .R4 - ADDRESS FOR END KEY.                         *Y02668 14800002
*          *                                                    *Y02668 14802002
*          * NOTES -                                            *Y02668 14804002
*          * .AODFAULT USES THE AOPRMCHK RTNE TO CHECK IF A    *YM01546 14806002
*          *  VALUE HAS BEEN SPECIFIED IN JCL FOR A PARTICULAR *YM01546 14809002
*          *  KEYWORD.                                         *YM01546 14812002
*          *  INPUT TO AOPRMCHK IS THE KEYWORD CODE IN R3.     *YM01546 14815002
*          *  OUTPUT FROM AOPRMCHK IS A ZERO IN R9 IF A VALUE  *YM01546 14818002
*          *  HAS NOT BEEN SPECIFIED.                          *YM01546 14821002
*          * .CONTENTS OF R4 ARE PLACED IN R7, AND R7 IS USED  *YM08105 14822002
*          *  IN APPENDING DEFAULT TEXT TO THE TEXT STRING.    *YM08105 14823002
*          *                                                    *Y02668 14824002
*          ******************************************************Y02668 14826002
         SPACE 2                                                 Y02668 14828002
* R4 POINTS TO NEXT KEY BYTE IN THE TEXT  BUFFER.                Y02668 14830002
AODFAULT DS    0H                                                Y02668 14832002
         STM   R1,R7,AODFLTSA      SAVE CALLER'S REGS.           Y02668 14834002
         ST    R9,AODSPCSA         SAVE K1 CALLER'S RETURN REG. YM01546 14835002
         LR    R7,R4               MOVE KEY BYTE ADD TO SAFE REG.Y02668 14836002
         L     R1,WANELPTR         LOAD NEL ADDRESS.             Y02668 14838002
         USING NEL,R1              NEL ADDRESSABILITY.           Y02668 14840002
         SCSW  O,EXECSWY,AOEDFL10  BRANCH IF EXEC STMT.         YM01546 14840602
* JOB STATEMENT. PERFORM JOB DEFAULT PROCESSING.                YM01546 14841202
* MSGCLASS CHECK.                                                Y02668 14842002
         LA    R3,MSGCLAJK         LOAD KEY.                     Y02668 14844002
         BAL   R6,AOPRMCHK         CHECK IF DEFAULT REQUIRED.   YM01546 14846002
* AOPRMCHK RETURNS WITH ZERO IN R9 IF DEFAULT TEXT TO BE ADDED. YM01546 14847002
         LTR   R9,R9               DEFAULT REQUIRED?            YM01546 14848002
         BNZ   AODFLT10            NO, BRANCH TO TRY NEXT.      YM01546 14849002
* MSGCLASS VALUE NOT SPECIFIED ON JCL. DEFAULT IS SUPPLIED.     YM01546 14850002
         MVC   0(AOMGCLTH,R7),AOMSGCTX APPEND PREBUILT TEXT.     Y02668 14854002
         MVC   AOMGCDSP(1,R7),NELMSGCL ENTER DEFAULT.            Y02668 14856002
         LA    R7,AOMGCLTH(R7)     ADD TEXT LTH TO KEY BYTE PTR. Y02668 14858002
         MVI   0(R7),ENDK          SET END KEY FOR TEXT SEARCH. YM01546 14859002
* MSGLEVEL CHECK.                                                Y02668 14860002
AODFLT10 DS    0H                                                Y02668 14862002
*  INITIALIZE WORK AREA WITH DEFAULTS. THESE WILL BE REPLACED   YM08105 14862402
*  BY VALUES ON THE JOB CARD, IF ANY WERE SPECIFIED.            YM08105 14862802
         MVC   WAMSGL1(1),NELMSGL1 JCL MSGL DEFAULT TO WK AREA. YM08105 14863202
         MVC   WAMSGL2(1),NELMSGL2 ALC MSGL DEFAULT TO WK AREA. YM08105 14863602
         LA    R3,MSGLEVJK         LOAD KEY.                     Y02668 14864002
         BAL   R6,AOPRMCHK         CHECK IF DEFAULT REQUIRED.   YM00154 14866002
         LTR   R9,R9               DEFAULT REQUIRED?            YM00154 14868002
         BZ    AODFLT15            BR YES TO SUPPLY BOTH DFLTS. YM08105 14870002
*  KEYWORD NOT NULL, BUT ONLY ONE PRM OR AN EXCESSIVE NUMBER OF YM08105 14870102
*  PRMS MAY HAVE BEEN SPECIFIED. CHECK FOR BOTH.                YM08105 14870202
         CLI   1(R9),2             MORE THAN 2 PRMS?            YM08105 14870302
         BNH   AODFLT12            BRANCH NO.                   YM08105 14870402
*  MORE THAN 2 PRMS. FAIL JOB AND ISSUE ERROR MESSAGE.          YM08105 14870502
         MVI   MSGKEY,MSGLEVJK     SET KEY FOR SECONDARY MSG.   YM08105 14870602
         LA    R2,ERMES3           EXCESSIVE PARAM MSG CODE.    YM08105 14870702
         B     AODFLT69            BR TO FAIL JOB, ISSUE MSG.   YM08105 14870802
*                                                               YM08105 14870902
*  LEGAL NUMBER OF PRMS.                                        YM08105 14871002
AODFLT12 DS    0H                                               YM08105 14871102
         BAL   RE,AOMGL1DF         CHECK IF ONE DEFAULT OMITTED.YM08105 14871202
*  AOMGL1DF WILL REPLACE DEFAULTS IN THE WORK AREA WITH ANY     YM08105 14871302
*  VALUES SPECIFIED ON THE JOB STATEMENT.                       YM08105 14871402
AODFLT15 DS    0H                                               YM08105 14871502
*  MOVE MSGLEVEL VALUES (SPECIFIED OR DEFAULTS) FROM WA TO TEXT.YM08105 14872002
         MVC   0(AOMGLLTH,R7),AOMSGLTX APPEND PREBUILT TEXT.     Y02668 14874002
         MVC   AOMGLDP1(1,R7),WAMSGL1 ENTER WA VALUE IN TEXT.   YM08105 14876002
         MVC   AOMGLDP2(1,R7),WAMSGL2 ENTER WA VALUE IN TEXT.   YM08105 14878002
         LA    R7,AOMGLLTH(R7)     ADD TEXT LTH TO KEY BYTE PTR. Y02668 14880002
         MVI   0(R7),ENDK          SET END KEY FOR TEXT SEARCH. YM01546 14881002
* PRTY     CHECK.                                                Y02668 14882002
AODFLT20 DS    0H                                                Y02668 14884002
         LA    R3,PRTYJK           LOAD KEY.                     Y02668 14886002
         BAL   R6,AOPRMCHK         CHECK IF DEFAULT REQUIRED.   YM00154 14888002
         LTR   R9,R9               DEFAULT REQUIRED?            YM00154 14890002
         BNZ   AODFLT30            NO, BRANCH TO TRY NEXT.      YM00154 14892002
* PRTY     VALUE NOT SPECIFIED ON JCL. DEFAULT IS SUPPLIED.     YM00154 14894002
         MVC   0(AOPRTLTH,R7),AOPRTYTX APPEND PREBUILT TEXT.     Y02668 14896002
         MVC   AOPRTDSP(2,R7),NELJPRTY ENTER DEFAULT.            Y02668 14898002
         LA    R7,AOPRTLTH(R7)     ADD TEXT LTH TO KEY BYTE PTR. Y02668 14900002
         MVI   0(R7),ENDK          SET END KEY FOR TEXT SEARCH. YM01546 14901002
* REGION   CHECK.                                                Y02668 14902002
AODFLT30 DS    0H                                                Y02668 14904002
         L     RF,TEXTBUFP         ADDRESS OF TEXT STRING.      YM01546 14904602
         USING TEXT,RF             TEXT ADDRESSABILITY.         YM01546 14905202
         LA    R3,REGINJK          LOAD KEY.                     Y02668 14906002
         BAL   R6,AOPRMCHK         CHECK IF DEFAULT REQUIRED.   YM00154 14908002
         LTR   R9,R9               DEFAULT REQUIRED?            YM00154 14910002
         BNZ   AODFLT50            NO, BRANCH TO TRY NEXT.      YM00154 14912002
* REGION   VALUE NOT SPECIFIED ON JCL. DEFAULT IS SUPPLIED.     YM00154 14914002
         MVC   0(AOREGLTH,R7),AOREGNTX APPEND PREBUILT TEXT.     Y02668 14916002
         MVC   AOREGDSP(3,R7),NELREG ENTER DEFAULT.              Y02668 14918002
         OI    STRJINDC,JTXREGDF   INDICATE REGION IS A DEFAULT. Y02668 14919202
         LA    R7,AOREGLTH(R7)     ADD TEXT LTH TO KEY BYTE PTR. Y02668 14920002
         MVI   0(R7),ENDK          SET END KEY FOR TEXT SEARCH. YM01546 14921002
*****************************************************************Y02668 14942102
*                                                               *Y02668 14942202
* PROPAGATE OPTIONS  TO THE JOB TEXT PREFIX, FOR PROCESSING     *Y02668 14942302
* BY THE INTERPRETER (IEFVJA).                                  *Y02668 14942402
*                                                               *Y02668 14942502
*****************************************************************Y02668 14942602
AODFLT50 DS    0H                                                Y02668 14942702
         TM    NELPARMO,NELPGMN    PROGR NAME REQUIRED OPTION?   Y02668 14942802
         BZ    AODFLT54            BRANCH NO.                    Y02668 14942902
         OI    STRJINDC,JTXPROGN   YES, PROPAGATE OPTION TO PFX. Y02668 14943002
AODFLT54 DS    0H                                                Y02668 14943102
         TM    NELPARMO,NELACCT    ACCT # REQUIRED OPTION ?      Y02668 14943202
         BZ    AODFLT60            BRANCH NO.                    Y02668 14943302
         OI    STRJINDC,JTXACCTN   YES, PROPAGATE OPTION TO PFX. Y02668 14943402
* LABEL CHECK.                                                   Y02668 14944002
*****************************************************************Y02668 14946002
*                                                               *Y02668 14948002
* LABEL DEFAULT PROCESSING IS AN EXCEPTIONAL CASE. THE ACTUAL   *Y02668 14950002
* CHECK FOR THE SPECIFICATION OF LABEL PROCESSING PARAMETERS IS *Y02668 14952002
* MADE IN THE INTERPRETER (IEFVDA). WHAT THIS ROUTINE DOES IS   *Y02668 14954002
* MERELY TRANSMIT TO THE INTERPRETER THE LABEL PROCESSING       *Y02668 14956002
* DEFAULTS SUPPLIED IN THE NEL. THIS IS DONE BY MEANS OF LABEL  *Y02668 14958002
* FLAGS IN THE PREFIX OF THE JOB STATEMENT TEXT STRING, RATHER  *Y02668 14960002
* THAN BY APPENDING PREBUILT LABEL TEXT, TO RETAIN COMPATIBILITY*Y02668 14962002
* WITH EXISTING CODE IN IEFVDA.                                 *Y02668 14964002
*                                                               *Y02668 14966002
*****************************************************************Y02668 14968002
AODFLT60 DS    0H                                                Y02668 14970002
         CLI   NELLABEL,C'0'       CHAR EQUAL 0?                 Y02668 14976002
         BNE   AODFLT64            NO, CHECK FOR 1.              Y02668 14978002
* CHARACTER IS 0.                                                Y02668 14980002
         MVI   STRJLABD,JTXLABNL   SET BIT FOR NL.               Y02668 14984002
         B     AODFLT70            EXIT.                         Y02668 14986002
AODFLT64 DS    0H                                                Y02668 14988002
         CLI   NELLABEL,C'1'       CHAR EQUAL 1?                 Y02668 14990002
         BNE   AODFLT68            NO,INVALID SPECIFICATION.     Y02668 14992002
* CHARACTER IS 1.                                                Y02668 14994002
         MVI   STRJLABD,JTXLABLP   SET BIT FOR BLP.              Y02668 14996002
         B     AODFLT70            EXIT.                         Y02668 14998002
*  NEITHER 0 NOR 1 - INVALID CHARACTER.                          Y02668 15000002
AODFLT68 DS    0H                                                Y02668 15001002
         MVI   MSGKEY,LABELK       SET KEY FOR SECONDARY MSG.    Y02668 15002002
         LA    R2,ERMSG639         'INVALID CLASS' MSG CODE.     Y02668 15003002
*                                                               YM08105 15004002
*  COMMON ERROR ENTRY FOR SETTING JOB FAIL BIT AND ENTERING     YM08105 15005002
*  ERROR MSG CODE IN REG 2 FOR IEFVGM.                          YM08105 15006002
AODFLT69 DS    0H                                               YM08105 15007002
         L     RF,TEXTBUFP         ADDRESS OF JOB TEXT STRING.  YM08105 15008002
         OI    STRJINDC,JTXJOBFL   SET JOB FAIL SWITCH FOR K1.  YM08105 15009002
         DROP  RF                                               YM08105 15010002
         ST    R2,AODFLTSA+4       SET ERR CODE IN R2 SLOT.     YM01546 15014602
         B     AODFLT70            EXIT.                        YM01546 15014802
         EJECT                                                  YM01546 15015002
****************************************************************YM01546 15015202
*                                                              *YM01546 15015402
* EXEC STATEMENT DEFAULT PROCESSING -                          *YM01546 15015602
*                                                              *YM01546 15015802
* .SPECIFICATION OF A PARAMETER ON AN EXEC STATEMENT INVOKING  *YM01546 15016002
*  A PROCEDURE (EXEC PROC) RESULTS IN AN OVERRIDE OF THE VALUE *YM01546 15016202
*  SPECIFIED ON THE EXEC STATEMENT (EXEC PGM) CONTAINED IN THE *YM01546 15016402
*  PROCEDURE.                                                  *YM01546 15016602
* .SPECIFICATION OF A NULL PARAMETER (KEYWORD=,) ON THE EXEC   *YM01546 15016802
*  PROC STATEMENT, RESULTS IN AN OVERRIDE WITH A DEFAULT VALUE,*YM01546 15017002
*  OF THE VALUE SPECIFIED ON THE EXEC PGM STATEMENT.           *YM01546 15017202
* .ABSENCE OF A PARTICULAR KEYWORD FROM BOTH THE EXEC PROC AND *YM01546 15017402
*  THE EXEC PGM STATEMENTS, RESULTS IN THE ASSIGNMENT OF A     *YM01546 15017602
*  DEFAULT VALUE FOR THE KEYWORD.                              *YM01546 15017802
* .ABSENCE OF THE TIME KEYWORD FORM THE EXEC PROC STMT RESULTS *YM01546 15018002
*  IN THE ASSIGNMENT OF THE TIME VALUE SPECIFIED ON THE EXEC   *YM01546 15018202
*  PGM STMT. IF NONE WAS SPECIFIED, THE TIME DEFAULT VALUE     *YM01546 15018402
*  IS THEN ASSIGNED.                                           *YM01546 15018602
*                                                              *YM01546 15018802
****************************************************************YM01546 15019002
*                                                               YM01546 15019202
* CHECK IF TIME KEYWORD SPECIFIED.                              YM01546 15019402
AOEDFL10 DS    0H                                               YM01546 15019602
         TM    PSTMT+4,8           EXEC CONVERTED FROM PROC ST? YM01546 15019802
         BO    AOEDFL90            YES, BYPASS DEFAULTS.        YM01546 15020002
         L     R6,TBEGP            POINT TO BASE KEY.           YM01546 15020202
         LA    R6,1(R6)            POINT TO PARAM COUNT.        YM01546 15020402
         CLI   0(R6),2             TWO PRMS? EXEC PROC HAS 2.   YM01546 15020602
         BE    AOEDFL15            BR YES TO EXEC PROC CODE.    YM01546 15020802
* ONE PARAM - STMT MAY BE EXEC PROC=PROCNAME OR PGM=PROGNM.     YM01546 15021002
* CHECK FOR PROC= KEY.                                          YM01546 15021202
         MVI   AOSCHKYS,PROCEK     ENTER KEY IN SEARCH LIST.    YM01546 15021402
         MVI   AOSCHKYS+1,ENDLISTI END OF LIST INDICATOR.       YM01546 15021602
         BAL   RE,AOKSRCHR         SEARCH FOR KEY IN TEXT.      YM01546 15021802
* AOKSRCHR RETURNS ADDR OF FOUND KEY IN R9, ZERO IF NOT FOUND.  YM01546 15022002
         LTR   R9,R9               PROC= KEY FOUND?             YM01546 15022202
         BZ    AOEDFL30            BR NO, EXEC PGM.             YM01546 15022402
*                                                               YM01546 15022602
*  STATEMENT INVOKES PROC. IF NULL TIME SPECIFIED (TIME=,) THE  YM01546 15022802
*  DEFAULT IS SUPPLIED, TO OVERRIDE TIME VALUES SPECIFIED ON    YM01546 15023002
*  THE EXEC STMTS IN THE PROC. IF TIME KEYWORD WAS NOT          YM01546 15023202
*  SPECIFIED, NO DEFAULT IS SUPPLIED, TO PERMIT TIME VALUES     YM01546 15023402
*  SPECIFIED ON THE EXEC STMTS IN THE PROC TO TAKE EFFECT.      YM01546 15023602
*                                                               YM01546 15023802
AOEDFL15 DS    0H                                               YM01546 15024002
         MVI   AOSCHKYS,TIMEEEK    ENTER KEY IN SEARCH LIST.    YM01546 15024202
         MVI   AOSCHKYS+1,ENDLISTK END OF LIST INDICATOR.       YM01546 15024402
         LR    R3,R7               SAVE R7. AOKSRCHR SAVES R3.  YM01546 15024602
         BAL   RE,AOKSRCHR         SEARCH TEXT FOR KEY.         YM01546 15024802
         LR    R7,R3               RESTORE R7.                  YM01546 15025002
* AOKSRCHR RETURNS ADDR IN R9 IF KEY FOUND, ZERO IF NOT FOUND.  YM01546 15025202
         LTR   R9,R9               KEY FOUND?                   YM01546 15025402
         BZ    AOEDFL90            BR NO TO EXIT, NO DEFAULTS.  YM01546 15025602
* KEY FOUND. FALL THROUGH TO CHECK FOR NULL VALUE.              YM01546 15025802
AOEDFL30 DS    0H                                               YM01546 15026002
         LA    R3,TIMEEEK          LOAD KEY.                    YM01546 15026202
         BAL   R6,AOPRMCHK         CHECK IF DEFAULT REQUIRED.   YM01546 15026402
* AOPRMCHK RETURNS WITH ZERO IN R9 IF DEFAULT TEXT TO BE ADDED. YM01546 15026602
         LTR   R9,R9               DEFAULT REQUIRED?            YM01546 15026802
         BNZ   AOEDFL90            BRANCH NO TO EXIT.           YM01546 15027002
* TIME NOT SPECIFIED ON STATEMENT, OR TIME PARAM WAS NULL -     YM01546 15027202
* I.E., 'TIME=,'.                                               YM01546 15027402
* R7 CONTAINS  POINTER TO END OF TEXT + 1.                      YM01546 15027602
         MVC   0(AOTIMLTH,R7),AOTIMETX APPEND PREBUILT TEXT.    YM01546 15027802
         MVC   AOTIMDP1(4,R7),NELTIME ENTER MINUTES DEFAULT.    YM01546 15028002
         MVC   AOTIMDP2(2,R7),NELTIME+4 ENTER SECONDS DEFAULT.  YM01546 15028202
         DROP  R1                                               YM01546 15028402
         LA    R7,AOTIMLTH(R7)     ADD TEXT LTH TO KEY BYTE PTR.YM01546 15028602
         MVI   0(R7),ENDK          SET END KEY FOR STRING.      YM01546 15028802
AOEDFL90 DS    0H                                               YM01546 15029002
* FALL THROUGH TO EXIT.                                         YM01546 15029202
         EJECT                                                  YM01546 15029402
* ALL CHECKS COMPLETED. EXIT FROM DEFAULT PROCESSING.           YM01546 15029602
AODFLT70 DS    0H                                               YM01546 15029802
         ST    R7,AODFLTSA+12      REPLACE OLD KEY BYTE PTR(R4) YM01546*15030002
                                   WITH UPDATED POINTER.        YM01546 15030202
         LM    R1,R7,AODFLTSA      RESTORE CALLER'S REGS.       YM01546 15030402
         L     R9,AODSPCSA         RESTORE K1 CALLER'S RET REG. YM01546 15030602
         BR    R6                  RETURN.                      YM01546 15030802
         EJECT                                                  YM01546 15031002
****************************************************************YM01546 15031202
*          *                                                   *YM01546 15031402
*          * AOPRMCHK - PARAMETER CHECK ROUTINE.               *YM01546 15031602
*          *                                                   *YM01546 15031802
*          * AOPRMCHK CHECKS TO SEE IF THE KEY FOR A PARTICULAR*YM01546 15032002
*          * KEYWORD EXISTS IN TEXT, AND IF SO, WHETHER AN     *YM01546 15032202
*          * ACTUAL  OR NULL PARAMETER HAS BEEN SUPPLIED.      *YM01546 15032402
*          * SPECIFICATION OF A NULL PARAMETER REPRESENTS, IN  *YM01546 15032602
*          * EFFECT, A REQUEST FOR THE ASSIGNMENT OF A DEFAULT *YM01546 15032802
*          * VALUE FOR THE KEYWORD.                            *YM01546 15033002
*          *                                                   *YM01546 15033202
*          * INPUT -                                           *YM01546 15033402
*          * .R3 - KEY FOR WHICH SEARCH IS TO BE MADE.         *YM01546 15033602
*          * .R7 - PTR TO END OF TEXT + 1.                     *YM01546 15033802
*          *                                                   *YM01546 15034002
*          * OUTPUT -                                          *YM01546 15034202
*          * .R9 - NON-ZERO IF PARAMETER SPECIFIED,            *YM01546 15034402
*          *       ZERO IF KEYWORD NOT SPECIFIED, OR SPECIFIED *YM01546 15034602
*          *       WITH NULL PARAMETER.                        *YM01546 15034802
*          *                                                   *YM01546 15035002
*          * NOTES -                                           *YM01546 15035202
*          * .AOPRMCHK USES AOKSRCHR TO FIND THE KEY IN TEXT.  *YM01546 15035402
*          * .AOPRMCHK SAVES R7 IN R3, TO INSURE ITS SAFETY,   *YM01546 15035602
*          *  SINCE AOKSRCHR SAVES ONLY RE THROUGH R6.         *YM01546 15035802
*          * .R6 IS THE BRANCH AND RETURN REG FOR THIS RTNE.   *YM01546 15036002
*          * .R3 AND R9 ARE USED AND NOT SAVED BY THIS RTNE.   *YM01546 15036202
*          * .AOPCHK2 IS AN ALTERNATE ENTRY POINT, IF ONLY THE *YM08105 15036402
*          *  TEXT OVERLAY FUNCTION OF AOPRMCHK IS DESIRED.    *YM08105 15036502
*          *                                                   *YM08105 15036602
****************************************************************YM08105 15036702
*                                                               YM08105 15036802
AOPRMCHK DS    0H                                               YM08105 15036902
         STC   R3,AOSCHKYS         ENTER KEY IN SEARCH LIST.    YM01546 15037202
         MVI   AOSCHKYS+1,ENDLISTK END OF LIST INDICATOR.       YM01546 15037402
         LR    R3,R7               SAVE R7. AOKSRCHR SAVES R3.  YM01546 15037602
         BAL   RE,AOKSRCHR         SEARCH TEXT FOR KEY.         YM01546 15037802
         LR    R7,R3               RESTORE R7.                  YM01546 15038002
* AOKSRCHR RETURNS ADDR IN R9 IF KEY FOUND, ZERO IF NOT FOUND.  YM01546 15038202
         LTR   R9,R9               KEY FOUND?                   YM01546 15038402
         BZ    AOPCHK10            BR NO TO RETURN.             YM01546 15038602
* KEYWORD WAS SPECIFIED. CHECK FOR NULL PARAM (I.E., KEYWORD=,).YM01546 15038802
         CLI   1(R9),1             ONE PARAMETER?               YM01546 15039002
         BH    AOPCHK10            MORE THAN 1 MEANS PARM VALID YM01546*15039202
                                   OR JCL ERROR.                YM01546 15039402
         CLI   2(R9),0             IS PARAM LTH ZERO?           YM01546 15039602
         BNE   AOPCHK10            NON-ZERO LTH MEANS PRM VALID YM01546 15039802
****************************************************************YM01546 15040002
* NULL PARAMETER WAS SPECIFIED. ELIMINATE TEXT FOR KEYWORD, SO  YM01546 15040202
* THAT APPENDED DEFAULT TEXT WILL NOT REPRESENT DUPLICATION OF  YM01546 15040402
* TEXT FOR THE KEYWORD. THIS IS ACCOMPLISHED BY OVERLAYING THE  YM01546 15040602
* THREE BYTES OF TEXT FOR THE NULL PARAM WITH THE REMAINDER OF  YM01546 15040802
* THE TEXT STRING.                                              YM01546 15041002
****************************************************************YM01546 15041102
         LA    R2,3                LTH OF TEXT TO BE OVERLAID.  YM08105 15041202
*  R2 = LENGTH OF TEXT TO BE OVERLAID.                          YM08105 15041302
*  R7 = ADDRESS OF END OF TEXT +1                               YM08105 15041402
*  R9 = ADDRESS OF TEXT SEGMENT TO BE OVERLAID.                 YM08105 15041502
AOPCHK2  DS    0H                  ENTRY FOR TEXT OVERLAY.      YM08105 15041602
         STM   R4,R7,IWAIOSA       SAVE REGS USED BELOW.        YM01546 15041702
         LR    R4,R9               INITIALIZE TARGET REG.       YM01546 15041802
         LR    R5,R7               COPY EOTEXT +1 ADDRESS.      YM01546 15041902
         LA    R6,0(R2,R4)         ADD LTH TO TARGET PTR TO GET YM01546*15042402
                                   SOURCE ADDR(TEXT AFTER NULL) YM01546 15042602
         SR    R5,R6               COMPUTE LTH OF MOVE -        YM01546*15042802
                                   LTH=EOTEXT ADDR-SOURCE ADDR. YM01546 15043002
         MVCL  R4,R6               OVERLAY NULL PARAM TEXT.     YM01546 15043202
         LM    R4,R7,IWAIOSA       RESTORE REGS.                YM01546 15043402
         SR    R7,R2               UPDATE EOTEXT ADDRESS TO     YM08105*15043602
                                   REFLECT NEW TEXT STRING LTH. YM01546 15043802
         SR    R9,R9               INDICATE DEFAULT REQUIRED.   YM01546 15044002
AOPCHK10 DS    0H                                               YM01546 15044202
         BR    R6                  RETURN.                      YM01546 15044402
*                                                               YM01546 15044602
         EJECT                                                          15045002
****************************************************************YM08105 15047002
*          *                                                   *YM08105 15049002
*          *  MSGLEVEL KEYWORD SPECIFIED IN NON-NULL FORM. THIS*YM08105 15051002
*          *  ROUTINE CHECKS IF BOTH PRMS HAVE BEEN SPECIFIED. *YM08105 15053002
*          *  IF THERE HAS BEEN AN OMISSION, A DEFAULT IS      *YM08105 15055002
*          *  SUPPLIED.                                        *YM08105 15057002
*          *  LISTED BELOW ARE MSGLEVEL VARIATIONS FOR WHICH   *YM08105 15059002
*          *  THIS ROUTINE CHECKS, AND THE DEFAULTS SUPPLIED.  *YM08105 15061002
*          *                                                   *YM08105 15063002
*          *  A. MSGLEVEL=X      ALLOC DEFAULT.                *YM08105 15065002
*          *  B. MSGLEVEL=(X,)   ALLOC DEFAULT.                *YM08105 15067002
*          *  C. MSGLEVEL=(X,Y)  NO DEFAULT.                   *YM08105 15069002
*          *  D. MSGLEVEL=(,Y)   JCL DEFAULT.                  *YM08105 15071002
*          *  E. MSGLEVEL=(,)    JCL AND ALLOC DEFAULTS.       *YM08105 15073002
*          *                                                   *YM08105 15075002
****************************************************************YM08105 15077002
*  R9 = ADDRESS OF MSGLEVEL KEY IN TEXT STRING.                 YM08105 15079002
*  R2 = POINTER TO MSGLEVEL TEXT CONTROL FIELDS.                YM08105 15081002
*  RE = BRANCH AND RETURN REG.                                  YM08105 15083002
AOMGL1DF DS    0H                                               YM08105 15085002
         LA    R2,2(R9)            SET PTR TO JCL PRM LTH.      YM08105 15087002
         CLI   0(R2),1             NON-NULL, LEGAL JCL LTH?     YM08105 15089002
         BH    AOMSGL90            BR EXCESSIVE PRM LTH.        YM08105 15091002
         BL    AOMSGL50            BR NULL TO CHECK ALLOC PRM.  YM08105 15093002
*  NON-NULL JCL PRM - VAR A, B OR C.                            YM08105 15095002
         LA    R2,1(R2)            SET PTR TO JCL VALUE.        YM08105 15097002
         MVC   WAMSGL1(1),0(R2)    JCL VALUE FROM TEXT TO WA.   YM08105 15099002
*                                                               YM08105 15101002
*  CHECK ALLOC PRM.                                             YM08105 15103002
AOMSGL50 DS    0H                                               YM08105 15105002
         CLI   1(R9),2             ALLOC PRM INDICATED?         YM08105 15107002
         BL    AOMSGL70            BR NO TO OVERLAY TEXT-VAR A. YM08105 15109002
*  ALLOC PRM INDICATED - VAR B THRU E.                          YM08105 15111002
         LA    R2,1(R2)            SET PTR TO ALLOC LTH.        YM08105 15113002
         CLI   0(R2),1             NON-NULL, VALID ALLOC LTH?   YM08105 15115002
         BH    AOMSGL90            BR EXCESSIVE PRM LTH.        YM08105 15117002
         BL    AOMSGL70            BR NULL ALLOC PRM.           YM08105 15119002
*  NON-NULL ALLOC PRM - VAR C OR D.                             YM08105 15121002
         LA    R2,1(R2)            SET PTR TO ALLOC VALUE.      YM08105 15123002
         MVC   WAMSGL2(1),0(R2)    ALLOC VALUE FROM TEXT TO WA. YM08105 15125002
*                                                               YM08105 15127002
*  ENTRY TO OVERLAY EXISTING MSGLEVEL TEXT AND APPEND           YM08105 15129002
*  DEFAULT TEXT.                                                YM08105 15131002
*  R2 POINTS TO LAST BYTE OF MSGLEVEL TEXT.                     YM08105 15133002
AOMSGL70 DS    0H                                               YM08105 15135002
         LA    R2,1(R2)            ADD 1 FOR LAST BYTE.         YM08105 15137002
         SR    R2,R9               COMPUTE LTH OF MSGLEVEL TEXT.YM08105 15139002
         BAL   R6,AOPCHK2          BR TO OVERLAY EXISTING TEXT. YM08105 15141002
         BR    RE                  RETURN.                      YM08105 15143002
*                                                               YM08105 15145002
*  ENTRY FOR EXCESSIVE PRM LENGTH ERROR.                        YM08105 15147002
AOMSGL90 DS    0H                                               YM08105 15149002
         LA    R2,ERMSG642         EXCESSIVE PRM LTH MSG CODE.  YM08105 15151002
         MVI   MSGKEY,MSGLEVJK     SET KEY FOR SECONDARY MSG.   YM08105 15153002
         B     AODFLT69            BR TO FAIL JOB, ISSUE MSG.   YM08105 15155002
         EJECT                                                          15180000
*          ******************************************************Y02668 15180202
*          *                                                    *Y02668 15180402
*          * PREBUILT TEXT SEGMENTS FOR PARAMETERS FOR WHICH    *Y02668 15180602
*          * DEFAULTS ARE SUPPLIED BY THE SYSTEM.               *Y02668 15180802
*          *                                                    *Y02668 15181002
*          ******************************************************Y02668 15181202
         SPACE 2                                                 Y02668 15181402
* MSGCLASS TEXT.                                                 Y02668 15181602
AOMSGCTX DS    0C                                                Y02668 15181802
         DC    AL1(MSGCLAJK)       MSGCLASS KEY.                 Y02668 15182002
         DC    AL1(1)              NUMBER OF PARAMS.             Y02668 15182202
         DC    AL1(1)              PARAM LENGTH                  Y02668 15182402
AOMGCDFL DC    AL1(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15182602
AOMGCEND DS    0C                  END OF TEXT.                  Y02668 15182802
AOMGCLTH EQU   AOMGCEND-AOMSGCTX   LTH OF TEXT.                  Y02668 15183002
AOMGCDSP EQU   AOMGCDFL-AOMSGCTX   DISPLACEMENT FOR DEFAULT.     Y02668 15183202
*                                                                Y02668 15183402
* MSGLEVEL TEXT.                                                 Y02668 15183602
AOMSGLTX DS    0C                                                Y02668 15183802
         DC    AL1(MSGLEVJK)       MSGLEVEL KEY.                 Y02668 15184002
         DC    AL1(2)              NUMBER OF PARAMS.             Y02668 15184202
         DC    AL1(1)              FIRST PARAM LTH.              Y02668 15184402
AOMGLDF1 DC    AL1(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15184602
         DC    AL1(1)              SECOND PARAM LTH.             Y02668 15184802
AOMGLDF2 DC    AL1(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15185002
AOMGLEND DS    0C                  END OF TEXT.                  Y02668 15185202
AOMGLLTH EQU   AOMGLEND-AOMSGLTX   LTH OF TEXT.                  Y02668 15185402
AOMGLDP1 EQU   AOMGLDF1-AOMSGLTX   DISPLACEMENT FOR DEFAULT.     Y02668 15185602
AOMGLDP2 EQU   AOMGLDF2-AOMSGLTX   DISPLACEMENT FOR DEFAULT.     Y02668 15185802
*                                                                Y02668 15186002
* PRTY TEXT.                                                     Y02668 15186202
AOPRTYTX DS    0C                                                Y02668 15186402
         DC    AL1(PRTYJK)         PRTY KEY.                     Y02668 15186602
         DC    AL1(1)              NUMBER OF PARAMS.             Y02668 15186802
         DC    AL1(2)              PARAM LENGTH                  Y02668 15187002
AOPRTDFL DC    AL2(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15187202
AOPRTEND DS    0C                  END OF TEXT.                  Y02668 15187402
AOPRTLTH EQU   AOPRTEND-AOPRTYTX   LTH OF TEXT.                  Y02668 15187602
AOPRTDSP EQU   AOPRTDFL-AOPRTYTX   DISPLACEMENT FOR DEFAULT.     Y02668 15187802
*                                                                Y02668 15188002
* REGION TEXT.                                                   Y02668 15188202
AOREGNTX DS    0C                                                Y02668 15188402
         DC    AL1(REGINJK)        REGION KEY.                   Y02668 15188602
         DC    AL1(1)              NUMBER OF PARAMS.             Y02668 15188802
         DC    AL1(4)              PARAM LENGTH.                 Y02668 15189002
AOREGDFL DC    AL3(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15189202
         DC    C'K'                REGION IDENTIFIER.            Y02668 15189402
AOREGEND DS    0C                  END OF TEXT.                  Y02668 15189602
AOREGLTH EQU   AOREGEND-AOREGNTX   LTH OF TEXT.                  Y02668 15189802
AOREGDSP EQU   AOREGDFL-AOREGNTX   DISPLACEMENT FOR DEFAULT.     Y02668 15190002
*                                                                Y02668 15190202
* TIME TEXT.                                                     Y02668 15190402
AOTIMETX DS    0C                                                Y02668 15190602
         DC    AL1(TIMEEEK)        TIME KEY.                    YM01546 15190802
         DC    AL1(2)              NUMBER OF PARAMS.             Y02668 15191002
         DC    AL1(4)              FIRST PARAM LTH.              Y02668 15191202
AOTIMDF1 DC    AL4(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15191402
         DC    AL1(2)              SECOND PARAM LTH.             Y02668 15191602
AOTIMDF2 DC    AL2(0)              NULL PARAM - DEFAULT SLOT.    Y02668 15191802
AOTIMEND DS    0C                  END OF TEXT.                  Y02668 15192002
AOTIMLTH EQU   AOTIMEND-AOTIMETX   LTH OF TEXT.                  Y02668 15192202
AOTIMDP1 EQU   AOTIMDF1-AOTIMETX   DISPLACEMENT FOR DEFAULT.     Y02668 15192402
AOTIMDP2 EQU   AOTIMDF2-AOTIMETX   DISPLACEMENT FOR DEFAULT.     Y02668 15192602
WAMSGL1  EQU   AOHEBSA             JCL PRM VALUE FOR MSGLEVEL.  YM08105 15192802
WAMSGL2  EQU   AOHEBSA+1           ALC PRM VALUE FOR MSGLEVEL.  YM08105 15193002
         EJECT                                                          15193202
*          **********************************************************   15200000
*          *                                                        *   15220000
*          *   ERROR ROUTINE                                        *   15240000
*          *       SETS SWITCH TO FAIL JOB                          *   15260000
*          *       SETS ERROR SWITCH FOR DD STATEMENT               *   15280000
*          *       MOVES FAKE JOB TEXT FOR JOB STATEMENT            *   15300000
*          *       MOVES FAKE EXEC TEXT FOR EXEC STATEMENT          *   15320000
*          *       USES MESSAGE MODULE TO ISSUE ERROR MESSAGE       *   15340000
*          *       GOES TO SCAN EXIT ROUTINE                        *   15360000
*          *                                                        *   15380000
*          **********************************************************   15400000
E1       DS    0H                  ENTRY TO ERROR ROUTINE.              15420000
         L     RF,IEFVGMV         LOAD VCON                             15421000
         SCSW  O,CXPNZ,E102        CTL RTNE ISSUES MSG          YM00393 15424002
         BALR  RE,RF               GO TO ISSUE MSG              YM00393 15427002
E102     DS    0H                                                       15431000
         SCSW  S,PROCERRZ         SET ERROR INDICATOR FOR PROC O RIDE   15440000
         LA    R1,WAJOBPFX         ADDRESS OF PSEUEDO JOB PFX.   Y02668 15460002
         USING TEXT,R1             PREFIX ADDRESSABILITY.        Y02668 15462002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 15464002
         DROP  R1                                                Y02668 15466002
         SCSW  O,VERBCSWZ,E104    TRANSFER PROC VERB                    15470000
         SCSW  O,JOBSWY,E2        TRANSFER JOB.                         15480000
         SCSW  O,EXECSWY,E3       TRANSFER EXEC.                        15500000
E104     DS    0H                                                       15510000
         SCSW  S,FERRORA          SET ERROR FOR DD AND PROC VERB        15520000
         B     E4                 TRANSFER.                             15540000
E2       DS    0H                 ENTER FOR JOB.                        15560000
         MVC   WAJBNAME(8),DUMNAME CHANGE JOBNAME TO 'JOBFAIL',  Y02668 15570002
         LA    R1,DUMMYJCT         POINTER TO CANNED JOBFAIL TXT.Y02668 15580002
         LA    R5,JOTEXLEN         LOAD LENGTH OF TEXT.          Y02668 15590002
         B     E33                 MOVE FAIL TEXT TO TEXT BUFFER.Y02668 15600002
E3       DS    0H                 ENTER FOR EXEC.                       15620000
         NI    SRCHSW1,SRCHCLR-SRCHF8        TURN OFF SYMBOLIC @ZA03299 15622003
*                                      BYPASS SW. SO THAT IT IS@ZA03299 15623003
*                                      NOT APPLIED TO THE NEXT @ZA03299 15624003
*                                      STMT.  NORMALLY TURNED  @ZA03299 15625003
*                                      OFF IN COMMA OR BLANKS  @ZA03299 15626003
*                                      ROUTINE.                @ZA03299 15627003
         L     R1,TEXTBUFP         PREFIX ADDRESSABILITY       @ZA25564 15628003
         USING TEXT,R1                                         @ZA25564 15629003
         TM    STREINDC,ETXPROC    IS STATEMENT FROM A PROC    @ZA25564 15630003
         DROP  R1                                              @ZA25564 15631003
         BO    E31                 YES,DO NOT CLEAR SYMBUF PTR @ZA25564 15632003
         XC    SYMTTR(VFA4),SYMTTR CLEAR PTR TO SYMBUF         @ZA15003 15635003
E31      DS    0H                                              @ZA15003 15636003
         LA    R1,DUMMYSCT         PTR TO CANNED EXEC FAIL TEXT. Y02668 15640002
         LA    R5,EXTEXLEN         LOAD LENGTH OF TEXT.          Y02668 15641002
E33      DS    0H                                                Y02668 15642002
         L     R4,TEXTBUFP         POINT TO START OF BAD TEXT    Y02668 15643002
         BCTR  R5,0                REDUCE TEXT LTH FOR MOVE.     Y02668 15644002
         EX    R5,DUMTXTMV         MOVE FAIL TEXT OVER BAD TEXT. Y02668 15645002
         LA    R5,0(R4,R5)         ADD START ADDR AND TEXT LTH-1.Y02668 15646002
         LA    R5,1(R5)            ADD 1 TO GET ADDR OF NEXT     Y02668 15647002
         ST    R5,TLENP            AVAILABLE BYTE IN TEXT BUF.   Y02668 15648002
E4       DS    0H                 ENTER FOR ALL.                        15660000
         BAL   RE,AOTXTLTH         GO TO UPDATE TEXT LENGTH      Y02668 15662002
         LA    R7,ENDK             ENTER END KEY FOR             Y02668 15666002
         BAL   R9,K1               TEXT STRING IN ERROR.         Y02668 15672002
         SCSW  O,CXPNZ,FAD1       CONTRL RTN ISSUES CONTIN NOT RCVD MSG 15680000
         OI    CMTZ,CMT+ENDS      TURN ON COMMENT AND END SCAN SWS AACA 15710016
         B     FAC                TRANSFER.                             15760000
DUMTXTMV MVC   0(0,R4),0(R1)       EXECUTED MV-FAIL TEXT TO BUF. Y02668 15770002
DUMMYJCT DS    0C                  FAKE JOB TEXT.                       15780000
         DC    AL2(ENDDJCT-DUMMYJCT) LTH OF JOBFAIL TEXT.        Y02668 15784002
         DC    AL1(JOBSTR)         PREFIX - JOB STMT BIT ON      Y02668 15788002
         DC    AL1(JTXJOBFL+JTXMHEDR) IND JOB FAILED & MSG WRTN  Y02668 15790002
         DC    X'00'                                             Y02668 15792002
         DC    X'00'                                             Y02668 15796002
         DC    AL1(JOBK)          JOB KEY.                              15800000
         DC    X'03'              NUMBER BYTE.                          15820000
         DC    X'08'              LENGTH BYTE.                          15840000
DUMNAME  DS    0C                                                       15850002
         DC     C'JOBFAIL '       LABEL                                 15860000
         DC    X'08'              LENGTH BYTE.                          15880000
         DC    C'JOBFAILB'        ACCOUNT NUMBER.                       15900000
         DC    X'08'              LENGTH BYTE.                          15920000
         DC    C'JOBFAILC'        PROGRAMMER NAME.                      15940000
         DC    AL1(MSGLEVJK)      MSGLEVEL KEY                          15960000
         DC    X'01'              NUMBER BYTE                           15980000
         DC    X'01'              LENGTH BYTE                           16000000
         DC    C'1'               MSGLEVEL =1                           16020000
ENDDJCT  DS    0C                  END OF FAKE TEXT.                    16060000
DUMMYSCT DS    0C                  FAKE EXEC TEXT.                      16080000
         DC    AL2(ENDDSCT-DUMMYSCT) LTH OF EXECFAIL TEXT.       Y02668 16082002
         DC    AL1(EXECSTR)        INDICATE EXEC TEXT STRING     Y02668 16084002
         DC    X'00'                                             Y02668 16092002
         DC    AL1(EXECK)         EXEC KEY.                             16100000
         DC    X'01'              NUMBER BYTE.                          16120000
         DC    X'08'              LENGTH BYTE.                          16140000
         DC    C'EXECFAIL'        EXEC LABEL.                           16160000
         DC    AL1(PGMEK)         PGM EQUAL KEY.                        16180000
         DC    X'01'              NUMBER BYTE.                          16200000
         DC    X'08'              LENGTH BYTE.                          16220000
         DC    C'EXECNONE'        PROGRAM NAME.                         16240000
ENDDSCT  DS    0C                  END OF FAKE EXEC TEXT.               16280000
JOTEXLEN EQU   (ENDDJCT-DUMMYJCT)  JOBFAIL TEXT LENGTH           Y02668 16286002
EXTEXLEN EQU   (ENDDSCT-DUMMYSCT)  EXECFAIL TEXT LENGTH.         Y02668 16293002
         EJECT                                                          16300000
*          **********************************************************   16320000
*          *                                                        *   16340000
*          *   BRANCH ROUTINE                                       *   16360000
*          *       TRANSLATES JCL STATEMENT AND BRANCHES TO         *   16380000
*          *       ROUTINE TO PROCESS DELIMITER.                    *   16400000
*          *                                                        *   16420000
*          **********************************************************   16440000
FB1      DS    0H                  ENTRY TO BRANCH ROUTINE.             16460000
         L     R1,CSTRP            GET CHARACTER STRING POINTER.        16480000
FB2      DS    0H                  ENTRY TO BRANCH ROUTINE.             16500000
         LA    R1,1(R1)            BUMP CHARACTER STRING POINTER.       16520000
         ST    R1,CBSYP            SAVE CHARACTER STRING POINTER.       16540000
         L     R3,AFB7            GET ADDRESS OF TRANSLATE TABLE        16560000
         B     FB4                 TRANSFER.                            16580000
FB3      DS    0H                  SECONDARY ENTRY TO BRANCH ROUTINE.   16600000
         LA    R1,1(R1)            BUMP CHARACTER STRING POINTER.       16620000
FB4      DS    0H                  ENTRY FROM ABOVE                     16640000
         L     R5,CENDP            GET END POINTER.                     16660000
         SR    R2,R2              ZERO REGISTER.                        16680000
         SR    R5,R1              COMPUTE LENGTH CHARACTER STRING.      16700000
         BC    12,BKR             TRANSFER TO BLANK RTN                 16720000
         EX    R5,FB6              EXECUTE TRT INSTRUCTION              16740000
         LM    R5,R6,TKEYP         R5= TKEYP                            16746017
*                                  R6= TNUMP                            16752017
         BC    9,BKR          TRANSFER TO BLANK ROUTINE.           7821 16758017
         TM    ENDKYSWP,ENDKYSW    IS KEYWORD DELIMITER EXPECTED A28668 16758320
         BZ    FB41                NO - TRANSFER                 A28668 16758620
         CLI   0(R1),C'='          IS DLIMITER EQUAL             A28668 16758920
         BE    EQR                 YES. BRANCH TO EQUAL ROUTINE  A28668 16759220
         CLI   0(R1),C'.'          IS DELIMITER PERIOD           A28668 16759520
         BE    FB41                YEW. BRANCH TO CONTINUE       A28668 16759820
         CLI   0(R1),C'&&'         IS DELIMITER AMPERSAND        A28668 16760120
         BE    FB41                YES. TRANSFER TO CONTINUE     A28668 16760420
         CLI   0(R1),C' '          IS DELIMITER BLANK            A28668 16760720
         BNE   FB401               NO  TRANSFER ERROR            A28668 16761020
         BCTR  R1,R0               DECREMENT CSTRP               A28668 16761320
         CLI   0(R1),C','          WAS LAST CHARACTER COMMA      A28668 16761620
         BE    BKR3                YES, TRANSFER CONTINUATION    A28668 16761920
FB401    DS    0H                                                A28668 16762220
         LA    R2,ERMES19          NO. DELIMITER NOT FOR KEYWORD A28668 16762520
         B     E1                  GO TO ERROR RTN.                     16762820
FB41     DS    0H                                                A28668 16763120
         LA    R0,EQ          EQUAL SIGN FUNCTION BYTE VALUE.      7821 16764017
         CR    R2,R0          WAS DELIMITER AN '='.                7821 16770017
         BE    EQR            YES-BRANCH TO EQUAL SIGN ROUTINE.    7821 16776017
         STC   R2,DLMFBYTE    NO-SAVE DELIMITER FUNCTION BYTE.     7821 16782017
         B     FB5-4(R2)      BRANCH TO PROPER ROUTINE.            7821 16788017
FB5      DS    0H                  BRANCH TABLE.                        16800000
         B     BKR                 BLANK ROUTINE.                       16820000
         B     PRR                 PERIOD ROUTINE.                      16840000
         B     TTR                 ILLEGAL AND SLASH ROUTINE.           16860000
         B     LPR                 LEFT PAREN ROUTINE                   16880000
         B     PLR                PLUS ROUTINE                          16900000
         B     AMR                 AMPERSAND ROUTINE.                   16920000
         B     ASR                 ASTERICK ROUTINE                     16940000
         B     RPR                 RIGHT PAREN ROUTINE.                 16960000
         B     COR                 COMMA ROUTINE.                       16980000
         B     APR                 APOST ROUTINE                        17000000
         B     EQR                 EQUAL ROUTINE.                       17020000
         B     MIR                MINUS ROUTINE                         17040000
         B     SLR                SLASH ROUTINE                         17060000
FB6      DS    0H                  LABEL FOR TRANSLATE.                 17080000
         TRT   0(0,R1),0(R3)       EXECUTES THE TRANSLATE TABLE.        17100000
         EJECT                                                          17120000
TTR      DS    0H                  ENTRY FOR ILLEGAL ROUTINE.           17140000
         SPACE                                                          17141017
*   THE 'PLUS 0' CHARACTER ( 12-0 MULTIPUNCH ) IS USED IN SOME DATAAACA 17142017
*        MNGMT MODULE NAMES.  A CHECK IS MADE HERE TO DETERMINE IF AACA 17143017
*        THE CHARACTER IS  1). A PLUS 0 AND  2). IN DSN FIELD.     AACA 17144017
         SPACE                                                          17145017
         CLI   0(R1),X'C0'         IS THIS PLUS 0                  AACA 17146017
         BNE   TTR08               NO - ERROR                      AACA 17147017
         SPACE                                                          17148017
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 17149017
         SPACE                                                          17150017
         CLI   0(R5),DSNAMEK       IS IT DSN                       AACA 17151017
         BE    FB3                 YES - RET TO SCAN               AACA 17152017
         CLI   0(R5),DSIDK        IS IT THE DSID KEY?          @Y30OPSB 17152303
         BE    FB3      YES,12/0 OK WITH DSID AS WELL...       @Y30OPSB 17152603
TTR08    DS    0H                  NO  - ERROR                     AACA 17153017
         LA    R2,ERMES8           LOAD ERROR NUMBER                    17160000
         B     E1                  TRANSFER TO ERROR ROUTINE.           17180000
         EJECT                                                          17200000
BKR      DS    0H                  ENTRY TO BLANK ROUTINE               17220000
         BCTR  R1,R0               DECREMENT CSTRP.                     17240000
         CLI   0(R1),C','          IS LAST DELIMITER COMMA.             17260000
         BC    EQUAL,BKR3          YES TRANSFER                         17280000
         SCSW  O,COLSTY,BKR4      TRANSFER COL 72 NON BLANK             17300000
BKR11    DS    0H                                                       17320000
         LA    R1,1(R1)            RESTORE CSTRP.                       17340000
         SCSW  O,FLUSHSWW,BKR2     TRANSFER FLUSH SW ON.                17360000
         TM    SRCHSW1,SRCHF8     SYMBOLIC TO BE BYPASSED        A32730 17366020
         BO    BKR21              YES - BRANCH                   A32730 17372020
         SCSW  O,RPRSWW,BKR1       TRANSFER RT PAREN SW ON.             17380000
         ST    R1,CESYP            SAVE CHARACTER END SYMBOL POINTER.   17400000
BKR1     DS    0H                  ENTRY                                17420000
         L     R7,DELPTR           GET RSTMT/PSTMT POINTER      YM00399 17428002
* IF THERE IS NO OPERAND, THE OPER DISPLACEMENT IS 71 (COL 71). YM0399  17436002
         CLI   LISTPTR(R7),71      IS THERE AN OPERAND?         YM00399 17444002
         BE    BKR1A               NO  DO NOT ENTER TEXT        YM02708 17452002
         BAL   R7,T1               ENTER TEXT.                          17460000
BKR1A    DS    0H                                               YM02708 17462002
         SCSW  Z,POVRDZ,BKR2      TRANSFER NO DD OVERRIDE               17464016
*                                 SET COMMENT SW TO HANDLE POSSIBILITY  17468016
*                                      THAT THIS OVERRIDE IS            17472016
*                                      FOLLOWED BY A COMMENT            17476016
*                                      CONTINUATION.  THE SW            17480016
*                                      IS CLEARED WHEN ALL              17484016
*                                      COMMENT CONTINS ARE              17488016
         SCSW  S,CMTZ                  PROCESSED.                       17492016
         B     FAB                GO TO SCAN EXIT                       17496016
BKR21    NI    SRCHSW1,SRCHCLR-SRCHF8 SYMBOLIC BYPASS SWITCH OFF A32730 17498020
BKR2     DS    0H                  ENTRY                                17500000
         LA    R7,ENDK             GET END KEY                          17520000
         BAL   R9,K1               ENTER END KEY.                       17540000
         SCSW  C,CLEARSWW          CLEAR SWITCHES                       17560000
         SCSW  S,ENDSZ             SET END SCAN SWITCH ON.              17580000
         B     FAA                 TRANSFER                             17600000
BKR3     DS    0H                  ENTRY                                17620000
        SCSW  S,COLSTY           SET COL 72 SW ON                  AACA 17650016
         SCSW  S,CXPOPZ           SET CONT EXP FOR OPERANDS    @ZA12458 17660003
         B     FAA                                                 AACA 17680016
BKR4     DS    0H                 ENTRY TO CHECK FOR DELIMITER          17720000
         L     R7,CENDP                                                 17740000
         BCTR  R7,R0              PTR TO COL 71                         17760000
         CLR   R7,R1              IS OPERAND FIELD LESS THAN COL 72     17780000
         BC    HIGH,BKR11         YES  -  CONTINUE                      17800000
         CLI   0(R7),C' '         IS  COL 71 BLANK                      17820000
         BC    EQUAL,BKR11        YES - CONTINUE  PROCESSING            17840000
         LA    R2,ERMES6          OPERAND FIELD NOT TERM IN COMMA       17860000
         MVI   MSGKEY,0           CLEAR SECONDARY MSG                   17880000
         B     E1                                                       17900000
         EJECT                                                          17920000
PRR      DS    0H                  ENTRY TO PERIOD ROUTINE.             17940000
         SCSW  O,PROCSWZ,PRR0      TRANS-EXEC PROC OR PROC VERB   20978 17950018
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 17960017
PRR0     DS    0H                                                 20978 17970018
         MVI   MSGSVE,ERMES10     ERROR NUMBER FOR POSSIBLE ERROR       17980000
*                                      DETECTED BY EQUAL RTN            18000000
         CLC   1(1,R1),0(R1)       PERIOD THEN A PERIOD          A33203 18010020
         BE    PRR13               CHECK IF PROGRAMMER NAME FLD   M0745 18012001
         SCSW  O,RPRSWW,PRR4       TRANSFER PERIOD ERROR.               18020000
*        R5= TKEYP                                                 AACA 18040017
         SCSW  O,PDASSWW,PRR3      TRANSFER PERIOD DEL & AST SW ON      18060000
         BCTR  R1,0                LOOK AT PRIOR BYTE IN BUFFER@ZA10120 18062003
         CLI   0(R1),C'='          IS IT '=.' CONDITION?       @ZA20640 18064003
         LA    R1,1(R1)            RESTORE SCAN REG TO NORMAL  @ZA10120 18066003
         BC    NOT-EQUAL,PRR01     TRANSFER IF NOT '=.'        @ZA20640 18068003
         LA    R2,ERMES10          INCORRECT USE OF PERIOD     @ZA20640 18070003
         B     E1                  GO TO ERROR ROUTINE         @ZA10120 18072003
PRR01    EQU   *                                               @ZA10120 18078003
         CLI   0(R5),SUBALLOK      IS KEY SUBALLOC.                     18080000
         BC    NOT-EQUAL,PRR1      NO TRANSFER.                         18100000
         LA    R7,1(R5)            SET POINTER TO BASE NUMBER BYTE      18120000
         CLI   0(R7),2             IS NUMBER TWO.                       18140000
         BC    NOT-EQUAL,PRR1      NO TRANSFER                          18160000
         SCSW  S,PDASSWW           TURN ON PERIOD DEL & AST SW.         18180000
         SCSW  S,LPBYSWZ          SET LEFT PAREN SW                AACA 18190017
         B     PRR3                TRANSFER FOR TEXT ENTRY.             18200000
PRR1     DS    0H                  ENTRY.                               18220000
*        R6= TNUMP                                                 AACA 18240017
         CLI   0(R6),X'82'         IS NUMBER UP A LEVEL AT TWO.         18260000
         BC    NOT-EQUAL,PRR11     NO.                                  18280000
         CLI   0(R5),CONDPEK       YES IS KEY EXEC COND PERIOD.         18300000
         BC    EQUAL,PRR3          YES TRANSFER FOR TEXT ENTRY.         18320000
         CLI   0(R5),CONDEEK       NO IS KEY EXEC COND EQUAL.           18340000
         BC    EQUAL,PRR3          YES TRANSFER FOR TEXT ENTRY.         18360000
PRR11    DS    0H                                                       18380000
         CLI   0(R6),2             TRANSFER IF NO. OF POSITIONAL  M0745 18400001
         BC    NOT-EQUAL,PRR12     PARAMETERS IS NOT EQUAL TO TWO M0745 18420001
         CLI   0(R5),JOBK          TRANSFER IF THIS IS NOT        M0745 18440001
         BC    EQUAL,FB3           A JOB STATEMENT.               M0745 18490001
PRR12    DS    0H                                                       18500001
         CLI   0(R6),0             TRANSFER IF NO. OF POSITIONAL  M0745 18510001
         BC    NOT-EQUAL,PRR2      PARAMETERS IS NOTEQUAL TO ZERO M0745 18520001
         CLI   0(R5),PGMEK         IS THIS THE PGM= KEY           M0745 18540001
         BC    EQUAL,PRR4          TRANSFER - ERROR - IF PGM KEY  M0745 18560001
         SCSW  O,PDELSWW,FB3       TRANSFER IF PERIOD IS EXPECTED M0745 18580001
PRR2     DS    0H                  NO ENTRY FOR DICT LOOK UP.           18600000
         TM    EXECSWY,EXECSW     IS THIS AN EXEC STMT           A33229 18606020
         BNO   PRR4               IF NOT THEN AN ERROR           A33229 18612020
         OI    ENDKYSWP,ENDKYSW   SET END KEY SWITCH             A33229 18618020
         OI    SWY2,KEYNXTSW      SET NEXT KEY SWITCH            A33229 18624020
         B     EQR11              GO SEARCH SCAN DICT.           A33229 18630020
*********************************************************************** 18630401
*                                                                 M0745 18630801
*  THIS PTM WAS WRITTEN TO ALLOW A PERIOD TO BE FOLLOWED BY A     M0745 18631201
*  PERIOD IN THE PROGRAMMER NAME FIELD ON THE JOB STATEMENT       M0745 18631601
*                                                                 M0745 18631701
*********************************************************************** 18631801
PRR13    DS    0H                                                 M0745 18632001
         CLI   0(R6),2             TRANSFER IF NO. OF POSITIONAL  M0745 18634001
         BC    NOT-EQUAL,PRR4      PARAMETERS IS NOT EQUAL TO TWO M0745 18636001
         CLI   0(R5),JOBK          TRANSFER IF THIS IS            M0745 18638001
         BC    EQUAL,FB3           A JOB STATEMENT.               M0745 18638401
         B     PRR4                TRANSFER  ERROR                M0745 18638801
PRR3     DS    0H                  ENTRY FOR TEXT.                      18640000
         ST    R1,CESYP            SAVE END SYMBOL POINTER              18660000
         ST    R1,CSTRP                                                 18680000
         BAL   R7,T1               ENTER TEXT                           18700000
         SCSW  S,LDLX              TURN ON LAST DEL SW                  18720000
         B     FB1                 TRANSFER TO BRANCH ROUTINE.          18740000
PRR4     DS    0H                  ENTRY FOR ERROR                      18760000
         LA    R2,ERMES10          GET ERROR NUMBER                     18780000
         B     E1                  TRANSFER TO ERROR ROUTINE            18800000
         EJECT                                                          18820000
LPR      DS    0H                  ENTRY TO LEFT PAREN ROUTINE          18840000
         LH    R4,CURLE            GET CURRENT LEVEL OF PARENS     AACA 18860017
         SCSW  S,FPRNSWZ           SET LEFT PAREN INDICATOR        AACA 18880017
         LA    R4,1(R4)            BUMP LEVEL BY ONE FOR LEFT PAREN     18900000
         STH   R4,CURLE            SAVE CURRENT LEVEL                   18920000
         CL    R1,CBSYP            IS PTR STILL EQ TO STRING PTR   AACA 18950017
         BE    LPR3               CHECK FOR ILLEGAL LEFT PAREN   A36292 18960020
LPRORRTN TM    FLUSHSWW,FLUSHSW        IS THIS KEY OVERRIDDEN    A20874 18986018
         BC    ZERO,LPR2          BRANCH AROUND IF NOT OVERRIDE  A20874 18992018
         B     FB2                 RETURN TO SCAN                A28667 19001019
LPR2     DS    0H                                                A20874 19010018
         SCSW  O,RPRSWW,LPR1       NO TRANSFER IF RT PAREN SW ON.       19020000
*        R5= TKEYP                                                 AACA 19040017
         CLI   0(R5),DSNAMEK       IS KEY DSNAME                        19060000
         BC    NOT-EQUAL,LPR1      NO TRANSFER FOR LEFT PAREN ERROR     19080000
*        R6= TNUMP                                                 AACA 19100017
         CLI   0(R6),0                                                  19120000
         BC    NOT-EQUAL,LPR1      NO TRANSFER FOR LEFT PAREN ERROR     19140000
         ST    R1,CESYP            SAVE END SYMBOL POINTER.             19160000
         ST    R1,CSTRP                                                 19180000
         BAL   R7,T1               ENTER TEXT.                          19200000
         SCSW  C,PDASSWW           TURN OFF PERIOD DEL & AST SW.        19220000
         B     FB1                 TRANSFER TO BRANCH ROUTINE           19240000
LPR1     DS    0H                  ENTRY FOR ERRORS                     19260000
         LA    R2,ERMES11          LOAD ERROR NUMBER.                   19280000
         B     E1                  TRANSFER TO ERROR ROUTINE            19300000
LPR3     CLI   0(R5),DSNAMEK       IS KEY DSNAME                 A36292 19312020
         BC    NOT-EQUAL,FB2       RETURN TO SCAN NOT DSNAME     A36292 19314020
         SCSW  O,FLUSHSWW,FB2      RETURN IF KEY OVERRIDEN        M6150 19314420
         BCTR  R1,0                BACK UP TO PREVIOUS CHARACTER A36292 19316020
         CLI   0(R1),C'='          WAS LAST CHARACTER EQUAL SIGN A36292 19318020
         LA    R1,1(R1)            RESTORE SCAN REG TO NORMAL    A36292 19318420
         BE    LPR1                EQUAL SIGN LEFT PAREN ERROR   A36292 19318820
         B     FB2                 RETURN TO SCAN                A36292 19319220
         EJECT                                                          19320000
PLR      DS    0H                 ENTRY FOR PLUS RTN                    19340000
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 19360017
         SCSW  O,RPRSWW,PLR1       TRANSFER ERROR.                      19380000
*        R5= TKEYP                                                 AACA 19400017
*        R6= TNUMP                                                 AACA 19420017
         CLI   0(R5),DSNAMEK      IS KEY DSNAME.                        19440000
         BC    NOT-EQUAL,PLR1     NO TRANSFER                           19460000
*                  SYNTAX CHECK FOR + IN THE WRONG POSITION        3565 19463016
         CLI   0(R6),X'81'        IS THIS SECOND OPERAND           3565 19466016
         BNE   PLR1               NO, ERROR                        3565 19469016
         CL    R1,CBSYP           IS IT FIRST CHARACTER            3565 19472016
         BNE   PLR1               NO, ERROR                        3565 19475016
         ST    R1,CBSYP           YES SET BEGIN SYMBOL POINTER          19480000
         B     FB3                GO BACK TO SCAN                       19500000
PLR1     DS    0H                  ENTRY FOR ERRORS                     19520000
         LA    R2,ERMES12          LOAD ERROR NUMBER.                   19540000
         B     E1                  TRANSFER TO ERROR ROUTINE.           19560000
         EJECT                                                          19580000
MIR      DS    0H                 ENTRY FOR MINUS ROUTINE               19600000
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 19620017
         SCSW  O,RPRSWW,MIR1      ERROR                                 19640000
*        R5= TKEYP                                                 AACA 19670017
*        R6= TNUMP                                                 AACA 19700017
         SPACE                                                          19730017
         LA    RF,MIRTAB                                                19760017
         BAL   RE,XKRTN                                                 19790017
         CLI   0(RF),0            WAS KEY FOUND IN TABLE?        Y02668 19820002
         BE    MIRA               NO, CONTINUE                   Y02668 19830002
         CLI   0(RF),JOBK         JOB KEY?                       Y02668 19840002
         BNE   FB3                BRANCH TO CONTINUE PROCESSING  Y02668 19850002
         TM    AOSW1,AOFSTPOS     2ND POSITIONAL RECEIVED?     @ZA14268 19860003
         BO    MIR1               YES, ERROR                     Y02668 19870002
         B     FB3                BRANCH TO CONTINUE PROCESSING  Y02668 19880002
MIRA     DS    0H                                                       19900000
         CLI   0(R5),UNITK        IS IT UNIT KEY                        19920000
         BC    NOT-EQUAL,MIR1     NO TRANSFER ERROR                     19940000
         CLI   0(R6),0            YES IS NUMBER ZERO                    19960000
         BC    EQUAL,FB3          CONTINUE SCAN                         19980000
MIR1     DS    0H                 ENTRY FOR ERROR                       20000000
         LA    R2,ERMES18         LOAD ERROR NUMBER                     20020000
         B     E1                 TRANSFER TO ERROR RTN                 20040000
         EJECT                                                          20060000
AMR      DS    0H                  ENTRY TO AMPERSAND ROUTINE           20080000
         CLI   1(R1),C'&&'        IS THIS DOUBLE AMPERSANDS             20101000
         BE    AMR02              YES - TRANSFER                        20102000
         CLI   INTBUF,0           NO  - IS AMPERSAND IN INTBUF          20103000
         BNE   AMR03              YES - DO NOT PROCESS AS SYMBOLIC      20104000
         SCSW  O,VERBCSWZ,AMR1     AMP ON PROC VERB IS ERROR       AACA 20105017
         OC    SYMTTR(VFA4),SYMTTR DOES SYMBUF HAVE A TTR?       Y02621 20106002
         BZ    AMR03               NO - THERE ARE NO SYMBOLICS   Y02621 20107002
         L     RF,FIEFVFB         GET SYMBOLIC PARAMETER RTN            20109000
         BALR  RE,RF                                                    20110000
         CLI   INTBUF,0           IS TEXT IN INTBUF                     20111000
         BE    AMR03              NO  - PROCESS AS NO SYMBOLIC          20112000
         B     FB1                YES - GO TO SCAN INTBUF               20113000
AMR02    DS    0H                                                       20114000
         L     R6,CBSYP           BUMP BEGIN POINTER                    20115000
         LA    R6,1(R6)                                                 20116000
         ST    R6,CBSYP                                                 20117000
         LA    R1,1(R1)           BUMP TO SECOND AMPERSAND              20118000
*                                                                       20119000
*   NOTE -  DD PROCESSING ROUTINE SYMTAX CHECKS DSNAME FIELD            20120000
*                                                                       20121000
AMR03    DS    0H                                                       20122000
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 20128017
         SCSW  O,FBLITRLZ,APR8    BR- INCOMPLETE LITERAL EXPRESSION     20134000
         LM    R5,R6,TKEYP                                              20144017
         CLI   0(R5),DSNAMEK       IS KEY DSNAME.                       20160000
         BC    NOT-EQUAL,AMR1      NO TRANSFER FOR ERROR                20180000
         CLI   0(R6),0             IS NUMBER ZERO.                      20220000
         BC    NOT-EQUAL,AMR1      NO TRANSFER FOR ERROR                20240000
         SCSW  C,PDELSWW           TURN OFF PER DEL SW.                 20260000
         B     FB3                 TRANSFER TO BRANCH ROUTINE           20280000
AMR1     DS    0H                  ENTRY FOR ERRORS                     20300000
         LA    R2,ERMES13          LOAD ERROR NUMBER.                   20320000
         B     E1                  TRANSFER TO ERROR ROUTINE.           20340000
         EJECT                                                          20360000
SLR      DS    0H                 ENTRY FOR SLASH ROUTINE               20380000
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 20400017
         SCSW  O,RPRSWW,SLR1      TRANSFER ERROR                        20420000
*        R5= TKEYP                                                 AACA 20440017
*        R6= TNUMP                                                 AACA 20460017
         CLI   0(R5),UNITK        IS KEY UNIT                           20480000
         BC    NOT-EQUAL,SLR1     NO ERROR                              20500000
         CLI   0(R6),0            YES IS NUMBER BYTE ZERO               20520000
         BC    EQUAL,FB3          YES CONTINUE SCAN                     20540000
SLR1     DS    0H                 ENTRY FOR ERROR                       20560000
         LA    R2,ERMES17         LOAD ERROR NUMBER                     20580000
         B     E1                 TRANSFER TO ERROR RTN                 20600000
         EJECT                                                          20620000
ASR      DS    0H                  ENTRY TO ASTERICK ROUTINE            20640000
         BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN   AACA 20650017
*        R5= TKEYP                                                 AACA 20658017
         CLI   0(R5),DDK          IS THIS DD* STATEMENT            AABA 20666016
         BE    FB3                YES - RET TO TRANSLATE           AABA 20667016
         CLI   0(R5),RESTARJK      IS IT RESTART=                  AAAA 20670015
         BE    FB3                 YES- RETURN TO TRANSLATE RTN    AAAA 20675015
         CLI   0(R5),SYSOUTK       IS IT SYSOUT=  ?             YM03227 20676002
         BE    FB3                 YES  RETURN TO TRANSLATE     YM03227 20677002
         SCSW  O,RPRSWW,ASR1       TRANSFER ERROR                       20680000
         SCSW  Z,PDELSWW,ASR1      TRANSFER ERROR                       20700000
         SCSW  O,ASTSWW,ASR1       TRANSFER ERROR                       20720000
*                  SYNTAX CHECK FOR * IN THE WRONG POSITION        3565 20722016
*        R6= TNUMP                                                 AACA 20724017
         CLI   0(R6),0            IS IT FIRST OPERAND              3565 20726016
         BNE   ASR1               NO, ERROR                        3565 20728016
         CL    R1,CBSYP           IS IT FIRST CHARACTER            3565 20730016
         BNE   ASR1               NO, ERROR                        3565 20732016
         CLI   1(R1),C' '          IF LAST CHARACTER (FOLLOWED   M18103 20734018
         BE    ASR1                BY BLANK), IT'S AN ERROR      M18103 20736018
         SCSW  S,ASTSWW            TURN ON AST SW                       20740000
         SCSW  S,LPBYSWZ           SET LEFT PAREN BYPASS           AACA 20750017
         B     FB3                GO CONTINUE SCAN                      20760000
ASR1     DS    0H                  ENTRY FOR ERROR                      20780000
         LA    R2,ERMES14          LOAD ERROR NUMBER                    20800000
         B     E1                  TRANSFER TO ERROR ROUTINE            20820000
         EJECT                                                          20840000
RPR      DS    0H                  ENTRY FOR RIGHT PAREN ROUTINE.       20860000
         SR    R4,R4               CLEAR REGISTER.                      20880000
         AH    R4,CURLE            GET CURRENT LEVEL.                   20900000
         BP    RPR02              TRANSFER CURLE HIGH - OK              20904000
         LA    R2,ERMES7          CURLE NOT HIGH - NG                   20908000
         B     E1                 GO TO ERROR RTN                       20912000
RPR02    DS    0H                                                       20916000
DEC1     EQU   1                                                  22520 20916318
DEC0     EQU   0                                                  22520 20916618
         LA    R5,DEC1(R1)         GET PTR TO NEXT CHARACTER      22520 20916918
         LA    RF,RPRTAB           PT TO LAST TABLE ENTRY         22520 20917218
         BAL   RE,XKRTN            GO TO SEARCH TABLE             22520 20917518
         CLI   DEC0(RF),DEC0                                      22520 20917818
         BNE   RP06                YES, CONTINUE.              @ZA01934 20918103
RP03     DS    0H                                              @ZA01934 20918203
         LA    R2,ERMES19          NO, ERROR                      22520 20918418
         B     E1                  GO TO ERROR ROUTINE            22520 20918718
RP04     DS    0H                                                 22520 20919018
         CLI   DEC0(RF),AMPERSAN   IS NEXT CHAR SYMBOLIC?        A45828 20919401
         BE    RP05                YES,SKIP UPDATING PAREN       A45828 20919801
*                                  CURLE,ON RETURN FROM VFB WILL A45828 20919901
*                                  SCAN SAME PAREN AGAIN.        A45828 20926601
         BCTR  R4,R0               DECREMENT CURRENT LEVEL FOR RIGHT P. 20933301
         STH   R4,CURLE            SAVE CURRENT LEVEL.                  20940000
RP05     BAL   RE,ORRTN           GO SEE IF THIS KEY IS O'RIDDEN A45828 20965001
         SCSW  O,RPRSWW,FB3        TRANSFER RIGHT PAREN SW ON.          20980000
         ST    R1,CESYP            SAVE END SYMBOL POINTER              21000000
         SCSW  S,RPRSWW            SET RIGHT PAREN SWITCH ON.           21020000
         B     FB3                 TRANSFER TO BRANCH ROUTINE.          21040000
RP06     DS    0H                                              @ZA01934 21041003
         SR    R4,R4              CLEAR REGISTER               @ZA01934 21042003
RP07     DS    0H                                              @ZA01934 21043003
         CLI   DEC0(RF),RPARENT   IS NEXT CHAR RT PAREN?       @ZA01934 21044003
         BNE   RP08               NO,CONTINUE.                 @ZA01934 21045003
         LA    R4,DEC1(R4)        BUMP COUNT                   @ZA01934 21046003
         LA    R5,DEC1(R5)        GET PTR TO NEXT CHARACTER    @ZA01934 21047003
         LA    RF,RPRTAB          PT TO LAST TABLE ENTRY       @ZA01934 21048003
         BAL   RE,XKRTN           GO SEARCH TABLE                       21049003
         CLI   DEC0(RF),DEC0      VALID CHARACTER?             @ZA01934 21050003
         BE    RP03               NO, ERROR                    @ZA01934 21051003
         B     RP07               CONTINUE RT PAREN SEARCH     @ZA01934 21052003
RP08     DS    0H                                              @ZA01934 21060003
         SR    R5,R4              RESTORE CHAR POINTER         @ZA01934 21063003
         SR    R4,R4              CLEAR REGISTER               @ZA01934 21066003
         AH    R4,CURLE           GET CURRENT LEVEL            @ZA01934 21069003
         B     RP04               CONTINUE                     @ZA01934 21072003
         EJECT                                                          21075003
COR      DS    0H                  ENTRY TO COMMA ROUTINE               21080000
         ST    R1,CSTRP           SAVE CHARACTER STRING POINTER.        21100000
         SCSW  O,FLUSHSWW,FB1     TRANSFER FLUSH SWITCH ON.             21120000
         TM    SRCHSW1,SRCHF8     SYMBOLIC TO BE BYPASSED?       A32730 21126020
         BO    COR4               YES - BRANCH                   A32730 21132020
         SCSW  O,RPRSWW,COR1       TRANSFER RT PAREN SW ON.             21140000
         ST    R1,CESYP            SAVE CHAR END SYMBOL POINTER.        21160000
COR1     DS    0H                  ENTRY                                21180000
         ST    R1,CSTRP            SAVE CHAR STRING PT.                 21200000
COR2     DS    0H                  ENTRY FROM APOST ROUTINE.            21220000
         SR    R6,R6               CLEAR REGISTER                Y02668 21220802
         AH    R6,CURLE            GET CURRENT PAREN LEVEL       Y02668 21221602
         BNZ   COR3                TRANSFER PARAMETER NOT ENDED  Y02668 21222402
         TM    SWY2,KEYNXTSW       HAS FIRST KEYWORD BEEN RCVD   A28668 21224020
         BZ    COR3                NO. TRANSFER TO CONTINUE      A28668 21228020
         OI    ENDKYSWP,ENDKYSW    SET SWITCH FOR END OF PARAM   A28668 21244020
*                                  NEW KEYWORD  SHOULD FOLLOW    A28668 21248020
COR3     DS    0H                                                A28668 21252020
         BAL   R7,T1               ENTER TEXT                           21260000
         SCSW  Z,EXECSWY,COR3A     CHECK FOR EXEC STMT.          Y02668 21264002
* ON EXEC, FIRST POSITIONAL IS A PROCNAME - //S  EXEC  PROCNAME,.Y02668 21268002
         OI    AOSW2,AOPROCNM      INDICATE POSITIONAL PROCNAME. Y02668 21272002
         OI    SWH,PROCSW          SET PROC INVOKED SWITCH.      Y02668 21274002
COR3A    DS    0H                                                Y02668 21276002
         SCSW  C,RPASWW            TURN OFF RT PAREN AST & PER DEL      21280000
         SCSW  S,LDLX              TURN ON LAST DEL SW.                 21300000
         SCSW  Z,JGCY,FB1                                               21320000
         SCSW  C,JGCY                                                   21340000
         L     R5,TKEYP                                                 21360000
         LA    R5,1(R5)                                                 21380000
         ST    R5,TNUMP                                                 21400000
         B     FB1                                                      21420000
COR4     NI    SRCHSW1,SRCHCLR-SRCHF8 SYMBOLIC BYPASS SWITCH OFF A32730 21426020
         B     FB1                RETURN TO TRT ROUTINE          A32730 21432020
         EJECT                                                          21440000
APR      DS    0H                  ENTRY TO APOST ROUTINE.              21460000
*        R5= TKEYP                                                 AACA 21480017
*        R6= TNUMP                                                 AACA 21500017
         CL    R1,CBSYP           ERROR.  INTERVENING TEXT BETWEEN AACA 21540017
         BNE   APR6                       LAST DELIM AND APOST.    AACA 21560017
         B     APROVRD            BRANCH TO OVERRIDE RTN.        A33221 21566020
APR0     DS    0H                                                A33221 21572020
         SPACE                                                          21580017
         LA    RF,APRTAB           ARRD OF TABLE                        21600017
         BAL   RE,XKRTN                                                 21620017
         CLI   0(RF),0             WAS KEY IN TABLE                AACA 21640017
         BNE   APR1                YES - OK                             21660017
         CLI   0(R5),DSNAMEK       DSN                             AACA 21680017
         BC    NOT-EQUAL,APR6      NO TRANSFER                          21740000
         L     R7,TEXTBUFP         ADDR OF TEXT STRING.          Y02668 21750002
         USING TEXT,R7             PREFIX ADDRESSABILITY.        Y02668 21752002
         OI    STRDINDC,DTXDSNLT   SET DSN LITERAL BIT.          Y02668 21754002
         DROP  R7                                                Y02668 21756002
APR1     DS    0H                  ENTRY                                21760000
         SCSW  S,FBLITRLZ         SET SW TO INDICATE LITERAL            21766000
         ST    R1,SAVEP           SAVE STRING PTR                       21772000
         LA    R1,1(R1)            BUMP CSTRP.                          21780000
         ST    R1,CBSYP            SAVE CHARACTER BEGIN POINTER         21800000
         LR    R4,R1               LOAD POINTER FOR CREATED SYMBOL.     21820000
         L     R7,CENDP            GET CHARACTER END POINTER.           21840000
         B     APR3                TRANSFER.                            21860000
APR2     DS    0H                  ENTRY.                               21880000
         LA    R4,1(R4)            BUMP POINTER                         21900000
         LA    R1,1(R1)            BUMP POINTER                         21920000
APR3     DS    0H                  ENTRY                                21940000
         CLR   R1,R7               IS CSTRP ABOVE COL 71.               21960000
         BC    HIGH+EQUAL,APR6     YES TRANSFER.                        21980000
         CLI   0(R1),C''''         IS CHARACTER APOST.                  22000000
         BC    EQUAL,APR5          YES TRANSFER.                        22020000
         CLI   0(R1),C'&&'        IS IT AMPERSAND                       22026000
         BC    EQUAL,APR7         YES TRANSFER                          22032000
APR4     DS    0H                  ENTRY                                22040000
         MVC   0(0,R4),0(R1)       MOVE A CHARACTER.                    22060000
         B     APR2                TRANSFER.                            22080000
APR5     DS    0H                  ENTRY.                               22100000
         LA    R1,1(R1)            BUMP POINTER                         22120000
         CLR   R1,R7               IS CSTRP ABOVE COL 71.               22140000
         BC    HIGH,APR6          YES TRANSFER                  378     22160000
         CLI   0(R1),C''''         IS CHARACTER APOST.                  22180000
         BC    EQUAL,APR4          YES GO BACK                          22200000
         ST    R1,CSTRP            SAVE CHARACTER STRING POINTER        22220000
         ST    R4,CESYP            SAVE END CHARACTER SYMBOL POINTER.   22240000
         SCSW  C,FBLITRLZ         CLEAR  SW                             22250000
         CLI   0(R1),C' '          IS CHARACTER BLANK.                  22260000
         BC    EQUAL,BKR1          YES TRANSFER.                        22280000
         CLI   0(R1),C','          IS CHARACTER COMMA.                  22300000
         BC    EQUAL,COR2          YES TRANSFER                         22320000
         SCSW  S,RPRSWW           SET RT. PAREN SW                 AAAA 22330015
         CLI   0(R1),C')'          IS CHAR RT PAREN                     22340000
         BC    EQUAL,RPR           YES - TRANSFER                       22360000
APR6     DS    0H                  ENTRY FOR ERROR                      22380000
         LA    R2,ERMES15          GET ERROR NUMBER                     22400000
         B     E1                  TRANSFER TO ERROR ROUTINE.           22420000
         SPACE                                                          22421000
APR7     DS    0H                                                       22422000
         LA    R1,1(R1)           BUMP PTR                              22423000
         CLR   R1,R7              IS CSTRP ABOVE COL 71                 22424000
         BC    HIGH,APR6          YES TRANSFER                          22425000
         CLI   0(R1),C'&&'        IS CHAR AMPERSAND                     22426000
         BC    EQUAL,APR4         YES GO BACK                           22427000
         BCTR  R1,R0                                                    22428000
         CLI   0(R5),PARMEEK      PARM KEYWORD ALLOWS            A39526 22428401
         BE    APR70              SYMBOLIC IN QUOTES             A39526 22428801
         CLI   0(R5),PARMPEK      NO OTHER KEYWORD DOES          A39526 22428901
         BE    APR70                                             A39526 22429401
         B     APR4               ALLOW SINGLE AMPERSAND IN TEXT  M0702 22430401
APR70    DS    0H                 PARM KEYWORD                   A39526 22439301
         CLI   INTBUF,0           IS TEXT IN INTBUF                     22441001
         BNE   APR4               GO BACK - NOT A SYMBOLIC PARAM        22442701
         L     R7,SAVEP           A SYMBOLIC - RESET PTR                22444401
         ST    R7,CBSYP                                                 22446101
         B     AMR                GO TO AMPERSAND RTN                   22447801
APR8     DS    0H                 ENTRY HERE MEANS THE                  22449501
*                                 LITERAL CONTAINS A SINGLE             22451201
*                                 AMPERSAND.  HOWEVER, SYMBOLIC         22452901
*                                 PARAMETERS ARE NOT ALLOWED            22454601
*                                 ON THIS STATEMENT - AS DETERMINED     22456301
*                                 BY THE SYMBOLIC PARAM RTN.            22458001
*                                                                       22459701
         L     R7,SAVEP           RESTORE CBSYP TO BEFORE        A33221 22461401
         LA    R7,1(R7)           TRANSFER TO AMR TTN.           A33221 22463101
         ST    R7,CBSYP           THE SINGLE AMPER. IS TREATED   A33221 22464801
         L     R7,CENDP           AS IF DOUBLE AMPER. HAD        A33221 22466501
         B     APR4               BEEN CODED.                    A33221 22468201
APROVRD  DS    0H                                                A33221 22469901
         TM    FLUSHSWW,FLUSHSW   IS THIS FIELD OVERRIDDEN       A33221 22471601
         BC    ZERO,APR0          NO - CONTINUE NORMAL PROCEDURE A33221 22473301
         L     R7,CENDP           COLUMN 72 POINTER              A33221 22475001
APROVRD1 LA    R1,1(R1)           INCREMENT STRING POINTER       A33221 22476701
         CLR   R1,R7              IS CSTRP BEYOND COL. 71        A33221 22478401
         BC    HIGH+EQUAL,APR6    YES - ERROR ROUTINE            A33221 22480101
         CLI   0(R1),C''''        CLOSING APOSTROPHE FOUND       A33221 22481801
         BC    NOT-EQUAL,APROVRD1 NO - CONTINUE SCAN             A33221 22483501
         CLI   1(R1),C''''        WAS IT SINGLE CLOSING APOS.    A33221 22485201
         BC    NOT-EQUAL,APROVRD2  YES - STORE POINTERS          A33221 22486901
         LA    R1,1(R1)           NO - INCREMENT POINTER         A33221 22488601
         B     APROVRD1           AND REENTER SCAN LOOP          A33221 22490301
APROVRD2 DS    0H                                                A33221 22492001
         ST    R1,CESYP           YES - STORE END POINTER        A33221 22493701
         LA    R1,1(R1)           INCREMENT STRING POINTER       A33221 22495401
         ST    R1,CSTRP           SAVE CHARACTER STRING POINTER  A33221 22497101
         B     FB4                RETURN TO TRT ROUTINE          A33221 22498801
         EJECT                                                          22500501
EQR      DS    0H                 ENTRY TO EQUAL ROUTINE                22502201
         OI    SWY2,KEYNXTSW       SET FIRST EQUAL RECEIVED. NO  A28668 22503901
*                                 MORE POSITIONAL PARAMETERS EXPECTED   22505601
         OI    AOSW1,AOFSTPOS     TURN OFF SWITCH FOR JOB CARD @ZA14268 22506103
*                                 SECOND POSITIONAL            @ZA14268 22506603
         NI    ENDKYSWP,255-ENDKYSW TURN OFF KEYWORD EXPECTED    A28668 22507301
         MVC   LASLE,CURLE        RESET LASLE, IN THE EVENT IT   A27943 22509001
*                                 HASN'T BEEN RESET IN THE TEXT  A27943 22510701
*   BUILD ROUTINE (T1) WHERE IT IS NORMALLY DONE. LASLE WILL NOT A27943 22512401
*   BE RESET IN T1 IN CASES WHERE THE SUBPARAMETER IMMEDIATELY   A27943 22514101
*   PRECEDING A RIGHT PAREN HAS BEEN OVERRIDDEN - E.G., THE DEN  A27943 22515801
*   SUBPARAMETER IN THE STRING DCB=(...,DEN=2). FAILURE TO RESET A27943 22517501
*   LASLE MAY CAUSE AN ERROR IN THE BUILDING OF SUBLIST TEXT FOR A27943 22519201
*   THE PARAMETERS WHICH FOLLOW.                                 A27943 22520901
*                                                                A27943 22522601
         SR    R4,R4              CLEAR REGISTER                        22524301
         IC    R4,DLMFBYTE    GET PREVIOUS DELIMITER FUNCTION BYTE.7821 22526001
         CR    R2,R4          IS THE CURRENT DELIMITER FUNCTION    7821 22527701
*                             BYTE(X'2C' IN R2) EQUAL TO THE       7821 22529401
*                             PREVIOUS DELIMITER FUNCTION BYTE(IN  7821 22531101
*                             R4).  I.E. DO WE HAVE THE 'KEYWORD=  7821 22532801
*                             KEYWORD=' SITUATION.                 7821 22534501
         BNE   EQR04          NO-BRANCH.                         A49940 22536201
         OI    DLMFBYTE,EQDELSW  YES-TURN THE EQDELSW SWITCH       7821 22537901
*                              ('KEYWORD=KEYWORD=' INDICATOR) ON.  7821 22539601
         B     EQR010         IT IS NOT NECESSARY TO STORE THE     7821 22541301
*                             CURRENT DELIMITER FUNCTION BYTE INTO 7821 22543001
*                             THE 'DLMFBYTE' SINCE THEY ARE        7821 22544701
*                             ALREADY EQUAL AT THIS POINT.         7821 22546401
         SPACE                                                          22548101
EQR04    EQU   *                                                 A49940 22548501
         CLI   DLMFBYTE,PR        IS PREVIOUS A PERIOD?          A49940 22548901
         BNE   EQR05              NO, CONTINUE.                  A49940 22549301
         TM    DDSWY,DDSW         IS THIS A DD STATEMENT?        A49940 22549701
         BNO   EQR05              NO, CONTINUE.                  A49940 22553001
         LA    R2,ERMES16         YES, LOAD MSG. NUMBER.         SM4180 22555001
         B     E1                 GO TO ERROR ROUTINE.           A49940 22555401
EQR05    DS    0H                                                  7821 22556901
         STC   R2,DLMFBYTE    STORE THE CURRENT DELIMITER FUNCTION 7821 22560201
*                             BYTE OVER THE PREVIOUS ONE.          7821 22563501
EQR010   DS    0H                                                  7821 22566801
         SR    R4,R4          CLEAR REGISTER.                      7821 22570101
         MVI   MSGSVE,ERMES16     ERROR NUMBER FOR POSSIBLE LATER USE   22573401
         SCSW  O,DDSWY,EQR3       TRANSFER DD                           22576701
         AH    R4,CURLE           IS CURRENT LEVEL ZERO                 22580000
         BC    NOT-EQUAL,EQRL5    TRANSFER CURRENT LEVEL NOT ZERO       22600000
         SCSW  O,EXECSWY,EQR1     TRANSFER EXEC SW ON                   22620000
         L     RF,AJ5L             ADDR OF JOB KEYWORDS            AADA 22640018
         B     EQRD               TRANSFER                              22660000
EQR1     DS    0H                 ENTRY                                 22680000
         CLI   0(R6),0            IS THIS FIRST OPERAND                 22700000
         BC    NOT-EQUAL,EQR11     BRANCH NO.                    Y02668 22720002
         CLI   0(R5),PROCEK        IS KEY PROC?                  Y02668 22730002
         BNE   EQR10               BRANCH NO.                    Y02668 22740002
         OI    SWH,PROCSW          SET PROC INVOKED SWITCH.      Y02668 22750002
EQR10    DS    0H                                                Y02668 22760002
         LA    RF,XKTAB            ADDR OF TABLE TO SEARCH.      Y02668 22770002
         BAL   RE,XKRTN            SEE IF KEY IS EXEC O'RIDE       AACA 22810017
         CLI   0(RF),0                                                  22840017
         BNE   EQR2                YES - GO PROCESS O'RIDE         AACA 22870017
EQR11    DS    0H                 ENTRY FOR EXEC PERIOD KEYS            22940000
         L     RF,AE4L             ADDR OF EXEC KEYWORDS           AADA 22960018
         B     EQRD               TRANSFER                              22980000
EQR2     DS    0H                 ENTRY                                 23000000
         SCSW  S,LPBYSWZ           SET LEFT PAREN BYPASS SW        AACA 23010017
         ST    R1,CSTRP           SAVE CHAR STRING POINTER              23020000
         ST    R1,CESYP           SAVE CHAR END SYMBOL POINTER          23040000
         BAL   R7,T1              ENTER TEXT                            23060000
         L     R5,TKEYP           GET TEXT KEY POINTER                  23080000
         CLI   0(R5),CONDPEK      LAST KEY COND PERIOD                  23100000
         BC    NOT-EQUAL,FB1      NO TRANSFER                           23120000
         SCSW  S,LDLX             TURN ON LAST DELIMITER SWITCH         23140000
         B     FB1                TRANSFER                              23160000
EQR3     DS    0H                 ENTRY                                 23180000
         SCSW  Z,OVKEYSWZ,EQR31   TRANSFER PREVIOUS KEY NOT O'RIDDEN    23200000
         CLI   OVKEYSVE,DCBK           WAS OVERRIDEN KEY DCB =    16368 23206016
         BNE   EQR304                                            A24421 23208019
         AH    R4,CURLE                                          A24421 23210019
         BC    HIGH,EQRB                                         A24421 23212019
         B     EQR301                                            A24421 23214019
EQR304   DS    0H                                                       23216019
         CLI   OVKEYSVE,UNITK     WAS PREVIOUS O'RIDDEN KEY UNIT=       23220000
         BC    NOT-EQUAL,EQR301   NO -CHECK ALL DD KEYS                 23240000
         L     R9,CSTRP                                                 23260000
         CLI   0(R9),C'='         YES -  IS UNIT AFF POSSIBLE           23280000
         BC    EQUAL,EQR30               YES - SEARCH UNIT MINOR KEYS   23300000
         AH    R4,CURLE                  NO  - IS UNIT SEP POSSIBLE     23320000
         BC    NOT-HIGH,EQR301                 NO - CHECK ALL KEYS      23340000
EQR30    DS    0H                 ENTRY TO SEARCH UNIT MINOR KEYS       23360000
         L     RF,AD4LUS           ADDR OF UNIT MINOR KEYWORDS     AADA 23380018
         B     EQRD                                                     23400000
EQR301   DS    0H                 ENTRY TO CHECK ALL DD KEYS            23420000
         L     RF,AD4L             ADDR OF DD MAJORS               AADA 23440018
         B     EQRD                                                     23460017
EQR31    DS    0H                 ENTRY - PREVIOUS KEY NOT O'RIDDEN     23480000
         AH    R4,CURLE           IS CURRENT LEVEL ZERO                 23500000
         BC    HIGH,EQR5          TRANSFER CURRENT LEVEL HIGH           23520000
         CLI   0(R6),0            IS TEXT LENGTH ZERO                   23540000
         BC    EQUAL,EQR4         YES TRANSFER                          23560000
         B     EQRC                                               16505 23600017
EQR4     DS    0H                 ENTRY FROM ABOVE                      23640000
         CLI   0(R5),UNITK        IS KEY UNIT                           23660000
         BC    NOT-EQUAL,EQR6     NO TRANSFER                     19200 23680019
         L     RF,AD4LUA           ADDR OF UNIT AFF KEYWORD        AADA 23700018
         B     EQRD               TRANSFER                              23720000
EQR5     DS    0H                 ENTRY CURRENT LEVEL HIGH              23740000
         CLI   0(R5),UNITK        IS KEY UNIT                           23760000
         BC    NOT-EQUAL,EQR50    NO TRANSFER                    Y01113 23780001
         L     RF,AD4LUS           ADDR OF UNIT MINOR KEYWORDS     AADA 23800018
         B     EQRD               TRANSFER                              23820000
EQR50    DS    0H                 ENTRY KEY NOT UNIT             Y01113 23822001
         CLI   0(R5),AMPK         IS KEY AMP?                    Y01113 23830001
         BE    EQRL5              ISSUE UNBALANCED PARENS MSG    Y01113 23832001
EQR6     DS    0H                 ENTRY KEY NOT UNIT                    23840000
         LA    RF,DCBTAB          ADDR. OF DCB MINOR TABLE        19200 23860019
         BAL   RE,XKRTN           TABLE SEARCH ROURINE            19200 23880019
         CLI   0(RF),0            IF ZERO  NOT IN DCB MINOR TABLE 19200 23900019
         BNE   EQRB               IN TABLE THEN TAKE BRANCH       19200 23920019
         CLI   0(R5),VOLUMEK      IS KEY VOLUME                         23960000
         BC    NOT-EQUAL,EQR8     NO TRANSFER                           23980000
         L     RF,AD4LV            ADDR OF VOL MINOR KEYWORDS      AADA 24000018
         B     EQRD               TRANSFER                              24020000
EQR8     DS    0H                 ENTRY KEY NOT VOLUME                  24040000
         CLI   0(R5),LABELK       IS KEY LABEL                          24060000
         BC    NOT-EQUAL,EQRA     NO TRANSFER                           24080000
         L     RF,AD6LL            ADDR OF LABEL MINOR KEYWORDS    AADA 24100018
         B     EQRD               TRANSFER                              24120000
EQRA     DS    0H                 ENTRY KEY NOT LABEL                   24140000
         CLI   0(R5),DCBK         IS KEY DCB                            24160000
         BC    NOT-EQUAL,EQRC     NO TRANSFER                           24180000
EQRB     DS    0H                 ENTRY                                 24200000
         L     RF,AD4LD            ADDR OF DCB MINOR KEYWORDS      AADA 24220018
         B     EQRD               TRANSFER                              24240000
EQRC     DS    0H                 ENTRY KEY NOT DCB                     24260000
         L     RF,AD4L             ADDR OF DD MAJOR KEYWORDS       AADA 24270018
         SR    R9,R9                                              20664 24282017
         AH    R9,CURLE                                           20664 24284017
         BZ    EQRD05                                             20664 24286017
         LA    R2,ERMES7                                          20664 24288017
         B     E1                                                 20664 24290017
EQRD05   DS    0H                                                 20664 24292017
EQRD     DS    0H                 ENTRY                                 24300000
         NI    SWV,255-FPRNSW-LPBYSW CLEAR LEFT PAREN SW AND       AACA 24306017
*                                           BYPASS SW              AACA 24312017
         ST    R1,CSTRP           SAVE CHAR STRING POINTER              24320000
         L     R9,CBSYP           GET CHAR END SYMBOL POINTER           24340000
         SR    R1,R9              COMPUTE CHAR LENGTH                   24360000
         SR    R4,R4              CLEAR REGISTER                        24380000
         B     EQRD3              TRANSFER                              24400000
EQRD1    DS    0H                 ENTRY                                 24420000
         CLC   1(0,RF),0(R9)       IS KEYWORD IN TABLE             AADA 24440018
EQRD2    DS    0H                                                       24460000
         AR    RF,R4               BUMP TO NEXT KEYWORD            AADA 24480018
EQRD3    DS    0H                                                       24500000
         IC    R4,0(RF)            GET KEYWORD LENGTH              AADA 24520018
         LTR   R4,R4              TABLE END                             24540000
         BC    ZERO,EQRL          YES TRANSFER                          24560000
         EX    R1,EQRD1           EXECUTE KEY WORD COMPARE              24580000
         BC    NOT-EQUAL,EQRD2    TRANSFER BACK NOT FOUND               24600000
         LR    R9,RF               SAVE RF IN R9                   AADA 24600318
         TM    DLMFBYTE,EQDELSW   DO WE HAVE 'KEYWORD=KEYWORD='    7821 24600717
*                                 CONDITION.                       7821 24601417
         BZ    EQRE      NO-CONTINUE NORMAL PROCESSING.            7821 24602117
         SPACE                                                          24602817
*       IF THE EQDELSW IS ON IT MEANS WE HAVE A 'KEYWORD=KEYWORD=' 7821 24603517
*   SITUATION IN THE JCL.  THE ONLY TIME THIS CONDITION IS PERMIS- 7821 24604217
*   SABLE IS WHEN EITHER VOL,DCB,UNIT, OR LABEL IS SPECIFIED.      7821 24604917
*   THESE KEYWORDS WILL BE CHECKED AND IF NONE ARE FOUND AN ERROR  7821 24605617
*   MESSAGE (IEF632I FORMAT ERROR) WILL BE ISSUED.                 7821 24606317
         SPACE                                                          24607017
         LA    RF,KEYEQTAB    ADDRESS OF TABLE CONTAINING THE KEYS 7821 24607717
*                             OF VOL,DCB,UNIT, AND LABEL.          7821 24608417
         L     R5,TKEYP       POINTER TO TEXT KEY(NOT OVERRIDDEN). 7821 24609117
         TM    OVKEYSWZ,OVKEYSW    HAS KEY BEEN OVERRIDDEN.        7821 24609817
         BZ    EQRD5               NO-BRANCH.                      7821 24610517
         LA    R5,OVKEYSVE         YES-GET ADDRESS OF OVERRIDDEN   7821 24611217
*                                  KEY.                            7821 24611917
EQRD5    DS    0H                                                  7821 24612617
         BAL   RE,XKRTN       ROUTINE TO SEARCH KEYS.              7821 24613317
         CLI   0(RF),0        WAS KEY FOUND.                       7821 24614017
         BE    EQRD6          NO-ERROR CONDITION.                  7821 24614717
         NI    DLMFBYTE,255-EQDELSW  TURN OFF EQDELSW SWITCH(HIGH  7821 24615417
*                                    ORDER BIT).                   7821 24616117
         B     EQRE           CONTINUE NORMAL PROCESSING.          7821 24616817
EQRD6    DS    0H                                                  7821 24617517
         LA    R2,ERMES19     GET ERROR MESSAGE NUMBER.            7821 24618217
         B     E1             ERROR PROCESSOR.                     7821 24618917
EQRE     DS    0H                 ENTRY FOUND                           24620000
         LR    RF,R9               RESTORE RF SAVED IN R9          AADA 24630018
         SCSW  C,OVKEYSWZ         CLEAR OVERRIDDEN KEY SW               24640000
         LA    R9,2(R1,RF)         GET POINTER TO KEY              AADA 24660018
         SR    R3,R3              CLEAR REGISTER                        24680000
         IC    R3,0(R9)           GET KEY                               24700000
         AR    RF,R4               BUMP POINTER TO NEXT KEYWORD    AADA 24720018
         LR    R7,R3              KEY FOR K1 ROUTINE                    24740000
         BAL   R6,I1              GET PTR TO BYTE IN DUPTB TO TEST BIT  24760000
         EX    R5,EQRE1           IS THE BIT ON IN DUPTB                24780000
         BC    O,EQRJ             YES TRANSFER TO CHECK FOR OVERRIDE    24800000
         ST    R9,SAVEP           SAVE PTR TO KEY                       24820000
         LA    R3,KEYTAB-DUPTAB(R3)  BUMP TO KEYTAB               19874 24840019
         EX    R5,EQRF1           SET BIT IN KEYTAB                     24860000
         ST    RF,WORK1           SAVE VALUE OF RF               A26796 24870019
         BAL   R9,K1              PUT KEY IN TEXT                       24880000
         L     RF,WORK1           RESTORE VALUE OF RF            A26796 24890019
         L     R9,SAVEP           RESTORE PTR TO KEY                    24900000
EQRF     DS    0H                                                       24920000
         L     R3,TEXTBUFP        ADDR OF TEXT STRING.         @G29AN2E 24922003
         USING TEXT,R3            PREFIX ADDRESSABILITY.       @G29AN2E 24922803
         CLI   0(R9),DDNAMEK      IS THIS DDNAME KEYWORD           AABA 24923603
         BNE   EQRF03             BR NO                        @G29AN2E 24924403
         OC    DUPTAB(EDASTAB1-DASTAB1),DASTAB1  SET ALL BITS  @ZA13371 24926003
*                                 FOR KEYS MUTUALLY EXCLUSIVE  @ZA13371 24927003
*                                 WITH DDNAME WHILE PRESERVING @ZA13371 24928003
*                                 OVERRIDING DCB VALUES.       @ZA13371 24929003
         OI    STRDINDC,DTXDDNM    SET DDNAME SWITCH.            Y02668 24932003
***************************************************************@G32HPPJ 24932103
*                                                              @G32HPPJ 24932203
*  IN AN SU ENVIRONMENT IT IS NECESSARY TO CHECK TO SEE IF THE @G32HPPJ 24932303
*  SU BIT IS ON WHEN A KEYWORD WHICH IS NEW FOR AN SU IS FOUND @G32HPPJ 24932403
*  IF THE SU BIT IS NOT ON FOR THE PARTICULAR KEYWORD, THEN THE@G32HPPJ 24932503
*  KEYWORD SHOULD BE TREATED AS AN INVALID                     @G32HPPJ 24932603
*                                                              @G32HPPJ 24932703
***************************************************************@G32HPPJ 24932803
EQRF03   DS    0H                                              @G32HPPJ 24932903
         L     RE,16              GET ADDRESS OF CVT           @G32HPPJ 24933003
         USING CVTMAP,RE          ESTABLISH ADDR. TO CVT       @G32HPPJ 24933103
         L     R2,CVTIHASU        GET ADDR INSTALLED SU BITS   @G32HPPJ 24933203
         USING SUBITS,R2          SU BIT MAPPING               @G32HPPJ 24933303
         CLI   0(R9),SUBSYSK      IS THIS SUBSYS KEY    ?      @G32HPPJ 24933403
         BNE   EQRF040            NO CHECK NEXT                @G32HPPJ 24933503
         TM    SUBYTE4,SU29BIT    YES,IS SU29 INSTALLED ?      @G32HPPJ 24933603
         BO    EQRF055            YES PROCESS SUBSYS           @G32HPPJ 24933703
EQRF035  DS    0H                                              @G32HPPJ 24933803
         MVI   MSGKEY,DDK         NO, INDICATE DD STMT         @G32HPPJ 24933903
         LA    R2,ERMES16         ISSUE UNIDENTIFIED KEYWORD   @G32HPPJ 24934003
         B     E1                                              @G32HPPJ 24934103
EQRF040  DS    0H                                              @G32HPPJ 24934203
         CLI   0(R9),PROTECTK     IS THIS PROTECT KEY?         @G32HPPJ 24934303
         BE    EQRF045            NO CONTINUE                  @G32HPPJ 24934403
         CLI   0(R9),CHARSK       IS THIS CHARS KEY?           @G16APPJ 24934503
         BE    EQRF050            CHECK FOR SU10               @G16APPJ 24934603
         CLI   0(R9),BURSTK       IS THIS BURST KEY            @G16APPJ 24934703
         BE    EQRF050            CHECK FOR SU10               @G16APPJ 24934803
         CLI   0(R9),MODIFYK      IS THIS MODIFY KEY?          @G16APPJ 24934903
         BE    EQRF050            CHECK FOR SU10               @G16APPJ 24935003
         CLI   0(R9),FLASHK       IS THIS FLASH KEY ?          @G16APPJ 24935103
         BE    EQRF050            CHECK FOR SU10               @G16APPJ 24935203
         B     EQRF04             CONTINUE PROCESSING          @G16APPJ 24935303
EQRF045  TM    SUBYTE5,SU32BIT    YES, IS SU32 INSTALLED?      @G16APPJ 24935403
         BNO   EQRF035            NO, ISSUE ERROR MESSAGE      @G32HPPJ 24935503
         B     EQRF04             YES, CONTINUE PROCESSING     @G32HPPJ 24935603
EQRF050  DS    0H                                              @G16APPJ 24935703
         TM    SUBYTE2,SU10BIT    IS SU10 INSTALLED  ?         @G16APPJ 24935803
         BNO   EQRF035            NO ISSUE ERROR MSG           @G16APPJ 24935903
         B     EQRF04             YES CONTINUE PROCESSING      @G16APPJ 24936003
EQRF055  DS    0H                 PROCESSING FOR SUBSYS KEY    @G32HPPJ 24936103
         MVC   AOSUBSYS,TKEYP     SAVE ADDR OF SUBSYS KEY      @G32HPPJ 24936203
         OI    STRDINDC,DTXSUBSK  SET SUBSYS KEY SWITCH        @G32HPPJ 24936303
         DROP  RE                                              @G32HPPJ 24936403
         DROP  R2                                              @G32HPPJ 24936503
         DROP  R3                                              @G29AN2E 24936603
EQRF04   DS    0H                                                  AABA 24936703
         SR    R3,R3              CLEAR REGISTER                        24940000
         IC    R3,0(R9)           GET KEY                               24960000
         BAL   R6,I1              GET PTR TO BYTE IN DUPTB TO SET BIT   24980000
         EX    R5,EQRF1           SET BIT ON IN DUPTB                   25000000
         LA    R9,1(R9)           BUMP TO NEXT KEY                      25020000
         TM    SWZ,DDSW            IS THIS A DD CARD?             19874 25026019
         BC    ZERO,EQRF5          NO,BYPASS OVERRIDE TEST        19874 25032019
         TM    0(R9),X'80'        IS IT OVERRIDDEN KEY                  25040000
         BC    O,EQRG             YES TRANSFER                          25060000
EQRF5    DS    0H                                                 19874 25070019
         CLR   R9,RF               END OF SCAN DICT ENTRY          AADA 25080018
         BC    LOW,EQRF04         NO  CONTINUE PROCESSING          AABA 25100016
EQRG     DS    0H                 ENTRY FOR OVERRIDDEN KEY              25120000
         SCSW  C,FLUSHSWW         CLEAR FLUSHSW                         25140000
         L     R5,TKEYP           GET POINTER TO KEY                    25160000
         CLI   0(R5),CONDEEK      IS KEY COND EQUAL                     25180000
         BC    EQUAL,EQRG1        YES TRANSFER                          25200000
         CLI   0(R5),CONDJK       IS KEY JOB COND                       25220000
         BC    NOT-EQUAL,EQRH     NO TRANSFER                           25240000
EQRG1    DS    0H                                                       25260000
         SCSW  S,LDLX             TURN ON LAST DELIMITER SW             25280000
         B     FB1                TRANSFER                              25300000
EQRE1    DS    0H                                                       25320000
         TM    0(R3),0            TEST FOR BIT IN DUPTB                 25340000
EQRF1    DS    0H                                                       25360000
         OI    0(R3),0            TURN ON BIT IN DUPTB                  25380000
EQRH     DS    0H                                                       25400000
         SCSW  C,LDLX             CLEAR LAST DELIMITER SW               25420000
         CLI   0(R5),DSNAMEK      IS KEY DSNAME                         25440000
         BC    EQUAL,EQRI         YES TRANSFER                          25460000
         CLI   0(R5),REFMK        IS KEY REF                            25480000
         BC    EQUAL,EQRI         YES TRANSFER                          25500000
         CLI   0(R5),PGMEK        IS KEY PGM EQUAL                      25520000
         BC    NOT-EQUAL,EQRH1     BRANCH NO.                    Y02668 25540002
         NI    SWC,255-PEXP        CLEAR PROC EXEC EXPECTED SW.  Y02668 25540302
         TM    AOSW2,AOPROCNM      POSITIONAL PROCNAME SPECIFIED?Y02668 25540702
         BZ    EQRI                BRANCH NO.                    Y02668 25541402
* ERROR - BOTH A POSITIONAL PROCNAME AND PGM= SPECIFIED.         Y02668 25542102
         LA    R2,ERMSG632         'FORMAT ERROR' MSG CODE.      Y02668 25542802
         B     E1                  BR TO ERROR ROUTINE.          Y02668 25544202
EQRH1    DS    0H                                                Y02668 25544902
         CLI   0(R5),RESTARJK      IS IT RESTART                   AAAA 25546015
         BE    EQRI0              YES - TRANSFER                   AAAA 25552015
         CLI   0(R5),DCBK         IS KEY DCB                            25560000
         BC    NOT-EQUAL,EQRI01   NO TRANSFER                           25580000
         SCSW  S,DCBSWW           TURN ON DCB SWITCH                    25600000
EQRI     DS    0H                                                       25620000
         SCSW  S,LDLX             SET LAST DELIMITER SW            AAAA 25626015
EQRI0    DS    0H                                                  AAAA 25632015
         SCSW  S,PDELSWW          TURN ON PERIOD DELIMITER SWITCH       25640000
         B     FB1                TRANSFER                              25680000
EQRI01   DS    0H                                                       25700000
         L     RF,TEXTBUFP         ADDR OF TEXT STRING.          Y02668 25706002
         USING TEXT,RF             PREFIX ADDRESSABILITY.        Y02668 25712002
         CLI   0(R5),SYSOUTK      IS KEY SYSOUT                         25720000
         BC    NOT-EQUAL,EQRI02   NO TRANSFER                           25740000
         L     R1,CSTRP           RESTORE CHAR STRING PTR.       A39022 25742001
         CLI   1(R1),COMMA        IS SYSOUT BEING NULLIFIED      A39022 25750001
         BC    EQUAL,EQRI02       YES-TRANSFER DO NOT SET SWITCH A39022 25752001
         CLI   1(R1),BLANK        IS SYSOUT BEING NULLIFIED      A39022 25754001
         BC    EQUAL,EQRI02       YES-TRANSFER DO NOT SET SWITCH A39022 25756001
         OI    STRDINDC,DTXSYOUT   SET SYSPUT SWITCH.            Y02668 25792002
         B     FB1                TRANSFER                              25800000
EQRI02   DS    0H                                                       25820000
         SPACE                                                          25822001
* IF DLM APPEARS ON A DD STM. OTHER THAN DD * OR DD DATA,         21009 25830001
* MUTUAL EXCLUSIVE ERROR MESSAGE IS GIVEN                         21009 25840001
         SPACE                                                          25840401
         CLI   0(R5),DLMK          IS THIS A DLM KEY?             21009 25842001
         BC    NOT-EQUAL,EQRI04    NO, NORMAL PROCESSING          21009 25844001
         OI    SWA,DLM             DLM FOUND THIS CARD ?        YM03459 25845002
         LR    R9,R5               STORE KEY FOR MESSAGE          21009 25846001
         TM    STRDINDC,DTXSYSIN   THIS A DD */DATA STMT?        Y02668 25848002
         BC    Z,EQRL1             NO, MUTUAL EXCLUSIVE ERROR  @ZA01931 25848403
         DROP  RF                                                Y02668 25848602
EQRI04   DS    0H                                                 21009 25848801
          SPACE                                                         25850017
         LA    RF,XKTAB                                                 25880017
         BAL   RE,XKRTN            CHECK IF EXEC O'RIDE                 25910017
         CLI   0(RF),0             KEY IN TABLE                         25940017
         BE    FB1                 NO - NOT EXEC O'RIDE                 25970017
EQRI03   DS    0H                                                       26040000
         SR    R3,R3              CLEAR REGISTER                        26060000
         IC    R3,0(R5)           GET KEY                               26080000
         BAL   R6,I1              GET PTR TO BYTE IN DUPTB              26100000
         LCR   R5,R5              EXPRESS AS TWO'S COMPLEMENT           26120000
         BCTR  R5,R0              DECREMENT REGISTER                    26140000
         EX    R5,D3              TURN OFF BITS IN DUPTB                26160000
         B     FB1                TRANSFER                              26180000
D3       NI    0(R3),0                                            16368 26190016
EQRJ     DS    0H                                                       26200000
         SCSW  Z,DDOVZ,EQRL1      TRANSFER OVERRIDE SW OFF - ERROR      26220000
         SCSW  S,FLUSHSWW         SET FLUSH SWITCH                      26240000
         SCSW  S,OVKEYSWZ         SET OVERRIDDEN KEY SW                 26260000
         STC   R7,OVKEYSVE        SAVE OVERRIDDEN KEY                   26280000
EQRK     DS    0H                                                       26300000
         SR    R3,R3              CLEAR REGISTER                        26320000
         IC    R3,0(R9)           GET THE KEY                           26340000
         TM    SWZ,DDSW                IS THIS A DD CARD          19874 26346019
         BC    ZERO,EQRK1          NO, LEAVE HIGH ORDER BIT SET   19874 26352019
         LA    R4,X'7F'           LOAD MASK FOR AND                     26360000
         NR    R3,R4              AND OUT HIGH ORDER BIT                26380000
EQRK1    EQU   *                                                  19874 26390019
         BAL   R6,I1              GET PTR TO BYTE IN DUPTB              26400000
         EX    R5,EQRF1           TURN ON BIT IN DUPTB                  26420000
         LA    R9,1(R9)           BUMP TO NEXT KEY                      26440000
         CLR   R9,RF               END OF SCAN DICT ENTRY          AADA 26460018
         BC    LOW,EQRK           NO CONTINUE PROCESSING                26480000
         B     FB1                TRANSFER                              26500000
EQRL     DS    0H                                                       26520000
         SCSW  Z,EXECSWY,EQRLA1   TRANSFER NOT EXEC VERB                26522000
         L     R1,CSTRP           POINTER FOR SYMBOLIC PARAM RTN        26524000
         L     RF,FIEFVFB         GET SYMBOLIC PARAMETER RTN            26526000
         BALR  RE,RF                                                    26528000
         B     FB1                RETURN TO STATEMENT SCAN              26530000
EQRLA1   DS    0H                                                       26532000
         SCSW  O,OVKEYSWZ,EQRLB   TRANSFER LAST KEY OVERRIDDEN          26540000
EQRLA    DS    0H                                                       26560000
         SR    R2,R2                                                    26580000
         IC    R2,MSGSVE          ERROR MSG NUMBER                      26600000
         B     E1                                                       26620000
EQRLB    DS    0H                                                       26640000
         L     R5,AD6LL           PTR TO LAST OF DD KEYS                26660000
         CLR   RF,R5               IS THIS THE END                 AADA 26680018
         BC    HIGH,EQRLA         YES  - ISSUE ERROR MSG                26700000
         LA    RF,1(RF)            NO-  BUMP PTR                   AADA 26720018
         B     EQRD3              CONTINUE SEARCH                       26740000
EQRL1    DS    0H                 ENTRY FOR MUTUALLY EXCLUSIVE ERROR    26760000
         MVC   MSGKEY(1),0(R9)    KEY FOR SECONDARY MESSAGE             26780000
         LA    R2,ERMES2          ERROR MESSAGE NUMBER                  26800000
         L     RF,IEFVGMV                                               26820000
         BALR  RE,RF              ISSUE MSG                             26840000
EQRL2    DS    0H                 ENTRY FOR SECOND HALF OF MESSAGE      26860000
         L     R5,TBEGP            GET VERB KEY FOR THIS STMT    Y02668 26900002
         MVC   MSGKEY(1),0(R5)     FOR ENTRY IN SECONDARY MSG.   Y02668 26920002
         SCSW  Z,VERBCSWZ,EQRL3    TRANSFER NOT PROC VERB          AABA 26940016
         MVI   MSGKEY,PSECMSG      GET PROC SECONDARY MSG          AABA 26980016
EQRL3    DS    0H                                                       27020016
         MVI   INTBUF,0                                            AABA 27060016
         LA    R2,ERMES2B                                          AABA 27100016
         B     E1                  GO TO ERROR RTN                      27140016
EQRL5    DS    0H                 ENTRY FOR INVALID SUBPARAM            27220000
         LA    R2,X'29'                                                 27240000
         B     E1                                                       27260000
         EJECT                                                          27260317
*                                                                  AACA 27260617
*     THIS RTN CHECKS IF THE PARAMS FOR THE KEYWORD ARE BEING      AACA 27260917
*        FLUSHED (IGNORED) DUE TO A DD O'RIDE                      AACA 27261217
ORRTN    DS    0H                                                       27261517
         SPACE                                                          27261817
         SCSW  O,FLUSHSWW,FB3      RET TO TRANS RTN IF O'RIDE      AACA 27262117
         BR    RE                  RET IF NO O'RIDE                AACA 27262417
         SPACE                                                          27262717
*                                                                  AACA 27263017
XKRTN    DS    0H                                                       27263317
*                                                                  AACA 27263617
*   THIS RTN SEARCHES A TABLE OF ONE BYTE KEYS                     AACA 27263917
*                                                                       27264217
*       INPUT- R5  PTR TO SEARCH ARGUMENT                          AACA 27264517
*              R14 RET REG                                         AACA 27264817
*              R15 PTR TO LAST TABLE ENTRY                         AACA 27265117
*                                                                       27265417
*              OUTPUT- R5  UNCHANGED                               AACA 27265717
*                      R14 UNCHANGED                               AACA 27266017
*                      R15 PTR TO FOUND ENTRY OR ZERO ENTRY        AACA 27266317
*                                                                       27266617
*                                                                       27266917
XKRTN01  DS    0H                                                       27267217
         CLI   0(RF),0             IS ENTRY 0                           27267517
         BE    XKRTN05             KEY NOT FOUND                        27267817
         CLC   0(1,RF),0(R5)       COMP TO SEARCH ARG                   27268117
         BE    XKRTN05             FOUND - RETURN                  AACA 27268417
         BCT   RF,XKRTN01          CHECK NEXT                           27268717
XKRTN05  DS    0H                                                       27269017
         BR    RE                  RETURN                               27269317
* TABLE OF O'RIDE KEYS                                                  27269617
         DC    AL1(0)                                                   27269917
         DC    AL1(ACCTPEK)                                             27270217
         DC    AL1(PRFMPEK)                                      Y02655 27270302
         DC    AL1(CONDPEK)                                             27270517
         DC    AL1(DYNMPEK)                                      Y02670 27270602
         DC    AL1(PARMPEK)                                             27270817
         DC    AL1(TIMEPEK)                                             27271117
         DC    AL1(ROLLPEK)                                             27271417
         DC    AL1(ADRSPPEK)                                            27271501
         DC    AL1(RDPEK)                                               27271717
         DC    AL1(SDPPEK)                                         I241 27271818
XKTAB    DC    AL1(REGINPEK)                                            27272017
         SPACE                                                          27272317
* TABLE OF KEYS WHERE PARAMS MAY BE IN QUOTES                           27272617
         DC    AL1(0)                                                   27272917
         DC    AL1(SUBSYSK)                                    @G29AN2E 27273003
         DC    AL1(DLMK)                                          21009 27273103
         DC    AL1(JOBK)                                                27273403
         DC    AL1(ACCTEEK)                                             27273517
         DC    AL1(PARMEEK)                                             27273817
         DC    AL1(ACCTPEK)                                             27274117
         DC    AL1(AMPK)                                         Y01113 27274201
         DC    AL1(PARMPEK)                                             27274417
         DC    AL1(SERMK)                                               27274717
APRTAB   DC    AL1(RESTARJK)                                            27275017
*                                                                  AACA 27275317
* TABLE OF KEYS WHERE HYPHEN IS OK                                 AACA 27275617
         DC    AL1(0)                                                   27275917
         DC    AL1(DSIDK)                                      @Y30OPSB 27276003
         DC    AL1(SERMK)                                               27276217
         DC    AL1(JOBK)                                                27276517
         DC    AL1(ACCTEEK)                                             27276817
         DC    AL1(ACCTPEK)                                             27277117
MIRTAB   DC    AL1(DSNAMEK)                                             27277417
*                                                                  7821 27277717
* TABLE OF KEYS WHERE 'KEYWORD=KEYWORD=' IS ALLOWABLE.             7821 27278017
         DC    AL1(0)                                              7821 27278317
         DC    AL1(DCBK)                                           7821 27278617
         DC    AL1(VOLUMEK)                                        7821 27278917
         DC    AL1(UNITK)                                          7821 27279217
KEYEQTAB DC    AL1(LABELK)                                         7821 27279517
         EJECT                                                          27280000
*          **********************************************************   27300000
*    TABLE OF CHARTERS APPEARING AFTER RIGHT PAREN.               22520 27301018
         DC    AL1(0)                                             22520 27302018
         DC    AL1(COMMA)                                         22520 27303018
         DC    AL1(BLANK)                                         22520 27304018
         DC    AL1(AMPERSAN)                                      22520 27305018
RPRTAB   DC    AL1(RPARENT)                                       22520 27306018
COMMA    EQU   C','                                               22520 27307018
BLANK    EQU   C' '                                               22520 27308018
AMPERSAN EQU   C'&&'                                              22520 27309018
RPARENT  EQU   C')'                                               22520 27310018
*          **********************************************************   27311018
*          *                                                        *   27320000
*          *   ROUTINE TO SELECT BITS IN DUPLICATE TABLE.           *   27340000
*          *                                                        *   27360000
*          **********************************************************   27380000
AOKEYBIT DS    0H                                                Y02668 27400002
         LA    R2,KEYTAB           TEST THE BITS IN KEYTAB       Y02668 27403002
         B     AOKSI5                                            Y02668 27406002
I1       DS    0H                                                Y02668 27409002
         LA    R2,DUPTAB           TEST THE BITS IN DUPTAB       Y02668 27412002
AOKSI5   DS    0H                                                Y02668 27415002
         LA    R4,X'07'                                                 27420000
         NR    R4,R3                                                    27440000
         LA    R5,X'80'                                                 27460000
         SRL   R5,0(R4)                                                 27480000
         SRL   R3,3                                                     27500000
         LA    R3,0(R2,R3)         BIT @ IN REQUESTED TABLE      Y02668 27520002
         BR    R6                                                       27540000
         EJECT                                                          27540519
*        *********************************************************19200 27541019
*                                                                 19200 27541519
* TABLE OF DCB MINOR KEYWORDS                                     19200 27542019
         DC    AL1(0)                                             19200 27542519
         DC    AL1(BFALNMK)                                       19200 27543019
         DC    AL1(BFTEKMK)                                       19200 27543519
         DC    AL1(BLKSIZMK)                                      19200 27544019
         DC    AL1(BUFLMK)                                        19200 27544519
         DC    AL1(BUFNOMK)                                       19200 27545019
         DC    AL1(BUFRQMK)                                       19200 27545519
         DC    AL1(CODEMK)                                        19200 27546019
         DC    AL1(CPRIMK)                                        19200 27546519
         DC    AL1(CYLOFLMK)                                      19200 27547019
         DC    AL1(HIARCHMK)                                      19200 27547519
         DC    AL1(DENMK)                                         19200 27548019
         DC    AL1(DIAGNSK)                                       21042 27548401
         DC    AL1(DSORGMK)                                       19200 27548519
         DC    AL1(EROPTMK)                                       19200 27549019
         DC    AL1(FRIDMK)                                       Y02668 27549202
         DC    AL1(INTVLMK)                                       19200 27549519
         DC    AL1(KEYLENMK)                                      19200 27550019
         DC    AL1(LIMCTMK)                                       19200 27550519
         DC    AL1(LRECLMK)                                       19200 27551019
         DC    AL1(MODEMK)                                        19200 27551519
         DC    AL1(NCPMK)                                         19200 27552019
         DC    AL1(NTMMK)                                         19200 27552519
         DC    AL1(OPTCDMK)                                       19200 27553019
         DC    AL1(PRTSPMK)                                       19200 27553519
         DC    AL1(RECFMMK)                                       19200 27554019
         DC    AL1(RKPMK)                                         19200 27554519
         DC    AL1(SOWAMK)                                        19200 27555019
         DC    AL1(STACKMK)                                       19200 27555519
         DC    AL1(TRTCHMK)                                       19200 27556019
         DC    AL1(GNCPMK)                                        19200 27556519
         DC    AL1(GDSORGMK)                                      19200 27557019
         DC    AL1(BUFOFFMK)                                      19200 27557120
         DC    AL1(BUFINMK)                                       20002 27557220
         DC    AL1(BUFOUTMK)                                      20002 27557320
         DC    AL1(BUFMAXMK)                                      20002 27557420
         DC    AL1(BUFSIZMK)                                      20002 27557520
         DC    AL1(PCIMK)                                         20002 27557620
         DC    AL1(RESERVMK)                                      20002 27557720
         DC    AL1(THRESHMK)                                      20002 27557920
         DC    AL1(IPLTXIDK)                                     Y01948 27567901
DCBTAB   DS    0C                  END OF DCB MINOR KEYS                27607901
         DC    AL1(FUNCMK)                                        21088 27617901
*        *********************************************************19200 27657901
AOPCSVBL DC    CL8' '                                            Y02668 27677902
         EJECT                                                          27707902
*          ******************************************************Y02668 27708702
*          *                                                    *Y02668 27709502
*          * AOKSRCHR - TEXT KEY SEARCH ROUTINE.                *Y02668 27710302
*          *                                                    *Y02668 27711102
*          * AOKSRCHR SEARCHES A TEXT STRING TO FIND A KEY      *Y02668 27711902
*          * PROVIDED AS A SEARCH ARGUMENT BY ITS CALLER. IT    *Y02668 27712702
*          * CHECKS FOR A MATCH ON THE BASE KEY. IF THERE IS NO *Y02668 27713502
*          * MATCH, IT PASSES THE ADDRESS OF THE KEY TO ROUTINE *Y02668 27714302
*          * AOKSR1, WHICH THEN COMPUTES THE ADDRESS OF THE     *Y02668 27715102
*          * NEXT KEY IN TEXT.                                  *Y02668 27715902
*          *                                                    *Y02668 27716702
*          * ON RETURN FROM AOKSR1, AOKSRCHR PERFORMS THE       *Y02668 27717502
*          * FOLLOWING LOGIC:                                   *Y02668 27718302
*          *                                                    *Y02668 27719102
*          * .CHECKS IF THE NEXT KEY IS A TEXT ENDING KEY (ENDK,*Y02668 27719902
*          *  JENDK) OR A KEYWORD KEY.                          *Y02668 27720702
*          * .IF A TEXT ENDING KEY, SETS R9 TO ZERO AND RETURNS *Y02668 27721502
*          *  TO CALLER.                                        *Y02668 27722302
*          * .IF A KEYWORD KEY, CHECKS IF KEY MATCHES THE       *Y02668 27723102
*          *  SEARCH KEY.                                       *Y02668 27723902
*          * .IF KEYS MATCH, RETURNS TO CALLER WITH ADDRESS OF  *Y02668 27724702
*          *  KEY IN R9.                                        *Y02668 27725502
*          * .IF KEYS DO NOT MATCH, BRANCHES TO AOKSR1 TO OBTAIN*Y02668 27726302
*          *  ADDRESS OF NEXT KEY IN TEXT, AND PERFORMS THE     *Y02668 27727102
*          *  ABOVE LOGIC AGAIN.                                *Y02668 27727902
*          *                                                    *Y02668 27728702
*          * INPUT -                                            *Y02668 27729502
*          * .R9 - ADDRESS OF TEXT STRING TO BE SEARCHED.       *Y02668 27730302
*          * .AOSCHKEY - KEY WHICH IS TO BE LOCATED IN THE      *Y02668 27731102
*          *  TEXT STRING.                                      *Y02668 27731902
*          *                                                    *Y02668 27732702
*          * OUTPUT -                                           *Y02668 27733502
*          *                                                    *Y02668 27734302
*          * .R9 - ADDRESS OF KEY, IF FOUND. ZERO IF KEY NOT    *Y02668 27735102
*          *  FOUND.                                            *Y02668 27735902
*          *                                                    *Y02668 27736702
*          * NOTES -                                            *Y02668 27737502
*          * .AOKSRCHR USES SUBROUTINE AOKSR1 FOR SKIPPING FROM *Y02668 27738302
*          *  KEY TO KEY IN TEXT.                               *Y02668 27739102
*          *                                                    *Y02668 27739902
*          ******************************************************Y02668 27740702
         SPACE 2                                                 Y02668 27741502
AOKSRCHR DS    0H                                                Y02668 27742302
         STM   RE,R5,AOKSCHSA      SAVE CALLER'S REGS.          YM01546 27743102
         L     R9,TEXTBUFP         POINT TO PREFIX FOR SEARCH.  YM01546 27743502
         USING TEXT,R9             SET TEXT STRNG ADDRESSABILITY.Y02668 27743902
         TM    STRINDCS,JOBSTR     JOB STRING?                   Y02668 27744702
         BZ    AOKS03              BRANCH NO.                    Y02668 27745502
         LA    R9,STRJPFXL(R9)     POINT TO JOB BASE KEY.        Y02668 27746302
         B     AOKS010             BRANCH TO SEARCH.             Y02668 27747102
AOKS03   DS    0H                                                Y02668 27747902
         TM    STRINDCS,EXECSTR+PROCSTR EXEC OR PROC STRING?     Y02668 27748702
         BZ    AOKS06              BRANCH IF NEITHER.            Y02668 27749502
         LA    R9,STREPFXL(R9)     POINT TO BASE KEY - PREFIX    Y02668*27750302
                                   IS SAME LENGTH FOR BOTH.      Y02668 27751102
         B     AOKS010             BRANCH TO SEARCH.             Y02668 27751902
* ONLY DD STRING LEFT.                                           Y02668 27752702
AOKS06   DS    0H                                                Y02668 27753502
         LA    R9,STRDPFXL(R9)     POINT TO BASE DD KEY.         Y02668 27754302
* SEARCH KEY IS IN AOSCHKYS. MAY BE KEYWORD OR STRING END KEYS.  Y02668 27755102
AOKS010  DS    0H                                                Y02668 27755902
         LA    RF,AOSCHKYS         ADDRESS OF SEARCH LIST.       Y02668 27756702
AOKS020  DS    0H                                                Y02668 27757502
         CLI   0(RF),ENDLISTI      END OF SEARCH LIST?           Y02668 27758302
         BE    AOKS030             BR YES, GET NEXT KEY IN TEXT. Y02668 27759102
* MORE SEARCH LIST ENTRIES TO GO.                                Y02668 27759902
         CLC   0(1,RF),0(R9)       ENTRY MATCH CURRENT KEY?      Y02668 27760702
         BE    AOKS060             BRANCH YES, KEY FOUND.        Y02668 27761502
         LA    RF,1(RF)            STEP TO NEXT LIST ENTRY.      Y02668 27762302
         B     AOKS020             BR TO COMPARE NEXT ENTRY.     Y02668 27763102
* CURRENT KEY IN TEXT DOES NOT MATCH ANY ENTRIES IN SEARCH KIST. Y02668 27763902
AOKS030  DS    0H                                                Y02668 27764702
         CLI   0(R9),ENDK          CURRENT KEY 'END OF STRING'?  Y02668 27765502
         BE    AOKS080             BRANCH YES.                   Y02668 27766302
* CURRENT KEY IS NOT A TEXT ENDING KEY. MORE KEYS TO GO.         Y02668 27768702
         BAL   RE,AOKSR1           SKIP TO NEXT KEY IN TEXT.     Y02668 27769502
         B     AOKS010             COMPARE NEXT KEY TO LIST.     Y02668 27770302
* MATCH FOUND TO SEARCH LIST ENTRY.                              Y02668 27771102
* RF POINTS TO MATCHING LIST ENTRY, R9 TO MATCHING KEY IN TEXT.  Y02668 27771902
* THE MATCHING ENTRY IS MOVED TO THE TOP OF THE LIST.            Y02668 27772702
AOKS060  DS    0H                                                Y02668 27773502
         LA    RE,AOSCHKYS         GET ADDR OF 1ST LIST ENTRY.   Y02668 27774302
         CR    RF,RE               MATCHING ENTRY ALREADY FIRST? Y02668 27775102
         BE    AOKS090             BRANCH YES.                   Y02668 27775902
* MATCHING ENTRY NOT THE FIRST ENTRY.                            Y02668 27776702
* ENTRIES ABOVE ARE MOVED DOWN OVER THE MATCHING ENTRY, AND      Y02668 27777502
* THE MATCHING ENTRY IS PLACED IN THE FIRST SLOT.                Y02668 27778302
         IC    R0,0(RF)            LOAD  MATCHING ENTRY.         Y02668 27779102
         LR    R1,RF               COPY ADDR OF MATCHING ENTRY.  Y02668 27779902
         SR    R1,RE               GET DISPLACEMENT OF ENTRY.    Y02668 27780702
         BCTR  RF,0                POINT TO 1ST ENTRY ABOVE      Y02668*27781502
                                   MATCHING ENTRY.               Y02668 27782302
         EX    R1,AOKS100          MOVE LIST DOWN 1 SLOT OVER    Y02668*27783102
                                   MATCHING ENTRY. AN EXTRA BYTE Y02668*27783902
                                   IS MOVED, BUT NO HARM DONE.   Y02668 27784702
         STC   R0,AOSCHKYS         PLACE MATCHING ENTRY AT TOP.  Y02668 27785502
         B     AOKS090             BR TO EXIT. R9 CONTAINS ADDR  Y02668*27786302
                                   OF MATCHING KEY IN TEXT.      Y02668 27787102
* END OF TEXT HAS BEEN REACHED AND NO MATCHES FOUND.             Y02668 27787902
AOKS080  DS    0H                                                Y02668 27788702
         SR    R9,R9               SET CODE FOR KEY(S) NOT FOUND.Y02668 27789502
AOKS090  DS    0H                                                Y02668 27790302
         LM    RE,R5,AOKSCHSA      RESTORE REGS.                YM01546 27791102
         BR    RE                  AND RETURN.                   Y02668 27791902
         SPACE 2                                                 Y02668 27792702
AOKS100  MVC   1(0,RF),0(RF)       EX MOVE OVER MATCHING ENTRY.  Y02668 27793502
ENDLISTI EQU   X'00'               END OF LIST INDICATOR.        Y02668 27797502
         EJECT                                                          27799102
*          ******************************************************Y02668 27799902
*          *                                                    *Y02668 27800702
*          * AOKSR1 - KEY SEARCH SERVICE ROUTINE.               *Y02668 27801502
*          *                                                    *Y02668 27802302
*          * AOKSR1 IS ENTERED TO FIND THE NEXT KEY IN A TEXT   *Y02668 27803102
*          * STRING. THE CALLING ROUTINE PROVIDES A SEARCH      *Y02668 27803902
*          * STARTING ADDRESS, AND PARAMETERS NECESSARY FOR     *Y02668 27804702
*          * SEARCHING THROUGH TEXT. AOKSR1 RETURNS THE ADDRESS *Y02668 27805502
*          * OF THE KEY.                                        *Y02668 27806302
*          *                                                    *Y02668 27807102
*          * INPUT -                                            *Y02668 27807902
*          * .R9 - ADDRESS OF KEY WHOSE TEXT IS TO BE SKIPPED   *Y02668 27808702
*          *                                                    *Y02668 27809502
*          * OUTPUT -                                           *Y02668 27810302
*          * .R9 - ADDRESS OF KEY AT WHICH SEARCH WAS STOPPED.  *Y02668 27811102
*          *  ENDING KEY MAY BE A TEXT ENDING KEY OR KEYWORD KEY*Y02668 27811902
*          *                                                    *Y02668 27812702
*          * NOTES -                                            *Y02668 27813502
*          * .AOKSR1 MOVES DATA FROM TEXT INTO THE FOLLOWING    *Y02668 27814302
*          *  WORK AREAS:                                       *Y02668 27815102
*          * .AOKSRPRM - TWO BYTE PARAMETER LIST COMPRISING -   *Y02668 27815902
*          * .AOKSRNBR - NUMBER OF PARAMS LEFT FOR THIS KEYWORD.*Y02668 27816702
*          * .AOKSRSCT - CONTENTS OF THE BYTE IN TEXT FOLLOWING *Y02668 27817502
*          *  THE NUMBER BYTE. CONTENTS MAY BE -                *Y02668 27818302
*          *                           SUBLIST COUNT            *Y02668 27819102
*          *                           LENGTH OF NEXT PARAMETER.*Y02668 27819902
*          * .AOKSRBY3 - CONTENTS OF THE 2ND BYTE IN TEXT FOLLOW*Y02668 27820702
*          *  ING THE NUMBER BYTE. IF AOKSRSCT CONTAINS A SUB-  *Y02668 27821502
*          *  LIST COUNT, THEN AOKSRBY3 CONTAINS THE LTH OF THE *Y02668 27822302
*          *  FIRST PARAM IN THE SUBLIST.                       *Y02668 27823102
*          *  OTHERWISE THE BYTE IS IGNORED.                    *Y02668 27823902
*          *                                                    *Y02668 27824702
*          ******************************************************Y02668 27825502
         SPACE 2                                                 Y02668 27826302
AOKSR1   DS    0H                                                Y02668 27827102
* R9 POINTS TO KEY BYTE. NUMBER BYTE FOLLOWS.                    Y02668 27827902
         MVC   AOKSRPRM(3),1(R9)   MOVE NBR, LTH AND LTH+1 BYTES Y02668*27828702
                                   FOR THIS KEY, TO WORK AREA.   Y02668 27829702
         LA    R9,2(R9)            POINT TO LENGTH BYTE.         Y02668 27830702
         CLI   AOKSRNBR,0          IS PARAM NBR ZERO?            Y02668 27831702
         BC    8,0(RE)             RETURN IF YES. ZERO PARAM NBR Y02668*27832702
                                   IS KEYWORD=KEYWORD CASE.      Y02668 27833702
* NON-ZERO PARAM NUMBER. INITIALIZE FOR SEARCH.                  Y02668 27834702
         STM   RE,RF,AOKSR1SA      SAVE REGS.                    Y02668 27835702
         SR    RE,RE               ZERO PARAM NUMBER             Y02668 27837502
         SR    RF,RF               AND PARAM LENGTH REGS.        Y02668 27838302
* ENTRY FROM WITHIN LOOP.                                        Y02668 27839102
AOKSR110 DS    0H                                                Y02668 27839902
         IC    RE,AOKSRNBR         LOAD PARAM NUMBER.            Y02668 27840702
         XC    AOKSRNBR(1),AOKSRNBR ZERO NBR FIELD TO INDICATE   Y02668 27841502
*                                  NO SUBLIST BEING PROCESSED.   Y02668 27842302
AOKSR120 DS    0H                                                Y02668 27843102
         IC    RF,AOKSRSCT         LOAD PRESUMED LENGTH.         Y02668 27843902
         TM    AOKSRSCT,SUBLST     SUBLIST BIT ON?               Y02668 27844702
         BZ    AOKSR150            BRANCH NO.                    Y02668 27845502
* SUBLIST BIT IS ON. LENGTH BYTE CONTAINS A SUBLIST COUNT        Y02668 27846302
* INSTEAD OF AN ACTUAL LENGTH VALUE.                             Y02668 27847102
         BCTR  RE,0                REDUCE NBR BY 1 FOR SUBLIST.  Y02668 27847902
         STC   RE,AOKSRNBR         SAVE REMAINING NUMBER.        Y02668 27848702
         IC    RE,AOKSRSCT         LOAD SUBLIST CT IN NBR REG,   Y02668*27849502
                                   TO BE USED AS NUMBER.         Y02668 27850302
         IC    RF,AOKSRBY3         LOAD ACTUAL LTH FROM BYTE 3.  Y02668 27851102
         N     RE,AOSBLOFF         CLEAR SUBLIST BIT TO GET      Y02668*27851902
                                   USABLE COUNT.                 Y02668 27852702
         LA    R9,1(R9)            POINT TO LENGTH BYTE.         Y02668 27853102
* LENGTH BYTE CONTAINS VALID LENGTH VALUE.                       Y02668 27853502
AOKSR150 DS    0H                                                Y02668 27854302
         LA    R9,1(RF,R9)         ADD PARAM LTH, PLUS 1 FOR LTH Y02668*27855102
                                   BYTE, TO POINT TO NEXT        Y02668*27855602
                                   CONTROL BYTE.                 Y02668 27856102
         MVC   AOKSRSCT(2),0(R9)   MOVE NEW LENGTH AND BYTE      Y02668 27856702
*                                  FOLLOWING, TO TEST AREA.      Y02668 27857502
         BCTR  RE,0                REDUCE NBR FOR THIS PARAM.    Y02668 27858302
         LTR   RE,RE               ANY MORE PARAMS TO GO?        Y02668 27859102
         BNZ   AOKSR120            BRANCH YES .                  Y02668 27859902
* NUMBER REG IS ZERO. TEST IF SUBLIST WAS BEING PROCESSED.       Y02668 27860702
         CLI   AOKSRNBR,0          WAS PARM NBR SAVED BEFORE?    Y02668 27861502
         BNE   AOKSR110            BRANCH YES TO PROCESS NBR.    Y02668 27862302
* NUMBER REG IS ZERO AND NO SUBLIST WAS BEING PROCESSED.         Y02668 27863102
AOKSR190 DS    0H                                                Y02668 27863902
         LM    RE,RF,AOKSR1SA      RESTORE REGS                  Y02668 27864702
         BR    RE                  AND RETURN.                   Y02668 27865502
         SPACE 2                                                 Y02668 27866302
AOSBLOFF DC    A(255-SUBLST)       MASK TO TURN OFF SUBLIST BIT. Y02668 27867102
SUBLST   EQU   X'80'               SUBLIST SWITCH.               Y02668 27874302
         EJECT                                                          27880000
*              **************************************************       27900000
*              *                                                *       27920000
*              *    A AND V ADDRESS CONSTANT TABLE.             *       27940000
*              *                                                *       27960000
*              **************************************************       27980000
*                                                                       28000000
*                       V ADDRESS CONSTANTS.                            28020000
*                                                                       28040000
IEFVHFHA DC    V(IEFVHF)          CONTROL ROUTINE.                      28060000
IEFVGMV  DC    V(IEFVGM)          MESSAGE ROUTINE.                      28140000
IEFVHRV  DC    V(IEFVHR)           WTO ROUTINE.                  Y02668 28150002
FIEFVHQ  DC    V(IEFVHQ)          Q MANAGER.                            28160000
FIEFVFB  DC    V(IEFVFB)          SYMBOLIC PARAMETER ROUTINE.           28170000
*                                                                       28180000
*                       A ADDRESS CONSTANTS                             28200000
*                                                                       28220000
AFB7     DC    A(FB7)             ADDRESS OF TRANSLATE TABLE.           28240000
AJ5L     DC    A(J5L)             ADDRESS FOR JOB KEY WORDS.            28260000
AE4L     DC    A(E4L)             ADDRESS FOR EXEC KEY WORDS.           28280000
AD4L     DC    A(D4L)             ADDRESS FOR DD MAJOR KEY WORDS.       28300000
AD4LD    DC    A(D4LD)            ADDRESS FOR DD DCB MINOR KEY WORDS.   28320000
AD4LUS   DC    A(D4LUS)           ADDRESS FOR DD UNIT MINOR KEY WORDS.  28340000
AD4LUA   DC    A(D4LUA)           ADDRESS FOR DD UNIT AFF KEY WORD.     28360000
AD4LV    DC    A(D4LV)            ADDRESS FOR DD VOLUME MINOR KEY WORDS 28380000
AD6LL    DC    A(D6LL)            ADDRESS FOR DD LABEL MINOR KEY WORDS. 28400000
*                                                                       28420000
NULLFILE DC    C'NULLFILE'         TEST FOR DUMMY DSNAME       @ZA26370 28422003
         SPACE 2                                                        28424002
*********************PREFIX EQUATES *****************************Y02668 28428002
JOB      EQU   1                                                 Y02668 28436002
EXEC     EQU   2                                                 Y02668 28440002
PROCV    EQU   8                                                 Y02668 28444002
AONUML   EQU   2                                                 Y02668 28448002
*********************PATCH SPACE ******************************@G29AN2E 28500003
         DC    C'PTCH'                  PATCH SPACE IDENTIFIER @G29AN2E 28550003
PATCH    DC    110F'0'                  PATCH SPACE            @G29AN2E 28600003
         EJECT                                                 @G29AN2E 28650003
DICT     JCLD                                                           28700003
         EJECT                                                          28750003
FB7      JTRT  TT,(BK,PR,LP,PL,AM,AS,RP,MI,SL,CO,AP,EQ),AL,NC           28800003
         END                                                            28850003
./  ADD  SSI=70900076,NAME=IEFVFB
*********************************************************************** 00005014
*                                                                     * 00006014
*  MODULE NAME - IEFVFB                                               * 00007402
*                                                                     * 00008014
*  DESCRIPTIVE NAME - SYMBOLIC PARAMETER ROUTINE                      * 00008402
*                                                                     * 00008802
*  COPYRIGHT - N/A                                                    * 00008902
*                                                                     * 00010302
*  STATUS - OS/VS2 RELEASE 3.0 AND 3.7 PTF                     @ZA18227 00020303
*                                                                     * 00022102
*  FUNCTION -  1. PROCESS EXEC PROCEDURE STATEMENTS  WHICH ASSIGN     * 00022202
*                 VALUES TO  SYMBOLIC PARAMETERS.   SYMBOLIC  AND     * 00023602
*                 VALUE ARE ENTERED IN A DICTIONARY FOR  SYMBOLIC     * 00025002
*                 PARAMETERS.  (SYMBUF)                               * 00026402
*                                                                     * 00027802
*              2. PROCESS SYMBOLIC PARAMETERS APPEARING ON STATE-     * 00029202
*                 MENTS IN A CATALOGUED PROCEDURE.  VALUE ASSIGN-     * 00030602
*                 MENTS ARE SUBSTITUTED WHERE SYMBOLICS  APPEAR.      * 00032002
*                                                                     * 00033402
*                                                                     * 00034802
*  OPERATION - THERE ARE TWO BASIC FLOWS THROUGH THE RTN.  (1) TO     * 00036202
*              PROCESS SYMBOLIC PARAMETER  VALUE ASSIGNMENTS FROM     * 00037602
*              EXEC PROCEDURE STATEMENTS OR PROC VERB  STATEMENTS     * 00039002
*              AND (2) TO PROCESS THE  SYMBOLIC  PARAMETERS WHICH     * 00040402
*              APPEAR ON DD AND EXEC  STATEMENTS  IN A CATALOGUED     * 00041802
*              PROCEDURE.                                             * 00043202
*                                                                     * 00044602
*              1. VALUE ASSIGNMENTS ON EXEC PROCEDURE  STATEMENTS     * 00046002
*                                                                     * 00047402
*                 A. AFTER  MODULE  INITIALIZATION, THE  SYMBOLIC     * 00048802
*                    PARAMETER  DICTIONARY (SYMBUF)  IS  SEARCHED     * 00050202
*                    USING THE SYMBOLIC AS SEARCH ARGUMENT.    IF     * 00051602
*                    THE SYMBOLIC IS FOUND ( INDICATING THE PARAM     * 00053002
*                    WAS PREVIOUSLY DEFINED ) RETURN IS  TO  SCAN     * 00054402
*                    ROUTINE WITH NO ENTRY  BEING MADE IN SYMBUF.     * 00055802
*                    IF THE SYMBOLIC PARAMETER WAS NOT PREVIOUSLY     * 00057202
*                    DEFINED,  IT IS ENTERED INTO THE DICTIONARY.     * 00058602
*                                                                     * 00060002
*                 B. VALUE ASSIGNMENTS ASSOCIATED WITH  THE PARAM     * 00061402
*                    ARE ALSO  ENTERED INTO  THE  DICTIONARY.         * 00062802
*                                                                     * 00064202
*                 C. POINTERS ARE SET FOR SCAN ROUTINE  TO RESUME     * 00065602
*                    PROCESSING OF THE INPUT STATEMENT.               * 00067002
*                                                                     * 00068402
*                 D. RETURNS TO SCAN ROUTINE VIA REG 14               * 00069802
*                                                                     * 00071202
*                                                                     * 00078202
*              2. SYMBOLIC PARAMETERS ON STATEMENTS IN A PROC         * 00079602
*                                                                     * 00081002
*                 A. SYMBOLIC  PARAMS ARE  PROCESSED BY  BUILDING     * 00082402
*                    INTERMEDIATE TEXT COMPOSED OF VALUE  ENTRIES     * 00083802
*                    TAKEN FROM THE SYMBOLIC PARAMETER DICTIONARY     * 00085202
*                    IN COMBINATION WITH TEXT CONCATENATED IN THE     * 00086602
*                    INPUT STATEMENT.                                 * 00088002
*                                                                     * 00089402
*                 B. POINTERS ARE SET CAUSING SCAN RTN TO PROCESS     * 00090802
*                    THE INTERMEDIATE TEXT.   ( WHEN INTERMEDIATE     * 00092202
*                    TEXT IS PROCESSED  BY SCAN RTN, POINTERS ARE     * 00093602
*                    RESET BACK TO THE INPUT STATEMENT  AND  SCAN     * 00095002
*                    CONTINUES. )                                     * 00096402
*                                                                     * 00097802
*                                                                     * 00099202
*  NOTES - THE HIGH ORDER BIT OF THE 'LENGTH OF PARM ' FIELD IS SET   * 00100402
*          WHEN VALUE ASSIGNMENT IS MADE.   THE BIT IS CLEARED WHEN   * 00100502
*          THE VALUE FIELD IS MOVED TO THE INTERMEDIATE BUFFER.       * 00100602
*          THE BIT FOR EACH ENTRY IS CHECKED IN THE CONVERTER PROC    * 00100702
*          EOF ROUTINE.   ANY BITS LEFT ON(MEANING SYMBOLICS HAVE     * 00100802
*          NOT BEEN USED) RESULTS IN AN ERROR CONDITION WHICH         * 00100902
*          CAUSES JOB FAILURE.                                        * 00101402
*                                                                     * 00102402
*                                                                       00102502
*     CHARACTER CODE DEPENDENCIES - EBCDIC                            * 00102702
*     DEPENDENCIES - NONE                                             * 00103102
*     RESTRICTIONS - NONE                                             * 00103202
*     REGISTER CONVENTIONS - REG 12 PTR TO CONVERTER WORK AREA        * 00103302
*     PATCH-LABEL - PATCH                                             * 00103502
*                                                                     * 00103902
*                                                                       00104002
*  MODULE TYPE - BAL                                                  * 00104302
*     PROCESSOR - ASSEMBLER                                           * 00104502
*     ATTRIBUTES - REFRESHABLE,PRIVILEGED,KEY 0, PAGEABLE LPA         * 00104902
*                                                                     * 00105302
*                                                                       00105402
*                                                                       00105602
*  ENTRY POINT - IEFVFB FROM IEFVFA                                   * 00106002
*     PURPOSE - TO SAVE SYMBOLIC PARAMETER VALUES AND WHEN NECESSARY  * 00106102
*               MAKE SUBSTITUTIONS IN PROCEDURE STATEMENTS.           * 00106302
*     LINKAGE - BALR                                                  * 00106702
*     INPUT -                                                         * 00106802
*               REGISTER 1 - DELIMETER POINTER                        * 00106902
*               REGISTER 8 - PTR TO SCAN LOCAL WORK AREA              * 00107202
*               REGISTER 12 - PTR TO CONVERTER WORK AREA              * 00107602
*               REGISTER 13 - PTR TO REGISTER SAVE AREA               * 00108002
*     REGISTERS SAVED - REG14-REG12                                   * 00108102
*     REGISTER CONTENTS DURING PROCESSING -                           * 00108202
*               R0  - WORK REG                                        * 00108602
*               R1  - DELIMETER PTR                                   * 00108702
*               R2  - MSG CODE AND WORK REG                          *  00111202
*               R3  - WORK REG                                        * 00113802
*               R4  - PTR TO CURRENT SYMBUF ENTRY                     * 00115802
*               R5  - RETURN ADDR FOR SUBROUTINES                     * 00117802
*               R6  - WORK REG                                        * 00119802
*               R7  - PTR TO PARM VALUE                               * 00119902
*               R8  - PTR TO SCAN LOCAL WORK AREA                     * 00120002
*               R9  - LINKAGE REG TO SUBROUTINES                      * 00120102
*               R10 - WORK REG                                        * 00120602
*               R11 - IEFVFB BASE REG                                 * 00121002
*               R12 - PTR TO CONVERTER WORK AREA                      * 00121402
*               R13 - PTR TO REG SAVE AREA                            * 00121502
*               R14 - RETURN REG                                      * 00121802
*               R15 - LINKAGE REG                                     * 00122202
*     REGISTERS RESTORED - REG14-REG12                                * 00122602
*                                                                     * 00123002
*                                                                       00123102
*  EXIT-NORMAL - BR 14 TO CALLER                                      * 00123402
*     CONDITIONS - SYMBOLIC PARM SAVED OR SUBSTITUTED                 * 00123802
*     OUTPUT - SYMBOLIC PARM DICTIONARY TO SWA                        * 00123902
*              PTR TO SUBSTITUTED VALUE                               * 00124202
*     RETURN CODES - NONE                                             * 00124602
*                                                                     * 00125002
*                                                                       00135002
*  EXIT-ERROR - BR 14 TO CALLER'S ERROR ROUTINE                       * 00175002
*     CONDITIONS - INVALID SYMBOLIC PARAMETER                         * 00177002
*     OUPUT - REG 2 CONTAINS ERROR MESSAGE CODE                       * 00179002
*     RETURN CODES - NONE                                             * 00181002
*                                                                     * 00182202
*                                                                       00183202
*  EXTERNAL REFERENCES - SWA MANAGER INTERFACE                        * 00185002
*     ROUTINES - IEFVHQ                                               * 00186002
*     DATA AREAS - CONVERTER WORK AREA, SCAN LOCAL WORK AREA,         * 00187002
*                  SYMBOLIC PARM DICTIONARY,STMT BUFFERS              * 00188002
*     CONTROL BLOCKS - QMPA                                      *      00189002
*     TABLES - CONVERTER/INTERPRETER KEYS(IEFVKEYS)                   * 00190002
*     MACROS - SAVE,IEFSAVER,IEFRELSE,RETURN,SCSW,GETMAIN,FREEMAIN    * 00191002
*     ENQUEUE RESOURCES - NONE                                        * 00192002
*     CHANGE LEVEL - Y02668(MVM C/I),OZ05366,ZA08218,ZA18227  @ZA18227* 00193003
*                                                                     * 00194002
*                                                                       00194402
*  MESSAGES -                                                         * 00195002
*            IEF630I UNIDENTIFIED KEYWORD                             * 00197002
*            IEF618I OPERAND FIELD NOT TERMINATED IN COMMA OR BLANK   * 00199002
*            IEF623I SOURCE TEXT CONTAINS UNDEFINED OR ILLEGAL        * 00199402
*                    CHARACTERS                                       * 00199802
*            IEF642I EXCESSIVE PARAMETER LENGTH                       * 00199902
*            IEF647I NON-ALPHA FIRST CHARACTER                        * 00204502
*                                                                     * 00211402
*                                                                     * 00280402
*********************************************************************** 00282402
         EJECT                                                          00284402
*********************************************************************** 00284802
*  FORMAT OF ENTRIES IN SYMBOLIC  PARAMETER  DICTIONARY  (SYMBUF)     * 00285002
*                                                                     * 00289602
*  *****************************************************************  * 00294202
*  *        *        *        *        *          *        *       *  * 00298802
*  * TTR OF * TTR OF * LENGTH * LENGTH *          * LENGTH *       *  * 00303402
*  *  THIS  *  NEXT  *   OF   *   OF   * SYMBOLIC *   OF   * VALUE *  * 00308002
*  * BUFFER * BUFFER *  ENTRY *  PARAM *  PARAM   *  VALUE *       *  * 00312602
*  *        *        *  (LE)  *  (LP)  *          *  (LV)  *       *  * 00317202
*  *        *        *        *        *          *        *       *  * 00321802
*  *****************************************************************  * 00326402
*                                                                     * 00331002
*   4 BYTES  4 BYTES   1 BYTE   1 BYTE   VARIABLE   1 BYTE  VARIABLE  * 00335602
*                                         LENGTH             LENGTH   * 00340202
*********************************************************************** 00381602
         EJECT                                                          00386202
         IEFQMNGR                                                       00390802
         EJECT                                                          00395402
         IEFVKEYS                                                       00400014
         EJECT                                                          00500014
         IEFCOMWA                                                Y02668 00600002
         IEFCVRWA                                                Y02668 00650002
         EJECT                                                          00700014
         IEFVMSWA                                                       00800014
         SPACE                                                          00900014
*   FB EQUATES                                                          01000014
FEQUAL   EQU   C'='               EQUAL                                 01100014
FAPOST   EQU   C''''              APOST                                 01200014
FBLANK   EQU   C' '               BLANK                                 01300014
FCOMMA   EQU   C','               COMMA                                 01400014
FAMP     EQU   C'&&'              AMPERSAND                             01500014
FPERIOD  EQU   C'.'               PERIOD                         A37550 01550001
FRPAREN  EQU   C')'               RIGHT PAREN.                   A51024 01560001
FBSMAX   EQU   7                  MAX LENGTH OF SYMBOLIC PARAMETER      01600014
ITBL     EQU   120                MAX LENGTH OF TEXT IN INTBUF          01650014
MSGMAX   EQU   120                MAX LENGTH OF MSG TEXT                01655003
TWO7     EQU   27                 LENGTH OF MSG HEA&ER.          A37550 01660001
ONE      EQU   1                  DISPLACEMENT.                  A37550 01670001
SIX9     EQU   69                 MAX LENGTH FOR MOVE1          YM01591 01673002
BUFLNGTH EQU   TWO7+SIX9+ITBL     SIZE OF MAX BUFFER REQ'D      YM01591 01676002
FBFOUR   EQU   4             LENGTH VALUE OF FOUR                Y02621 01680002
*   FB ERROR MESSAGE CODES                                              01700014
ERMSB01  EQU   X'1E' UNDIENTIFIED KEYWORD                               01800014
*                                                                       02100014
ERMSB03  EQU   X'12' OPERAND FIELD NOT TERM IN COMMA OR BLANK           02200014
ERMSB04  EQU   X'17' SOURCE TEXT CONTAINS UNIDENTIFIED CHARACTERS       02300014
ERMSB05  EQU   X'2A' EXCESSIVE PARAMETER LENGTH -TOO MANY INTBUF CHARS  02400014
*                                                                       02600014
ERMSB06  EQU   X'2F' NON ALPH FIRST CHARACTER                           02700014
ERMSB07  EQU   X'2A' EXCESSIVE PARAMETER LENGTH                         02750014
*     FB  SECONDARY MESSAGE CODES                                       02760014
*                                                                       02770014
SMSGS    EQU   INTKEY1             SYMBOLIC PARAMETER             19874 02777019
SMSGP    EQU   INTKEY2             VALUE FIELD OF THE .....       19874 02784019
SMSGV    EQU   INTKEY3             ON THE PROC STATEMENT          19874 02791019
FBSVN    EQU   7                  DISPLACEMENT CONSTANT          Y02621 02794002
SYMBUFID EQU   X'25'              ID FOR WRITING SYMBUF RECORD.  Y02621 02797002
NUMB     EQU   X'01'               DISP TO COUNT FIELD IN TEXT.  Y02668 02798002
RECNO1   EQU   X'01'                                             Y02668 02798602
RECNO2   EQU   X'20'                                             Y02668 02799202
         SPACE 2                                                        02800014
IEFVFB   CSECT                                                          02900014
* ADDED STATEMENT AFTER LABEL FBCHN                            @ZA05366 02920003
* CODE & COMMENTS CHANGED NEAR LABELS AROUND & FBDEL02X,       @ZA08218 02934003
*  BUILDING MULTIPLE SUBSTITUTION                              @ZA08218 02935003
*  JCL MESSAGE                                                 @ZA08218 02939003
* ADDED CODE TO DETECT DUMM= AFTER LABEL FBDEL02               @ZA18227 02944003
DASBIT   EQU   16                  **********TEMP************   YM01590 02950002
         SAVE  (14,12)            SAVE REGISTERS                        03000014
         BALR  RB,R0 FB BASE                                            03100014
         USING *,RB                                                     03200014
*****************************************************************Y02668 03205002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 03210002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 03215002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 03220002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 03225002
         DC    C'VFB '             MOD ID USED BY TRACE.         Y02668 03230002
* TRACE RETURNS HERE.                                            Y02668 03235002
*****************************************************************Y02668 03240002
         B     VFB01               BRANCH AROUND ID              Y02668 03250002
         MODID BR=NO                                             Y02668 03350002
         DC    C'SPLT'                                           Y02668 03450002
         DC    C'04'               LEVEL NUMBER (SWA SUPPORT).   Y02668 03550002
         DC    C'REL3PTF'     PTF UZ01541 0B0-C IN VHA READING @ZA05366 03560003
*        DC    C'01'          DICTIONARY NOT WRITTEN TO SWA    @ZA05366 03590003
*        DC    C'02'          ALLOW AS MANY IEF653I SUBSTITUTION JCL    03592003
*                             MSGS AS NEEDED TO SHOW ALL                03594003
*                             SUBSTITUTIONS                    @ZA08218 03596003
         DC    C'03'  CHANGE DUMM= TO DUMMY IN SUBSTITUTION    @ZA18227 03600003
*                     JCL MESSAGE                              @ZA18227 03604003
VFB01    DS    0H                                                Y02668 03650002
         EJECT                                                          03800014
*********************************************************************** 03900014
*                                                                     * 04000014
*   INITIALIZATION                                                    * 04100014
*                                                                     * 04200014
*        R1 = POINTER TO STATEMENT DELIMITER                          * 04300014
*        R4 = CURRENT ENTRY IN SYMBUF                                 * 04400014
*                                                                     * 04500014
*********************************************************************** 04600014
         SPACE                                                          04700014
         LA    R4,SYMBUF+8        CURRENT SYMBUF ENTRY                  04900014
         L     R7,CBSYP           CHAR STRING PTR                       05000014
*                                                                       05100014
*   CHECK IF FROM KEYWORD RTN                                           05200014
*                                                                       05300014
         CLI   0(R1),FEQUAL       IS DELIMITER AN EQUAL SIGN            05400014
         BE    FBB                YES- PROCESS TO ASSIGN A VALUE        05430014
         CLI   0(R1),C'.'         NO - IS THIS INCORRECT USE OF PERIOD  05460014
         BNE   FBC                NO - PROCESS FOR SUBSTITUTION         05490014
         LA    R2,ERMES10         GET ERROR CODE                        05520014
         B     FBERR              ERROR RETURN                          05550014
*                                                                       05600014
*********************************************************************** 05700014
*                                                                     * 05800014
*   PROCESSING RTN TO ASSIGN A VALUE TO A SYMBOLIC PARAMETER          * 05900014
*                                                                     * 06000014
*    ROUTINE FIRST TEST FOR EXEC PROC STATEMENT                       * 06100014
*                                                                     * 06200014
*********************************************************************** 06300014
         SPACE                                                          06400014
FBB      DS    0H                                                       06500014
         L     R5,TBEGP            GET PTR TO VERB KEY           Y02668 06700002
         CLI   1(R5),NUMB          Q. EXEC VERB HAVE OVER 1 PARM Y02668 06750002
         BH    FBB0               YES - GO SET PROC SW                  06800014
         LA    R6,PROCEK          NO  - CHECK FOR PROC= KEY             06900014
         BAL   R9,FBI             HAVE FBI CHECK ON IT                  07000014
         LA    R6,KEYTAB(R6)      OFFSET TO KEY TABLE                   07100014
         EX    R2,FBB010          IS PROC KEY BIT ON                    07200014
*                                    R2 HAS BIT PATTERN FOR PROC        07300014
*                                    R6 HAS OFFSET TO KEYTAB            07400014
         BZ    FBB020             TRANSFER BIT OFF - ERROR              07500014
FBB0     DS    0H                                                       07600014
         SCSW  S,PROCSWZ          THIS IS EXEC PROC - SET INDICATOR     07700014
         OC    SYMTTR(FBFOUR),SYMTTR   DOES SYMBUF HAVE A TTR?   Y02621 07750002
         BNE   FBB030             YES - GO TO SEARCH FIRST BUFFER       07800014
         XC    SYMBUF(176),SYMBUF NO  - CLEAR THE BUFFER                07850014
*                                                                       07900014
*   ASSIGN TTR TO SYMBUF AND SAVE TTR  IN SYMTTR                        08000014
*                                                                       08100014
*                                                                       08200014
         XC    QLINKWA(8),QLINKWA  CLEAR PARMLIST                Y02668 08300002
         LA    R3,QLINKWA          GET ADDR OF EXTERNAL PARMLIST Y02668 08330002
         ST    R3,QPARM+QMPCL-QMNAM SAVE PTR IN QMPA             Y02668 08360002
         MVI   QPARM+QMPCM-QMNAM,RECNO2 ASSIGN TWO SVA'S(ONE FOR Y02668 08390002
*                                  SYMBUF AND THE OTHER FOR A    Y02668 08420002
*                                  SYMBUF EXTENSION              Y02668 08450002
         MVI   QPARM+QMPOP-QMNAM,QMASGN                                 08500014
         BAL   R6,FBQMAN02        GO TO ASSIGN TTR                      08560014
         L     R3,QPARM+QMPCL-QMNAM                                     08620014
         MVC   TNEXT(4),0(R3)     SAVE ASSIGNED TTR                     08700014
         MVC   SYMBUF(4),4(R3)     INSERT SVA IN SYMBUF          Y02668 08720002
         MVC   SYMTTR(4),4(R3)     ALSO SAVE IT IN THE CWA FOR   Y02668 08740002
*                                  VFA AND VHA TO CHECK. A NON - Y02668 08760002
*                                  ZERO VALUE HERE INDICATES     Y02668 08780002
*                                  SYMBOLICS WERE PRESENT IN A   Y02668 08800002
*                                  PROCEDURE                     Y02668 08820002
         B     FBB030                                                   08900014
FBB010   DS    0H                 EXECUTED                              09000014
         TM    0(R6),0            TEST BIT                              09100014
FBB020   DS    0H                                                       09200014
         LA    R2,ERMSB01                                               09300014
         B     FBERR              GO TO ERROR RTN                       09400014
         SPACE 2                                                        09500014
*********************************************************************** 09600014
*                                                                     * 09700014
*   STATEMENT IS EXEC PROC - SEARCH SYMBUF FOR SYMBOLIC PARAM         * 09800014
*                                                                     * 09900014
*        FOUND = DO NOT MAKE ENTRIES IN SYMBUF                        * 10000014
*        NOT FOUND = OK (ENTER SYMBOLIC IN TABLE)                     * 10100014
*                                                                     * 10200014
*********************************************************************** 10300014
         SPACE                                                          10400014
FBB030   DS    0H                                                       10500014
         BAL   R5,FBSCH           GO TO TABLE SEARCH ROUTINE            10600014
         LTR   RF,RF              IS SYMBOLIC ALREADY IN TABLE          10700014
         BZ    FBB1               NO - GO ENTER SYMBOLIC                10800014
         SCSW  S,FBFLUSHZ         SET FLUSH SW - NO UPDATE OF SYMBUF    10900014
*                                                                       11100014
*                                                                       11200014
*   CHECK SYMBOLIC FOR FIRST CHARACTER ALPHA                            11300014
*                                                                       11400014
FBB1     DS    0H                                                       11500014
         LTR   RA,RA              NULL SYMBOLIC                         11510014
         BZ    FBB020             TRANSFER NULL  - ERROR                11520014
         MVI   MSGKEY,SMSGS       SECONDARY MESSAGE                     11550014
         MVC   FAWA4(1),0(R7)     MOVE FIRST CHAR TO WORK AREA          11600014
         NI    FAWA4,X'F0'        ZERO LOW ORDER BITS                   11700014
         XI    FAWA4,C'0'         TEST FOR DIFFERENCE IN ZONE BITS      11800014
         BC    7,FBB102           TRANSFER - NOT NUMERIC                11900014
         LA    R2,ERMSB06         ERROR MSG NUMBER                      12000014
         B     FBERR0                                                   12100014
FBB102   DS    0H                                                       12200014
*                                                                       12300014
*   CHECK SYMBOLIC FOR SPECIAL CHARACTERS AND MAX LENGTH                12400014
*                                                                       12500014
         LA    R5,FBSMAX          MAX LENGTH                            12600014
         CLR   RA,R5              RA HAS LENGTH OF THIS SYMBOLIC        12700014
         BNH   FBB104             TRANSFER - SYMBOLIC NOT TOO LONG      12740014
         LA    R2,ERMSB07         ERROR MSG NUMBER                      12780014
         B     FBERR0                                                   12820014
FBB104   DS    0H                                                       12860014
         BAL   R9,FBSCR           GO TO TRANSLATE SYMBOLIC              12900014
*                                 NO ERROR - CONTINUE PROCESSING        12930014
         SPACE 2                                                        12960014
*********************************************************************** 13000014
*                                                                     * 13100014
*   GO TO TABLE BUILD RTN TO ENTER SYMBOLIC IN SYMBUF                 * 13200014
*                                                                     * 13300014
*        R1 = DELIMITER PTR                                           * 13400014
*        R4 = CURRENT SYMBUF ENTRY                                    * 13500014
*        R5 = RETURN ADDRESS                                          * 13600014
*        R7 = POINTER TO FIRST CHARACTER                              * 13700014
*                                                                     * 13800014
*********************************************************************** 13900014
         SPACE 2                                                        14000014
FBB110   DS    0H                                                       14100014
         BAL   R5,FBBLD           GO TO TABLE BUILD RTN (RF=0)          14200014
*                                 SYMBOLIC IS IN SYMBUF                 14300014
         OI    1(R4),HONE         SET FLAG IN LP BYTE                   14400014
*                                                                       14500014
*   CHECK IF VALUE IS ENCLOSED IN APOST                                 14600014
*                                                                       14700014
         LA    R1,1(R1)                                                 14800014
         LR    R7,R1              UPDATE STRING PTR                     14850014
         CLI   0(R1),FAPOST       IS FIRST CHAR = APOST                 14900014
         BE    FBB2               YES-TRANSFER FOR SPECIAL CHARS        15000014
*                                                                       15200014
*   PROCESSING  FOR  VALUE NOT IN APOSTS                                15300014
*                                                                       15400014
FBB120   DS    0H                                                       15500014
         LA    R3,1               COUNT FOR MOVE RTN                    15600014
         LR    R2,R1              PTR FOR MOVE RTN                      15650014
         CLI   0(R1),FBLANK       BLANK                                 15700014
         BE    FBB130             YES- TRANSFER                         15800014
         CLI   0(R1),FCOMMA       NO - COMMA                            15900014
         BE    FBB130             YES- TRANSFER                         16000014
         BAL   R5,FBMVC           NO - MOVE CHAR TO INTBUF              16100014
         LA    R1,1(R1)           BUMP CHARACTER POINTER                16200014
         B     FBB120             LOOP                                  16300014
*                                                                       16400014
*   SPECIAL CHARACTER CHECK                                             16500014
*                                                                       16600014
FBB130   DS    0H                                                       16700014
         MVI   MSGKEY,SMSGP       SECONDARY MESSAGE                     16800014
         BAL   R9,FBSCR           GO TO SPECIAL CHARACTER ROUTINE       16900014
         B     FBB3               GO TO MOVE VALUE TO SYMBUF            17000014
*                                                                       17100014
*   PROCESSING FOR VALUE IN APOSTS                                      17200014
*                                                                       17300014
FBB2     DS    0H                                                       17400014
         LA    R1,1(R1)           FIRST CHAR OF VALUE                   17500014
FBB220   DS    0H                                                       17600014
         CLI   0(R1),FAPOST       IS THIS APOST                         17700014
         BE    FBB240             YES  TRANSFER                         17800014
*                                 NO   MOVE THIS CHAR TO INTBUF         17900014
FBB230   DS    0H                                                       18000014
         LA    R3,1               COUNT FOR MOVE RTN                    18100014
         LR    R2,R1                                                    18200014
         CL    R2,CENDP           DOES OPERAND GO INTO COL 72      AACA 18230017
         BH    FBTRR07             BR IF INTO COL 72 - ERROR       AACA 18260017
         BAL   R5,FBMVC           MOVE BYTE TO INTBUF                   18300014
         B     FBB2               LOOP                                  18400014
FBB240   DS    0H                                                       18500014
         LA    R1,1(R1)           BUMP CHAR PTR                         18600014
         CLI   0(R1),FAPOST       IS THIS TWO APOST                     18700014
         BE    FBB230             YES  MOVE ONE TO INTBUF               18800014
         CLI   0(R1),FBLANK       IS CHARACTER A BLANK?          A51024 18850001
         BE    FBB3               YES, MOVE VALUE TO SYMBUF.     A51024 18860001
         CLI   0(R1),FCOMMA       IS CHARACTER A COMMA?          A51024 18870001
         BE    FBB3               YES, MOVE VALUE TO SYMBUF      A51024 18880001
         CLI   0(R1),FRPAREN      IS CHARACTER A RIGHT PAREN?    A51024 18890001
         BE    FBB3               YES, MOVE VALUE TO SYMBUF.     A51024 18892001
         LA    R2,ERMES6          GET ERROR CODE.                A51024 18894001
         B     FBERR              ERROR RETURN.                  A51024 18896001
*                                 NO   END OF VALUE                     18900014
         SPACE 2                                                        19000014
*********************************************************************** 19100014
*                                                                     * 19200014
*   PREPARE TO MOVE VALUE TO SYMBUF                                   * 19300014
*                                                                     * 19400014
*        R1 = PTR TO DELIMITER                                        * 19500014
*        R4 = CURRENT SYMBUF PTR                                      * 19600014
*        R5 = RET ADDRESS                                             * 19700014
*        R7 = PTR TO FIRST CHARACTER                                  * 19800014
*                                                                     * 19900014
*********************************************************************** 20000014
         SPACE                                                          20100014
FBB3     DS    0H                                                       20200014
         LA    R7,INTBUF+1        FIRST CHAR  OF VALUE                  20300014
         ST    R1,CESYP           SAVE DELIMITER FOR SCAN RTN           20400014
         BCTR  R1,R0                                                    20430014
         ST    R1,CSTRP                                                 20460014
         SR    R1,R1                                                    20500014
         IC    R1,INTBUF                                                20600014
         LA    R1,INTBUF+1(R1)    DELIMITER POINTER FOR BUILD RTN       20700014
         BAL   R5,FBBLD           GO TO TABLE BUILD RTN                 20800014
*                                                                       20900014
*   VALUE IS IN TABLE - RETURN TO SCAN ROUTINE                          21000014
*                                                                       21100014
FBB440   DS    0H                                                       21900014
         OI    SRCHSW1,SRCHF8     NO TEXT INTO TEXTBUF           A32730 21960020
         B     FBRET                                                    22020014
         EJECT                                                          22100014
*********************************************************************** 22200014
*                                                                     * 22300014
*   PROCESSING RTN TO DEFINE A SYMBOLIC PARAMETER                     * 22400014
*                                                                     * 22500014
*        BUILDS INTERMEDIATE TEXT IN INTBUF                           * 22600014
*                                                                     * 22700014
*********************************************************************** 22800014
         SPACE                                                          22900014
FBC      DS    0H                                                       23000014
         MVI   INTBUF+1,C' '                                            23040014
         MVC   INTBUF+2(ITBL-1),INTBUF+1 BLANK INTBUF                   23080014
         MVC   INTBUF-ITBMSGL(ITBMSGL),FBCMSG1 INITIALIZE MSG BUFFER    23120014
         MVI   INTBUF,0           ZERO COUNT FIELD                      23160014
         SCSW  Z,VERBCSWZ,FBC02   TRANSFER NOT A PROC VERB              23170014
         MVI   MSGKEY,SMSGV       INITIALIZE SECONDARY ERROR MESSAGE    23180014
FBC02    DS    0H                                                       23190014
         TM    SWE,PROC+PREF     IS THIS STATEMENT IN A PROC    YA02705 23200002
         BC    5,FBAMR           YES - GO TO PROCESS AMPERSAND  YA02705 23300002
         SCSW  O,POVRDZ,FBAMR     NO  - TRANSFER IF OVERRIDE DD         23400014
         B     FBRET              RETURN                                23500014
         SPACE 2                                                        23508014
*                                                                       23516014
*    FOLLOWING TEXT PRECEDES THE INTBUF.  THE MESSAGE AND               23524014
*        THE VARIABLE LENGTH TEXT IN INTBUF ARE PRINTED                 23532014
*        IF A JCL ERROR IS DETECTED WHILE THE INTBUF                    23540014
*        IS BEING SCANNED.                                              23548014
*   NOTE - IF THE TEXT OF MSG IS CHANGED AND LENGTH IS ALTERED,         23556014
*        THE EQUATE 'ITBMSGL' MUST BE CHANGED ACCORDINGLY.              23564014
*                                                                       23572014
FBCMSG1  DS    0H                                                       23580014
         DC    C'IEF653I SUBSTITUTION JCL - '                      I68  23590018
         EJECT                                                          23600014
*********************************************************************** 23700014
*                                                                     * 23800014
*   TRANSLATE AND TEST ROUTINE          R1= CHARACTER STRING PTR      * 23900014
*                                                                     * 24000014
*********************************************************************** 24100014
         SPACE                                                          24200014
FBTRR0   DS    0H                                                       24230014
         LA    R1,1(R1)           BUMP PTR                              24260014
FBTRR    DS    0H                                                       24300014
         L     R3,FATRP           ADDRESS OF TRANSLATE TABLE            24400014
         L     R5,CENDP           END OF STATEMENT                      24500014
         LA    R5,1(R5)           BUMP ONE TO ACCEPT COL. 72 PTM122     24550014
         SR    R2,R2                                                    24600014
         SR    R5,R1              IS TEXT TOO LONG                      24700014
         BC    12,FBTRR06         YES - ERROR                           24800014
         EX    R5,FBTRR04         EXECUTE TRANSLATE INSTRUCTION         24900014
         BC    6,FBTRR02-4(R2)                                          25000014
FBTRR02  DS    0H                                                       25100014
         B     FBBKR              BLANK                                 25200014
         B     FBPRR              PERIOD                                25300014
         B     FBTTR              ILLEGAL                               25400014
         B     FBLPR              LEFT PAREN                            25500014
         B     FBPLR              PLUS                                  25600014
         B     FBAMR              AMPERSAND                             25700014
         B     FBASR              ASTERISK                              25800014
         B     FBRPR              RIGHT PAREN                           25900014
         B     FBCOR              COMMA                                 26000014
         B     FBAPR              APOST                                 26100014
         B     FBEQR              EQUAL                                 26200014
         B     FBMIR              MINUS                                 26300014
         B     FBSLR              SLASH                                 26400014
FBTRR04  DS    0H                                                       26500014
         TRT   0(0,R1),0(R3)                                            26600014
*                                                                       26700014
FBTRR06  DS    0H                                                       26800014
         SCSW  Z,FBLITRLZ,FBTRR08 TRANSFER NO LITERAL                   26810014
         BCTR  R1,R0                                                    26820014
         SCSW  C,FBLITRLZ         CLEAR THE LITERAL INDICATOR           26840014
         B     FBDEL02          GO PREPARE FOR RET TO SCAN RTN          26850014
FBTRR07  DS    0H                                                       26853017
         MVI   INTBUF,0            INDICATE NO TEXT IN BUFFER      AACA 26856017
FBTRR08  DS    0H                                                       26860014
         LA    R2,ERMSB03                                               26900014
         MVI   MSGKEY,0           ZERO SECONDARY MSG                    26950014
         B     FBERR                                                    27000014
         EJECT                                                          27100014
*                                                                       27200014
*   ROUTINE TO PROCESS AMPERSAND                                        27300014
*                                                                       27400014
FBAMR    DS    0H                 AMPERSAND                             27500014
         BAL   R9,FBTXT           TEXT RTN                              27600014
         LR    R7,R1              BUMP STRING PTR (& NOT PART OF TEXT)  27700014
         CLI   0(R1),FAMP         DOUBLE AMPERSANDS                     27800014
         BE    FBTRR0             YES - RETURN TO BUMP PTR              28000014
         SCSW  S,AMPSWZ           NO  - SET SW TO INDICATE SYMBOLIC     28200014
         B     FBTRR              RETURN TO TRANSLATE RTN               28400014
         SPACE 2                                                        28500014
*                                                                       28600014
*   ROUTINE TO PROCESS APOST                                            28700014
*                                                                       28800014
FBAPR    DS    0H                 APOST                                 28900014
         CLI   1(R1),FAPOST       DOUBLE APOST                          29100014
         BE    FBAPR01            YES - TRANSFER                        29250014
         XI    FBLITRLZ,FBLITRL   NO  - FLIP THE LITERAL INDICATOR      29320014
         B     FBSPR                                                    29400014
FBAPR01  DS    0H                                                       29420014
         BAL   R9,FBTXT           GO TO TEXT RTN                        29440014
         B     FBTRR0             RETURN TO TRANSLATE                   29460014
         SPACE 2                                                        29500014
*                                                                       29600014
*   ROUTINE TO PROCESS PERIOD                                           29700014
*                                                                       29800014
FBPRR    DS    0H                 PERIOD                                29900014
         SCSW  Z,AMPSWZ,FBTRR0    TRANSFER TEXT NOT CONCATENATED        30000014
         BAL   R9,FBTXT           TEXT ROUTINE                          30100014
         LR    R7,R1              DO NOT ALLOW PERIOD INTO TEXT         30150014
         B     FBTRR              RETURN TO TRANSLATE                   30200014
         SPACE 2                                                        30600014
*                                                                       30700014
*   ROUTINE TO PROCESS LEFT PAREN                                       30800014
*                                                                       30900014
FBLPR    DS    0H                 LEFT PAREN                            31000014
         SCSW  Z,AMPSWZ,FBTRR0    TRANSFER NO SYMBOLIC BEFORE LPRA41170 31050001
         BAL   R9,FBTXT           TEXT ROUTINE FOR SYMBOLIC      A41170 31060001
         B     FBTRR              RETURN TO TRANSLATE NEXT CHAR  A41170 31100001
         SPACE 2                                                        31300014
*                                                                       31400014
*   ROUTINE TO PROCESS SPECIAL CHARACTERS                               31500014
*                                                                       31600014
FBSPR    DS    0H                 SPECIAL CHARACTER                     31700014
FBTTR    DS    0H                 ILLEGAL                               31800014
FBPLR    DS    0H                 PLUS                                  31900014
FBASR    DS    0H                 ASTERISK                              32000014
FBRPR    DS    0H                 RIGHT PAREN                           32100014
FBEQR    DS    0H                 EQUAL                                 32200014
FBMIR    DS    0H                 MINUS                                 32300014
FBSLR    DS    0H                 SLASH                                 32400014
FBCOR    DS    0H                 COMMA                                 32450014
         BAL   R9,FBTXT           TEXT ROUTINE                          32500014
         B     FBTRR              RETURN TO TRANSLATE                   32600014
         SPACE 2                                                        32700014
*                                                                       32800014
*   ROUTINE TO PROCESS DELIMITERS  (BLANK AND COMMA)                    32900014
*                                                                       33000014
FBDEL    DS    0H                 DELIMITERS                            33100014
FBBKR    DS    0H                 BLANK                                 33200014
         SCSW  O,FBLITRLZ,FBSPR   TRANSFER IF IN A LITERAL -SET BY SCAN 33400014
         BAL   R9,FBTXT           MOVE TEXT                             33500014
         LR    R7,R1                                                    33550014
         BCTR  R7,R0                                                    33600014
         BAL   R9,FBTXT           MOVE DELIMITER TO INTBUF              33800014
*                                                                       33900014
*   RESET POINTERS TO CAUSE SCAN RTN TO SCAN INTBUF                     34000014
*                                                                       34100014
FBDEL02  DS    0H                                                       34150014
         LA    R2,INTBUF                                                34200014
         ST    R2,CSTRP                                                 34300014
         LA    R2,INTBUF+ITBL+1   NEW END OF TEXT                       34400014
         ST    R2,CENDP                                                 34500014
         SCSW  C,RPRSWW           CLEAR RT PAREN SW                     34550014
         TM    SWY2,DASBIT         DONE ANY SUBSTITUTION?       YM01590 34555002
         BZ    FBRET               NO, RETURN TO SCAN           YM01590 34560002
         NI    SWY2,255-DASBIT     YES, RESET BIT AND CONTINUE  YM01590 34565002
         TM    IWAJMSGL,AOMSGLV1   MSGLEVEL=1?                   Y02668 34570502
         BZ    FBRET                                               I68  34571018
         LA    R0,BUFLNGTH   GET SIZE OF WORK BUFFER            YM01591 34571502
         GETMAIN R,LV=(0)    GET 216 BYTE BUFFER                YM01591 34572002
        LR    R9,R1         R9=PTR BEG WKBUF                       I68  34572518
         MVC   0(ITBMSGL,R9),INTBUF-ITBMSGL  MSG HDR TO WKBUF      I68  34573018
         LA    R5,ITBMSGL(R9)  R5 PTR TO NEXT FREE SPACE           I68  34573518
         SR    R3,R3                                               I68  34574018
         L     R2,DELPTR     PTR TO STMT PTR                       I68  34574518
         IC    R3,LISTPTR(R2)     OFFSET TO OPERAND FIELD          I68  34575018
         L     R2,0(R2)           ADDR OF STMT                     I68  34575518
         AR    R2,R3         R2 PTR TO OPER TO BE MOVED            I68  34576018
         LA    R4,79                                               I68  34576518
         SR    R4,R3         LENGTH-1 OF FLD TO BE MOVED           I68  34577018
         EX    R4,MOVE1                                            I68  34577518
         CLC   FBDUMM(5),0(R5)     IS THIS DUMM= KEYWORD       @ZA18227 34577603
         BNE   FBDEL03             NO, BRANCH AROUND           @ZA18227 34577703
         MVI   4(R5),C'Y'          YES, OVERLAY '=' WITH 'Y'   @ZA18227 34577803
*                                  FOR SUBSTITUTION MSG        @ZA18227 34578303
FBDEL03  L     R4,CBSYP      PTR TO 1ST &                               34578403
         SR    R4,R2         LENTH OF 1ST OPERAND IN PROC          I68  34578803
         AR    R5,R4                                               I68  34579018
         SR    R3,R3                                               I68  34579518
         IC    R3,INTBUF     TEXT LENGTH                           I68  34580018
         LR    RF,R3              --PUT ACTUAL LENGTH IN RF        I68  34582518
         SPACE                                                          34583018
FBDEL04  DS    0H                                                  I68  34583518
         BCTR  RF,R0               DECREMENT FOR MOVE              I68  34584018
         EX    RF,MOVE2           MOVE SUBSTITUTED TEXT            I68  34584518
         LA    R4,ITBMSGL(R3,R4)   CALCULATE LENGTH OF MSG NOW     I68  34585018
*                                           IN WORKBUFFER          I68  34585518
         EJECT                                                          34586020
**************************************************************** A37550 34586420
*                                                              * A37550 34586520
*        APAR 37550 CONCERNED THE INCOMPLETE REPRESENTATION    * A37550 34586920
*        OF SYMBOLIC PARAMETER SUBSTITUTION IN MESSAGE IEF653I * A37550 34587020
*        DUE TO THE LENGTH OF THE SUBSTITUTIONS.               * A37550 34587420
*        THE CODE ADDED FOR APAR 37550 WILL CREATE AS MANY     @ZA08218 34587503
*        IEF653I MESSAGE NEEDED TO SHOW ALL SUBSTITUTIONS MADE.@ZA08218 34587603
*                                                              * A37550 34588020
**************************************************************** A37550 34588420
         SPACE 2                                                        34588520
         LR    R7,R9         SAVE PTR TO WORKBUFFER.             A37550 34588920
         LA    R5,MSGMAX           120 COMPERAND                 A37550 34589003
         CR    R5,R4               MSG LONGER THAN 120 BYTES     A37550 34589103
         BNL   FBNORMAL      NO-CONTINUE                         A37550 34589520
         OI    SRCHSW1,SRCHF5 SET SECOND MSG INDICATOR           A37550 34589920
         LA    R2,TWO7       SET COUNTER.                        A37550 34590020
LOOP     LA    R3,0(R2,R9)   SET UP TO SCAN WORKBUFFER.          A37550 34590420
         CLI   0(R3),FCOMMA  IS CHARACTER A COMMA .              A37550 34590520
         BE    SETUP         YES-SAVE POINTER TO CHARACTER.      A37550 34590920
         CLI   0(R3),FPERIOD IS CHARACTER A PERIOD.              A37550 34591020
         BE    SETUP         YES-SAVE POINTER TO CHARACTER.      A37550 34591420
         CLI   0(R3),FEQUAL  IS CHARACTER AN EQUAL SIGN.         A37550 34591520
         BNE   BACK          NO,LOOK AT NEXT CHARACTER.          A37550 34591920
SETUP    LR    RF,R3         ADDRESS OF SEPARATOR.               A37550 34592020
BACK     CR    R2,R5         REACHED 120 YET.                    A37550 34592403
         BNL   AROUND                                            A37550 34592803
         LA    R2,ONE(R2)    INCREMENT COUNTER.                  A37550 34592920
         B     LOOP          CONTINUE SCAN                       A37550 34593020
AROUND   SR    RF,R9         LENGTH OF FIRST MESSAGE             A37550 34593403
NEXTMSG  EQU   *                                               @ZA08218 34593703
         LA    R3,0(RF,R9)   BEGINNING OF NEXT MESSAGE.          A37550 34593803
         LA    R2,TWO7       SUBTRACT HEADER LENGTH FOR          A37550 34597903
         SR    R3,R2         ADDRESS OF BEGINNING OF NEXT MSG.   A37550 34599903
         SR    R4,RF         LENGTH OF NEXT MESSAGE.             A37550 34600603
         STC   RF,IWAMSLEN   STORE LENGTH OF MESSAGE.            A37550 34602020
         B     FBDEL02X                                          A37550 34604020
FBNORMAL STC   R4,IWAMSLEN   STORE ACTUAL LENGTH.                A37550 34604420
FBDEL02X  DS   0H                                                A37550 34604820
         SR    R2,R2                                             A37550 34605220
         OI    AOSW1,AOVFBSW       SET VFB SWITCH FOR VGM        Y02668 34605402
         IEFSAVER SAVEPTR                                        A37550 34605620
         L     RF,IEFVGMV     MESSAGE MODULE ADDRESS             A37550 34605720
         BALR  RE,RF          PUT MESSAGE IN SMB                 A37550 34605820
         IEFRELSE SAVEPTR                                        A37550 34605920
         TM    SRCHSW1,SRCHF5   SECOND MESSAGE TO CONSTRUCT.     A37550 34613620
         BZ    FBMSGOUT       NO - FREE WORKBUFFER AND RETURN.   A37550 34615620
         MVC   0(ITBMSGL,R3),INTBUF-ITBMSGL  MOVE IN HEADER.     A37550 34617620
         LR    R9,R3         UPDATE PTR TO WORKBUF MSG AREA.     A37550 34618020
         LA    R4,TWO7(R4)   INCLUDE HEADER IN MSG LENGTH.       A37550 34620020
         LA    R5,MSGMAX          MAXIMUM LENGTH OF MESSAGE    @ZA08218 34620103
         CR    R4,R5              ANOTHER MSG AFTER CURRENT MSG@ZA08218 34620203
         BH    SETUPMSG           SET FOR CURRENT & NEXT MSG   @ZA08218 34620603
         NI    SRCHSW1,SRCHCLR-SRCHF5 NEXT MESSAGE INDICATOR OFF A37550 34620703
         B     FBNORMAL      WRITE LAST MESSAGE.               @ZA08218 34620803
SETUPMSG EQU   *                                               @ZA08218 34622903
         LR    RF,R5              MAXIMUM MSG LENGTH FOR CURRENT        34623803
*                                 MESSAGE                      @ZA08218 34624703
         B     NEXTMSG                                         @ZA08218 34625603
FBMSGOUT DS    0H                                                A37550 34626503
         LR    R1,R7           PTR TO WORKBUFFER                 A37550 34627403
         LA    R0,BUFLNGTH        GET SIZE OF WORK BUFFER       YM01591 34628303
         FREEMAIN R,LV=(0),A=(1)                                   I68  34629220
         MVI   IWAMSLEN,X'5A'      RESTORE LENGTH TO NINETY     YM02715 34636902
         B     FBRET              RETURN TO SCAN ROUTINE                34644620
MOVE1    MVC   0(0,R5),0(R2)  MOVE OPERAND FLD FROM PROC TO WKBUF  I68  34652320
MOVE2    MVC   0(0,R5),INTBUF+1  OVERLAY WITH SUBSTIT STRING       I68  34660018
         EJECT                                                          34700014
*                                                                       34800014
*   SELECTS BITS TO TEST FOR PROC IN KEYTAB                             34900014
*        INPUT (R6= ONE BYTE KEY)                                       35000014
*        OUTPUT (R2= BIT PATTERN)                                       35100014
*               (R6= OFFSET INTO TABLE)                                 35200014
*        R9 = RETURN REG                                                35300014
*                                                                       35400014
FBI      DS    0H                                                       35500014
         LA    R3,X'07'                                                 35600014
         NR    R3,R6                                                    35700014
         LA    R2,X'80'                                                 35800014
         SRL   R2,0(R3)                                                 35900014
         SRL   R6,3                                                     36000014
         BR    R9                                                       36100014
         SPACE 2                                                        36200014
*                                                                       36300014
*   SPECIAL CHARACTER CHECK ROUTINE                                     36400014
*                                                                       36500014
FBSCR    DS    0H                                                       36600014
         LR    RA,R1              SAVE DELIMITER                        36800014
         LR    R5,R1                                                    36900014
         LR    R1,R7              STRING POINTER                        37000014
         SR    R5,R7              COMPUTE STRING LENGTH                 37060014
         BZ    FBSCR01            TRANSFER NULL VALUE                   37120014
         BCTR  R5,R0                                                    37200014
         L     R3,FATRP           ADDRESS OF TRANSLATE TABLE            37300014
         EX    R5,FBTRR04         EXECUTE TRAN                          37400014
         BC    7,FBSCR02          SPECIAL CHARS                         37500014
FBSCR01  DS    0H                                                       37650014
         LR    R1,RA              RESTORE DELIMITER PTR                 37670014
         BR    R9                 RETURN - NO SPECIAL CHARACTERS        37700014
FBSCR02  DS    0H                                                       37800014
         LA    R2,ERMSB04         ERROR MSG NUMBER                      37900014
         B     FBERR0                                                   38000014
         EJECT                                                          38100014
*********************************************************************** 38200014
*                                                                     * 38300014
*   TEXT ROUTINE    MOVES TEXT TO INTBUF FROM EITHER                  * 38400014
*                   THE VALUE FIELD IN SYMBUF OR                      * 38500014
*                   FROM INPUT STATEMENT                              * 38600014
*        R1 = DELIMITER PTR                                           * 38700014
*        R4 = CURRENT SYMBUF ENTRY                                    * 38800014
*        R7 = CHARACTER STRING PTR                                    * 38900014
*        R9 = RETURN ADDR                                             * 39000014
*                                                                     * 39100014
*********************************************************************** 39200014
         SPACE                                                          39300014
FBTXT    DS    0H                                                       39400014
         SCSW  O,AMPSWZ,FBTXT10   TRANSFER IF SYMBOLIC                  39500014
*                                                                       39600014
*   CHECK FOR NULL VALUE                                                39700014
*                                                                       39800014
         CLR   R7,R1              NULL                                  39900014
         BNE   FBTXT02            NO  - TRANSFER                        40000014
         LA    R1,1(R1)                                                 40100014
         BR    R9                 YES - RETURN                          40200014
FBTXT02  DS    0H                                                       40300014
         LR    R2,R7              NO  - PTR FOR MOVE RTN                40400014
         LR    R3,R1                                                    40500014
         SR    R3,R7              LENGTH FOR MOVE                       40600014
         BAL   R5,FBMVC           MOVE TEXT TO INTBUF                   40700014
         B     FBTXT22            RETURN                                40800014
*                                                                       40900014
*   ENTRY TO SEARCH TABLE FOR SYMBOLIC                                  41000014
*                                                                       41100014
FBTXT10  DS    0H                                                       41200014
         BAL   R5,FBSCH           GO TO TABLE SEARCH ROUTINE            41300014
         LTR   RF,RF              SYMBOLIC FOUND                        41400014
         BNE   FBTXT12            YES - TRANSFER                        41500014
*                                 NO - MOVE SYMBOLIC TO INTBUF          41530014
         BCTR  R7,R0              POINTER TO AMPERSAND                  41560014
         LR    R2,R7              POINTER FOR MOVE RTN                  41590014
*                                 NOTE - RA = LENGTH OF SYMBOLIC        41620014
         LA    R3,1(RA)           GET LENGTH OF SYMBOLIC(INCLUDING &)   41650014
*                                       FOR MOVE RTN                    41680014
         B     FBTXT16            GO MOVE SYMBOLIC TO INTBUF            41710014
FBTXT12  DS    0H                                                       41800014
         NI    1(R4),255-HONE     HIT - CLEAR HIGH ORDER BIT LP BYTE    41900014
         OI    SWY2,DASBIT      INDICATE SUBSTITUTION OCCURRED  YM01590 41950002
*                                                                       42000014
*   GET POINTER TO VALUE IN R2 FOR MOVE ROUTINE                         42100014
*       AND LENGTH OF TEXT IN R3                                        42200014
*                                                                       42300014
*                                 LENGTH OF PARAM IN RA                 42400014
         LA    R2,2(R4,RA)        PTR TO LV BYTE                        42500014
         IC    RA,0(R2)           LV IN RA                              42600014
         LTR   R3,RA              IS VALUE A NULL (R3=LENGTH FOR MOVE)  42700014
         BZ    FBTXT20            YES - RETURN                          42800014
         LA    R2,1(R2)           NO  - PTR TO VALUE IN R2              42900014
FBTXT16  DS    0H                                                       42950014
         BAL   R5,FBMVC           MOVE RTN                              43000014
FBTXT20  DS    0H                                                       43100014
         SCSW  C,AMPSWZ           CLEAR SW                              43200014
*                                                                       43300014
FBTXT22  DS    0H                                                       43400014
         LR    R7,R1                                                    43500014
         LA    R1,1(R1)                                                 43700014
         BR    R9                                                       43800014
         SPACE 2                                                        43900014
*                                                                       44000014
*********************************************************************** 44100014
*                                                                     * 44200014
*   MOVE ROUTINE   GETS POINTER TO NEXT OPEN BYTE IN INTBUF           * 44300014
*                  UPDATES INTBUF COUNT BYTE                          * 44400014
*                                                                     * 44500014
*        REGS ON ENTRY        R3 = LENGTH OF TEXT TO BE MOVED         * 44600014
*                             R2 = PTR TO TEXT                        * 44700014
*                             R5 = RETURN REG                         * 44800014
*                                                                     * 44900014
*********************************************************************** 45000014
         SPACE                                                          45100014
FBMVC    DS    0H                                                       45200014
         SCSW  O,FBFLUSHZ,FBMVC01 TRANSFER IF IN FLUSH MODE             45250014
         SR    R6,R6                                                    45300014
         IC    R6,INTBUF          LENGTH OF TEXT IN INTBUF              45400014
         LA    RA,INTBUF+1(R6)    FIRST OPEN BYTE                       45500014
         AR    R6,R3                                                    45600014
         CH    R6,FBMVC06         DOES LENGTH EXCEED MAX                45700014
         BH    FBMVC04            YES - TRANSFER                        45800014
*                                 NO  - UPDATE LENGTH BYTE              45900014
         STC   R6,INTBUF          NEW LENGTH BYTE                       46000014
         BCTR  R3,R0              DECREMENT FOR EXECUTE                 46100014
         EX    R3,FBMVC02                                               46200014
FBMVC01  DS    0H                                                       46250014
         BR    R5                                                       46300014
FBMVC02  DS    0H                                                       46400014
         MVC   0(0,RA),0(R2)                                            46500014
FBMVC04  DS    0H                                                       46600014
         LA    R2,ERMSB05                                               46700014
         MVI   MSGKEY,SMSGS       SECONDARY MSG NUMBER                  46750014
         B     FBERR                                                    46800014
FBMVC06  DS    0H                                                       46900014
         DC    AL2(ITBL)                                                47000014
         EJECT                                                          47100014
*********************************************************************** 47200014
*                                                                     * 47300014
*   ROUTINE TO SEARCH SYMBUF FOR SYMBOLIC PARAMETER                   * 47400014
*                                                                     * 47500014
*        R1 = PTR TO DELIMITER                                        * 47600014
*        R4 = CURRENT ENTRY IN AMPBUF                                 * 47700014
*        R5 = RETURN REG                                              * 47800014
*        R7 = PTR TO FIRST CHARACTER OF SEARCH ARGUMENT               * 47900014
*                                                                     * 48000014
*********************************************************************** 48100014
         SPACE                                                          48200014
FBSCH    DS    0H                                                       48300014
         LR    RA,R1              SAVE DELIMITER PTR                    48400014
         SR    RA,R7              LENGTH OF FIELD IN RA                 48500014
         BZ    FBSCH14            ZERO LENGTH - GO INDICATE NO HIT      48600014
*                                                                       48700014
*   CHECK IF SYMBUF HAS TTR                                             48800014
*                                                                       48900014
FBSCH01  DS    0H                                                       49000014
         OC    SYMTTR(FBFOUR),SYMTTR  IS THERE A TTR FOR SYMBUF? Y02621 49100002
         BZ    FBSCH14            NO  - RETURN                   Y02621 49200002
*                                                                       49400014
*   CHECK IF FIRST SYMBUF IS IN CORE                                    49500014
*                                                                       49600014
FBSCH02  DS    0H                                                       49700014
         CLC   SYMBUF(4),SYMTTR   IS THIS THE FIRST SYMBUF              49800014
         BE    FBSCH04            YES - TRANSFER                        49900014
         L     R2,SYMTTR          NO  - GET TTR OF FIRST BUFFER         49920014
         OC    SYMBUF(FBFOUR),SYMBUF  DOES THIS ONE HAVE A TTR?  Y02621 49940002
         BZ    FBSCH05            NO  - TRANSFER TO READ ONLY           49960002
*                                 YES - WRITE THIS ONE OUT              49980014
FBSCH03  DS    0H                                                       50000014
         L     R0,SYMBUF          TTR OF THIS BUFFER                    50020014
         MVI   QPARM+QMPOP-QMNAM,QMWRTE                                 50040014
         MVI   QPARM+QMPNC-QMNAM,RECNO1 SET WRITE OF 1 REC.     YM00370 50050002
         BAL   R6,FBQMAN          WRITE OUT THIS BUFFER                 50060014
FBSCH05  DS    0H                                                       50080014
         LR    R0,R2              TTR OF BUFFER TO BE READ IN           50100014
         MVI   QPARM+QMPOP-QMNAM,QMREAD                                 50200014
         MVI   QPARM+QMPNC-QMNAM,RECNO1 SET READ  OF 1 REC.     YM00370 50250002
         BAL   R6,FBQMAN          GO TO Q MANAGER INTERFACE             50300014
*                                                                       50400014
*   CURRENT SYMBUF IN OK - NOW SEARCH FOR SYMBOLIC                      50500014
*                                                                       50600014
FBSCH04  DS    0H                                                       50700014
         LA    R4,SYMBUF+8        FIRST ENTRY                           50800014
         SR    R3,R3                                                    50900014
         LA    R2,HONE+1                                                51000014
         LCR   R2,R2                                                    51100014
FBSCH06  DS    0H                                                       51200014
         CLI   0(R4),0            IS THERE AN ENTRY                     51300014
         BE    FBSCH12            NO  - TRANSFER                        51400014
         IC    R3,1(R4)           YES - GET LP BYTE                     51500014
         NR    R3,R2              CLEAR HIGH ORDER FLAG BIT             51600014
         CLR   RA,R3              IS LENGTH SAME AS SEARCH ARGUMENT     51700014
         BNE   FBSCH08            NO  - TRANSFER   DO NOT COMPARE       51800014
         BCTR  R3,R0              DECREMENT LENGTH FOR EXECUTE          51900014
         EX    R3,FBSCH10         COMPARE - IS THIS THE SYMBOLIC        52000014
         BE    FBSCH16            THIS IS THE ONE                       52100014
FBSCH08  DS    0H                 ENTRY FOR NO HIT                      52200014
         IC    R3,0(R4)           LENGTH OF ENTRY IN SYMBUF             52300014
         AR    R4,R3              R4 POINTS TO NEXT ENTRY               52400014
         B     FBSCH06                                                  52500014
FBSCH10  DS    0H                                                       52600014
         CLC   2(0,R4),0(R7)                                            52700014
*                                                                       52800014
*   IS THERE ANOTHER SYMBOLIC  PARAM TABLE BUFFER                       52900014
*                                                                       53000014
FBSCH12  DS    0H                                                       53100014
         OC    SYMBUF+FBFOUR(FBFOUR),SYMBUF+FBFOUR   IS THE NEXT Y02621 53200002
*              SYMBUF POINTER IN SYMBUF ZERO?                    Y02621 53240002
         BZ    FBSCH14            YES- NO NEXT SYMBUF EXISTS     Y02621 53280002
         L     R2,SYMBUF+4        YES- TTR OF NEXT BUFFER               53320014
         B     FBSCH03            GO WRITE THIS ONE OUT, READ IN NEXT   53400014
*                                                                       53500014
*   SYMBOLIC NOT FOUND - INDICATE NO HIT - RF = 0                       53600014
*                                                                       53700014
FBSCH14  DS    0H                                                       53800014
         SR    RF,RF                                                    53900014
         BR    R5                 RETURN                                54000014
*                                                                       54100014
*   SYMBOLIC FOUND     - INDICATE HIT    - RF = 4                       54200014
*                                                                       54300014
FBSCH16  DS    0H                                                       54400014
         LA    RF,4                                                     54500014
         BR    R5                 RETURN - R4 IS PTR TO SYMBUF ENTRY    54600014
         EJECT                                                          54700014
*********************************************************************** 54800014
*                                                                     * 54900014
*   SYMBOLIC PARAMETER TABLE BUILD ROUTINE                            * 55000014
*                                                                     * 55100014
*        R1= DELIMITER POINTER                                        * 55200014
*        R7= POINTER TO FIRST CHAR                                    * 55300014
*        R5= RETURN REG                                               * 55400014
*        R4= CURRENT SYMBUF ENTRY                                     * 55500014
*                                                                     * 55600014
*********************************************************************** 55700014
         SPACE                                                          55800014
FBBLD    DS    0H                                                       55900014
         SCSW  O,FBFLUSHZ,FBBLD26 TRANSFER IF FLUSH MODE                55950014
         LR    RA,R1              DELIM PTR                             56000014
         SR    RA,R7              LENGTH OF FIELD                       56100014
         BZ    FBBLD26            ZERO LENGTH - RETURN                  56150014
         SR    R2,R2                                                    56200014
         IC    R2,0(R4)           LE BYTE                               56300014
         LA    R3,4(R2,RA)        COMPUTE NEW END OF TEXT IN SYMBUF     56400014
         AR    R3,R4              ADD PTR TO CURRENT ENTRY              56450014
         LA    R6,SYMBUF+175      END OF BUFFER                         56500014
         CLR   R3,R6              IS THERE ROOM FOR TEXT                56600014
         BNH   FBBLD20            YES - TRANSFER                        56700014
*                                                                       56800014
*   NO ROOM IN THIS BUFFER  -  WRITE IT OUT, CHAIN BUFFERS,             56900014
*                              INITIALIZE ANOTHER BUFFER                57000014
*                                                                       57100014
         CLI   0(R4),0            IS THIS AN ENTRY FOR SYMBOLIC         57200014
         BNE   FBBLD10            NO  - TRANS TO PROCESS 'VALUE' SPILL  57300014
*                                 YES - PROCESS 'PARAM' SPILL           57400014
*                                                                       57500014
*   SPILL ROUTINE FOR SYMBOLIC 'PARAM'                                  57600014
*                                                                       57700014
         BAL   R9,FBCHN           GO TO CHAIN RTN                       57800014
         XC    SYMBUF+4(172),SYMBUF+4 CLEAR ALL BUT TTR FIELD           57900014
         LA    R4,SYMBUF+8        INITIALIZE CURRENT ENTRY PTR          58000014
         B     FBBLD20            GO TO MOVE TEXT                       58100014
*                                                                       58200014
*   SPILL ROUTINE FOR 'VALUE'          R2 = CONTENTS OF LE BYTE         58300014
*                                                                       58400014
FBBLD10  DS    0H                                                       58500014
         MVI   0(R4),0            ZERO LE BYTE IN SPILLED BUFFER        58600014
         BAL   R9,FBCHN           GO TO CHAIN RTN                       58700014
         STC   R2,SYMBUF+8         LE BYTE                              58800014
         BCTR  R2,R0                                                    58900014
         EX    R2,FBBLD12         MOVE IN LP BYTE AND PARAM             59000014
         LA    R4,SYMBUF+8        INITIALIZE CURRENT ENTRY              59100014
         LA    R9,1(R2,R4)        FIRST BYTE TO BE CLEARED              59200014
         LA    R3,SYMBUF+174                                            59300014
         SR    R3,R9              DECREMENTED COUNT IN R3               59400014
         EX    R3,FBBLD14         CLEAR REMAINDER OF BUFFER             59500014
         B     FBBLD20            GO TO MOVE TEXT                       59600014
FBBLD12  DS    0H                                                       59700014
         MVC   SYMBUF+9(0),1(R4)                                        59800014
FBBLD14  DS    0H                                                       59900014
         XC    0(0,R9),0(R9)                                            60000014
*                                                                       60100014
*                                                                       60200014
*   BUFFERS OK - MOVE TEXT TO SYMBUF     RA = LENGTH OF FIELD           60300014
*                                                                       60400014
FBBLD20  DS    0H                                                       60500014
         SR    R3,R3                                                    60600014
         IC    R3,0(R4)           LE BYTE                               60700014
         LTR   R3,R3              IS LE BYTE ZERO  (IS THIS PARAM TEXT) 60800014
         BNE   FBBLD22            NO  - TRANSFER FOR VALUE              60900014
         STC   RA,1(R4)           YES - ENTER LP BYTE                   61000014
         LA    R6,3(RA)           COMPUTE LENGTH OF ENTRY (LE) BYTE     61060014
*                                      ( LE INCLUDES A NULL LV BYTE)    61120014
         STC   R6,0(R4)           ENTER LE BYTE                         61200014
         LA    R6,2(R4)           PARAM FIELD PTR                       61300014
         B     FBBLD24                                                  61400014
FBBLD22  DS    0H                 ENTRY FOR VALUE                       61500014
         LA    R6,0(RA,R3)        COMPUTE NEW LENGTH OF ENTRY           61600014
         STC   R6,0(R4)           NEW LE BYTE                           61700014
         LA    R6,0(R3,R4)                                              61760014
         BCTR  R6,R0              PTR TO NEW LV BYTE                    61820014
         STC   RA,0(R6)           NEW LV BYTE                           61900014
         LA    R6,1(R6)           PTR TO VALUE FIELD                    62000014
FBBLD24  DS    0H                                                       62100014
         BCTR  RA,R0                                                    62200014
         EX    RA,FBBLD30         MOVE TEXT TO SYMBUF                   62300014
         MVI   INTBUF,0           ZERO COUNT BYTE                       62400014
FBBLD26  DS    0H                                                       62450014
         BR    R5                                                       62500014
FBBLD30  DS    0H                                                       62600014
         MVC   0(0,R6),0(R7)                                            62700014
         EJECT                                                          62800014
*                                                                       62900014
*   BUFFER CHAIN ROUTINE       WRITES CURRENT BUFFER TO QUEUE,          63000014
*                              CHAINS BUFFERS                           63100014
FBCHN    DS    0H                                                       63200014
         MVC   SYMBUF+4(4),TNEXT  TTR OF NEXT BUFFER                    63300014
         L     R0,SYMBUF          TTR OF THIS BUFFER                    63400014
         MVI   QPARM+QMPOP-QMNAM,QMWRTA SET WRITE AND ASSIGN.   YM00370 63420002
         MVI   QPARM+QMPNC-QMNAM,RECNO1 SET WRITE OF 1 REC.     YM00370 63440002
         OI    QPARM+QMPCM-QMNAM,X'10' SET ASSIGN OF 1 REC.     YM00370 63460002
         BAL   R6,FBQMAN          GO TO QUEUE INTERFACE RTN             63500014
         OI    AOSW2,X'80'   INDICATE SYMBOLIC WRITE TO SWA    @ZA05366 63550003
*                                                                       63600014
*   INITIALIZE NEW BUFFER                                               63700014
*                                                                       63800014
         MVC   SYMBUF(4),TNEXT    CHAIN                                 63900014
         MVC   TNEXT(4),0(R3)     SAVE ASSIGNED TTR                     64000014
         XC    SYMBUF+4(4),SYMBUF+4 CLEAR CHAIN TTR FIELD               64100014
         BR    R9                                                       64200014
         EJECT                                                          64300014
*********************************************************************** 64400014
*                                                                     * 64500014
*   QUEUE MANAGER INTERFACE ROUTINE                                   * 64600014
*        R6 = RETURN REG                                              * 64700014
*        R0 = TTR OF RECORD TO READ OR WRITE                          * 64800014
*                                                                     * 64900014
*********************************************************************** 65000014
         SPACE                                                          65100014
FBQMAN   DS    0H                                                       65200014
         LA    R3,QLINKWA          GET ADDR OF EXTERNAL PARMLIST Y02668 65400002
         ICM   R3,8,QPARM+QMPNC-QMNAM INSERT RECORD COUNT, TO   YM00370*65430002
                                     AVOID OVERLAYING IT.       YM00370 65440002
         ST    R3,QPARM+QMPNC-QMNAM SAVE CT AND LISTPTR IN QMPA YM00370 65450002
         ST    R0,4(R3)           TTR THIS RECORD (FOR READ AND WRITE)  65500014
         MVI   FBSVN(R3),SYMBUFID  ID USED FOR WRITE,IGNORED     Y02621 65530002
*                                  FOR READ.ONLY WRITE SYMBUF    Y02621 65560002
         LA    R0,SYMBUF                                                65600014
         ST    R0,0(R3)           POINTER TO RECORD ( READ AND WRITE)   65700014
FBQMAN02 DS    0H                 ENTRY FOR ASSIGN                      65720014
         ST    R1,SAVEP           SAVE R1                               65750014
         IEFSAVER  SAVEPTR                                              65800014
         L     RF,FBIEFVHQ                                              65850014
         BALR  RE,RF              QUEUE MANAGER                         65900014
         IEFRELSE  SAVEPTR                                              66000014
         L     R1,SAVEP           RESTORE R1                            66050014
         BR    R6                 RETURN                                66100014
FBDUMM   DC    C'DUMM='                                        @ZA18227 66150003
FBIEFVHQ DC    V(IEFVHQ)          QUEUE MANAGER                         66200014
IEFVGMV  DC    V(IEFVGM)      MESSAGE MODULE                       I68  66220018
         EJECT                                                          66250014
*********************************************************************** 66300014
*                                                                     * 66400014
*   ERROR RETURN         R2 = ERROR MESSAGE NUMBER                    * 66500014
*                                                                     * 66600014
*********************************************************************** 66700014
         SPACE                                                          66800014
FBERR0   DS    0H                                                       66830014
         MVI   INTBUF,0           INDICATE NO TEXT IN INTBUF            66860014
FBERR    DS    0H                                                       66900014
         L     RE,FERRP           PTR TO SCAN ERROR RTN                 67000014
         ST    RE,12(RD)                                                67100014
         ST    R2,28(RD)          ERROR MSG NUMBER                      67200014
*                                                                       67600014
*   RETURN TO SCAN                                                      67700014
*                                                                       67800014
FBRET    DS    0H                                                       67900014
         SCSW  C,FBFLUSHZ         CLEAR FLUSH SW                        67950014
FBRET02  DS    0H                                                       67970014
         RETURN (14,12)                                                 68000014
*                                                                       68100014
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 70100002
         END                                                            72400014
./  ADD  SSI=80550284,NAME=IEFVGI
         TITLE 'IEFVGI - IEFQMNGR'                                      00020000
         IEFQMNGR                                                       00040000
         TITLE 'IEFVGI - IWA'                                           00060000
         IEFCOMWA                                                Y02668 00090002
         IEFVMIWA                                                       00092002
         TITLE 'IEFVGI - AWA'                                           00100000
AWA      DSECT                                                          00120000
         USING AWA,RA                                                   00140000
         IEFVMAWA                                                       00160000
         TITLE 'IEFVGI - CSECT'                                         00180000
IEFVGI   CSECT                                                          00200000
*********************************************************************** 00220000
*                                                                     * 00240000
*        INPUT TO THIS ROUTINE.                                       * 00260000
*                                                                     * 00280000
*              R1 = POINTS TO ENTRY TO BE PLACED IN DICTIONARY.       * 00300000
*              RA = ADDRESS OF AUXILIARY WORK AREA.                   * 00320000
*              RC = ADDRESS OF INTERPRETER WORK AREA.                 * 00340000
*              RD = ADDRESS OF CURRENT REGISTER SAVE AREA.            * 00360000
*              RE = RETURN ADDRESS.                                   * 00380000
*                                                                     * 00400000
*********************************************************************** 00420000
*                                                                       00440000
         STM   14,12,12(13)       SAVE REGISTERS.                       00460000
         SPACE                                                          00480000
         BALR  RB,0               REG 11 IS THE BASE REGISTER           00500000
         USING *,RB                    OF THE INPUT ROUTINE.            00520000
*****************************************************************Y02028 00525002
* MODULE TRACE CODE - FOR TESTING.                               Y02028 00530002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02028 00535002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02028 00540002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02028 00545002
         DC    C'VGI '             MOD ID USED BY TRACE.         Y02028 00550002
* TRACE RETURNS HERE.                                            Y02028 00555002
*****************************************************************Y02028 00560002
         B     VGI                 BR AROUND ID.                 Y02668 00570002
         MODID BR=NO               MODULE IDENT.                 Y02668 00580002
*        DC    C'REL4'              FUNCTION ID AND            @Z40MPTH 00590003
*        DC    C'02'   LEV # (RACF)                            @Z40RPSM 00594003
         DC    C'03'   LEV # (MERGE SU4,10,16 CODE TO 037 PTF) @ZA27750 00598003
VGI      DS    0H                                                Y02668 00610002
         USING AWA,RA             AWA ADDRESS                           00660000
         SPACE                                                          00680000
         LA    R9,SREFB           ADDRESS OF INPUT DICTIONARY.          00700000
         SR    R6,R6              SET R6 FOR IC INSTRUCTIONS.           00720000
         SR    R8,R8              R8 = ZERO FOR COMPARES & ZEROEING.    00740000
         LA    R7,7(R9)           POINT AT FIRST ENTRY IN TABLE.        00760000
         TM    SWD,DCTFST         IS THIS THE FIRST DICT ENTRY.         00780000
         BO    GI1                NO. GO TO POINT TO NEXT ENTRY SLOT.   00800000
*                                                                       00820000
*   FIRST DICTIONARY ENTRY.  SET DCTFST, ZERO SREFB TABLE AND ZERO      00840000
*        TSREFB SLOT IN IWA. ALSO, SET TABLE ID = 8.                    00860000
*                                                                       00880000
         OI    SWD,DCTFST         SET BIT INDICATING FIRS DICT ENTRY.   00900000
         XC    0(176,R9),0(R9)    ZERO DICT 1.                          00920000
         MVI   3(R9),GIDCTID      SET TABLE ID.                         00940000
         ST    R8,TSREFB          ZERO TSREFB SLOT IN IWA.              00960000
         B     GI2                GO TO STORE ENTRY.                    00980000
*                                                                       01000000
*   NOT FIRST ENTRY - CHAIN TO END OF DICT.                             01020000
*                                                                       01040000
GI1      DS    0H                                                       01060000
         IC    R6,0(R7)           PICK UP LENGTH OF ENTRY.              01080000
         LA    R7,0(R6,R7)        INCREMENT TO NEXT ENTRY POSITION.     01100000
         CLI   0(R7),X'00'        IS IT THE END OF TABLE.               01120000
         BNE   GI1                NO. GO TO GET NEXT ENTRY POSITION.    01140000
         SPACE                                                          01160000
*                                                                       01180000
*   END OF DICT ENTRIES - COMPUTE OVERFLOW POSSIBILITY.                 01200000
*                                                                       01220000
         IC    R6,0(R1)           GET NEW ENTRY LENGTH.                 01240000
         LA    R5,1(R6,R7)        COMPUTE NEW END ADDR+1 (TO SHOW END). 01260000
         SR    R5,R9              SUBTRACT START ADDRESS                01280000
         CH    R5,GI176           WILL ENTRY OVERFLOW TABLE.            01300000
         BH    GIOVFLW            YES. GO TO HANDLE OVERFLOW.           01320000
*                                                                       01340000
*   MOVE ENTRY TO DICTIONARY. COMPUTE RELATIVE ADDRESS.                 01360000
*                                                                       01380000
GI2      DS    0H                                                       01400000
         IC    R6,0(R1)           GET ENTRY LENGTH.                     01420000
         BCTR  R6,0               DECREMENT FOR EXECUTE INSTRUCTION.    01440000
         EX    R6,GIMVC1          MOVE NEW ENTRY TO TABLE.              01460000
         SR    R7,R9              COMPUTE RELATIVE ADDRESS OF ENTRY.    01480000
         SLL   R7,24              SHIFT REL ADDR TO 1ST BYTE.           01500000
*                                                                       01520000
*   CHECK FOR EXEC PROC STMT - STORE REL ADDRESS AND ZERO TTR.          01540000
*                                                                       01560000
         CLI   1(R1),GIPROC       IS IT AN EXEC PROC ENTRY.             01580000
         BNE   GI3                NO. GO TO CHECK FOR EXEC PGM.         01600000
         SPACE                                                          01620000
         ST    R7,RELPROC         SET PROC REL ADDR & ZERO TTR IN IWA.  01640000
         B     GIEXIT             GO TO EXIT.                           01660000
*                                                                       01680000
*   CHECK FOR EXEC PGM STMT - STORE REL ADDRESS AND ZERO TTR.           01700000
*                                                                       01720000
GI3      CLI   1(R1),GIPGM        IS IT AN EXEC PGM ENTRY.              01740000
         BNE   GI3A                    NO, GO TEST PGM/PROC             01760000
         XC    RELPROC(4),RELPROC       CLEAR LAST PROC POINTER         01780000
         B     GI4                     GO SET LAST PGM REL ADDR         01800000
        SPACE                                                           01820000
GI3A     DS    0H                                                       01840000
         CLI   1(R1),GIPPM        IS IT PGM WITHIN A PROCEDURE.         01860000
         BNE   GIEXIT             NO GO TO EXIT.                        01880000
GI4      DS    0H                                                       01900000
         ST    R7,RELPGM          SET PGM REL ADDR & ZERO TTR IN IWA.   01920000
*        FALL THRU TO EXIT                                              01940000
*                                                                       01960000
*   EXIT.                                                               01980000
*                                                                       02000000
GIEXIT   DS    0H                                                       02020000
         LM    14,12,12(13)       RESTORE REGS                          02040000
         BR    14                 EXIT                                  02060000
         SPACE 3                                                        02080000
*********************************************************************** 02100000
*                                                                     * 02120000
*        HANDLING OF DICTIONARY OVERFLOW.                             * 02140000
*                                                                     * 02160000
*********************************************************************** 02180000
GIOVFLW  DS    0H                                                       02200000
         LR    R5,R1              SAVE R1.                              02220000
*********************************************************************** 02240000
         IEFSAVER SAVEPTR         GET NEW REGIESTER SAVE AREA.          02260000
*********************************************************************** 02280000
         SPACE                                                          02300000
         LA    R4,QPARM           Q-MANAGER PARAMETER AREA              02320000
         USING IOPARAMS,R4             ADDRESSING.                      02340000
         L     R3,QMPCL           SET UP REGS FOR STORE DICT ADD & TTR. 02360000
         L     R2,GIVHQ           INTERFACE MODULE (IEFVHQ) ADDRESS.    02380000
         SPACE                                                          02400000
*                                                                       02420000
*   CHECK FOR FIRST DICT PUT OUT - ASSIGN FIRST TTR.                    02440000
*                                                                       02460000
         CL    R8,TSREFB          IS THIS THE FIRST DICTIONARY.         02480000
         BNE   GIOVFLW1           NO. GO TO CHAIN DICTS.                02500000
         MVI   QMPOP,QMASGN       INDICATE ASSIGN ONLY.                 02520000
         BALR  RE,R2              LINK TO Q-MNGR INTERFACE.             02540000
         SPACE                                                          02560000
         MVC   TSREFB(4),0(R3)    MOVE TTR TO IWA (FIRST DICT TTR SAVE) 02580000
         MVC   0(3,R9),0(R3)      ALSO MOVE TTR TO DICTIONARY.          02600000
*   FALL THRU TO CHAIN TABLES.                                          02620000
GIOVFLW1 DS    0H                                                       02640000
         MVC   4(3,R9),IWANXTSV    MOVE CHAIN SVA TO DICT BLOCK.YM02716 02660002
         SPACE                                                          02680000
*                                                                       02700000
*   CHECK VOR PROC TTR - IF NO TTR ASSIGN DICT TTR TO RELPROC.          02720000
*                                                                       02740000
         LA    RF,RELPROC         POINT TO PROC TTR IN IWA.             02760000
         BAL   RE,GITTRCK         LINK TO CHECK FOR TTR.                02780000
*                                                                       02800000
*   CHECK FOR PGM TTR - IF NO TTR ASSIGN DICT TTR TO RELPGM.            02820000
*                                                                       02840000
         LA    RF,RELPGM          POINT TO PGM TTR IN IWA.              02860000
         BAL   RE,GITTRCK         LINK TO CHECK FOR PGM TTR & MVC       02880000
*                                      DICT TTR TO RELPGM IN IWA.       02900000
*                                                                       02920000
*   WRITE AND ASSIGN DICTIONARY - MOVE CHAIN TTR TO DICT TTR - UPDATE   02940000
*        TNEXT AND CLEAR (TO ZEROES) REST OF DICT 1. POINT R7 AT        02960000
*        BEGINNING DICTIONARY ENTRY.                                    02980000
*                                                                       03000000
         ST    R9,0(R3)           MOVE DICT ADDR TO QMPCA.              03020000
         MVC   4(3,R3),0(R9)      MOVE TTR TO QMPEX.                    03040000
         MVI   DISPLID(R3),DICTRYID  BLOCK ID TO REMOTE LIST     Y02621 03050002
         SPACE                                                          03060000
         BALR  RE,R2              LINK TO QMNGR INTERFACE (IEFVHQ).     03080000
* AFTER BLOCK IS WRITTEN, CLEAR BLOCK ID IN REMOTE LIST TO       Y02621 03084002
* PREVENT INCORRECT IDENTIFICATION OF NEXT BLOCK WRITTEN. SWA    Y02621 03088002
* MGR USES  THIS ID IF NONZERO. IF ZERO, IT WILL USE ID IN BLOCK.Y02621 03092002
         MVI   DISPLID(R3),0       ZERO ID IN REMOTE LIST.       Y02621 03096002
         SPACE                                                          03100000
         MVC   0(3,R9),IWANXTSV    MOVE CHAIN SVA TO NEW BLOCK. YM02716 03120002
         SPACE                                                          03140000
         MVC   IWANXTSV(4),0(R3)   SAVE SVA FOR NEXT DICT BLOCK YM02716 03160002
         SPACE                                                          03180000
         XC    4(172,R9),4(R9)    ZERO REST OF DICT (ID STAYS).         03200000
         SPACE                                                          03220000
         LA    R7,7(R9)           POINT R7 AT 1ST ENTRY SLOT OF THIS    03240000
*                                      DICTIONARY.                      03260000
*********************************************************************** 03280000
         IEFRELSE  SAVEPTR        RELEASE NEW REGISTER SAVE AREA.       03300000
*********************************************************************** 03320000
         LR    R1,R5              RESTORE R1.                           03340000
         B     GI2                TO TO MOVE NEW ENTRY TO DICTIONARY.   03360000
         SPACE                                                          03380000
*                                                                       03400000
*   CHECK AND UPDATE RELPROC AND RELPGM.                                03420000
*                                                                       03440000
GITTRCK  DS    0H                                                       03460000
         CL    R8,0(RF)           IS THERE AN ENTRY FOR RELPROC/RELPGM  03480000
         BC    8,0(RE)            NO. - RETURN -                        03500000
         CLC   1(3,RF),GIZERO3    YES. IS THERE ALREADY A TTR ASSIGNED. 03520000
         BNE   0(RE)              YES. - RETURN -                       03540000
         MVC   1(3,RF),0(R9)      NO MOVE DICT TTR TO RELPROC/RELPGM.   03560000
         BR    RE                 RETURN.                               03580000
         SPACE 2                                                        03600000
GIMVC1   MVC   0(1,R7),0(R1)      MOVE NEW ENTRY TO DICTIONARY.         03620000
         SPACE 2                                                        03640000
*********************************************************************** 03660000
*                                                                     * 03680000
*        CONSTANTS                                                    * 03700000
*                                                                     * 03720000
*********************************************************************** 03740000
GIVHQ    DC    V(IEFVHQ)          Q-MANAGER INTERFACE.                  03760000
GI176    DC    H'176'             LENGTH OF DICTIONARY.                 03780000
GIZERO3  DC    X'000000'          RELPROC/RELPGM TTR CHECK.             03800000
GIPROC   EQU   X'80'              EXEC PROC DICT INDICATOR.             03820000
GIPGM    EQU   X'40'              EXEC PGM DICT INDICATOR.              03840000
GIPPM    EQU   X'20'               PGM WITHIN PROC INDICATOR.           03860000
GIDCTID  EQU   X'08'              DICTIONARY 1 ID.                      03880000
DISPLID  EQU   7                  DISPLACEMENT OF BLOCK ID       Y02621 03884002
DICTRYID EQU   X'25'              BLOCK ID FOR DICTIONARY RECORD Y02621 03888002
*                                                                Y02668 03892002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02028 03896002
         END                                                            03900000
./  ADD  SSI=80550285,NAME=IEFVGK
*********************************************************************** 00020000
*                                                                     * 00040002
*  MODULE NAME= IEFVGK                                                * 00090002
*  DESCRIPTIVE NAME= GET KEY/POSITIONAL UTILITY ROUTINE               * 00140002
*  COPYRIGHT= NONE                                                    * 00190002
*  STATUS= REL. 037 PTF                                       @ZA27750* 00240003
*                                                                     * 00290002
*  FUNCTION/OPERATION   THIS UTILITY ROUTINE GETS THE NEXT KEYWORD    * 00340002
*        OR POSITIONAL PARAMETER IN THE INTERNAL TEXT BUFFER FOR      * 00390002
*        THE CALLING PROCESSOR ROUTINE (IEFVDA, IEFVEA OR IEFVJA).    * 00440002
*        IT ALSO HANDLES THE GETTING OF CHAINED BUFFERS FROM DISK     * 00490002
*        WHEN A LONG JCL STATEMENT CAUSES OVERFLOW.                   * 00540002
*                                                                     * 00590002
*  NOTES                                                              * 00640002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                            * 00690002
*      DEPENDENCIES= NONE                                             * 00740002
*      RESTRICTIONS= NONE                                             * 00790002
*      REGISTER CONVENTIONS= IWASL (NAME OF AREA IN IWA WHERE         * 00800002
*                            REGISTER CONVENTIONS ARE FOUND)          * 00810002
*      PATCH-LABEL= N/A                                               * 00812002
*                                                                     * 00814002
*  MODULE TYPE= PROCEDURE                                             * 00816002
*      PROCESSOR= ASSEMBLER                                           * 00818002
*      MODULE SIZE= N/A                                               * 00818402
*      ATTRIBUTES= READ ONLY / REENTRANT / PAGED LPA                  * 00818802
*                                                                     * 00819202
*  ENTRY POINT= IEFVGK                                                * 00819602
*      PURPOSE= MAIN ENTRY                                            * 00819702
*      LINKAGE= NONE                                                  * 00819802
*      INPUT DATA= 1. PTR. TO JOB,EXEC,OR DD WORK AREA                * 00819902
*                  2. BASE REGISTER OF JOB,EXEC,OR DD WORK AREA       * 00826602
*                  3. PTR TO IWA                                      * 00828602
*                  4. PTR TO THE CURRENT REGISTER SAVE AREA           * 00830602
*                  5. RETURN ADDRESS                                  * 00832602
*      REGISTERS SAVED= NONE                                          * 00833002
*      REGISTER CONTENTS DURING PROCESSING=                           * 00833102
*                        R6= CURRENT KEY POINTER                      * 00833202
*                        R7= CURRENT NUMBER POINTER                   * 00839902
*                        R8= CURRENT LENGTH                           * 00841902
*                        R9= CURRENT LENGTH POINTER                   * 00843902
*                        R10 - RF= SAME AS INPUT                      * 00845902
*      REGISTERS RESTORED= NONE                                       * 00846302
*                                                                     * 00846402
*  EXIT - NORMAL= KEYWORD PROCESSING ROUTINE                          * 00846502
*      CONDITIONS= WHEN KEY HAS BEEN RECEIVED AND VALIDATED           * 00851202
*      OUTPUT DATA= 1. R2= LENGTH OF CURRENT POSITIONAL PARAMETER     * 00853202
*                   2. R3= PTR TO LENGTH BYTE OF CURRENT PARAMETER    * 00855202
*                   3. R4= PTR TO PARAMETER DESCRIPTOR TABLE          * 00855602
*      RETURN CODES= NONE                                             * 00855702
*  EXIT - ERROR= THE CLEANUP PORTION OF THE PROCESSING ROUTINE        * 00855802
*      CONDITIONS= WHEN ERROR HAS BEEN DETECTED                       * 00857202
*      OUTPUT DATA= ERROR MESSAGE                                     * 00859202
*      RETURN CODES= NONE                                             * 00859602
*                                                                     * 00859702
*  EXTERNAL REFERENCES=                                               * 00859802
*      ROUTINES= IEFVHQ                                               * 00859902
*      DATA AREAS= IWA,LWA                                            * 00863202
*      CONTROL BLOCKS= QMPA - U,M                                     * 00865202
*          KEY:  C=CREATE, U=USED, M=MODIFY, D=DELETE                 * 00865602
*      TABLES= IEFVKEYS ( TABLE OF VALID KEYS )                       * 00866002
*      MACROS= NONE                                                   * 00866402
*      ENQUEUE RESOURCES= NONE                                        * 00866502
*                                                                     * 00866602
*  MESSAGES= IEF640I- EXCESSIVE NBR OF POSITIONAL SUBPARAMETERS       * 00866702
*            IEF641I- IMPROPER SUBPARAMETER LIST                      * 00867802
*                                                                     * 00869802
*  CHANGE LEVEL = Z40MPTH,Z40RPSM,ZA27750                     @ZA27750* 00869903
*                                                                     * 00870503
*                                                                     * 00871903
*********************************************************************** 00874202
*                                                                     * 00876202
         IEFTXTFT                                                       00891402
         TITLE 'IEFVGK - KEYS'                                          00895702
         IEFVKEYS                                                       00900000
         TITLE 'IEFVGK - IEFQMNGR'                                      00920000
         IEFQMNGR                                                       00940000
         TITLE 'IEFVGK - IWA'                                           00960000
         IEFCOMWA                                                       00980002
         IEFVMIWA                                                       00990002
         TITLE 'IEFVGK - AWA'                                           01000000
GKWORK   DSECT                                                          01020000
         IEFVMAWA                                                       01040000
         TITLE 'IEFVGK - CSECT'                                         01060000
*                                                                     * 01080000
*********************************************************************** 01100000
*                                                                     * 01120000
*              EQUATES - ERROR MESSAGE NUMBERS.                       * 01140000
*                                                                     * 01160000
*********************************************************************** 01180000
*                                                                     * 01200000
GKER1    EQU   X'28'   IEF640I EXCESSIVE NBR OF POS. SUBPARAMETERS.     01220000
GKER2    EQU   X'29'   IEF641I IMPROPER SUBPARAMETER LIST.              01240000
*****************************************************************Y02668 01242002
*                                                               *Y02668 01244002
*                 GENERAL  EQUATES                              *Y02668 01246002
*                                                               *Y02668 01248002
*****************************************************************Y02668 01250002
         SPACE 2                                                 Y02668 01252002
         EJECT                                                          01260000
IEFVGK   CSECT                                                          01280000
*********************************************************************** 01300000
*                                                                     * 01320000
*        INPUT TO THIS ROUTINE:                                       * 01340000
*                                                                     * 01360000
*              RA POINTS TO JOB, EXEC OR DD WORK AREA.                * 01380000
*              RB IS BASE REGISTER OF JOB, EXEC OR DD ROUTINE.        * 01400000
*              RC POINTS TO INTERPRETER WORK AREA.                    * 01420000
*              RD POINTS TO CURRENT REGISTER SAVE AREA.               * 01440000
*              RE RETURN ADDRESS.                                     * 01460000
*                                                                     * 01480000
*********************************************************************** 01500000
*                                                                       01520000
         SPACE 2                                                        01540000
         STM   R5,R1,12(RD)       SAVE ALL REGISTERS BUT R2,R3 & R4.    01560000
         SPACE                                                          01580000
         BALR  RB,0               REGISTER 11 IS THE BASE               01600000
         USING *,RB                    OF THIS ROUTINE.                 01620000
*****************************************************************Y02668 01622002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01624002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01626002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01628002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01630002
         DC    C'VGK '             MOD ID USED BY TRACE.         Y02668 01632002
* TRACE RETURNS HERE.                                            Y02668 01634002
*****************************************************************Y02668 01636002
GKBASE   EQU   *                                                        01640000
         B     GKB1A                                             Y02668 01690002
         MODID BRANCH=NO                                         Y02668 01700002
*        DC    C'SPLT'             FUNCTION ID AND               Y02668 01710003
*        DC    C'05'               LEVEL # (TEXT PFX FIX).       Y02668 01712003
*        DC    C'REL37'             FUNCTION ID AND            @Z40MPTH 01714003
*        DC    C'02'   LEV # (RACF)                            @Z40RPSM 01716003
         DC    C'03'   LEV # (MERGE SU4,10,16 CODE TO 037 PTF) @ZA27750 01718003
GKB1A    DS    0H                                                Y02668 01730002
         USING GKWORK,RA          LOCAL WORK AREA (GOTTEN IN CALLING    01780000
*                                      PROGRAM).                        01800000
         LM    R2,R5,TNUM         GET CURRENT PARAM/SUBPARAM STATUS.    01820000
         CLR   R2,R3              PARAMETERS TO PROCESS.                01840000
         BNE   GKB2               YES. GO TO GET POSITIONAL.            01860000
         CLR   R4,R5              SUBPARAMETER TO PROCESS.              01880000
         BNE   GKB2               YES. GO TO GET POSITIONAL.            01900000
         EJECT                                                          01920000
*********************************************************************** 01940000
**                                                                   ** 01960000
**             GET KEY PROCESSING.                                   ** 01980000
**                                                                   ** 02000000
*********************************************************************** 02020000
GKB4     DS    0H                                                       02040000
         LM    R6,R9,TKEYPX       R6 = CURRENT KEY POINTER.             02060000
*                                 R7 = CURRENT NUMBER POINTER.          02080000
*                                 R8 = CURRENT LENGTH.                  02100000
*                                 R9 = CURRENT LENGTH POINTER.          02120000
         LTR   R6,R6              CURRENT KEY POINTER = ZERO.           02140000
         BE    GKB5A              YES. INITIAL ENTRY TO GET KEY.        02160000
         LR    R6,R9              TAKE TLENP.                           02180000
         AR    R6,R8              ADD TLEN.                             02200000
         LA    R6,1(R6,0)         PLUS ONE. R6 NOW POINTS TO NEXT KEY.  02220000
GKF3     DS    0H                                                       02360000
         CLI   0(R6),ENDK          END KEY                        19378 02366017
         BE    AOGK5               YES,GO TO CLEANUP             Y02668 02372002
         BAL   RE,GKL1             GO PROCESS DEFAULT TABLE      Y02668 02376002
         LA    R7,1(R6,0)         R7 NOW POINTS TO NEW NBR.             02380000
         LR    R9,R7              SET R9 (TLENP) TO BE INCREMENTED      02400000
*                                      BY GET POS.                      02420000
         L     R4,TBRANCH         BRANCH TABLE ADDRESS TO R4.           02440000
         SR    R5,R5                                                    02460000
         IC    R5,0(R6)           THIS KEY TO R5.                       02480000
         STC   R5,MSGKEY          STORE KEY IN IWA FOR POSS ERROR MSG.  02500000
         SR    R1,R1                                                    02520000
         IC    R1,TBASE           COMPUTE TABLE ENTRY ADDRESS FROM BASE 02540000
         SR    R1,R5                   KEY AND CURRENT KEY.             02560000
         MH    R1,GK06                                                  02580000
         LA    R1,0(R1,R4)        R1 NOW POINTS AT TABLE ENTRY.         02600000
         CLC   0(1,R7),0(R1)      TOO MANY PARAMETERS FOR THIS KEY.     02620000
         BH    GKG5               YES. GO TO SET ERROR MSG.             02640000
         XC    TNUM(16),TNUM      ZERO STATUS TABLE.                    02660000
         MVC   TNUM+3(1),0(R7)    MOVE NBR OF PARAMS TO TABLE.          02680000
         SR    R8,R8              SET LENGTH SLOT TO ZERO.              02700000
         STM   R6,R9,TKEYPX       STORE UPDATED STATUS OF KEY,NUM & LEN 02720000
         LH    R9,2(R1)           BRANCH RETURN RELATIVE ADDRESS TO R9. 02740000
         L     R8,36(RD)          JOB,EXEC OR DD BASE TO R8.            02760000
         LA    R9,0(R9,R8)        ABSOLUTE BRANCH RTN ADDR TO R9.       02780000
         ST    R9,48(RD)          STORE INTO R14 RETURN SLOT.           02800000
         LH    R9,4(R1)           PDT RELATIVE ADDRESS TO R9.           02820000
         LA    R9,0(R9,R8)        PDT ADDRESS TO R9.                    02840000
         ST    R9,TPDTSAVE        SAVE TO PICK UP ON EXIT.              02860000
         MVC   TSUBPARM(1),1(R1)  SAVE SUBPARM CHECK FIELD FOR GET POS. 02880000
         CLI   TNUM+3,X'00'       DOES NBR PARAMS EQUAL ZERO.           02900000
         BE    GKJ2A              YES. GO TO EXIT.                      02920000
         B     GKB2               GO TO GET POS.                        02940000
*                                                                       02960000
*   INITIALIZE WORK AREA.                                               02980000
*                                                                       03000000
GKB5A    DS    0H                                                       03020000
         L     R6,TEXTBUFP         GET POINTER TO TEXT AND       Y02668 03040002
         USING TEXT,R6             ADDRESSABILITY FOR TEXT PREFIXY02668 03041002
         TM    STRINDCS,PROCSTR    Q. PROC STMT TEXT STRING      Y02668 03042002
         BO    AOGK2               YES, PROCESS AS EXEC STMT     Y02668 03042602
         TM    STRINDCS,JOBSTR     Q. JOB STMT TEXT STRING       Y02668 03043202
         BZ    AOGK1               NO, CHECK IF EXEC STMT        Y02668 03043802
         LA    R6,STRJPFXL(R6)     INCRE BY JOB PFX LTH          Y02668 03044402
         B     AOGK4               EXIT TO STORE JOB KEY PTR     Y02668 03045002
AOGK1    DS    0H                                                Y02668 03046002
         TM    STRINDCS,EXECSTR    Q. EXEC STMT TEXT STRING      Y02668 03049002
         BZ    AOGK3               NO, ASSUME DD STMT TXT STRING Y02668 03050002
AOGK2    DS    0H                                                Y02668 03051002
         LA    R6,STREPFXL(R6)     INCRE PTR BY EXEC/PROC PFX LTHY02668 03052002
         B     AOGK4               GO TO STORE PTR               Y02668 03053002
AOGK3    DS    0H                                                Y02668 03054002
         LA    R6,STRDPFXL(R6)     INCRE PTR BY DD PREFIX LENGTH Y02668 03055002
AOGK4    DS    0H                                                Y02668 03056002
         ST    R6,TBEGPX           SAVE POINTER.                 Y02668 03070002
         MVC   TBASE(1),0(R6)      MOVE BASE KEY TO LWA.         Y02668 03100002
         B     GKF3               GO TO PROCESS KEY.                    03140000
         SPACE                                                          03160000
AOGK5    DS    0H                                                Y02668 03180002
         OI    AOSW1,AOENDKSW      SET END KEY SW TO INDICATE    Y02668*03183002
                                   TEXT STRING PROCESSED TO END. Y02668 03186002
         XC    MSGKEY,MSGKEY       TELL VGM NO SECONDARY MSG    YM00393 03192002
         B     GKE4                GET READY TO EXIT             Y02668 03198002
GKG5     DS    0H                                                Y02668 03207002
         MVI   MSGSEC,GKER1        ERROR:'TOO MANY PARMS'        Y02668 03216002
         LA    R6,1(R6)            POINT BEYOND KEY IN ERROR     Y02668 03225002
GKE4     DS    0H                                                Y02668 03234002
         MVC   48(4,RD),TCLEANUP   MOVE CLEANUP ADDR TO R14 SLOT Y02668 03243002
         B     GKK2               GO TO EXIT.                           03260000
         EJECT                                                          03280000
*********************************************************************** 03300000
**                                                                   ** 03320000
**             GET POSITIONAL PROCESSING.                            ** 03340000
**                                                                   ** 03360000
*********************************************************************** 03380000
         SPACE                                                          03400000
GKB2     DS    0H                                                       03420000
         LM    R2,R5,TNUM                                               03440000
*        R2 = TNUM                                                      03460000
*        R3 = TCT                                                       03480000
*        R4 = TNUM1                                                     03500000
*        R5 = TCT1                                                      03520000
         SPACE                                                          03540000
         LM    R8,R9,TLEN                                               03560000
*        R8 = TLEN                                                      03580000
*        R9 = TLENPX                                                    03600000
         SPACE                                                          03620000
         CLR   R4,R5              SUBPARAMETERS TO PROCESS.             03640000
         BNE   GKB1               YES. GO TO INCREMENT TCT1.            03660000
         LA    R3,1(R3,0)         NO. PROCESSING PARAMETER. INCR. TCT.  03680000
         B     GKD1               GO TO INCREMENT TO NEXT LENGTH.       03700000
         SPACE                                                          03720000
GKE2     DS    0H                                                       03740000
         SR    R8,R8                                                    03760000
         IC    R8,0(R9)           PUT CURRENT LENGTH INTO R8.           03780000
         LR    R7,R8              TLEN OR N' TO R7.                     03800000
         SRL   R7,7                                                     03820000
         LTR   R7,R7              IS THERE A HIGH ORDER ONE.            03840000
         BNE   GKE1               YES. SUBPARAMETER. GO TO SET UP       03860000
         SPACE                                                          03880000
GKH2     DS    0H                                                       03900000
         SPACE 2                                                        04000000
*   S A V E  S T A T U S  A N D  R E T U R N  O N  R E G  1 4.          04020000
GKJ2     DS    0H                                                       04040000
         STM   R8,R9,TLEN         STORE LENGTH AND LENGTH POINTER.      04060000
         STM   R2,R5,TNUM         STORE PARAM/SUBPARAM STATUS.          04080000
GKJ2A    DS    0H                                                       04100000
         LM    R2,R4,TLEN         R2 = LENGTH.                          04120000
*                                 R3 = LENGTH POINTER.                  04140000
*                                 R4 = PDT POINTER.                     04160000
GKK2     DS    0H                                                       04180000
         LM    R5,R1,12(RD)       RESTORE REGISTERS.                    04200000
         BR    RE                 RETURN.                               04220000
         SPACE 2                                                        04240000
GKB1     DS    0H                                                       04260000
         LA    R5,1(R5,0)         INCREMENT TCT1.                       04280000
GKD1     DS    0H                                                       04300000
         AR    R9,R8              ADD OLD LENGTH.                       04320000
         LA    R9,1(R9,0)         POINT AT NEXT LENGTH SLOT.            04340000
         B     GKE2                                                     04360000
         SPACE                                                          04380000
GKE1     DS    0H                                                       04400000
         LR    R4,R8              PICK UP NBR SUBPARAMS.                04420000
         N     R4,GKPATRN2        TURN OFF HIGH ORDER BIT.              04440000
         LA    R5,1               SET TCT1 TO ONE.                      04460000
         LA    R9,1(R9,0)         INCREMENT POINTER TO LENGTH.          04480000
         IC    R8,0(R9)           PUT CURRENT LENGTH IN R8.             04500000
         CLI   TSUBPARM,X'FF'     IF SUBPARAMETERS ARE ALLOWED IN  AABA 04504016
         BE    GKH2               THE FIRST 8 PARAMETERS, ALLOW    AABA 04508016
*                                 THEM ANYWHERE.                   AABA 04512016
         SPACE                                                          04516016
         SPACE                                                          04520000
         SR    R6,R6              *    THIS SEQUENCE CHECKS TO SEE      04540000
         IC    R6,TSUBPARM        *    IF A SUBPARAMETER IS OK IN       04560000
         LH    R7,GKPATRN1        *    THIS POSITION OF THE PARAM       04580000
         SRL   R7,0(R3)           *    FIELD. R3 IS THE NUMBER OF THE   04600000
         NR    R7,R6              *    CURRENT PARAM UNDER THIS KEY.    04620000
         BC    4,GKH2             SUBPARAMETER IS OK. CONTINUE.         04640000
         MVI   MSGSEC,GKER2       ERROR. SET ERROR CODE. SUBPARM ERROR. 04660000
         B     GKE4               GO TO GET CLEANUP ADDRESS.            04680000
         EJECT                                                          04700000
*********************************************************************** 04720002
*                                                                     * 05241202
*               DEFAULT TABLE PROCESSING ROUTINE                      * 05241802
*                                                                     * 05242402
*********************************************************************** 05243002
         SPACE                                                          05243602
*        R6= PTR TO KEY                                          Y02668 05244202
GKL1     DS    0H                                                Y02668 05244802
         LA    R3,GKDFLT           GET DEFAULT TABLE ADDRESS     Y02668 05245402
         LA    R4,GKTLTH           GET LENGTH OF TABLE           Y02668 05246002
GKL2     DS    0H                                                Y02668 05246602
         CLC   0(1,R3),0(R6)      COMPARE KEYS                   Y02668 05247202
         BE    GKL3                YES, GO SET BIT IN IWA        Y02668 05247802
         LA    R3,1(R3)            NO, INDEX INTO TABLE          Y02668 05248402
         BCT   R4,GKL2             LOOP BACK UNTIL END OF TABLE  Y02668 05249002
*  KEYWORD IS NOT IN DEFAULT TABLE.                             YM00368 05249102
         NI    AOSW2,255-AODFLTKW  CLEAR SW, IF ON FROM THE     YM00368*05249202
                                   PREVIOUS KEYWORD.            YM00368 05249302
         BR    RE                  RETURN TO CALLER              Y02668 05249602
GKL3     DS    0H                                                Y02668 05250202
         OI    AOSW2,AODFLTKW      SET BIT INDICATING DEFAULT    Y02668 05250802
         BR    RE                  RETURN TO CALLER              Y02668 05251402
         EJECT                                                          05252002
*  TABLE OF KEYWORDS FOR WHICH DEFAULTS ARE SUPPLIED.            Y02668 05252602
GKDFLT   DS    0H                                                Y02668 05253002
         DC    AL1(HOLDK)          HOLD                          Y02668 05253402
         DC    AL1(FREEK)          FREE                          Y02668 05253802
         DC    AL1(COPIESK)        COPIES                        Y02668 05254202
         DC    AL1(DYNMPEK)        DYNAMNBR.                     Y02668 05254602
         DC    AL1(DYNMEEK)        DYNAMNBR=                     Y02668 05255002
         DC    AL1(PRFMPEK)        PERFORM.  - EXEC STMT         Y02668 05255402
         DC    AL1(PRFMEEK)        PERFORM=  - EXEC STMT         Y02668 05255802
         DC    AL1(PRFMJK)         PERFORM   - JOB STMT          Y02668 05256202
GKTLTH   EQU   *-GKDFLT            TABLE LENGTH                  Y02668 05257402
*********************************************************************** 05260000
*                                                                     * 05280000
*              CONSTANTS                                              * 05300000
*                                                                     * 05320000
*********************************************************************** 05340000
GK06     DC    H'6'                                                     05360000
GKPATRN1 DS    0H                 CHECK HIGH ORDER ONE PATTERN.         05380000
         DC    XL2'0100'                                                05400000
GKPATRN2 DS    0F                 TURN OFF HIGH ORDER ONE PATTERN.      05420000
         DC    XL4'0000007F'                                            05440000
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 05450002
         END                                                            05460000
./  ADD  SSI=80300047,NAME=IEFVGM
         EJECT                                                          00020002
         IEFCOMWA                                                Y02668 00030002
AWA      DSECT                                                          00040000
         IEFVMAWA                                                       00060000
         EJECT                                                          00080002
         IFGRPL                                                  Y02668 00090002
         EJECT                                                          00100002
NEL      DSECT                                                          00110002
         IEFNEL SUBCOM=C                                                00120002
         EJECT                                                          00130002
         IEFVKEYS                                                 19874 00190019
         IEFTXTFT                                                       00195002
*********************************************************************** 00200000
**********************************************************************  00220000
IEFVGM   CSECT                                                          00240000
*/*                                                                     00290002
**********************************************************************  00340002
*                                                                       00350002
*   MODULE NAME= IEFVGM                                                 00352002
*                                                                       00354002
*   DESCRIPTIVE NAME= MESSAGE MODULE                                    00356002
*                                                                       00358002
*   COPYRIGHT= N/A                                                      00358402
*                                                                       00358802
* STATUS - VS2 SU 16 - IN THIS MODULE, SU 16 SUPPORTS          @G16APPK 00358903
*          VPSS SUPPORT(SU 29 - @G29AN2E) AND RACF             @G16APPK 00359803
*          VERSION 2(SU 32 - @G32HPPJ).                        @G16APPK 00360703
*          SU16 PTF                                            @ZA19982 00361603
*          MERGE SU4,10,16 CODE TO REL 037 PTF                 @ZA27753 00362003
*                                                                       00362503
*   FUNCTION= PRINT OUT ERROR MESSAGES OR JCL STATEMENTS                00363403
*      OPERATION= WHEN IEFVGM RECEIVES CONTROL REGISTER 2 CONTAINS THE  00364303
*                 PRIMARY MESSAGE NUMBER OR IS ZERO.  IF A     @G29AN2E 00365203
*                 PRIMARY MESSAGE NUMBER IS GIVEN, THEN THE    @G29AN2E 00366103
*                 MESSAGE IS LOCATED AND PUT TO THE MESSAGE    @G29AN2E 00367003
*                 DATA SET.  IF REGISTER 2 IS ZERO AND         @G29AN2E 00367903
*                 AOMSGTXT FLAG IS ON IN THE COMWA, THEN AN    @G29AN2E 00368803
*                 ERROR MESSAGE IN THE VGM MESSAGE BUFFER IS   @G29AN2E 00369703
*                 PUT TO THE MESSAGE DATA SET.  IF REGISTER 2  @G29AN2E 00370603
*                 IS ZERO AND AOMSGTXT FLAG IS NOT ON, THEN A  @G29AN2E 00371503
*                 STATEMENT (POINTED TO BY REGISTER 9) IS      @G29AN2E 00372403
*                 PACKED AND PUT TO THE LIST DATA SET.  IF AN  @G29AN2E 00373303
*                 I/O ERROR IS ENCOUNTERED, AN I/O ERROR WTO   @G29AN2E 00374203
*                 IS ISSUED AND EXIT IS TO THE TERMINATION     @G29AN2E 00375103
*                 ROUTINE.                                     @G29AN2E 00376003
*                                                              @G29AN2E 00376903
*                 A WARNING WTO IS ISSUED IF IT HAS NOT        @G29AN2E 00377803
*                 PREVIOUSLY BEEN ISSUED IN CASES WHEN THE     @G29AN2E 00378703
*                 PRIMARY MESSAGE NUMBER IS A WARNING          @G29AN2E 00379603
*                 MESSAGE OR WHEN AOWRNREQ IS TURNED ON IN     @G29AN2E 00380503
*                 THE COMWA.                                   @G29AN2E 00381403
*                                                              @G29AN2E 00382303
*                                                                       00385802
*   NOTES                                                               00387802
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00389802
*      DEPENDENCIES= NONE                                               00391802
*      RESTRICTIONS= NONE                                               00391902
*      REGISTER CONVENTIONS= R0-RF                                      00392302
*      PATCH-LABEL= PATCH                                               00392402
*                                                                       00398002
*   MODULE TYPE= PROCEEDURE                                             00400002
*      PROCESSOR= ASSEMBLER                                             00402002
*      MODULE SIZE=                                                     00402402
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00402802
*                                                                       00403202
*   ENTRY POINT= IEFVGM                                                 00403302
*      PURPOSE= WRITE OUT A MESSAGE                                     00403402
*      LINKAGE= LOAD VCON BRANCH REGISTER                               00403502
*      INPUT DATA= STATEMENT (REG 2=ZERO, REG 9=STATEMENT POINTER)      00417402
*                  ERROR MESSAGE (REG 2=PRIMARY MESSAGE NUMBER)         00419402
*      REGISTERS SAVED= 14,12                                           00427402
*      REGISTER CONTENTS DURING PROCESSING= N/A                         00429402
*      REGISTERS RESTORED= 14,12                                        00429802
*                                                                       00430202
*   EXIT - NORMAL= BRANCH REGISTER 14                                   00430602
*      CONDITIONS= MESSAGE OR STATEMENT WRITTEN                         00431002
*      OUTPUT DATA= NONE                                                00431102
*      RETURN CODES= NONE                                               00431202
*                                                                       00438202
*   EXIT - ERROR= LOAD TERMINATION RTN VCON AND BRANCH REGISTER         00440202
*      CONDITIONS= I/O ERROR ON PUT OF MESSAGE OR STATEMENT.            00440302
*      OUTPUT DATA= SET TERM BIT IN WORK AREA                           00440402
*      RETURN CODES= AN 8 IN WORK AREA RETURN CODE FIELD                00440502
*                                                                       00440602
*    EXTERNAL REFERANCES= NONE                                          00442402
*      ROUTINES= NONE                                                   00444502
*      DATA AREAS= IWA,AWA,NEL                                          00446602
*      CONTROL BLOCKS= NONE                                             00448702
*      TABLE= NONE                                                      00450802
*      MACROS= GETMAIN FREEMAIN RETURN IEFSAVER IEFRELSE                00452902
*      ENQUEUE RESOURCES= N/A                                           00455002
*                                                                       00457103
*   MESSAGES= NONE                                                      00459103
*                                                                       00461103
*   CHANGE LEVEL = Z40MPTH,G29AN2E,G32HPPJ                     @G32HPPJ 00463103
*   CHANGE LEVEL = Z40MPTH,ZA19982,ZA27753                     @ZA27753 00465103
*                                                                       00471702
**********************************************************************  00473702
**/                                                                     00477602
*********************************************************************** 00481702
*********************************************************************** 00485602
*********************************************************************** 00497402
*********************************************************************** 00509201
AOSTMTLT EQU   10            LENGTH OF STMT # FIELD IN MSG       Y02668 00549202
HDRLINES EQU   2                                                 Y02668 00551502
HDRLTH   EQU   17                                                Y02668 00551602
VFBMSG   EQU   X'FF'                                             Y02668 00551802
VGM0     EQU   0                                               @G29AN2E 00552703
VGM1     EQU   1                                               @G29AN2E 00553603
VGM9     EQU   9                                               @G29AN2E 00554503
L160     EQU   160                                             @G29AN2E 00555403
MAXLEN   EQU   110           MAXIMUN LENGTH TEXT TO BE PASSED  @G29AN2E 00556303
B3       EQU   B'0011'       ICM MASK                          @G29AN2E 00557203
AOMSGLO  EQU   8             OFFSET TO MSG LENGTH              @G29AN2E 00558103
*                                                                       00559201
         SAVE  (14,12)                 SAVE USER REGS                   00980000
         BALR  RB,0                    SETUP MODULE BASE                01000000
         USING *,RB                                                     01020000
*****************************************************************Y02668 01021002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01022002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01023002
         CNOP  2,4                                                      01024002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01025002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01026002
         DC    C'VGM '             MOD ID USED BY TRACE.         Y02668 01027002
* TRACE RETURNS HERE.                                            Y02668 01028002
*****************************************************************Y02668 01029002
         B     GM1                 BR AROUND MODULE IDENTIFIER   Y02668 01030002
         MODID BR=NO                                             Y02668 01050002
*        DC    C'SU32'             FUNCTION ID                 @G32HPPJ 01096003
*        DC    C'01'               LEVEL # (PROTECT)           @G32HPPJ 01098003
*        DC    C'02'          LEVEL # (PUT MSG 50 IN TABLE)    @ZA19982 01100003
         DC    C'03'   LEV # (MERGE SU4,10,16 CODE TO 037 PTF) @ZA27753 01102003
GM1      DS    0H                                                       01110002
*********************************************************************** 01140002
*                   ISSUE WARNING WTO IF                         Y02668 01170002
*                   WARNING MSG IS ISSUED                        Y02668 01200002
*********************************************************************** 01230002
         TM    AOSW1,AOVFBSW       CREATED MSG INDICATED       @YA00069 01240003
         BO    GM200               YES.  GO TO PROCESS MSG     @YA00069 01250003
         LTR   R2,R2               MSG OR STMT TO BE ISSUED?     Y02668 01260002
         BZ    GM200               STMT.  BYPASS WTO CODE        Y02668 01290002
         TM    SWI,WAWRNWTO        HAS A WARNING WTO BEEN ISSUED Y02668 01320002
         BO    GM200               YES.  GO TO PROCESS MSG       Y02668 01350002
         TM    AOSW4,AOWRNREQ      IS WARNING REQUESTED?       @G29AN2E 01360003
         BO    GM150                                           @G29AN2E 01370003
         LA    R6,GWRNKEYS         GET KEY TABLE ADDRESS         Y02668 01380002
         LA    R8,GWKEYLTH         GET TABLE LENGTH              Y02668 01410002
GM100    DS    0H                                                Y02668 01440002
         CLM   R2,1,0(R6)          IS THIS A WARNING KEY?        Y02668 01470002
         BE    GM150               YES ISSUE WARNING WTO         Y02668 01500002
         LA    R6,1(R6)            NO  INCREMENT TABLE POINTER   Y02668 01530002
         BCT   R8,GM100            DECREMENT AND SEARCH TABLE    Y02668 01560002
         B     GM200               NOT A WARNING MESSAGE -       Y02668 01590002
*                                  GO TO PROCESS MESSAGE         Y02668 01620002
GM150    DS    0H                                                Y02668 01650002
*********************************************************************** 01680002
*        ISSUE WARNING WRITE TO OPERATOR                         Y02668 01710002
*********************************************************************** 01740002
         IEFSAVER   ,              SAVE AREA FOR IEFVHR          Y02668 01790002
         TM    AOSW4,AODFWMSG     WRN MSG ISSUED TO CONSOLE?    YM00398 01800002
         BO    GM160               YES, DO NOT ISSUE AGAIN      YM00398 01810002
         LA    R5,IEF677I          GET WARNING MESSAGE KEY       Y02668 01830002
         L     RF,IEFVHRV          GET IEFVHR ADDRESS            Y02668 01860002
         BALR  RE,RF               GO TO PUT OUT WTO             Y02668 01890002
         OI    AOSW4,AODFWMSG     CONSOLE WRN MSG ISSUED        YM00398 01900002
GM160    DS    0H                                               YM00398 01910002
         IEFRELSE   ,              RELEASE IEFVHR SAVE AREA      Y02668 01940002
         TM    AOSW4,AOWRNREQ      IS WARNING REQUESTED        @G29AN2E 01950003
         BZ    GM200               NO, GO PROCESS MSG          @G29AN2E 01960003
         NI    AOSW4,X'FF'-AOWRNREQ TURN OFF WARNING REQ FLAG  @G29AN2E 01970003
         XR    R2,R2               CLER WORK REG               @G29AN2E 01980003
         TM    AOSW4,AOMSGTXT      HAS TEXT ALSO BEEN PASSED?  @G29AN2E 01990003
         BO    GM230               YES, GO PROCESS TEXT        @G29AN2E 02000003
         B     GM600               GO EXIT                     @G29AN2E 02010003
*                                                                       02020000
*                                                                       02040000
*********************************************************************** 02060000
*             ENTRY DETERMINATION                                       02080000
*             WORK AREA PREPARATION                                     02100000
*             .R2 CONTAINS MESSAGE NO. OF SECONDARY MESSAGE      OR     02120000
*             .R2 EQUAL ZERO AND R9 CONTAINS STATEMENT PTR              02140000
*             .R6 CONTAINS ADDR OF WORK BUFFER                          02160000
*********************************************************************** 02180000
GM200    EQU   *                                                        02200000
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 02203003
         BO    GM230               YES - CHECK MSG LEN         @G29AN2E 02206003
         L     R1,WAMSGBUF         GET WORK AREA ADDRESS         Y02668 02210002
         MVI   0(R1),C' '          BLANK OUT                     Y02668 02246002
         MVC   1(159,R1),0(R1)     WORK BUFFER                   Y02668 02252002
         LR    R6,R1                   SAVE BUFFER PTR                  02260000
         LR    R8,R1                   SAVE ADDR BUFFER                 02280000
         TM    AOSW1,AOVFBSW       CALLED BY VFB?                Y02668 02286002
         BO    AOEPCVT             YES, GO TO MOVE STMT #        Y02668 02292002
GM210    LTR   R2,R2                   TEST FOR MESSAGE          Y02668 02300002
         BZ    GM400                   BCH ON STATEMENT ENTRY           02320000
         L     R7,CTRLWAP          MESSAGE ENTRY-GET SEC MESSAGE        02340000
         USING AWA,R7                                                   02360000
         L     R9,TEXTBUFP         ADDR OF TEXT STRING.          Y02668 02380002
         USING TEXT,R9             PREFIX ADDRESSABILITY.        Y02668 02382002
         TM    STRINDCS,PROCSTR    PROC STATEMENT?               Y02668 02384002
         BZ    GM225               BRANCH NO.                    Y02668 02386002
         DROP  R9                                                Y02668 02388002
         CLI   MSGKEY,EXECK       IS EXECK IN MSGKEY?            A32755 02394020
         BNE   GM225              TRANSFER IF MSGKEY NOT EXEC.   A32755 02396020
         MVI   MSGKEY,INTKEY3     MOVE PROC KEY INTO MSGKEY.     A32755 02398020
GM225    DS    0H                                                A32755 02398420
         SR    R9,R9               CLEAR SEC MSG NUMBER REG.     Y02668 02399202
         IC    R9,MSGKEY               LOCATE SECONDARY MSG NO          02400000
         DROP  R7                                                       02420000
         B     AOEPCVT            SKIP TO MOVE STMT #          @G29AN2E 02420803
GM230    DS    0H                                              @G29AN2E 02421603
         L     R1,WAMSGBUF        GET ADDR OF MSG BUFFER       @G29AN2E 02422403
         LR    R8,R1              SAVE ADDR                    @G29AN2E 02423203
         XR    R7,R7              CLEAR WORK REG               @G29AN2E 02424003
         CH    R7,AOMSGLO(R1)     IS LENGTH OF MSG>0           @G29AN2E 02424803
         BE    GM600              NO, GO EXIT                  @G29AN2E 02425603
         LA    R7,MAXLEN          STORE MAX ALLOWABLE MSG LEN  @G29AN2E 02426403
         CH    R7,AOMSGLO(R1)     IS MSG LONGER THAN MAX       @G29AN2E 02427203
         BNH   GM235              YES, ASSUME MAX LENGTH       @G29AN2E 02428003
         ICM   R7,B3,AOMSGLO(R1)  NO, GET ACTUAL LENGTH        @G29AN2E 02428803
GM235    DS    0H                                              @G29AN2E 02429603
         LA    R7,AOSTMTLT(R7)     GET TOTAL LENGTH TO WRITE   @G29AN2E 02430403
         LA    RE,L160             GET LENGTH OF BUFFER        @G29AN2E 02431203
         SR    RE,R7               GET TOTAL BLANKS NEEDED     @G29AN2E 02432003
         LR    RF,R1               GET ADDR OF BUFFER          @G29AN2E 02432803
         AR    RF,R7               GET ADDR OF FIRST BLANK     @G29AN2E 02433603
         MVI   VGM0(RF),C' '       MOVE FIRST BLANK            @G29AN2E 02434403
         BCTR  RE,0                GET NUMBER LEFT TO DO       @G29AN2E 02435203
         BCTR  RE,0                DECREMENT FOR MOVE          @G29AN2E 02436003
         EX    RE,MVCBLANK         BLANK OUT REST OF BUFFER    @G29AN2E 02436803
         MVI   VGM0(R1),C' '       BLANK OUT FIRST CHAR        @G29AN2E 02437603
         MVC   VGM1(VGM9,R1),VGM0(R1) BLANK OUT NEXT 9 CHARS   @G29AN2E 02438403
*                                                                Y02668 02440002
* MOVE IN STMT # FOR THIS MESSAGE                                Y02668 02441002
*                                                                Y02668 02442002
         SPACE 2                                                 Y02668 02443002
AOEPCVT  DS    0H                                                Y02668 02444002
         LH    R4,WASTMTNO         GET NUMBER OF THIS STMT       Y02668 02445002
         CVD   R4,AOEPWORK         CONVERT TO DECIMAL            Y02668 02447002
         UNPK  0(5,R8),AOEPWORK(8) UNPACK STMT# TO MSG BUFFER    Y02668 02448002
         OI    4(R8),X'F0'         CHANGE SIGN TO ZONE           Y02668 02449002
         LR    R4,R8                                             Y02668 02450002
AOEPCVT1 DS    0H                                                Y02668 02451002
         CLI   0(R4),X'F0'         CHECK FOR LEADING ZERO        Y02668 02452002
         BNE   AOEPCVT2            BRANCH IF NO                  Y02668 02453002
         MVI   0(R4),C' '          CHANGE LEADING ZERO TO BLANK  Y02668 02454002
         LA    R4,1(R4)            POINTS TO NEXT BYTE           Y02668 02455002
         B     AOEPCVT1            BRANCH TO CHECK AGAIN         Y02668 02456002
AOEPCVT2 DS    0H                                                Y02668 02457002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 02457303
         BO    GM355               YES, GO CHECK HEADER        @G29AN2E 02457603
         LA    R7,AOSTMTLT         R7=STMT # LENGTH              Y02668 02458002
         LA    R8,0(R7,R8)         ADJUST PTR INTO BUFFER        Y02668 02459002
         SR    R4,R4         PRIMARY MESSAGE SCAN BEGINS AT BEGINNI0725 02460000
*                            OF TABLE                              0725 02480000
         TM    AOSW1,AOVFBSW       FROM VFB?                     Y02668 02481002
         BZ    GM300               NO, BRANCH AROUND             Y02668 02482002
         IC    R4,IWAMSLEN         GET MSG LENGTH                Y02668 02483002
         LR    R3,R9               SAVE PTR                      Y02668 02484002
         NI    AOSW1,255-AOVFBSW   TURN OFF VFB SWITCH           Y02668 02485002
         LA    R2,VFBMSG           IND MSG TO PUT ROUTINE        Y02668 02485502
AOEP0235 DS    0H                                                Y02668 02486002
         AR    R7,R4               ADD LENGTHS                   Y02668 02487002
         BCTR  R4,0                DECREMENT BY 1 FOR MOVE       Y02668 02488002
         EX    R4,MVC3             EXECUTE MOVE                  Y02668 02489002
         B     GM350                                             Y02668 02490002
GM250    EQU   *                                                        02520000
         LTR   R9,R9                   TEST FOR SECOND MSG              02540000
         BZ    GM350          BCH ON NO SECONDARY MSG FOUND             02560000
         LR    R2,R9                 RESET FOR SECOND MSG               02580000
         LA    R4,KEFAC      SECONDARY MESSAGE SCAN BEGINS AT MIDDLE725 02600000
*                            OF TABLE                              0725 02620000
         XR    R9,R9                  FLAG END OF MSGS                  02640000
*                                                                       02680000
*********************************************************************** 02700000
*********************************************************************** 02720000
*             ERROR MESSAGE PROCESSING-                                 02740000
*             THERE EXIST 2 POSSIBLE MESSAGES-PRIMARY MSG NO. IS IN THE 02760000
*             REG 2-SECONDARY MSG NO. IN IWA UNDER LABEL MSGKEY.        02780000
*             PRIMARY MSG IS LOCATED AND INSERTED INTO THE BUFFER AREA  02800000
*             THEN THE SECONDARY MSG IS LOCATED,INSERTED INTO THE       02820000
*             BUFFER,AND THE 2 MSG LENGTHS ARE TOTALLED AND INSERTED    02840000
*             IN FRONT OF COMPLETED MESSAGE.                            02860000
*             .R2 CONTAINS MSG NUMBER -SEARCH ARGUMENT                  02880000
*             .R3 SCANS TABLE OF MSG MOD AND MSGS WITHIN PARTICULAR     02900000
*              MODULE -ENDS POINTING TO LENGTH CHARACTER OF MSG DESIRED 02920000
*             .R4  ON ENTRY TO TABLE SCAN ROUTINE POINTS TO RELATIV0725 02940000
*              START LOCATION WHERE SCAN IS TO BEGIN. PRIMARY MESSA0725 02960000
*              START AT THE BEGINNING -SECONDARY MESSAGES START AT 0725 02980000
*              MIDDLE. THEN  REG4  IS ZEROED TO BE USED            0725 03000000
*             .R4 USED TO INCREMENT SCANNING REG                        03020000
*             .R5 HOLDS ADDR OF SYMBOLIC NAME OF MSG MODULE LOADED      03040000
*              TO DELETE LATER                                          03060000
*             .R6 POINTS TO BUFFER AREA                                 03080000
*             .R8 USED TO PUT MSG IN START OF BUFFER -FIRST MSG         03100000
*                             OR     MIDDLE OF BUFFER-SECOND MSG        03120000
*             .R9 HOLDS SECOND MSG NO. DURING PROCESSING OF PRIMARY     03140000
*              MSG                                                      03160000
*********************************************************************** 03180000
GM300    EQU   *                                                        03200000
         LA    R3,GMT1                 TABLE ADDR                       03220000
         ALR   R3,R4               ADJUST TO STARTING POINT       19874 03240019
         SR    R4,R4                                                    03260000
GM305    EQU   *                                                        03280000
         IC    R4,0(R3)                HI NO. OF MODULE                 03300000
         CR    R2,R4                   MESSAGE IN THIS MODULE           03320000
         BNH   GM320               YES, LOAD MODULE               19874 03350019
GM310    EQU   *                                                        03380000
         LA    R3,2(R3)                TEST NEXT NO.                    03400000
         CLI   0(R3),X'00'         IS IT END OF TABLE              0725 03420000
         BNE   GM305            BCH ON NO                          0725 03440000
         B     GM350          GO PUT OUT PRIMARY ONLY              0725 03460000
GM320    EQU   *                                                        03480000
         SR    R4,R4                   SETUP TO LOAD MSG MOD            03500000
         IC    R4,1(R3)                POSITION OF MOD VCON IN TABLE    03520000
         LA    R3,GMT2                 TBL OF VCONS                     03540000
         AR    R3,R4                   PLUS POSITION OF PARTIC MOD      03560000
         LR    R0,R3                   SETUP TO LOAD                    03580000
         LR    R5,R3                   SAVE ADDR OF SYMBOLIC MODULE     03600000
         LOAD  EPLOC=(0)                                                03620000
         LR    R3,R0                   LOCATION OF ENTRY PT             03640000
*                                                                       03660000
*********************************************************************** 03680000
*             SCAN MESSAGES IN MODULE FOR PARTICULAR MESSAGE NO.        03700000
*             .FORMAT OF MESSAGE-1 BYTE MESSAGE NO                      03720000
*                                1 BYTE LENGTH OF MESSAGE               03740000
*                                MESSAGE                                03760000
*********************************************************************** 03780000
GM330    EQU   *                                                        03800000
         SR    R4,R4                                                    03820000
         CLI   0(R3),X'FF'                                              03840000
         BE    GM339               BCH NO MSG FOUND                     03860000
         IC    R4,0(R3)                MESSAGE NO.                      03880000
         CR    R2,R4                   IS THIS THE MESSAGE              03900000
         BE    GM340                   BCH  ON  YES                     03920000
         IC    R4,1(R3)                NO-LENGTH OF MSG                 03940000
         LA    R3,2(R4,R3)    ADJUST TO POINT TO NEXT MSG               03960000
         B     GM330                                                    03980000
*                                                                       04000000
GM339    EQU   *                                                        04020000
         LR    R0,R5          SETUP TO DELETE MSG MODULE                04040000
         DELETE EPLOC=(0)                                               04060000
GM3395   EQU   *             EXIT POINT                            0725 04080000
         LR    R3,R6          ADDR OF BUFFER TO FREE                    04100000
         B     GM600             EXIT FROM ROUTINE                      04120000
*********************************************************************** 04140000
*             MESSAGE FOUND                                             04160000
*             .MOVE MSG INTO BUFFER+1                                   04180000
*             .SAVE MSG LENGTH IN REG7                                  04200000
*             .TEST END OF MESSAGES-REG1 IS ZERO                        04220000
*             .DELETE MODULE AND RESCAN FOR SECOND MSG                  04240000
*             .R3 POINTS TO MSG                                         04260000
*             .R7 TOTALS LENGTH OF BOTH MSGS                            04280000
*             .R8 BUFFER ADJUST REG TO INSERT MSGS                      04300000
*********************************************************************** 04320000
GM340    EQU   *                                                        04340000
         IC    R4,1(R3)                LENGTH OF MSG                    04360000
         LA    R3,2(R3)                POINTS TO MSG CONTENT            04380000
         CLI   0(R3),C' '          IS THIS SECOND LINE OF MSG    Y02668 04383002
         BNE   GM345               BRANCH NO                     Y02668 04386002
         MVI   0(R6),C' '          BLANK OUT STMT #              Y02668 04389002
         MVC   1(5,R6),0(R6)       ALREADY IN THE BUFFER         Y02668 04392002
GM345    DS    0H                                                Y02668 04395002
         AR    R7,R4                   TOTAL LENGTH                     04400000
         BCTR  R4,0                    DECREMENT COUNT ONE FOR EXEC MVC 04420000
         EX    R4,MVC3                 MOVE MSG INTO BUFFER             04440000
         LR    R0,R5                   ADDR OF SYMBOLIC NAME TO DELETE  04460000
         DELETE EPLOC=(0)                                               04480000
         LTR   R9,R9                    TEST END OF MSGS                04500000
         BZ    GM350                   BCH YES                          04520000
         LA    R8,2(R4,R8)         ADJUST PTR INTO BUFFER        Y02668 04540002
         MVI   0(R8),C' '               MOVE IN BLANK FOR SPACING       04560000
         LA    R7,1(R7)                ADJUST LENGTH TO INCLUDE SPACE   04580000
         B     GM250                                                    04600000
MVC3     MVC   0(0,R8),0(R3)                                     Y02668 04620002
GM350    EQU   *                                                        04640000
         LTR   R7,R7        IS THERE A PRIMARY MSG TO PUT OUT      0725 04660000
         BZ    GM3395                BCH NO TO EXIT                0725 04680000
         MVI   0(R6),C' '              BLANK FIRST BYTE          Y02668 04700002
GM355    DS    0H                                              @G29AN2E 04710003
         LA    R5,WAJOBPFX         ADDR OF IWA JOB PFX           Y02668 04720002
         USING TEXT,R5             SET ADDRESSIBILITY TO PFX     Y02668 04730002
         TM    STRJINDC,JTXMHEDR   HAS A HEADER BEEN WRITTEN ?   Y02668 04740002
         BZ    GM700               NO GO TO WRITE HEADER         Y02668 04750002
         DROP  R5                  DROP TEXT BASE                Y02668 04760002
GM360    EQU   *                                                 Y02668 04770002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 04771003
         BO    GM365               YES, GO SET UP FOR PUT      @G29AN2E 04772003
         LR    R3,R6               GET MESSAGE ADDRESS           Y02668 04773002
         LA    R4,1(R7)            GET MESSAGE LENGTH            Y02668 04776002
         BAL   R9,GM500            GO TO WRITE MSG               Y02668 04780002
         B     GM600               RETURN TO CALLER              Y02668 04790002
GM365    DS    0H                                              @G29AN2E 04791003
         L     R3,WAMSGBUF         GET ADDR OF BUFFER          @G29AN2E 04792003
         LR    R4,R7               GET LENGTH OF MESSAGE       @G29AN2E 04793003
         BAL   R9,GM500            GO TO WRITE TEXT            @G29AN2E 04794003
         B     GM600               RETURN TO CALLER            @G29AN2E 04795003
*********************************************************************** 04800000
*********************************************************************** 04820000
*             STATEMENT PROCESSING-                                     04840000
*             .INPUT-REG9 PTS TO STATEMENT                              04860000
*              MOVE STATEMENT INTO MESSAGE BUFFER                       04880002
*********************************************************************** 05220000
GM400    EQU   *                                                        05240000
         LR    R3,R6                   ADDR OF BUFFER                   05260000
         SR    R7,R7          CLEAR                                I68  05330018
         IC    R7,IWAMSLEN    PICK UP MESSAGE LENGTH - USUALLY 80  I68  05340018
         LR    R4,R7          PUT LENGTH IN REG 4                Y02668 05360002
         L     R9,AOWSTMT          R9 PTR TO 'WRITE' BUFFER      Y02668 05390002
         BCTR  R7,0                    LESS CT FOR EXEC MVC      Y02668 05400002
         EX    R7,MVC1                 MOVE DATA FIELD           Y02668 05700002
         BAL   R9,GM500            GO TO  WRITE STMT             Y02668 06040002
         B     GM600               RETURN TO CALLER              Y02668 06240002
*                                                                       06440000
**********************************************************************  06460000
*             PUT STATEMENT OR ERROR MESSAGE MESSAGE DATASET            06480002
*             .R3 -PTR TO MESSAGE OR STATEMENT                          06560000
*             .R4 -LENGTH OF MESSAGE OR PACKED STATEMENT                06580000
**********************************************************************  06600000
GM500    EQU   *                                                        06620000
         L     R5,WANELPTR         GET NEL BASE                  Y02668 06640002
         USING NEL,R5              ESTABLISH BASE                Y02668 06648002
         LA    RA,RPLADDR          GET RPL BASE                  Y02668 06656002
         USING IFGRPL,RA           ESTABLISH BASE                Y02668 06664002
         MVI   RPLREQ,RPLPUT       OPERATION TO BE A PUT         Y02668 06672002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 06680003
         BO    GM5005                                          @G29AN2E 06682003
         LTR   R2,R2               TEST FOR STMT OR MSG          Y02668 06684003
         BZ    PUTSTMT             GO TO STMT PROCESSING         Y02668 06686003
GM5005   DS    0H                                              @G29AN2E 06688003
         MVC   RPLDACB,NELMSGCB    MOVE IN ACB POINTER           Y02668 06696002
         B     GM551               BRANCH ARROUND TEXT PROC      Y02668 06704002
PUTSTMT  MVC   RPLDACB,NELSTMCB    MOVE ACB POINTER              Y02668 06712002
GM551    ST    R3,RPLAREA          POINTER TO RECORD             Y02668 06720002
         XC    RPLARG(4),RPLARG    ZERO FIELD                    Y02668 06728002
         MVI   RPLOPT1,RPLSEQ      SET TO SEQUENTIAL             Y02668 06736002
         ST    R4,RPLRLEN          STORE RECORD LENGTH.          Y02668 06744002
         XC    RPLBUFL(4),RPLBUFL  ZERO BUFFER LENGTH.           Y02668 06752002
         XC    RPLDDDD(4),RPLDDDD  ZERO RETURN POINTER           Y02668 06760002
         ST    RD,IWASACHN         CHAIN SAVE AREAS              Y02668 06768002
         LA    RD,IWAIOSA          POINT OT ACC. MTHD. SAVE AREA Y02668 06772002
         LR    R1,RA            REG. 1 POINTS TO RPL             Y02668 06776002
         PUT   RPL=(1)                                                  06784002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 06800002
         TM    AOSW1,AOIOERR       I/O ERROR FROM LIST DATA SET? Y02668 06816002
         BO    ERREXIT             IF YES GO TO IEFVHN           Y02668 06824002
         LTR   RF,RF               CHECK RETURN CODE             Y02668 06832002
         BCR   8,R9                RETURN TO CALLER              Y02668 06840002
**********************************************************************  06848002
*        I/O ERROR MESSAGE HANDLER                               Y02668 06856002
**********************************************************************  06864002
         CLC   RPLDACB,NELMSGCB    I/O ERROR ON MSG DATA SET?    Y02668 06904002
         BE    MSGDSERR            ISSUE MSG ERROR WTO           Y02668 06912002
         LA    R5,4                I/O ERROR MSG CODE            Y02668 06915002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 06918002
         BALR  RE,RF               GO TO ISSUE MSG               Y02668 06921002
         LA    R2,20               I/O ERROR MSG CODE            Y02668 06924002
         MVI   AOSW1,AOIOERR       SET LIST I/O ERROR IN IWA     Y02668 06928002
         MVC   1(159,R6),0(R6)     ZERO WORK BUFFER              Y02668 06936002
         LR    R8,R6               SET WORK BUFFER POINTER       Y02668 06944002
         B     GM210               GO TO PUT OUT MESSAGE         Y02668 06952002
MSGDSERR DS    0H                                                Y02668 06953002
         LA    R5,5                I/O ERROR MSG CODE            Y02668 06954002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 06955002
         BALR  RE,RF               GO TO ISSUE MSG               Y02668 06956002
**********************************************************************  06960002
*        EXIT ROUTINE I/O ERROR                                  Y02668 06968002
**********************************************************************  06976002
ERREXIT  DS    0H                                                Y02668 06984002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE IN IWA        Y02668 06992002
         OI    AOSW4,CWATERM       INDICATE TERMINATION          Y02668 07000002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 07008002
         BR    RF                  GO TO TERMINATION             Y02668 07016002
IEFVHRV  DC    V(IEFVHR)                                         Y02668 07024002
**********************************************************************  07060000
*             EXIT ROUTINE                                              07080000
*             .FREE CORE BUFFER AREA                                    07100000
*             .RETURN                                                   07120000
**********************************************************************  07140000
GM600    EQU   *                                                        07160000
GM650    EQU   *                                                        07240000
         RETURN (14,12)                                                 07260000
*****************************************************************Y02668 07260802
*   PUT HEADER ROUTINE                                           Y02668 07261602
*****************************************************************Y02668 07262402
GM700    EQU   *                                                 Y02668 07263202
         LA    R3,HEADER           GET HEADER ADDRESS            Y02668 07264002
         LA    R4,HDRLTH           GET HEADER LENGTH             Y02668 07264802
         LA    R8,HDRLINES         GET NUMBER OF LINES TO PRINT  Y02668 07265602
GM750    EQU   *                                                 Y02668 07266402
         BAL   R9,GM500            GO TO PRINT HEADER            Y02668 07267202
         LA    R3,HDRLTH(R3)       GET NEXT LINE ADDRESS         Y02668 07268002
         BCT   R8,GM750            LOOP TO PRINT NEXT LINE       Y02668 07268802
         LA    R3,WAJOBPFX         ADDR OF IWA JOB PFX           Y02668 07269602
         USING TEXT,R3             SET ADDRESSIBILITY TO PFX     Y02668 07270402
         OI    STRJINDC,JTXMHEDR   INDICATE HEADER WRITTEN       Y02668 07271202
         DROP  R3                  DROP TEXT BASE                Y02668 07272002
         B     GM360               RETURN TO PRINT MSG           Y02668 07275202
PGMERROR DC    X'0024'             PGM ERROR RETURN CODE         Y02668 07276002
HEADER   DC    CL17' STMT NO. MESSAGE'                           Y02668 07276802
         DC    CL17'-                '                           Y02668 07277602
MVC1     MVC   0(0,R6),0(R9)                                     Y02668 07280002
MVCBLANK MVC   VGM1(0,RF),VGM0(RF)   BLANK OUT REST OF BUFFER  @G29AN2E 07320003
*********************************************************************** 07360000
*             .A PRIMARY MESSAGE CONTAINS THE IEF6..I  IDENTIFICATION   07380000
*              AND ALWAYS APPEARS FIRST IN THE MESSAGE LINE.            07400000
*              IT DESCRIBES THE ERROR                                   07420000
*             .A SECONDARY MESSAGE DOES NOT HAVE AN IDENTIFICATION. IT  07440000
*              IS ASSOCIATED WITH A PARTICULAR INTERPRETER KEY. IT      07460000
*              ALWAYS FOLLOWS THE PRIMARY MESSAGE IN THE MESSAGE LINE   07480000
*              IT IDENTIFIES THE PARTICULAR PARAMETER FIELD IN ERROR    07500000
*              AND ON WHICH PARTICULAR TYPE JCL STATEMENT THE ERROR     07520000
*              OCCURRED                                                 07540000
*                                                                       07560000
*              PRIMARY MESSAGES ARE IDENTIFIED BY A PARTICULAR INTE0725 07580000
*              NAL MESSAGE NUMBER.  SECONDARY MESSAGES ARE IDENTIFI0725 07600000
*              BY THEIR INTERNAL KEY.                              0725 07620000
*             TWO TABLES ARE USED TO OBTAIN ANY GIVEN MESSAGE NUMBER    07640000
*             .TABLE1 - EACH ENTRY IN GMT1 IS 2 BYTES                   07660000
*              (GMT1)        .FIRST BYTE IS THE HIGHEST MSG NUMBER      07680000
*                                CONTAINED IN THE MODULE LOCATED AT     07700000
*                                A DISPLACEMENT VALUE  INDICATED BY THE 07720000
*                            .THE SECOND BYTE VALUE  WITHIN             07740000
*             .TABLE2 - EACH ENTRY IN GMT2 IS  8 BYTES - THE TABLE IS   07760000
*              (GMT2)  A LIST OF MESSAGE TEXT MODULES                   07780000
*                                                                       07800000
*  NOTES--     PRIMARY MESSAGE NUMBERS ARE LOCATED IN THE FIRST HAL0725 07820000
*              OF THE TABLE GMT1-SCAN BEGINS AT THE BEGINNING.     0725 07840000
*              SECONDARY MESSAGE NUMBERS (KEYS) ARE LOCATED IN THE 0725 07860000
*              LAST HALF-SCAN BEGINS AT THE MIDDLE                 0725 07880000
*                                                                       07900000
*             TABLE INSERTS SHOULD REQUIRE ONLY REASSEMBLY TO CORRECT   07920000
*              POSITION DISPLACEMENTS WITHIN TABLE 2                    07940000
*                                                                       07960000
*********************************************************************** 07980000
*          TABLE 1 -OF HIGH MESSAGE NUMBERS AND THEIR RESPECTIVE MODULE 08000000
*              POSITION DISPLACEMENTS WITHIN TABLE 2                    08020000
GMT1     EQU   *                                                        08040000
         DC    X'07'                                                    08060000
         DC    AL1(M1-GMT2)                                             08080000
         DC    X'0F'                                                    08100000
         DC    AL1(M2-GMT2)                                             08120000
         DC    X'17'                                                    08140000
         DC    AL1(M3-GMT2)                                             08160000
         DC    X'1F'                                                    08180000
         DC    AL1(M4-GMT2)                                             08200000
         DC    X'27'                                                    08220000
         DC    AL1(M5-GMT2)                                             08240000
         DC    X'2F'                                                    08260000
         DC    AL1(M6-GMT2)                                             08280000
         DC    X'37'                                                    08300000
         DC    AL1(M7-GMT2)                                             08320000
         DC    X'3F'                                               0725 08340000
         DC    AL1(M70-GMT2)                                       0725 08360000
         DC    X'50'                                           @ZA19982 08366003
         DC    AL1(M71-GMT2)                                      O106  08372019
         DC    X'00'       END OF PRIMARY MESSAGES                 0725 08380000
GMTK     EQU   *                                                   0725 08400020
         DC    AL1(THRESHMK)                                M3944,M5688 08402020
         DC    AL1(M76-GMT2)                                M3944,M5688 08402420
         DC    AL1(QNAMEK)                                        M3131 08404020
         DC    AL1(M67-GMT2)                                      20002 08408020
         DC    AL1(DUMMK)                                         19874 08420019
         DC    AL1(M78-GMT2)                                       0725 08440000
         DC    AL1(DISPK)                                         19874 08460019
         DC    AL1(M8-GMT2)                                             08480000
         DC    AL1(SEPMK)                                         19874 08500019
         DC    AL1(M9-GMT2)                                             08520000
         DC    AL1(BUFLMK)                                        19874 08540019
         DC    AL1(M10-GMT2)                                            08560000
         DC    AL1(DSORGMK)                                       19874 08580019
         DC    AL1(M11-GMT2)                                            08600000
         DC    AL1(NTMMK)                                         19874 08620019
         DC    AL1(M12-GMT2)                                            08640000
         DC    AL1(DDK)                                           19874 08660019
         DC    AL1(M13-GMT2)                                            08680000
         DC    AL1(RDPEK)                                         19874 08686019
         DC    AL1(M19-GMT2)                                       AAAA 08692015
         DC    AL1(CONDPEK)                                       19874 08702019
         DC    AL1(M14-GMT2)                                            08720000
         DC    AL1(EXECK)                                         19874 08730019
         DC    AL1(M15-GMT2)                                            08743014
         DC    AL1(ROLLJK)                                        19874 08747019
         DC    AL1(M17-GMT2)                                            08752014
         DC    AL1(JOBK)                                          19874 08772019
         DC    AL1(M16-GMT2)                                            08800000
         DC    AL1(INTKEY8)                                   M3738O106 08806019
         DC    AL1(M18-GMT2)                                            08812014
         DC    X'00'                                                    08820000
         DS    0D                                                       08840000
*          TABLE 2 -OF MESSAGE TEXT MODULES                             08860000
GMT2     EQU   *                                                        08880000
M1       DC    CL8'IEFVGM1'   MSG NOS   01   -  07                      08900000
M2       DC    CL8'IEFVGM2'             08   -  0F                      08920000
M3       DC    CL8'IEFVGM3'             10   -  17                      08940000
M4       DC    CL8'IEFVGM4'             18   -  1F                      08960000
M5       DC    CL8'IEFVGM5'             20   -  27                      08980000
M6       DC    CL8'IEFVGM6'             28   -  2F                      09000000
M7       DC    CL8'IEFVGM7'             30   -  37                 0725 09020000
M70      DC    CL8'IEFVGM70'            38   -  3F                 0725 09040000
M71      DC    CL8'IEFVGM71'            40   -  50             @ZA19982 09050003
*             INSERT NEW MODULES OF PRIMARY MESSAGES HERE          0725 09060000
*                                                                  0725 09080000
*             MODULES OF MESSAGES ASSOCIATED WITH  INTERNAL KEYS   0725 09100000
M76      DC    CL8'IEFVGM76'            1B   -  2E             @G32HPPJ 09106003
M67      DC    CL8'IEFVGM67'            2F   -  36          M3944,M5688 09116020
M78      DC    CL8'IEFVGM78'            37   -  3E                19874 09120019
M8       DC    CL8'IEFVGM8'             3F   -  46                19874 09140019
M9       DC    CL8'IEFVGM9'             47   -  4E                19874 09160019
M10      DC    CL8'IEFVGM10'            4F   -  56                19874 09180019
M11      DC    CL8'IEFVGM11'            57   -  5E                19874 09200019
M12      DC    CL8'IEFVGM12'            5F   -  66                19874 09220019
M13      DC    CL8'IEFVGM13'            67   -  6E                19874 09240019
M19      DC    CL8'IEFVGM19'            7E   -  85                19874 09260019
M14      DC    CL8'IEFVGM14'            86   -  8D                19874 09280019
M15      DC    CL8'IEFVGM15'            8E   -  94                19874 09300019
M17      DC    CL8'IEFVGM17'            A5   -  AC                19874 09320019
M16      DC    CL8'IEFVGM16'            AD   -  B4                19874 09340019
M18      DC    CL8'IEFVGM18'            F0   -  F7                19874 09360019
CF0      DC    F'0'                                                     09420000
CF0F     DC    X'0000FFFF'                                              09440000
KEFAC    EQU   GMTK-GMT1      DISPLACEMENT FACTOR TO SCAN KEY MSGS 0725 09460000
*********************************************************************** 09760002
*     WARNING MESSAGE KEY TABLE                                  Y02668 10060002
*********************************************************************** 10360002
GWRNKEYS EQU   *                   BEGINNING OF WRN KEY TABLE    Y02668 10660002
         DC    X'02'               MSG - IEF674I                 Y02668 10960002
         DC    X'04'               MSG - IEF675I                 Y02668 11260002
         DC    X'13'               MSG - IEF676I                 Y02668 11560002
         DC    X'30'               MSG - IEF648I                 Y02668 11860002
         DC    X'37'               MSG - IEF655I                 Y02668 12160002
         DC    X'38'               MSG - IEF681I                 Y02668 12460002
         DC    X'42'               MSG - IEF682I                 Y02668 12760002
         DC    X'4A'               MSG - IEF684I                 Y02668 13060002
         DC    X'4B'               MSG - IEF685I                 Y02668 13360002
         DC    X'50'          MSG - IEF686I                    @ZA19982 13410003
GWKEYEND EQU   *                   END OF WRN KEY TABLE          Y02668 13660002
GWKEYLTH EQU   GWKEYEND-GWRNKEYS   LENGTH OF WARNING KEY TABLE   Y02668 13960002
IEF677I  EQU   1                   WARNING WTO KEY               Y02668 14260002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 15630002
         END                                                            15640000
./  ADD  SSI=30872062,NAME=IEFVGM1
IEFVGM1  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES FOR THE INTERPRETER         00040000
*             NUMBERED  01  THRU  07                                    00060000
*             IDENTIFICATION NUMBERS    IEF601I  THRU  IEF607I          00080000
***********BY IEFVHA, IEFVHCB                                           00100000
M11      EQU   *                                                        00120000
         DC    X'01'                                                    00140000
         DC    AL1(M12-M11-2)                                           00160000
         DC    C'IEF601I '                                              00180000
         DC    C'INVALID STATEMENT IN '                                 00200000
         DC    C'PROCEDURE'                                             00220000
************BY  VEA                                                     00240002
M12      EQU   *                                                        00260000
         DC    X'02'                                                    00280000
         DC    AL1(M13-M12-2)                                           00300000
        DC     C'IEF674I '                                      Y02668  00320002
        DC     C'INVALID DYNAMNBR VALUE '                       Y02668  00340002
        DC     C'- 0 SUBSTITUTED'                               Y02668  00360002
***********BY IEFVHA                                                    00380000
M13      EQU   *                                                        00400000
         DC    X'03'                                                    00420000
         DC    AL1(M14-M13-2)                                           00440000
         DC    C'IEF603I '                                              00460000
         DC    C'PROCLIB DEVICE I/O ERROR '                             00480000
         DC    C'READING FOR JOB'                                       00500000
************BY  VJA,VEA                                          Y02668 00520002
M14      EQU   *                                                        00540000
         DC    X'04'                                                    00560000
         DC    AL1(M15-M14-2)                                           00580000
         DC    C'IEF675I '                                       Y02668 00600002
         DC    C'PERFORM VALUE INVALID OR OMITTED '              Y02668 00610002
         DC    C'- SYSTEM DEFAULT SUBSTITUTED'                   Y02668 00620002
***********BY IEFVHCB, IEFVHM                                           00640000
M15      EQU   *                                                        00660000
         DC    X'05'                                                    00680000
         DC    AL1(M16-M15-2)                                           00700000
         DC    C'IEF605I '                                              00720000
         DC    C'UNIDENTIFIED OPERATION FIELD'                          00740000
************BY IEFVDA                                                   00760000
M16      EQU   *                                                        00780000
         DC    X'06'                                                    00800000
         DC    AL1(M17-M16-2)                                           00820000
         DC    C'IEF606I '                                              00840000
         DC    C'MISPLACED DD STATEMENT'                                00860000
***********BY IEFVHEC                                                   00880000
M17      EQU   *                                                        00900000
         DC    X'07'                                                    00920000
         DC    AL1(MEE-M17-2)                                           00940000
         DC    C'IEF607I '                                              00960000
         DC    C'JOB HAS NO STEPS'                                      00980000
MEE      DC    X'FF'               END OF MSG MODULE INDICATOR          01000000
         MODID BR=NO                                             Y01886 01010001
         DC    C'MVM'              FUNCTION ID                   Y02668 01013002
         DC    C'01'               LEVEL #  (NEW MESSAGE)        Y02668 01016002
         END                                                            01020000
./  ADD  SSI=20621903,NAME=IEFVGM10
IEFVGM10 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              SER OF THE VOLUME FIELD                            19874 00046019
*              REF OF THE VOLUME FIELD                            19874 00049019
*              EXPDT OF THE LABEL FIELD                           19874 00052019
*              RETPD OF THE LABEL FIELD                           19874 00055019
*              BFALN OF THE DCB FIELD                             19874 00058019
*              BFTEK OF THE DCB FIELD                             19874 00061019
*              BLKSIZE OF THE DCB FIELD                           19874 00064019
*              BUFL OF THE DCB FIELD                              19874 00067019
         IEFVKEYS                                                 19874 00070019
M100     EQU   *                                                        00080000
         DC    AL1(SERMK)                                         19874 00100019
         DC    AL1(M101-M100-2)                                         00120000
         DC    C'IN THE SER SUBPARAMETER '                              00140000
         DC    C'OF THE VOLUME FIELD '                                  00160000
M101     EQU   *                                                        00180000
         DC    AL1(REFMK)                                         19874 00200019
         DC    AL1(M102-M101-2)                                         00220000
         DC    C'IN THE REF SUBPARAMETER '                              00240000
         DC    C'OF THE VOLUME FIELD '                                  00260000
M102     EQU   *                                                        00280000
         DC    AL1(EXPDTMK)                                       19874 00300019
         DC    AL1(M103-M102-2)                                         00320000
         DC    C'IN THE EXPDT SUBPARAMETER '                            00340000
         DC    C'OF THE LABEL FIELD '                                   00360000
M103     EQU   *                                                        00380000
         DC    AL1(RETPDMK)                                       19874 00400019
         DC    AL1(M104-M103-2)                                         00420000
         DC    C'IN THE RETPD SUBPARAMETER '                            00440000
         DC    C'OF THE LABEL FIELD '                                   00460000
M104     EQU   *                                                        00480000
         DC    AL1(BFALNMK)                                       19874 00500019
         DC    AL1(M105-M104-2)                                         00520000
         DC    C'IN THE BFALN SUBPARAMETER '                            00540000
         DC    C'OF THE DCB FIELD '                                     00560000
M105     EQU   *                                                        00580000
         DC    AL1(BFTEKMK)                                       19874 00600019
         DC    AL1(M106-M105-2)                                         00620000
         DC    C'IN THE BFTEK SUBPARAMETER '                            00640000
         DC    C'OF THE DCB FIELD '                                     00660000
M106     EQU   *                                                        00680000
         DC    AL1(BLKSIZMK)                                      19874 00700019
         DC    AL1(M107-M106-2)                                         00720000
         DC    C'IN THE BLKSIZE SUBPARAMETER '                          00740000
         DC    C'OF THE DCB FIELD '                                     00760000
M107     EQU   *                                                        00780000
         DC    AL1(BUFLMK)                                        19874 00800019
         DC    AL1(MEE-M107-2)                                          00820000
         DC    C'IN THE BUFL SUBPARAMETER '                             00840000
         DC    C'OF THE DCB FIELD '                                     00860000
MEE      DC    X'FF'                                                    00880000
         MODID BR=NO                                             Y01886 00890001
         END                                                            00900000
./  ADD  SSI=20621904,NAME=IEFVGM11
IEFVGM11 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              BUFNO OF THE DCB FIELD                             19874 00046019
*              BUFRQ OF THE DCB FIELD                             19874 00049019
*              CODE OF THE DCB FIELD                              19874 00052019
*              CPRI OF THE DCB FIELD                              19874 00055019
*              CYLOFL OF THE DCB FIELD                            19874 00058019
*              HIARCHY OF THE DCB FIELD                           19874 00061019
*              DEN OF THE DCB FIELD                               19874 00064019
*              DSORG OF THE DCB FIELD                             19874 00067019
         IEFVKEYS                                                 19874 00070019
M118     EQU   *                                                        00080000
         DC    AL1(BUFNOMK)                                       19874 00100019
         DC    AL1(M119-M118-2)                                         00120000
         DC    C'IN THE BUFNO SUBPARAMETER '                            00140000
         DC    C'OF THE DCB  FIELD '                                    00160000
M119     EQU   *                                                        00180000
         DC    AL1(BUFRQMK)                                       19874 00200019
         DC    AL1(M11A-M119-2)                                         00220000
         DC    C'IN THE BUFRQ SUBPARAMETER '                            00240000
         DC    C'OF THE DCB FIELD '                                     00260000
M11A     EQU   *                                                        00280000
         DC    AL1(CODEMK)                                        19874 00300019
         DC    AL1(M11B-M11A-2)                                         00320000
         DC    C'IN THE CODE SUBPARAMETER '                             00340000
         DC    C'OF THE DCB FIELD '                                     00360000
M11B     EQU   *                                                        00380000
         DC    AL1(CPRIMK)                                        19874 00400019
         DC    AL1(M11C-M11B-2)                                         00420000
         DC    C'IN THE CPRI SUBPARAMETER '                             00440000
         DC    C'OF THE DCB FIELD '                                     00460000
M11C     EQU   *                                                        00480000
         DC    AL1(CYLOFLMK)                                      19874 00500019
         DC    AL1(M11D-M11C-2)                                         00520000
         DC    C'IN THE CYLOFL SUBPARAMETER '                           00540000
         DC    C'OF THE DCB FIELD '                                     00560000
M11D     EQU   *                                                        00580000
         DC    AL1(HIARCHMK)                                      19874 00600019
         DC    AL1(M11E-M11D-2)                                         00620000
         DC    C'IN THE HIARCHY SUBPARAMETER '                     AAAA 00640015
         DC    C'OF THE DCB FIELD '                                     00660000
M11E     EQU   *                                                        00680000
         DC    AL1(DENMK)                                         19874 00700019
         DC    AL1(M11F-M11E-2)                                         00720000
         DC    C'IN THE DEN SUBPARAMETER '                              00740000
         DC    C'OF THE DCB FIELD '                                     00760000
M11F     EQU   *                                                        00780000
         DC    AL1(DSORGMK)                                       19874 00800019
         DC    AL1(MEE-M11F-2)                                          00820000
         DC    C'IN THE DSORG SUBPARAMETER '                            00840000
         DC    C'OF THE DCB FIELD '                                     00860000
MEE      DC    X'FF'                                                    00880000
         MODID BR=NO                                             Y01886 00890001
         END                                                            00900000
./  ADD  SSI=20621905,NAME=IEFVGM12
IEFVGM12 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              EROPT OF THE DCB FIELD                             19874 00046019
*              INTVL OF THE DCB FIELD                             19874 00049019
*              KEYLEN OF THE DCB FIELD                            19874 00052019
*              LIMCT OF THE DCB FIELD                             19874 00055019
*              LRECL OF THE DCB FIELD                             19874 00058019
*              MODE OF THE DCB FIELD                              19874 00061019
*              NCP OF THE DCB FIELD                               19874 00064019
*              NTM OF THE DCB FIELD                               19874 00067019
         IEFVKEYS                                                 19874 00070019
M120     EQU   *                                                        00080000
         DC    AL1(EROPTMK)                                       19874 00100019
         DC    AL1(M121-M120-2)                                         00120000
         DC    C'IN THE EROPT SUBPARAMETER '                            00140000
         DC    C'OF THE DCB FIELD '                                     00160000
M121     EQU   *                                                        00180000
         DC    AL1(INTVLMK)                                       19874 00200019
         DC    AL1(M122-M121-2)                                         00220000
         DC    C'IN THE INTVL SUBPARAMETER '                            00240000
         DC    C'OF THE DCB FIELD '                                     00260000
M122     EQU   *                                                        00280000
         DC    AL1(KEYLENMK)                                      19874 00300019
         DC    AL1(M123-M122-2)                                         00320000
         DC    C'IN THE KEYLEN SUBPARAMETER '                           00340000
         DC    C'OF THE DCB FIELD '                                     00360000
M123     EQU   *                                                        00380000
         DC    AL1(LIMCTMK)                                       19874 00400019
         DC    AL1(M124-M123-2)                                         00420000
         DC    C'IN THE LIMCT SUBPARAMETER '                            00440000
         DC    C'OF THE DCB FIELD '                                     00460000
M124     EQU   *                                                        00480000
         DC    AL1(LRECLMK)                                       19874 00500019
         DC    AL1(M125-M124-2)                                         00520000
         DC    C'IN THE LRECL SUBPARAMETER '                            00540000
         DC    C'OF THE DCB FIELD '                                     00560000
M125     EQU   *                                                        00580000
         DC    AL1(MODEMK)                                        19874 00600019
         DC    AL1(M126-M125-2)                                         00620000
         DC    C'IN THE MODE SUBPARAMETER '                             00640000
         DC    C'OF THE DCB FIELD '                                     00660000
M126     EQU   *                                                        00680000
         DC    AL1(NCPMK)                                         19874 00700019
         DC    AL1(M127-M126-2)                                         00720000
         DC    C'IN THE NCP SUBPARAMETER '                              00740000
         DC    C'OF THE DCB FIELD '                                     00760000
M127     EQU   *                                                        00780000
         DC    AL1(NTMMK)                                         19874 00800019
         DC    AL1(MEE-M127-2)                                          00820000
         DC    C'IN THE NTM SUBPARAMETER '                              00840000
         DC    C'OF THE DCB FIELD '                                     00860000
MEE      DC    X'FF'                                                    00880000
         MODID BR=NO                                             Y01886 00890001
         END                                                            00900000
./  ADD  SSI=20621906,NAME=IEFVGM13
IEFVGM13 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              OPTCD OF THE DCB FIELD                             19874 00046019
*              PRTSP OF THE DCB FIELD                             19874 00049019
*              RECFM OF THE DCB FIELD                             19874 00052019
*              RKP OF THE DCB FIELD                               19874 00055019
*              SOWA OF THE DCB FIELD                              19874 00058019
*              STACK OF THE DCB FIELD                             19874 00061019
*              TRTCH OF THE DCB FIELD                             19874 00064019
*              DD                                                 19874 00067019
         IEFVKEYS                                                 19874 00070019
M138     EQU   *                                                        00080000
         DC    AL1(OPTCDMK)                                       19874 00100019
         DC    AL1(M139-M138-2)                                         00120000
         DC    C'IN THE OPTCD SUBPARAMETER '                            00140000
         DC    C'OF THE DCB FIELD '                                     00160000
M139     EQU   *                                                        00180000
         DC    AL1(PRTSPMK)                                       19874 00200019
         DC    AL1(M13A-M139-2)                                         00220000
         DC    C'IN THE PRTSP SUBPARAMETER '                            00240000
         DC    C'OF THE DCB FIELD '                                     00260000
M13A     EQU   *                                                        00280000
         DC    AL1(RECFMMK)                                       19874 00300019
         DC    AL1(M13B-M13A-2)                                         00320000
         DC    C'IN THE RECFM SUBPARAMETER '                            00340000
         DC    C'OF THE DCB FIELD '                                     00360000
M13B     EQU   *                                                        00380000
         DC    AL1(RKPMK)                                         19874 00400019
         DC    AL1(M13C-M13B-2)                                         00420000
         DC    C'IN THE RKP SUBPARAMETER '                              00440000
         DC    C'OF THE DCB FIELD '                                     00460000
M13C     EQU   *                                                        00480000
         DC    AL1(SOWAMK)                                        19874 00500019
         DC    AL1(M13D-M13C-2)                                         00520000
         DC    C'IN THE SOWA SUBPARAMETER '                             00540000
         DC    C'OF THE DCB FIELD '                                     00560000
M13D     EQU   *                                                        00580000
         DC    AL1(STACKMK)                                       19874 00600019
         DC    AL1(M13E-M13D-2)                                         00620000
         DC    C'IN THE STACK SUBPARAMETER '                            00640000
         DC    C'OF THE DCB FIELD '                                     00660000
M13E     EQU   *                                                        00680000
         DC    AL1(TRTCHMK)                                       19874 00700019
         DC    AL1(M13F-M13E-2)                                         00720000
         DC    C'IN THE TRTCH SUBPARAMETER '                            00740000
         DC    C'OF THE DCB FIELD '                                     00760000
M13F     EQU   *                                                        00780000
         DC    AL1(DDK)                                           19874 00800019
         DC    AL1(MEE-M13F-2)                                          00820000
         DC    C'ON THE DD STATEMENT'                                   00840000
MEE      DC    X'FF'                                                    00860000
         MODID BR=NO                                             Y01886 00870001
         END                                                            00880000
./  ADD  SSI=20601895,NAME=IEFVGM14
IEFVGM14 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              ROLL OVERRIDE                                      19874 00046019
*              ROLL                                               19874 00049019
*              REGION OVERRIDE                                    19874 00052019
*              REGION                                             19874 00055019
*              PGM                                                19874 00058019
*              PROC                                               19874 00061019
*              ACCT OVERRIDE                                      19874 00064019
*              COND OVERRIDE                                      19874 00067019
         IEFVKEYS                                                 19874 00070019
M148     EQU   *                                                        00080000
         DC    AL1(ROLLPEK)                                       19874 00085019
         DC    AL1(M149-M148-2)                                         00090014
         DC    C'IN THE ROLL OVERRIDE FIELD'                            00095014
M149     EQU   *                                                        00100000
         DC    AL1(ROLLEEK)                                       19874 00105019
         DC    AL1(M14A-M149-2)                                         00110014
         DC    C'IN THE ROLL FIELD'                                     00115014
M14A     EQU   *                                                        00120000
         DC    AL1(REGINPEK)                                      19874 00140019
         DC    AL1(M14B-M14A-2)                                         00160000
         DC    C'IN THE REGION OVERRIDE FIELD '                         00180000
M14B     EQU   *                                                        00200000
         DC    AL1(REGINEEK)                                      19874 00220019
         DC    AL1(M14C-M14B-2)                                         00240000
         DC    C'IN THE REGION FIELD '                                  00260000
M14C     EQU   *                                                        00280000
         DC    AL1(PGMEK)                                         19874 00300019
         DC    AL1(M14D-M14C-2)                                         00320000
         DC    C'IN THE PGM FIELD '                                     00340000
M14D     EQU   *                                                        00360000
         DC    AL1(PROCEK)                                        19874 00380019
         DC    AL1(M14E-M14D-2)                                         00400000
         DC    C'IN THE PROC FIELD '                                    00420000
M14E     EQU   *                                                        00440000
         DC    AL1(ACCTPEK)                                       19874 00460019
         DC    AL1(M14F-M14E-2)                                         00480000
         DC    C'IN THE ACCT OVERRIDE FIELD '                           00500000
M14F     EQU   *                                                        00520000
         DC    AL1(CONDPEK)                                       19874 00540019
         DC    AL1(MEE-M14F-2)                                          00560000
         DC    C'IN THE COND OVERRIDE FIELD '                           00580000
MEE      DC    X'FF'                                                    00600000
         MODID BR=NO                                             Y01886 00610001
         END                                                            00620000
./  ADD  SSI=20820081,NAME=IEFVGM15
IEFVGM15 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00044019
*              PARM OVERRIDE                                      19874 00048019
*              TIME OVERRIDE                                      19874 00052019
*              ACCT                                               19874 00056019
*              COND                                               19874 00060019
*              PARM                                               19874 00064019
*              TIME                                               19874 00068019
*              EXEC                                               19874 00072019
         IEFVKEYS                                                 19874 00076019
M150     EQU   *                                                        00080000
         DC    AL1(PARMPEK)                                       19874 00100019
         DC    AL1(M151-M150-2)                                         00120000
         DC    C'IN THE PARM OVERRIDE FIELD '                           00140000
M151     EQU   *                                                        00160000
         DC    AL1(TIMEPEK)                                       19874 00180019
         DC    AL1(M152-M151-2)                                         00200000
         DC    C'IN THE TIME OVERRIDE FIELD '                           00220000
M152     EQU   *                                                        00240000
         DC    AL1(ACCTEEK)                                       19874 00260019
         DC    AL1(M153-M152-2)                                         00280000
         DC    C'IN THE ACCT FIELD '                                    00300000
M153     EQU   *                                                        00320000
         DC    AL1(CONDEEK)                                       19874 00340019
         DC    AL1(M154-M153-2)                                         00360000
         DC    C'IN THE COND FIELD '                                    00380000
M154     EQU   *                                                        00400000
         DC    AL1(PARMEEK)                                       19874 00420019
         DC    AL1(M155-M154-2)                                         00440000
         DC    C'IN THE PARM FIELD '                                    00460000
M155     EQU   *                                                        00480000
         DC    AL1(TIMEEEK)                                       19874 00500019
         DC    AL1(M156-M155-2)                                         00520000
         DC    C'IN THE TIME FIELD '                                    00540000
M156     EQU   *                                                        00560000
         DC    AL1(EXECK)                                         19874 00580019
         DC    AL1(M157-M156-2)                                         00600000
         DC    C'ON THE EXEC STATEMENT'                                 00620000
M157     EQU   *                                                        00640000
MEE      DC    X'FF'                                                    00660000
         MODID BR=NO                                             Y10886 00670001
         END                                                            00680000
./  ADD  SSI=20601897,NAME=IEFVGM16
IEFVGM16 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              CLASS                                              19874 00046019
*              REGION                                             19874 00049019
*              COND                                               19874 00052019
*              PRTY                                               19874 00055019
*              TYPRUN                                             19874 00058019
*              MSGCLASS                                           19874 00061019
*              MSGLEVEL                                           19874 00064019
*              JOB                                                19874 00067019
         IEFVKEYS                                                 19874 00070019
M160     EQU   *                                                        00080000
         DC    AL1(CLASSJK)                                       19874 00085019
         DC    AL1(M161-M160-2)                                         00090014
         DC    C'IN THE CLASS FIELD'                                    00095014
M161     EQU   *                                                        00100000
         DC    AL1(REGINJK)                                       19874 00120019
         DC    AL1(M162-M161-2)                                         00140000
         DC    C'IN THE REGION FIELD '                                  00160000
M162     EQU   *                                                        00180000
         DC    AL1(CONDJK)                                        19874 00200019
         DC    AL1(M163-M162-2)                                         00220000
         DC    C'IN THE COND FIELD '                                    00240000
M163     EQU   *                                                        00260000
         DC    AL1(PRTYJK)                                        19874 00280019
         DC    AL1(M164-M163-2)                                         00300000
         DC    C'IN THE PRTY FIELD '                                    00320000
M164     EQU   *                                                        00340000
         DC    AL1(TYPRUNJK)                                      19874 00360019
         DC    AL1(M165-M164-2)                                         00380000
         DC    C'IN THE TYPRUN FIELD '                                  00400000
M165     EQU   *                                                        00420000
         DC    AL1(MSGCLAJK)                                      19874 00440019
         DC    AL1(M166-M165-2)                                         00460000
         DC    C'IN THE MSGCLASS FIELD '                                00480000
M166     EQU   *                                                        00500000
         DC    AL1(MSGLEVJK)                                      19874 00520019
         DC    AL1(M167-M166-2)                                         00540000
         DC    C'IN THE MSGLEVEL FIELD '                                00560000
M167     EQU   *                                                        00580000
         DC    AL1(JOBK)                                          19874 00600019
         DC    AL1(MEE-M167-2)                                          00620000
         DC    C'ON THE JOB STATEMENT'                                  00640000
MEE      DC    X'FF'                                                    00660000
         MODID BR=NO                                             Y01886 00670001
         END                                                            00680000
./  ADD  SSI=80300048,NAME=IEFVGM17
IEFVGM17 CSECT                                                          06000014
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         12000014
*             INTERPRETER KEYS                                    19874 13000019
*              TIME                                               19874 14000019
*              RESTART                                            19874 15000019
*              RD                                                 19874 16000019
*              ROLL                                               19874 17000019
*              ADDRSPC                                           Y01029 17050001
*              PERFORM                                         @ZA02127 17350003
*              USER                                            @Z40RPTH 17650003
*              PASSWORD                                        @Z40RPSM 17700003
*              GROUP                                           @Z40RPSM 17750003
*  CHANGE LEVEL = ZA02127,Z40RPTH,Z40RPSM,ZA27753              @ZA27753 17800003
*                                                                       17850003
         IEFVKEYS                                                 19874 17900003
M174     EQU   *                                               @Z40RPSM 17950003
         DC    AL1(GROUPK)                                     @Z40RPSM 18000003
         DC    AL1(M175-M174-2)                                @Z40RPSM 18050003
         DC    C' IN THE GROUP FIELD'                          @Z40RPSM 18100003
M175     EQU   *                                               @Z40RPTH 18150003
         DC    AL1(PASWORDK)                                   @Z40RPSM 18200003
         DC    AL1(M176-M175-2)                                @Z40RPTH 18250003
         DC    C' IN THE PASSWORD FIELD'                       @Z40RPSM 18300003
M176     EQU   *                                               @Z40RPTH 18350003
         DC    AL1(USERK)                                      @Z40RPTH 18400003
         DC    AL1(M177-M176-2)                                @Z40RPTH 18450003
         DC    C' IN THE USER FIELD'                           @Z40RPTH 18500003
M177     EQU   *                                                   AAAA 24000015
         DC    AL1(PRFMJK)                                     @ZA02127 24700003
         DC    AL1(M178-M177-2)                                @ZA02127 25400003
         DC    C' IN THE PERFORM FIELD '                       @ZA02127 26100003
M178     EQU   *                                                   AAAA 27000015
         DC    AL1(ADRSPJK)                                      Y01029 27050001
         DC    AL1(M179-M178-2)   *                              Y01029 27060001
         DC    C'IN THE ADDRSPC FIELD'                           Y01029 27100001
M179     EQU   *                                                   AAAA 30000015
         DC    AL1(NOTIFYJK)                                     M24012 30700001
         DC    AL1(M17A-M179-2)                                  M24012 31400001
         DC    C'IN THE NOTIFY FIELD'                            M24012 32100001
M17A     EQU   *                                                   AAAA 33000015
         DC    AL1(TIMEJK)                                        19874 33700019
         DC    AL1(M17B-M17A-2)        *                           SMF1 34400018
         DC    C'IN THE TIME FIELD'    *                           SMF1 35100018
M17B     EQU   *                                                   AAAA 36000015
         DC    AL1(RESTARJK)                                      19874 39000019
         DC    AL1(M17C-M17B-2)                                    AAAA 42000015
         DC    C'IN THE RESTART FIELD'                             AAAA 45000015
M17C     EQU   *                                                   AAAA 48000015
         DC    AL1(RDJK)                                          19874 51000019
         DC    AL1(M17D-M17C-2)                                    AAAA 54000015
         DC    C'IN THE RD FIELD'                                  AAAA 57000015
M17D     EQU   *                                                   AAAA 60000015
         DC    AL1(ROLLJK)                                        19874 63000019
         DC    AL1(MEE-M17D-2)                                  YM00390 66000002
         DC    C'IN THE ROLL FIELD'                                     84000014
MEE      DC    X'FF'                   END OF MODULE INDICATOR          90000014
         MODID BR=NO                                             Y01886 90050001
*        DC    C'REL4'              FUNCTION ID AND            @Z40RPTH 91050003
*        DC    C'01'    LEVEL # (RACF.)                        @Z40RPSM 91100003
         DC    C'02'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27753 91150003
         END                                                            91200003
./  ADD  SSI=20601899,NAME=IEFVGM18
IEFVGM18 CSECT                                                          04000014
*             THIS MODULE CONTAINS SECONDARY MESSAGES FOR THE           08000014
*              INTERNAL KEYS                                      19874 12000019
         IEFVKEYS                                                 19874 16000019
M180     EQU   *                                                        20000014
         DC    AL1(INTKEY1)                                       19874 24000019
         DC    AL1(M181-M180-2)                                         28000014
         DC    C'IN THE SYMBOLIC PARAMETER'                             32000014
M181     EQU   *                                                        36000014
         DC    AL1(INTKEY2)                                       19874 40000019
         DC    AL1(M182-M181-2)                                         44000014
         DC    C'IN THE VALUE FIELD '                                   48000014
         DC    C'OF THE SYMBOLIC PARAMETER'                             52000014
M182     EQU   *                                                        56000014
         DC    AL1(INTKEY3)                                       19874 57000019
         DC    AL1(M183-M182-2)                                         58000014
         DC    C'ON THE PROC STATEMENT'                                 59000014
M183     EQU   *                                                        60000014
         DC    AL1(INTKEY4)                                       19874 61000019
         DC    AL1(M184-M183-2)                                    AACA 62000017
         DC    C'PASS SUBSTITUTED'                                 AACA 63000017
M184     EQU   *                                                   AACA 64000017
         DC    AL1(INTKEY5)                                       19874 65000019
         DC    AL1(M185-M184-2)                                    AACA 66000017
         DC    C'KEEP SUBSTITUTED'                                 AACA 67000017
M185     EQU   *                                                        68000014
         DC    AL1(INTKEY6)                                             69000019
         DC    AL1(M186-M185-2)                                   O106  70000019
         DC    C'ON THE PEND STATEMENT'                           O106  71000019
M186     EQU   *                                                        72000014
M187     EQU   *                                                        76000014
MEE      DC    X'FF'              END OF MODULE INDICATOR               80000014
         MODID BR=NO                                             Y01886 80050001
         END                                                            84000014
./  ADD  SSI=43390060,NAME=IEFVGM19
IEFVGM19 CSECT                                                          04000015
*              THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE        08000015
*             INTERPRETER KEYS                                    19874 09000019
*              DPRTY                                              19874 10000019
*              DPRTY OVERRIDE                                     19874 11000019
*              SYSTEM FLAGS                                       19874 12000019
*              RD                                                 19874 13000019
*              RD OVERRIDE                                              14000001
*              ADDRSPC                                           Y01029 14100001
*              ADDRSPC OVERRIDE                                  Y01029 14150001
*              DYNAMNBR                                        @ZA02127 14250003
*              DYNAMNBR OVERRIDE                               @ZA02127 14350003
*              PERFORM                                         @ZA02127 14450003
*              PERFORM OVERRIDE                                @ZA02127 14550003
*                                                                       14650003
*    CHANGE LEVEL = 11/05/74                                   @ZA02127 14750003
* A 142500-145500, 150500-158000,850500,860500                 @ZA02127 14850003
* D 400000-480000                                              @ZA02127 14920003
         IEFVKEYS                                                 19874 15000019
M19B     EQU   *                                               @ZA02127 15050003
         DC    AL1(DYNMPEK)                                    @ZA02127 15100003
         DC    AL1(M19C-M19B-2)                                @ZA02127 15150003
         DC    C' IN THE DYNAMNBR OVERRIDE FIELD '             @ZA02127 15200003
M19C     EQU   *                                               @ZA02127 15250003
         DC    AL1(DYNMEEK)                                    @ZA02127 15300003
         DC    AL1(M19D-M19C-2)                                @ZA02127 15350003
         DC    C' IN THE DYNAMNBR FIELD '                      @ZA02127 15400003
M19D     EQU   *                                               @ZA02127 15450003
         DC    AL1(PRFMPEK)                                    @ZA02127 15500003
         DC    AL1(M19E-M19D-2)                                @ZA02127 15550003
         DC    C' IN THE PERFORM OVERRIDE FIELD '              @ZA02127 15600003
M19E     EQU   *                                               @ZA02127 15650003
         DC    AL1(PRFMEEK)                                    @ZA02127 15700003
         DC    AL1(M19F-M19E-2)                                @ZA02127 15750003
         DC    C' IN THE PERFORM FIELD '                       @ZA02127 15800003
M19F     EQU   *                                                 Y01029 20000001
         DC    AL1(ADRSPPEK)                                     Y01029 20050001
         DC    AL1(M190-M19F-2)                                  Y01029 20100001
         DC    C'IN THE ADDRSPC OVERRIDE FIELD'                  Y01029 20150001
M190     EQU   *                                                 Y01029 24000001
         DC    AL1(ADRSPEEK)                                     Y01029 24050001
         DC    AL1(M191-M190-2)                                  Y01029 24100001
         DC    C'IN THE ADDRSPC FIELD'                           Y01029 24150001
M191     EQU   *                                                        28000015
         DC    AL1(SDPPEK)                                       19874  29000019
         DC    AL1(M192-M191-2)                                    I241 30000018
         DC    C'IN THE DPRTY OVERRIDE FIELD'                      I241 31000018
M192     EQU   *                                                        32000015
         DC    AL1(SDPEEK)                                        19874 33000019
         DC    AL1(M193-M192-2)                                    I241 34000018
         DC    C'IN THE DPRTY FIELD'                               I241 35000018
M193     EQU   *                                                        36000015
M194     EQU   *                                                        52000015
         DC    AL1(RDEEK)                                         19874 56000019
         DC    AL1(M195-M194-2)                                         60000015
         DC    C'IN THE RD FIELD'                                       64000015
M195     EQU   *                                                        68000015
         DC    AL1(RDPEK)                                         19874 72000019
         DC    AL1(MEE-M195-2)                                          76000015
         DC    C'IN THE RD OVERRIDE FIELD'                              80000015
MEE      DC    X'FF'                   END OF MODULE INDICATOR          84000015
         MODID BR=NO                                             Y01886 84050001
         DC    C'REL3'         FUNCTION ID                     @ZA02127 85050003
         DC    C'01'    LEVEL # (PERFORM & DYNAMNBR MSGS)      @ZA02127 86050003
         END                                                            88000015
./  ADD  SSI=20601900,NAME=IEFVGM2
IEFVGM2  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES FOR THE INTERPRETER         00040000
*             NUMBERED  08  THRU  0F                                    00060000
*             IDENTIFICATION NUMBERS    IEF608I  THRU  IEF615I          00080000
************BY IEFVHI                                                   00100000
M28      EQU   *                                                        00120000
         DC    X'08'                                                    00140000
         DC    AL1(M29-M28-2)                                           00160000
         DC    C'IEF608I '                                              00180000
         DC    C'SPOOL DEVICE I/O ERROR '                               00200000
         DC    C'WRITING FOR JOB'                                       00220000
************BY IEFVEA                                                   00240000
M29      EQU   *                                                        00260000
         DC    X'09'                                                    00280000
         DC    AL1(M2A-M29-2)                                           00300000
         DC    C'IEF609I '                                              00320000
         DC    C'INVALID OVERRIDE KEYWORD'                              00340000
************BY IEFVHEC                                                  00360000
M2A      EQU   *                                                        00380000
         DC    X'0A'                                                    00400000
         DC    AL1(M2B-M2A-2)                                           00420000
         DC    C'IEF610I '                                              00440000
         DC    C'PROCEDURE HAS NO STEP'                                 00460000
************BY IEFVHH,IEFVHEB,IEFVHCB                                   00480000
M2B      EQU   *                                                        00500000
         DC    X'0B'                                                    00520000
         DC    AL1(M2C-M2B-2)                                           00540000
         DC    C'IEF611I '                                              00560000
         DC    C'OVERRIDDEN STEP NOT '                                  00580000
         DC    C'FOUND IN PROCEDURE'                                    00600000
************BY IEFVEA                                                   00620000
M2C      EQU   *                                                        00640000
* THIS MESSAGE WAS CHANGED FOR O106.  IT WAS SHORTENED FROM        O106 00650019
* PROCEDURE NOT FOUND IN PROCLIB.  THE MESSAGE IS PRINTED WHEN     O106 00651019
* THE PROCEDURE CAN NOT BE FOUND IN THE PROCLIB OR IN THE IN-LINE  O106 00652019
* PROCEDURE DIRECTORY.                                             O106 00653019
         DC    X'0C'                                                    00660000
         DC    AL1(M2D-M2C-2)                                           00680000
         DC    C'IEF612I '                                              00700000
         DC    C'PROCEDURE NOT FOUND '                                  00720000
************BY IEFVEA                                                   00760000
M2D      EQU   *                                                        00780000
         DC    X'0D'                                                    00800000
         DC    AL1(M2E-M2D-2)                                           00820000
         DC    C'IEF613I '                                              00840000
         DC    C'PROCEDURE WITHIN A '                                   00860000
         DC    C'PROCEDURE'                                             00880000
************BY IEFVEA                                                   00900000
M2E      EQU   *                                                        00920000
         DC    X'0E'                                                    00940000
         DC    AL1(M2F-M2E-2)                                           00960000
         DC    C'IEF614I '                                              00980000
         DC    C'PROCLIB DEVICE I/O ERROR '                             01000000
         DC    C'SEARCHING FOR PROCEDURE'                               01020000
************BY IEFVEA                                                   01040000
M2F      EQU   *                                                        01060000
         DC    X'0F'                                                    01080000
         DC    AL1(MEE-M2F-2)                                           01100000
         DC    C'IEF615I '                                              01120000
         DC    C'EXCESSIVE PROCSTEP NAME'                               01140000
MEE      DC    X'FF'               END OF MSG MODULE INDICATOR          01160000
         MODID BR=NO                                             Y01886 01170001
         END                                                            01180000
./  ADD  SSI=30872064,NAME=IEFVGM3
IEFVGM3  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES FOR THE INTERPRETER         00040000
*             NUMBERED  10  THRU  17                                    00060000
*             IDENTIFICATION NUMBERS    IEF616I  THRU  IEF623I          00080000
***********BY IEFVFA                                                    00100000
M30      EQU   *                                                        00120000
         DC    X'10'                                                    00140000
         DC    AL1(M31-M30-2)                                           00160000
         DC    C'IEF616I '                                              00180000
         DC    C'SUBLIST WITH SUBLIST '                                 00200000
         DC    C'INCORRECT'                                             00220000
************BY IEFVDA                                                   00240000
M31      EQU   *                                                        00260000
         DC    X'11'                                                    00280000
         DC    AL1(M32-M31-2)                                           00300000
         DC    C'IEF617I '                                              00320000
         DC    C'NO NAME ON FIRST DD '                                  00340000
         DC    C'STATEMENT AFTER EXEC '                                 00360000
         DC    C'STATEMENT'                                             00380000
***********BY IEFVFA                                                    00400000
M32      EQU   *                                                        00420000
         DC    X'12'                                                    00440000
         DC    AL1(M33-M32-2)                                           00460000
         DC    C'IEF618I '                                              00480000
         DC    C'OPERAND FIELD DOES NOT '                               00500000
         DC    C'TERMINATE IN COMMA OR '                                00520000
         DC    C'BLANK'                                                 00540000
************BY  VJA,VEA                                          Y02668 00560002
M33      EQU   *                                                        00580000
         DC    X'13'                                                    00600000
         DC    AL1(M34-M33-2)                                           00620000
         DC    C'IEF676I '                                       Y02668 00640002
         DC    C'PERFORM VALUE UNDEFINED TO '                    Y02668 00660002
         DC    C'SYSTEM - DEFAULT SUBSTITUTED'                   Y02668 00680002
************BY  VHCB,VHE,VGM,VINA,VHA                            Y02668 00700002
M34      EQU   *                                                        00720000
         DC    X'14'                                                    00740000
         DC    AL1(M35-M34-2)                                           00760000
         DC    C'IEF678I '                                       Y02668 00780002
         DC    C'DEVICE I/O ERROR '                              Y02668 00800002
         DC    C'CONVERTING/INTERPRETING JCL'                    Y02668 00820002
************BY IEFVFA,IEFVHB,IEFVHC                                     00840000
M35      EQU   *                                                        00860000
         DC    X'15'                                                    00880000
         DC    AL1(M36-M35-2)                                           00900000
         DC    C'IEF621I '                                              00920000
         DC    C'EXPECTED CONTINUATION '                                00940000
         DC    C'NOT RECEIVED'                                          00960000
***********BY IEFVFA                                                    00980000
M36      EQU   *                                                        01000000
         DC    X'16'                                                    01020000
         DC    AL1(M37-M36-2)                                           01040000
         DC    C'IEF622I '                                              01060000
         DC    C'UNBALANCED PARENTHESIS'                                01080000
***********BY IEFVFA                                                    01100000
M37      EQU   *                                                        01120000
         DC    X'17'                                                    01140000
         DC    AL1(MEE-M37-2)                                           01160000
         DC    C'IEF623I '                                              01180000
         DC    C'SOURCE TEXT CONTAINS '                                 01200000
         DC    C'UNDEFINED OR ILLEGAL '                                 01220000
         DC    C'CHARACTERS'                                            01240000
MEE      DC    X'FF'               END OF MSG MODULE INDICATOR          01260000
         MODID BR=NO                                             Y01886 01270001
         DC    C'MVM'              FUNCTION ID                   Y02668 01273002
         DC    C'01'               LEVEL #  (NEW MESSAGE)        Y02668 01276002
         END                                                            01280000
./  ADD  SSI=20601901,NAME=IEFVGM4
IEFVGM4  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES FOR THE INTERPRETER         00040000
*             NUMBERED  18  THRU  1F                                    00060000
*             IDENTIFICATION NUMBERS    IEF624I  THRU  IEF631I          00080000
************BY IEFVFA                                                   00100000
M48      EQU   *                                                        00120000
         DC    X'18'                                                    00140000
         DC    AL1(M49-M48-2)                                           00160000
         DC    C'IEF624I '                                              00180000
         DC    C'INCORRECT USE OF PERIOD'                               00200000
************BY IEFVFA                                                   00220000
M49      EQU   *                                                        00240000
         DC    X'19'                                                    00260000
         DC    AL1(M4A-M49-2)                                           00280000
         DC    C'IEF625I '                                              00300000
         DC    C'INCORRECT USE OF LEFT '                                00320000
         DC    C'PARENTHESIS'                                           00340000
************BY IEFVFA                                                   00360000
M4A      EQU   *                                                        00380000
         DC    X'1A'                                                    00400000
         DC    AL1(M4B-M4A-2)                                           00420000
         DC    C'IEF626I '                                              00440000
         DC    C'INCORRECT USE OF PLUS'                                 00460000
************BY IEFVFA                                                   00480000
M4B      EQU   *                                                        00500000
         DC    X'1B'                                                    00520000
         DC    AL1(M4C-M4B-2)                                           00540000
         DC    C'IEF627I '                                              00560000
         DC    C'INCORRECT USE OF '                                     00580000
         DC    C'AMPERSAND'                                             00600000
************BY IEFVFA                                                   00620000
M4C      EQU   *                                                        00640000
         DC    X'1C'                                                    00660000
         DC    AL1(M4D-M4C-2)                                           00680000
         DC    C'IEF628I '                                              00700000
         DC    C'INCORRECT USE OF '                                     00720000
         DC    C'ASTERISK'                                              00740000
************BY IEFVFA                                                   00760000
M4D      EQU   *                                                        00780000
         DC    X'1D'                                                    00800000
         DC    AL1(M4E-M4D-2)                                           00820000
         DC    C'IEF629I '                                              00840000
         DC    C'INCORRECT USE OF '                                     00860000
         DC    C'APOSTROPHE'                                            00880000
************BY IEFVFA                                                   00900000
M4E      EQU   *                                                        00920000
         DC    X'1E'                                                    00940000
         DC    AL1(M4F-M4E-2)                                           00960000
         DC    C'IEF630I '                                              00980000
         DC    C'UNIDENTIFIED KEYWORD'                                  01000000
************BY IEFVDA                                                   01020000
M4F      EQU   *                                                        01040000
         DC    X'1F'                                                    01060000
         DC    AL1(MEE-M4F-2)                                           01080000
         DC    C'IEF631I '                                              01100000
         DC    C'NUMBER OF DDNAMES '                                    01120000
         DC    C'EXCEEDS MAXIMUM'                                       01140000
MEE      DC    X'FF'               END OF MSG MODULE INDICATOR          01160000
         MODID BR=NO                                             Y01886 01170001
         END                                                            01180000
./  ADD  SSI=20601902,NAME=IEFVGM5
IEFVGM5  CSECT                                                          00020000
*             THIS MODULE CONTAINS THE MESSAGES FOR THE INTERPRETER     00040000
*             NUMBERED  20  THRU  27                                    00060000
*             IDENTIFICATION NUMBERS    IEF632I  THRU  IEF639I          00080000
************BY IEFVJA,IEFVEA                                            00100000
M50      EQU   *                                                        00120000
         DC    X'20'                                                    00140000
         DC    AL1(M51-M50-2)                                           00160000
         DC    C'IEF632I '                                              00180000
         DC    C'FORMAT ERROR'                                          00200000
************BY IEFVJA                                                   00220000
M51      EQU   *                                                        00240000
         DC    X'21'                                                    00260000
         DC    AL1(M52-M51-2)                                           00280000
         DC    C'IEF633I '                                              00300000
         DC    C'PROGRAMMER NAME MISSING'                               00320000
************BY IEFVJA                                                   00340000
M52      EQU   *                                                        00360000
         DC    X'22'                                                    00380000
         DC    AL1(M53-M52-2)                                           00400000
         DC    C'IEF634I '                                              00420000
         DC    C'ACCOUNT NUMBER MISSING'                                00440000
************BY IEFVJA                                                   00460000
M53      EQU   *                                                        00480000
         DC    X'23'                                                    00500000
         DC    AL1(M54-M53-2)                                           00520000
         DC    C'IEF635I '                                              00540000
         DC    C'JOBNAME MISSING'                                       00560000
************BY IEFVDA                                                   00580000
M54      EQU   *                                                        00600000
         DC    X'24'                                                    00620000
         DC    AL1(M55-M54-2)                                           00640000
         DC    C'IEF636I '                                              00660000
         DC    C'MISPLACED JOBLIB '                                     00680000
         DC    C'STATEMENT'                                             00700000
************BY IEFVJA,IEFVEA                                            00720000
M55      EQU   *                                                        00740000
         DC    X'25'                                                    00760000
         DC    AL1(M56-M55-2)                                           00780000
         DC    C'IEF637I '                                              00800000
         DC    C'EXCESSIVE ACCOUNT '                                    00820000
         DC    C'FIELD LENGTH'                                          00840000
************BY IEFVGT,IEFVEA                                            00860000
M56      EQU   *                                                        00880000
         DC    X'26'                                                    00900000
         DC    AL1(M57-M56-2)                                           00920000
         DC    C'IEF638I '                                              00940000
         DC    C'SPECIFIED NUMERIC EXCEEDS '                       0725 00960000
         DC    C'MAXIMUM ALLOWED'                                       00980000
************BY IEFVGT                                                   01000000
M57      EQU   *                                                        01020000
         DC    X'27'                                                    01040000
         DC    AL1(MEE-M57-2)                                           01060000
         DC    C'IEF639I '                                              01080000
         DC    C'INVALID CLASS DESIGNATION'                             01100000
MEE      DC    X'FF'               END OF MSG MODULE INDICATOR          01120000
         MODID BR=NO                                             Y01886 01130001
         END                                                            01140000
./  ADD  SSI=20801046,NAME=IEFVGM6
IEFVGM6  CSECT                                                          00020000
*             THIS MODULE CONTAINS THE MESSAGES FOR THE INTERPRETER     00040000
*             NUMBERED  28  THRU  2F                                    00060000
*             IDENTIFICATION NUMBERS    IEF640I  THRU  IEF647I          00080000
************BY IEFVGS,IEFVDA,IEFVGK                                     00100000
M68      EQU   *                                                        00120000
         DC    X'28'                                                    00140000
         DC    AL1(M69-M68-2)                                           00160000
         DC    C'IEF640I '                                              00180000
         DC    C'EXCESSIVE NUMBER OF POSITIONAL '                       00200000
         DC    C'PARAMETERS'                                            00220000
************BY IEFVGK                                                   00240000
M69      EQU   *                                                        00260000
         DC    X'29'                                                    00280000
         DC    AL1(M6A-M69-2)                                           00300000
         DC    C'IEF641I '                                              00320000
         DC    C'IMPROPER SUBPARAMETER LIST'                            00340000
************BY IEFVEA,IEFVDA,IEFVGT                                     00360000
M6A      EQU   *                                                        00380000
         DC    X'2A'                                                    00400000
         DC    AL1(M6B-M6A-2)                                           00420000
         DC    C'IEF642I '                                              00440000
         DC    C'EXCESSIVE PARAMETER LENGTH'                            00460000
************BY IEFVGT                                                   00480000
M6B      EQU   *                                                        00500000
         DC    X'2B'                                                    00520000
         DC    AL1(M6C-M6B-2)                                           00540000
         DC    C'IEF643I '                                              00560000
         DC    C'UNIDENTIFIED POSITIONAL '                              00580000
         DC    C'PARAMETER'                                             00600000
************BY IEFVGT                                                   00620000
M6C      EQU   *                                                        00640000
         DC    X'2C'                                                    00660000
         DC    AL1(M6D-M6C-2)                                           00680000
         DC    C'IEF644I '                                              00700000
         DC    C'INVALID NUMERIC'                                       00720000
************BY IEFVGS,IEFVDA                                            00740000
M6D      EQU   *                                                        00760000
         DC    X'2D'                                                    00780000
         DC    AL1(M6E-M6D-2)                                           00800000
         DC    C'IEF645I '                                              00820000
         DC    C'INVALID REFERBACK'                                     00840000
************BY IEFVDA                                                   00860000
M6E      EQU   *                                                        00880000
         DC    X'2E'                                                    00900000
         DC    AL1(M6F-M6E-2)                                           00920000
         DC    C'IEF646I '                                              00940000
         DC    C'REQUIRED POSITIONAL '                                  00960000
         DC    C'PARAMETER MISSING'                                     00980000
************BY IEFVDA                                                   01000000
M6F      EQU   *                                                        01020000
         DC    X'2F'                                                    01040000
         DC    AL1(MEE-M6F-2)                                           01060000
         DC    C'IEF647I '                                              01080000
         DC    C'NON-ALPHABETIC FIRST '                                 01100000
         DC    C'CHARACTER OF NAME'                                     01120000
MEE      DC    X'FF'                                                    01140000
         MODID BR=NO                                             Y01886 01150001
         END                                                            01160000
./  ADD  SSI=20601903,NAME=IEFVGM67
IEFVGM67 CSECT                                                          02000020
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE   20002 04000020
*             INTERPRETER KEYS:                                         06000020
*              RESERVE SUBPARAMETER OF THE DCB                          08000020
*              PCI SUBPARAMETER OF THE DCB                              10000020
*              BUFMAX SUBPARAMETER OF THE DCB                           12000020
*              BUFOUT SUBPARAMETER OF THE DCB FIELD                     14000020
*              BUFIN SUBPARAMETER OF THE DCB FIELD                      16000020
*              BUFSIZE SUBPARAMETER OF THE DCB FIELD                    18000020
*              DYNAM                                                    20000020
*              QNAME                                                    22000020
         IEFVKEYS                                                 20002 24000020
M670     EQU   *                                                  20001 26000020
         DC    AL1(RESERVMK)                                      20002 28000020
         DC    AL1(L'T670)                                        20001 30000020
T670     DC    C'IN THE RESERVE SUBPARAMETER OF THE DCB FIELD'    20002 32000020
M671     EQU   *                                                  20002 34000020
         DC    AL1(PCIMK)                                         20002 36000020
         DC    AL1(L'T671)                                        20002 38000020
T671     DC    C'IN THE PCI SUBPARAMETER OF THE DCB FIELD'        20002 40000020
M672     EQU   *                                                  20002 42000020
         DC    AL1(BUFMAXMK)                                      20002 44000020
         DC    AL1(L'T672)                                        20002 46000020
T672     DC    C'IN THE BUFMAX SUBPARAMETER OF THE DCB FIELD'     20002 48000020
M673     EQU   *                                                  20002 50000020
         DC    AL1(BUFOUTMK)                                      20002 52000020
         DC    AL1(L'T673)                                        20002 54000020
T673     DC    C'IN THE BUFOUT SUBPARAMETER OF THE DCB FIELD'     20002 56000020
M674     EQU   *                                                  20002 58000020
         DC    AL1(BUFINMK)                                       20002 60000020
         DC    AL1(L'T674)                                        20002 62000020
T674     DC    C'IN THE BUFIN SUBPARAMETER OF THE DCB FIELD'      20002 64000020
M675     EQU   *                                                  20002 66000020
         DC    AL1(BUFSIZMK)                                      20002 68000020
         DC    AL1(L'T675)                                        20002 70000020
T675     DC    C'IN THE BUFSIZE SUBPARAMETER OF THE DCB FIELD'    20002 72000020
M676     EQU   *                                                  20002 74000020
         DC    AL1(DYNAK)                                         20002 76000020
         DC    AL1(L'T676)                                        20002 78000020
T676     DC    C'IN THE DD DYNAM FIELD'                           20002 80000020
M677     EQU   *                                                  20002 82000020
         DC    AL1(QNAMEK)                                        20002 84000020
         DC    AL1(L'T677)                                        20002 86000020
T677     DC    C'IN THE QNAME FIELD'                              20002 88000020
M678     EQU   *                                                  20002 90000020
MEE      DC    X'FF'               END OF MODULE INDICATOR              90050000
         MODID BR=NO                                             Y01886 90100000
         END                                                            92000020
./  ADD  SSI=20601904,NAME=IEFVGM7
IEFVGM7  CSECT                                                          00020000
*             THIS MODULE CONTAINS THE MESSAGES FOR THE INTERPRETER     00040000
*             NUMBERED  30  THRU  37                                    00060000
*             IDENTIFICATION NUMBERS    IEF648I  THRU  IEF655I          00080000
************BY IEFVDA                                                   00100000
M70      EQU   *                                                        00120000
         DC    X'30'                                                    00140000
         DC    AL1(M71-M70-2)                                           00160000
         DC    C'IEF648I '                                              00180000
         DC    C'INVALID DISP FIELD-'                                   00200000
************BY IEFVDA                                                   00240000
M71      EQU   *                                                        00260000
         DC    X'31'                                                    00280000
         DC    AL1(M72-M71-2)                                           00300000
         DC    C'IEF649I '                                              00320000
         DC    C'EXCESSIVE NUMBER OF DD '                               00340000
         DC    C'STATEMENTS'                                            00360000
************IEFVFA                                                      00380000
M72      EQU   *                                                        00400000
         DC    X'32'                                                    00420000
         DC    AL1(M73-M72-2)                                           00440000
         DC    C'IEF650I '                                              00460000
         DC    C'INCORRECT USE OF SLASH'                                00480000
************BY IEFVFA                                                   00500000
M73      EQU   *                                                        00520000
         DC    X'33'                                                    00540000
         DC    AL1(M74-M73-2)                                           00560000
         DC    C'IEF651I '                                              00580000
         DC    C'INCORRECT USE OF MINUS'                                00600000
************BY IEFVFA                                                   00620000
M74      EQU   *                                                        00640000
         DC    X'34'                                                    00660000
         DC    AL1(M75-M74-2)                                           00680000
         DC    C'IEF652I '                                              00700000
         DC    C'MUTUALLY EXCLUSIVE KEYWORDS - '                        00720000
         DC    C'KEYWORD'                                               00740000
*                                                                       00760000
**NOTE -THE FOLLOWING MESSAGE IS ALWAYS PUT OUT AFTER THE  ABOVE        00780000
*       AND THEREFORE HAS NO  7 CHARACTER IDENT IN FRONT                00800000
M75      EQU   *                                                        00820000
         DC    X'35'                                                    00840000
         DC    AL1(M76-M75-2)                                           00860000
         DC    CL8' '                                                   00880000
         DC    C'IS MUTUALLY EXCLUSIVE WITH KEYWORD'                    00900000
************BY IEFVDA                                                   00920000
M76      EQU   *                                                        00940000
         DC    X'36'                                                    00960000
         DC    AL1(M77-M76-2)                                           00980000
         DC    C'IEF654I '                                              01000000
         DC    C'MULTIPLE DDNAMES REFER TO ONE '                        01020000
         DC    C'DD STATEMENT'                                          01040000
************BY IEFVDA                                                   01060000
M77      EQU   *                                                        01080000
         DC    X'37'                                                    01100000
         DC    AL1(MEE-M77-2)                                           01120000
         DC    C'IEF655I '                                              01140000
         DC    C'DSNAME INVALID WHEN SYSOUT '                           01160000
         DC    C'SPECIFIED'                                             01180000
MEE      DC    X'FF'               END OF MODULE INDICATOR              01200000
         MODID BR=NO                                             Y01886 01210001
         END                                                            01220000
./  ADD  SSI=30872065,NAME=IEFVGM70
IEFVGM70 CSECT                                                          00020000
*             THIS MODULE CONTAINS THE MESSAGES FOR THE INTERPRETER     00040000
*             NUMBERED    38    THRU   3F                               00060000
*             IDENTIFICATION NUMBERS   IEF656I  THRU  IEF663I           00080000
************BY  VDA                                              Y02668 00100002
M708     EQU   *                                                        00120000
         DC    X'38'                                                    00140000
         DC    AL1(M709-M708-2)                                         00160000
         DC    C'IEF681I '                                       Y02668 00180002
         DC    C'INVALID COPIES VALUE - '                        Y02668 00190002
         DC    C'DEFAULT OF ONE SUBSTITUTED'                     Y02668 00200002
************BY IEFVHH                                             21016 00230001
M709     EQU   *                                                        00240000
         DC    X'39'                                                    00242014
         DC    AL1(M70A-M709-2)                                         00244014
         DC    C'IEF657I '                                              00246014
         DC    C'SYMBOL NOT DEFINED'                              21016 00248001
         DC    C' IN PROCEDURE'                                   21016 00250001
************BY IEFVHCB                                                  00252014
M70A     EQU   *                                                        00260000
         DC    X'3A'                                                    00263014
         DC    AL1(M70B-M70A-2)                                         00266014
         DC    C'IEF658I PROC VERB '                                    00269014
         DC    C'STATEMENT OUT OF '                                     00272014
         DC    C'SEQUENCE'                                              00275014
************BY IEFVHEB                                             AACA 00277017
M70B     EQU   *                                                        00280000
         DC    X'3B'                                               AACA 00283017
         DC    AL1(M70C-M70B-2)                                    AACA 00286017
         DC    C'IEF659I MISPLACED SYSCHK '                        AACA 00289017
         DC    C'DD STATEMENT'                                     AACA 00292017
************BY IEFVHCB                                             AACA 00295017
M70C     EQU   *                                                        00300000
         DC    X'3C'                                               AACA 00303017
         DC    AL1(M70D-M70C-2)                                    AACA 00306017
         DC    C'IEF660I MISSING SYSCHK '                          AACA 00309017
         DC    C'DD STATEMENT'                                     AACA 00312017
************BY IEFVHEC                                             AACA 00315017
M70D     EQU   *                                                        00320000
         DC    X'3D'                                               AACA 00324017
         DC    AL1(M70E-M70D-2)                                    AACA 00328017
         DC    C'IEF661I RESTART STEP '                            AACA 00332017
         DC    C'NOT FOUND'                                        AACA 00336017
************BY IEFVINA                                                  00338019
M70E     EQU   *                                                        00340000
         DC    X'3E'                                                    00344019
         DC    AL1(M70F-M70E-2)                                         00348019
         DC    C'IEF662I INVALID LABEL '                                00352019
************BY IEFVINA                                                  00356019
M70F     EQU   *                                                        00360000
         DC    X'3F'                                                    00365019
         DC    AL1(MEE-M70F-2)                                          00370019
         DC    C'IEF663I NO LABEL'                                      00375019
MEE      DC    X'FF'              END OF MODULE INDICATOR               00380000
         MODID BR=NO                                             Y01886 00390001
         DC    C'MVM'              FUNCTION ID                   Y02668 00393002
         DC    C'01'               LEVEL #  (NEW MESSAGE)        Y02668 00396002
         END                                                            00400000
./  ADD  SSI=80300049,NAME=IEFVGM71
IEFVGM71 CSECT                                                          03000019
* ADD MESSAGE AFTER LABEL M713                                 @ZA16056 03006003
* ADD MESSAGE AFTER LABEL M726                                 @ZA19982 03009003
* CHANGED MSG CONTENTS AFTER LABEL M727                        @ZA27613 03010003
*********************************************************************** 03012003
*                                                                       03018003
* STATUS - VS2 SU16 - PTF                                      @ZA16056 03024003
*                                                                       03074003
*                                                                       03124003
*              THIS MODULE CONTAINS THE MESSAGES FOR THE INTERPRETER    03174003
*              MESSAGES NUMBERED 40 THROUGH 50                 @ZA19982 03224003
*              IDENTIFICATION NUMBERS IEF664I - IEF673I,       @G29AN2E 03274003
*                                     IEF744I - IEF750I        @G29AN2E 03324003
*                                     IEF757I                  @ZA16056 03374003
*                                     IEF686I                  @ZA19982 03424003
*                                                                       03474003
* CHANGE LEVEL = ZA16056,ZA19982,ZA27613                       @ZA27613 03524003
*                                                                       03574003
*********************************************************************** 03624003
*                                                                       03674003
         SPACE                                                          15000019
         SPACE                                                          18000019
************BY IEFVINA                                            O106  21000019
M710     EQU   *                                                  O106  24000019
         DC    X'40'                                              O106  27000019
         DC    AL1(M711-M710-2)                                   O106  30000019
         DC    C'IEF664I MISSING DELIMITER '                      O106  33000019
************BY IEFVINA                                            O106  39000019
M711     EQU   *                                                  O106  42000019
         DC    X'41'                                              O106  45000019
         DC    AL1(M712-M711-2)                                   O106  48000019
         DC    C'IEF665I EXCESSIVE NUMBER OF '                    O106  51000019
         DC    C'IN-STREAM PROCEDURES'                             4325 54000019
************BY VDA                                               Y02668 55000002
M712     EQU   *                                                        57000019
         DC    X'42'                                             Y02668 57500002
         DC    AL1(M713-M712-2)                                  Y02668 58000002
         DC    C'IEF682I '                                       Y02668 58500002
         DC    C'FREE VALUE INVALID - '                          Y02668 59000002
         DC    C'DEFAULT OF (END) SUBSTITUTED'                   Y02668 59500002
************BY VDA                                             @ZA16056 59550003
M713     EQU   *                                                        60000019
         DC    X'43'                                           @ZA16056 60050003
         DC    AL1(M714-M713-2)                                @ZA16056 60100003
         DC    C'IEF757I ILLEGAL DATA SET NAME '               @ZA16056 60150003
         DC    C'ON DD STATEMENT'                              @ZA16056 60200003
************BY IEFVHCB                                                  61000019
M714     EQU   *                                                        63000019
         DC    X'44'                                                    63600019
         DC    AL1(M715-M714-2)                                         64200019
         DC    C'IEF668I PEND VERB STATEMENT OUT '                      64800019
         DC    C'OF SEQUENCE'                                           65400019
************BY IEFVDA                                                   65700020
M715     EQU   *                                                        66000019
         DC    X'45'                                              20029 66600020
         DC    AL1(M716-M715-2)                                   20029 67200020
         DC    C'IEF669I INVALID REFER FORWARD '                  20029 67800020
         DC    C'TO DYNAM DATA SET'                               20029 68400020
************ BY IEFVEA                                            21016 68450001
M716     EQU   *                                                  21016 69000001
         DC     X'46'                                             21016 69050001
         DC    AL1(M717-M716-2)                                   21016 69100001
         DC    C'IEF670I NO VALUE ASSIGNED TO SYMBOLIC'           M1876 69150001
         DC    C' PARAMETER ON PROC STMT VIA THE EXEC STMT'       M1876 69200001
************ BY IEFVDA                                          *Y01113 72050001
M717     EQU   *                                                        72100001
         DC    X'47'                                             Y01113 72150001
         DC    AL1(M718-M717-2)                                  Y01113 72200001
         DC    C'IEF671I MISPLACED JOBCAT DD STATEMENT'          Y01113 72250001
M718     EQU   *                                                 Y01113 72300001
         DC    X'48'                                             Y01113 72350001
         DC    AL1(M719-M718-2)                                  Y01113 72400001
         DC    C'IEF672I MULTIPLE STEPCAT DD STATEMENT IN STEP'  YO1113 72450001
************ BY IEFVEA AND IEFVJA                                Y01029 72460001
M719     EQU   *                                                        72500001
         DC    X'49'                                             Y01029 72550001
         DC    AL1(M720-M719-2)                                  Y01029 72600001
         DC    C'IEF673I ADDRSPC=REAL INVALID'                   Y01029 72650001
************ BY IEFVDA                                           Y02668 72670002
M720     EQU   *                                                 Y01029 72700001
         DC    X'4A'                                             Y02668 73000002
         DC    AL1(M721-M720-2)                                  Y02668 73300002
         DC    C'IEF684I HOLD VALUE INVALID - DEFAULT OF ''NO''' Y02668 73600002
         DC    C' SUBSTITUTED'                                   Y02668 73900002
M721     EQU   *                                                 Y02668 74200002
         DC    X'4B'                                             Y02668 74300002
         DC    AL1(M722-M721-2)                                  Y02668 74400002
         DC    C'IEF685I STATIC PLUS DYNAMIC DD COUNT'           Y02668 74500002
         DC    C' EXCEEDS MAX - DYNAMIC DD''S REDUCED'           Y02668 74600002
************ BY IEFVFA                                         @G29AN2E 74700003
M722     EQU   *                                                 Y02668 74750003
         DC    X'4C'                                           @G29AN2E 74800003
         DC    AL1(M723-M722-2)                                @G29AN2E 74850003
         DC    C'IEF744I SUBSYSTEM NOT SPECIFIED'              @G29AN2E 74900003
M723     EQU   *                                               @G29AN2E 74950003
         DC    X'4D'                                           @G29AN2E 75000003
         DC    AL1(M724-M723-2)                                @G29AN2E 75050003
         DC    C'IEF748I SUBSYSTEM NAME INVALID'               @G29AN2E 75100003
M724     EQU   *                                               @G29AN2E 75150003
         DC    X'4E'                                           @G29AN2E 75200003
         DC    AL1(M725-M724-2)                                @G29AN2E 75250003
         DC    C'IEF749I JCL STATEMENT BUFFER CAPACITY'        @G29AN2E 75300003
         DC    C' EXCEEDED'                                    @G29AN2E 75350003
M725     EQU   *                                               @G29AN2E 75400003
         DC    X'4F'                                           @G29AN2E 75450003
         DC    AL1(M726-M725-2)                                @G29AN2E 75500003
         DC    C'IEF750I SYSTEM ERROR IN PROCESSING'           @G29AN2E 75550003
         DC    C' SUBSYS DD PARAMETER'                         @G29AN2E 75600003
************ BY IEFVHH                                         @ZA19982 75650003
M726     EQU   *                                               @G29AN2E 75700003
         DC    X'50'                                           @ZA19982 75750003
         DC    AL1(M727-M726-2)                                @ZA19982 75800003
         DC    C'IEF686I DDNAME REFERRED TO ON DDNAME'         @ZA27613 75850003
         DC    C' KEYWORD IN PRIOR STEP WAS NOT RESOLVED'      @ZA27613 75900003
M727     EQU   *                                               @ZA19982 75950003
MEE      DC    X'FF'                                                    76000003
         MODID BR=NO                                             Y01886 76050003
         DC    C'SU16'             FUNCTION ID                 @G29AN2E 76100003
*        DC    C'02'               LEVEL # (ILLEGAL DSNAME MSG)@ZA16056 76150003
*        DC    C'03'               LEVEL # (DD REFERRED TO NOT DEFINED) 76200003
*                                                              @ZA19982 76250003
*        DC    C'04'     LEVEL # (CHANGED DD REFERRED TO MSG)  @ZA27613 76300003
         DC    C'05'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27753 76350003
         END                                                            76400003
./  ADD  SSI=80300051,NAME=IEFVGM76
IEFVGM76 CSECT                                                          04000020
*                                                                       08000003
* STATUS - VS2 SU 16 - IN THIS MODULE, SU 16 SUPPORTS          @G16APPK 08050003
*          VPSS SUPPORT(SU 29 - @G29AN2E) AND RACF             @G16APPK 08100003
*          VERSION 2 (SU 32 - @G32HPPJ).                       @G16APPK 08150003
*          MERGE SU4,10,16 CODE TO REL 037 PTF                 @ZA27753 08170003
*                                                                       08200003
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         08250003
*             INTERPRETER KEYS:                                         08300003
*              PROTECT                                         @G32HPPJ 08350003
*              SUBSYS                                          @G29AN2E 08400003
*              CHARS                                           @Z40MPTH 08450003
*              MODIFY                                          @Z40MPTH 08500003
*              FLASH                                           @Z40MPTH 08550003
*              BURST                                           @Z40MPTH 08600003
*              DSID                                            @Y30OPTD 12000603
*              MSVGP                                           @Y30OPTD 12001203
*              HOLD                                             YM02710 12002002
*              DEST                                             YM02710 12004002
*              FRID                                             YM02710 12006002
*              FREE                                             YM02710 12008002
*              AMP                                               Y01113 12010001
*              DIAGNS                                            I21042 12050001
*              FUNC                                               21088 12050101
*              FCB                                                      20000020
*              TERM                                                     20010020
*              THRESH                                                   20020020
*                                                                       24000020
               IEFVKEYS                                                 28000020
         DC    AL1(PROTECTK)       MESSAGE KEY                 @G32HPPJ 28005003
         DC    AL1(L'T759)         MESSAGE LENGTH              @G32HPPJ 28010003
T759     DC    C'IN THE PROTECT FIELD'                         @G32HPPJ 28015003
         DC    AL1(SUBSYSK)        MESSAGE KEY                 @G29AN2E 28020003
         DC    AL1(L'T760)         MESSAGE LENGTH              @G29AN2E 28025003
T760     DC    C'IN THE SUBSYS FIELD'                          @G29AN2E 28030003
         DC    AL1(CHARSK)         MESSAGE KEY                 @Z40MPTH 28035003
         DC    AL1(L'T761)         MESSAGE LENGTH              @Z40MPTH 28040003
T761     DC    C'IN THE CHARS FIELD'                           @Z40MPTH 28045003
         DC    AL1(MODIFYK)        MESSAGE KEY                 @Z40MPTH 28050003
         DC    AL1(L'T762)         MESSAGE LENGTH              @Z40MPTH 28055003
T762     DC    C'IN THE MODIFY FIELD'                          @Z40MPTH 28060003
         DC    AL1(FLASHK)         MESSAGE KEY                 @Z40MPTH 28065003
         DC    AL1(L'T763)         MESSAGE LENGTH              @Z40MPTH 28070003
T763     DC    C'IN THE FLASH FIELD'                           @Z40MPTH 28075003
         DC    AL1(BURSTK)         MESSAGE KEY                 @Z40MPTH 28080003
         DC    AL1(L'T764)         MESSAGE LENGTH              @Z40MPTH 28085003
T764     DC    C'IN THE BURST FIELD'                           @Z40MPTH 28090003
         DC    AL1(DSIDK)          MESSAGE KEY                 @Y30OPTD 28100003
         DC    AL1(L'T765)         MESSAGE LENGTH              @Y30OPTD 28200003
T765     DC    C'IN THE DSID FIELD'                            @Y30OPTD 28300003
         DC    AL1(MSVGPK)         MESSAGE KEY                 @Y30OPTD 28400003
         DC    AL1(L'T766)         MESSAGE LENGTH              @Y30OPTD 28500003
T766     DC    C'IN THE MSVGP FIELD'                           @Y30OPTD 28600003
         DC    AL1(HOLDK)          MSG KEY.                     YM02710 28800002
         DC    AL1(L'HOLDTXT)      MSG LENGTH.                  YM02710 29000002
HOLDTXT  DC    C'IN THE HOLD FIELD'                             YM02710 29200002
         DC    AL1(DESTK)                                       YM01594 29600002
         DC    AL1(L'T767)                                      YM01594 30400002
T767     DC    C'IN THE DEST FIELD'                             YM01594 31200002
         DC    AL1(FRIDMK)                                      YM00381 33000002
         DC    AL1(L'T768)                                      YM00381 34000002
T768     DC    C'IN THE FRID SUBPARAMETER OF THE DCB FIELD'     YM00381 35000002
         DC    AL1(FREEK)          MSG KEY.                     YM02710 36000002
         DC    AL1(L'FREETXT)      MSG LENGTH.                  YM02710 36010002
FREETXT  DC    C'IN THE FREE FIELD'                             YM02710 36020002
         DC    AL1(AMPK)                                         Y01113 36050001
         DC    AL1(L'T769)                                       Y01113 36100001
T769     DC    C'IN THE AMP FIELD'                               Y01113 36150001
         DC    AL1(FUNCMK)                                        21088 40050001
         DC    AL1(L'T76A)                                        21088 40100001
T76A     DC    C'IN THE FUNC SUBPARAMETER OF THE DCB FIELD'       21088 40150001
         DC    AL1(DIAGNSK)                                      I21042 44050001
         DC    AL1(L'T76B)                                       I21042 44100001
T76B     DC    C'IN THE DIAGNS FIELD'                            I21042 44150001
         DC    AL1(DLMK)                                         21009  48050001
         DC    AL1(L'T76C)                                       21009  48100001
T76C     DC    C'IN THE DLM FIELD'                               21009  48150001
         DC    AL1(FCBK)                                          20202 53000020
         DC    AL1(L'T76D)                                        20202 54000020
T76D     DC    C'IN THE FCB FIELD'                                20202 55000020
         DC    AL1(TERMK)                                               60000020
         DC    AL1(L'T76E)                                              64000020
T76E     DC    C'IN THE TERM FIELD'                                     68000020
         DC    AL1(THRESHMK)                                            72010020
         DC    AL1(L'T76F)                                              72020020
T76F     DC    C'IN THE THRESH FIELD'                                   72030020
MEE      DC    X'FF'                                                    88000020
         MODID BR=NO                                             Y01886 88050001
*        DC    C'SU32'            FUNCTION ID                  @G32HPPJ 89050003
*        DC    C'01'    LEVEL # (PROTECT)                      @G32HPPJ 89100003
         DC    C'02'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27753 89150003
         END                                                            89200003
./  ADD  SSI=33060997,NAME=IEFVGM78
IEFVGM78 CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040019
*             INTERPRETER KEYS                                          00060019
*              BUFOFF IN THE DCB FIELD                            19200 00061019
*              OUTLIM IN THE DCB FIELD                            19028 00062019
*              IPLTXID IN THE DCB FIELD                          Y01948 00063002
*              COPIES                                           YM02710 00064002
*              GDSORG IN THE DCB FIELD                            19874 00065019
*              GNCP   IN THE DCB FIELD                            19874 00066019
*              UCS                                                19874 00067019
*              DUMMY                                              19874 00068019
         IEFVKEYS                                                 19874 00074019
M788     EQU   *                                                        00080000
         DC    AL1(BUFOFFMK)           MESSAGE KEY                19200 00085019
         DC    AL1(L'M789TXT)          MSG LENGTH                 19200 00090019
M789TXT  DC    C'IN THE BUFOFF SUBPARAMETER OF THE DCB FIELD'     19200 00095019
M789     EQU   *                                                        00100000
         DC    AL1(OUTLIMK)            MESSAGE KEY                19028 00105019
         DC    AL1(L'M78ATXT)          MSG LENGTH                 19028 00110019
M78ATXT  DC    C'IN THE OUTLIM FIELD'                             19028 00115019
M78A     EQU   *                                                        00120001
         DC    AL1(IPLTXIDK)            IPLTXID KEY              Y01948 00130001
         DC    AL1(M78B-M78BTXT)        MSG LENGTH               Y01948 00132001
M78BTXT  DC    C'IN THE IPLTXID SUBPARAMETER '  SECONDARY...     Y01948 00134001
         DC    C'OF THE DCB FIELD'      ... MSG TEXT             Y01948 00136001
M78B     EQU   *                                                YM02710 00140002
         DC    AL1(COPIESK)        MSG KEY.                     YM02710 00145002
         DC    AL1(M78C-M78B-2)    MSG LENGTH.                  YM02710 00150002
         DC    C'IN THE COPIES FIELD'                           YM02710 00155002
M78C     EQU   *                                                        00160000
         DC    AL1(GDSORGMK)                                      19874 00164019
         DC    AL1(M78D-M78C-2)                                         00168014
         DC    C'IN THE GDSORG SUBPARAMETER '                           00172014
         DC    C'OF THE DCB FIELD'                                      00176014
M78D     EQU   *                                                        00180000
         DC    AL1(GNCPMK)                                        19874 00181019
         DC    AL1(M78E-M78D-2)                                         00188014
         DC    C'IN THE GNCP SUBPARAMETER '                             00192014
         DC    C'OF THE DCB FIELD'                                      00196014
M78E     EQU   *                                                        00200000
         DC    AL1(UCSK)                                          19874 00204019
         DC    AL1(M78F-M78E-2)                                         00208014
         DC    C'IN THE UCS FIELD'                                      00214014
M78F     EQU   *                                                        00220000
         DC    AL1(DUMMK)                                         19874 00240019
         DC    AL1(MEE-M78F-2)                                          00260000
         DC    C'ON THE DD DUMMY STATEMENT'                             00280000
MEE      DC    X'FF'                          END OF MODULE INDICATOR   00300000
         MODID BR=NO                                             Y01886 00310001
         DC    C'MVM'              FUNCTION ID AND              YM02710 00313002
         DC    C'01'   LEVEL # (COPIES SECONDARY MSG).          YM02710 00316002
         END                                                            00320000
./  ADD  SSI=42770149,NAME=IEFVGM8
IEFVGM8  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS  0E   THRU  15                           00060000
*             INTERPRETER KEYS                                    19874 00061019
*              CHKPT                                           @Z30JPSF 00062003
*              DCB                                                19874 00063019
*              UNIT                                               19874 00064019
*              LABEL                                              19874 00065019
*              VOLUME                                             19874 00066019
*              AFF                                                19874 00067019
*              SEP                                                19874 00068019
*              DISP                                               19874 00069019
         IEFVKEYS                                                 19874 00070019
M80      EQU   *                                                        00080000
         DC    AL1(CHKPTK)                                     @Z30JPSF 00100003
         DC    AL1(M81-M80-2)                                           00120000
         DC    C'IN THE CHKPT FIELD'                           @Z30JPSF 00140003
M81      EQU   *                                                        00160000
         DC    AL1(DCBK)                                          19874 00180019
         DC    AL1(M82-M81-2)                                           00200000
         DC    C'IN THE DCB FIELD'                                      00220000
M82      EQU   *                                                        00240000
         DC    AL1(UNITK)                                         19874 00260019
         DC    AL1(M83-M82-2)                                           00280000
         DC    C'IN THE UNIT FIELD'                                     00300000
M83      EQU   *                                                        00320000
         DC    AL1(LABELK)                                        19874 00340019
         DC    AL1(M84-M83-2)                                           00360000
         DC    C'IN THE LABEL FIELD'                                    00380000
M84      EQU   *                                                        00400000
         DC    AL1(VOLUMEK)                                       19874 00420019
         DC    AL1(M85-M84-2)                                           00440000
         DC    C'IN THE VOLUME FIELD '                                  00460000
M85      EQU   *                                                        00480000
         DC    AL1(AFFK)                                          19874 00500019
         DC    AL1(M86-M85-2)                                           00520000
         DC    C'IN THE AFF FIELD '                                     00540000
M86      EQU   *                                                        00560000
         DC    AL1(SEPK)                                          19874 00580019
         DC    AL1(M87-M86-2)                                           00600000
         DC    C'IN THE SEP FIELD '                                     00620000
M87      EQU   *                                                        00640000
         DC    AL1(DISPK)                                         19874 00660019
         DC    AL1(MEE-M87-2)                                           00680000
         DC    C'IN THE DISP FIELD '                                    00700000
MEE      DC    X'FF'                         END OF MODULE INDICATOR    00720000
         MODID BR=NO                                             Y01886 00730001
         DC     C'REL3'                                        @Z30JPSF 00733003
         DC     C'01'     LEVEL#(CHKPT EOV ENHANCEMENT)        @Z30JPSF 00736003
         END                                                            00740000
./  ADD  SSI=20601909,NAME=IEFVGM9
IEFVGM9  CSECT                                                          00020000
*             THIS MODULE CONTAINS MESSAGES ASSOCIATED WITH THE         00040000
*             INTERPRETER KEYS                                    19874 00043019
*              SPACE                                              19874 00046019
*              SPLIT                                              19874 00049019
*              DDNAME                                             19874 00052019
*              DSNAME                                             19874 00055019
*              SYSOUT                                             19874 00058019
*              SUBALLOC                                           19874 00061019
*              AFF IN THE UNIT FIELD                              19874 00064019
*              SEP IN THE UNIT FIELD                              19874 00067019
         IEFVKEYS                                                 19874 00070019
M98      EQU   *                                                        00080000
         DC    AL1(SPACEK)                                        19874 00100019
         DC    AL1(M99-M98-2)                                           00120000
         DC    C'IN THE SPACE FIELD '                                   00140000
M99      EQU   *                                                        00160000
         DC    AL1(SPLITK)                                        19874 00180019
         DC    AL1(M9A-M99-2)                                           00200000
         DC    C'IN THE SPLIT FIELD '                                   00220000
M9A      EQU   *                                                        00240000
         DC    AL1(DDNAMEK)                                       19874 00260019
         DC    AL1(M9B-M9A-2)                                           00280000
         DC    C'IN THE DDNAME FIELD '                                  00300000
M9B      EQU   *                                                        00320000
         DC    AL1(DSNAMEK)                                       19874 00340019
         DC    AL1(M9C-M9B-2)                                           00360000
         DC    C'IN THE DSNAME FIELD '                                  00380000
M9C      EQU   *                                                        00400000
         DC    AL1(SYSOUTK)                                       19874 00420019
         DC    AL1(M9D-M9C-2)                                           00440000
         DC    C'IN THE SYSOUT FIELD '                                  00460000
M9D      EQU   *                                                        00480000
         DC    AL1(SUBALLOK)                                      19874 00500019
         DC    AL1(M9E-M9D-2)                                           00520000
         DC    C'IN THE SUBALLOC FIELD '                                00540000
M9E      EQU   *                                                        00560000
         DC    AL1(AFFMK)                                         19874 00580019
         DC    AL1(M9F-M9E-2)                                           00600000
         DC    C'IN THE AFF SUBPARAMETER '                              00620000
         DC    C'OF THE UNIT FIELD '                                    00640000
M9F      EQU   *                                                        00660000
         DC    AL1(SEPMK)                                         19874 00680019
         DC    AL1(MEE-M9F-2)                                           00700000
         DC    C'IN THE SEP SUBPARAMETER '                              00720000
         DC    C'IN THE UNIT FIELD '                                    00740000
MEE      DC    X'FF'                                                    00760000
         MODID BR=NO                                             Y01886 00770001
         END                                                            00780000
./  ADD  SSI=63270463,NAME=IEFVGM90
         TITLE 'IEFVGM90 - VARIABLE ERROR MESSAGES                     *00001000
                        '                                               00002000
IEFVGM90 CSECT                                            /*@G29AN2E*/  00003000
*END IEFVGM90;                                             /*@G29AN2E*/ 00004000
@DATA    DS    0H                                                       00005000
         DS    0F                                                       00006000
         DS    0F                                                       00007000
         DS    0D                                                       00008000
VGM90MOT DS    CL12                                                     00009000
         ORG   VGM90MOT                                                 00010000
MSG1MOT  DS    CL4                                                      00011000
         ORG   MSG1MOT                                                  00012000
MSG1OFST DC    AL2(VGM901-VGM90TXT)                                     00013000
MSG1LNTH DC    AL2(58)                                                  00014000
         ORG   VGM90MOT+4                                               00015000
MSG2MOT  DS    CL4                                                      00016000
         ORG   MSG2MOT                                                  00017000
MSG2OFST DC    AL2(VGM902-VGM90TXT)                                     00018000
MSG2LNTH DC    AL2(37)                                                  00019000
         ORG   VGM90MOT+8                                               00020000
MSG3MOT  DS    CL4                                                      00021000
         ORG   MSG3MOT                                                  00022000
MSG3OFST DC    AL2(VGM903-VGM90TXT)                                     00023000
MSG3LNTH DC    AL2(41)                                                  00024000
         ORG   VGM90MOT+12                                              00025000
VGM90TXT DS    CL136                                                    00026000
         ORG   VGM90TXT                                                 00027000
VGM901   DS    CL58                                                     00028000
         ORG   VGM901                                                   00029000
@NM00001 DC    CL8'IEF745I '                                            00030000
@NM00002 DC    CL10'SUBSYSTEM '                                         00031000
@NM00003 DC    CL5' '                                                   00032000
@NM00004 DC    CL17'DOES NOT SUPPORT '                                  00033000
@NM00005 DC    CL18'THE SUBSYS KEYWORD'                                 00034000
         ORG   VGM90TXT+58                                              00035000
VGM902   DS    CL37                                                     00036000
         ORG   VGM902                                                   00037000
@NM00006 DC    CL8'IEF746I '                                            00038000
@NM00007 DC    CL10'SUBSYSTEM '                                         00039000
@NM00008 DC    CL5' '                                                   00040000
@NM00009 DC    CL14'DOES NOT EXIST'                                     00041000
         ORG   VGM90TXT+95                                              00042000
VGM903   DS    CL41                                                     00043000
         ORG   VGM903                                                   00044000
@NM00010 DC    CL8'IEF747I '                                            00045000
@NM00011 DC    CL10'SUBSYSTEM '                                         00046000
@NM00012 DC    CL5' '                                                   00047000
@NM00013 DC    CL18'IS NOT OPERATIONAL'                                 00048000
         ORG   VGM90TXT+136                                             00049000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00050000
@01      EQU   01                                                       00051000
@02      EQU   02                                                       00052000
@03      EQU   03                                                       00053000
@04      EQU   04                                                       00054000
@05      EQU   05                                                       00055000
@06      EQU   06                                                       00056000
@07      EQU   07                                                       00057000
@08      EQU   08                                                       00058000
@09      EQU   09                                                       00059000
@10      EQU   10                                                       00060000
@11      EQU   11                                                       00061000
@12      EQU   12                                                       00062000
@13      EQU   13                                                       00063000
@14      EQU   14                                                       00064000
@15      EQU   15                                                       00065000
         ENTRY VGM90TXT                                                 00066000
         ENTRY VGM90MOT                                                 00067000
@ENDDATA EQU   *                                                        00068000
         END   IEFVGM90,(C'PLS1831',0701,76327)                         00069000
./  ADD  SSI=80550289,NAME=IEFVGS
         TITLE 'IEFVGS - JCT'                                           00020000
GSJCT    DSECT                                                          00040000
         IEFAJCTB                                                       00060000
         TITLE 'IEFVGS - IEFQMNGR'                                      00080000
         IEFQMNGR                                                       00100000
         TITLE 'IEFVGS - IWA'                                           00120000
         IEFCOMWA                                                       00140002
         IEFVMIWA                                                       00150002
         TITLE 'IEFVGS - EWA'                                           00160020
         IEFVMEWA                                               A36294  00200020
         TITLE 'IEFVGS - CSECT'                                         00220000
*                                                                     * 00240000
*********************************************************************** 00260000
*                                                                     * 00280000
*              EQUATES.                                               * 00300000
*                                                                     * 00320000
*********************************************************************** 00340000
*                                                                     * 00360000
GSR48    EQU   X'28'   IEF640I EXCESSIVE NBR OF POS. SUBPARAMETERS.     00380000
GSR4F    EQU   X'2D'   IEF645I INVALID REFERBACK.                       00400000
FF       EQU   X'FF'              ALL ONES.                             00420000
GSEXPROC EQU   X'80'              PROC ENTRY INDICATOR.                 00440000
GSEXPGM  EQU   X'40'              PGM ENTRY INDICATOR.                  00460000
GSEXPPGM EQU   X'20'              PGM/PROC ENTRY INDICATOR.             00480000
GSEXDD   EQU   X'10'              DD ENTRY INDICATOR.                   00500000
GSJBFLAG EQU   X'80'              JOBLIB FLAG IN JCT.                   00520000
GSDIS24  EQU   24       DISPLACEMENT 24                          A47261 00530001
         EJECT                                                          00540000
IEFVGS   CSECT                                                          00560000
* D STATEMENTS NEAR LABEL GSRCH4A                              @ZA11828 00566003
*********************************************************************** 00580000
*                                                                     * 00600000
*        INPUT TO THIS ROUTINE.                                       * 00620000
*                                                                     * 00640000
*              R3 = POINTS TO LENGTH OF STEPNAME/DDNAME.              * 00660000
*              RA = ADDRESS OF AUXILIARY WORK AREA.                   * 00680000
*              RC = ADDRESS OF INTERPRETER WORK AREA.                 * 00700000
*              RD = ADDRESS OF CURRENT REGISTER SAVE AREA.            * 00720000
*              RE = RETURN ADDRESS.                                   * 00740000
*                                                                     * 00760000
*********************************************************************** 00780000
*                                                                       00800000
         STM   14,12,12(13)       SAVE REGISTERS.                       00820000
         SPACE                                                          00840000
         BALR  RB,0               REG 11 IS THE BASE REGISTER           00860000
         USING *,RB                    OF THE SEARCH ROUTINE.           00880000
*****************************************************************Y02668 00882002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 00884002
         L     RF,TRACEV           LOAD TRACE RTN ADDR.          Y02668 00886002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 00888002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 00890002
         DC    C'VGS '             MOD ID USED BY TRACE          Y02668 00892002
* TRACE RETURNS HERE.                                            Y02668 00894002
*****************************************************************Y02668 00896002
         SPACE                                                          00900000
         B     GSA1                BRANCH ARROUND ID             Y02668 00950002
         MODID BRANCH=NO                                         Y02668 00960002
*        DC    C'REL4'              FUNCTION ID AND            @Z40MPTH 00970003
*        DC    C'02'  LEV #(RACF)                              @Z40RPSM 00975003
*        DC    C'03'          STEPNAME.PROCSTEP IDENTIFICATION @ZA11828 00980003
         DC    C'04'  LEV #(MERGE SU4,10,16 CODE TO 037 PTF)   @ZA27750 00983003
GSA1     DS    0H                                                Y02668 00990002
         SPACE                                                          01000001
         LA    R9,DREFB           DICT 2 ADDRESS TO R9.                 01080000
         SPACE                                                          01100000
         MVC   SRCHREL(8),RELPROC SAVE RELPROC & RELPGM.                01120000
         SPACE                                                          01140000
         SR    R0,R0              ZERO FOR COMPARE.                     01160000
         SR    R6,R6              ZERO FOR IC INSTRUCTIONS.             01180000
         SPACE                                                          01200000
         LR    R5,R3              MOVE POINTER TO SEARCH ARGUMENT.      01220000
         BCTR  R5,0               LOOK AT PRECEDING BYTE.               01240000
         CLI   0(R5),C'*'         IS IT AN ASTERISK.                    01260000
         BE    GSC4               YES. GO TO POINT AT NBR OF PARAMS.    01280000
*   NOT *. PICK UP NBR PARAMS FROM BYTE IMMEDIATELY PRECEEDING LENGTH.  01300000
         IC    R6,0(R5)           PICK UP NBR.                          01320000
         B     GSE3               GO TO PROCESS PARAMS.                 01340000
         SPACE                                                          01360000
GSC4     BCTR  R5,0                                                     01380000
         BCTR  R5,0               LOOK AT NBR BYTE.                     01400000
         IC    R6,0(R5)           PICK UP NBR.                          01420000
         BCTR  R6,0               DECREMENT BY ONE.                     01440000
         SPACE                                                          01460000
GSE3     DS    0H                                                       01480000
         N     R6,GS7F            AND OUT HIGH ORDER BIT.               01500000
         SPACE                                                          01520000
         STC   R6,SRCHNBR         SAVE NBR PARAMS FOR CLI INSTS.        01540000
*                                                                       01560000
*   CHECK FOR ONE SEARCH ARGUMENT.                                      01580000
*                                                                       01600000
         CLI   SRCHNBR,X'01'      IS NBR SA'S EQUAL ONE.                01620000
         BE    GSF4               ONLY STEPNAME/DDNAME GIVEN.           01640000
*                                                                       01660000
*   CHECK FOR TWO SEARCH ARGUMENTS.                                     01680000
*                                                                       01700000
         CLI   SRCHNBR,X'02'      IS NBR SA'S EQUAL TWO.                01720000
         BE    GSG2               YES. TWO SEARCH ARGUMENTS.            01740000
*                                                                       01760000
*   CHECK FOR THREE SEARCH ARGUMENTS.                                   01780000
*                                                                       01800000
         CLI   SRCHNBR,X'03'      IS NBR SA'S EQUAL THREE.              01820000
         BE    GSJ3               YES. THREE SEARCH ARGUMENTS.          01840000
*                                                                       01860000
*   ERROR - MORE THAN THREE SEARCH ARGUMENTS.                           01880000
*                                                                       01900000
         MVI   MSGSEC,GSR48       SET MSG NBR - TOO MANY PARAMETERS -   01920000
         B     GSERROR            GO TO ERROR RETURN                    01940000
         EJECT                                                          01960000
*                                                                       01980000
*   SEARCH ON ONE ARGUMENT.                                             02000000
*                                                                       02020000
GSF4     DS    0H                                                       02040000
         TM    SRCHSW1,SRCHF2     SIOT OR SCT SEARCH.                   02060000
         BO    GSF5               SCT. GO TO SEARCH STEPNAMES.          02080000
*                                                                       02100000
*   SEARCH FOR DDNAME ONLY.  (DDNAME)                                   02120000
*                                                                       02140000
GSG4     DS    0H                                                       02160000
         CLC   0(7,R3),GSJOBLIB   REFERBACK TO JOBLIB.                  02180000
         BNE   GSG4A              NO. GO TO NORMAL SEARCH.              02200000
         TM    JCT+JCTJSTAT-GSJCT,GSJBFLAG  YES. IS THERE A JOBLIB.     02220000
         BZ    GSERRNF            NO. ERROR - INVALID REFERBACK.        02240000
         MVC   SRCHTTR(3),TSREFB  MOVE TTR OF 1ST DICT TO SEARCH TTR.   02260000
         BAL   RE,GSGET           LINK TO READ IN 1ST DICT.             02280000
         B     GSEXIT             GO TO EXIT.                           02300000
GSG4A    DS    0H                                                       02320000
         BAL   RE,GSRCH2          LINK TO SEARCH FOR DDNAME.            02340000
         SPACE                                                          02360000
         B     GSEXIT             FOUND.  GO TO EXIT.                   02380000
*                                                                       02400000
*   SEARCH ON STEPNAME.  (STEPNAME)                                     02420000
*                                                                       02440000
GSF5     DS    0H                                                       02460000
         OI    SRCHSW1,SRCHF3     RETRY AND LAST ARGUMENT        YM4022 02480001
         BAL   RE,GSRCH4          SEARCH UNDER PROCEDURE.               02500000
         B     GSEXIT             FOUND GO TO EXIT.                     02520000
GSG5     DS    0H                                                       02540000
         BAL   RE,GSRCH1          NOT FOUND. SEARCH FROM TOP.           02560000
         B     GSEXIT             FOUND GO TO EXIT.                     02580000
*                                                                       02600000
*   SEARCH ON TWO ARGUMENTS.                                            02620000
*                                                                       02640000
GSG2     DS    0H                                                       02660000
         TM    SRCHSW1,SRCHF2     IS IT A SEARCH FOR SCT TTR.           02680000
         BO    GSG1               YES.  GO TO SEARCH SCT.               02700000
*                                                                       02720000
*   SEARCH SIOT TTR. (STEPNAME.DDNAME).                                 02740000
*                                                                       02760000
         OI    SRCHSW1,SRCHF3     INDICATE RETRY IF NOT FOUND.          02780000
         BAL   RE,GSRCH4          LINK TO SEARCH FOR SCT FROM PROC.     02800000
         B     GSG4               FOUND - GO TO SEARCH DDNAME.          02820000
         B     GSJ5               NOT FOUND - GO TO SEARCH STEPNAME(TOP 02840000
*                                                                       02860000
*   SEARCH FOR SCT TTR  (STEPNAME.PROCSTEP).                            02880000
*                                                                       02900000
GSG1     DS    0H                                                       02920000
         OI    SRCHSW1,SRCHF3     INDICATE RETRY IF NOT FOUND.          02940000
         BAL   RE,GSRCH3          LINK TO SEARCH PROC STEPNAME (TOP).   02960000
         B     GSH1               FOUND - GO TO SEARCH PROCSTEP.        02980000
         B     GSJ1               NOT FOUND - GO TO TEST F1.            03000000
GSH1     DS    0H                                                       03020000
         TM    SRCHSW1,SRCHF1     IS THIS A CONDITIONALLY QUAL STEPNAME 03040000
         BZ    GSH1A              NO. GO TO SEARCH FOR EXACT NAME.      03060000
         OI    SRCHSW1,SRCHF3     YES. INDICATE RETRY & NO INDEX.       03080000
GSH1A    DS    0H                                                       03100000
         BAL   RE,GSRCH4          LINK TO SEARCH PGM WITHIN PROC.       03120000
         B     GSEXIT             FOUND - GO TO EXIT.                   03140000
GSJ1     DS    0H                                                       03160000
         TM    SRCHSW1,SRCHF1     IS IT MATCH OR ERROR.                 03180000
         BO    GSG5               NO. GO TO RETRY ON STEPNAME FROM TOP. 03200000
         B     GSERRNF            YES. NO MATCH - ERROR -               03220000
*                                                                       03240000
*   SEARCH FOR SIOT TTR. (STEPNAME.PROCSTEP.DDNAME).                    03260000
*                                                                       03280000
GSJ3     DS    0H                                                       03300000
         TM    SRCHSW1,SRCHF1     IS A RETRY INDICATED.                 03320000
         BO    GSJ4               YES. GO TO SET RETRY.                 03340000
         BAL   RE,GSRCH3          NO. SEARCH PROC STEPNAME FROM TOP.    03360000
GSK4     DS    0H                                                       03380000
         BAL   RE,GSRCH4          FOUND.  SEARCH STEP WITHIN PROC.      03400000
         B     GSG4               FOUND. GO TO SEARCH DDNAME.           03420000
GSJ4     DS    0H                                                       03440000
         OI    SRCHSW1,SRCHF3     INDICATE RETRY IF NOT FOUND           03460000
         BAL   RE,GSRCH3          LINK TO SEARCH PROC STEPNAME (TOP).   03480000
         B     GSK4               FOUND. GO TO SEARCH PROCSTEP.         03500000
*                                 NOT FOUND. FALL THRU TO SEARCH STPNM. 03520000
GSJ5     DS    0H                                                       03540000
         BAL   RE,GSRCH1          LINK TO SEARCH STEPNAME FROM TOP.     03560000
         B     GSG4               FOUND.  GO TO SEARCH DDNAME.          03580000
         SPACE                                                          03600000
*                                                                       03620000
*   ERROR EXIT.                                                         03640000
*                                                                       03660000
GSERRNF  DS    0H                                                       03680000
         MVI   MSGSEC,GSR4F       SET ERROR MSG NBR.                    03700000
GSERROR  DS    0H                                                       03720000
         MVC   12(4,RD),TCLEANUP  MOVE CLEANUP ADDR TO RE SAVE.         03740000
         SPACE                                                          03760000
*                                                                       03780000
*   EXIT.                                                               03800000
*                                                                       03820000
GSEXIT   DS    0H                                                       03840000
         ST    R1,24(RD)          POINT R1 AT ENTRY.                    03860000
         MVC   RELPROC(8),SRCHREL RESTORE RELPROC AND RELPGM.           03880000
         MVI   SRCHSW1,X'00'      CLEAR SWITCHES.                       03900000
         LM    RE,RC,12(RD)       RESTORE REGS.                         03920000
         BR    RE                 RETURN.                               03940000
         EJECT                                                          03960000
*********************************************************************** 03980000
*                                                                       04000000
*   SEARCH 1 - STEPNAME (PGM) FROM TOP OF DICTIONARY.                   04020000
*                                                                       04040000
*********************************************************************** 04060000
GSRCH1   DS    0H                                                       04080000
         ST    RE,SRCHL1          SAVE RETURN ADDRESS.                  04100000
         MVC   SRCHTTR(3),TSREFB  SET TTR FOR FIRST DICT.               04120000
         BAL   RE,GSGET           LINK TO READ IN FIRST DICT.           04140000
GSRCH1A  DS    0H                                                       04160000
         TM    1(R1),GSEXPGM      IS THIS ENTRY AN EXEC PGM ENTRY.      04180000
         BZ    GSRCH1B            NO. GO TO GET NEXT ENTRY.             04200000
GSRCH1A1 DS    0H                                                       04220000
         LA    R2,5(R1)           POINT AT ENTRY NAME.                  04240000
         BAL   RE,GSCOMPAR        LINK TO CHECK ENTRY VS ARGUMENT.      04260000
         B     GSRCH1B            UNEQUAL COMPARE.  GO GET NEXT ENTRY.  04280000
*                                                                       04300000
*   FOUND SCT ENTRY - SET RELPGM TO FIND DDNAME.                        04320000
*                                                                       04340000
         LR    R4,R1                                                    04360000
         SR    R4,R9              COMPUTE OFFSET TO SCT ENTRY.          04380000
         STC   R4,RELPGM          SET RELATIVE OFFSET.                  04400000
         MVC   RELPGM+1(3),0(R9)  MOVE IN TTR.                          04420000
         B     GSRETN1            RETURN TO CALLING ROUTINE.            04440000
*                                                                       04460000
*   CHECK FOR END OF ENTRIES.                                           04480000
GSRCH1B  DS    0H                                                       04500000
         BAL   RE,GSENDCK         LINK TO CHECK END OF ENTRY.           04520000
         SPACE                                                          04540000
         TM    SRCHSW1,SRCHF4     IS THIS A PROC.                       04560000
         BO    GSRCH4A            YES.  GO TO PROCESS PGM IN PROC.      04580000
         SPACE                                                          04600000
         B     GSRCH1A            NO. GO TO TEST NEW ENTRY.             04620000
         EJECT                                                          04640000
*********************************************************************** 04660000
*                                                                       04680000
*   SEARCH 2 - DDNAME FROM PGM ENTRY.                                   04700000
*                                                                       04720000
*********************************************************************** 04740000
GSRCH2   DS    0H                                                       04760000
         ST    RE,SRCHL1          SAVE LEVEL 1 RETURN REGISTER.         04780000
         SPACE                                                          04800000
         MVC   SRCHTTR(3),RELPGM+1     SET TTR OF RELPGM DICT TO GET.   04820000
         BAL   RE,GSGET           LINK TO GET PGM DICTIONARY.           04840000
         SPACE                                                          04860000
         IC    R6,RELPGM          *                                     04880000
         LA    R1,0(R6,R9)        *    POINT AT FIRST DD ENTRY UNDER    04900000
         IC    R6,0(R1)           *         CURRENT STEP ENTRY.         04920000
         LA    R1,0(R6,R1)        *                                     04940000
         BAL   RE,GSENDCK1            CHECK FOR END OF DICT             04960000
GSRCH2A  DS    0H                                                       04980000
         TM    1(R1),GSEXDD       IS THIS A DD ENTRY.                   05000000
         BZ    GSRTNF             NO. GO TO NOT FOUND RETURN.           05020000
         SPACE                                                          05040000
         LA    R2,8(R1)           YE. POINT R2 AT ENTRY NAME.           05060000
         SPACE                                                          05080000
         BAL   RE,GSCOMPAR        LINK TO COMPARE ENTRY VS ARGUE.       05100000
         SPACE                                                          05120000
         B     GSRCH2B            NOT EQUAL.  GO GET NEXT ENTRY.        05140000
         B     GSRETN1            EQUAL.  GO TO RETURN 1.               05160000
GSRCH2B  DS    0H                                                       05180000
         SPACE                                                          05200000
         BAL   RE,GSENDCK         CHECK FOR END OF DD'S, GET NEXT ENTRY 05220000
         SPACE                                                          05240000
         B     GSRCH2A            GO PROCESS ENTRY.                     05260000
         EJECT                                                          05280000
*********************************************************************** 05300000
*                                                                       05320000
*   SEARCH 3 - PROCEDURE STEPNAME FROM TOP.                             05340000
*                                                                       05360000
*********************************************************************** 05380000
GSRCH3   DS    0H                                                       05400000
         ST    RE,SRCHL1          SAVE LEVEL 1 RETURN REGISTER.         05420000
         SPACE                                                          05440000
         MVC   SRCHTTR(3),TSREFB  SET TTR TO 1ST DICT.                  05460000
         BAL   RE,GSGET           LINK TO GET FIRST DICTIONARY.         05480000
         SPACE                                                          05500000
GSRCH3A  DS    0H                                                       05520000
         TM    1(R1),GSEXPROC     IS THIS A PROC ENTRY.                 05540000
         BZ    GSRCH3B            NO.  GO TO GET NEXT ENTRY.            05560000
         SPACE                                                          05580000
         LA    R2,2(R1)           POINT AT ENTRY NAME.                  05600000
         BAL   RE,GSCOMPAR        LINK TO COMPARE ENTRY VS ARGUE.       05620000
         SPACE                                                          05640000
         B     GSRCH3B            NOT EQUAL. GO TO GET NEXT ENTRY.      05660000
*                                 EQUAL - SET RELPROC & RETURN.         05680000
         LR    R4,R1              COMPUTE RELATIVE OFFSET TO THE        05700000
         SR    R4,R9                   PROCEDURE ENTRY.                 05720000
         STC   R4,RELPROC         SET RELATIVE OFFSET.                  05740000
         MVC   RELPROC+1(3),0(R9) MOVE IN TTR.                          05760000
         B     GSRETN1            RETURN TO CALLING ROUTINE.            05780000
         SPACE                                                          05800000
GSRCH3B  DS    0H                                                       05820000
         BAL   RE,GSENDCK         LINK TO GET NEXT ENTRY.               05840000
         B     GSRCH3A            GO TO PROCESS ENTRY.                  05860000
         EJECT                                                          05880000
*********************************************************************** 05900000
*                                                                       05920000
*   SEARCH 4 - PGM STEPNAME WITH A PROCEDURE.                           05940000
*                                                                       05960000
*********************************************************************** 05980000
GSRCH4   DS    0H                                                       06000000
         ST    RE,SRCHL1          SAVE LEVEL 1 RETURN REGISTER.         06020000
         OI    SRCHSW1,SRCHF4     INDICATE SEARCH ON PGM WITHIN PROC.   06040000
         SPACE                                                          06060000
         SR    R0,R0              CLEAR REGISTER FOR COMPARE    PTM4030 06061001
         C     R0,RELPROC         IS THERE A PROCEDURE ENTRY.           06080000
         BE    GSRTNF             NO. GO TO RTN ON NOT FOUND.           06100000
         SPACE                                                          06120000
         MVC   SRCHTTR(3),RELPROC+1    SET TTR FOR GET.                 06140000
         BAL   RE,GSGET           GET PROC DICTIONARY.                  06160000
         IC    R6,RELPROC         GET RELATIVE OFFSET OF PROC ENTRY.    06180000
         LA    R1,0(R6,R9)        POINT R1 AT OFFSET.                   06200000
         BAL   RE,GSENDCK             CHECK FOR END OF DICT             06220000
GSRCH4A  DS    0H                                                       06240000
         TM    1(R1),GSEXPPGM     IS THIS A PGM ENTRY (WITHIN A PROC).  06260000
         BO    GSRCH1A1           YES. GO TO COMPARE NAMES.             06280000
         SPACE                                                          06300000
         TM    1(R1),GSEXPGM      THIS A PGM ENTRY NOT IN PROC  YA01401 06320002
         BO    GSRTNF             YES GO TO RTN ON NOT FOUND    YA01401 06326002
         TM    1(R1),GSEXPROC     IS THIS ANOTHER PROC          YA01401 06344002
         BO    GSRTNF             YES GO TO RTN ON NOT FOUND    YA01401 06350002
         B     GSRCH1B            NO. GO TO GET NEXT DICT ENTRY.        06360000
         EJECT                                                          06380000
*********************************************************************** 06400000
*                                                                       06420000
*   SUBROUTINE TO COMPARE DICT ENTRY VS ARGUMENT.                       06440000
*                                                                       06460000
*********************************************************************** 06480000
GSCOMPAR DS    0H                                                       06500000
         LR    R4,R2              PTR TO ENTRY NAME TO R4.              06520000
         SR    R4,R1              DIFFERENCE BETWEEN BEGIN & ENTRY NAME 06540000
         IC    R6,0(R1)           TOTAL LENGTH OF ENTRY.                06560000
         SR    R6,R4              LENGTH OF ENTRY NAME.                 06580000
         IC    R4,0(R3)           LENGTH OF ARGUMENT NAME.              06600000
         CLR   R6,R4              ARE THE LENGTHS EQUAL.                06620000
         BNE   0(RE)              NO. RETURN.                           06640000
         BCTR  R4,0               YES. DECREMENT LENGTH FOR EX INSTRUCT 06660000
         SR    R0,R0               CLEAR REGISTER FOR COMPARE   PTM4030 06661001
         CR    R4,R0              IS LENGTH LESS THAN ZERO       A20647 06666018
         BL    GSCOMP2            YES.  BRANCH                   A20647 06672018
         EX    R4,GSCOMP1         COMPARE ENTRY NAME VS ARGUMENT NAME.  06680000
         BNE   0(RE)              NO. RETURN.                           06700000
GSCOMP2  EQU   *                                                 A20647 06710018
         LA    RE,4(RE)           EQUAL. SET RE TO RETURN TO FOUND.     06720000
         BR    RE                 RETURN.                               06740000
         SPACE 2                                                        06760000
GSCOMP1  CLC   1(1,R3),0(R2)                                            06780000
         EJECT                                                          06800000
*********************************************************************** 06820000
*                                                                       06840000
*   RETURNS FROM LEVEL 2 TO LEVEL 1.  (NOTFOUND/NORMAL).                06860000
*                                                                       06880000
*********************************************************************** 06900000
GSRTNF   DS    0H                                                       06920000
*   NOT FOUND RETURN.                                                   06940000
         TM    SRCHSW1,SRCHF3     IS THIS A RETRY.                      06960000
         BZ    GSERRNF            NO. ERROR -GO TO ERROR EXIT.          06980000
*   RETRY                                                               07000000
         L     RE,SRCHL1          *                                     07020000
         LA    RE,4(RE)           *    SET RETURN REG FOR RETRY.        07040000
         ST    RE,SRCHL1          *                                     07060000
         SPACE                                                          07080000
         TM    SRCHSW1,SRCHF1     INDEX TO NEXT ARGUMENT.               07100000
         BO    GSRETN1A           YES. GO TO POINT R3 AT NEXT ARGUMENT. 07120000
         BZ    GSRETN1B           NO.  GO TO TURN OFF F3 & F4 & RETURN. 07140000
*                                                                       07160000
*   NORMAL LEVEL 2 RETURN TO LEVEL 1.                                   07180000
*                                                                       07200000
GSRETN1  DS    0H                                                       07220000
GSRETN1A DS    0H                                                       07240000
         TM    SRCHSW1,SRCHF1+SRCHF2+SRCHF3+SRCHF4  CHECK FOR SEARCH    07260000
*                                 ON CONDITIONALLY QUALIFIED STEPNAME.  07280000
         BO    GSRETN1B           ALL FLAGS ON INDICATE NO INDEXING.    07300000
         IC    R6,0(R3)           POINT R3 AT LENGTH BYTE OF     YM4022 07350001
         LA    R3,1(R6,R3)          THE SEARCH ARGUMENT          YM4022 07352001
GSRETN1B DS    0H                                                       07373320
         NI    SRCHSW1,FF-SRCHF3-SRCHF4     TURN OFF F3 AND F4.         07380000
         L     RE,SRCHL1          RESTORE LEVEL 1 RETURN REG.           07400000
         BR    RE                 RETURN TO LEVEL ONE.                  07420000
         EJECT                                                          07440000
*********************************************************************** 07460000
*                                                                       07480000
*   CHECK FOR END OF DICTIONARY AND GET NEXT ENTRY.                     07500000
*                                                                       07520000
*********************************************************************** 07540000
GSENDCK  DS    0H                                                       07560000
         SPACE                                                          07580000
         IC    R6,0(R1)           *    POINT R1 AT THE LENGTH BYTE OF   07600000
         LA    R1,0(R6,R1)        *         THE NEXT DICT ENTRY.        07620000
GSENDCK1 DS    0H                 ENTRY, R1 POINTS TO NEXT DIST ENTRY   07640000
         ST    RE,SRCHL2          SAVE LEVEL 2 RETURN REG.              07660000
         SPACE                                                          07680000
         CLI   0(R1),X'00'        IS THIS THE END OF THIS DICT.         07700000
         BNE   0(RE)              NO. RETURN TO LEVEL 2 , R1 = ENTRY.   07720000
         SPACE                                                          07740000
         CLC   4(3,R9),GS7F       IS THERE A CHAIN TTR FOR THIS DICT.   07760000
         BE    GSRTNF             NO. GO TO NOT FOUND RETURN.           07780000
         SPACE                                                          07800000
         MVC   SRCHTTR(3),4(R9)   DICT IS CHAINED. GET NEXT DICTIONARY. 07820000
         BAL   RE,GSGET           LINK TO GET NEXT DICTIONARY.          07840000
         SPACE                                                          07860000
         L     RE,SRCHL2          RESTORE LEVEL 2 RETURN REG.           07880000
         BR    RE                 RETURN TO LEVEL 2.                    07900000
         EJECT                                                          07920000
*********************************************************************** 07940000
*                                                                       07960000
*   SUBROUTINE TO GET NEXT/FIRST DICTIONARY FOR LEVEL 2 OR LEVEL 3.     07980000
*                                                                       08000000
*********************************************************************** 08020000
GSGET    DS    0H                                                       08040000
         STM   RE,R0,SRCHL3       SAVE REGS 14,15 AND 0.                08060000
         SPACE                                                          08080000
         CLC   SRCHTTR(3),GS7F    DOES TTR PASSED EQUAL ZERO.           08100000
         BE    GSGET1             YES. ONLY ONE DICT-MVC DICT1 TO DICT2 08120000
         SPACE                                                          08140000
         CLC   SRCHTTR(3),SREFB   IS DICT IN DICT 1 SLOT.               08160000
         BE    GSGET1             YES. GO TO MOVE DICT1 TO DICT2.       08180000
*                                                                       08200000
*   MUST GET DICT FROM DISK. SET UP LINKAGE TO Q MANAGER.               08220000
*                                                                       08240000
         LA    R8,QPARM           Q-MANAGER PARAMETER AREA ADDRESS.     08260000
         USING IOPARAMS,R8                                              08280000
         L     R4,QMPCL           ADDRESS OF QMPCA/QMPEX.               08300000
         ST    R9,0(R4)           DICT 2 ADDRESS TO QMPCA.              08320000
         MVC   4(3,R4),SRCHTTR    TTR TO QMPEX.                         08340000
         MVI   QMPOP,QMREAD       INDICATE READ ONLY.                   08360000
         IEFSAVER SAVEPTR         GET NEW REGISTER SAVE AREA.           08380000
         SPACE                                                          08400000
         L     RF,GSVHQ           IEFVHQ ADDRESS TO RF.                 08420000
         BALR  RE,RF              LINK TO Q-MANAGER INTERFACE MODULE.   08440000
         SPACE                                                          08460000
         IEFRELSE SAVEPTR         FREE NEW REGISTER SAVE AREA.          08480000
         SPACE                                                          08500000
         B     GSGET2             GO TO POINT TO FIRST DICT ENTRY.      08520000
         SPACE                                                          08540000
*                                                                       08560000
*   DICT ASKED FOR IS DICT 1.                                           08580000
*                                                                       08600000
GSGET1   DS    0H                                                       08620000
         MVC   DREFB(176),SREFB   SHIFT DICT 1 TO SEARCH.               08640000
         SPACE                                                          08660000
GSGET2   DS    0H                                                       08680000
         LA    R1,7(R9)           POINT R1 AT FIRST DICT ENTRY.         08700000
         SPACE                                                          08720000
         LM    RE,R0,SRCHL3       RESTORE R14,R15 & R0.                 08740000
         BR    RE                 RETURN.                               08760000
         EJECT                                                          08780000
*********************************************************************** 08800000
*                                                                     * 08820000
*              CONSTANTS.                                             * 08840000
*                                                                     * 08860000
*********************************************************************** 08880000
**                                                                    * 08900000
GSJOBLIB DC    X'06'              CHECK FOR JOBLIB REFERBACK.           08920000
         DC    C'JOBLIB'                                                08940000
GS7F     DC    F'127'             MASK TO TURN OFF HIGH ORDER BIT -1ST  08960000
*                                      3 BYTES ALSO TO CK TTRS.         08980000
GSVHQ    DC    V(IEFVHQ)          Q-MANAGER INTERFACE MODULE.           09000000
LCONT    EQU   X'FD'                                             YM4022 09010001
GSVGK    DC    V(IEFVGK)           GET KEY ROUTINE               F36294 09012020
PATCH    DC    25F'0'              ************PATCH SPACE*******Y02668 09016002
         END                                                            09020000
./  ADD  SSI=72580044,NAME=IEFVHA
*********************************************************************** 00020002
*                                                                       00029002
*   MODULE NAME= IEFVHA                                                 00038002
*                                                                       00047002
*   DESCRIPTIVE NAME= GET ROUTINE                                       00056002
*                                                                       00065002
*   COPYRIGHT= N/A                                                      00074002
*                                                                       00083002
*   STATUS= OS/VS2 RELEASE 3                                   @ZA08442 00092003
*                                                                       00101002
*   FUNCTION= READS JCL STATEMENTS FROM THE JCL DATA SET, THE PROCEDURE 00110002
*             LIBRARY, AND INSTREAM PROCEDURES, AS REQUIRED; AND        00119002
*             PERFORMS END OF FILE PROCESSING FOR EACH OF THE ABOVE     00128002
*      OPERATION= 1. READS FROM THE JCL DATA SET OR A PROCEDURE ACCORD- 00137002
*                    ING TO READ FLAG SETTINGS.                         00146002
*                 2. PERFORMS EOF PROCESSING FOR THE JCL DATA SET AS    00155002
*                    FOLLOWS: SETS SWITCH EOFR AND MOVES A NULL STATE-  00164002
*                    MENT INTO THE INPUT BUFFER AND TAKES A NORMAL      00173002
*                    EXIT.                                              00182002
*                 3. PERFORMS END OF FILE PROCESSING FOR A PROCEDURE    00191002
*                    AS FOLLOWS: CHECKS IF ANY SYMBOLIC PARAMETERS      00200002
*                    REMAIN UNUSED, AND FAILS THE JOB IF ANY DO. SETS   00209002
*                    SWITCH PREF AND CLEARS ALL PROC SWITCHES, MOVES    00218002
*                    A NULL STATEMENT INTO THE INPUT BUFFER AND EXITS.  00227002
*                 4. PROVIDES INSTREAM PROCEDURE SUPPORT AS FOLLOWS:    00236002
*                    REPLACES THE BSAM ROUTINE ADDRESS IN THE DCB WITH  00245002
*                    THE ADDRESS OF THE INSTREAM PROC GET ROUTINE       00254002
*                    (IEFVIND), WHEN AN INSTREAM PROCEDURE IS TO BE     00263002
*                    READ FROM SWA.                                     00272002
*                                                                       00281002
*   NOTES                                                               00290002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00299002
*      DEPENDENCIES= NONE                                               00308002
*      RESTRICTIONS= NONE                                               00317002
*      REGISTER CONVENTIONS=                                            00326002
*                            R2- MESSAGE CODE FOR IEFVGM                00335002
*                            R9- STATEMENT POINTER                      00344002
*                            RB- BASE REGISTER                          00353002
*                            RC- CWA POINTER                            00362002
*                            RD- SAVE AREA POINTER                      00371002
*      PATCH-LABEL= PATCH                                               00380002
*                                                                       00389002
*   MODULE TYPE= BAL                                                    00398002
*      PROCESSOR= ASSEMBLER                                             00407002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00416002
*                                                                       00425002
*   ENTRY POINT= IEFVHA                                                 00434002
*      PURPOSE= READ JCL STATEMENTS                                     00443002
*      LINKAGE= BRANCH ON REGISTER                                      00452002
*      INPUT DATA= CONVERTER WORK AREA                                  00461002
*                  RC- POINTS TO CWA                                    00470002
*      REGISTERS SAVED= NONE                                            00479002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00488002
*      REGISTERS RESTORED= NONE                                         00497002
*                                                                       00506002
*   EXIT - NORMAL= BRANCH TO IEFVHC                                     00515002
*      CONDITIONS= UNCONDITIONALLY                                      00524002
*      OUTPUT DATA= JCL STATEMENT IN BUFFER                             00533002
*                   R9- POINTS TO INPUT BUFFER                          00542002
*      RETURN CODES= NONE                                               00551002
*                                                                       00553002
*   EXIT - ERROR= BRANCH TO IEFVHAA                                     00555002
*      CONDITIONS= ERRORS ON EOF(JCL D. S. AND PROCLIB)                 00557002
*      OUTPUT DATA= ERROR MESSAGE WRITTEN TO MSG DATA SET               00559002
*      RETURN CODES= NONE                                               00559402
*                                                                       00560002
*   EXIT - ERROR= BRANCH TO IEFVHC                                      00569002
*      CONDITIONS= NULL STMT FOUND IN PROCEDURE                         00578002
*      OUTPUT DATA= ERROR MESSAGE WRITTEN TO THE MESSAGE DATA SET       00587002
*      RETURN CODES= NONE                                               00596002
*                                                                       00598002
*   EXIT - ERROR= BRANCH TO IEFVHF                                      00600002
*     CONDITIONS= I/O ERROR READING                                     00602002
*     OUTPUT DATA= SET TERMINATION BIT(CWATERM) IN CWA                  00604002
*     RETURN CODES= INITIALIZE CWARET TO 8                              00604402
*                                                                       00605002
*   EXTERNAL REFERENCES=                                                00614002
*      ROUTINES= BRANCH TO IEFVGM- WRITE MESSAGE TO MESSAGE DATA SET    00623002
*      ROUTINES= BRANCH TO IEFVGM- WRITE INVALID STATEMENT IN PROCED-   00632002
*                                  URE TO LIST DATA SET                 00641002
*                BRANCH TO IEFVHR- WRITE MESSAGE TO CONSOLE             00650002
*                BRANCH TO IEFVIND VIA DCBREAD- READ STATEMENT FROM     00659002
*                                               INSTREAM PROC           00668002
*                BRANCH TO IEFVHEB- WRITE INSTREAM PROC STATEMENT TO    00677002
*                                   LIST DATA SET                       00686002
*                BRANCH TO IEFVHQ- READ SYMBUF FROM SWA                 00695002
*      DATA AREAS= JCL DATA SET INPUT BUFFER                            00704002
*                  PROCEDURE LIBRARY INPUT BUFFER                       00713002
*                  CWA, SYMBUF, INSTREAM PROC PARMLIST                  00722002
*      CONTROL BLOCKS= QMPA, DCB, RPL                                   00731002
*      TABLES= NONE                                                     00740002
*      MACROS= IEFVMCWA, DCBD, IEFQMNGR, IEFVKEYS, IFGRPL               00749002
*      ENQUEUE RESOURCES= NONE                                          00758002
*      CHANGE LEVEL= OZ03606,OZ05366,OZ07517,OZ08442           @ZA08442 00767003
*                                                                       00776002
*   MESSAGES=                                                           00785002
*      TO MESSAGE DATA SET=                                             00794002
*             IEF601I INVALID STATEMENT IN PROCEDURE                    00803002
*             IEF602I INPUT DEVICE I/O ERROR READING FOR JOB            00812002
*             IEF603I PROCLIB DEVICE I/O ERROR READING FOR JOB          00821002
*             IEF610I PROCEDURE HAS NO STEP                             00830002
*             IEF657I SYMBOL NOT DEFINED IN PROCEDURE                   00839002
*      TO CONSOLE=                                                      00848002
*             IEF417I PROCLIB DEVICE I/O ERROR READING FOR JOB JJJ      00857002
*             IEF419I INPUT DEVICE I/O ERROR READING FOR JOB JJJ        00866002
*                                                                       00875002
*********************************************************************** 00884002
         EJECT                                                          00893002
         IEFCOMWA                                                Y02668 00960002
         IEFCVRWA                                                Y02668 00990002
         IEFTXTFT                                                Y02668 01030002
         DCBD  DSORG=(PS)                                               01040000
NEL      DSECT                                                          01044002
         IEFNEL SUBCOM=C                                                01048002
         IEFQMNGR                                                       01052002
INTKEY3  EQU   X'F2'                                             Y02668 01054002
         EJECT                                                          01056002
         IEFVMSWA                                                       01058002
         EJECT                                                          01060000
         IFGRPL                                                         01066002
         EJECT                                                   Y02668 01068002
         IDARMRCD                                                Y02668 01070002
         EJECT                                                          01072002
IEFVHA   CSECT                                                          01080000
* D 019202-019212                                              @ZA01562 01090003
* C 036928                                                     @ZA01892 01100003
* ADDED STATEMENTS NEAR LABEL A644A                            @ZA05366 01110003
* ADDED CODE NEAR LABEL A644E, AND ADDED LABEL A644AB          @ZA07517 01115003
* DELETED IEFSAVER MACRO IN A9 SUBROUTINE                      @ZA08442 01117003
         BALR  RB,0                                                     01120000
         USING *,RB          *                                          01140000
         USING IHADCB,R3                                                01160000
*****************************************************************Y02668 01162002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01164002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01166002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01168002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01170002
         DC    C'VHA '             MOD ID USED BY TRACE.         Y02668 01172002
* TRACE RETURNS HERE.                                            Y02668 01174002
*****************************************************************Y02668 01176002
         B     A6                                                       01180000
         MODID BR=NO                                             Y01886 01230001
         DC    C'SPLT'                                           Y02668 01235002
         DC    C'04'               LEVEL # (NEL CODE DELETION).  Y02668 01240002
         DC    C'REL3PTF'    TURN OFF COMMENTS SWITCH AT EOF   @ZA03606 01241003
*        DC    C'01' LEV # (PTF UZ00952 PREVENT 0C4 IN IEFVFA).@ZA03606 01247003
*        DC    C'02' LEV # (PTF UZ01541 PREVENT 0B0-C IN VHA). @ZA05366 01251003
*        DC    C'03' LEV # (PTF UZ03049).                      @ZA07517 01254003
         DC    C'04' LEV # (PTF UZ03361 DONT SAVE REGS)        @ZA08442 01256003
A6       DS    0H                                                       01260000
         L     R8,CTRLWAP          ADDRESS OF SCAN WORK AREA.   YM02718 01260102
         TM    IWAPARM,EOFPROC         IS THIS A READER EOF FROM  M4268 01260219
*                                      IEFVINA FOR AN INSTREAM    M4268 01260419
*                                      PROC                       M4268 01260619
         BO    A66                     YES, RESTORE EODAD AND     M4268 01260819
*                                      SYNAD ADDRESSES TO QSAM    M4268 01261019
*                                      DCB                        M4268 01261219
         TM    SWE,GPI                  GET PROC INPUT                  01266014
         BZ    A66                      BR NO                           01272014
         L     R3,PDCBP           PROC DCB                              01272717
         TM    SWI,BLKPRC         BLOCK RTN SWITCH ON?                  01274817
         BO    A961               GOTO UNBLOCKING ROUTINE.              01275517
         OI    SWI,BLKPRC         TURN ON BLOCK SWITCH.                 01276217
         MVC   IWAINTS4(4),PSTMT  SAVE THE BUFFER ADDRESS.              01276917
A62      LA    R2,0(0,0)                                                01277617
         STH   R2,IWANLRC     ZERO LOG REC COUNT                        01278317
         LA    R2,A9                                            YM02718 01279002
         L     R3,PDCBP      PROC DCB                                   01289017
         ST    R2,20(RD)                TEMP SAVE                       01300000
         MVC   DCBSYNAD+1(3),21(RD)     SYNAD                           01380000
         LA    R2,A644                  EODAD                           01400000
         ST    R2,20(RD)                                                01420000
         MVC   DCBEODAD+1(3),21(RD)                                     01440000
         LA    R2,QLINKWA     **USE QLINKWA AS A DECB                   01480000
         L     R9,PSTMT                 BUFFEP PTR                      01500000
         TM    IWAPARM,INSTPROC        SEE IF IN-STREAM PROCS ARE M4763 01502019
*                                      BEING USED                 M4763 01504019
         BZ    A623                    NO - ISSUE A READ          M4763 01506019
         MVC   DCBREAD+DISPLONE(MVTHREE),VIEFVIND+DISPLONE        M4763 01508019
*                                      ADDRESS OF PSEUDO ACCESS   M4763 01510019
*                                      METHOD TO BE USED TO READ  M4763 01512019
*                                      STATEMENTS FROM AN IN-STREAM4763 01514019
*                                      PROCEDURE                  M4763 01516019
A623     DS    0H                                                 M4763 01518019
         READ  (2),SF,(3),(9),MF=E                                      01520000
         TM    IWAPARM,INSTPROC        IN-STREAM PROCEDURE BEING  M4763 01526019
         BO    A63                     PROCESSED                  M4763 01532019
         LR    R1,R2                    DECB                            01540000
         CHECK (1)                                                      01560000
A63      DS    0H                                                 O106  01570019
         TM    SWC,IOERR                I/O ERROR                       01580000
         BZ    A64                      BR NO                           01600000
         LA    R2,MSG3                  I/O ERR                         01620000
         BAL   RA,A686                  PUT MSG                         01640000
         B     A644                     SET PROC EOF                    01660000
A64      DS    0H                                                       01680000
         CLC   NULL(2),0(R9)            // STMT                         01700000
         BNE   A641          BR NO - INVALID STMT IN PROC       A25814  01710019
*        TEST FOR A NULL STATEMENT - NOT VALID IN PROC          A25814  01712019
         CLI   D2(R9),C' '   TEST COL 3 FOR A BLANK             A25814  01714019
         BNE   A68           BR NOT BLANK, STMT OK              A25814  01716019
         CLC   D2(LEN,R9),D3(R9)  TEST COLS 4-71 FOR BLANKS     A25814  01718019
         BNE   A68           BR NOT BLANKS, STMT OK             A25814  01720019
A641     EQU   *             HERE FOR NULL OR NOT //            A25814  01722019
         TM    IWAPARM,INSTPROC   IN-STREAM PROC BEING PROCESSED. M5288 01722420
         BZ    A641A         NO-INSTREAM CLEANUP NOT NEEDED.      M5288 01722520
**********************************************************************  01724420
D1       EQU   1             DISPLACEMENT TO COL 1                M5288 01725020
D2       EQU   2             DISPLACEMENT TO COL 2              A25814  01725620
D3       EQU   3             DISPLACEMENT TO COL 3              A25814  01726220
TWENTY4  EQU   24            LENGTH OF IN-STREAM LIST             M5288 01726820
LEN      EQU   68            NO OF COLS CHECKED TO SCANE        A25814  01728019
*                            FOR NULL STMT.                     A25814  01730019
*        LEN=68 CHECKS COLS 3-71.                               A25814  01732019
**********************************************************************  01732420
         SPACE 1                                                        01732820
*        IN-STREAM PROC PARAM LIST MUST BE FREED AS A RESULT OF   M5288 01734020
*         THE INVALID CARD WITHIN THE INSTREAM PROC               M5288 01736020
         LA    R0,TWENTY4    LENGTH OF AREA TO BE FREED.          M5288 01738020
         L     R1,IWAPARM    ADDRESS OF AREA TO BE FREED.         M5288 01738420
         FREEMAIN R,LV=(0),A=(1)                                  M5288 01738820
         XC    IWAPARM+D1(D3),IWAPARM+D1  CLEAR IWA PARM POINTER  M5288 01739220
A641A    DS    0H                                                Y02668 01740002
         TM    IWAJMSGL,AOMSGLV1   MSGLEVEL=1?                   Y02668 01780002
         BZ    A642                     BR NO                           01800000
         L     R2,AOWSTMT          GET 'WRITE' BUFFER ADDR       Y02668 01804002
         MVI   0(R2),C' '          BLANK OUT 'WRITE' BUFFER      Y02668 01808002
         MVC   1(BUFLTH,R2),0(R2)  BEFORE MOVING IN STMT         Y02668 01812002
         MVC   STNLTH(AOMSGLTH,R2),0(R9)  MOVE STMT TO BUFFER    Y02668 01816002
         SR    R2,R2                                                    01820000
         BAL   RA,A687                  STMT TO SMB                     01840000
A642     DS    0H                                                       01860000
         LA    R2,MSG1                  INVALID STMT IN PROC            01880000
         BAL   RA,A686                  PUT MSG                         01900000
*                                                               YM02718 01920002
A644     DS    0H                  PROC EODAD.                  YM02718 01920802
*****************************************************************Y02668 01921502
*                                                               *Y02668 01921802
*        CHECK EACH ENTRY IN THE SYMBOLIC PARAMETER TABLE       *Y02668 01922102
*        (THESE ENTRIES ARE MAPPED FROM THE PROC STMT).   MAKE  *Y02668 01922402
*        SURE IT HAS BEEN REFERENCED IN THE PROCEDURE.          *Y02668 01922702
*                                                               *Y02668 01923002
*****************************************************************Y02668 01923302
         L     RF,SYMTTR           LOAD PTR TO FIRST SYMBUF.    YM02718 01923602
         LTR   RF,RF               SYMB PARMS IN THIS PROCEDURE?YM02718 01924202
         BZ    A644G               NO, BYPASS SYMB PARM CHECK.  YM02718 01924802
         TM    AOSW2,X'80'   WAS SYMBOLIC DICTIONARY WRITTEN   @ZA05366 01925003
         BZ    A644B         NO, BYPASS SYMB DICTIONARY READ   @ZA05366 01925203
         L     RF,IEFVHQV          Q-MNGR ADDRESS                Y02668 01925402
         LA    R2,SYMBUF           SET UP TO READ SYMBUFF IN     Y02668 01925702
         L     R5,QPARM+QMPCL-QMNAM  FROM QUEUE                  Y02668 01926002
A644A    DS    0H                                                Y02668 01926302
         ST    R2,CLEAR(R5)        TELL QMNGR WHERE TO PUT SYMBUFY02668 01926602
         MVC   4(TTRLTH,R5),SYMTTR GIVE QMNGR TTR OF RECORD TO   Y02668 01926902
*                                  BE READ                       Y02668 01927202
A644AB   DS    0H                                              @ZA07517 01927303
         MVI   7(R5),CLEAR         ZERO BYTE FOLLOWING TTR       Y02668 01927502
         MVI   QPARM+QMPOP-QMNAM,QMREAD INDICATE READ OPERATION  Y02668 01927802
         BALR  RE,RF               GO TO READ SYMBUF             Y02668 01928102
A644B    DS    0H           COME HERE TO  BYPASS DICTIONARY RD @ZA05366 01928403
         LA    R2,SYMBUF+8         PTR TO FIRST ENTRY IN SYMBUF  Y02668 01928702
A644C    DS    0H                                                Y02668 01929002
         CLI   CLEAR(R2),CLEAR     Q. SYMBOLIC PARM FIELD ENTEREDY02668 01929302
         BE    A644E               NO, CHECK TO SEE IF SYMBUF    Y02668 01929602
*                                  HAS BEEN SPILLED              Y02668 01929902
         TM    1(R2),USEFLAG       Q. SYMBOLIC PARM USED         Y02668 01930202
         BZ    A644D               YES, CONTINUE SEARCH          Y02668 01930502
         LA    R2,MSGSYMP          NO, ERROR - SET MSG CODE      Y02668 01930802
         BAL   RA,A686             FAIL JOB AND ISSUE MSG.      YM02718 01931102
         B     A644F               CONTINUE PROCESSING.         YM02718 01932102
A644D    DS    0H                                                Y02668 01933202
         SR    RE,RE               CLEAR REG FOR INSERT          Y02668 01933502
         IC    RE,CLEAR(R2)        GET OFFSET TO NEXT ENTRY      Y02668 01933802
         AR    R2,RE               UPDATE PTR TO NEXT ENTRY      Y02668 01934102
         B     A644C               CONTINUE SEARCH               Y02668 01934402
A644E    DS    0H                                                Y02668 01934702
         L     R2,SYMBUF+4         Q. DID SYMBUF SPILL TO        Y02668 01935002
         LTR   R2,R2               ANOTHER BUFFER                Y02668 01935302
         BZ    A644F               NO, CONTINUE PROCESSING       Y02668 01935602
         MVC   4(TTRLTH,R5),SYMBUF+4  YES, SET UP TO READ      @ZA07517 01935903
         LA    R2,SYMBUF           NEXT SYMBUF INTO CORE         Y02668 01936202
         B     A644AB              GO BACK TO READ             @ZA07517 01936503
A644F    DS    0H                                                Y02668 01936802
A644G    DS    0H                                                Y02668 01937702
         OI    SWE,PREF                 PROC EOF                        01940000
         XC    PSTMT+4,PSTMT+4     CLEAR VERB KEY FOR NEXT PROC.YM      01940302
          TM    SWC,PEXP               EXEC IN PROC EXPECTED     A27937 01940619
          BZ    A645                   NO,BRANCH                 A27937 01941219
          LA    R2,EAR49               YES,HAS NOT BEEN RECEIVED A27937 01941819
          BAL   RA,A686                PUT OUT MESSAGE           A27937 01942419
A645     DS    0H                                                 M4268 01942719
         NI    IWAPARM,EOFINST         IN-STREAM PROCEDURE IS NOT M4763 01943019
*                                      BEING PROCESSED ANY MORE   M4763 01946019
         NI    SWI,255-BLKPRC          TURN OFF UNBLOCKING RTN    M4268 01950019
*                                      SWITCH                     M4268 01954019
         NI    SWE,255-PROC-GPI   CLEAR PROC & GET PROC INPUT     11499 01960014
         MVC   0(3,R9),NULL             BUILD A NULL STMT               01980000
         MVC   3(77,R9),2(R9)                                           02000000
         MVC   PSTMT(4),IWAINTS4   RESTORE BUFFER POINTER               02010017
         NI    SWC,255-IOERR           TURN OFF ERROR FLAG       A49656 02012001
         B     A68                                                      02020000
A66      DS    0H                       GET RDR STMT                    02040000
         TM    IWAPARM,EOFPROC         EOF FOR RDR FROM IEFVINA   M4268 02186019
         BO    A95                     READER EOF FROM IEFVINA    M4268 02192019
         TM    SWB,FRCV                 HAS 1ST STMT BEEN RCVD          02220000
         BZ    A663                     BR NO                           02240000
         L     R9,RSTMT                 PTR TO LAST STMT                02260000
         MVI   0(R9),X'FF'              CLEAR 1ST POS OF STMT           02280000
A663     DS    0H                                                       02300000
         LA    R4,RPLADDR               GET ADDRESS OF RPL       Y02668 02340002
         USING IFGRPL,R4                SET BASE FOR RPL         Y02668 02342002
         L     R6,WANELPTR              GET ADDRESS OF NEL       Y02668 02344002
         USING NEL,R6                   SET BASE FOR NEL         Y02668 02346002
         MVI RPLREQ,RPLGET              REQUEST IS A GET         Y02668 02348002
         MVC   RPLDACB,NELJCLCB         SET POINTER TO ACB       Y02668 02350002
         MVC   RPLAREA,RSTMT            SET POINTER TO BUFFER    Y02668 02352002
         XC    RPLARG(4),RPLARG         ZERO UNUSED FIELD        Y02668 02354002
         MVI   RPLOPT1,RPLSEQ           GET IS SEQUENTIAL        Y02668 02356002
         XC    RPLRLEN(4),RPLRLEN       ZERO UNUSED FIELD        Y02668 02358002
         LA    R0,80                    GET BUFFER LENGTH        Y02668 02360002
         ST    R0,RPLBUFL               SET MAXIMUM BUFFER LENTH Y02668 02362002
         XC    RPLDDDD(4),RPLDDDD       ZERO UNUSED FIELD        Y02668 02364002
         DROP  R6                       RELEASE BASE FOR NEL     Y02668 02366002
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 02368002
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 02369002
         LR    R1,R4                    POINT TO RPL             Y02668 02370002
         GET   RPL=(1)                                                  02372002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 02376002
         LTR   RF,RF               CHECK FOR ERROR               Y02668 02386002
         BZ    A664                NO. BRANCH TO CONTINUE        Y02668 02388002
         CLI   RPLRTNCD,RPLLOGER   IS THIS A LOGICAL ERROR ?     Y02668 02388302
         BNE   ERREXIT             NO. GO TO ERROR EXIT          Y02668 02388602
         CLI   RPLERRCD,RPLEODER   IS END OF DATA DETECTED ?     Y02668 02388902
         BE    A95                 YES. GO TO EOF ROUTINE        Y02668 02389202
         DROP  R4                  RELEASE BASE FOR RPL          Y02668 02389302
         B     ERREXIT             NO. GO TO ERROR ROUTINE       Y02668 02389502
A664     DS    0H                      *                                02390002
         L     R9,RSTMT                 STMT PTR                 Y02668 02392002
         TM    SWB,FRCV                 1ST STMT RCVD                   02420000
         BO    A68                 BRANCH YES.                   Y02668 02440002
         NI    SWC,255-NRCV             TURN OFF RDR NULL               02480000
         OI    SWB,FRCV                 1ST STMT RCVD                   02500000
A68      DS    0H                                                       02780000
         L     RF,IEFVHCV      EXIT TO VERB ID                          02800000
         BR    RF                                                       02820000
         EJECT                                                          02890002
*                                                               YM02718 02960002
*  FAIL JOB AND WRITE MESSAGE TO SYSOUT                         YM02718 03030002
*                                                               YM02718 03100002
A686     DS    0H                                                       03200000
         LA    RF,WAJOBPFX         ADDR OF PSEUDO JOB PFX.      YM02718 03240002
         USING TEXT,RF             PREFIX ADDRESSABILITY.       YM02718 03250002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 03260002
         DROP  RF                                               YM02718 03270002
         XC    MSGKEY(1),MSGKEY    NO SECONDARY MSGS FROM VHA.  YM02718 03275002
A687     DS    0H                                                       03280000
         L     RF,IEFVGMV               MSG ROUTINE                     03300000
         BALR  RE,RF                                                    03320000
         BR    RA                 RETURN                          11791 03340014
         EJECT                                                          03440002
A9       DS    0H                      *SYNAD FOR PROCLIB               03540000
         USING IHADCB,R3               *                                03560000
         NI    DCBIFLGS,X'00'          *TURN OFF DCB ERROR FLAGS        03580000
         OI    SWC,IOERR               *I/O ERROR                       03600000
         LA    R5,MSG2                 *MSG CODE                        03620000
         LR    RA,RE                        RETURN ADDRESS        11791 03644014
         LR    R6,RE               SAVE RETURN REGISTER           11791 03652014
         L     RF,IEFVHRV       **ERROR MSG ROUTINE ADDR.    PTM 14/039 03658014
         BALR  RE,RF               PUT OUT ERROR MESSAGE          11791 03660014
         LR    RE,R6               RESTORE RETURN REGISTER        11791 03668014
         BR    RA                  RETURN                         11791 03672014
         EJECT                                                          03672802
*****************************************************************Y02668 03673002
*                                                               *Y02668 03673202
*   EODAD  ROUTINE  FOR  JCL  DATA  SET                         *Y02668 03673402
*                                                               *Y02668 03673602
*****************************************************************Y02668 03673802
         SPACE 2                                                        03674002
A95      DS    0H                                                Y02668 03674202
         NI    IWAPARM,EOFRINST    TURN OFF EOF BIT FOR JCL DATA Y02668 03674402
*                                  SET, SET BY IEFVINA FOR AN    Y02668 03674602
*                                  INSTREAM PROCEDURE            Y02668 03674802
         L     R9,RSTMT            GET PTR TO CURRENT JCL        Y02668 03675202
*                                  STMT BUFFER                   Y02668 03675402
         OI    SWA,EOFR            INDICATE JCL D. S. EOF IN CWA Y02668 03675602
         MVC   0(MV3,R9),NULL      BUILD A NULL STMT IN THE      Y02668 03675802
         MVC   MV3(STMTLTH-MV3,R9),HALFWORD(R9) JCL D. S. BUFFER Y02668 03676002
         NI    CMTZ,255-CMT    TURN OFF COMMENTS SWITCH AT EOF @ZA03606 03676103
         L     RF,IEFVHCV          GET PTR TO VALIDATION RTN     Y02668 03676202
         BR    RF                  CONTINUE PROCESSING NULL STMT Y02668 03676402
         EJECT                                                          03676602
*****************************************************************Y02668 03676802
*                                                               *Y02668 03677002
*    BLOCKED PROCLIB PROCESSING                                 *Y02668 03677202
*                                                               *Y02668 03677402
*****************************************************************Y02668 03677602
         SPACE 2                                                        03677802
A961     L     R9,PSTMT           ADDRESS OF LAST RECORD.               03679217
         LA    R9,80(0,R9)        INCREMENT TO POINT TO NEXT RECORD.    03680017
         LA    R7,1(0,0)                                                03680817
         AH    R7,IWANLRC                                               03681617
         STH   R7,IWANLRC                                               03682417
         L     R7,IWAINTS4        ADDRESS OF BUFFER                     03683217
         AH    R7,DCBBLKSI        ADD BLOCK SIZE-POINTER TO END OF BUFF 03684017
         CR    R7,R9              IS THIS END OF BLOCK?                 03684817
         BE    A962               BR YES - READ NEW BLOCK.              03685617
         L     R2,DCBIOBA    R2 = ADDR OF IOB PREFIX                    03686417
         SLL   R2,8          CLEAR FLAG BYTE                            03687217
         SRL   R2,8                                                     03688017
         LH    R5,22(0,R2)         R5=RESIDUAL BYTE CT IN CSW.  YM02718 03688802
         LTR   R5,R5               COUNT=0?                     YM02718 03689602
         BE    BLKSTR        YES-PROCESS NORMALLY-NO TRUNCATION         03690417
         SR    R7,R5       NO,FIND THE ACTUAL END OF THIS BLOCK.YM02718 03691202
         CR    R9,R7         HAVE ALL RECS IN THIS BLOCK BEEN PASSED?   03692017
         BE    A962          YES-GOTO READ NEW BLOCK           @ZA01892 03692803
BLKSTR   ST    R9,PSTMT      NO-PASS POINTER TO THIS RECORD             03693617
         B     A64                GOTO DATA CHECK RTN.                  03694417
A962     MVC   PSTMT(4),IWAINTS4  RESTORE BUFFER ADDRESS FOR READ.      03695217
         B     A62                 GO TO READ ROUTINE.           Y02668 03695602
         EJECT                                                          03696002
*****************************************************************Y02668 03696102
*                                                               *Y02668 03696202
*        SYNAD ROUTINE FOR JCL DATA SET                         *Y02668 03696302
*                                                               *Y02668 03696402
*****************************************************************Y02668 03696502
         SPACE 2                                                        03696602
ERREXIT  DS    0H                                                Y02668 03696702
         LA    R5,4                I/O ERROR MSG CODE            Y02668 03697002
         L     RF,IEFVHRV               GET POINTER TO IEFVHR    Y02668 03697502
         BALR  RE,RF                    WRITE MSG TO OPERATOR    Y02668 03698002
         LA    R2,20               I/O ERROR MSG CODE            Y02668 03698502
         BAL   RA,A687             ISSUE ERROR MESSAGE.         YM02718 03699002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE               Y02668 03699602
         OI    AOSW4,CWATERM       INDICATE TERMINATION          Y02668 03699702
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 03700002
         BR    RF                  GO TO TERMINATION             Y02668 03700502
         EJECT                                                          03700702
NULL     DC    C'// '                                                   03701502
PGMERROR DC    X'0024'             PGM ERROR CODE (36)           Y02668 03701702
MVTHREE  EQU   3                       LENGTH OF MOVE             M4763 03702019
INSTPROC EQU   X'80'                   IN-STREAM PROCEDURE BEING  M4763 03704019
*                                      PROCESSED                  M4763 03706019
EOFINST  EQU   X'7F'                   INSTREAM PROCEDURE NOT     M4763 03708019
*                                      BEING PROCESSED            M4763 03710019
EOFRINST EQU   X'BF'                                              M4268 03710619
EOFPROC  EQU   X'40'                                              M4268 03711219
VIEFVIND DC    V(IEFVIND)              ADDRESS OF IEFVIND, PSEUDO O106  03712019
*                                      ACCESS NETHOD              O106  03714019
DISPLONE EQU   1                       DISPLACEMENT               O106  03716019
MV3      EQU   3                       LENGTH OF COMPARE          O106  03718019
MSG1     EQU   1                        INVALID STMT IN PROCEDURE       03720000
MSG2     EQU   2                        RDR I/O ERR                     03740000
MSG3     EQU   3                        PROC I/O ERR                    03760000
EAR49     EQU   X'0A'          PROC HAS NO STEP ERROR            A27937 03763019
MSGSYMP  EQU   X'39'               SYMBOLIC PARMS NOT USED       Y02668 03766002
USEFLAG  EQU   X'80'               INDICATES A SYM PARM WAS USED Y02668 03769002
TTRLTH   EQU   4                   LENGTH OF TTR FIELD           Y02668 03772002
CLEAR    EQU   0                                                 Y02668 03775002
HALFWORD EQU   2                                                 Y02668 03780002
STMTLTH  EQU   80                  JCL STMT LENGTH               Y02668 03800002
STNLTH   EQU   10                  STMT# FIELD LENGTH            Y02668 03805002
BUFLTH   EQU   90                  WHOLE STMT BUFFER LENGTH      Y02668 03810002
AOMSGLTH EQU   BUFLTH-STNLTH       MSG LENGTH                    Y02668 03815002
IEFVHCV  DC    V(IEFVHC)                VERB ID                         03820000
IEFVGMV  DC    V(IEFVGM)                                                03840000
IEFVHRV  DC    V(IEFVHR)               *OPERATOR MSG RTN                03860000
IEFVHQV  DC    V(IEFVHQ)           Q/SWA MANAGER RTN             Y02668 03865002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 03870002
         END                                                            03880000
./  ADD  SSI=62640465,NAME=IEFVHC
*/*                                                                     00030002
**********************************************************************  00032002
*                                                                       00034002
*   MODULE NAME= IEFVHC                                                 00036002
*                                                                       00038002
*   DESCRIPTIVE NAME= COMMENT OR CONTINUATION VALIDATION                00038402
*                                                                       00038802
*   COPYRIGHT= N/A                                                      00039202
*                                                                       00039602
*   STATUS= OS/VS2 RELEASE 3                                   @ZA12458 00039703
*   FUNCTION= IEFVHC CHECKS INPUT FOR THE VALID PRESENCE OR NON-        00041902
*             PRESENCE OF A CONTINUATION OR COMMENT.                    00043902
*      OPERATION= WHEN IEFVHC RECEIVES CONTROL REGISTER 9 POINTS TO THE 00046602
*                 BEGINNING OF THE STATEMENT.  IF A CONTINUATION IS     00047002
*                 EXPECTED AND REVEIVED EXIT TO IEFVHEB.                00047802
*                 IF A CONTINUATION IS NOT EXPECTED EXIT TO             00048202
*                 IEFVHCB.  IF A CONTINUATION IS EXPECTED AND NOT       00048302
*                 RECEIVED, EXIT TO IEFVHEB ( IEFVGM IS USED            00048402
*                 AS A SUBROUTINE TO PRINT ERROR MESSAGE                00050402
*                 PRIOR TO EXIT ). IF THE STATEMENT IS A COMMENT,       00052402
*                 LOAD IEFVHEB VCON AND BRANCH REGISTER TO PRINT IT,    00052602
*                 THEN EXIT TO IEFVHA.  (IF COMMENT CHANGE // TO **)    00054602
*                            (IF CATALOG PROCEEDURE CHANGE // TO XX)    00055602
*                           (IF INSTREAM PROCEEDURE CHANGE // TO ++)    00055702
*                                                                       00056002
*   NOTES                                                               00057002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00058002
*      DEPENDENCIES= NONE                                               00059002
*      RESTRICTIONS= NONE                                               00060002
*      REGISTER CONVENTIONS= ACTUAL REGISTER NUMBERS ARE USED           00061002
*      PATCH-LABEL= PATCH                                               00062002
*                                                                       00063002
*   MODULE TYPE= PROCEDURE                                              00064002
*      PROCESSOR= ASSEMBLER                                             00065902
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00067002
*                                                                       00068002
*   ENTRY POINT= IEFVHC                                                 00073202
*      PURPOSE= DETERMINE PROPER EXIT, DEPENDING ON THE                 00075202
*               VALIDITY OF THE CONTINUATION.                           00075602
*      LINKAGE= LOAD VCON BRANCH REGISTERAC                             00077202
*      INPUT DATA= REG 9 POINTS TO THE STATEMENT                        00079302
*                  REG 10 POINTS TO THE STATEMENT PARAMETER LIST        00079402
*                  REG 12 POINTS TO THE CWA                             00079502
*                  SWITCHES TESTED IN THE CWA                           00081002
*                      (SWA SWB SWE SWZ)                                00083002
*      REGISTERS SAVED= NONE                                            00084502
*      REGISTER CONTENTS DURING PROCESSING=                             00086002
*      REGISTERS RESTORED= NONE                                         00087502
*                                                                       00089002
*   EXIT - NORMAL= LOAD IEFVHEB VCON, BRANCH REGISTER                   00090502
*      CONDITIONS= CONTINUATION EXPECTED AND RECEIVED                   00092002
*      OUTPUT DATA= NONE                                                00093502
*      RETURN CODES= NONE                                               00095002
*                                                                       00096502
*   EXIT - NORMAL= LOAD IEFVHA VCON, BRANCH REGISTER                    00098002
*      CONDITIONS= COMMENT RECEIVED                                     00099502
*      OUTPUT DATA= NONE                                                00101002
*      RETURN CODES= NONE                                               00102502
*                                                                       00104002
*   EXIT - NORMAL= LOAD VCON IEFVHCB, BRANCH REGISTER                   00105502
*      CONDITIONS= CONTINUATION NOT EXPECTED                            00107002
*      OUTPUT DATA= NONE                                                00108502
*      RETURN CODES= NONE                                               00110002
*                                                                       00111502
*   EXIT - ERROR= LOAD VCON IEFVHEB, BRANCH REGISTER                    00113002
*      CONDITIONS= CONTINUATION EXPECTED AND NOT RECIEVED               00114502
*      OUTPUT DATA= REGISTER 2 POINTS TO THE MESSAGE                    00116002
*      RETURN CODES= NONE                                               00117502
*                                                                       00119002
*   EXTERNAL REFERENCES=                                                00120502
*      ROUTINES= IEFVGM (TO PUT OUT ERROR MESSAGE)                      00122002
*                IEFVHEB (STATEMENT NUMBER PROCESSING)                  00122402
*      DATA AREAS= IWA                                                  00123502
*      CONTROL BLOCKS= NONE                                             00125002
*      TABLE= NONE                                                      00126502
*      MACROS= IEFVMIWA                                                 00128002
*      ENQUEUE RESOURCES= NONE                                          00129502
*      CHANGE LEVEL= ZA02374, ZA12458                          @ZA12458 00131003
*                                                                       00132502
*   MESSAGES= (EXPECTED CONTINUATION NOT RECEIVED)                      00134002
*             PASSED TO IEFVGM TO BE PRINTED                            00135502
*                                                                       00137002
**********************************************************************  00138502
**/                                                                     00140002
         EJECT                                                          00740000
         IEFCOMWA                                                Y02668 00760002
         IEFCVRWA                                                Y02668 00770002
         EJECT                                                          00782002
         IEFVMCWA                                                       00784002
         EJECT                                                          00792019
JCTD     DSECT                                                          00800000
         IEFAJCTB                                                       00820000
         IEFTXTFT                                                Y02668 00830002
         EJECT                                                          00840000
IEFVHC   CSECT                                                          00860000
* A 015960-015970,016520-016540                                @ZA02374 00880003
* A STMTS AFTER LABEL B1725                                    @ZA12458 00890003
         BALR  RB,0                                                     00900000
         USING *,RB                                                     00920000
*****************************************************************Y02668 00942002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 00944002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 00946002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 00948002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 00950002
         DC    C'VHC '             MOD ID USED BY TRACE.         Y02668 00952002
* TRACE RETURNS HERE.                                            Y02668 00954002
*****************************************************************Y02668 00956002
         B     B1                                                       00960000
         MODID BR=NO                                             Y01886 01010001
         DC    C'REL3'              FUNCTION ID AND                     01030603
*        DC    C'02' LEV # (CONT. EXPECTED NOT RECD. MSG).     @ZA02374 01034603
         DC    C'03'          LEV # (CONT EXP NOT RECEIVED              01035603
*                             FOR OPERAND FIELD)               @ZA12458 01036603
B1       DS    0H                                                       01040000
         DROP  RA           REMOVE CWA ADDRESSABILITY          @ZA00894 01070003
         TM    SWE,GPI                  PROC STMT                       01100000
         BZ    B14                      BR NO                           01120000
         LA    RA,PSTMT                 PROC STMT PARM LIST             01140000
         B     B142                                                     01160000
B14      DS    0H                                                       01180000
         LA    RA,RSTMT                 RDR STMT PARM LIST              01200000
B142     DS    0H                                                       01220000
         L     R9,0(0,RA)               PTR TO STMT                     01240000
         CLC   0(3,R9),COMMENT     IS THIS A COMMENT CARD (//*)?YM03493 01241002
         BNE   B146               BRANCH NO                        AABA 01242016
         MVI   0(R9),C'*'         MARK COMMENT CARD                AABA 01243016
         MVI   1(R9),C'*'         *                                AABA 01244016
         OI    AOSW1,AOPRTSW       TELL VHEB TO PRINT STMT       Y02668 01245002
         L     RF,IEFVHEBV         EXIT ADDR                     Y02668 01246002
         L     RE,IEFVHAV          RETURN ADDR AFTER PRINT       Y02668 01247002
         BR    RF                  EXIT TO PRINT STMT            Y02668 01248002
B146     DS    0H                                                  AABA 01251016
         TM    SWE,GPI            IS THIS STATEMENT IN A PROC      AABA 01252016
         BO    B180               BRANCH YES                       AABA 01253016
B148     DS    0H                                                  AABA 01254016
         TM    SWB,CXP                  CONT EXPECTED                   01260000
         BO    B15                                                      01280000
         L     RF,IEFVHCBV                                              01300000
         BR    RF             EXIT TO VERB ID                           01320000
B15      DS    0H                                                       01340000
         TM    SWE,GPI             IS THIS STATEMENT IN A PROC  YM03493 01341002
         BO    B152                YES - BYPASS (//) CHECK      YM03493 01342002
         CLC   0(2,R9),SLASH       IS THIS A JCL STATEMENT?     YM03493 01343002
*                                  (//) VALIDATION IS MADE ON   YM03493 01344002
*                                  EVERY CONTINUATION TO INSURE YM03493 01345002
*                                  JESS HAS NOT PASSED A DATA   YM03493 01346002
*                                  CARD TO INDICATE DATA WAS    YM03493 01347002
*                                  FOUND IN THE INPUT STREAM    YM03493 01348002
*                                  INSTEAD OF EXPECTED CONTINU. YM03493 01349002
         BE    B152                YES - GO TO VALIDATE CONT.   YM03493 01350002
         L     RE,IEFVHAV          NO - GET RETURN ADDR.        YM03493 01351002
         B     B1717               GO TO ISSUE ERROR MESSAGE    YM03493 01352002
*                                  AND FLUSH DATA CARD.         YM03493 01353002
B152     DS    0H                                               YM03493 01354002
         CLI   2(R9),C' '               COL 3 BLANK                     01360000
         BNE   B1715               BRANCH NO                     Y02668 01380002
         CLC   3(12,R9),2(R9)           4 TO 15 BLANK                   01400000
         BNE   B174               BRANCH NO                        AABA 01420016
         CLI   15(R9),C' '              COL 16 BLANK                    01440000
         BE    B172                     BR YES                          01460000
         TM    SWZ,ENDS           TEST END SCAN SW                 AABA 01465016
         BO    B173               BRANCH ON                        AABA 01470016
         TM    SWZ,CMT            IS COMMENT SW ON                 AABA 01471016
         BO    B173               YES, O'RIDING DD STMT            AABA 01472016
B154     DS    0H                                                  AABA 01475016
         MVI   LISTPTR(RA),15           SET REL LIST PTR IN PARM LIST   01480000
B16      DS    0H                                                       01500000
         L     RF,IEFVHEBV                                              01520000
         BR    RF             EXIT TO JOB CONTROL, ENTRY B              01540000
B171     DS    0H                                                  AABA 01590016
         L     RE,IEFVHCBV         GET VHCB ADDR                 Y02668 01591002
         B     B1717               GO TO PUT MSG                 Y02668 01592002
B1715    DS    0H                                                Y02668 01593002
         L     RE,IEFVHEBV         GET IEFVHEB ADDR              Y02668 01594002
B1717    DS    0H                                                Y02668 01595002
         TM    SWB,CXPN     CONT EXP,NOT RECD ALREADY ON       @ZA02374 01596003
         BO    B1718        YES,MSG ALREADY PUT OUT            @ZA02374 01597003
         OI    SWB,CXPN           CONT EXP, NOT RECD               AABA 01600016
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 01610002
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 01612002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT            Y02668 01614002
         DROP  R8                                                Y02668 01616002
         L     R2,CTRLWAP     GET WORK AREA ADDR               @ZA00894 01616803
         USING CWA,R2             CWA ADDRESSABILITY           @ZA00894 01617603
         MVI   MSGKEY,0           INDICATE NO SECONDARY MSG    @ZA00894 01618403
         DROP  R2                 REMOVE CWA ADDRESSABILITY    @ZA00894 01619203
         LA    R2,MSG15           CONT MISSING MSG                 AABA 01620016
         L     RF,IEFVGMV         PUT MSG - CONT MISSING AND       AABA 01640016
         BR    RF                 EXIT TO JOB CONTROL              AABA 01650016
B1718    DS    0H                                             @ZA02374  01652003
         BR    RE           EXIT TO IEFVHEB,IEFVHCB,OR IEFVHA  @ZA02374 01654003
*                                                               YM03493 01656002
*************************************************************** YM03493 01662002
*  CONTROL WILL BE RETURNED FROM VGM VIA REG14 WHICH HAS BEEN   YM03493 01668002
*  LOADED WITH AN  APPROPRIATE MODULE ADDRESS PRIOR TO ENTRY    YM03493 01674002
*  OF THIS SEGMENT OF CODE.                                     YM03493 01680002
*************************************************************** YM03493 01686002
*                                                               YM03493 01692002
B172     DS    0H                                                       01700000
         CLC   16(55,R9),15(R9)   17 TO 71 BLANK                   AABA 01703016
         BE    B182               BRANCH YES                       AABA 01706016
B1725    DS    0H                                                  AABA 01709016
         TM    SWB,CXPOP           TEST CONT EXP FOR OPERANDS  @ZA12458 01709503
         BNO   B1726               NO, PROCEED                 @ZA12458 01710003
         MVI   2(R9),C'*'          MARK COMMENT CARD           @ZA12458 01710503
         B     B1715               HANDLE CONT NOT RECEIVED    @ZA12458 01711003
B1726    DS    0H                                              @ZA12458 01711503
         TM    SWZ,ENDS           TEST END SCAN SW                 AABA 01712016
         BO    B173               BRANCH IF ON                     AABA 01715016
         TM    SWE,POVRD          IS THIS AN O'RIDING DD STMT      AABA 01716016
         BO    B1727              YES, BRANCH                      AABA 01717016
         OI    SWB,CXPC                 CONT EXP & CANCELLED            01720000
         B    B173                                                 AABA 01721016
B1727    DS    0H                                                  AABA 01722016
         OI    SWZ,CMT            TURN ON COMMENT SW               AABA 01723016
B173     DS    0H                                                  AABA 01726016
         MVI   2(R9),C'*'         MARK COMMENT CARD                AABA 01732016
         B     B154                                                AABA 01733016
B174     DS    0H                                                  AABA 01734016
         TM    SWZ,ENDS           TEST END SCAN SW                 AABA 01735016
         BO    B173               TRANSFER END SCAN SW ON          AABA 01736016
         TM    SWZ,CMT            IS COMMENT SW ON                 AABA 01736316
         BO    B173               YES, O'RIDING DD STMT            AABA 01736616
         LA    R4,3(0,R9)         COMPUTE REL LIST PTR             AABA 01737016
B176     DS    0H                                                  AABA 01738016
         CLI   0(R4),C' '         *SEARCH FOR 1ST NON-BLANK        AABA 01739016
         BNE   B178               *BRANCH IF NON-BLANK FOUND       AABA 01740016
         LA    R4,1(0,R4)         *INCREMENT POINTER               AABA 01741016
         B     B176               *RETURN TO SEARCH                AABA 01742016
B178     DS    0H                                                  AABA 01743016
         SR    R4,R9              *COMPUTE DISPLACEMENT            AABA 01744016
         STC   R4,LISTPTR(RA)     *STORE IN PARM LIST              AABA 01745016
         B     B16                                                 AABA 01746016
         SPACE                                                          01746119
B179     DS    0H                                                 O106  01746219
         MVC   DISPLZER(COMP2,R9),PLUS INDICATE IN-LINE PROC      O106  01746319
         B     B148                    CHECK FOR CONTINUATION     O206  01746419
         SPACE                                                          01746519
B180     DS    0H                                                 M4763 01746919
         TM    IWAPARM,INSTPROC        IN-STREAM PROC BEING PROCE M4763 01747319
         BO    B179                    YES, CHANGE TO ++          M4763 01747719
         MVI   0(R9),C'X'              MARK PROC STMT             M4763 01748119
         MVI   1(R9),C'X'              MARK PROC STMT             M4763 01748519
         B     B148                                               M4763 01748919
         SPACE                                                          01749319
B182     DS    0H                                                  AABA 01750016
         TM    SWE,PREF           PROC EOF                         AABA 01751016
         BO    B171               BRANCH YES                       AABA 01752016
         TM    SWA,EOFR           RDR EOF                          AABA 01753016
         BO    B171               BRANCH YES                       AABA 01754016
         B     B1725                                               AABA 01755016
IEFVGMV  DC    V(IEFVGM)                MSG ROUTINE                     01760000
IEFVHCBV DC    V(IEFVHCB)               VERB ID                         01780000
IEFVHEBV DC    V(IEFVHEB)               JOB CONTROL                     01800000
IEFVHAV  DC    V(IEFVHA)          GET STATEMENT                    AABA 01810016
INSTPROC EQU   X'80'                   IN-STREAM PROC BEING PROCESM4763 01811019
PLUS     DC    C'++'                   IN-LINE PROCEDURE          O106  01812019
SLASH    DC    C'//'               JCL STATEMENT                YM03493 01812302
COMMENT  DC    C'//*'              COMMENT CARD                 YM03493 01812602
DISPLONE EQU   1                       DISPLACEMENT               O106  01813019
MV3      EQU   3                                                   O106 01814019
COMP2    EQU   2                       LENGTH OF MOVE AND COMPARE O106  01815019
DISPLZER EQU   0                       DISPLACEMENT               O106  01816019
MSG15    EQU   21                                                       01820000
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 01830002
         END                                                            01840000
./  ADD  SSI=71730343,NAME=IEFVHCB
*********************************************************************** 00020002
*                                                                       00026002
*   MODULE NAME= IEFVHCB                                                00032002
*                                                                       00038002
*   DESCRIPTIVE NAME= VERB IDENTIFIER                                   00044002
*                                                                       00050002
*   COPYRIGHT= N/A                                                      00056002
*                                                                       00062002
*   STATUS= OS/VS2 RELEASE 3.0 AND 3.7 PTF                     @ZA14932 00068003
*                                                                       00074002
*   FUNCTION= 1. IDENTIFIES VERB OF STATEMENT                           00080002
*             2. PERFORMS MERGE OF STATEMENTS FROM JCL DATA SET AND     00086002
*                PROCEDURE LIBRARY                                      00092002
*             3. WRITES INTERNAL TEXT FOR THE PRIOR STATEMENT TO        00098002
*                THE TEXT DATA SET                                      00104002
*     OPERATION= 1. MODULE CHECKS FOR A STATEMENT NAME AND VERB ON THE  00110002
*                   CARD IMAGE, IDENTIFIES THE VERB AND BUILDS A        00116002
*                   STATEMENT PARAMETER LIST IN FIELD RSTMT FOR STATE-  00122002
*                   MENTS FROM THE JCL DATA SET, AND IN FIELD PSTMT FOR 00128002
*                   STATEMENTS FROM THE PROCEDURE LIBRARY               00134002
*                2. MODULE MERGES JCL DATA SET AND PROCEDURE LIBRARY    00140002
*                   STATEMENTS AS FOLLOWS: IT SAVES THE QUALIFIED NAME  00146002
*                   (PROCSTEPNAME.DDNAME) FOR A DD STATEMENT READ FROM  00152002
*                   THE JCL DATA SET. IT THEN CHECKS FOR A MATCH ON     00158002
*                   PROCSTEPNAME AGAINST THE NAME ON EACH EXEC STATE-   00164002
*                   MENT READ FROM THE PROCEDURE LIBRARY. WHEN SUCH A   00170002
*                   MATCH IS FOUND, IT THEN CHECKS FOR A MATCH ON       00176002
*                   DDNAME AGAINST EACH DD STATEMENT FOR THAT STEP.     00182002
*                   WHEN SUCH A MATCH IS FOUND, AN OVERRIDE SITUATION   00188002
*                   EXISTS, AND APPROPRIATE SWITCHES ARE SET.           00194002
*                  .ON AN OVERRIDE SITUATION, THE DD STATEMENT FROM THE 00200002
*                   JCL DATA SET IS PROCESSED FIRST, THEN THE DD FROM   00206002
*                   THE PROCEDURE LIBRARY. THE OVERRIDDEN STATEMENT IS  00212002
*                   MARKED BY CHANGING // TO X/.                        00218002
*                  .IF NO MATCH ON DDNAME IS FOUND PRIOR TO THE NEXT    00224002
*                   EXEC STATEMENT IN THE PROCEDURE, OR TO PROCEDURE    00230002
*                   END OF FILE, THE JCL DATA SET DD IS SIMPLY ADDED TO 00236002
*                   THE DD'S FOR THE STEP.                              00242002
*                3. THE MODULE PROVIDES CHECKPOINT/RESTART SUPPORT AS   00248002
*                   FOLLOWS: A STEP OR CHECKPOINT RESTART IS SIGNIFIED  00254002
*                   BY THE SPECIFICATION OF THE RESTART PARAMETER CON-  00260002
*                   TAINING A CHECKPOINT IDENTIFIER. IF SUCH A SPECI-   00266002
*                   FICATION HAS BEEN MADE, THE MODULE CHECKS FOR A     00272002
*                   DD STATEMENT WITH THE NAME 'SYSCHK' PRIOR TO THE    00278002
*                   FIRST EXEC STATEMENT FOR THE JOB. FINDING THE       00284002
*                   SYSCHK DD, THE MODULE SETS FLAG 'CPFLG' IN THE CWA  00290002
*                   TO INDICATE TO IEFVHEB THAT A PSEUDO EXEC STATEMENT 00296002
*                   MUST BE GENERATED AND PROCESSED PRIOR TO THE SYSCHK 00302002
*                   DD, BUT THE JOB HAS STEP BIT MUST NOT BE   @ZA09485 00308003
*                   TURNED ON FOR THIS PSEUDO EXEC STATEMENT.  @ZA09485 00310003
*                  .THE MODULE ALSO CHECKS IF A FLUSH TO STEPNAME HAS   00314002
*                   BEEN REQUESTED IN THE RESTART PARAMETER. IF SO,     00320002
*                   FLAG 'CPSTPFL' IN THE CWA IS SET ON. WHEN THE       00326002
*                   CORRECT STEP HAS BEEN FOUND BY THIS MODULE, THE     00332002
*                   FLAG IS CLEARED.                                    00338002
*                4. THE MODULE PROVIDES INSTREAM PROCEDURE SUPPORT      00344002
*                   AS FOLLOWS: IT CHECKS FOR A PROC STATEMENT FROM THE 00350002
*                   JCL DATA SET, WHICH SIGNIFIES THE BEGINNING OF AN   00356002
*                   INSTREAM PROCEDURE. FOR THE FIRST INSTREAM PROCE-   00362002
*                   DURE OF A JOB, THE MODULE WILL OBTAIN STORAGE FOR   00368002
*                   A 352 BYTE WORK AREA, AND FOR A QMPA FOR INSTREAM   00374002
*                   ROUTINE IEFVINA. (THIS STORAGE MUST BE OBTAINED BY  00380002
*                   IEFVHCB, RATHER THAN BY IEFVINA, TO PREVENT FRAG-   00386002
*                   MENTATION, INASMUCH AS IEFVINA MAY EXIT IN A WAY    00392002
*                   THAT MIGHT PREVENT IT FROM FREEING THE WORK AREAS.) 00398002
*                   THE MODULE THEN BRANCHES TO IEFVINA.                00404002
*                5. THE MODULE WRITES INTERNAL TEXT FOR THE PRIOR       00410002
*                   STATEMENT TO THE TEXT DATA SET, AND SAVES THE RBA   00416002
*                   FOR THE JOB AND LAST EXEC TEXT STRING WRITTEN. AT   00422002
*                   THE END OF A STEP, IF AN EXEC HAS BEEN WRITTEN,     00425002
*                   THE MODULE READS BACK THE EXEC STRING WITH THE      00428002
*                   SAVED RBA AS A GET ARGUEMENT, UPDATES THE           00431002
*                   PREFIX AND WRITES THE STRING BACK.  AT THE END      00434002
*                   OF JOB, THE JOB AND EXEC PREFIXES ARE UPDATED       00437002
*                   BY MEANS OF THE RBA TO PICK UP ANY BITS SET         00440002
*                   DURING PROCESSING. IT ALSO INDICATES (VIA A BIT     00443002
*                   IN THE EXEC PREFIX) THAT STEP HAS NO DD'S AND       00446002
*                   (VIA A BIT IN THE DD PRIFIX) THAT A DD IS THE       00449002
*                   LAST DD IN THE STEP.                                00452002
*                                                                       00458002
*   NOTES                                                               00464002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00470002
*      DEPENDENCIES= NONE                                               00476002
*      RESTRICTIONS= NONE                                               00482002
*      REGISTER CONVENTIONS=                                            00488002
*                            R9- CARD IMAGE POINTER                     00494002
*                            RA- STATEMENT PARAMETER LIST POINTER       00500002
*                            RB- BASE REGISTER                          00506002
*                            RC- CWA POINTER                            00512002
*                            RD- SAVE AREA POINTER                      00518002
*      PATCH-LABEL= PATCH                                               00524002
*                                                                       00530002
*   MODULE TYPE= BAL                                                    00536002
*      PROCESSOR= ASSEMBLER                                             00542002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00548002
*                                                                       00554002
*   ENTRY POINT= IEFVHCB                                                00560002
*      PURPOSE= VERB IDENTIFICATION                                     00566002
*      LINKAGE= BRANCH ON REGISTER                                      00572002
*      INPUT DATA= JCL STATEMENT                                        00578002
*                  CONVERTER WORK AREA                                  00584002
*                  R9- POINTS TO JCL STATEMENT                          00590002
*                  RA- POINTS TO STATEMENT PARAMETER LIST               00596002
*                  RC- POINTS TO CWA                                    00602002
*      REGISTERS SAVED= NONE                                            00608002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00614002
*      REGISTERS RESTORED= NONE                                         00620002
*                                                                       00626002
*   EXIT - NORMAL= BRANCH TO IEFVHEB                                    00632002
*      CONDITIONS= STATEMENT CONTAINS JOB, EXEC OR DD VERB              00638002
*      OUTPUT DATA= UPDATED FIELDS IN CWA                               00644002
*                   STATEMENT PARAMETER LIST                            00650002
*                   RA- POINTER TO STATEMENT PARAMETER LIST             00656002
*      RETURN CODES= NONE                                               00662002
*                                                                       00668002
*   EXIT - NORMAL= BRANCH TO IEFVHL                                     00674002
*      CONDITION= NULL STATEMENT FOUND                                  00680002
*      OUTPUT DATA= NONE                                                00686002
*      RETURN CODES= NONE                                               00692002
*                                                                       00698002
*   EXIT - NORMAL= BRANCH TO IEFVINA                                    00704002
*      CONDITIONS= JCL DATA SET STATEMENT CONTAINS A PROC VERB          00710002
*      OUTPUT DATA= OBTAINED STORAGE FOR WORK AREA                      00716002
*                   CWAWKBF- ADDRESS OF WORK AREA                       00722002
*                   OBTAINED STORAGE FOR INSTREAM QMPA                  00728002
*                   WKQMPAPT- ADDRESS OF INSTREAM QMPA                  00734002
*      RETURN CODES= NONE                                               00740002
*                                                                       00746002
*   EXIT - NORMAL= BRANCH TO IEFVHM                                     00752002
*      CONDITIONS= STATEMENT CONTAINS UNRECOGNIZABLE VERB               00758002
*      OUTPUT= NONE                                                     00764002
*      RETURN CODES= NONE                                               00770002
*                                                                       00776002
*   EXIT - NORMAL= BRANCH TO IEFVHA                                     00782002
*      CONDITIONS= PROCEDURE LIBRARY INPUT BUFFER IS TO BE PRIMED       00788002
*      OUTPUT= NONE                                                     00794002
*      RETURN CODES= NONE                                               00800002
*                                                                       00806002
*   EXIT - ERROR= BRANCH TO IEFVHA                                      00812002
*      CONDITIONS= STATEMENT CONTAINS NO VERB                           00818002
*      OUTPUT= ERROR MESSAGE WRITTEN TO MESSAGE DATA SET                00824002
*      RETURN CODES= NONE                                               00830002
*                                                                       00836002
*   EXTERNAL REFERENCES=                                                00842002
*      ROUTINES= BRANCH TO IEFVGM - WRITE ERROR MSG TO MSG DATA SET     00848002
*                BRANCH TO IEFVHEB TO LIST ILLEGAL OP STMTS             00850002
*      DATA AREAS= JCL DATA SET INPUT BUFFER                            00854002
*                  PROCEDURE LIBRARY INPUT BUFFER                       00860002
*                  CWA, INSTREAM PROC WORK AREA (WORKAREA)              00866002
*      CONTROL BLOCKS= QMPA, RPL                                        00872002
*      TABLES= NONE                                                     00878002
*      MACROS= IEFVMCWA, DCBD, IEFQMNGR, IEFVKEYS, IFGRPL, GETMAIN      00884002
*      ENQUEUE RESOURCES= NONE                                          00890002
*      CHANGE LEVEL= OZ01932,OZ05638,OZ06806,OZ09485,OZ14932   @ZA14932 00896003
*                                                                       00902002
*   MESSAGES= IEF601I INVALID STATEMENT IN PROCEDURE                    00908002
*             IEF605I UNIDENTIFIED OPERATION FIELD                      00914002
*             IEF611I OVERRIDDEN STEP NOT FOUND                         00920002
*             IEF617I NO NAME ON FIRST DD STATEMENT AFTER      @ZA14932 00922003
*                     EXEC STATEMENT                           @ZA14932 00924003
*             IEF658I PROC VERB STATEMENT OUT OF SEQUENCE               00926002
*             IEF659I MISPLACED SYSCHK DD STATEMENT                     00932002
*             IEF660I MISSING SYSCHK DD STATEMENT                       00938002
*                                                                       00944002
*********************************************************************** 00950002
         EJECT                                                          00956002
         IEFCOMWA                                                Y02668 01000002
         IEFCVRWA                                                Y02668 01000402
         EJECT                                                          01000819
         IEFQMNGR                                                       01001219
QMPADDR  DS    CL4                     ADDRESS OF WORK BUFFER           01001619
QMPATTR  DS    CL3                     TTR OF JOB QUEUE RECORD          01002019
QMPAZER  DS    CL1  N                  RESERVED FIELD                   01002419
         EJECT                                                          01002819
WORKAREA DSECT                                                          01003219
WKTTR    DS    CL4                     POINTER TO NEXT RECORD           01003619
WKQMPAPT DS    CL4                     ADDRESS OF QMPA                  01004019
WKRECORD DS    CL168                   COMPRESSED RECORD          O106  01004419
WKPTR1   DS    CL4                     POINTER TO ITSELF                01004819
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN        01005219
*                                      THIS SEGMENT OF THE DIRECTORY    01005619
WKPTR2   DS    CL3                     HOLDER OF TTR FROM QUEUE   O106  01006019
*                                      MANAGER                    O106  01006419
WKPROCN1 DS    CL8                     PROCEDURE NAME                   01006819
WKTTR1   DS    CL3                     TTR OF FIRST RECORD              01007219
WKPROCN2 DS    CL8                     PROCEDURE NAME                   01007619
WKTTR2   DS    CL3                     TTR OF FIRST RECORD              01008019
WKPROCN3 DS    CL8                     PROCEDURE NAME                   01008419
WKTTR3   DS    CL3                     TTR OF FIRST RECORD              01008819
WKPROCN4 DS    CL8                     PROCEDURE NAME                   01009219
WKTTR4   DS    CL3                     TTR OF FIRST RECORD              01009619
WKPROCN5 DS    CL8                     PROCEDURE NAME                   01010019
WKTTR5   DS    CL3                     TTR OF FIRST RECORD              01010419
WKPROCN6 DS    CL8                     PROCEDURE NAME                   01010819
WKTTR6   DS    CL3                     TTR OF FIRST RECORD              01011219
WKPROCN7 DS    CL8                     PROCEDURE NAME                   01011619
WKTTR7   DS    CL3                     TTR OF FIRST RECORD              01012019
WKPROCN8 DS    CL8                     PROCEDURE NAME                   01012419
WKTTR8   DS    CL3                     TTR OF FIRST RECORD              01012819
WKPROCN9 DS    CL8                     PROCEDURE NAME                   01013219
WKTTR9   DS    CL3                     TTR OF FIRST RECORD              01013619
WKPROCNA DS    CL8                     PROCEDURE NAME                   01014019
WKTTRA   DS    CL3                     TTR OF FIRST RECORD              01014419
WKPROCNB DS    CL8                     PROCEDURE NAME                   01014819
WKTTRB   DS    CL3                     TTR OF FIRST RECORD              01015219
WKPROCNC DS    CL8                     PROCEDURE NAME                   01015619
WKTTRC   DS    CL3                     TTR OF FIRST RECORD              01016019
WKPROCND DS    CL8                     PROCEDURE NAME                   01016419
WKTTRD   DS    CL3                     TTR OF FIRST RECORD              01016819
WKPROCNE DS    CL8                     PROCEDURE NAME                   01017219
WKTTRE   DS    CL3                     TTR OF FIRST RECORD              01017619
WKPROCNF DS    CL8                     PROCEDURE NAME                   01018019
WKTTRF   DS    CL3                     TTR OF FIRST RECORD              01018419
         EJECT                                                          01018819
         EJECT                                                     AACA 01045017
NEL      DSECT                                                     AACA 01050017
         IEFNEL SUBCOM=C                                                01055002
         EJECT                                                          01060000
         IEFVKEYS                                                A40034 01070001
         EJECT                                                          01070602
         IEFTXTFT                                                       01071202
         EJECT                                                   A40034 01072001
         IEFVMCWA                                                A40034 01074001
         EJECT                                                   A40034 01076001
         IFGRPL                                                  Y02668 01077002
         EJECT                                                          01078002
IEFVHCB  CSECT                                                          01080000
* A 036630,036660,039030-039120,0611700                        @ZA01932 01100003
* C 058960,058980                                              @ZA00841 01130003
* C 018530,018840                                              @ZA05638 01131003
* C LABEL B223C OUT OF MAINLINE FOR DDOVERRIDE FOLLOWED BY //  @ZA06806 01131503
* A LABEL B223CA WHERE LABEL B223C WAS BEFORE                  @ZA06806 01132003
* C PUT INTERNAL TEXT ROUTINE DONT SET JHS FOR PSEUDO EXEC     @ZA09485 01132303
* A AFTER LABEL B380 FOR NULL DDNAME AFTER EXEC PROC           @ZA14932 01132403
*                   R9 = PTR TO STMT                                    01132601
*                   RA = PTR TO STMT PARM LIST                          01136301
*                   RD=PTR TO CURRENT REG SAVE AREA                     01140000
         BALR  RB,0                                              Y02668 01176002
         USING *,RB                                                     01180000
*****************************************************************Y02668 01182002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01184002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01186002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01188002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01190002
         DC    C'VHCB'             MOD ID USED BY TRACE.         Y02668 01192002
* TRACE RETURNS HERE.                                            Y02668 01194002
*****************************************************************Y02668 01196002
         B     B1                      BRANCH AROUND CONSTANTS   A27782 01200019
         MODID BR=NO                                             Y01886 01250001
         DC    C'REL3'              FUNCTION ID AND              Y02668 01264303
*        DC    C'02' LEV # (CONCAT DS OVERRID W/SAME DDNAME)   @ZA01932 01265303
*        DC    C'03' LEV # (STEPCAT NOT INDICATED IN EXEC PFX) @ZA05638 01265803
*        DC    C'04' LEV # (DD OVERRIDE FOLLOWED BY //NULL)    @ZA06806 01266203
*        DC    C'05' LEV #(NO EXEC IN DEFERRED RESTART JOB)    @ZA09485 01266403
         DC    C'06' LEV #(JCL ERROR ON NULL DDNAME AFTER EXEC PROC)    01266503
*                                                              @ZA14932 01266603
CLEARVB  EQU   7                                                 Y02668 01267002
         DROP  RA                  RELEASE USING ON LWA         YM00387 01269002
B1       DS    0H                                                A27782 01271019
         TM    SWE,PREF                Q. PROC END OF FILE ?     A27782 01272019
         BNO   B2                      NO                        A27782 01273019
         OI    SWE,SEQUENCE            YES, SET SWITCH FOR USE   A27782 01274019
*                                      LATER - TEST FOR ADDITION A27782 01275019
*                                      OUT OF SEQUENCE           A27782 01276019
B2       DS    0H                                                       01280000
*                                       SET UP FOR SCAN                 01300000
         LA    R1,1(0,R9)               START OF SCAN-1   COL2          01320000
         LA    R7,1(0,R1)               SAVE TO CALC NAME LENGTH        01380000
*                                       SET UP TO SCAN FOR A BLANK      01400000
         LA    R8,B282             LOAD ERROR EXIT ADDR.           AACA 01410017
         LA    R4,B279               **EXIT IF NOT FOUND                01420014
         LA    R5,B22                     EXIT IF FOUND                 01440000
         LA    R6,X'70'                   COND CODE                     01460000
B20      DS    0H                                                  AACA 01465017
         LA    R2,1                     INCREMENT                  AACA 01470017
         LA    R3,70(0,R9)              COL 71 LAST SCAN POSITON   AACA 01475017
B21      DS    0H                       SCAN ROUTINE                    01480000
         BXH   R1,R2,0(R4)                EXIT IF CHAR NOT FOUND        01500000
         CLI   0(R1),C' '                 TEST CHAR                     01520000
         EX    R6,B212                  LOOP IF CHAR NOT FOUND          01540000
         BR    R5                       EXIT IF CHAR FOUND              01560000
B212     BC    0,B21                    EXECUTED BR                     01580000
B22      DS    0H                                                       01600000
         LR    0,R1                                                     01620000
         SR    0,R7                     CALC NAME LENGTH                01640000
         STC   0,NAMEL(0,RA)            SAVE LENGTH IN PARM LIST        01660000
*                                       SET TO SCAN FOR NON-BLANK       01680000
         BNE   B222                     BR IF NAME IS PRESENT           01700000
         LA    R4,B223                    EXIT IF A NULL                01720000
B222     DS    0H                                                       01740000
         LA    R5,B23                     EXIT IF VERB FOUND            01760000
         LA    R6,X'80'                   COND CODE                     01780000
         B     B21                        GO TO SCAN                    01800000
B223     DS    0H                                                       01820000
         NI    VERB(RA),255-7           SET VERB ID = 0                 01840000
         TM    SWE,PROC            PROCESSING A PROC ?          YM08107 01841002
         BZ    B2235               NO - GO TO WRITE TEXT        YM08107 01842002
         TM    SWE,PRCV            PROC BUFFER CONTAIN A CARD ? YM08107 01843002
         BO    B224                NO - GO TO EOF RTN           YM08107 01844002
         LA    RA,PSTMT            YES - POINT TO PROC PARMS    YM08107 01845002
B2235    DS    0H                                               YM08107 01846002
         BAL   R7,AOIORTN          WRITE TEXT FOR PRIOR STMT.    Y02668 01850002
         TM    SWE,PROC            PROC BEING PROCESSED ?       YM02703 01851002
         BO    B223C               YES GO TO UPDATE EXEC PREFIX@ZA05638 01853003
         TM    SWB,CXPN            CONT EXP & NOT RECV?         YM00387 01855002
         BZ    B223A               NO GO TO UPDATE PREFIXES     YM00387 01856002
         L     R7,TLENP            YES GET PTR TO NEXT TXT BYTE YM00387 01857002
         MVI   0(R7),ENDK          PUT END KEY IN TEXT          YM00387 01858002
         LA    R7,1(R7)            INCREMENT FOR END KEY        YM00387 01859002
         L     R1,TEXTBUFP         GET TEXT POINTER             YM00387 01860002
         SR    R7,R1               CALCULATE TEXT LENGTH        YM00387 01861002
         USING TEXT,R1             GET ADDRESSABILITY TO PREFIX YM00387 01862002
         STH   R7,STRLTH           PUT TEXT LENGTH IN PREFIX    YM00387 01863002
         DROP  R1                                               YM00387 01864002
         OI    AOSW1,AOTXTWRT      SET TEXT WRTIE SW.           YM00387 01865002
         BAL   R7,AOIORTN          GO TO WRITE TEXT             YM00387 01866002
B223A    DS    0H                                               YM00387 01867002
         TM    SWA,JHS             DOES JOB HAVE A STEP?        YM00387 01868002
         BO    B223B               YES GO TO UPDATE PREFIXES    YM00387 01869002
         L     R2,CTRLWAP          GET LWA ADDR                 YM00387 01870002
         USING CWA,R2              SET ADDRESSABILITY           YM00387 01871002
         XC    MSGKEY,MSGKEY       TELL VGM NO SECONDARY MSG    YM00387 01872002
         DROP  R2                                               YM00387 01873002
         LA    R2,MSG7             NO GET JOB HAS NO STEP KEY   YM00387 01874002
         L     RF,IEFVGMV          GET MSG RTNE ADDR            YM00387 01875002
         BALR  RE,RF               GO TO WRITE MSG              YM00387 01876002
         LA    R7,WAJOBPFX         GET JOB PFX ADDR             YM00387 01877002
         USING TEXT,R7             GET TEXT ADDRESSABILITY      YM00387 01878002
         OI    STRJINDC,JTXJOBFL   SET JOB FAIL IN PFX          YM00387 01879002
         DROP  R7                                               YM00387 01880002
B223B    DS    0H                                               YM00387 01881002
         LA    R0,WAJOBRBA         GET JOB TEXT TTR             YM00387 01882002
         BAL   R7,AOIOPFXP         GO TO UPDATE JOB PREFIX      YM00387 01883002
B223CA   TM    SWA,JHS             DOES A STEP EXIST? NEW LABEL@ZA06806 01884003
         BZ    B224                NO GO TO NULL EXIT           YM00387 01885002
         LA    R0,WAEXCRBA         GET EXEC TEXT TTR            YM00387 01886002
         BAL   R7,AOIOPFXP         GO TO UPDATE EXEC PFX        YM00387 01887002
B224     DS    0H                                               YM00387 01888002
         L     RF,IEFVHLV                                       YM00387 01889002
         BR    RF                  EXIT TO NULL RTNE            YM00387 01890002
B223C    TM    SWZ,DDOV           IS DD OVERRIDE IN PROGRESS   @ZA06806 01892003
         BO    B224               YES, DONOT UPDATE EXEC PRFX  @ZA06806 01894003
         B     B223CA             NO. GO UPDATE EXEC PRFX NOW  @ZA06806 01896003
B23      DS    0H                                                       01900000
         CLC   JOB,0(R1)                JOB STMT                        01960000
         BE    B2375                    BR YES                          01980000
         CLC   PEND,0(R1)              IS THIS A PEND VERB         4387 01986019
         BE    B2355                   PEND VERB OUT OF SEQ        4387 01992019
         CLC   DD,0(R1)                 DD STMT                         02000000
         BNE   B2377                    BR NO                           02020000
         TM    SWH,CPSTPFL         Q. CKPT/REST STEP FLUSH ON      AACA 02021017
         BO    B2308                BR - YES                       AACA 02022017
         TM    SWH,CPFLGXX         Q. RESTART FLAG ON              AACA 02025017
         BZ    B2308                BR - NO                        AACA 02026017
         CLC   2(7,R9),SYSCHK      Q. 'SYSCHK' DD NAME             AACA 02027017
         BNE   B2308                BR - NOT SYSCHK DD NAME        AACA 02028017
         NI    SWH,255-CPFLGXX     CLEAR RESTART FLAG              AACA 02029017
*** RESTART RELEASE.                                             Y02668 02029202
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 02029702
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 02030202
         OI    STRJINDC,JTXSYSCK   SET SYSCHK DD RECVD BIT.      Y02668 02030702
         CLI   CWACHIDL,0          CHECKID LENGTH = 0?           Y02668 02031202
         BE    B2304                BR - YES  IF DD NAME IS        AACA 02032017
*                                   SYSCHK, AN EXEC STMT MUST      AACA 02033017
*                                   HAVE BEEN RCVD.                AACA 02034017
         TM    SWD,FEXRCV          Q. 1ST EXEC STMT RCVD           AACA 02035017
         BO    B2306                BR - YES                       AACA 02036017
         OI    CRSW1,CPFLG         SET CKPT/REST FLAG              AACA 02037017
         TM    CRSW1,CRRES1        RESTART FIRST STEP?           Y02668 02038002
         BE    B2308                BR - YES                       AACA 02039017
         TM    STRJINDC,JTXJOBFL   JOB ALREADY FAILED?           Y02668 02039202
         BO    B2308                BR - YES                       AACA 02041017
         OI    SWH,CPSTPFL         SET WORK AREA STEP FLUSH BIT. Y02668 02042002
         OI    STRJINDC,JTXCPSTF   SET C/R STEP FLUSH FLAG. THIS Y02668 02042602
*                                  FLAG SIGNIFIES TO EXEC STMT     AACA 02043017
*                                  PROCESSOR (IEFVEA) TO CHECK FOR AACA 02044017
*                                  THE CORRECT RESTART STEP. WHEN  AACA 02045017
*                                  FOUND, THIS FLAG IS CLEARED.    AACA 02046017
         B     B2308               CONTINUE SCAN OF DD STMT        AACA 02047017
B2304    DS    0H                                                  AACA 02048017
         TM    SWD,FEXRCV          Q. 1ST EXEC STMT RCVD           AACA 02048717
         BO    B2308                BR - YES                       AACA 02049417
         TM    STRJINDC,JTXJOBFL   JOB ALREADY FAILED?           Y02668 02051002
         BO    B2308                BR - YES                       AACA 02052017
B2306    DS    0H                                                  AACA 02053017
         MVI   VERB(RA),CRE+4      SET C/R ERR FLG & DD VERB       AACA 02054017
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 02055002
         DROP  R8                                                Y02668 02055502
         B     B231                                                AACA 02056017
B2308    DS    0H                                                  AACA 02057017
         MVI   VERB(RA),4          DD VERB ID                      AACA 02058017
B231     DS    0H                                                  AACA 02059017
         LA    R1,2(R1)            UPDATE SCAN PTR                 AACA 02060017
B232     DS    0H                                                       02080000
B233     DS    0H                       FIND STMT OPERAND LIST          02140000
         LA    R4,B234                    EXIT IF NO LIST               02160000
         LA    R6,X'80'                   COND CODE TO FIND A NON-BLANK 02180000
         BAL   R5,B20                   SET EXIT & GO TO SCAN      AACA 02200017
B234     DS    0H                                                       02220000
         SR    R1,R9                    CALC REL LIST PTR               02240000
         STC   R1,LISTPTR(0,RA)    SAVE REL PTR IN PARM LIST     Y02668 02250002
AOB01    DS    0H                                                Y02668 02260202
         TM    VERB(RA),1          IS THIS A JOB CARD?           Y02668 02260402
         BZ    AOB10               BRANCH IF NOT.                Y02668 02260602
         OI    SWA,JTOP            INDICATE JOB CARD FOUND.      Y02668 02260802
AOB10    DS    0H                                                Y02668 02263902
         TM    VERB(RA),8              Q. PROC VERB               M4268 02264019
         BZ    B234A                   IF NO, CHECK IF PROCEDURE  M4268 02268019
*                                      BEING PROCESSED            M4268 02272019
         TM    SWE,GPI                 IS PROC STMT FROM PROCLIB  M4268 02276019
         BO    B3                      IF YES,CHECK IT'S POSITION M4268 02280019
*                                      IN THE PROCEDURE           M4268 02284019
         TM    IWAPARM,INSTPR          IS AN INSTREAM PROCEDURE   M4268 02288019
*                                      BEING EXPANDED             M4268 02292019
         BZ    B281A                   IF NO, GO TO INSTREAM      M4268 02296019
*                                      PROCEDURE COMPRESS ROUTINE M4268 02300019
         TM    SWE,PRCV                ANY STMT IN PROC BUFFER   A41878 02302001
         BZ    B451                    YES - PROCESS IT BEFORE   A43603 02302401
*                                      READING FROM INPUT STREAM A43603 02302801
         B     B380                    EXIT TO GET ROUTINE        M4268 02304019
B234A    DS    0H                                                 M4268 02308019
         TM    SWE,PROC                Q.PROCEDURE BEING PROCESSEDM4268 02312019
         BO    B3                      IF YES,CHECK VERB POSITIONSM4268 02316019
         TM    SWE,PREF                 PROC EOF                        02320000
         BO    B24                      BR YES                          02340000
B235     DS    0H                                                       02360000
         BAL   R7,AOIORTN          WRITE TEXT FOR PRIOR STMT     Y02668 02361002
         CLI   VERB(RA),2          HAS AN EXEC BEEN READ?        Y02668 02362002
         BNE   B235A               NO CONTINUE PROCESSING        Y02668 02363002
         LA    R7,WAEXCPFX         GET BASE FOR EXEC PFX SVAREA  Y02668 02364002
         USING TEXT,R7             SET ADDRESSABILITY                   02365002
         TM    STRINDCS,EXECSTR    HAS AN EXEC PREFIX BEEN SAVED Y02668 02366002
         BZ    B235A               NO CONTINUE PROCESSING        Y02668 02367002
         DROP  R7                                                Y02668 02368002
         LA    R0,WAEXCRBA         GET EXEC TEXT TTR             Y02668 02369002
         BAL   R7,AOIOPFXP         GO TO UPDATE EXEC PREFIX      Y02668 02370002
B235A    DS    0H                                                Y02668 02371002
         L     RF,IEFVHEB          EXIT TO                       Y02668 02380002
         BR    RF                  PRE-SCAN ROUTINE.             Y02668 02390002
B2355    DS    0H                                                  4387 02404019
         LA    R2,PENDERR          ERR MSG - PEND OUT OF SEQ     Y02668 02408002
         L     RE,IEFVHAV          SET EXIT ADDR TO GO BACK&READ Y02668 02412002
         B     B28                     CREATE SMB FOR ERROR MSG    4387 02416019
B2375    DS    0H                       JOB STMT                        02640000
         LA    R1,3(0,R1)               SET SCAN PTR                    02680000
         MVI   VERB(RA),1               VERB ID IN PARM LIST  (JOB)     02700000
         B     B233                                                     02720000
B2376    CLC   2(0,R9),PPSN             COMPARE JOBNAME WITH START NAME 02740000
B2377    DS    0H                                                       02760000
         CLC   EXEC,0(R1)               EXEC STMT                       02780000
         BE    B2380                 ** BR-YES                          02785014
         CLC   PROCA,0(R1)           **Q. PROC STMT                     02790014
         BNE   B284                  ** BR-NO GO SCAN FOR COMMAND       02795014
         LA    R1,4(R1)              **UPDATE THE SCAN PTR              02800014
         MVI   VERB(RA),8            **VERB ID TO PARM LIST             02805014
         B     B232                                                AACA 02805517
B2380    TM    SWH,CPSTPFL         Q. C/R STEP FLUSH FLAG ON       AACA 02806017
         BO    B2386                BR - YES                       AACA 02806517
         TM    SWH,CPFLGXX         Q. RESTART FLAG ON              AACA 02807517
         BZ    B2386                BR - NO                        AACA 02808017
         NI    SWH,255-CPFLGXX     CLEAR RESTART FLAG              AACA 02808517
         CLI   CWACHIDL,0          CHECKID LENGTH = 0?           Y02668 02809002
         BE    B2384                BR - YES                       AACA 02809517
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 02810102
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 02810202
         TM    STRJINDC,JTXSYSCK   SYSCHK DD RECEIVED?           Y02668 02810302
         BO    B2386                BR - YES                       AACA 02810517
         OI    STRJINDC,JTXSYSCK   SET SYSCHK DD RECVD FLAG.     Y02668 02811002
         LA    R3,MSG60            LOAD ERROR MESSAGE INDEX        AACA 02811517
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 02812002
         BAL   R8,B281             OUTPUT MESSAGE                  AACA 02812517
         B     B2386                                               AACA 02813017
B2384    DS    0H                                                  AACA 02813517
         TM    CRSW1,CRRES1        RESTART FIRST STEP?           Y02668 02814002
         BE    B2386                BR - YES                       AACA 02814517
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 02815002
         TM    STRJINDC,JTXJOBFL   JOB FAILED?                   Y02668 02815502
         BO    B2386                BR - YES                       AACA 02816017
         OI    SWH,CPSTPFL         WORK AREA C/R STEP FLUSH FLAG.Y02668 02816502
         OI    STRJINDC,JTXCPSTF   SET C/R STEP FLUSH FLAG. THIS Y02668 02816802
*                                  FLAG SIGNIFIES TO EXEC STMT     AACA 02817017
*                                  PROCESSOR (IEFVEA) TO CHECK FOR AACA 02817517
*                                  THE CORRECT RESTART STEP. WHEN  AACA 02818017
*                                  FOUND, THIS FLAG IS CLEARED.    AACA 02818517
B2386    DS    0H                                                  AACA 02819017
         LA    R1,4(R1)                 SET SCAN PTR                    02820000
         MVI   VERB(RA),2               VERB ID IN PARM LIST  (EXEC)    02840000
         B     B232                                                     02860000
B24      DS    0H                       IF PROC EOF ON AND              02880000
         TM    VERB(RA),4            **Q. THIS A RDR DD STMT            02900014
         BZ    B235                   **(BRANCH NO) THEN TEST THE PROC  02920014
*                                       MERGE CONTROL FOR DD SEQUENCE   02940000
         BAL   R8,B6                      BREAKOUT QUAL NAMES TO REG    02960000
         CLI   20(RD),C' '                SAVE AREA - STEPNAME PRESENT  02980000
         BE    B235                       BR NO                         03000000
         CLC   PSNM(8),20(RD)             STEPNAME = PROC STEPNAME      03020000
         BE    B235                       BR YES                        03040000
         OI    VERB(RA),SSE               SET DD STMT SEQ ERR           03060000
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 03080002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 03110002
         B     B235                                                     03140000
B279     DS    0H                    **                                 03146014
         L     R2,CTRLWAP          GET LOCAL WORK AREA PTR       Y02668 03147002
         USING CWA,R2              SET BASE                      Y02668 03148002
         XC    MSGKEY,MSGKEY       ZERO SECONDARY MSG. KEY       Y02668 03149002
         DROP  R2                                                Y02668 03150002
         LA    R2,MSG5             UNIDENTIFIED OPERATION FIELD  Y02668 03152002
         L     RE,IEFVHAV          SET EXIT ADDR                 Y02668 03156002
B28      DS    0H                                                       03160000
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 03180002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 03190002
         DROP  R8                                                Y02668 03200002
         OI    AOSW1,AOPRTSW       TELL VHEB TO PRINT STMT       Y02668 03220002
         OI    AOSW1,AOILGLOP      TELL VHEB IT'S A MSG          Y02668 03230002
         L     RF,IEFVHEB          GO TO PRINT                   Y02668 03240002
         BR    RF                  THE STMT                      Y02668 03250002
B281     DS    0H                                                       03320000
         LR    R2,R3                 **SET UP MESS. INDEX               03340014
         L     RF,IEFVGMV          LOAD MSG RTN ADDR               AACA 03350017
         BALR  RE,RF                    MSG TO SMB                      03360000
         SPACE 1                                                 A40034 03362001
*********************************************************************** 03362401
* UPON RETURN FROM IEFVGM THE SECONDARY MSG FIELD(MSGKEY) MUST BE     * 03362801
* CLEARED TO PREVENT ANY FURTHER USAGE OF SECONDARY MSG.S. IN THE     * 03363201
* CONTROL RTN.S.                                                      * 03363601
*********************************************************************** 03363701
         SPACE 1                                                 A40034 03363801
         L     R2,CTRLWAP          ESTABLISH CWA ADDRESSABILITY  A40034 03366001
         USING CWA,R2                                            A40034 03368001
         XC    MSGKEY,MSGKEY       INITIALIZE SECONDARY MSG KEY  A40034 03368401
         DROP  R2                  RELEASE  ADDRESS. TO CWA      A40034 03368801
         SPACE 1                                                 A40034 03369201
         BR    R8                  RETURN                          AACA 03370017
         SPACE                                                          03370319
B281A    DS    0H                                                 O106  03370619
*********************************************************************** 03370919
*                                                                     * 03371219
*  AN IN-LINE PROCEDURE WAS BEEN ENCOUNTERED.  GET CORE FOR A     O106* 03371519
*  WORK AREA AND A QMPA IF THEY ARE NEEDED.  XCTL TO IEFVINA      O106* 03371819
*                                                                     * 03372119
*********************************************************************** 03372419
         L     R3,IWAWKBF              ADDRESS OF WORK AREA       O106  03372719
         LTR   R3,R3                   SEE IF CORE WAS GOTTEN     O106  03373019
         BNZ   B281AA                  EXIT FOR IEFVINA           O106  03373319
         SPACE                                                          03373619
         LA    R0,WORKLN               LENGTH OF WORK AREA        O106  03373919
         GETMAIN R,LV=(0)                                               03374219
         XC    DISPL0(MAXLIN,R1),DISPL0(R1) CLEAR THE WORK AREA   O106  03374519
         LR    R7,R1                   SAVE ADDRESS OF WORKAREA   O106  03374819
         USING WORKAREA,R7                                        O106  03375119
         ST    R1,IWAWKBF              ADDRESS OF WORK AREA             03375219
         LA    R1,QPARM            GET QMPA ADDRESS              Y02668 03376002
         ST    R1,WKQMPAPT             ADDRESS OF QMPA                  03376319
         SPACE                                                          03376919
B281AA   DS    0H                                                 O106  03377219
         L     RF,IEFVINAV         INSTREAM PROC RTNE ADDR.      Y02668 03377502
         BR    RF                  BRANCH.                       Y02668 03377602
         SPACE                                                          03377819
B282     DS    0H                                                       03380000
         L     RF,IEFVHAV                                               03400000
         BR    RF             EXIT TO GET STMT                          03420000
B284     DS    0H                                                       03440000
         LR    R5,R1                    PTR TO VERB                     03460000
         L     RF,IEFVHMV                                               03480000
         BR    RF             EXIT TO SCAN COMMAND                      03500000
B3       DS    0H        PROCEDURE STMT MERGE ROUTINE                   03520000
         TM    VERB(RA),8            **Q. PROC VERB                     03526014
         BO    B32                   ** BRANCH - YES                    03531014
         NI    SWD,255-SYMPRC        **CLEAR 1ST ACCESS FLAG            03535014
         TM    VERB(RA),4               DD STMT                         03540000
         BZ    B35                      BR NO                           03560000
         TM    SWE,GPI                  PROC STMT                       03580000
         BO    B35                      BR YES                          03600000
         CLI   NAMEL(RA),0              NAME PRESENT                    03620000
         BNE   B35                      BR YES                          03640000
         OI    SWE,CONCAT               CONCATINATION ON                03660000
B31      DS    0H                                              @ZA01932 03663003
         MVC   RDNM(8),BLANKS       BLANK READER DDNAME        @ZA01932 03666003
         B     B38                                                      03670014
B32      DS    0H                    **                                 03681014
         TM    SWD,SYMPRC            **Q. 1ST ACCESS OF THIS PROC       03682014
         BZ    B325                  ** BR-NO                           03683014
         NI    SWD,255-SYMPRC        **CLEAR 1ST ACCESS OF PROC         03684014
         B     B235                GO TO PRE SCAN EXIT          YM00382 03686002
B325     DS    0H                    **                                 03688014
         NI    SWD,255-SYMPRC        **CLEAR 1ST ACCESS OF PROC         03688514
         LA    R2,MSG13            PROC VERB OUT OF SEQUENCE     Y02668 03689002
         L     RE,IEFVHAV          SET UP EXIT ADDR              Y02668 03689502
         B     B28                   **                                 03690014
B35      DS    0H                                                       03700000
         BAL   R8,B6                    BREAKOUT STMT NAMES             03720000
         TM    SWE,GPI                  PROC STMT                       03740000
         BZ    B351                     BR NO                           03760000
         TM    VERB(RA),1               JOB                             03780000
         BO    B57                      BR YES                          03800000
         TM    VERB(RA),2               EXEC                            03820000
         BO    B40                      BR YES                          03840000
B351     DS    0H                                                       03860000
         CLI   NAMEL(RA),0              NAME BLANK                      03880000
         BNE   B36                  NO, BRANCH                 @ZA01932 03890003
         TM    SWE,GPI              PROC STMT                  @ZA01932 03900003
         BZ    B31                  NO, BRANCH                 @ZA01932 03904003
         MVC   PDNM(8),BLANKS       BLANK PROC DDNAME          @ZA01932 03908003
         B     B38                  THEN BRANCH                @ZA01932 03912003
B36      DS    0H                                                       03916003
         TM    SWE,GPI                  PROC STMT                       03920000
         BZ    B37                      BR NO                           03940000
         MVC   PDNM(8),28(RD)           PROC DDNAME                     03960000
         B     B38                                                      03980000
B37      DS    0H                                                       04000000
         CLI   20(RD),C' '              STEPNAME BLANK                  04020000
         BE    B372                     BR YES                          04040000
         MVC   RSNM(8),20(RD)           RDR STEPNAME                    04060000
B372     DS    0H                                                       04080000
         MVC   RDNM(8),28(RD)           RDR DD NAME                     04100000
B38      DS    0H                                                       04120000
         TM    SWE,PRCV                 PRIME PROC BUFFER               04140000
         BZ    B45                      BR NO                           04160000
B380     DS    0H                                                 M4268 04170019
         NI    SWE,255-PRCV             PRCV OFF                        04180000
         OI    SWE,GPI               **SET GET PROC INPUT AND           04190014
         OI    SWD,SYMPRC            ** 1ST ACCESS FLAGS                04200014
         TM    VERB(RA),4         IS THIS A DD STATEMENT?      @ZA14932 04201003
         BZ    B381               NO, BRANCH                   @ZA14932 04202003
         CLI   NAMEL(RA),0        IS DDNAME LENGTH ZERO?       @ZA14932 04203003
         BNE   B381               NO, BRANCH                   @ZA14932 04204003
*                                                                       04205003
* CONDITION DETECTED OF DD STATEMENT WITH NO NAME FOLLOWING    @ZA14932 04206003
* EXEC PROC STATEMENT. FAIL WITH MSG IEF617I.                  @ZA14932 04207003
* NO NAME ON DD STATEMENT AFTER EXEC PGM= STATEMENT IS         @ZA14932 04208003
* DETECTED IN INTERPRETER MODULE IEFVDA                        @ZA14932 04209003
         LA    R2,MSG17           CODE FOR MSG IEF617I         @ZA14932 04210003
         L     RE,IEFVHAV         SET EXIT ADDR                @ZA14932 04211003
         B     B28                GO PUT OUT MSG FIRST         @ZA14932 04212003
B381     DS    0H                                              @ZA14932 04216003
         L     RF,IEFVHAV                                               04220000
         BR    RF             EXIT TO GET STMT                          04240000
B40      DS    0H                       PROCEDURE EXEC STMT             04260000
         OI    SWE,SEQUENCE            TURN SWITCH ON EACH TIME  A27782 04266019
*                                     PROC 'EXEC' IS ENCOUNTERED A27782 04272019
         MVC   PPSN(8),PSNM             SAVE PREVIOUS STEPNAME          04280000
         MVC   PSNM(8),28(RD)           CURRENT STEPNAME                04300000
         MVI   PDNM,C' '                INITIALIZE PROC DD NAME         04320000
         MVI   PDNM+1,C'@'              SPECIAL CHARACTER               04340000
         CLI   RSNM,0                   RDR STEPNAME=0                  04360000
         BNE   B38                      BR NO                           04380000
         MVC   RSNM(8),PSNM             SET STEPNAMES EQUAL             04400000
         NI    SWE,255-CONCAT           CONCATINATION OFF               04420000
         B     B38                                                      04440000
B45      DS    0H                                                       04460000
         TM    SWE,POVRD                OVERRIDDEN STMT                 04480000
         BZ    B48                      BR NO                           04500000
B451     DS    0H                                                A43603 04510001
         NI    SWE,255-POVRD            OVERRIDE OFF                    04520000
B46      DS    0H                                                       04540000
         LA    RA,PSTMT                 PROC PARM LIST                  04560000
         L     R9,PSTMT                 PROC STMT                       04580000
         OI    SWE,GPI                  GET PROC STMT ON                04600000
         B     B235                                                     04620000
B48      DS    0H                                                       04640000
         CLC   PSNM(8),RSNM             STEPNAMES EQUAL                 04660000
         BNE   B55                      BR NO                           04680000
         NI    SWE,NOT-SEQUENCE        TURN SWITCH OFF EACH TIME A27782 04686019
*                                      DDNAMES ARE EQUAL         A27782 04692019
         CLC   PDNM(8),RDNM             DDNAMES EQUAL                   04700000
         BNE   B52                      BR NO                           04720000
         TM    RSTMT+VERB,4             RDR HAVE A DD                   04740000
         BZ    B46                      BR NO                           04760000
         OI    SWE,POVRD                OVERRIDE ON                     04780000
         L     R9,PSTMT      POINT R9 TO STATEMENT...           YA59657 04783002
B505     MVI   1(R9),C'/'         MARK OVERRIDDEN STMT            20817 04832018
B51      DS    0H                                                 20817 04836018
         NI    SWE,255-CONCAT-GPI       CONCATINATION OFF & GPI OFF     04840000
         LA    RA,RSTMT                 RDR PARM LIST                   04860000
         L     R9,RSTMT                 RDR STMT                        04880000
         B     B235                     GO TO JOB CONTROL               04900000
B52      DS    0H                                                       04920000
         TM    SWE,CONCAT               CONCATINATION IN RDR            04940000
         BZ    B46                      BR NO                           04960000
         B     B51                     BR IF YES                 A29458 04980019
B55      DS    0H                                                       05000000
         NI    SWE,255-CONCAT           CONCAT OFF                      05020000
         TM    RSTMT+VERB,4             RDR A DD                        05040000
         BZ    B46                      BR NO                           05060000
         CLC   RSNM(8),PPSN             STEP EQL PREV PROC STEP         05080000
         BNE   B46                      BR NO                           05100000
         TM    SWE,SEQUENCE            TEST FOR ADDITION OUT OF  A27782 05103019
*                                      SEQUENCE                  A27782 05106019
         BO    B51                     --NO--VALID ADDITION TO  YA59657 05109002
*                                      PREVIOUS PROC STEP--      A27782 05112019
*                                      ---PROCESS READER---      A27782 05115019
         B     B46                     --YES-ADDITION MAY BE OUT A27782 05118019
*                                     OF SEQUENCE OR THE STEP TO A27782 05121019
*                                      BE OVERRIDDEN IS NOT IN   A27782 05124019
*                                      THIS PROCEDURE--PROCESS   A27782 05127019
*                                      THE PROC. STATEMENT       A27782 05130019
B57      DS    0H                                                       05140000
         NI    VERB(RA),255-CLEARVB SET VERB ID = 0              Y02668 05150002
         LA    R2,MSG1             JOB STMT IN PROCEDURE         Y02668 05200002
         L     RE,IEFVHLV          SET EXIT ADDR                 Y02668 05250002
         B     B28                                               Y02668 05300002
B6       DS    0H                  BREAKOUT QUAL NAMES                  05380000
*                                  QUALIFIER TO 20(RD)                  05400000
*                                  UNQUAL NAME TO 28(RD)                05420000
         MVI   20(RD),C' '              BLANKS TO WORK AREA             05440000
         MVC   21(15,RD),20(RD)                                         05460000
         CLI   NAMEL(RA),0              NAME BLANK                      05480000
         BCR   8,R8                     RETURN YES                      05500000
         MVI   28(RD),0                 DDNAME ON ERR RETURN            05520000
B61      DS    0H                                                       05540000
         LA    R1,2(0,R9)               NAME                            05560000
         LA    R2,1                     INCREMENT                       05580000
B611     DS    0H                                                       05600000
         LA    R3,8(0,R1)               END OF SCAN                     05620000
         SR    R4,R4                    LENGTH COUNTER                  05640000
         LR    R5,R1                    1ST CHAR OF NAME                05660000
B612     DS    0H                                                       05680000
         BXH   R1,R2,B622               LONG NAME ERROR MSG RTN  A40034 05700001
         CLI   0(R1),C' '               BLANK FOUND                     05720000
         BE    B62                      BR YES                          05740000
         CLI   0(R1),C'.'               . FOUND                         05760000
         BE    B63                      BR YES                          05780000
         AR    R4,R2                    COUNTER                         05800000
         B     B612                                                     05820000
B62      DS    0H                       MOVE DDNAME                     05840000
         EX    R4,B625                                                  05860000
         BR    R8                  EXIT                                 05880000
         SPACE 5                                                        05880401
*********************************************************************** 05882001
*  THE FOLLOWING IS AN ERROR MSG SETUP RTN THAT ESTABLISHES CWA       * 05884001
* ADDRESSABILITY, AND SETS THE SECONDARY MSG FIELD FOR IEFVGM.        * 05886001
*  - THE EXIT FROM THIS RTN IS TO A GENERALIZED MSG INTERFACE RTN, AND* 05888001
* UPON RETURN FROM THE MSG RTN THE EXIT IS MADE TO IEFVHA TO READ A   * 05888801
* NEW CARD IMAGE.                                                     * 05889201
*********************************************************************** 05889601
         SPACE 1                                                 A40034 05890001
B622     L     R6,CTRLWAP               ESTABLISH ADDRESS TO CWA A40034 05892001
         USING CWA,R6                                            A40034 05894001
         TM    VERB(RA),DDVERB          WAS THIS A DD STMT. ?    A40034 05894401
         BO    B623DD                   INDICATE DD VERB         A40034 05894801
         MVI   MSGKEY,EXECK             EXEC STMT KEY TO CWA     A40034 05895201
         B     B6MSG                    GO SET PRIMARY MSG UP    A40034 05895301
B623DD   MVI   MSGKEY,DDK               DD STMT KEY TO CWA       A40034 05895601
B6MSG    LA    R2,MSG42                 MSG IEF642I FOR ERROR  @ZA00841 05896003
         L     RE,IEFVHAV             EXIT TO IEFVHA FROM VHEB @ZA00841 05897203
         B     B28                      CREATE SMB FOR ERROR MSG A40034 05898401
         DROP  R6                       RELEASE CWA ADDRESS.     A40034 05898801
B625     MVC   28(1,RD),0(R5)           DDNAME                          05900000
B63      DS    0H                       MOVE STEPNAME                   05920000
         EX    R4,B635                                                  05940000
         AR    R1,R2                    PTR TO NEXT SCAN CHAR           05960000
         B     B611                     SCAN FOR DDNAME                 05980000
**********************************************************************  05980402
*  PREFIX UPDATE SUBROUTINE                                      Y02668 05980802
**********************************************************************  05981202
AOIOPFXP DS    0H                                                Y02668 05981602
         L     R6,WANELPTR         GET BASE FOR NEL              Y02668 05982002
         USING NEL,R6              SET ADDRESSIBILITY            Y02668 05982402
         LA    R2,RPLADDR          GET BASE FOR RPL              Y02668 05982802
         USING IFGRPL,R2           SET ADDRESSIBILITY            Y02668 05983202
         MVI   RPLREQ,RPLGET       OPERATION TO BE A GET         Y02668 05983602
         MVC   RPLDACB,NELTXTCB    MOVE IN ACB POINTER           Y02668 05984002
         MVC   RPLAREA,TEXTBUFP    POINTER TO BUFFER             Y02668 05984402
         ST    R0,RPLARG           TTR OF RECORD                 Y02668 05984802
         MVI   RPLOPT1,RPLDIR      OPERATION TO BE DIRECT        Y02668 05985202
         MVI   RPLOPT2,RPLUPD      OPERATION TO BE WITH UPDATE   Y02668 05985602
         LH    R0,TXTBUFLT         GET BUFFER LENGTH             Y02668 05986002
         ST    R0,RPLBUFL          MAXIMUM BUFFER 4K             Y02668 05986402
         XC    RPLRLEN(4),RPLRLEN  ZERO FIELD                    Y02668 05986802
         XC    RPLDDDD(4),RPLDDDD  ZERO FIELD                    Y02668 05987202
         DROP  R6                                                Y02668 05987602
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 05988002
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 05988402
         LR    R1,R2               POINT TO RPL                  Y02668 05988802
         GET   RPL=(1)                                                  05989202
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 05989602
         LTR   RF,RF               TEST RETURN CODE              Y02668 05990002
         BNZ   AOIOERRT            BR NON-ZERO TO ERROR RTNE.    Y02668 05990402
         L     R6,TEXTBUFP         GET BASE FOR TEXT PREFIX      Y02668 05990802
         USING TEXT,R6             SET ADDRESSABILITY            Y02668 05991202
         TM    STRINDCS,JOBSTR     IS THIS JOB TEXT?             Y02668 05991602
         BZ    AOIOEXMV            NO GO TO MOVE IN EXEC PREFIX  Y02668 05992002
         MVC   TEXT(STRJPFXL),WAJOBPFX  UPDATE JOB PREFIX        Y02668 05992402
         B     AOIOPTXT            GO TO PUT TEXT                Y02668 05992802
AOIOEXMV DS    0H                                                Y02668 05993202
         MVC   TEXT(STREPFXL),WAEXCPFX  UPDATE JOB PREFIX        Y02668 05993602
AOIOPTXT DS    0H                                                Y02668 05994002
         XC    RPLRLEN(2),RPLRLEN  ZERO FIRST 2 BYTES AND        Y02668 05994402
         MVC   RPLRLEN+2(2),0(R6)  MOVE LENGTH IN LAST 2 BYTES   Y02668 05994802
         MVI   RPLREQ,RPLPUT       OPERATION TO BE A PUT         Y02668 05995202
         LR    R1,R2               POINT TO RPL                  Y02668 05995602
         DROP  R6                                                Y02668 05996002
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 05996402
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 05996802
         PUT   RPL=(1)                                                  05997202
         XC    RPLOPT2,RPLOPT2     CLEAR FOR FUTURE USE          Y02668 05997602
         DROP  R2                                                Y02668 05998002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 05998402
         LTR   RF,RF               TEST RETURN CODE              Y02668 05998802
         BCR   8,R7                NO ERROR RETURN TO CALLER     Y02668 05999202
         B     AOIOERRT            ERROR.                        Y02668 05999602
         EJECT                                                          06000002
*********************************************************************   06000402
*     PUT INTERNAL TEXT ROUTINE                                  Y02668 06000502
*********************************************************************   06000602
AOIORTN  DS    0H                                                Y02668 06000702
         TM    AOSW1,AOTXTWRT      IS THERE TEXT TO BE WRITTEN   Y02668 06000802
         BCR   8,R7                BRANCH NO                     Y02668 06000902
*   TEXT EXISTS FOR PRIOR STATEMENT. WRITE STRING TO TEXT DS     Y02668 06001002
         L     R6,TEXTBUFP         GET BASE FOR TEXT PREFIX      Y02668 06001102
         USING TEXT,R6             SET ADDRESSABILITY            Y02668 06001202
         TM    STRINDCS,EXECSTR    IS THIS AN EXEC STRING        Y02668 06001302
         BZ    AOIODD              NO GO TO CHECK FOR A DD       Y02668 06001402
         TM    STREINDC,ETXCPFLG   C/R FLAG SET IN PREFIX      @ZA09485 06001503
         BO    AOPSEUDO            DONT SET JOB HAS STEP BIT   @ZA09485 06001603
         OI    SWA,JHS             SET STEP DOES EXIST           Y02668 06002503
AOPSEUDO CLI   VERB(RA),2          YES IS THE NEXT AN EXEC ALSO@ZA09485 06002603
         BE    AOIOEXDD            YES GO TO SET NO DD BIT       Y02668 06003003
         CLI   VERB(RA),0          IS THE NEXT STMT A NULL?      Y02668 06003103
         BNE   AOIOPUT             NO GO TO PUT TEXT             Y02668 06003203
AOIOEXDD DS    0H                                                Y02668 06003303
         OI    STREINDC,ETXNODD    YES SET NO DD IN STEP         Y02668 06003403
         B     AOIOPUT             GO TO PUT TEXT                Y02668 06003503
AOIODD   DS    0H                                                       06003603
         TM    STRINDCS,DDSTR      IS THIS DD TEXT TO BE WRITTEN Y02668 06003703
         BZ    AOIOPUT             NO GO TO PUT TEXT             Y02668 06003803
         CLI   VERB(RA),4          IS THE NEXT STMT A DD?        Y02668 06003903
         BE    AOIOPUT             YES GO TO PUT TEXT            Y02668 06004003
         OI    STRINDCS,LASTSTMT   YES  SET LAST STMT BIT IN PFX Y02668 06004103
         DROP  R6                                                Y02668 06004203
AOIOPUT  DS    0H                                                Y02668 06004303
         NI    AOSW1,255-AOTXTWRT  CLEAR TEXT WRITE SWITCH       Y02668 06004403
         L     R6,WANELPTR         GET BASE ADDRESS OF NEL       Y02668 06004503
         USING NEL,R6              SET BASE                      Y02668 06004603
         LA    R2,RPLADDR          GET BASE ADDRESS OF RPL       Y02668 06004703
         USING IFGRPL,R2           SET BASE                      Y02668 06004802
         MVI   RPLREQ,RPLPUT       OPERATION TO BE A PUT         Y02668 06005202
         MVC   RPLDACB,NELTXTCB    MOVE IN ACB POINTER           Y02668 06005602
         MVC   RPLAREA,TEXTBUFP    POINTER TO RECORD             Y02668 06006002
         XC    RPLARG(4),RPLARG    ZERO FIELD                    Y02668 06006402
         MVI   RPLOPT1,RPLSEQ      SET TO SEQUENTIAL             Y02668 06006802
         L     R1,TEXTBUFP         GET TEXT ADDRESS              Y02668 06007202
         XC    RPLRLEN(4),RPLRLEN  ZERO FIELD                    Y02668 06007602
         MVC   RPLRLEN+2(2),0(R1)  GET LENGTH OF RECORD          Y02668 06008002
         XC    RPLBUFL(4),RPLBUFL  ZERO FIELD                    Y02668 06008402
         XC    RPLDDDD(4),RPLDDDD  ZERO FIELD                    Y02668 06008802
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 06009202
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 06009302
         LR    R1,R2               POINT TO RPL                  Y02668 06009402
         DROP  R6                                                Y02668 06009502
         DROP  R2                  FREE REGISTER 2               Y02668 06009602
         PUT   RPL=(1)                                                  06009702
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 06009802
         LTR   RF,RF               ACCESS MTHOD ERROR?           Y02668 06009902
         BNZ   AOIOERRT            YES, BR TO ERROR RTNE.        Y02668 06010002
         LA    R2,RPLADDR          GET ADDRESS OF RPL            Y02668 06010102
         USING IFGRPL,R2           SET ADDRESSABILITY            Y02668 06010202
         L     R6,TEXTBUFP         GET BASE FOR TEXT PREFIX      Y02668 06010302
         USING TEXT,R6             SET ADDRESSABILITY            Y02668 06010402
         TM    STRINDCS,JOBSTR     IS THIS JOB TEXT?             Y02668 06010502
         BZ    AOIOEXEC            NO GO CHECK FOR EXEC TEXT     Y02668 06010602
         MVC   WAJOBRBA(8),RPLRBAR YES SAVE JOB TEXT SVA AND     Y02668 06010702
         OC    WAJOBPFX(STRJPFXL),TEXT   JOB PREFIX             YM00387 06010802
         B     AOIOEXIT            GO TO PUT SUBROUTINE EXIT     Y02668 06010902
AOIOEXEC DS    0H                                                Y02668 06011002
         TM    STRINDCS,EXECSTR    IS THIS EXEC TEXT?            Y02668 06011102
         BZ    AOIOEXIT            NO GO TO PUT SUBROUTINE EXIT  Y02668 06011202
         MVC   WAEXCRBA(8),RPLRBAR YES SAVE EXEC TEXT SVA AND    Y02668 06011302
         MVC   WAEXCPFX(STREPFXL),TEXT      EXEC PREFIX          Y02668 06011402
         DROP  R2                  FREE REGISTER 2               Y02668 06011502
         DROP  R6                                                Y02668 06011602
AOIOEXIT DS    0H                                                Y02668 06011702
         BR    R7                  RETURN TO CALLER              Y02668 06012402
* I/O ERROR.                                                     Y02668 06013202
AOIOERRT DS    0H                                                Y02668 06013402
         MVC   IWARET(2),PGMERROR  SET RETURN CODE               Y02668 06013602
         OI    AOSW4,CWATERM       INDICATE TERMINATION          Y02668 06013802
         LA    R5,4                I/O ERROR MSG CODE            Y02668 06014002
         L     RF,IEFVHRV          GET ADDRESS OF IEFVHR         Y02668 06014402
         BALR  RE,RF               GO TO IEFVHR                  Y02668 06014802
         LA    R2,20               I/O ERROR MSG CODE            Y02668 06015202
         L     RF,IEFVGMV          GET ADDRESS OF IEFVGM         Y02668 06015602
         BALR  RE,RF               GO TO IEFVHR                  Y02668 06016002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 06016402
         BR    RF                  GO TO TERMINATION             Y02668 06016802
B635     MVC   20(1,RD),0(R5)      STEPNAME                      Y02668 06017202
         EJECT                                                          06017602
IEFVHRV  DC    V(IEFVHR)           WTO MODULE.                   Y02668 06018002
IEFVGMV  DC    V(IEFVGM)                MSG                             06020000
IEFVHAV  DC    V(IEFVHA)                GET STMT                        06040000
IEFVHFV  DC    V(IEFVHF)           CONTROL ROUTINE.              Y02668 06060002
IEFVHLV  DC    V(IEFVHL)                NULL                            06080000
IEFVHMV  DC    V(IEFVHM)                SCAN COMMAND                    06100000
IEFVHEB  DC    V(IEFVHEB)            **PRE-SCAN PREP RTN.               06110014
IEFVINAV DC    V(IEFVINA)          INSTREAM PROC MODULE.         Y02668 06115002
BLANKS   DC    C'        '          TO BLANK DDNAME            @ZA01932 06117003
DD       DC    C'DD '                                                   06120000
JOB      DC    C'JOB '                                                  06140000
EXEC     DC    C'EXEC '                                                 06160000
PROCA    DC    C'PROC '              **PROC VERB                        06170014
SYSCHK   DC    C'SYSCHK '          CKPT/RESTART DD NAME CONSTANT   AACA 06171017
ASTERISK DC    C'* '               CKPT/REST IMMEDIATE             AACA 06172017
PGMERROR DC    X'0024'             PGM ERROR CODE (36)           Y02668 06172502
TXTBUFLT DC    H'8184'             MAX TEXT RECLTH, BUF LTH-HDR. Y02668 06172702
MSG60    EQU   60                  CHECKID = 0 AND SYSCHK DD       AACA 06173017
*                                  APPEARED BEFORE AN EXEC STMT    AACA 06174017
CPSTMTP  EQU   IWAJOBS5            SYSCHK DD STMT SAVE AREA PTR    AACA 06175017
MSG1     EQU   1                        INVALID STMT IN PROC            06180000
MSG5     EQU   5                        NO VERB                         06200000
MSG7   EQU     7             JOB HAS NO STEPS MSG KEY           YM00387 06205002
MSG13    EQU   58                                                       06210014
MSG17    EQU   17                  CODE FOR IEF617I MSG        @ZA14932 06210103
MSG42    EQU   42                      CODE FOR IEF642I MSG      A40034 06210203
DDVERB   EQU   4                       DD STMT CODE IN PARM LIST A40034 06210303
NOT      EQU   255                                               A27782 06210419
MVTHREE  EQU   3                       LENGTH OF MOVE             O106  06210819
DISPL0   EQU   0                       DISPLACEMENT               O106  06211619
DISPL1   EQU   1                       DISPLACEMENT               O106  06212419
MINCT    EQU   X'01'                   COUNT VALUE WHEN NO IN-LINEO106  06213219
*                                      PROCEDURES EXIST           O106  06214019
MAXLIN   EQU   255                     INITIALIZE FIRST BYTES OF  O106  06214819
*                                      WORK AREA                  O106  06215619
WORKLN   EQU   352                     LENGTH OF WORK AREA        O106  06216419
QMPALN   EQU   48                      LEN OF EXTERNAL PARM LIST        06217219
*                                      PARM LIST                  O106  06218019
PEND     DC    C'PEND '                PEND VERB STATEMENT         4387 16218819
ONE      EQU   1                                                 A26382 16268801
PENDERR  EQU   X'44'                   IEF668I PEND VERB STMT OUT OF    26218819
*                                      SEQUENCE                    4397 36218819
INSTPR   EQU   X'80'                   IN-STREAM PROC BEING PROC   4398 46218819
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 49218802
         END                                                            56218819
./  ADD  SSI=80550309,NAME=IEFVHE
*********************************************************************** 00020000
*                                                                       00030002
*MODULE NAME= IEFVHE                                                    00070002
*  CSECT-NAME= IEFVHE                                                   00120002
*                                                                       00170002
*DESCRIPTIVE NAME= INTERPRETER GET AND  ROUTE ROUTINE                   00220002
*                                                                       00270002
*COPYRIGHT= N/A                                                         00320002
*                                                                       00370002
*STATUS= OS/VS2 037 PTF                                        @ZA27750 00420003
*                                                                       00470002
*FUNCTION= THIS ROUTINE  GETS TEXT STRINGS                              00520002
*          FROM THE INTERNAL TEXT DATA SET AND                          00540002
*          ROUTES THE STRINGS TO THE APPROPRIATE PROCESSOR.             00550002
*          IT ALSO RECOGNIZES WHEN AN SCT IS TO BE PUT TO SWA           00560002
*          AND END OF JOB(JCT TO BE PUT TO SWA).                        00562002
*                                                                       00564002
*                                                                       00566002
*  OPERATION=  .THE RPL IN THE IWA IS  INITIALIZED TO ISSUE A           00570002
*               GET FROM THE INTERNAL TEXT DATA SET                     00636602
*              .AN INTERNAL TEXT STRING IS GOTTEN                       00637002
*              .A  CHECK IS MADE FOR DATA SET EOF                       00638602
*               (END OF JOB)- IF YES, EXIT TO IEFVHEC.                  00639002
*              .IF NOT END OF JOB,  THE STATEMENT IS IDENTIFIED         00639402
*               AND ROUTED TO THE APPROPRIATE PROCESSOR                 00639802
*               PRIOR TO ROUTINE, STMT ORIENTED INFORMATION IS   Y02668 00639902
*               PROPAGATED FROM THE TEXT STRING PREFIX TO THE    Y02668 00640902
*               IWA. THIS ALLOWS THE PROCESSORS TO ACCESS IT MOREY02668 00641902
*               EASILY.                                          Y02668 00642902
*               TO SEE IF AN SCT IS TO BE PUT TO SWA, IF YES EXIT       00646602
*               IS MADE TO IEFVHH.                                      00656602
*                                                                       00660002
*                                                                       00720002
*NOTES                                                                  00730002
*  DEPENDENCIES= NONE                                                   00732002
*  CHARACTER-CODE DEPENDENCIES= EBCDIC                                  00734002
*  RESTRICTIONS= NONE                                                   00736002
*  REGISTER-CONVENTIONS=  REG 11 - MODULE BASE                          00738002
*                         REG 12 - IWA POINTER                          00738102
*                         REG 13 - REG SAVE AREA PTR                    00738202
*  PATCH-LABEL= PATCH                                                   00738402
*                                                                       00738502
*                                                                       00738802
*MODULE TYPE= BAL CSECT                                                 00739202
*  PROCESSOR= ASSEMBLER                                                 00739602
*  ATTRIBUTES= REFRESHABLE,PRIVILEGED,REENTRANT, KEY 0, PAGEABLE LPA    00739802
*                                                                       00739902
*ENTRY POINT= IEFVHE FROM IEFNB903 (INTERPRETER INITIALIZATION)         00746602
*  PURPOSE= TO GET A TEXT STRING AND ROUTE IT                           00748602
*  LINKAGE= BR                                                          00750602
*  INPUT= R12- PTR TO IWA, R13 - PTR TO REG SAVE AREA                   00752602
*  REGISTERS SAVED= NONE                                                00753002
*  REGISTER USAGE=                                                      00753102
*               R0  - WORK REG                                          00754802
*               R1  - WORK REG                                          00756802
*               R2  - RPL BASE                                          00757202
*               R3  - UNUSED                                            00757602
*               R4  - UNUSED                                            00758002
*               R5  - UNUSED                                            00758102
*               R6  - NEL BASE                                          00758202
*               R7  - TEXT PREFIX BASE                                  00758702
*               R8  - UNUSED                                            00759102
*               R9  - UNUSED                                            00759502
*               R10 - LOCAL WORK AREA PTR                               00759602
*               R11 - MODULE BASE REG                                   00759702
*               R12 - IWA PTR                                           00759802
*               R13 - PTR TO REG SAVE AREA                              00760902
*               R14 - LINKAGE AND WORK REG                              00762902
*               R15 - LINKAGE AND WORK REG                              00763302
*  REGISTERS RESTORED= NONE                                             00763502
*                                                                       00764302
*                                                                       00764602
*EXIT - NORMAL= IEFVJA                                                  00765002
*  CONDITIONS= JOB STMT TEXT STRING ENCOUNTERED                         00765402
*  OUTPUT= REG 12 - PTR TO IWA WHICH CONTAINS PTR TO TXT STR            00765502
*  RETURN CODES= NONE                                                   00765602
*                                                                       00765702
*                                                                       00765802
*EXIT - NORMAL= IEFVEA                                                  00765902
*  CONDITIONS= EXEC STMT TEXT STRING ENCOUNTERED                        00766002
*  OUTPUT= REG 12 - PTR TO IWA WHICH CONTAINS PTR TO TXT STR            00766102
*  RETURN CODES= NONE                                                   00766202
*                                                                       00766302
*                                                                       00766402
*EXIT - NORMAL= IEFVDA                                                  00767202
*  CONDITIONS= DD STMT TEXT STRING ENCOUNTERED                          00767302
*  OUTPUT= REG 12 - PTR TO IWA WHICH CONTAINS PTR TO TXT STR            00767402
*  RETURN CODES= NONE                                                   00767502
*                                                                       00767802
*                                                                       00768402
*EXIT - NORMAL= IEFVHH                                          YM02714 00768702
*  CONDITIONS= JOB END  FOUND (EOF ON TEXT DATA SET)                    00769002
*  OUTPUT= REG 12 - PTR TO IWA                                          00769302
*  RETURN CODES= NONE                                                   00769602
*                                                                       00769902
*                                                                       00770202
*EXIT - NORMAL= IEFVHH                                                  00770502
*  CONDITIONS= SCT TO PUT TO SWA                                        00770902
*  OUTPUT= REG 12 - PTR TO IWA                                          00771102
*  RETURN CODES= NONE                                                   00771202
*                                                                       00771902
*EXIT - ERROR= IEFVHN  VIA BR 14                                        00774302
*  CONDITIONS=  I/O ERROR                                               00775102
*  OUTPUT= REG 12 - PTR TO IWA WHICH CONTAINS I/O ERROR FLAG            00775902
*  RETURN CODES= NONE                                                   00777202
*                                                                       00779202
*                                                                       00779302
*EXTERNAL REFERENCES=                                                   00779602
*  ROUTINES= IEFVHR (TO ISSUE WTO)                                      00779702
*  DATA AREAS= LWA, IWA                                                 00779902
*  CONTROL BLOCKS=                                                      00780002
*              RPL, ACB                                                 00782002
*                                                                       00787902
*      TABLES= INTERNAL KEYS(IEFVKEYS)                                  00789202
*                                                                       00791202
*      MACROS= GET, IEFZB900                                            00791602
*         IEFVMIWA,IEFRPL,IEFACB,                                       00792302
*      SERIALIZATION= NONE                                              00793702
*.                                                                      00794402
*                                                                       00795102
*CHANGE LEVEL = Z40MPTH,Z40RPSM,OZ10512,OZ27750                @ZA27750 00795803
*CHANGE ACTIVITY= Y02668                                                00796503
*                                                                       00797203
*MESSAGES = IEF6XXI I/O ERROR INTERPRETING JOB                          00797903
*                                                                       00799302
*********************************************************************** 00800002
         EJECT                                                          00801702
         IEFCOMWA                                                       00804002
         IEFVMIWA                                                       00805002
         SPACE 5                                                        00807002
JCTD     DSECT                                                          00807702
         IEFAJCTB                                                       00808602
         SPACE 5                                                        00812002
NEL      DSECT                                                          00812202
         IEFNEL SUBCOM=I,EXITS=(TXT,RTN,QEP,SMF,IAM,FAM)                00812402
         SPACE 5                                                        00812602
         IEFASCTB                                                Y02668 00813202
         EJECT                                                   Y02668 00813302
         IEFVMEWA                                                Y02668 00813402
         SPACE 5                                                        00813802
         IEFVMJWA  NA                                                   00814002
         SPACE 5                                                        00814202
         IEFVMDWA  NA                                                   00814402
         SPACE 5                                                        00814602
         IEFQMNGR                                                       00814802
         SPACE 5                                                        00815002
         IEFJMR                                                         00815202
         IEFVKEYS                                                       00816002
         EJECT                                                          00820002
         EJECT                                                          00828002
         IEFTXTFT                                                       00832002
         EJECT                                                          00836002
         IFGRPL                                                  Y02668 00836802
         EJECT                                                   Y02668 00837602
         IDARMRCD                                                Y02668 00838402
         EJECT                                                   Y02668 00839202
IEFVHE   CSECT                                                          00840000
* CODE MOVED FROM AFTER LABEL VHE0043 TO NEAR LABEL C1         @ZA10512 00843003
*****************************************************************       00850002
*                                                               *       00860002
*  READING AND ROUTING FUNCTIONS                                *       00870002
*                                                               *       00880002
*****************************************************************       00890002
         SPACE 2                                                        00900002
         BALR  RB,0                MODULE BASE REG               Y02668 00910002
         USING *,RB                MODULE ADDRESSABILITY         Y02668 00920002
*****************************************************************Y02668 00942002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 00944002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 00946002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 00948002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 00950002
         DC    C'VHE '             MOD ID USED BY TRACE.         Y02668 00952002
* TRACE RETURNS HERE.                                            Y02668 00954002
*****************************************************************Y02668 00956002
         B     C1                                                       00960000
         MODID BR=NO                                             Y01886 01010001
         DC    C'037 PTF'           FUNCTION ID                @ZA10512 01033003
*        DC    C'03'   LEV # (SAVE CORRECT STATEMENT NUMBER)   @ZA10512 01034003
         DC    C'04'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27750 01035003
C1       DS    0H                                                       01040000
         L     R7,TEXTBUFP         GET TEXT BUF ADDRESS         YM00397 01040102
         USING TEXT,R7             GET TXT PFX ADDRESSABILITY   YM00397 01041002
         TM    AOSW2,AONOREAD      HAS STMT IN TEXTBUFFER BEEN   Y02668 01111002
*                                  PROCESSED YET                 Y02668 01181002
         BZ    VHE0010             YES, SET UP FOR 'GET'         Y02668 01251002
         NI    AOSW2,255-AONOREAD  NO, CLEAR SWITCH AND          Y02668 01321002
         TM    STREINDC,ETXPRCV    STMT INVOKE A PROC?         @ZA10512 01323003
         BZ    VHE0050             NO, BYPASS 1ST PASS PROC.   @ZA10512 01325003
         TM    STRINDCS,PROCSTR    REALLY A PROC STMT(DUM EXEC)@ZA10512 01335003
         BO    VHE0050             BR YES, WANT REAL EXEC ONLY @ZA10512 01345003
         MVC   IWAEXPNO(2),WASTMTNO SAVE STMT NBR OF REAL EXEC @ZA10512 01355003
*                                  FOR PROC O'RIDE ERR MSG.    @ZA10512 01365003
         B     VHE0050             BYPASS FIRST PASS PROCESSING YM00382 01391002
         EJECT                                                          01461002
*****************************************************************Y02668 01541002
*                                                               *Y02668 02041002
*  GET FROM THE INTERNAL TEXT DATA SET - EODAD & SYNAD RTNS     *Y02668 02541002
*                                                               *Y02668 03041002
*****************************************************************Y02668 03541002
         SPACE 2                                                 Y02668 04041002
VHE0010  DS    0H                                                Y02668 04541002
         L     R6,WANELPTR         GET BASE ADDRESS OF NEL       Y02668 05042002
         USING NEL,R6              SET BASE                      Y02668 05842002
         LA    R2,RPLADDR          GET BASE ADDRESS OF RPL       Y02668 06642002
         USING IFGRPL,R2           SET BASE                     Y02668  07442002
         MVI   RPLREQ,RPLGET       OPERATION TO BE A GET         Y02668 08242002
         MVC   RPLDACB,NELTXTCB    MOVE IN ACB POINTER           Y02668 09042002
         MVC   RPLAREA,TEXTBUFP    POINTER TO RECORD             Y02668 09842002
         XC    RPLARG(4),RPLARG    ZERO FIELD                    Y02668 10642002
         MVI   RPLOPT1,RPLSEQ      INDICATE TXT D.S. IS SEQENTIALY02668 11442002
         XC    RPLRLEN(WORDLEN),RPLRLEN RECORD LENGTH NOT NEEDED Y02668 11842002
*                                  FOR GET                       Y02668 12242002
         LH    R0,TXTBUFLT         GET LENGTH OF TEXT BUFFER     Y02668 12642002
*                                  INTO WHICH RECORD IS TO BE    Y02668 13042002
*                                  READ                          Y02668 13442002
         ST    R0,RPLBUFL          SAVE IN RPL BUF LENGTH        Y02668 13842002
         XC    RPLDDDD(4),RPLDDDD  ZERO FIELD                    Y02668 14642002
         XC    RPLERRCD(1),RPLERRCD ZERO UNUSED FIELD            Y02668 15442002
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 16242002
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 16642002
         LR    R1,R2               POINT TO RPL                  Y02668 17042002
         DROP  R6                                                Y02668 18642002
         GET   RPL=(1)                                                  19442002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 20242002
         LTR   RF,RF               ERROR ATTEMPTING GET ?        Y02668 21042002
         BZ    VHE0020             NO. BRANCH TO CONTINUE        Y02668 21112002
         CLI   RPLRTNCD,RPLLOGER   IS THIS A LOGICAL ERROR ?     Y02668 21182002
         BNE   VHE0015             NO. GO TO ERROR EXIT          Y02668 21252002
         CLI   RPLERRCD,RPLEODER   IS END OF DATA DETECTED ?     Y02668 21322002
         BNE   VHE0015             NO. GO TO ERROR EXIT          Y02668 21392002
         NI    SWE,255-PROC        TEXT EOF - PROC ENDED        YM00382 21492002
         OI    SWA,JCTTQ           INDICATE END OF JOB-SO PUT    Y02668 21542002
*                                  THE JCT TO SWA                Y02668 21562002
         L     RF,IEFVHHV          GET PTR TO RTN THAT PUTS      Y02668 21582002
*                                  CONTROL BLOCKS TO SWA         Y02668 21602002
         BR    RF                  GO TO PROCESS EOF             Y02668 21642002
VHE0015  DS    0H                                                Y02668 21742002
         LTR   RF,RF               ERROR IN ATTEMPTING GET?      Y02668 21842002
         BZ    VHE0020             NO ERROR, 'GET' COMPLETE     YM01588 21942002
         LA    R5,4                I/O ERROR MSG CODE(FOR WTO)   Y02668 22042002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 22142002
         BALR  RE,RF               WRITE I/O ERROR MSG TO CONSOLEY02668 22242002
         LA    R2,20               I/O ERROR MSG CODE(SYS OUTPUT)Y02668 22342002
         L     RF,IEFVGMV          GET MSG RTN ADDR              Y02668 22442002
         BALR  RE,RF               WRITE MSG TO SYS MSG DATA SET Y02668 22542002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE FOR CALLER    Y02668 22642002
*                                  OF INTERPRETER                Y02668 22742002
         L     RF,TERMRTN          GET INTERPRETER TERM RTN ADDR Y02668 22842002
         BR    RF                  GO TO TERMINATE THE           Y02668 22942002
*                                  INTERPRETER                   Y02668 23042002
         EJECT                                                          23142002
*****************************************************************Y02668 23242002
*                                                               *Y02668 23342002
*  DD STMT: IDENTIFY, COPY PREFIX INFO INTO IWA, AND ROUTE      *Y02668 23442002
*           TO DD PROCESSOR                                     *Y02668 23542002
*                                                               *Y02668 23642002
*****************************************************************Y02668 23742002
         SPACE 2                                                 Y02668 23842002
*                                                               YM00371 24242002
*  UPDATE STATEMENT # FOR ALL INPUT STATEMENTS.                 YM00371 24252002
*                                                               YM00371 24262002
VHE0020  DS    0H                                                Y02668 24272002
         TM    STRINDCS,EXECSTR    EXEC STMT?                   YM00371 24282002
         BZ    VHE0021             NO, CONTINUE NORMALLY.       YM00371 24292002
         TM    STREINDC,ETXCPFLG   C/R EXEC? (INTERNAL STMT).   YM00371 24302002
         BO    VHE0025             YES, INTERNAL STMT, DO NOT   YM00371*24312002
                                   UPDATE STMT #.               YM00371 24322002
VHE0021  DS    0H                                               YM00371 24332002
         LH    RF,WASTMTNO         GET STMT NO OF LAST           Y02668 24342002
*                                  TEXT STRING PROCESSED         Y02668 24442002
         LA    RF,NEXT(RF)         INCREMENT STMT NO, BY ONE     Y02668 24542002
         STH   RF,WASTMTNO         STORE STMT NO. OF TEXT STRING Y02668 24642002
*                                  JUST READ-USED BY MSG RTN TO  Y02668 24742002
*                                  CORRELATE MSGS WITH STMTS     Y02668 24842002
VHE0025  DS    0H                  START STMT IDENTIFICATION    YM01588 24942002
         TM    STRINDCS,DDSTR      IS THIS A DD STMT STRING      Y02668 27442002
         BZ    VHE0030             NO,CHECK FOR EXEC STMT        Y02668 28242002
         XC    SWY2(1),SWY2        CLEAR SWITCHES FOR THIS DD.   Y02668 28248002
         XC    SWI(1),SWI          CLEAR SWITCHES FOR THIS DD.   Y02668 28254002
         TM    STRDINDC,DTXDSNLT   DSN FOR THIS DD A LITERAL?    Y02668 28262002
         BZ    VHE00252            BRANCH NO.                    Y02668 28282002
         OI    SWI,DSNLIT          SET WORK AREA DSN LITERAL SW. Y02668 28302002
VHE00252 DS    0H                                                Y02668 28322002
         TM    STRDINDC,DTXDDNM    DDNAME= SPECIFIED ON STMT?    Y02668 28342002
         BZ    VHE00255            BRANCH NO.                    Y02668 28362002
         OI    SWI,IWADDNM         YES, SET DDNAME SW IN IWA.    Y02668 28382002
VHE00255 DS    0H                                                Y02668 28402002
         TM    STRDINDC,DTXDYNAM   DYNAM SPECIFIED ON STMT?      Y02668 28442002
         BZ    VHE0027             BRANCH NO.                    Y02668 28542002
         OI    SWY2,DYNAMSW        SET DYNAM SW FOR VDA.         Y02668 28642002
VHE0027  DS    0H                                                Y02668 28742002
         TM    STRDINDC,DTXDUMMY   DUMMY SPECIFIED ON STMT?     YM02714 28802002
         BZ    VHE00272            BRANCH NO.                   YM02714 28862002
         OI    SWY2,DUMMYSW        SET DUMMY SW FOR VDA.        YM02714 28922002
VHE00272 DS    0H                                               YM02714 28982002
         L     RF,IEFVDAV          GET PTR TO DD STMT PROCESSOR  Y02668 29042002
         BR    RF                  EXIT TO PROCESS DD STRING     Y02668 29842002
         EJECT                                                   Y02668 29922002
*****************************************************************Y02668 30002002
*                                                               *Y02668 30082002
*  EXEC & PROC STMTS: IDENTIFY, COPY PREFIX INFO INTO IWA, AND  *Y02668 30162002
*                     ROUTE TO EXEC PROCESSOR                   *Y02668 30242002
*                                                               *Y02668 30322002
*****************************************************************Y02668 30402002
         SPACE 2                                                 Y02668 30482002
VHE0030  DS    0H                                                Y02668 30642002
         TM    STRINDCS,JOBSTR     IS THIS A JOB STRING ?       YM00382 31442002
         BO    VHE0060             YES  GO TO PROCCESS JOB      YM00382 32042002
VHE0040  DS    0H                                                Y02668 32642002
         OI    SWA,JHS             INDICATE JOB HAS A STEP.      Y02668 32942002
         TM    STREINDC,ETXPROC    EXEC FROM A PROCEDURE?        Y02668 33242002
         BZ    VHE0042             BRANCH NO.                    Y02668 33542002
         OI    SWE,PROC            SET PROC SWITCH FOR VEA.      Y02668 33842002
         B     VHE0043             CONTINUE PROCESSING.          Y02668 34142002
VHE0042  DS    0H                                                Y02668 34742002
         NI    SWE,255-PROC        CLEAR PROC SWITCH, STATEMENT  Y02668*35042002
                                   NOT FROM PROC.                Y02668 35142002
VHE0043  DS    0H                                                Y02668 35342002
         TM    STREINDC,ETXPRCV    STMT INVOKE A PROC?           Y02668 35642002
         BZ    VHE0044             BRANCH NO.                    Y02668 35942002
         OI    SWE,PRCV            SET PROC INVOKED FLAG FOR VEA.Y02668 36242002
         TM    STRINDCS,PROCSTR    REALLY A PROC STMT(DUM EXEC)?YM02714 36302002
         BZ    VHE0044A            CONTINUE PROCESSING.        @ZA10512 36542003
VHE0044  DS    0H                                                Y02668 36842002
         NI    SWE,255-PRCV        CLEAR PROC INVOKED SWITCH.    Y02668 37142002
VHE0044A DS    0H                                                Y02668 37172002
         TM    STREINDC,ETXCPFLG   CHECKPT/RESTART EXEC?         Y02668 37202002
         BZ    VHE0045             BRANCH NO.                    Y02668 37232002
         OI    SWH,CPSYSFLG        SET C/R FLAG IN WORK AREA.    Y02668 37262002
         B     VHE0046             CONTINUE PROCESSING.          Y02668 37292002
VHE0045  DS    0H                                                Y02668 37322002
         NI    SWH,255-CPSYSFLG    CLEAR C/P FLAG .              Y02668 37352002
VHE0046  DS    0H                                                Y02668 37442002
         TM    STREINDC,ETXPRCV    STMT INVOKE A PROC?         @ZA10512 37492003
         BO    VHE0048             GO CHECK O'RIDE STEP NOT FOUND       37542003
*                                                              @ZA10512 37592003
         TM    SWA,SCTTQ           IS THERE AN SCT FOR A         Y02668 37842002
*                                  PREVIOUS STEP THAT SHOULD BE  Y02668 38642002
*                                  PUT TO SWA                    Y02668 39442002
         BZ    VHE0050             NO, JUST PROCESS STMT         Y02668 40242002
VHE0048  DS    0H                                              @ZA10512 40292003
         OI    AOSW2,AONOREAD      INDICATE AFTER SCT IS         Y02668 40342002
*                                  PUT TO SWA,THE EXEC IN TXTBUF Y02668 40442002
*                                  MUST BE PROCESSED BEFORE THE  Y02668 40542002
*                                  NEXT STMT IS READ             Y02668 40642002
         L     RF,IEFVHHV          YES, GET CONTROL BLK'PUT'RTN  Y02668 41042002
         BR    RF                  GO TO PUT SCT TO SWA          Y02668 41842002
VHE0050  DS    0H                                                Y02668 42642002
         MVC   WAEXCPFX(STREPFXL),0(R7) SAVE EXEC PREFIX.        Y02668 43042002
         L     RF,IEFVEAV          GET PTR TO EXEC STMT PROCESSORY02668 43442002
         BR    RF                  EXIT TO PROCESS EXEC STRING   Y02668 44242002
         EJECT                                                   Y02668 44322002
*****************************************************************Y02668 44402002
*                                                               *Y02668 44482002
*  JOB STMT: IDENTIFY, COPY PREFIX INFO INTO IWA, AND ROUTE    **Y02668 44562002
*            TO JOB PROCESSOR                                   *Y02668 44642002
*                                                               *Y02668 44722002
*****************************************************************Y02668 44802002
         SPACE 2                                                        44882002
VHE0060  DS    0H                  ASSUME JOB TEXT STRING        Y02668 45042002
         TM    STRJINDC,JTXSYSCK   JOB HAVE SYSCHK DD?           Y02668 45048002
         BZ    VHE0064             BRANCH NO.                    Y02668 45054002
         LA    R8,JCT              ADDRESS OF JCT.               Y02668 45060002
         USING JCTD,R8             JCT ADDRESSABILITY.           Y02668 45066002
         OI    JCTRSW2,JCTSYSCK    SET SYSCHK DD RECEIVED FLAG.  Y02668 45072002
         DROP  R8                                                Y02668 45078002
VHE0064  DS    0H                                                Y02668 45084002
         TM    STRJINDC,JTXCPSTF   C/R STEP FLUSH BIT ON?        Y02668 45090002
         BZ    VHE0080             BRANCH NO.                    Y02668 45096002
         OI    SWH,CPSTPFL         SET WORK AREA STEP FLUSH BIT. Y02668 45102002
VHE0080  DS    0H                                                Y02668 45108002
         MVC   WAJBNAME(8),AOBLKNAM BLANK JOBNAME FIELD.         Y02668 45122002
         SR    R5,R5               CLEAR LENGTH REG.             Y02668 45202002
         IC    R5,STRJKEY+2        LOAD JOBNAME LENGTH.          Y02668 45282002
         LTR   R5,R5               LENGTH = 0?                  YM08106 45292002
         BZ    VHE0081             YES, BYPASS MOVE OF NAME.    YM08106 45302002
         BCTR  R5,0                DECREMENT FOR EXECUTED MOVE. YM04716 45322002
         EX    R5,AOMVJBNM         MOVE JOBNAME FROM TEXT TO WA. Y02668 45362002
VHE0081  DS    0H                                               YM08106 45402002
         MVC   WAJOBPFX(STRJPFXL),0(R7) SAVE JOB PREFIX.         Y02668 45442002
         MVC   DINBPLP1(1),STRJLABD MOVE BPL DEFAULT TO WORK     Y02668*45472002
                                   AREA FOR IEFVDA.              Y02668 45502002
         TM    STRJINDC,JTXJOBFL   JOB FAILED BY CONVERTER?      Y02668 45532002
         BZ    VHE0082             BRANCH NO.                    Y02668 45562002
* JOB WAS FAILED IN CONVERTER. PROPAGATE JOB FAILED BIT TO JCT.  Y02668 45592002
         LA    R4,JCT              JCT ADDRESS.                  Y02668 45622002
         USING JCTD,R4             JCT ADDRESSABILITY.           Y02668 45652002
         OI    JCTJSTAT,INCMSTS    SET JOB FAILED BIT.           Y02668 45682002
         DROP  R4                                                Y02668 45712002
VHE0082  DS    0H                                                Y02668 45742002
         L     RF,IEFVJAV          GET PTR TO JOB STMT PROCESSOR Y02668 45842002
         BR    RF                  EXIT TO PROCESS JOB STRING    Y02668 46642002
         SPACE 1                                                        46842002
AOMVJBNM MVC   WAJBNAME(0),STRJKEY+3 EXECUTED MOVE OF JOBNAME.   Y02668 47042002
         EJECT                                                          47442002
*****************************************************************Y02668 48242002
*                                                               *Y02668 49042002
*                        EQUATES                                *Y02668 49842002
*                                                               *Y02668 50642002
*****************************************************************Y02668 51442002
         SPACE 2                                                 Y02668 52242002
LNGTHAWA EQU   ENDAWA-QLINKWA                                    Y02668 57842002
LNGJACT  EQU   JACT-JASW1                                        Y02668 58642002
LNGSIOT  EQU   SIOT-DWA                                          Y02668 59442002
LNGJFCB  EQU   JFCB-DWA                                          Y02668 60242002
LNGJFCBX EQU   JFCBX-DWA                                         Y02668 61042002
WORDLEN  EQU   4                                                 Y02668 65042002
QMPALEN  EQU   32                                                Y02668 65842002
NONE     EQU   0                                                 Y02668 66642002
JMRLEN   EQU   X'4C'                                             Y02668 67442002
TABLEN   EQU   176                                               Y02668 68242002
AOWBFLTH EQU   90                                                Y02668 69842002
DBLEWORD EQU   8                                                 Y02668 70642002
SIGNDIGT EQU   7                                                 Y02668 71442002
BYTE0    EQU   0                                                 Y02668 72242002
HEX00    EQU   0                                                 Y02668 73042002
NEXT     EQU   1                                                 Y02668 73842002
SIGN     EQU   X'F0'                                             Y02668 74642002
DATEDSPL EQU   3                                                 Y02668 75442002
DOT      EQU   C'.'                                              Y02668 76242002
T        EQU   C'T'                                              Y02668 77042002
R        EQU   C'R'                                              Y02668 77842002
A        EQU   C'A'                                              Y02668 78642002
BSIGN    EQU   X'0F'                                             Y02668 79442002
LEN3     EQU   3                                                 Y02668 80242002
LEN4     EQU   4                                                 Y02668 81042002
LEN5     EQU   5                                                 Y02668 81842002
LEN6     EQU   6                                                 Y02668 82642002
LEN8     EQU   8                                                 Y02668 83442002
RECNO    EQU   6                   RECORD NUMBER                 Y02668 84242002
SVALEN   EQU   3                   SWA VIRTUAL ADDR LENGTH       Y02668 85042002
DISPL20  EQU   20                                                Y02668 85842002
DISPL3   EQU   3                                                 Y02668 86642002
DISPL8   EQU   8                                                 Y02668 87442002
DISPL16  EQU   16                                                Y02668 88242002
         EJECT                                                          89042002
*****************************************************************Y02668 89842002
*                                                               *Y02668 90642002
*              DECLARED STORAGE                                 *Y02668 91442002
*                                                               *       92242002
*****************************************************************Y02668 93042002
IEFVDAV  DC    V(IEFVDA)           DD STMT PROCESSOR             Y02668 94642002
IEFVEAV  DC    V(IEFVEA)           EXEC STMT PROCESSOR           Y02668 95442002
IEFVJAV  DC    V(IEFVJA)           JOB STMT PROCLESSOR           Y02668 96242002
IEFVHHV  DC    V(IEFVHH)           CONTROL BLOCK PUT RTN         Y02668 97042002
IEFVHRV  DC    V(IEFVHR)           WTO RTN                       Y02668 97072002
IEFVGMV  DC    V(IEFVGM)           MSG RTN                       Y02668 97102002
*                                                                Y02668 97142002
*        C O N S T A N T S                                       Y02668 97242002
*                                                                Y02668 97342002
AOBLKNAM DC    CL8' '              8 BLANKS.                     Y02668 97442002
PGMERROR DC    X'0024'             PGM ERROR CODE (36)           Y02668 97642002
TXTBUFLT DC    H'8184'             MAX TXT REC LTH, BUFLTH-HDR.  YM1545 97742002
PATCH1   DC    25F'0'              ZAP SPACE                     Y02668 97842002
         END   IEFVHE                                                   98642002
./  ADD  SSI=43250002,NAME=IEFVHEB
*********************************************************************** 00020002
*                                                                       00029002
*   MODULE NAME= IEFVHEB                                                00038002
*                                                                       00047002
*   DESCRIPTIVE NAME= PRE-SCAN ROUTINE                                  00056002
*                                                                       00065002
*   COPYRIGHT= N/A                                                      00074002
*                                                                       00083002
*   STATUS= OS/VS2 RELEASE 2                                            00092002
*                                                                       00101002
*   FUNCTION= PERFORMS MISCELLANEOUS PRESCAN FUNCTIONS AND SMF          00110002
*             INITIALIZATION, AND ENTERS STATEMENTS (VIA IEFVGM) IN THE 00119002
*             LIST DATA SET                                             00128002
*      OPERATION= 1. CHECKS MSGLEVEL FLAGS AND ENTERS STATEMENT IN      00137002
*                    LIST DATA SET ACCORDING TO FLAG SETTINGS.          00146002
*                 2. CHECKS PRINT SWITCH TO SEE IF MODULE WAS ENTERED   00155002
*                    IN THE NORMAL FLOW, OR IS BEING USED AS A SUB-     00164002
*                    ROUTINE TO ENTER A STATEMENT IN THE LIST DATA SET. 00173002
*                 3. COMPUTES STATEMENT NUMBER AND ENTERS IT IN OUTPUT  00182002
*                    BUFFER PRIOR TO LISTING THE STATEMENT.             00191002
*                    CONTINUATIONS, COMMENTS, AND COMMANDS              00193002
*                    DO NOT HAVE STATEMENT NUMBERS;THEREFORE,           00195002
*                    NO COMPUTATION IS DONE.                            00197002
*                 4. IF A SYSCHK DD IS BEING PROCESSED, MODULE WILL     00200002
*                    OBTAIN STORAGE AND SAVE THE STATEMENT AND PASS     00209002
*                    INSTEAD, TO THE SCAN ROUTINE, A GENERATED EXEC     00218002
*                    STATEMENT FOR PROCESSING.                          00227002
*                 5. MOVES THE JMR FROM THE JESS WORK AREA TO THE CWA,  00236002
*                    DOES SOME INITIALIZATION, AND BRANCHES TO IEFUJV   00245002
*                    TO PERMIT USER SMF PROCESSING.                     00254002
*                                                                       00263002
*   NOTES=                                                              00272002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00281002
*      DEPENDENCIES= NONE                                               00290002
*      RESTRICTIONS= NONE                                               00299002
*      REGISTER CONVENTIONS=                                            00308002
*                            R5- POINTER TO JMR                         00317002
*                            R9- POINTER TO JCL STATEMENT               00326002
*                            RA- POINTER TO STATEMENT PARAMETER LIST    00335002
*                            RB- BASE REGISTER                          00344002
*                            RC- POINTER TO CWA                         00353002
*                            RD- SAVE AREA POINTER                      00362002
*      PATCH-LABEL= PATCH                                               00371002
*                                                                       00380002
*   MODULE TYPE= BAL                                                    00389002
*      PROCESSOR= ASSEMBLER                                             00398002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00407002
*                                                                       00416002
*   ENTRY POINT= IEFVHEB                                                00425002
*      PURPOSE= PRESCAN FUNCTIONS                                       00434002
*      LINKAGE= BRANCH ON REGISTER                                      00443002
*      INPUT DATA= JCL STATEMENT                                        00452002
*                  STATEMENT PARAMETER LIST                             00461002
*                  CONVERTER/INTERPRETER ENTRY LIST (NEL)               00470002
*                  CONVERTER WORK AREA                                  00479002
*                  R9- POINTS TO JCL STATEMENT                          00488002
*                  RA- POINTS TO STATEMENT PARAMETER LIST               00497002
*                  RC- POINTS TO CWA                                    00506002
*      REGISTERS SAVED= NONE                                            00515002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00524002
*      REGISTERS RESTORED= NONE                                         00533002
*                                                                       00542002
*   EXIT - NORMAL= IEFVFA                                               00551002
*      CONDITIONS= UNCONDITIONALLY (IF NOT USED AS STMT # SUBRTN)       00560002
*      OUTPUT DATA= INITIALIZED JMR                                     00569002
*                   GENERATED EXEC IF SYSCHK DD FOUND                   00578002
*                   MODIFIED STATEMENT IMAGE FOR STMT WITH PROC VERB    00587002
*      RETURN CODES= NONE                                               00596002
*                                                                       00598002
*   EXIT - NORMAL= CALLER                                               00600002
*      CONDITIONS= MSGLEVEL FLAGS INITIALIZED, PRINT SWITCH ON          00602002
*                  WHEN MODULE WAS ENTERED                              00604002
*      OUTPUT DATA= STMT NO. CALC AND STMT PRINTED IF MSGLEVEL=1        00604402
*      RETURN CODES= NONE                                               00604802
*                                                                       00605002
*   EXIT - ERROR= IEFVFA                                                00614002
*      CONDITIONS= UNCONDITIONALLY                                      00623002
*      OUTPUT DATA= INITIALIZED JMR                                     00632002
*                   ERROR MESSAGE WRITTEN TO MESSAGE DATA SET           00641002
*      RETURN CODES= NONE                                               00650002
*                                                                       00659002
*   EXTERNAL REFERENCES=                                                00668002
*      ROUTINES= BRANCH TO IEFVGM- WRITE JCL STATEMENT TO LIST DATA     00677002
*                                  SET, OR ERROR MESSAGE TO MESSAGE     00686002
*                                  DATA SET                             00695002
*      DATA AREAS= CONVERTER WORK AREA                                  00704002
*                  JCL STATEMENT                                        00713002
*                  STATEMENT PARAMETER LIST                             00722002
*      CONTROL BLOCKS= JMR, NEL, CWA                                    00731002
*      TABLES= NONE                                                     00740002
*      MACROS= IEFVMCWA, IEFJMR, IEFNEL                                 00749002
*      ENQUEUE RESOURCES= NONE                                          00758002
*      CHANGE LEVEL= NONE                                               00767002
*                                                                       00776002
*   MESSAGES= IEF611I OVERRIDDEN STEP NOT FOUND IN PROCEDURE            00785002
*                                                                       00794002
*********************************************************************** 00803002
         EJECT                                                          00812002
         IEFJMR                                                         00850018
         EJECT                                                          00860000
         IEFCOMWA                                                Y02668 00880002
         IEFCVRWA                                                Y02668 00910002
JCTD     DSECT                                                          00940000
         IEFAJCTB                                                       00960000
         IEFTXTFT                                                Y02668 00990002
NEL      DSECT                                                     AACA 01026017
         IEFNEL SUBCOM=C                                                01033002
         EJECT                                                          01040000
IEFVHEB  CSECT                                                          01060000
* C 012930,012960,014175-014193,024400 (10/21/74)              @OZ02100 01066003
* A 014175-014185 (10/21/74)                                   @OZ02100 01072003
*                   R9=STMT PTR                                         01080000
*                   RA=STMT PARM LIST PTR                               01100000
*                   RD=PTR TO CURRENT REG SAVE AREA                     01120000
         SPACE 1                                                 Y02668 01122002
ZONE     EQU   X'F0'                                             Y02668 01132102
BLANK    EQU   C' '                                              Y02668 01132202
EXEC     EQU   2                                                 Y02668 01132402
DD       EQU   4                                                        01132502
JOB      EQU   1                                                        01132602
STNLTH   EQU   10                  STMT # FIELD LENGTH           Y02668 01133402
STNBUFL  EQU   90                  STMT# + MSG LENGTH            Y02668 01133502
BUFL     EQU   STNBUFL-STNLTH      MSG LENGTH                    Y02668 01133602
MSG0B    EQU   11                                                Y02668 01138002
         BALR  RB,0                                                     01140000
         USING *,RB          *                                          01160000
         ST    RE,AOHEBSA          SAVE EXIT ADDR FOR RE RETURN. Y02668 01201002
*****************************************************************Y02668 01202002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01204002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01206002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01208002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01210002
         DC    C'VHEB'             MOD ID USED BY TRACE.         Y02668 01212002
* TRACE RETURNS HERE.                                            Y02668 01214002
*****************************************************************Y02668 01216002
         B     C2                                                       01220000
         MODID BR=NO                                             Y01886 01270001
         DC    C'SPLT'             FUNCTION ID AND               Y02668 01280002
         DC    C'07'               LEVEL # (STMT NUMBERING FIX). Y02668 01290002
         DC    C'REL3'              FUNCTION ID AND            @OZ02100 01293003
         DC    C'01'   LEV #(SMF EXIT ENTERED TOO MANY TIMES). @OZ02100 01296003
C2       DS    0H                                                       01300000
*                                                                Y02668 01300202
*    MOVE STMT INTO WRITE BUFFER; FIRST SIX BYTES OF BUFFER      Y02668 01300402
*    ARE FOR THE STMT NUMBER.                                    Y02668 01300602
*                                                                Y02668 01300802
         L     R1,AOWSTMT          GET BUFFER ADDR               Y02668 01301002
         MVI   0(R1),BLANK         BLANK OUT THE BUFFER          Y02668 01301202
         MVC   1(STNBUFL,R1),0(R1) BEFORE MOVING IN STMT         Y02668 01301402
         MVC   STNLTH(BUFL,R1),0(R9) MOVE STMT INTO BUFFER       Y02668 01301602
         TM    AOSW1,AOPRTSW       IS A PRINT OPERATION INDIC'D  Y02668 01301802
         BZ    AOEP0100            NO, CHECK FOR OVERRIDDEN STMT Y02668 01302002
         EJECT                                                          01302202
*************************************************************** YM03455 01303202
*                        PRINT SUBROUTINE                       YM03455 01304202
*         THIS SUBROUTINE RETURNS TO IEFVHEB'S CALLER           YM03455 01305202
*************************************************************** YM03455 01306202
         NI    AOSW1,255-AOPRTSW   YES, RE-INITIALIZE PRINT SW   Y02668 01307202
         TM    AOSW1,AOILGLOP      Q  A MESSAGE                  Y02668 01308202
         BZ    AOEP0010            NO, DO NOT INCRE STMT #       Y02668 01309202
         NI    AOSW1,255-AOILGLOP  RE-INITIALIZE SWITCH          Y02668 01310202
         LH    R1,WASTMTNO         YES,INCREASE STMT # COUNT     Y02668 01311202
         LA    R1,1(R1)            BY ONE                        Y02668 01312202
         STH   R1,WASTMTNO         SAVE UPDATED STMT NUMBER      Y02668 01313202
         L     RF,IEFVGMV          PUT MESSAGE OUT               Y02668 01314202
         BALR  RE,RF                                             Y02668 01315202
         BAL   RE,AOEPCVT          CONVERT AND STORE STMT #      Y02668 01316202
AOEP0010 DS    0H                                                Y02668 01317202
         TM    AOSW4,CWATERM       PROCESSING RDR NULL ?        YM03455 01318202
         BZ    AOEP0015            NO BYPASS SMF                YM03455 01319202
         BAL   R6,TRYSMF           GO TO SMF ROUTINE            YM03455 01320202
AOEP0015 DS    0H                                               YM03455 01321202
         TM    IWAJMSGL,AOMSGLV1+AOMSGLV2  MSGLEVEL= 1 OR 2 ?   YA02015 01322202
         BZ    AOEP0020            NO,DO NOT PRINT STMT          Y02668 01323202
         TM    SWE,GPI       INPUT READ FROM PROC?              YA02015 01324202
         BZ    AOEP0030            NO,PRINT STMT                 Y02668 01325202
         TM    IWAJMSGL,AOMSGLV2   MSGLEVEL=2?                   Y02668 01326202
         BO    AOEP0020            YES, DO NOT PRINT STMT        Y02668 01327202
AOEP0030 DS    0H                **PRINT STMT RTN                Y02668 01328202
         SR    R2,R2               SET LIST STMT CODE FOR VGM.   Y02668 01329202
         L     RF,IEFVGMV          MSG RTN ADDR                  Y02668 01330202
         BALR  RE,RF               GO TO PUT OUT STMT            Y02668 01331202
AOEP0020 DS    0H                **DO NOT PRINT,INSTEAD,RETURN   Y02668 01332202
         L     RF,AOHEBSA          LOAD RETURN ADDRESS.          Y02668 01333202
         BR    RF                  EXIT                          Y02668 01334202
         EJECT                                                          01335202
*************************************************************** YM03455 01336202
*            CONVERT & STORE STMT # ROUTINE                     YM03455 01337202
*************************************************************** YM03455 01338202
AOEPCVT  DS    0H                **CONVERT AND STORE RTN         Y02668 01339202
         LH    R6,WASTMTNO         GET NUMBER OF THIS STMT       Y02668 01340202
         CVD   R6,AOEPWORK         CONVERT STMT # TO DECIMAL     Y02668 01341202
         L     R5,AOWSTMT          R5 PTS TO WRITE BUFFER        Y02668 01342202
         UNPK  0(5,R5),AOEPWORK(8) UNPK STMT # INTO FIRST        Y02668 01343202
*                                  5 BYTES OF BUFFER             Y02668 01344202
         OI    4(R5),ZONE          CHANGE SIGN TO ZONE           Y02668 01345202
AOEPCVT1 DS    0H                                                Y02668 01346202
         CLI   0(R5),ZONE          CHECK FOR LEADING ZERO        Y02668 01347202
         BNE   AOEPCVT2            NO, BRANCH AROUND BLANKING    Y02668 01348202
         MVI   0(R5),BLANK         CHANGE LEADING ZERO TO BLANK  Y02668 01349202
         LA    R5,1(R5)            BUMP PTR                      Y02668 01350202
         B     AOEPCVT1            GO TO CHECK AGAIN             Y02668 01351202
AOEPCVT2 DS    0H                                                Y02668 01352202
         BR    RE                                                Y02668 01353202
         EJECT                                                          01354202
*************************************************************** YM03455 01355202
*                   PRE  SCAN  ROUTINE                          YM03455 01356202
*************************************************************** YM03455 01357202
AOEP0100 DS    0H                                                Y02668 01358202
         TM    CRSW1,CPFLG         C/R EXEC? (INTERNAL STMT).   YM00371 01359202
         BO    AOEP0500            BR, DO NOT UPDATE STMT #.    YM00371 01360202
         CLC   0(2,R9),AOEPOVR     OVERRIDDEN STMT?              Y02668 01361202
         BE    AOEP0500            YES, NO STMT # NEEDED         Y02668 01362202
         CLC   0(2,R9),AOEPOVR1   O'RIDDEN STMT FROM INSTR PROC YM02704 01363202
         BE    AOEP0500            YES NO STMT # NEEDED         YM02704 01364202
         TM    SWB,CXP             CONT. EXPECTED ?              Y02668 01365202
         BO    AOEP0500            YES DON'T INCR. STMT #       YM00370 01366202
         LH    R6,WASTMTNO         GET NUMBER OF LAST STMT       Y02668 01367202
         LA    R6,1(R6)            INCREMENT BY ONE              Y02668 01368202
         STH   R6,WASTMTNO         SAVE NUMBER OF CURRENT STMT   Y02668 01369202
         BAL   RE,AOEPCVT          CONVERT AND INSERT STMT #     Y02668 01370202
AOEP0500 DS    0H                **END OF STMT # PROCESSING      Y02668 01371202
         TM    VERB(RA),1               JOB                             01372202
         BO    C22                      BR YES                          01373202
         TM    CRSW1,CPFLG         Q. CKPT/REST FLAG ON            AACA 01374202
         BZ    C20                 NO, GOTO CHECK MSGLEVEL       Y02668 01375202
         LA    R0,CKPTLGT          AREA FOR DD STMT                AACA 01376202
         GETMAIN R,LV=(0)                                          AACA 01377202
         MVC   0(80,R1),0(R9)      SAVE SYSCHK DD STMT AND         AACA 01378202
         MVC   80(8,R1),0(RA)      SAVE STMT CONTROL DATA FOR SCAN AACA 01379202
         ST    R1,CPSTMTP           ADDR OF SAVE AREA              AACA 01380202
         MVC   0(CPSTMTED,R9),CPSTMTC BUILD EXEC STMT FOR CKPT     AACA 01381202
   MVC CPSTMTL(80-CPSTMTL,R9),CPSTMTL-1(R9)  BLK AREA LEFT         AACA 01382202
         MVI   NAMEL(RA),8         SET UP NAME LENGTH,             AACA 01383202
         MVI   VERB(RA),2           VERB ID AND                    AACA 01384202
         MVI   LISTPTR(RA),16       REL. LIST PTR OFFSET           AACA 01385202
         OI    SWH,CPSYSFLG        SET C/R EXEC FLAG               AACA 01386202
         B     C213                                                AACA 01387202
C20      DS    0H                                                  AACA 01388202
         TM    IWAJMSGL,AOMSGLV1   MSGLEVEL=1?                   Y02668 01389202
         BO    C23                      BR YES                          01400000
         TM    IWAJMSGL,AOMSGLV2   MSGLEVEL=2?                   Y02668 01406002
         BZ    C201                    LEVEL=0 - TRY SMF EXIT    A32886 01408020
         LA    R3,RSTMT                PTR TO ADDR OF RDR STMNT   M0528 01409018
         CR    R3,RA                   RA POINTS TO ADDR OF THE   M0528 01410018
*                                      BUFFER CURR BEING USED     M0528 01411018
         BE    C23                     IF EQUAL THIS CARD IS      M0528 01413018
*                                      FROM THE INPUT STREAM      M0528 01415018
*                                      GO PUT INTO SMB            M0528 01417018
C201     TM    SWB,CXPN       CONTINUATION EXPECTED BUT NOT    @OZ02100 01417503
*                                    RECEIVED?                 @OZ02100 01418103
         BO    C21            YES, DO NOT GO TO SMF USER EXIT  @OZ02100 01418703
         BAL   R6,TRYSMF             SMF USER EXIT AVAILABLE?  @OZ02100 01419303
C21      DS    0H                                                       01420000
         CLI   VERB(RA),8            **Q. PROC VERB                     01420814
         BNE   C213                  ** BR-NO                           01421614
         TM    SWB,CXP               CONT. OF PROC STMT           19253 01422217
         BO    C213                  BRANCH-YES                   19253 01422817
         CLI   LISTPTR(RA),71        **Q. NULL OPERANDS                 01423614
         BE    C212                  ** BRANCH - YES                    01425614
         SR    R4,R4                 **LOAD REL. LIST DISPL.            01428014
         IC    R4,LISTPTR(RA)        **                                 01428814
         SH    R4,CON4               **ADJUST REL. LIST                 01430414
         STC   R4,LISTPTR(RA)        ** PTR. FOR 'PROC,'                01431214
         AR    R4,R9                 **COMPUTE PROC NAME ADDRESS        01432214
         MVC   0(5,R4),PROCA         **INSERT PROC NAME IN OPERAND      01434214
         B     C216                  ** EXIT TO SCAN RTN                01438414
C212     DS    0H                    **                                 01438514
         LA    R4,16                 **ADJUST THE REL.                  01438614
         STC   R4,LISTPTR(RA)        ** LIST PTR.                       01438714
         AR    R4,R9                 **COMPUTE ADDRESS OF INSERTION     01438814
         MVC   0(4,R4),PROCA         ** AND MOVE PROC OPERAND           01438914
         B     C216                  **                                 01439014
C213     DS    0H                    **                                 01439214
         TM    VERB(RA),SSE+CRE    DD STMT SEQ. ERROR              AACA 01449217
         BNZ   C217                 BR YES                         AACA 01459217
         B     C216                GO TO VFA EXIT                Y02668 01529202
         EJECT                                                          01559202
*********************************************************************** 01600618
*        SMF OPTION                                                SMF1 01601218
*********************************************************************** 01601818
TRYSMF   EQU   *                       *                           SMF1 01602418
         L     R5,WANELPTR         LOAD NEL ADDRESS.             Y02668 01603002
         USING NEL,R5              NEL ADDRESSABILITY.           Y02668 01603402
         TM    NELOPSWT,NELSMF     SMF  REQUESTED?               Y02668 01603802
         BCR   8,R6                BRANCH NO.                    Y02668 01604202
         L     R5,CWAJMRPT         LOAD JMR ADDRESS.             Y02668 01604602
         DROP  R5                                                Y02668 01605002
         USING JMR,R5              JMR ADDRESSABILITY.           Y02668 01605402
         L     RF,JMRUJVP          LOAD USER EXIT ADDR, IF ANY.  Y02668 01605702
         TM    JMROPT,JMREXITS     HAS A USER EXIT BEEN REQUESTEDY02668 01606002
         BCR   IFZERO,R6           NO, RETURN                    Y02668 01606602
         LA    R1,JMRPTRS              GET ADDR OF PARAM LIST      SMF1 01607218
         LA    R4,JMRJOB               GET ADDR OF JOB LOG         SMF1 01607818
         ST    R4,JMRJOBP              STORE JOB LOG ADDR IN       SMF1 01608418
*                                           PARAM LIST             SMF1 01609018
         ST    R9,JMRJCLP              STORE ADDR OF CARD IMAGE    SMF1 01609618
         MVC   JMRJCLCD(DEC1),VERB(RA) PUT VERB CODE IN LIST     Y02668 01610202
         NI    JMRJCLCD,ERBITOFF   CLEAR ALL BITS EXCEPT THOSE   Y02668 01610402
*                                  INDICATING VERB CODE          Y02668 01610602
         LA    R4,JMRJCLCD         GET PTR TO VERB CODE          Y02668 01610802
         ST    R4,JMRJCLCP         SAVE PTR IN PARMLIST          Y02668 01611002
         LA    R4,LISTPTR(RA)          POINT TO OPERAND OFFSET     SMF1 01611418
         ST    R4,JMRJCLCP+DEC4        *                           SMF1 01612018
         L     RF,JMRUJVP          GET PTR TO USER EXIT          Y02668 01612302
         BALR  RE,RF                   GO TO USER ROUTINE          SMF1 01612618
         L     R1,AOWSTMT          GET BUFFER ADDR              YM03455 01612702
         MVC   STNLTH(BUFL,R1),0(R9) UPDATE BUFFER TO REFLECT   YM03455 01612802
*                                  POSSIBLE USER UPADTE         YM03455 01612902
         LA    R4,DEC4                 *                           SMF1 01613218
         CR    RF,R4                   CHECK FOR JOB CANCEL        SMF1 01613818
         BCR   DEC7,R6                 *                           SMF1 01614418
         LA    R5,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 01615002
         USING TEXT,R5             PREFIX ADDRESSABILITY.        Y02668 01615402
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 01615802
         DROP  R5                                                Y02668 01616202
         BR    R6                      *                           SMF1 01616818
C217     DS    0H                                                       01680000
         LA    R2,MSG59            SET UP C/R ERROR MESSAGE        AACA 01685017
         TM    VERB(RA),CRE        Q. C/R ERROR                    AACA 01690017
         BO    C218                 BR YES                         AACA 01695017
         NI    VERB(RA),255-SSE         SEQ ERR OFF                     01700000
         LA    R2,MSG0B                *OVERRIDDEN STEP                 01720000
C218     DS    0H                                                  AACA 01726017
         NI    VERB(RA),255-CRE    CLEAR C/R ERROR FLAG            AACA 01732017
         L     R5,IEFVGMV          LOAD BRANCH ADDR FOR MSG.     Y02668 01740002
         B     C2161                                             Y02668 01770002
C22      DS    0H                                                       01800000
         TM    SWB,CXP                  JOB STMT CONTINUATION           01820000
         BO    C23                      BR YES                          01840000
         NI    SWD,255-FEXRCV           1ST EXEC RCVD OFF               01860000
         LA    R5,WAJBNAME         SET WAJBNAME AS TARGET FIELD. Y02668 01861002
         BAL   RE,AOMVJBNM         MOVE JOBNAME TO WAJBNAME.     Y02668 01862002
         B     C225                                              Y02668 02176002
C225     DS    0H                                                       02300000
         SR    R2,R2                    SET FOR MSG ROUTINE             02320000
         BAL   R6,TRYSMF               *                           SMF1 02321018
DEC4     EQU   4                       NUMERIC EQUATE                   02322018
DEC8     EQU   8                       NUMERIC EQUATE                   02323018
DEC7     EQU   7                       NUMERIC EQUATE                   02324018
DEC5     EQU   5                       NUMERIC EQUATE                   02325018
HEX60    EQU   X'60'                   HEX EQUATE                       02326018
DEC3     EQU   3                       NUMERIC EQUATE                   02327018
DEC20    EQU   20                      NUMERIC EQUATE                   02328018
DEC1     EQU   1                       NUMERIC EQUATE                   02329018
HEX01    EQU   X'01'                   HEX EQUATE                       02330018
HEX40    EQU   X'40'                   HEX EQUATE                       02331018
DEC11    EQU   11                      NUMERIC EQUATE                   02332018
DEC0     EQU   0                       NUMERIC EQUATE                   02333018
DEC2     EQU   2                       NUMERIC EQUATE                   02334018
         L     RF,IEFVGMV                                               02340000
         BALR  RE,RF                    STMT TO SMB                     02360000
         B     C21                                                 AACA 02368017
C23      DS    0H                                                       02400000
         TM    SWB,CXPN                 CONT NOT RCVD                   02420000
         BO    C216                    BRANCH YES              @OZ02100 02440003
         TM    SWB,CXPC                 CANCELLED                       02460000
         BZ    C225                     BR NO                           02480000
         CLI   2(R9),C' '         COL 3 BLANK                      AABA 02490016
         BNE   C225               BRANCH NO                        AABA 02500016
         CLC   3(68,R9),2(R9)     4 TO 71 BLANK, NULL              AABA 02510016
         BNE   C225               BRANCH NO                        AABA 02520016
C24      EQU   *                                                        02526018
         TM    IWAJMSGL,AOMSGLV1   MSGLEVEL=1?                   Y02668 02532002
         BZ    C216                NO, ALREADY BEEN TO TSTSMF    Y02668 02538002
         BAL   R6,TRYSMF               YES, GO TO SMF                   02544018
C216     DS    0H                                                Y02668 02552602
         L     R5,IEFVFAV          LOAD BRANCH ADDR FOR SCAN.    Y02668 02552702
C2161    DS    0H                                                Y02668 02552802
C2160    DS    0H                                                Y02668 02557502
         LR    RF,R5               MOVE BRANCH ADDR TO BR REG.   Y02668 02557902
         L     RE,IEFVFAV          LOAD RETURN TO SCAN IN CASE   Y02668 02558302
         BR    RF                  BRANCH IS TO MSG MODULE.      Y02668 02558702
         EJECT                                                   Y02668 02559102
*****************************************************************Y02668 02559602
*                                                               *Y02668 02560102
*        AOMVJBNM BLANKS  OUT AN 8 BYTE TARGET FIELD AND THEN   *Y02668 02560602
*        MOVES THE JOBNAME INTO IT.                             *Y02668 02561102
*                                                               *Y02668 02561602
*        INPUT -                                                *Y02668 02562102
*           R5 - ADDRESS OF TARGET FIELD.                       *Y02668 02562602
*           R9 - ADDRESS OF CARD IMAGE.                         *Y02668 02563102
*           RA - ADDRESS OF STATEMENT PARAMETER LIST (RSTMT).   *Y02668 02563602
*                                                               *Y02668 02564102
*        NOTE -                                                 *Y02668 02564602
*           R1 IS USED AS A WORK REGISTER AND ITS CONTENTS      *Y02668 02565102
*           ARE NOT SAVED.                                      *Y02668 02565602
*                                                               *Y02668 02566102
*****************************************************************Y02668 02566602
         SPACE 2                                                 Y02668 02567102
AOMVJBNM DS    0H                                                Y02668 02567602
         MVC   0(8,R5),AOBLKNAM    BLANK THE TARGET FIELD.       Y02668 02568102
         SR    R1,R1               CLEAR LTH REG.                Y02668 02568602
         IC    R1,NAMEL(RA)        LOAD JOBNAME LTH.             Y02668 02569102
         LTR   R1,R1               LENGTH = 0?                   Y02668 02569602
         BZ    AOMVJ090            BRANCH YES TO EXIT.           Y02668 02570102
         C     R1,AOMAXLTH         LENTH EXCEED MAX OF 8?        Y02668 02570602
         BNH   AOMVJ010            BRANCH NO.                    Y02668 02571102
* LENGTH EXCEED MAX OF 8.                                        Y02668 02571602
         LA    R1,8                SET DEFAULT OF 8. JOBNAME     Y02668*02572102
                                   ERRORS WILL BE CAUGHT LATER.  Y02668 02572602
AOMVJ010 DS    0H                                                Y02668 02573102
         BCTR  R1,0                DECREMENT LTH FOR MOVE.       Y02668 02573602
         EX    R1,AOEXMOV          EXECUTE MOVE OF JOBNAME.      Y02668 02574102
AOMVJ090 DS    0H                                                Y02668 02574602
         BR    RE                  RETURN.                       Y02668 02575102
         SPACE 2                                                 Y02668 02575602
AOEXMOV  MVC   0(0,R5),2(R9)       EXECUTED MOVE OF JOBNAME.     Y02668 02576102
AOBLKNAM DC    CL8' '              8 BLANKS.                     Y02668 02576602
AOMAXLTH DC    F'8'                CONSTANT FOR MAX JOBNAME LTH. Y02668 02577102
         EJECT                                                   Y02668 02577602
IEFVFAV  DC    V(IEFVFA)           SCAN ROUTINE.                 Y02668 02578102
IEFVGMV  DC    V(IEFVGM)                MSG                             02580000
IEFVHQV  DC    V(IEFVHQ)                Q MGR LINK                      02620000
IEFVHAV  DC    V(IEFVHA)           CONVERTER GET RTN             Y02668 02622002
AOEPOVR  DC    C'X/'               OVERRIDDEN STMT SYMBOL        Y02668 02624002
AOEPOVR1 DC    C'+/'      O'RIDDEN STMT FROM INSTR PROC         YM02704 02625002
CON4     DC    H'5'                  **CONSTANT                         02626014
AOTBUFL  DC    H'4000'             TEXT BUF LENGTH.              Y02668 02628002
PROCA    DC    C'PROC,'              **PROC NAME CONSTANT               02632014
CPSTMTC  DC    C'//IEFDSDRP EXEC PGM=IEFDSDRP ' GEND C/R EXEC.   Y02668 02634002
CPSTMTS  EQU   *                                                   AACA 02638017
CPSTMTED EQU   CPSTMTS-CPSTMTC                                     AACA 02640017
CPSTMTL  EQU   L'CPSTMTC           LTH OF GEN'D EXEC STMT.       Y02668 02642002
CKPTLGT  EQU   88                  AREA NEEDED FOR SYSCHK SAVEAREA AACA 02644017
CPSTMTP  EQU   IWAJOBS5            SYSCHK DD STMT SAVE AREA PTR    AACA 02646017
MSG59    EQU   59                  MISPLACED SYSCHK DD STMT        AACA 02648017
*                                   ERROR MESSAGE INDEX            AACA 02650017
         SPACE 1                                                 Y02668 02652002
INPUTA   EQU   40                  INPUT QUEUE 'A' QMPA INDICATORA44202 02654001
IFZERO   EQU   8                                                 Y02668 02654602
ERBITOFF EQU   X'0F'                                             Y02668 02655202
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 02656002
         END                                                            02660000
./  ADD  SSI=71300328,NAME=IEFVHF
*********************************************************************** 00020000
*                                                                       00070002
*  MODULE NAME - IEFVHF                                                 00120002
*                                                                       00170002
*  DESCRIPTIVE NAME - CONVERTER TERMINATION ROUTINE                     00180002
*                                                                       00182002
*  COPYRIGHT - N/A                                                      00182402
*                                                                       00182802
*  STATUS - OS/VS2 RELEASE 3.0 AND 3.7 PTF                     @ZA16823 00183203
*                                                                       00183602
*                                                                     * 00280000
*  FUNCTION - THIS ROUTINE FREES AREAS GOTTEN BY THE INITIALIZATION     00290002
*             ROUTINE, ISSUES MESSAGES TO THE OPERATOR INDICATING       00292002
*             JOB STATUS AT THE END OF CONVERSION, AND SETS A RETURN    00294002
*             CODE FOR THE CONVERTER'S CALLER.   IT ALSO PROCESSES      00296002
*             THE SYSCHK DD AND EXITS TO THE PRE SCAN RTN(IEFVHEB).     00298002
*             IT ALSO ENSURES THAT TEXT IS COMPLETE FOR A STMT.         00298102
*                                                                       00298402
*             THE ESTAE ENVIRONMENT IS CANCELLED IN THIS ROUTINE.       00298502
*                                                                       00298802
*     OPERATION -                                                       00299202
*               .IF TERMINATION IS TO BE PERFORMED, CHECK IF A          00349202
*                WARNING MSG HAS BEEN ISSUED.   IF YES ISSUE WTO        00399202
*                TO JESS JOB LOG.   IF A JCL ERROR, ISSUE WTO           00449202
*                AND SET R15 TO 4.   IF AN I/O ERROR SET R15 TO 8.      00499202
*                IF JOB SUCCESSFUL SET R15 TO 0.                        00499602
*                   MOVE QMPA BACK TO CALLER'S CORE.   MOVE JMR BACK    00503602
*                BACK TO CALLER'S(JESS) CORE.   FREE JMR AND LOCAL      00504802
*                WORK AREA CORE.CANCEL THE ESTAE ENVIRONMENT.           00506002
*               .FREE WORK AREA FOR INSTREAM PROCEDURES, IF    @ZA16823 00506103
*                THERE IS ONE.                                 @ZA16823 00506203
*                FREE THE CONVERTER'S GOTTEN CORE IN SP0. RESET         00506402
*                R1 TO POINT TO NEL AND EXIT TO CONVERTER'S CALLER      00507202
*               .IF TERMINATION NOT TO BE PERFORMED, IS CHECKPOINT      00508602
*                RESTART FLAG ON.   IF YES , REINSTATE SYSCHK DD        00510602
*                STMT AND EXIT TO IEFVHEB.                              00512602
*               . CHECK IF CONTINUATION EXPECTED.   IF YES, EXIT        00513002
*                TO IEFVHA TO READ THE NEXT CARD SO TEXT CAN BE         00513202
*                COMPLETED.                                             00563102
*               .IF CONTINUATION CANCELLED EXIT TO IEFVHA TO GET        00613102
*                NEXT STMT.                                             00663102
*               .IF CONTINUATION EXPECTED AND NOT RECV'D EXIT TO        00713102
*                IEFVHCB.                                               00763102
*                                                                       00813102
*                                                                       00815102
*  NOTES -                                                              00817102
*     CHARACTER CODE DEPENDENCIES - EBCDIC                              00819102
*     DEPENDENCIES - NONE                                               00819502
*     RESTRICTIONS - NONE                                               00819902
*     REGISTER CONVENTIONS - R11 - BASE REG                             00826602
*                            R12 - PTR TO CONVERTER WORK AREA           00828602
*                            R13 - PTR TO REG SAVE AREA                 00830602
*     PATCH-LABEL - PATCH                                               00832602
*                                                                       00833002
*                                                                       00833102
*  MODULE TYPE - BAL CSECT                                              00833202
*     PROCESSOR - ASSEMBLER                                             00839902
*     ATTRIBUTES - REFRESHABLE, REENTRANT, PRIVILEGED, KEY 0, PAG LPA   00841902
*                                                                       00843902
*                                                                       00845902
*  ENTRY POINT - IEFVHF FROM IEFVFA                                     00846302
*     PURPOSE - TO TERMINATE CONVERTER OR COMPLETE TEXT                 00846402
*     LINKAGE - BALR                                                    00846502
*     INPUT -                                                           00853202
*            REG 12 - PTR TO CONVERTER WORK AREA                        00855202
*            REG 13 - PTR TO REG SAVE AREA                              00857202
*     REGISTERS SAVED - NONE                                            00859202
*     REGISTERS USED IN PROCESSING -                                    00859302
*                        R0 - R2 - WORK REGS                            00859402
*                             R3 - LOCAL WORK AREA BASE                 00859502
*                        R4 - R7 - UNUSED                               00859602
*                             R8 - PSEUDO JOB PREFIX                    00860102
*                             R9 - STMT PTR                             00860602
*                            R10 - STMT PTR                             00861002
*                            R11 - MODULE BASE REG                      00861402
*                            R12 - PTR TO CONVERTER WORK AREA           00861802
*                            R13 - PTR TO REG SAVE AREA                 00862202
*                            R14 - LINKAGE AND WORK REG                 00862302
*                            R15 - LINKAGE AND WORK REG                 00862402
*     REGISTERS RESTORED - R14 - R12                                    00862602
*  EXIT-NORMAL - CONVERTER'S CALLER(JESS)                               00863602
*     CONDITIONS - TERMINATION COMPLETE                                 00864602
*     OUTPUT - REG 1 - PTR TO NEL, REG 15 - RETURN CODE                 00865602
*     RETURN CODES - 0 -SUCCESSFUL                                      00866602
*                    4 -JCL ERROR                                       00868502
*                    8 -I/O ERROR                                       00870502
*                                                                       00872502
*                                                                       00872902
*  EXIT-NORMAL - IEFVHA                                                 00873302
*     CONDITIONS - CONTINUATION EXPECTED OR CANCELLED                   00873402
*     OUTPUT - REG 12 - PTR TO CWA, REG 13 - PTR TO RSA                 00873502
*     RETURN CODES - NONE                                               00875602
*                                                                       00877602
*                                                                       00879602
*  EXIT-NORMAL - IEFVHCB                                                00879702
*     CONDITION  - CONTINUATION NOT RECEIVED                            00879802
*     OUTPUT - REG 12 - PTR TO CWA                                      00879902
*     RETURN CODES - NONE                                               00885602
*                                                                       00887602
*                                                                       00889602
*  EXIT-NORMAL - IEFVHEB                                                00890002
*     CONDITIONS - SYSCHK DD TO BE REINSTATED                           00890402
*     OUTPUT - REG 12 - PTR TO CWA                                      00890802
*     RETURN CODES - NONE                                               00891202
*                                                                       00891302
*                                                                       00891402
*  EXIT - ERROR - NONE                                                  00892002
*                                                                       00892402
*  EXTERNAL REFERENCES -                                                00892802
*     ROUTINES - IEFVHR                                                 00893202
*     DATA AREAS - CWA, LWA, I/O BUFFERS, QMPA                          00893302
*     CONTROL BLOCKS - JMR, NEL, QMPA                                   00894902
*     TABLES - NONE                                                     00896902
*     MACROS - IEFJMR, GETMAIN, FREEMAIN, DELETE,                       00897302
*                                                                       00897702
*     CHANGE LEVEL - Y02668,OZ10816,OZ16823                    @ZA16823 00898103
*                                                                       00901503
*                                                                       00902503
*  MESSAGES - IEF607I  JOB HAS NO STEPS                                 00903502
*                                                                       00905502
*********************************************************************** 00908802
         EJECT                                                          00914002
         IEFCOMWA                                                Y02668 00919202
         IEFCVRWA                                                Y02668 00924202
         IEFVMCWA                                                       00929602
         EJECT                                                          00930402
NEL      DSECT                                                          00931202
         IEFNEL SUBCOM=C,EXITS=(TXT,RTN,QEP,SMF,IAM,FAM)                00932002
         EJECT                                                          00932802
         IEFTXTFT                                                       00933602
         IEFJMR                                                  Y02668 00934202
         DCBD  DSORG=(PS)                                        Y02668 00934402
         IEFZB9RD                                                Y02668 00934602
         EJECT                                                          00934802
IEFVHF   CSECT                                                          00940000
* CODE ADDED NEAR LABEL VHF0050                                @ZA10816 00960003
* CODE ADDED AFTER LABEL VHFNOTRC                              @ZA16823 00970003
         BALR  RB,0                                                     00980000
         USING *,RB                                                     01000000
*****************************************************************Y02668 01002002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01004002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01006002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01008002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01010002
         DC    C'VHF '             MOD ID USED BY TRACE.         Y02668 01012002
* TRACE RETURNS HERE.                                            Y02668 01014002
*****************************************************************Y02668 01016002
         B     C6                                                       01020000
         MODID BR=NO                                             Y01886 01070001
*        DC    C'SPLT'             FUNCTION ID AND               Y02668 01080003
*        DC    C'03'               LEVEL NUMBER (C/I LOGIC)      Y02668 01130003
*        DC    C'MVM'              FUNCTION ID                   Y02668 01180003
*        DC    C'23'   LEV # (DD * OVERRIDE FIX-VS02712).       YM02712 01230003
*        DC    C'01'   LEV # (ZERO BUFFER ADDR AFTER FREEING)  @ZA10816 01280003
         DC    C'02'   LEV # (FREE INSTREAM PROC WK AREA IF ANY@ZA16823 01330003
C6       DS    0H                                                Y02668 01900002
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.      YM01572 02000002
         USING TEXT,R8             PREFIX ADDRESSABILITY.       YM01572 02100002
         TM    AOSW4,CWATERM       SHOULD THE CONVERTER BE       Y02668 02300002
*                                  TERMINATED                    Y02668 02700002
         BZ    VHFRESRT            NO, GO TO CHECK IF RESTART    Y02668 03100002
         EJECT                                                          03500002
*****************************************************************Y02668 03510002
*                                                               *Y02668 03520002
*  SMF USER EXIT AT END OF CONVERSION                           *Y02668 03530002
*                                                               *Y02668 03540002
*****************************************************************Y02668 03550002
         L     R3,WANELPTR         GET PTR TO NEL                Y02668 03560002
         USING NEL,R3              ADDRESS NEL                   Y02668 03570002
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 03580002
         BZ    VHF0005             NO, DON'T BOTHER WITH EXIT    Y02668 03590002
         L     R2,CWAJMRPT         GET JMR PTR                   Y02668 03600002
         USING JMR,R2              ADDRESS JMR                   Y02668 03610002
         TM    JMROPT,JMREXITS     IS A USER EXIT REQUESTED      Y02668 03620002
         BZ    VHF0005             NO, THEN DON'T TAKE ONE       Y02668 03630002
         LA    R1,JMRPTRS          GET ADDR OF PARMLIST          Y02668 03640002
         LA    RE,JMRJOB           GET ADDR OF JOB LOG           Y02668 03650002
         ST    RE,JMRJOBP          AND PUT IT IN PARMLIST        Y02668 03660002
         MVI   JMRJCLCD,EXCODE     SET EXIT CODE TO INDICATE     Y02668 03670002
*                                  END OF CONVERSION             Y02668 03680002
         LA    RE,JMRJCLCD         GET PTR TO EXIT CODE AND      Y02668 03690002
         ST    RE,JMRJCLCP         PUT IT IN THE PARMLIST        Y02668 03700002
         L     RF,JMRUJVP          GET USER EXIT RTN ADDR        Y02668 03710002
         BALR  RE,RF               GO TO SMF USER EXIT           Y02668 03720002
*                                                                Y02668 03730002
         LA    R2,JCLERROR         GET ERROR RETCODE VALUE       Y02668 03740002
         CR    RF,R2               DOES USER WANT TO CANCEL      Y02668 03750002
         BNE   VHF0005             NO, CONTINUE                  Y02668 03760002
*  YES, FAIL JOB.                                                Y02668 03770002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED FLAG.          Y02668 03776002
VHF0005  DS    0H                  END OF SMF USER EXIT          Y02668 03780002
         EJECT                                                   Y02668 03790002
*****************************************************************Y02668 04240002
*                                                               *Y02668 04300002
*                                                               *Y02668 04700002
*  TERMINATION - RETURN CODE PROCESSING                         *Y02668 05100002
*                                                               *Y02668 05500002
*****************************************************************Y02668 05900002
         SPACE 2                                                 Y02668 06300002
VHF0010  DS    0H                                                Y02668 06700002
         L     R1,WORD(RD)         PICK UP PTR TO REG SAVE AREA  Y02668 07100002
*                                  OF CONVERTER'S CALLER         Y02668 07500002
         CL    R1,CWASAVPT         IS THIS, IN FACT, THE CORRECT Y02668 07900002
*                                  SAVE AREA PTR(SAVED ON ENTRY  Y02668 08300002
*                                  BY VH1)                       Y02668 08700002
         BE    VHF0020             YES, CONTINUE TERMINATION     Y02668 09100002
*                                  NO, FREE EXCESS RSA AND CHECK Y02668 09500002
         IEFRELSE  ,               NEXT BACWARD CHAIN PTR        Y02668 09900002
         B     VHF0010             GO BACK AND CHECK AGAIN       Y02668 10300002
VHF0020  DS    0H                **RETURN CODE PROCESSING        Y02668 10700002
         L     R1,WORD(RD)         ADDRESS CALLER'S RSA          Y02668 11100002
         XC    SAVERF(WORD,R1),SAVERF(R1) ZERO RETURN CODE REG INY02668 11300002
*                                  CALLER'S SAVE AREA            Y02668 11500002
         CLC   IWARET(2),IOERROR   TEMP *****                    Y02668 11900002
         BL    VHF0030             NO, CHECK FOR JCL ERROR       Y02668 12300002
         MVC   SAVERF+2(HALFWORD,R1),IWARET INITIALIZE CALLER'S  Y02668 12700002
*                                  REG15 TO RETURN CODE          Y02668 13100002
         B     VHF0040                                           Y02668 13500002
VHF0030  DS    0H                                                Y02668 13900002
         TM    STRJINDC,JTXJOBFL   DOES JOB HAVE A JCL ERROR     Y02668 14300002
         BZ    VHF0040             NO, THEREFORE, JOB IS         Y02668 14700002
*                                  SUCCESSFUL AND REG15=0        Y02668 15100002
         MVI   SAVERF+3(R1),JCLERROR INDICATE JCL ERROR IN CALLERY02668 15500002
         DROP  R8                                                Y02668 15700002
*                                  R15                           Y02668 15900002
         LA    R5,IEF452I          GET JCL ERROR MSG KEY         Y02668 16000002
         L     RF,IEFVHRV          GET WTO ROUTINE ADDR          Y02668 16100002
         BALR  RE,RF               GO TO ISSUE WTO               Y02668 16200002
         EJECT                                                   Y02668 16300002
*****************************************************************Y02668 16700002
*                                                               *Y02668 17100002
*  EXIT LIST PROCESSING   - WTO  PROCESSING                     *Y02668 17500002
*                                                               *Y02668 17900002
*****************************************************************Y02668 18300002
VHF0040  DS    0H                                                Y02668 18700002
         EJECT                                                   Y02668 19100002
*****************************************************************Y02668 19500002
*                                                               *Y02668 19900002
* RE-INITIALIZE QMPA AND JMR IN CORE OF CONVERTER'S CALLER      *Y02668 20300002
* DELETE IEFUJV                                                 *YM0581 20500002
*                                                               *Y02668 20700002
*****************************************************************Y02668 21100002
         SPACE 2                                                 Y02668 21500002
         L     R3,WANELPTR         GET PTR TO NEL                Y02668 21900002
         USING NEL,R3              ADDRESS NEL                   Y02668 22300002
         L     RE,NELQMPA          GET PTR TO QMPA IN CALLER'S   Y02668 22700002
*                                  CORE                          Y02668 23100002
         MVC   NONE(QMPALEN,RE),QPARM PUT QMPA BACK              Y02668 23500002
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 23900002
         BZ    VHF0050             NO, BYPASS JMR PROCESSING     Y02668 24300002
         L     RE,NELJMR           GET PTR TO JMR IN CALLER'S    Y02668 24700002
*                                  CORE                          Y02668 25100002
         L     RF,CWAJMRPT         GET PTR TO JMR IN             Y02668 25500002
*                                  CONVERTER'S CORE              Y02668 25900002
         LTR   RF,RF               ALREADY FREED IF ZERO       @ZA10816 25950003
         BZ    VHF0050             BYPASS FREEMAIN IF ZERO     @ZA10816 26000003
         MVC   NONE(JESSJMR,RE),NONE(RF) PUT JMR BACK            Y02668 26300002
         LR    R1,RF               GET ADDR OF JMR GOTTEN CORE   Y02668 26400002
         LA    R0,TABLEN           GET LENGTH OF CORE            Y02668 26500002
         FREEMAIN R,LV=(0),A=(1)   FREE CORE JMR WAS IN          Y02668 26600002
         XC    CWAJMRPT,CWAJMRPT   ZERO PTR SO WON'T FREE IF RETRY      26610003
*                                                              @ZA10816 26620003
         DELETE EP=IEFUJV          DELETE USER ROUTINE.         YM00581 26650002
VHF0050  DS    0H                                                Y02668 26700002
         EJECT                                                   Y02668 27100002
*****************************************************************Y02653 27120002
*                                                                Y02653 27140002
*  DEACTIVATE THE ESTAE ENVIRONMENT OVER THE CONVERTER.          Y02653 27160002
*                                                                Y02653 27180002
*****************************************************************Y02653 27200002
         SPACE 1                                                        27220002
         L      R1,AOSTAPRM    LOAD ESTAE USER PARAM ADDR        Y02653 27240002
         LTR   R1,R1         WAS ESATE ACTIVE IN CONVERTER       Y02653 27260002
         BZ    VHFBYPAS    IF POINTER ZERO THEN ESTAE WAS NOT    Y02653 27280002
*              ACTIVE IN CONVERTER.BYPASS CANCELLING IT          Y02653 27300002
         LA    R0,EREPLEN          LENGTH OF USER PARM AREA      Y02668 27306002
         FREEMAIN R,LV=(0),A=(1)   ESTAE ACTIVE SO FREE PARM AREAY02668 27312002
         XC    AOSTAPRM,AOSTAPRM   ZERO PTR AFTER BUFFER FREED @ZA10816 27316003
         ESTAE 0                                                 Y02653 27320002
         SPACE 1                                                        27340002
*        THE ESTAE ENVIRONMENT IS NOW CANCELLED.                 Y02653 27400002
VHFBYPAS DS    0H                                                Y02653 27420002
         EJECT                                                          27440002
*****************************************************************Y02668 27500002
*                                                               *Y02668 27900002
*  FREE ALL OF THE CONVERTERS WORKING STORAGE AND EXIT          *Y02668 28300002
*                                                               *Y02668 28700002
*****************************************************************Y02668 29100002
         SPACE 2                                                 Y02668 29500002
         L     R3,WANELPTR         GET PTR TO NEL                Y02668 29900002
         USING NEL,R3              ADDRESS NEL                   Y02668 29940002
         L     R0,CWALINKL         GET LENGTH FOR POSSIBLE FREE YM00373 29945002
         LTR   R0,R0               POST SCAN EXIT AREA ?        YM00373 29950002
         BZ    VHFNOPSE            NO DO NOT FREE AREA          YM00373 29955002
         L     R1,CWALINK          GET PTR TO POST SCAN AREA    YM00373 29960002
         FREEMAIN R,LV=(0),A=(1)   FREE POST SCAN EXIT AREA     YM00373 29965002
VHFNOPSE DS    0H                                               YM00373 29970002
         L     RF,NELPROCB         GET PROCLIB DCB PTR           Y02668 29980002
         LTR   RF,RF               WAS A PROCLIB SPECIFIED       Y02668 30020002
         BZ    VHFNOPRC            NO, THEN A PROC BUFFER WASN'T Y02668 30060002
*                                  GOTTEN                        Y02668 30100002
         USING IHADCB,RF           IF YES, GE TPROC BUFFER       Y02668 30140002
         LH    R0,DCBBLKSI         LENGTH OUT OF DCB(MAX BLKSI)  Y02668 30180002
         L     R1,PSTMT            GET ADDR OF PROC BUFFER       Y02668 30220002
         FREEMAIN R,LV=(0),A=(1)   FREE PROC BUFFER              Y02668 30260002
VHFNOPRC DS    0H                                                Y02668 30300002
         L     R1,BUFADDR          GET 'TRACE ' RTN BUFFER ADDR  Y02668 30305002
         LTR   R1,R1               WAS 'TRACE' ACTIVE?           Y02668 30310002
         BZ    VHFNOTRC            NO, GO TO FREE OTHER WORK AREAY02668 30315002
         LH    R0,BUFLTH           YES, GET BUFFER LENGTH        Y02668 30320002
         FREEMAIN R,LV=(0),A=(1)   FREE THE 'TRACE' BUFFER       Y02668 30325002
VHFNOTRC DS    0H                                                Y02668 30330002
         L     R1,IWAWKBF         GET ADDR OF INSTREAM PROC    @ZA16823 30331003
*                                  WORK AREA IF ANY            @ZA16823 30332003
         LTR   R1,R1              IS THERE A WORK AREA?        @ZA16823 30333003
         BZ    VHFNOINP           NO, BYPASS FREEMAIN          @ZA16823 30334003
         LA    R0,WORKLN          LENGTH OF INSTREAM PROC AREA @ZA16823 30335003
         FREEMAIN R,LV=(0),A=(1)  FREE INSTREAM PROC WORK AREA @ZA16823 30336003
VHFNOINP EQU   *                  NO INSTREAM PROC BRCH TARGET @ZA16823 30337003
         LR    R1,RC               GET ADDR OF LARGE AREA GOTTEN Y02668 30340002
*                                  AT INITIALIZATION             Y02668 30380002
         L     R0,WAWRKLTH         GET LENGTH OF COMBINED        Y02668 30420002
*                                  WORK AREAS                    Y02668 30460002
         FREEMAIN R,LV=(0),A=(1)   FREE CONVERTER WORK AREAS     Y02668 30500002
         IEFRELSE  ,               RELEASE CONVT SAVE AREA       Y02668 30540002
         RETURN (14,12)            RETURN TO CONVERTER'S CALLER  Y02668 30700002
         EJECT                                                   Y02668 31100002
*****************************************************************Y02668 31500002
*                                                               *Y02668 31900002
*  CHECK POINT RESTART PROCESSING                               *Y02668 32300002
*                                                               *Y02668 32700002
*****************************************************************Y02668 33100002
         SPACE 2                                                 Y02668 33500002
VHFRESRT DS    0H                                                Y02668 33900002
         TM    CRSW1,CPFLG         HAS A SYSCHK DD STMT BEEN     Y02668 34300002
*                                  ENCOUNTERED                   Y02668 34700002
         BZ    VHFCONTU            NO, CHECK IF  CONTINUATION    Y02668 35100002
         L     R9,RSTMT            GET PTR TO JCL D. S. INPUT    Y02668 35500002
*                                  BUFFER.THIS IS THE BUFFER     Y02668 35900002
*                                  INTO WHICH THE SYSCHK DD      Y02668 36300002
*                                  STMT IS TO BE RE-ENSTATED     Y02668 36700002
         LA    RA,RSTMT            GET PTR TO PARMLIST           Y02668 37100002
*                                  DISCRIBING STMT               Y02668 37500002
         L     RF,CPSTMTP          GET PTR TO SYSCHK DD STMT     Y02668 37900002
*                                  PREVIOUSLY SAVED BY VHEB      Y02668 38300002
         MVC   NONE(RECLEN,R9),NONE(RF) RE-ENSTATE SYSCHK DD     Y02668 38700002
*                                  IN JCL D. S. INPUT BUFFER     Y02668 39100002
         MVC   WORD(WORD,RA),SPARMLOC(RF) REINITIALIZE STMT      Y02668 39500002
*                                  PARM LIST INFO SO SYSCHK DD   Y02668 39900002
*                                  CAN BE PROCESSED AS IF IT     Y02668 40300002
*                                  WERE JUST READ FROM JCL D. S. Y02668 40700002
         NI    CRSW1,255-CPFLG     CLEAR RESTART FLAG            Y02668 41100002
         L     RF,IEFVHCBV         ADDR OF TEXT WRITE RTNE.     YM00371 41500002
         BR    RF                  WRITE C/R EXEC TEXT,         YM00371*41700002
                                   PROCESS SYSCHK DD.           YM00371 41900002
         EJECT                                                   Y02668 42300002
*****************************************************************Y02668 42700002
*                                                               *Y02668 43100002
*  THE FOLLOWING PROCESSING INSURES THAT,FOR A PARTICULAR JCL   *Y02668 43500002
*  STMT, THE INTERNAL TEXT STRING IS COMPLETE.  IT MAKES SURE   *Y02668 43900002
*  CONTINUATIONS AND OVERRIDES ARE NOT OUTSTANDING              *Y02668 44300002
*                                                               *Y02668 44700002
*****************************************************************Y02668 45100002
         SPACE 2                                                        45500002
VHFCONTU DS    0H                                                Y02668 45900002
         TM    SWE,GPI             IS A PROCEDURE STMT          YM00370 45930002
*                                  BEING PROCESSED              YM00370 45960002
         BZ    VHF0021             NO, ASSUME JCL D.S. STMT     YM00370 45990002
         LA    RA,PSTMT            YES, POINT AT PROCEDURE STMT YM00370 46020002
         B     VHF0041             PARM LIST                    YM00370 46050002
VHF0021  DS    0H                                               YM00370 46080002
         LA    RA,RSTMT            POINT AT JCL STMT PARMLIST   YM00370 46110002
VHF0041  DS    0H                                               YM00370 46140002
         L     R9,NONE(RA)         POINT TO BUFFER OF STMT      YM00370 46170002
*                                  BEING PROCESSED              YM00370 46200002
VHF0060  DS    0H                                                Y02668 53900002
         TM    SWB,CXPN            WAS CONTINUATION EXPECTED     Y02668 54300002
*                                  AND NOT RECEIVED              Y02668 54700002
         BZ    VHF0070             NO, CHECK FOR CONT. CANCEL    Y02668 55100002
         NI    SWB,255-CXPN        YES, CLEAR FLAG               Y02668 55500002
         B     VHFVHCB             EXIT TO VERB ID TO PROCESS    Y02668 55900002
*                                  CURRENT STMT                  Y02668 56300002
VHF0070  DS    0H                                                Y02668 56700002
         TM    SWB,CXPC            WAS CONTINUATION EXPECTED     Y02668 57100002
*                                  AND CANCELED                  Y02668 57500002
         BZ    VHFVHA              NO, GOTO GET ANOTHER STMT     Y02668 57900002
         NI    SWB,255-CXPC        CLEAR FLAG                    Y02668 58300002
         B     VHFVHA              GO TO GET ANOTHER STMT       YM00370 58700002
         EJECT                                                   Y02668 64300002
*****************************************************************Y02668 64700002
*                                                               *Y02668 65100002
*                        EXITS                                  *Y02668 65500002
*                                                               *Y02668 65900002
*****************************************************************Y02668 66300002
         SPACE 2                                                 Y02668 66700002
VHFVHA   DS    0H                  EXIT TO CONVERTER GET RTN     Y02668 67100002
         L     RF,IEFVHAV          LOAD AND                      Y02668 67500002
         BR    RF                  GO                            Y02668 67900002
VHFVHEB  DS    0H                  EXIT TO CONVERTER PRE-SCAN RTNY02668 68300002
         L     RF,IEFVHEBV         LOAD AND                      Y02668 68700002
         BR    RF                  GO                            Y02668 69100002
VHFVHCB  DS    0H                  EXIT TO CONVERTER VERB ID RTN Y02668 69500002
         L     RF,IEFVHCBV         LOAD AND                      Y02668 69900002
         BR    RF                  GO                            Y02668 70300002
*****************************************************************Y02668 70700002
*                                                               *Y02668 71100002
*                          EQUATES                              *Y02668 71500002
*                                                               *Y02668 71900002
*****************************************************************Y02668 72300002
         SPACE 2                                                        72700002
WORD     EQU   4                                                        73900002
SAVERF   EQU   16                                                       74700002
HALFWORD EQU   2                                                        75100002
JCLERROR EQU   4                                                        75500002
NONE     EQU   0                                                        75900002
QMPALEN  EQU   32                                                       76300002
EXCODE   EQU   X'10'          SMF EXIT CODE - CONVERSION OVER    Y02668 76700002
JESSJMR  EQU   56             SUBSYSTEM JMR LENGTH               Y02668 76900002
ZERO     EQU   X'00'                                                    79900002
RECLEN   EQU   80                  RECORD LENGTH                 Y02668 80300002
SPARMLOC EQU   84                  STMT PARMLIST LOCATION        Y02668 80700002
CPSTMTP  EQU   IWAJOBS5                                          Y02668 81100002
BLANK    EQU   C' '                                              Y02668 81500002
COL4     EQU   3                                                 Y02668 81900002
NULLEN   EQU   68                                                Y02668 82300002
IEF452I  EQU   6                   JCL ERROR MSG KEY             Y02668 82310002
TABLEN   EQU   X'50'               LTH OF AREA OBTAINED FOR JMR.YM01556 82330002
MSG7     EQU   7                   JOB HAS NO STEPS MSG CODE     Y02668 82430002
WORKLN   EQU   352               INSTREAM PROC WORK AREA LENGTH@ZA16823 82480003
*****************************************************************Y02668 82700002
*                                                               *Y02668 83100002
*  DECLARED  STORAGE                                            *Y02668 83500002
*                                                               *Y02668 83900002
*****************************************************************Y02668 84300002
IEFVHEBV DC    V(IEFVHEB)          PRE-SCAN RTN                  Y02668 84700002
IEFVGMV  DC    V(IEFVGM)           SYSOUT MSG RTN                Y02668 84900002
IEFVHCBV DC    V(IEFVHCB)          VERB ID RTN                   Y02668 85100002
IEFVHAV  DC    V(IEFVHA)           GET RTN                       Y02668 85500002
IEFVHRV  DC    V(IEFVHR)           WTO RTN                       Y02668 85700002
IOERROR  DC    X'0008'                                                  85900002
BUFLTH   DC    H'2048'             'TRACE' BUFFER LENGTH         Y02668 86100002
PATCH    DC    25F'0'              ZAP SPACE                     Y02668 86300002
         END   IEFVHF                                                   86700002
./  ADD  SSI=72160237,NAME=IEFVHH
        TITLE 'IEFVHH'                                                  00020020
*********************************************************************** 00040002
*                                                                       00048002
*   MODULE NAME= IEFVHH                                                 00056002
*                                                                       00064002
*   DESCRIPTIVE NAME= ENQUEUE ROUTINE                                   00072002
*                                                                       00080002
*   COPYRIGHT= N/A                                                      00088002
*                                                                       00096002
*   STATUS= OS/VS2 RELEASE 3.7 SU04 PTF                        @ZA19982 00104040
*                                                                       00112002
*   FUNCTION= 1. WRITES JOB AND STEP TABLES TO SWA                      00120002
*             2. PERFORMS MISCELLANEOUS CLEANUP FUNCTIONS               00128002
*      OPERATION= 1. CHECKS IF ALL EXEC OVERRIDES HAVE BEEN COMPLETED   00136002
*                    AT PROCEDURE END OF FILE, AND FAILS THE JOB IF     00144002
*                    ANY REMAIN.                                        00152002
*                 2. DELETED                                    YM04952 00160002
*                 3. PROVIDES SMF SUPPORT BY BRANCHING TO USER'S        00168002
*                    ROUTINE AND CHECKING THE RETURN CODE, AND ENTERING 00176002
*                    INTERPRETER STOP TIME IN THE JMR.                  00184002
*                    THE JSCB ACTIVE POINTER IN THE TCB IS      YM04108 00184502
*                    SWITCHED BEFORE GOING TO THE USER EXIT.    YM04108 00185002
*                    THE ACTUAL ACTIVE JSCB ADDRESS IS REPLACED YM04108 00185502
*                    WITH THE INITIATOR'S JSCB ADDRESS(ALWAYS   YM04108 00186002
*                    THE FIRST JSCB IN THE CHAIN.).THIS ALLOWS  YM04108 00186502
*                    THE USER EXIT TO USE A DATA SET DEFINED IN YM04108 00187002
*                    THE INITIATOR PROC.                        YM04108 00187502
*                    THE ORIGINAL ACTIVE JSCB POINTER IS PUT    YM04108 00188002
*                    BACK INTO THE TCB UPON RETURN FROM THE     YM04108 00188502
*                    USER EXIT.                                 YM04108 00189002
*                    IF AN ABEND OCCURS WHILE THE POINTER IS    YM04108 00189502
*                    SWITCHED,THE INTERPRETER RECOVERY ROUTINE  YM04108 00190002
*                    IEFNB9IT WILL SWITCH IT BACK..             YM04108 00190502
*                 4. WRITES APPROPRIATE JOB AND STEP TABLES TO SWA AS   00192002
*                    INDICATED BY SWITCH SETTINGS.                      00200002
*                 5. DELETED                                    YM04952 00208002
*                 6. CLEARS THE SCT.                                    00224002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00232002
*      DEPENDENCIES= NONE                                               00240002
*      RESTRICTIONS= NONE                                               00248002
*      REGISTER CONVENTIONS=                                            00256002
*                            R6- SWA MANAGER PARMLIST POINTER           00264002
*                            R7- SCT POINTER                            00272002
*                            R8- JCT POINTER                            00280002
*                            R9- STATEMENT POINTER                      00288002
*                            RA- POINTER TO STATEMENT PARAMETER LIST    00296002
*                            RB- BASE REGISTER                          00304002
*                            RC- IWA POINTER                            00312002
*                            RD- SAVE AREA POINTER                      00320002
*      PATCH-LABEL= PATCH                                               00328002
*                                                                       00336002
*   MODULE TYPE= BAL                                                    00344002
*      PROCESSOR= ASSEMBLER                                             00352002
*      ATTRIBUTES= NCAL, LET,LIST,XREF,RENT,REFR                        00360002
*                                                                       00368002
*   ENTRY POINT= IEFVHH                                                 00376002
*      PURPOSE= JOB AND STEP ENQUEUE PROCESSING                         00384002
*      LINKAGE= BRANCH ON REGISTER                                      00392002
*      INPUT DATA= INTERPRETER WORK AREA                                00400002
*                  RC- POINTS TO IWA                                    00408002
*                  JCT, SCT, JMR, QMPA, NEL                             00416002
*      REGISTERS SAVED= NONE                                            00424002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00432002
*      REGISTERS RESTORED= NONE                                         00440002
*                                                                       00448002
*   EXIT - NORMAL= BRANCH TO IEFVHN                                     00536002
*      CONDITIONS= SWITCH JCTRTN IS ON AND JOB HAS NOT BEEN FAILED      00544002
*      OUTPUT DATA= ALL JOB TABLES WRITTEN TO SWA                       00552002
*      RETURN CODES= NONE                                               00560002
*                                                                       00568002
*   EXIT - ERROR= BRANCH TO IEFVHN                                      00672002
*      CONDITIONS= SWITCH JCTRTN IS ON AND JOB HAS BEEN FAILED          00680002
*      OUTPUT DATA= ALL JOB TABLES WRITTEN TO SWA                       00688002
*                   IF ERROR FOUND IN IEFVHH, ERROR MSG WRITTEN         00696002
*                            TO MESSAGE DATA SET                        00704002
*      RETURN CODES= NONE                                               00712002
*                                                                       00720002
*   EXTERNAL REFERENCES=                                                00768002
*      ROUTINES= BRANCH TO IEFVGM- WRITE ERROR MESSAGE TO MSG DATA SET  00776002
*                BRANCH TO IEFVHQ- WRITE JOB TABLES TO SWA              00784002
*                                                                       00792002
*      DATA AREAS= INTERPRETER WORK AREA                                00800002
*      CONTROL BLOCKS= JCT, SCT, CVT, NEL, ACT, DSNT, DSENQT, QMPA,JCTX 00808040
*      TABLE= WORKAREA                                                  00816002
*                                                                       00824002
*      MACROS= IEFVMIWA, IEFAJCTB, IEFASCTB, IEFJMR, IEFQMNGR, IEFNEL,  00832002
*              CVT                                                      00840002
*      ENQUEUE RESOURCES= NONE                                          00848002
*                                                                       00864002
*   MESSAGES= IEF611I OVERRIDDEN STEP NOT FOUND IN PROCEDURE            00872002
*             IEF661I  RESTART STEP NOT FOUND                           00876002
*             IEF686I  DDNAME REFERRED TO NOT DEFINED IN STEP  @ZA19982 00878040
*                                                                       00880002
*   CHANGE LEVEL = Z40MPTH, Z40RPSM, ZA19982                            00882040
*                                                                       00884040
*********************************************************************** 00888002
         EJECT                                                          00896002
         IEFJMR                                                         00930018
         EJECT                                                          00940000
         IEFCOMWA                                                       00960002
         IEFVMIWA                                                       00980002
JCTD     DSECT                                                          01000000
         IEFAJCTB                                                       01020000
SCTD     DSECT                                                          01040000
         IEFASCTB                                                       01060000
         IEFQMNGR                                                       01080000
         EJECT                                                          01140000
*                                 NEL DSECT FOLLOWS               M0780 01144020
NEL      DSECT                                                          01148020
         IEFNEL SUBCOM=I                                         Y02668 01152002
         IEFVMCWA                                                       01154002
CVTDSECT DSECT                                                          01154402
         CVT                                                            01154802
         IEZJSCB                                                        01155202
         IKJTCB                                                         01155602
         EJECT                                                          01156020
IEFVHH   CSECT                                                          01190020
* CODE ADDED AFTER LABEL DEC255                                @ZA19982 01200040
         BALR  RB,0                                                     01214820
         USING *,RB          *                                          01220000
         USING IOPARAMS,R6   *                                          01240000
         USING SCTD,R7       *                                          01260000
         USING JCTD,R8       *                                          01280000
*****************************************************************Y02668 01282002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01284002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01286002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01288002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01290002
         DC    C'VHH '             MOD ID USED BY TRACE.         Y02668 01292002
* TRACE RETURNS HERE.                                            Y02668 01294002
*****************************************************************Y02668 01296002
         B     D1                                                       01300000
         MODID BR=NO                                             Y01886 01350001
         DC    C'REL4'              FUNCTION ID AND            @Z40MPTH 01373040
*        DC    C'02'   LEV # (RACF)                            @Z40RPSM 01376040
         DC    C'03'   LEV # (DD REFERRED TO NOT DEFINED)      @ZA19982 01377040
D1       DS    0H                                                       01380000
         LA    R6,QPARM                Q PARM LIST                      01400000
         L     R5,QMPCL                 WORK AREA FOR Q PARMS           01420000
         XC    CLFOUR(CLFOUR,R5),CLFOUR(R5)     CLEAR Q-MGR      Y02621 01440002
*              QMPA PARAM LIST BLOCK POINTER BY ZEROING IT.      Y02621 01450002
         L     RF,CTRLWAP          ADDRESS OF LOCAL WORK AREA.  YM02714 01452002
         USING CWA,RF              WORK AREA ADDRESSABILITY.    YM02714 01454002
         XC    MSGKEY(1),MSGKEY    CLEAR SEC MSG CODES, IF ANY. YM02714 01456002
         DROP  RF                                               YM02714 01458002
         LA    R8,JCT                  JCT BASE                         01460000
         L     RA,IEFVHQV                                               01480000
         TM    SWA,SCTTQ               SCT TO NQ                   7586 01509215
         BZ    D4                       BR NO                           01520000
         TM    SWE,PROC           EXEC FROM A PROCEDURE...?      Y02668 01540002
         BO    D11                YES,CONTINUE PROCESSING,       Y02668 01560002
         TM    SWE,POVRX                EXEC ORIDES COMPLETE            01600000
         BZ    D11                      BR YES                          01620000
*  NOT ALL EXEC OVERRIDES RESOLVED - ERROR CONDITION.           YM02714 01626002
         NI    SWE,255-POVRX       CLEAR EXEC OVERRIDE SW.      YM02714 01632002
         OI    JCTJSTAT,INCMSTS         FAIL JOB                        01640000
         LH    R4,WASTMTNO         SAVE CURRENT STMT NBR.       YM02714 01645002
         MVC   WASTMTNO(2),IWAEXPNO MOVE IN EXEC PROC STMT NBR  YM02714*01650002
                                   FOR THIS MSG.                YM02714 01655002
         LA    R2,MSG11                 EXEC ORIDE NOT FOUND            01660000
         L     RF,IEFVGMV                                               01680000
         BALR  RE,RF                    PUT MSG                         01700000
         STH   R4,WASTMTNO         REPLACE CURRENT STMT NBR.    YM02714 01710002
D11      DS    0H                                                       01720000
         TM    SWC,DSNTQ                DSN TO NQ                       01940000
         BZ    D16                      BR NO                           01960000
         LA    R4,DSNAME               DSN TABLE BASE                   01980000
         ST    R4,0(0,R5)               STORE PTR TO DSN IN WORK AREA   02000000
         MVC   4(3,R5),0(R4)            TTR TO WORK AREA+4              02020000
         MVI   QMPOP,QMWRTE             WRITE ONLY                      02040000
         BALR  RE,RA                    DSN TO Q                        02060000
D16      DS    0H                                                       02080000
         LA    R7,SCT                  SCT BASE                         02140000
         TM    AOSW2,AOMAXERR      HAS NUMBER OF STATIC DD'S     Y02668 02142002
*                                 EXCEEDED THE MAXIMUM           Y02668 02144002
         BO    VHH170              YES, DON'T BOTHER ADDING      Y02668 02146002
*                                  THE DYNAMIC DD COUNT TO THE   Y02668 02148002
*                                 STATIC DD COUNT                Y02668 02150002
         LH    RE,SCTLALOC         GET THE NUMBER OF STATIC DD'S Y02668 02152002
         AH    RE,SCTNIUSL         ADD STATIC AND DYNAMIC DD     Y02668 02154002
*                                  COUNTS                        Y02668 02156002
         LH    RF,MAXDDS           GET MAX COUNT ALLOWABLE       Y02668 02158002
         CLR   RE,RF               HAS THE MAX BEEN EXCEEDED     Y02668 02160002
         BH    VHH160              YES, USE MAX AND WARN         Y02668 02162002
         STH   RE,SCTNIUSL         NO, SAVE TOTAL IN SCT         Y02668 02164002
         B     VHH170              CONTINUE                      Y02668 02166002
VHH160   DS    0H                                                Y02668 02168002
         STH   RF,SCTNIUSL         USE MAXIMUM - THIS, IN EFFECT,Y02668 02170002
*                                  REDUCES THE NUMBER OF DYNAMIC Y02668 02172002
*                                  DD'S REQUESTED                Y02668 02174002
         LA    R2,MAXDDMSG         WARNING MSG - DYNAMIC DD'S   YM01901 02176002
*                                  REDUCED                      YM01901 02177002
         L     RF,IEFVGMV          ADDR OF MSG RTN               Y02668 02178002
         BALR  RE,RF               PUT OUT WARNING MSG           Y02668 02180002
VHH170   DS    0H                                                Y02668 02182002
         NI    SWC,255-DSNTQ            DSN SW OFF               Y02668 02193002
         NI    SWH,255-CPSYSFLG    CLEAR C/R EXEC STMT FLAG        AACA 02292017
         CLC   SCTAFACT(3),D3ZERO   *ACT TTR EQUAL ZERO.                02300000
         BNE   D16A               *NO.  ACT HAS BEEN PUT OUT.           02320000
         MVI   QMPOP,QMASGN      * ASSIGN TTR FOR ACT.                  02340000
         MVI   QMPCM,X'10'         SET ASSIGN OF 1 RECORD.      YM02717 02350002
         BALR  RE,RA             *                                      02360000
         XC    DSNAME(176),DSNAME  USE TABLE AREA FOR ACT BUILD.YM04952 02380002
         MVC   DSNAME(3),0(R5)     * MOVE IN ACT TTR.            Y02668 02400002
         MVI   DSNAME+3,X'01'      * SET ACT ID.                 Y02668 02420002
         MVC   4(4,R5),0(R5)     * MOVE TTR TO PARM FIELD.              02440000
         MVC   SCTAFACT(3),0(R5) * MOVE TTR TO SCT.                     02460000
         MVI   QMPOP,QMWRTE      * SET TO WRITE ONLY.                   02480000
         LA    R9,DSNAME         *                               Y02668 02500002
         ST    R9,0(R5)          * SET ACT ADDRESS.                     02520000
         BALR  RE,RA             * LINK TO PUT OUT ACT.                 02540000
D16A     DS    0H                *                                      02560000
         ST    R7,0(0,R5)               STORE PTR TO SCT IN WORK AREA   02580000
         MVC   4(3,R5),SCTDISKA         TTR IN WORK AREA+4              02600000
         MVC   SCTANSCT(3),TNEXT        CHAIN TO NEXT SCT               02620000
         TM    SWA,JCTTQ                LAST STEP THIS JOB              02640000
         BZ    D17                      BR NO                           02660000
         MVI   QMPOP,QMWRTE             WRITE ONLY                      02680000
         XC    SCTANSCT(3),SCTANSCT     CLEAR CHAIN PTR                 02700000
D17      DS    0H                                                       02720000
*********************************************************************** 02721018
*   SMF OPTION                                                     SMF1 02722018
*********************************************************************** 02723018
         L     R4,WANELPTR         GET PTR TO NEL                Y02668 02724002
         USING NEL,R4              ADDRESS THE NEL               Y02668 02724602
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 02725202
         BZ    D17A                NO, BYPASS SMF PROCESSING     Y02668 02725802
         L     R4,IWAJMRPT         YES, GET JMR PTR              Y02668 02726402
         USING JMR,R4                                                   02727018
         TM    SWA,JCTTQ               JCT TO N Q                       02728018
         BO    D17A1                   YES,DON'T UP STP CT.             02729018
         SR    R2,R2                   *                           SMF1 02730018
         IC    R2,JMRSTEP              *                           SMF1 02731018
         LA    R2,DEC1(R2)             *                           SMF1 02732018
         STC   R2,JMRSTEP              INCREMENT STEP COUNT        SMF1 02733018
D17A1    EQU   *                       *                                02734018
         L     R2,SCTSMF               SYSIN CT                    SMF1 02735018
         A     R2,JMRJOBIN             *                           SMF1 02736018
         ST    R2,JMRJOBIN             TOTAL FOR JOB               SMF1 02737018
D17A     BALR  RE,RA                   SCT TO Q                    SMF1 02738018
         XC    SCTSMF(4),SCTSMF        CLEAR STEP SYSIN COUNT      SMF1 02748018
*                                  IN SCT FOR NEXT STEP          Y02668 02756002
         MVC   TNEXT,0(R5)              NEW TTR, GARBAGE IF LAST STEP   02760000
*****************************************************************Y01113 02770001
*        * PRIOR TO AOS/AM0 RELEASE DDSWX1 WAS ZEROED IN AN XC   Y01113 02772001
*        * INSTRUCTION ALONG WITH 78 BYTE DNRT.                  Y01113 02774001
*        * NEXT INSTRUCTION ADDED TO PREVENT NEW BITS FROM BEING Y01113 02776001
*        * OFF ALONG WITH CLEARING OF DDNAME REF SW & TABLE.     Y01113 02778001
*****************************************************************Y01113 02778401
DEC78    EQU   78                 DDNAME REFERENCE TABLE LENGTH  Y01113 02778501
DEC255   EQU   255                DECIMAL EQUATE                 Y01113 02789401
         NI    DDSWX1,DEC255-SDDNSW-IWASCAT2 SET SWITCHES OFF.   Y02668 02794502
         LA    R1,DNRT        ADDRESS OF DDNAME TABLE          @ZA19982 02794840
         LA    RF,DEC5        SET LOOP FOR 5                   @ZA19982 02795140
D30      DS    0H                                              @ZA19982 02795440
         OC    0(8,R1),0(R1)  COMPARE ENTRY TO ZERO            @ZA19982 02795740
         BNZ   D6                                              @ZA19982 02796040
         LA    R1,14(R1)      INCREMENT TO NEXT ENTRY          @ZA19982 02796340
         BCT   RF,D30         LOOP BACK                        @ZA19982 02796640
         B     D4             TABLE EMPTY,ALL NAMES DEFINED    @ZA19982 02796940
D6       DS    0H                                              @ZA19982 02797240
         XC    DNRT(DEC78),DNRT  CLEAR DDNAME REF TABLE        @ZA19982 02797540
         LA    R2,MSG686      SET UP CODE FOR IEF686I          @ZA19982 02797840
         L     RF,IEFVGMV     LOAD MSG MODULE ADDRESS          @ZA19982 02798140
         BALR  RE,RF          GO TO PUT OUT MESSAGE            @ZA19982 02798440
D4       DS    0H                                                       02860000
         TM    SWA,JCTTQ                JCT TO NQ                       02880000
         BO    D41                      BR YES                          02900000
D4A      DS    0H                                                A45375 02908801
         NI    SWA,255-SCTTQ       INDICATE SCT HAS BEEN PUT TO  Y02668 02910002
*                                  SWA                           Y02668 02913002
         L     RF,IEFVHEV          GO TO PROCESS NEXT STEP       Y02668 02916002
         BR    RF                  HOUSEKEEPING ROUTINE            AAAA 02920015
D41      DS    0H                                                       02940000
         L     R4,DSENQTP               ADDR OF DSENQ TABLE IF          02960000
         LTR   R4,R4                         NON-ZERO MUST BE PUT OUT   02980000
         BZ    D414                     ZERO. DO NOT PUT OUT     Y02668 03000002
         TM    SWD,DBFST          US THERE DSENQ TABLE FOR THIS JOB.292 03020000
         BO    D414               NO.  BYPASS ASSIGN.            Y02668 03040002
         MVI   QMPOP,QMASGN            *ASSIGN ONLY                     03060000
         BALR  RE,RA                   *                                03080000
         MVC   TNEXT,0(R5)             *NEW TTR                         03100000
         ST    R4,0(0,R5)         *DSENQ PTR TO REMOTE LIST             03120000
         MVC   0(3,R4),TNEXT            TTR TO DSENQ TABLE              03140000
         MVC   JCTDETDA(3,R8),TNEXT     SAME TTR TO JCT                 03160000
         MVC   4(3,R5),TNEXT            TTR FROM TABLE TO WORKAREA+4    03180000
         MVI   QMPOP,QMWRTE       *INDICATE WRITE ONLY                  03200000
         BALR  RE,RA                                                    03240000
         EJECT                                                          03360502
*****************************************************************Y02668 03360802
*                                                               *Y02668 03361102
*    SMF USER EXIT - PRIOR TO PUTTING THE JCT TO SWA            *Y02668 03361402
*                                                               *Y02668 03361702
*****************************************************************Y02668 03362002
*                                                               YM04952 03362302
D414     DS    0H                                               YM04952 03362402
         L     R4,WANELPTR         GET PTR TO NEL                Y02668 03362602
         USING NEL,R4              ADDRESS NEL                   Y02668 03362902
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 03363202
         BZ    D415A               NO, BYPASS PUTTING JMR TO SWA Y02668 03363502
         L     R4,IWAJMRPT         GET JMRPTR                    Y02668 03363802
         USING JMR,R4             ADDRESS JMR                    Y02668 03364102
         TM    JMROPT,JMREXITS    IS A USER EXIT REQUESTED?     Y02668  03364202
         BZ    D415B              NO,THEN PUT JMR TO SWA..      Y02668  03364302
         L     R3,CVTPTR          ADDRESS OF CVT                YM04108 03364402
         USING CVTMAP,R3                                                03364502
         L     R3,CVTTCBP         ADDRESS OF DOUBLEWORD POINTER YM04108 03364602
*                                FOR CURRENT AND OLD TCBS.      YM04108 03364702
         DROP  R3                                                       03364802
         L     R3,CURRTCB(R3)    ADDRESS OF CURRENT TCB...      YM04108 03364902
         USING TCB,R3                                           YM04108 03365002
         L     R3,TCBJSCB         ADDRESS OF FIRST JSCB OFF TCB YM04108 03365102
         DROP  R3                                                       03365202
         ST    R3,IWAJSCBF        STORE ADDRESS FOR LATER USE.  YM04108 03365302
         USING IEZJSCB,R3                                       YM04108 03365402
         L     R1,JSCBACT         ADDRESS OF ACTIVE JSCB        YM04108 03365502
         ST    R1,IWAJSCBA        STORE ADDRESS FOR LATER USE.  YM04108 03365602
         MVC   JSCBACT(4),IWAJSCBF  MAKE FIRST JSCB ACTIVE JSCB.YM04108 03365702
         DROP  R3                                                       03365802
         LA    R1,JMRPTRS              GET ADDR OF PARAM LIST      SMF1 03366018
         LA    R3,JMRJOB               GET ADDR OF JOB LOG         SMF1 03366518
         ST    R3,JMRJOBP              STORE JOB LOG ADDR IN       SMF1 03367018
*                                           PARAM LIST             SMF1 03367518
         MVI   JMRJCLCD,JCTSMFEX   SET EXIT CODE IN PARMLIST     Y02668 03368002
         LA    R3,JMRJCLCD             *                           SMF1 03368518
         ST    R3,JMRJCLCP             TERMINATION STATUS          SMF1 03369018
         L     RF,JMRUJVP    GET ADDRESS OF USER EXIT RTN..      Y02668 03369902
         BALR  RE,RF              GO TO SMF USER EXIT..            SMF1 03370002
         L     R3,IWAJSCBF        PTR TO FIRST JSCB OFF TCB.    YM04108 03370102
         USING IEZJSCB,R3                                       YM04108 03370202
         MVC   JSCBACT(4),IWAJSCBA   RESET ACTIVE JSCB POINTER  YM04108 03370302
         DROP  R3                                                       03370402
         SR    R3,R3              ZERO REGISTER 3               YM04108 03370502
         ST    R3,IWAJSCBF        SET FIRST JSCB POINT TO ZERO  YM04108 03370602
         ST    R3,IWAJSCBA        SET ACTIVE JSCB PTR TO ZERO.  YM04108 03370702
         LA    R2,DEC4                 *                           SMF1 03371018
         CR    RF,R2                   CHECK FOR CANCELLATION      SMF1 03371518
         BNE   D415B                   NO CANCEL                   SMF1 03372518
CANCENQ  EQU   X'04'                   *                           SMF1 03373018
         OI    JCTJMROP+DEC1,CANCENQ   MARK CANC IN JCT            SMF1 03373518
         OI    JCTJSTAT,INCMSTS        SET JOB CANCELLED BIT       SMF1 03374018
D415B    ST    R4,DEC0(DEC0,R5)        PTR TO JMR IN WORK AREA     SMF1 03374518
         MVC   DEC4(DEC3,R5),JCTJMR    MOVE JMR TTR TO WORK AREA   SMF1 03375018
         MVI   DISPLID(R5),JMRID       BLOCK ID TO REMOTE LIST   Y02621 03375202
         MVI   QMPOP,QMWRTE            WRITE ONLY                  SMF1 03375518
         BALR  RE,RA                   JMR TO Q                    SMF1 03377018
         MVI   DISPLID(R5),DEC0    CLEAR BLOCK ID IN SWA MANGR   Y02668 03378002
*                                  WORK AREA                     Y02668 03379002
DEC1     EQU   1                       NUMERIC EQUATE                   03380518
DEC4     EQU   4                       NUMERIC EQUATE                   03386518
DEC0     EQU   0                       NUMERIC EQUATE                   03389518
DEC3     EQU   3                       NUMERIC EQUATE                   03392518
DEC16    EQU   16                                                       03395518
D415A    DS    0H                                                Y02668 03395902
         L     RE,WANELPTR         LOAD NEL ADDRESS.             Y02668 03396102
         USING NEL,RE              NEL ADDRESSABILITY.           Y02668 03396302
         TM    NELOPSWT,NELRECVY   MSGS TO BE SUPPRESSED?        Y02668 03396702
         DROP  RE                                                 M3144 03398320
         BZ    D40                 BYPASS SETTING SUPPRESS BIT.  Y02668 03398702
         OI    JCTSTAT2,JCTSWSM  SET SUPPRESS WARM START MSG BIT  M3144 03399120
D40      DS    0H                                                Y02668 03399502
         TM    SWH,CPSTPFL         HAS THE RESTART STEP BEEN    YM01573 03400502
*                                  FOUND                        YM01573 03401502
         BZ    VHH0100             YES, DON'T FAIL THE JOB      YM01573 03402502
         IEFSAVER SAVEPTR          GET SAVEAREA FOR WTO RTN     YM01573 03403502
         LA    R5,RSNOTFND         INDICATE RESTART STEP NOT    YM01573 03404502
*                                  FOUND TO WTO RTN             YM01573 03405502
         L     RF,IEFVHRV          GET ADDR OF WTO RTN          YM01573 03406502
         BALR  RE,RF               ISSUE WTO                    YM01573 03407502
         IEFRELSE SAVEPTR          RELEASE WTO RTN SAVEAREA     YM01573 03408502
         LA    R2,MSG61            RESTART STEP NOT FOUND MSG   YM01573 03409502
*                                  TO PROGRAMMER                YM01573 03410502
         LA    RF,1                RESET STMT NBR TO 1 FOR      YM02714 03411502
         STH   RF,WASTMTNO         JOB STMT, FOR THIS EOJ MSG.  YM02714 03413502
         L     RF,IEFVGMV          GET ADDR OF SYSTEM MSG RTN   YM01573 03415502
         BALR  RE,RF               PUT OUT MSG                  YM01573 03416502
         OI    JCTJSTAT,INCMSTS    FAIL THE JOB                 YM01573 03417502
         L     R5,QMPCL            RE-INIT EXTRN PARMLIST PTR   YM01573 03418502
VHH0100  DS    0H                                               YM01573 03419502
***  WRITE JCT AND JCTX TO SWA. ***                            @Z40RPSM 03420340
         ST   R8,0(0,R5)          ADDR. OF JCT STORED IN WORK           03421140
*                                 AREA                         @Z40RPSM 03421940
         LA   R0,JCTX             ADDR.OF JCTX STORED          @Z40RPSM 03422740
         ST   R0,D8(R5)          IN WORK AREA                  @Z40RPSM 03423540
         MVC  D04(D3,R5),JCTDSKAD TTR IN WORK AREA+4           @Z40RPSM 03424340
         MVI  D7(R5),NULLID      ZERO ID FOR JCT               @Z40RPSM 03425140
         MVC  D12(D3,R5),JCTJCTX JCTX TTR INTO WORK AREA       @Z40RPSM 03425940
         MVI  D15(R5),NULLID     ZERO ID FOR JCTX INTO WORK             03426140
*                                AREA                          @Z40RPSM 03426340
         MVI  QPARM+QMPOP-QMNAM,QMWRTE     SET WRITE           @Z40RPSM 03427540
         MVI  QPARM+QMPNC-QMNAM,D2         SET 2 WRITES        @Z40RPSM 03428340
         BALR RE,RA                        JCT ' JCTX TO Q     @Z40RPSM 03468340
D45      DS    0H                                                Y02668 03700002
         L     RF,IEFVHNV          GET INTERP TERMINATION RTN @  Y02668 03710002
         BR    RF                  JOB COMPLETE - GO TO          Y02668 03720002
*                                  TERMINATE THE INTERPRETER     Y02668 03730002
         EJECT                                                          03747002
*****************************************************************Y02668 03749002
*                                                               *Y02668 03751002
*        VCONS, DECLARED STORAGE, AND EQUATES                   *Y02668 03753002
*                                                               *Y02668 03755002
*****************************************************************Y02668 03757002
IEFVHRV  DC    V(IEFVHR)           WTO ROUTINE                   Y02668 03762002
IEFVGMV  DC    V(IEFVGM)                MSG                             03774020
IEFVHQV  DC    V(IEFVHQ)                Q MGR LINK                      03780000
IEFVHEV  DC    V(IEFVHE)           INTERPRETER GET AND ROUTE RTN Y02668 03790002
IEFVHNV  DC    V(IEFVHN)           INTERPRETER TERMINATION       Y02668 03795002
D3ZERO   DC    X'000000'                                                03800000
         DS    0F                                                       03805015
MSK01    DC    X'000000F0'                                              03810015
MSK02    DC    X'0000000F'                                              03815015
MAXDDS   DC    H'1635'             MAX # DD'S ALLOWED IN STEP    Y02668 03816002
MAXDDMSG EQU   X'4B'               DYNAMIC DD COUNT REDUCED     YM01901 03816502
HALFWORD EQU   2                                                 Y02668 03817002
MSG11    EQU   11                       ORIDDEN EXEC STMT MISSING       03820000
MSG686   EQU   X'50'                    DDNAME UNDEFINED MSG   @ZA19982 03823040
DEC5     EQU   5                      LOOP CNTRL FOR DNRT SRCH @ZA19982 03826040
MSGSYMP  EQU   X'39'              UNDEFINED SYMBOLIC PARAM              03830014
JCTDETDA EQU   88                       JCT OFFSET FOR DSENQT TTR       03840000
CLFOUR   EQU   4                        LENGTH OF FOUR           A35409 03858020
DISPLID  EQU   7       DISPLACEMENT OF BLOCK ID IN REMOTE LIST   Y02621 03858602
JMRID    EQU   X'1B'     JMR BLOCK ID FOR REMOTE LIST            Y02621 03859202
JCTSMFEX EQU   X'20'               SMF EXIT CODE                 Y02668 03859702
RSNOTFND EQU   3                   RESTART STEP NOT FOUND WTO    Y02668 03859802
MSG61    EQU   61                  RESTART STEP NOT FOUND MSG    Y02668 03859902
CURRTCB  EQU   4                                                YM04108 03860002
HFAIL    EQU   1                                                        04180002
D2       EQU   2                                               @Z40RPSM 04230040
D3       EQU   3                                               @Z40RPSM 04280040
D04      EQU   4                                               @Z40RPSM 04330040
D5       EQU   5                                               @Z40RPSM 04380040
D7       EQU   7                                               @Z40RPSM 04400040
D8       EQU   8                                               @Z40RPSM 04430040
D12      EQU   12                                              @Z40RPSM 04480040
D15      EQU   15                                              @Z40RPSM 04530040
NULLID   EQU   X'00'       NULL ID FOR SWA MGR.                @Z40RPSM 04580040
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 04934002
         END                                                            05320000
./  ADD  SSI=51220029,NAME=IEFVHL
*********************************************************************** 00020002
*                                                                       00028002
*   MODULE NAME= IEFVHL                                                 00036002
*                                                                       00044002
*   DESCRIPTIVE NAME= NULL STATEMENT, OR END OF FILE, PROCESSOR         00052002
*                                                                       00060002
*   COPYRIGHT= N/A                                                      00068002
*                                                                       00076002
*   STATUS= OS/VS2 RELEASE 3                                            00084003
*                                                                       00092002
*   FUNCTION= ENTERED AS A RESULT OF NULL STATEMENT GENERATED BY IEFVHA 00100002
*             AT END OF FILE ON THE JCL DATA SET OR PROCEDURE - MODULE  00108002
*             PERFORMS END OF FILE PROCESSING.                          00116002
*      OPERATION= .CHECKS WHICH INPUT DATA SET REACHED END OF FILE,     00124002
*                  THEN CHECKS THE EOF FLAG FOR THE OTHER. IF EOF IS    00132002
*                  INDICATED FOR BOTH, MODULE SETS THE END OF           00140002
*                  CONVERSION FLAG FOR IEFVHF.                          00148002
*                 .IF EOF HAS BEEN REACHED ONLY ON THE JCL DATA SET,    00156002
*                  FLAGS ARE SET TO CAUSE CONTINUED READING FROM THE    00164002
*                  PROCEDURE LIBRARY.                                   00172002
*                 .IF EOF HAS BEEN REACHED ONLY ON THE PROCEDURE, ALL   00180002
*                  PROCEDURE FLAGS ARE CLEARED TO CAUSE CONTINUED       00188002
*                  READING FROM THE JCL DATA SET.                       00196002
*                                                                       00204002
*   NOTES                                                               00212002
*      CHARACTER CODE DEPENDENCIES= NONE                                00220002
*      DEPENDENCIES= NONE                                               00228002
*      RESTRICTIONS= NONE                                               00236002
*      REGISTER CONVENTIONS=                                            00244002
*                            R9- STATEMENT POINTER                      00252002
*                            RA- STATEMENT PARAMETER LIST POINTER       00260002
*                            RB- BASE REGISTER                          00268002
*                            RC- CWA POINTER                            00276002
*                            RD- SAVE AREA POINTER                      00284002
*      PATCH-LABEL= PATCH                                               00292002
*                                                                       00300002
*   MODULE TYPE= BAL                                                    00308002
*      PROCESSOR= ASSEMBLER                                             00316002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00324002
*                                                                       00332002
*   ENTRY POINT= IEFVHL                                                 00340002
*      PURPOSE= END OF FILE PROCESSING                                  00348002
*      LINKAGE= BRANCH ON REGISTER                                      00356002
*      INPUT DATA= CONVERTER WORK AREA                                  00364002
*                  RC- POINTS TO CWA                                    00372002
*      REGISTERS SAVED= NONE                                            00380002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00388002
*      REGISTERS RESTORED= NONE                                         00396002
*                                                                       00404002
*   EXIT - NORMAL= BRANCH TO IEFVHA                                     00412002
*      CONDITIONS= END OF FILE ON JCL DATA SET, A PROCEDURE LIBRARY IS  00420002
*                  STILL BEING READ, AND PROC BUFFER IS TO BE PRIMED    00428002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00436002
*      RETURN CODES= NONE                                               00444002
*                                                                       00452002
*   EXIT - NORMAL= BRANCH TO IEFVHEB                                    00460002
*      CONDITIONS= END OF FILE ON JCL DATA SET, A PROCEDURE LIBRARY IS  00468002
*                  STILL BEING READ, AND PROC BUFFER ALREADY CONTAINS A 00476002
*                  JCL STATEMENT TO BE PROCESSED                        00484002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00492002
*                   R9- POINTS TO PROCEDURE INPUT BUFFER                00500002
*      RETURN CODES= NONE                                               00508002
*                                                                       00516002
*   EXIT - NORMAL= BRANCH TO IEFVHCB                                    00524002
*      CONDITIONS= END OF FILE ON PROCEDURE AND NO END OF FILE ON       00532002
*                  JCL DATA SET                                         00540002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00548002
*                   R9- POINTS TO JCL DATA SET INPUT BUFFER             00556002
*      RETURN CODES= NONE                                               00564002
*                                                                       00572002
*   EXIT - NORMAL= BRANCH TO IEFVHF                                     00580002
*      CONDITIONS= END OF FILE ON BOTH PROCEDURE AND JCL DATA SET       00588002
*      OUTPUT DATA= END OF CONVERSION FLAG SET                          00596002
*      RETURN CODES= NONE                                               00604002
*                                                                       00612002
*   EXIT - ERROR= NONE                                                  00620002
*                                                                       00628002
*   EXTERNAL REFERENCES=                                                00636002
*      ROUTINES= NONE                                                   00644002
*      DATA AREAS= CONVERTER WORK AREA                                  00652002
*      CONTROL BLOCKS= NONE                                             00660002
*      TABLES= NONE                                                     00668002
*      MACROS= IEFVMCWA                                                 00676002
*      ENQUEUE RESOURCES= NONE                                          00684002
*      CHANGE LEVEL= OZ03636                                   @ZA03636 00692003
*                                                                       00700002
*   MESSAGES= NONE                                                      00708002
*                                                                       00716002
*********************************************************************** 00724002
         EJECT                                                          00732002
         IEFCOMWA                                                Y02668 00820002
         IEFCVRWA                                                Y02668 00850002
         EJECT                                                          00880000
IEFVHL   CSECT                                                          00900000
*                                                                A26315 00910019
*                   R9=STMT PTR                                         00920000
*                   RA=STMT PARM PTR                                    00940000
*                   RD=PTR TO CURRENT REG SAVE AREA                     00960000
         BALR  RB,0                                                     00980000
         USING *,RB          *                                          01000000
*****************************************************************Y02028 01022002
* MODULE TRACE CODE - FOR TESTING.                               Y02028 01024002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02028 01026002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02028 01028002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02028 01030002
         DC    C'VHL '             MOD ID USED BY TRACE.         Y02028 01032002
* TRACE RETURNS HERE.                                            Y02028 01034002
*****************************************************************Y02028 01036002
         B     F1                                                       01040000
         MODID BR=NO                                             Y01886 01090001
         DC    C'SPLT'             FUNCTION ID AND               Y02028 01100002
         DC    C'04'     LEVEL NUMBER( STMT # )                  Y02668 01110002
         DC    C'REL3 PTF'        FUNCTION ID AND              @ZA03636 01113003
         DC    C'01'         LEVEL (BAD PROC CLEANUP)          @ZA03636 01115003
F1       DS    0H                                                       01120000
         TM    SWC,IOERR                I/O  ERROR               A26315 01126019
         BO    F23                      BR  YES                  A26315 01132019
         TM    SWE,GPI                  PROC STMT                       01140000
         BO    F2                       BR YES                          01160000
         OI    SWC,NRCV                 NULL STMT RCVD                  01180000
         NI    SWB,255-FRCV             TURN OFF 1ST STMT RCVD          01200000
         TM    SWE,PROC                 PROCEDURE ON                    01220000
         BO    F14                                                      01240000
         TM    SWA,JTOP                 JOB TO PROCESS                  01260000
         BZ    F16                      BR NO                           01280000
         TM    SWA,EOFR                 RDR EOF                         01300000
         BZ    F22                      BR NO                           01320000
         B     F23                                                      01340000
F14      DS    0H                                                       01360000
         OI    SWE,GPI                  PROC STMT ON                    01380000
         NI    SWE,255-POVRD            DD ORIDE OFF                    01400000
         TM    SWE,PRCV                 PRIME PROC BUFF                 01420000
         BO    F15                                                      01440000
         LA    RA,PSTMT                 PROC PARM                       01460000
         L     R9,0(0,RA)               PROC STMT                       01480000
         L     RF,IEFVHEBV         EXIT                          Y02028 01500002
         BR    RF                  TO PRE-SCAN ROUTINE.          Y02028 01520002
F15      DS    0H                                                       01540000
         NI    SWE,255-PRCV             PRIME OFF                       01560000
         OI    SWD,SYMPRC            **SET 1ST ACCESS FLAG              01570014
F16      DS    0H                                                       01580000
         L     RF,IEFVHAV                                               01600000
         BR    RF                  EXIT TO GET STMT                     01620000
F2       DS    0H                                                       01640000
         OI    SWE,PREF                 PROC EOF                        01660000
         TM    SWA,EOFR                 RDR EOF                         01680000
         BO    F23                      BR YES                          01700000
         TM    SWC,NRCV                 RDR NULL RCVD                   01720000
         BO    F22                      BR YES                          01740000
         L     RF,IEFVHCBV         SET EXIT TO VERB ID                  01760000
         B     F231                                                     01780000
F22      DS    0H                                                       01800000
         L     R9,RSTMT                 PTR TO RDR BUFFER               01820000
         OI    AOSW4,CWATERM       INDICATE CONVERSION COMPLETE. Y02668 01840002
         OI    AOSW1,AOPRTSW       TELL VHEB TO PRINT            Y02668 01860002
         L     RE,IEFVHFV          SET VHEB EXIT TO VHF          Y02668 01880002
         L     RF,IEFVHEBV         EXIT TO VHEB WHO IN TURN      Y02668 01900002
         BR    RF                  CALLS VGM WHO EXITS TO VHF    Y02668 01920002
F23      DS    0H                                                       01960000
         OI    AOSW4,CWATERM       INDICATE CONVERSION COMPLETE. Y02668 01980002
         L     RF,IEFVHFV          SET EXIT TO CONTROL ROUTINE.  Y02028 01990002
F231     DS    0H                                                       02000000
         TM    SWE,GPI                 PROC BEING HANDLED      @ZA03636 02003003
         BZ    NOTPROC                 NO                      @ZA03636 02006003
         NI    SWI,255-BLKPRC          RESET BLOCKING SWITCH   @ZA03636 02009003
         MVC   PSTMT(4),IWAINTS4       RESTORE BEGIN OF BUFFER @ZA03636 02012003
NOTPROC  EQU   *                       NOT DOING PROC          @ZA03636 02015003
         LA    RA,RSTMT                 STMT PARM                       02020000
         L     R9,0(0,RA)               RDR STMT                        02040000
         NI    SWE,255-PROC-GPI         PROC & GPI OFF                  02060000
         BR    RF                  EXIT TO VERB ID OR JOB CONTROL C     02080000
IEFVHAV  DC    V(IEFVHA)                GET                             02120000
IEFVHCBV DC    V(IEFVHCB)               VERB ID B                       02140000
IEFVHEBV DC    V(IEFVHEB)          PRE-SCAN ROUTINE.             Y02028 02160002
IEFVHFV  DC    V(IEFVHF)           CONTROL ROUTINE.              Y02028 02170002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02028 02180002
         END                                                            02200000
./  ADD  SSI=61350412,NAME=IEFVHM
*/*                                                                     00030002
**********************************************************************  00032002
*                                                                       00034002
*   MODULE NAME= IEFVHM                                                 00036002
*                                                                       00038002
*   DESCRIPTIVE NAME= COMMAND VERB VALIDATION                           00038402
*                                                                       00038802
*   COPYRIGHT= N/A                                                      00039202
*                                                                       00039602
*   STATUS= OS/VS2 - SERVICE DATA IMPROVEMENTS                 @G17SPTJ 00039841
*                                                                       00044640
*   FUNCTION= IEFVHM VALIDITY CHECKS A COMMAND VERB.                    00045640
*      OPERATION= WHEN IEFVHM RECEIVES CONTROL REGISTER 5 POINTS TO A   00046602
*                 VERB WHICH IS THEN COMPARED AGAINST A TABLE           00047002
*                 TO VALIDATE IT AS A COMMAND.  IF A COMMAND            00047402
*                 IS FOUND, A MESSAGE IS SENT TO THE OPERATOR.          00047802
*                 IF REPLY IS YES ISSUE SVC34. IF NO BYPASS SVC.        00047902
*                 CONTROL THEN IS PASSED TO IEFVHA.  IF THE             00048202
*                 COMAND IS NOT VALID THE JOB IS FAILED, AN ERROR       00048402
*                 MESSAGE IS ISSUED, IS PASSED TO IEFVHA.               00048502
*                                                                       00048602
*   NOTES                                                               00050602
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00052602
*      DEPENDENCIES= SVC 34                                             00053002
*      RESTRICTIONS= NONE                                               00053202
*      PATCH-LABEL= PATCH                                               00059902
*      REGISTER CONVENTIONS= R0 THROUGH RF                              00061902
*                                                                       00062302
*   MODULE TYPE= PROCEEDURE                                             00063902
*      PROCESSOR= ASSEMBLER                                             00065902
*      MODULE SIZE= X'4B8'                                     @G17SPTJ 00066141
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00066402
*                                                                       00066502
*   ENTRY POINT= IEFVHM                                                 00073202
*      PURPOSE= VALIDATE VERB AS A COMMAND                              00075202
*      LINKAGE= LOAD VCON, BRANCH REGISTER                              00077202
*      INPUT DATA= REGISTER 5 POINTS TO THE VERB                        00079302
*                  REGISTER 9 POINTS TO THE STATEMENT                   00079402
*                  REGISTER 10 POINTS TO THE STATEMENT PARAMETER LIST   00079502
*                  REGISTER 13 POINTS TO THE SAVEAREA                   00079602
*      REGISTERS SAVED= NONE                                            00079702
*      REGISTER CONTENTS DURING PROCESSING=                             00079802
*      REGISTERS RESTORED= NONE                                         00079902
*                                                                       00080002
*   EXIT - NORMAL= LOAD IEFVHA VCON, BRANCH REGISTER                    00086502
*      CONDITIONS= VERB IS A VALID COMMAND                              00088502
*      OUTPUT DATA= NONE                                                00090502
*      RETURN CODES= NONE                                               00092502
*                                                                       00092902
*   EXIT - ERROR= LOAD IEFVHA VCON, BRANCH REGISTER                     00093302
*      CONDITIONS= VERB NOT A VALID COMMAND                             00093402
*      OUTPUT DATA= REGISTER 2 POINTS TO A MESSAGE                      00093502
*      RETURN CODES= NONE                                               00095602
*                                                                       00097602
*   EXTERNAL REFERENCES=                                                00099602
*      ROUTINES= IEFVHEB TO LIST THE COMMAND                            00099702
*      DATA AREAS= IWA,JCT                                              00099802
*      CONTROL BLOCKS= NONE                                             00099902
*      TABLE= COMMAND COMPARE TABLE                                     00105602
*      MACROS= GETMAIN,FREEMAIN,WTO,WTOR,WAIT,GMCR                      00107602
*      ENQUEUE RESOURCES= NONE                                          00109602
*                                                                       00110402
*   MESSAGES= (UNIDENTIFIED OPERATION FIELD)                            00110802
*             THIS MESSAGE IS PASSED TO IEFVHEB                         00110902
*                                                                       00111040
*   CHANGE LEVEL = Z40WPSM, Z40BPSV, G17SPTJ                   @G17SPTJ 00131041
*                                                                       00730040
**********************************************************************  00780040
**/                                                                     00830040
         EJECT                                                          00880000
         IEFCOMWA                                                Y02668 00900002
         IEFCVRWA                                                Y02668 00910002
         EJECT                                                          00925002
         IEFVMCWA                                                       00930002
         EJECT                                                          00935002
         IEFTXTFT                                                Y02668 00940002
NEL      DSECT                                                  YM00386 00950002
         IEFNEL SUBCOM=C                                                00960002
         EJECT                                                          00980000
*                                                                  XMCS 00981018
WTOBUF   DSECT                                                     XMCS 00982018
         USING WTOBUF,R2                                           XMCS 00983018
         DS    0D                                                       00984018
WTOLENG  DS    H                   MSG LENGTH                      IMCS 00985018
MCSFLG   DS    H                   MCS FLAGS                       IMCS 00986018
MSGIDBF  DS    2F                  MSG ID                          IMCS 00987018
MSGTEXT  DS    16F                 MSG CONTENT.                  Y02668 00988002
DESCRTC  DS    F                   DESCRIPTOR AND ROUTING CODES    IMCS 00989018
ECBBUF   DS    F                   WAIT ECB                        IMCS 00990018
REPLYBUF DS    C                   REPLY LOCATION                  IMCS 00991018
DUMM     DS    CL3                 UNUSED                          IMCS 00992018
CMDLENG  DS    F                   REPLY LENGTH                    IMCS 00993018
*                                                                  XMCS 00994018
*                                                                  XMCS 00995018
         ORG WTOBUF                BUFFER USED FOR SVC 34          IMCS 00996018
MSGLEN   DS    F                   MSG LENGTH, MCS FLAGS           IMCS 00997018
COMDTXT  DS    20F                 COMMAND IMAGE                   IMCS 00998018
*                                                                  XMCS 00999018
IEFVHM   CSECT                                                          01000018
EBLANK   EQU   C' '                                                     01000902
ECHARN   EQU   C'N'                                                     01001802
ECHARY   EQU   C'Y'                                                     01002702
EHEX01   EQU   X'01'                                                    01003602
EHEX40   EQU   X'40'                                                    01004502
IGNOREC  EQU   X'F3'                                            YM00386 01004602
EXONLY   EQU   X'F0'                                            YM00386 01004702
ASKOPER  EQU   X'F2'                                            YM00386 01004802
EBCDICF  EQU   X'C6'                                            YM00386 01004902
AUTHLEN  EQU   4                                                YM00386 01005002
E0       EQU   0                                                        01005402
E1       EQU   1                                                        01006302
E2       EQU   2                                                        01007202
E4       EQU   4                                                        01008102
E8       EQU   8                                                        01009002
E12      EQU   12                                                       01009902
E16      EQU   16                                                       01010802
E61      EQU   61                                                       01011702
E76      EQU   76                                                       01012602
E79      EQU   79                                                       01013502
E80      EQU   80                                                       01014402
E88      EQU   88                                                       01015302
E91      EQU   91                                                       01016202
* THE ABOVE EQUATES (EBLANK THRU E91) WERE MOVED TO ELIMINATE   YM01559 01017102
*  THE EXISTENCE OF A PRIVATE CSECT FOR THIS MODULE.            YM01559 01018002
         BALR  RB,0                                                     01100000
         USING *,RB                                                     01120000
*****************************************************************Y02668 01142002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01144002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01146002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01148002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01150002
         DC    C'VHM '             MOD ID USED BY TRACE.         Y02668 01152002
* TRACE RETURNS HERE.                                            Y02668 01154002
*****************************************************************Y02668 01156002
         B     F6                                                       01160000
         MODID BR=NO                                             Y01886 01210001
         DC    C'SU 17'            FUNCTION ID AND             @G17SPTJ 01220041
         DC    C'01'               LEV #(SLIP COMMAND)         @G17SPTJ 01233041
F6       DS    0H                                                       01240000
         CLI   2(R9),X'40'                                        20107 01386017
         BNE   F64                                                20107 01392017
         LR    R6,R5                    VERB                            01400000
         LA    R2,1                     INCREMENT                       01420000
         LA    R3,8                                                     01440000
         AR    R3,R6                    LIMIT                           01460000
F63      DS    0H                                                       01480000
         BXH   R6,R2,F64                SCAN FOR A BLANK                01500000
         CLI   0(R6),C' '                                               01520000
         BNE   F63                                                      01540000
         SR    R6,R5                    FOUND, CALC VERB LENGTH         01560000
         LA    R1,TBL                   COMD LIST                       01580000
         LA    R2,9                     INCREMENT                       01600000
         LA    R3,ENDTBL                                                01620000
F635     DS    0H                       SCAN COMMAND LIST               01640000
         EX    R6,COMPARE                                               01660000
         BE    F66                      FOUND COMD                      01680000
         BXLE  R1,R2,F635                                               01700000
* NOW SCAN ABBREVIATED COMMAND LIST                                     01720000
         LA    R3,ENDTBL2              END OF COMMAND TABLE COMPARAND   01740000
         LA     R2,2                   INCREMENT                        01760000
         LA    R1,TBL2                 TABLE START                      01780000
F636     DS    0H                                                       01800000
         EX    R6,COMPARE                                               01820000
         BE    F66                     FOUND                            01840000
         BXLE  R1,R2,F636              LOOP UNTIL TABLE IS DONE         01860000
F64      DS    0H                                                       01880000
         TM    SWA,JTOP              **Q. JOB TO PROCESS                01886014
         BZ    F65                   ** BRANCH - NO                     01892014
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 01900002
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 01901002
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT            Y02668 01902002
         DROP  R8                                                Y02668 01903002
         L     RE,CTRLWAP          GET LOCAL WORK AREA PTR       Y02668 01904002
         USING CWA,RE              SET BASE                      Y02668 01908002
         XC    MSGKEY,MSGKEY       ZERO SECONDARY MSG. KEY       Y02668 01912002
         DROP  RE                                                Y02668 01916002
         LA    R2,MSG5                  MSG-NO VERB                     01920000
         OI   AOSW1,AOILGLOP       SET ILLEGAL OP SWITCH         Y02668 01940002
*                                  INDICATING A MESSAGE TO       Y02668 01950002
*                                  BE PRINTED                    Y02668 01960002
F65      DS    0H                                                       01980000
         OI    AOSW1,AOPRTSW       INDICATE PRINT OP TO VHEB     Y02668 02000002
         L     RE,IEFVHAV          SET UP EXIT                   Y02668 02010002
         L     RF,IEFVHEBV         PRINT STMT AND MESSAGE IN     Y02668 02020002
         BR    RF                  VHEB BEFORE GOING TO VHA      Y02668 02030002
F66      DS    0H                       SET UP STMT FOR SVC 34          02040000
         GETMAIN R,LV=92      MSG BUFFER MAX LENGTH FOR WTO        XMCS 02045018
*                      AND WTOR - ECB REPLY CORE IF WTOR           GMCS 02050018
         LR    R2,R1                                               GMCS 02055018
         MVC   MSGTEXT(E80),E0(R9)                               Y02668 02060002
         LA    R4,MSGTEXT+E79                                    Y02668 02065002
         LA    R3,E80                                              IMCS 02070018
F67      EQU   *                                                        02075018
         CLI   E0(R4),EBLANK                                       IMCS 02080018
         BNE   F68                 FOUND IT                        GMCS 02085018
         BCTR  R4,R0               DECREASE PTR                    GMCS 02090018
         BCT   R3,F67              DECREASE LENGTH                 GMCS 02095018
F68      EQU   *                                                   GMCS 02100018
         L     R1,WANELPTR         GET PTR TO NEL               YM00386 02105002
         USING NEL,R1              ADDRESS NEL                  YM00386 02107002
         CLI   NELCOMDS,IGNOREC    SHOULD COMMAND BE IGNORED    YM00386 02109002
         BE    F65                 YES, DO NOT EXEC COMMAND     YM00386 02111002
         CLI   NELCOMDS,EXONLY     SHOULD COM BE DISPLAYED      YM00386 02113002
         BE    F68G                NO, ONLY EXECUTE IT          YM00386 02115002
         DROP  R1                                               YM00386 02117002
MSGWTOMV EQU   *                                                   GMCS 02120018
         MVC   MSGIDBF(E8),MSGID   MOVE MSG ID TO WTO BUFFER       IMCS 02125018
         ST    R3,CMDLENG          STORE COMMAD LENGTH FOR SVC USE XMCS 02130018
         C     R3,NUM64            IS LENGTH OF COMMAND GREATER    GMCS 02135018
*                                  THAN 64                         GMCS 02140018
         LA    R1,WTO1             ..                              XMCS 02145018
         MVC   MCSFLG(E2),E2(R1)   MCS FLAGS TO WTO BUFFER         IMCS 02150018
         BNH   F68A                SINGLE WTO                      XMCS 02155018
         B     F68B                MULTIPLE WTO'S TO BE SENT       XMCS 02160018
F68A     EQU   *                                                   GMCS 02165018
         A     R3,HEX08            ADD 8 FOR MSG ID LENGTH         GMCS 02170018
         STH   R3,WTOLENG          MESSAGE LENGTH                  XMCS 02175018
         MVC   E1(E4,R4),E8(R1)    DESC AND ROUTCDE PARAMETERS     IMCS 02180018
ISSUE    EQU   *                                                   GMCS 02185018
         LA    R3,ECBBUF           ECB PTR FOR WTOR                XMCS 02190018
         LA    R4,REPLYBUF         REPLY BUFFER PTR FOR WTOR       XMCS 02195018
         WTO   MF=(E,(2))          ISSUE MESSAGE                   GMCS 02200018
         B     F68C                TEST IF WTOR REQUIRED           XMCS 02205018
F68B     EQU   *                   MULTIPLE WTO                    GMCS 02210018
         MVC   DESCRTC(E4),E8(R1)  DESC AND ROUTCODE PARAMETERS    IMCS 02215018
         LA    R4,E76                                              IMCS 02220018
         STH   R4,WTOLENG          MSG LENGTH                      XMCS 02225018
         WTO    MF=(E,(2))         ISSUE FIRST PART OF MSG         GMCS 02230018
         S     R3,NUM64            LENGTH OF COMMAND LEFT          GMCS 02235018
         LR    R7,R9                                               GMCS 02240018
         A     R7,NUM64                                            XMCS 02245018
         LR    R4,R3                                               GMCS 02250018
         BCTR  R4,E0               SUBTRACT 1                      IMCS 02255018
         EX    R4,MVIT             MOVE REST OF MESSAGE            IMCS 02260018
         LA    R4,E12(R2)                                          IMCS 02265018
         AR    R4,R3               PT TO LAST CHAR IN MSG          IMCS 02270018
         BCTR  R4,E0               SUBTRACT 1                      IMCS 02275018
         LA    R1,WTO1        RE-SET PTR TO WTO TEXT              M3178 02277019
         B     F68A                GO ISSUE 2ND PART OF MSG        IMCS 02280018
MVIT     DS    0H                                                Y02668 02285002
         MVC   MSGTEXT(E0),E0(R7)  MOVE CMD TO DISPLAY TO OPER.  Y02668 02287002
MVIT1    MVC   COMDTXT(E0),E0(R9)  MOVE CMD IMAGE FOR SVC 34       IMCS 02290018
F68C     DS    0F                                                  GMCS 02295018
*                             MUST BE WTOR OR WTO AND MGCR              02340000
         L     R1,WANELPTR         GET PTR TO NEL               YM00386 02360002
         USING NEL,R1              ADDRESS NEL                  YM00386 02363002
         CLI   NELCOMDS,ASKOPER    MUST OPERATOR BE ASKED TO    YM00386 02366002
*                                  PROVIDE COMMAND DISP         YM00386 02369002
         BNE   F68F1               NO, JUST EXEC COMMAND        YM00386 02372002
         DROP  R1                                               YM00386 02375002
F68D     EQU   *                                                   XMCS 02380018
         MVC   E0(E61,R2),WTOREP                                   IMCS 02390018
         LR    R1,R2                                               IMCS 02400018
         ST    R4,E0(R1)           PTR TO REPLY                    IMCS 02410018
         ST    R3,E4(R1)           PRT TO ECB                      IMCS 02420018
         XC    ECBBUF(E4),ECBBUF   CLEAR OUT ECB                   IMCS 02430018
         XC    REPLYBUF(E1),REPLYBUF  AND REPLY BUFFERS            IMCS 02440018
         MVI   E0(R1),EHEX01       REPLY LENGTH                    IMCS 02450018
         WTOR  ,0(R4),1,0(R3),MF=(E,(1))                           XMCS 02460018
         WAIT  1,ECB=(R3)                                          GMCS 02470018
         CLI   E0(R4),ECHARY                                       IMCS 02480018
         BE    F68F1               YES, GO ISSUE COMMAND           IMCS 02490018
         CLI   E0(R4),ECHARN       IS IT A 'NO' ANSWER             IMCS 02500018
         BNE   F68D                NO, OPERATOR ERROR, TRY AGAIN   XMCS 02510018
         LA    R4,F65              YES, PRESET FINAL BRANCH AND    XMCS 02520018
*                                  OMIT COMMAND                    XMCS 02530018
F68E     EQU   *                                                   XMCS 02540018
         LR   R1,R2                                                GMCS 02550018
         FREEMAIN R,LV=92,A=(1)                                    XMCS 02560018
         BR    R4                  RETURN                          IMCS 02570018
F68G     EQU   *                                                   XMCS 02580018
         LR    R1,R3                                               XMCS 02590018
         B     F68F2               GO TO SET UP FOR SVC 34         XMCS 02600018
F68F1    EQU  *                                                    XMCS 02610018
         L     R1,E88(R2)          COMMAND LENGTH                       02620018
F68F2    EQU   *                                                        02630018
         BCTR  R1,E0               SUBTRACT 1                      IMCS 02640018
         MVI   MSGLEN,EHEX40                                       IMCS 02650018
         MVC   MSGLEN+E1(E91),MSGLEN                               IMCS 02660018
         EX    R1,MVIT1            MOVE CMD IMAGE FOR SVC 34       XMCS 02670018
         A     R1,HEX04                                            XMCS 02680018
         SLL   R1,E16                                                   02690018
         ST    R1,MSGLEN           COMMAND LENGTH                  XMCS 02700018
F686     DS    0H                                                       02780000
****************************************************************YM00386 02780502
*                                                              *YM00386 02780702
*  CONVERT COMMAND AUTHORITY WHICH IS IN PRINTABLE HEX         *YM00386 02780902
*                 TO  BINARY TO PASS TO SVC 34                 *YM00386 02781102
*                                                              *YM00386 02781302
****************************************************************YM00386 02781502
         SPACE 2                                                YM00386 02781702
         L     R3,CDAUTHWA         LOAD WORK AREA CONTENTS.     YM02718 02781902
         LTR   R3,R3               HAS AUTH BEEN CONVERTED      YM00386 02782302
         BNZ   VHMSVC34            YES, BYPASS CONVERT          YM00386 02782502
         L     R3,WANELPTR         GET PTR TO NEL               YM00386 02782702
         USING NEL,R3              ADDRESS NEL                  YM00386 02782902
         LA    R4,NELAUTH          GET PTR TO COMMAND AUTH      YM00386 02783102
         LA    R7,CDAUTHWA         ADDRESS OF WORK AREA.        YM02718 02783302
         LA    R5,AUTHLEN          LENGTH OF AUTH FIELD         YM00386 02783502
*                                  AN UNPACKED FORMAT OF FA-FF. YM00386 02783702
VHMCONVT DS    0H                                               YM00386 02783902
         CLI   0(R4),EBCDICF       IS CHAR ALPHA(A THRU F)      YM00386 02784102
         BH    VHMNUM              NO, ASSUME   IT IS NUMERIC   YM00386 02784302
         SR    R6,R6               CLEAR R6 FOR INSERT          YM00386 02784502
         IC    R6,0(R4)            PUT CHAR IN R6               YM00386 02784702
         LA    R6,57(R6)           ADD 57 TO CHAR VALUE         YM00386 02784902
*                                  BY ADDING 57, CHAR VALUES    YM00386 02785102
*                                  A-F(C1-C6) ARE CHANGED TO    YM00386 02785302
*                                  WHEN THESE VALUES(FA-FF) ARE YM00386 02785502
*                                  PACKED THE LOW ORDER         YM00386 02785702
*                                  BITS(A-F) ARE RETAINED.      YM00386 02785902
         STC   R6,0(R7)            SAVE CONVRTED VALUE IN W.AREAYM00386 02786102
         LA    R7,1(R7)            INCRE TO NEXT FIED IN W.AREA YM00386 02786302
         LA    R4,1(R4)            INCRE TO NEXT COMAUTH CHAR   YM00386 02786502
         BCT   R5,VHMCONVT         GO BACK IF MORE CHARS        YM00386 02786702
         B     VHMPACK             IF FINISHED GO TO PACK       YM00386 02786902
VHMNUM   DS    0H                                               YM00386 02787102
         MVC   E0(E1,R7),E0(R4)    MOVE F0-F9 DIRECTLY FOR PACK YM01877 02787302
         LA    R7,1(R7)            INCRE TO NEXT FIELD IN AREA  YM00386 02787502
         LA    R4,1(R4)            INCRE TO NEXT COMAUTH CHAR   YM00386 02787702
         BCT   R5,VHMCONVT         GO BACK IF MORE CHARS        YM00386 02787902
VHMPACK  DS    0H                                               YM00386 02788102
         PACK  CDAUTHWA(4),CDAUTHWA PACK CONVERTED CHARS.       YM02718 02788302
VHMSVC34 DS    0H                                                       02788502
         L     R0,CDAUTHWA         LOAD INTO REG FOR SVC 34.    YM02718 02788702
         SRL   R0,4                SHIFT OUT SIGN BITS          YM00386 02788902
         O     R0,NEGMASK          INDIC(TO SVC34) THAT         YM00386 02789102
*                                  COMMAND IS FROM INPUT STREAM YM00386 02789302
         MVI   4(R2),C'/'         PUT / IN PLACE OF X             19687 02792017
         MVI   5(R2),C'/'         PUT / IN PLACE OF X             19687 02796017
*                                  IN CASE COMD WAS IN A PROC.  YM00386 02798002
         MGCR  (2)                      SCHEDULE COMMAND'S EXECUTION    02800000
         LA    R4,F65                                              XMCS 02830018
         B     F68E           FREE BUF AND READ NEXT CARD          XMCS 02860018
COMPARE  CLC   0(1,R1),0(R5)                                            02900000
TBL      EQU   *                        COMMAND LIST                    02920000
         DC    CL9'DISPLAY'                                             02940000
         DC    CL9'START'                                               02960000
         DC    CL9'STOP'                                                02980000
         DC    CL9'MOUNT'                                               03000000
         DC    CL9'UNLOAD'                                              03020000
         DC    CL9'HOLD'                                                03040000
         DC    CL9'LOG'                                                 03060000
         DC    CL9'MODIFY'                                              03080000
         DC    CL9'RELEASE'                                             03100000
         DC    CL9'REPLY'                                               03120000
         DC    CL9'WRITELOG'                                            03140000
         DC    CL9'RESET'                                               03160000
         DC    CL9'CANCEL'                                              03180000
         DC    CL9'SET'                                                 03200000
         DC    CL9'VARY'                                                03220000
         DC    CL9'CHNGDUMP'                                     Y02668 03222002
         DC    CL9'MONITOR'                                       M0381 03225020
         DC    CL9'SEND'                                          M0381 03230020
         DC    CL9'SE'             SEND ABBREVIATION              M4557 03232020
         DC    CL9'MN'             MONITOR                        M0381 03235020
         DC    CL9'CD'             CHNGDUMP ABBREVIATION         Y02668 03237002
         DC    CL9'SHIFT'                                               03240000
         DC    CL9'MSG'                                                 03260000
         DC    CL9'CENOUT'                                              03280000
         DC    CL9'BRDCST'                                              03300000
         DC    CL9'STOPMN'                                       Y02668 03306002
         DC    CL9'PM'             STOPMN ABBREVIATION           Y02668 03312002
         DC    CL9'USERID'                                              03320000
         DC    CL9'PAGEADD'                                    @Z40WPSM 03326040
         DC    CL9'PA'         PAGE ADD ABBREVIATION           @Z40WPSM 03332040
         DC    CL9'SETDMN'                                     @Z40BPSV 03333040
         DC    CL9'SD'         SETDMN ABBREVIATION             @Z40BPSV 03334040
         DC    CL9'SLIP'                                       @G17SPTJ 03336041
         DC    CL9'SL'         SLIP ABBREVIATION               @G17SPTJ 03338041
ENDTBL   DC    CL9'SHOW'                                                03340000
* ACCEPTABLE ABBREVIATIONS FOR COMMANDS                                 03360000
*                                                                       03380000
TBL2     EQU   *                                                        03400000
         DC    CL2'D'                  DISPLAY                          03420000
         DC    CL2'S'                  START                            03440000
         DC    CL2'P'                  STOP                             03460000
         DC    CL2'M'                  MOUNT                            03480000
         DC    CL2'U'                  UNLOAD                           03500000
         DC    CL2'H'                  HOLD                             03520000
         DC    CL2'L'                  LOG                              03540000
         DC    CL2'F'                  MODIFY                           03560000
         DC    CL2'A'                  RELEASE                          03580000
         DC    CL2'R'                  REPLY                            03600000
         DC    CL2'W'                  WRITELOG                         03620000
         DC    CL2'E'                  RESET                            03640000
         DC    CL2'C'                  CANCEL                           03660000
         DC    CL2'T'                  SET                              03680000
ENDTBL2  DC    CL2'V'                  VARY                             03700000
MSG5     EQU   5                        NO VERB                         03720000
         DS    0F                                                  XMCS 03725018
CLEAR0F  DC    X'0000FFFF'         MASKS TO SPECIFY COMMAND FROM   IMCS 03730018
NEGMASK  DC    X'80000000'           INPUT STREAM                       03735018
IEFVHAV  DC    V(IEFVHA)                GET                             03740000
IEFVHEBV DC    V(IEFVHEB)                                        Y02668 03760002
       DS    0F                                                    GMCS 03761018
MSGID    DC    CL8'IEF165I '       MSG ID                          IMCS 03762018
REPLYDMY DS    C                   AREA FOR WTOR REPLY             IMCS 03763018
ECBDMY   DS    F                   WAIT ECB ADDR                   IMCS 03764018
         DS    0F                                                       03765018
HEX04    DC    F'5'                SIZE OF ROUT-DESC AREA PLUS 1   IMCS 03766018
HEX08    DC    F'12'               MSG ID LENGTH                   IMCS 03767018
NUM64    DC    X'00000040'         MAX LENGTH OF WTO               IMCS 03768018
HEX02    EQU   X'02'                                                    03769018
         DS   0F                                                   GMCS 03770018
WTO1     WTO   '    ',MF=L,MCSFLAG=(RESP),DESC=(5),ROUTCDE=(1)          03771018
*                                                                  GMCS 03772018
WTOREP   WTOR  'IEF166D REPLY Y/N TO EXECUTE/SUPPRESS COMMAND',REPLYDMY*03773018
               ,1,ECBDMY,MF=L,MCSFLAG=(RESP),DESC=(2),ROUTCDE=(1)       03774018
*                                                                  GMCS 03775018
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 03777002
         END                                                            03780000
./  ADD  SSI=80550313,NAME=IEFVHN
         TITLE 'IEFVHN'                                                 00050001
*********************************************************************** 00100002
*                                                                       00109002
*   MODULE NAME= IEFVHN                                                 00118002
*                                                                       00127002
*   DESCRIPTIVE NAME= INTERPRETER TERMINATION ROUTINE                   00136002
*                                                                       00145002
*   COPYRIGHT= N/A                                                      00154002
*                                                                       00163002
*   STATUS= VS2 SU16 - IN THIS MODULE, SU 16 SUPPORTS          @G16AP2F 00172003
*           VPSS SUPPORT (SU 29 - @G29AN2F).                   @G16AP2F 00175003
*           MERGE SU4,10,16 CODE TO REL 037 PTF                @ZA27750 00178003
*                                                                       00181002
*   FUNCTION=  THIS ROUTINE PERFORMS CLEAN UP FUNCTIONS                 00190002
*             JUST PRIOR TO INTERPRETER TERMINATION.   IT FREES AREAS   00199002
*             GOTTEN BY THE INITIALIZATION ROUTINE(IEFVHE), ISSUES      00208002
*             WTO'S INFORMING THE OPERATOR OF JOB STATUS AT             00217002
*             INTERPRETER END, AND SETS RETURN CODES TO BE PASSED       00226002
*             TO THE INTERPRETER'S CALLER.                              00235002
*             SWA SUPPORT -                                             00244002
*             ALL CODE REFERENCING THE 3RD BYTE OF A TTR HAS BEEN       00253002
*             REMOVED.THE SWA VIRTUAL ADDRESSING MAKES THIS TEST        00262002
*             INVALID.                                                  00271002
*                                                                       00280002
*                                                                       00289002
*      OPERATION=                                                       00298002
*              .A CHECK IS MADE TO SEE IF A JCL OR I/O ERROR HAS        00307002
*               OCCURRED.   IF A JCL ERROR, A WTO IS ISSUED ( JOB NOT   00316002
*               RUN JCL  ERROR), AND A RETURN CODE OF 4 IS PLACED IN    00325002
*               REG 15.   IF AN I/O ERROR, A RETURN CODE OF 8 IS PLACED 00334002
*               IN REG 15.                                              00343002
*              .INPUT AND OUTPUT BUFFERS ARE FREED.                     00352002
*              .FREE LOCAL WORK AREA                                    00361002
*              .IF LOADED, SWA MANAGER IS DELETED                       00370002
*              .IF SPECIAL ACCESS METHOD PROVIDED, FREE IT              00379002
*              .RESTORE QMPA FOR RETURN TO CALLER                       00388002
*              .INITIALIZE NELJCT PTR                                   00397002
*              .CHECK FOR SMF.  IF FUNCTIONAL, CHECK IF USER RTN        00406002
*               WAS LOADED.   IF YES, DELETE IT.                        00415002
*               MOVE UPDATED JMR BACK TO CALLER'S STORAGE AND           00424002
*               FREE CORE THAT HELD IT.                                 00433002
*              .FREE DSENQ TABLE CORE.                                  00442002
*              .FREE INTERPRETER WORK AREA                              00451002
*              .CHECK IF SPECIAL RETURN PROVIDED.   IF YES, SET         00460002
*               UP FOR XCTL OR BR, AND TAKE SPECIAL EXIT.               00469002
*               IF NORMAL RETURN, RE-LOAD CALLER'S REGS AND EXIT.       00478002
*                                                                       00487002
*                                                                       00496002
*   NOTES                                                               00505002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00514002
*      DEPENDENCIES= NONE                                               00523002
*      RESTRICTIONS= NONE                                               00532002
*      REGISTER CONVENTIONS= REG11 - BASE REGISTER                      00541002
*                            REG12 - INTERPRETER WORK AREA PTR          00550002
*                            REG13 - REG SAVE AREA PTR                  00559002
*      PATCH-LABEL= PATCH                                               00568002
*                                                                       00577002
*                                                                       00586002
*   MODULE TYPE= BAL CSECT                                              00595002
*      PROCESSOR= ASSEMBLER                                             00604002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00613002
*                  KEY 0, PAGEABLE LPA                                  00622002
*                                                                       00631002
*                                                                       00640002
*   ENTRY POINT= IEFVHN FROM IEFVHH,IEFKG, AND  IEFVHQ                  00649002
*      PURPOSE= TO TERMINATE INTERPRETER                                00658002
*      LINKAGE= BALR AND BR 14                                          00667002
*      INPUT DATA= R12 - IWA PTR, R13 - RSA PTR                         00676002
*      REGISTERS SAVED= NONE                                            00685002
*      REGISTER CONTENTS DURING PROCESSING=                             00694002
*               R0  - WORK REG                                          00703002
*               R1  - PARMLIST PTR AND WORK REG                         00712002
*               R2  - NEL PTR                                           00721002
*               R3  - SUBROUTINE LINKAGE  AND WORK REG                  00730002
*               R4  - MSG AREA PTR AND WORK REG                         00739002
*               R5  - REG SAVE AREA INDEX REG                           00748002
*               R6  - SUBROUTINE LINKAGE AND WORK REG                   00757002
*               R7  - NEL EXIT LIST PTR                                 00766002
*               R8  - JCT BASE AND NEL EXIT LIST PTR                    00775002
*               R9  - MSG CODE AND WORK REG                             00784002
*               R10 - WORK REG                                          00793002
*               R11 - CSECT BASE REG                                    00802002
*               R12 - PTR TO INTERPRETER WORK AREA                      00811002
*               R13 - PTR TO REG SAVE AREA                              00820002
*               R14 - LINKAGE AND WORK REG                              00829002
*               R15 - LINKAGE AND WORK  REG                             00838002
*      REGISTERS RESTORED= R14-R12                                      00847002
*                                                                       00856002
*                                                                       00865002
*   EXIT - MORMAL= BR  14 TO INTERPRETER'S CALLER                       00874002
*      CONDITIONS= CLEAN UP PROCESSING COMPLETE                         00883002
*      OUTPUT DATA= R1 - PTR TO NEL, R15 - RETURN CODE                  00892002
*      RETURN CODES= ZERO(0) INDICATES INTERPRETATION SUCCESSFUL        00901002
*                                                                       00910002
*                                                                       00919002
*   EXIT - ERROR= BR 14 TO INTERPRETER'S CALLER                         00928002
*      CONDITIONS= CLEAN UP PROCESSING COMPLETE                         00937002
*      OUTPUT DATA= R1 - PTR TO NEL, R15 - RETURN CODE                  00946002
*      RETURN CODES=  4 - JCL ERROR                                     00955002
*                     8 - I/O ERROR                                     00964002
*                                                                       00973002
*                                                                       00982002
*   EXTERNAL REFERENCES=                                                00991002
*      ROUTINES= IEFKG                                                  01000002
*      DATA AREAS= IWA,QMPA                                             01009002
*      CONTROL BLOCKS= JCT,JMR,NEL                                      01018002
*      TABLE= NONE                                                      01027002
*      MACROS= IEFVMIWA,IEFAJCTB,IEFJMRIEFRELSE,FREEPOOL,MODID,XCTL,    01036002
*              IEFQMNGR,IEFNEL,DELETE,FREEMAIN,GETMAIN,RETURN           01045002
*      ENQUEUE RESOURCES= NONE                                          01054002
*                                                                       01072002
*                                                                       01081002
*   MESSAGES=                                                           01090002
*            IEF428I TERMINATED DUE TO I/O ERROR                        01099002
*            IEF452I JJJ JOB NOT RUN JCL ERROR                          01108002
*                                                                       01117002
*   CHANGE LEVEL = Y02668, Z40MPTH, OZ10444, G29AN2F, OZ27750  @ZA27750 01120003
*                                                                       01123003
*********************************************************************** 01126002
         EJECT                                                          01135002
         IEFCOMWA                                                       01250002
         IEFVMIWA                                                       01270002
         EJECT                                                          01300001
         IEFVMEWA                                                       01350001
ENDLAREA EQU   *                                                        01400001
         EJECT                                                          01450001
         EJECT                                                          01850001
JCTD     DSECT                                                          01900001
         IEFAJCTB                                                       01950001
     IEFJMR                                                             02000001
         EJECT                                                          02050001
         IEFZB9RD                                                       02070002
         EJECT                                                          02100001
         IEFQMNGR                                                       02150001
QPARMEND DS    0D                                                       02200001
         EJECT                                                          02250001
         IEFTXTFT                                                       02350002
         EJECT                                                          02750001
*********                                                               02800001
NELHERE  DSECT                                                          02850001
         IEFNEL  SUBCOM=I,EXITS=(RTN,QEP,SMF)                           02900002
         EJECT                                                          03000001
IEFVHN   CSECT                                                    M1865 03050001
* CODE ADDED TO VHNEXOUT ROUTINE                               @ZA10444 03070003
*                   RD=PTR TO CURRENT REG SAVE AREA                     03100001
*                                  AND CANNOT BE CLOBBERED              03150001
         BALR  RB,0                                                     03200001
         USING *,RB          *                                          03250001
*                                                                       03300001
*****************************************************************Y02668 03405002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 03410002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 03415002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 03420002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 03425002
         DC    C'VHN '             MOD ID USED BY TRACE.         Y02668 03430002
* TRACE RETURNS HERE.                                            Y02668 03435002
*****************************************************************Y02668 03440002
         B     HN1                 BRANCH AROUND ID.             Y02668 03450002
         MODID BR=NO                                             Y02668 03455002
*        DC    C'SU16'            FUNCTION ID                  @G16AP2F 03460003
*        DC    C'01'              LEVEL # (SU16)               @G16AP2F 03462003
         DC    C'02'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27750 03464003
HN1      DS    0H                                                Y02668 03480002
         EJECT                                                          03500002
*****************************************************************Y02668 03600002
*                                                               *Y02668 03700002
*  TERMINATION - RETURN CODE PROCESSING                         *Y02668 03800002
*                                                               *Y02668 03900002
*****************************************************************Y02668 04000002
         SPACE 2                                                 Y02668 04100002
VHN0010  DS    0H                                                Y02668 04200002
         L     R1,WORD(RD)         PICK UP PTR TO REG SAVE       Y02668 04300002
*                                  AREA OF INTERPRETER'S CALLER  Y02668 04400002
         CL    R1,IWASAVPT         IS THIS, IN FACT THE CORRECT  Y02668 04500002
*                                  SAVE AREA PTR(SAVED ON ENTRY  Y02668 04600002
*                                  BY NB903)                     Y02668 04700002
         BE    VHN0020             YES, CONTINUE TERMINATION     Y02668 04800002
*                                  NO, FREE EXCESS RSA AND CHECK Y02668 04900002
         IEFRELSE ,                NEXT BACKWARD CHAIN PTR       Y02668 05000002
         B     VHN0010             GO BACK AND CHECK AGAIN       Y02668 05100002
         SPACE 2                                                 Y02668 05200002
VHN0020  DS    0H                **RETURN CODE PROCESSING        Y02668 05300002
         L     R1,WORD(RD)         ADDRESS CALLER'S RSA          Y02668 05400002
         XC    SAVERF(WORD,R1),SAVERF(R1) ZERO RETURN CODE REG   Y02668 05500002
*                                  IN CALLER'S SAVE AREA         Y02668 05600002
         CLC   IWARET(2),IOERROR   TEMP *** I/O ERROR?/PGM CHK   Y02668 05700002
         BL    VHN0030             NO, CHECK FOR JCL ERROR       Y02668 05800002
         MVC   SAVERF+2(HALFWORD,R1),IWARET INITIALIZE CALLER'S  Y02668 05900002
*                                  REG15 TO I/O ERR RETURN CODE  Y02668 06000002
         B     VHN0040             CONTINUE TERMINATION          Y02668 06100002
VHN0030  DS    0H                                                Y02668 06200002
         LA    R2,JCT              GET PTR TO JCT                Y02668 06250002
         USING JCTD,R2             ADDRESSABILITY OF JCT         Y02668 06300002
         TM    JCTJSTAT,INCMSTS    WAS JOB FAILED                Y02668 06350002
         BZ    VHN0040             NO, THEREFORE, JOB IS         Y02668 06400002
         MVI   SAVERF+3(R1),JCLERROR INDICATE JCL ERROR IN       Y02668 06410002
         DROP  R2                                                Y02668 06420002
         LA    R2,WAJOBPFX         GET PTR TO SAVED JOB PFX      Y02668 06430002
         USING TEXT,R2             ADDRESSABILITY OF JOB PFX     Y02668 06440002
         TM    STRJINDC,JTXJOBFL   WAS JOB FAILED IN THE CONV.   Y02668 06450002
         BO    VHN0040             YES - NO MSG ISSUED           Y02668 06460002
         LA    R5,IEF452I          GET JCL ERROR MSG KEY         Y02668 06470002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 06480002
         BALR  RE,RF               GO ISSUE ERROR MSG            Y02668 06490002
*                                  SUCCESSFUL AND REG15=0        Y02668 06500002
*                                  CALLER'S REG15                Y02668 06700002
VHN0040  DS    0H                                                Y02668 06800002
         EJECT                                                   Y02668 06900002
*****************************************************************Y02668 07000002
*                                                               *Y02668 07100002
*  EXIT LIST PROCESSING - WTO PROCESSING                        *Y02668 07200002
*                                                               *Y02668 07300002
*****************************************************************Y02668 07400002
         SPACE 2                                                 Y02668 07500002
VHNEXLST DS    0H                                                       07600002
*              THE EXIT LIST ENTRY FOR THE ALTERNATE SWA       @G29AN2F 07600303
*              MANAGER FOR LOCATE MODE WAS SAVED BY IEFNB903   @G29AN2F 07600603
*              IN THE IWA. IF THE EXIT LIST NAME ENTRY HAS     @G29AN2F 07600903
*              THE NAME OF THE MODULE IN IT, THEN THE NAME     @G29AN2F 07601203
*              WILL BE LEFT JUSTIFIED IN THE FIELD AND PADDED  @G29AN2F 07601503
*              WITH BLANKS. THE DELETE WILL BE ISSUED          @G29AN2F 07601803
*              POINTING TO THE NAME                            @G29AN2F 07602103
         SPACE 1                                                        07602403
         L     R3,AOQLOCEP        ADDR OF ALT SWA MNGR LOC EP  @G29AN2F 07602703
         LTR   R3,R3              DOES THE ENTRY EXIST?        @G29AN2F 07603003
         BZ    VHNEXLS2           NO, TEST FOR ALT SWA MNGR    @G29AN2F 07603303
*                                 MOVE MODE                    @G29AN2F 07603603
         LA    R3,AOQLOCEX        ADDR OF EXIT LIST ENTRY      @G29AN2F 07603903
         USING NELEXENT,R3        ADDR OF EXIT LIST            @G29AN2F 07604203
         CLI   NELEXLK,NELEXNAM   DOES LIST HAVE 6 BYTE NAME?  @G29AN2F 07604503
         BNE   VHNEXLS2           NO, CHECK MOVE MODE          @G29AN2F 07604803
         BAL   RA,VHNDEL          GO DO DELETE                 @G29AN2F 07605103
         XC    AOQLOCEP,AOQLOCEP  ZERO ADDRESS TO AVOID SECOND @G29AN2F 07605403
*                                 DELETE                       @G29AN2F 07605703
VHNEXLS2 DS    0H                                              @G29AN2F 07606003
*                                                                Y02621 07608002
*              THE JOURNAL MERGE EXIT LIST ENTRY WAS SAVED BY    Y02621 07616002
*              IEFNB903 IN THE IWA.IF THE EXIT LIST ENTRY HAS THEY02621 07624002
*              NAME OF A MODULE IN IT,THEN THE NAME WILL BE LEFT Y02621 07632002
*              JUSTIFIED IN THE FIELD AND PADDED WITH BLANKS.THE Y02621 07640002
*              DELETE WILL BE ISSUED POINTING TO THE NAME.       Y02621 07648002
         SPACE 1                                                 Y02621 07656002
         L     R3,AOJMRGEP        ADDRESS OF EP TO JOURNAL MERGE Y02621 07664002
         LTR   R3,R3              DOES THE ENTRY EXIST?          Y02621 07672002
         BZ    VHNEXOUT           NO,BYPASS DELETION CODE        Y02621 07680002
         LA    R3,AOJRNLEX        ADDRESS OF EXIT LIST ENTRY     Y02621 07688002
         CLI   NELEXLK,NELEXNAM   DOES LIST HAVE 6 BYTE NAME?    Y02621 07696003
         BNE   VHNEXOUT           NO-NO NEED TO DELETE           Y02621 07706003
         BAL   RA,VHNDEL          GO DO DELETE                 @G29AN2F 07716003
         XC    AOJMRGEP,AOJMRGEP  ZERO ADDRESS TO AVOID SECOND @G29AN2F 07726003
*                                 DELETE                       @G29AN2F 07736003
         DROP  R3                 RELEASE REG                  @G29AN2F 07746003
VHNEXOUT DS    0H                                                Y02621 07768002
         EJECT                                                   Y02668 07776002
*****************************************************************Y02668 07800002
*                                                               *Y02668 07900002
*  SET UP NEL TO BE RETURNED TO INTERPRETER'S CALLER            *Y02668 08000002
*                                                               *Y02668 08100002
*****************************************************************Y02668 08200002
         SPACE 2                                                 Y02668 08300002
         L     R3,WANELPTR         GET PTR TO NEL                Y02668 08400002
         USING NELHERE,R3          ADDRESS NEL                   Y02668 08500002
         L     RE,NELQMPA          GET PTR TO QMPA IN CALLER'S   Y02668 08600002
*                                  CORE                          Y02668 08700002
         MVC   NONE(QMPALEN,RE),QPARM OVERLAY CALLER'S QMPA WITH Y02668 08800002
*                                  THE QMPA THE INTERPRETER USED Y02668 08900002
         LA    R2,JCT              GET PTR TO JCT                Y02668 09000002
         USING JCTD,R2             ADDRESS THE JCT               Y02668 09100002
         MVC   NELJCT(WORD),JCTDSKAD PUT THE SVA OF THE JCT      Y02668 09200002
*                                  INTO THE NEL                  Y02668 09300002
         DROP  R2                                                Y02668 09400002
         EJECT                                                   Y02668 09500002
*****************************************************************Y02668 09600002
*                                                               *Y02668 09700002
*  FREE I/O BUFFERS                                             *Y02668 09800002
*                                                               *Y02668 09900002
*****************************************************************Y02668 10000002
         SPACE 2                                                 Y02668 10100002
         L     R1,TEXTBUFP         GET ADDR OF INTERNAL TEXT     Y02668 10200002
*                                  BUFFER                        Y02668 10300002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 10330003
         BZ    VHN0050             BYPASS FREEMAIN IF PTR ZERO @ZA10444 10360003
         LA    R2,WORD*2           GET TXTBUF HEADER LENGTH      Y02668 10400002
         SR    R1,R2               PUSH TEXTBUF PTR BACK TO      Y02668 10430002
*                                  POINT TO TEXTBUF HEADER       Y02668 10460002
         LH    R0,TXTBUFLT         GET TEXT BUFFER LENGTH        Y02668 10500002
         BAL   RA,VHNFREE          FREE THE TEXT BUFFER          Y02668 10600002
         XC    TEXTBUFP,TEXTBUFP   ZERO POINTER SO WON'T TRY FREE       10620003
*                                  AGAIN IF ENTERED ON RETRY   @ZA10444 10640003
VHN0050  EQU   *                                               @ZA10444 10660003
*                                                                Y02668 10700002
         L     R1,AOWSTMT          GET ADDR OF SYSTEM OUTPUT     Y02668 10800002
*                                  BUFFER                        Y02668 10900002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 10930003
         BZ    VHN0055             BYPASS FREEMAIN IF PTR ZERO @ZA10444 10960003
         LA    R0,AOWBFLTH         GET BUFFER LENGTH             Y02668 11000002
         BAL   RA,VHNFREE          GO TO FREE SYSTEM OUTPUT BUF  Y02668 11100002
         XC    AOWSTMT,AOWSTMT     ZERO PTR AFTER BUFFER FREED @ZA10444 11106003
VHN0055  EQU   *                                               @ZA10444 11112003
         L     R1,WAMSGBUF         GET PTR TO MSG BUFFER         Y02668 11120002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 11126003
         BZ    VHN0060             BYPASS FREEMAIN IF PTR ZERO @ZA10444 11132003
         LA    R0,MSBUFLEN         GET MSG BUFFER LENGTH        YM00364 11140002
         BAL   RA,VHNFREE          GO TO FREE MSG BUFFER         Y02668 11160002
         XC    WAMSGBUF,WAMSGBUF   ZERO PTR AFTER BUFFER FREED @ZA10444 11170003
VHN0060  EQU   *                                               @ZA10444 11180003
         EJECT                                                   Y02668 11200002
*****************************************************************Y02668 11300002
*                                                               *Y02668 11400002
*  FREE CORE USED FOR TABLES AND WORK AREAS                     *Y02668 11500002
*  DELETE IEFUJV                                                *YM0581 11550002
*                                                               *Y02668 11600002
*****************************************************************Y02668 11700002
         SPACE 2                                                 Y02668 11800002
         TM    NELOPSWT,NELSMF     WAS A JMR CREATED FOR SMF     Y02668 11900002
*                                  PROCESSING                    Y02668 12000002
         BZ    VHN0100             NO, BYPASS FREEING OF         Y02668 12100002
*                                  JMR CODE                      Y02668 12200002
         L     R1,IWAJMRPT         GET ADDR OF JMR CORE          Y02668 12300002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 12330003
         BZ    VHN0100             BYPASS FREEMAIN IF PTR ZERO @ZA10444 12360003
         LA    R0,TABLEN           GET LENGTH OF GOTTEN CORE     Y02668 12400002
         BAL   RA,VHNFREE                                        Y02668 12500002
         XC    IWAJMRPT,IWAJMRPT   ZERO PTR AFTER BUFFER FREED @ZA10444 12520003
         DELETE EP=IEFUJV          DELETE USER ROUTINE.         YM00581 12550002
VHN0100  DS    0H                                                Y02668 12600002
         L     R1,DSENQTP          GET ADDR OF DSENQ TABLE       Y02668 12700002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 12730003
         BZ    VHN0110             BYPASS FREEMAIN IF PTR ZERO @ZA10444 12760003
         LA    R0,TABLEN           GET TABLE LENGTH              Y02668 12800002
         BAL   RA,VHNFREE          FREE THE DSENQ TABLE          Y02668 12900002
         XC    DSENQTP,DSENQTP     ZERO PTR AFTER BUFFER FREED @ZA10444 12930003
VHN0110  EQU   *                                               @ZA10444 12960003
*                                                                Y02668 13000002
         L     R1,CTRLWAP          GET ADDR OF LOCAL WORK        Y02668 13100002
*                                  AREA                          Y02668 13200002
         LTR   R1,R1               ALREADY FREE IF ZERO        @ZA10444 13230003
         BZ    VHN0120             BYPASS FREEMAIN IF PTR ZERO @ZA10444 13260003
         L     R0,IWALWLGN   LOAD LWA LENGTH FROM IWA TO FREE. @Z40MPTH 13300003
         BAL   RA,VHNFREE          FREE THE LOCAL WORK AREA      Y02668 13400002
         XC    CTRLWAP,CTRLWAP     ZERO PTR AFTER BUFFER FREED @ZA10444 13420003
VHN0120  EQU   *                                               @ZA10444 13440003
         L     R1,BUFADDR          GET 'TRACE ' RTN BUFFER ADDR  Y02668 13470002
         LTR   R1,R1               WAS 'TRACE' ACTIVE?           Y02668 13540002
         BZ    VHN0125             NO, GO TO FREE OTHER WORK AREAY02668 13610002
         LH    R0,BUFLTH           YES, GET BUFFER LENGTH        Y02668 13680002
         BAL   RA,VHNFREE          FREE THE 'TRACE' BUFFER       Y02668 13750002
VHN0125  DS    0H                                                Y02668 13820002
         EJECT                                                   Y02668 13900002
*****************************************************************Y02653 13903002
*                                                                Y02653 13906002
* DEACTIVATE THE ESTAE ENVIRONMENT OVER INTERPRETER              Y02653 13909002
*                                                                Y02653 13912002
*****************************************************************Y02653 13915002
         SPACE 1                                                        13918002
         L     R1,AOSTAPRM         ADDRESS OF USER PARAM AREA    Y02653 13921002
         LTR   R1,R1               WAS ESTAE ACTIVE?             Y02653 13924002
         BZ    VHN0150         NO IF POINTER IS ZERO-BYPASS      Y02653 13927002
*              FREEING THE USER AREA SINCE IT DOESN NOT EXIST,ANDY02653 13930002
*              BYPASS CANCELLING ESTAE SINCE IT WAS NOT ACTIVE.  Y02653 13933002
         LA     R0,EREPLEN        LENGHT OF USER PARMAETER LIST  Y02653 13936002
         BAL    RA,VHNFREE        FREE USER PARAMTER LIST        Y02653 13939002
         SPACE 1                                                        13942002
         ESTAE  0                                                Y02653 13945002
         SPACE 1                                                        13948002
VHN0150  DS    0H                                                Y02653 13951002
         EJECT                                                          13954002
*****************************************************************Y02668 13957002
*                                                               *Y02668 13960002
*  FREE THE IWA                                                 *Y02668 13963002
*                                                               *Y02668 13966002
*****************************************************************Y02668 13969002
         LR    R1,RC               GET ADDR OF IWA               Y02668 13972002
         LA    R0,WALTH            GET IWA LENGTH.               Y02668 13975002
         BAL   RA,VHNFREE          GO TO FREE IWA                Y02668 13978002
         EJECT                                                          13984002
*****************************************************************Y02668 14000002
*                                                               *Y02668 14100002
*  RESTORE CALLER'S REGS AND EXIT                               *Y02668 14200002
*                                                               *Y02668 14300002
*****************************************************************Y02668 14400002
         SPACE 2                                                 Y02668 14500002
         IEFRELSE  ,               RESTORE CALLER'S RSA PTR      Y02668 14600002
         RETURN (14,12)            RETURN TO INTERP'S CALLER     Y02668 14700002
         EJECT                                                          14800002
*****************************************************************Y02668 14900002
*                                                               *Y02668 15000002
*  SUBROUTINE TO CLEAR CORE                                     *Y02668 15100002
*              R0 - LENGTH OF CORE TO FREE                      *Y02668 15200002
*              R1 - ADDRESS OF CORE TO BE FREED                 *Y02668 15300002
*                                                               *Y02668 15400002
*****************************************************************Y02668 15500002
         SPACE 2                                                        15600002
VHNFREE  DS    0H                                                Y02668 15700002
         FREEMAIN  R,LV=(0),A=(1)  FREE CORE AS REQUESTED        Y02668 15800002
         BR    RA                  RETURN TO CALLER              Y02668 15900002
         SPACE 4                                                        15905003
***************************************************************@G29AN2F 15910003
*                                                              @G29AN2F 15915003
*   SUBROUTINE TO DELETE EXIT LIST ENTRY POINT                 @G29AN2F 15920003
*                                                              @G29AN2F 15925003
*              R3 - ADDRESS OF NEL EXIT LIST ENTRY             @G29AN2F 15930003
*                                                              @G29AN2F 15935003
***************************************************************@G29AN2F 15940003
         SPACE 2                                                        15945003
VHNDEL   DS    0H                                              @G29AN2F 15950003
         USING NELEXENT,R3       SET UP ADDRESSABILITY         @G29AN2F 15955003
         MVC   ZERO(MVSIX,R3),NELEXEP  LEFT JUSTIFY NAME IN FIELDY02621 15960003
         MVC   SIX(MVTWO,R3),BLANK2  PAD FIELD WITH BLANKS       Y02621 15965003
         DROP  R3                                                Y02621 15970003
         SPACE 1                                                        15975003
         DELETE EPLOC=(3)         DELETE JOURNAL MERGE ROUTINE   Y02621 15980003
         SPACE 1                                                        15985003
         BR    RA                 RETURN TO CALLER             @G29AN2F 15990003
         EJECT                                                          16000002
*****************************************************************Y02668 16100002
*                 DECLARED STORAGE                              *Y02668 16200002
*****************************************************************Y02668 16300002
IOERROR  DC    X'0008'             TEMP***                              16400002
TXTBUFLT DC    H'8192'             8K INTERNAL TEXT BUFFER       Y02668 16500002
BLANK2   DC    X'4040'       BLANKS TO PAD MODULE NAME                  16550002
BUFLTH   DC    H'2048'             'TRACE' BUFFER LENGTH         Y02668 16620002
*****************************************************************       16700002
*                                                               *       16800002
*                        EQUATES                                *       16900002
*                                                               *       17000002
*****************************************************************       17100002
         SPACE 2                                                        17200002
MSBUFLEN EQU   160       MSG BUF LEN                             Y02668 17360002
WORD     EQU   4                                                 Y02668 17500002
SAVERF   EQU   16                  DISPL OF R15 IN SAVE AREA     Y02668 17700002
HALFWORD EQU   2                                                 Y02668 17800002
JCLERROR EQU   4                   JCL ERROR RETURN CODE         Y02668 18100002
QMPALEN  EQU   32                                                Y02668 18300002
AOWBFLTH EQU   90                                                Y02668 18600002
TABLEN   EQU   176                                               Y02668 18800002
NONE     EQU   0                                                 Y02668 19000002
ZERO     EQU   0                                                 Y02668 19020002
SIX      EQU   6                                                 Y02668 19040002
MVSIX    EQU   6                                                 Y02668 19060002
MVTWO    EQU   2                                                 Y02668 19080002
IEF452I  EQU   6                   JCL ERROR MSG KEY             Y02668 19084002
*****************************************************************Y02668 19086002
*                 VCONS                                         *Y02668 19088002
*****************************************************************Y02668 19090002
IEFVHRV  DC    V(IEFVHR)           WTO RTN                       Y02668 19092002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 19094002
         END   IEFVHN                                                   19100002
./  ADD  SSI=80300052,NAME=IEFVHQ
         TITLE 'IEFVHQ'                                                 00400017
*********************************************************************** 00800002
*                                                                       00900002
*   MODULE NAME= IEFVHQ                                                 01000002
*                                                                       01100002
*   DESCRIPTIVE NAME= SWA MANAGER INTERFACE                             01200002
*                                                                       01300002
*   COPYRIGHT= N/A                                                      01400002
*                                                                       01500002
*   STATUS= VS2 SU16 - IN THIS MODULE, SU 16 SUPPORTS          @G16AP2F 01600003
*           VPSS SUPPORT (SU 29 - @G29AN2E & @G29AN2F).        @G16AP2F 01630003
*           MERGE SU4,10,16 CODE TO REL 037 PTF                @ZA27753 01660003
*                                                                       01700002
*   FUNCTION= GENERAL DESCRIPTION:                                      01800002
*             IEFVHQ PROVIDES AN INTERFACE BETWEEN EITHER THE           01900002
*             CONVERTER OR INTERPRETER AND THE SWA MANAGER.             02000002
*             IT ALSO PROVIDES AN INTERFACE BETWEEN THE INTER- @G29AN2F 02100003
*             PRETER AND THE ALTERNATE SWA MANAGERS FOR MOVE   @G29AN2F 02130003
*             MODE AND LOCATE MODE.  (THE ALTERNATE SWA MANAGER@G29AN2F 02160003
*             FOR MOVE MODE IS SOMETIMES REFERRED TO AS THE    @G29AN2F 02190003
*             JOURNAL MERGE ROUTINE.)                          @G29AN2F 02220003
*                                                                       02300002
*             SWA SUPPORT:                                              02400002
*             FOR SWA SUPPORT,ALL TRACK STACKING CODE HAS               02500002
*             BEEN REMOVED.                                             02600002
*             ERROR PROCESSING CODE HAS BEEN SUBSTITUTED WITH           02700002
*             NEW ERROR CONDITION CODE.                                 02800002
*                                                                       02900002
*      OPERATION= IEFVHQ RECEIVES CONTROL VIA A BALR.          @G29AN2E 03000003
*                                                              @G29AN2E 03050003
*                MOVE MODE PROCESSING WILL BE DONE             @G29AN2E 03100003
*                IF AOSWALOC IS TURNED OFF IN THE COMWA.       @G29AN2E 03150003
*                LOCATE MODE PROCESSING WILL BE DONE IF        @G29AN2E 03200003
*                AOSWALOC IS TURNED ON.                        @G29AN2E 03250003
*                                                              @G29AN2E 03300003
*                IF PROCESSING IN THE MOVE MODE IS TO BE DONE, @G29AN2E 03350003
*                IT LOADS REGISTER 1 WITH THE ADDRESS OF THE   @G29AN2E 03400003
*                QMPA AND BRANCHES TO THE SWA MANAGER MOVE     @G29AN2E 03450003
*                MODE VIA THE IEFQMREQ MACRO.  IF IEFVHQ FINDS @G29AN2E 03500003
*                THAT A JOURNAL MERGE ROUTINE EXISTS, IT WILL  @G29AN2E 03550003
*                BRANCH TO THE JOURNAL MERGE ROUTINE INSTEAD   @G29AN2E 03600003
*                OF GOING TO THE SWA MANAGER.                  @G29AN2E 03650003
*                                                              @G29AN2E 03700003
*                IF PROCESSING IN THE LOCATE MODE IS TO BE     @G29AN2E 03750003
*                DONE, IT LOADS REGISTER 1 WITH THE ADDRESS OF @G29AN2E 03800003
*                THE PARAMETER LIST (POINTED TO BY AOLOCPL IN  @G29AN2E 03850003
*                THE COMWA) AND BRANCHES TO THE SWA MANAGER    @G29AN2E 03900003
*                LOCATE MODE. IF IEFVHQ FINDS THAT AN          @G29AN2F 03950003
*                ALTERNATE SWA MANAGER FOR LOCATE MODE EXISTS, @G29AN2F 04000003
*                IT WILL BRANCH TO IT INSTEAD OF THE DEFAULT   @G29AN2F 04050003
*                SWA MANAGER FOR LOCATE MODE (IEFQB555).       @G29AN2F 04100003
*                                                                       04900002
*   NOTES                                                               05000002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              05100002
*      DEPENDENCIES= NONE                                               05200002
*      RESTRICTIONS= NONE                                               05300002
*      REGISTER CONVENTIONS= REGISTERS SAVED 14-12                      05400002
*      PATCH-LABEL= N/A                                                 07100002
*                                                                       07200002
*   MODULE TYPE= BAL                                                    07300002
*      PROCESSOR= ASSEM                                                 07400002
*      MODULE SIZE= N/A                                                 07500002
*      ATTRIBUTES= NCAL,RENT,REFR,XREF,LIST                             07600002
*                                                                       07700002
*   ENTRY POINT= IEFVHQ                                                 07800002
*      PURPOSE= PROVIDE SWA MANAGER INTERFACE                           07900002
*      LINKAGE= BALK TO ENTRY POINT ADDRESS                             08000002
*      INPUT DATA= IWA DATA IN FORM OF QMPA POINTER.                    08100002
*                  COMWA DATA:                                 @G29AN2E 08120003
*                    AOLOCPL    ADDR OF LOCATE PARM LIST       @G29AN2E 08140003
*                    AOSWALOC   LOCATE MODE FLAG               @G29AN2E 08160003
*      REGISTERS SAVED= 14-12                                           08200002
*      REGISTER CONTENTS DURING PROCESSING= (SEE REGISTER CONVENTIONS)  08300002
*      REGISTERS RESTORED= 14-12                                        08400002
*                                                                       08500002
*   EXIT - NORMAL= RETURN TO CALLER                                     08600002
*      CONDITIONS= SWA MOVE MODE REQUEST HANDLED SUCCESSFULLY @G29AN2E  08700003
*      OUTPUT DATA= QMPA RE-INITIALIZED                                 08800002
*      RETURN CODES= ZERO                                               08900002
*                                                                       09000002
*   EXIT - ERROR= NONE                                                  09100002
*      CONDITIONS= NONE                                                 09200002
*      OUTPUT DATA= NONE                                                09300002
*      RETURN CODES= NONE                                               09500002
*                                                                       09600002
*   EXTERNAL REFERENCES=                                                09700002
*      ROUTINES= IEFQB555                                      @G29AN2E 09800003
*      DATA AREAS= IWA,COMWA                                   @G29AN2E 09850003
*      CONTROL BLOCKS= JCT,CVT,JESCT,QMPA                               10000002
*      TABLE= NONE                                                      10100002
*      MACROS= IEFVMIWA,IEFQMNGR,IEFAJCTB,CVT,IEFJESCT,IEFQMREQ         10200002
*      ENQUEUE RESOURCES= NONE                                          10300002
*      CHANGE LEVEL= Y02621,OZ11352,G29AN2E,G29AN2F,OZ27753    @ZA27753 10400003
*                                                                       10500002
*   MESSAGES= NONE                                                      10600002
*                                                                       10700002
*********************************************************************** 10800002
         EJECT                                                          10900002
         IEFCOMWA                                                Y02668 17600002
         EJECT                                                          18880002
         CVT                                                            18960002
         EJECT                                                          19040002
         IEFJESCT                                                       19120002
         EJECT                                                          19200017
         IEFQMNGR                                                       19600017
         EJECT                                                          19900002
********* E Q U A T E S ******************************************M2551 20550001
VHQ2     EQU   2                                                  M2551 20600001
VHQ7     EQU   7                                               @ZA11352 20650003
VHQ8     EQU   8                                               @ZA11352 20700003
         EJECT                                                          20800017
IEFVHQ   CSECT                                                          21200017
*                   RD=PTR TO CURRENT REG SAVE AREA                     22400017
* CODE ADDED AFTER LABEL H16A                                  @ZA11352 22450003
         SAVE  (14,12)                                                  22800017
         BALR  RB,0                                                     23200017
         USING *,RB          *                                          23600017
         USING IOPARAMS,R1   *                                          24000017
*****************************************************************Y02668 24005002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 24010002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 24015002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 24020002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 24025002
         DC    C'VHQ '             MOD ID USED BY TRACE.         Y02668 24030002
* TRACE RETURNS HERE.                                            Y02668 24035002
*****************************************************************Y02668 24040002
         B     HQ1                 BRANCH AROUND ID.             Y02668 24050002
         MODID BR=NO                                             Y02668 24450002
*        DC    C'SU16'             FUNCTION ID AND             @G16AN2F 25950003
*        DC    C'01'               LEVEL # (SUBSYS)            @G29AN2E 25970003
         DC    C'02'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27753 25990003
HQ1      DS    0H                                                Y02668 26050003
         ST    RD,IWASACHN         SAVE - SAVE AREA POINTER     YM02701 26100003
         LA    RD,IWAIOSA          GET SAVE AREA POINTER        YM02701 26150003
         TM    AOSW4,AOSWALOC      SWA LOCATE MODE REQUESTED?  @G29AN2E 26200003
         BO    HQL1                YES, GO PROCESS LOCATE MODE @G29AN2E 26250003
H14      DS    0H                                                       27200017
         L     R1,QPARMP                Q-MGR PARMLIST POINTER          27600017
         L     RF,AOJMRGEP LOAD ADDR OF JOURNAL MERGE INTERFACE  Y02621 28800002
         LTR   RF,RF   DOES A JOURNAL MERGE INTERFACE RTN EXIST? Y02621 29200002
         BZ    H16   NO,USE SWA MANAGER INTERFACE AS DEFAULT.    Y02621 29600002
         BALR  RE,RF  GO TO JOURNAL MERGE INTERFACE TRN.         Y02621 38820002
         B     H16A   CONTINUE PROCESSING                        Y02621 38840002
H16      DS    0H                                                       38850002
*              CALL THE SWA MANAGER VIA THE QMREQ MACRO.         Y02621 38860002
         SPACE 1                                                        38900002
         IEFQMREQ                                                       38940002
         SPACE 1                                                        38980002
H16A     DS    0H                                                       39040002
*        RE-SET QMPA VALUES                                             39160002
         L     R1,QPARMP                Q-MGR PARMLIST POINTER          39200017
         CLI   QMPOP,QMREAD        WAS FUNCTION READ?          @ZA11352 39220003
         BNE   H22                 NO, BYPASS                  @ZA11352 39240003
         L     R2,QMPCL            GET ADDR OF EXT PARMLIST    @ZA11352 39260003
         IC    R3,QMPCL            GET # OF BLOCKS             @ZA11352 39280003
         N     R3,HQANDOFF         TURN OFF HI ORDER BITS      @ZA11352 39300003
H20      EQU   *                                               @ZA11352 39320003
         MVI   VHQ7(R2),X'00'      CLEAR BLOCKID FIELD IF READ @ZA11352 39340003
* TO PREVENT INCORRECT IDENTIFICATION OF NEXT BLOCK WRITTEN    @ZA11352 39360003
         BCTR  R3,R0               DECREMENT # RECORDS READ    @ZA11352 39380003
         LTR   R3,R3               DONE CLEARING BLOCKIDS?     @ZA11352 39400003
         BZ    H22                                             @ZA11352 39420003
         LA    R2,VHQ8(R2)         PT TO NEXT ENTRY IN EXT PARM@ZA11352 39440003
         B     H20                 GO CLEAR NEXT BLOCKID       @ZA11352 39460003
H22      EQU   *                   SET QMPA FOR ASSUMED NEXT FUNCT.     39480003
*                                                              @ZA11352 39500003
         MVI   QMPCM,X'11'              SET ASSIGN 1 & WRITE 1          39600017
         MVI   QMPOP,QMWRTA             SET FOR WRITE & ASSIGN          40000017
         B     HQEXIT                                          @G29AN2E 40400003
         EJECT                                                 @G29AN2E 40450003
***************************************************************@G29AN2E 40500003
*                                                             *@G29AN2E 40550003
*    SWA MANAGER LOCATE MODE INTERFACE                        *@G29AN2E 40600003
*                                                             *@G29AN2E 40650003
***************************************************************@G29AN2E 40700003
         SPACE 2                                               @G29AN2E 40750003
HQL1     DS    0H                                              @G29AN2E 40800003
         L     R1,AOLOCPL          REG1 PTS TO PARM LIST       @G29AN2E 40850003
         L     RF,AOQLOCEP         LOAD ADDR OF ALTERNATE      @G29AN2F 40900003
*                                  LOCATE MODE SWA MANAGER     @G29AN2F 40950003
         LTR   RF,RF               DOES ALTERNATE EXIST?       @G29AN2F 41000003
         BZ    HQL2                NO, USE IEFQB555            @G29AN2F 41050003
         BALR  RE,RF               YES, GO TO ALTERNATE        @G29AN2F 41100003
         B     HQL3                CONTINUE PROCESSING         @G29AN2F 41150003
HQL2     DS    0H                                              @G29AN2F 41200003
         L     RF,CVTPTR(R0,R0)    ESTABLISH ADDRESSABILITY    @G29AN2E 41250003
         USING CVTMAP,RF           FOR CVT                     @G29AN2E 41300003
         L     RF,CVTJESCT         ESTABLISH ADDRESSABILITY    @G29AN2E 41350003
         USING JESCT,RF            FOR JESCT                   @G29AN2E 41400003
         L     RF,JESWAA           GET ADDR SWA MGR LOCATE MODE@G29AN2E 41450003
         BALR  RE,RF               GO TO IEFQB555              @G29AN2E 41500003
         DROP  RF                                              @G29AN2E 41550003
HQL3     DS    0H                                              @G29AN2F 41600003
         NI    AOSW4,X'FF'-AOSWALOC TURN OFF LOCATE MODE SWITCH@G29AN2F 41650003
         SPACE 3                                               @G29AN2E 41700003
HQEXIT   DS    0H                                              @G29AN2E 41750003
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER   @G29AN2F 41800003
         RETURN (14,12),T          RETURN TO CALLER                     41850003
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 41900003
HQANDOFF DC    X'0000000F'       CLEAR # OF RECORDS TO ASSIGN  @ZA11352 41950003
         END                                                            42000003
./  ADD  SSI=31771903,NAME=IEFVHR
*/*                                                                     00020002
**********************************************************************  00030002
*                                                                       00040002
*   MODULE NAME= IEFVHR                                                 00050002
*                                                                       00060002
*   DESCRIPTIVE NAME= OPERATOR MESSAGE MODULE                           00070002
*                                                                       00080002
*   COPYRIGHT= V/A                                                      00090002
*                                                                       00100002
*   STATUS= OS/VS2 RELEASE 2                                            00110002
*                                                                       00120002
*   FUNCTION= IEFVHR WRITES ERROR MESSAGES TO THE OPERATOR              00130002
*      OPERATION= WHEN IEFVHR RECEIVES CONTROL, REGISTER 5 CONTAINS     00140002
*                 THE MESSAGE CODE.  THIS CODE IS USED AGAINST A LOOK   00150002
*                 UP TABLE TO ISSUE THE CORRECT WTO. RETURN TO CALLER.  00160002
*                                                                       00200002
*   NOTES                                                               00210002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00220002
*      DEPENDENDIES= NONE                                               00230002
*      RESTRICTIONS= NONE                                               00240002
*      REGISTER CONVENTIONS= R0-RF                                      00250002
*      PATCH-LABEL= PATCH                                               00260002
*                                                                       00270002
*   MODULE TYPE= PROCEEDURE                                             00280002
*      PROCESSOR= ASSEMBLER                                             00290002
*      MODULE SIZE= 1150                                                00300002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00310002
*                                                                       00320002
*   ENTRY POINT= IEFVHR                                                 00330002
*      PRUPOSE= ISSUE OPERATOR MESSAGES                                 00340002
*      LINKAGE= LOAD VCON AND BRANCH REGISTER                           00350002
*      INPUT DATA= MESSAGE POINTER (REG.5) IWA POINTER (REG. 12)        00360002
*      REGISTERS SAVED= 14,12                                           00370002
*      REGISTER CONTENTS DURING PROCESSING=                             00380002
*   REGISTERS RESTORED= 14,12                                           00390002
*                                                                       00400002
*   EXIT - NORMAL= BRANCH REGISTER 14                                   00410002
*      CONDITIONS= MESSAGE IS WRITTEN TO OPERATOR                       00420002
*      OUTPUT DATA= NONE                                                00430002
*      RETURN CODES= NONE                                               00440002
*                                                                       00450002
*   EXET - ERROR= NONE                                                  00460002
*                                                                       00550002
*   EXTERNAL REFERENCES=                                                00560002
*      ROUTINES= NONE                                                   00570002
*      DATA AREAS= IWA,CWA                                              00580002
*      CONTROL BLOCKS= UCB                                              00590002
*      TABLE= JCT                                                       00600002
*      MACROS=SAVE,IEFSAVER,LINK,FREEMAIN,GETMAIN,WTO,IEFRELSE,RETURN   00610002
*      ENQUEUE RESOURCES= NONE                                          00620002
*      CHANGE LEVEL=                                                    00630002
*                                                                       00640002
*   MESSAGES=                                                           00650002
*                                                                       00660002
**********************************************************************  00670002
**/                                                                     00680002
         EJECT                                                          00740000
         IEFCOMWA                                                Y02668 00760002
         EJECT                                                          00860000
HIUCB    DSECT                                                          00880000
         IEFUCBOB                                                       00900000
         EJECT                                                          00906002
WTOBUFER DSECT                                                     MCS  00908018
         USING WTOBUFER,R3                                         MCS  00909018
         DS    0D                                                  MCS  00910018
TEXT     DS    18F                     MESSAGE WROK AREA           MCS  00911018
         ORG   WTOBUFER                                                 00912018
TEXT1    DS    CL25                MSGLGTH,MCSFLGS,MSGTXT AREA         *00913018
                                     XMCS                               00914018
UCBNM    DS    CL3                 UCBNM FILLER FOR MSG6               *00915018
                               XMCS                                     00916018
TEXT2    DS    11F                REST OF MSG TEXT,ROUTCDES AND DESCS   00917018
*                                                                  XMCS 00918018
*********                                                               00919018
*                                                                       00920018
*********                                                               00921018
PARAM    DSECT                                                          00922018
         USING PARAM,R2                                                 00923018
         DS    0D                                                  XMCS 00924018
UCBPTR   DS    F                   UCB POINTER                     XMCS 00925018
TABPTR   DS    F                   JOBNAME LOC PTR                 XMCS 00926018
NUMENTRY DS    F                   NUMBER OF ENTRIES               XMCS 00927018
JOBNM    DS    2F                  JOBNAME                         XMCS 00928018
UNUSED   DS    F                                                   XMCS 00929018
*                                                                       00930018
         ORG   UCBPTR                                                   00931018
FLAG     DS    CL1                 USER COUNT SWITCH               XMCS 00932018
PTR      DS    CL3                 UCB PTR                         XMCS 00933018
D4       EQU   4                                                 A30871 00933320
D17      EQU   17                                                A30871 00933620
*********                                                               00934018
*                                                                       00935018
IEFVHR   CSECT                                                          00936018
         SAVE  (14,12)                                                  00960000
         BALR  RB,0                                                     00980000
         USING *,RB                                                     01000000
*****************************************************************Y02668 01002002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01004002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01006002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01008002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01010002
         DC    C'VHR '             MOD ID USED BY TRACE.         Y02668 01012002
* TRACE RETURNS HERE.                                            Y02668 01014002
*****************************************************************Y02668 01016002
         B     HR1                                                      01020000
         MODID BR=NO                                             Y01886 01070001
         DC    C'SPLT'             FUNCTION ID AND               Y02668 01080002
         DC    C'02'               LEVEL # (NEL CODE DELETION).  Y02668 01090002
         DC    C'MVM'              FUNCTION ID AND               Y02668 01091002
         DC    C'10'         LEVEL # ( MSG3 AND MSG5 FIX )      YM00372 01092002
HR1      DS    0H                                                       01100000
         IEFSAVER SAVEPTR                                               01120000
         GETMAIN R,LV=96           AREA FOR WTOBUF AND PARAMLIST   XMCS 01140018
         LA    R2,72(R1)           PARAM LIST PTR                  XMCS 01160018
         LR    R3,R1               WTO BUFFER PTR                  XMCS 01180018
         XC    0(96,R1),0(R1)      CLEAR OUT AREAS                 XMCS 01200018
*                                                                       01600000
*        PREPARE FOR ERROR MSG WRITE TO OPERATOR                        01620000
*                                                                       01640000
HR12     DS    0H                                                       01660000
         BCTR  R5,0                    MINUS 1                          01680000
         LR    R4,R5                                                    01700000
         SLA   R5,2                    TIMES 4                          01720000
         LA    R6,RTABLE                MSG TABLE                       01740000
         L     R7,0(R5,R6)             MSG LOCATION                     01760000
         LH    R5,0(R7)                LENGTH OF MESSAGE           MCS  01770018
         A     R5,THREE                PLUS ROUTCDE AND DESC LEN   MCS  01780018
         EX    R5,MOVE                                             MCS  01790018
HR3      DS    0H                                                       01840000
         LA    R6,RTEXT            DISPLACEMENT TABLE              XMCS 01850018
         AR    R6,R4                                               XMCS 01860018
         SR    R5,R5               CLEAR REGISTER                       01870018
         IC    R5,0(R6)            AMOUNT OF DISPL.                XMCS 01880018
         AR    R5,R3               REG5 PTS TO WHERE JOBNAME MUST BEMCS 01890018
*                                  FILLED IN                       XMCS 01900018
         MVC   0(8,R5),WAJBNAME    ENTER JOBNAME INTO MESSAGE.   Y02668 01920002
ISSUE1   DS    0H                                                       01948018
         SR    R0,R0                                               GMCS 01952018
         C     R0,IWACONID         ANY CONSOLE ID PTR              GMCS 01956018
         BE    ISSUE2              NO, DEFAULT TO MASTER CONSOLE   GMCS 01960018
         L     R1,IWACONID         PTR TO CONSOLE ID               GMCS 01964018
         IC    R0,0(R1)            CONSOLE ID                      GMCS 01968018
ISSUE2   DS    0H                                                       01972018
         WTO   MF=(E,(3))                                               01980000
HR331    DS    0H                                                PTM725 02420000
         IEFRELSE SAVEPTR                                               02440000
         LR    R1,R3               RESET PTR TO GOTTEN CORE        XMCS 02460018
         FREEMAIN R,LV=96,A=(1)                                    XMCS 02480018
         RETURN (14,12)                                           M1977 02500001
MOVE     MVC   TEXT(0),0(R7)                                            03070018
RTABLE   DS    0F                                                       03080000
         DC    A(MSG1)                                                  03100000
         DC    A(MSG2)                                           Y02668 03120002
         DC    A(MSG3)                                                  03140000
         DC    A(MSG4)                                                  03160000
         DC    A(MSG5)                                                  03180000
         DC    A(MSG6)                                           Y02668 03240002
RTEXT    DS    0F                                                  XMCS 03316018
         DC    AL1(39)             MSG1                          Y02668 03326002
         DC    AL1(53)             MSG2                          Y02668 03396002
         DC    AL1(43)             MSG3                         YM00372 03466002
         DC    AL1(65)             MSG4                          Y02668 03536002
         DC    AL1(71)             MSG5                         YM00372 03606002
         DC    AL1(12)             MSG6                          Y02668 03636002
MSG1     WTO   'IEF677I WARNING MESSAGE(S) FOR JOB          ISSUED',   $03676002
               MF=L,MCSFLAG=(REG0),DESC=(4),ROUTCDE=(2)                 03746002
MSG2     WTO   'IEF417I PROCLIB DEVICE I/O ERROR READING FOR JOB       *03816002
                 ',MF=L,ROUTCDE=(2,10),MCSFLAG=(REG0),DESC=(4)          03895018
*                                                                  XMCS 03904018
*                                                                       03914018
MSG3     WTO   'IEF430I RESTART STEP NOT FOUND FOR JOB         ',      *03924002
               MF=L,MCSFLAG=(REG0),DESC=(4),ROUTCDE=(2)                 03964002
MSG4     WTO   'IEF679I DEVICE I/O ERROR CONVERTING/INTERPRETING JCL FO*04004002
               R JOB         ',                                        *04044002
               MF=L,MCSFLAG=(REG0),DESC=(4),ROUTCDE=(2,10)              04084002
MSG5     WTO   'IEF680I DEVICE I/O ERROR WRITING TO SYSTEM MESSAGE DATA*04124002
               SET FOR JOB         ',                                  *04164002
               MF=L,MCSFLAG=(REG0),DESC=(4),ROUTCDE=(2,10)              04204002
MSG6     WTO   'IEF452I          JOB NOT RUN - JCL ERROR',             *04234002
               MF=L,MCSFLAG=(REG0),DESC=(4),ROUTCDE=(2,10)              04264002
RETCD    EQU   8                   R/I TERMINAL ERROR            A38453 04315001
RETCDREG EQU   16                  DISPLACEMENT TO RETURN CODE    M1977 04317001
THREE    DC    F'3'                                                     04380018
XMSGB    DC    A(5)                                                     04420018
SIX      DC    F'6'                    SPOOL FULL AND WAITING CODE 0416 04460018
*                                      MINUS ONE                   0416 04480018
CON11    DC    H'11'               MESSAGE 12 CONSTANT             AACA 04510017
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 04517002
         END                                                            04520000
./  ADD  SSI=80300054,NAME=IEFVH1
         TITLE 'IEFVH1'                                                 00050001
**********************************************************************  00060002
*                                                                       00070002
*                                                                       00080002
*MODULE NAME= IEFVH1                                                    00100001
*                                                                       00110002
*DESCRIPTIVE NAME= CONVERTER INITIALIZATION ROUTINE                     00150002
*                                                                       00160002
*COPYRIGHT= N/A                                                         00200001
*                                                                       00210002
*STATUS= VS2 SU16 - IN THIS MODULE, SU 16 SUPPORTS             @G16APPK 00250003
*        VPSS SUPPORT (SU 29 - @G29AN2E).                      @G16APPK 00253003
*        MERGE SU4,10,16 CODE TO REL 037 PTF                   @ZA27753 00256003
*                                                                       00260002
*                                                                       00270002
*FUNCTION= THIS MODULE PERFORMS INITIALIZATION FOR THE CONVERTER.       00300002
*          IT SETS UP THE ESTAE ENVIRONMENT OVER THE CONVERTER.         00310002
*          IT GETS AND INITIALIZES THE CONVERTER WORK AREA,             00350002
*          AS WELL AS INITIALIZING  OTHER  CONTROL                      00410002
*          BLOCKS.                                                      00450002
*                                                                       00502002
*    OPERATION=                                                         00510002
*             .CORE IS GOTTEN FOR THE ESTAE PARAMETER LIST              00510802
*             .CORE IS GOTTEN FOR THE USER PARAMETER LIST               00511202
*             .ESTAE LIST IS MOVED TO THE GOTTEN CORE                   00511602
*             .ESTAE MACRO (EXECUTE FORM) IS ISSUED.                    00511702
*             .GETS AND CLEARS CONVERTER WORK AREA                      00512002
*             .INITIALIZE R12 WITH CONV WORK AREA PTR                   00514002
*             .CWA ADDRESS IS STORED INTO ESTAE USER PARAM AREA         00514402
*             .INITIALIZE NEL PTR IN CONV WORK AREA                     00516002
*             .SAVE CALLER'S REG SAVE AREA ADDR IN CONV WORK AREA       00518002
*             .GET INPUT STMT BUFFER AND SAVE ADDR IN CONV WORK AREA    00518402
*             .GET INTERNAL TEXT BUFFER AND SAVE ADDR IN CWA            00518502
*             .PUT PROCLIB DCB PTR IN CONV WORK AREA                    00518802
*             .GET PROCEDURE STMT BUFFER AND SAVE ADDR IN CONV WORK     00519202
*              AREA                                                     00519602
*             .GET MESSAGE BUFFER AND SAVE ADDR IN CWA FOR IEFVGM       00523202
*             .GET AND CLEAR CORE FOR LOCAL WORK AREA AND INITIALIZE    00528002
*              LWA PTR IN CWA                                           00531602
*             .GET , CLEAR, AND CHAIN REG SAVE AREA                     00535202
*              PUT PTR TO CONVERTER REG SAVE AREA IN CWA                00538802
*             .MOVE QMPA PASSED BY CALLER INTO CWA                      00542402
*             .CHECK IF SMF IS FUNCTIONAL.  IF YES,                     00546002
*              GET CORE FOR JMR, MOVE JMR FOR THE JOB INTO IT           00549602
*              AND INITIALIZE SYSTEM ID AND SMF OPTION FIELDS IN IT.    00553202
*              SAVE JMR PTR IN CWA.                                     00556802
*             .CHECK FOR ACCOUNTING RTN EXIT; IF YES STORE PTR IN CWA   00560402
*             .CHECK FOR SPECIAL FIND EXIT; IF YES SET FLAG AND STORE   00564002
*              PTR IN CWA.                                              00567602
*             .CHECK FOR SPECIAL SWA-MANAGER ENTRY; IF YES, SET FLAG    00571202
*              AND STORE PTR IN CWA                                     00574802
*             .GET BUFFER FOR STMTS THAT ARE BEING PUT TO SYSOUT.       00578402
*              SAVE BUFFER PTR IN CWA.                                  00582002
*             .ALLOCATE VIRTUAL STORAGE FOR SSOB AND SSIB      @G29AN2E 00582903
*              AND STORE PTR IN CWA                            @G29AN2E 00583803
*             .INITIALIZE SSOB AND SSIB                        @G29AN2E 00584703
*             .EXIT                                                     00585602
*                                                                       00589202
*                                                                       00592802
*NOTES                                                                  00596402
*    CHARACTER-CODE DEPENDENCIES= EBCDIC                                00600001
*    DEPENDENCIES=NONE                                                  00650001
*    RESTRICTIONS=NONE                                                  00700001
*    REGISTER-CONVENTIONS=                                              00750002
*               R11 - MODULE BASE                                       00760002
*               R12 - CONVERTER WORK AREA PTR                           00770002
*               R13 - REG SAVE AREA PTR                                 00780002
*    PATCH-LABEL= PATCH                                                 00800002
*                                                                       00850002
*                                                                       00860002
*MODULE TYPE= BAL CSECT                                                 00900002
*    PROCESSOR= ASSEMBLER                                               00950002
*    ATTRIBUTES=REFRESHABLE,PRIVILEGED,KEY 0, PAGEABLE LPA              01050002
*                                                                       01070002
*                                                                       01100001
*ENTRY POINT= IEFVH1 FROM JOB ENTRY SUBSYSTEM OR MASTER SUBSYSTEM       01150002
*    PURPOSE= NORMAL ENTRY TO INITIALIZE FOR CONVERTER PROCESSING       01200002
*    LINKAGE= LINK                                               Y02668 01250002
*    INPUT DATA= REG 1 POINTS TO NEL                                    01300001
*                REG 13 POINTS TO SUPERVISOR REG SAVE AREA              01350002
*    REGISTERS SAVED= R14-R12                                           01400001
*    REGISTER CONTENTS DURING PROCESSING=                               01450002
*              R0  - WORK REG                                           01460002
*              R1  - PTR TO NEL AND WORK REG                            01470002
*              R2  - WORK REG                                           01480002
*              R3  - NEL BASE REG                                       01490002
*              R4  - WORK REG                                           01492002
*              R5  - WORK REG                                           01494002
*              R6  - WORK REG                                           01496002
*              R7  - WORK REG                                           01498002
*              R8  - UNUSED                                             01498402
*              R9  - UNUSED                                             01498802
*              R10 - LOCAL WORK AREA BASE AND SUBRTN LINKAGE REG        01499202
*              R11 - MODULE BASE REG                                    01499602
*              R12 - CONVERTER WORK AREA PTR                            01499702
*              R13 - REG SAVE AREA PTR                                  01499802
*              R14 - LINKAGE AND WORK REG                               01499902
*              R15 - LINKAGE AND WORK REG                               01516602
*    REGISTERS RESTORED= NONE                                           01533302
*                                                                       01550002
*                                                                       01600001
*EXIT - NORMAL= IEFVHA                                                  01650002
*    CONDITIONS= ALL TABLES AND CONTROL BLOCKS HAVE BEEN SET UP.        01700001
*                READY TO GET 1ST STMT FROM JCL DATA SET.               01750002
*    OUTPUT DATA= REG 12 POINTS TO CWA, REG 13 POINTS TO RSA            01850002
*    RETURN CODES= NONE                                                 01900001
*                                                                       01950001
*                                                                       01960002
*EXIT - ERROR=  N/A                                                     02000002
*   CONDITIONS=  N/A                                                    02050002
*   OUTPUT DATA=  N/A                                                   02100002
*   RETURN CODES= NONE                                                  02200002
*                                                                       02250001
*                                                                       02500001
*EXTERNAL REFERENCES                                                    02550001
*   ROUTINES=  NONE                                                     02600002
*   DATA AREAS=  CONVERTER WORK AREA, LOCAL WORK AREA ,ESTAE USER       02750002
*                PARAMETER LIST                                         02800002
*   CONTROL BLOCKS= NEL, QMPA, JMR, SSOB, SSIB                 @G29AN2E 02850003
*   TABLES=  NONE                                                       03500002
*   MACROS= GETMAIN, CALL, FREEMAIN,  LOAD, SAVE,                       03700002
*           IEFSAVER, IEFRELSE, RETURN,IEFZB9RD.                        03750002
*   ENQUEUE  RESOURCES= NONE                                            03800002
*   CHANGE LEVEL= Y02668,Y02653,G29AN2E                        @G29AN2E 03850003
*                                                                       03900001
*                                                                       03910002
*MESSAGES=  NONE                                                        03950002
*                                                                       04000002
*********************************************************************** 04050001
         EJECT                                                          04100001
         IEFCOMWA                                                Y02668 04150002
         IEFCVRWA                                                Y02668 04200002
         EJECT                                                          04250001
         IEFVMEWA                                                       04300001
ENDLAREA EQU   *                                                        04350001
         EJECT                                                          04400001
         IEFVMDWA   NA                                                  04450001
         EJECT                                                          04500001
         IEFVMJWA  NA                                                   04550001
LNGTHAWA EQU   ENDAWA-QLINKWA           LENGTH OF AWA                   04600001
LNGJACT  EQU   JACT-JASW1              RELATIVE ADDR OF ACT             04650001
LNGSIOT  EQU   SIOT-DWA            SIOT OFFSET IN DD LWA.               04700001
LNGJFCB  EQU   JFCB-DWA            JFCB OFFSET IN DD LWA.               04750001
LNGJFCBX EQU   JFCBX-DWA           JFCBX OFFSET IN DD LWA.              04800001
         EJECT                                                          04850001
         EJECT                                                          05000001
         EJECT                                                          05150001
DTGM     DSECT                                                    20001 05200001
DTUNPK   DS    D                                                  20001 05250001
DTCVT    EQU   DTUNPK                                                   05300001
DTMASK   EQU   *                                                        05350001
DTDATE   DS    8C                                                       05400001
DTDOT2   DS    1C                      PERIOD                           05450001
DTTIME   DS    7C                       TIME                            05500001
DTDOT3   DS    1C                      PERIOD                           05550001
DTCTR    DS    5C                       INTERPRETER CTR                 05600001
DTDOT4   DS    1C                                                       05650001
         DCBD  DSORG=(PS)                                               05700001
         EJECT                                                          05750001
         IEFQMNGR                                                       05800001
         IFGRPL                                                         05820002
QPARMEND DS    0D                                                       05850001
         EJECT                                                          05900001
         EJECT                                                          06050001
         EJECT                                                          06200001
         EJECT                                                          06350001
NELHERE    DSECT                                                        06400001
         IEFNEL   SUBCOM=C,EXITS=(TXT,RTN,QEP,SMF,IAM,FAM)              06500002
         EJECT                                                          06550001
         IEESMCA                                                        06600001
         EJECT                                                          06650001
         IEFJMR                                                         06700001
         EJECT                                                          06750001
         IEFZB9RD                                                       06760002
         EJECT                                                          06770002
H1CVT    DSECT                                                          06800001
         CVT                                                            06850001
         EJECT                                                          06900001
         IEFJSSIB                                              @G29AN2E 06950003
         EJECT                                                          07000003
         IEFJSSOB (CI)                                         @G29AN2E 07050003
         EJECT                                                          07800001
IEFVH1   CSECT                                                          07850002
         ENTRY TRACE                                                    07900002
*****************************************************************Y02668 07950002
*                                                                Y02668 08050002
*  STANDARD LINKAGE CONVENTIONS                                  Y02668 08150002
*                                                                Y02668 08250002
*****************************************************************Y02668 08350002
         SPACE 2                                                 Y02668 08450002
         SAVE  (14,12)                                           Y02668 08550002
         BALR  RB,0                SET UP MODULE                 Y02668 08650002
         USING *,RB                ADDRESSABILITY                Y02668 08750002
         B     VH10010                                           Y02668 08850002
         MODID BR=NO                                                    08950002
*        DC    C'SU16'             FUNC ID                     @G16APPK 09050003
         DC    C'01'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27753 09100003
VH10010  DS    0H                                                Y02668 09450002
         LR    R3,R1               SAVE NEL ADDR, FOR R1         Y02668 09550002
         USING NELHERE,R3          CLOBBERED BY GETMAIN          Y02668 09650002
         MODESET  MODE=SUP         GET INTO SUPERVISOR MODE      Y02668 09700002
         EJECT                                                          09750002
*****************************************************************Y02668 09850002
*                                                               *Y02668 09950002
*  GET CORE FOR WORK AREAS AND INITIALIZE                       *Y02668 10050002
*                                                               *Y02668 10150002
*****************************************************************Y02668 10250002
         SPACE 2                                                 Y02668 10350002
         IEFSAVER  ,               GET CONVERTER SAVE AREA       Y02668 10450002
*****************************************************************Y02668 10510002
*                                                               *Y02668 10517002
*  CALCULATE CORE NEEDED FOR CWA+LWA+JCL STMT BUFFER+SYSOUT     *Y02668 10524002
*  STMT BUFFER+MSG BUFFER+TEXTBUFFER+SSOB+SSIB AND ISSUE       @G29AN2E 10531003
*  ONE BIG GETMAIN.                                            @G29AN2E 10531703
*  THIS ENABLES CONVERTER TERMINATION TO ISSUE ON BIG FREEMAIN. *Y02668 10532403
*                                                                       10533103
*                                                                       10533803
*  THE LARGE VIRTUAL STORAGE AREA THAT IS GETMAINED IS USED   *@G29AN2E 10534503
*  FOR THE FOLLOWING IN THIS ORDER:                           *@G29AN2E 10535203
*                                                             *@G29AN2E 10535903
*        COMWA                -COMMON WORK AREA               *@G29AN2E 10536603
*        CVRWA/IWA            -CONVERTER/INTERPRETER WORKAREA *@G29AN2E 10537303
*        LWA                  -LOCAL WORKAREA (JWA/EWA/DWA)   *@G29AN2E 10538003
*        STMT BUFFER          -INPUT BUFFER FOR JCL STMT      *@G29AN2E 10538703
*        INTERNAL TEXT BUFFER                                 *@G29AN2E 10539403
*        SYSTEM OUTPUT BUFFER -OUTPUT BUFFER FOR JCL STMT     *@G29AN2E 10540103
*        MESSAGE BUFFER       -FOR ERROR MESSAGE              *@G29AN2E 10540803
*        SSOB                 -FOR SUBSYS KEY PROCESSING      *@G29AN2E 10541503
*        SSIB                 -FOR SUBSYS KEY PROCESSING      *@G29AN2E 10542203
*                                                             *@G29AN2E 10542903
*                                                             *@G29AN2E 10543603
*  JMR AND PROC BUF ARE OPTIONAL AND THEREFORE GOTTEN SEPARATELY*Y02668 10545002
*****************************************************************Y02668 10552002
         SPACE 2                                                 Y02668 10559002
         LH    R2,TXTBUFLT         GET TEXT BUFFER LENGTH        Y02668 10566002
         LA    R2,WALTH(R2)        ADD WORK AREA LENGTH.         Y02668 10573002
         LA    R2,WRKAREAS(R2)     ADD OTHER WORK AREA LENGTHS   Y02668 10580002
         LA    R2,SSOBLN19(R2)     ADD LENGTH OF SSOB          @G29AN2E 10582003
         LA    R2,SSIBSIZE(R2)     ADD LENGTH OF SSIB          @G29AN2E 10584003
         LR    R0,R2               SET UP FOR GETMAIN            Y02668 10587002
         BAL   RA,VH1GAC           GET CORE FOR WORK AREAS       Y02668 10594002
         EJECT                                                   Y02668 10601002
*****************************************************************Y02668 10608002
*                                                               *Y02668 10615002
* START INITIALIZATION - DIVIDE LARGE AREA OF GOTTEN CORE       *Y02668 10622002
*                                                               *       10629002
*****************************************************************Y02668 10636002
         SPACE 2                                                 Y02668 10643002
         LR    RC,R1               INITIALIZE R12 TO POINT TO CWAY02668 10650002
*                                  R12 PTS TO CWA THRU LIFE OF   Y02668 10750002
*                                  CONVERTER                     Y02668 10850002
         ST    R2,WAWRKLTH         SAVE GETMAIN LENGTH FOR       Y02668 10880002
*                                  WORK AREA FREEMAIN IN VHF     Y02668 10910002
         LA    R0,WALTH            LOAD WORK AREA LENGTH.        Y02668 10950002
         ST    R0,CWAL             SAVE LENGTH IN 1ST WORD       Y02668 11050002
         MVC   CWAID,ID            INITIALIZE CWA IDENTIFIER     Y02668 11150002
         ST    R3,WANELPTR         SAVE NEL PTR IN CWA           Y02668 11250002
         ST    RD,SAVEPTR          SAVE PTR TO CURRENT SAVE AREA Y02668 11350002
         MVC   CWASAVPT(WORDLEN),WORDLEN(RD)   SAVE PTR TO       Y02668 11380002
*                                  CALLER'S SAVE AREA            Y02668 11410002
         L     R0,IEFVHFV          GET PTR TO  CONVERTER         Y02668 11450002
*                                  TERMINATION ROUTINE           Y02668 11550002
         ST    R0,TERMRTN          SAVE IN CWA FOR C/I           Y02668 11650002
*                                  COMMON ROUTINES               Y02668 11750002
         L     R0,NELPROCB         GET PROCLIB DCB PTR           Y02668 11850002
         ST    R0,PDCBP            SAVE PROCLIB DCB PTR IN CWA   Y02668 11950002
         MVC   CWACONID(WORDLEN),NELCOMID INIT CWA WITH CONSOLE  Y02668 12050002
*                                  ID PTR-USED BY WTO            Y02668 12150002
         LA    R1,WALTH(RC)        CALC ADDR OF LOCAL WORK AREA. Y02668 12250002
*                                  AREA BY BUMPING PTR TO THE    Y02668 12310002
*                                  END OF THE CWA                Y02668 12370002
*                                  AND CLEAR IT                  Y02668 12450002
         ST    R1,CTRLWAP          SAVE PTR TO LWA IN CWA        Y02668 12550002
         MVC   CWALABEL(LEN1),NELLABEL   SAVE LABEL PROCESSING   Y02668 12950002
*                                  OPTION BYTE IN CWA-THIS OPTIONY02668 13050002
*                                  MUST BE PASSED TO THE INTERP  Y02668 13150002
*                                  VIA JOB STRING PREFIX         Y02668 13250002
         MVI   CWAMSLEN,MSGLEN     INDICATE MSG LENGTH TO IEFVGM Y02668 13350002
        EJECT                                                           13450002
*****************************************************************Y02653 13453002
*                                                                Y02653 13456002
*  SETUP ESTAE ENVIRONMENT OVER CONVERTER                        Y02653 13459002
*                                                                Y02653 13462002
*****************************************************************Y02653 13465002
         SPACE 2                                                        13468002
         L     R0,LENESTAE        GET CORE FOR ESTAE LIST FORM   Y02653 13471002
         BAL   RA,VH1GAC           GET CORE ROUTINE.             Y02653 13474002
         LR    R5,R1               ADDRESSABILITY FOR LIST FORM  Y02653 13477002
         L     R4,LENESTAE         LENGTH OF LIST FORM FOR MOVE  Y02653 13480002
         BCTR  R4,0          DECREMENT FOR MOVE INTO CORE.      YM02681 13481002
         EX    R4,MVESTAE          MOVE LIST TO GOTTEN CORE      Y02653 13483002
         LA    R0,EREPLEN          LENGHT OF USER PARAMETER AREA Y02653 13486002
         BAL   RA,VH1GAC           GET CORE FOR PARAMETER AREA   Y02653 13489002
         LR    R4,R1               ADDRESSABILITY FOR PARAM AREA Y02653 13492002
         ST    R4,AOSTAPRM         ADDRESS OF USER PARAM AREA    Y02653 13495002
         USING EREPL,R4             ADDRESSABILITY TO USER AREA  Y02653 13498002
         ST    RC,EREPLCWA      CWA ADDR IN PARAM AREA FOR ESTAE Y02653 13501002
         MVC   EREPLRSV(LEN4),CWASAVPT  ADDR OF CALLERS S/A      Y02653 13504002
         DROP  R4                  DROP REGISTER 4               Y02653 13507002
         L     R6,IEFNB9CR         ADDRESS OF ESTAE EXIT.        Y02653 13510002
*                                                                Y02653 13513002
         ESTAE (6),PARAM=(4),MF=(E,(5))                          Y02653 13516002
         LTR   RF,RF              WAS ESTAE SUCCESSFUL?          Y02653 13519002
         BZ    VH10020            YES IF REG15 IS ZERO           Y02653 13522002
*        IF ESTAE WAS NOT SUCCESSFUL. FREE THE USER PARAMETER    Y02668 13522402
*        AREA AND ZERO THE POINTER TO IT IN THE CWA              Y02668 13522802
*                                                                Y02668 13523202
         L     R1,AOSTAPRM         ADDRESS OF USER AREA GOTTEN   Y02668 13523602
         LA    R0,EREPLEN          LENGTH OF USER AREA           Y02668 13524002
         FREEMAIN R,LV=(0),A=(1)   FREE USER PARAMETER LIST      Y02668 13524402
         XC    AOSTAPRM(4),AOSTAPRM     ZERO USER PARMETER LIST  Y02653 13525002
*              POINTER TO SIGNAL THAT ESTAE DOES NOT EXIST.      Y02653 13528002
VH10020  DS    0H                                                Y02653 13531002
*        FREE ESTAE EXIT LIST IN GOTTEN CORE                     Y02668 13534002
         LR    R1,R5               ADDRESS OF LIST IN CORE       Y02668 13537002
         L     R0,LENESTAE         LENGTH OF LIST IN CORE        Y02668 13540002
         FREEMAIN R,LV=(0),A=(1)   FREE LIST                     Y02668 13543002
         EJECT                                                   Y02668 13546002
*****************************************************************Y02668 13550002
*                                                               *Y02668 13650002
*  SET UP QMPA AND JMR IN CONVERTER'S CORE                      *Y02668 13750002
*  LOAD IEFUJV                                                  *YM0581 13800002
*                                                               *Y02668 13850002
*****************************************************************Y02668 13950002
         SPACE 2                                                 Y02668 14050002
         L     R1,NELQMPA          GET POINTER TO QMPA PASSED BY Y02668 14150002
*                                  THE CONVERTER'S CALLER        Y02668 14250002
         MVC   QPARM(QMPALEN),0(R1) MOVE QMPA INTO CWA           Y02668 14350002
         LA    R0,QPARM            GET ADDR OF SWA MANAGER PARM  Y02668 14450002
*                                  AREA IN CWA                   Y02668 14550002
         ST    R0,QPARMP           INIT CWA PTR FIELD FOR VHQ    Y02668 14650002
         TM    NELOPSWT,NELSMF     IS SMF BEING USED             Y02668 14750002
         BZ    VH1IOBUF            NO, SKIP JMR PROCESSING       Y02668 14850002
         LA    R0,JMRLEN           GET JMR LENGTH                Y02668 14950002
         BAL   RA,VH1GAC           GET CORE AND CLEAR FOR JMR    Y02668 15050002
         USING JMR,R1              ADDRESS NEWLY GOTTEN CORE     Y02668 15150002
         L     RE,NELJMR           GET JMR POINTER FROM NEL      Y02668 15250002
         MVC   JMRJOB(JESSJMR),DISPL0(RE) MOVE JMR TO CONVRTR'S  Y02668 15350002
*                                  CORE-THIS IS DONE SO THAT WHENY02668 15450002
*                                  THE SMF USER EXIT IS TAKEN,   Y02668 15550002
*                                  THE USER DOES NOT LOOK AT     Y02668 15650002
*                                  JESS CORE.                    Y02668 15750002
         ST    R1,CWAJMRPT         SAVE PTR TO JMR IN CWA        Y02668 15850002
         LOAD  EP=IEFUJV           LOAD USER ROUTINE.           YM00581 15950002
         L     R1,CWAJMRPT         RESTORE R1,DESTROYED BY LOAD YM00581 16350002
         ST    R0,JMRUJVP          SAVE ADDR IN JMR.            YM00581 16750002
         MVI   JMRSTEP,STEP1       START OFF WITH STEP 1         Y02668 17150002
         DROP  R1                                                       17550002
         EJECT                                                   Y02668 17650002
*****************************************************************Y02668 17750002
*                                                               *Y02668 17850002
*  GET I/O BUFFERS AND INITIALIZE PTRS IN CWA                   *Y02668 17950002
*                                                               *Y02668 18050002
*****************************************************************Y02668 18150002
         SPACE 2                                                 Y02668 18250002
VH1IOBUF DS    0H                                                Y02668 18350002
         L     R6,NELPROCB         GET PROCLIB DCB PTR FROM NEL  Y02668 18450002
         LTR   R6,R6               HAS A PROCLIB BEEN SPECIFIED  Y02668 18550002
*                                  FOR THIS JOB                  Y02668 18650002
         BZ    VH10100             NO, DO NOT GET PROC BUFFER    Y02668 18750002
         USING IHADCB,R6           ADDRESS DCB                   Y02668 18850002
         LH    R0,DCBBLKSI         USE MAX BLKSIZE AS PROCEDURE  Y02668 19350002
*                                  BUFFER LENGTH                 Y02668 19450002
         BAL   RA,VH1GAC           GET AND CLEAR PROC BUFFER     Y02668 19550002
         ST    R1,PSTMT            SAVE PTR IN CWA               Y02668 19650002
         ST    R1,CWABPROC         SAVE PTR TO BLOCKED PROC BUFF Y02668 19750002
         DROP  R6                                                Y02668 19850002
VH10100  DS    0H                                                       19950002
         L     R1,CTRLWAP          GET PTR TO LOCAL WORKAREA     Y02668 20150002
         LA    R1,LEWA(R1)         CALCULATE THE END ADDR OF THE Y02668 20250002
*                                  LWA-THIS IN TURN IS THE       Y02668 20350002
*                                  BEGINNING OF THE STMT BUFFER  Y02668 20450002
         ST    R1,RSTMT            SAVE PTR IN CWA               Y02668 20550002
         LA    R1,JCLLEN(R1)       INCREMENT THE JCL STMT BUFFER Y02668 20650002
*                                  PTR BY THE BUFFER LENGTH TO   Y02668 20710002
*                                  GET A PTR TO THE TEXT BUFFER  Y02668 20770002
         LA    R2,DBLWORD(R1)      ALLOW DOUBLE WORD AT BEGINNINGY02668 20850002
*                                  OF THE TEXT BUFFER FOR AN     Y02668 20854002
*                                  IDENTIFIER AND LENGTH FIELD   Y02668 20858002
         LH    RF,TXTBUFLT         GET BUFFER LENGTH             Y02668 20862002
         ST    RF,BYTE0(R1)        PUT LENGTH IN HEADER          Y02668 20866002
         MVC   WORDLEN(WORDLEN,R1),TEXTID PUT ID IN BUFFER       Y02668 20870002
         ST    R2,TEXTBUFP         SAVE PTR TO 1ST AVAIL BYTE    Y02668 20874002
         AH    R1,TXTBUFLT         GET BUFFER END ADDRESS        Y02668 20880002
         ST    R1,TENDP            SAVE END ADDRESS              Y02668 20910002
*                                  THE END ADDRESS OF THE        Y02668 20950002
*                                  INTERNAL TEXT BUFFER IS       Y02668 21050002
*                                  THE BEGINNING ADDRESS OF      Y02668 21150002
*                                  THE SYSTEM OUTPUT BUFFER      Y02668 21250002
         ST    R1,AOWSTMT          STORE PTR IN CWA              Y02668 21350002
         LA    R1,AOWBFLTH(R1)     THE END ADDR OF THE SYSTEM    Y02668 21370002
*                                  OUTPUT BUFFER IS THE          Y02668 21380002
*                                  BEGINNING ADDR OF THE         Y02668 21390002
*                                  MESSAGE BUFFER                Y02668 21400002
         ST    R1,WAMSGBUF         SAVE PTR TO MSGBUF IN CWA     Y02668 21430002
         LA    R1,MSBUFLEN(R1)     THE END ADDR OF THE MESSAGE @G29AN2E 21450003
*                                  BUFFER IS THE BEGINNING ADDR@G29AN2E 21460003
*                                  OF THE SSOB                 @G29AN2E 21470003
         ST    R1,AOSSOB           SAVE PTR TO SSOB            @G29AN2E 21480003
         LA    R1,SSOBLN19(R1)     THE END ADDR OF THE SSOB IS @G29AN2E 21490003
*                                  THE BEGINNING OF THE SSIB   @G29AN2E 21500003
         ST    R1,AOSSIB           SAVE PTR TO SSIB            @G29AN2E 21510003
         EJECT                                                          21520003
*****************************************************************Y02668 21550002
*                                                               *Y02668 21650002
*  EXIT LIST PROCESSING                                         *Y02668 21750002
*                                                               *Y02668 21850002
*****************************************************************Y02668 21950002
         SPACE 2                                                 Y02668 22050002
         L     R7,NELEXLST         GET PTR TO EXIT LIST FROM NEL Y02668 22150002
         USING NELEXITS,R7         ADDRESS EXIT LIST             Y02668 22250002
         LTR   R7,R7               IS THERE AN EXIT LIST         Y02668 22350002
         BZ    VH1EXEND            NO EXIT LIST - CONTINUE       Y02668 22450002
         SR    R6,R6               CLEAR REG 6 FOR LOAD          Y02668 22460002
         LH    R6,NELEXLEN         GET LENGTH OF EXIT LIST       Y02668 22470002
         DROP  R7                                                       22480002
         SRA   R6,3                DIVIDE BY 8 TO GET            Y02668 22490002
*                                  NUMBER OF ENTRIES             Y02668 22500002
         BCTR  R6,R0               DECREMENT NO. BY ONE TO       Y02668 22510002
*                                  ACCT. FOR 8 BYTE HEADER       Y02668 22520002
VH10200  DS    0H                                                Y02668 22530002
         LA    R7,DBLWORD(R7)      BUMP PTR PASSED EXIT LIST     Y02668 22540002
*                                  HEADER                        Y02668 22550002
         CLI   EXITID(R7),NELTXTEX IS THIS THE POST SCAN TEXT    Y02668 22560002
*                                  EXIT                          Y02668 22570002
         BNE   VH10300             NO, GO TO CHECK NEXT ENTRY    Y02668 22580002
         ST    R7,CWATXTEX         YES, SAVE ENTRY PTR IN CWA    Y02668 22590002
         CLI   LINKID(R7),NELEXNAM POST SCAN EXIT BY MOD NAME ? YM00373 22590902
         BNE   VH10400             NO TXT EXIT PROCESSED        YM00373 22591802
         LA    R0,LINKLTH          YES GET LINK DATA LENGTH     YM00373 22592702
         ST    R0,CWALINKL         SAVE LENGTH FOR FREE AT TERM YM00373 22593602
         BAL   RA,VH1GAC           GET STORAGE FOR LINK         YM00373 22594502
         ST    R1,CWALINK          SAVE PTR FOR VFA             YM00373 22595402
         MVC   0(LINKLTH,R1),VH1LINK  INIT STORAGE FOR VFA LINK YM00373 22596302
         MVC   CWAPSENM(R6),EXITNAME(R7) SAVE EXIT NAME FOR VFA YM00373 22597202
         MVI   CWAPSENM+6,C' '     PAD NAME                     YM00373 22598102
         MVI   CWAPSENM+7,C' '     WITH BLANKS                  YM00373 22599002
         B     VH10400             TXT EXIT PROCESSED -         YM00385 22600002
VH10300  DS    0H                                                Y02668 22610002
         CLI   EXITID(R7),NELFAMEX IS THIS THE SPECIAL FIND RTN YM00385 22611002
*                                  EXIT                         YM00385 22612002
         BNE   VH10400             NO, CONTINUE SEARCH          YM00385 22613002
         OI    IWAEXTS,IWASFIND    INDICATE YES IN CWA          YM00385 22614002
         MVC   IWAFINDP,LEN5(R7)   MOVE FIND ENTRY POINT        YM00385 22615002
*                                  TO CWA TO BE USED BY VFA     YM00385 22616002
VH10400  DS    0H                                               YM00385 22617002
*                                  CONTINUE PROCESSING LIST     YM00385 22618002
         BCT   R6,VH10200          DECREMENT NO. OF ENTRIES BY 1 Y02668 22620002
VH1EXEND DS    0H                                                Y02668 22630002
         EJECT                                                   Y02668 22750002
*****************************************************************Y02668 22850002
*                                                               *Y02668 22950002
*  CONVERTER INITIALIZATION COMPLETE, EXIT TO GET JCL STATEMENT *Y02668 23050002
*                                                               *Y02668 23150002
*****************************************************************Y02668 23250002
         SPACE 2                                                 Y02668 23350002
         L     RF,IEFVHAV          CONVERTER GET RTN ADDR        Y02668 23450002
         BR    RF                  EXIT TO START GETTING JCL     Y02668 23550002
*                                  STATEMENTS                    Y02668 23650002
         EJECT                                                   Y02668 25350002
*****************************************************************Y02668 25450002
*                                                               *Y02668 25550002
*  ROUTINE TO GET AND CLEAR CORE                                *Y02668 25650002
*                                                               *Y02668 25750002
*****************************************************************Y02668 25850002
         SPACE 2                                                 Y02668 25950002
VH1GAC   DS    0H                                                Y02668 26050002
         STM   R4,R7,12(RD)        SAVE REGS CLOBBERED BY MVCL   Y02668 26100002
         LR    R5,R0               PUT LENGTH IN ODD REG FOR MVCLY02668 26150002
         GETMAIN  R,LV=(0)         GET REQUESTED CORE            Y02668 26230002
         LR    R4,R1               SET UP TARGET OF MVCL AND     Y02668 26310002
*                                  PRESERVE REG1 FOR RETURN      Y02668 26390002
         SR    R7,R7               INDICATE PADDING CHAR OF 0    Y02668 26470002
*                                  FOR MVCL AND OBJECT COUNT OF 0Y02668 26550002
         SR    R6,R6               INDICATE NO MVCL OBJECT ADDR  Y02668 26630002
         MVCL  R4,R6               CLEAR REQUESTED CORE          Y02668 26710002
         LM    R4,R7,12(RD)        RESTORE REGS CLOBBERED        Y02668 26750002
*                                  BY MOVE CHAR LONG(MVCL)       Y02668 26790002
         BR    RA                                                Y02668 26850002
         EJECT                                                          35850001
**********************************************************************  35900001
*                         E Q U A T E S                              *  35950001
**********************************************************************  36000001
IWAL1    EQU   X'FFF'              IWA LENGTH.                   Y02028 36150002
TABLEN   EQU   176               LENGTH OF TABLES                       36250001
EXITLEN  EQU   16                LENGTH OF NEL EXIT LIST                36300001
ENDNEL   EQU   X'80'             INDICATES END OF NEL                   36350001
WORDLEN  EQU   4                 LENGTH OF FULL WORD                    36400001
DBLWORD  EQU   8                 LENGTH OF DOUBLE WORD                  36450001
HWORDLEN EQU   2                 LENGTH OF HALF WORD                    36500001
PARMLEN  EQU   12                LENGTH OF PARM LIST FOR IEEVSMSG       36550001
ERRMSG13 EQU   13                MSG CODE FOR MSG IEE                   36600001
NELLEN6  EQU   24                LENGTH OF 6 WORD NEL                   36650001
SAVELEN  EQU   72                LENGTH OF SAVE AREA                    36700001
QMPALEN  EQU   32                LENGTH OF QMPA                         36750001
MSGLEN   EQU   90                  STMT/MSG LENGTH               Y02668 36800002
MAINUCB  EQU   X'FF'             INDICATES MAIN UCB                     36850001
ERRCODE  EQU   4                 ERROR CODE FOR IEFVHN                  36900001
CHARA    EQU   C'A'              DEFAULT MSG CLASS                      36950001
BLANK    EQU   C' '              CHARACTER BLANK -X'40'                 37000001
NAMELEN  EQU   8                 LENGTH OF NAME                         37050001
ENTRYLEN EQU   8                 LENGTH OF NEL EXIT LIST ENTRIES        37100001
WORKLEN  EQU   16                LENGTH OF WORK AREA FOR EXTRACT        37150001
BITS3    EQU   3                 SHIFT 3 BITS                           37200001
BITS4    EQU   4                 SHIFT 4 BITS                           37250001
BITS7    EQU   7                 SHIFT 7 BITS                           37300001
BITS24   EQU   24                SHIFT 24 BITS                          37350001
HWORD0   EQU   0                 DISPLACEMENT                           37400001
WORD0    EQU   0                 DISPLACEMENT                           37450001
WORD1    EQU   4                 DISPLACEMENT                           37500001
WORD2    EQU   8                 DISPLACEMENT                           37550001
WORD3    EQU   12                DISPLACEMENT                           37600001
WORD4    EQU   16                DISPLACEMENT                           37650001
WORD6    EQU   24                DISPLACEMENT                           37700001
BYTE0    EQU   0                 DISPLACEMENT                           37750001
BYTE1    EQU   1                 DISPLACEMENT                           37800001
BYTE2    EQU   2                 DISPLACEMENT                           37850001
BYTE3    EQU   3                 DISPLACEMENT                           37900001
BYTE26   EQU   26                DISPLACEMENT                           37950001
BYTE27   EQU   27                DISPLACEMENT                           38000001
DISPL0   EQU   0                 DISPLACEMENT                           38050001
DISPL1   EQU   1                 DISPLACEMENT                           38100001
DISPL3   EQU   3                 DISPLACEMENT                           38150001
DISPL4   EQU   4                 DISPLACEMENT                           38200001
DISPL6   EQU   6                 DISPLACEMENT                           38250001
DISPL7   EQU   7                 DISPLACEMENT                           38300001
LEN0     EQU   0                 LENGTH                                 38350001
LEN1     EQU   1                 LENGTH                                 38400001
LEN2     EQU   2                 LENGTH                                 38450001
LEN3     EQU   3                 LENGTH                                 38500001
LEN4     EQU   4                 LENGTH                                 38550001
LEN5     EQU   5                 LENGTH                                 38600001
LEN6     EQU   6                 LENGTH                                 38650001
LEN8     EQU   8                 LENGTH                                 38700001
LEN11    EQU   11                LENGTH                                 38750001
LEN12    EQU   12                LENGTH                                 38800001
LEN40    EQU   40                LENGTH                                 38850001
LEN84    EQU   84                LENGTH                                 38900001
NEXT     EQU   1                 UPDATE TO NEXT BYTE                    38950001
BLDGLEN  EQU   48                LENGTH OF BLDG PARM LIST               39000001
V        EQU   C'V'              INDICATES MVT SYSTEM                   39050001
T        EQU   C'T'              INDICATES TIME                         39100001
R        EQU   C'R'              INDICATES COUNTER                      39150001
PERIOD   EQU   C'.'              CHARACTER PERIOD                       39200001
SIGN     EQU   X'F0'             CONVERT SIGN BITS AFTER UNPACK         39250001
BSIGN    EQU   X'0F'             CONVERT SIGN BITS BEFORE UNPACK        39300001
WKAREALN EQU   8                 LENGTH OF WORK AREA                    39350001
MAX16    EQU   16                CONTROL FOR SCANNING                   39400001
ROLLBITS EQU   X'C0'             ROLL OPTION BITS                       39450001
COMDAUTH EQU   28                COMMAND AUTHORITY DISPLACEMENT         39500001
CODE0    EQU   0                 RETURN CODE ZERO -SUCCESSFUL           39550001
CODE4    EQU   4                 RETURN CODE OF 4 -ERROR                39600001
CLABEL0  EQU   C'0'              VALUE FOR LABEL PARM                   39650001
CLABEL1  EQU   C'1'              VALUE FOR LABEL PARM                   39700001
CLABEL2  EQU   C'2'              POSSIBLE VALUE FOR LABEL PARM          39750001
BLABEL1  EQU   X'10'             TREAT AS BYPASS LABEL PROCESSING       39800001
BLABEL02 EQU   X'01'             TREAT AS NON LABEL                     39850001
DFLMSGL1 EQU   C'0'              DEFAULT MSGLEVEL FOR JCL MSGS          39900001
DFLMSGL2 EQU   C'1'              DEFAULT MSGLEVEL FOR ALLOC MSGS        39950001
HEX00    EQU   X'00'                                               XMCS 40000001
HEX04    EQU   X'04'                                               XMCS 40050001
HEX40    EQU   X'40'                   HEX EQUATE                   SMF 40100001
HEX80    EQU   X'80'                                               XMCS 40150001
EXITID   EQU   1                   DISPL OF EXIT TYE FIELD IN ENTRY     40160002
LINKID   EQU   0                   DISPL OF LINKAGE ID          YM00373 40170002
EXITNAME EQU   2                   DISPL OF EXIT NAME           YM00373 40180002
         SPACE 3                                                        40200001
         EJECT                                                          40250001
*                                                                Y02668 40300002
*  EQUATES TO CONVERT  IWA  TO CWA                               Y02668 41300002
*                                                                Y02668 42300002
JMRLEN   EQU   80                  JMR+PARLIST LENGTH            Y02668 43300002
JESSJMR  EQU   56                  JMR PASSED BY JOB ENT SUBSYS  Y02668 43800002
JCLLEN   EQU   80                                                Y02668 56300002
MSBUFLEN EQU   160                                               Y02668 59600002
AOWBFLTH EQU   90                                                       60300002
LEN7     EQU   7                                                        67300002
STEP1    EQU   X'01'                                             Y02668 68300002
MVESTAE  MVC   LEN0(LEN0,R5),VH1ESTAE          MOVE LIST FORM           68500002
WRKAREAS EQU   LEWA+JCLLEN+AOWBFLTH+MSBUFLEN                     Y02668 68900002
*****************************************************************Y02668 69300002
*                                                               *Y02668 70300002
*        DECLARED STORAGE                                       *Y02668 71300002
*                                                               *Y02668 72300002
*****************************************************************Y02668 73300002
         SPACE 2                                                        74300002
EIGHTY   DC    F'80'                                             Y02668 75300002
ID       DC    X'11111111'         CWA IDENTIFIER                Y02668 76300002
TEXTID   DC    X'EEEEEEEE'         TEXT BUFFER IDENTIFIER        Y02668 77300002
TXTBUFLT DC    H'8192'             8K INTERNAL TEXT BUFFER       Y02668 77800002
IEFVHAV  DC    V(IEFVHA)           CONVERTER GET ROUTINE         Y02668 78300002
IEFVHFV  DC    V(IEFVHF)                                         Y02668 79300002
IEFNB9CR DC    V(IEFNB9CR)         ADDRESS OF ESTEA EXIT                79380002
         SPACE 1                                                        79460002
VH1ESTAE ESTAE XCTL=NO,PURGE=NONE,ASYNCH=YES,RECORD=YES,MF=L            79540002
LENESTAE DC    A(*-VH1ESTAE)                                            79620002
VH1LINK  LINK SF=L                 LIST FORM OF LINK            YM00373 79640002
LINKLTH  EQU   *-VH1LINK           LENGTH OF LINK EXPANSION     YM00373 79660002
         SPACE 1                                                        79700002
PATCH    DC    25F'0'                                                   80300002
         EJECT                                                          80320002
TRACE    DS    0H                                                       80340002
         BALR  15,0                SET BASE REG.                        80360002
         USING *,15                                                     80380002
****************************************************************YM08105 80390002
         B     TRNOP               DEACTIVATE TRACE             YM08105 80400002
*                                  ZAP THIS INSTR TO '47000000' YM08105 80410002
*                                  TO TRACE MODULE FLOW.        YM08105 80420002
****************************************************************YM08105 80430002
         STM   11,1,TRSAVE         SAVE CALLER'S REGS.                  80480002
* REGISTER 12 CONTAINS ADDRESS OF WORK AREA.                     Y02668 80500002
         L     1,BUFADDR           LOAD CONTENTS.                       80540002
         LTR   1,1                 TRACE BUFFER OBTAINED ?              80560002
         BNZ   TR5                 BRANCH YES.                          80580002
* TRACE BUFFER NOT YET OBTAINED.                                        80600002
         LR    11,15               SAVE BASE REGISTER.                  80620002
         LH    0,BUFLTH            LOAD BUF LENTH.                      80640002
         GETMAIN  R,LV=(0)                                              80660002
         LR    15,11               RESTORE BASE REGISTER.               80680002
         ST    1,BUFADDR           SAVE BUFFER ADDRESS.                 80700002
         ST    1,NEXTPTR           INIT NEXT ENTRY PTR.                 80720002
         AH    1,BUFLTH            ADD LENGTH TO                        80740002
         ST    1,BUFEND            COMPUTE BUFFER END ADDR.             80760002
* TRACE BUFFER EXISTS AND PTRS ARE INITIALIZED.                         80780002
TR5      DS    0H                                                       80800002
         CLC   NEXTPTR(4),BUFEND   IS BUFFER FILLED ?                   80820002
         BNE   TR10                BRANCH NO.                           80840002
* BUFFER HAS BEEN FILLED. START OVER.                                   80860002
         MVC   NEXTPTR(4),BUFADDR  SET NEXT ENTRY TO START OF BUF.      80880002
TR10     DS    0H                                                       80900002
         L     1,NEXTPTR           LOAD PTR TO NEXT ENTRY.              80920002
         L     14,TRSAVE+12        LOAD ADDR OF CALLER.                 80940002
         MVC   0(4,1),4(14)        MOD ID IS 2ND WD AFTER CALLING      *80960002
                                   ADDR. MOVE ID TO BUF.                80980002
         LA    1,4(1)              SET ENTRY PTR TO NEXT LOC AND        81000002
         ST    1,NEXTPTR           SAVE.                                81020002
         LM    11,1,TRSAVE         RESTORE REGS.                        81040002
TRNOP    DS    0H                                               YM08105 81050002
         LA    14,8(14)            PT LINK REG BEYOND PARM LIST.        81060002
         BR    14                  RETURN TO NEXT EXECUTABLE INSTR.     81080002
         SPACE 2                                                        81100002
         DS    0H                                                       81120002
BUFLTH   DC    AL2(2048)           BUFFER LENGTH.                       81140002
         END   IEFVH1                                                   81300002
./  ADD  SSI=72800207,NAME=IEFVINA
*********************************************************************** 00100019
*                                                                     * 00200019
* MODULE NAME - IEFVINA                                               * 00350002
*                                                                     * 00400019
* DESCRIPTIVE NAME - INSTREAM PROCEDURE CONTROL  AND GET ROUTINE      * 00450002
*                                                                     * 00460002
* COPYRIGHT - N/A                                                     * 00470002
*                                                                     * 00480002
* STATUS - OS/VS2 RELEASE 3 PTF                               @ZA03865  00490000
*                                                                     * 00492002
* FUNCTION - READS INSTREAM PROCEDURES FROM THE JCL DATA SET AND CALLS* 00494002
*            A SERIES OF SUBROUTINES TO RECORD THE PRESENCE OF THE    * 00496002
*            PROCEDURE AND TO SAVE IT IN COMPRESSED FORM IN SWA.      * 00498002
*                                                                     * 00500019
* OPERATION -THIS MODULE ACTS AS THE ROUTING ROUTINE FOR INSTREAM     * 00600002
*            PROCEDURES.  IT GETS CORE FOR A PARAMETER LIST (24 BYTES * 00700019
*            AND INITIALIZES IT FOR VARIOUS ROUTINES AND FOR A QMPA   * 00800019
*            AND EXTERNAL PARAMETER LIST.  BOTH PARAMETER LIST AND    * 00900019
*            QMPA ARE FREED BEFORE EXIT FROM THE MODULE.              * 01000019
*                                                                     * 01100019
*            THE MODULE CONSISTS OF A MAIN FLOW AND FIVE SUBROUTINES, * 01200019
*            ONE OF WHICH CONTAINS AN INTERNAL SUBROUTINE.            * 01300019
*                                                                     * 01400019
*            VINAPARM:  THIS SUBROUTINE GETS CORE FOR THE PARAMETER   * 01500019
*            LIST AND INITIALIZES IT FOR IEFVINB AND/OR IEFVINC.        01600019
*                                                                     * 01700019
*            VINAERR:  THIS SUBROUTINE HANDLES ERROR CONDITIONS       * 01800019
*            AND UTILIZES THE INTERNAL SUBROUTINE VINAMSG1 TO WRITE   * 01900002
*            THE   ERROR MESSAGE TO SYSOUT.                           * 02050002
*                                                                     * 03000019
*            THE JOB FAILED BIT IS SET ON  AND CONTROL IS             * 03100002
*            TRANSFERRED TO IEFVHA (PROC) OR THE COMPRESS SUBROUTINE  * 03200019
*            (PEND) TO GET ANOTHER RECORD                             * 03300019
*                                                                     * 03400019
*            VINACONT:  THIS SUBROUTINE PROCESSES THE PROC OR PEND    * 03500019
*            STATEMENT WHICH IS TO BE CONTINUED.  IT SETS A HIGH      * 03600019
*            ORDER BIT TO INDICATE THAT THIS IS A CONTINUED STATEMENT * 03700019
*            AND BRANCHES TO THE SYNTAX SUBROUTINE, VINASYNT.         * 03800019
*                                                                     * 03900019
*            VINAMSG:  THIS ROUTINE UTILIZES AN INTERNAL ROUTINE,     * 04000019
*            VINAMSG1 TO WRITE THE MESSAGE TO SYSOUT IF ONE IS        * 04150002
*            NEEDED.  IT BUILDS A PARAMETER LIST FOR IEZNCODE AND     * 04200019
*            USES IEZNCODE TO COMPRESS THE RECORD.  IT USES IEFVHQ AND  04300019
*            THE SWA MANAGER TO ASSIGN AND WRITE RECORDS TO SWA.      * 04400002
*                                                                     * 04600019
*            VINASYNT:  THIS SUBROUTINE BRANCHES TO IEFVINE TO        * 04700019
*            SYNTAX CHECK THE PROC AND PEND STATEMENTS.  IT TESTS FOR * 04800019
*            COMMON ERROR CONDITIONS.  INVALID LABEL AND DELIMITER    * 04900019
*            ERRORS IN THE COMMENTS FIELD.                            * 05000019
*                                                                     * 05100019
* NOTES - NONE                                                        * 05150002
*     CHARACTER CODE DEPENDENCIES - EBCDIC                            * 05160002
*     DEPENDENCIES - NONE                                             * 05170002
*     RESTRICTIONS - NONE                                             * 05180002
*     REGISTER CONVENTIONS - R11 - BASE REG                           * 05190002
*                            R12 - CONVERTER WORK AREA                * 05192002
*     PATCH-LABEL - PATCH                                             * 05194002
*                                                                     * 05196002
* MODULE TYPE - BAL CSECT                                             * 05198002
*     PROCESSOR - ASSEMBLER                                           * 05198402
*     ATTRIBUTES - REFRESHABLE,PRIVILEGED, KEY 0, PAGEABLE LPA        * 05198802
*                                                                     * 05199202
* ENTRY POINT - IEFVINA FROM IEFVHCB                                  * 05199602
*     PURPOSE - PROCESS INSTREAM PROCEDURE                           *  05199702
*     LINKAGE - BALR                                                  * 05199802
*     INPUT -                                                         * 05199902
*               R12 - PTR TO CONVERTER WORK AREA                      * 05233202
*               R13 - PTR TO REG SAVE AREA                            * 05283202
*     REGISTERS SAVED - R14-R12                                       * 05293202
*     REGISTER CONTENTS DURING PROCESSING -                           * 05295202
*               R0  - WORK REG                                        * 05297202
*               R1  - STATEMENT PTR                                   * 05299202
*               R2  - SUBROUTINE LINKAGE ANDWORK REG                 *  05299602
*               R3  - WORK REG                                        * 05299702
*               R4  - RETURN CODE AND WORK REG                        * 05299802
*               R5  - INPUT STMT PTR AND SUBRTN LINKAGE REG           * 05299902
*               R6  - NEL AND QMPA BASE                               * 05333202
*               R7  - PTR TO INSTREAM WORK AREA                       * 05383202
*               R8  - NEL AND JCT BASE REG                            * 05393202
*               R9  - PTR TO INPUT BUFFER                             * 05395202
*               R10 - LOCAL WORK AREA BASE                            * 05397202
*               R11 - CSECT BASE REG                                  * 05399202
*               R12 - PTR TO CONVERTER WORK AREA                      * 05399602
*               R13 - PTR TO REG SAVE AREA                            * 05399702
*               R14 - LINKAGE REG                                     * 05399802
*               R15 - LINKAGE REG                                     * 05399902
*     REGISTERS RESTORED - R9 AND R10                                 * 05433202
*                                                                     * 05483202
* EXIT - NORMAL - BR 15 TO IEFVHA TO GET NEXT STMT                    * 05493202
*     CONDITIONS - PEND STATEMENT FOUND                               * 05495202
*     OUTPUT - ENTRY MADE IN INSTREAM PROCEDURE DIRECTORY AND         * 05497202
*              ACTUAL PROCEDURE SAVED IN SWA                          * 05499202
*     RETURN CODES - NONE                                             * 05499602
*                                                                     * 05499702
* EXIT-ERROR - BR 15 TO IEFVHA                                        * 05549702
*     CONDITIONS - INCORRECT LABEL FIELD ON PROC OR PEND STMT         * 05599702
*                - EXCESSIVE NUMBER OF INSTREAM PROCEDURES            * 05649702
*                - EOF REACHED WITHOUT FINDING PEND STMT              * 05699702
*                - INVALID CARD IN PROCEDURE                          * 05749702
*     OUTPUT - JOB FAIL BIT SET AND APPROPRIATE ERROR MSG ISSUED      * 05799702
*     RETURN CODES - NONE                                             * 05849702
*                                                                       05859702
* EXIT-ERROR - BR 15 TO IEFVHF                                          05869702
*     CONDITIONS - I/O ERROR READING  FROM JCL DATA SET                 05879702
*     OUTPUT - TERMINATION BIT(CWATERM) SET IN CWA                      05889702
*     RETURN CODES - CWARET INITIALIZED TO 8                            05891702
*                                                                     * 05899702
* EXTERNAL REFERENCES -                                               * 05949702
*     ROUTINES - IEFVHQ, IEFVGM,IEZNCODE, IEFVINB,IEFVINC,IEFVINE     * 05999702
*     DATA AREAS - CONVERTER WORK AREA,INSTREAM WORK AREA,            * 06049702
*                  PARMLIST FOR EXTERNAL RTNS                         * 06099702
*     CONTROL BLOCKS - QMPA,ACB,RPL                                     06149702
*     TABLES - CONVERTER/INTERPRETER KEYS(IEFVKEYS)                   * 06199702
*     MACROS - GET, PUT, GETMAIN, FREEMAIN, IEFSAVER, SAVE, IEFRELSE  * 06249702
*     ENQUEUE RESOURCES - NONE                                        * 06299702
*     CHANGE LEVEL - Y02668,APAR OZ03865                              * 06349700
*                                                                     * 06399702
* MESSAGES -                                                          * 06449702
*            IEF662I INVALID LABEL ON PROC STMT                       * 06499702
*            IEF662I INVALID LABEL ON PEND STMT                       * 06549702
*            IEF663I NO LABEL ON THE PROC STATEMENT                   * 06599702
*            IEF665I EXCESSIVE NUMBER OF INSTREAM PROCEDURES          * 06649702
*                                                                     * 08100019
* MORE DETAILED                                                       * 08150002
* OPERATION - .ADDRESSIBILITY IS ESTABLISHED FOR THE WORK AREA, THE   * 13900002
*              QMPA,  AND THE MODULE                                  * 14000002
*             .A SAVE AREA IS GOTTEN                                  * 14100019
*             . MSGKEY IS STORED FOR THE PROC VERB                    * 14200019
*             .VINASYNT SUBROUTINE IS EXECUTED                        * 14300019
*             .CHECK MADE FOR NO PROCEDURE NAME                       * 14400019
*             . IF AN ERROR EXISTS, CONTROL IS PASSED TO VINAERR TO   * 14500019
*              WRITE THE STATEMENT AND ERROR MSG                      * 14650002
*             .IF NO ERROR EXISTS, THE LENGTH OF THE PROCEDURE NAME   * 14700019
*              IS SAVED                                               * 14800019
*             .A CHECK IS MADE TO SEE IF THIS IS A FIRST INSTREAM     * 14900002
*              PROCEDURE                                              * 15000019
*             .IF IT IS NOT, A PARM LIST IS MADE FOR IEFVINB AND      * 15100019
*              CONTROL IS PASSEDTO IEFVINB TO SEARCH THE DIRECTORY    * 15200019
*              CONTROL IS THEN PASSED TO IEFVINC                      * 15300019
*             . IF THE COUNT FIELD IN THE WORK AREA IS ONE, INDICATING  15400002
*              THAT THIS IS THE FIRST INSTREAM PROCEDURE, THE QMPA IS * 15500002
*              INITIALIZED AND AN ASSIGN DONE.                        * 15600002
*             .A PARM LIST IS GOTTEN AND BUILT FOR IEFVINC AND CONTROL* 15700002
*              IS TRANSFERRED TO BUILD A DIRECTORY ENTRY.             * 15800019
*             .A CHECK IS MADE TO SEE IF TOO MANY PROCEDURES WERE     * 15900019
*              ALREADY ENCOUNTERED.                                   * 16000002
*             . IF THEY WERE, CONTROL IS TRANSFERRED TO VINAERR TO    * 16100019
*              WRITE THE ERROR MESSAGE                                * 16250002
*             . THE NEXT STATEMNET IS READ AND TESTED FOR A PEND      * 16300002
*             .IF NOT A PEND,  THE STATEMENT IS WRITTEN TO SYSOUT AND   16550002
*              THE RECORD IS COMPRESSED AND IF NECESSARY WRITTEN TO   * 16600019
*              SWA .  ANOTHER RECORD IS READ                          * 16700002
*             .IF IT IS  A PEND STATEMENT THE PARAMETER LIST AND SAVE   16800002
*              AREA ARE FREED AND EXIT IS MADE TO IEFVHA              * 16900002
*                                                                     * 17200019
*********************************************************************** 17300019
         EJECT                                                          17400019
         IEFCOMWA                                                Y02668 17500002
         IEFCVRWA                                                Y02668 17550002
         EJECT                                                          17600019
         IEFVMEWA                                                       17700019
         EJECT                                                          17800019
         IEFTXTFT                                                Y02668 18050002
         EJECT                                                          18100019
         IEFQMNGR                                                       18200019
         DCBD  DSORG=(PS)                                               18520019
         EJECT                                                          18540019
         IEFVKEYS                                                       18560019
         EJECT                                                          18580019
         IFGRPL                                                         18584002
         EJECT                                                   Y02668 18585002
         IDARMRCD                                                Y02668 18586002
         EJECT                                                          18588002
NEL      DSECT                                                          18592002
         IEFNEL SUBCOM=C                                                18596002
         EJECT                                                          18600019
WORKAREA DSECT                                                          18700019
         USING WORKAREA,R7                                              18800019
WKTTR    DS    CL4                     POINTER TO NEXT RECORD           18900019
WKQMPAPT DS    CL4                     ADDRESS OF QMPA                  19000019
WKRECORD DS    CL168                   COMPRESSED RECORD                19100019
WKPTR1   DS    CL4                     POINTER TO ITSELF                19200019
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN        19300019
WKPTR2   DS    CL3                     HOLDER FOR TTR ASSIGNED FROM     19400019
*                                      THE QUEUE MANAGER          O106  19500019
WKPROCN1 DS    CL8                     PROCEDURE NAME                   19600019
WKTTR1   DS    CL3                     TTR OF FIRST RECORD              19700019
WKPROCN2 DS    CL8                     PROCEDURE NAME                   19800019
WKTTR2   DS    CL3                     TTR OF FIRST RECORD              19900019
WKPROCN3 DS    CL8                     PROCEDURE NAME                   20000019
WKTTR3   DS    CL3                     TTR OF FIRST RECORD              20100019
WKPROCN4 DS    CL8                     PROCEDURE NAME                   20200019
WKTTR4   DS    CL3                     TTR OF FIRST RECORD              20300019
WKPROCN5 DS    CL8                     PROCEDURE NAME                   20400019
WKTTR5   DS    CL3                     TTR OF FIRST RECORD              20500019
WKPROCN6 DS    CL8                     PROCEDURE NAME                   20600019
WKTTR6   DS    CL3                     TTR OF FIRST RECORD              20700019
WKPROCN7 DS    CL8                     PROCEDURE NAME                   20800019
WKTTR7   DS    CL3                     TTR OF FIRST RECORD              20900019
WKPROCN8 DS    CL8                     PROCEDURE NAME                   21000019
WKTTR8   DS    CL3                     TTR OF FIRST RECORD              21100019
WKPROCN9 DS    CL8                     PROCEDURE NAME                   21200019
WKTTR9   DS    CL3                     TTR OF FIRST RECORD              21300019
WKPROCNA DS    CL8                     PROCEDURE NAME                   21400019
WKTTRA   DS    CL3                     TTR OF FIRST RECORD              21500019
WKPROCNB DS    CL8                     PROCEDURE NAME                   21600019
WKTTRB   DS    CL3                     TTR OF FIRST RECORD              21700019
WKPROCNC DS    CL8                     PROCEDURE NAME                   21800019
WKTTRC   DS    CL3                     TTR OF FIRST RECORD              21900019
WKPROCND DS    CL8                     PROCEDURE NAME                   22000019
WKTTRD   DS    CL3                     TTR OF FIRST RECORD              22100019
WKPROCNE DS    CL8                     PROCEDURE NAME                   22200019
WKTTRE   DS    CL3                     TTR OF FIRST RECORD              22300019
WKPROCNF DS    CL8                     PROCEDURE NAME                   22400019
WKTTRF   DS    CL3                     TTR OF FIRST RECORD              22500019
         EJECT                                                          22530019
         EJECT                                                          22600019
IEZPARM  DSECT                         PARAMETER AREA                   22700019
         USING IEZPARM,R1                                               22800019
IEZADDR  DS    CL4                     ADDRESS OF PARAMETER LIST        22900019
IEZUNCOM DS    A                       PTR TO UNCOMPRESSED RECORD       23000019
IEZCOMPR DS    A                       PTR TO NEXT COMPRESSED RECORD    23100019
IEZLEN   DS    H                       LENGTH OF UNCOMPRESSED RECORD    23200019
IEZOUT   DS    H                       LENGTH OF AREA FOR OUTPUT RECORD 23300019
IEZCHAR  DS    C                       CHARACTER CODE OF BLANK          23400019
IEZTYPE  DS    B                       FLAG ASSOCIATED WITH RECORD      23500019
IEZRES   DS    H                       WORK AREA                        23600019
         ORG IEZADDR                                                    23700019
ADDSS    DS    CL4                     ADDRESS OF PARAMETER LIST        23800019
PROCNAME DS    CL8                     PROCEDURE NAME                   23900019
DIRECT   DS    CL4                     ADDRESS OF DIRECTORY             24000019
IWAPTR   DS    CL4                     ADDRESS OF IWA                   24100019
RTCD     DS    CL4                     RETURN CODE FROM VINB            24200019
         EJECT                                                          24300019
IEFVINA  CSECT                                                          24400019
* A 554626-554632, C 554120                                    @ZA01933 24420003
* CODE ADDED NEAR LABEL VINACOMP                               @ZA03865 24430000
BUFLTH   EQU   90                  STMT # + MSG LENGTH           Y02668 24440002
STNLTH   EQU   10                  STMT# LENGTH                  Y02668 24450002
STMTLTH  EQU   BUFLTH-STNLTH       MSG LENGTH                    Y02668 24460002
BLANK    EQU   C' '                                              Y02668 24470002
DISPLID  EQU   7             DISPLACEMENT OF ID IN REMOTE LIST   Y02621 24480002
INSRECID EQU   X'25'         ID FOR INSTREAM RECORDS PUT TO SWA  Y02621 24490002
         SAVE (14,12)                                                   24500019
         BALR  RB,0                                                     24600019
         USING *,RB                                                     24700019
*****************************************************************Y02668 24710002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 24720002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 24730002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 24740002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 24750002
         DC    C'VINA'             MOD ID USED BY TRACE.         Y02668 24760002
* TRACE RETURNS HERE.                                            Y02668 24770002
*****************************************************************Y02668 24780002
         B     VINA000                                                  24800019
         SPACE                                                          24900019
         MODID BR=NO                                             Y01886 24950001
         DC    C'SPLT'                                           Y02668 25050002
         DC    C'06'               LEVEL # (VHA/VINA LOAD MERGE).Y02668 25150002
         DC    C'REL3'              FUNCTION ID AND            @ZA01933 25200003
         DC    C'02'         LEVEL# (IEZPARM INITIALIZATION)   @ZA03865 25250000
         SPACE                                                          25300019
VINA000  DS    0H                                                       25400019
         L     R7,IWAWKBF              ADDRESSIBILITY FOR WORK AREA     25500019
         L     R6,WKQMPAPT             ADDRESS OF IN-STREAM QMPA   3391 25590019
         USING IOPARAMS,R6             FOR QMPA                         25650019
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 25800002
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 26000002
         IEFSAVER                                                       26200019
         L     R3,PDCBP                ADDRESS OF PROC DCB        19093 26210019
         USING IHADCB,R3                                                26220019
*                                                             M3739O106 26226019
         MVC   IWABPAM(MVTHREE),DCBREAD+DISPLONE SAVE ADDR OF BPAM O106 26232019
         DROP  R3                                                       26290019
         SPACE                                                          26300019
**********************************************************************  26400019
*                                                                    *  26500019
* SYNTAX CHECK PROC AND PEND STATEMENTS                              *  26600019
*                                                                    *  26700019
**********************************************************************  26800019
         SPACE                                                          26900019
         L     RA,CTRLWAP              ADDRESS OF CONTROL AREA          27000019
         MVI   MSGKEY,INTKEY3          SECONDARY MSG IF NEEDED     4360 27100019
         BAL   R2,VINASYNT             SYNTAX CHECKER                   27200019
         SPACE                                                          27300019
         LTR   R4,R4                   TEST FOR EXISTENCE OF PROC NAME  27400019
         BZ    VINAERR                 NO PROC NAME                     27500019
VINA010  DS    0H                                                 4329  27550019
         LR    R3,R4                   LENGTH OF PROC NME               27620019
         BCTR  R3,R0                   DECREMENT FOR MOVE               27700019
         CLI   WKCT,NOENTRY            SEE IF THIS IS THE               27800019
         BNE   VINA130                 IN-LINE PROCEDURE                27900019
         SPACE                                                          28000019
**********************************************************************  28100019
*                                                                    *  28200019
* INITIALIZE CORE FOR THE QMPA AND DO ASSIGN/START                   *  28300019
*                                                                    *  28400019
**********************************************************************  28500019
         SPACE                                                          28600019
VINA020  DS    0H                                                  3391 28660019
         OI    QMPOP,QMASGS            ASSIGN/START                     29000019
         L     R5,RSTMT                ADDRESS OF INPUT BUFFER          29200019
         L     R1,CTRLWAP          GET ADDR OF EXT. PARM. LIST   Y02668 29400002
         ST    R1,QMPCL                ADDRESS OF EXTERNAL PARAMETER    29500019
*                                      LIST                             29600019
VINA025  DS    0H                                                  3391 29650019
         MVI   QMPCM,ASSIGN1           NUMBER OF RECORDS TO ASSIGN      29700019
         L     RF,VIEFVHQ              Q MANAGER INTERFACE              29900019
         BALR  RE,RF                                                    30000019
         L     R1,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 30260019
         MVC   WKPTR1+DISPLONE(MVTHREE),DISPLZER(R1)   TTR RETURNED3391 30320019
         SPACE                                                          30400019
         BAL   R2,VINAPARM             GET CORE FOR PARM LIST, ESTAB-   30500019
         XC    RTCD(MVFOUR),RTCD       RETURN CODE FOR IEFVINB          30600019
         SPACE                                                          30700019
VINA030  DS    0H                                                       30800019
*                                      LIST ADDRESSIBILITY FOR DSECT,   30900019
*                                      BUILD PARM LIST FOR VINB AND/OR  31000019
*                                      VINC                             31100019
         L     RF,VIEFVINC             DIRECTORY BUILD ROUTINE          31300019
         BALR  RE,RF                                                    31400019
         L     R1,IWAPARM              ADDRESS OF PARM LIST             31700019
         L     RF,RTCD                 RETURN CODE FROM IEFVINC         31800019
         LTR   RF,RF                   EXCESSIVE NAMBER OF              31900019
         BNE   VINAERR3                IN-LINE PROCEDURES               32000019
         BAL   R4,VINAMSG              CREATE AN SMB IF NECESSARY       32400019
         SPACE                                                          32800019
VINA040  DS    0H                                                       32900019
         NI    SWZ,X'FF'-CMT           INITIALIZE COMMENT SWITCH F39049 32950020
         BAL   R5,VINAGET               GO TO ACCESS METHOD      Y02668 33000002
         SPACE                                                          33130019
VINA043  DS    0H                                                  3156 33160019
         L     R1,RSTMT                ADDRESS OF INPUT BUFFER          33200019
         LA    R2,VINAEND(R1)          COLUMN 71 OF STMT           3156 33230019
         LA    R4,VINA040              GET ANOTHER REOCRD          3156 33260019
         CLC   DISPLZER(MVTWO,R1),VINASLH SEE IF THE FIRST 2 CHARACTERS 33300019
         BE    VINA045                 CHECK THE VERB                   33400019
         MVC   DISPLZER(MVONE,R1),VINABLNK     MOVE BLANK TO     A35012 33440020
*                                              FIRST BYTE OF     A35012 33480020
*                                              BUFFER            A35012 33520020
         MVC   DISPLONE(MV79,R1),DISPLZER(R1)  AND CLEAR.        A35012 33560020
         MVC   DISPLZER(MV46,R1),VINASLH GENERATE //SYSIN DD *    M3738 33600019
         B     VINA140                  SET DATA FLUSH BUT       A35013 33700020
         SPACE                                                          33800019
VINA045  DS    0H                                                       33900019
         CLI   DISPLTWO(R1),VINASTE    IS THIS A COMMENT STMT     4362  33930019
         BE    VINA072                 CREATE AN SMB             A39049 33960020
         LA    R1,DISPLONE(R1)         BUMP STATEMENT POINTER           34000019
         SPACE                                                          34100019
VINA050  DS    0H                                                       34200019
         LA    R1,DISPLONE(R1)         BUMP STATEMENT POINTER           34300019
         CLI   DISPLZER(R1),INITBLK    TEST FOR A BLANK                 34400019
         BNE     VINA075               LABEL ON STATEMENT               34500019
         SPACE                                                          34600019
VINA060  DS    0H                                                       34700019
         LA    R1,DISPLONE(R1)         BUMP STTEMENT POINTR             34800019
         CR    R2,R1                   END OF STMT                 3156 34830019
         BL    VINACNT0                YES, CHECK FOR CONTINUATIOA39900 34860020
*                                      NULL SO FAR               A39900 34870020
         CLI   DISPLZER(R1),INITBLK    NEXT NON-BLNAK SHOULD BE VERB    34900019
         BE    VINA060                 A  BLANK                         35000019
VINA065  DS    0H                                                 4362  35050019
         SPACE                                                          35100019
         CLC   DISPLZER(MVFIVE,R1),VINAPEND     IS THERE A PEND VERB    35200019
         BE    VINA080                 PEND VERB                        35300019
         CLC   DISPLZER(COMPFIVE,R1),VINAEXEC EXEC VERB?         SM4182 35350001
         BNE   VINA066            BRANCH. NOT AN EXEC CARD.      SM4182 35400001
         LA    R1,DISPLFOR(R1)    BUMP PTR PAST VERB.            SM4182 35450001
VINA068  LA    R1,DISPLONE(R1)    BUMP PTR BY ONE.               SM4182 35500001
         CR    R2,R1              END OF STMT?                   SM4182 35550001
         BL    VINACNT            YES, CHECK FOR CONTINUATION.   SM4182 35560001
         CLI   DISPLZER(R1),INITBLK  CHECK FOR OPERAND.          SM4182 35570001
         BE    VINA068            CONTINUE SCAN FOR NON-BLANK.   SM4182 35580001
         B     VINACNT8           CHECK FOR CONTINUATION.        SM4182 35590001
VINA066  CLC   DISPLZER(COMTHREE,R1),VINADD    DD VERB           SM4182 35600001
         BNE   VINA073                 GET ANOTHER RECORD               35700019
         LA    R1,DISPLTWO(R1)         BUMP POINTER PAST VERB           35800019
         SPACE                                                          35900019
*********************************************************************** 36000019
*                                                                     * 36100019
* CHECK FOR DD * OR DD DATA.  IF EITHER EXIST THE DATA WILL BE FLUSHED  36200019
* BY THE READER/INTERPRETER                                           * 36300019
*                                                                     * 36400019
*********************************************************************** 36500019
VINA070  DS    0H                                                       36600019
         LA    R1,DISPLONE(R1)         BUMP POINTER                     36700019
         CR    R2,R1                   END OF STMT?                3156 36730019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 36760019
         CLI   DISPLZER(R1),INITBLK    CHECK FOR OPERAND                36800019
         BE    VINA070                 NO OPERAND                       36900019
         SPACE                                                          37000019
         CLC   DISPLZER(COMPTWO,R1),VINAST   COMPARE FOR DD *           37100019
         BE    VINA140                 DD *                             37200019
         CLC   DISPLZER(COMPFIVE,R1),VINADATA    DD DATA                37300019
         BE    VINA150                 DD DATA                          37400019
         CLC   DISPLZER(COMPTWO,R1),VINASTCM   DD *,?             4362  37420019
         BE    VINA140                 SET THE DATA FLUSH BIT     4362  37440019
         CLC   DISPLZER(COMPFIVE,R1),VINADATC  DD  DATA,?         4362  37460019
         BE    VINA150                 SET THE DATA FLUSH BITS    4362  37480019
         B     VINA073                 CONTINUE THE SCAN         A39049 37490020
         SPACE                                                          37500019
VINA072  DS    0H                                                A39049 37550020
         OI    SWZ,CMT                 INDICATE COMMENT CARD     A39049 37560020
         SPACE                                                          37570020
VINA073  DS    0H                                                       37600019
         BAL   R5,VINACNT8             CHECK FOR CONTINUATION           37700019
         SPACE                                                          37900019
VINA075  DS    0H                                                       38000019
         LA    R1,DISPLONE(R1)         BUMP POINTER                     38100019
         CR    R2,R1                   END OF STMT?                3156 38130019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 38160019
         CLI   DISPLZER(R1),INITBLK    END OF LABEL                     38200019
         BNE   VINA075                 END OF LABEL                     38300019
         SPACE                                                          38320019
VINA078  DS    0H                                                 4362  38340019
         LA    R1,DISPLONE(R1)         BUMP POINTER               4362  38360019
         CR    R2,R1                   END OF STMT?                3156 38366019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 38372019
         CLI   DISPLZER(R1),INITBLK    BEGINING OF VERB?          4362  38380019
         BE    VINA078                 NO                         4362  38400019
         SPACE                                                          38420019
         CLC   DISPLZER(MVFOUR,R1),VINAJOB   THIS A JOB VERB?     4362  38440019
         BE    VINA120                 XCTL TO IEFVHCB            4362  38460019
         B     VINA065                 CHECK FOR PEND STMT        4362  38480019
         SPACE                                                          38500019
VINA080  DS    0H                                                       38600019
         MVI   MSGKEY,INTKEY6          ON THE PEND STMT            4360 38700019
         L     R1,IWAPARM              ADDRESS OF PARAMETER LIST        38800019
         CLI   IEZLEN+DISPLONE,INPLN    SEE IF RECORD WAS COMPRESS19086 38810019
         BE    VINA085                  PROCEDURE HAD STATEMENTS. 19086 38820019
         LA    R2,WKRECORD              ADDRESS OF WORK RECORD    19086 38830019
         ST    R2,IEZCOMPR              NEXT AVAILABLE BYTE FOR   19086 38840019
*                                       COMPRESSED RECORD         19086 38850019
         SPACE                                                          38860019
VINA085  DS    0H                                                 19086 38870019
         L     R2,IEZCOMPR             ADDRESS OF WHERE EOF MARKER      38900019
*                                      SHOULD GO                        39000019
         XC    DISPLZER(MVTWO,R2),DISPLZER(R2)  EOF MARKER              39100019
         BAL   R2,VINASYNT             SUNTAX CHECKER                   39200019
         SPACE                                                          39300019
VINA090  DS    0H                                                       39400019
         BAL   R5,VINAMSG0             CREATE AN SMB IF NECESSARY       39500019
         LA    R5,VINA096              RETURN FROM QUEUE WRITE   A40299 39550001
*                                      SUBROUTINE TO XCTL TO VHA A40299 39570001
         SPACE                                                          39600019
*********************************************************************** 39700019
*                                                                     * 39800019
* WRITE THE LAST RECORD OF THE PROCEDURE ONTO THE JOB QUEUE           * 39900019
*                                                                     * 40000019
*********************************************************************** 40100019
VINA095  DS    0H                                                 19086 40150019
         XC    WKTTR(MVFOUR),WKTTR     CLEAR TTR OF NEXT RECORD FIELD   40200019
*                                      TO INDICATE END OF PROCEDURE     40300019
         L     RF,VIEFVHQ              ADDRESS OF IEFVHQ                40500019
         MVI   QMPOP,QMWRTE            SET FUNCTION BYTE TO WRITE       40600019
         L     R6,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 40700019
         MVC   DISPLZER(MVFOUR,R6),IWAWKBF  ADDR OF WORK AREA      3391 40800019
         MVC   DISPLFOR(MVTHREE,R6),WKPTR2  TTR OF WHERE RECORD SHOULD  40900019
*                                      GO ON JOB QUEUE             3391 41000019
         MVI   DISPLID(R6),INSRECID  BLOCK ID TO REMOTE LIST     Y02621 41050002
         BALR  RE,RF                   WRITE RECORD ON JOB QUEUE        41100019
         BR    R5                      RETURN TO CALLER          A40299 41450001
         SPACE                                                          41452001
VINA096  DS    0H                                                A40299 41460001
         BAL   R5,VINAEXIT             FREE SAVE AREA AND CORE   A40299 41470001
         SPACE                                                          41480001
VINA100  DS    0H                                                       41500019
         SPACE                                                          42400019
         L     RF,VIEFVHA          ADDR OF GET ROUTINE.          Y02668 42500002
         BR    RF                  BRANCH.                       Y02668 42550002
         SPACE                                                          42600019
VINA120  DS    0H                                                       42700019
         LA    RA,RSTMT                ADDRESS OF PARM LIST       19093 42900019
         L     R9,RSTMT                ADDRESS OF READER BUFFER   19093 43100019
         SPACE                                                          43300019
         BAL   R5,VINAEXIT                                        19093 43500019
         SPACE                                                          43700019
         L     RF,VIEFVHCB         ADDR OF VERB ID ROUTINE.      Y02668 43800002
         BR    RF                  BRANCH.                       Y02668 43850002
         SPACE                                                          43900019
VINA130  DS    0H                                                       44000019
         L     R5,RSTMT                ADDRESS OF BSAM BUFFER           44100019
         BAL   R2,VINAPARM             GET CORE FOR PARM LIST           44200019
         L     RF,VIEFVINB             ADDRESS OF DIRECTORY SEARCH      44300019
*                                      ROUTINE                          44400019
         BALR  RE,RF                                                    44500019
         B     VINA030                 CREATE AN SMB IF ONE IS NEEDED   44600019
         SPACE                                                          44700019
VINA140  DS    0H                                                       44800019
         B     VINA160                 CREATE AN SMB FOR STATEMNT       45000019
         SPACE                                                          45100019
VINA150  DS    0H                                                       45200019
VINA160  DS    0H                                                       45400019
         BAL   R4,VINAMSG              CREATE AN SMB FOR STATEMENT      45500019
         L     R1,IWAPARM               ADDRESS OF PARM LIST      19086 45530019
         L     R2,IEZCOMPR              NEXT AVAILABLE BYTE       19086 45560019
         XC    DISPLZER(MVTWO,R2),DISPLZER(R2) EODAD MARKER       19086 45590019
         LA    R5,VINA096               DON'T RETURN FROM SUBRRTNA40299 45600001
         B     VINA095                  WRITE PROC ON JOB QUEUE   19086 45620019
         EJECT                                                          45650019
         EJECT                                                          45700019
**********************************************************************  45800019
*                                                                    *  45900019
* THIS SUBROUTINE WILL GET CORE FOR A 20 BYTE PARAMETER LIST         *  46000019
* THIS PARAMETER LIST IS USED FOR THE DIRECTORY SEARCH ROUTINE       *  46100019
* IEFVINB, THE DIRECTORY BUILD ROUTINE, IEFVINC AND FOR THE COMPRESS *  46200019
* ROUTINE, IEZNCODE.  THE SUBROUTINE WILL INITIALIZE THE PARM LIST   *  46300019
* TO CONTAIN THE VALUES NEEDED FOR BOTH IEFVINB AND IEFVINC.  THAT IS   46400019
*     BYTES        VALUE                                             *  46500019
*     0-3          ADDRESS OF ITSELF                                 *  46600019
*     4-11         PROCEDURE NAME                                       46700019
*     12-15        ADDRESS OF THE DIRECTORY                          *  46800019
*     16-19        RETURN CODE FOR IEFVINB                           *  46900019
*     20-23        RETURN CODE FROM IEFVINC                          *  47000019
*                                                                    *  47100019
* CONTROL IS TRANSFERRED ON REGISTER 2                               *  47200019
* THIS ROUTINE WILL ESTABLISH ADDRESSIBILITY ON THE DSECT FOR THE    *  47300019
* PARAMETER LIST USED BY IEZNCODE                                    *  47400019
*                                                                    *  47500019
**********************************************************************  47600019
         SPACE                                                          47700019
VINAPARM DS    0H                                                       47800019
         LA    R0,VINACORE             LENGTH OF CORE                   47900019
         GETMAIN R,LV=(0)                                               48000019
         ST    R1,ADDSS                ADDR OF PARM LIST          M4268 48060019
         O     R1,IWAPARM              RETAIN INFO IN HIGH ORDER  M4268 48120019
*                                      BYTE OF FIELD              M4268 48180019
         ST    R1,IWAPARM              ADDR OF PARM LIST          M4268 48240019
         MVI   PROCNAME,INITBLK        CLEAR PROCNAME FIELD             48300019
         MVC   PROCNAME+DISPLONE(MVSEVEN),PROCNAME   TO BLANKS          48400019
         EX    R3,VINAMV2              MOVE PROCNAME TO PARM LIST       48500019
         LA    R3,WKPTR1               ADDRESS OF DIRECTORY             48600019
         ST    R3,DIRECT               ADDRESS OF DIRECTORY             48700019
         ST    RF,RTCD                 RETURN CODE FROM VINB            48800019
         ST    RC,IWAPTR               ADDRESS OF IWA                   48900019
         BR    R2                                                       49000019
         EJECT                                                          49100019
**********************************************************************  49200019
*                                                                    *  49300019
* THIS SUBROUTINE WILL INITIALIZE REGISTER 2 WITH AN ERROR CODE AND  *  49400019
* BRANCH TO A SUBROUTINE WHICH PRINTS THE ERROR MESSAGE.  THE JOB    *  49500019
* FAILED BIT IS SET AND CONTROL RETURNED TO XCTL TO IEFVHA.          *  49600019
*                                                                    *  49700019
**********************************************************************  49800019
         SPACE                                                          49900019
VINAERR  DS    0H                                                       50000019
         MVI   MSGSEC,PRIMARY1         NO PROCEDURE NAME                50100019
         B     VINAERR0                NO PROCEDURE NAME                50200019
         SPACE                                                          50300019
VINAERR2 DS    0H                      LABEL ERROR                      50400019
         MVI   MSGSEC,PRIMARY2         LABEL ERROR                      50500019
         CLI   MSGKEY,INTKEY6          IS  ERROR ON PEND CARD?    M1867 50510001
         BNE   VINAERR0                NO - ONLY ISSUE ERROR MSG  M1867 50520001
         BAL   R5,VINA095              QUEUE RECORDS SHOULD BE...A40299 50550001
*                                      ...WRITTEN FOR THIS ERROR A40299 50560001
*                                      CONDITION TO PREVENT THE  A40299 50570001
*                                      R/I FROM ABENDING WHEN IT A40299 50580001
*                                      EXPANDS THE PROCEDURE.    A40299 50590001
         SPACE                                                          50592001
         B     VINAERR0                LABEL ERROR                      50600019
         SPACE                                                          50700019
         SPACE                                                          51100019
VINAERR3 DS    0H                                                       51200019
         MVI   MSGSEC,PRIMARY4         EXCESSIVE NUMBER OF PROCS        51300019
         MVI   MSGKEY,DISPLZER         CLEAR SECONDARY MSG KEY          51400019
         SPACE                                                          51500019
VINAERR0 DS    0H                      ERROR                            51600019
         BAL   R5,VINAMSG0         CREATE AN SMB                  19085 51900019
         SPACE                                                          52200019
         XR    R2,R2                   INSERT PRIMARY MSG CODE          52400019
         IC    R2,MSGSEC               FOR ERROR MESSAGE                52500019
         BAL   R5,VINAMSG1             CREATE SMB FOR ERROR MSG         52600019
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 52700002
         DROP  R8                                                Y02668 52720002
         L     R2,IWAPARM              ADDRESS OF PARM LIST       19093 52750001
         LTR   R2,R2                   PARM LIST GOTTEN?          19093 52760001
         LA    R5,VINA100              XCTL TO IEFVHA             19093 52810001
         BZ    VINAEXT1                PARMLIST WASN'T GOTTEN     19093 52820001
         B     VINAEXIT                FREE CORE FOR PARM LIST    19093 52870001
         EJECT                                                          53200019
VINACNT0 DS    0H                                                A39900 53210020
         CLI  DISPLONE(R2),INITBLK     IS THIS TRULY A NULL      A39900 53220020
*                                      STATEMENT                 A39900 53260020
         BNE  VINACNT1                 NO, IT HAS CONTINUATION   A39900 53270020
         BAL  R5,VINAMSG0              GO TO WRITE OUT NULL      A39900 53280020
         B    VINA120                  XCTL TO IEFVHCB AS FOR    A39900 53290020
*                                      JOB CARD                  A39900 53292020
VINACNT  DS    0H                                                       53300019
         CLI   DISPLONE(R2),INITBLK    IS THIS STMT CONTINUED      3156 53400019
         BE    VINAMSG                 NO, CREATE AN SMB           3156 53500019
*  CONTINUATION ON STATEMENT                                      3156* 53600019
         SPACE                                                          53700019
VINACNT1 DS    0H                                                  3156 53800019
         BAL   R4,VINAMSG              CREATE AN SMB               3156 53900019
         SPACE                                                          53950020
         TM    SWZ,CMT                 IS A COMMENT CARD BEING   A39049 53960020
*                                      PROCESSED?                A39049 53962020
         BO    VINA040                 RETURN TO MAINLINE PROCES.A39049 53970020
         SPACE                                                          53980020
         BAL   R5,VINAGET               GO TO ACCESS METHOD      Y02668 54000002
         L     R1,RSTMT                ADDR OF INPUT BUFFER      Y02668 54100002
         LA    R2,VINAEND(R1)          POINTER TO COLUMN 71        3156 54300019
         LA    R1,MVTHREE(R1)          INCREMENT TO COLUMN 4 WHERE 3156 54400019
*                                      CONTINUATION CAN BEGIN      3156 54500019
         SPACE                                                          54600019
VINACNT3 DS    0H                                                  3156 54700019
         CLC   DISPLZER(MVFIVE,R1),VINAPEND   IS THIS A PEND COMMENT    54800019
         LA    R4,VINA040              GET ANOTHER RECORD          3156 54900019
         BE    VINACNT                 YES, CHECK FOR CONTINUTAION 3156 55000019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3156 55100019
         CR    R2,R1                   END OF 2TATEMENT?           3156 55200019
         BL    VINA043                 YES, SC1N STATEMENT         3156 55300019
         B     VINACNT3                CHECK FOR PEND COMMENT      3156 55400019
VINACNT8 DS    0H                                                       55402019
         XR    R3,R3                                               3157 55404019
VINACT10 DS    0H                                                  3157 55406019
         CLI   DISPLZER(R1),VINAQUOT   CHECK FOR LITERAL           3157 55408019
         BNE   VINACT16                NOT A LITERAL               3157 55410019
         CLI   DISPLONE(R1),VINAQUOT   CHECK FOR A LITERAL     @ZA01933 55412003
         LA    R5,VINACT10             ONLY ONE QUOTE, A LITERAL   3157 55414019
         BE    VINACT14                NOT A LITERAL               3157 55416019
*****  QUOTE INDICATES A LITERAL, SET SWITCH                      3157* 55418019
         SPACE                                                          55420019
         LTR   R3,R3                   END OR BEGINNING OF LITERAL 3157 55422019
         LA    R5,VINACNT8             CLEAR LITERAL SWITCH        3157 55424019
         BNZ   VINACT12                END OF LITERAL, CHECK FOR   3157 55426019
*                                      ', ' TO INDICATE CONTIN     3157 55428019
         LA    R3,DISPLONE             START OF LITERAL, SET SW    3157 55430019
         LA    R5,VINACT10             CHECK FOR LITERAL           3157 55432019
         SPACE                                                          55434019
VINACT12 DS    0H                                                  3157 55436019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3157 55438019
         SPACE                                                          55440019
VINACT14 DS    0H                                                  3157 55442019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3157 55444019
         CR    R2,R1                   END OF STATEMENT            3157 55446019
         BL    VINACNT                 CHECK FOR CONTINUATION      3157 55448019
         BR    R5                      RETURN TO CALLER            3157 55450019
VINACT16 DS    0H                                                  3157 55452019
         LA    R5,VINACT10             CHECK FOR LITERAL           3157 55454019
         LTR   R3,R3                   IS THIS IN A LITERAL?       3157 55456019
         BNZ   VINACT14                IN A LITERAL, CHECK FOR END 3157 55458019
         CLC   DISPLZER(MVTWO,R1),VINACONT      CONTINUATION?      3157 55460019
         BE    VINACNT1                CONTINUATION OF STMT        3157 55462019
         CLI   DISPLZER(R1),INITBLK    CHECK FOR NON-BLANK     @ZA01933 55462603
         BE    VINACNT                 CHECK FOR CONTINUATION  @ZA01933 55463203
         B     VINACT14                INCREMENT POINTER           3157 55464019
         EJECT                                                          55466019
         EJECT                                                          55500019
         EJECT                                                          57000019
**********************************************************************  57100019
*                                                                    *  57200019
* THIS SUBROUTINE CREATES AN SMB IF ONE IS NEEDED.  IT INITIALIZES    * 57300019
* THE PARAMETER LIST FOR IEZNCODE WHEN THE FIRST IN-LINE PROCEDURE IS * 57400019
* ENCOUNTERED.  THE PARAMETER LIST IS MAPPED IN THE DSECT, IEZPARM.   * 57500019
*                                                                     * 57600019
* IT BRANCHES TO IEZNCODE TO COMPRESS THE RECORD AND CHECKS A         * 57700019
* RETURN CODE UPON RETURN.  IF THE OUTPUT AREA IS FULL, IT USES IEFVHQ  57800019
* AND THE QUEUE MANAGER TO ASSIGN A NEW RECORD, AND WRITE THE RECORD  * 57900019
* TO THE JOB QUEUE.  CONTROL IS THEN RETURNED TO IEZNCODE.  WHEN THE  * 58000019
* COMPRESSED RECORD HAS BEEN PLACED IN THE OUTPUT BUFFER, CONTROL IS  * 58100019
* RETURNED TO THE CALLER THROUGH REGISTER 4.                          * 58200019
         SPACE                                                          58300019
*                                                                    *  58400019
**********************************************************************  58500019
VINAMSG  DS    0H                                                       58600019
         LA    R5,VINACOMP             NEXT INSTRUCTION TO BE EXECUTED  58700019
         SPACE                                                          58800019
VINAMSG0 DS    0H                                                       58900019
         TM    IWAJMSGL,AOMSGLV1+AOMSGLV2  MSGLEVEL = 1 OR 2?   YM02706 59000002
         BC    8,0(R5)             NO, RETURN TO CALLER.         Y02668 59100002
         L     R9,RSTMT                ADDRESS OF INPUT BUFFER          59200019
         L     R2,AOWSTMT          R2 PTR TO'WRITE' BUFFER       Y02668 59220002
         MVI   0(R2),BLANK         BLANK OUT BUFFER BEFORE       Y02668 59240002
         MVC   1(BUFLTH,R2),0(R2)  MOVEING STMT IN               Y02668 59260002
         MVC   STNLTH(STMTLTH,R2),0(R9) MOVE STMT INTO BUFFER    Y02668 59280002
**********************************************************************  59300019
*                                                                    *  59400019
* CREATE SMB                                                            59500019
*                                                                    *  59600019
**********************************************************************  59700019
         SPACE                                                          59800019
         XR    R2,R2                   INDICATE NO ERROR MESSAGE        59900019
*                                      AFTER THE FOLLOWING SUBROUTINE   60000019
*                                      WHICH BRANCHES TO IEFVGM TO      60100019
*                                      CREATE SMB'S                     60200019
         SPACE                                                          60300019
**********************************************************************  60400019
*                                                                    *  60500019
* THIS SUBROUTINE USES IEFVGM TO CREATE AN SMB FOR AN ERROR OR A STMT*  60600019
* IT RETURNS CONTROL ON REGISTER 5                                   *  60700019
*                                                                    *  60800019
**********************************************************************  60900019
         SPACE                                                          61000019
VINAMSG1 DS    0H                                                       61100019
         OI    SWA,JTOP                SET JOB TO PROCESS BIT           61200019
         L     RF,VIEFVGM              CREATE                           61300019
         BALR  RE,RF                                                    61400019
         BR    R5                                                       61500019
         SPACE                                                          61600019
VINACOMP DS    0H                                                       61700019
         L     R1,IWAPARM              ADDRESS OF PARAMETER AREA        61800019
         SLL   R1,8                    CLEAR HIGH ORDER BYTE   @ZA03865 61820000
         SRL   R1,8                                            @ZA03865 61840000
         CL    R1,0(0,R1)              CHECK IF INITIALIZED    @ZA03865 61860000
         BNE   VINACOM2                ALREADY INITIALIZED     @ZA03865 61880000
         LA    R5,DISPLFOR(R1)         ADDRESS OF PARAMETER LIST        62100019
         ST    R5,IEZADDR              PARAMETER LIST                   62200019
         LA    R3,INPLN                LENGTH OF INPUT BUFFER           62400019
         STH   R3,IEZLEN                                                62500019
         LA    R3,WKRECORD             ADDRESS OF WORK RECORD           62600019
         ST    R3,IEZCOMPR                                              62700019
         MVI   IEZCHAR,INITBLK         BLANKS TO BE COMPRESSED          62800019
         LA    R3,OUTLN                LENGTH OF OUTPUT BUFFER          62900019
         STH   R3,IEZOUT               AREA                             63000019
         MVI   IEZTYPE,TYPEZER         NOT SPECIAL                      63100019
         SPACE                                                          63200019
VINACOM2 DS    0H                                                       63300019
         MVC   IEZUNCOM(MVFOUR),RSTMT   ADDRESS OF INPUT BUFFER  A34832 63350020
         L     R1,IWAPARM              ADDRESS OF PARAMETER LIST        63400019
         L     RF,VIEZN                ADDRESS OF COMPRESS ROUTINE      63500019
         BALR  RE,RF                                                    63600019
         SPACE                                                          63700019
         LTR   RF,RF                                                    63800019
         BCR   EQU,R4                  RECORD WAS COMPRESSED            63900019
**********************************************************************  64000019
*                                                                    *  64100019
* IF THIS IS A PEND VERB CONTROL IS TRANSFERRED TO VIN015 TO XCTL       64200019
* TO VHA.  FOR ANY OTHER STATEMNT ANOTHER STATEMENT WILL BE READ.       64300019
*                                                                    *  64400019
**********************************************************************  64500019
         SPACE                                                          64600019
         MVI   QMPOP,QMASGN            ASSIGN                           64700019
         L     RF,VIEFVHQ              Q MANAGER INTERFACE              64900019
         BALR  RE,RF                   Q MANAGER INTERFACE              65000019
         L     R2,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 65100019
         MVC   DISPLFOR(MVTHREE,R2),WKPTR2   RECORD ON QUEUE       3391 65200019
         MVC   WKPTR2(MVTHREE),DISPLZER(R2) TTR RETURNED FROM ASSIGN    65300019
         MVC   WKTTR(MVTHREE),DISPLZER(R2) ADDR OF NEXT RECORD IN PROC  65400019
         MVC   DISPLZER(MVFOUR,R2),IWAWKBF CORE ADDR OF WORK BUFFER3391 65500019
         MVI   DISPLID(R2),INSRECID  MOVE BLOCK ID FOR WRITE     Y02621 65550002
         MVI   QMPOP,QMWRTE            WRITE THE RRCORD TO THE Q        65600019
         BALR  RE,RF                                                    65900019
         LA    R2,WKRECORD             REINITIALIZE POINTER TO          66200019
         ST    R2,IEZCOMPR             WHERE NEXT COMPRESSED RECORD     66300019
*                                      SHOULD GO                        66400019
         LA    R2,OUTLN                LENGTH OF OUTPUT BEFFER          66500019
         STH   R2,IEZOUT               LENGTH OF OUTPUT BUFFER          66600019
         B     VINACOM2                COMPRESS THE RECORD              66700019
         EJECT                                                          66800019
**********************************************************************  66900019
*                                                                    *  67000019
* THIS SUBROUTINE BRANCHES TO IEFVINE TO SYNTAX THE PROC OR PEND     *  67100019
* STATEMENTS.  UPON RETURN IT TESTS COMMON ERROR CONDITIONS.         *  67200019
*        IF THE HIGH ORDER BIT OF THE RETURN CODE IS SET A CONTINUA- *  67300019
*        TION IS EXPECTED.  CONTROL IS PASSED TO THE CONTINUATION SUB*  67400019
*        ROUTINE                                                     *  67500019
*                                                                    *  67600019
*        IF THE RETURN CODE IS 12, AN ERROR EXISTS IN THE LABEL FIELD*  67700019
*        CONTROL IS PASSED TO AN ERROR ROUTINE                       *  67800019
*        IF THE RETURN CODE IS 16, AN ERROR EXISTS IN THE USE OF     *  67900019
*        COMMENTS.  CONTROL IS PASSED TO AN ERROR ROUTINE            *  68000019
*                                                                    *  68100019
*        IF NONE OF THESE ERROR EXIST CONTROL IS RETURNED THROUGH    *  68200019
*        REGISTER 2                                                  *  68300019
*                                                                    *  68400019
**********************************************************************  68500019
         SPACE                                                          68600019
VINASYNT DS    0H                                                       68700019
         L     R1,RSTMT                ADDRESS OF INPUT BUFFER          68800019
         L     RF,VIEFVINE             SYNTAX CHECKER                   68900019
         BALR  RE,RF                                                    69000019
         L     R4,DISPL10(RD)          RETURN CODE FROM IEFVINE   4329  69100019
         LA    R3,ERRTEST              CHECK FOR ERROR                  69400019
         CR    R4,R3                   ARE THERE ANY ERRORS?      4329  69500019
         BE    VINAERR2                ERROR IN THE LABEL FIELD         69700019
         BR    R2                      RETURN TO CALLER            O106 69900019
         EJECT                                                          70100019
*********************************************************************** 70300019
*                                                                     * 70500019
*  THIS SUBROUTINE IS THE FIRST PORTION OF THE READER END OF FILE     * 70700019
*  ROUTINE.  IT IS USED ONLY IF THE CONDITION OCCURS IN IEFVINA.  IT  * 70900019
*    SETS THE READER END OF FILE BIT IN IWA AND FREES CORE.       O106* 71100019
*    IT THEN XCTL'S TO IEFVHA TO FINISH CLOSING SYSIN                 * 71400019
*                                                                     * 71700019
*********************************************************************** 71900019
         SPACE                                                          72100019
VINAEOF  DS    0H                                                 19093 72300019
         SPACE                                                          72500019
         OI    IWAPARM,EOFRINPR        SET READER EOF BIT         19093 72700019
         LA    R5,VINA100              XCTL TO IEFVHA             19093 72900019
         SPACE                                                          73100019
VINAEXIT DS    0H                                                 19093 73300019
         SPACE                                                          73500019
         LA    R0,VINACORE             LENGTH OF CORE             19093 73700019
         L     R1,IWAPARM              ADDRESS OF PARM LIST       19093 73900019
         FREEMAIN  R,LV=(0),A=(1)                                       74100019
         XC    IWAPARM+DISPLONE(MVTHREE),IWAPARM+DISPLONE         19093 74300019
*                                      CLEAR PARM LIST POINTER    19093 74500019
         SPACE                                                          74700019
VINAEXT1 DS    0H                                                 19093 74900019
         MVI   MSGKEY,DISPLZER         CLEAR SECONDARY MESSAGE KEY19093 75100019
         SPACE                                                          75300019
         IEFRELSE                                                       75500019
         SPACE                                                          75700019
         BR    R5                      RETURN TO THE CALLER       19093 75900019
*********************************************************************** 76100019
*                                                                     * 76300019
*  THIS SUBROUTINE IS THE FIRST PORTION OF THE SYNAD ROUTINE FOR N      76500019
*  AN I/O ERROR SHOULD IT OCCUR WHILE READING AN INPUT RECORD IN  O106* 76700019
*  LOAD MODULE.  THE I/O ERROR BIT IN THE IWA IS SET, THE EODAD   O106* 76900019
*  AND SYNAD ROUTINE ADDRESSES ARE REPLACED IN THE QAAM DCB, CORE O106* 77100019
*  IS FREED AND CONTROL IS RETURNED TO IEFVHA TO COMPLETE PROCESSING  * 77300019
*  OF THE I/O ERROR                                               O106* 77500019
*                                                                     * 77700019
*********************************************************************** 77900019
         SPACE                                                          78100019
VINASYND DS    0H                                                 19093 78300019
         OI    SWC,IOERR               SET I/O ERROR SWITCH IN IWA19093 78500019
         LA    R5,VINA100              XCTL TO IEFVHA FOR INPUT  A49933 78550001
         B     VINAEXIT                REPLACE DCB ADDRESSES      19093 78700019
VINAGET  DS    0H                                                Y02668 78705002
         LA    R4,RPLADDR               GET ADDRESS OF RPL       Y02668 78710002
         USING IFGRPL,R4                SET BASE FOR RPL         Y02668 78715002
         L     R2,WANELPTR              GET ADDRESS OF NEL       Y02668 78720002
         USING NEL,R2                   SET BASE FOR NEL         Y02668 78725002
         MVI RPLREQ,RPLGET              REQUEST IS A GET         Y02668 78730002
         MVC   RPLDACB,NELJCLCB         SET POINTER TO ACB       Y02668 78735002
         MVC   RPLAREA,RSTMT            SET POINTER TO BUFFER    Y02668 78740002
         XC    RPLARG(4),RPLARG         ZERO UNUSED FIELD        Y02668 78745002
         MVI   RPLOPT1,RPLSEQ           GET IS SEQUENTIAL        Y02668 78750002
         XC    RPLRLEN(4),RPLRLEN       ZERO UNUSED FIELD        Y02668 78755002
         LA    R0,80                    GET BUFFER LENGTH        Y02668 78760002
         ST    R0,RPLBUFL               SET MAXIMUM BUFFER LENTH Y02668 78765002
         XC    RPLDDDD(4),RPLDDDD       ZERO UNUSED FIELD        Y02668 78770002
         DROP  R2                       RELEASE BASE FOR NEL     Y02668 78775002
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 78780002
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 78782002
         LR    R1,R4                    POINT TO RPL             Y02668 78785002
         GET   RPL=(1)                                                  78790002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 78795002
         LTR   RF,RF               CHECK FOR ERROR               Y02668 78820002
         BCR   8,R5                     RETURN NO ERROR          Y02668 78825002
         CLI   RPLRTNCD,RPLLOGER   IS THIS A LOGICAL ERROR ?     Y02668 78826002
         BNE   ERREXIT             NO. GO TO ERROR EXIT          Y02668 78827002
         CLI   RPLERRCD,RPLEODER   IS END OF DATA DETECTED ?     Y02668 78828002
         BE    VINAEOF             YES. GO TO EOF ROUTINE        Y02668 78829002
         DROP  R4                  RELEASE BASE FOR RPL          Y02668 78829502
ERREXIT  DS    0H                                                       78830002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE               Y02668 78835002
         LA    R5,4                I/O ERROR MSG CODE            Y02668 78840002
         L     RF,VIEFVHR               GET POINTER TO IEFVHR    Y02668 78845002
         BALR  RE,RF                    WRITE MSG TO OPERATOR    Y02668 78850002
         LA    R2,20               I/O ERROR MSG CODE            Y02668 78855002
         L     RF,VIEFVGM               GET ADDRESS OF IEFVGM    Y02668 78860002
         BALR  RE,RF                    WRITE OUT ERROR MSG      Y02668 78865002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 78870002
         BR    RF                  GO TO TERMINATION             Y02668 78880002
         EJECT                                                          78900019
         DS    0F                                                       79100019
VIEFVINB DC    V(IEFVINB)              ADDRESS OF DIRECTORY SEARCH      79300019
VIEFVINC DC    V(IEFVINC)              ADDRESS OF DIRECTORY BUILD       79500019
VIEFVINE DC    V(IEFVINE)              ADDRESS OF SYNTAX CHECKER        79700019
VIEFVHQ  DC    V(IEFVHQ)               ADDRESS OF Q MANAGER INTERFACE   79900019
VIEFVGM  DC    V(IEFVGM)               ADDRESS OF MESSAGE MODULE        80100019
VIEZN    DC    V(IEZNCODE)             ADDRESS OF COMPRESS ROUTINE      80300019
VIEFVHR  DC    V(IEFVHR)                                                80320002
VIEFVHCB DC    V(IEFVHCB)          ADDRESS OF VERB ID MODULE.    Y02668 80360002
VIEFVHA  DC    V(IEFVHA)           ADDRESS OF GET MODULE.        Y02668 80420002
         SPACE                                                          80500019
VINASTCM DC    C'*,'                   DD    *,   STATEMENT       4362  80700019
VINADATC DC    C'DATA,'                SYSIN  DD  DATA,DCB=       4362  80900019
VINADATA DC    C'DATA '                DD DATA STATEMENT                81100019
VINAPEND DC    C'PEND '                                                 81300019
VINAJOB  DC    C'JOB '                                                  81500019
VINAEXEC DC    C'EXEC '           EXEC STATEMENT                 SM4182 81550001
         SPACE                                                          81700019
VINAMV2  MVC   PROCNAME(0),2(R5)                                        81900019
VINAMOVE MVC   QMNAM(0),2(R5)          PROCNAME TO QMPA                 82100019
         SPACE                                                          82300019
* THE FOLLOWING FIVE DC'S MUST REMAIN IN THIS ORDER.  THEY FORM THE   * 82500019
* GENERATED DD * STATEMENT.                                           * 82700019
VINASLH  DC    X'6161'                 FIRST TWO CHARACTERS OF STMT     82900019
VINASYS  DC    C'SYSIN '               PART OF GENERATED STMT           83100019
VINADD   DC    C'DD '                  DD VERB                          83300019
VINAST   DC    C'* '               OPERAND OF GENERATED STMT            83400019
         DC    C'INSTREAM PROC GENERATED STATEMENT ' COMMENT OF GEN DD  83500019
VINABLNK DC    C' '                     BLANK TO CLEAR READER    A35012 83560020
*                                       BUFFER                   A35012 83620020
         SPACE                                                          83700019
VINAPLUS DC    C'++'                   IN-LINE PROCEDURE                83900019
PGMERROR DC    X'0024'             PGM ERROR CODE (36)           Y02668 84000002
VINACORE EQU   24                      LENGTH OF THE PARAMETER LIST     84100019
QMSYSOUT EQU   X'3'                    DEQUEUE TYPE                     84300019
WORKLN   EQU   352                     LENGTH OF WORK BUFFER       O106 84500019
QMPALN1  EQU   48                      LENGTH OF QMPA              O106 84700019
EOFRINPR EQU   X'40'                   INDICATE END OF READER           84800019
VINAQUOT EQU   C''''                   TEST FOR A LITERAL               84900019
VINACONT DC    C', '                   CHECK FOR CONTINUATION      3157 85000019
VINASTE  EQU   C'*'                    CHECK FOR COMMENT STATEMENT4362  85100019
MVONE    EQU   1                        LENGTH OF MOVE           A35012 85200020
MVTWO    EQU   2                       LENGTH OF MOVE                   85300019
MVTHREE  EQU   3                       LENGTH OF MOVE                   85500019
MVFOUR   EQU   4                       LENGTH OF MOVE                   85700019
MVFIVE   EQU   5                       LENGTH OF MOVE                   85900019
MVSEVEN  EQU   7                       LENGTH OF MOVE                   86100019
MVEIGHT  EQU   8                       LENGTH OF MOVE                   86300019
MV46     EQU   46                                                 M3738 86500019
MV79     EQU   79                       LENGTH OF READER STATE-  A35012 86600020
*                                       MENT MINUS ONE FOR MOVE  A35012 86700020
DISPLZER EQU   0                       DISPLACEMENT                     86900019
DISPLONE EQU   1                       DISPLACEMENT                     87100019
DISPLTWO EQU   2                       DISPLACEMENT                     87300019
DISPL3   EQU   3                       DISPLACEMENT                     87500019
DISPLFOR EQU   4                       DISPLACEMENT                     87700019
DISPL10  EQU   16                      REGISTER 15 IN THE SAVE AREA,    87900019
*                                      RETURN CODE FROM IEFVINE         88100019
DISPL24  EQU   X'24'                   REGISTER 4 IN THE SAVE AREA4329  88300019
COMPTWO  EQU   2                       LENGTH OF COMPARE                88500019
COMTHREE EQU   3                       LENGTH OF COMPARE                88700019
COMPFIVE EQU   5                       LENGTH OF COMPARE                88900019
NOENTRY  EQU   0                       NO IN-LINE PROCEDURES HAVE BEEN  89100019
*                                      ENCOUNTERED YET                  89300019
VINAEND  EQU   70                      END OF STATEMENT            3156 89400019
INPLN    EQU   80                      LENGTH OF INPUT BUFFER FOR       89500019
*                                      IEZNCODE                         89700019
OUTLN    EQU   168                     LENGTH OF OUTPUT BUFFER FOR      89900019
*                                      IEZNCODE                         90100019
TYPEZER  EQU   X'00'                   NOT A SPECIAL RECORD             90300019
EQU      EQU   8                       BRANCH ON EQUAL-RECORD FIT IN    90500019
*                                      THE BUFFER                       90700019
INITBLK  EQU   X'40'                   INITIALIZE QMNAM TO BLANKS       90900019
QMPALN   EQU   36                  LENGTH OF QMPA                       91100019
QMTPYONE EQU   1                       LENGTH OF QMTPY FIELD            91300019
QMTPYF   EQU   15                      DISPLACEMENT INTO QMPA TO        91500019
*                                      QMPTY FIELD                      91700019
ASSIGN1  EQU   X'10'                   NUMBER OF RECORDS TO ASSIGN      91900019
PRIMARY1 EQU   X'3F'                   NO PROCEDURE NAME                92100019
PRIMARY2 EQU   X'3E'                   SYNTAX ERROR                     92300019
PRIMARY4 EQU   X'41'                   EXCESSIVE NUMBER OF PROCEDURES   92700019
HIORDER  EQU   X'80'                   CONTINUATION OF A PEND OR PROC   92900019
*                                      STATEMENT                        93100019
ERRTEST  EQU   12                      TEST FOR ERROR ON PROCEDURE      93300019
*                                      DELIMITERS                       93500019
LENGONE  EQU   1                       NUMBER OF BITS TO SHIFT TO TURN  93700019
*                                      OFF HIGH ORDER BIT               93900019
CLFOUR   EQU   4                       CLEAR PTRS IN IWA          19093 94100019
SYMPARM  EQU   X'40'                   SYMBOLIC PARAMETERS EXIST  4329  94300019
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 94400002
         END                                                            94500019
./  ADD  SSI=30900647,NAME=IEFVINB
* TITLE: IEFVINB-DIRECTORY SEARCH                                     * 00600020
*                                                                     * 01200020
* FUNCTION: THIS MODULE SEARCHES THROUGH THE DIRECTORY FOR A DUPLICATE* 01800020
*           PROCEDURE NAME. IT SETS A RETURN CODE INDICATING WHETHER  * 02400020
*           THE PROCEDURE WAS FOUND OR NOT. A ZERO INDICATES THE PRO-*  03000020
*           CEDURE WAS NOT FOUND.  IF THE PROCEDURE WAS FOUND, THE    * 03600020
*           RETURN CODE WILL CONSIST OF THE TTR OF THE FIRST RECORD   * 04200020
*           OF THAT PROCEDURE.                                        * 04800020
*                                                                     * 05400020
* ENTRY POINT: IEFVINB                                                * 06000020
*                                                                     * 06600020
* INPUT: R1 POINTS TO A 20 BYTE PARAMETER LIST                        * 07200020
*                                                                     * 07800020
*        ***************************************************          * 08400020
*        *                                                 *          * 09000020
*        *     BYTES     PURPOSE                           *          * 09600020
*        *                                                 *          * 10200020
*        *     0-3       ADDRESS OF THE PARAMETER LIST     *          * 10800020
*        *     4-11      PROCEDURE NAME                    *          * 11400020
*        *     12-15     ADDRESS OF THE DIRECTORY          *          * 12000020
*        *     16-19     RETURN CODE FROM IEFVINB          *          * 12600020
*        *     20-23     RETURN CODE FROM IEFVINC          *          * 13200020
*        *                                                 *          * 13800020
*        ***************************************************          * 14400020
*                                                                     * 15000020
* EXITS: RETURNS TO CALLER                                            * 15600020
*                                                                     * 16200020
* OUTPUT: RETURN CODE                                                 * 16800020
*           0-PROCEDURE WAS NOT FOUND IN DIRECTORY                    * 17400020
*         TTR-TTR OF FIRST RECORD IN PROCEDURE                        * 18000020
*                                                                     * 18600020
* WORKAREAS OR TABLES                                                 * 19200020
*       PARM-PARAMETER LIST                                           * 19800020
*       WORK AREA-WORK BUFFER AND DIRECTORY                           * 20400020
*       IEFQMNGR-QMPA                                                 * 21000020
*       IEFVMIWA-IWA                                                  * 21600020
*                                                                     * 22200020
* REGISTER USEAGE-R8-QMPA                                             * 22800020
*                 R7-WORK BUFFER                                      * 23400020
*                                                                     * 24000020
* MACROES USED-RETURN                                                 * 24600020
*              SAVE                                                   * 25200020
*                                                                     * 25800020
* OPERATION-.SETS UP ADDRESSIBILITY FOR QMPA AND WORK AREA            * 26400020
*           .COMPARES EACH PROCEDURE NAME IN THE DIRECTORY WITH THE   * 27000020
*            PROCEDURE NAME PASSED AS A PARAMETER                     * 27600020
*           .IF THE PROCEDURE DOES NOT EXIST, A ZERO IS PLACED IN THE * 28200020
*            RTCD FIELD IN THE PARAMETER LIST                         * 28800020
*           .IF THE PROCEDURE NAME DOES EXIST, THE TTR OF THE FIRST   * 29400020
*            RECORD OF THAT PROCEDURE IS PLACED IN THE RTCD FIELD     * 30000020
*            OF THE PARAMETER LIST                                    * 30600020
*                                                                     * 31200020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 31800020
         EJECT                                                          32400020
         IEFCOMWA                                                       33000002
         IEFCVRWA                                                       33300002
         EJECT                                                          33600020
         IEFQMNGR                                                       34200020
QMPADDR  DS    CL4                     ADDRESS OF WORK BUFFER           34800020
QMPATTR  DS    CL3                     TTR OF JOB QUEUE RECORD          35400020
QMPAZER  DS    CL1  N                  RESERVED FIELD                   36000020
         EJECT                                                          36600020
WORKAREA DSECT                                                          37200020
         USING WORKAREA,R7                                              37800020
WKTTR    DS    CL4                     POINTER TO NEXT RECORD           38400020
WKQMPAPT DS    CL4                     ADDRESS OF QMPA                  39000020
WKRECORD DS    CL168                   COMPRESSED RECORD                39600020
WKPTR1   DS    CL4                     POINTER TO ITSELF                40200020
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN        40800020
*                                      THIS SEGMENT OF THE DIRECTORY    41400020
WKPTR2   DS    CL3                     HOLDER OF TTR ASSIGNED BY  O106  42000020
*                                      THE QUEUE MANAGER          O106  42600020
WKPROCN1 DS    CL8                     PROCEDURE NAME                   43200020
WKTTR1   DS    CL3                     TTR OF FIRST RECORD              43800020
WKPROCN2 DS    CL8                     PROCEDURE NAME                   44400020
WKTTR2   DS    CL3                     TTR OF FIRST RECORD              45000020
WKPROCN3 DS    CL8                     PROCEDURE NAME                   45600020
WKTTR3   DS    CL3                     TTR OF FIRST RECORD              46200020
WKPROCN4 DS    CL8                     PROCEDURE NAME                   46800020
WKTTR4   DS    CL3                     TTR OF FIRST RECORD              47400020
WKPROCN5 DS    CL8                     PROCEDURE NAME                   48000020
WKTTR5   DS    CL3                     TTR OF FIRST RECORD              48600020
WKPROCN6 DS    CL8                     PROCEDURE NAME                   49200020
WKTTR6   DS    CL3                     TTR OF FIRST RECORD              49800020
WKPROCN7 DS    CL8                     PROCEDURE NAME                   50400020
WKTTR7   DS    CL3                     TTR OF FIRST RECORD              51000020
WKPROCN8 DS    CL8                     PROCEDURE NAME                   51600020
WKTTR8   DS    CL3                     TTR OF FIRST RECORD              52200020
WKPROCN9 DS    CL8                     PROCEDURE NAME                   52800020
WKTTR9   DS    CL3                     TTR OF FIRST RECORD              53400020
WKPROCNA DS    CL8                     PROCEDURE NAME                   54000020
WKTTRA   DS    CL3                     TTR OF FIRST RECORD              54600020
WKPROCNB DS    CL8                     PROCEDURE NAME                   55200020
WKTTRB   DS    CL3                     TTR OF FIRST RECORD              55800020
WKPROCNC DS    CL8                     PROCEDURE NAME                   56400020
WKTTRC   DS    CL3                     TTR OF FIRST RECORD              57000020
WKPROCND DS    CL8                     PROCEDURE NAME                   57600020
WKTTRD   DS    CL3                     TTR OF FIRST RECORD              58200020
WKPROCNE DS    CL8                     PROCEDURE NAME                   58800020
WKTTRE   DS    CL3                     TTR OF FIRST RECORD              59400020
WKPROCNF DS    CL8                     PROCEDURE NAME                   60000020
WKTTRF   DS    CL3                     TTR OF FIRST RECORD              60600020
         EJECT                                                          61200020
PARAM    DSECT                                                          61800020
         USING PARMADDR,R1                                              62400020
PARMADDR DS    CL4                     ADDRESS OF PARAMETER LIST        63000020
PROCNAME DS    CL8                     PROCEDURE NAME                   63600020
DIRECT   DS    CL4                     ADDRESS OF DIRECTORY             64200020
IWAPTR   DS    CL4                     ADDRESS OF IWA                   64800020
RTCD     DS    CL4                     RETURN CODE FORM IEFVINB         65400020
         EJECT                                                          66000020
IEFVINB  CSECT                                                          66600020
         SAVE  (14,12)                                                  67200020
         BALR  RB,0                                                     67800020
         USING *,RB                                                     68400020
**************************************************************** Y02668 68460002
* MODULE TRACE CODE - FOR TESTING                                Y02668 68520002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 68580002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 68640002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 68700002
         DC    C'VINB'             MOD ID USED BY TRACE          Y02668 68760002
* TRACE RETURNS HERE.                                            Y02668 68820002
**************************************************************** Y02668 68880002
         B     VINB000                 BRANCH AROUND IDENTIFICATION     69000020
         MODID BR=NO                                             Y01886 69050001
         DC    C'MVM'              FUNCTION ID AND               Y02668 69750002
         DC    C'04'         LEVEL # (WA MACRO UPDATES).         Y02668 70450002
         SPACE                                                          71400020
VINB000  DS    0H                                                       72000020
         L     R7,IWAWKBF              ADDRESSIBILITY OF WORK AREA      72600020
         XR    R3,R3                   CLEAR REGISTER FOR COUNT         73200020
         IC    R3,WKCT                 NUMBER OF ENTRIES IN SEGMENT     73800020
         LA    R4,WKPROCN1             ADDRESS OF FIST PROCNAME         74400020
         SPACE                                                          75000020
****************************************************************        75600020
*                                                              *        76200020
* SEE IF PROCEDURE NAME EXISTS IN DIRECTORY                    *        76800020
*                                                              *        77400020
****************************************************************        78000020
VINB030  DS    0H                                                       78600020
         CLC   DISPLZER(MVEIGHT,R4),PROCNAME COMPARE FOR PROC NAME      79200020
         BE    VINB050                 PROCNAME WAS FOUND               79800020
         LA    R4,DISPLELE(R4)         INCREMENT TO NEXT PROCNAME       80400020
         BCT   R3,VINB030              SEE IF MORE ENTRIES EXIST        81000020
         SPACE                                                          81600020
****************************************************************        82200020
*                                                              *        82800020
*  PROCEDURE NAME WAS NOT FOUND.  RETURN CODE EQUALS ZERO      *        83400020
*                                                              *        84000020
****************************************************************        84600020
         XC    RTCD(CLFOUR),RTCD       PROCEDURE NAME NOT FOUND         85200020
         RETURN (14,12)                                                 85800020
         SPACE                                                          86400020
****************************************************************        87000020
*                                                              *        87600020
* PROCEDURE NAME WAS FOUND.  RETURN CODE EQUALS THE TTR        *        88200020
* OF THE FIRST RECORD OF THE PROCEDURE                         *        88800020
*                                                              *        89400020
****************************************************************        90000020
         SPACE                                                          90600020
VINB050  DS    0H                                                       91200020
         MVC   RTCD(MVTHREE),DISPLATE(R4) PROCEDURE WAS FOUND           91800020
         RETURN (14,12)                                                 92400020
MVTHREE  EQU   3                       LENGTH OF MOVE                   93000020
MVEIGHT  EQU   8                       LENGTH OF MOVE                   93600020
CLFOUR   EQU   4                       LENGTH OF CORE TO BE CLEARED     94200020
DISPLZER EQU   0                       DISPLACEMENT                     94800020
DISPLATE EQU   8                       DISPLACEMENT                     95400020
DISPLELE EQU   11                      DISPLACEMENT                     96000020
         END                                                            96600020
./  ADD  SSI=30922102,NAME=IEFVINC
         TITLE ' /***************************************************'  00001000
IEFVINC  CSECT ,                                                   0001 00002000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00003000
         BALR  @11,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@11                                         0001 00006000
         L     @00,@SIZDATD                                        0001 00007000
         GETMAIN R,LV=(0)                                               00008000
         LR    @09,@01                                             0001 00009000
         USING @DATD,@09                                           0001 00010000
         ST    @13,@SA00001+4                                      0001 00011000
         LM    @00,@01,20(@13)                                     0001 00012000
         ST    @09,8(,@13)                                         0001 00013000
         LR    @13,@09                                             0001 00014000
         MVC   @PC00001(4),0(@01)                                  0001 00015000
*************************************************************** Y02668  00016000
* MODULE TRACE CODE - FOR TESTING.                              Y02668  00017000
        L     15,TRACEV           LOAD TRACE RTNE ADDR.         Y02668  00018000
        CNOP  2,4                                               Y02668  00019000
        BALR  14,15               ENTER MOD ID IN TRACE RECORD  Y02668  00020000
TRACEV  DC    V(TRACE)            TRACE RTNE ADDR.              Y02668  00021000
        DC    C'VINC'             MOD ID USED BY TRACE.         Y02668  00022000
* TRACE RETURNS HERE                                            Y02668  00023000
*************************************************************** Y02668  00024000
        B     INSTR               BRANCH ARROUND ID             Y02668  00025000
        DC    X'11111111'                                               00026000
        DC    C'VINC'                                                   00027000
        DC    C'L.01'                                                   00028000
        DC    C'MVM'              FUNCTION ID AND               Y02668  00029000
        DC    C'03'         LEVEL # (IEFVHQ REG. 12 FIX).       Y02668  00030000
*INSTR:                                                            0020 00031000
*    R6=RTCD;   /* SAVE RETURN CODE */                             0020 00032000
INSTR    L     @10,@PC00001                                        0020 00033000
         L     R6,RTCD(,@10)                                       0020 00034000
*        R2=IWAWKBF;             /* ADDRESS OF WORK AREA */        0021 00035000
         L     @08,WAPTR(,@10)                                     0021 00036000
         L     R2,IWAWKBF+372(,@08)                                0021 00037000
*        R3=CT+1;         /* NUMBER OF ENTRIES */                  0022 00038000
         LA    R3,1                                                0022 00039000
         SR    @08,@08                                             0022 00040000
         IC    @08,CT(,R2)                                         0022 00041000
         AR    R3,@08                                              0022 00042000
*        IF R6>0 THEN                                              0023 00043000
         LTR   R6,R6                                               0023 00044000
         BNP   @RF00023                                            0023 00045000
*        DO;                                                       0024 00046000
*/********************************************************************/ 00047000
*/*                                                                  */ 00048000
* /* PROCEDURE NAME WAS FOUND  NO ENTRY HAS TO BE MADE IN DIRECTORY*/   00049000
*/*                                                                  */ 00050000
*/********************************************************************/ 00051000
*        PTR2=RTCD ; /* RTCD CONTAINS TTR OF SAME NAME PROC     M1971*/ 00052000
         MVC   PTR2(3,R2),RTCD(@10)                                0025 00053000
* /* TTR OF FIRST RECORD OF PROC */                                0026 00054000
*        CT=R3-1;         /* NUMBER OF ENTRIES  */                 0026 00055000
         LR    @10,R3                                              0026 00056000
         BCTR  @10,0                                               0026 00057000
         STC   @10,CT(,R2)                                         0026 00058000
*        GOTO LABEL;              /* SET RETURN CODE AND EXIT */   0027 00059000
         B     LABEL                                               0027 00060000
*        END;                                                      0028 00061000
*            R5=QPARMP;         /* INITIALIZE QMPA POINTER */      0029 00062000
@RF00023 L     @10,@PC00001                                        0029 00063000
         L     @08,WAPTR(,@10)                                     0029 00064000
         L     R5,QPARMP(,@08)                                     0029 00065000
*/********************************************************************/ 00066000
*/*                                                                  */ 00067000
* /*PROCEDURE NAME WAS NOT FOUND.  AN ENTRY MUST BE MADE*/         0030 00068000
*/*                                                                  */ 00069000
*/********************************************************************/ 00070000
*        IF    R3=16 THEN         /* MAXIMUM NUMBER OF IN-LINE PROCS*/  00071000
         CH    R3,@CH00090                                         0030 00072000
         BNE   @RF00030                                            0030 00073000
*        DO;                                                       0031 00074000
*        RTCD=4;                  /* EXCESSIVE NUMBER OF INLINE      */ 00075000
         MVC   RTCD(4,@10),@CF00226                                0032 00076000
*                                 /* PROCEDURES */                 0033 00077000
*        RETURN;                                                   0033 00078000
@EL00001 L     @13,4(,@13)                                         0033 00079000
@EF00001 L     @00,@SIZDATD                                        0033 00080000
         LR    @01,@09                                             0033 00081000
         FREEMAIN R,LV=(0),A=(1)                                        00082000
@ER00001 LM    @14,@12,12(@13)                                     0033 00083000
         BR    @14                                                 0033 00084000
*        END;                                                      0034 00085000
*/********************************************************************/ 00086000
*/*                                                                  */ 00087000
* /* A RECORD IS ASSIGNED TO CONTAIN THE NEW PROCEDURE AND THE */  0035 00088000
* /* DIRECTORY ENTRY IS BUILT */                                   0035 00089000
*/*                                                                  */ 00090000
*/********************************************************************/ 00091000
*        QMPOP=1;                 /*ASSIGN RECORD TO CONTAIN PROC*/     00092000
@RF00030 MVI   QMPOP(R5),X'01'                                     0035 00093000
*        RC=WAPTR;                                           /*Y02668*/ 00094000
         L     @10,@PC00001                                        0036 00095000
         L     RC,WAPTR(,@10)                                      0036 00096000
*        CALL IEFVHQ;                                              0037 00097000
         L     @15,@CV00343                                        0037 00098000
         BALR  @14,@15                                             0037 00099000
*        R6=QMPACL;  /* ADDRESS OF EXTERNAL PARM LIST            3199*/ 00100000
         SR    R6,R6                                               0038 00101000
         ICM   R6,7,QMPACL(R5)                                     0038 00102000
*        TTR1(R3)=ADDRESS;        /* TTR OF PROCEDURE */           0039 00103000
         LR    @10,R3                                              0039 00104000
         MH    @10,@CH00033                                        0039 00105000
         ST    @10,@TF00001                                        0039 00106000
         ALR   @10,R2                                              0039 00107000
         MVC   TTR1-11(3,@10),ADDRESS(R6)                          0039 00108000
*        PROCNM(R3)=PROCNAME;     /*NAME OF PROCEDURE*/            0040 00109000
         LR    @10,R2                                              0040 00110000
         AL    @10,@TF00001                                        0040 00111000
         L     @08,@PC00001                                        0040 00112000
         MVC   PROCNM-11(8,@10),PROCNAME(@08)                      0040 00113000
*        CT=R3;     /* INCREMENT COUNT */                          0041 00114000
         STC   R3,CT(,R2)                                          0041 00115000
*        PTR2=ADDRESS;            /* TTR RETURNED FROM ASSIGN */   0042 00116000
         MVC   PTR2(3,R2),ADDRESS(R6)                              0042 00117000
*LABEL:                                                            0043 00118000
*        RTCD=0;                  /* LESS THAN 15 PROCEDURES */    0043 00119000
LABEL    L     @10,@PC00001                                        0043 00120000
         SR    @08,@08                                             0043 00121000
         ST    @08,RTCD(,@10)                                      0043 00122000
*        RETURN;                                                   0044 00123000
         B     @EL00001                                            0044 00124000
*        END                                                       0045 00125000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00126000
*/*%INCLUDE SYSLIB  (IEFCOMWA)                                        * 00127000
*/*%INCLUDE SYSLIB  (IEFCVRWA)                                        * 00128000
*;                                                                 0045 00129000
         B     @EL00001                                            0045 00130000
@DATA    DS    0H                                                       00131000
@CH00033 DC    H'11'                                                    00132000
@CH00090 DC    H'16'                                                    00133000
@DATD    DSECT                                                          00134000
         DS    0F                                                       00135000
@SA00001 DS    18F                                                      00136000
@PC00001 DS    1F                                                       00137000
@TF00001 DS    F                                                        00138000
IEFVINC  CSECT                                                          00139000
         DS    0F                                                       00140000
@CF00226 DC    F'4'                                                     00141000
@DATD    DSECT                                                          00142000
         DS    0D                                                       00143000
@ENDDATD EQU   *                                                        00144000
IEFVINC  CSECT                                                          00145000
         DS    0F                                                       00146000
@SIZDATD DC    AL1(0)                                                   00147000
         DC    AL3(@ENDDATD-@DATD)                                      00148000
@CV00343 DC    V(IEFVHQ)                                                00149000
         DS    0D                                                       00150000
PATCH    DC    XL100'0'                                                 00151000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00152000
@01      EQU   01                                                       00153000
@02      EQU   02                                                       00154000
@03      EQU   03                                                       00155000
@04      EQU   04                                                       00156000
@05      EQU   05                                                       00157000
@06      EQU   06                                                       00158000
@07      EQU   07                                                       00159000
@08      EQU   08                                                       00160000
@09      EQU   09                                                       00161000
@10      EQU   10                                                       00162000
@11      EQU   11                                                       00163000
@12      EQU   12                                                       00164000
@13      EQU   13                                                       00165000
@14      EQU   14                                                       00166000
@15      EQU   15                                                       00167000
R2       EQU   @02                                                      00168000
R3       EQU   @03                                                      00169000
R4       EQU   @04                                                      00170000
R5       EQU   @05                                                      00171000
R6       EQU   @06                                                      00172000
RC       EQU   @12                                                      00173000
RD       EQU   @13                                                      00174000
R1       EQU   @01                                                      00175000
R7       EQU   @07                                                      00176000
COMWA    EQU   0                                                        00177000
CWAL     EQU   COMWA                                                    00178000
CWAID    EQU   COMWA+4                                                  00179000
CWACONID EQU   COMWA+8                                                  00180000
QPARMP   EQU   COMWA+12                                                 00181000
IWAIOSA  EQU   COMWA+88                                                 00182000
WARPL    EQU   COMWA+160                                                00183000
CWARET   EQU   COMWA+344                                                00184000
CWAMCSCA EQU   COMWA+346                                                00185000
CWAMSLEN EQU   COMWA+360                                                00186000
AOSW1    EQU   COMWA+361                                                00187000
AOSW4    EQU   COMWA+362                                                00188000
SWE      EQU   COMWA+363                                                00189000
SWH      EQU   COMWA+364                                                00190000
SWI      EQU   COMWA+365                                                00191000
SWY2     EQU   COMWA+366                                                00192000
CVRWA    EQU   0                                                        00193000
IWAINTS4 EQU   CVRWA+8                                                  00194000
RSTMT    EQU   CVRWA+20                                                 00195000
VERB     EQU   RSTMT+4                                                  00196000
PSTMT    EQU   CVRWA+28                                                 00197000
VERBP    EQU   PSTMT+4                                                  00198000
IWAWKBF  EQU   CVRWA+260                                                00199000
AOKSCHSA EQU   CVRWA+304                                                00200000
AOKSRPRM EQU   CVRWA+403                                                00201000
AOSW2    EQU   CVRWA+417                                                00202000
AOSW3    EQU   CVRWA+418                                                00203000
IWAEXTS  EQU   CVRWA+420                                                00204000
SWA      EQU   CVRWA+425                                                00205000
SWB      EQU   CVRWA+426                                                00206000
SWC      EQU   CVRWA+427                                                00207000
SWD      EQU   CVRWA+428                                                00208000
SWV      EQU   CVRWA+429                                                00209000
CRSW1    EQU   CVRWA+430                                                00210000
SW2      EQU   CVRWA+438                                                00211000
QMPA     EQU   0                                                        00212000
QMNAM    EQU   QMPA                                                     00213000
QMPOP    EQU   QMPA+8                                                   00214000
QMPCL    EQU   QMPA+32                                                  00215000
QMPCMNC  EQU   QMPCL                                                    00216000
QMPACL   EQU   QMPCL+1                                                  00217000
EXADDR   EQU   0                                                        00218000
ADDRESS  EQU   EXADDR                                                   00219000
EXTTR    EQU   EXADDR+3                                                 00220000
WORKBUF  EQU   0                                                        00221000
DIRECT   EQU   WORKBUF+176                                              00222000
CT       EQU   DIRECT+4                                                 00223000
PTR2     EQU   DIRECT+5                                                 00224000
ARR      EQU   DIRECT+8                                                 00225000
PROCNM   EQU   ARR                                                      00226000
TTR1     EQU   ARR+8                                                    00227000
LIST     EQU   0                                                        00228000
PROCNAME EQU   LIST+4                                                   00229000
WAPTR    EQU   LIST+16                                                  00230000
RTCD     EQU   LIST+20                                                  00231000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00232000
DIRADR   EQU   LIST+12                                                  00233000
ADRESS   EQU   LIST                                                     00234000
PTR1     EQU   DIRECT                                                   00235000
RECORD   EQU   WORKBUF+8                                                00236000
QMPAPT   EQU   WORKBUF+4                                                00237000
TTR      EQU   WORKBUF                                                  00238000
ZEROHQ   EQU   EXTTR+3                                                  00239000
TTRHQ    EQU   EXTTR                                                    00240000
QMPNC    EQU   QMPCMNC                                                  00241000
QMPCM    EQU   QMPCMNC                                                  00242000
QMEIA    EQU   QMPA+28                                                  00243000
QMWTQ    EQU   QMPA+24                                                  00244000
QMRSD1   EQU   QMPA+22                                                  00245000
QMTID    EQU   QMPA+20                                                  00246000
QMLINK   EQU   QMPA+18                                                  00247000
QMPRI    EQU   QMPA+17                                                  00248000
QMSTA    EQU   QMPA+16                                                  00249000
QMTPY    EQU   QMPA+15                                                  00250000
QMNOT    EQU   QMPA+14                                                  00251000
QMTLN    EQU   QMPA+12                                                  00252000
QMTST    EQU   QMPA+11                                                  00253000
QMFLT    EQU   QMPA+9                                                   00254000
QMPEB    EQU   QMNAM+4                                                  00255000
QMCAN    EQU   QMNAM                                                    00256000
SNPSW    EQU   SW2                                                      00257000
DDSW     EQU   SW2                                                      00258000
EXECSW   EQU   SW2                                                      00259000
JOBSW    EQU   SW2                                                      00260000
COLST    EQU   SW2                                                      00261000
ENDS     EQU   SW2                                                      00262000
DDOV     EQU   SW2                                                      00263000
CMT      EQU   SW2                                                      00264000
SWY      EQU   CVRWA+437                                                00265000
IWANELEN EQU   CVRWA+436                                                00266000
SYMTTR   EQU   CVRWA+432                                                00267000
@NM00028 EQU   CVRWA+431                                                00268000
@NM00027 EQU   CRSW1                                                    00269000
CRRES1   EQU   CRSW1                                                    00270000
@NM00026 EQU   CRSW1                                                    00271000
CPFLG    EQU   CRSW1                                                    00272000
LPBYSW   EQU   SWV                                                      00273000
FPRNSW   EQU   SWV                                                      00274000
FBLITRL  EQU   SWV                                                      00275000
AMPSW    EQU   SWV                                                      00276000
FBFLUSH  EQU   SWV                                                      00277000
VERBCSW  EQU   SWV                                                      00278000
PROCERR  EQU   SWV                                                      00279000
OVKEYSW  EQU   SWV                                                      00280000
SYMPRC   EQU   SWD                                                      00281000
@NM00025 EQU   SWD                                                      00282000
FEXRCV   EQU   SWD                                                      00283000
@NM00024 EQU   SWD                                                      00284000
@NM00023 EQU   SWC                                                      00285000
PEXP     EQU   SWC                                                      00286000
NRCV     EQU   SWC                                                      00287000
IOERR    EQU   SWC                                                      00288000
@NM00022 EQU   SWC                                                      00289000
@NM00021 EQU   SWB                                                      00290000
FRCV     EQU   SWB                                                      00291000
@NM00020 EQU   SWB                                                      00292000
CXPC     EQU   SWB                                                      00293000
CXPN     EQU   SWB                                                      00294000
CXP      EQU   SWB                                                      00295000
@NM00019 EQU   SWA                                                      00296000
EOFR     EQU   SWA                                                      00297000
@NM00018 EQU   SWA                                                      00298000
JHS      EQU   SWA                                                      00299000
JTOP     EQU   SWA                                                      00300000
OSW2     EQU   CVRWA+424                                                00301000
IWAFINDP EQU   CVRWA+421                                                00302000
@NM00017 EQU   IWAEXTS                                                  00303000
IWASFIND EQU   IWAEXTS                                                  00304000
@NM00016 EQU   IWAEXTS                                                  00305000
AOFDPCL  EQU   CVRWA+419                                                00306000
AOBTCHSW EQU   AOSW3                                                    00307000
@NM00015 EQU   AOSW3                                                    00308000
@NM00014 EQU   AOSW2                                                    00309000
AOPROCNM EQU   AOSW2                                                    00310000
@NM00013 EQU   AOSW2                                                    00311000
IWAJMSGL EQU   CVRWA+416                                                00312000
CWACHIDL EQU   CVRWA+415                                                00313000
IWAWRNMS EQU   CVRWA+414                                                00314000
AOSTRLTH EQU   CVRWA+412                                                00315000
LASLE    EQU   CVRWA+410                                                00316000
CURLE    EQU   CVRWA+408                                                00317000
IWANLRC  EQU   CVRWA+406                                                00318000
AOKSRBY3 EQU   AOKSRPRM+2                                               00319000
AOKSRSCT EQU   AOKSRPRM+1                                               00320000
AOKSRNBR EQU   AOKSRPRM                                                 00321000
IWABPAM  EQU   CVRWA+400                                                00322000
AOSCHKYS EQU   CVRWA+392                                                00323000
AOFDPCSV EQU   CVRWA+384                                                00324000
CWASAVPT EQU   CVRWA+380                                                00325000
AOBSKSA  EQU   CVRWA+376                                                00326000
AODFLTSA EQU   CVRWA+348                                                00327000
AOHEBSA  EQU   CVRWA+344                                                00328000
AOKSR1SA EQU   CVRWA+336                                                00329000
AOGACSA  EQU   AOKSCHSA                                                 00330000
AOFDTMP1 EQU   CVRWA+300                                                00331000
AODSPCSA EQU   CVRWA+296                                                00332000
TENDP    EQU   CVRWA+292                                                00333000
TLENP    EQU   CVRWA+288                                                00334000
TNUMP    EQU   CVRWA+284                                                00335000
TKEYP    EQU   CVRWA+280                                                00336000
TBEGP    EQU   CVRWA+276                                                00337000
IWANELJC EQU   CVRWA+272                                                00338000
CWAJMRPT EQU   CVRWA+268                                                00339000
IWASTAPL EQU   CVRWA+264                                                00340000
IWAJOBS5 EQU   CVRWA+256                                                00341000
DREFB    EQU   CVRWA+80                                                 00342000
IWAPARM  EQU   CVRWA+76                                                 00343000
PPSN     EQU   CVRWA+68                                                 00344000
RSNM     EQU   CVRWA+60                                                 00345000
RDNM     EQU   CVRWA+52                                                 00346000
PSNM     EQU   CVRWA+44                                                 00347000
PDNM     EQU   CVRWA+36                                                 00348000
@NM00012 EQU   PSTMT+7                                                  00349000
LISTPTRP EQU   PSTMT+6                                                  00350000
NAMELP   EQU   PSTMT+5                                                  00351000
@NM00011 EQU   VERBP                                                    00352000
CREP     EQU   VERBP                                                    00353000
SSEP     EQU   VERBP                                                    00354000
STMTPTRP EQU   PSTMT                                                    00355000
@NM00010 EQU   RSTMT+7                                                  00356000
LISTPTR  EQU   RSTMT+6                                                  00357000
NAMEL    EQU   RSTMT+5                                                  00358000
@NM00009 EQU   VERB                                                     00359000
CRE      EQU   VERB                                                     00360000
SSE      EQU   VERB                                                     00361000
RSTMTPTR EQU   RSTMT                                                    00362000
CWATXTEX EQU   CVRWA+16                                                 00363000
IWAINTS5 EQU   CVRWA+12                                                 00364000
CWABPROC EQU   IWAINTS4                                                 00365000
IWAINTS3 EQU   CVRWA+4                                                  00366000
PDCBP    EQU   CVRWA                                                    00367000
RBYTE5   EQU   COMWA+371                                                00368000
RBYTE4   EQU   COMWA+370                                                00369000
RBYTE3   EQU   COMWA+369                                                00370000
RBYTE2   EQU   COMWA+368                                                00371000
RBYTE1   EQU   COMWA+367                                                00372000
@NM00008 EQU   SWY2                                                     00373000
KEYNXTSW EQU   SWY2                                                     00374000
DYNAMSW  EQU   SWY2                                                     00375000
@NM00007 EQU   SWY2                                                     00376000
@NM00006 EQU   SWI                                                      00377000
DSNLIT   EQU   SWI                                                      00378000
BLKMLTER EQU   SWI                                                      00379000
@NM00005 EQU   SWI                                                      00380000
IWADDNM  EQU   SWI                                                      00381000
WAWRNWTO EQU   SWI                                                      00382000
BLKPRC   EQU   SWI                                                      00383000
@NM00004 EQU   SWH                                                      00384000
CPSTPFL  EQU   SWH                                                      00385000
PROCSW   EQU   SWH                                                      00386000
CPFLGXX  EQU   SWH                                                      00387000
CPSYSFLG EQU   SWH                                                      00388000
@NM00003 EQU   SWH                                                      00389000
SEQUENCE EQU   SWE                                                      00390000
POVRX    EQU   SWE                                                      00391000
POVRD    EQU   SWE                                                      00392000
CONCAT   EQU   SWE                                                      00393000
PRCV     EQU   SWE                                                      00394000
PREF     EQU   SWE                                                      00395000
GPI      EQU   SWE                                                      00396000
PROCPLS  EQU   SWE                                                      00397000
CWATERM  EQU   AOSW4                                                    00398000
@NM00002 EQU   AOSW4                                                    00399000
AOTXTWRT EQU   AOSW1                                                    00400000
AOPRTSW  EQU   AOSW1                                                    00401000
AONOPLIB EQU   AOSW1                                                    00402000
AOILGLOP EQU   AOSW1                                                    00403000
AOIOERR  EQU   AOSW1                                                    00404000
AOVFBSW  EQU   AOSW1                                                    00405000
AOENDKSW EQU   AOSW1                                                    00406000
AOFSTPOS EQU   AOSW1                                                    00407000
IWAMSLEN EQU   CWAMSLEN                                                 00408000
RHALF5   EQU   COMWA+358                                                00409000
RHALF4   EQU   COMWA+356                                                00410000
RHALF3   EQU   COMWA+354                                                00411000
RHALF2   EQU   COMWA+352                                                00412000
RHALF1   EQU   COMWA+350                                                00413000
WASTMTNO EQU   COMWA+348                                                00414000
CWALABEL EQU   CWAMCSCA+1                                               00415000
IWAMCSCA EQU   CWAMCSCA                                                 00416000
IWARET   EQU   CWARET                                                   00417000
RFULL5   EQU   COMWA+340                                                00418000
RFULL4   EQU   COMWA+336                                                00419000
RFULL3   EQU   COMWA+332                                                00420000
RFULL2   EQU   COMWA+328                                                00421000
RFULL1   EQU   COMWA+324                                                00422000
WAEXCPFX EQU   COMWA+316                                                00423000
WAJOBPFX EQU   COMWA+308                                                00424000
WAJBNAME EQU   COMWA+300                                                00425000
WAEXCRBA EQU   COMWA+292                                                00426000
WAJOBRBA EQU   COMWA+284                                                00427000
QPARM    EQU   COMWA+248                                                00428000
WAWRKLTH EQU   COMWA+244                                                00429000
WAMSGBUF EQU   COMWA+240                                                00430000
WANELPTR EQU   COMWA+236                                                00431000
RPLADDR  EQU   WARPL                                                    00432000
@NM00001 EQU   IWAIOSA+8                                                00433000
IWASACHN EQU   IWAIOSA+4                                                00434000
TRSAVE   EQU   IWAIOSA                                                  00435000
AOEPWORK EQU   COMWA+80                                                 00436000
AOSTAPRM EQU   COMWA+76                                                 00437000
AOJMRGEP EQU   COMWA+72                                                 00438000
NEXTPTR  EQU   COMWA+68                                                 00439000
BUFEND   EQU   COMWA+64                                                 00440000
BUFADDR  EQU   COMWA+60                                                 00441000
AOWSTMT  EQU   COMWA+56                                                 00442000
TERMRTN  EQU   COMWA+52                                                 00443000
TBUFCOPY EQU   COMWA+48                                                 00444000
TEXTBUFP EQU   COMWA+44                                                 00445000
JACTLPTR EQU   COMWA+40                                                 00446000
TNEXT2   EQU   COMWA+36                                                 00447000
TNEXT    EQU   COMWA+32                                                 00448000
IWAINTS0 EQU   COMWA+28                                                 00449000
QMGRP    EQU   COMWA+24                                                 00450000
CTRLWAP  EQU   COMWA+20                                                 00451000
SAVEPTR  EQU   COMWA+16                                                 00452000
IWACONID EQU   CWACONID                                                 00453000
IWAID    EQU   CWAID                                                    00454000
IWAL     EQU   CWAL                                                     00455000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00456000
@ENDDATA EQU   *                                                        00457000
         END   IEFVINC                                                  00458000
./  ADD  SSI=30900648,NAME=IEFVIND
*                                                                     * 00600019
*  TITLE: IEFVIND-EXPAND INTERFACE                                    * 00900019
*                                                                     * 01200019
*  FUNCTION: THE MODULE IS USED AS A PSEUDO ACCESS METHOD. THE ADDRESS* 01500019
*            OF THE ENTRY POINT HAS BEEN PUT INTO THE DCBREAD FIELD OF* 01800019
*            THE BPAM DCB. WHENEVER A READ IS ISSUED IN IEFVHA AND THE* 02100019
*            ADDRESS IS IN THE DCB THIS MODULE IS ENTERED. IT SETS UP * 02400019
*            PARAMETER LISTS AND BRANCHES TO IEZDCODE TO EXPAND THE   * 02700019
*            RECORD. IF ANOTHER QUEUE RECORD IS NEEDED, IT BRANCHES TO* 03000019
*            IEFVHQ TO READ THE NEXT RECORD.                          * 03300019
*                                                                     * 03600019
* ENTRY POINT: IEFVIND                                                * 03900019
*                                                                     * 04200019
* INPUT: RD POINTS TO THE SAVE AREA                                   * 04500019
*        RE RETURN ADDRESS                                            * 04800019
*        RC POINTS TO THE IWA                                         * 05100019
*                                                                     * 05400019
* EXITS: RETURNS ONLY TO THE CALLER.                                  * 05700019
*                                                                     * 06000019
* OUTPUT: ALL REGISTERS ARE RESTORED                                  * 06300019
*                                                                     * 06600019
* INTERNAL EXITS: IEFVHQ-READ ANOTHER RECORD FROM THE QUEUE           * 06900019
*                 IEZDCODE-EXPAND A RECORD                            * 07200019
*                                                                     * 07500019
* WORKAREAS AND TABLES-                                               * 07800019
*     .IEFVMIWA-IWA                                                   * 08100019
*     .IEFQMNGR-QMPA                                                  * 08400019
*     .WORKAREA-WORK AREA AND DIRECTORY                               * 08700019
*     .IEZPARM-PARAMETER LIST                                         * 09000019
*     .DCBD - BPAM DCB                                       M3739O106* 09300019
*                                                                     * 09600019
* REGISTER USEAGE: R4-PARAMETER LIST TO IEZDCODE                      * 09900019
*                  R6-QMPA                                            * 10200019
*                  R7-WORK AREA                                       * 10500019
*                  RB-ADDRESSIBILITY OF MODULE                        * 10800019
*                  RC-IWA                                             * 11100019
*                                                                     * 11400019
* MACROES USED: IEFSAVER                                              * 11700019
*               IEFRELSE                                              * 12000019
*               SAVE                                                  * 12300019
*               RETURN                                                * 12600019
*                                                                     * 12900019
* OPERATION:.REGISTERS ARE SAVED                                      * 13200019
*           .A SAVE AREA IS GOTTEN                                    * 13500019
*           .ADDRESSIBILITY IS ESTABLISHED FOR THE WORK AREA AND THE  * 13800019
*           .QMPA                                                     * 14100019
*           .THE ADDRESS OF THE PARAMETER LIST IS GOTTEN FROM IWAPARM,* 14400019
*            OFFSET X'100' IN THE IWA                                 * 14700019
*           .THE PARAMETER LIST IS COMPLETED IF NECESSARY             * 15000019
*           .IEZDCODE EXPANDS A RECORD                                * 15300019
*           .A RETURN CODE IS TESTED                                  * 15600019
*            A ZERO INDICATES THAT THE RECORD WAS EXPANDED.           * 15900019
*            THE SAVE AREA RELEASED AND CONTROL RETURNED TO IEFVHA    * 16200019
*           IF THE RETURN CODE IS FOUR, THE LAST COMPRESSED           * 16500019
*           RECORD HAS ALREADY BEEN EXPANDED. IEFVHQ READS A NEW RECORD 16800019
*           FROM THE QUEUE AND THE RECORD IS EXPANDED.                * 17100019
*                                                                     * 17400019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 17700019
         EJECT                                                          18000019
WORKAREA DSECT                                                          18300019
         USING WORKAREA,R7                                              18600019
WKTTR    DS    CL4                     POINTER TO NEXT RECORD           18900019
WKQMPAPT DS    CL4                     ADDRESS OF QMPA                  19200019
WKRECORD DS    CL168                   COMPRESSED RECORD                19500019
WKPTR1   DS    CL4                     POINTER TO ITSELF                19800019
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN        20100019
*                                      THIS SEGMENT OF THE DIRECTORY    20400019
WKPTR2   DS    CL3                     HOLDER OF TTR FROM QUEUE   O106  20700019
*                                      MANAGER                    O106  21000019
WKPROCN1 DS    CL8                     PROCEDURE NAME                   21300019
WKTTR1   DS    CL3                     TTR OF FIRST RECORD              21600019
WKPROCN2 DS    CL8                     PROCEDURE NAME                   21900019
WKTTR2   DS    CL3                     TTR OF FIRST RECORD              22200019
WKPROCN3 DS    CL8                     PROCEDURE NAME                   22500019
WKTTR3   DS    CL3                     TTR OF FIRST RECORD              22800019
WKPROCN4 DS    CL8                     PROCEDURE NAME                   23100019
WKTTR4   DS    CL3                     TTR OF FIRST RECORD              23400019
WKPROCN5 DS    CL8                     PROCEDURE NAME                   23700019
WKTTR5   DS    CL3                     TTR OF FIRST RECORD              24000019
WKPROCN6 DS    CL8                     PROCEDURE NAME                   24300019
WKTTR6   DS    CL3                     TTR OF FIRST RECORD              24600019
WKPROCN7 DS    CL8                     PROCEDURE NAME                   24900019
WKTTR7   DS    CL3                     TTR OF FIRST RECORD              25200019
WKPROCN8 DS    CL8                     PROCEDURE NAME                   25500019
WKTTR8   DS    CL3                     TTR OF FIRST RECORD              25800019
WKPROCN9 DS    CL8                     PROCEDURE NAME                   26100019
WKTTR9   DS    CL3                     TTR OF FIRST RECORD              26400019
WKPROCNA DS    CL8                     PROCEDURE NAME                   26700019
WKTTRA   DS    CL3                     TTR OF FIRST RECORD              27000019
WKPROCNB DS    CL8                     PROCEDURE NAME                   27300019
WKTTRB   DS    CL3                     TTR OF FIRST RECORD              27600019
WKPROCNC DS    CL8                     PROCEDURE NAME                   27900019
WKTTRC   DS    CL3                     TTR OF FIRST RECORD              28200019
WKPROCND DS    CL8                     PROCEDURE NAME                   28500019
WKTTRD   DS    CL3                     TTR OF FIRST RECORD              28800019
WKPROCNE DS    CL8                     PROCEDURE NAME                   29100019
WKTTRE   DS    CL3                     TTR OF FIRST RECORD              29400019
WKPROCNF DS    CL8                     PROCEDURE NAME                   29700019
WKTTRF   DS    CL3                     TTR OF FIRST RECORD              30000019
WKSAVE1  DS    CL1                                               A33705 30100020
         EJECT                                                          30300019
         IEFCOMWA                                                       30600002
         IEFCVRWA                                                       30700002
         EJECT                                                          30900019
         IEFQMNGR                                                       31200019
         EJECT                                                          31400019
QMPADDR  DS    CL4                     ADDRESS OF WORK BUFFER           31500019
QMPATTR  DS    CL3                     TTR OF JOB QUEUE RECORD          31800019
QMPAZER  DS    CL1                     RESERVED FIELD                   32100019
         EJECT                                                          32400019
IEZPARM  DSECT                         PARAMETER AREA                   32700019
PARMADDR DS    CL4                     ADDRESS OF PARAMETER LIST        33000019
PROCNAME DS    CL8                     PROCEDURE NAME                   33300019
DIRECT   DS    CL4                     ADDRESS OF DIRECTORY             33600019
IWAPT    DS    CL4                     ADDRESS OF IWA                   33900019
RTCD     DS    CL4                     RETURN CODE FOR IEFVINB          34200019
         ORG   PARMADDR                                                 34500019
IEZADDR  DS    CL4                     ADDRESS OF WORK AREA        O106 34800019
IEZUNCOM DS    A                       PTR TO UNCOMPRESSED RECORD       35100019
IEZCOMPR DS    A                       PTR TO NEXT COMPRESSED RECORD    35400019
IEZLEN   DS    H                       LENGTH OF UNCOMPRESSED RECORD    35700019
IEZOUT   DS    H                       LENGTH OF AREA FOR OUTPUT RECORD 36000019
IEZCHAR  DS    C                       CHARACTER CODE OF BLANK          36300019
IEZTYPE  DS    B                       FLAG ASSOCIATED WITH RECORD      36600019
IEZRES   DS    H                       WORK AREA                        36900019
*                                      THE IWA                          37200019
         EJECT                                                          37500019
         DCBD  DSORG=(PS)                                               37800019
         EJECT                                                          38100019
IEFVIND  CSECT                                                          38400019
         SAVE (14,12)                                                   38700019
         BALR  RB,0                                                     39000019
         USING *,RB                                                     39300019
**************************************************************** Y02668 39330002
* MODULE TRACE CODE - FOR TESTING                                Y02668 39360002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 39390002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 39420002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 39450002
         DC    C'VIND'             MOD ID USED BY TRACE          Y02668 39480002
* TRACE RETURNS HERE.                                            Y02668 39510002
**************************************************************** Y02668 39540002
         B     VIND000                                                  39600019
         SPACE                                                          39900019
         MODID BR=NO                                            Y01886  39950001
         DC    C'SPLT'             FUNCTION ID AND               Y02668 40250002
         DC    C'02'               LEVEL # (NEL DELETION FIX).   Y02668 40550002
         DC    C'MVM'              FUNCTION ID AND               Y02668 40650002
         DC    C'04'         LEVEL # (WA MACRO UPDATES).         Y02668 40750002
         SPACE                                                          41100019
VIND000  DS    0H                                                       41400019
         IEFSAVER                                                       41700019
         L     R7,IWAWKBF              ADDRESS OF WORK AREA        3391 41730019
         L     R6,WKQMPAPT             ADDRESS OF IN-STREAM QMPA   3391 42240019
         SPACE                                                          42600019
         USING IOPARAMS,R6                                              42660019
         L     R2,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 42720019
         SPACE                                                          42900019
*********************************************************************** 43200019
*                                                                     * 43500019
*  IF THIS IS THE FIRST STATEMENT OF THE PROCEDURE, CORE IS GOTTEN FOR* 43800019
*  THE PARAMETER LIST, THE ADDRESS IS SAVED IN THE IEA, AND THE   4399* 44100019
*  PARAMETER LIST IS INITIALIZED.  THE EXTERNAL PARAMETER LIST    4399* 44400019
*  FOR IEFVHQ AND IEFQMRAW ARE INITIALIZED TO POINT TO THE FIRST  4399* 44700019
*  RECORD OF THE PROCEDURE AND THAT 953694 Z2-92 4                4399* 45000019
*                                                                 4399* 45300019
*********************************************************************** 45600019
*                                                                     * 45900019
*********************************************************************** 46200019
         SPACE                                                          46500019
         L     R4,IWAPARM              ADDRESS OF PARAMETER LIST        46800019
         USING IEZPARM,R4                                               47100019
         LA    R4,DISPLZER(R4)         CLEAR HIGH ORDER BYTE       4399 47200019
         NI    SWI,UNBLKPC             TURN OFF SWITCHES FRO BLOCKED    47400019
*                                      PROCLIB                          47700019
         SPACE                                                          48000019
         LTR   R4,R4                   IS THIS THE FIRST STMT OF THE    48070019
*                                      PROCEDURE                   4399 48140019
         BNZ   VIND025                 NO-EXPAND THE STATEMENT     4399 48210001
         LA    R0,VINDPARM             LENGTH OF PARM LIST         4399 48280019
         GETMAIN R,LV=(0)                                               48350019
         O     R1,IWAPARM              RETAIN HIGH ORDER BYTE INFOM4268 48420019
         ST    R1,IWAPARM              ADDR OF PARMLIST           M4268 48490019
         LR    R4,R1                   ADDRESS OF PARM LIST        4399 48560019
         USING IEZPARM,R4                                          4399 48630019
         LA    R3,DISPLFOR(R1)         ADDRESS OF PARM INFORMATION 4399 48700019
         ST    R3,IEZADDR              ADDRESS OF PARM INFORMATION 4399 48770019
         MVC   IEZUNCOM(MVFOUR),PSTMT     ADDRESS OF OUTPUT BUFFER 4399 48840019
         MVI   IEZCHAR,CHAR            CHARACTER TO BE ADDED       4399 48910019
         MVI    IEZTYPE,TYPE           NOT A SPECIAL RECORD        4399 48980019
         LA  R3,INLN                   LENGTH OF OUTPUT BUFFER     4399 49050019
         STH   R3,IEZLEN               LENGTH OF OUTPUT BUFFER     4399 49120019
         MVC   MVFOUR(MVTHREE,R2),WKPTR2 TTR OF FIRST RECORD OF PROC    49190019
         LA    R5,VIND025              ADDR ROUTINE TO EXPAND RECORD    49260001
         SPACE                                                          49500019
VIND010  DS    0H                                                       49800019
*********************************************************************** 50100019
*                                                                     * 50400019
*  READ THE RECORD FROM THE JOB QUEUE AND THEN REINITIALIZE THE       * 50700019
* PARAMETER LIST FOR IEZDCODE                                         * 51000019
*                                                                     * 51300019
*********************************************************************** 51600019
         ST    R6,QPARMP               REPLACE R/I QMPA PTR             51900019
         MVC   DISPLZER(MVFOUR,R2),IWAWKBF ADDRESS OF WORK BUFFER  3391 52200019
        MVI   QMPOP,QMREAD            READ                              52500019
         L     RF,VIEFVHQ              ADDRESS OF Q MANAGER INTERFACE   52800019
         BALR  RE,RF                   Q MANAGER INTERFACE              53100019
         LA    R1,QPARM                ADDRESS OF QMPA (R/I)            53400019
         ST    R1,QPARMP               REPLACE IN-LINE PROC QMPA PTR    53700019
         LA    R3,OUTLEN               LENGTH OF INPUT BUFFER      4361 54000019
         STH   R3,IEZOUT           LENGTH OF INPUT BUFFER         M3667 54300019
         LA    R3,WKRECORD             ADDRESS OF WORK BUFFER           54600019
         ST    R3,IEZCOMPR             ADDRESS OF WORK BUFFER           54900019
         BR    R5                      RETURN TO CALLER            4399 55000019
         SPACE                                                          55200019
*********************************************************************** 55800019
*                                                                     * 56100019
* EXPAND A RECORD                                                     * 56400019
*                                                                     * 56700019
*********************************************************************** 57000019
VIND025  DS    0H                                                  4399 57400019
         L     R1,IEZCOMPR             LOAD THE ABSOLUTE ADDR OF A33705 57410020
*                                      NEXT STMT TO BE EXPANDED  A33705 57420020
         SR    R1,R7                   CALC RELATIVE DISPLMNT    A33705 57430020
*                                      INTO THE WORK BUFFER OF   A33705 57440020
*                                      NEXT STMT TO BE EXPANDED  A33705 57450020
         STC   R1,WKSAVE1              STORE THIS RELATIVE       A33705 57460020
*                                      DISPLACEMENT INTO THE     A33705 57470020
*                                      DIRECTORY. DURING RDR     A33705 57480020
*                                      SUSPENSION IN PCP THIS    A33705 57490020
*                                      DISPLACEMENT IS USED TO   A33705 57500020
*                                      RESTORE THE RDR TO THE POIA33705 57510020
*                                      AT WHICH IT WAS,WHEN IT   A33705 57520020
*                                      WAS SUSPENDED.            A33705 57530020
         SPACE                                                          57600019
         L     R1,IWAPARM              ADDRESS OF PARAMETER LIST        57900019
         L     R8,VIEDCODE             IEZDCODE VCON             Y01029 57950001
         BALR  RE,R8                   BRANCH TO IEZDCODE        Y01029 58500001
         LTR   RF,RF                   WAS RECORD THERE                 58800019
         BNZ   VIND040             A NON-ZERO RETURN CODE         M3738 58840019
*                                  INDICATES THERE ARE NO MORE    M3738 58880019
*                                  RECORDS (CODE 4) OR A PARAM    M3738 58920019
*                                  LIST ERROR (CODE 8). NON-ZERO  M3738 58960019
*                                  IS ASSUMED TO BE CODE 4, SINCE M3738 59000019
*                                  THE ONLY CONDITION UNDER WHICH M3738 59040019
*                                  CODE 8 WILL BE RETURNED IS IN  M3738 59080019
*                                  THE EVENT OF SOME WILD STORE   M3738 59120019
*                                  INTO THE PARAMETER LIST. A     M3738 59160019
*                                  RETURN CODE OF 8 WILL RESULT   M3738 59200019
*                                  IN TRUNCATION OR NON-EXPANSION M3738 59240019
*                                  OF THE INSTREAM PROCEDURE.     M3738 59280019
         SPACE                                                          59400019
VIND030  DS    0H                                                       59700019
*********************************************************************** 60000019
*                                                                     * 60300019
*  THE RECORD WAS EXPANDED.                                           * 60600001
*   RETURN TO PROCESS THE EXPANDED RECORD AS IF IT HAD COME FROM      * 60900019
*   PROCLIB                                                           * 61200019
*                                                                     * 61500019
*********************************************************************** 61800019
         SPACE                                                          62700019
         IEFRELSE                                                       63000019
         SPACE                                                          63300019
         RETURN (14,12)                                                 63600019
         SPACE                                                          63900019
VIND040  DS    0H                                                       64200019
*********************************************************************** 64500019
*                                                                     * 64800019
* CHECK TO SEE IF THIS IS THE END OF THE RECORD.  THE FIRST WORD      * 65100019
* WILL CONTAIN A TTR OF THE NEXT RECORD IF ONE EXISTS                 * 65400019
*                                                                     * 65700019
*********************************************************************** 66000019
         L     R3,WKTTR                TTR OF NEXT RECORD          3391 66300019
         LTR   R3,R3                   END OF PROCEDURE            3391 66600019
         BE    VIND050                 END OF PROCEDURE                 66900019
         SPACE                                                          67200019
*********************************************************************** 67500019
*                                                                     * 67800019
* BUILD THE QMPA AND READ A RECORD                                    * 68100019
*                                                                     * 68400019
*********************************************************************** 68700019
         MVC   WKPTR2(MVTHREE),WKTTR   UPDATE PTR TO REFLECT TTR A33705 68750020
*                                      OF PORTION OF PROCEDURE   A33705 68800020
*                                      BEING EXPANDED            A33705 68850020
         MVC   MVFOUR(MVTHREE,R2),WKTTR  READ A RECORD             3391 68900019
         LA    R5,VIND025              COMPRESS THE RECORD         4399 69100019
         B     VIND010                                                  69300019
         SPACE                                                          69600019
VIND050  DS    0H                                                       69900019
*********************************************************************** 69930019
*                                                                 4399* 69960019
*  END OF FILE HAS BEEN REACHED.  THE ADDRESS OF BPAM IS PUT BACK INTO  69990019
*  THE BPAM DCB, THE ADDRESS OF THE EODAD PLACED IN REGISTER 14, THE  * 70020019
*  PARM LIST FOR IEZDCODE IS FREED AND THE POINTER TO IT IS CLEARED   * 70050019
*  CONTROL IS RETURNED TO IEFVHAS END OF PROCEDURE ROUTINE VIA REG 14   70080019
*                                                                 4399* 70110019
*********************************************************************** 70140019
         L     RA,PDCBP                ADDRESS OF PROC DDB              70200019
         MVC   DCBREAD+DISPLONE-IHADCB(MVTHREE,RA),IWABPAM    M3739O106 70500019
         L     R4,MVFOUR(RD)           ADDR OF SAVE AREA SET       O106 70800019
*                                      REGISTER 14 TO THE EODAD   O106  71100019
*                                      ROUTINE BECAUSE THIS IS THEO106  71400019
*                                      END OF THE IN-LINE PROCEDURE106  71700019
         MVC   DISPL13(MVTHREE,R4),DCBEODAD+DISPLONE-IHADCB(RA)         72000019
         L     R1,IWAPARM              ADDRESS OF PARM LIST        4399 72050019
         LA    R0,VINDPARM             LENGTH OF PARM LIST         4399 72100019
         FREEMAIN R,A=(1),LV=(0)                                        72150019
         XC    IWAPARM+DISPLONE(MVTHREE),IWAPARM+DISPLONE  CLEAR   4399 72200019
*                                      ADDRESS OF PARM LIST        4399 72250019
         B     VIND030                 END OF IN-LINE PROCEDURE         72300019
         SPACE                                                          72600019
*********************************************************************** 72900019
*                                                                     * 73200019
*   CONSTANTS AND EQUATES                                             * 73500019
*                                                                     * 73800019
*********************************************************************** 74100019
VIEFVHQ  DC    V(IEFVHQ)               ADDRESS OF Q MANAGER INTERFACE   74400019
VIEDCODE DC    V(IEZDCODE)             DECOMPRESS RECORD ROUTINE Y01029 74450001
DISPLZER EQU   0                       CLEAR THE HIGH ORDER BIT    4399 74500019
VINDPARM EQU   24                      LENGTH OF PARM LIST         4399 74600019
INSTPROC EQU   X'80'                   INSTREAM PROC BEING PROCESSE4399 74700019
DISPLFOR EQU   4                       DISPLACEMENT                4399 74800019
CHAR     EQU   X'40'                   CHARACTER BEING ADDED       4399 74900019
TYPE     EQU   X'00'                   NOT A SPECIAL RECORD        4399 75000019
INLN     EQU   X'50'                   LENGTH OF OUTPUT BUFFER     4399 75100019
DISPLONE EQU   1                        DISPLACEMENT               4399 75200019
OUTLEN   EQU   168                     LENGTH OF OUTPUT BUFFER     4399 75300019
MVTHREE  EQU   3                       LENGTH OF MOVE                   75900019
UNBLKPC  EQU   X'77'                   TURN OFF THE BLO KED PROCLIB     76500019
*                                       SWITCHS IN SWI IN THE IWA       76800019
MVFOUR   EQU   4                       LENGTH OF MOVE                   77400019
DISPL12  EQU   12                      DISPLACEMENT               O106  77700019
DISPL13  EQU   13                      DISPLACEMENT                     78000019
PATCH    DC    25F'0'              PATCH SPACE                   Y02668 78100002
   END                                                                  78300019
./  ADD  SSI=30872089,NAME=IEFVINE
         TITLE ' /***************************************************'  00001000
IEFVINE  CSECT ,                                                   0001 00002000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00003000
         BALR  @11,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@11                                         0001 00006000
         L     @00,@SIZDATD                                        0001 00007000
         GETMAIN R,LV=(0)                                               00008000
         LR    @09,@01                                             0001 00009000
         USING @DATD,@09                                           0001 00010000
         LM    @00,@01,20(@13)                                     0001 00011000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00012000
         MVC   @PC00001(4),0(@01)                                  0001 00013000
**************************************************************** Y02668 00014000
*  MODULE TRACE CODE - FOR TESTING.                              Y02668 00015000
         L     15,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 00016000
         CNOP  2,4                                               Y02668 00017000
         BALR  14,15               ENTER MOD ID IN TRACE RECORD  Y02668 00018000
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 00019000
         DC    C'VINE'             MOD ID USED BY TRACE.         Y02668 00020000
*  TRACE RETURNS HERE                                            Y02668 00021000
**************************************************************** Y02668 00022000
         B     STRT                                                     00023000
         DC    X'11111111'                                              00024000
         DC    CL4'VINE'                                                00025000
         DC    CL4'L.01'                                                00026000
         DC    C'MVM'              FUNCTION ID AND               Y02668 00027000
         DC    C'01'               LEVEL # (TRACE AND PATCH)     Y02668 00028000
*                                                                  0017 00029000
*                                                                  0017 00030000
*STRT:;                                                            0018 00031000
STRT     DS    0H                                                  0019 00032000
*FIVE=ONE;                                                         0019 00033000
         LR    FIVE,ONE                                            0019 00034000
*TWO=0;                                /* CLEAR REG2 FOR TRT         */ 00035000
         SR    @12,@12                                             0020 00036000
         LR    TWO,@12                                             0020 00037000
*BEGIN=FIVE+2;                                                     0021 00038000
*                                                                  0021 00039000
         LA    BEGIN,2                                             0021 00040000
         AR    BEGIN,FIVE                                          0021 00041000
*/*                         LABEL SCAN                               */ 00042000
*                                                                  0022 00043000
*  IF BEGIN->ONEBYTE=' ' THEN          /*IF CARD NOT A CONTINUATION  */ 00044000
         CLI   ONEBYTE(BEGIN),C' '                                 0022 00045000
         BNE   @RF00022                                            0022 00046000
*    DO;                               /*CHECK IF COL. 3 CONTAINS A  */ 00047000
*      INCRE=FIVE+3;                   /*BLANK(LABEL CHECK) IF YES,  */ 00048000
         LA    INCRE,3                                             0024 00049000
         AR    INCRE,FIVE                                          0024 00050000
*      LENGTH=0;                       /*UPDATE POINTER TO COL. 4,SET*/ 00051000
         LR    LENGTH,@12                                          0025 00052000
*      GOTO NONBLNK;                   /*LENGTH TO ZERO, AND BRANCH  */ 00053000
         B     NONBLNK                                             0026 00054000
*    END;                              /*TO VERB CHECK RTN,BYPASSING */ 00055000
*                                      /*LABEL SYNTAX CHECKING       */ 00056000
*                                      /* IF LABEL FOUND, CHECK      */ 00057000
*                                      /* IF FIRST CHAR IS           */ 00058000
*                                      /* ALPHABETIC OR NATIONAL     */ 00059000
*GENERATE;                                                         0028 00060000
@RF00022 DS    0H                                                  0028 00061000
         TRT   0(1,BEGIN),TRTTAB                                        00062000
         BNZ   LABERR                  IF NO, ERROR                     00063000
*  IF BEGIN->ONEBYTE>='F0'X THEN GOTO LABERR;  /*IF 1ST NUMERIC,ERROR*/ 00064000
         CLI   ONEBYTE(BEGIN),X'F0'                                0029 00065000
         BNL   @RT00029                                            0029 00066000
*                                      /* IS REMAINING PART OF LABEL */ 00067000
*                                      /* ALPHA-NUMERIC.             */ 00068000
*GENERATE;                                                         0031 00069000
         TRT   1(8,BEGIN),TRTTAB                                        00070000
         BZ    LABERR                  IF LABEL TOO LONG, ERROR         00071000
*  IF TWO Â¬=4 THEN GOTO LABERR;        /* IF NOT, LABEL INVALID      */ 00072000
         CH    TWO,@CH00038                                        0032 00073000
         BNE   @RT00032                                            0032 00074000
*INCRE=ONE;                            /* IF LABEL VALID, UPDATE PTR */ 00075000
         LR    INCRE,ONE                                           0034 00076000
*LENGTH=ONE-BEGIN;                     /*PASSED THE LABEL  AND       */ 00077000
         LR    LENGTH,ONE                                          0035 00078000
         SR    LENGTH,BEGIN                                        0035 00079000
*                                      /* CALCULATE THE LABEL LENGTH */ 00080000
*NONBLNK:IF INCRE->ONEBYTEÂ¬=' ' THEN GOTO CHECK;   /* CHECK FOR      */ 00081000
NONBLNK  CLI   ONEBYTE(INCRE),C' '                                 0036 00082000
         BNE   @RT00036                                            0036 00083000
*INCRE=INCRE+1;                        /* BEGINNING OF VERB          */ 00084000
         AH    INCRE,@CH00050                                      0038 00085000
*GOTO NONBLNK;                                                     0039 00086000
         B     NONBLNK                                             0039 00087000
*CHECK:;                                                      /*M3122*/ 00088000
CHECK    DS    0H                                                  0041 00089000
*      IF INCRE->VERB=PRC THEN         /* IF 'PROC' VERB FOUND  M3122*/ 00090000
         CLC   VERB(5,INCRE),PRC                                   0041 00091000
         BNE   @RF00041                                            0041 00092000
*        DO;                                                  /*M3122*/ 00093000
*          RE:RETCODE=LENGTH;          /* SET RETURN CODE EQUAL M3122*/ 00094000
RE       ST    LENGTH,RETCODE(,R13)                                0043 00095000
*             RETURN;                  /* TO THE LABEL LENGTH   M3122*/ 00096000
@EL00001 DS    0H                                                  0044 00097000
@EF00001 L     @00,@SIZDATD                                        0044 00098000
         LR    @01,@09                                             0044 00099000
         FREEMAIN R,LV=(0),A=(1)                                        00100000
@ER00001 LM    @14,@12,12(@13)                                     0044 00101000
         BR    @14                                                 0044 00102000
*        END;                          /* AND RETURN CONTROL TO M3122*/ 00103000
*                                      /* IEFVINA.              M3122*/ 00104000
*      IF INCRE->VERB=PND THEN GOTO RE;/* IF 'PEND' VERB FOUND  M3122*/ 00105000
@RF00041 CLC   VERB(5,INCRE),PND                                   0046 00106000
         BE    @RT00046                                            0046 00107000
*                                      /* PROCESS LIKE PROC STMTM3122*/ 00108000
*LABERR:;                              /* IF NEITHER VERB FOUND M3122*/ 00109000
LABERR   DS    0H                                                  0049 00110000
*       RETCODE=12;                    /* OR INVALID LABEL      M3122*/ 00111000
         MVC   RETCODE(4,R13),@CF00083                             0049 00112000
*                                      /* PREVIOUSLY DETECTED   M3122*/ 00113000
*                                      /* SET RETURN CODE TO 12 M3122*/ 00114000
*       RETURN;                        /*AND RETURN TO IEFVINA  M3122*/ 00115000
         B     @EL00001                                            0050 00116000
*END IEFVINE;                                                      0051 00117000
         B     @EL00001                                            0051 00118000
@DATA    DS    0H                                                       00119000
@CH00050 DC    H'1'                                                     00120000
@CH00038 DC    H'4'                                                     00121000
@DATD    DSECT                                                          00122000
         DS    0F                                                       00123000
@PC00001 DS    1F                                                       00124000
@ZTEMPS  DS    C                                                        00125000
@ZTEMPND EQU   *                                                        00126000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00127000
@TEMPS   EQU   @ZTEMPS                                                  00128000
@L       EQU   @ZLEN                                                    00129000
IEFVINE  CSECT                                                          00130000
         DS    0F                                                       00131000
@CF00083 DC    F'12'                                                    00132000
@DATD    DSECT                                                          00133000
         DS    0D                                                       00134000
@ENDDATD EQU   *                                                        00135000
@DATEND  EQU   *                                                        00136000
IEFVINE  CSECT                                                          00137000
         DS    0F                                                       00138000
@SIZDATD DC    AL1(0)                                                   00139000
         DC    AL3(@ENDDATD-@DATD)                                      00140000
@SIZ001  EQU   @SIZDATD                                                 00141000
         DS    0D                                                       00142000
PRC      DC    CL5'PROC '                                               00143000
PND      DC    CL5'PEND '                                               00144000
PATCH    DC    XL100'0'                                                 00145000
TRTTAB   DC    64AL1(8)                                                 00146000
         DC    AL1(4)                                                   00147000
         DC    26AL1(8)                                                 00148000
         DC    AL1(0)                                                   00149000
         DC    31AL1(8)                                                 00150000
         DC    2AL1(0)                                                  00151000
         DC    68AL1(8)                                                 00152000
         DC    9AL1(0)                                                  00153000
         DC    7AL1(8)                                                  00154000
         DC    9AL1(0)                                                  00155000
         DC    8AL1(8)                                                  00156000
         DC    8AL1(0)                                                  00157000
         DC    6AL1(8)                                                  00158000
         DC    10AL1(0)                                                 00159000
         DC    6AL1(8)                                                  00160000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00161000
@01      EQU   01                                                       00162000
@02      EQU   02                                                       00163000
@03      EQU   03                                                       00164000
@04      EQU   04                                                       00165000
@05      EQU   05                                                       00166000
@06      EQU   06                                                       00167000
@07      EQU   07                                                       00168000
@08      EQU   08                                                       00169000
@09      EQU   09                                                       00170000
@10      EQU   10                                                       00171000
@11      EQU   11                                                       00172000
@12      EQU   12                                                       00173000
@13      EQU   13                                                       00174000
@14      EQU   14                                                       00175000
@15      EQU   15                                                       00176000
@0       EQU   00                                                       00177000
@1       EQU   01                                                       00178000
@2       EQU   02                                                       00179000
@3       EQU   03                                                       00180000
@4       EQU   04                                                       00181000
@5       EQU   05                                                       00182000
@6       EQU   06                                                       00183000
@7       EQU   07                                                       00184000
@8       EQU   08                                                       00185000
@9       EQU   09                                                       00186000
@A       EQU   10                                                       00187000
@B       EQU   11                                                       00188000
@C       EQU   12                                                       00189000
@D       EQU   13                                                       00190000
@E       EQU   14                                                       00191000
@F       EQU   15                                                       00192000
ONE      EQU   @01                                                      00193000
TWO      EQU   @02                                                      00194000
FIVE     EQU   @05                                                      00195000
R13      EQU   @13                                                      00196000
BEGIN    EQU   @04                                                      00197000
INCRE    EQU   @03                                                      00198000
LENGTH   EQU   @06                                                      00199000
VERB     EQU   0                                                        00200000
RETCODE  EQU   16                                                       00201000
ONEBYTE  EQU   0                                                        00202000
DUMMY    EQU   0                                                        00203000
@RT00029 EQU   LABERR                                                   00204000
@RT00032 EQU   LABERR                                                   00205000
@RT00036 EQU   CHECK                                                    00206000
@RT00046 EQU   RE                                                       00207000
@EL01    EQU   @EL00001                                                 00208000
@ENDDATA EQU   *                                                        00209000
         END   IEFVINE                                                  00210000
./  ADD  SSI=81450282,NAME=IEFVJA
*********************************************************************** 00020000
*                                                                     * 00040002
*  MODULE NAME= IEFVJA                                                * 00090002
*                                                                     * 00100002
*  DESCRIPTIVE NAME= JOB STATEMENT PROCESSOR                          * 00140002
*                                                                     * 00150002
*  COPYRIGHT= N/A                                                     * 00190002
*                                                                     * 00200002
*  STATUS= OS/VS2 REL. 037 PTF                                @ZA26751* 00240003
*                                                                     * 00260002
*  FUNCTION= THIS IS THE MAIN PROCESSING MODULE FOR A JOB STATEMENT.  * 00290002
*            IT 1. CREATES AND INITIALIZES CONTROL BLOCKS AND         * 00340002
*                  TABLES.                                            * 00390002
*               2. CHECKS VALIDITY OF JOB CARD KEYWORDS, AND IN       * 00440002
*                  SOME CASES THEIR VALUES.                           * 00490002
*               3. SETS JOB-FAIL BIT FOR INVALID KEYWORDS.            * 00540002
*                                                                     * 00550002
*  OPERATION= IT INITIALIZES A JCT FOR A JOB BY SETTING MSGCLASS=A,   * 00590002
*             MSGLEVEL=0, INTERNAL JOB SERIAL NUMBER=1, JCT ID=0,     * 00640002
*             TYPRUN= SETUP AND SETS THE DEFAULT PRIORITY WHICH HAD   * 00690002
*             BEEN SPECIFIED IN THE READER PARMS. IEFVJA ALSO         * 00740002
*             SETS UP A JOB ACCOUNT CONTROL TABLE EVEN IF ACCOUNTING  * 00750002
*             INFORMATION HAS NOT BEEN SPECIFIED. IT INITIALIZES THE  * 00760002
*             NUMBER OF SIOTS SLOT (DDINO) IN THE IWA AND SETS THE    * 00770002
*             FIRST TIME.                                             * 00772002
*             THE PARAMETER DESCRIPTOR TABLE (PDT), USED TO CHECK THE * 00774002
*             FORMAT OF THE KEYWORD IS USED BY THE EXTERNAL ROUTINE   * 00776002
*             IEFVGT TO PROCESS THE KEYWORD VALUE; THE KEYWORD BRANCH * 00778002
*             TABLE (KBT) IS USED BY IEFVGK TO GET THE NEXT KEY.      * 00778402
*             THE INTERNAL TEXT IS THEN PROCESSED BY THE APPROPIATE   * 00778802
*             KEYWORD ROUTINE. IF THE ROUTINE FINDS THE KEYWORD IN-   * 00779202
*             VALID, THE PROCESSING ROUTINE GOES TO THE CLEAN-UP      * 00779602
*             ROUTINE WHICH SETS THE JOB-FAIL BIT IN THE JCT, AND     * 00779702
*             PLACES THE APPROPIATE ERROR MESSAGE IN MSGSEC.          * 00779802
*                                                                     * 00779902
*  NOTES                                                              * 00780002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                            * 00786602
*      DEPENDENCIES= NONE                                             * 00788602
*      RESTRICTIONS= NONE                                             * 00790602
*      REGISTER CONVENTIONS= IWASL (NAME OF AREA IN IWA WHERE         * 00792602
*                            REGISTER CONVENTIONS ARE ESTABLISHED)    * 00793002
*      PATCH LABEL= PATCH                                             * 00793102
*                                                                     * 00794802
*  MODULE TYPE= PROCEDURE                                             * 00798302
*      PROCESSOR= ASSEMBLER                                           * 00800002
*      MODULE SIZE= N/A                                               * 00801902
*      ATTIRBUTES= READ ONLY / REENTRANT / PAGED LPA                  * 00803902
*                                                                     * 00804302
*  ENTRY POINT= IEFVJA                                                * 00805902
*      PURPOSE= MAIN ENTRY POINT                                      * 00806302
*      LINKAGE= BR                                                    * 00806402
*      INPUT DATA= INTERNAL TEXT, IWA, NEL                            * 00806502
*      REGISTERS SAVED= NONE                                          * 00813202
*      REGISTER CONTENTS DURING PROCESSING=                           * 00815202
*              R5 = ERROR MESSAGE CODE REGISTER.                      * 00817202
*              R8 = JCT ADDRESSING.                                   * 00819202
*              R9 = ADDRESS OF TEST AND STORE.                        * 00819602
*              RA = LOCAL AND GET-T+S WORK AREA.                      * 00819702
*              RB = JOB ROUTINE BASE REGISTER.                        * 00819802
*              RC = INTERPRETER WORK AREA.                            * 00819902
*              RD = REGISTER SAVE AREA.                               * 00826502
*              RE = LINK RETURN REGISTER.                             * 00828502
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                   * 00830502
*      REGISTERS RESTORED= NONE                                       * 00832502
*                                                                     * 00832902
*  EXIT - NORMAL= IEFVHE                                              * 00833302
*      CONDITIONS= WHEN PROCESSING OF JOB CARD IS COMPLETE            * 00833402
*      OUTPUT DATA= REGISTERS 12 AND 13 REMAIN UNCHANGED              * 00833502
*      RETURN CODES= NONE                                             * 00835602
*                                                                     * 00836002
*  EXIT - ERROR= IEFVHE                                               * 00837602
*      CONDITION= AFTER AN ERROR HAS BEEN FOUND ON THE JOB CARD       * 00839602
*      OUTPUT DATA= ERROR MESSAGE VIA IEFVGM                          * 00839702
*      RETURN CODES= NONE                                             * 00839802
*                                                                     * 00839902
*  EXTERNAL REFERENCES=                                               * 00845602
*      ROUTINES= IEFVGK,IEFVGT,IEFVGM,IEFVHQ                          * 00847602
*      DATA AREAS= IWA,LWA,NEL                                        * 00849602
*      CONTROL BLOCKS= JCT - C,U,M                                    * 00850002
*                      QMPA - U,M                                     * 00850402
*                      JACT - C,U,M                                   * 00851202
*                      JMR  - U                               @ZA02952* 00851303
*          KEY: C=CREATE, U= USED, M=MODIFY                           * 00854303
*      TABLES= IEFVKEYS (TABLE OF VALID KEYS)                         * 00859103
*      MACROS= IEFVMIWA, IEFVMJWA, IEFAJCTB, IEFQMNGR                 * 00863103
*                                                                     * 00866103
*  MESSAGES= IEF639I - INVALID CLASS DESIGNATION                      * 00871003
*            IEF642I - EXCESSIVE PARAMETER LENGTH                     * 00873003
*            IEF646I - POSITIONAL PARAMETER MISSING                   * 00876803
*            IEF675I - PERFORM VALUE INVALID OR OMITTED - SYSTEM      * 00882603
*                      DEFAULT SUBSTITUTED                            * 00884603
*            IEF676I - PERFORM VALUE UNDEFINED TO SYSTEM - DEFAULT    * 00888403
*                      SUBSTITUTED                                    * 00890403
*                                                                     * 00894203
*   CHANGE LEVEL = OZ02952,OZ04561,OZ25756,OZ26751            @ZA26751* 00894803
*                = Z40RPTH, Z40RPSM, OZ27750                  @ZA27750* 00895003
*                                                                     * 00895403
*********************************************************************** 00896203
*                                                                     * 00900003
         EJECT                                                          00904003
         MACRO                                                          00908003
         KKK   &A,&B,&C,&D                                              00912003
         DC    XL1'&A'            NBR PARAMS THIS KEY.                  00916003
         DC    BL1'&B'       1 MEANS SUBPARAM OK THIS POS.              00920000
         DC    Y(&C)            OFFSET TO KEY PROCESSOR.                00940000
         DC    Y(&D)            OFFSET TO PDT.                          00960000
         MEND                                                           00980000
         MACRO                                                          01000000
         SSS   &A,&B                                                    01020000
         DC    XL1'&A'            NBR CNTRL BYTES/NBR BYTES COMPARE.    01040000
         DC    C'&B'              COMPARE PATTERN.                      01060000
         MEND                                                           01080000
         MACRO                                                          01100000
         MMM   &A,&B,&C                                                 01120000
         DC    FL1'&A'            MAX PARAMETER LENGTH.                 01140000
         DC    XL1'&B'            FUNCT/TABLE.                          01160000
         DC    AL1(&C)            OFFSET IN TABLE.                      01180000
         MEND                                                           01200000
         MACRO                                                          01220000
         DDD   &A,&B,&C,&D                                              01240000
         DC    XL1'&A'            FUNCT/TABLE.                          01260000
         DC    AL1(&B)            OFFSET IN TABLE.                      01280000
         DC    FL&C'&D'           MAX NBR (CVB).                        01300000
         MEND                                                           01320000
         MACRO                                                          01340000
         CCC   &A,&B                                                    01360000
         DC    FL1'&A'            LENGTH OF THIS POSITIONAL PDT.        01380000
         DC    XL1'&B'            NBR CNTRL BYTES/NBR BYTES COMPARE.    01400000
         MEND                                                           01420000
         MACRO                                                          01440000
         BBB   &A,&B,&C                                                 01460000
         DC    XL1'&A'            FUNCT/TABLE.                          01480000
         DC    AL1(&B)          OFFSET IN TABLE.                        01500000
         DC    XL1'&C'            BIT PATTERN.                          01520000
         MEND                                                           01540000
         MACRO                                                          01560000
         BBC   &A,&B,&C                                                 01580000
         DC    XL1'&A'            FUNCT/TABLE.                          01600000
         DC    AL1(&B)            OFFSET IN TABLE.                      01620000
         DC    AL1(&C)            BIT PATTERN.                          01640000
         MEND                                                           01660000
         TITLE 'IEFVJA - NEL'                                           01670001
JANEL    DSECT                                                          01672001
         IEFNEL SUBCOM=I                                         Y02668 01674002
         TITLE 'IEFVJA - KEYS'                                          01675003
         IEFVKEYS                                                       01682003
         TITLE 'IEFVJA - JMR'                                           01689003
         IEFJMR                                                @ZA02952 01696003
         EJECT                                                          01703003
         TITLE 'IEFVJA - IEFQMNGR'                                      01720000
         IEFQMNGR                                                       01740000
         TITLE 'IEFVJA - JCT'                                           01760000
JAJCT    DSECT                                                          01780000
JAACT    EQU   JAJCT                                                    01800000
         IEFAJCTB                                                       01820000
         TITLE 'IEFVJA - JCTX'                                 @Z40RPSM 01825003
JAJCTX   DSECT                                                          01830003
         IEFJCTX                                               @Z40RPSM 01835003
         TITLE 'IEFVJA - IWA'                                           01840000
         IEFCOMWA                                                       01860002
         EJECT                                                          01860602
         IEFVMIWA                                                       01861202
         IEFTXTFT                                                       01862002
         EJECT                                                          01870002
         TITLE 'IEFVJA - JWA'                                           01880000
         IEFVMJWA                                                       01900000
JAWORK   EQU   JWA                                                      01920000
         TITLE 'IEFVJA - JOB ROUTINE'                                   01940000
IEFVJA   CSECT                                                          01960000
* A PDT - SCAN KEYWORD                                         @ZA04561 01962003
* A 031565-031595,016760,008513  D 022198,031500               @ZA02952 01964003
* A 030350  C 030300                                           @ZA02952 01966003
* CHANGE PDT, BRANCH TABLE, AND CODE FOR PRTY                  @ZA26751 01968003
* CHANGE PDT, BRANCH TABLE, AND CODE FOR TYPRUN                @ZA26751 01970003
* RECOMPILE TO CORRECT MICROFICHE                              @ZA25756 01972003
*********************************************************************** 01980000
*                                                                     * 02000000
*        INPUT TO THIS ROUTINE:                                       * 02020000
*                                                                     * 02040000
*              RC = ADDRESS OF INTERPRETER WORK AREA.                 * 02060000
*              RD = CURRENT REGISTER SAVE AREA.                       * 02080000
*                                                                     * 02100000
*********************************************************************** 02120000
         SPACE                                                          02140000
JAERMAX  EQU   X'26'              ERROR NBR USED TO INDEX TO ERROR RTN. 02160001
JAFORMAT EQU   32                 ERROR MSG NBR FO FORMAT ERROR.   287  02180000
JANOREAL EQU   X'49'              IEF673I ADDRSPC=REAL INVALID   Y01029 02182001
JABADCLS EQU   39                 IEF639I INVALID CLASS DESIGNATION.    02184015
JAMISSIN EQU   46                 IEF646I ERROR MSG - POS PARAM MISSING 02188015
JAADDRSP EQU   X'80'              ADDRSPC FLAG                          02198001
JAREGOFF EQU   92                 OFFSET TO REGION STORE SLOT IN JCT.   02200000
JALENGTH EQU   42            IEF642I - EXCESSIVE PARAMETER LENGTH  AACA 02210017
JAALPHA  EQU   47      IEF647I-NON-ALPHABETIC FIRST CHARACTER  @Z40RPTH 02210503
WRNMSG03 EQU   X'04'              INVALID PERFORM VALUE          Y02655 02211002
WRNMSG05 EQU   X'13'              PERFORM VAL NOT SYS DEF'D     YM00368 02212002
JAZERO   EQU   0                   ZERO DISPLACEMENT              M1715 02213020
JA2      EQU   2                   DISPLACEMENT BYTE            YM00376 02213302
JA8      EQU   8                   LENGTH FOR MOVE               Y02655 02213702
JA16     EQU   16                  LENGTH F0R MOVE               Y02655 02214402
LENZERO  EQU   X'00'               PARAM LENGTH ZERO              M1715 02216020
         SPACE 2                                                        02220000
         BALR  RB,0               REGISTER 11 IS THE BASE REGISTER      02240000
         USING *,RB                    OF THE JOB ROUTINE.              02260000
JABASE   EQU   *                                                        02280000
*****************************************************************Y02668 02282002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 02284002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 02286002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 02288002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 02290002
         DC    C'VJA '             MOD ID USED BY TRACE.         Y02668 02292002
* TRACE RETURNS HERE.                                            Y02668 02294002
*****************************************************************Y02668 02296002
         B     JAA1               ********************                  02300000
         MODID BR=NO                                             Y01889 02320001
         DC    C'REL37'             FUNCTION ID AND            @Z40RPTH 02380003
*        DC    C'02'       LEV # (TYPRUN = SCAN)               @ZA04561 02385003
*        DC    C'04'       LEV # (RACF)                        @Z40RPSM 02388003
*        DC    C'05'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27750 02391003
         DC    C'06'       LEV # (REMOVE TYRUN & PRTY CODE)    @ZA26751 02394003
      EJECT                                                             02400003
*********************************************************************** 02420000
**                                                                   ** 02440000
**             HEADER PORTION OF JOB ROUTINE.                        ** 02460000
**                                                                   ** 02480000
*********************************************************************** 02500000
*                                                                       02520000
*        REGISTER USAGE:                                                02540000
*                                                                       02560000
*              R5 = ERROR MESSAGE CODE REGISTER.                        02580000
*              R8 = JCT ADDRESSING.                                     02600000
*              R9 = ADDRESS OF TEST AND STORE.                          02620000
*              RA = LOCAL AND GET-T+S WORK AREA.                        02640000
*              RB = JOB ROUTINE BASE REGISTER.                          02660000
*              RC = INTERPRETER WORK AREA.                              02680000
*              RD = REGISTER SAVE AREA.                                 02700000
*              RE = LINK RETURN REGISTER.                               02720000
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                     02740000
*                                                                       02760000
         SPACE                                                          02780000
JAA1     DS    0H                                                       02800000
         L     RA,CTRLWAP         LOCAL WORK AREA                       02840000
         USING JAWORK,RA               ADDRESSING.                      02860000
         L     R9,JATESTOR        T AND S ADDRESS.                      02880000
         XC    JAWORK(JATEMP2+2-JAWORK),JAWORK   ZERO WORK AREA.        02900000
         L     RF,JAGETKEP        GET KEY/POS ADDRESS.                  02920000
         LA    R8,JCT             JCT                                   02940000
         USING JAJCT,R8                ADDRESSING.                      02960000
*                                                                       02980000
*   INITIALIZE JCT - JOBNAME SLOT TO BLANKS, DEFAULT MSGLEVEL,     I68  03000018
*        DEFAULT PRTY, INTERNAL JOB SER = 1,TYPRUN=SETUP, & JCT ID=0.   03020000
*        STEP NUMBER=1, CHECKPOINT ID TO BLANKS                @ZA02952 03030003
*        JOBCLASS IS SET TO DEFAULT VALUE USED BY JES.         @ZA02952 03035003
*        USER ID TO BLANKS                                     @Z40RPTH 03036003
*        GROUP ID TO BLANKS                                    @Z40RPSM 03037003
*                                                                       03040000
         MVI   JCTJNAME,C' '                                            03060000
         MVC   JCTJNAME+1(7),JCTJNAME  BLANK JOBNAME SLOT.              03080000
         MVI   JCTJSRNO,X'01'      SET INTERNAL JOB SER NBR TO 1        03100000
         MVI   JCTSNUMB,X'01'     SET STEP NUMBER=1                AACA 03152017
         MVI   JCTCKIDT,C' '           * MOVE BLANKS INTO          AACA 03154017
         MVC   JCTCKIDT+1(15),JCTCKIDT * CHECKPOINT ID SLOT        AACA 03156017
         MVI   JCTUSER,C' '            * MOVE BLANKS INTO      @Z40RPTH 03156503
         MVC   JCTUSER+1(6),JCTUSER    * USER ID SLOT          @Z40RPTH 03156603
         LA    R3,JCTX                   ADDRESS JCTX          @Z40RPSM 03156703
         USING JAJCTX,R3                JCTX ADDRESSABILITY    @Z40RPSM 03156803
         MVI   JCTXGROP,C' '            * MOVE BLANKS INTO     @Z40RPSM 03156903
         MVC   JCTXGROP+1(7),JCTXGROP  * JCTX .                @Z40RPSM 03157003
         MVI   JCTXIDNT,JCTXID      SWA ID INTO JCTXIDNT       @Z40RPSM 03157103
         DROP  R3                                              @Z40RPSM 03157203
         L     R3,WANELPTR         ADDRESS OF NEL              @ZA02952 03157303
         USING JANEL,R3            NEL ADDRESSABILITY          @ZA02952 03157403
         L     R4,NELJMR           JMR ADDRESS                 @ZA02952 03157903
         USING JMR,R4              JMR ADDRESSABILITY          @ZA02952 03158003
         MVC   JCTJCSMF,JMRCLASS   SET JOBCLASS DEFAULT IN JCT @ZA02952 03158503
         DROP  R4                  RELEASE REGISTER 4          @ZA02952 03159003
         DROP  R3                  RELEASE REGISTER 3          @ZA02952 03159503
*                                                                       03160000
*   NOTE - IEFVHA ORIGINALLY ZEROES JCT, IEFVHH ZEROES JCT AFTER        03180000
*        EACH JOB STATEMENT.  THEREFORE, JCT ID IS ALREADY = 0,         03200000
*        AND TYPRUN = SETUP                                        I68  03220018
         SPACE                                                          03240000
*                                                                       03260000
*   CLEAR ACT                                                           03280000
*                                                                       03300000
         LA    R4,JACT            ACT ADDRESS.                          03320000
         XC    0(176,R4),0(R4)    ZERO 176 BYTE ACT.                    03340000
         MVI   ACTPRGNM-ACTDSKAD(R4),C' '   BLANK PGMNM SLOT.           03360000
         MVC   ACTPRGNM-ACTDSKAD+1(19,R4),ACTPRGNM-ACTDSKAD(R4)         03380000
*                                                                  AACA 03382017
* BLANK RESTART STEPNAME SLOT IN IWA, CLEAR CHKPT/RESTART SWITCHES AACA 03384017
*                                                                  AACA 03386017
         TM    SWH,CPSTPFL        IS C/R STEP FLUSH ON             AACA 03388017
         BZ    JAAA1               IF NO, DON'T BLANK FIELD     YM01573 03390002
*                                  FOR VEA                      YM01573 03391002
         MVC   IWAJOBS1(16),ACTPRGNM-ACTDSKAD(R4) USE BLANKS IN ACTAACA 03392017
*                                 TO BLANK OUT SLOT IN IWA              03394017
JAAA1    DS    0H                                                       03396017
         MVI   IWAINTS8,X'00'     CLEAR SWITCHES.                  AACA 03398017
*                                                                       03400000
*   ERROR MESSAGES SETUP.                                               03420000
*                                                                       03440000
         OI    JASW1,JANOJBNM+JANOPGNM+JANOACTN+JAACTPUT  SET ERROR SWS 03460000
         LA    R5,JAERMAX         SET ERROR MESSAGE REGISTER FOR        03480000
*                                      INDEXING ON ERROR RETURNS.       03500000
*                                                                       03520000
*   INITIALIZE DICTIONARY SWITCH FOR ENTRIES TO DICT 1 (SREFB).         03540000
*   CLEAR DDINO IN IWA (NECESSARY FOR JOBLIB WHEN NOT 1ST JOB).         03560000
*   CLEAR REGION AND ROLL SWITCHES IN IWA - CLEAR ROLL FIELD.      AACA 03570017
*   CLEAR REGION SPACE IN IWA.                                     AACA 03580017
*   SET NORESTART FLAG IN JCT - TO BE CLEARED IF RESTART SPECIFIED.AACA 03590017
*                                                                       03600000
         NI    SWD,FF-DCTFST-JOBREGNS-JOBADDRF  CLEAR SWITCHES IN SWD.  03606001
         MVI   IWAJBADR,LENZERO     CLEAR ADDRSPC FLAG          Y01029  03616001
         NI    JCTSTAT2,FF-JCTADSPC     CLEAR ADDRSPC FLAG      Y01029  03616401
         OI    SWD,DBFST          TURN ON FIRST ENTRY DSENQ SW     750  03640000
         XC    DDINTNO(2),DDINTNO CLEAR NBR DD STMTS SLOT IN IWA Y02668 03660002
         XC    IWAJOBS6(4),IWAJOBS6     CLEAR REGION SPACE.        AACA 03670017
*****************************************************************Y01113 03672001
*     CLEAR JOBCAT FIELDS AND SWITCH IN IWA                      Y01113 03674001
*****************************************************************Y01113 03676001
         XC    IWAJSIOT(4),IWAJSIOT    CLEAR TTR FIELD           Y01113 03678001
         NI    DDSWX1,FF-IWAJCAT-IWASCAT-IWASCAT2 CLR SWITCHES   Y01113 03678401
         XC    IWACATCT(1),IWACATCT  CLEAR P.C. COUNT FIELD      Y01113 03678501
         XC    JBCONCAT(1),JBCONCAT  CLEAR JOBLIB COUNT FIELD    Y01113 03678601
         SPACE                                                          03678801
*                                                                       03680000
*   INITIALIZE CORE FOR GET KEY/POS AND TEST & STORE.                   03700000
*                                                                       03720000
         LA    R7,JACLEANP        CLEANUP ADDRESS.                      03740000
         ST    R7,TCLEANUP                                              03760000
         LA    R7,JABRANCH        BRANCHING TABLE ADDRESS.              03780000
         ST    R7,TBRANCH                                               03800000
*                                                                       03820000
*   GET FIRST KEY.                                                      03840000
*                                                                       03860000
         BALR  RE,RF              GO TO GET FIRST KEY.                  03880000
         EJECT                                                          03900000
*********************************************************************** 03920000
*                                                                     * 03940000
*              JOB KEY PROCESSING.                                    * 03960000
*                                                                     * 03980000
*********************************************************************** 04000000
JAJOB    DS    0H                                                       04020000
*                                                                       04040000
*   JOBNAME.                                                            04060000
*                                                                       04080000
         BALR  RE,R9              GO TO TEST AND STORE JOBNAME.         04100000
*                                                                       04120000
*   ACCOUNT NUMBER.                                                     04140000
*                                                                       04160000
         BALR  RE,RF              GET NEXT POSITIONAL - ACCOUNT NBR.    04180000
         SPACE                                                          04200000
         LA    R7,JACT+ACTJNFLD-ACTDSKAD+1  ADDR OF ACCNT FIELD TO R7.  04220000
         LA    R0,1               CNTR1 = NBR OF ACCNT FIELDS.          04240000
         L     R6,TNUM1           CNTR2 = TOTAL LENGTH ACCNT FIELD.     04260000
         LTR   R2,R2              NULL PARAMETER.                       04280000
         BZ    JAC3               YES. GO CHECK FOR ACCNTING INFO.      04300000
         SPACE                                                          04320000
         NI    JASW1,X'FF'-JANOACTN-JAACTPUT     TURN OFF NO ACT SW &   04340000
*                                           NO ACT PUT SWITCH.          04360000
         EX    R2,JAJOBMV1        MOVE LENGTH AND ACNT NBR TO ACT.      04380000
         AR    R6,R2                   OF ACNT FIELDS + LENGTH.         04400000
JAC3     DS    0H                                                       04420000
         LA    R7,1(R7,R2)        POINT TO NEXT ACT STORE POSITION.     04440000
         CLC   TNUM1,TCT1         ACCOUNTING INFO TO STORE.             04460000
         BE    JAE2               NO GO TO GET NEXT POSITIONAL.         04480000
         SPACE                                                          04500000
         BALR  RE,RF              GET POSITIONAL - ACCOUNTING INFO.     04520000
         SPACE                                                          04540000
         A     R0,JA1             INCREMENT CNTR1 BY ONE.               04560000
         LTR   R2,R2              IS THIS A NULL PARAMETER.             04580000
         BZ    JAC3               NO.  GO GET NEXT POSITIONAL.          04600000
         SPACE                                                          04620000
         AR    R6,R2              ADD LENGTH TO CNTR 2.                 04640000
         NI    JASW1,X'FF'-JAACTPUT    TURN OFF NO ACT TO PUT SW.       04660000
         CL    R6,JA144           DOES TOTAL ACCNTING FIELD EXCEDE 144. 04680000
         BH    JAER6              YES. -ERROR- ACCNT FIELD EXCEDES 144. 04700000
         SPACE                                                          04720000
         EX    R2,JAJOBMV1        NO. MOVE ACTNG INFO TO ACT.           04740000
         SPACE                                                          04760000
         B     JAC3               GO TO CHECK FOR MORE ACTNG INFO.      04780000
         SPACE                                                          04800000
JAE2     DS    0H                                                       04820000
         STC   R0,JACT+ACTJNFLD-ACTDSKAD   STORE NBR ACCNT FIELDS.      04840000
         SPACE                                                          04860000
*                                                                       04880000
*   PROGRAMMER NAME.                                                    04900000
*                                                                       04920000
         BALR  RE,RF              GET NEXT POSITIONAL - PROG NAME.      04940000
         SPACE                                                          04960000
         BALR  RE,R9              TEST AND STORE PROGRAMMER NAME.       04980000
         SPACE                                                          05000000
         BALR  RE,RF              GO GET NEXT KEY.                      05020000
         SPACE                                                          05040000
JAJOBMV1 MVC   0(1,R7),0(R3)      MOVE ACNTNG FIELDS TO ACT (EXECUTED). 05060000
         EJECT                                                          05080000
*********************************************************************** 05100000
*                                                                     * 05120000
*     GROUP/USER/MSGLEVEL/MSGCLASS/RD   KEY PROCESSING.        @Z40RPSM 05140003
*                                                                     * 05160000
*********************************************************************** 05180000
JARD     DS    0H                                                 M1715 05182020
         CLI   JAZERO(R3),LENZERO      PARAMETER LENGTH ZERO?     M1715 05184020
         BE    JAER1                   YES-ERROR CONDITION.       M1715 05186020
         BALR  RE,R9               TEST AND STORE.               Y02668 05186602
         MVC   IWAINTS8(1),JCTRSW2 MOVE CKPT SWS TO WA FOR VEA.  Y02668 05187202
         NI    IWAINTS8,JCTNORST+JCTNOCKP+JCTRESTT    CLEAR      Y02668*05187802
                                   REDUNDANT BITS.               Y02668 05188402
         BALR  RE,RF               GET NEXT KEY.                 Y02668 05189002
JAUSER   DS    0H                                              @Z40RPTH 05190003
JAGROUP  DS    0H                                              @Z40RPSM 05200003
JAMSCL   DS    0H                                                       05240000
         BALR  RE,R9              TEST AND STORE.                       05320000
         BALR  RE,RF              GO TO GET NEXT KEY               I68  05321018
JAMSLV   DS    0H   PARM OR SYSGEN DEFAULT VALUES ARE ALREADY SET  I68  05322018
         LTR   R2,R2          IS LENGTH OF JCL LEVEL ZERO          I68  05323018
         BZ    JAMSLGET       YES - GO GET ALLOCATION LEVEL        I68  05324018
         NI    JCTJMGLV,X'8F' NO - CLEAR DEFAULT JCL LEVEL         I68  05325018
JAMSLGET BALR  RE,R9                   TEST AND STORE             M3309 05326018
         BALR  RE,RF                   GET NEXT KEY               M3309 05327018
         LTR   R2,R2          IS LENGTH OF ALLOCATION LEVEL ZERO   I68  05328018
         BZ    JAMSLOUT       YES - BRANCH NO MORE MSGLEVEL PROCESSING  05329018
         NI    JCTJMGLV,X'7F' NO - CLEAR DEFAULT ALLOCATION LEVEL  I68  05330018
         BALR  RE,R9          GO TO TEST AND STORE                 I68  05331018
JAMSLOUT BALR  RE,RF          GO TO GET NEXT KEY                   I68  05332018
         EJECT                                                          05332403
*********************************************************************** 05332803
*                                                                     * 05333703
*     TYPRUN KEYWORD PROCESSING                               @ZA26751* 05334603
*                                                                     * 05335503
*  THE INTERPRETER DOES NOT PROCESS THIS KEYWORD BUT RATHER   @ZA26751* 05336403
*  ALLOWS ALL THE PROCESSING TO BE DONE BY THE JOB ENTRY      @ZA26751* 05337303
*  SUBSYSTEM (JES).                                           @ZA26751* 05338203
*                                                                     * 05339103
*********************************************************************** 05340003
         SPACE 2                                                        05340903
JATYP    DS    0H                 TYPRUN KEYWORD PROCESSING    @ZA26751 05341803
         BALR  RE,RF              GO TO GET NEXT KEY           @ZA26751 05342703
         B     JATYP              LOOP UNTIL NEW KEYWORD FOUND @ZA26751 05343603
         SPACE 2                                                        05344503
*********************************************************************** 05345403
*                                                                     * 05346303
*     PRTY KEY PROCESSING                                     @ZA26751* 05347203
*                                                                     * 05348103
*  THE INTERPRETER DOES NOT PROCESS THIS KEYWORD BUT RATHER   @ZA26751* 05349003
*  ALLOWS ALL THE PROCESSING TO BE DONE BY THE JOB ENTRY      @ZA26751* 05349903
*  SUBSYSTEM (JES).                                           @ZA26751* 05350803
*                                                                     * 05351703
*********************************************************************** 05352603
         SPACE 2                                                        05353503
JAPRTY   DS    0H                 PRTY KEYWORD PROCESSING      @ZA26751 05354403
         BALR  RE,RF              GO TO GET NEXT KEY           @ZA26751 05355303
         B     JAPRTY             LOOP UNTIL NEW KEYWORD FOUND @ZA26751 05356203
         SPACE 2                                                        05357103
         EJECT                                                          05360217
*******************************************************************AACA 05360417
*                                                                  AACA 05360617
*              RESTART KEY PROCESSING.                             AACA 05360817
*                                                                  AACA 05361017
*******************************************************************AACA 05361217
JAREST   DS    0H                                                  AACA 05361417
*                                                                  AACA 05361617
*        IF RESTART=STEPNAME OR STEPNAME.PROCSTEPNAME, IEFVGT      AACA 05361817
*        CHECKS 1ST CHARACTER ALPHA AND TEMPORARILY MOVES UP TO 17 AACA 05362017
*        BYTES TO SRCHL1.  (THIS IS A REFERBACK WORK AREA WHICH IS AACA 05362217
*        NOT USED DURING JOB STATEMENT PROCESSING.)  ALSO          AACA 05362417
*        SETS BITS JATCKPTR AND JATSTEPR IN JCT. IF THERE IS A CHECKID, 05362617
*        JATSTEPR IS TURNED OFF AND UP TO 16 BYTES ARE MOVED TO    AACA 05362817
*        JATCKIDT OF JCT.  JATCKIDL IS SET BY STC OF R2.           AACA 05363017
         OI    SWH,CPFLGXX        INDICATE RESTART                 AACA 05363617
         LTR   R2,R2              1ST PARAMETER IS REQUIRED.       AACA 05363817
         BZ    JAER1              NOT THERE - ERROR.               AACA 05364017
         CLI   1(R3),C'*'         IS IT RESTART = *.               AACA 05364217
         BNE   JAREST1            NO. GO CHECK STEPNAME            AACA 05364417
         C     R2,JA1             ONE CHARACTER ONLY.              AACA 05364617
         BNE   JAER1              NO - ERROR.                      AACA 05364817
         ST    R4,TPDTP           * SET UP PDT POINTERS FOR GT SO  AACA 05365017
         LA    R6,JAST5           * THAT IT WILL LOOK AT 2ND ENTRY AACA 05365217
         ST    R6,TCPDTP          * IN RESTART PDT BYPASSING 1ST.  AACA 05365417
         MVI   IWAJOBS3,C'*'      INDICATE CHECKPOINT IS 1ST STEP. AACA 05365617
         B     JAREST5            GO TO PROCESS CHECKID.           AACA 05365817
         SPACE                                                          05366017
JAREST1  DS    0H                                                  AACA 05366217
         BALR  RE,R9         ERROE CHECK STEPNAME & MVC TO SRCHL1  AACA 05366417
         SPACE                                                          05366617
         LA    R4,8          SET UP FOR SCAN OF STEPNAME.PROCSTEP  AACA 05366817
         LR    R6,R2              TOTAL LENGTH.                    AACA 05367017
         LR    R7,R3              POINTER TO PARAMETER.            AACA 05367217
JAREST2  DS    0H                                                  AACA 05367417
         CLI   1(R3),C'.'         SCAN FOR PERIOD.                 AACA 05367617
         BE    JAREST3       STEPNAME.PROCSTEP - GO SAVE STEPNAME  AACA 05367817
         LA    R3,1(R3,0)         NO HIT - POINT AT NEXT BYTE.     AACA 05368017
         BCT   R6,JAREST2         DECREMENT COUNT AND TRY AGAIN.   AACA 05368217
         LR    R6,R2              STEPNAME.   - RESTORE R6.        AACA 05368417
         B     JAREST4            GO TO SAVE STEPNAME.             AACA 05368617
JAREST3  DS    0H                                                  AACA 05368817
         SR    R2,R6         DETERMINE LENGTH OF CALLING STEPNAME  AACA 05369017
         CLR   R2,R4                                               AACA 05369217
         BH    JAER1                                               AACA 05369417
         BCTR  R2,0                                                AACA 05369617
         EX    R2,JARESTM1        MOVE CALLING STEPNAME TO IWAJOBS1AACA 05369817
         LA    R7,1(R3)           POINT R7 AT PROCSTEP-1.          AACA 05370017
         BCTR  R6,0               DECREMENT BECAUSE OF PERIOD.     AACA 05370217
JAREST4  DS    0H                                                  AACA 05370417
         CLR   R6,R4              DOES STEPNAME EXCEED 8 CHARACTERSAACA 05370617
         BH    JAER1              YES - ERROR                      AACA 05370817
         BCTR  R6,0               DECREMENT FOR EX STMT.           AACA 05371017
         EX    R6,JARESTM2   MOVE STEPNAME OR PROCSTEP TO IWAJOBS3 AACA 05371217
JAREST5  DS    0H                                                  AACA 05371417
         BALR  RE,RF              GET CHECKID.                     AACA 05371817
         BALR  RE,R9         CHECK 1ST CHAR ALPHA - MOVE TO JCT    AACA 05372017
         STC   R2,JCTCKIDL        IF NOT SAVE CHECKID LENGTH IN JCTAACA 05372317
*                                                                  AACA 05372517
         BALR  RE,RF              GET NEXT KEYWORD                 AACA 05372617
         SPACE 2                                                        05372817
JARESTM1 MVC   IWAJOBS1(1),1(R7)       EXECUTED.                   AACA 05373017
JARESTM2 MVC   IWAJOBS3(1),1(R7)       EXECUTED.                   AACA 05373217
         EJECT                                                          05380000
*********************************************************************** 05400000
*                            TIME KEY PROCESSING                      * 05622018
*********************************************************************** 05623018
JATIME   XC    JCTJMRSS+DEC1(DEC8),JCTJMRSS+DEC1 CLEAR THE WORK    SMF1 05624018
*                                           FIELDS                 SMF1 05625018
         BALR  RE,R9                   CONVETT MIN TO BINARY       SMF1 05626018
         CLC   TNUM(DEC4),TCT          ARE ALL SUB PARAMS DONE     SMF1 05627018
         BE    JATIME1                 YES                         SMF1 05628018
         BALR  RE,RF                   NO, GO GET 2ND ONE (SECS)   SMF1 05629018
         BALR  RE,R9                   AND CONVERT TO BINARY       SMF1 05630018
JATIME1  L     R6,JCTJMRSS+DEC1        *                           SMF1 05631018
         MH    R6,JA6000               MIN TO 1/100 SECS           SMF1 05632018
         L     R7,JCTJMRSS+DEC5        *                           SMF1 05633018
         MH    R7,JA100                SECS TO 1/100 SECS          SMF1 05634018
         AR    R6,R7                   ADD TOGETHER                SMF1 05635018
         SLL   R6,DEC8                 SHIFT LEFT ONE BYTE         SMF1 05636018
         ST    R6,JCTJMRTL             AND STORE                   SMF1 05637018
         XC    JCTJMRSS+DEC1(DEC8),JCTJMRSS+DEC1  REINITIALIZE @YA02020 05637302
*              FIELD TO ZERO AFTER USE....                     @YA02020 05637602
         BALR  RE,RF                   AND GO AWAY FOR NEXT        SMF1 05638018
*                                           KEYWORD                SMF1 05639018
         EJECT                                                          05640000
*********************************************************************** 05660000
*                                                                     * 05680000
*              COND KEY PROCESSING                                    * 05700000
*                                                                     * 05720000
*********************************************************************** 05740000
JACOND   DS    0H                                                       05760000
         SPACE                                                          05780000
         LA    R7,JCTJDPCD        DEPENDENCY CODE ADDR TO R7.           05800000
JBB2     DS    0H                                                       05820000
         OI    JASW1,JACONDER     SET COND ERROR FLAG.                  05840000
*                                                                       05860000
*   DEPENDENCY CODE                                                     05880000
*                                                                       05900000
         BALR  RE,R9              TEST & STORE CODE. (TEMP1)            05920000
*                                                                       05940000
*   CHECK FOR THE COND AS A SUBPARAMETER. (PROPER NBR PARENTHESIS).     05960000
*                                                                       05980000
         BCTR  R3,0               POINT TO BYTE BEFORE TLENP. HOPEFULLY 06000000
*                                      IT IS THE SUBPARAMETER BYTE.     06020000
         SR    R2,R2                                                    06040000
         IC    R2,0(R3)           PICK UP BYTE.                         06060000
         SRL   R2,4               SHIFT TO GET HIGH ORDER BITS ONLY.    06080000
         X     R2,JAMSK1          CHECK FOR SUBPARM INDICATOR ONLY.     06100000
         BC    4,JAER1            IF OTHER BITS ON NOT SUBPARM -ERROR-  06120000
*                                                                       06140000
*   DEPENDENCY OPERATOR                                                 06160000
*                                                                       06180000
         BALR  RE,RF              GET OPERATOR.                         06200000
         SPACE                                                          06220000
         LTR   R2,R2              IS THERE AN OPERATOR.                 06240000
         BZ    JAER1              NO. ERROR.                            06260000
         SPACE                                                          06280000
         CLC   TNUM1(4),TCT1      ARE THERE MORE PARAMS IN COND FIELD.  06300000
         BNE   JAER1              YES. ERROR.                           06320000
         SPACE                                                          06340000
         XC    JATEMP2(2),JATEMP2      ZERO TEMP2 FOR OR OF OP CODE.    06360000
*                                                                       06380000
*   DEPENDENCY OPERATOR                                                 06400000
*                                                                       06420000
         BALR  RE,R9              TEST & STORE OPERATOR. (TEMP 2)       06440000
         SPACE                                                          06460000
         ST    RB,TPDTP           SPOIL PDTP SO THAT T&S WILL START AT  06480000
*                                      TOP AND CYCLE THRU TABLE AGAIN.  06500000
         MVC   0(4,R7),JATEMP1    MOVE CODE & OPERATOR TO JCT.          06520000
         LA    R7,4(R7,0)         INCREMENT TO NEXT STORE POSITION.     06540000
         NI    JASW1,X'FF'-JACONDER    TURN OFF COND ERROR FLAG.        06560000
         SPACE                                                          06580000
         BALR  RE,RF              GO TO GET NEXT COND CODE OR NEXT KEY. 06600000
         SPACE                                                          06620000
         B     JBB2               IF ANOTHER COND GO TO PROCESS.        06640000
         EJECT                                                          06660000
*********************************************************************** 06680000
*                                                                     * 06700000
*              REGION KEY PROCESSING.                                 * 06720000
*                                                                     * 06740000
*********************************************************************** 06760000
JAREG    DS    0H                                                       06780000
         LTR   R2,R2              IS PRIMARY REGION SPECIFIED      AACA 06810017
         BZ    JAREG01            NO-GO GET NEXT KEY               AACA 06840017
         BAL   RE,JAREG1          CHECK HIGH SPEED REGION SYNTAX.  AACA 06870017
         BALR  RE,R9              LINK TO TEST NUMERICS, CVB & MVC-JCT. 06920000
         OI    SWD,JOBREGNS        SET SW - REGION ON JOB STMT.  Y02668 06920502
         MVC   IWAJOBS6(2),JAREGOFF(R8) MOVE REGION TO IWA FOR SCT.AACA 06921017
         SPACE                                                          06922017
JAREG01  DS    0H                                                  AACA 06923017
         ST    R4,TPDTP           * SET UP PDT POINTERS FOR GT SO  AACA 06924017
         LA    R6,JAREGB+1        * THAT IT WILL LOOK AT 2ND ENTRY AACA 06925017
         ST    R6,TCPDTP          * IN REGION PDT, BYPASSING 1ST.  AACA 06926017
         BALR  RE,RF                                               AACA 06927017
         SPACE                                                          06928017
         BAL   RE,JAREG1          CHECK LCS.                       AACA 06929017
         BALR  RE,R9              CVB & MOVE TO JATEMP1.           AACA 06930017
         SR    R4,R4              ZERO R4                        Y01029 06930401
         IC    R4,JATEMP1         FIRST BYTE H1 IN R4            Y01029 06930501
         SLL   R4,8               MOVE FIRST BYTE H1             Y01029 06930601
         IC    R4,JATEMP1+1       INSERT SECOND BYTE OF H1       Y01029 06930701
         AH    R4,JAREGOFF(R8)    ADD H0 VALUE TO H1             Y01029 06939001
         C     R4,MAXVAL          MAX VALUE EXCEEDED ?           Y01029 06939401
         BH    JAER77             YES, ERROR MSG                 Y01029 06939801
         STH   R4,JAREGOFF(R8)    JCT REGION = H0 + H1           Y01029 06940801
         STH   R4,IWAJOBS6        IWA REGION = H0 + H1           Y01029 06942601
         BALR  RE,RF              GET NEXT KEY.                    AACA 06944401
         SPACE                                                          06946201
JAREG1   DS    0H                                                  AACA 06948001
         LA    R6,0(R2,R3)        CHECK FOR REGION OF XXXXXK.      AACA 06949801
         CLI   0(R6),C'K'                                          AACA 06951601
         BNE   JAER1              NO 'K'.  GO TO ERROR.            AACA 06953401
         BCTR  R2,0               SET TO PROCESS NUMERICS ONLY.    AACA 06955201
         LTR   R2,R2         WAS 'K' ONLY SPECIFICATION?        YA02009 06955802
         BZ    JAER1         YES,FORMAT ERROR IN REGION FIELD.. YA02009 06956402
         BR    RE                 RETURN.                          AACA 06957001
         EJECT                                                          06958801
*********************************************************************** 06960615
*                                                                     * 06960915
*                                                                     * 06961215
*              ROLL KEY PROCESSING.                                   * 06961515
*                                                                     * 06961815
*********************************************************************** 06962115
JAROLL   DS    0H                                                       06962415
         SPACE                                                          06966315
         BALR  RE,RF              GET NEXT KEYWORD.                     06966615
         B     JAROLL                                           Y01029  06966701
         EJECT                                                          06966915
*********************************************************************** 06967215
*                                                                     * 06967515
*              CLASS KEY PROCESSING.                                  * 06967815
*                                                                     * 06968115
*********************************************************************** 06968415
JACLASS  DS    0H                                               YM00362 06968702
         LA    R7,JACLSTBL         ADDR OF TABLE OF CLASSES.    YM00362 06969002
         LA    R6,JACLSLTH         CLASS TABLE LENGTH.          YM00362 06969302
JACLASS1 DS    0H                                               YM00362 06969602
         CLC   0(1,R7),1(R3)       SPECIFIED CLASS IN TABLE?    YM00362 06969902
         BE    JACLASS2            BR YES TO ENTER CLASS IN JCT.YM00362 06970202
         LA    R7,1(R7)            POINT TO NEXT ENTRY IN TABLE.YM00362 06970502
         BCT   R6,JACLASS1         REDUCE ENTRY COUNT, AND BR   YM00362*06970802
                                   TO CHECK NEXT ENTRY.         YM00362 06971102
* FALL THRU IF ALL ENTRIES CHECKED AND NO MATCH FOUND.          YM00362 06971402
* SPECIFIED CLASS IS INVALID.                                   YM00362 06971702
         MVI   MSGSEC,JABADCLS    SET MSG NBR FOR IEF639I               06972315
         B     JACLEANP           GO TO CLEANUP.                        06972615
JACLASS2 DS    0H                                                       06973215
         BALR  RE,R9              TEST FOR ONE BYTE ONLY.               06973515
         MVC   JCTJCSMF(1),1(R3)   MOVE JOBCLASS VALUE TO JCT.  YM00361 06973802
         BALR  RE,RF              GO TO GET NEXT KEYWORD.               06974115
         SPACE 2                                                        06974402
*  TABLE OF VALID CLASS VALUES.                                 YM00362 06974602
JACLSTBL DS    0C                                               YM00362 06974802
         DC    C'ABCDEFGHI'                                     YM00362 06975002
         DC    C'JKLMNOPQR'                                     YM00362 06975202
         DC    C'STUVWXYZ'                                      YM00362 06975402
         DC    C'0123456789'                                    YM00362 06975602
JACLSEND DS    0C                                               YM00362 06975802
JACLSLTH EQU   JACLSEND-JACLSTBL                                YM00362 06976002
         EJECT                                                          06976701
*********************************************************************** 06978201
**                                                                   ** 06978801
**                   ADDRSPC KEY PROCESSING                          ** 06978901
**                                                                   ** 06979001
**                                                                   ** 06979201
*********************************************************************** 06979401
*                                                                       06979801
JAADDR   DS    0H                                                Y01029 06979901
         LTR   R2,R2              ADDRSPC PARAMETER SPECIFIED?   Y01029 06986701
         BZ    TEST               NO, GET NEXT KEY(NULLIFY)      Y01029 06988601
         BALR  RE,R9              TEST AND STORE ROUTINE         Y01029 06990601
         OI    SWD,JOBADDRF        SET SW - ADDRSPC ON JOB STMT. Y02668 06991602
         TM    JCTSTAT2,JCTADSPC  ADDRSPC=REAL?                  Y01029 06992601
         BZ    TEST               NO,NO TSO CHECK               Y01029  06992701
         L     R3,WANELPTR         ADDRESS OF NEL.               Y02668 06993102
         USING JANEL,R3            NEL ADDRESSABILITY            Y01029 06993501
         TM    NELOPSW2,NELADSPC   IS THIS A TSO USER ?          Y01029 06993901
         BZ    JAADDR1             NO GO TO SET ADDRSPC BIT      Y01029 06994001
         DROP  R3                                                       06994401
         MVI   MSGSEC,JANOREAL     YES, ADDRSPC=REAL INVALID     Y01029 06997401
         MVI   MSGKEY,JOBK         ON JOB STATEMENT              Y01029 06999401
         B     JAERRTN             EXIT TO ERROR RTN             Y01029 06999801
JAADDR1  DS    0H                                                Y01029 07000201
         OI    IWAJBADR,JCTADSPC                                 Y01029 07000701
TEST     DS    0H                                                Y01029 07002701
         BALR  RE,RF               GO GET NEXT KEY               Y01029 07005702
         EJECT                                                          07005802
************************************************************     Y02655 07005902
**                                                        **     Y02655 07006002
**                 PERFORM KEY PROCESSING                 **     Y02655 07006102
**                                                        **     Y02655 07006202
************************************************************     Y02655 07006302
          SPACE                                                         07006402
JAPRFM   DS    0H                                                Y02655 07006502
         OI    JCT+JCTSTAT2-INJMJCT,JCTPERFM SET JOB PRFM FLAG. YM00368 07006602
         LTR   R2,R2               PERFORM VALUE SPECIFIED?     YM00368 07008602
         BZ    JAPRFM1             NO, ISSUE WARNING MSG.       YM00368 07010602
         BALR  RE,R9               GO TO TEST AND STORE RTNE.   YM00368 07012602
         CLI   MSGSEC,JAZERO       VGT ENTERS MSG CODE IF ERROR.YM00368 07014602
         BE    JAPRFM2             BRANCH ON ERROR.             YM00368 07016602
         MVI   MSGSEC,JAZERO       ZERO MESSAGE FIELD.          YM00368 07018602
JAPRFM1  DS    0H                                               YM00368 07020602
         MVI   MSGKEY,JAZERO       CLEAR SECONDARY MSG FIELD.   YM00368 07022602
         LA    R2,WRNMSG03         LOAD WARNING MSG CODE.       YM00368 07024602
         L     R3,JAVGM            GET MESSAGE MODULE ADDRESS.  YM00368 07026602
         BALR  RE,R3               ISSUE MESSAGE.               YM00368 07028602
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 07030602
*  IEFVGT WILL ACCEPT VALUES IN THE RANGE OF 0-255.             YM00368 07032602
JAPRFM2  DS    0H                                               YM00368 07034602
         CLI   JCT+JCTPRFMF-INJMJCT,JAZERO VALUE EQUAL ZERO?    YM00368 07036602
         BE    JAPRFM1             BRANCH YES, ZERO IS INVALID. YM00368 07038602
         SR    R1,R1               CLEAR REG 1.                 YM00368 07040602
         IC    R1,JCT+JCTPRFMF-INJMJCT GET SPECIFIED VALUE.     YM00368 07042602
         SYSEVENT VERIFYPG         VALIDATE VALUE.              YM00368 07044602
         L     RF,JAGETKEP         RESTORE GET KEY ADDRESS.     YM00368 07046602
*  SRM RETURNS ZERO IN BYTE 2 IF SPECIFIED VALUE IS DEFINED TO  YM00368 07048602
*  SYSTEM, OR A DEFAULT VALUE IF SPECIFIED VALUE IS UNDEFINED.  YM00368 07050602
         CLM   R1,JA2,JACON0       ZERO RETURN CODE ?           YM00376 07052602
         BZ    JAPRFM3             BRANCH YES, VALID VALUE.     YM00368 07054602
*  SPECIFIED VALUE IS INVALID.                                  YM00368 07056602
         STCM  R1,JA2,JCT+JCTPRFMF-INJMJCT ENTER DEFAULT IN JCT.YM00376 07058602
         MVI   MSGKEY,JAZERO       CLEAR SECONDARY MSG FIELD.   YM00368 07060602
         LA    R2,WRNMSG05         INSERT WARNING MSG FOR VGM.  YM00368 07062602
         L     R3,JAVGM            GET MESSAGE MODULE ADDRESS.  YM00368 07064602
         BALR  RE,R3               ISSUE MESSAGE.               YM00368 07066602
JAPRFM3  DS    0H                                               YM00368 07068602
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 07070602
         EJECT                                                  YM00368 07072602
***************************************************************@Z40RPTH 07074603
**                                                           **@Z40RPTH 07074703
**           PASSWORD KEYWORD PROCESSING                     **@Z40RPSM 07074803
**                                                           **@Z40RPTH 07074903
* REGISTER 4 CONTAINS THE ADDRESS OF THE PDT FOR THE PASSWORD  @Z40RPSM 07075003
* KEYWORD.  THE PDT WILL NOT BE USED SINCE NO DATA WILL BE     @Z40RPTH 07075103
* MOVED TO A CONTROL BLOCK.  ALL PASSWORD KEYWORD PROCESSING IS@Z40RPSM 07075203
* HANDLED BY THIS ROUTINE.  THEREFORE, REGISTER 4 CAN BE       @Z40RPTH 07075303
* DESTROYED AND USED AS A WORK REGISTER.                       @Z40RPTH 07075403
***************************************************************@Z40RPTH 07075503
         SPACE 2                                                        07075603
JAPASS   DS    0H                                              @Z40RPSM 07075703
         LA    R4,EIGHT       PUT VALUE 8 IN REG. 4            @Z40RPSM 07075803
         CR    R2,R4          PASSWORD LENGTH GREATER THAN 8?  @Z40RPSM 07075903
         BNH   PASSOK         NO,PASSWORD IS VALID             @Z40RPSM 07076003
         B     JAER8          YES,ISSUE ERROR MESSAGE IEF642I  @Z40RPTH 07076103
PASSOK   BALR  RE,RF          GET NEXT KEYWORD                 @Z40RPSM 07076203
         B JAPASS             FOR 2ND PASSWORD                 @Z40RPSM 07076303
         EJECT                                                          07076403
***************************************************************@Z40RPTH 07076503
**                                                           **@Z40RPTH 07076603
**               NOTIFY KEYWORD PROCESSING                   **@Z40RPTH 07076703
**                                                           **@Z40RPTH 07076803
* REGISTER 4 CONTAINS THE ADDRESS OF THE PDT FOR THE NOTIFY    @Z40RPTH 07076903
* KEYWORD.  THE PDT WILL NOT BE USED SINCE NO DATA WILL BE     @Z40RPTH 07077003
* MOVED TO A CONTROL BLOCK. ALL NOTIFY KEYWORD PROCESSING IS   @Z40RPTH 07077103
* HANDLED BY THIS ROUTINE. THEREFORE, REGISTER 4 CAN BE        @Z40RPTH 07077203
* DESTROYED AND USED AS A WORK REGISTER.                       @Z40RPTH 07077303
***************************************************************@Z40RPTH 07077403
         SPACE 2                                                        07077503
JANOTIFY DS    0H                                              @Z40RPTH 07077603
         LA    R4,SEVEN        PUT VALUE 7 IN REG. 4           @Z40RPTH 07077703
         CR    R2,R4           USER ID GREATER THAN 7 CHARS?   @Z40RPTH 07077803
         BNH   CHECKN          NO,CHECK FIRST CHARACTER        @Z40RPTH 07077903
         B     JAER8          YES,ISSUE ERROR MESSAGE IEF642I  @Z40RPTH 07078003
CHECKN   LA    R3,1(0,R3)     POINT TO FIRST CHARACTER         @Z40RPTH 07078103
         CLI   0(R3),E9       COMPARE FIRST CHAR. TO X'E9'=Z   @Z40RPTH 07078203
         BH    JAER9          NUMERIC FIRST CHAR. INVALID      @Z40RPTH 07078303
         BALR  RE,RF          GET NEXT KEYWORD                 @Z40RPTH 07078403
         EJECT                                                          07078503
*********************************************************************** 07078603
**                                                                   ** 07078703
**             CLEANUP PORTION OF JOB ROUTINE.                       ** 07080602
**                                                                   ** 07082602
*********************************************************************** 07084602
JACLEANP DS    0H                                                       07086602
*                                                               YM00368 07088602
*   PERFORM CHECK.                                              YM00368 07090602
*                                                               YM00368 07092602
         CLI JCT+JCTPRFMF-INJMJCT,JAZERO PERF VALUE SPECIFIED?  YM00368 07094602
         BNE   JAE1               YES,CONTINUE NORMAL PROCESSINGYM00368 07096602
*  PERFORM VALUE NOT SPECIFIED ON JOB STMT. IEFVJA OBTAINS      YM00368 07098602
*  DEFAULT FOR EXEC PROCESSOR IN THE EVENT A PERFORM VALUE      YM00368 07100602
*  WAS NOT SPECIFIED ON AN EXEC STMT.                           YM00368 07102602
         SR    R1,R1              CLEAR REG FOR SYSEVENT        YM00368 07104602
         SYSEVENT VERIFYPG                                      YM00368 07106602
         STCM  R1,JA2,JCT+JCTPRFMF-INJMJCT SAVE DEFLT VALUE     YM00368 07108602
*                                                                       07120000
*   ERROR CHECK.                                                        07140000
*                                                                       07160000
         CLI   MSGSEC,X'00'       IS ERROR FLAG EQUAL ZERO.             07180000
         BNE   JAERRTN            NO - ERROR.                           07200000
*                                                                       07220000
*   JOBNAME CHECK.                                                      07240000
*                                                                       07260000
JAE1     DS    0H                                                       07280000
         TM    JASW1,JANOJBNM     IS THE NO JOBNAME SWITCH ON.          07300000
         BO    JAER4              YES. -ERROR- -NO JOBNAME-             07320000
*                                                                       07340000
*   CONDITION CHECK.                                                    07360000
*                                                                       07380000
         MVI   MSGKEY,CONDJK      SET SECONDARY MESSAGE FOR COND.       07400000
         TM    JASW1,JACONDER     IS THE CONDITION ERROR SWITCH ON.     07420000
         BO    JAER1              YES. -ERROR- -OPERATOR MISSING-       07440000
*                                                                       07460000
*   CHECK FOR ACCOUNT NUMBER OR PROGRAMMER NAME NEEDED AND MISSIOG.     07480000
*                                                                       07500000
         LA    R3,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 07506002
         USING TEXT,R3             PREFIX ADDRESSABILITY.        Y02668 07512002
         TM    JASW1,JANOPGNM     IS THERE A PROGRAMMER NAME.           07520000
         BZ    JAE12              YES. GO TO CHECK ACCNT NBR.           07540000
         TM    STRJINDC,JTXPROGN   PROGR NAME REQUIRED?          Y02668 07580002
         BO    JAER2              YES. ERROR -PROGRAMMER NAME MISS-     07600000
         SPACE                                                          07620000
JAE12    DS    0H                                                       07640000
         TM    JASW1,JANOACTN     IS THERE AN ACCOUNT NUMBER.           07660000
         BZ    JABLPCHK            BYPASS ACCT # REQUIRED CHECK. Y02668 07680002
         TM    STRJINDC,JTXACCTN   ACCT NUMBER REQUIRED?         Y02668 07700002
         BO    JAER3              YES. -ERROR-  -ACT NBR MISSING-       07740000
*  CHECK IF BYPASS LABEL PROCESSING DEFAULT SPECIFIED.           Y02668 07742002
JABLPCHK DS    0H                                                Y02668 07744002
         TM    STRJLABD,JTXLABLP   IS DEFAULT BLP?               Y02668 07746002
         BZ    JAACTCK             NO, DEFLT IS NL, NO BIT SET.  Y02668 07748002
         OI    JCTSTAT2,JCTBLP     SET BLP FLAG IN JCT.          Y02668 07750002
         DROP  R3                                                Y02668 07752002
*                                                                       07760000
*   ACT TO PUT OUT.                                                     07780000
*                                                                       07800000
JAACTCK DS     0H                                                       07820000
         LA    R4,JACT            JOB ACT ADDRESS TO R4.                07840000
         MVC   0(3,R4),TNEXT      DISK ADDR THIS ACT TO ACT.            07860000
         MVI   3(R4),ACTID        ACT IDENT = 1.                        07880000
         LA    R7,QPARM           Q-MANAGER PARAMETER AREA.             07900000
         USING IOPARAMS,R7             LIST ADDRESSING.                 07920000
         L     R6,QMPCL           QMPCA ADDRESS TO R6.                  07940000
         ST    R4,0(R6)           ACT ADDRESS TO QMPCA.                 07960000
         MVC   4(4,R6),TNEXT      TTR TO QMPEX.                         07980000
         L     RF,JAVHQ           IEFVHQ ADDRESS TO R15.                08000000
         SPACE                                                          08020000
         BALR  RE,RF              LINK TO QMANAGER TO WRITE AND ASSIGN. 08040000
         SPACE                                                          08060000
         MVC   JCTACTAD(4),TNEXT  MOVE ACT TTR TO JCT.                  08080000
         MVC   TNEXT(4),0(R6)     REPLACE TTR IN IWA.                   08100000
*   FALL THROUGH TO EXIT.                                               08120000
         SPACE                                                          08140000
*                                                                       08160000
*   EXIT TO IEFVHF.                                                     08180000
*                                                                       08200000
JAEXIT   DS    0H                                                       08220000
         MVI   MSGKEY,DEC0         ZERO SECONDARY MESSAGE        Y02668 08230002
         SPACE                                                          08240000
         L     RF,JAVHE            SET EXIT TO ROUTER.           Y02668 08260002
         SPACE                                                          08280000
         BR    RF                 ***   EXIT   ***                      08300000
         EJECT                                                          08320000
*********************************************************************** 08340000
**                                                                   ** 08360000
**             ERROR ROUTINES.                                       ** 08380000
**                                                                   ** 08400000
*********************************************************************** 08420000
         SPACE                                                          08440000
JAER2    BCTR  R5,0               IEF633I - PROGRAMMER NAME MISSING.    08460000
JAER3    BCTR  R5,0               IEF634I - ACCOUNT NUMBER MISSING.     08480000
JAER4    BCTR  R5,0               IEF635I - JOBNAME MISSING.            08500000
JAER5    BCTR  R5,0               NOT USED BY IEFVJA.                   08520000
JAER6    BCTR  R5,0               IEF637I - ACCT FIELD EXCEEDS MAXIMUM. 08540001
*                                      MSG NBR IS STORED INTO IWA.      08542001
JAER77   STC   R5,MSGSEC          IEF638I - MAX REGION EXCEEDED  Y01029 08550001
         MVI   MSGKEY,JOBK        SET MSGKEY TO JOB KEY.                08580000
         SPACE                                                          08600000
*                                                                       08620000
*   FAIL JOB - ENTER MESSAGE INTO SMB.                                  08640000
*                                                                       08660000
JAERRTN  DS    0H                                                       08680000
         OI    JCTJSTAT,INCMSTS   FAIL JOB.                             08700000
         OI    JCTJMGLV,INCMMGL1  DEFAULT TO MESSAGE LEVEL = 1.         08720000
         SPACE                                                          08740000
         CLI   JCTJNAME,C' '      TEST FOR JOBNAME IN JCT         22297 08746018
         BNE   JAERMSG             YES,GO PUT OUT MESSAGE         22297 08752018
         MVC   JCTJNAME(8),JAERDUM  NO,PUT DUMMY NAME IN JCT      22297 08758018
*                                       THEN GO PUT OUT MESSAGE   22297 08764018
JAERMSG  SR    R2,R2                                              22297 08770018
         IC    R2,MSGSEC          MSG NBR TO R2.                        08780000
         L     RF,JAVGM           IEFVGM ADDRESS TO R15.                08800000
         SPACE                                                          08820000
         BALR  RE,RF              LINK TO MESSAGE MODULE.               08840000
         SPACE                                                          08860000
         B     JAACTCK            GO TO PUT OUT ACT & EXIT.             08880000
         SPACE 2                                                        08900000
JAER1    DS    0H                                                       08920000
         MVI   MSGSEC,JAFORMAT    SET MESSAGE FOR FORMAT ERROR.         08940000
         B     JAERRTN                                                  08960000
         SPACE 3                                                        08962017
JAER7    DS    0H                                                  AACA 08964017
         MVI   MSGSEC,JAMISSIN    IEF646I - REQ POS PARAM MISSING. AACA 08966017
         B     JAERRTN                                             AACA 08968017
         SPACE 3                                                   AACA 08970017
JAER8    DS    0H                                                  AACA 08972017
         MVI   MSGSEC,JALENGTH IEF642I-EXCESSIVE PARAMETER LENGTH  AACA 08974017
         B     JAERRTN                                             AACA 08976017
         SPACE 3                                                        08976603
JAER9    DS    0H                                              @Z40RPTH 08977203
         MVI   MSGSEC,JAALPHA      IEF647I-NON ALPHABETIC      @Z40RPTH 08977803
*                                  FIRST CHARACTER             @Z40RPTH 08978403
         B     JAERRTN                                         @Z40RPTH 08979003
         EJECT                                                          08980000
*********************************************************************** 09000000
**                                                                   ** 09020000
**             TABLES FOR JOB ROUTINE.                               ** 09040000
**                                                                   ** 09060000
*********************************************************************** 09080000
*                                                                       09100000
*   BRANCHING TABLE FOR GET KEY/POS.                                    09120000
*                                                                       09140000
         SPACE                                                          09160000
JABRANCH DS    0H                                                       09180000
JAJOBA   EQU   *                  JOB KEY.                              09200000
         KKK   03,01000000,JAJOB-JABASE,JAJOBB-JABASE                   09220000
JAMSLVA  EQU   *                  MSGLEVEL KEY.                         09240000
         KKK   02,00000000,JAMSLV-JABASE,JAMSLVB-JABASE            I68  09260018
JAMSCLA  EQU   *                  MSGCLASS KEY.                         09280000
         KKK   01,00000000,JAMSCL-JABASE,JAMSCLB-JABASE                 09300000
JATYPA   EQU   *                  TYPRUN KEY.                           09320000
         KKK   FF,00000000,JATYP-JABASE,JATYPB-JABASE          @ZA26751 09340003
JAPRTYA  EQU   *                  PRTY KEY.                             09350003
         KKK   FF,00000000,JAPRTY-JABASE,JAPRTYB-JABASE        @ZA26751 09360003
JACONDA  EQU   *                  COND KEY.                             09400000
         KKK   08,11111111,JACOND-JABASE,JACONDB-JABASE                 09420000
JAREGA   EQU   *                  REGION KEY.                           09440000
         KKK   02,0,JAREG-JABASE,JAREGB-JABASE                     AACA 09444017
JACLASSA EQU   *                  CLASS KEY.                       AACA 09448017
         KKK   01,0,JACLASS-JABASE,JACLASSB-JABASE                 AACA 09452017
JAROLLA  EQU   *                  ROLL KEY.                        AACA 09456017
         KKK   02,0,JAROLL-JABASE,JAROLLB-JABASE                   AACA 09460017
JARDA    EQU   *                  RD KEY.                          AACA 09464017
         KKK   01,0,JARD-JABASE,JARDB-JABASE                       AACA 09468017
JARESTA  EQU   *                  RESTART KEY.                     AACA 09472017
         KKK   02,0,JAREST-JABASE,JARESTB-JABASE                   AACA 09476017
JATIMEA  EQU   *                       TIME KEY               M0444SMF1 09477018
         KKK   02,00000000,JATIME-JABASE,JATIMEB-JABASE       M0444SMF1 09478018
JANOTIFA EQU   *                  NOTIFY KEY                      20001 09478620
         KKK   01,0,JANOTIFY-JABASE,JANOTIFB-JABASE               20001 09479220
JAADDRA  EQU   *                   ADDRSPC KEY                  Y01029  09479701
         KKK   01,0,JAADDR-JABASE,JAADDRB-JABASE                Y01029  09479801
JAPRFMA  EQU   *                        PERFORM KEY              Y02655 09479902
         KKK   01,0,JAPRFM-JABASE,JAPRFMB-JABASE                 Y02655 09480002
JAUSERA  EQU   *                   USER KEY                    @Z40RPTH 09480203
         KKK   01,0,JAUSER-JABASE,JAUSERB-JABASE               @Z40RPTH 09482203
JAPASSA  EQU   *               PASSWORD KEY                    @Z40RPSM 09484203
         KKK   02,0,JAPASS-JABASE,JAPASSB-JABASE               @Z40RPSM 09486203
JAGROUPA EQU *                GROUP KEYWORD.                   @Z40RPSM 09488203
         KKK   01,0,JAGROUP-JABASE,JAGROUPB-JABASE             @Z40RPSM 09490203
         EJECT                                                          09492203
*                                                                       09500000
*   PARAMETER DESCRIPTER TABLE FOR TEST AND STORE (PDT).                09520000
*                                                                       09540000
         SPACE                                                          09560000
JAJOBB   EQU   *                  JOB PDT.                              09580000
         DC    FL1'17'            LENGTH OF PDT FOR JOB.                09600000
*   JOBNAME                                                             09620000
         CCC   8,50                                                     09640000
         MMM   8,61,JCTJNAME-INJMJCT                                    09660000
         BBC   40,JASW1-JAWORK,FF-JANOJBNM                              09680000
*   PROGRAMMER NAME.                                                    09700000
         CCC   8,50                                                     09720000
         MMM   20,53,ACTPRGNM-ACTDSKAD                                  09740000
         BBC   40,JASW1-JAWORK,FF-JANOPGNM-JAACTPUT                     09760000
         SPACE                                                          09780000
JATYPB   EQU   *                  TYPRUN PDT.                  @ZA26751 09800003
*              DUMMY PDT SINCE TYPRUN IS A SUBSYSTEM RATHER    @ZA26751 09840003
*              THAN A CONTROL PROGRAM KEYWORD                  @ZA26751 09880003
         SPACE                                                          09960000
JAMSLVB  EQU   *                  MSGLEVEL PDT.                         09980000
         DC    AL1(MSLENDX-JAMSLVB)     LENGTH OF MSGLEVEL PDT     I68  09983018
JAMSLVC  DC    AL1(JAMSLVD-JAMSLVC)     LENGTH OF FIRST POSITIONAL PDT  09986018
*   TWO        JCL LEVEL                                           I68  09989018
         SSS   31,2                                                I68  09992018
         BBC   01,JCTJMGLV-INJMJCT,INCMMGL2                        I68  09995018
*   ONE                                                                 10040000
         SSS   31,1                                                     10060000
         BBC   01,JCTJMGLV-INJMJCT,INCMMGL1                             10080000
*   ZERO                                                                10100000
         SSS   01,0                                                     10120000
JAMSLVD  DC    AL1(MSLENDX-JAMSLVD)     LENGTH OF SECOND POSITIONAL PDT 10122018
*   ONE        ALLOCATION LEVEL                                    I68  10124018
         SSS   31,1                                                I68  10126018
         BBC   01,JCTJMGLV-INJMJCT,INCMALL                         I68  10128018
*   ZERO                                                           I68  10130018
         SSS   01,0                                                I68  10132018
MSLENDX  EQU   *                                                   I68  10134018
         SPACE                                                          10140000
JAMSCLB  EQU   *                  MSGCLASS PDT.                         10160000
         DC    FL1'7'             LENGTH OF MSGCLASS PDT.               10180000
         CCC   6,30                                                     10200000
         DC    FL1'1'             MAX PARAMETER LENGTH.                 10220000
         DC    XL1'70'            FUNCT/TABLE.                          10240000
         DC    XL1'51'            FUNCT/TABLE.                          10260000
         DC    AL1(JCTJMGPO-INJMJCT)   OFFSET IN TABLE.                 10280000
         SPACE                                                          10300000
JAPRTYB  EQU   *                  PRTY PDT.                    @ZA26751 10320003
*              DUMMY PDT SINCE PRTY IS A SUBSYSTEM RATHER      @ZA26751 10340003
*              THAN A CONTROL PROGRAM KEYWORD.                 @ZA26751 10360003
JATIMEB  EQU   *                       TIME PDT                    SMF1 10402018
         DC    FL1'17'                 LENGTH OF TIME PDT          SMF1 10404018
         CCC   8,50                                                     10406018
         MMM   4,31,JCTJMRSS+2-INJMJCT                                  10408018
         DC    FL3'1440'               MAXIMUM NUMBER OF MINUTES   SMF1 10410018
         CCC   8,50                                                     10412018
         MMM   2,31,JCTJMRSS+6-INJMJCT                                  10414018
         DC    FL3'59'                 MAXIMUM NUMBER OF SECONDS   SMF1 10416018
JANOTIFB EQU   *                  JUST LABEL FOR NOTIFY PDT    @Z40RPTH 10416303
*                                 NO FUNCTIONAL PDT            @Z40RPTH 10417303
         SPACE                                                          10420000
JACONDB  EQU   *                  COND PDT.                             10440000
         DC    FL1'45'            LENGTH OF COND PDT.                   10460000
*   CODE.                                                               10480000
         CCC   7,40                                                     10500000
         DC    FL1'4'             MAXIMUM PARAMETER LENGTH.             10520000
         DDD   20,JATEMP1-JAWORK,2,4095                                 10540000
         DC    FL1'37'            LENGTH THIS POSITIONAL PDT.           10560000
*   OPERATORS.                                                          10580000
*   GT                                                                  10600000
         SSS   32,GT                                                    10620000
         BBB   00,JATEMP2-JAWORK,20                                     10640000
*   GE                                                                  10660000
         SSS   32,GE                                                    10680000
         BBB   00,JATEMP2-JAWORK,B0                                     10700000
*   EQ                                                                  10720000
         SSS   32,EQ                                                    10740000
         BBB   00,JATEMP2-JAWORK,80                                     10760000
*   NE                                                                  10780000
         SSS   32,NE                                                    10800000
         BBB   00,JATEMP2-JAWORK,70                                     10820000
*   LE                                                                  10840000
         SSS   32,LE                                                    10860000
         BBB   00,JATEMP2-JAWORK,D0                                     10880000
*   LT                                                                  10900000
         SSS   32,LT                                                    10920000
         BBB   00,JATEMP2-JAWORK,40                                     10940000
         SPACE                                                          10960000
JAREGB   EQU   *                  REGION PDT.                           10980000
         DC    AL1(JAEND7-JAREGB)       LENGTH OF REGION PDT.      AACA 11000017
         CCC   07,40                                            YM00395 11020002
         DC    FL1'5'             MAXIMUM PARAMETER LENGTH.             11040000
         DC    XL1'21' FUNCT/TABLE.                                     11060000
         DC    AL1(JAREGOFF) OFFSET IN TABLE.                           11080000
         DC    XL2'3FFF'          MAX REGION SEZE.                 AACA 11080817
JAST7    EQU   *                                                   AACA 11082417
         DC    AL1(JAEND7-JAST7)  LENGTH LCS PDT.                  AACA 11083217
         DC    XL1'40'            CONTROL/COMPARE.                 AACA 11084017
         DC    FL1'5'             MAX PARAMETER LENGTH.            AACA 11084817
         DC    XL1'20'            CVB (2)/ JWA.                    AACA 11085617
         DC    AL1(JATEMP1-JAWORK)      OFFSET.                    AACA 11086417
         DC    XL2'3FFF'          MAX   LCS SIZE.                  AACA 11087217
JAEND7   EQU   *                                                   AACA 11088017
         SPACE                                                          11088817
JAROLLB  EQU   *                  ROLL PDT                       Y01029 11090801
         DC    AL1(JAEND2-JAROLLB)                                      11098801
JAEND2   EQU   *                                                   AACA 11101617
JACLASSB EQU   *                  CLASS PDT.                       AACA 11102417
         DC    AL1(JAEND3-JACLASSB)    LENGTH OF CLASS PDT.        AACA 11103217
JAST3    EQU   *                                                   AACA 11104017
         DC    AL1(JAEND3-JAST3)       LENGTH OF 1ST POS PARAM.    AACA 11104817
         DC    XL1'10'                 CONTROL/COMPARE             AACA 11105617
         DC    XL1'01'                 MAX PARAMETER LENGTH.       AACA 11106417
         DC    XL1'70'                 CHECK FOR ALPHA/NUMERIC.    AACA 11107217
JAEND3   EQU   *                                                   AACA 11108017
         SPACE                                                          11108817
JARDB    EQU   *                  RD PDT.                          AACA 11109617
         DC    AL1(JAEND4-JARDB)                                   AACA 11110417
JAST4    EQU   *                                                   AACA 11111217
         DC    AL1(JAEND4-JAST4)                                   AACA 11112017
         SSS   31,R                                                AACA 11112817
         BBC   01,JCTRSW2-INJMJCT,JCTRESTT                       Y02668 11113602
         SSS   32,NR                                               AACA 11114417
         BBC   01,JCTRSW2-INJMJCT,JCTNORST                       Y02668 11115202
         SSS   32,NC                                               AACA 11116017
         BBC   01,JCTRSW2-INJMJCT,JCTNOCKP                       Y02668 11116802
         SSS   63,RNC                                              AACA 11117617
         BBC   01,JCTRSW2-INJMJCT,JCTRESTT                       Y02668 11118402
         BBC   01,JCTRSW2-INJMJCT,JCTNOCKP                       Y02668 11119202
JAEND4   EQU   *                                                   AACA 11120017
         SPACE                                                          11120817
JARESTB  EQU   *                  RESTART PDT.                     AACA 11121617
         DC    AL1(JAEND6-JARESTB)     LENGTH TOTAL PDT.           AACA 11122417
JAST5    EQU   *                                                   AACA 11123217
         DC    AL1(JAEND5-JAST5)       LENGTH 1ST PARAM PDT.       AACA 11124017
         DC    XL1'20'            CTRL BYTES/COMPARE BYTES         AACA 11124817
         MMM   17,60,SRCHL1-JAWORK                                 AACA 11125617
JAEND5   EQU   *                                                   AACA 11126417
JAST6    EQU   *                                                   AACA 11127217
         DC    AL1(JAEND6-JAST6)       LENGTH CHKID PDT.           AACA 11128017
         DC    XL1'20'            CTRL BYTES/COMPARE BYTES         AACA 11128817
         MMM   16,51,JCTCKIDT-INJMJCT                            A43678 11129601
JAEND6   EQU   *                                                 Y01029 11130401
JAADDRB  EQU   *                         ADDRSPC PDT             Y01029 11132401
         DC   AL1(JAEND8-JAADDRB)        LENGTH ADDRSPC PDT      Y01029 11134401
JAST1A   EQU   *                                                 Y01029 11136501
         DC   AL1(JAEND8-JAST1A)         LENGTH POSITIONAL PDT   Y01029 11138401
         SSS   34,REAL                                          YM00395 11138802
         BBC  01,JCTSTAT2-INJMJCT,JCTADSPC                       Y01029 11139201
         SSS   04,VIRT                                          YM00395 11139602
JAEND8   EQU   *                                                 Y01029 11139901
JAPRFMB  EQU   *                        PERFORM PDT              Y02655 11140002
         DC    AL1(JAEND9-JAPRFMB)      LENGTH PERFORM PDT       Y02655 11142002
JAST9    EQU   *                                                 Y02655 11144002
         DC    AL1(JAEND9-JAST9)        LENGTH POSITIONAL PDT    Y02655 11146002
         DC    XL1'30'            CONTROL BYTE                   Y02655 11148002
         DC    FL1'3'             MAX PARAMETER LENGTH           Y02655 11150002
         DC    XL1'11'            FUNCTION/TABLE                 Y02655 11152002
         DC    AL1(JCTPRFMF-INJMJCT) OFFSET IN TABLE             Y02655 11154002
         DC    XL1'FF'            MAX NBR (CVB)                  Y02655 11156002
JAEND9   EQU   *                                                 Y02655 11158002
JAUSERB  EQU   *                   USER PDT                    @Z40RPTH 11158103
         DC    AL1(JAUSER3-JAUSERB) LENGTH OF ENTRY            @Z40RPTH 11158203
JAUSER1  DS    0C                  START OF POSITION           @Z40RPTH 11158303
         DC    AL1(JAUSER3-JAUSER1) LENGTH OF POSITION         @Z40RPTH 11158403
         DC    XL1'20'           CONTROL BYTE                  @Z40RPTH 11158503
JAUSER2  DS    0C                  START OF CONTROL BYTES      @Z40RPTH 11158603
         MMM   7,61,JCTUSER-INJMJCT                            @Z40RPTH 11158703
JAUSER3  DS    0C                  END OF ENTRY                @Z40RPTH 11158803
         SPACE 2                                               @Z40RPTH 11158903
JAPASSB  EQU   *                   JUST LABEL FOR PASSWORD     @Z40RPSM 11159003
*                                  NO FUNCTIONAL PDT           @Z40RPSM 11159103
JAGROUPB EQU   *                   GROUP PDT.                  @Z40RPSM 11159203
         DC AL1(JAGROUP3-JAGROUPB) LENGTH OF ENTRY.            @Z40RPSM 11159303
JAGROUP1 DS    0C                  START OF POSITION.          @Z40RPSM 11159403
         DC AL1(JAGROUP3-JAGROUP1) LENGTH OF POSITION.         @Z40RPSM 11159503
         DC XL1'20'                CONTROL BYTE.               @Z40RPSM 11159603
JAGROUP2 DS   0C                   START OF CONTROL BYTE.      @Z40RPSM 11159703
         MMM  8,6D,JCTXGROP-JCTXIN                             @Z40RPSM 11159803
JAGROUP3 DS   0C                   END OF ENTRY.               @Z40RPSM 11159903
*********************************************************************** 11160000
*                                                                     * 11180000
*              CONSTANTS                                              * 11200000
*                                                                     * 11220000
*********************************************************************** 11240000
FILLER   DS    0F                                                Y01029 11246401
MAXVAL   DC    XL4'00003FFF'           MAX REGION VALUE          Y01029 11249201
JA100    DC    H'100'                  CONVERSION OF SECS TO       SMF1 11252001
*                                           100THS SECS.           SMF1 11254801
JA6000   DC    H'6000'                 CONVERSION OF MINS TO       SMF1 11257601
*                                           100THS SECS            SMF1 11260401
JACON0   DC    H'0'                HALFWORD ZERO CONSTANT.      YM00376 11260902
DEC0     EQU   0                       NUMERIC EQUATE            Y02668 11261402
DEC3     EQU   3                       NUMERIC EQUATE                   11263201
DEC1     EQU   1                       NUMERIC EQUATE                   11266001
DEC8     EQU   8                       NUMERIC EQUATE                   11268801
DEC4     EQU   4                       NUMERIC EQUATE                   11271601
DEC5     EQU   5                       NUMERIC EQUATE                   11274401
EIGHT    EQU   8              MAXIMUM LENGTH OF PASSWORD       @Z40RPSM 11275103
SEVEN    EQU   7              MAXIMUM LENGTH OF NOTIFY ID      @Z40RPTH 11275803
E9       EQU   C'Z'           LETTER Z                         @Z40RPTH 11276503
JATESTOR DC    V(IEFVGT)          TEST AND STORE.                       11277201
JAGETKEP DC    V(IEFVGK)          GET KEY/POS.                          11280000
JAVHQ    DC    V(IEFVHQ)          QMANAGER INTERFACE.                   11300000
JAVGM    DC   V(IEFVGM)           MESSAGE MODULE.                       11320000
JAVHE    DC    V(IEFVHE)           CONTROL ROUTINE.              Y02668 11340002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 11345002
JAERDUM  DC    C'JOBFAIL '                                        22297 11350018
JAMSK1   DC    F'8'               MASK FOR COND SUBPARM CHECK.          11360000
JA144    DC    F'144'                                                   11380000
JA1      DC    F'1'                                                     11400000
         END                                                            11420000
./  ADD  SSI=30872094,NAME=IEZDCODE
         TITLE 'DECOMPRESSION MODULE IEZDCODE'                          00300019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00600019
*                                                                       00900019
*                                      DECOMPRESSION SUBROUTINE         01200019
*                                                                       01500019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01800019
*                                                                       02100019
*        STATUS                                                         02400019
*                                                                       02700019
*              CHANGE LEVEL ZERO                                        03000019
*              RELEASE NINETEEN                                         03300019
*                                                                       03600019
*        FUNCTION                                                       03900019
*                                                                       04200019
*              CHARACTER STRING DECOMPRESSION                           04500019
*              REPLACING COUNT FIELDS WITH SERIES OF BLANKS             04800019
*              REVERSING COMPRESSION BY IEZNCODE                        05100019
*                                                                       05400019
*              DEBLOCKS COMPRESSED RECORDS                              05700019
*              BY UPDATING PARAMETER AREA                               06000019
*                                                                       06300019
*              SETS IEZTYPE TO X'80'                                    06600019
*              IF COMPRESSED RECORD IS FLAGGED                          06900019
*              X'00' IF NOT                                             07200019
*                                                                       07500019
*        ENTRY POINTS                                                   07800019
*                                                                       08100019
*              IEZDCODE                                                 08400019
*                                                                       08700019
*        INPUT                                                          09000019
*                                                                       09300019
*              REGISTER 13 ADDRESSES SAVE AREA                          09600019
*              REGISTER 14 ADDRESSES RETURN POINT                       09900019
*              REGISTER 1 ADDRESSES POINTER TO PARAMETER AREA           10200019
*                                                                       10500019
*        OUTPUT                                                         10800019
*                                                                       11100019
*              REGISTER 15 CONTAINS RETURN CODE                         11400019
*              OTHER REGISTERS ARE RESTORED                             11700019
*                                                                       12000019
*        EXTERNAL REFERENCES                                            12300019
*                                                                       12600019
*              READS AND SCRATCHES COMPRESSED RECORD                    12900019
*              ADDRESSED BY IEZCOMPR                                    13200019
*              WITH LENGTH CONTAINED THEREIN                            13500019
*                                                                       13800019
*              WRITES UNCOMPRESSED RECORD                               14100019
*              ADDRESSED BY IEZUNCOM                                    14400019
*              WITH LENGTH NOT EXCEEDING IEZOUT                         14700019
*                                                                       15000019
*              READS IEZUNCOM, IEZOUT AND IEZCHAR                       15300019
*              UPDATES IEZCOMPR                                         15600019
*              WRITES IEZTYPE                                           15900019
*              SCRATCHES IEZRES                                         16200019
*                                                                       16500019
*        NORMAL EXITS                                                   16800019
*                                                                       17100019
*              RETURN CODE ZERO MEANS TRANSLATION COMPLETED             17400019
*              FOR ONE RECORD                                           17700019
*                                                                       18000019
*              RETURN CODE FOUR MEANS END OF BLOCK TERMINATION          18300019
*              WITH NO RECORD TRANSLATED                                18600019
*                                                                       18900019
*        ABNORMAL EXITS                                                 19200019
*                                                                       19500019
*              RETURN CODE EIGHT MEANS ERROR TERMINATION                19800019
*              BECAUSE UNCOMPRESSED RECORD WOULD BE LONGER THAN IEZOUT  20100019
*                                                                       20400019
*              ERROR DETECTING INSTRUCTIONS ARE FLAGGED                 20700019
*              WITH ASTERISK BEGINNING REMARK                           21000019
*                                                                       21300019
*        TABLES AND WORK AREAS                                          21600019
*                                                                       21900019
*              PARAMETER AREA BELOW                                     22200019
*                                                                       22500019
*        ATTRIBUTES                                                     22800019
*                                                                       23100019
*              REFRESHABLE                                              23400019
*                                                                       23700019
*        NOTES                                                          24000019
*                                                                       24300019
*              OPERATION CHARACTER-CODE INDEPENDENT                     24600019
*                                                                       24900019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 25200019
*                                                                       25500019
*                                      COMPRESSION FORMAT               25800019
*                                                                       26100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 26400019
*                                                                       26700019
*        BLOCK                                                          27000019
*                                                                       27300019
*              COMPRESSED RECORDS      SEE BELOW                        27600019
*              END OF BLOCK MARK       2 BYTES OF ZERO                  27900019
*                                                                       28200019
*        COMPRESSED RECORD                                              28500019
*                                                                       28800019
*              SPECIAL RECORD FLAG     1 BIT                            29100019
*              COMPR RECORD LENGTH     15 BITS                          29400019
*              SEGMENTS                SEE BELOW                        29700019
*                                                                       30000019
*        SEGMENT                                                        30300019
*                                                                       30600019
*              MERGED COUNTS FLAG      1 BIT                            30900019
*              BLANK CHAR COUNT        3 (FLAG ON) OR 7 (FLAG OFF) BITS 31200019
*              NONBLANK CHAR COUNT     4 (FLAG ON) OR 8 (FLAG OFF) BITS 31500019
*              NONBLANK CHARS          1 BYTE EACH                      31800019
*                                                                       32100019
*                                      AN UNCOMPRESSED SEGMENT          32400019
*                                      IS A SERIES OF NONBLANKS         32700019
*                                      FOLLOWED BY A SERIES OF BLANKS   33000019
*                                      EITHER SERIES POSSIBLY EMPTY     33300019
*                                                                       33600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 33900019
*                                                                       34200019
*                                      PARAMETER AREA                   34500019
*                                                                       34800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 35100019
*                                                                       35400019
IEZPARM  DSECT                         PARAMETER AREA                   35700019
IEZUNCOM DS    A                       PTR TO UNCOMPRESSED RECORD       36000019
IEZCOMPR DS    A                       PTR TO NEXT COMPRESSED RECORD    36300019
IEZLEN   DS    H                       LENGTH OF UNCOMPRESSED RECORD    36600019
IEZOUT   DS    H                       LENGTH OF AREA FOR OUTPUT RECORD 36900019
IEZCHAR  DS    C                       CHARACTER CODE OF BLANK          37200019
IEZTYPE  DS    B                       FLAG ASSOCIATED WITH RECORD      37500019
IEZRES   DS    H                       WORK AREA                        37800019
*                                                                       38100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 38400019
*                                                                       38700019
*                                      GENERAL REGISTERS                39000019
*                                                                       39300019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 39600019
*                                                                       39900019
BASE     EQU   11                      CODE BASE                        40200019
DATA     EQU   12                      DATA BASE                        40500019
SAVE     EQU   13                      SAVE AREA                        40800019
BACK     EQU   14                      RETURN POINT                     41100019
CODE     EQU   15                      RETURN CODE                      41400019
WORK     EQU   0                       WORK REGISTER                    41700019
PASS     EQU   1                       PARAMETER LIST                   42000019
*                                                                       42300019
UNCOM    EQU   2                       INDEX THROUGH TARGET RECORD      42600019
COMPR    EQU   3                       INDEX THROUGH SOURCE RECORD      42900019
MAXUNCOM EQU   4                       * END OF TARGET RECORD           43200019
MAXCOMPR EQU   5                       END OF SOURCE RECORD             43500019
BLANKS   EQU   6                       COUNT OF BLANKS IN SEGMENT       43800019
CHARS    EQU   7                       COUNT OF CHARS IN SEGMENT        44100019
RETAIN   EQU   X'80'                   RETAIN COUNT FLAG        A46304  44150001
DISPL0   EQU   0                       ZERO OFFSET              A46304  44200001
*                                                                       44400019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 44700019
*                                                                       45000019
*                                      BEGIN MODULE                     45300019
*                                                                       45600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 45900019
*                                                                       46200019
IEZDCODE CSECT                         BEGIN MODULE                     46500019
*                                                                       46800019
         STM   BACK,DATA,12(SAVE)      SAVE REGISTERS                   47100002
         BALR  BASE,0                  ADDRESS CODE                     47400019
         USING *,BASE                  CODE ADDRESSABILITY              47700019
**************************************************************** Y02668 47705002
* MODULE TRACE CODE - FOR TESTING                                Y02668 47710002
         L     15,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 47715002
         BALR  14,15               ENTER MOD ID IN TRACE RECORD. Y02668 47720002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 47725002
         DC    C'DCOD'             MOD ID USED BY TRACE          Y02668 47730002
* TRACE RETURNS HERE.                                            Y02668 47735002
**************************************************************** Y02668 47740002
         B     D1                  BYPASS ID                     Y02668 47745002
         MODID BR=NO                                             Y02668 47750002
         DC    C'MVM'              FUNCTION ID AND               Y02668 47810002
         DC    C'01'               LEVEL # (TRACE + PATCH)       Y02668 47870002
D1       DS    0H                  BEGIN                         Y02668 47930002
         L     DATA,0(PASS)            ADDRESS DATA                     48000019
         USING IEZPARM,DATA            DATA ADDRESSABILITY              48300019
         LA    WORK,1                  CONSTANT REGISTER                48600019
         LA    CODE,2                  CONSTANT AND FLAG REGISTER       48900019
         LM    UNCOM,COMPR,IEZPARM     LOAD SOURCE AND TARGET POINTERS  49200019
*                                                                       49500019
         TM    0(COMPR),X'80'          IF RECORD FLAGGED                49800019
         BO    ON                      THEN PROCESS FLAG                50100019
*                                                                       50400019
         MVI   IEZTYPE,X'00'           WRITE FLAG OFF                   50700019
*                                                                       51000019
         B     OFF                     CONTINUE PROCESSING              51300019
*                                                                       51600019
ON       DS    0H                      RECORD FLAGGED                   51900019
*                                                                       52200019
         MVI   IEZTYPE,X'80'           WRITE FLAG ON                    52500019
         NI    0(COMPR),X'FF'-X'80'    TURN FLAG OFF                    52800019
*                                                                       53100019
OFF      DS    0H                      RECORD FLAG PROCESSED            53400019
*                                                                       53700019
         MVC   IEZRES,0(COMPR)         MOVE SOURCE LENGTH               54000019
         LH    MAXCOMPR,IEZRES         LOAD SOURCE LENGTH               54300019
*                                                                       54600019
         LTR   MAXCOMPR,MAXCOMPR       IF SOURCE LENGTH ZERO            54900019
         BZ    BLOCK                   THEN END OF BLOCK                55200019
*                                                                       55500019
         AR    MAXCOMPR,COMPR          COMPUTE SOURCE LIMIT             55800019
         LR    MAXUNCOM,UNCOM          * PREPARE TARGET LIMIT           56100019
         AH    MAXUNCOM,IEZOUT         * COMPUTE TARGET LIMIT           56400019
         AR    COMPR,CODE              ADDRESS FIRST SEGMENT            56700019
*                                                                       57000019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57300019
*                                                                       57600019
*                                      BEGIN SEGMENT                    57900019
*                                                                       58200019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 58500019
*                                                                       58800019
SEGMENT  DS    0H                      DECOMPRESS SEGMENT               59100019
*                                                                       59400019
         SR    BLANKS,BLANKS           ZERO BLANK COUNT                 59700019
         SR    CHARS,CHARS             ZERO NONBLANK COUNT              60000019
*                                                                       60300019
         TM    0(COMPR),X'80'          IF COUNTS FLAGGED                60600019
         BO    SHORT                   THEN UNMERGE COUNTS              60900019
*                                                                       61200019
         IC    BLANKS,0(COMPR)         LOAD BLANK COUNT                 61500019
         IC    CHARS,1(COMPR)          LOAD NONBLANK COUNT              61800019
         AR    COMPR,CODE              BUMP SOURCE POINTER              62100019
*                                                                       62400019
         B     LONG                    CONTINUE PROCESSING              62700019
*                                                                       63000019
SHORT    DS    0H                      UNMERGE COUNTS                   63300019
*                                                                       63600019
         NI    0(COMPR),X'FF'-X'80'    TURN COUNT FLAG OFF              63900019
         IC    CHARS,0(COMPR)          PREPARE COUNTS                   64200019
         SLDL  BLANKS,32-4             UNMERGE BLANK COUNT              64500019
         SRL   CHARS,32-4              UNMERGE NONBLANK COUNT           64800019
         OI    DISPL0(COMPR),RETAIN    SET RETAIN COUNT FLAG    A46304  64850001
         AR    COMPR,WORK              BUMP SOURCE POINTER              65100019
*                                                                       65400019
LONG     DS    0H                      COUNTS LOADED                    65700019
*                                                                       66000019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 66300019
*                                                                       66600019
*                                      TRANSLATE NONBLANKS              66900019
*                                                                       67200019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 67500019
*                                                                       67800019
         LTR   CHARS,CHARS             IF NO NONBLANKS                  68100019
         BZ    NOCHAR                  THEN DECOMPRESS NONE             68400019
*                                                                       68700019
CHAR     DS    0H                      DECOMPRESS NONBLANK              69000019
*                                                                       69300019
         CR    UNCOM,MAXUNCOM          * IF TARGET FULL                 69600019
         BNL   ERROR                   * THEN ERROR                     69900019
*                                                                       70200019
         MVC   0(1,UNCOM),0(COMPR)     DECOMPRESS NONBLANK              70500019
         AR    COMPR,WORK              BUMP SOURCE POINTER              70800019
         AR    UNCOM,WORK              BUMP TARGET POINTER              71100019
*                                                                       71400019
         BCT   CHARS,CHAR              NEXT NONBLANK IF ANY             71700019
*                                                                       72000019
NOCHAR   DS    0H                      NONBLANKS DECOMPRESSED           72300019
*                                                                       72600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 72900019
*                                                                       73200019
*                                      TRANSLATE BLANKS                 73500019
*                                                                       73800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 74100019
*                                                                       74400019
         LTR   BLANKS,BLANKS           IF NO BLANKS                     74700019
         BZ    NOBLANK                 THEN DECOMPRESS NONE             75000019
*                                                                       75300019
BLANK    DS    0H                      DECOMPRESS BLANK                 75600019
*                                                                       75900019
         CR    UNCOM,MAXUNCOM          * IF TARGET FULL                 76200019
         BNL   ERROR                   * THEN ERROR                     76500019
*                                                                       76800019
         MVC   0(1,UNCOM),IEZCHAR      DECOMPRESS BLANK                 77100019
         AR    UNCOM,WORK              BUMP TARGET POINTER              77400019
*                                                                       77700019
         BCT   BLANKS,BLANK            NEXT BLANK IF ANY                78000019
*                                                                       78300019
NOBLANK  DS    0H                      BLANKS DECOMPRESSED              78600019
*                                                                       78900019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 79200019
*                                                                       79500019
*                                      END SEGMENT                      79800019
*                                                                       80100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 80400019
*                                                                       80700019
         CR    COMPR,MAXCOMPR          IF SOURCE NOT FINISHED           81000019
         BL    SEGMENT                 THEN DECOMPRESS NEXT SEGMENT     81300019
*                                                                       81600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 81900019
*                                                                       82200019
*                                      END MODULE                       82500019
*                                                                       82800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 83100019
*                                                                       83400019
         ST    COMPR,IEZCOMPR          UPDATE SOURCE POINTER            83700019
         S     UNCOM,IEZUNCOM          COMPUTE TARGET LENGTH            84000019
         STH   UNCOM,IEZLEN            WRITE TARGET LENGTH              84300019
         SR    CODE,CODE               RETURN TRANSLATION COMPLETE CODE 84600019
*                                                                       84900019
RETURN   DS    0H                      EXIT MODULE                      85200019
*                                                                       85500019
         L     BACK,12(SAVE)           RESTORE 14                Y02668 85600002
         LM    WORK,DATA,20(SAVE)      RESTORE REGISTERS         Y02668 85800002
*                                                                       86100019
         BR    BACK                    RETURN CONTROL                   86400019
*                                                                       86700019
BLOCK    DS    0H                      END OF BLOCK                     87000019
*                                                                       87300019
         AR    CODE,CODE               RETURN END OF BLOCK CODE         87600019
*                                                                       87900019
         B     RETURN                  EXIT MODULE                      88200019
*                                                                       88500019
ERROR    DS    0H                      * ERROR DETECTED                 88800019
*                                                                       89100019
         LA    CODE,8                  * RETURN ERROR CODE              89400019
*                                                                       89700019
         B     RETURN                  * EXIT MODULE                    90000019
*                                                                       90300019
PATCH    DC    25F'0'              PATCH SPACE                   Y02668 90400002
         END   IEZDCODE                                                 90600001
./  ADD  SSI=30872097,NAME=IEZNCODE
         TITLE 'COMPRESSION MODULE IEZNCODE'                            00300019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00600019
*                                                                       00900019
*                                      COMPRESSION SUBROUTINE           01200019
*                                                                       01500019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01800019
*                                                                       02100019
*        STATUS                                                         02400019
*                                                                       02700019
*              CHANGE LEVEL ZERO                                        03000019
*              RELEASE NINETEEN                                         03300019
*                                                                       03600019
*        FUNCTION                                                       03900019
*                                                                       04200019
*              CHARACTER STRING COMPRESSION                             04500019
*              REPLACING SERIES OF BLANKS WITH COUNT FIELDS             04800019
*              FOR DECOMPRESSION BY IEZDCODE                            05100019
*                                                                       05400019
*              BLOCKS COMPRESSED RECORDS                                05700019
*              BY UPDATING PARAMETER AREA                               06000019
*                                                                       06300019
*              FLAGS COMPRESSED RECORD                                  06600019
*              IF IEZTYPE IS X'80'                                      06900019
*              NOT IF X'00'                                             07200019
*                                                                       07500019
*        ENTRY POINTS                                                   07800019
*                                                                       08100019
*              IEZNCODE                                                 08400019
*                                                                       08700019
*        INPUT                                                          09000019
*                                                                       09300019
*              REGISTER 13 ADDRESSES SAVE AREA                          09600019
*              REGISTER 14 ADDRESSES RETURN POINT                       09900019
*              REGISTER 1 ADDRESSES POINTER TO PARAMETER AREA           10200019
*                                                                       10500019
*        OUTPUT                                                         10800019
*                                                                       11100019
*              REGISTER 15 CONTAINS RETURN CODE                         11400019
*              OTHER REGISTERS ARE RESTORED                             11700019
*                                                                       12000019
*        EXTERNAL REFERENCES                                            12300019
*                                                                       12600019
*              READS UNCOMPRESSED RECORD                                12900019
*              ADDRESSED BY IEZUNCOM                                    13200019
*              WITH LENGTH IEZLEN                                       13500019
*                                                                       13800019
*              WRITES COMPRESSED RECORD                                 14100019
*              ADDRESSED BY IEZCOMPR                                    14400019
*              WITH LENGTH NOT EXCEEDING IEZOUT                         14700019
*                                                                       15000019
*              READS IEZUNCOM, IEZLEN, IEZCHAR AND IEZTYPE              15300019
*              UPDATES IEZCOMPR AND IEZOUT                              15600019
*              SCRATCHES IEZRES                                         15900019
*                                                                       16200019
*        NORMAL EXITS                                                   16500019
*                                                                       16800019
*              RETURN CODE ZERO MEANS TRANSLATION COMPLETED             17100019
*              FOR ONE RECORD                                           17400019
*                                                                       17700019
*              RETURN CODE FOUR MEANS END OF BLOCK TERMINATION          18000019
*              WITH NO RECORD TRANSLATED                                18300019
*                                                                       18600019
*        ABNORMAL EXITS                                                 18900019
*                                                                       19200019
*              NONE                                                     19500019
*                                                                       19800019
*        TABLES AND WORK AREAS                                          20100019
*                                                                       20400019
*              PARAMETER AREA BELOW                                     20700019
*                                                                       21000019
*        ATTRIBUTES                                                     21300019
*                                                                       21600019
*              REFRESHABLE                                              21900019
*                                                                       22200019
*        NOTES                                                          22500019
*                                                                       22800019
*              OPERATION CHARACTER-CODE INDEPENDENT                     23100019
*                                                                       23400019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 23700019
*                                                                       24000019
*                                      COMPRESSION FORMAT               24300019
*                                                                       24600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 24900019
*                                                                       25200019
*        BLOCK                                                          25500019
*                                                                       25800019
*              COMPRESSED RECORDS      SEE BELOW                        26100019
*              END OF BLOCK MARK       2 BYTES OF ZERO                  26400019
*                                                                       26700019
*        COMPRESSED RECORD                                              27000019
*                                                                       27300019
*              SPECIAL RECORD FLAG     1 BIT                            27600019
*              COMPR RECORD LENGTH     15 BITS                          27900019
*              SEGMENTS                SEE BELOW                        28200019
*                                                                       28500019
*        SEGMENT                                                        28800019
*                                                                       29100019
*              MERGED COUNTS FLAG      1 BIT                            29400019
*              BLANK CHAR COUNT        3 (FLAG ON) OR 7 (FLAG OFF) BITS 29700019
*              NONBLANK CHAR COUNT     4 (FLAG ON) OR 8 (FLAG OFF) BITS 30000019
*              NONBLANK CHARS          1 BYTE EACH                      30300019
*                                                                       30600019
*                                      AN UNCOMPRESSED SEGMENT          30900019
*                                      IS A SERIES OF NONBLANKS         31200019
*                                      FOLLOWED BY A SERIES OF BLANKS   31500019
*                                      EITHER SERIES POSSIBLY EMPTY     31800019
*                                                                       32100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 32400019
*                                                                       32700019
*                                      PARAMETER AREA                   33000019
*                                                                       33300019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 33600019
*                                                                       33900019
IEZPARM  DSECT                         PARAMETER AREA                   34200019
IEZUNCOM DS    A                       PTR TO UNCOMPRESSED RECORD       34500019
IEZCOMPR DS    A                       PTR TO NEXT COMPRESSED RECORD    34800019
IEZLEN   DS    H                       LENGTH OF UNCOMPRESSED RECORD    35100019
IEZOUT   DS    H                       LENGTH OF AREA FOR OUTPUT RECORD 35400019
IEZCHAR  DS    C                       CHARACTER CODE OF BLANK          35700019
IEZTYPE  DS    B                       FLAG ASSOCIATED WITH RECORD      36000019
IEZRES   DS    H                       WORK AREA                        36300019
*                                                                       36600019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 36900019
*                                                                       37200019
*                                      GENERAL REGISTERS                37500019
*                                                                       37800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 38100019
*                                                                       38400019
BASE     EQU   11                      CODE BASE                        38700019
DATA     EQU   12                      DATA BASE                        39000019
SAVE     EQU   13                      SAVE AREA                        39300019
BACK     EQU   14                      RETURN POINT                     39600019
CODE     EQU   15                      RETURN CODE                      39900019
WORK     EQU   0                       WORK REGISTER                    40200019
PASS     EQU   1                       PARAMETER LIST                   40500019
*                                                                       40800019
UNCOM    EQU   2                       INDEX THROUGH SOURCE RECORD      41100019
COMPR    EQU   3                       INDEX THROUGH TARGET RECORD      41400019
MAXUNCOM EQU   4                       END OF SOURCE RECORD             41700019
MAXCOMPR EQU   5                       END OF TARGET RECORD             42000019
BLANKS   EQU   6                       COUNT OF BLANKS IN SEGMENT       42300019
CHARS    EQU   7                       COUNT OF CHARS IN SEGMENT        42600019
LENGTH   EQU   8                       BEGINNING OF TARGET RECORD       42900019
COUNTS   EQU   9                       BEGINNING OF SEGMENT             43200019
OUT      EQU   10                      SPACE FOR TARGET RECORDS         43500019
*                                                                       43800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 44100019
*                                                                       44400019
*                                      BEGIN MODULE                     44700019
*                                                                       45000019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 45300019
*                                                                       45600019
IEZNCODE CSECT                         BEGIN MODULE                     45900019
*                                                                       46200019
         STM   BACK,DATA,12(SAVE)      SAVE REGISTERS                   46500002
         BALR  BASE,0                  ADDRESS CODE                     46800019
         USING *,BASE                  CODE ADDRESSABILITY              47100019
**************************************************************** Y02668 47105002
* MODULE TRACE CODE - FOR TESTING                                Y02668 47110002
         L     15,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 47115002
         BALR  14,15               ENTER MOD ID IN TRACE RECORD. Y02668 47120002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 47125002
         DC    C'NCOD'             MOD ID USED BY TRACE          Y02668 47130002
* TRACE RETURNS HERE.                                            Y02668 47135002
**************************************************************** Y02668 47140002
         B     N1                  BYPASS ID                     Y02668 47145002
         MODID BR=NO                                             Y02668 47150002
         DC    C'MVM'              FUNCTION ID AND               Y02668 47210002
         DC    C'01'               LEVEL # (TRACE + PATCH)       Y02668 47270002
N1       DS    0H                  BEGIN                         Y02668 47330002
         L     DATA,0(PASS)            ADDRESS DATA                     47400019
         USING IEZPARM,DATA            DATA ADDRESSABILITY              47700019
         LA    WORK,1                  CONSTANT REGISTER                48000019
         LA    CODE,2                  CONSTANT AND FLAG REGISTER       48300019
         LM    UNCOM,COMPR,IEZPARM     LOAD SOURCE AND TARGET POINTERS  48600019
         LR    MAXUNCOM,UNCOM          PREPARE SOURCE LIMIT             48900019
         AH    MAXUNCOM,IEZLEN         COMPUTE SOURCE LIMIT             49200019
         LH    OUT,IEZOUT              LOAD TARGET SPACE                49500019
         LA    MAXCOMPR,0(COMPR,OUT)   PREPARE TARGET LIMIT             49800019
         SR    MAXCOMPR,CODE           DECREMENT FOR END OF BLOCK MARK  50100019
         LR    LENGTH,COMPR            ADDRESS TARGET RECORD            50400019
         AR    COMPR,CODE              ADDRESS FIRST SEGMENT            50700019
*                                                                       51000019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 51300019
*                                                                       51600019
*                                      BEGIN SEGMENT                    51900019
*                                                                       52200019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 52500019
*                                                                       52800019
SEGMENT  DS    0H                      COMPRESS SEGMENT                 53100019
*                                                                       53400019
         LTR   CODE,CODE               IF LAST SEGMENT COMPRESSED       53700019
         BZ    FINISH                  THEN FINISH RECORD               54000019
*                                                                       54300019
         LR    COUNTS,COMPR            SAVE ADDRESS FOR COUNT FIELDS    54600019
         AR    COMPR,CODE              ADDRESS COMPRESSED CHARACTERS    54900019
         SR    CHARS,CHARS             ZERO NONBLANK CHARS COUNTED      55200019
         SR    BLANKS,BLANKS           ZERO BLANKS COUNTED              55500019
*                                                                       55800019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 56100019
*                                                                       56400019
*                                      TRANSLATE NONBLANKS              56700019
*                                                                       57000019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57300019
*                                                                       57600019
CHAR     DS    0H                      COUNT NONBLANK CHAR              57900019
*                                                                       58200019
         CR    UNCOM,MAXUNCOM          IF SOURCE FINISHED               58500019
         BNL   RECORD                  THEN FINISH RECORD               58800019
*                                                                       59100019
         CR    COMPR,MAXCOMPR          IF TARGET LIMIT EXCEEDED         59400019
         BNL   BLOCK                   THEN FINISH BLOCK                59700019
*                                                                       60000019
         CH    CHARS,MAXCHAR           IF CHAR COUNT FULL               60300019
         BNL   COUNTED                 THEN FINISH SEGMENT              60600019
*                                                                       60900019
         CLC   0(1,UNCOM),IEZCHAR      IF SOURCE BLANK                  61200019
         BE    BLANK                   THEN COUNT BLANKS                61500019
*                                                                       61800019
         MVC   0(1,COMPR),0(UNCOM)     COMPRESS CHAR                    62100019
         AR    UNCOM,WORK              BUMP SOURCE POINTER              62400019
         AR    COMPR,WORK              BUMP TARGET POINTER              62700019
         AR    CHARS,WORK              BUMP CHAR COUNT                  63000019
*                                                                       63300019
         B     CHAR                    NEXT CHAR                        63600019
*                                                                       63900019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 64200019
*                                                                       64500019
*                                      TRANSLATE BLANKS                 64800019
*                                                                       65100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65400019
*                                                                       65700019
BLANK    DS    0H                      COUNT BLANK                      66000019
*                                                                       66300019
         CR    UNCOM,MAXUNCOM          IF SOURCE FINISHED               66600019
         BNL   RECORD                  THEN FINISH RECORD               66900019
*                                                                       67200019
         CH    BLANKS,MAXBLANK         IF BLANK COUNT FULL              67500019
         BNL   COUNTED                 THEN FINISH SEGMENT              67800019
*                                                                       68100019
         CLC   0(1,UNCOM),IEZCHAR      IF SOURCE NONBLANK               68400019
         BNE   COUNTED                 THEN FINISH SEGMENT              68700019
*                                                                       69000019
         AR    UNCOM,WORK              BUMP SOURCE POINTER              69300019
         AR    BLANKS,WORK             BUMP BLANK COUNT                 69600019
*                                                                       69900019
         B     BLANK                   NEXT BLANK                       70200019
*                                                                       70500019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 70800019
*                                                                       71100019
*                                      END SEGMENT                      71400019
*                                                                       71700019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 72000019
*                                                                       72300019
RECORD   DS    0H                      FINISH LAST SEGMENT IN RECORD    72600019
*                                                                       72900019
         SR    CODE,CODE               FLAG LAST SEGMENT COMPRESSED     73200019
*                                                                       73500019
COUNTED  DS    0H                      FINISH SEGMENT                   73800019
*                                                                       74100019
         STC   BLANKS,0(COUNTS)        WRITE BLANK COUNT                74400019
         STC   CHARS,1(COUNTS)         WRITE NONBLANK COUNT             74700019
*                                                                       75000019
         TM    0(COUNTS),B'11111000'   IF LEFT COUNT LARGE              75300019
         BNZ   SEGMENT                 THEN NEXT SEGMENT                75600019
*                                                                       75900019
         TM    1(COUNTS),B'11110000'   IF RIGHT COUNT LARGE             76200019
         BNZ   SEGMENT                 THEN NEXT SEGMENT                76500019
*                                                                       76800019
         MVO   1(1,COUNTS),0(1,COUNTS) MERGE COUNTS                     77100019
         OI    1(COUNTS),X'80'         FLAG MERGED COUNTS               77400019
         EX    CHARS,MOVE              SHIFT SEGMENT                    77700019
         SR    COMPR,WORK              SHIFT TARGET POINTER             78000019
*                                                                       78300019
         B     SEGMENT                 NEXT SEGMENT                     78600019
*                                                                       78900019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 79200019
*                                                                       79500019
*                                      END MODULE                       79800019
*                                                                       80100019
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 80400019
*                                                                       80700019
FINISH   DS    0H                      FINISH RECORD                    81000019
*                                                                       81300019
         XC    0(2,COMPR),0(COMPR)     END OF BLOCK IF LAST CALL        81600019
         ST    COMPR,IEZCOMPR          UPDATE TARGET POINTER            81900019
         SR    COMPR,LENGTH            COMPUTE TARGET LENGTH            82200019
         STH   COMPR,IEZRES            STORE TARGET LENGTH              82500019
         MVC   0(2,LENGTH),IEZRES      WRITE TARGET LENGTH              82800019
         OC    0(1,LENGTH),IEZTYPE     FLAG RECORD LENGTH               83100019
         SR    OUT,COMPR               COMPUTE TARGET SPACE             83400019
         STH   OUT,IEZOUT              UPDATE TARGET SPACE              83700019
*                                                                       84000019
RETURN   DS    0H                      EXIT MODULE                      84300019
*                                                                       84600019
         L     BACK,12(SAVE)           RESTORE 14                Y02668 84700002
         LM    WORK,DATA,20(SAVE)      RESTORE REGISTERS         Y02668 84900002
*                                                                       85200019
         BR    BACK                    RETURN CONTROL                   85500019
*                                                                       85800019
BLOCK    DS    0H                      FINISH BLOCK                     86100019
*                                                                       86400019
         XC    0(2,LENGTH),0(LENGTH)   MARK END OF BLOCK                86700019
         AR    CODE,CODE               RETURN END OF BLOCK CODE         87000019
*                                                                       87300019
         B     RETURN                  EXIT MODULE                      87600019
*                                                                       87900019
MAXBLANK DC    H'127'                  MAXIMUM BLANKS IN SEGMENT        88200019
MAXCHAR  DC    H'255'                  MAXIMUM NONBLANKS IN SEGMENT     88500019
MOVE     MVC   0(0,COUNTS),1(COUNTS)   EXECUTED INSTRUCTION             88800019
*                                                                       89100019
PATCH    DC    25F'0'              PATCH SPACE                   Y02668 89200002
         END                                                            89400001
*                                                                       89700019
