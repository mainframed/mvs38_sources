./  ADD  SSI=40610005,NAME=IEAVBLDP
         TITLE 'BUILD QUICKCELL POOL MODULE --- IEAVBLDP'               00110102
* /* START OF SPECIFICATIONS ****                                       00120102
*                                                                       00130102
*01*  MODULE-NAME = IEAVBLDP                                            00150102
*                                                                       00300102
*02*     CSECT-NAME = IEAVBLDP                                          00350102
*                                                                       00400102
*01*  DESCRIPTIVE-NAME = BUILD QUICKCELL POOL                           00500102
*                                                                       00560102
*01*  COPYRIGHT = NONE                                                  00570102
*01*  STATUS = LEVEL 02.02  -- 1/31/74                                  00596102
*                                                                       00598502
*01*  FUNCTION = CREATE, EXTEND OR RECOVER (REFORMAT) A QUICK-CELL      00598902
*     POOL.                                                             00599302
*                                                                       00599702
*02*     OPERATION = THE STORAGE PASSED BY THE CALLER (ADDRESS OF       00599802
*        STORAGE IN REGISTER 1) IS FORMATTED INTO A POOL OF CONTIGUOUS  00609802
*        CELLS. IF THE POOL IDENTIFIER (PASSED IN REGISTER 0) IS FOUND  00619802
*        TO INDICATE THAT SUCH A POOL ALREADY EXISTS, THE EXISTING POOL 00621802
*        IS EXTENDED BY THE ADDITION OF A NEW SEGMENT (EXTENT), WHICH   00623802
*        IS CREATED FROM THE STORAGE SUPPLIED. IF NO SUCH POOL ALREADY  00625802
*        EXISTS, THE NEW POOL IS SIMILARLY CREATED. IF NO ADDRESS IS    00627802
*        SUPPLIED IN REGISTER 1, THE POOL WHOSE IDENTIFIER IS IN        00628202
*        REGISTER 0 IS REFORMATTED, REGARDLESS OF THE CURRENT           00628302
*        ALLOCATION STATUS OF THE POOL. UPON COMPLETION, THE POOL       00628402
*        CONSISTS OF AS MANY EVEN-SIZED CELLS AS WILL FIT IN THE SPACE  00628502
*        PASSED. EACH CELL WILL ADDRESS ITS SUCCESSOR CELL THROUGH AN   00632902
*        ADDRESS IN THE LAST WORD OF THE CELL. THIS WORD IS ADDED TO    00634902
*        THE USER-SPECIFIED CELL LENGTH. THE LAST CELL IN THE SEGMENT   00636902
*        WILL CONTAIN A ZERO IN THIS FIELD. THE FIRST OF THESE CELLS IN 00637302
*        THE EXTENT WILL BE ADDRESSED BY THE 'CPABFACP' FIELD IN THE    00638602
*        CELL POOL ANCHOR BLOCK (CPAB) FOR THIS POOL SEGMENT (EXTENT).  00640602
*                                                                       00641502
*01*   NOTES = STANDARD LINKAGE CONVENTIONS                             00642802
*                                                                       00646202
*02*     DEPENDENCIES = 370R-MULTIPROCESSOR INSTRUCTION SET             00650602
*                                                                       00655002
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00659402
*02*     RESTRICTIONS = NONE                                            00663802
*02*     REGISTER-CONVENTIONS = SEE REGISTER EQUATES FOLLOWING CSECT    00668202
*        STATEMENT                                                      00670202
*                                                                       00671402
*02*     PATCH-LABEL = NUCLEUS PATCH AREA                               00671802
*                                                                       00672102
*01*  MODULE-TYPE = MACRO-INVOKED PROCESSING SUBROUTINE                 00676702
*                                                                       00680702
*02*     PROCESSOR = ASSEMBLER-370R                                     00681102
*                                                                       00690402
*02*     MODULE-SIZE = 650 BYTES                                        00690502
*                                                                       00702502
*02*     ATTRIBUTES = REFRESHABLE , NUCLEUS RESIDENT                    00712502
*                                                                       00726302
*01*  ENTRY-POINT = IEAVBLDP                                            00728302
*                                                                       00748502
*02*     PURPOSE = CREATION, EXTENSION OR REFORMATTING OF A QUICK-CELL  00758502
*        POOL.                                                          00758602
*                                                                       00758702
*02*     LINKAGE = ENTERED VIA A BALR 14,15 ... SHOULD BE INVOKED BY    00762102
*        THE BLDCPOOL MACRO-INSTRUCTION.                                00764102
*                 REG 0 = CPID OF THE POOL OR 0 FOR DYNAMIC POOL        00765302
*                 CREATION.                                             00767302
*                 REG 1 = ADDRESS OF THE STORAGE TO BE FORMATTED INTO   00768702
*                 THE POOL EXTENSION OR 0 FOR RECOVERY OF AN ENTIRE     00769002
*                 POOL.                                                 00769402
*                                                                       00770502
*02*     INPUT = THE FIRST 32 BYTES OF THE EXTENT AREA (ADDRESSED BY    00770802
*        REG. 1) IS FORMATTED INTO A MODEL CPAB (CELL POOL ANCHOR       00772802
*        BLOCK) BY THE BLDCPOOL MACRO EXPANSION. THE FOLLOWING FIELDS   00773202
*        IN THIS MODEL CPAB CONTAIN INPUT INFORMATION: CPABCPID,        00773602
*        CPABCSZE, CPABSPID, AND CPABENAD (THE LENGTH OF THE EXTENT).   00773702
*        ... ALL OTHER FIELDS ARE SET TO ZERO.                          00773802
*                                                                       00774002
*02*     OUTPUT = THE EXTENT IS FORMATTED INTO A QUICK-CELL POOL, AND   00775002
*        THE CPAB IDENTIFYING IT IS ENQUEUED INTO THE CHAIN OF CPABS    00775402
*        FOR THE POOL.                                                  00775802
*                                                                       00777002
*02*     REGISTERS-SAVED = THIS ROUTINE SAVES NO REGISTERS, THE MACRO   00778002
*        SAVES REGS. 2 THROUGH 12 INCLUSIVE.                            00778402
*                                                                       00780002
*02*     REGISTER-USAGE = SEE COMMENTS ON REGISTER EQUATES.             00781002
*                                                                       00783002
*02*     REGISTERS-RESTORED = NONE ... SEE REGISTERS SAVED.             00784002
*                                                                       00786002
*01*  EXIT-NORMAL = EXIT                                                00787002
*                                                                       00791002
*02*     CONDITIONS = SUCCESSFUL FORMATTING OF THE EXTENT OR THE POOL   00792002
*        (RECOVER).                                                     00792402
*                                                                       00794002
*02*     OUTPUT = THE CPAB DESCRIBING THE EXTENT IS FULLY INITIALIZED   00795002
*        AND THE EXTENT IS FORMATTED INTO A QUEUE OF CELLS.             00797002
*                                                                       00800002
*02*     RETURN-CODES = 0                                               00808202
*                                                                       00814602
*01*  EXIT-ERROR = BLDERR08                                             00815002
*                                                                       00837502
*02*     CONDITIONS = INVALID CPID OR UNFORMATTED POOL.                 00847502
*                                                                       00851502
*02*     OUTPUT = RETURN CODE.                                          00851902
*        REG 0 CONTAINS EXTENT SUBPOOL NUMBER AND LENGTH OF THE EXTENT  00853902
*        REG 1 CONTAINS EXTENT ADDRESS.                                 00861902
*        NOTE: THESE PARAMETERS ARE SET UP FOR AN R-FORM FREEMAIN.      00863902
*                                                                       00865902
*02*     RETURN-CODES = 8                                               00867902
*                                                                       00879902
*01*  EXIT-ERROR = BLDERR12                                             00880302
*                                                                       00880702
*02*     CONDITIONS = INVALID SUBPOOL ... NON-GLOBAL ONE FOR PERMANENT  00881102
*        CPID OR NON-MATCHING ONE FOR EXTENSION OF ANY EXISTING POOL.   00881202
*                                                                       00881502
*02*     OUTPUT = RETURN CODE.                                          00881602
*        REG 0 CONTAINS EXTENT SUBPOOL NUMBER AND LENGTH OF THE EXTENT  00883602
*        REG 1 CONTAINS EXTENT ADDRESS.                                 00884002
*        NOTE: THESE PARAMETERS ARE SET UP FOR AN R-FORM FREEMAIN.      00884602
*                                                                       00885802
*02*     RETURN-CODES = 12                                              00886402
*                                                                       00887402
*01*  EXIT-ERROR = BLDERR16                                             00889402
*                                                                       00891402
*02*     CONDITIONS = INVALID CELL SIZE ... NON-MATCHING SIZE ON POOL   00891802
*        EXTEND OPERATION OR CELL SIZE GREATER THAN POOL SIZE ON ANY    00891902
*        OPERATION.                                                     00892002
*                                                                       00892202
*02*     OUTPUT = RETURN CODE.                                          00892602
*        REG 0 CONTAINS EXTENT SUBPOOL NUMBER AND LENGTH OF THE EXTENT  00893702
*        REG 1 CONTAINS EXTENT ADDRESS.                                 00894102
*        NOTE: THESE PARAMETERS ARE SET UP FOR AN R-FORM FREEMAIN.      00894502
*                                                                       00895802
*02*     RETURN-CODES = 16                                              00896202
*                                                                       00896602
*01*  EXIT-ERROR = BLDERR20                                             00897002
*                                                                       00897402
*02*     CONDITIONS = INCOMPATABLE CONCURRENT REQUEST ... A DELETE      00899102
*        (DELCPOOL) WAS IN PROCESS FOR THIS POOL, CAUSING THE EXTENT TO 00899202
*        WHICH THE NEW EXTENT WAS TO BE ENQUEUED TO BECOME DELETED, BUT 00901202
*        THE DELETE HAD NOT COMPLETED BY THE TIME THIS ROUTINE HAD      00903202
*        RE-SEARCHED THE QUEUE TO FIND THE END THE FIFTH TIME.          00905202
*                                                                       00908802
*02*     OUTPUT = RETURN CODE.                                          00910802
*        REG 0 CONTAINS EXTENT SUBPOOL NUMBER AND LENGTH OF THE EXTENT  00914402
*        REG 1 CONTAINS EXTENT ADDRESS.                                 00914502
*        NOTE: THESE PARAMETERS ARE SET UP FOR AN R-FORM FREEMAIN.      00914602
*                                                                       00914802
*02*     RETURN-CODES = 20                                              00916802
*                                                                       00917202
*01*  EXTERNAL-REFERENCES = CVT, GDA, AND CPAB.                         00918102
*                                                                       00927002
*02*     ROUTINES = NONE                                                00935902
*02*     CONTROL-BLOCKS = CVT AND GDA (READ ONLY). CPAB (READ AND       00944802
*        WRITE).                                                        00946802
*                                                                       00949702
*01*  TABLES = NONE                                                     00949802
*01*  MACROS = FREEMAIN                                                 00958102
*02*     SERIALIZATION = THE 'CPABFLGW' FIELD IS USED TO SERIALIZE ALL  00968102
*        OPERATIONS ON ANY SINGLE POOL EXTENT, REGARDLESS OF THE TYPE   00970102
*        OF OPERATION. THIS FIELD IS MANIPULATED WITH THE 'CS' (COMPARE 00972102
*        AND SWAP) INSTRUCTION. ONE BIT IN THIS FIELD, 'DELETELK', IS   00974102
*        USED TO INDICATE THAT THE EXTENT IS BEING DELETED FROM THE     00974502
*        POOL. IF A DELETE IS OCCURING (THE BIT IS 'ON'), ALL OTHER     00974602
*        OPERATIONS ARE PROHIBITED ON THE EXTENT BEING DELETED. IF NO   00979102
*        DELETE IS OCCURRING, THE USE COUNT 'CPABUSE#' IS USED TO       00981102
*        PREVENT A DELETE FROM STARTING IN THE MIDDLE OF SOME OTHER     00983102
*        PROCESS. A NON-ZERO VALUE FOR 'CPABUSE#' WILL PREVENT AN       00983502
*        EXTENT FROM BEING DELETED. ONCE THE EXTENT HAS BEEN LOCKED     00983602
*        AGAINST DELETES, THE DOUBLE-WORD FIELD CONSISTING OF           00983702
*        'CPABDEQC' AND 'CPABFACP' IS USED TO SERIALIZE THE ACQUISITION 00984802
*        AND RELEASE OF CELLS IN THE SINGLE EXTENT. THIS DOUBLE-WORD    00986802
*        FIELD IS MANIPULATED WITH THE 'CDS' (COMPARE DOUBLE AND SWAP)  00986902
*        INSTRUCTION.                                                   00987002
*                                                                       00987102
*01*  CHANGE-ACTIVITY = NEW FOR OS/VS2 RELEASE 2.                       00987202
*        LEVEL 02.00 ... CONTAINS FULL ERROR RETURN SUPPORT,            00988302
*        AND M-P INSTRUCTIONS FOR INTERNAL LOCKING OF THE POOL.         00992802
*        LEVEL 2.01 CONTAINS DCRR 23108...SUPPORT FOR BOUNDARY          00993802
*        ALIGNMENT.                                                     00994802
*01*  MESSAGES = NONE                                                   00997302
*01*  ABEND-CODES = NONE                                                01001802
**** END OF SPECIFICATIONS ***/                                         01006302
         EJECT                                                          01056302
*/*BLDCPOOL:   CHART (AMODE)      */                                    08050002
*/* HEADER                                                              08060002
*/*DYNAMIC QUICKCELL                                                    08070002
*/*                                          BUILD CELL POOL ROUTINE    08080002
*/*                                                                     08090002
*/*                                      PAGE  # */                     08092402
*/*IEAVBLDP:1A2 E  (,%RND) BRANCH ENTRY */                              08100002
*/*%RND:       P   (,CONTINUE) ROUND CELL SIZE TO A MULTIPLE OF 4       08110002
*/*(IF NECESSARY)   */                                                  08120002
*/*CONTINUE:   D   (YES,PERMCPID,NO,%D2) PERMANENT CPID? */             08150002
*/*PERMCPID:   P   (,%PINIT) CALCULATE INDEX INTO CPAB TABLE */         08200002
*/*%PINIT:     D   (NO,%PRCV,YES,CPIDTEST) IS THE POOL FORMATTED ? */   08210002
*/*%PRCV:      D   (YES,BLDERR08,NO,%D3) RECOVER REQUEST ? */           08220002
*/*%D3:1D2     D   (NO,BLDERR12,YES,MOVEMODL) GLOBAL SUBPOOL? */        08250002
*/*MOVEMODL:   P   (,EXTEND) INITIALIZE ORIGINAL PERMANENT CPAB */      08310002
*/*%D2:1B3     D   (NO,DYNAMOLD,YES,%DYN) NULL CPID (CREATE)? */        08350002
*/*%DYN:       D   (YES,BLDERR08,NO,%DYNER) CPADDR = 0? (RECOVER?) */   08410002
*/*%DYNER:1B4  P   (,NOCPIDCK)  CREATE DYNAMIC CPID (CPADDR/4)*/        08450002
*/*DYNAMOLD:   P   (,CPIDTEST)  CALCULATE CPAB ADDR (CPID*4)*/          08500002
*/*CPIDTEST:   D   (NO,BLDERR08,YES,%D5) CPID'S MATCH? */               08550002
*/*%D5:1F3     D   (NO,%SPCHK,YES,RECOVER) RECOVER REQUEST? */          08552002
*/*%SPCHK:1G2  D   (NO,BLDERR12,YES,%D7) SUBPOOL NUMBERS MATCH? */      08552402
*/*%D7:1H2     D   (NO,BLDERR16,YES,%SEXT) CSIZES MATCH? */             08552802
*/*%SEXT:      P   (,NOCPIDCK) SET EXTENT BIT ON IN CPAB */             08552902
*/*NOCPIDCK:   P   (,EXTEND) SET UP LIMIT ADDRESSES IN CPAB */          08553002
*/*EXTEND:     S   (,FINDLOOP) POOLFORM: FORMAT THE EXTENT  */          08553702
*/*FINDLOOP:   P   (,%CHN) LOOP UNTIL LAST CPAB FOUND */                08553802
*/*%CHN:       M   (,%CHN1) LOCK OUT DELETE (RAISE USE COUNT) */        08566302
*/*%CHN1:      D   (YES,%CHN2,NO,BLDERR20) DID I GET THE THE LOCK ? */  08576302
*/*%CHN2:1J1   M   (,%RUSE) CHAIN CPABE TO CPAB(E) USING 'CS'. */       08591502
*/*%RUSE:      P   (,EXIT) UNLOCK THE EXTENT (LOWER THE USE COUNT) */   08604002
*/*EXIT:       R   RC = 0 */                                            09150002
*/*RECOVER:    M   (,RCVRLOOP) SET BUILD IN PROCESS FLAG FOR POOL*/     09160002
*/*RCVRLOOP:   P   (,%PLFC) SET DELETE LOCK FOR EXTENT */               09170002
*/*%PLFC:      S   (,%RSTLK) POOLFORM: FORMAT THE EXTENT */             09180002
*/*%RSTLK:     P   (,%RCVD) RESET DELETE LOCK FOR THE EXTENT */         09190002
*/*%RCVD:      D   (YES,RCVRLOOP,NO,EXIT) ANY MORE EXTENTS? */          09192002
*/*BLDERR08:   P   (,ERREXIT) SET RETURN CODE TO 8     */               09200002
*/*BLDERR12:   P   (,ERREXIT) SET RETURN CODE TO 12 */                  09250002
*/*BLDERR16:   P   (,ERREXIT) SET RETURN CODE TO 16 */                  09300002
*/*BLDERR20:   P   (,ERREXIT) SET RETURN CODE TO 20 */                  09302002
*/*OK2EXIT:    R   RETURN, PASS PRESET RETURN CODE */                   09340002
*/*ERREXIT:    P   (,OK2EXIT) SET UP REGS 0 & 1 WITH SP#, LENGTH AND    09342002
*/*ADDRESS OF STORAGE AREA */                                           09344002
*/*BLDCPOOL: END */                                                     09350002
*/*POOLFOR:    CHART (AMODE)  */                                        09400002
*/* HEADER                                                              09410002
*/*DYNAMIC QUICKCELL                                                    09420002
*/*                              BUILD-POOL FORMATTING SUBROUTINE       09430002
*/*                                                                     09440002
*/*                                            # */                     09442002
*/*POOLFORM:   E   (,%PF1) BALR TYPE ENTRY */                           09450002
*/*%PF1:       P   (,%PREP) COMPUTE NUMBER OF CELLS IN EXTENT */        09600002
*/*%PREP:      M   (,%TCNT) SET UP LOOP COUNT FROM NUMBER */            09650002
*/*%FAVL:      P   (,LOOPFORM) STORE FIRST FREE CELL ADDRESS IN CPAB */ 09660002
*/*%TCNT:      D   (YES,BLDERR16,NO,%FAVL) COUNT = ZERO? */             09700002
*/*LOOPFORM:   P   (,%NXT) CHAIN CELL TO NEXT CELL (FORCE BOUNDARY      09800002
*/* ALIGNMENT IF NECESSARY)*/                                           09820002
*/*%NXT:       M   (,%FRM) REDUCE CELL COUNT */                         09850002
*/*%FRM:       D   (YES,LASTCELL,NO,LOOPFORM) ZERO CELLS REMAINING? */  09900002
*/*LASTCELL:   P   (,%RCP0) STORE 0 IN THE CELL LINK FIELD OF THE LAST  09910002
*/*CELL */                                                              09920002
*/*%RCP0:      R   RETURN */                                            09950002
*/*BLDERR16:   R   RC=16 */                                             09960002
*/*POOLFOR: END */                                                      10000002
         EJECT                                                          10060002
IEAVBLDP CSECT                                                          10100002
CELLLINK EQU   0              CELL LINKAGE POINTER                      10150002
R0       EQU   0              CPID -- INPUT PARAMETER                   10200002
R1       EQU   1              POOL AREA ADDRESS -- INPUT PARAMETER      10250002
R2       EQU   2              SCRATCH REGISTER                          10300002
R3       EQU   3              SCRATCH REGISTER                          10350002
*                             ON INPUT, R3 CONTAINS CVT ADDRESS         10400002
R4       EQU   4              CPAB ADDRESS (CALCULATED)                 10450002
R5       EQU   5              SCRATCH REGISTER                          10460002
R6       EQU   6              NEXT CELL ADDRESS (DURING FORMATTING)     10466002
R7       EQU   7              LOOP CONTROL REGISTER (DURING FORMATTING) 10472002
R8       EQU   8              ADDRESS OF CPAB (DURING FORMATTING)       10478002
R9       EQU   9              CELL LENGTH (DURING FORMATTING)           10484002
R10      EQU   10             *** UNUSED ***                            10490002
R11      EQU   11             INTERNAL LINKAGE TO THE POOLFORM ROUTINE  10496002
R12      EQU   12             CONTAINS POOL AREA ADDRESS FOR ERR RETURN 10498002
R13      EQU   13             (DO NOT USE) CALLER SAVE AREA ADDRESS     10498402
R14      EQU   14             RETURN ADDRESS                            10500002
R15      EQU   15             ENTRY POINT ADDRESS (BASE REGISTER)       10550002
         EJECT                                                          10560002
         USING IEAVBLDP,R15                                             10600002
         MODID BR=YES                                                   10600402
*********************************************************************** 10602002
*        TEST THE VALUE OF THE CELL SIZE FOUND IN THE MODEL CPAB        10610002
*        WHICH IS PASSED BY THE MACRO INVOKATION IN THE FIRST           10620002
*        32 BYTES OF THE USER'S POOL AREA (POINTED TO BY                10630002
*        REGISTER 1). IF THE CELL SIZE IS NOT A MULTIPLE OF FOUR,       10640002
*        ROUND IT.                                                      10640802
*********************************************************************** 10641202
         USING CPAB,R1                                                  10642002
         LTR   R12,R1         SAVE POOL AREA ADDRESS FOR ERROR EXITS    10642402
         BZ    TESTCPID       IF RECOVER OPTION, SKIP LENGTH CHECK      10651402
         TM    CPABCSZE+L'CPABCSZE-1,3   IS THE LENGTH A MULTIPLE OF 4? 10660402
         BZ    CONTINUE       YES, LENGTH IS MULTIPLE OF 4, CONTINUE    10664802
         L     R2,CPABCSZE    NOT A MULTIPLE OF FOUR, GET LENGTH        10669202
         LA    R2,4(R2)        AND INCREASE IT BY 4. THEN RETURN IT     10673602
         ST    R2,CPABCSZE    TO THE CPAB AND TURN OFF ANY ODD BITS     10677602
         NI    CPABCSZE+L'CPABCSZE-1,X'FF'-3 IN THE LENGTH (<4).        10681602
CONTINUE EQU   *                                                        10691202
         TM    CPABFLGS,BLDDWORD   DOUBLE WORD CELL ALIGNMENT REQUIRED? 10692002
         BZ    TESTCPID            NO, LEAVE SIZE UNCHANGED.            10692802
         TM    CPABCSZE+L'CPABCSZE-1,X'04' YES, IF CELL SIZE IS ALREADY 10693602
         BO    TESTCPID            DOUBLE-WORD MULTIPLE, THEN IT MUST   10694402
         LA    R2,4                BE ADJUSTED BY 4 TO FORCE THE        10695602
         A     R2,CPABCSZE         REQUIRED DOUBLE WORD ALIGNMENT,      10704602
         ST    R2,CPABCSZE         INCLUDING THE LINK POINTER LENGTH.   10713602
TESTCPID EQU   *                                                        10722602
         DROP  R1                                                       10726602
         LTR   R4,R0          TEST CPID VALUE (& PREPARE CPAB BASE)     10731602
         BM    PERMCPID       NEGATIVE, PERMANENT (SYSTEM) CPID         10740602
         BNZ   DYNAMOLD       POSITIVE, OLD DYNAMIC POOL ID             10750002
         SPACE 3                                                        10760002
*********************************************************************** 10762002
*        THE CPID HAS BEEN FOUND TO BE NULL. THIS MEANS THAT A NEW      10770002
*        DYNAMIC CELL POOL IS TO BE CREATED. THE NEW ID IS CREATED      10790002
*        BY DIVIDING THE ADDRESS OF THE CPAB (IN REG. 1) BY 4.          10792002
*********************************************************************** 10792402
         USING CPAB,R4                                                  10794002
         LTR   R0,R1          NEW CPID = CPADDR                         10796002
         BZ    BLDERR08       ERROR, NULL CPADDR - (RECOVER REQUEST)    10796402
         LR    R4,R1          SET UP CPAB BASE ADDRESSING AREA PASSED   10796802
         SRL   R0,2           CPID = CPADDR / 4                         10798002
         ST    R0,CPABCPID    STORE THE NEW ID IN THE CPAB              10798102
         B     NOCPIDCK       BRANCH TO MAINLINE                        10798402
         EJECT                                                          10798802
*********************************************************************** 10848802
*        A PERMANENT (SYSTEM) CPID HAS BEEN PASSED, THE CPAB            11150002
*        ADDRESS IS FOUND BY USING THE LOW-ORDER BYTE OF THE            11200002
*        ID AS AN INDEX INTO A TABLE OF CPAB'S. THE TABLE IS            11250002
*        FOUND FROM THE GLOBAL DATA AREA (GDA), WHOSE ADDRESS           11300002
*        IS FOUND IN THE CVT.                                           11350002
*********************************************************************** 11360002
PERMCPID EQU   *                                                        11400002
         USING CVTMAP,R3                                                11450002
         L     R3,CVTGDA      GDA ADDRESS                               11500002
         USING GDA,R3                                                   11550002
*        THE CELL POOL ANCHOR BLOCK (CPAB) ADDRESS = CPID               11650002
         N     R4,F255             // 256 (MODULO DIVISION)             11700002
         SLL   R4,5                * 32 (CPAB LENGTH)                   11750002
         A     R4,PFSTCPAB         + CPAB TABLE ADDRESS                 11800002
*****    NOTE THAT THE PREVIOUS CALCULATION IS DEPENDENT UPON THE       11802002
*****    LENGTH OF THE CPAB BEING A POWER OF 2 (32).                    11806002
         L     R3,CPABSTAD    GET POOL START ADDRESS TO TEST:           11810002
         LTR   R3,R3          HAS THE POOL BEEN INITIALIZED?            11812002
         BNZ   CPIDTEST       YES, GO CHECK FOR CPID MATCH              11820002
         LTR   R1,R1          NO, IS IT A RECOVER REQUEST?              11822002
         BZ    BLDERR08       YES, ERROR - RECOVERING AN UN-BUILT POOL  11824002
         C     R0,CPABCPID    IS THIS THE CORRECT CPAB?                 11824402
         BNE   BLDERR08       NO, THE CPIDS DO NOT MATCH, ERROR.        11824802
         CLI   CPABSPID-CPAB(R1),GSP1   IS THIS A GLOBAL SUBPOOL?       11826002
         BE    MOVEMODL       YES, GO INITIALIZE THE ANCHOR BLOCK       11828402
         CLI   CPABSPID-CPAB(R1),GSP2   IS THIS A GLOBAL SUBPOOL?       11828802
         BE    MOVEMODL       YES, GO INITIALIZE THE ANCHOR BLOCK       11829202
         CLI   CPABSPID-CPAB(R1),GSP3   IS THIS A GLOBAL SUBPOOL?       11829602
         BE    MOVEMODL       YES, GO INITIALIZE THE ANCHOR BLOCK       11829702
         CLI   CPABSPID-CPAB(R1),GSP4   IS THIS A GLOBAL SUBPOOL?       11829802
         BE    MOVEMODL       YES, GO INITIALIZE THE ANCHOR BLOCK       11829902
         B     BLDERR12       ERROR, NON-GLOBAL SUBPOOL                 11833202
MOVEMODL EQU   *                                                        11835202
         MVC   CPAB(CPABLEN),0(R1) MOVE MODEL CPAB FROM USER CORE       11836702
         L     R2,CPABENAD     SET UP POOL START AND END ADDRESSES IN   11840002
         AR    R2,R1           THE NEW CPAB. ADD START ADDRESS TO       11842002
         STM   R1,R2,CPABSTAD  THE LENGTH AND STORE THE TWO POINTERS    11844002
         LR    R1,R4          SET UP ADDRESS OF ORIGINAL CPAB           11844402
         B     EXTEND         CONTINUE WITH MAINLINE                    11846002
         SPACE                                                          11846402
*********************************************************************** 11846502
*        THESE REPRESENT THE LEGITIMATE GLOBAL SUBPOOLS IN WHICH        11846602
*        A PERMANENT POOL CAN EXIST. IF THE DESIGN IS CHANGED, THESE    11849202
*        WILL HAVE TO BE HANDLED ACCORDINGLY.                           11851602
*********************************************************************** 11852002
GSP1     EQU   231           COMMON SERVICE AREA (CSA)                  11852502
GSP2     EQU   239           GLOBAL FIXED STORAGE                       11854502
GSP3     EQU   241           COMMON SERVICE AREA (CSA)                  11856502
GSP4     EQU   245           SYSTEM QUEUE AREA (SQA)                    11858502
         EJECT                                                          11862502
*********************************************************************** 11865002
*        THE CPID HAS BEEN FOUND TO BE A DYNAMIC POOL ID AND            11867502
*        THE ADDRESS OF THE FIRST CPAB IS FOUND FROM THE CPID           11870002
*        BY MULTIPLYING IT BY 4.                                        11880002
*********************************************************************** 11880402
DYNAMOLD EQU   *                                                        11882002
*                            REGISTER 4 ALREADY CONTAINS THE CPID,      11890002
         SLL   R4,2           MULTIPLY BY 4 TO GET CPAB ADDRESS.        11892002
         SPACE 3                                                        11894002
*********************************************************************** 11896002
*        COMMON PATH******** AFTER FINDING THE CPAB FOR THE             11900002
*        ID GIVEN, CHECK FOR MATCHING CPID'S, UNFORMATTED               11950002
*        POOLS, AND RECOVER REQUESTS.                                   12000002
*********************************************************************** 12010002
CPIDTEST EQU   *                                                        12050002
         C     R0,CPABCPID              CPID'S MATCH ?                  12150002
         BNE   BLDERR08                  NO, ERROR CONDITION            12200002
         LTR   R1,R1                    IS THIS A RECOVER REQUEST?      12210002
         BZ    RECOVER                   YES, GO TO RECOVER ROUTINE     12220002
         CLC   CPABCSZE,CPABCSZE-CPAB(R1)    CELL SIZES MATCH?          12220402
         BNE   BLDERR16                 NO, ERROR CONDITION             12220802
         CLC   CPABSPID,CPABSPID-CPAB(R1)    SUBPOOLS MATCH?            12221202
         BNE   BLDERR12                 NO, ERROR CONDITION             12221602
         OI    CPABFLGS-CPAB(R1),CPABEXTN    SET CPAB EXTENSION FLAG    12222002
         ST    R4,CPABCPID-CPAB(R1)     LINK NEW CPAB TO ORIGINAL CPAB  12224002
NOCPIDCK EQU   *                                                        12230002
         L     R2,CPABENAD-CPAB(R1)     GET POOL LENGTH FROM MODEL CPAB 12250002
         AR    R2,R1                    ADD POOL LENGTH TO GET POOL END 12310002
         ST    R2,CPABENAD-CPAB(R1)     ADDR. AND STORE IT IN THE CPAB. 12360002
         LA    R2,CPABNXTP-CPAB+L'CPABNXTP(R1) R2 = START ADDRESS OF    12410002
         ST    R2,CPABSTAD-CPAB(R1)     THE POOL, STORE IT IN THE CPAB. 12460002
         B     EXTEND                   GO TO THE POOL EXTEND ROUTINE.  12470002
         EJECT                                                          12510002
*********************************************************************** 13170002
*        A RECOVER REQUEST HAS BEEN ISSUED, THIS ROUTINE CONTROLS THE   13210002
*        SUCCESSIVE INVOKATION OF THE POOL FORMATTING ROUTINE AS EACH   13260002
*        EXTENT BECOMES RE-FORMATTED.                                   13310002
*        THIS ROUTINE IS ALSO RESPONSIBLE FOR THE SERIALIZATION OF ALL  13360002
*        OPERATIONS AND ASSURANCE THAT NO OTHER QUICK-CELL OPERATION    13410002
*        BEGINS WHILE THE EXTENT IS BEING RECOVERED.                    13460002
*********************************************************************** 13470002
RECOVER  EQU   *                                                        13510002
RCVRLOOP EQU   *                                                        13660002
         LR    R8,R4          SET UP CPAB ADDRESS AS PARM FOR THE       13710002
*                             FORMATTING ROUTINE.                       13760002
RCVRLOCK EQU   *                                                        13810002
         L     R2,CPABFLGW    GET THE LOCKS FOR THIS EXTENT             13860002
RCVRLOC2 EQU   *                                                        13880002
         LR    R3,R2          COPY THEM AND SET THE DELETE LOCK BIT     13910002
         O     R3,DELETEON    ON FOR THIS EXTENT. STORE THE             13920002
         CS    R2,R3,CPABFLGW LOCKS IN ORDER TO INHIBIT ALL             13930002
         BNE   RCVRLOC2       CONCURRENT GETS AND FREES DURING RECOVERY 13940002
         BAL   R11,POOLFORM   LINK TO THE POOL FORMATTING ROUTINE.      13960002
RCVRUNLK EQU   *                                                        14010002
         L     R2,CPABFLGW    GET THE LOCKS FOR THIS EXTENT             14060002
RCVRUNL2 EQU   *                                                        14065002
         LR    R3,R2          COPY THEM AND SET THE DELETE LOCK BIT     14070002
         N     R3,DELETOFF    OFF FOR THIS EXTENT. STORE THE            14080002
         CS    R2,R3,CPABFLGW LOCKS IN ORDER TO ALLOW ALL               14090002
         BNE   RCVRUNL2       GETS AND FREES FOLLOWING RECOVERY         14100002
         L     R4,CPABNXTP    GET NEXT CPAB POINTER                     14110002
         LTR   R4,R4          IS IT NULL (=0), END OF CHAIN??           14160002
         BNZ   RCVRLOOP       NO, CONTINUE THE RECOVERY                 14210002
         LR    R4,R8          YES, RESTORE THE LAST CPAB ADDRESS        14260002
         B     BLDEXIT0       THE POOL IS FULLY RECOVERED, RETURN.      14460002
         EJECT                                                          14510002
*********************************************************************** 14520002
*        THIS ROUTINE EXTENDS THE POOL BY INVOKING THE FORMAT ROUTINE   14560002
*        FOR THE NEW POOL EXTENT AND ENQUEUEING THE NEW EXTENT ON THE   14660002
*        LAST ONE IN THE POOL. SINCE THE ENQUEUEING OPERATION IS NOT    14760002
*        ACCOMPLISHED UNTIL THE NEW EXTENT HAS BEEN FORMATTED, THERE    14810002
*        IS NO SERIALIZATION PROBLEM UNTIL THE ENQUEUE OCCURS. THE USE  14860002
*        COUNT OF THE LAST CPAB IS INCREMENTED TO PREVENT IT FROM       14910002
*        BEING DELETED BEFORE THE NEW EXTENT CAN BE ADDED.              14960002
*********************************************************************** 14970002
EXTEND   EQU   *                                                        15010002
         LR    R8,R1          PASS CPAB ADDRESS TO POOL FORMAT ROUTINE  15040002
         BAL   R11,POOLFORM   LINK TO THE FORMATTING ROUTINE            15210002
         CR    R4,R1          IS THIS THE FIRST CPAB FOR THE POOL?      15260002
         BE    EXIT           YES, SKIP THE ENQUEUE PROCESS             15310002
*********************************************************************** 15320002
*        FIND THE LAST CPAB IN THE CHAIN AND LOCK IT, SO THAT THE NEW   15340002
*        EXTENT CAN BE ENQUEUED ON THE END OF THE CHAIN.                15350002
*        THIS LOCK WILL PROHIBIT CONFLICTING OPERATIONS BY PREVENTING   15352002
*        ANY DELETIONS FROM TAKING PLACE ON THIS EXTENT                 15354002
*        CONCURRENT WITH THIS BUILD, WHILE GETS AND FREES OF CELLS MAY  15356002
*        STILL BE CARRIED OUT ON THE PREVIOUSLY EXISTING EXTENTS.       15358002
*********************************************************************** 15358402
         LA    R11,5          SET UP TO RETRY IF DELETION IS IN         15370002
*                             PROCESS FOR THE LAST EXTENT. THIS         15380002
*                             SHOULD GIVE THE DELETE TIME TO FINISH.    15390002
FINDLOOP EQU   *                                                        15409802
         L     R5,CPABNXTP    GET NEXT CPAB ADDRESS                     15409902
         LTR   R5,R5           IS IT NULL? (=0)                         15426602
         BZ    RETRYLK         YES, THE LAST CPAB HAS BEEN FOUND        15436602
         LR    R4,R5           NO, CONTINUE THE LOOP                    15446602
         B     FINDLOOP         UNTIL THE LAST CPAB IS FOUND.           15456602
         SPACE                                                          15458602
RETRYLK  EQU   *                                                        15459002
         L     R2,CPABFLGW    GET THE LOCKS FOR THIS EXTENT             15459402
RETRYLK2 EQU   *                                                        15459602
         LR    R3,R2          COPY THEM AND TEST THEM FOR THE           15459802
         N     R3,DELETOFF    PRESENCE OF THE DELETE LOCK. IF           15459902
         CR    R3,R2          THEY ARE THE SAME, THE EXTENT IS NOT      15476602
         BE    NOTLOCKD       NOT BEING DELETED, CONTINUE.              15486602
         BCT   R11,TRYAGAIN   THE EXTENT IS BEING DELETED,              15496602
*                             SEARCH THE QUEUE AGAIN, TO FIND THE       15506602
*                             NEW LAST EXTENT AND TO ALLOW THE          15508602
*                             DELETE TO FINISH.                         15509002
         B     BLDERR20       THE DELETE DID NOT COMPLETE AFTER         15509402
*                             THE NECESSARY RETRIES, ERROR RETURN       15509802
         EJECT                                                          15509902
TRYAGAIN EQU   *                                                        15510002
         TM    CPABFLGS,CPABEXTN   IF THIS IS THE ONLY POOL SEGMENT     15515402
         BZ    BLDERR20            ERROR RETURN, THE WHOLE POOL IS      15517402
         L     R4,CPABCPID         BEING DELETED. OTHERWISE, GET THE    15519402
         B     FINDLOOP            FIRST CPAB ADDRESS AND RETRY.        15519802
NOTLOCKD EQU   *                                                        15521102
         A     R3,F1          THIS EXTENT IS NOT DEING DELETED,         15526602
         CS    R2,R3,CPABFLGW LOCK DELETE OUT BY RAISING THE            15536602
         BNE   RETRYLK2       USE COUNT OF THE EXTENT. REPEAT           15546602
*                             THE TEST IF THE LOCK WORD HAS CHANGED.    15556602
         L     R5,CPABNXTP    THE EXTENT IS NOW MINE, NOW               15558602
         LTR   R5,R5          ENQUEUE THE CPAB, IF THE EXTENT           15559002
         BNZ   NEXTCPAB       IS STILL THE LAST ONE --- IF IT IS NO     15559402
*                             LONGER THE LAST ONE, FIND THE LAST ONE.   15559802
         CS    R5,R1,CPABNXTP STILL LAST, ENQUEUE THE NEW EXTENT        15559902
         BE    EXITUNL2       IF SUCCESSFUL, EXIT                       15576602
NEXTCPAB EQU   *                                                        15586602
         L     R2,CPABFLGW    UNLOCK THIS PRESENT EXTENT BY             15596602
NEXTCPA2 EQU   *                                                        15601602
         LR    R3,R2          REDUCING THE USE COUNT AND                15606602
         S     R3,F1          STORING IT BACK IN THE EXTENT             15608602
         CS    R2,R3,CPABFLGW TO ALLOW CONCURRENT GETS AND              15609002
         BNE   NEXTCPA2       FREES. IF THE LOCK PICTURE CHANGES,       15609402
*                             CONTINUE UNTIL IT CAN BE STORED.          15609802
         B     TRYAGAIN       LOCK CHANGED, FIND THE NEW QUEUE END.     15609902
         SPACE 2                                                        15660002
*********************************************************************** 15670002
*        EXIT ROUTINE FOR SUCCESSFUL OPERATIONS, THIS ROUTINE           15680002
*        UNLOCKS THE EXTENT (IF REQUIRED) PRIOR TO EXIT.                15710002
*********************************************************************** 15712002
EXIT     EQU   *                                                        15720002
         TM    CPABFLGS,CPABEXTN   IF THIS IS NOT AN EXTENT, NO         15760002
         BZ    FIRSTONE       UNLOCKING OF THE PRIOR EXTENT REQUIRED    15810002
EXITUNLK EQU   *                                                        15870002
         L     R2,CPABFLGW    UNLOCK THIS PRESENT EXTENT BY             15880002
EXITUNL2 EQU   *                                                        15885002
         LR    R3,R2          REDUCING THE USE COUNT AND                15890002
         S     R3,F1          STORING IT BACK IN THE CPAB               15900002
         CS    R2,R3,CPABFLGW TO ALLOW CONCURRENT GETS AND              15902002
         BNE   EXITUNL2       FREES.                                    15904002
FIRSTONE EQU   *                                                        15910002
BLDEXIT0 EQU   *                                                        15960002
         SR    R15,R15        RETURN TO CALLER RC=0                     16010002
         BR    R14                                                      16020002
         EJECT                                                          16060002
*********************************************************************** 16070002
*        THIS SUBROUTINE PERFORMS THE POOL FORMATTING OPERATION.        16110002
*        ON ENTRY, REG 8 CONTAINS THE ADDRESS OF THE CPAB FOR THE       16160002
*        EXTENT TO BE FORMATTED. REG 11 CONTAINS THE RETURN POINT       16210002
*        TO THE CALLER.                                                 16260002
*********************************************************************** 16270002
POOLFORM EQU   *                                                        16310002
         DROP  R4                                                       16360002
         USING CPAB,R8                                                  16410002
         L     R7,CPABENAD    POOL END ADDRESS                          16460002
         S     R7,CPABSTAD     MINUS POOL START ADDRESS                 16510002
         BNP   BLDERR16        EQUALS LENGTH, IF LENGTH <= 0 , ERROR.   16560002
         L     R5,CPABCSZE    GET CELL SIZE                             16610002
         LA    R9,4(R5)       ADD LINK POINTER SIZE TO                  16660002
         SR    R6,R6           OBTAIN THE TRUE INTERNAL CELL LENGTH.    16710002
         DR    R6,R9          DIVIDE POOL SIZE BY CELL SIZE.            16760002
         LTR   R7,R7          TEST NUMBER OF CELLS THAT WILL FIT        16810002
         BNP   BLDERR16       LESS THAN OR EQUAL TO ZERO, ERROR.        16860002
         L     R3,CPABSTAD    GET POOL START ADDRESS                    16910002
         ST    R3,CPABFACP    STORE FIRST AVAILABLE POINTER IN CPAB     16920002
         BCT   R7,LOOPFORM    IF ONLY ONE CELL GO TO LAST CELL          16960002
         B     LASTCELL       PROCESSING IMMEDIATELY.                   17010002
         SPACE 2                                                        17060002
*********************************************************************** 17070002
*        THIS LOOP FORMATS THE POOL EXTENT. EACH CELL HAS THE           17110002
*        ADDRESS OF ITS HIGH NEIGHBOR PLACED IN ITS LINKAGE POINTER,    17210002
*        WHICH IS FOUND IN ITS LAST WORD.                               17260002
*********************************************************************** 17270002
LOOPFORM EQU   *                                                        17310002
         LA    R6,4(R3,R5)    CREATE ADDRESS OF ADJACENT NEIGHBOR CELL  17360002
         ST    R6,0(R3,R5)     AND STORE IT INTO LINKAGE POINTER.       17410002
         LR    R3,R6          GET THE ADDRESS OF THE NEXT CELL.         17460002
         BCT   R7,LOOPFORM     AND CONTINUE TO LAST CELL                17510002
LASTCELL EQU   *                                                        17560002
         SR    R9,R9          LINK ADDRESS IN LAST CELL GETS SET        17610002
         ST    R9,CELLLINK(R3,R5)  TO ZERO                              17660002
         ST    R9,CPABDEQC    ZERO THE ALLOCATED CELL COUNT AND         17670002
         BR    R11            RETURN TO CALLER                          17710002
         DROP  R8                                                       17760002
         EJECT                                                          17810002
*********************************************************************** 17820002
*        ERROR CONDITIONS FOR A RETURN CODE OF EIGHT:                   17860002
*        ..CPID IN THE CPAB DOES NOT MATCH THE CPID PASSED.             17960002
*        ..THE CPID PASSED DOES NOT DEFINE A RECOGNIZABLE POOL.         18010002
*        ..THE POOL TO BE RECOVERED HAS NEVER BEEN FORMATTED.           18020002
*********************************************************************** 18030002
BLDERR08 EQU   *                                                        18060002
         LA    R11,8                                                    18110002
         B     ERREXIT   TAKE ERROR EXIT                                18160002
         SPACE 3                                                        18210002
*********************************************************************** 18210402
*        THE SUBPOOL FOR A PERMANENT POOL WAS NOT A GLOBAL ONE          18220002
*  OR    THE SUBPOOL PASSED DID NOT MATCH THE ORIGINAL ONE FOR THE POOL 18230002
*********************************************************************** 18240002
BLDERR12 EQU   *                                                        18260002
         LA    R11,12                                                   18310002
         B     ERREXIT                                                  18360002
         SPACE 2                                                        18410002
*********************************************************************** 18412002
*        EXTEND OPERATION ONLY - THE CELLSIZE PASSED DOES NOT MATCH THE 18420002
*        CELL SIZE IN THE ORIGINAL POOL CPAB                            18430002
*  OR    ANY OPERATION - THE CELLSIZE IS TOO LARGE TO ALLOW EVEN ONE    18440002
*        CELL TO FIT IN THE POOL SPACE PASSED.                          18450002
****NOTE:  IF THIS CONDITION OCCURS ON RECOVER OPERATIONS, THE EXTENT   18450402
*        WILL BE LOCKED AND IT MAY BE NECESSARY TO ADD CODE TO UNLOCK   18450802
*        THE EXTENT. HOWEVER, SINCE THIS ERROR INDICATES THAT THE       18451602
*        CPAB FOR THE EXTENT HAS BEEN DESTROYED, THE EXTENT WILL NOT    18451702
*        BE EITHER USEABLE OR RECOVERABLE, SO IT MAY AS WELL REMAIN     18451802
*        LOCKED.                                                        18451902
*********************************************************************** 18452002
BLDERR16 EQU   *                                                        18460002
         LA    R11,16                                                   18510002
         B     ERREXIT                                                  18560002
         SPACE 2                                                        18610002
*********************************************************************** 18612002
*        A CONFLICTING CONCURRENT REQUEST HAS PRECEEDED THIS ONE AND    18620002
*        IS STILL IN PROGRESS. THE CONFLICTING REQUEST WILL BE          18630002
*        A DELETE REQUEST ON THE EXTENT TO WHICH THE NEW POOL EXTENT    18640002
*        WOULD BE ENQUEUED.                                             18650802
*********************************************************************** 18652002
BLDERR20 EQU   *                                                        18660002
         LA    R11,20                                                   18710002
         B     ERREXIT                                                  18760002
         EJECT                                                          18770002
*********************************************************************** 18772002
*        SO THAT A FREEMAIN MAY BE ISSUED BY THE CALLER ON ANY ERRORS,  18780002
*        THIS ROUTINE WILL PASS BACK REGISTERS 0 AND 1 IN SUCH A WAY    18790002
*        THAT THEY ARE SUFFICIENT FOR EXECUTION OF A FREEMAIN (R-FORM). 18800002
*        REGISTER 0 = SUBPOOL NUMBER .. POOL SIZE IN BYTES              18802002
*        REGISTER 1 = POOL ADDRESS                                      18804002
*********************************************************************** 18808402
ERREXIT  EQU   *                                                        18810002
         LTR   R1,R12         PICK UP AREA ADDRESS                      18820002
         BZ    RCVRERR        IF RECOVER OPERATION, CLEAR REG 0 AND 1   18822002
         USING CPAB,R1                                                  18830002
         IC    R0,CPABSPID    GET THE SUBPOOL NUMBER                    18840002
         SLL   R0,24           SHIFTED INTO THE HIGH-ORDER BYTE.        18850002
         L     R2,CPABENAD    PICK UP THE ORIGINAL POOL SIZE            18852002
         L     R3,CPABSTAD    GET STARTING ADDRESS AND                  18852402
         LTR   R3,R3           TEST TO SEE IF IT HAS BEEN SET UP YET.   18852802
         BZ    VALISOK        NO, CPABENAD CONTAINS ONLY LENGTH         18853202
         SR    R2,R3          YES, GET LENGTH BY SUBTRACTING START     *18853602
                               ADDRESS FROM END ADDRESS                 18853702
         TM    CPABFLGS,CPABEXTN   IF THIS IS AN EXTENT,                18855702
         BO    ADDCPABL       THE CPAB LENGTH MUST BE ADDED BACK.       18857702
         L     R5,CPABCPID    OR IF THIS IS A DYNAMIC POOL (CPID>0),    18859702
         LTR   R5,R5          THE CPAB LENGTH MUST BE ADDED BACK        18859802
         BNM   ADDCPABL                                                 18859902
         B     VALISOK        PERMANENT POOL FIRST EXTENT, SKIP         18862402
ADDCPABL EQU   *                                                        18864402
         LA    R2,CPABLEN(R2) INCLUDE CPAB LENGTH IN THE POOL LENGTH.   18866402
VALISOK  EQU   *                                                        18867502
         LA    R2,0(R2)       REMOVE HIGH-ORDER BYTE                    18870002
         OR    R0,R2          CATENATE THE TWO FIELDS (SP# & LENGTH)    18875002
RCVRERR  EQU   *                                                        18877002
*********************************************************************** 18877402
*        ON RECOVER ERRORS, DO NOT RETURN THE FREEMAIN PARAMETERS       18880402
*********************************************************************** 18880502
OK2EXIT  EQU   *                                                        18886902
         LR    R15,R11        PASS THE RETURN CODE                      18890002
         BR    R14                                                      18910002
         EJECT                                                          18920002
*********************************************************************** 19007402
*        CONSTANTS REQUIRED BY THE BUILD CELL POOL PROGRAM              19010002
*********************************************************************** 19020002
F255     DC    F'255'         CONSTANT USED FOR MODULO DIVIDE BY 256    19060002
F1       DC    F'1'           CONSTANT USED TO BUMP/DECREMENT USE COUNT 19140002
*        THE FOLLOWING MASKS ARE USED TO TURN THE DELETE LOCK BIT       19140402
*         ON/OFF IN A REGISTER.                                         19140602
DELETEON DC    X'00',AL1(DELETELK),2X'00'         TURN THE FLAG ON      19140802
DELETOFF DC    X'FF',AL1(X'FF'-DELETELK),2X'FF'   TURN THE FLAG OFF     19141402
         EJECT                                                          19142002
         CVT     DSECT=YES                                              19160002
         EJECT                                                          19210002
         IHAGDA  DSECT=YES                                              19260002
         EJECT                                                          19270002
         IHACPAB DSECT=YES                                              19310002
         END                                                            19410002
./  ADD  SSI=53140157,NAME=IEAVCARR
         TITLE '****IEAVCARR--AOS2/REL2  IEAVGCAS FRR****              *00001000
                        '                                               00002000
*                                        /* @ZA07006*/                  00003000
IEAVCARR CSECT                                                          00004000
         USING *,R15                                                    00005000
         MODID                                                          00006000
ENT1     DS    0H                                                       00007000
         BALR  REG8,0              TEMP. ADDRESSABILITY                 00008000
         USING *,REG8                                                   00009000
         B     COMMON              GO SET UP COMMON ADDR.               00010000
         DC    AL2(EP1-ENT1-2)                                          00011000
IEAVTTRR DS    0H                                                       00012000
         BALR  REG8,0              TEMP ADDR.                           00013000
         USING *,REG8                                                   00014000
         B     COMMON              SET UP COMMON ADDR.                  00015000
         DC    AL2(EP2-IEAVTTRR-2)                                      00016000
         ENTRY IEAVTTRR                                                 00017000
IEAVFARR DS    0H                                                       00018000
         BALR  REG8,0               TEMP ADDR.                          00019000
         USING *,REG8                                                   00020000
         B     COMMON               SET UP COMMON ADDR.                 00021000
         DC    AL2(EP3-IEAVFARR-2)                                      00022000
         ENTRY IEAVFARR                                                 00023000
         DROP  REG8                                                     00024000
COMMON   BALR  REG9,0               COMMON ADDRESSABILITY AND SETUP     00025000
PSTART   DS    0H                                                       00026000
         USING PSTART,REG9                                              00027000
         AH    REG8,4(,REG8)        GET @ OF PROPER ENTRY PT.           00028000
         BR    REG8                 BRANCH TO PROPER ENTRY POINT        00029000
EP1      DS    0H                                                       00030000
         LR    REG12,GPR00F               BASE FOR DYNAMIC STORAGE      00031000
         USING @DATD,REG12                                              00032000
*   SDWAPTR=REG1;                   /* BASE FOR SDWA                 */ 00033000
         LR    SDWAPTR,REG1                                        0068 00034000
*   R14SAVE=R14;                                                   0069 00035000
         ST    R14,R14SAVE                                         0069 00036000
*   RFY                                                            0070 00037000
*    (REG1,                                                        0070 00038000
*     R14) UNRSTD;                  /*                       @ZA07006*/ 00039000
*   PARMBASE=SDWAPARM;              /* PTR TO FRR PARM AREA          */ 00040000
         L     PARMBASE,SDWAPARM(,SDWAPTR)                         0071 00041000
*   SDWARCRD='1'B;                  /* INDICATE RECORDING            */ 00042000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0072 00043000
*   SDWAMODN=MODN;                  /* MODULE NAME                   */ 00044000
         MVC   SDWAMODN(8,SDWAPTR),MODN                            0073 00045000
*   SDWACSCT=MODN;                  /* CSECT NAME                    */ 00046000
         MVC   SDWACSCT(8,SDWAPTR),MODN                            0074 00047000
*   SDWAREXN=REXN1;                 /* FRR ROUTINE NAME              */ 00048000
         MVC   SDWAREXN(8,SDWAPTR),REXN1                           0075 00049000
*   IF SDWAFMID¬=SAME THEN          /* IF NOT IN FAILING MEMORY      */ 00050000
         LH    @08,SDWAFMID(,SDWAPTR)                              0076 00051000
         N     @08,@CF01580                                        0076 00052000
         CH    @08,SAME                                            0076 00053000
         BNE   @RT00076                                            0076 00054000
*     GOTO PERCOL;                  /* PERCOLATE                     */ 00055000
*   SDWAUPRG='1'B;                  /* REGS UPDATED FOR RETRY        */ 00056000
         OI    SDWAUPRG(SDWAPTR),B'00001000'                       0078 00057000
*   IF PAGEADD¬=0 THEN              /* IF PAGE WAS GETMAINED,        */ 00058000
         L     @08,PAGEADD(,PARMBASE)                              0079 00059000
         LTR   @08,@08                                             0079 00060000
         BZ    @RF00079                                            0079 00061000
*     DO;                           /* FREE IT                       */ 00062000
*       RFY                                                        0081 00063000
*        (RTCB,                                                    0081 00064000
*         RASCB,                                                   0081 00065000
*         R14,                                                     0081 00066000
*         R15) RSTD;                /*                       @ZA07006*/ 00067000
*       RTCB=PSATOLD;               /* TCB ADDRESS FOR GM            */ 00068000
         L     RTCB,PSATOLD                                        0082 00069000
*       RASCB=PSAAOLD;              /* ASCB @ FOR GM                 */ 00070000
         L     RASCB,PSAAOLD                                       0083 00071000
*       DO;                         /* FREEMAIN(RC)                0084 00072000
*                                      LV(4096)A(PAGEADD->PAGE) SP(0)   00073000
*                                      BRANCH                        */ 00074000
*         RESPECIFY                                                0085 00075000
*          (GPR01F,                                                0085 00076000
*           GPR03F,                                                0085 00077000
*           GPR00F) RESTRICTED;                                    0085 00078000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 00079000
         SLR   GPR01F,GPR01F                                       0086 00080000
*         GPR03F=1;                 /* SET TYPE                      */ 00081000
         LA    GPR03F,1                                            0087 00082000
*         GPR00F=4096;              /* LENGTH REQUESTED              */ 00083000
         L     GPR00F,@CF01560                                     0088 00084000
*         GPR01F=ADDR(PAGEADD->PAGE);/* SET REGISTER ONE             */ 00085000
         LR    GPR01F,@08                                          0089 00086000
*         GPR03F=GPR03F+((0)*256);  /* SUBPOOL VALUE                 */ 00087000
*         CALL CVTCRMN;             /* BRANCH ENTRY POINT            */ 00088000
         L     @08,CVTPTR                                          0091 00089000
         L     @15,CVTCRMN(,@08)                                   0091 00090000
         BALR  @14,@15                                             0091 00091000
*         RESPECIFY                                                0092 00092000
*          (GPR01F,                                                0092 00093000
*           GPR03F,                                                0092 00094000
*           GPR00F) UNRESTRICTED;                                  0092 00095000
*       END;                        /* FREEMAIN(RC)                0093 00096000
*                                      LV(4096)A(PAGEADD->PAGE) SP(0)   00097000
*                                      BRANCH                        */ 00098000
*       RFY                                                        0094 00099000
*        (RTCB,                                                    0094 00100000
*         RASCB,                                                   0094 00101000
*         R14,                                                     0094 00102000
*         R15) UNRSTD;              /*                       @ZA07006*/ 00103000
*     END;                                                         0095 00104000
*   IF RECURSE='1'B THEN            /* IS THIS RECURSION ENTRY?      */ 00105000
@RF00079 TM    RECURSE(PARMBASE),B'00010000'                       0096 00106000
         BNO   @RF00096                                            0096 00107000
*     DO;                                                          0097 00108000
*       IF SDWAPCHK='1'B THEN       /* IS THIS A PGM CHECK?          */ 00109000
         TM    SDWAPCHK(SDWAPTR),B'01000000'                       0098 00110000
         BNO   @RF00098                                            0098 00111000
*         DO;                                                      0099 00112000
*           RFY                                                    0100 00113000
*            (GPR00F,                                              0100 00114000
*             GPR01F,                                              0100 00115000
*             R13,                                                 0100 00116000
*             R14,                                                 0100 00117000
*             R15) RSTD;            /*                       @ZA07006*/ 00118000
*           LDAPTR=PSAAOLD->ASCBLDA;                               0101 00119000
         L     @10,PSAAOLD                                         0101 00120000
         L     LDAPTR,ASCBLDA(,@10)                                0101 00121000
*           R13=ADDR(CFAPWKAR);     /* SAVE AREA                     */ 00122000
         LA    R13,CFAPWKAR(,LDAPTR)                               0102 00123000
*           R14=PSAAOLD;            /* ASCB BASE                     */ 00124000
         LR    R14,@10                                             0103 00125000
*           LFSDUMP2=LFSDUMP;                                      0104 00126000
         MVC   LFSDUMP2(24),LFSDUMP                                0104 00127000
*           GPR01F=ADDR(LFSDUMP2);  /* SDUMP PARM AREA               */ 00128000
         LA    GPR01F,LFSDUMP2                                     0105 00129000
*           GENERATE;                                              0106 00130000
     SDUMP ASID=ASCBASID(14),SDATA=(PSA,LSQA),BRANCH=YES,MF=(E,(1))     00131000
*           RFY                                                    0107 00132000
*            (GPR00F,                                              0107 00133000
*             GPR01F,                                              0107 00134000
*             R13,                                                 0107 00135000
*             R14,                                                 0107 00136000
*             R15) UNRSTD;          /*                       @ZA07006*/ 00137000
*         END;                                                     0108 00138000
*       SDWAFLLK='1'B;              /* RELEASE LOCAL LOCK            */ 00139000
@RF00098 OI    SDWAFLLK(SDWAPTR),B'00000001'                       0109 00140000
*       GOTO PERCOL;                /* PERCOLATE                     */ 00141000
         B     PERCOL                                              0110 00142000
*     END;                                                         0111 00143000
*   RECURSE='1'B;                   /* SET RECURSION BIT ON          */ 00144000
@RF00096 OI    RECURSE(PARMBASE),B'00010000'                       0112 00145000
*   IF SDWAPERC='0'B THEN           /* IF NOT A CASE OF PERCOLATION  */ 00146000
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0113 00147000
         BNZ   @RF00113                                            0113 00148000
*     IF SDWAPCHK='1'B|SDWAMCHK='1'B THEN/* IF ERROR IS A PGM CHECK     00149000
*                                      OR A MACHINE CHK, TRY TO RETRY*/ 00150000
         TM    SDWAPCHK(SDWAPTR),B'11000000'                       0114 00151000
         BZ    @RF00114                                            0114 00152000
*       DO;                                                        0115 00153000
*CONTINUE:                                                         0116 00154000
*         IF RSMBIT='0'B THEN       /* IF RSM WAS NOT CALLED,        */ 00155000
CONTINUE TM    RSMBIT(PARMBASE),B'10000000'                        0116 00156000
         BNZ   @RF00116                                            0116 00157000
*           DO;                     /* RETRY FROM BEGINNING          */ 00158000
*             SDWARTYA=ADDR(CASRETRY);/* RETRY ADDRESS               */ 00159000
         L     @08,@CV01514                                        0118 00160000
         ST    @08,SDWARTYA(,SDWAPTR)                              0118 00161000
*             SDWASR01=ASCBSAVE;    /* RESTORE PARM                  */ 00162000
         L     @08,ASCBSAVE(,PARMBASE)                             0119 00163000
         ST    @08,SDWASR01(,SDWAPTR)                              0119 00164000
*             SDWARCDE=RCDE4;       /* INDICATE RETRY                */ 00165000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0120 00166000
*             GOTO RETRN;           /* RETURN                        */ 00167000
         B     RETRN                                               0121 00168000
*           END;                                                   0122 00169000
*         ELSE                      /* IF RSM CALLED, RETRY WITH   0123 00170000
*                                      ERROR RETURN TO PROVIDE FOR 0123 00171000
*                                      RSM CLEANUP                   */ 00172000
*           DO;                                                    0123 00173000
@RF00116 DS    0H                                                  0124 00174000
*             SDWARTYA=ADDR(NOTAUTH);/* ERROR RETURN FOR VGCAS       */ 00175000
         L     @10,@CV01517                                        0124 00176000
         ST    @10,SDWARTYA(,SDWAPTR)                              0124 00177000
*             SDWARCDE=RCDE4;                                      0125 00178000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0125 00179000
*             GOTO RETRN;           /* RETURN                        */ 00180000
         B     RETRN                                               0126 00181000
*           END;                                                   0127 00182000
*       END;                                                       0128 00183000
*     ELSE                          /* NOT PCHK OR MCHK              */ 00184000
*       SDWAFLLK='1'B;              /* TELL RTM TO RELEASE LOCAL LOCK*/ 00185000
@RF00114 OI    SDWAFLLK(SDWAPTR),B'00000001'                       0129 00186000
*   ELSE                                                           0130 00187000
*     ;                             /* THIS IS PERCOLATION           */ 00188000
@RF00113 DS    0H                                                  0131 00189000
*PERCOL:                                                           0131 00190000
*   SDWARCDE=RCDE0;                 /* CONTINUE WITH TERMINATION     */ 00191000
PERCOL   MVI   SDWARCDE(SDWAPTR),X'00'                             0131 00192000
*   RFY                                                            0132 00193000
*    (REG1,                                                        0132 00194000
*     R14) RSTD;                    /*                       @ZA07006*/ 00195000
*RETRN:                                                            0133 00196000
*   R14=R14SAVE;                    /* RETURN TO CALLER              */ 00197000
RETRN    L     R14,R14SAVE                                         0133 00198000
*   REG1=SDWAPTR;                   /* PUT SDWA PTR IN REG 1 FOR RTM */ 00199000
         LR    REG1,SDWAPTR                                        0134 00200000
*   GOTO R14;                       /* RETURN TO CALLER              */ 00201000
         BR    R14                                                 0135 00202000
*                                                                  0136 00203000
*/*                                                                  */ 00204000
*/********************************************************************/ 00205000
*/*                     IEAVTTRR                                     */ 00206000
*/*     THIS IS THE ENTRY POINT IF THE FRR WAS ENTERED FOR ERRORS    */ 00207000
*/*IN THE TASK TERMINATION ROUTINE OF IEAVGCAS.                      */ 00208000
*/********************************************************************/ 00209000
*                                                                  0136 00210000
*IEAVTTRR:                                                         0136 00211000
*   ENTRY;                                                         0136 00212000
*   GENERATE SETS(REG12);                                          0137 00213000
*                           /*  @ZA07006*/                              00214000
EP2      DS    0H                                                       00215000
         LR    REG12,GPR00F               BASE FOR DYNAMIC STORAGE      00216000
         USING @DATD,REG12                                              00217000
*   SDWAPTR=REG1;                   /* BASE FOR SDWA                 */ 00218000
         LR    SDWAPTR,REG1                                        0138 00219000
*   R14SAVE=R14;                                                   0139 00220000
         ST    R14,R14SAVE                                         0139 00221000
*   RFY                                                            0140 00222000
*    (REG1,                                                        0140 00223000
*     R14) UNRSTD;                  /*                       @ZA07006*/ 00224000
*   PARMBASE=SDWAPARM;              /* PTR TO FRR PARM AREA          */ 00225000
         L     PARMBASE,SDWAPARM(,SDWAPTR)                         0141 00226000
*   SDWARCRD='1'B;                  /* INDICATE RECORDING            */ 00227000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0142 00228000
*   SDWAMODN=MODN;                  /* MODULE NAME                   */ 00229000
         MVC   SDWAMODN(8,SDWAPTR),MODN                            0143 00230000
*   SDWACSCT=MODN;                  /* CSECT NAME                    */ 00231000
         MVC   SDWACSCT(8,SDWAPTR),MODN                            0144 00232000
*   SDWAREXN=REXN2;                 /* FRR ROUTINE NAME              */ 00233000
         MVC   SDWAREXN(8,SDWAPTR),REXN2                           0145 00234000
*   IF SDWAFMID¬=SAME THEN          /* IF NOT IN FAILING MEMORY      */ 00235000
         LH    @08,SDWAFMID(,SDWAPTR)                              0146 00236000
         N     @08,@CF01580                                        0146 00237000
         CH    @08,SAME                                            0146 00238000
         BNE   @RT00146                                            0146 00239000
*     GOTO PERCOL;                  /* PERCOLATE                     */ 00240000
*   IF RECURSE='1'B THEN            /* IF RECURSION ENTRY, INDICATE     00241000
*                                      RETRY FAILED                  */ 00242000
         TM    RECURSE(PARMBASE),B'00010000'                       0148 00243000
         BNO   @RF00148                                            0148 00244000
*     DO;                                                          0149 00245000
*       IF SDWAPCHK='1'B THEN       /* IS THIS A PGM CHECK?          */ 00246000
         TM    SDWAPCHK(SDWAPTR),B'01000000'                       0150 00247000
         BNO   @RF00150                                            0150 00248000
*         DO;                                                      0151 00249000
*           RFY                                                    0152 00250000
*            (GPR00F,                                              0152 00251000
*             GPR01F,                                              0152 00252000
*             R13,                                                 0152 00253000
*             R14,                                                 0152 00254000
*             R15) RSTD;            /*                       @ZA07006*/ 00255000
*           LDAPTR=PSAAOLD->ASCBLDA;                               0153 00256000
         L     @10,PSAAOLD                                         0153 00257000
         L     LDAPTR,ASCBLDA(,@10)                                0153 00258000
*           R13=ADDR(CFAPWKAR);     /* SAVE AREA                     */ 00259000
         LA    R13,CFAPWKAR(,LDAPTR)                               0154 00260000
*           R14=PSAAOLD;            /* ASCB BASE                     */ 00261000
         LR    R14,@10                                             0155 00262000
*           LFSDUMP2=LFSDUMP;                                      0156 00263000
         MVC   LFSDUMP2(24),LFSDUMP                                0156 00264000
*           GPR01F=ADDR(LFSDUMP2);  /* SDUMP PARM AREA               */ 00265000
         LA    GPR01F,LFSDUMP2                                     0157 00266000
*           GENERATE;                                              0158 00267000
     SDUMP ASID=ASCBASID(14),SDATA=(PSA,LSQA),BRANCH=YES,MF=(E,(1))     00268000
*           RFY                                                    0159 00269000
*            (GPR00F,                                              0159 00270000
*             GPR01F,                                              0159 00271000
*             R13,                                                 0159 00272000
*             R14,                                                 0159 00273000
*             R15) UNRSTD;          /*                       @ZA07006*/ 00274000
*         END;                                                     0160 00275000
*       GOTO PERCOL;                /* PERCOLATE                     */ 00276000
         B     PERCOL                                              0161 00277000
*     END;                          /* RETURN                        */ 00278000
*   IF SDWAPERC='0'B THEN           /* THIS IS NOT A PERCOLATION     */ 00279000
@RF00148 TM    SDWAPERC(SDWAPTR),B'00010000'                       0163 00280000
         BNZ   @RF00163                                            0163 00281000
*     IF SDWAMCHK='1'B|SDWAPCHK='1'B THEN/* IF PGM CHK OR MACHINE  0164 00282000
*                                      CHK--                         */ 00283000
         TM    SDWAMCHK(SDWAPTR),B'11000000'                       0164 00284000
         BZ    @RF00164                                            0164 00285000
*       DO;                                                        0165 00286000
*         SDWARCDE=RCDE4;           /* INDICATE RETRY                */ 00287000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0166 00288000
*         SDWARTYA=ADDR(TTRETRY);   /* RETRY AT BEGINNING            */ 00289000
         L     @08,@CV01512                                        0167 00290000
         ST    @08,SDWARTYA(,SDWAPTR)                              0167 00291000
*         SDWAUPRG='1'B;            /* REGS UPDATED FOR RETRY        */ 00292000
         OI    SDWAUPRG(SDWAPTR),B'00001000'                       0168 00293000
*         RECURSE='1'B;                                            0169 00294000
         OI    RECURSE(PARMBASE),B'00010000'                       0169 00295000
*         GOTO RETRN;                                              0170 00296000
         B     RETRN                                               0170 00297000
*       END;                                                       0171 00298000
*   GOTO PERCOL;                    /* PERCOLATE ALL OTHER ERRORS    */ 00299000
         B     PERCOL                                              0172 00300000
*   RFY                                                            0173 00301000
*    (REG1,                                                        0173 00302000
*     R14) RSTD;                    /*                       @ZA07006*/ 00303000
*                                                                  0174 00304000
*/*                                                                  */ 00305000
*/********************************************************************/ 00306000
*/*                         IEAVFARR                                 */ 00307000
*/*   THIS IS THE ENTRY POINT IF THE FRR WAS ENTERED DUE TO ERRORS IN*/ 00308000
*/*   THE FREE ADDRESS SPACE ROUTINE OF IEAVGCAS                     */ 00309000
*/********************************************************************/ 00310000
*                                                                  0174 00311000
*IEAVFARR:                                                         0174 00312000
*   ENTRY;                                                         0174 00313000
*   GENERATE SETS(REG12);                                          0175 00314000
*                                 /* @ZA07006*/                         00315000
EP3      DS    0H                                                       00316000
         LR    REG12,GPR00F               BASE FOR DYNAMIC STORAGE      00317000
         USING @DATD,REG12                                              00318000
*   SDWAPTR=REG1;                   /* BASE FOR SDWA                 */ 00319000
         LR    SDWAPTR,REG1                                        0176 00320000
*   R14SAVE=R14;                                                   0177 00321000
         ST    R14,R14SAVE                                         0177 00322000
*   RFY                                                            0178 00323000
*    (REG1,                                                        0178 00324000
*     R14) UNRSTD;                  /*                       @ZA07006*/ 00325000
*   PARMBASE=SDWAPARM;              /* PTR TO FRR PARM AREA          */ 00326000
         L     PARMBASE,SDWAPARM(,SDWAPTR)                         0179 00327000
*   SDWARCRD='1'B;                  /* INDICATE RECORDING            */ 00328000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0180 00329000
*   SDWAMODN=MODN;                  /* MODULE NAME                   */ 00330000
         MVC   SDWAMODN(8,SDWAPTR),MODN                            0181 00331000
*   SDWACSCT=MODN;                  /* CSECT NAME                    */ 00332000
         MVC   SDWACSCT(8,SDWAPTR),MODN                            0182 00333000
*   SDWAREXN=REXN3;                 /* FRR ROUTINE NAME              */ 00334000
         MVC   SDWAREXN(8,SDWAPTR),REXN3                           0183 00335000
*   IF SDWAFMID¬=SAME THEN          /* IF NOT IN FAILING MEMORY      */ 00336000
         LH    @08,SDWAFMID(,SDWAPTR)                              0184 00337000
         N     @08,@CF01580                                        0184 00338000
         CH    @08,SAME                                            0184 00339000
         BNE   @RT00184                                            0184 00340000
*     GOTO PERCOL;                  /* PERCOLATE                     */ 00341000
*   SDWAUPRG='1'B;                  /* REGS UPDATED FOR RETRY        */ 00342000
         OI    SDWAUPRG(SDWAPTR),B'00001000'                       0186 00343000
*   IF RECURSE='1'B THEN            /* IF RECURSION ENTRY--          */ 00344000
         TM    RECURSE(PARMBASE),B'00010000'                       0187 00345000
         BO    @RT00187                                            0187 00346000
*     GOTO FAILED;                                                 0188 00347000
*   IF SDWAPERC='0'B THEN           /* THIS IS NOT A PERCOLATION     */ 00348000
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0189 00349000
         BNZ   @RF00189                                            0189 00350000
*     IF SDWAMCHK='1'B|SDWAPCHK='1'B THEN/* IF PGM CHK OR MACHINE  0190 00351000
*                                      CHK--                         */ 00352000
         TM    SDWAMCHK(SDWAPTR),B'11000000'                       0190 00353000
         BZ    @RF00190                                            0190 00354000
*       DO;                                                        0191 00355000
*         SDWARCDE=RCDE4;           /* RETRY INDICATOR ON            */ 00356000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0192 00357000
*         RECURSE='1'B;                                            0193 00358000
         OI    RECURSE(PARMBASE),B'00010000'                       0193 00359000
*         IF WDEQ='1'B THEN         /* IF WAIT EL DEQUEUE IN PROCESS    00360000
*                                      RETRY AT DEQUEUE STEP         */ 00361000
         TM    WDEQ(PARMBASE),B'01000000'                          0194 00362000
         BNO   @RF00194                                            0194 00363000
*           DO;                     /* RETURN                        */ 00364000
*             SDWARTYA=ADDR(UNCHAINW);                             0196 00365000
         L     @10,@CV01510                                        0196 00366000
         ST    @10,SDWARTYA(,SDWAPTR)                              0196 00367000
*             GOTO RETRN;                                          0197 00368000
         B     RETRN                                               0197 00369000
*           END;                                                   0198 00370000
*         IF PDEQ='1'B THEN         /* IF POST EL DEQUEUE IN PROCESS,   00371000
*                                      RETRY AT DEQUEUE STEP         */ 00372000
@RF00194 TM    PDEQ(PARMBASE),B'00100000'                          0199 00373000
         BNO   @RF00199                                            0199 00374000
*           DO;                                                    0200 00375000
*             SDWARTYA=ADDR(UNCHAINP);                             0201 00376000
         L     @10,@CV01511                                        0201 00377000
         ST    @10,SDWARTYA(,SDWAPTR)                              0201 00378000
*             GOTO RETRN;           /* RETURN                        */ 00379000
         B     RETRN                                               0202 00380000
*           END;                                                   0203 00381000
*         SDWARTYA=ADDR(FASRETRY);  /* OTHERWISE,RETRY AT START      */ 00382000
@RF00199 L     @08,@CV01513                                        0204 00383000
         ST    @08,SDWARTYA(,SDWAPTR)                              0204 00384000
*         SDWASR01=ASCBSAVE;        /* RESTORE PARM                  */ 00385000
         L     @08,ASCBSAVE(,PARMBASE)                             0205 00386000
         ST    @08,SDWASR01(,SDWAPTR)                              0205 00387000
*         GOTO RETRN;               /* RETURN                        */ 00388000
         B     RETRN                                               0206 00389000
*       END;                                                       0207 00390000
*                                                                  0207 00391000
*   /*****************************************************************/ 00392000
*   /*                                                               */ 00393000
*   /* FOR RECURSION OR NON-RETRYABLE ERRORS, PERCOLATE              */ 00394000
*   /*                                                               */ 00395000
*   /*****************************************************************/ 00396000
*                                                                  0208 00397000
*FAILED:                                                           0208 00398000
*   IF SDWAPCHK='1'B THEN           /* IS THIS A PGM CHK?            */ 00399000
@RF00190 DS    0H                                                  0208 00400000
@RF00189 DS    0H                                                  0208 00401000
FAILED   TM    SDWAPCHK(SDWAPTR),B'01000000'                       0208 00402000
         BNO   @RF00208                                            0208 00403000
*     DO;                                                          0209 00404000
*       RFY                                                        0210 00405000
*        (GPR00F,                                                  0210 00406000
*         GPR01F,                                                  0210 00407000
*         R13,                                                     0210 00408000
*         R14,                                                     0210 00409000
*         R15) RSTD;                /*                       @ZA07006*/ 00410000
*       LDAPTR=PSAAOLD->ASCBLDA;                                   0211 00411000
         L     @10,PSAAOLD                                         0211 00412000
         L     LDAPTR,ASCBLDA(,@10)                                0211 00413000
*       R13=ADDR(CFAPWKAR);                                        0212 00414000
         LA    R13,CFAPWKAR(,LDAPTR)                               0212 00415000
*       R14=PSAAOLD;                                               0213 00416000
         LR    R14,@10                                             0213 00417000
*       LFSDUMP2=LFSDUMP;                                          0214 00418000
         MVC   LFSDUMP2(24),LFSDUMP                                0214 00419000
*       GPR01F=ADDR(LFSDUMP2);                                     0215 00420000
         LA    GPR01F,LFSDUMP2                                     0215 00421000
*       GENERATE;                                                  0216 00422000
     SDUMP ASID=ASCBASID(14),SDATA=(PSA,SQA),BRANCH=YES,MF=(E,(1))      00423000
*       RFY                                                        0217 00424000
*        (GPR00F,                                                  0217 00425000
*         GPR01F,                                                  0217 00426000
*         R13,                                                     0217 00427000
*         R14,                                                     0217 00428000
*         R15) UNRSTD;              /*                       @ZA07006*/ 00429000
*     END;                                                         0218 00430000
*   SDWASALL='1'B;                  /* FREE SALLOC LOCK              */ 00431000
@RF00208 OI    SDWASALL(SDWAPTR),B'00000100'                       0219 00432000
*   SDWAFLLK='1'B;                  /* FREE LOCAL LOCK               */ 00433000
         OI    SDWAFLLK(SDWAPTR),B'00000001'                       0220 00434000
*   GOTO PERCOL;                    /* PERCOLATE ALL ERRORS OTHER  0221 00435000
*                                      THAN PGM AND MACHINE CHKS     */ 00436000
         B     PERCOL                                              0221 00437000
*   END IEAVCARR                                                   0222 00438000
*                                                                  0222 00439000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00440000
*/*%INCLUDE SYSLIB  (AHAFMAIN)                                       */ 00441000
*/*%INCLUDE SYSLIB  (FREEMAIN)                                       */ 00442000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 00443000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 00444000
*/*%INCLUDE SYSLIB  (IHASDUMP)                                       */ 00445000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 00446000
*/*%INCLUDE SYSLIB  (IHALDA  )                                       */ 00447000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 00448000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00449000
*                                                                  0222 00450000
*       ;                                                          0222 00451000
@DATA    DS    0H                                                       00452000
@DATD    DSECT                                                          00453000
         DS    0F                                                       00454000
IEAVCARR CSECT                                                          00455000
         DS    0F                                                       00456000
@CF01560 DC    F'4096'                                                  00457000
@CF01580 DC    XL4'0000FFFF'                                            00458000
@DATD    DSECT                                                          00459000
         DS    0D                                                       00460000
SDUMPPTR DS    A                                                        00461000
FRREPTR  DS    A                                                        00462000
R14SAVE  DS    A                                                        00463000
DUMPRET  DS    A                                                        00464000
LFSDUMP2 DS    CL24                                                     00465000
IEAVCARR CSECT                                                          00466000
         DS    0F                                                       00467000
@SIZDATD DC    AL1(0)                                                   00468000
         DC    AL3(@ENDDATD-@DATD)                                      00469000
@CV01510 DC    V(UNCHAINW)                                              00470000
@CV01511 DC    V(UNCHAINP)                                              00471000
@CV01512 DC    V(TTRETRY)                                               00472000
@CV01513 DC    V(FASRETRY)                                              00473000
@CV01514 DC    V(CASRETRY)                                              00474000
@CV01517 DC    V(NOTAUTH)                                               00475000
@CV01515 DC    V(IEAQSPET)                                              00476000
@CV01509 DC    V(IEAVGCAS)                                              00477000
@CV01508 DC    V(IEAVGFAS)                                              00478000
@CV01516 DC    V(OUT)                                                   00479000
         DS    0D                                                       00480000
SAME     DC    H'0'                                                     00481000
MODN     DC    CL8'IEAVGCAS'                                            00482000
REXN1    DC    CL8'IEAVCARR'                                            00483000
REXN2    DC    CL8'IEAVTTRR'                                            00484000
REXN3    DC    CL8'IEAVFARR'                                            00485000
IEAVCARR CSECT                                                          00486000
LFSDUMP  SDUMP  HDR='PGM CHECK IN IEAVGCAS',MF=L                        00487000
@DATD    DSECT                                                          00488000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00489000
@ENDDATD EQU   *                                                        00490000
IEAVCARR CSECT                                                          00491000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00492000
@01      EQU   01                                                       00493000
@02      EQU   02                                                       00494000
@03      EQU   03                                                       00495000
@04      EQU   04                                                       00496000
@05      EQU   05                                                       00497000
@06      EQU   06                                                       00498000
@07      EQU   07                                                       00499000
@08      EQU   08                                                       00500000
@09      EQU   09                                                       00501000
@10      EQU   10                                                       00502000
@11      EQU   11                                                       00503000
@12      EQU   12                                                       00504000
@13      EQU   13                                                       00505000
@14      EQU   14                                                       00506000
@15      EQU   15                                                       00507000
PARMBASE EQU   @10                                                      00508000
LDAPTR   EQU   @03                                                      00509000
SDWAPTR  EQU   @02                                                      00510000
ASCBPTR  EQU   @07                                                      00511000
REG8     EQU   @08                                                      00512000
REG9     EQU   @09                                                      00513000
GPR01F   EQU   @01                                                      00514000
GPR03F   EQU   @03                                                      00515000
GPR00F   EQU   @00                                                      00516000
R14      EQU   @14                                                      00517000
R15      EQU   @15                                                      00518000
REG1     EQU   @01                                                      00519000
RTCB     EQU   @04                                                      00520000
RASCB    EQU   @07                                                      00521000
REG12    EQU   @12                                                      00522000
R13      EQU   @13                                                      00523000
PSA      EQU   0                                                        00524000
FLCRNPSW EQU   PSA                                                      00525000
FLCROPSW EQU   PSA+8                                                    00526000
FLCICCW2 EQU   PSA+16                                                   00527000
PSAEEPSW EQU   PSA+132                                                  00528000
PSAESPSW EQU   PSA+136                                                  00529000
FLCSVILC EQU   PSAESPSW+1                                               00530000
PSAEPPSW EQU   PSA+140                                                  00531000
FLCPIILC EQU   PSAEPPSW+1                                               00532000
FLCPICOD EQU   PSAEPPSW+2                                               00533000
PSAPICOD EQU   FLCPICOD+1                                               00534000
FLCTEA   EQU   PSAEPPSW+4                                               00535000
FLCPER   EQU   PSA+152                                                  00536000
FLCMCLA  EQU   PSA+168                                                  00537000
FLCIOEL  EQU   FLCMCLA+4                                                00538000
FLCIOA   EQU   FLCMCLA+16                                               00539000
FLCFSA   EQU   FLCMCLA+80                                               00540000
PSATOLD  EQU   PSA+540                                                  00541000
PSAAOLD  EQU   PSA+548                                                  00542000
PSASUPER EQU   PSA+552                                                  00543000
PSASUP1  EQU   PSASUPER                                                 00544000
PSASUP2  EQU   PSASUPER+1                                               00545000
PSASUP3  EQU   PSASUPER+2                                               00546000
PSASUP4  EQU   PSASUPER+3                                               00547000
PSACLHT  EQU   PSA+640                                                  00548000
PSALKSA  EQU   PSA+696                                                  00549000
PSAHLHI  EQU   PSA+760                                                  00550000
PSADSSFL EQU   PSA+836                                                  00551000
PSADSSF1 EQU   PSADSSFL                                                 00552000
PSADSSF3 EQU   PSADSSFL+2                                               00553000
PSADSSF4 EQU   PSADSSFL+3                                               00554000
PSARSVT  EQU   PSA+896                                                  00555000
CVTPTR   EQU   16                                                       00556000
SDWA     EQU   0                                                        00557000
SDWAPARM EQU   SDWA                                                     00558000
SDWAFIOB EQU   SDWA+4                                                   00559000
SDWAABCC EQU   SDWAFIOB                                                 00560000
SDWACMPF EQU   SDWAABCC                                                 00561000
SDWACTL1 EQU   SDWA+8                                                   00562000
SDWACMKA EQU   SDWACTL1                                                 00563000
SDWAMWPA EQU   SDWACTL1+1                                               00564000
SDWAPMKA EQU   SDWACTL1+4                                               00565000
SDWACTL2 EQU   SDWA+16                                                  00566000
SDWACMKP EQU   SDWACTL2                                                 00567000
SDWAMWPP EQU   SDWACTL2+1                                               00568000
SDWAPMKP EQU   SDWACTL2+4                                               00569000
SDWAGRSV EQU   SDWA+24                                                  00570000
SDWANAME EQU   SDWA+88                                                  00571000
SDWAEC1  EQU   SDWA+104                                                 00572000
SDWAEMK1 EQU   SDWAEC1                                                  00573000
SDWAMWP1 EQU   SDWAEC1+1                                                00574000
SDWAINT1 EQU   SDWAEC1+2                                                00575000
SDWANXT1 EQU   SDWAEC1+4                                                00576000
SDWAAEC1 EQU   SDWA+112                                                 00577000
SDWAILC1 EQU   SDWAAEC1+1                                               00578000
SDWAINC1 EQU   SDWAAEC1+2                                               00579000
SDWAICD1 EQU   SDWAINC1+1                                               00580000
SDWAEC2  EQU   SDWA+120                                                 00581000
SDWAEMK2 EQU   SDWAEC2                                                  00582000
SDWAMWP2 EQU   SDWAEC2+1                                                00583000
SDWAINT2 EQU   SDWAEC2+2                                                00584000
SDWANXT2 EQU   SDWAEC2+4                                                00585000
SDWAAEC2 EQU   SDWA+128                                                 00586000
SDWAILC2 EQU   SDWAAEC2+1                                               00587000
SDWAINC2 EQU   SDWAAEC2+2                                               00588000
SDWAICD2 EQU   SDWAINC2+1                                               00589000
SDWASRSV EQU   SDWA+136                                                 00590000
SDWASR01 EQU   SDWASRSV+4                                               00591000
SDWAIDNT EQU   SDWA+200                                                 00592000
SDWAMCH  EQU   SDWA+204                                                 00593000
SDWASTCK EQU   SDWAMCH                                                  00594000
SDWAMCHI EQU   SDWAMCH+8                                                00595000
SDWAMCHS EQU   SDWAMCHI                                                 00596000
SDWAMCHD EQU   SDWAMCHI+1                                               00597000
SDWARSR1 EQU   SDWAMCH+12                                               00598000
SDWARSR2 EQU   SDWAMCH+13                                               00599000
SDWAFLGS EQU   SDWA+232                                                 00600000
SDWAERRA EQU   SDWAFLGS                                                 00601000
SDWAMCHK EQU   SDWAERRA                                                 00602000
SDWAPCHK EQU   SDWAERRA                                                 00603000
SDWAERRB EQU   SDWAFLGS+1                                               00604000
SDWAERRC EQU   SDWAFLGS+2                                               00605000
SDWAPERC EQU   SDWAERRC                                                 00606000
SDWAERRD EQU   SDWAFLGS+3                                               00607000
SDWAFMID EQU   SDWA+236                                                 00608000
SDWAIOFS EQU   SDWA+238                                                 00609000
SDWARTYA EQU   SDWA+240                                                 00610000
SDWACPUA EQU   SDWA+248                                                 00611000
SDWAPARQ EQU   SDWA+252                                                 00612000
SDWARCDE EQU   SDWAPARQ                                                 00613000
SDWAACF2 EQU   SDWAPARQ+1                                               00614000
SDWARCRD EQU   SDWAACF2                                                 00615000
SDWAUPRG EQU   SDWAACF2                                                 00616000
SDWAACF3 EQU   SDWAPARQ+2                                               00617000
SDWASALL EQU   SDWAACF3                                                 00618000
SDWAACF4 EQU   SDWAPARQ+3                                               00619000
SDWAFLLK EQU   SDWAACF4                                                 00620000
SDWALKWA EQU   SDWA+256                                                 00621000
SDWALKWS EQU   SDWALKWA                                                 00622000
SDWARECP EQU   SDWA+292                                                 00623000
SDWAMODN EQU   SDWARECP                                                 00624000
SDWACSCT EQU   SDWARECP+8                                               00625000
SDWAREXN EQU   SDWARECP+16                                              00626000
SDWASNPA EQU   SDWA+320                                                 00627000
SDWADUMP EQU   SDWASNPA                                                 00628000
SDWADPFS EQU   SDWADUMP+1                                               00629000
SDWADDAT EQU   SDWASNPA+4                                               00630000
SDWASDAT EQU   SDWADDAT                                                 00631000
SDWAPDAT EQU   SDWADDAT+2                                               00632000
SDWADPSA EQU   SDWA+328                                                 00633000
SDWADPSL EQU   SDWADPSA                                                 00634000
SDWARA   EQU   SDWA+400                                                 00635000
SDWADPVA EQU   SDWARA+2                                                 00636000
ASCB     EQU   0                                                        00637000
ASCBLDA  EQU   ASCB+48                                                  00638000
ASCBFW1  EQU   ASCB+100                                                 00639000
ASCBRCTF EQU   ASCBFW1+2                                                00640000
ASCBFLG1 EQU   ASCBFW1+3                                                00641000
ASCBDSP1 EQU   ASCB+114                                                 00642000
ASCBFLG2 EQU   ASCB+115                                                 00643000
SDUMP    EQU   0                                                        00644000
SDUSDAT1 EQU   SDUMP+2                                                  00645000
SDUSDAT2 EQU   SDUMP+3                                                  00646000
LDA      EQU   0                                                        00647000
LVSMFLAG EQU   LDA                                                      00648000
CFAPWKAR EQU   LDA+1164                                                 00649000
FRRS     EQU   0                                                        00650000
FRRSHEAD EQU   FRRS                                                     00651000
FRRSENTR EQU   0                                                        00652000
FRRSFLGS EQU   FRRSENTR+4                                               00653000
FRRSFLG1 EQU   FRRSFLGS                                                 00654000
CVTMAP   EQU   0                                                        00655000
CVTDAR   EQU   CVTMAP+72                                                00656000
CVTFLGS1 EQU   CVTDAR                                                   00657000
CVTDCB   EQU   CVTMAP+116                                               00658000
CVTIERLC EQU   CVTMAP+144                                               00659000
CVTOPTA  EQU   CVTMAP+182                                               00660000
CVTOPTB  EQU   CVTMAP+183                                               00661000
CVTGTF   EQU   CVTMAP+236                                               00662000
CVTGTFST EQU   CVTGTF                                                   00663000
CVTGTFS  EQU   CVTGTFST                                                 00664000
CVTSTATE EQU   CVTGTFST                                                 00665000
CVTTMODE EQU   CVTGTFST                                                 00666000
CVTFORM  EQU   CVTGTFST                                                 00667000
CVTAQAVT EQU   CVTMAP+240                                               00668000
CVTTCMFG EQU   CVTAQAVT                                                 00669000
CVTVOLM2 EQU   CVTMAP+244                                               00670000
CVTTATA  EQU   CVTVOLM2                                                 00671000
CVTTSKS  EQU   CVTTATA                                                  00672000
CVTVOLF2 EQU   CVTTSKS                                                  00673000
CVTTAT   EQU   CVTTATA+1                                                00674000
CVTATER  EQU   CVTMAP+248                                               00675000
CVTEXT1  EQU   CVTMAP+252                                               00676000
CVTPURG  EQU   CVTMAP+260                                               00677000
CVTQMSG  EQU   CVTMAP+268                                               00678000
CVTDMSR  EQU   CVTMAP+272                                               00679000
CVTERPV  EQU   CVTMAP+316                                               00680000
CVTINTLA EQU   CVTMAP+320                                               00681000
CVTAPF   EQU   CVTMAP+324                                               00682000
CVTEXT2  EQU   CVTMAP+328                                               00683000
CVTHJES  EQU   CVTMAP+332                                               00684000
CVTPGSIA EQU   CVTMAP+348                                               00685000
CVTA1F1  EQU   CVTMAP+356                                               00686000
CVTSYSK  EQU   CVTMAP+357                                               00687000
CVTVOLM1 EQU   CVTMAP+380                                               00688000
CVTVOLF1 EQU   CVTVOLM1                                                 00689000
CVTATMCT EQU   CVTMAP+388                                               00690000
CVTXTNT1 EQU   0                                                        00691000
CVTXTNT2 EQU   0                                                        00692000
CVTDSSV  EQU   CVTXTNT2                                                 00693000
CVTFLGBT EQU   CVTXTNT2+5                                               00694000
CVTQID   EQU   CVTXTNT2+24                                              00695000
CVTRV400 EQU   CVTXTNT2+52                                              00696000
CVTRV409 EQU   CVTXTNT2+53                                              00697000
CVTATCVT EQU   CVTXTNT2+64                                              00698000
CVTRV429 EQU   CVTXTNT2+84                                              00699000
CVTRV438 EQU   CVTXTNT2+85                                              00700000
CVTRV457 EQU   CVTXTNT2+112                                             00701000
CVTRV466 EQU   CVTXTNT2+113                                             00702000
CVTFIX   EQU   0                                                        00703000
CVTRELNO EQU   CVTFIX+252                                               00704000
PARMS    EQU   0                                                        00705000
RSMBIT   EQU   PARMS                                                    00706000
WDEQ     EQU   PARMS                                                    00707000
PDEQ     EQU   PARMS                                                    00708000
RECURSE  EQU   PARMS                                                    00709000
PAGEADD  EQU   PARMS+4                                                  00710000
ASCBSAVE EQU   PARMS+8                                                  00711000
PAGE     EQU   0                                                        00712000
PSARSVTE EQU   PSARSVT                                                  00713000
PSACSTK  EQU   PSARSVTE                                                 00714000
FRRSPTR  EQU   PSACSTK                                                  00715000
CVTS01   EQU   CVTPGSIA                                                 00716000
CVTLPDIA EQU   CVTS01+12                                                00717000
CVTDIRST EQU   CVTLPDIA                                                 00718000
CVTSLIDA EQU   CVTS01+24                                                00719000
CVTCTLFG EQU   CVTS01+50                                                00720000
CVTCRMN  EQU   CVTS01+156                                               00721000
CVTRV210 EQU   CVTS01+424                                               00722000
CVTRV219 EQU   CVTS01+425                                               00723000
CVTRV228 EQU   CVTS01+426                                               00724000
CVTRV237 EQU   CVTS01+427                                               00725000
CVTMFRTR EQU   CVTS01+452                                               00726000
CVTRV262 EQU   CVTS01+468                                               00727000
CVTRV271 EQU   CVTS01+469                                               00728000
CVTRV280 EQU   CVTS01+470                                               00729000
CVTRV289 EQU   CVTS01+471                                               00730000
CVTGSDA  EQU   CVTS01+600                                               00731000
FLC      EQU   PSA                                                      00732000
*                                      START UNREFERENCED COMPONENTS    00733000
CVTRV628 EQU   CVTS01+728                                               00734000
CVTRV627 EQU   CVTS01+724                                               00735000
CVTRV626 EQU   CVTS01+720                                               00736000
CVTRV625 EQU   CVTS01+716                                               00737000
CVTRV624 EQU   CVTS01+712                                               00738000
CVTRV623 EQU   CVTS01+708                                               00739000
CVTRV622 EQU   CVTS01+704                                               00740000
CVTRV621 EQU   CVTS01+700                                               00741000
CVTRV620 EQU   CVTS01+696                                               00742000
CVTRV619 EQU   CVTS01+692                                               00743000
CVTRV618 EQU   CVTS01+688                                               00744000
CVTRV617 EQU   CVTS01+684                                               00745000
CVTRV616 EQU   CVTS01+680                                               00746000
CVTRV615 EQU   CVTS01+676                                               00747000
CVTRV614 EQU   CVTS01+672                                               00748000
CVTRV613 EQU   CVTS01+668                                               00749000
CVTRV612 EQU   CVTS01+664                                               00750000
CVTRV611 EQU   CVTS01+660                                               00751000
CVTRV610 EQU   CVTS01+656                                               00752000
CVTRV609 EQU   CVTS01+652                                               00753000
CVTRV608 EQU   CVTS01+648                                               00754000
CVTRV607 EQU   CVTS01+644                                               00755000
CVTRV606 EQU   CVTS01+640                                               00756000
CVTRV605 EQU   CVTS01+636                                               00757000
CVTRV604 EQU   CVTS01+632                                               00758000
CVTEFF02 EQU   CVTS01+628                                               00759000
CVTCBBR  EQU   CVTS01+624                                               00760000
CVTSSCR  EQU   CVTS01+620                                               00761000
CVTEVENT EQU   CVTS01+616                                               00762000
CVTCRCA  EQU   CVTS01+612                                               00763000
CVTTPIO  EQU   CVTS01+608                                               00764000
CVTADV   EQU   CVTS01+604                                               00765000
CVTGSDAB EQU   CVTGSDA                                                  00766000
CVTQV3   EQU   CVTS01+596                                               00767000
CVTQV2   EQU   CVTS01+592                                               00768000
CVTQV1   EQU   CVTS01+588                                               00769000
CVTRPT   EQU   CVTS01+584                                               00770000
CVTSSRB  EQU   CVTS01+580                                               00771000
CVTCSDRL EQU   CVTS01+576                                               00772000
CVTEXP1  EQU   CVTS01+572                                               00773000
CVTRMPMT EQU   CVTS01+568                                               00774000
CVTRMPTT EQU   CVTS01+564                                               00775000
CVTVPSA  EQU   CVTS01+560                                               00776000
CVTVSTOP EQU   CVTS01+556                                               00777000
CVTGTFR8 EQU   CVTS01+552                                               00778000
CVTQUIT  EQU   CVTS01+548                                               00779000
CVTVACR  EQU   CVTS01+544                                               00780000
CVTWTCB  EQU   CVTS01+540                                               00781000
CVTSTPRS EQU   CVTS01+536                                               00782000
CVT0PT02 EQU   CVTS01+532                                               00783000
CVTDARCM EQU   CVTS01+528                                               00784000
CVTIRECM EQU   CVTS01+524                                               00785000
CVTJRECM EQU   CVTS01+520                                               00786000
CVTVEMS0 EQU   CVTS01+516                                               00787000
CVTSPFRR EQU   CVTS01+512                                               00788000
CVTRLSTG EQU   CVTS01+508                                               00789000
CVT0TC0A EQU   CVTS01+504                                               00790000
CVTGMBR  EQU   CVTS01+500                                               00791000
CVTLFRM  EQU   CVTS01+496                                               00792000
CVTRMBR  EQU   CVTS01+492                                               00793000
CVTVIOP  EQU   CVTS01+488                                               00794000
CVTRV307 EQU   CVTS01+486                                               00795000
CVTRV306 EQU   CVTS01+484                                               00796000
CVTRV305 EQU   CVTS01+482                                               00797000
CVTRV304 EQU   CVTS01+480                                               00798000
CVTRV303 EQU   CVTS01+478                                               00799000
CVTRV302 EQU   CVTS01+476                                               00800000
CVTTRCA  EQU   CVTS01+472                                               00801000
CVTRV297 EQU   CVTRV289                                                 00802000
CVTRV296 EQU   CVTRV289                                                 00803000
CVTRV295 EQU   CVTRV289                                                 00804000
CVTRV294 EQU   CVTRV289                                                 00805000
CVTRV293 EQU   CVTRV289                                                 00806000
CVTRV292 EQU   CVTRV289                                                 00807000
CVTRV291 EQU   CVTRV289                                                 00808000
CVTRV290 EQU   CVTRV289                                                 00809000
CVTRV288 EQU   CVTRV280                                                 00810000
CVTRV287 EQU   CVTRV280                                                 00811000
CVTRV286 EQU   CVTRV280                                                 00812000
CVTRV285 EQU   CVTRV280                                                 00813000
CVTRV284 EQU   CVTRV280                                                 00814000
CVTRV283 EQU   CVTRV280                                                 00815000
CVTRV282 EQU   CVTRV280                                                 00816000
CVTRV281 EQU   CVTRV280                                                 00817000
CVTRV279 EQU   CVTRV271                                                 00818000
CVTRV278 EQU   CVTRV271                                                 00819000
CVTRV277 EQU   CVTRV271                                                 00820000
CVTRV276 EQU   CVTRV271                                                 00821000
CVTRV275 EQU   CVTRV271                                                 00822000
CVTRV274 EQU   CVTRV271                                                 00823000
CVTRV273 EQU   CVTRV271                                                 00824000
CVTRV272 EQU   CVTRV271                                                 00825000
CVTRV270 EQU   CVTRV262                                                 00826000
CVTRV269 EQU   CVTRV262                                                 00827000
CVTRV268 EQU   CVTRV262                                                 00828000
CVTRV267 EQU   CVTRV262                                                 00829000
CVTRV266 EQU   CVTRV262                                                 00830000
CVTRV265 EQU   CVTRV262                                                 00831000
CVTRV264 EQU   CVTRV262                                                 00832000
CVTRV263 EQU   CVTRV262                                                 00833000
CVTVFP   EQU   CVTS01+464                                               00834000
CVTVSI   EQU   CVTS01+460                                               00835000
CVTVPSIB EQU   CVTS01+456                                               00836000
CVTMFACT EQU   CVTMFRTR                                                 00837000
CVTMFCTL EQU   CVTS01+448                                               00838000
CVTPVBP  EQU   CVTS01+444                                               00839000
CVTPWI   EQU   CVTS01+440                                               00840000
CVTRV254 EQU   CVTS01+438                                               00841000
CVTRV253 EQU   CVTS01+436                                               00842000
CVTRV252 EQU   CVTS01+434                                               00843000
CVTRV251 EQU   CVTS01+433                                               00844000
CVTRV250 EQU   CVTS01+432                                               00845000
CVTRV249 EQU   CVTS01+431                                               00846000
CVTRV248 EQU   CVTS01+430                                               00847000
CVTRV247 EQU   CVTS01+429                                               00848000
CVTRV246 EQU   CVTS01+428                                               00849000
CVTRV245 EQU   CVTRV237                                                 00850000
CVTRV244 EQU   CVTRV237                                                 00851000
CVTRV243 EQU   CVTRV237                                                 00852000
CVTRV242 EQU   CVTRV237                                                 00853000
CVTRV241 EQU   CVTRV237                                                 00854000
CVTRV240 EQU   CVTRV237                                                 00855000
CVTRV239 EQU   CVTRV237                                                 00856000
CVTRV238 EQU   CVTRV237                                                 00857000
CVTRV236 EQU   CVTRV228                                                 00858000
CVTRV235 EQU   CVTRV228                                                 00859000
CVTRV234 EQU   CVTRV228                                                 00860000
CVTRV233 EQU   CVTRV228                                                 00861000
CVTRV232 EQU   CVTRV228                                                 00862000
CVTRV231 EQU   CVTRV228                                                 00863000
CVTRV230 EQU   CVTRV228                                                 00864000
CVTRV229 EQU   CVTRV228                                                 00865000
CVTRV227 EQU   CVTRV219                                                 00866000
CVTRV226 EQU   CVTRV219                                                 00867000
CVTRV225 EQU   CVTRV219                                                 00868000
CVTRV224 EQU   CVTRV219                                                 00869000
CVTRV223 EQU   CVTRV219                                                 00870000
CVTRV222 EQU   CVTRV219                                                 00871000
CVTRV221 EQU   CVTRV219                                                 00872000
CVTRV220 EQU   CVTRV219                                                 00873000
CVTRV218 EQU   CVTRV210                                                 00874000
CVTRV217 EQU   CVTRV210                                                 00875000
CVTRV216 EQU   CVTRV210                                                 00876000
CVTRV215 EQU   CVTRV210                                                 00877000
CVTRV214 EQU   CVTRV210                                                 00878000
CVTRV213 EQU   CVTRV210                                                 00879000
CVTRV212 EQU   CVTRV210                                                 00880000
CVTRV211 EQU   CVTRV210                                                 00881000
CVTLCCAT EQU   CVTS01+420                                               00882000
CVTPCCAT EQU   CVTS01+416                                               00883000
CVTIPCRP EQU   CVTS01+412                                               00884000
CVTIPCRI EQU   CVTS01+408                                               00885000
CVTIPCDS EQU   CVTS01+404                                               00886000
CVTAIDVT EQU   CVTS01+400                                               00887000
CVTSSAP  EQU   CVTS01+396                                               00888000
CVTEHCIR EQU   CVTS01+392                                               00889000
CVTEHDEF EQU   CVTS01+388                                               00890000
CVTDAIR  EQU   CVTS01+384                                               00891000
CVTPERFM EQU   CVTS01+380                                               00892000
CVT044R2 EQU   CVTS01+376                                               00893000
CVTFETCH EQU   CVTS01+372                                               00894000
CVTRSTWD EQU   CVTS01+368                                               00895000
CVTSPOST EQU   CVTS01+364                                               00896000
CVTIOBP  EQU   CVTS01+360                                               00897000
CVTASMVT EQU   CVTS01+356                                               00898000
CVTRECRQ EQU   CVTS01+352                                               00899000
CVTWSAC  EQU   CVTS01+348                                               00900000
CVTRV149 EQU   CVTS01+344                                               00901000
CVTWSAL  EQU   CVTS01+340                                               00902000
CVTSPSA  EQU   CVTS01+336                                               00903000
CVTGLMN  EQU   CVTS01+332                                               00904000
CVTVEAC0 EQU   CVTS01+328                                               00905000
CVT062R1 EQU   CVTS01+324                                               00906000
CVTRPOST EQU   CVTS01+320                                               00907000
CVTDQIQE EQU   CVTS01+316                                               00908000
CVTCSD   EQU   CVTS01+312                                               00909000
CVTLKRMA EQU   CVTS01+308                                               00910000
CVTRSPIE EQU   CVTS01+304                                               00911000
CVTRENQ  EQU   CVTS01+300                                               00912000
CVTLQCB  EQU   CVTS01+296                                               00913000
CVTFQCB  EQU   CVTS01+292                                               00914000
CVTQCS01 EQU   CVTS01+288                                               00915000
CVTAPFT  EQU   CVTS01+284                                               00916000
CVTPARRL EQU   CVTS01+280                                               00917000
CVTVWAIT EQU   CVTS01+276                                               00918000
CVTGSPL  EQU   CVTS01+272                                               00919000
CVTLSMQ  EQU   CVTS01+268                                               00920000
CVTGSMQ  EQU   CVTS01+264                                               00921000
CVTEXPRO EQU   CVTS01+260                                               00922000
CVTOPCTP EQU   CVTS01+256                                               00923000
CVTSIC   EQU   CVTS01+252                                               00924000
CVTTPIOS EQU   CVTS01+248                                               00925000
CVTRTMS  EQU   CVTS01+244                                               00926000
CVTSDBF  EQU   CVTS01+240                                               00927000
CVTSCBP  EQU   CVTS01+236                                               00928000
CVTSDMP  EQU   CVTS01+232                                               00929000
CVTSV60  EQU   CVTS01+228                                               00930000
CVTRTMCT EQU   CVTS01+224                                               00931000
CVTASCBL EQU   CVTS01+220                                               00932000
CVTASCBH EQU   CVTS01+216                                               00933000
CVTGDA   EQU   CVTS01+212                                               00934000
CVTASVT  EQU   CVTS01+208                                               00935000
CVTVVMDI EQU   CVTS01+204                                               00936000
CVTAQTOP EQU   CVTS01+200                                               00937000
CVTIOSCS EQU   CVTS01+196                                               00938000
CVTSDRM  EQU   CVTS01+192                                               00939000
CVTOPTE  EQU   CVTS01+188                                               00940000
CVTSTXU  EQU   CVTS01+184                                               00941000
CVTQUIS  EQU   CVTS01+180                                               00942000
CVTPARS  EQU   CVTS01+176                                               00943000
CVTS1EE  EQU   CVTS01+172                                               00944000
CVTFRAS  EQU   CVTS01+168                                               00945000
CVTQSAS  EQU   CVTS01+164                                               00946000
CVTCRAS  EQU   CVTS01+160                                               00947000
CVTDELCP EQU   CVTS01+152                                               00948000
CVTFRECL EQU   CVTS01+148                                               00949000
CVTGETCL EQU   CVTS01+144                                               00950000
CVTBLDCP EQU   CVTS01+140                                               00951000
CVTAUTHL EQU   CVTS01+136                                               00952000
CVTSCAN  EQU   CVTS01+132                                               00953000
CVTRV144 EQU   CVTS01+130                                               00954000
CVTMAXMP EQU   CVTS01+128                                               00955000
CVTSTCK  EQU   CVTS01+124                                               00956000
CVTRV139 EQU   CVTS01+123                                               00957000
CVTDSSAC EQU   CVTS01+122                                               00958000
CVTRV513 EQU   CVTS01+121                                               00959000
CVTIOSPL EQU   CVTS01+120                                               00960000
CVTPTGT  EQU   CVTS01+116                                               00961000
CVTCSPIE EQU   CVTS01+112                                               00962000
CVTSMFEX EQU   CVTS01+108                                               00963000
CVTOLT0A EQU   CVTS01+104                                               00964000
CVTSRBRT EQU   CVTS01+100                                               00965000
CVTPUTL  EQU   CVTS01+96                                                00966000
CVTRV519 EQU   CVTS01+92                                                00967000
CVTRV327 EQU   CVTS01+88                                                00968000
CVTRV326 EQU   CVTS01+84                                                00969000
CVTRV325 EQU   CVTS01+80                                                00970000
CVTRV324 EQU   CVTS01+76                                                00971000
CVT0VL01 EQU   CVTS01+72                                                00972000
CVTSHRVM EQU   CVTS01+68                                                00973000
CVTRV332 EQU   CVTS01+64                                                00974000
CVTTAS   EQU   CVTS01+60                                                00975000
CVTRSCN  EQU   CVTS01+56                                                00976000
CVTTRAC2 EQU   CVTS01+54                                                00977000
CVTTRACE EQU   CVTS01+52                                                00978000
CVTAPG   EQU   CVTS01+51                                                00979000
CVTSDTRC EQU   CVTCTLFG                                                 00980000
CVTGTRCE EQU   CVTCTLFG                                                 00981000
CVTNOMP  EQU   CVTCTLFG                                                 00982000
CVTRSV79 EQU   CVTCTLFG                                                 00983000
CVTDSTAT EQU   CVTCTLFG                                                 00984000
CVTRSV78 EQU   CVTCTLFG                                                 00985000
CVTRV333 EQU   CVTCTLFG                                                 00986000
CVTRV323 EQU   CVTCTLFG                                                 00987000
CVTSPVLK EQU   CVTS01+49                                                00988000
CVTRSV77 EQU   CVTS01+48                                                00989000
CVTRV331 EQU   CVTS01+44                                                00990000
CVTRV330 EQU   CVTS01+40                                                00991000
CVTRV329 EQU   CVTS01+36                                                00992000
CVTRV328 EQU   CVTS01+32                                                00993000
CVTRV322 EQU   CVTS01+28                                                00994000
CVTSLID  EQU   CVTSLIDA+1                                               00995000
CVTSYLK  EQU   CVTSLIDA                                                 00996000
CVTRV321 EQU   CVTS01+20                                                00997000
CVTRV320 EQU   CVTS01+16                                                00998000
CVTLPDIR EQU   CVTLPDIA+1                                               00999000
CVTRSV69 EQU   CVTDIRST                                                 01000000
CVTRSV68 EQU   CVTDIRST                                                 01001000
CVTRSV67 EQU   CVTDIRST                                                 01002000
CVTRSV66 EQU   CVTDIRST                                                 01003000
CVTRSV65 EQU   CVTDIRST                                                 01004000
CVTRSV64 EQU   CVTDIRST                                                 01005000
CVTRSV63 EQU   CVTDIRST                                                 01006000
CVTDICOM EQU   CVTDIRST                                                 01007000
CVTPVTP  EQU   CVTS01+8                                                 01008000
CVTLPDSR EQU   CVTS01+4                                                 01009000
CVTGETL  EQU   CVTS01                                                   01010000
PSARSAV  EQU   PSARSVTE+60                                              01011000
PSARSTK  EQU   PSARSVTE+56                                              01012000
PSAESAV3 EQU   PSARSVTE+52                                              01013000
PSAESTK3 EQU   PSARSVTE+48                                              01014000
PSAESAV2 EQU   PSARSVTE+44                                              01015000
PSAESTK2 EQU   PSARSVTE+40                                              01016000
PSAESAV1 EQU   PSARSVTE+36                                              01017000
PSAESTK1 EQU   PSARSVTE+32                                              01018000
PSAPSAV  EQU   PSARSVTE+28                                              01019000
PSAPSTK  EQU   PSARSVTE+24                                              01020000
PSAMSAV  EQU   PSARSVTE+20                                              01021000
PSAMSTK  EQU   PSARSVTE+16                                              01022000
PSASSAV  EQU   PSARSVTE+12                                              01023000
PSASSTK  EQU   PSARSVTE+8                                               01024000
PSANSTK  EQU   PSARSVTE+4                                               01025000
SAVESAVE EQU   PARMS+12                                                 01026000
@NM00085 EQU   PARMS                                                    01027000
CVTLEVL  EQU   CVTRELNO+2                                               01028000
CVTNUMB  EQU   CVTRELNO                                                 01029000
CVTMDL   EQU   CVTFIX+250                                               01030000
@NM00084 EQU   CVTFIX+248                                               01031000
@NM00083 EQU   CVTFIX                                                   01032000
CVTRV482 EQU   CVTXTNT2+128                                             01033000
CVTRV481 EQU   CVTXTNT2+124                                             01034000
CVTRV480 EQU   CVTXTNT2+120                                             01035000
CVTRV479 EQU   CVTXTNT2+118                                             01036000
CVTRV478 EQU   CVTXTNT2+117                                             01037000
CVTRV477 EQU   CVTXTNT2+116                                             01038000
CVTRV476 EQU   CVTXTNT2+115                                             01039000
CVTRV475 EQU   CVTXTNT2+114                                             01040000
CVTRV474 EQU   CVTRV466                                                 01041000
CVTRV473 EQU   CVTRV466                                                 01042000
CVTRV472 EQU   CVTRV466                                                 01043000
CVTRV471 EQU   CVTRV466                                                 01044000
CVTRV470 EQU   CVTRV466                                                 01045000
CVTRV469 EQU   CVTRV466                                                 01046000
CVTRV468 EQU   CVTRV466                                                 01047000
CVTRV467 EQU   CVTRV466                                                 01048000
CVTRV465 EQU   CVTRV457                                                 01049000
CVTRV464 EQU   CVTRV457                                                 01050000
CVTRV463 EQU   CVTRV457                                                 01051000
CVTRV462 EQU   CVTRV457                                                 01052000
CVTRV461 EQU   CVTRV457                                                 01053000
CVTRV460 EQU   CVTRV457                                                 01054000
CVTRV459 EQU   CVTRV457                                                 01055000
CVTRV458 EQU   CVTRV457                                                 01056000
CVTRV456 EQU   CVTXTNT2+108                                             01057000
CVTRV455 EQU   CVTXTNT2+104                                             01058000
CVTRV454 EQU   CVTXTNT2+100                                             01059000
CVTRV453 EQU   CVTXTNT2+96                                              01060000
CVTRV452 EQU   CVTXTNT2+94                                              01061000
CVTRV451 EQU   CVTXTNT2+92                                              01062000
CVTRV450 EQU   CVTXTNT2+90                                              01063000
CVTRV449 EQU   CVTXTNT2+88                                              01064000
CVTRV448 EQU   CVTXTNT2+87                                              01065000
CVTRV447 EQU   CVTXTNT2+86                                              01066000
CVTRV446 EQU   CVTRV438                                                 01067000
CVTRV445 EQU   CVTRV438                                                 01068000
CVTRV444 EQU   CVTRV438                                                 01069000
CVTRV443 EQU   CVTRV438                                                 01070000
CVTRV442 EQU   CVTRV438                                                 01071000
CVTRV441 EQU   CVTRV438                                                 01072000
CVTRV440 EQU   CVTRV438                                                 01073000
CVTRV439 EQU   CVTRV438                                                 01074000
CVTRV437 EQU   CVTRV429                                                 01075000
CVTRV436 EQU   CVTRV429                                                 01076000
CVTRV435 EQU   CVTRV429                                                 01077000
CVTRV434 EQU   CVTRV429                                                 01078000
CVTRV433 EQU   CVTRV429                                                 01079000
CVTRV432 EQU   CVTRV429                                                 01080000
CVTRV431 EQU   CVTRV429                                                 01081000
CVTRV430 EQU   CVTRV429                                                 01082000
CVTRV428 EQU   CVTXTNT2+80                                              01083000
CVTRV427 EQU   CVTXTNT2+76                                              01084000
CVTRV426 EQU   CVTXTNT2+72                                              01085000
CVTRV425 EQU   CVTXTNT2+68                                              01086000
CVTATACT EQU   CVTATCVT                                                 01087000
CVTRV423 EQU   CVTXTNT2+62                                              01088000
CVTRV422 EQU   CVTXTNT2+60                                              01089000
CVTRV421 EQU   CVTXTNT2+58                                              01090000
CVTRV420 EQU   CVTXTNT2+56                                              01091000
CVTRV419 EQU   CVTXTNT2+55                                              01092000
CVTRV418 EQU   CVTXTNT2+54                                              01093000
CVTRV417 EQU   CVTRV409                                                 01094000
CVTRV416 EQU   CVTRV409                                                 01095000
CVTRV415 EQU   CVTRV409                                                 01096000
CVTRV414 EQU   CVTRV409                                                 01097000
CVTRV413 EQU   CVTRV409                                                 01098000
CVTRV412 EQU   CVTRV409                                                 01099000
CVTRV411 EQU   CVTRV409                                                 01100000
CVTRV410 EQU   CVTRV409                                                 01101000
CVTRV408 EQU   CVTRV400                                                 01102000
CVTRV407 EQU   CVTRV400                                                 01103000
CVTRV406 EQU   CVTRV400                                                 01104000
CVTRV405 EQU   CVTRV400                                                 01105000
CVTRV404 EQU   CVTRV400                                                 01106000
CVTRV403 EQU   CVTRV400                                                 01107000
CVTRV402 EQU   CVTRV400                                                 01108000
CVTRV401 EQU   CVTRV400                                                 01109000
CVTICB   EQU   CVTXTNT2+48                                              01110000
CVTSKTA  EQU   CVTXTNT2+44                                              01111000
CVTRSV99 EQU   CVTXTNT2+40                                              01112000
CVTRSV98 EQU   CVTXTNT2+36                                              01113000
CVTRSV97 EQU   CVTXTNT2+34                                              01114000
CVTRSV96 EQU   CVTXTNT2+32                                              01115000
CVTOLTEP EQU   CVTXTNT2+28                                              01116000
CVTQIDA  EQU   CVTQID+1                                                 01117000
CVTRSV95 EQU   CVTQID                                                   01118000
CVTRSV94 EQU   CVTXTNT2+20                                              01119000
CVTRSV93 EQU   CVTXTNT2+16                                              01120000
CVTRSV92 EQU   CVTXTNT2+12                                              01121000
CVTDEBVR EQU   CVTXTNT2+8                                               01122000
CVTRSV91 EQU   CVTXTNT2+6                                               01123000
CVTRSV9H EQU   CVTFLGBT                                                 01124000
CVTRSV9G EQU   CVTFLGBT                                                 01125000
CVTRSV9F EQU   CVTFLGBT                                                 01126000
CVTRSV9E EQU   CVTFLGBT                                                 01127000
CVTRSV9D EQU   CVTFLGBT                                                 01128000
CVTRSV9C EQU   CVTFLGBT                                                 01129000
CVTVME   EQU   CVTFLGBT                                                 01130000
CVTNPE   EQU   CVTFLGBT                                                 01131000
CVTNUCLS EQU   CVTXTNT2+4                                               01132000
CVTDSSVA EQU   CVTDSSV+1                                                01133000
CVTRSV89 EQU   CVTDSSV                                                  01134000
CVTRSV88 EQU   CVTXTNT1+8                                               01135000
CVTRSV87 EQU   CVTXTNT1+4                                               01136000
CVTFACHN EQU   CVTXTNT1                                                 01137000
CVTRV488 EQU   CVTMAP+412                                               01138000
CVTRV487 EQU   CVTMAP+408                                               01139000
CVTRV486 EQU   CVTMAP+404                                               01140000
CVTRV485 EQU   CVTMAP+400                                               01141000
CVTACTAP EQU   CVTMAP+396                                               01142000
CVTAUTH  EQU   CVTMAP+392                                               01143000
CVTATMCA EQU   CVTATMCT+1                                               01144000
CVTATMST EQU   CVTATMCT                                                 01145000
CVTRSV61 EQU   CVTMAP+384                                               01146000
CVTVOLT1 EQU   CVTVOLM1+1                                               01147000
CVTVOLI1 EQU   CVTVOLF1                                                 01148000
CVTSTOA  EQU   CVTMAP+376                                               01149000
CVTRSV58 EQU   CVTMAP+374                                               01150000
CVTRSV57 EQU   CVTMAP+372                                               01151000
CVTDDCE  EQU   CVTMAP+368                                               01152000
CVTPNWFR EQU   CVTMAP+364                                               01153000
CVTSMF   EQU   CVTMAP+360                                               01154000
CVTSULK  EQU   CVTMAP+358                                               01155000
CVTSLKO  EQU   CVTSYSK                                                  01156000
CVTSLKP  EQU   CVTSYSK                                                  01157000
CVTSLKQ  EQU   CVTSYSK                                                  01158000
CVTSLKR  EQU   CVTSYSK                                                  01159000
CVTRSV56 EQU   CVTSYSK                                                  01160000
CVTRSV55 EQU   CVTSYSK                                                  01161000
CVTRSV54 EQU   CVTSYSK                                                  01162000
CVTRSV53 EQU   CVTSYSK                                                  01163000
CVTRSV52 EQU   CVTA1F1                                                  01164000
CVTRSV51 EQU   CVTA1F1                                                  01165000
CVTRSV50 EQU   CVTA1F1                                                  01166000
CVTRSV49 EQU   CVTA1F1                                                  01167000
CVTRSV48 EQU   CVTA1F1                                                  01168000
CVTRSV47 EQU   CVTA1F1                                                  01169000
CVTSRSW  EQU   CVTA1F1                                                  01170000
CVTPFSW  EQU   CVTA1F1                                                  01171000
CVTPCVT  EQU   CVTMAP+352                                               01172000
CVTRSV46 EQU   CVTMAP+344                                               01173000
CVTRSV45 EQU   CVTMAP+340                                               01174000
CVTRSV44 EQU   CVTMAP+338                                               01175000
CVTRSV43 EQU   CVTMAP+336                                               01176000
CVTHJESA EQU   CVTHJES+1                                                01177000
CVTRSV42 EQU   CVTHJES                                                  01178000
CVTEXT2A EQU   CVTEXT2+1                                                01179000
CVTRSV41 EQU   CVTEXT2                                                  01180000
CVTAPFA  EQU   CVTAPF+1                                                 01181000
CVTRSV40 EQU   CVTAPF                                                   01182000
CVTRV518 EQU   CVTINTLA                                                 01183000
CVTRV517 EQU   CVTERPV                                                  01184000
CVTEORM  EQU   CVTMAP+312                                               01185000
CVTMCHPR EQU   CVTMAP+308                                               01186000
CVTTZ    EQU   CVTMAP+304                                               01187000
CVTJEPS  EQU   CVTMAP+300                                               01188000
CVTJESCT EQU   CVTMAP+296                                               01189000
CVTMODE  EQU   CVTMAP+292                                               01190000
CVTPTRV  EQU   CVTMAP+288                                               01191000
CVTREAL  EQU   CVTMAP+284                                               01192000
CVTRSV39 EQU   CVTMAP+280                                               01193000
CVTRSV38 EQU   CVTMAP+276                                               01194000
CVTDMSRA EQU   CVTDMSR+1                                                01195000
CVTRSV37 EQU   CVTDMSR                                                  01196000
CVTQMSGA EQU   CVTQMSG+1                                                01197000
CVTRSV36 EQU   CVTQMSG                                                  01198000
CVTAMFF  EQU   CVTMAP+264                                               01199000
CVTPURGA EQU   CVTPURG+1                                                01200000
CVTRSV35 EQU   CVTPURG                                                  01201000
CVTCBSP  EQU   CVTMAP+256                                               01202000
CVTATERA EQU   CVTATER+1                                                01203000
CVTSYST  EQU   CVTATER                                                  01204000
CVTVOLT2 EQU   CVTTAT                                                   01205000
CVTVOLI2 EQU   CVTVOLF2                                                 01206000
CVTAQAVB EQU   CVTAQAVT+1                                               01207000
CVTRSV34 EQU   CVTTCMFG                                                 01208000
CVTRSV33 EQU   CVTTCMFG                                                 01209000
CVTRSV32 EQU   CVTTCMFG                                                 01210000
CVTRSV31 EQU   CVTTCMFG                                                 01211000
CVTRSV30 EQU   CVTTCMFG                                                 01212000
CVTRSV29 EQU   CVTTCMFG                                                 01213000
CVTRSV28 EQU   CVTTCMFG                                                 01214000
CVTTCRDY EQU   CVTTCMFG                                                 01215000
CVTGTFA  EQU   CVTGTF+1                                                 01216000
CVTRSV27 EQU   CVTGTFST                                                 01217000
CVTRNIO  EQU   CVTGTFST                                                 01218000
CVTUSR   EQU   CVTGTFST                                                 01219000
CVTRV318 EQU   CVTFORM                                                  01220000
CVTRV317 EQU   CVTTMODE                                                 01221000
CVTRV316 EQU   CVTSTATE                                                 01222000
CVTRV315 EQU   CVTGTFS                                                  01223000
CVTGTFAV EQU   CVTGTFS                                                  01224000
CVT0SCR1 EQU   CVTMAP+232                                               01225000
CVTRV515 EQU   CVTMAP+228                                               01226000
CVTRMS   EQU   CVTMAP+224                                               01227000
CVTPATCH EQU   CVTMAP+220                                               01228000
CVTTSCE  EQU   CVTMAP+216                                               01229000
CVTLNKSC EQU   CVTMAP+214                                               01230000
CVTQABST EQU   CVTMAP+212                                               01231000
CVTMDLDS EQU   CVTMAP+208                                               01232000
CVTUSER  EQU   CVTMAP+204                                               01233000
CVTABEND EQU   CVTMAP+200                                               01234000
CVTSMCA  EQU   CVTMAP+196                                               01235000
CVTRSV18 EQU   CVTMAP+192                                               01236000
CVTQLPAQ EQU   CVTMAP+188                                               01237000
CVTQCDSR EQU   CVTMAP+184                                               01238000
CVTRSV17 EQU   CVTOPTB                                                  01239000
CVTRSV16 EQU   CVTOPTB                                                  01240000
CVTFP    EQU   CVTOPTB                                                  01241000
CVTAPTHR EQU   CVTOPTB                                                  01242000
CVTNLOG  EQU   CVTOPTB                                                  01243000
CVTTOD   EQU   CVTOPTB                                                  01244000
CVTCTIMS EQU   CVTOPTB                                                  01245000
CVTPROT  EQU   CVTOPTB                                                  01246000
CVTXPFP  EQU   CVTOPTA                                                  01247000
CVTASCII EQU   CVTOPTA                                                  01248000
CVTRSV13 EQU   CVTOPTA                                                  01249000
CVTRSV12 EQU   CVTOPTA                                                  01250000
CVTNIP   EQU   CVTOPTA                                                  01251000
CVTDDR   EQU   CVTOPTA                                                  01252000
CVTAPR   EQU   CVTOPTA                                                  01253000
CVTCCH   EQU   CVTOPTA                                                  01254000
CVTSNCTR EQU   CVTMAP+180                                               01255000
CVTQMWR  EQU   CVTMAP+176                                               01256000
CVTQOCR  EQU   CVTMAP+172                                               01257000
CVT1EF00 EQU   CVTMAP+168                                               01258000
CVTMZ00  EQU   CVTMAP+164                                               01259000
CVTHEAD  EQU   CVTMAP+160                                               01260000
CVTRSV11 EQU   CVTMAP+156                                               01261000
CVT0PT01 EQU   CVTMAP+152                                               01262000
CVTMSER  EQU   CVTMAP+148                                               01263000
CVTRV516 EQU   CVTIERLC                                                 01264000
CVTILCH  EQU   CVTMAP+140                                               01265000
CVT0DS   EQU   CVTMAP+136                                               01266000
CVTFBOSV EQU   CVTMAP+132                                               01267000
CVTNUCB  EQU   CVTMAP+128                                               01268000
CVTIXAVL EQU   CVTMAP+124                                               01269000
CVTIOQET EQU   CVTMAP+120                                               01270000
CVTDCBA  EQU   CVTMAP+117                                               01271000
CVTMVS2  EQU   CVTDCB                                                   01272000
CVT6DAT  EQU   CVTDCB                                                   01273000
CVT4MPS  EQU   CVTDCB                                                   01274000
CVTRSV09 EQU   CVTDCB                                                   01275000
CVT4MS1  EQU   CVTDCB                                                   01276000
CVT2SPS  EQU   CVTDCB                                                   01277000
CVT1SSS  EQU   CVTDCB                                                   01278000
CVTRSV08 EQU   CVTDCB                                                   01279000
CVTSTB   EQU   CVTMAP+112                                               01280000
CVTQTD00 EQU   CVTMAP+108                                               01281000
CVTQTE00 EQU   CVTMAP+104                                               01282000
CVTCUCB  EQU   CVTMAP+100                                               01283000
CVTSJQ   EQU   CVTMAP+96                                                01284000
CVTPBLDL EQU   CVTMAP+92                                                01285000
CVTTPC   EQU   CVTMAP+88                                                01286000
CVTSVDCB EQU   CVTMAP+84                                                01287000
CVTBRET  EQU   CVTMAP+82                                                01288000
CVTEXIT  EQU   CVTMAP+80                                                01289000
CVT0FN00 EQU   CVTMAP+76                                                01290000
CVTDARA  EQU   CVTDAR+1                                                 01291000
CVTRSV07 EQU   CVTFLGS1                                                 01292000
CVTRSV06 EQU   CVTFLGS1                                                 01293000
CVTRSV05 EQU   CVTFLGS1                                                 01294000
CVTRSV04 EQU   CVTFLGS1                                                 01295000
CVTRSV03 EQU   CVTFLGS1                                                 01296000
CVTRSV02 EQU   CVTFLGS1                                                 01297000
CVTRSV01 EQU   CVTFLGS1                                                 01298000
CVTDMPLK EQU   CVTFLGS1                                                 01299000
CVTXITP  EQU   CVTMAP+68                                                01300000
CVTZDTAB EQU   CVTMAP+64                                                01301000
CVTMSLT  EQU   CVTMAP+60                                                01302000
CVTDATE  EQU   CVTMAP+56                                                01303000
CVTBTERM EQU   CVTMAP+52                                                01304000
CVTSYSAD EQU   CVTMAP+48                                                01305000
CVTXTLER EQU   CVTMAP+44                                                01306000
CVTILK2  EQU   CVTMAP+40                                                01307000
CVTILK1  EQU   CVTMAP+36                                                01308000
CVTPRLTV EQU   CVTMAP+32                                                01309000
CVTPCNVT EQU   CVTMAP+28                                                01310000
CVT0VL00 EQU   CVTMAP+24                                                01311000
CVTXAPG  EQU   CVTMAP+20                                                01312000
CVTBUF   EQU   CVTMAP+16                                                01313000
CVTJOB   EQU   CVTMAP+12                                                01314000
CVTLINK  EQU   CVTMAP+8                                                 01315000
CVT0EF00 EQU   CVTMAP+4                                                 01316000
CVTTCBP  EQU   CVTMAP                                                   01317000
CVT      EQU   CVTMAP                                                   01318000
FRRSPARM EQU   FRRSENTR+8                                               01319000
@NM00082 EQU   FRRSFLGS+1                                               01320000
@NM00081 EQU   FRRSFLG1                                                 01321000
FRRSNEST EQU   FRRSFLG1                                                 01322000
FRRSRCUR EQU   FRRSFLG1                                                 01323000
FRRSFRRA EQU   FRRSENTR                                                 01324000
FRRSENTS EQU   FRRS+84                                                  01325000
FRRSRTMW EQU   FRRS+16                                                  01326000
FRRSCURR EQU   FRRSHEAD+12                                              01327000
FRRSELEN EQU   FRRSHEAD+8                                               01328000
FRRSLAST EQU   FRRSHEAD+4                                               01329000
FRRSEMP  EQU   FRRSHEAD                                                 01330000
LDAEND   EQU   LDA+1496                                                 01331000
LCLCELCT EQU   LDA+1492                                                 01332000
LCLCELL  EQU   LDA+1488                                                 01333000
LDALIMIT EQU   LDA+1484                                                 01334000
LDARSVPT EQU   LDA+1480                                                 01335000
LDASRPQE EQU   LDA+1476                                                 01336000
CURRGNTP EQU   LDA+1472                                                 01337000
VVREGSZ  EQU   LDA+1468                                                 01338000
LSQAPTR  EQU   LDA+1464                                                 01339000
CSAVE    EQU   LDA+1100                                                 01340000
OBFRSAVE EQU   LDA+1036                                                 01341000
GFRESAVE EQU   LDA+972                                                  01342000
GMREPSAV EQU   LDA+908                                                  01343000
FBQSAVE  EQU   LDA+844                                                  01344000
G4KSAVE  EQU   LDA+780                                                  01345000
FSAVE    EQU   LDA+716                                                  01346000
BSAVE    EQU   LDA+652                                                  01347000
SAVEREG2 EQU   LDA+588                                                  01348000
BRANCHSV EQU   LDA+524                                                  01349000
GMFMWKAR EQU   LDA+24                                                   01350000
LDARES2  EQU   LDA+21                                                   01351000
LDACBSP  EQU   LDA+20                                                   01352000
LDARQSTA EQU   LDA+16                                                   01353000
LDATCB   EQU   LDA+12                                                   01354000
ASDPQE   EQU   LDA+8                                                    01355000
PASCBSV  EQU   LDA+4                                                    01356000
@NM00080 EQU   LVSMFLAG+1                                               01357000
LDABRSW  EQU   LVSMFLAG                                                 01358000
LDAFPFM  EQU   LVSMFLAG                                                 01359000
LDAFLAGS EQU   LVSMFLAG                                                 01360000
LDASTART EQU   LDA                                                      01361000
@NM00055 EQU   SDUMP+20                                                 01362000
@NM00054 EQU   SDUMP+16                                                 01363000
@NM00053 EQU   SDUMP+12                                                 01364000
@NM00052 EQU   SDUMP+8                                                  01365000
@NM00051 EQU   SDUMP+4                                                  01366000
@NM00050 EQU   SDUSDAT2                                                 01367000
SDUSWA   EQU   SDUSDAT2                                                 01368000
SDUCSA   EQU   SDUSDAT2                                                 01369000
SDUTRT   EQU   SDUSDAT1                                                 01370000
SDULPA   EQU   SDUSDAT1                                                 01371000
SDURGN   EQU   SDUSDAT1                                                 01372000
SDULSQA  EQU   SDUSDAT1                                                 01373000
SDUSQA   EQU   SDUSDAT1                                                 01374000
SDUNUC   EQU   SDUSDAT1                                                 01375000
SDUPSA   EQU   SDUSDAT1                                                 01376000
SDUALPSA EQU   SDUSDAT1                                                 01377000
@NM00049 EQU   SDUMP                                                    01378000
ASCBEND  EQU   ASCB+208                                                 01379000
ASCBSRBT EQU   ASCB+200                                                 01380000
ASCBSWTL EQU   ASCB+196                                                 01381000
ASCBRS14 EQU   ASCB+195                                                 01382000
ASCBSMCT EQU   ASCB+194                                                 01383000
ASCBRS12 EQU   ASCB+192                                                 01384000
ASCBPCTT EQU   ASCB+188                                                 01385000
ASCBVGTT EQU   ASCB+184                                                 01386000
ASCBLGCB EQU   ASCB+180                                                 01387000
ASCBJBNS EQU   ASCB+176                                                 01388000
ASCBJBNI EQU   ASCB+172                                                 01389000
ASCBMCC  EQU   ASCB+168                                                 01390000
ASCBRTWA EQU   ASCB+164                                                 01391000
ASCBIQEA EQU   ASCB+160                                                 01392000
ASCBXMPQ EQU   ASCB+156                                                 01393000
ASCBRS01 EQU   ASCB+154                                                 01394000
ASCBFMCT EQU   ASCB+152                                                 01395000
ASCBOUXB EQU   ASCB+148                                                 01396000
ASCBOUCB EQU   ASCB+144                                                 01397000
ASCBMECB EQU   ASCB+140                                                 01398000
ASCBQECB EQU   ASCB+136                                                 01399000
ASCBCMSB EQU   ASCB+132                                                 01400000
ASCBCMSF EQU   ASCB+128                                                 01401000
ASCBTCBS EQU   ASCB+124                                                 01402000
ASCBNVSC EQU   ASCB+122                                                 01403000
ASCBVSC  EQU   ASCB+120                                                 01404000
ASCBSRBS EQU   ASCB+118                                                 01405000
ASCBSSRB EQU   ASCB+116                                                 01406000
ASCBRV06 EQU   ASCBFLG2                                                 01407000
ASCBRV05 EQU   ASCBFLG2                                                 01408000
ASCBRV04 EQU   ASCBFLG2                                                 01409000
ASCBSNQS EQU   ASCBFLG2                                                 01410000
ASCBS2S  EQU   ASCBFLG2                                                 01411000
ASCBCEXT EQU   ASCBFLG2                                                 01412000
ASCBPXMT EQU   ASCBFLG2                                                 01413000
ASCBXMPT EQU   ASCBFLG2                                                 01414000
ASCBRF07 EQU   ASCBDSP1                                                 01415000
ASCBRF06 EQU   ASCBDSP1                                                 01416000
ASCBRF05 EQU   ASCBDSP1                                                 01417000
ASCBRF04 EQU   ASCBDSP1                                                 01418000
ASCBRF03 EQU   ASCBDSP1                                                 01419000
ASCBRF02 EQU   ASCBDSP1                                                 01420000
ASCBFAIL EQU   ASCBDSP1                                                 01421000
ASCBNOQ  EQU   ASCBDSP1                                                 01422000
ASCBSWCT EQU   ASCB+112                                                 01423000
ASCBASXB EQU   ASCB+108                                                 01424000
ASCBTMCH EQU   ASCB+104                                                 01425000
ASCBNSWP EQU   ASCBFLG1                                                 01426000
ASCBTYP1 EQU   ASCBFLG1                                                 01427000
ASCBSTND EQU   ASCBFLG1                                                 01428000
ASCBABNT EQU   ASCBFLG1                                                 01429000
ASCBTERM EQU   ASCBFLG1                                                 01430000
ASCBS3S  EQU   ASCBFLG1                                                 01431000
ASCBCMSH EQU   ASCBFLG1                                                 01432000
ASCBTOFF EQU   ASCBFLG1                                                 01433000
ASCBRF01 EQU   ASCBRCTF                                                 01434000
ASCBTMLW EQU   ASCBRCTF                                                 01435000
ASCBOUT  EQU   ASCBRCTF                                                 01436000
ASCBWAIT EQU   ASCBRCTF                                                 01437000
ASCBRV08 EQU   ASCBRCTF                                                 01438000
ASCBFQU  EQU   ASCBRCTF                                                 01439000
ASCBFRS  EQU   ASCBRCTF                                                 01440000
ASCBTMNO EQU   ASCBRCTF                                                 01441000
ASCBAFFN EQU   ASCBFW1                                                  01442000
ASCBDUMP EQU   ASCB+96                                                  01443000
ASCBQSVC EQU   ASCB+92                                                  01444000
ASCBUBET EQU   ASCB+88                                                  01445000
ASCBECB  EQU   ASCB+84                                                  01446000
ASCBJSTL EQU   ASCB+80                                                  01447000
ASCBEWST EQU   ASCB+72                                                  01448000
ASCBEJST EQU   ASCB+64                                                  01449000
ASCBTSB  EQU   ASCB+60                                                  01450000
ASCBCSCB EQU   ASCB+56                                                  01451000
ASCBRSM  EQU   ASCB+52                                                  01452000
ASCBSTOR EQU   ASCB+44                                                  01453000
ASCBDP   EQU   ASCB+43                                                  01454000
ASCBRV07 EQU   ASCB+42                                                  01455000
ASCBIOSM EQU   ASCB+40                                                  01456000
ASCBSEQN EQU   ASCB+38                                                  01457000
ASCBASID EQU   ASCB+36                                                  01458000
ASCBCPUS EQU   ASCB+32                                                  01459000
ASCBSPL  EQU   ASCB+28                                                  01460000
ASCBLSLQ EQU   ASCB+24                                                  01461000
ASCBFSLQ EQU   ASCB+20                                                  01462000
ASCBIOSP EQU   ASCB+16                                                  01463000
ASCBLOCK EQU   ASCB+12                                                  01464000
ASCBBWDP EQU   ASCB+8                                                   01465000
ASCBFWDP EQU   ASCB+4                                                   01466000
ASCBASCB EQU   ASCB                                                     01467000
ASCBEGIN EQU   ASCB                                                     01468000
@NM00048 EQU   SDWA+512                                                 01469000
SDWAVRA  EQU   SDWARA+4                                                 01470000
SDWAURAL EQU   SDWARA+3                                                 01471000
@NM00047 EQU   SDWADPVA                                                 01472000
SDWAEBC  EQU   SDWADPVA                                                 01473000
SDWAHEX  EQU   SDWADPVA                                                 01474000
SDWAVRAL EQU   SDWARA                                                   01475000
@NM00046 EQU   SDWA+396                                                 01476000
SDWACOMP EQU   SDWA+392                                                 01477000
SDWARCPL EQU   SDWA+364                                                 01478000
@NM00045 EQU   SDWADPSA+32                                              01479000
SDWATO4  EQU   SDWADPSL+28                                              01480000
SDWAFRM4 EQU   SDWADPSL+24                                              01481000
SDWATO3  EQU   SDWADPSL+20                                              01482000
SDWAFRM3 EQU   SDWADPSL+16                                              01483000
SDWATO2  EQU   SDWADPSL+12                                              01484000
SDWAFRM2 EQU   SDWADPSL+8                                               01485000
SDWATO1  EQU   SDWADPSL+4                                               01486000
SDWAFRM1 EQU   SDWADPSL                                                 01487000
@NM00044 EQU   SDWADDAT+3                                               01488000
@NM00043 EQU   SDWAPDAT                                                 01489000
SDWAUSPL EQU   SDWAPDAT                                                 01490000
SDWADPSW EQU   SDWAPDAT                                                 01491000
SDWATJPA EQU   SDWAPDAT                                                 01492000
SDWATLPA EQU   SDWAPDAT                                                 01493000
SDWADREG EQU   SDWAPDAT                                                 01494000
SDWADSAH EQU   SDWAPDAT                                                 01495000
SDWADSAS EQU   SDWAPDAT                                                 01496000
@NM00042 EQU   SDWADDAT+1                                               01497000
@NM00041 EQU   SDWASDAT                                                 01498000
SDWAQQS  EQU   SDWASDAT                                                 01499000
SDWACBS  EQU   SDWASDAT                                                 01500000
SDWAGTF  EQU   SDWASDAT                                                 01501000
SDWASWA  EQU   SDWASDAT                                                 01502000
SDWALSQA EQU   SDWASDAT                                                 01503000
SDWASQA  EQU   SDWASDAT                                                 01504000
SDWANUC  EQU   SDWASDAT                                                 01505000
@NM00040 EQU   SDWADUMP+2                                               01506000
@NM00039 EQU   SDWADPFS                                                 01507000
SDWASLST EQU   SDWADPFS                                                 01508000
@NM00038 EQU   SDWADPFS                                                 01509000
SDWADLST EQU   SDWADPFS                                                 01510000
SDWADPT  EQU   SDWADPFS                                                 01511000
SDWADPID EQU   SDWADUMP                                                 01512000
SDWADPLA EQU   SDWA+316                                                 01513000
@NM00037 EQU   SDWA+290                                                 01514000
SDWAASID EQU   SDWA+288                                                 01515000
SDWATALW EQU   SDWALKWS+28                                              01516000
SDWATDLW EQU   SDWALKWS+24                                              01517000
SDWATNLW EQU   SDWALKWS+20                                              01518000
SDWAAPLW EQU   SDWALKWS+16                                              01519000
SDWAIPLW EQU   SDWALKWS+12                                              01520000
SDWAILLW EQU   SDWALKWS+8                                               01521000
SDWAIULW EQU   SDWALKWS+4                                               01522000
SDWAICLW EQU   SDWALKWS                                                 01523000
SDWACMS  EQU   SDWAACF4                                                 01524000
SDWAOPTM EQU   SDWAACF4                                                 01525000
SDWATADB EQU   SDWAACF4                                                 01526000
SDWATDNB EQU   SDWAACF4                                                 01527000
SDWATNCB EQU   SDWAACF4                                                 01528000
SDWAILCH EQU   SDWAACF4                                                 01529000
SDWAIUCB EQU   SDWAACF4                                                 01530000
SDWAICAT EQU   SDWAACF3                                                 01531000
SDWAIPRG EQU   SDWAACF3                                                 01532000
SDWAASMP EQU   SDWAACF3                                                 01533000
SDWADISP EQU   SDWAACF3                                                 01534000
@NM00036 EQU   SDWAACF3                                                 01535000
@NM00035 EQU   SDWAACF2                                                 01536000
SDWAFREE EQU   SDWAACF2                                                 01537000
@NM00034 EQU   SDWAACF2                                                 01538000
SDWASPIN EQU   SDWAACF2                                                 01539000
@NM00033 EQU   SDWAACF2                                                 01540000
SDWALCPU EQU   SDWACPUA+2                                               01541000
@NM00032 EQU   SDWACPUA                                                 01542000
SDWARECA EQU   SDWA+244                                                 01543000
@NM00031 EQU   SDWA+239                                                 01544000
@NM00030 EQU   SDWAIOFS                                                 01545000
SDWANIOP EQU   SDWAIOFS                                                 01546000
SDWANOIO EQU   SDWAIOFS                                                 01547000
SDWAIOHT EQU   SDWAIOFS                                                 01548000
SDWAIOQR EQU   SDWAIOFS                                                 01549000
@NM00029 EQU   SDWAERRD                                                 01550000
SDWAMCIV EQU   SDWAERRD                                                 01551000
SDWARPIV EQU   SDWAERRD                                                 01552000
SDWAMABD EQU   SDWAERRD                                                 01553000
SDWACTS  EQU   SDWAERRD                                                 01554000
SDWASTAE EQU   SDWAERRD                                                 01555000
SDWANRBE EQU   SDWAERRD                                                 01556000
SDWACLUP EQU   SDWAERRD                                                 01557000
@NM00028 EQU   SDWAERRC                                                 01558000
SDWAEAS  EQU   SDWAERRC                                                 01559000
SDWAIRB  EQU   SDWAERRC                                                 01560000
SDWASTAI EQU   SDWAERRC                                                 01561000
SDWASTAF EQU   SDWAERRC                                                 01562000
SDWASRBM EQU   SDWAERRB                                                 01563000
SDWALDIS EQU   SDWAERRB                                                 01564000
SDWAENRB EQU   SDWAERRB                                                 01565000
SDWATYP1 EQU   SDWAERRB                                                 01566000
@NM00027 EQU   SDWAERRB                                                 01567000
SDWAPGIO EQU   SDWAERRA                                                 01568000
SDWATEXC EQU   SDWAERRA                                                 01569000
SDWASVCE EQU   SDWAERRA                                                 01570000
SDWAABTM EQU   SDWAERRA                                                 01571000
SDWASVCD EQU   SDWAERRA                                                 01572000
SDWARKEY EQU   SDWAERRA                                                 01573000
SDWATIME EQU   SDWAMCH+20                                               01574000
SDWARFSA EQU   SDWAMCH+16                                               01575000
@NM00026 EQU   SDWAMCH+14                                               01576000
SDWAVEQR EQU   SDWARSR2                                                 01577000
SDWAPGFX EQU   SDWARSR2                                                 01578000
SDWAFLSQ EQU   SDWARSR2                                                 01579000
SDWAFSQA EQU   SDWARSR2                                                 01580000
SDWANUCL EQU   SDWARSR2                                                 01581000
SDWASPER EQU   SDWARSR2                                                 01582000
SDWAINTC EQU   SDWARSR2                                                 01583000
SDWAOFLN EQU   SDWARSR2                                                 01584000
SDWACHNG EQU   SDWARSR1                                                 01585000
SDWAMSER EQU   SDWARSR1                                                 01586000
@NM00025 EQU   SDWARSR1                                                 01587000
SDWACPID EQU   SDWAMCH+10                                               01588000
SDWATERR EQU   SDWAMCHD                                                 01589000
SDWAFPRX EQU   SDWAMCHD                                                 01590000
SDWAINSF EQU   SDWAMCHD                                                 01591000
SDWAACR  EQU   SDWAMCHD                                                 01592000
SDWASCK  EQU   SDWAMCHD                                                 01593000
SDWAPSWU EQU   SDWAMCHD                                                 01594000
SDWAREGU EQU   SDWAMCHD                                                 01595000
SDWASKYF EQU   SDWAMCHD                                                 01596000
@NM00024 EQU   SDWAMCHS                                                 01597000
SDWARSRF EQU   SDWAMCHS                                                 01598000
SDWARSRC EQU   SDWAMCHS                                                 01599000
SDWAINVP EQU   SDWAMCHS                                                 01600000
SDWATSVL EQU   SDWAMCHS                                                 01601000
SDWARCDF EQU   SDWAMCHS                                                 01602000
SDWASRVL EQU   SDWAMCHS                                                 01603000
SDWASCKE EQU   SDWASTCK+4                                               01604000
SDWASCKB EQU   SDWASTCK                                                 01605000
SDWALNTH EQU   SDWAIDNT+1                                               01606000
SDWASPID EQU   SDWAIDNT                                                 01607000
SDWASR15 EQU   SDWASRSV+60                                              01608000
SDWASR14 EQU   SDWASRSV+56                                              01609000
SDWASR13 EQU   SDWASRSV+52                                              01610000
SDWASR12 EQU   SDWASRSV+48                                              01611000
SDWASR11 EQU   SDWASRSV+44                                              01612000
SDWASR10 EQU   SDWASRSV+40                                              01613000
SDWASR09 EQU   SDWASRSV+36                                              01614000
SDWASR08 EQU   SDWASRSV+32                                              01615000
SDWASR07 EQU   SDWASRSV+28                                              01616000
SDWASR06 EQU   SDWASRSV+24                                              01617000
SDWASR05 EQU   SDWASRSV+20                                              01618000
SDWASR04 EQU   SDWASRSV+16                                              01619000
SDWASR03 EQU   SDWASRSV+12                                              01620000
SDWASR02 EQU   SDWASRSV+8                                               01621000
SDWASR00 EQU   SDWASRSV                                                 01622000
SDWATRN2 EQU   SDWAAEC2+4                                               01623000
SDWAIPC2 EQU   SDWAICD2                                                 01624000
SDWAIMC2 EQU   SDWAICD2                                                 01625000
SDWAIPR2 EQU   SDWAICD2                                                 01626000
@NM00023 EQU   SDWAINC2                                                 01627000
@NM00022 EQU   SDWAILC2                                                 01628000
SDWAIL2  EQU   SDWAILC2                                                 01629000
@NM00021 EQU   SDWAILC2                                                 01630000
@NM00020 EQU   SDWAAEC2                                                 01631000
SDWAADD2 EQU   SDWANXT2+1                                               01632000
@NM00019 EQU   SDWANXT2                                                 01633000
@NM00018 EQU   SDWAEC2+3                                                01634000
SDWASGN2 EQU   SDWAINT2                                                 01635000
SDWAEXP2 EQU   SDWAINT2                                                 01636000
SDWADEC2 EQU   SDWAINT2                                                 01637000
SDWAFPO2 EQU   SDWAINT2                                                 01638000
SDWACC2  EQU   SDWAINT2                                                 01639000
@NM00017 EQU   SDWAINT2                                                 01640000
SDWAPGM2 EQU   SDWAMWP2                                                 01641000
SDWAWAT2 EQU   SDWAMWP2                                                 01642000
SDWAMCK2 EQU   SDWAMWP2                                                 01643000
SDWAECT2 EQU   SDWAMWP2                                                 01644000
SDWAKEY2 EQU   SDWAMWP2                                                 01645000
SDWAEXT2 EQU   SDWAEMK2                                                 01646000
SDWAIO2  EQU   SDWAEMK2                                                 01647000
SDWATRM2 EQU   SDWAEMK2                                                 01648000
@NM00016 EQU   SDWAEMK2                                                 01649000
SDWAPER2 EQU   SDWAEMK2                                                 01650000
@NM00015 EQU   SDWAEMK2                                                 01651000
SDWATRAN EQU   SDWAAEC1+4                                               01652000
SDWAIPC1 EQU   SDWAICD1                                                 01653000
SDWAIMC1 EQU   SDWAICD1                                                 01654000
SDWAIPR1 EQU   SDWAICD1                                                 01655000
@NM00014 EQU   SDWAINC1                                                 01656000
@NM00013 EQU   SDWAILC1                                                 01657000
SDWAIL1  EQU   SDWAILC1                                                 01658000
@NM00012 EQU   SDWAILC1                                                 01659000
@NM00011 EQU   SDWAAEC1                                                 01660000
SDWAADD1 EQU   SDWANXT1+1                                               01661000
@NM00010 EQU   SDWANXT1                                                 01662000
@NM00009 EQU   SDWAEC1+3                                                01663000
SDWASGN1 EQU   SDWAINT1                                                 01664000
SDWAEXP1 EQU   SDWAINT1                                                 01665000
SDWADEC1 EQU   SDWAINT1                                                 01666000
SDWAFPO1 EQU   SDWAINT1                                                 01667000
SDWACC1  EQU   SDWAINT1                                                 01668000
@NM00008 EQU   SDWAINT1                                                 01669000
SDWAPGM1 EQU   SDWAMWP1                                                 01670000
SDWAWAT1 EQU   SDWAMWP1                                                 01671000
SDWAMCK1 EQU   SDWAMWP1                                                 01672000
SDWAECT1 EQU   SDWAMWP1                                                 01673000
SDWAKEY1 EQU   SDWAMWP1                                                 01674000
SDWAEXT1 EQU   SDWAEMK1                                                 01675000
SDWAIO1  EQU   SDWAEMK1                                                 01676000
SDWATRM1 EQU   SDWAEMK1                                                 01677000
@NM00007 EQU   SDWAEMK1                                                 01678000
SDWAPER1 EQU   SDWAEMK1                                                 01679000
@NM00006 EQU   SDWAEMK1                                                 01680000
SDWAIOBR EQU   SDWA+100                                                 01681000
SDWAEPA  EQU   SDWA+96                                                  01682000
@NM00005 EQU   SDWANAME+4                                               01683000
SDWARBAD EQU   SDWANAME                                                 01684000
SDWAGR15 EQU   SDWAGRSV+60                                              01685000
SDWAGR14 EQU   SDWAGRSV+56                                              01686000
SDWAGR13 EQU   SDWAGRSV+52                                              01687000
SDWAGR12 EQU   SDWAGRSV+48                                              01688000
SDWAGR11 EQU   SDWAGRSV+44                                              01689000
SDWAGR10 EQU   SDWAGRSV+40                                              01690000
SDWAGR09 EQU   SDWAGRSV+36                                              01691000
SDWAGR08 EQU   SDWAGRSV+32                                              01692000
SDWAGR07 EQU   SDWAGRSV+28                                              01693000
SDWAGR06 EQU   SDWAGRSV+24                                              01694000
SDWAGR05 EQU   SDWAGRSV+20                                              01695000
SDWAGR04 EQU   SDWAGRSV+16                                              01696000
SDWAGR03 EQU   SDWAGRSV+12                                              01697000
SDWAGR02 EQU   SDWAGRSV+8                                               01698000
SDWAGR01 EQU   SDWAGRSV+4                                               01699000
SDWAGR00 EQU   SDWAGRSV                                                 01700000
SDWANXTP EQU   SDWACTL2+5                                               01701000
SDWASGP  EQU   SDWAPMKP                                                 01702000
SDWAEUP  EQU   SDWAPMKP                                                 01703000
SDWADOP  EQU   SDWAPMKP                                                 01704000
SDWAFPP  EQU   SDWAPMKP                                                 01705000
SDWACCP  EQU   SDWAPMKP                                                 01706000
SDWAILP  EQU   SDWAPMKP                                                 01707000
SDWAINTP EQU   SDWACTL2+2                                               01708000
SDWASPVP EQU   SDWAMWPP                                                 01709000
SDWAWATP EQU   SDWAMWPP                                                 01710000
SDWAMCKP EQU   SDWAMWPP                                                 01711000
@NM00004 EQU   SDWAMWPP                                                 01712000
SDWAKEYP EQU   SDWAMWPP                                                 01713000
SDWAEXTP EQU   SDWACMKP                                                 01714000
SDWAIOP  EQU   SDWACMKP                                                 01715000
SDWANXTA EQU   SDWACTL1+5                                               01716000
SDWASGA  EQU   SDWAPMKA                                                 01717000
SDWAEUA  EQU   SDWAPMKA                                                 01718000
SDWADOA  EQU   SDWAPMKA                                                 01719000
SDWAFPA  EQU   SDWAPMKA                                                 01720000
SDWACCA  EQU   SDWAPMKA                                                 01721000
SDWAILA  EQU   SDWAPMKA                                                 01722000
SDWAINTA EQU   SDWACTL1+2                                               01723000
SDWASPVA EQU   SDWAMWPA                                                 01724000
SDWAWATA EQU   SDWAMWPA                                                 01725000
SDWAMCKA EQU   SDWAMWPA                                                 01726000
@NM00003 EQU   SDWAMWPA                                                 01727000
SDWAKEYA EQU   SDWAMWPA                                                 01728000
SDWAEXTA EQU   SDWACMKA                                                 01729000
SDWAIOA  EQU   SDWACMKA                                                 01730000
SDWACMPC EQU   SDWAABCC+1                                               01731000
@NM00002 EQU   SDWACMPF                                                 01732000
SDWASTCC EQU   SDWACMPF                                                 01733000
@NM00001 EQU   SDWACMPF                                                 01734000
SDWASTEP EQU   SDWACMPF                                                 01735000
SDWAREQ  EQU   SDWACMPF                                                 01736000
@NM00079 EQU   PSA+3668                                                 01737000
PSASTAK  EQU   PSA+3072                                                 01738000
@NM00078 EQU   PSA+1040                                                 01739000
PSAUSEND EQU   PSA+1040                                                 01740000
PSARV062 EQU   PSA+1036                                                 01741000
PSAATCVT EQU   PSA+1032                                                 01742000
PSAPCPSW EQU   PSA+1024                                                 01743000
PSAPIR2  EQU   PSA+1020                                                 01744000
PSARV059 EQU   PSA+1018                                                 01745000
PSASVC13 EQU   PSA+1016                                                 01746000
PSALSFCC EQU   PSA+1012                                                 01747000
PSASFACC EQU   PSA+1008                                                 01748000
PSASTOP  EQU   PSA+992                                                  01749000
PSASTART EQU   PSA+976                                                  01750000
PSARSPSW EQU   PSA+968                                                  01751000
PSASRPSW EQU   PSA+960                                                  01752000
PSARV045 EQU   PSA+892                                                  01753000
PSARV044 EQU   PSA+888                                                  01754000
PSARV043 EQU   PSA+884                                                  01755000
PSARV042 EQU   PSA+880                                                  01756000
PSARV041 EQU   PSA+876                                                  01757000
PSARV040 EQU   PSA+872                                                  01758000
PSARV025 EQU   PSA+868                                                  01759000
PSADSSED EQU   PSA+868                                                  01760000
PSADSSPR EQU   PSA+864                                                  01761000
PSADSSFW EQU   PSA+860                                                  01762000
PSADSS14 EQU   PSA+856                                                  01763000
PSADSSPP EQU   PSA+848                                                  01764000
PSADSSRP EQU   PSA+840                                                  01765000
PSADSS05 EQU   PSADSSF4                                                 01766000
PSADSS10 EQU   PSADSSF4                                                 01767000
PSADSSVE EQU   PSADSSF4                                                 01768000
PSADSSDE EQU   PSADSSF4                                                 01769000
PSADSSC0 EQU   PSADSSF4                                                 01770000
PSADSSIE EQU   PSADSSF4                                                 01771000
PSADSS12 EQU   PSADSSF4                                                 01772000
PSADSSRC EQU   PSADSSF4                                                 01773000
PSARV057 EQU   PSADSSF3                                                 01774000
PSARV056 EQU   PSADSSF3                                                 01775000
PSARV055 EQU   PSADSSF3                                                 01776000
PSADSSMC EQU   PSADSSF3                                                 01777000
PSADSSRW EQU   PSADSSF3                                                 01778000
PSADSSNM EQU   PSADSSF3                                                 01779000
PSADSSES EQU   PSADSSF3                                                 01780000
PSADSSGP EQU   PSADSSF3                                                 01781000
PSADSSF2 EQU   PSADSSFL+1                                               01782000
PSADSSPI EQU   PSADSSF1                                                 01783000
PSADSSOI EQU   PSADSSF1                                                 01784000
PSADSSSP EQU   PSADSSF1                                                 01785000
PSADSSTP EQU   PSADSSF1                                                 01786000
PSADSSDW EQU   PSADSSF1                                                 01787000
PSADSSDD EQU   PSADSSF1                                                 01788000
PSADSSDM EQU   PSADSSF1                                                 01789000
PSADSSMV EQU   PSADSSF1                                                 01790000
PSADSSTS EQU   PSA+816                                                  01791000
PSADSSWK EQU   PSA+812                                                  01792000
PSADSSR3 EQU   PSA+808                                                  01793000
PSADSSR2 EQU   PSA+804                                                  01794000
PSADSSRS EQU   PSA+800                                                  01795000
PSASTOR  EQU   PSA+796                                                  01796000
PSACPUSA EQU   PSA+794                                                  01797000
PSAVSTAP EQU   PSA+792                                                  01798000
PSAWKVAP EQU   PSA+788                                                  01799000
PSAWKRAP EQU   PSA+784                                                  01800000
PSAMCHIC EQU   PSA+783                                                  01801000
PSARV061 EQU   PSA+782                                                  01802000
PSASYMSK EQU   PSA+781                                                  01803000
PSAMCHFL EQU   PSA+780                                                  01804000
PSACR0   EQU   PSA+776                                                  01805000
PSAPSWSV EQU   PSA+768                                                  01806000
PSALITA  EQU   PSA+764                                                  01807000
PSACLHS  EQU   PSAHLHI                                                  01808000
PSALKR15 EQU   PSALKSA+60                                               01809000
PSALKR14 EQU   PSALKSA+56                                               01810000
PSALKR13 EQU   PSALKSA+52                                               01811000
PSALKR12 EQU   PSALKSA+48                                               01812000
PSALKR11 EQU   PSALKSA+44                                               01813000
PSALKR10 EQU   PSALKSA+40                                               01814000
PSALKR9  EQU   PSALKSA+36                                               01815000
PSALKR8  EQU   PSALKSA+32                                               01816000
PSALKR7  EQU   PSALKSA+28                                               01817000
PSALKR6  EQU   PSALKSA+24                                               01818000
PSALKR5  EQU   PSALKSA+20                                               01819000
PSALKR4  EQU   PSALKSA+16                                               01820000
PSALKR3  EQU   PSALKSA+12                                               01821000
PSALKR2  EQU   PSALKSA+8                                                01822000
PSALKR1  EQU   PSALKSA+4                                                01823000
PSALKR0  EQU   PSALKSA                                                  01824000
PSARV023 EQU   PSACLHT+52                                               01825000
PSALOCAL EQU   PSACLHT+48                                               01826000
PSACMSL  EQU   PSACLHT+44                                               01827000
PSAOPTL  EQU   PSACLHT+40                                               01828000
PSATPACL EQU   PSACLHT+36                                               01829000
PSATPDNL EQU   PSACLHT+32                                               01830000
PSATPNCL EQU   PSACLHT+28                                               01831000
PSAIOSLL EQU   PSACLHT+24                                               01832000
PSAIOSUL EQU   PSACLHT+20                                               01833000
PSAIOSCL EQU   PSACLHT+16                                               01834000
PSAIOSSL EQU   PSACLHT+12                                               01835000
PSASALCL EQU   PSACLHT+8                                                01836000
PSAASML  EQU   PSACLHT+4                                                01837000
PSADISPL EQU   PSACLHT                                                  01838000
PSASRSA  EQU   PSA+636                                                  01839000
PSARV050 EQU   PSA+634                                                  01840000
PSADSSGO EQU   PSA+633                                                  01841000
PSARECUR EQU   PSA+632                                                  01842000
PSAHLHIS EQU   PSA+628                                                  01843000
PSAIPCSA EQU   PSA+624                                                  01844000
@NM00077 EQU   PSA+621                                                  01845000
PSAIPCDM EQU   PSA+620                                                  01846000
PSAIPCD  EQU   PSA+616                                                  01847000
@NM00076 EQU   PSA+613                                                  01848000
PSAIPCRM EQU   PSA+612                                                  01849000
PSAIPCR  EQU   PSA+608                                                  01850000
PSAMCHEX EQU   PSA+600                                                  01851000
PSAMPSW  EQU   PSA+592                                                  01852000
PSAEXPS2 EQU   PSA+584                                                  01853000
PSAEXPS1 EQU   PSA+576                                                  01854000
PSAPIREG EQU   PSA+572                                                  01855000
PSARSREG EQU   PSA+568                                                  01856000
PSAGPREG EQU   PSA+556                                                  01857000
PSARV022 EQU   PSASUP4                                                  01858000
PSARV021 EQU   PSASUP4                                                  01859000
PSARV020 EQU   PSASUP4                                                  01860000
PSARV019 EQU   PSASUP4                                                  01861000
PSARV018 EQU   PSASUP4                                                  01862000
PSARV017 EQU   PSASUP4                                                  01863000
PSARV016 EQU   PSASUP4                                                  01864000
PSARV015 EQU   PSASUP4                                                  01865000
PSARV014 EQU   PSASUP3                                                  01866000
PSARV013 EQU   PSASUP3                                                  01867000
PSARV012 EQU   PSASUP3                                                  01868000
PSARV011 EQU   PSASUP3                                                  01869000
PSARV010 EQU   PSASUP3                                                  01870000
PSAPSREG EQU   PSASUP3                                                  01871000
PSAPI2   EQU   PSASUP3                                                  01872000
PSAIOSUP EQU   PSASUP3                                                  01873000
PSALCR   EQU   PSASUP2                                                  01874000
PSARTM   EQU   PSASUP2                                                  01875000
PSAACR   EQU   PSASUP2                                                  01876000
PSAIPCE2 EQU   PSASUP2                                                  01877000
PSAIPCES EQU   PSASUP2                                                  01878000
PSAIPCEC EQU   PSASUP2                                                  01879000
PSAGTF   EQU   PSASUP2                                                  01880000
PSAIPCRI EQU   PSASUP2                                                  01881000
PSAIPCRP EQU   PSASUP1                                                  01882000
PSAIPCDR EQU   PSASUP1                                                  01883000
PSADISP  EQU   PSASUP1                                                  01884000
PSALOCK  EQU   PSASUP1                                                  01885000
PSAPI    EQU   PSASUP1                                                  01886000
PSAEXT   EQU   PSASUP1                                                  01887000
PSASVC   EQU   PSASUP1                                                  01888000
PSAIO    EQU   PSASUP1                                                  01889000
PSAANEW  EQU   PSA+544                                                  01890000
PSATNEW  EQU   PSA+536                                                  01891000
PSALCCAR EQU   PSA+532                                                  01892000
PSALCCAV EQU   PSA+528                                                  01893000
PSAPCCAR EQU   PSA+524                                                  01894000
PSAPCCAV EQU   PSA+520                                                  01895000
PSACPULA EQU   PSA+518                                                  01896000
PSACPUPA EQU   PSA+516                                                  01897000
PSAPSA   EQU   PSA+512                                                  01898000
FLCHDEND EQU   PSA+512                                                  01899000
FLCCRSAV EQU   FLCMCLA+280                                              01900000
FLCGRSAV EQU   FLCMCLA+216                                              01901000
FLCFPSAV EQU   FLCMCLA+184                                              01902000
FLCFLA   EQU   FLCMCLA+88                                               01903000
FLCRGNCD EQU   FLCMCLA+84                                               01904000
FLCFSAA  EQU   FLCFSA+1                                                 01905000
@NM00075 EQU   FLCFSA                                                   01906000
@NM00074 EQU   FLCMCLA+72                                               01907000
FLCMCIC  EQU   FLCMCLA+64                                               01908000
@NM00073 EQU   FLCMCLA+20                                               01909000
FLCIOAA  EQU   FLCIOA+1                                                 01910000
@NM00072 EQU   FLCIOA                                                   01911000
@NM00071 EQU   FLCMCLA+15                                               01912000
@NM00070 EQU   FLCMCLA+14                                               01913000
@NM00069 EQU   FLCMCLA+12                                               01914000
FLCLCL   EQU   FLCMCLA+8                                                01915000
FLCIOELA EQU   FLCIOEL+1                                                01916000
@NM00068 EQU   FLCIOEL                                                  01917000
FLCCHNID EQU   FLCMCLA                                                  01918000
@NM00067 EQU   PSA+160                                                  01919000
FLCMTRCD EQU   PSA+157                                                  01920000
@NM00066 EQU   PSA+156                                                  01921000
FLCPERA  EQU   FLCPER+1                                                 01922000
@NM00065 EQU   FLCPER                                                   01923000
@NM00064 EQU   PSA+151                                                  01924000
FLCPERCD EQU   PSA+150                                                  01925000
FLCMCNUM EQU   PSA+149                                                  01926000
@NM00063 EQU   PSA+148                                                  01927000
FLCTEAA  EQU   FLCTEA+1                                                 01928000
@NM00062 EQU   FLCTEA                                                   01929000
PSAPIPC  EQU   PSAPICOD                                                 01930000
PSAPIMC  EQU   PSAPICOD                                                 01931000
PSAPIPER EQU   PSAPICOD                                                 01932000
PSARV049 EQU   FLCPICOD                                                 01933000
FLCPILCB EQU   FLCPIILC                                                 01934000
@NM00061 EQU   FLCPIILC                                                 01935000
@NM00060 EQU   PSAEPPSW                                                 01936000
FLCSVCN  EQU   PSAESPSW+2                                               01937000
FLCSILCB EQU   FLCSVILC                                                 01938000
@NM00059 EQU   FLCSVILC                                                 01939000
@NM00058 EQU   PSAESPSW                                                 01940000
FLCEICOD EQU   PSAEEPSW+2                                               01941000
PSASPAD  EQU   PSAEEPSW                                                 01942000
@NM00057 EQU   PSA+128                                                  01943000
FLCINPSW EQU   PSA+120                                                  01944000
FLCMNPSW EQU   PSA+112                                                  01945000
FLCPNPSW EQU   PSA+104                                                  01946000
FLCSNPSW EQU   PSA+96                                                   01947000
FLCENPSW EQU   PSA+88                                                   01948000
FLCTRACE EQU   PSA+84                                                   01949000
FLCTIMER EQU   PSA+80                                                   01950000
FLCCVT2  EQU   PSA+76                                                   01951000
FLCCAW   EQU   PSA+72                                                   01952000
FLCCSW   EQU   PSA+64                                                   01953000
FLCIOPSW EQU   PSA+56                                                   01954000
FLCMOPSW EQU   PSA+48                                                   01955000
FLCPOPSW EQU   PSA+40                                                   01956000
FLCSOPSW EQU   PSA+32                                                   01957000
FLCEOPSW EQU   PSA+24                                                   01958000
@NM00056 EQU   FLCICCW2+4                                               01959000
FLCCVT   EQU   FLCICCW2                                                 01960000
FLCICCW1 EQU   FLCROPSW                                                 01961000
FLCIPPSW EQU   FLCRNPSW                                                 01962000
*                                      END UNREFERENCED COMPONENTS      01963000
@RT00076 EQU   PERCOL                                                   01964000
@RT00146 EQU   PERCOL                                                   01965000
@RF00150 EQU   PERCOL                                                   01966000
@RF00164 EQU   PERCOL                                                   01967000
@RF00163 EQU   PERCOL                                                   01968000
@RT00184 EQU   PERCOL                                                   01969000
@RT00187 EQU   FAILED                                                   01970000
@ENDDATA EQU   *                                                        01971000
         END   IEAVCARR,(C'PLS2104',0701,75314)                         01972000
./  ADD  SSI=62390179,NAME=IEAVCKEY
         TITLE '** IEAVCKEY-VS2/SU7 CHANGE STORAGE PROTECT KEY ROUTINE *00001000
                **      '                                               00002000
IEAVCKEY CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IEAVCKEY  76.239'                                 0001 00009000
CKEYRTRY DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00241-CKEYRTRY)                                   00013000
         ENTRY CKEYRTRY                                                 00014000
         DROP  @15                                                      00015000
@PROLOG  AH    @15,4(,@15)                                         0001 00016000
         BR    @15                                                 0001 00017000
@EP00001 DS    0H                                                  0002 00018000
*                                     /*ENTRY LINKAGE                   00019000
         USING PSA,0                  ADDRESS LOW STORAGE               00020000
         L     @15,PSAAOLD            ADDRESS                           00021000
         USING ASCB,@15                 CURRENT ASCB                    00022000
         L     @15,ASCBLDA            ADDRESS                           00023000
         USING LDA,@15                  LDA                             00024000
         LA    @15,CFAPWKAR           TEMP ADDRESSABILITY               00025000
         USING @DATD,@15                FOR WORK/SAVE AREA              00026000
*                                                                       00027000
*        THE 75-WORD AREA, CFAPWKAR, IN THE LDA IS USED AS A WORK/SAVE  00028000
*        AREA TO ACHIEVE REENTRANT ATTRIBUTE.                           00029000
*                                                                       00030000
         STM   @00,@14,SAVEREGS       SAVE CALLER'S REGS                00031000
*                                                                       00032000
*        IF THE CALLING PGM IS NOT PSW KEY 0, A PGM CHECK WILL RESULT   00033000
*        FROM EXECUTION OF THIS INSTRUCTION.                            00034000
*                                                                       00035000
         DROP  @15                                                      00036000
         LR    @09,@15                DATAREG                           00037000
         USING @DATD,@09              ADDRESS WORK/SAVE AREA            00038000
         BALR  @10,0                  CODEREG                           00039000
         USING *,@10                  ADDRESSABILITY FOR MODULE         00040000
FRRON   SETFRR A,FRRAD=CKFRR,PARMAD=PARMPTR,WRKREGS=(REG03,REG04),    --00041000
               RELATED=(FRR,CKEY(FRROFF,FRROFF2))                       00042000
*   CKEYBASE=REG10;                 /* INITIALIZE FRR PARM AREA      */ 00043000
         L     @12,PARMPTR                                         0042 00044000
         ST    REG10,CKEYBASE(,@12)                                0042 00045000
*   IF REQUEST=LTYPE THEN           /* DETERMINE INTERFACE USED      */ 00046000
         CLI   REQUEST,128                                         0043 00047000
         BNE   @RF00043                                            0043 00048000
*     CALL LISTPROC;                /* PROCESS L-TYPE REQUESTS       */ 00049000
         BAL   @14,LISTPROC                                        0044 00050000
*   ELSE                                                           0045 00051000
*     CALL REGPROC;                 /* PROCESS R-TYPE REQUESTS       */ 00052000
         B     @RC00043                                            0045 00053000
@RF00043 BAL   @14,REGPROC                                         0045 00054000
*   GEN SETS(REG03,REG04);                                         0046 00055000
@RC00043 DS    0H                                                  0046 00056000
*                       /*                                              00057000
FRROFF   SETFRR D,WRKREGS=(REG03,REG04),RELATED=(FRR,CKEY(FRRON))       00058000
*   IF RETCODE¬=0 THEN              /* TEST RETURN CODE              */ 00059000
         LTR   RETCODE,RETCODE                                     0047 00060000
         BZ    @RF00047                                            0047 00061000
*     DO;                           /* ABEND(O8F) SYSTEM             */ 00062000
*       RESPECIFY                                                  0049 00063000
*        (GPR01F) RESTRICTED;                                      0049 00064000
*       GPR01F=((O8F)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19    */ 00065000
         LA    GPR01F,143                                          0050 00066000
         N     GPR01F,@CF01514                                     0050 00067000
         SLA   GPR01F,12                                           0050 00068000
*       SVC(13);                    /* ISSUE ABEND SVC               */ 00069000
         SVC   13                                                  0051 00070000
*       RESPECIFY                                                  0052 00071000
*        (GPR01F) UNRESTRICTED;                                    0052 00072000
*     END;                          /* ABEND(O8F) SYSTEM NOT ZERO: 0053 00073000
*                                      CHANGE KEY FAILED             */ 00074000
*   REG00=OLDKEYFP;                 /* ZERO: CHANGE KEY SUCCESSFUL.     00075000
*                                      RETURN ORIGINAL STORAGE KEY   */ 00076000
@RF00047 SLR   REG00,REG00                                         0054 00077000
         IC    REG00,OLDKEYFP                                      0054 00078000
*   GEN REFS(SAVEREGS);                                            0055 00079000
*                             /*                                        00080000
         LM    @01,@14,INR1           RESTORE CALLER'S REGS             00081000
*   RETURN;                         /* RETURN TO CALLING PGM         */ 00082000
@EL00001 DS    0H                                                  0056 00083000
@EF00001 DS    0H                                                  0056 00084000
@ER00001 BR    @14                                                 0056 00085000
*                                                                  0057 00086000
*   /*****************************************************************/ 00087000
*   /*                                                               */ 00088000
*   /* ROUTINE TO PROCESS R-TYPE REQUESTS                            */ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                                  0057 00092000
*REGPROC:                                                          0057 00093000
*   PROC OPTIONS(NOSAVE);                                          0057 00094000
REGPROC  DS    0H                                                  0058 00095000
*   RETAD1=REG14;                   /* SAVE RETURN ADDRESS           */ 00096000
         ST    REG14,RETAD1                                        0058 00097000
*   FLAGS=0;                        /* INTERNAL INDICATORS OFF       */ 00098000
         MVI   FLAGS,X'00'                                         0059 00099000
*   ELTAD=ADDR(INR1);               /* ONE VA RANGE GIVEN BY INPUT R1   00100000
*                                      AND R2                        */ 00101000
*                                                                  0060 00102000
         LA    @12,INR1                                            0060 00103000
         ST    @12,ELTAD                                           0060 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* VALIDITY CHECK INPUT PARAMETERS: STORAGE DEFINED BY VA RANGE  */ 00107000
*   /* MUST BE IN PROBLEM PROGRAM SUBPOOLS                           */ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                                  0061 00111000
*   CALL PAGEVCK;                   /* VALIDITY CHECK: STORAGE IN  0061 00112000
*                                      PROBLEM PROGRAM SUBPOOLS      */ 00113000
         BAL   @14,PAGEVCK                                         0061 00114000
*   IF RETCODE=0 THEN               /* TEST RETURN CODE              */ 00115000
         LTR   RETCODE,RETCODE                                     0062 00116000
         BNZ   @RF00062                                            0062 00117000
*     DO;                           /* RC ZERO: VA RANGE VALID       */ 00118000
*       SAVEKEY=YES;                /* SAVE ORIGINAL KEY             */ 00119000
         OI    SAVEKEY,B'10000000'                                 0064 00120000
*       GEN REFS(PSALITA,FLC) SETS(REG11,REG12,REG13);             0065 00121000
*                                                   /*OBTAIN SALLOC     00122000
LOCKON   SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                      --00123000
               RELATED=(PAGES,CKEY(LOCKOFF))                            00124000
*       LPC=NONE;                   /* NO KEY FOR ANY PAGE CHANGED   */ 00125000
*                                                                  0066 00126000
         SLR   @12,@12                                             0066 00127000
         ST    @12,LPC                                             0066 00128000
*       /*************************************************************/ 00129000
*       /*                                                           */ 00130000
*       /* CHANGE STORAGE KEY: THE XPTPROT FIELD IN THE XPTE AND THE */ 00131000
*       /* HARDWARE KEY FOR EACH PAGE IS CHANGED                     */ 00132000
*       /*                                                           */ 00133000
*       /*************************************************************/ 00134000
*                                                                  0067 00135000
*       CALL ELTPROC;               /* CHANGE STORAGE KEY FOR RANGE  */ 00136000
         BAL   @14,ELTPROC                                         0067 00137000
*       IF RETCODE¬=0 THEN          /* TEST RETURN CODE              */ 00138000
         LTR   RETCODE,RETCODE                                     0068 00139000
         BZ    @RF00068                                            0068 00140000
*         CALL RECOVER;             /* RC NOT ZERO: CHANGE         0069 00141000
*                                      INCOMPLETE, RESTORE ORIGINAL     00142000
*                                      KEY                           */ 00143000
         BAL   @14,RECOVER                                         0069 00144000
*       ELSE                                                       0070 00145000
*         ;                         /* RC ZERO: KEY CHANGED          */ 00146000
@RF00068 DS    0H                                                  0071 00147000
*       GEN REFS(PSALITA,FLC) SETS(REG11,REG12,REG13);             0071 00148000
*                                                  /*RELEASE SALLOC     00149000
LOCKOFF  SETLOCK RELEASE,TYPE=SALLOC,                                 --00150000
               RELATED=(PAGES,CKEY(LOCKON))                             00151000
*     END;                                                         0072 00152000
*   ELSE                                                           0073 00153000
*     ;                             /* RC NOT ZERO: VA RANGE INVALID    00154000
*                                      , KEY NOT CHANGED             */ 00155000
@RF00062 DS    0H                                                  0074 00156000
*   REG14=RETAD1;                   /* RESTORE RETURN ADDRESS        */ 00157000
         L     REG14,RETAD1                                        0074 00158000
*   RETURN CODE(RETCODE);           /* RETURN TO TOP ROUTINE         */ 00159000
@EL00002 DS    0H                                                  0075 00160000
@EF00002 DS    0H                                                  0075 00161000
@ER00002 BR    @14                                                 0075 00162000
*   END REGPROC;                                                   0076 00163000
*                                                                  0077 00164000
*   /*****************************************************************/ 00165000
*   /*                                                               */ 00166000
*   /* ROUTINE TO PROCESS L-TYPE REQUESTS                            */ 00167000
*   /*                                                               */ 00168000
*   /*****************************************************************/ 00169000
*                                                                  0077 00170000
*LISTPROC:                                                         0077 00171000
*   PROC OPTIONS(NOSAVE);                                          0077 00172000
LISTPROC DS    0H                                                  0078 00173000
*   RETAD1=REG14;                   /* SAVE RETURN ADDRESS           */ 00174000
         ST    REG14,RETAD1                                        0078 00175000
*   FLAGS=0;                        /* INTERNAL INDICATORS OFF       */ 00176000
         MVI   FLAGS,X'00'                                         0079 00177000
*   LPC=NONE;                       /* NO KEY FOR ANY PAGE CHANGED   */ 00178000
         SLR   @12,@12                                             0080 00179000
         ST    @12,LPC                                             0080 00180000
*   ELTAD=INR1-LENGTH(LISTELT);     /* ADDRESS-8 OF FIRST ELEMENT IN    00181000
*                                      LIST                          */ 00182000
         L     @12,INR1                                            0081 00183000
         SL    @12,@CF00068                                        0081 00184000
         ST    @12,ELTAD                                           0081 00185000
*   GEN REFS(PSALITA,FLC) SETS(REG11,REG12,REG13);                 0082 00186000
*                                                                  0082 00187000
*                                                   /*OBTAIN SALLOC     00188000
LOCKON2  SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                      --00189000
               RELATED=(PAGES,CKEY(LOCKOFF2))                           00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* VALIDITY CHECK INPUT PARAMETERS: PARAMETER LIST MUST BE IN    */ 00193000
*   /* FIXED STORAGE. STORAGE DEFINED BY EACH ELEMENT IN LIST MUST BE*/ 00194000
*   /* IN PROBLEM PROGRAM SUBPOOLS                                   */ 00195000
*   /*                                                               */ 00196000
*   /*****************************************************************/ 00197000
*                                                                  0083 00198000
*   DO UNTIL(ERROR=YES|LASTELT=YES);/* CHECK EACH ELT IN LIST OR   0083 00199000
*                                      UNTIL ERROR IS DETECTED       */ 00200000
@DL00083 DS    0H                                                  0084 00201000
*     ELTAD=ELTAD+LENGTH(LISTELT);  /* LIST ELEMENT ADDRESS          */ 00202000
         LA    @12,8                                               0084 00203000
         AL    @12,ELTAD                                           0084 00204000
         ST    @12,ELTAD                                           0084 00205000
*     CALL ELTVCK;                  /* VALIDITY CHECK: ELT IN FIXED     00206000
*                                      STORAGE                       */ 00207000
         BAL   @14,ELTVCK                                          0085 00208000
*     IF RETCODE=0 THEN             /* TEST RETURN CODE              */ 00209000
         LTR   RETCODE,RETCODE                                     0086 00210000
         BNZ   @RF00086                                            0086 00211000
*       DO;                         /* RC ZERO: ELEMENT VALID        */ 00212000
*         CALL PAGEVCK;             /* VALIDITY CHECK: VA RANGE IN 0088 00213000
*                                      PROBLEM PGM SUBPOOLS          */ 00214000
         BAL   @14,PAGEVCK                                         0088 00215000
*         IF RETCODE¬=0 THEN        /* TEST RETURN CODE              */ 00216000
         LTR   RETCODE,RETCODE                                     0089 00217000
         BZ    @RF00089                                            0089 00218000
*           ERROR=YES;              /* RC NOT ZERO: RANGE INVALID    */ 00219000
         OI    ERROR,B'01000000'                                   0090 00220000
*         ELSE                                                     0091 00221000
*           ;                       /* RC ZERO:RANGE VALID           */ 00222000
@RF00089 DS    0H                                                  0092 00223000
*       END;                                                       0092 00224000
*     ELSE                          /* RC NOT ZERO: ELT INVALID      */ 00225000
*       ERROR=YES;                  /* INDICATE ERROR CONDITION      */ 00226000
         B     @RC00086                                            0093 00227000
@RF00086 OI    ERROR,B'01000000'                                   0093 00228000
*   END;                                                           0094 00229000
*                                                                  0094 00230000
@RC00086 DS    0H                                                  0094 00231000
@DE00083 TM    ERROR,B'01000000'                                   0094 00232000
         BO    @DC00083                                            0094 00233000
         L     @12,ELTAD                                           0094 00234000
         TM    LASTELT(@12),B'10000000'                            0094 00235000
         BNO   @DL00083                                            0094 00236000
@DC00083 DS    0H                                                  0095 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* CHANGE STORAGE KEY: THE FIELD XPTPROT IN THE XPTE AND THE     */ 00240000
*   /* HARDWARE KEY FOR EACH PAGE IS CHANGED                         */ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0095 00244000
*   IF ERROR=NO THEN                /* WAS AN ERROR DETECTED ?       */ 00245000
         TM    ERROR,B'01000000'                                   0095 00246000
         BNZ   @RF00095                                            0095 00247000
*     DO;                           /* NO: CONTINUE KEY PROCESSING   */ 00248000
*       ELTAD=INR1-LENGTH(LISTELT); /* ADDRESS-8 OF FIRST ELT IN LIST*/ 00249000
         L     @12,INR1                                            0097 00250000
         SL    @12,@CF00068                                        0097 00251000
         ST    @12,ELTAD                                           0097 00252000
*       SAVEKEY=YES;                /* SAVE ORIGINAL KEY             */ 00253000
         OI    SAVEKEY,B'10000000'                                 0098 00254000
*       DO UNTIL(LASTELT=YES|ERROR=YES);/* CHANGE KEY OF ALL RANGES     00255000
*                                      OR UNTIL ERROR IS DETECTED    */ 00256000
@DL00099 DS    0H                                                  0100 00257000
*         ELTAD=ELTAD+LENGTH(LISTELT);/* LIST ELEMENT ADDRESS        */ 00258000
         LA    @12,8                                               0100 00259000
         AL    @12,ELTAD                                           0100 00260000
         ST    @12,ELTAD                                           0100 00261000
*         CALL ELTPROC;             /* CHANGE KEY OF SINGLE RANGE    */ 00262000
         BAL   @14,ELTPROC                                         0101 00263000
*         IF RETCODE¬=0 THEN        /* TEST RETURN CODE              */ 00264000
         LTR   RETCODE,RETCODE                                     0102 00265000
         BZ    @RF00102                                            0102 00266000
*           DO;                                                    0103 00267000
*             ERROR=YES;            /* INDICATE ERROR CONDITION      */ 00268000
         OI    ERROR,B'01000000'                                   0104 00269000
*             CALL RECOVER;         /* RESTORE ORIGINAL KEY          */ 00270000
         BAL   @14,RECOVER                                         0105 00271000
*           END;                                                   0106 00272000
*         ELSE                                                     0107 00273000
*           ;                       /* RC ZERO: KEY CHANGED          */ 00274000
@RF00102 DS    0H                                                  0108 00275000
*       END;                                                       0108 00276000
@DE00099 L     @12,ELTAD                                           0108 00277000
         TM    LASTELT(@12),B'10000000'                            0108 00278000
         BO    @DC00099                                            0108 00279000
         TM    ERROR,B'01000000'                                   0108 00280000
         BNO   @DL00099                                            0108 00281000
@DC00099 DS    0H                                                  0109 00282000
*     END;                                                         0109 00283000
*   ELSE                                                           0110 00284000
*     ;                             /* YES: KEY UNCHANGED            */ 00285000
@RF00095 DS    0H                                                  0111 00286000
*   GEN REFS(PSALITA,FLC) SETS(REG11,REG12,REG13);                 0111 00287000
*                                                /*RELEASE SALLOC       00288000
LOCKOFF2 SETLOCK RELEASE,TYPE=SALLOC,                                 --00289000
               RELATED=(PAGES,CKEY(LOCKON2))                            00290000
*   REG14=RETAD1;                   /* RESTORE RETURN ADDRESS        */ 00291000
         L     REG14,RETAD1                                        0112 00292000
*   RETURN CODE(RETCODE);           /* RETURN TO TOP ROUTINE         */ 00293000
@EL00003 DS    0H                                                  0113 00294000
@EF00003 DS    0H                                                  0113 00295000
@ER00003 BR    @14                                                 0113 00296000
*   END LISTPROC;                                                  0114 00297000
*                                                                  0115 00298000
*   /*****************************************************************/ 00299000
*   /*                                                               */ 00300000
*   /* ROUTINE TO CHANGE THE KEY OF THE STORAGE AREA DEFINED BY ONE  */ 00301000
*   /* VA RANGE                                                      */ 00302000
*   /*                                                               */ 00303000
*   /*****************************************************************/ 00304000
*                                                                  0115 00305000
*ELTPROC:                                                          0115 00306000
*   PROC OPTIONS(NOSAVE);                                          0115 00307000
ELTPROC  DS    0H                                                  0116 00308000
*   RETAD2=REG14;                   /* SAVE RETURN ADDRESS           */ 00309000
         ST    REG14,RETAD2                                        0116 00310000
*   PGAD=FPA;                       /* FIRST PAGE PROCESSED          */ 00311000
*                                                                  0117 00312000
         L     @12,ELTAD                                           0117 00313000
         L     @12,FPA-1(,@12)                                     0117 00314000
         LA    @12,0(,@12)                                         0117 00315000
         ST    @12,PGAD                                            0117 00316000
*   /*****************************************************************/ 00317000
*   /*                                                               */ 00318000
*   /* STORAGE KEY CHANGED BY CHANGING THE PROTECT KEY FOR EACH PAGE */ 00319000
*   /* IN THE VA RANGE. PROCESSING IS NOT COMPLETED IF A PAGE IN THE */ 00320000
*   /* VA RANGE IS FOUND THAT HAS NOT BEEN GETMAINED.                */ 00321000
*   /*                                                               */ 00322000
*   /*****************************************************************/ 00323000
*                                                                  0118 00324000
*NEWSEG:                            /* REPEATED FOR EACH PAGE IN A 0118 00325000
*                                      NEW SEGMENT                   */ 00326000
*   RESPECIFY                                                      0118 00327000
*    (REG01,                                                       0118 00328000
*     REG02,                                                       0118 00329000
*     REG03) RSTD;                  /* REGS USED BY FINDPAGE         */ 00330000
NEWSEG   DS    0H                                                  0119 00331000
*   REG01=PGAD;                     /* PAGE ADDRESS                  */ 00332000
         L     REG01,PGAD                                          0119 00333000
*   REG02=RSMHDPTR;                 /* RSMHD ADDRESS                 */ 00334000
         L     @12,ASCBPTR                                         0120 00335000
         L     REG02,RSMHDPTR(,@12)                                0120 00336000
*   REG03=PVTPTR;                   /* PVT ADDRESS                   */ 00337000
         L     @12,CVTPTR                                          0121 00338000
         L     @12,PVTPTR(,@12)                                    0121 00339000
         LR    REG03,@12                                           0121 00340000
*   CALL IEAVFP2;                   /* GET PGTE,XPTE FOR PAGE        */ 00341000
         L     @15,PVTPFP2(,@12)                                   0122 00342000
         BALR  @14,@15                                             0122 00343000
*   PTEPTR=REG00;                   /* ADDRESS PGTE                  */ 00344000
         ST    REG00,PTEPTR                                        0123 00345000
*   XPTEPTR=REG01;                  /* ADDRESS XPTE                  */ 00346000
         ST    REG01,XPTEPTR                                       0124 00347000
*   RESPECIFY                                                      0125 00348000
*    (REG01,                                                       0125 00349000
*     REG02,                                                       0125 00350000
*     REG03) UNRSTD;                                               0125 00351000
*   IF RETCODE=0 THEN               /* TEST RETURN CODE              */ 00352000
         LTR   RETCODE,RETCODE                                     0126 00353000
         BNZ   @RF00126                                            0126 00354000
*SAMESEG:                                                          0127 00355000
*     DO;                           /* RC ZERO: PGTE,XPTE FOUND.   0127 00356000
*                                      REPEATED FOR EACH PAGE IN THE    00357000
*                                      SAME SEGMENT.                 */ 00358000
SAMESEG  DS    0H                                                  0128 00359000
*       IF PGTPAM=YES THEN          /* PAGE GM ASSIGNED ?            */ 00360000
         L     @12,PTEPTR                                          0128 00361000
         TM    PGTPAM(@12),B'00000001'                             0128 00362000
         BNO   @RF00128                                            0128 00363000
*         DO;                       /* YES: KEY WILL BE CHANGED      */ 00364000
*           IF SAVEKEY=YES THEN     /* SAVE KEY OF THIS PAGE ?       */ 00365000
         TM    SAVEKEY,B'10000000'                                 0130 00366000
         BNO   @RF00130                                            0130 00367000
*             DO;                   /* YES: XPTPROT IS SAVED         */ 00368000
*               OLDKEYFP=XPTPROT;   /* ORIGINAL STORAGE KEY          */ 00369000
         L     @12,XPTEPTR                                         0132 00370000
         IC    @11,XPTPROT(,@12)                                   0132 00371000
         STC   @11,OLDKEYFP                                        0132 00372000
*               SAVEKEY=NO;         /* NO OTHER KEY IS SAVED         */ 00373000
         NI    SAVEKEY,B'01111111'                                 0133 00374000
*             END;                                                 0134 00375000
*           ELSE                                                   0135 00376000
*             ;                     /* NO: CONTINUE                  */ 00377000
@RF00130 DS    0H                                                  0136 00378000
*           LPC=PGAD;               /* PAGE ADDRESS BEING PROCESSED  */ 00379000
         L     @12,PGAD                                            0136 00380000
         ST    @12,LPC                                             0136 00381000
*           CALL KEYCHG;            /* CHANGE KEY OF PAGE            */ 00382000
         BAL   @14,KEYCHG                                          0137 00383000
*           PGAD=PGAD+C4K;          /* NEXT PAGE ADDRESS IN RANGE    */ 00384000
         L     @12,@CF00106                                        0138 00385000
         AL    @12,PGAD                                            0138 00386000
         ST    @12,PGAD                                            0138 00387000
*           COND1=NO;                                              0139 00388000
*           COND2=NO;                                              0140 00389000
         NI    COND1,B'11001111'                                   0140 00390000
*           IF PGAD<=LPA THEN       /* ALL PAGES PROCESSED ?         */ 00391000
         L     @11,ELTAD                                           0141 00392000
         L     @11,LPA-1(,@11)                                     0141 00393000
         LA    @11,0(,@11)                                         0141 00394000
         CR    @12,@11                                             0141 00395000
         BH    @RF00141                                            0141 00396000
*             DO;                   /* NO: CONTINUE WITH NEXT PAGE   */ 00397000
*               COND1=YES;          /* INDICATE PAGE EXISTS          */ 00398000
         OI    COND1,B'00100000'                                   0143 00399000
*               IF SEG¬=NEW THEN    /* PAGE IN SAME SEGMENT ?        */ 00400000
         TM    SEG,B'11110000'                                     0144 00401000
         BZ    @RF00144                                            0144 00402000
*                 DO;               /* YES: PGTE,XPTE BY INCREMENTING   00403000
*                                      DOWN TABLES                   */ 00404000
*                   PTEPTR=PTEPTR+LENGTH(PGTPTE);/* NEXT PGTE ADDRESS*/ 00405000
         LA    @12,2                                               0146 00406000
         AL    @12,PTEPTR                                          0146 00407000
         ST    @12,PTEPTR                                          0146 00408000
*                   XPTEPTR=XPTEPTR+LENGTH(XPTE);/* NEXT XPTE ADDRESS*/ 00409000
         LA    @12,12                                              0147 00410000
         AL    @12,XPTEPTR                                         0147 00411000
         ST    @12,XPTEPTR                                         0147 00412000
*                   COND2=YES;      /* INDICATE SAME SEGMENT         */ 00413000
         OI    COND2,B'00010000'                                   0148 00414000
*                 END;                                             0149 00415000
*               ELSE                                               0150 00416000
*                 ;                 /* NO: PGTE,XPTE BY FINDPAGE     */ 00417000
@RF00144 DS    0H                                                  0151 00418000
*             END;                                                 0151 00419000
*           ELSE                                                   0152 00420000
*             ;                     /* YES: END PROCESSING           */ 00421000
@RF00141 DS    0H                                                  0153 00422000
*         END;                                                     0153 00423000
*       ELSE                        /* NO: ERROR CONDITION           */ 00424000
*         DO;                                                      0154 00425000
         B     @RC00128                                            0154 00426000
@RF00128 DS    0H                                                  0155 00427000
*           RETCODE=8;              /* IDENTIFY ERROR                */ 00428000
         LA    RETCODE,8                                           0155 00429000
*           ERROR=YES;              /* INDICATE ERROR DETECTED       */ 00430000
         OI    ERROR,B'01000000'                                   0156 00431000
*         END;                                                     0157 00432000
*     END;                                                         0158 00433000
*   ELSE                            /* RC NOT ZERO: NO PGTE,XPTE     */ 00434000
*     DO;                                                          0159 00435000
         B     @RC00126                                            0159 00436000
@RF00126 DS    0H                                                  0160 00437000
*       RETCODE=16;                 /* IDENTIFY ERROR                */ 00438000
         LA    RETCODE,16                                          0160 00439000
*       ERROR=YES;                  /* INDICATE ERROR DETECTED       */ 00440000
         OI    ERROR,B'01000000'                                   0161 00441000
*     END;                                                         0162 00442000
*   IF COND2=YES&ERROR=NO THEN      /* SAME SEG AND NO ERROR ?       */ 00443000
@RC00126 TM    COND2,B'00010000'                                   0163 00444000
         BNO   @RF00163                                            0163 00445000
         TM    ERROR,B'01000000'                                   0163 00446000
         BZ    @RT00163                                            0163 00447000
*     GOTO SAMESEG;                 /* YES: REPEAT SAMESEG           */ 00448000
*   ELSE                                                           0165 00449000
*     ;                             /* NO: CONTINUE                  */ 00450000
@RF00163 DS    0H                                                  0166 00451000
*   IF COND1=YES&ERROR=NO THEN      /* NEW SEG AND NO ERROR ?        */ 00452000
         TM    COND1,B'00100000'                                   0166 00453000
         BNO   @RF00166                                            0166 00454000
         TM    ERROR,B'01000000'                                   0166 00455000
         BZ    @RT00166                                            0166 00456000
*     GOTO NEWSEG;                  /* YES: REPEAT NEWSEG            */ 00457000
*   ELSE                                                           0168 00458000
*     ;                             /* NO: ALL PAGES ARE PROCESSED OR   00459000
*                                      ERROR HAS BEEN DETECTED       */ 00460000
@RF00166 DS    0H                                                  0169 00461000
*   REG14=RETAD2;                   /* RESTORE RETURN ADDRESS        */ 00462000
         L     REG14,RETAD2                                        0169 00463000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLING ROUTINE     */ 00464000
@EL00004 DS    0H                                                  0170 00465000
@EF00004 DS    0H                                                  0170 00466000
@ER00004 BR    @14                                                 0170 00467000
*   END ELTPROC;                                                   0171 00468000
*                                                                  0172 00469000
*   /*****************************************************************/ 00470000
*   /*                                                               */ 00471000
*   /* ROUTINE TO VERIFY THAT A PARAMETER LIST ELEMENT IS IN FIXED   */ 00472000
*   /* STORAGE AT THE TIME IEAVCKEY WAS INVOKED.                     */ 00473000
*   /*                                                               */ 00474000
*   /*****************************************************************/ 00475000
*                                                                  0172 00476000
*ELTVCK:                                                           0172 00477000
*   PROC OPTIONS(NOSAVE);                                          0172 00478000
ELTVCK   DS    0H                                                  0173 00479000
*   GEN REFS(ELTAD);                                               0173 00480000
*                 /*                                                    00481000
*         ELEMENT IS IN REAL STORAGE IF THE FIRST AND LAST BYTE OF      00482000
*         THE ELEMENT ARE IN REAL STORAGE                               00483000
         L     @15,ELTAD              ELEMENT VA                        00484000
         LRA   @15,C0(@15)            FIRST BYTE IN REAL STORAGE ?      00485000
         BNZ   ERR12                  NO: ERROR CONDITION               00486000
         L     @15,ELTAD              YES: ELEMENT ENDING               00487000
         LA    @15,C7(@15)                 VIRTUAL ADDRESS              00488000
         LRA   @15,C0(@15)            LAST BYTE IN REAL STORAGE?        00489000
         BNZ   ERR12                  NO: ERROR CONDITION               00490000
         SR    @15,@15                YES: ELT IN FIXED STORAGE         00491000
         BR    @14                    RETURN TO LISTPROC                00492000
ERR12    LA    @15,12                 IDENTIFY ERROR                    00493000
*   RETURN;                         /* RETURN TO LISTPROC            */ 00494000
@EL00005 DS    0H                                                  0174 00495000
@EF00005 DS    0H                                                  0174 00496000
@ER00005 BR    @14                                                 0174 00497000
*   END ELTVCK;                                                    0175 00498000
*                                                                  0176 00499000
*   /*****************************************************************/ 00500000
*   /*                                                               */ 00501000
*   /* ROUTINE TO VERIFY STORAGE DEFINED BY A VA RANGE IS FROM       */ 00502000
*   /* SUBPOOLS 0-127, 251, AND 252                                  */ 00503000
*   /*                                                               */ 00504000
*   /*****************************************************************/ 00505000
*                                                                  0176 00506000
*PAGEVCK:                                                          0176 00507000
*   PROC OPTIONS(NOSAVE);                                          0176 00508000
PAGEVCK  DS    0H                                                  0177 00509000
*   IF FPA<=LPA THEN                /* WRAP AROUND NOT PERMITTED     */ 00510000
         L     @12,ELTAD                                           0177 00511000
         CLC   FPA(3,@12),LPA(@12)                                 0177 00512000
         BH    @RF00177                                            0177 00513000
*     DO;                                                          0178 00514000
*       IF FPA>=PASTRT THEN         /* STORAGE ABOVE PRIVATE AREA  0179 00515000
*                                      START ?                       */ 00516000
         L     @11,CVTPTR                                          0179 00517000
         L     @01,GDAPTR(,@11)                                    0179 00518000
         L     @11,FPA-1(,@12)                                     0179 00519000
         LA    @11,0(,@11)                                         0179 00520000
         C     @11,PASTRT(,@01)                                    0179 00521000
         BL    @RF00179                                            0179 00522000
*         DO;                       /* YES: CONTINUE                 */ 00523000
*           IF LPA<CURRGNTP THEN    /* STORAGE BELOW CURRENT REGION     00524000
*                                      TOP ?                         */ 00525000
         L     @11,ASCBPTR                                         0181 00526000
         L     @01,LDAPTR(,@11)                                    0181 00527000
         L     @12,LPA-1(,@12)                                     0181 00528000
         LA    @12,0(,@12)                                         0181 00529000
         C     @12,CURRGNTP(,@01)                                  0181 00530000
         BNL   @RF00181                                            0181 00531000
*             RETCODE=0;            /* YES: STORAGE RANGE VALID      */ 00532000
         SLR   RETCODE,RETCODE                                     0182 00533000
*           ELSE                                                   0183 00534000
*             RETCODE=4;            /* NO: STORAGE RANGE INVALID     */ 00535000
         B     @RC00181                                            0183 00536000
@RF00181 LA    RETCODE,4                                           0183 00537000
*         END;                                                     0184 00538000
*       ELSE                                                       0185 00539000
*         RETCODE=4;                /* NO: STORAGE RANGE INVALID     */ 00540000
         B     @RC00179                                            0185 00541000
@RF00179 LA    RETCODE,4                                           0185 00542000
*     END;                                                         0186 00543000
*   ELSE                                                           0187 00544000
*     RETCODE=4;                                                   0187 00545000
         B     @RC00177                                            0187 00546000
@RF00177 LA    RETCODE,4                                           0187 00547000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLING ROUTINE     */ 00548000
@RC00177 DS    0H                                                  0188 00549000
@EL00006 DS    0H                                                  0188 00550000
@EF00006 DS    0H                                                  0188 00551000
@ER00006 BR    @14                                                 0188 00552000
*   END PAGEVCK;                                                   0189 00553000
*                                                                  0190 00554000
*   /*****************************************************************/ 00555000
*   /*                                                               */ 00556000
*   /* ROUTINE TO CHANGE PROTECT KEY AND FETCH PROTECT FLAG OF A     */ 00557000
*   /* SINGLE PAGE-REFERENCE BIT IS PRESERVED-CHANGE BIT IS TURNED   */ 00558000
*   /* ON- THIS IS DONE TO PREVENT ANOTHER CPU FROM TURING IT ON     */ 00559000
*   /* WHILE THE KEY IS BEING CHANGED AND THUS LOSING THE CHANGE     */ 00560000
*   /*                                                               */ 00561000
*   /*****************************************************************/ 00562000
*                                                                  0190 00563000
*KEYCHG:                                                           0190 00564000
*   PROC OPTIONS(NOSAVE);                                          0190 00565000
KEYCHG   DS    0H                                                  0191 00566000
*   XPTPROT=KEYANDFP;               /* CHANGE KEY IN XPTE            */ 00567000
         L     @12,XPTEPTR                                         0191 00568000
         IC    @11,KEYANDFP                                        0191 00569000
         STC   @11,XPTPROT(,@12)                                   0191 00570000
*   XPTCKF=YES;                     /* INDICATE KEY FOR PAGE WAS   0192 00571000
*                                      CHANGED                       */ 00572000
         OI    XPTCKF(@12),B'00100000'                             0192 00573000
*   GEN REFS(PGAD,RCBITS,INR1,CHANGBIT);                           0193 00574000
*                                    /*                                 00575000
*         CHANGE HARDWARE KEY IF PAGE IS ASSIGNED TO A FRAME IN REAL    00576000
*         STORAGE                                                       00577000
         L     @15,PGAD               PAGE VA                           00578000
         LRA   @15,C0(@15)            PAGE IN REAL STORAGE ?            00579000
         BNZ   CHGEND                 NO:ROUTINE COMPLETE               00580000
         ISK   @00,@15                YES: HDW KEY FOR PAGE             00581000
         N     @00,RCBITS             SAVE REFERENCE BIT      @ZA11388  00582000
         O     @00,CHANGBIT           TURN ON CHANGE BIT      @ZA11388  00583000
         O     @00,NEWKEY             APPEND BITS TO NEW KEY            00584000
         SSK   @00,@15                CHANGE HDW KEY OF FIRST 2K        00585000
         LA    @15,C2K(@15)           ADDRESS OF SECOND 2K              00586000
         ISK   @00,@15                HDW KEY FOR HALF PAGE             00587000
         N     @00,RCBITS             SAVE REFERENCE BIT      @ZA11388  00588000
         O     @00,CHANGBIT           TURN ON CHANGE BIT      @ZA11388  00589000
         O     @00,NEWKEY             APPEND BITS TO NEW KEY            00590000
         SSK   @00,@15                CHANGE HDW KEY OF SECOND 2K       00591000
CHGEND   EQU   *                                                        00592000
*   RETURN CODE(0);                 /* RETURN TO CALLING ROUTINE     */ 00593000
         SLR   @15,@15                                             0194 00594000
@EL00007 DS    0H                                                  0194 00595000
@EF00007 DS    0H                                                  0194 00596000
@ER00007 BR    @14                                                 0194 00597000
*   END KEYCHG;                                                    0195 00598000
*                                                                  0196 00599000
*   /*****************************************************************/ 00600000
*   /*                                                               */ 00601000
*   /* ROUTINE TO RESTORE THE ORIGINAL STORAGE KEY FOR ALL PAGES     */ 00602000
*   /* WHOSE KEY HAS BEEN CHANGED. THE ROUTINE IS CALLED INTERNALLY  */ 00603000
*   /* WHEN AN INVALID PAGE HAS BEEN DETECTED IN THE VA RANGE        */ 00604000
*   /* REQUESTED DURING CHANGE KEY PROCESSING. IT IS ALSO A PART OF  */ 00605000
*   /* RETRY PROCESSING REQUESTED BY THE FRR FOR UNEXPECTED ERRORS.  */ 00606000
*   /*                                                               */ 00607000
*   /*****************************************************************/ 00608000
*                                                                  0196 00609000
*RECOVER:                                                          0196 00610000
*   PROC OPTIONS(NOSAVE);                                          0196 00611000
RECOVER  DS    0H                                                  0197 00612000
*   INRCV=YES;                      /* INDICATE ROUTINE ENTERED      */ 00613000
         L     @12,PARMPTR                                         0197 00614000
         OI    INRCV(@12),B'10000000'                              0197 00615000
*   RETAD2=REG14;                   /* SAVE RETURN ADDRESS           */ 00616000
         ST    REG14,RETAD2                                        0198 00617000
*   IF LPC¬=NONE THEN               /* KEY FOR ANY PAGES CHANGED ?   */ 00618000
         L     @12,LPC                                             0199 00619000
         LTR   @12,@12                                             0199 00620000
         BZ    @RF00199                                            0199 00621000
*     DO;                           /* YES: RESTORE KEY              */ 00622000
*       RCSAVE=REG15;               /* SAVE RC OF CALLING ROUTINE    */ 00623000
         ST    REG15,RCSAVE                                        0201 00624000
*       KEYANDFP=OLDKEYFP;          /* ORIGINAL STORAGE KEY          */ 00625000
         IC    @12,OLDKEYFP                                        0202 00626000
         STC   @12,KEYANDFP                                        0202 00627000
*       IF REQUEST=LTYPE THEN       /* DETERMINE REQUEST TYPE        */ 00628000
         CLI   REQUEST,128                                         0203 00629000
         BNE   @RF00203                                            0203 00630000
*         DO;                       /* L-TYPE REQUEST                */ 00631000
*           ELTAD=INR1;             /* FIRST ELEMENT ADDRESS         */ 00632000
         L     @12,INR1                                            0205 00633000
         ST    @12,ELTAD                                           0205 00634000
*           DO UNTIL(LPG=LPC);      /* KEY FOR EACH RANGE CHANGED IS    00635000
*                                      RESTORED                      */ 00636000
@DL00206 DS    0H                                                  0207 00637000
*             IF FPA<=LPC&LPC<=LPA THEN/* LAST RANGE THAT KEY WAS  0207 00638000
*                                      CHANGED ?                     */ 00639000
         L     @12,LPC                                             0207 00640000
         L     @11,ELTAD                                           0207 00641000
         L     @08,FPA-1(,@11)                                     0207 00642000
         LA    @08,0(,@08)                                         0207 00643000
         CR    @12,@08                                             0207 00644000
         BL    @RF00207                                            0207 00645000
         L     @11,LPA-1(,@11)                                     0207 00646000
         LA    @11,0(,@11)                                         0207 00647000
         CR    @12,@11                                             0207 00648000
         BH    @RF00207                                            0207 00649000
*               LPG=LPC;            /* YES: RANGE ENDS WITH LAST PAGE   00650000
*                                      WHOSE KEY WAS CHANGED         */ 00651000
         ST    @12,LPG                                             0208 00652000
*             ELSE                                                 0209 00653000
*               LPG=LPA;            /* NO: KEY FOR ENTIRE RANGE WAS     00654000
*                                      CHANGED                       */ 00655000
         B     @RC00207                                            0209 00656000
@RF00207 L     @12,ELTAD                                           0209 00657000
         L     @12,LPA-1(,@12)                                     0209 00658000
         LA    @12,0(,@12)                                         0209 00659000
         ST    @12,LPG                                             0209 00660000
*             CALL KEYRSTR;         /* RESTORE KEY FOR RANGE         */ 00661000
@RC00207 BAL   @14,KEYRSTR                                         0210 00662000
*             ELTAD=ELTAD+LENGTH(LISTELT);/* NEXT ELEMENT IN LIST    */ 00663000
         LA    @12,8                                               0211 00664000
         AL    @12,ELTAD                                           0211 00665000
./  ADD  SSI=60640192,NAME=IEAVCKRR
         TITLE '**  IEAVCKRR-VS2/SU5  IEAVCKEY FRR  **                 *00001000
                        '                                               00002000
IEAVCKRR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEAVCKRR  76.064'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*                                                                  0020 00013000
*                             /*ADDRESSABILTIY FOR DYNAMIC SAVEAREA     00014000
         LR    REG11,REG00          DATAREG                             00015000
         USING @DATD,REG11                                              00016000
*                                                                       00017000
*     WORK AREA PROVIDED BY RTM IS USED AS DYNAMIC SAVE AREA            00018000
*     TO ACHIEVE REENTRANT ATTRIBUTE                                    00019000
*                                                                       00020000
*   /*****************************************************************/ 00021000
*   /*                                                               */ 00022000
*   /* SDWA INITILIZATION                                            */ 00023000
*   /*                                                               */ 00024000
*   /*****************************************************************/ 00025000
*                                                                  0021 00026000
*   SDWARCRD=YES;                   /* LOGREC RECORDING DESIRED      */ 00027000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0021 00028000
*   SDWAHEX=YES;                    /* VRA TO BE WRITTEN IN HEX      */ 00029000
         OI    SDWAHEX(SDWAPTR),B'10000000'                        0022 00030000
*   SDWAURAL=0;                     /* NO DATA IN VRA INITIALLY      */ 00031000
         MVI   SDWAURAL(SDWAPTR),X'00'                             0023 00032000
*   SDWAMODN=CKEY;                  /* MODULE NAME                   */ 00033000
         MVC   SDWAMODN(8,SDWAPTR),CKEY                            0024 00034000
*   SDWACSCT=CKEY;                  /* CSECT NAME                    */ 00035000
         MVC   SDWACSCT(8,SDWAPTR),CKEY                            0025 00036000
*   SDWAREXN=CKRR;                  /* FRR NAME                      */ 00037000
         MVC   SDWAREXN(8,SDWAPTR),CKRR                            0026 00038000
*   SDWARCDE=PERCOL;                /* INITIAL RETURN CODE TO      0027 00039000
*                                      RTM...PERCOLATE               */ 00040000
*                                                                  0027 00041000
         MVI   SDWARCDE(SDWAPTR),X'00'                             0027 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* RECORD INFORMATION RELEVANT TO STATUS OF CHANGE KEY PROCESSING*/ 00045000
*   /* WHEN UNEXPECTED ERROR OCCURED                                 */ 00046000
*   /*                                                               */ 00047000
*   /*****************************************************************/ 00048000
*                                                                  0028 00049000
*   IF SDWAFMID=SAME&SDWAPERC=NO&RECURSE=NO THEN/* NO INFORMATION  0028 00050000
*                                      RECORDED FOR THESE CONDITIONS */ 00051000
         CLC   SDWAFMID(2,SDWAPTR),SAME                            0028 00052000
         BNE   @RF00028                                            0028 00053000
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0028 00054000
         BNZ   @RF00028                                            0028 00055000
         L     @15,SDWAPARM(,SDWAPTR)                              0028 00056000
         TM    RECURSE(@15),B'01000000'                            0028 00057000
         BNZ   @RF00028                                            0028 00058000
*     DO;                                                          0029 00059000
*       SDWAURAL=LENGTH(RECORD);    /* LENGTH OF DATA WRITTEN IN VRA */ 00060000
         MVI   SDWAURAL(SDWAPTR),X'1A'                             0030 00061000
*       WKAPTR=ADDR(CFAPWKAR);      /* IEAVCKEY'S WORKAREA           */ 00062000
         L     @10,ASCBPTR                                         0031 00063000
         L     WKAPTR,LDAPTR(,@10)                                 0031 00064000
         LA    WKAPTR,CFAPWKAR(,WKAPTR)                            0031 00065000
*       CALLER=INR14;               /* IDENTIFY CALLING PGM          */ 00066000
         MVC   CALLER(4,SDWAPTR),INR14(WKAPTR)                     0032 00067000
*       KEYREQ=KEYANDFP;            /* NEW KEY BEING REQUESTED       */ 00068000
         MVC   KEYREQ(1,SDWAPTR),KEYANDFP(WKAPTR)                  0033 00069000
*       OLDKEY=OLDKEYFP;            /* ORIGINAL STORAGE KEY AS SAVED    00070000
*                                      BY IEAVCKEY                   */ 00071000
         MVC   OLDKEY(1,SDWAPTR),OLDKEYFP(WKAPTR)                  0034 00072000
*       REQTYPE=REQUEST;            /* TYPE INTERFACE BEING USED     */ 00073000
         MVC   REQTYPE(1,SDWAPTR),REQUEST(WKAPTR)                  0035 00074000
*       VARANGE=ELTAD->FPALPA;      /* VA RANGE BEING PROCESSED      */ 00075000
         L     @10,ELTAD(,WKAPTR)                                  0036 00076000
         MVC   VARANGE(8,SDWAPTR),FPALPA(@10)                      0036 00077000
*       PTABLE=PTEPTR->TABLE;       /* PGTE OF PAGE BEING PROCESSED  */ 00078000
         L     @10,PTEPTR(,WKAPTR)                                 0037 00079000
         MVC   PTABLE(2,SDWAPTR),TABLE(@10)                        0037 00080000
*       XPTABLE=XPTEPTR->FLAGS;     /* FIRST WORD OF XPTE FOR PAGE   */ 00081000
         L     @10,XPTEPTR(,WKAPTR)                                0038 00082000
         MVC   XPTABLE(4,SDWAPTR),FLAGS(@10)                       0038 00083000
*       LASTPAGE=LPC;               /* LAST PAGE WHOSE KEY WAS     0039 00084000
*                                      CHANGED                       */ 00085000
         MVC   LASTPAGE(4,SDWAPTR),LPC(WKAPTR)                     0039 00086000
*       RECURSE=YES;                /* FRR HAS BEEN ENTERED          */ 00087000
*                                                                  0040 00088000
         OI    RECURSE(@15),B'01000000'                            0040 00089000
*       /*************************************************************/ 00090000
*       /*                                                           */ 00091000
*       /* REQUEST RETRY OR PERCOLATION FROM RTM                     */ 00092000
*       /*                                                           */ 00093000
*       /*************************************************************/ 00094000
*                                                                  0041 00095000
*       IF INRCV=NO&(SDWAPCHK=YES|SDWAMCHK=YES) THEN/* RETRY ONLY FOR   00096000
*                                      PGM CHECKS OR MACHINE CHKS NOT   00097000
*                                      IN RECOVER PROCESSING         */ 00098000
         TM    INRCV(@15),B'10000000'                              0041 00099000
         BNZ   @RF00041                                            0041 00100000
         TM    SDWAPCHK(SDWAPTR),B'11000000'                       0041 00101000
         BZ    @RF00041                                            0041 00102000
*         DO;                                                      0042 00103000
*           SDWASR09=WKAPTR;        /* RESTORE WORKAREA ADDRESS      */ 00104000
         ST    WKAPTR,SDWASR09(,SDWAPTR)                           0043 00105000
*           SDWASR10=CKEYBASE;      /* RESTORE CODEREG FOR IEAVCKEY  */ 00106000
         MVC   SDWASR10(4,SDWAPTR),CKEYBASE(@15)                   0044 00107000
*           SDWAUPRG=YES;           /* REGISTERS UPDATED FOR RETRY   */ 00108000
         OI    SDWAUPRG(SDWAPTR),B'00001000'                       0045 00109000
*           SDWARTYA=ADDR(CKEYRTRY);/* RETRY POINT IN IEAVCKEY       */ 00110000
         L     @15,@CV00094                                        0046 00111000
         ST    @15,SDWARTYA(,SDWAPTR)                              0046 00112000
*           SDWARCDE=RETRY;         /* RETRY REQUESTED               */ 00113000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0047 00114000
*         END;                                                     0048 00115000
*     END;                                                         0049 00116000
*   RETURN;                         /* RETURN TO RTM                 */ 00117000
@EL00001 DS    0H                                                  0050 00118000
@EF00001 DS    0H                                                  0050 00119000
@ER00001 BR    @14                                                 0050 00120000
*   END IEAVCKRR                                                   0051 00121000
*                                                                  0051 00122000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00123000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 00124000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 00125000
*/*%INCLUDE SYSLIB  (IHALDA  )                                       */ 00126000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 00127000
*                                                                  0051 00128000
*       ;                                                          0051 00129000
         B     @EL00001                                            0051 00130000
@DATA    DS    0H                                                       00131000
@DATD    DSECT                                                          00132000
         DS    0F                                                       00133000
IEAVCKRR CSECT                                                          00134000
         DS    0F                                                       00135000
@DATD    DSECT                                                          00136000
         DS    0D                                                       00137000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00138000
@ENDDATD EQU   *                                                        00139000
IEAVCKRR CSECT                                                          00140000
         NOPR  ((@ENDDATD-@DATD)/201*16)                                00141000
         DS    0F                                                       00142000
@SIZDATD DC    AL1(0)                                                   00143000
         DC    AL3(@ENDDATD-@DATD)                                      00144000
@CV00094 DC    V(CKEYRTRY)                                              00145000
         DS    0D                                                       00146000
SAME     DC    AL2(0)                                                   00147000
CKEY     DC    CL8'IEAVCKEY'                                            00148000
CKRR     DC    CL8'IEAVCKRR'                                            00149000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00150000
@01      EQU   01                                                       00151000
@02      EQU   02                                                       00152000
@03      EQU   03                                                       00153000
@04      EQU   04                                                       00154000
@05      EQU   05                                                       00155000
@06      EQU   06                                                       00156000
@07      EQU   07                                                       00157000
@08      EQU   08                                                       00158000
@09      EQU   09                                                       00159000
@10      EQU   10                                                       00160000
@11      EQU   11                                                       00161000
@12      EQU   12                                                       00162000
@13      EQU   13                                                       00163000
@14      EQU   14                                                       00164000
@15      EQU   15                                                       00165000
WKAPTR   EQU   @02                                                      00166000
REG00    EQU   @00                                                      00167000
REG01    EQU   @01                                                      00168000
REG11    EQU   @11                                                      00169000
REG14    EQU   @14                                                      00170000
SDWAPTR  EQU   @01                                                      00171000
PSA      EQU   0                                                        00172000
FLCRNPSW EQU   PSA                                                      00173000
FLCROPSW EQU   PSA+8                                                    00174000
FLCICCW2 EQU   PSA+16                                                   00175000
PSAEEPSW EQU   PSA+132                                                  00176000
PSAESPSW EQU   PSA+136                                                  00177000
FLCSVILC EQU   PSAESPSW+1                                               00178000
PSAEPPSW EQU   PSA+140                                                  00179000
FLCPIILC EQU   PSAEPPSW+1                                               00180000
FLCPICOD EQU   PSAEPPSW+2                                               00181000
PSAPICOD EQU   FLCPICOD+1                                               00182000
FLCTEA   EQU   PSAEPPSW+4                                               00183000
FLCPER   EQU   PSA+152                                                  00184000
FLCMCLA  EQU   PSA+168                                                  00185000
FLCIOEL  EQU   FLCMCLA+4                                                00186000
FLCIOA   EQU   FLCMCLA+16                                               00187000
FLCFSA   EQU   FLCMCLA+80                                               00188000
PSAAOLD  EQU   PSA+548                                                  00189000
PSASUPER EQU   PSA+552                                                  00190000
PSASUP1  EQU   PSASUPER                                                 00191000
PSASUP2  EQU   PSASUPER+1                                               00192000
PSASUP3  EQU   PSASUPER+2                                               00193000
PSASUP4  EQU   PSASUPER+3                                               00194000
PSACLHT  EQU   PSA+640                                                  00195000
PSALKSA  EQU   PSA+696                                                  00196000
PSAHLHI  EQU   PSA+760                                                  00197000
PSADSSFL EQU   PSA+836                                                  00198000
PSADSSF1 EQU   PSADSSFL                                                 00199000
PSADSSF3 EQU   PSADSSFL+2                                               00200000
PSADSSF4 EQU   PSADSSFL+3                                               00201000
PSARSVT  EQU   PSA+896                                                  00202000
CKEYWKA  EQU   0                                                        00203000
SAVEREGS EQU   CKEYWKA                                                  00204000
NEWKEY   EQU   SAVEREGS                                                 00205000
REQUEST  EQU   NEWKEY                                                   00206000
KEYANDFP EQU   NEWKEY+3                                                 00207000
INR14    EQU   SAVEREGS+56                                              00208000
PTRVAR   EQU   CKEYWKA+72                                               00209000
PTEPTR   EQU   PTRVAR                                                   00210000
XPTEPTR  EQU   PTRVAR+4                                                 00211000
ELTAD    EQU   PTRVAR+12                                                00212000
LPC      EQU   PTRVAR+16                                                00213000
OLDKEYFP EQU   CKEYWKA+105                                              00214000
FPALPA   EQU   0                                                        00215000
TABLE    EQU   0                                                        00216000
FLAGS    EQU   0                                                        00217000
FRRPARMS EQU   0                                                        00218000
CKEYBASE EQU   FRRPARMS                                                 00219000
FRRFLAGS EQU   FRRPARMS+4                                               00220000
INRCV    EQU   FRRFLAGS                                                 00221000
RECURSE  EQU   FRRFLAGS                                                 00222000
ASCB     EQU   0                                                        00223000
ASCBLDA  EQU   ASCB+48                                                  00224000
ASCBFW1  EQU   ASCB+100                                                 00225000
ASCBRCTF EQU   ASCBFW1+2                                                00226000
ASCBFLG1 EQU   ASCBFW1+3                                                00227000
ASCBDSP1 EQU   ASCB+114                                                 00228000
ASCBFLG2 EQU   ASCB+115                                                 00229000
ASCBLKGP EQU   ASCB+128                                                 00230000
LDA      EQU   0                                                        00231000
LVSMFLAG EQU   LDA                                                      00232000
CFAPWKAR EQU   LDA+1164                                                 00233000
SDWA     EQU   0                                                        00234000
SDWAPARM EQU   SDWA                                                     00235000
SDWAFIOB EQU   SDWA+4                                                   00236000
SDWAABCC EQU   SDWAFIOB                                                 00237000
SDWACMPF EQU   SDWAABCC                                                 00238000
SDWACTL1 EQU   SDWA+8                                                   00239000
SDWACMKA EQU   SDWACTL1                                                 00240000
SDWAMWPA EQU   SDWACTL1+1                                               00241000
SDWAPMKA EQU   SDWACTL1+4                                               00242000
SDWACTL2 EQU   SDWA+16                                                  00243000
SDWACMKP EQU   SDWACTL2                                                 00244000
SDWAMWPP EQU   SDWACTL2+1                                               00245000
SDWAPMKP EQU   SDWACTL2+4                                               00246000
SDWAGRSV EQU   SDWA+24                                                  00247000
SDWANAME EQU   SDWA+88                                                  00248000
SDWAEC1  EQU   SDWA+104                                                 00249000
SDWAEMK1 EQU   SDWAEC1                                                  00250000
SDWAMWP1 EQU   SDWAEC1+1                                                00251000
SDWAINT1 EQU   SDWAEC1+2                                                00252000
SDWANXT1 EQU   SDWAEC1+4                                                00253000
SDWAAEC1 EQU   SDWA+112                                                 00254000
SDWAILC1 EQU   SDWAAEC1+1                                               00255000
SDWAINC1 EQU   SDWAAEC1+2                                               00256000
SDWAICD1 EQU   SDWAINC1+1                                               00257000
SDWAEC2  EQU   SDWA+120                                                 00258000
SDWAEMK2 EQU   SDWAEC2                                                  00259000
SDWAMWP2 EQU   SDWAEC2+1                                                00260000
SDWAINT2 EQU   SDWAEC2+2                                                00261000
SDWANXT2 EQU   SDWAEC2+4                                                00262000
SDWAAEC2 EQU   SDWA+128                                                 00263000
SDWAILC2 EQU   SDWAAEC2+1                                               00264000
SDWAINC2 EQU   SDWAAEC2+2                                               00265000
SDWAICD2 EQU   SDWAINC2+1                                               00266000
SDWASRSV EQU   SDWA+136                                                 00267000
SDWASR09 EQU   SDWASRSV+36                                              00268000
SDWASR10 EQU   SDWASRSV+40                                              00269000
SDWAIDNT EQU   SDWA+200                                                 00270000
SDWAMCH  EQU   SDWA+204                                                 00271000
SDWASTCK EQU   SDWAMCH                                                  00272000
SDWAMCHI EQU   SDWAMCH+8                                                00273000
SDWAMCHS EQU   SDWAMCHI                                                 00274000
SDWAMCHD EQU   SDWAMCHI+1                                               00275000
SDWARSR1 EQU   SDWAMCH+12                                               00276000
SDWARSR2 EQU   SDWAMCH+13                                               00277000
SDWAFLGS EQU   SDWA+232                                                 00278000
SDWAERRA EQU   SDWAFLGS                                                 00279000
SDWAMCHK EQU   SDWAERRA                                                 00280000
SDWAPCHK EQU   SDWAERRA                                                 00281000
SDWAERRB EQU   SDWAFLGS+1                                               00282000
SDWAERRC EQU   SDWAFLGS+2                                               00283000
SDWAPERC EQU   SDWAERRC                                                 00284000
SDWAERRD EQU   SDWAFLGS+3                                               00285000
SDWAFMID EQU   SDWA+236                                                 00286000
SDWAIOFS EQU   SDWA+238                                                 00287000
SDWARTYA EQU   SDWA+240                                                 00288000
SDWACPUA EQU   SDWA+248                                                 00289000
SDWAPARQ EQU   SDWA+252                                                 00290000
SDWARCDE EQU   SDWAPARQ                                                 00291000
SDWAACF2 EQU   SDWAPARQ+1                                               00292000
SDWARCRD EQU   SDWAACF2                                                 00293000
SDWAUPRG EQU   SDWAACF2                                                 00294000
SDWAACF3 EQU   SDWAPARQ+2                                               00295000
SDWAACF4 EQU   SDWAPARQ+3                                               00296000
SDWALKWA EQU   SDWA+256                                                 00297000
SDWALKWS EQU   SDWALKWA                                                 00298000
SDWARECP EQU   SDWA+292                                                 00299000
SDWAMODN EQU   SDWARECP                                                 00300000
SDWACSCT EQU   SDWARECP+8                                               00301000
SDWAREXN EQU   SDWARECP+16                                              00302000
SDWASNPA EQU   SDWA+320                                                 00303000
SDWADUMP EQU   SDWASNPA                                                 00304000
SDWADPFS EQU   SDWADUMP+1                                               00305000
SDWADDAT EQU   SDWASNPA+4                                               00306000
SDWASDAT EQU   SDWADDAT                                                 00307000
SDWAPDAT EQU   SDWADDAT+2                                               00308000
SDWADPSA EQU   SDWA+328                                                 00309000
SDWADPSL EQU   SDWADPSA                                                 00310000
SDWARA   EQU   SDWA+400                                                 00311000
SDWADPVA EQU   SDWARA+2                                                 00312000
SDWAHEX  EQU   SDWADPVA                                                 00313000
SDWAURAL EQU   SDWARA+3                                                 00314000
SDWAVRA  EQU   SDWARA+4                                                 00315000
ASCBPTR  EQU   PSAAOLD                                                  00316000
LDAPTR   EQU   ASCBLDA                                                  00317000
RECORD   EQU   SDWAVRA                                                  00318000
CALLER   EQU   RECORD                                                   00319000
KEYS     EQU   RECORD+4                                                 00320000
KEYREQ   EQU   KEYS                                                     00321000
OLDKEY   EQU   KEYS+1                                                   00322000
REQTYPE  EQU   KEYS+3                                                   00323000
VARANGE  EQU   RECORD+8                                                 00324000
LASTPAGE EQU   RECORD+16                                                00325000
XPTABLE  EQU   RECORD+20                                                00326000
PTABLE   EQU   RECORD+24                                                00327000
PSARSVTE EQU   PSARSVT                                                  00328000
FLC      EQU   PSA                                                      00329000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00330000
PSARSAV  EQU   PSARSVTE+60                                              00331000
PSARSTK  EQU   PSARSVTE+56                                              00332000
PSAESAV3 EQU   PSARSVTE+52                                              00333000
PSAESTK3 EQU   PSARSVTE+48                                              00334000
PSAESAV2 EQU   PSARSVTE+44                                              00335000
PSAESTK2 EQU   PSARSVTE+40                                              00336000
PSAESAV1 EQU   PSARSVTE+36                                              00337000
PSAESTK1 EQU   PSARSVTE+32                                              00338000
PSAPSAV  EQU   PSARSVTE+28                                              00339000
PSAPSTK  EQU   PSARSVTE+24                                              00340000
PSAMSAV  EQU   PSARSVTE+20                                              00341000
PSAMSTK  EQU   PSARSVTE+16                                              00342000
PSASSAV  EQU   PSARSVTE+12                                              00343000
PSASSTK  EQU   PSARSVTE+8                                               00344000
PSANSTK  EQU   PSARSVTE+4                                               00345000
PSACSTK  EQU   PSARSVTE                                                 00346000
@NM00007 EQU   KEYS+2                                                   00347000
@NM00082 EQU   SDWA+512                                                 00348000
@NM00081 EQU   SDWADPVA                                                 00349000
SDWAEBC  EQU   SDWADPVA                                                 00350000
SDWAVRAL EQU   SDWARA                                                   00351000
@NM00080 EQU   SDWA+396                                                 00352000
SDWACOMP EQU   SDWA+392                                                 00353000
SDWARCPL EQU   SDWA+364                                                 00354000
@NM00079 EQU   SDWADPSA+32                                              00355000
SDWATO4  EQU   SDWADPSL+28                                              00356000
SDWAFRM4 EQU   SDWADPSL+24                                              00357000
SDWATO3  EQU   SDWADPSL+20                                              00358000
SDWAFRM3 EQU   SDWADPSL+16                                              00359000
SDWATO2  EQU   SDWADPSL+12                                              00360000
SDWAFRM2 EQU   SDWADPSL+8                                               00361000
SDWATO1  EQU   SDWADPSL+4                                               00362000
SDWAFRM1 EQU   SDWADPSL                                                 00363000
@NM00078 EQU   SDWADDAT+3                                               00364000
@NM00077 EQU   SDWAPDAT                                                 00365000
SDWAUSPL EQU   SDWAPDAT                                                 00366000
SDWADPSW EQU   SDWAPDAT                                                 00367000
SDWATJPA EQU   SDWAPDAT                                                 00368000
SDWATLPA EQU   SDWAPDAT                                                 00369000
SDWADREG EQU   SDWAPDAT                                                 00370000
SDWADSAH EQU   SDWAPDAT                                                 00371000
SDWADSAS EQU   SDWAPDAT                                                 00372000
@NM00076 EQU   SDWADDAT+1                                               00373000
@NM00075 EQU   SDWASDAT                                                 00374000
SDWAQQS  EQU   SDWASDAT                                                 00375000
SDWACBS  EQU   SDWASDAT                                                 00376000
SDWAGTF  EQU   SDWASDAT                                                 00377000
SDWASWA  EQU   SDWASDAT                                                 00378000
SDWALSQA EQU   SDWASDAT                                                 00379000
SDWASQA  EQU   SDWASDAT                                                 00380000
SDWANUC  EQU   SDWASDAT                                                 00381000
@NM00074 EQU   SDWADUMP+2                                               00382000
@NM00073 EQU   SDWADPFS                                                 00383000
SDWASLST EQU   SDWADPFS                                                 00384000
@NM00072 EQU   SDWADPFS                                                 00385000
SDWADLST EQU   SDWADPFS                                                 00386000
SDWADPT  EQU   SDWADPFS                                                 00387000
SDWADPID EQU   SDWADUMP                                                 00388000
SDWADPLA EQU   SDWA+316                                                 00389000
@NM00071 EQU   SDWA+290                                                 00390000
SDWAASID EQU   SDWA+288                                                 00391000
SDWATALW EQU   SDWALKWS+28                                              00392000
SDWATDLW EQU   SDWALKWS+24                                              00393000
SDWATNLW EQU   SDWALKWS+20                                              00394000
SDWAAPLW EQU   SDWALKWS+16                                              00395000
SDWAIPLW EQU   SDWALKWS+12                                              00396000
SDWAILLW EQU   SDWALKWS+8                                               00397000
SDWAIULW EQU   SDWALKWS+4                                               00398000
SDWAICLW EQU   SDWALKWS                                                 00399000
SDWAFLLK EQU   SDWAACF4                                                 00400000
SDWACMS  EQU   SDWAACF4                                                 00401000
SDWAOPTM EQU   SDWAACF4                                                 00402000
SDWATADB EQU   SDWAACF4                                                 00403000
SDWATDNB EQU   SDWAACF4                                                 00404000
SDWATNCB EQU   SDWAACF4                                                 00405000
SDWAILCH EQU   SDWAACF4                                                 00406000
SDWAIUCB EQU   SDWAACF4                                                 00407000
SDWAICAT EQU   SDWAACF3                                                 00408000
SDWAIPRG EQU   SDWAACF3                                                 00409000
SDWASALL EQU   SDWAACF3                                                 00410000
SDWAASMP EQU   SDWAACF3                                                 00411000
SDWADISP EQU   SDWAACF3                                                 00412000
@NM00070 EQU   SDWAACF3                                                 00413000
@NM00069 EQU   SDWAACF2                                                 00414000
SDWAFREE EQU   SDWAACF2                                                 00415000
@NM00068 EQU   SDWAACF2                                                 00416000
SDWASPIN EQU   SDWAACF2                                                 00417000
@NM00067 EQU   SDWAACF2                                                 00418000
SDWALCPU EQU   SDWACPUA+2                                               00419000
@NM00066 EQU   SDWACPUA                                                 00420000
SDWARECA EQU   SDWA+244                                                 00421000
@NM00065 EQU   SDWA+239                                                 00422000
@NM00064 EQU   SDWAIOFS                                                 00423000
SDWANIOP EQU   SDWAIOFS                                                 00424000
SDWANOIO EQU   SDWAIOFS                                                 00425000
SDWAIOHT EQU   SDWAIOFS                                                 00426000
SDWAIOQR EQU   SDWAIOFS                                                 00427000
@NM00063 EQU   SDWAERRD                                                 00428000
SDWAMCIV EQU   SDWAERRD                                                 00429000
SDWARPIV EQU   SDWAERRD                                                 00430000
SDWAMABD EQU   SDWAERRD                                                 00431000
SDWACTS  EQU   SDWAERRD                                                 00432000
SDWASTAE EQU   SDWAERRD                                                 00433000
SDWANRBE EQU   SDWAERRD                                                 00434000
SDWACLUP EQU   SDWAERRD                                                 00435000
@NM00062 EQU   SDWAERRC                                                 00436000
SDWAEAS  EQU   SDWAERRC                                                 00437000
SDWAIRB  EQU   SDWAERRC                                                 00438000
SDWASTAI EQU   SDWAERRC                                                 00439000
SDWASTAF EQU   SDWAERRC                                                 00440000
SDWASRBM EQU   SDWAERRB                                                 00441000
SDWALDIS EQU   SDWAERRB                                                 00442000
SDWAENRB EQU   SDWAERRB                                                 00443000
SDWATYP1 EQU   SDWAERRB                                                 00444000
@NM00061 EQU   SDWAERRB                                                 00445000
SDWAPGIO EQU   SDWAERRA                                                 00446000
SDWATEXC EQU   SDWAERRA                                                 00447000
SDWASVCE EQU   SDWAERRA                                                 00448000
SDWAABTM EQU   SDWAERRA                                                 00449000
SDWASVCD EQU   SDWAERRA                                                 00450000
SDWARKEY EQU   SDWAERRA                                                 00451000
SDWATIME EQU   SDWAMCH+20                                               00452000
SDWARFSA EQU   SDWAMCH+16                                               00453000
@NM00060 EQU   SDWAMCH+14                                               00454000
SDWAVEQR EQU   SDWARSR2                                                 00455000
SDWAPGFX EQU   SDWARSR2                                                 00456000
SDWAFLSQ EQU   SDWARSR2                                                 00457000
SDWAFSQA EQU   SDWARSR2                                                 00458000
SDWANUCL EQU   SDWARSR2                                                 00459000
SDWASPER EQU   SDWARSR2                                                 00460000
SDWAINTC EQU   SDWARSR2                                                 00461000
SDWAOFLN EQU   SDWARSR2                                                 00462000
SDWACHNG EQU   SDWARSR1                                                 00463000
SDWAMSER EQU   SDWARSR1                                                 00464000
@NM00059 EQU   SDWARSR1                                                 00465000
SDWACPID EQU   SDWAMCH+10                                               00466000
SDWATERR EQU   SDWAMCHD                                                 00467000
SDWAFPRX EQU   SDWAMCHD                                                 00468000
SDWAINSF EQU   SDWAMCHD                                                 00469000
SDWAACR  EQU   SDWAMCHD                                                 00470000
SDWASCK  EQU   SDWAMCHD                                                 00471000
SDWAPSWU EQU   SDWAMCHD                                                 00472000
SDWAREGU EQU   SDWAMCHD                                                 00473000
SDWASKYF EQU   SDWAMCHD                                                 00474000
@NM00058 EQU   SDWAMCHS                                                 00475000
SDWARSRF EQU   SDWAMCHS                                                 00476000
SDWARSRC EQU   SDWAMCHS                                                 00477000
SDWAINVP EQU   SDWAMCHS                                                 00478000
SDWATSVL EQU   SDWAMCHS                                                 00479000
SDWARCDF EQU   SDWAMCHS                                                 00480000
SDWASRVL EQU   SDWAMCHS                                                 00481000
SDWASCKE EQU   SDWASTCK+4                                               00482000
SDWASCKB EQU   SDWASTCK                                                 00483000
SDWALNTH EQU   SDWAIDNT+1                                               00484000
SDWASPID EQU   SDWAIDNT                                                 00485000
SDWASR15 EQU   SDWASRSV+60                                              00486000
SDWASR14 EQU   SDWASRSV+56                                              00487000
SDWASR13 EQU   SDWASRSV+52                                              00488000
SDWASR12 EQU   SDWASRSV+48                                              00489000
SDWASR11 EQU   SDWASRSV+44                                              00490000
SDWASR08 EQU   SDWASRSV+32                                              00491000
SDWASR07 EQU   SDWASRSV+28                                              00492000
SDWASR06 EQU   SDWASRSV+24                                              00493000
SDWASR05 EQU   SDWASRSV+20                                              00494000
SDWASR04 EQU   SDWASRSV+16                                              00495000
SDWASR03 EQU   SDWASRSV+12                                              00496000
SDWASR02 EQU   SDWASRSV+8                                               00497000
SDWASR01 EQU   SDWASRSV+4                                               00498000
SDWASR00 EQU   SDWASRSV                                                 00499000
SDWATRN2 EQU   SDWAAEC2+4                                               00500000
SDWAIPC2 EQU   SDWAICD2                                                 00501000
SDWAIMC2 EQU   SDWAICD2                                                 00502000
SDWAIPR2 EQU   SDWAICD2                                                 00503000
@NM00057 EQU   SDWAINC2                                                 00504000
@NM00056 EQU   SDWAILC2                                                 00505000
SDWAIL2  EQU   SDWAILC2                                                 00506000
@NM00055 EQU   SDWAILC2                                                 00507000
@NM00054 EQU   SDWAAEC2                                                 00508000
SDWAADD2 EQU   SDWANXT2+1                                               00509000
@NM00053 EQU   SDWANXT2                                                 00510000
@NM00052 EQU   SDWAEC2+3                                                00511000
SDWASGN2 EQU   SDWAINT2                                                 00512000
SDWAEXP2 EQU   SDWAINT2                                                 00513000
SDWADEC2 EQU   SDWAINT2                                                 00514000
SDWAFPO2 EQU   SDWAINT2                                                 00515000
SDWACC2  EQU   SDWAINT2                                                 00516000
@NM00051 EQU   SDWAINT2                                                 00517000
SDWAPGM2 EQU   SDWAMWP2                                                 00518000
SDWAWAT2 EQU   SDWAMWP2                                                 00519000
SDWAMCK2 EQU   SDWAMWP2                                                 00520000
SDWAECT2 EQU   SDWAMWP2                                                 00521000
SDWAKEY2 EQU   SDWAMWP2                                                 00522000
SDWAEXT2 EQU   SDWAEMK2                                                 00523000
SDWAIO2  EQU   SDWAEMK2                                                 00524000
SDWATRM2 EQU   SDWAEMK2                                                 00525000
@NM00050 EQU   SDWAEMK2                                                 00526000
SDWAPER2 EQU   SDWAEMK2                                                 00527000
@NM00049 EQU   SDWAEMK2                                                 00528000
SDWATRAN EQU   SDWAAEC1+4                                               00529000
SDWAIPC1 EQU   SDWAICD1                                                 00530000
SDWAIMC1 EQU   SDWAICD1                                                 00531000
SDWAIPR1 EQU   SDWAICD1                                                 00532000
@NM00048 EQU   SDWAINC1                                                 00533000
@NM00047 EQU   SDWAILC1                                                 00534000
SDWAIL1  EQU   SDWAILC1                                                 00535000
@NM00046 EQU   SDWAILC1                                                 00536000
@NM00045 EQU   SDWAAEC1                                                 00537000
SDWAADD1 EQU   SDWANXT1+1                                               00538000
@NM00044 EQU   SDWANXT1                                                 00539000
@NM00043 EQU   SDWAEC1+3                                                00540000
SDWASGN1 EQU   SDWAINT1                                                 00541000
SDWAEXP1 EQU   SDWAINT1                                                 00542000
SDWADEC1 EQU   SDWAINT1                                                 00543000
SDWAFPO1 EQU   SDWAINT1                                                 00544000
SDWACC1  EQU   SDWAINT1                                                 00545000
@NM00042 EQU   SDWAINT1                                                 00546000
SDWAPGM1 EQU   SDWAMWP1                                                 00547000
SDWAWAT1 EQU   SDWAMWP1                                                 00548000
SDWAMCK1 EQU   SDWAMWP1                                                 00549000
SDWAECT1 EQU   SDWAMWP1                                                 00550000
SDWAKEY1 EQU   SDWAMWP1                                                 00551000
SDWAEXT1 EQU   SDWAEMK1                                                 00552000
SDWAIO1  EQU   SDWAEMK1                                                 00553000
SDWATRM1 EQU   SDWAEMK1                                                 00554000
@NM00041 EQU   SDWAEMK1                                                 00555000
SDWAPER1 EQU   SDWAEMK1                                                 00556000
@NM00040 EQU   SDWAEMK1                                                 00557000
SDWAIOBR EQU   SDWA+100                                                 00558000
SDWAEPA  EQU   SDWA+96                                                  00559000
@NM00039 EQU   SDWANAME+4                                               00560000
SDWARBAD EQU   SDWANAME                                                 00561000
SDWAGR15 EQU   SDWAGRSV+60                                              00562000
SDWAGR14 EQU   SDWAGRSV+56                                              00563000
SDWAGR13 EQU   SDWAGRSV+52                                              00564000
SDWAGR12 EQU   SDWAGRSV+48                                              00565000
SDWAGR11 EQU   SDWAGRSV+44                                              00566000
SDWAGR10 EQU   SDWAGRSV+40                                              00567000
SDWAGR09 EQU   SDWAGRSV+36                                              00568000
SDWAGR08 EQU   SDWAGRSV+32                                              00569000
SDWAGR07 EQU   SDWAGRSV+28                                              00570000
SDWAGR06 EQU   SDWAGRSV+24                                              00571000
SDWAGR05 EQU   SDWAGRSV+20                                              00572000
SDWAGR04 EQU   SDWAGRSV+16                                              00573000
SDWAGR03 EQU   SDWAGRSV+12                                              00574000
SDWAGR02 EQU   SDWAGRSV+8                                               00575000
SDWAGR01 EQU   SDWAGRSV+4                                               00576000
SDWAGR00 EQU   SDWAGRSV                                                 00577000
SDWANXTP EQU   SDWACTL2+5                                               00578000
SDWASGP  EQU   SDWAPMKP                                                 00579000
SDWAEUP  EQU   SDWAPMKP                                                 00580000
SDWADOP  EQU   SDWAPMKP                                                 00581000
SDWAFPP  EQU   SDWAPMKP                                                 00582000
SDWACCP  EQU   SDWAPMKP                                                 00583000
SDWAILP  EQU   SDWAPMKP                                                 00584000
SDWAINTP EQU   SDWACTL2+2                                               00585000
SDWASPVP EQU   SDWAMWPP                                                 00586000
SDWAWATP EQU   SDWAMWPP                                                 00587000
SDWAMCKP EQU   SDWAMWPP                                                 00588000
@NM00038 EQU   SDWAMWPP                                                 00589000
SDWAKEYP EQU   SDWAMWPP                                                 00590000
SDWAEXTP EQU   SDWACMKP                                                 00591000
SDWAIOP  EQU   SDWACMKP                                                 00592000
SDWANXTA EQU   SDWACTL1+5                                               00593000
SDWASGA  EQU   SDWAPMKA                                                 00594000
SDWAEUA  EQU   SDWAPMKA                                                 00595000
SDWADOA  EQU   SDWAPMKA                                                 00596000
SDWAFPA  EQU   SDWAPMKA                                                 00597000
SDWACCA  EQU   SDWAPMKA                                                 00598000
SDWAILA  EQU   SDWAPMKA                                                 00599000
SDWAINTA EQU   SDWACTL1+2                                               00600000
SDWASPVA EQU   SDWAMWPA                                                 00601000
SDWAWATA EQU   SDWAMWPA                                                 00602000
SDWAMCKA EQU   SDWAMWPA                                                 00603000
@NM00037 EQU   SDWAMWPA                                                 00604000
SDWAKEYA EQU   SDWAMWPA                                                 00605000
SDWAEXTA EQU   SDWACMKA                                                 00606000
SDWAIOA  EQU   SDWACMKA                                                 00607000
SDWACMPC EQU   SDWAABCC+1                                               00608000
@NM00036 EQU   SDWACMPF                                                 00609000
SDWASTCC EQU   SDWACMPF                                                 00610000
@NM00035 EQU   SDWACMPF                                                 00611000
SDWASTEP EQU   SDWACMPF                                                 00612000
SDWAREQ  EQU   SDWACMPF                                                 00613000
LDAEND   EQU   LDA+1496                                                 00614000
LCLCELCT EQU   LDA+1492                                                 00615000
LCLCELL  EQU   LDA+1488                                                 00616000
LDALIMIT EQU   LDA+1484                                                 00617000
LDARSVPT EQU   LDA+1480                                                 00618000
LDASRPQE EQU   LDA+1476                                                 00619000
CURRGNTP EQU   LDA+1472                                                 00620000
VVREGSZ  EQU   LDA+1468                                                 00621000
LSQAPTR  EQU   LDA+1464                                                 00622000
CSAVE    EQU   LDA+1100                                                 00623000
OBFRSAVE EQU   LDA+1036                                                 00624000
GFRESAVE EQU   LDA+972                                                  00625000
GMREPSAV EQU   LDA+908                                                  00626000
FBQSAVE  EQU   LDA+844                                                  00627000
G4KSAVE  EQU   LDA+780                                                  00628000
FSAVE    EQU   LDA+716                                                  00629000
BSAVE    EQU   LDA+652                                                  00630000
SAVEREG2 EQU   LDA+588                                                  00631000
BRANCHSV EQU   LDA+524                                                  00632000
GMFMWKAR EQU   LDA+24                                                   00633000
LDARES2  EQU   LDA+21                                                   00634000
LDACBSP  EQU   LDA+20                                                   00635000
LDARQSTA EQU   LDA+16                                                   00636000
LDATCB   EQU   LDA+12                                                   00637000
ASDPQE   EQU   LDA+8                                                    00638000
PASCBSV  EQU   LDA+4                                                    00639000
@NM00034 EQU   LVSMFLAG+1                                               00640000
LDABRSW  EQU   LVSMFLAG                                                 00641000
LDAFPFM  EQU   LVSMFLAG                                                 00642000
LDAFLAGS EQU   LVSMFLAG                                                 00643000
LDASTART EQU   LDA                                                      00644000
ASCBEND  EQU   ASCB+208                                                 00645000
ASCBSRBT EQU   ASCB+200                                                 00646000
ASCBSWTL EQU   ASCB+196                                                 00647000
ASCBRS14 EQU   ASCB+195                                                 00648000
ASCBSMCT EQU   ASCB+194                                                 00649000
ASCBRS12 EQU   ASCB+192                                                 00650000
ASCBPCTT EQU   ASCB+188                                                 00651000
ASCBVGTT EQU   ASCB+184                                                 00652000
ASCBLGCB EQU   ASCB+180                                                 00653000
ASCBJBNS EQU   ASCB+176                                                 00654000
ASCBJBNI EQU   ASCB+172                                                 00655000
ASCBMCC  EQU   ASCB+168                                                 00656000
ASCBRTWA EQU   ASCB+164                                                 00657000
ASCBIQEA EQU   ASCB+160                                                 00658000
ASCBXMPQ EQU   ASCB+156                                                 00659000
ASCBRS01 EQU   ASCB+154                                                 00660000
ASCBFMCT EQU   ASCB+152                                                 00661000
ASCBOUXB EQU   ASCB+148                                                 00662000
ASCBOUCB EQU   ASCB+144                                                 00663000
ASCBMECB EQU   ASCB+140                                                 00664000
ASCBQECB EQU   ASCB+136                                                 00665000
ASCBLSQH EQU   ASCBLKGP+4                                               00666000
ASCBLOCK EQU   ASCBLKGP                                                 00667000
ASCBTCBS EQU   ASCB+124                                                 00668000
ASCBNVSC EQU   ASCB+122                                                 00669000
ASCBVSC  EQU   ASCB+120                                                 00670000
ASCBSRBS EQU   ASCB+118                                                 00671000
ASCBSSRB EQU   ASCB+116                                                 00672000
ASCBRV06 EQU   ASCBFLG2                                                 00673000
ASCBRV05 EQU   ASCBFLG2                                                 00674000
ASCBRV04 EQU   ASCBFLG2                                                 00675000
ASCBSNQS EQU   ASCBFLG2                                                 00676000
ASCBS2S  EQU   ASCBFLG2                                                 00677000
ASCBCEXT EQU   ASCBFLG2                                                 00678000
ASCBPXMT EQU   ASCBFLG2                                                 00679000
ASCBXMPT EQU   ASCBFLG2                                                 00680000
ASCBRF07 EQU   ASCBDSP1                                                 00681000
ASCBRF06 EQU   ASCBDSP1                                                 00682000
ASCBRF05 EQU   ASCBDSP1                                                 00683000
ASCBRF04 EQU   ASCBDSP1                                                 00684000
ASCBRF03 EQU   ASCBDSP1                                                 00685000
ASCBRF02 EQU   ASCBDSP1                                                 00686000
ASCBFAIL EQU   ASCBDSP1                                                 00687000
ASCBNOQ  EQU   ASCBDSP1                                                 00688000
ASCBSWCT EQU   ASCB+112                                                 00689000
ASCBASXB EQU   ASCB+108                                                 00690000
ASCBTMCH EQU   ASCB+104                                                 00691000
ASCBNSWP EQU   ASCBFLG1                                                 00692000
ASCBTYP1 EQU   ASCBFLG1                                                 00693000
ASCBSTND EQU   ASCBFLG1                                                 00694000
ASCBABNT EQU   ASCBFLG1                                                 00695000
ASCBTERM EQU   ASCBFLG1                                                 00696000
ASCBS3S  EQU   ASCBFLG1                                                 00697000
ASCBCMSH EQU   ASCBFLG1                                                 00698000
ASCBTOFF EQU   ASCBFLG1                                                 00699000
ASCBRF01 EQU   ASCBRCTF                                                 00700000
ASCBTMLW EQU   ASCBRCTF                                                 00701000
ASCBOUT  EQU   ASCBRCTF                                                 00702000
ASCBWAIT EQU   ASCBRCTF                                                 00703000
ASCBRV08 EQU   ASCBRCTF                                                 00704000
ASCBFQU  EQU   ASCBRCTF                                                 00705000
ASCBFRS  EQU   ASCBRCTF                                                 00706000
ASCBTMNO EQU   ASCBRCTF                                                 00707000
ASCBAFFN EQU   ASCBFW1                                                  00708000
ASCBDUMP EQU   ASCB+96                                                  00709000
ASCBQSVC EQU   ASCB+92                                                  00710000
ASCBUBET EQU   ASCB+88                                                  00711000
ASCBECB  EQU   ASCB+84                                                  00712000
ASCBJSTL EQU   ASCB+80                                                  00713000
ASCBEWST EQU   ASCB+72                                                  00714000
ASCBEJST EQU   ASCB+64                                                  00715000
ASCBTSB  EQU   ASCB+60                                                  00716000
ASCBCSCB EQU   ASCB+56                                                  00717000
ASCBRSM  EQU   ASCB+52                                                  00718000
ASCBSTOR EQU   ASCB+44                                                  00719000
ASCBDP   EQU   ASCB+43                                                  00720000
ASCBRV07 EQU   ASCB+42                                                  00721000
ASCBIOSM EQU   ASCB+40                                                  00722000
ASCBSEQN EQU   ASCB+38                                                  00723000
ASCBASID EQU   ASCB+36                                                  00724000
ASCBCPUS EQU   ASCB+32                                                  00725000
ASCBSPL  EQU   ASCB+28                                                  00726000
ASCBIOSP EQU   ASCB+24                                                  00727000
ASCBRV10 EQU   ASCB+20                                                  00728000
ASCBRV12 EQU   ASCB+16                                                  00729000
ASCBCMSF EQU   ASCB+12                                                  00730000
ASCBBWDP EQU   ASCB+8                                                   00731000
ASCBFWDP EQU   ASCB+4                                                   00732000
ASCBASCB EQU   ASCB                                                     00733000
ASCBEGIN EQU   ASCB                                                     00734000
@NM00009 EQU   FRRPARMS+5                                               00735000
@NM00008 EQU   FRRFLAGS                                                 00736000
@NM00006 EQU   CKEYWKA+100                                              00737000
@NM00005 EQU   PTRVAR+20                                                00738000
@NM00004 EQU   PTRVAR+8                                                 00739000
@NM00003 EQU   CKEYWKA+60                                               00740000
@NM00002 EQU   SAVEREGS+4                                               00741000
@NM00001 EQU   NEWKEY+1                                                 00742000
@NM00033 EQU   PSA+3668                                                 00743000
PSASTAK  EQU   PSA+3072                                                 00744000
@NM00032 EQU   PSA+1048                                                 00745000
PSAUSEND EQU   PSA+1048                                                 00746000
PSARV062 EQU   PSA+1044                                                 00747000
PSACDAL  EQU   PSA+1040                                                 00748000
PSAWTCOD EQU   PSA+1036                                                 00749000
PSAATCVT EQU   PSA+1032                                                 00750000
PSAPCPSW EQU   PSA+1024                                                 00751000
PSAPIR2  EQU   PSA+1020                                                 00752000
PSARV059 EQU   PSA+1018                                                 00753000
PSASVC13 EQU   PSA+1016                                                 00754000
PSALSFCC EQU   PSA+1012                                                 00755000
PSASFACC EQU   PSA+1008                                                 00756000
PSASTOP  EQU   PSA+992                                                  00757000
PSASTART EQU   PSA+976                                                  00758000
PSARSPSW EQU   PSA+968                                                  00759000
PSASRPSW EQU   PSA+960                                                  00760000
PSARV045 EQU   PSA+892                                                  00761000
PSARV044 EQU   PSA+888                                                  00762000
PSARV043 EQU   PSA+884                                                  00763000
PSARV042 EQU   PSA+880                                                  00764000
PSARV041 EQU   PSA+876                                                  00765000
PSARV040 EQU   PSA+872                                                  00766000
PSARV025 EQU   PSA+868                                                  00767000
PSADSSED EQU   PSA+868                                                  00768000
PSADSSPR EQU   PSA+864                                                  00769000
PSADSSFW EQU   PSA+860                                                  00770000
PSADSS14 EQU   PSA+856                                                  00771000
PSADSSPP EQU   PSA+848                                                  00772000
PSADSSRP EQU   PSA+840                                                  00773000
PSADSS05 EQU   PSADSSF4                                                 00774000
PSADSS10 EQU   PSADSSF4                                                 00775000
PSADSSVE EQU   PSADSSF4                                                 00776000
PSADSSDE EQU   PSADSSF4                                                 00777000
PSADSSC0 EQU   PSADSSF4                                                 00778000
PSADSSIE EQU   PSADSSF4                                                 00779000
PSADSS12 EQU   PSADSSF4                                                 00780000
PSADSSRC EQU   PSADSSF4                                                 00781000
PSARV057 EQU   PSADSSF3                                                 00782000
PSARV056 EQU   PSADSSF3                                                 00783000
PSARV055 EQU   PSADSSF3                                                 00784000
PSADSSMC EQU   PSADSSF3                                                 00785000
PSADSSRW EQU   PSADSSF3                                                 00786000
PSADSSNM EQU   PSADSSF3                                                 00787000
PSADSSES EQU   PSADSSF3                                                 00788000
PSADSSGP EQU   PSADSSF3                                                 00789000
PSADSSF2 EQU   PSADSSFL+1                                               00790000
PSADSSPI EQU   PSADSSF1                                                 00791000
PSADSSOI EQU   PSADSSF1                                                 00792000
PSADSSSP EQU   PSADSSF1                                                 00793000
PSADSSTP EQU   PSADSSF1                                                 00794000
PSADSSDW EQU   PSADSSF1                                                 00795000
PSADSSDD EQU   PSADSSF1                                                 00796000
PSADSSDM EQU   PSADSSF1                                                 00797000
PSADSSMV EQU   PSADSSF1                                                 00798000
PSADSSTS EQU   PSA+816                                                  00799000
PSADSSWK EQU   PSA+812                                                  00800000
PSADSSR3 EQU   PSA+808                                                  00801000
PSADSSR2 EQU   PSA+804                                                  00802000
PSADSSRS EQU   PSA+800                                                  00803000
PSASTOR  EQU   PSA+796                                                  00804000
PSACPUSA EQU   PSA+794                                                  00805000
PSAVSTAP EQU   PSA+792                                                  00806000
PSAWKVAP EQU   PSA+788                                                  00807000
PSAWKRAP EQU   PSA+784                                                  00808000
PSAMCHIC EQU   PSA+783                                                  00809000
PSARV061 EQU   PSA+782                                                  00810000
PSASYMSK EQU   PSA+781                                                  00811000
PSAMCHFL EQU   PSA+780                                                  00812000
PSACR0   EQU   PSA+776                                                  00813000
PSAPSWSV EQU   PSA+768                                                  00814000
PSALITA  EQU   PSA+764                                                  00815000
PSACLHS  EQU   PSAHLHI                                                  00816000
PSALKR15 EQU   PSALKSA+60                                               00817000
PSALKR14 EQU   PSALKSA+56                                               00818000
PSALKR13 EQU   PSALKSA+52                                               00819000
PSALKR12 EQU   PSALKSA+48                                               00820000
PSALKR11 EQU   PSALKSA+44                                               00821000
PSALKR10 EQU   PSALKSA+40                                               00822000
PSALKR9  EQU   PSALKSA+36                                               00823000
PSALKR8  EQU   PSALKSA+32                                               00824000
PSALKR7  EQU   PSALKSA+28                                               00825000
PSALKR6  EQU   PSALKSA+24                                               00826000
PSALKR5  EQU   PSALKSA+20                                               00827000
PSALKR4  EQU   PSALKSA+16                                               00828000
PSALKR3  EQU   PSALKSA+12                                               00829000
PSALKR2  EQU   PSALKSA+8                                                00830000
PSALKR1  EQU   PSALKSA+4                                                00831000
PSALKR0  EQU   PSALKSA                                                  00832000
PSARV023 EQU   PSACLHT+52                                               00833000
PSALOCAL EQU   PSACLHT+48                                               00834000
PSACMSL  EQU   PSACLHT+44                                               00835000
PSAOPTL  EQU   PSACLHT+40                                               00836000
PSATPACL EQU   PSACLHT+36                                               00837000
PSATPDNL EQU   PSACLHT+32                                               00838000
PSATPNCL EQU   PSACLHT+28                                               00839000
PSAIOSLL EQU   PSACLHT+24                                               00840000
PSAIOSUL EQU   PSACLHT+20                                               00841000
PSAIOSCL EQU   PSACLHT+16                                               00842000
PSAIOSSL EQU   PSACLHT+12                                               00843000
PSASALCL EQU   PSACLHT+8                                                00844000
PSAASML  EQU   PSACLHT+4                                                00845000
PSADISPL EQU   PSACLHT                                                  00846000
PSASRSA  EQU   PSA+636                                                  00847000
PSARV050 EQU   PSA+634                                                  00848000
PSADSSGO EQU   PSA+633                                                  00849000
PSARECUR EQU   PSA+632                                                  00850000
PSAHLHIS EQU   PSA+628                                                  00851000
PSAIPCSA EQU   PSA+624                                                  00852000
@NM00031 EQU   PSA+621                                                  00853000
PSAIPCDM EQU   PSA+620                                                  00854000
PSAIPCD  EQU   PSA+616                                                  00855000
@NM00030 EQU   PSA+613                                                  00856000
PSAIPCRM EQU   PSA+612                                                  00857000
PSAIPCR  EQU   PSA+608                                                  00858000
PSAMCHEX EQU   PSA+600                                                  00859000
PSAMPSW  EQU   PSA+592                                                  00860000
PSAEXPS2 EQU   PSA+584                                                  00861000
PSAEXPS1 EQU   PSA+576                                                  00862000
PSAPIREG EQU   PSA+572                                                  00863000
PSARSREG EQU   PSA+568                                                  00864000
PSAGPREG EQU   PSA+556                                                  00865000
PSARV022 EQU   PSASUP4                                                  00866000
PSARV021 EQU   PSASUP4                                                  00867000
PSARV020 EQU   PSASUP4                                                  00868000
PSARV019 EQU   PSASUP4                                                  00869000
PSARV018 EQU   PSASUP4                                                  00870000
PSARV017 EQU   PSASUP4                                                  00871000
PSARV016 EQU   PSASUP4                                                  00872000
PSARV015 EQU   PSASUP4                                                  00873000
PSARV014 EQU   PSASUP3                                                  00874000
PSARV013 EQU   PSASUP3                                                  00875000
PSARV012 EQU   PSASUP3                                                  00876000
PSAESTA  EQU   PSASUP3                                                  00877000
PSASPR   EQU   PSASUP3                                                  00878000
PSAPSREG EQU   PSASUP3                                                  00879000
PSAPI2   EQU   PSASUP3                                                  00880000
PSAIOSUP EQU   PSASUP3                                                  00881000
PSALCR   EQU   PSASUP2                                                  00882000
PSARTM   EQU   PSASUP2                                                  00883000
PSAACR   EQU   PSASUP2                                                  00884000
PSAIPCE2 EQU   PSASUP2                                                  00885000
PSAIPCES EQU   PSASUP2                                                  00886000
PSAIPCEC EQU   PSASUP2                                                  00887000
PSAGTF   EQU   PSASUP2                                                  00888000
PSAIPCRI EQU   PSASUP2                                                  00889000
PSATYPE6 EQU   PSASUP1                                                  00890000
PSATCTL  EQU   PSASUP1                                                  00891000
PSADISP  EQU   PSASUP1                                                  00892000
PSALOCK  EQU   PSASUP1                                                  00893000
PSAPI    EQU   PSASUP1                                                  00894000
PSAEXT   EQU   PSASUP1                                                  00895000
PSASVC   EQU   PSASUP1                                                  00896000
PSAIO    EQU   PSASUP1                                                  00897000
PSAANEW  EQU   PSA+544                                                  00898000
PSATOLD  EQU   PSA+540                                                  00899000
PSATNEW  EQU   PSA+536                                                  00900000
PSALCCAR EQU   PSA+532                                                  00901000
PSALCCAV EQU   PSA+528                                                  00902000
PSAPCCAR EQU   PSA+524                                                  00903000
PSAPCCAV EQU   PSA+520                                                  00904000
PSACPULA EQU   PSA+518                                                  00905000
PSACPUPA EQU   PSA+516                                                  00906000
PSAPSA   EQU   PSA+512                                                  00907000
FLCHDEND EQU   PSA+512                                                  00908000
FLCCRSAV EQU   FLCMCLA+280                                              00909000
FLCGRSAV EQU   FLCMCLA+216                                              00910000
FLCFPSAV EQU   FLCMCLA+184                                              00911000
FLCFLA   EQU   FLCMCLA+88                                               00912000
FLCRGNCD EQU   FLCMCLA+84                                               00913000
FLCFSAA  EQU   FLCFSA+1                                                 00914000
@NM00029 EQU   FLCFSA                                                   00915000
@NM00028 EQU   FLCMCLA+72                                               00916000
FLCMCIC  EQU   FLCMCLA+64                                               00917000
@NM00027 EQU   FLCMCLA+20                                               00918000
FLCIOAA  EQU   FLCIOA+1                                                 00919000
@NM00026 EQU   FLCIOA                                                   00920000
@NM00025 EQU   FLCMCLA+15                                               00921000
@NM00024 EQU   FLCMCLA+14                                               00922000
@NM00023 EQU   FLCMCLA+12                                               00923000
FLCLCL   EQU   FLCMCLA+8                                                00924000
FLCIOELA EQU   FLCIOEL+1                                                00925000
@NM00022 EQU   FLCIOEL                                                  00926000
FLCCHNID EQU   FLCMCLA                                                  00927000
@NM00021 EQU   PSA+160                                                  00928000
FLCMTRCD EQU   PSA+157                                                  00929000
@NM00020 EQU   PSA+156                                                  00930000
FLCPERA  EQU   FLCPER+1                                                 00931000
@NM00019 EQU   FLCPER                                                   00932000
@NM00018 EQU   PSA+151                                                  00933000
FLCPERCD EQU   PSA+150                                                  00934000
FLCMCNUM EQU   PSA+149                                                  00935000
@NM00017 EQU   PSA+148                                                  00936000
FLCTEAA  EQU   FLCTEA+1                                                 00937000
@NM00016 EQU   FLCTEA                                                   00938000
PSAPIPC  EQU   PSAPICOD                                                 00939000
PSAPIMC  EQU   PSAPICOD                                                 00940000
PSAPIPER EQU   PSAPICOD                                                 00941000
PSARV049 EQU   FLCPICOD                                                 00942000
FLCPILCB EQU   FLCPIILC                                                 00943000
@NM00015 EQU   FLCPIILC                                                 00944000
@NM00014 EQU   PSAEPPSW                                                 00945000
FLCSVCN  EQU   PSAESPSW+2                                               00946000
FLCSILCB EQU   FLCSVILC                                                 00947000
@NM00013 EQU   FLCSVILC                                                 00948000
@NM00012 EQU   PSAESPSW                                                 00949000
FLCEICOD EQU   PSAEEPSW+2                                               00950000
PSASPAD  EQU   PSAEEPSW                                                 00951000
@NM00011 EQU   PSA+128                                                  00952000
FLCINPSW EQU   PSA+120                                                  00953000
FLCMNPSW EQU   PSA+112                                                  00954000
FLCPNPSW EQU   PSA+104                                                  00955000
FLCSNPSW EQU   PSA+96                                                   00956000
FLCENPSW EQU   PSA+88                                                   00957000
FLCTRACE EQU   PSA+84                                                   00958000
FLCTIMER EQU   PSA+80                                                   00959000
FLCCVT2  EQU   PSA+76                                                   00960000
FLCCAW   EQU   PSA+72                                                   00961000
FLCCSW   EQU   PSA+64                                                   00962000
FLCIOPSW EQU   PSA+56                                                   00963000
FLCMOPSW EQU   PSA+48                                                   00964000
FLCPOPSW EQU   PSA+40                                                   00965000
FLCSOPSW EQU   PSA+32                                                   00966000
FLCEOPSW EQU   PSA+24                                                   00967000
@NM00010 EQU   FLCICCW2+4                                               00968000
FLCCVT   EQU   FLCICCW2                                                 00969000
FLCICCW1 EQU   FLCROPSW                                                 00970000
FLCIPPSW EQU   FLCRNPSW                                                 00971000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00972000
@RF00028 EQU   @EL00001                                                 00973000
@RF00041 EQU   @EL00001                                                 00974000
@ENDDATA EQU   *                                                        00975000
         END   IEAVCKRR,(C'PLS1918',0701,76064)                         00976000
./  ADD  SSI=30752330,NAME=IEAVDELP
        TITLE 'DELETE QUICKCELL POOL MODULE --- IEAVDELP'               00022102
* /* START OF SPECIFICATIONS ****                                       00024102
*                                                                       00026102
*01*  MODULE-NAME = IEAVDELP                                            00030102
*                                                                       00044102
*02*     CSECT-NAME = IEAVDELP                                          00046102
*                                                                       00048502
*01*  DESCRIPTIVE-NAME = DELETE QUICKCELL POOL                          00048902
*                                                                       00049702
*01*  COPYRIGHT = NONE                                                  00049802
*01*  STATUS = LEVEL 02.00     -- 2/26/73                               00059302
*                                                                       00059802
*01*  FUNCTION = DELETION OF ALL OR PART OF A QUICKCELL POOL.           00059902
*                                                                       00070002
*02*     OPERATION = THE DELETE CELL POOL FUNCTION FINDS THE LAST       00072002
*        EXTENT OF A POOL OF CELLS AND THEN REMOVES IT FROM THE POOL.   00074002
*        AT THIS POINT, IT WILL EITHER FREEMAIN THE STORAGE OR ENQUEUE  00076002
*        IT FOR USER FREEMAINING, BASED UPON A USER SELECTED OPTION. IT 00076402
*        WILL CONTINUE TO DELETE EXTENTS ONE AT A TIME, WORKING TOWARDS 00076502
*        THE START OF THE POOL, UNTIL IT HAS SATISFIED THE CALLER'S     00076602
*        REQUEST FOR NUMBER OF EXTENTS TO BE DELETED. (NUMBER IS ONE,   00076702
*        ALL EXTENTS, OR THE WHOLE POOL).                               00078502
*                                                                       00080802
*01*   NOTES = STANDARD LINKAGE CONVENTIONS.                            00082602
*                                                                       00084402
*02*     DEPENDENCIES = 370-MP INSTRUCTION SET (COMPARE-AND-SWAP)       00086202
*                                                                       00088002
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00089802
*02*     RESTRICTIONS = NONE                                            00091602
*02*     REGISTER-CONVENTIONS = SEE EQUATES OF REGISTERS FOLLOWING      00093402
*        CSECT STATEMENT                                                00095202
*                                                                       00097002
*02*     PATCH-LABEL = NUCLEUS PATCH AREA                               00098802
*                                                                       00100602
*01*  MODULE-TYPE = MACRO-INVOKED PROCESSING SUBROUTINE                 00102402
*                                                                       00104202
*02*     PROCESSOR = ASSEMBLER-370R                                     00106002
*                                                                       00107802
*02*     MODULE-SIZE = 400 BYTES                                        00109802
*                                                                       00114202
*02*     ATTRIBUTES = NUCLEUS REFRESHABLE                               00114602
*                                                                       00116202
*01*  ENTRY-POINT = IEAVDELP                                            00116602
*                                                                       00121502
*02*     PURPOSE = DELETION OF THE LAST EXTENT OR ALL EXTENTS OF A      00123502
*        QUICKCELL POOL, OR DELETION OF THE ENTIRE POOL ... FREEMAINING 00125502
*        OF THE DELETED EXTENTS IS OPTIONAL WITH ANY FORM OF DELETION.  00126002
*                                                                       00129202
*02*     LINKAGE = ENTERED VIA A BALR 14,15 .. SHOULD BE INVOKED BY THE 00129702
*        DELCPOOL MACRO INSTRUCTION. REG 0 CONTAINS THE CPID OF THE     00130102
*        POOL TO BE ACTED UPON, AND REG 1 CONTAINS THE OPTION CODE.     00130502
*                                                                       00131702
*02*     INPUT = NONE                                                   00132202
*02*     OUTPUT = A MODIFIED CPAB QUEUE ... SEE SPECIFIC EXITS FOR      00135402
*        PARTICULARS                                                    00135802
*                                                                       00136202
*02*     REGISTERS-SAVED = THIS ROUTINE SAVES NO REGISTERS. THE MACRO   00136702
*        EXPANSION (DELCPOOL) PRESERVES 2 THRU 12.                      00137102
*                                                                       00137702
*02*     REGISTER-USAGE = REGISTER USAGE IS DESCRIBED ON THE EQUATES    00138202
*        DEFINING THE REGISTER NAMES.                                   00138602
*                                                                       00139202
*02*     REGISTERS-RESTORED = NONE ... SEE REGISTERS SAVED.             00139702
*01*  EXIT-NORMAL = DELEXIT0                                            00141202
*                                                                       00144002
*02*     CONDITIONS = NORMAL RETURN VIA BR R14                          00144102
*                                                                       00144302
*02*     OUTPUT = REGISTER 1 ADDRESSES THE FIRST DEQUEUED BUT           00145002
*        UN-FREEMAINED EXTENT. THE FIRST TWO WORDS OF THE EXTENT        00145402
*        CONTAIN ITS SUBPOOL NUMBER AND LENGTH, FOLLOWED BY THE ADDRESS 00145802
*        OF THE NEXT DEQUEUED BUT UN-FREEMAINED EXTENT (IF ANY)... THE  00146202
*        FIELD = 0 IF NO FURTHER EXTENTS.                               00146602
*                                                                       00146702
*02*     RETURN-CODES = 0 = SUCCESSFUL COMPLETION                       00146802
*                                                                       00147402
*01*  EXIT-ERROR = DELERR04                                             00147802
*                                                                       00159702
*02*     CONDITIONS = ERROR DURING FREEMAIN OF A DELETED EXTENT.        00161702
*                                                                       00164102
*02*     OUTPUT = REG 0 = REASON CODE (FREEMAIN ERROR CODE).            00164702
*                 REG 1 = ADDRESS OF EXTENT IN ERROR... THE FIRST       00166702
*                 WORD OF THE EXTENT CONTAINS THE SUBPOOL NUMBER AND    00168702
*                 LENGTH OF THE EXTENT.                                 00169102
*                                                                       00170002
*02*     RETURN-CODES = 4                                               00172002
*                                                                       00174402
*01*  EXIT-ERROR = DELERR08                                             00175602
*                                                                       00176002
*02*     CONDITIONS = ATTEMPT TO DELETE A 'NIP' CREATED POOL.           00176102
*                                                                       00176202
*02*     OUTPUT = RETURN CODE                                           00176302
*                                                                       00181602
*02*     RETURN-CODES = 8                                               00183602
*                                                                       00183702
*01*  EXIT-ERROR = DELERR12                                             00183802
*                                                                       00184102
*02*     CONDITIONS = ATTEMPT TO DELETE AN UNFORMATTED POOL.            00184502
*              OR AN ATTEMPT TO DELETE AN EXTENT ON A POOL THAT HAS NO  00184602
*              EXTENTS.                                                 00185002
*                                                                       00185402
*02*     OUTPUT = RETURN CODE                                           00187802
*                                                                       00188602
*02*     RETURN-CODES = 12                                              00189402
*                                                                       00190202
*01*  EXIT-ERROR = DELERR16                                             00191002
*                                                                       00191802
*02*     CONDITIONS = INVALID CPID PASSED OR NULL CPID (=0).            00192602
*                                                                       00193402
*02*     OUTPUT = RETURN CODE                                           00194202
*                                                                       00195002
*02*     RETURN-CODES = 16                                              00195802
*                                                                       00196602
*01*  EXIT-ERROR = DELERR20                                             00197402
*                                                                       00198202
*02*     CONDITIONS = CONCURRENT MUTUALLY EXCLUSIVE OPERATION TAKING    00199002
*        PLACE ON THIS EXTENT. EITHER A BLDCPOOL, GETCELL OR FREECELL   00199802
*        IS CURRENTLY OPERATING ON THIS EXTENT.                         00200602
*                                                                       00201402
*02*     OUTPUT = RETURN CODE                                           00202202
*                                                                       00203002
*02*     RETURN-CODES = 20                                              00203802
*                                                                       00204602
*01*  EXTERNAL-REFERENCES = CVT, GDA, CPAB                              00205402
*                                                                       00206202
*02*     ROUTINES = SVC 120 (FREEMAIN) VIA CONDITIONAL REGISTER FORM OF 00207002
*        FREEMAIN MACRO                                                 00207802
*                                                                       00208602
*02*     CONTROL-BLOCKS = CVT AND GDA (REFERENCE ONLY) AND CPAB         00209402
*        (REFERENCED AND DELETED)                                       00210202
*                                                                       00211002
*01*  TABLES = NONE                                                     00211802
*01*  MACROS = FREEMAIN                                                 00212602
*                                                                       00213402
*02*     SERIALIZATION = THE 'CPABFLGW' FIELD IS USED TO SERIALIZE ALL  00213802
*        OPERATIONS ON ANY SINGLE POOL EXTENT, REGARDLESS OF THE TYPE   00214202
*        OF OPERATION. THIS FIELD IS MANIPULATED WITH THE 'CS' (COMPARE 00214602
*        AND SWAP) INSTRUCTION. ONE BIT IN THIS FIELD, 'DELETELK', IS   00214702
*        USED TO INDICATE THAT THE EXTENT IS BEING DELETED FROM THE     00214802
*        POOL. IF A DELETE IS OCCURING (THE BIT IS 'ON'), ALL OTHER     00214902
*        OPERATIONS ARE PROHIBITED ON THE EXTENT BEING DELETED. IF NO   00217502
*        DELETE IS OCCURRING, THE USE COUNT 'CPABUSE#' IS USED TO       00219502
*        PREVENT A DELETE FROM STARTING IN THE MIDDLE OF SOME OTHER     00221502
*        PROCESS. A NON-ZERO VALUE FOR 'CPABUSE#' WILL PREVENT AN       00221902
*        EXTENT FROM BEING DELETED. ONCE THE EXTENT HAS BEEN LOCKED     00222302
*        AGAINST DELETES, THE DOUBLE-WORD FIELD CONSISTING OF           00222702
*        'CPABDEQC' AND 'CPABFACP' IS USED TO SERIALIZE THE ACQUISITION 00222802
*        AND RELEASE OF CELLS IN THE SINGLE EXTENT. THIS DOUBLE-WORD    00222902
*        FIELD IS MANIPULATED WITH THE 'CDS' (COMPARE DOUBLE AND SWAP)  00223002
*        INSTRUCTION.                                                   00223702
*                                                                       00224102
*                                                                       00225402
*01*  CHANGE-ACTIVITY = NONE ... NEW FOR OS/VS2 RELEASE 2               00226102
*01*  MESSAGES = NONE                                                   00228302
*01*  ABEND-CODES = NONE                                                00230902
*                                                                       00233502
**** END OF SPECIFICATIONS ***/                                         00236102
                 EJECT                                                  00282402
*/*DELCPOOL:   CHART (AMODE) */                                         00295002
*/* HEADER                                                              00305002
*/*DYNAMIC QUICKCELL FUNCTION                                           00305402
*/*                                         DELETE CELL POOL ROUTINE    00305802
*/*                                                                     00305902
*/*                                      PAGE # */                      00309602
*/*IEAVDELP:   E   (,%D1) BRANCH ENTRY */                               00313302
*/*%D1:        D   (YES,%PERM,NO,%DYN) PERMANENT CPID? */               00317002
*/*%PERM:      P   (,%D2) CALCULATE CPAB ADDRESS IN CPAB TABLE.*/       00328002
*/*%DYN:       D   (YES,%RC16,NO,%DYN2) NULL CPID? (=0) */              00339002
*/*%DYN2:      P   (,%D2) CALCULATE CPAB ADDRESS */                     00350002
*/*%D2:        D   (NO,%RC16,YES,%D3) CPID MATCH ONE IN CPAB? */        00400002
*/*%D3:        D   (NO,%RC12,YES,%D4) IS THE POOL FORMATTED? */         00450002
*/*%D4:        D   (YES,%EXT,NO,%NIP) 'EXTENT' DELETION REQUEST ? */    00500002
*/*%NIP:       D   (YES,%RC8,NO,EXTENT) NIP BUILT THIS POOL? */         00510002
*/*%EXT:       D   (YES,EXTENT,NO,%RC12) DOES THE POOL HAVE EXTENTS? */ 00550002
*/*EXTENT:     M   (,%D2A) FIND LAST EXTENT */                          00700002
*/*%D2A:       D   (ON,%RC20,OFF,%DEL) TEST AND SET DELETE INHIBIT      00710002
*/*FLAG*/                                                               00720002
*/*%DEL:       P   (,%FRD) DEQUEUE THIS EXTENT */                       00750002
*/*%FRD:       D   (YES,%FREE,NO,%DST1) FREEMAIN REQUEST? */            00800002
*/*%DST1:      P   (,%DEL3) STORE SUBPOOL AND POOL LENGTH IN POOL AREA  00810002
*/* */                                                                  00820002
*/*%FREE:      S   (,%DEL2) FREEMAIN: FREE THIS EXTENT & CPAB(E)*/      00850002
*/*%DEL2:      D   (NO,%DST2,YES,%DEL3) FREEMAIN SUCCESSFUL? */         00900002
*/*%DEL3:      D   (NO,%DCD,YES,%RC0) IS THE POOL FULLY DELETED? */     01000002
*/*%DCD:       D   (YES,%RC0,NO,%DCO) DELETE 'EXTENT=LAST' REQUEST? */  01150002
*/*%DCO:       D   (NO,%D2A,YES,%DEC) IS THIS ORIGINAL CPAB? */         01200002
*/*%DEC:       D   (YES,%SYS,NO,%RC0) DELETE POOL REQUEST? */           01210002
*/*%SYS:       D   (YES,%ZCPAB,NO,%D2A) SYSTEM POOL? */                 01300002
*/*%ZCPAB:     P   (,%FRD) ZERO OUT CPAB FIELDS  (EXCEPT CPID) AFTER    01350002
*/*SAVING ADDRESS AND SIZE*/                                            01360002
*/*%DST2:      P   (,%RC4) STORE SUBPOOL AND POOL LENGTH IN POOL AREA   01360402
*/**/                                                                   01360802
*/*%RC4:       R   RC=4, R0= FREEMAIN RETURN CODE */                    01362002
*/*%RC8:       R   RC=8 */                                              01364002
*/*%RC12:      R   RC=12 */                                             01366002
*/*%RC20:      R   RC=20 */                                             01368002
*/*%RC16:      R   RC=16 */                                             01370002
*/*%RC0:       R   RC=0 -- NORMAL-- */                                  01380002
*/*IEAVDELP: END */                                                     01400002
         EJECT                                                          01450002
IEAVDELP CSECT                                                          01860002
R0       EQU   0              ENTRY PARAMETER, CONTAINS CPID            01900002
*                              IMMEDIATELY BECOMES SCRATCH.             01910002
R1       EQU   1              ENTRY PARAMETER, CONTAINS OPTION CODE     01950002
*                              IMMEDIATELY BECOMES SCRATCH.             01960002
R2       EQU   2              SCRATCH                                   02000002
R3       EQU   3              ON ENTRY, CONTAINS CVT ADDRESS            02050002
*                              SCRATCH, FOLLOWING 'GOTCPAB'             02060002
R4       EQU   4              ORIGINAL CPAB BASE POINTER                02100002
R5       EQU   5              SCRATCH                                   02150002
R6       EQU   6              SCRATCH                                   02200002
R7       EQU   7              PRESERVED RETURN POINT TO USER            02250002
R8       EQU   8              INTERNAL LINKAGE REGISTER                 02300002
R9       EQU   9              USED TO SAVE ENTRY PARAMETER (CPID)       02350002
R10      EQU   10             USED TO SAVE ENTRY PARAMETER (OPTIONS)    02400002
R11      EQU   11             HEAD POINTER FOR THE PUSH-DOWN STACK OF   02450002
*                              DEQUEUED EXTENTS WHEN FREEMAIN IS        02460002
*                              SUPPRESSED.                              02470002
R12      EQU   12             PROGRAM BASE REGISTER                     02500002
R13      EQU   13             CONTAINS ADDRESS OF CALLER'S SAVE AREA    02550002
R14      EQU   14             CONTAINS ADDRESS OF RETURN POINT          02600002
*                              IMMEDIATELY BECOMES SCRATCH.             02610002
R15      EQU   15             USED FOR RETURN CODE ON EXIT              02650002
*                              IMMEDIATELY BECOMES SCRATCH.             02660002
LOWHALF  EQU   3              MASK USED FOR CLM OF LOW ORDER HALF-WORD  02670002
         USING IEAVDELP,R15                                             02680002
         MODID BR=YES                                                   02690002
         DROP  R15                                                      02692002
         BALR  R12,0                                                    02700002
         USING *,R12                                                    02750002
*********************************************************************** 02760002
*        SINCE THE PROGRAM HAS NO PLACE TO SAFELY STORE, THE ENTRY      02800002
*        PARAMETERS (CPID AND OPTION CODE) ARE PRESERVED IN REGISTERS,  02850002
*        BECAUSE THEY ARE REQUIRED THROUGHOUT THE PROGRAM.              02900002
*********************************************************************** 02902002
         LR    R7,R14         SAVE RETURN ADDRESS TO CALLER             02910002
         LR    R10,R1         SAVE OPTION CODE                          02950002
         LR    R9,R0          SAVE CPID                                 03000002
         SR    R11,R11        CLEAR PUSH-DOWN LIST ADDRESS              03050002
         LTR   R4,R0          TEST CPID VALUE AND SET CPAB BASE         03100002
         BM    PERMCPID       NEGATIVE, PERMANENT CPID                  03150002
         BZ    DELERR16       NULL (=0), ERROR RETURN.                  03200002
          EJECT                                                         03250002
*********************************************************************** 03260002
*        THE CPID IS FOR A DYNAMIC POOL, AND THE CPAB ADDRESS IS FOUND  03300002
*        BY MULTIPLYING THE CPID BY 4.                                  03350002
*********************************************************************** 03360002
         SLL   R4,2           MULTIPLY CPID BY 4 TO GET CPAB            03400002
         B     GOTCPAB         ADDRESS AND CONTINUE PROCESSING          03450002
         SPACE 2                                                        03500002
*********************************************************************** 03510002
*        THE CPID IS FOR A PERMANENT (SYSTEM) POOL, THE CPAB IS         03550002
*        FOUND BY USING THE LOW-ORDER BYTE OF THE CPID AS AN            03600002
*        INDEX INTO THE TABLE OF PERMANENT CPABS. THE TABLE IS          03650002
*        LOCATED VIA THE GLOBAL DATA AREA (GDA), WHICH IS FOUND         03700002
*        FROM THE CVT.                                                  03750002
*********************************************************************** 03760002
PERMCPID EQU   *                                                        03800002
         USING CVT,R3                                                   03850002
         L     R3,CVTGDA      GLOBAL DATA AREA ADDRESS                  03900002
         USING GDA,R3                                                   03950002
*****    NOTE: THIS CALCULATION IS DEPENDENT UPON THE LENGTH OF         03952002
*****      THE CPAB REMAINING AT 32 BYTES.                              03956002
         N     R4,F255        ISOLATE LOW-ORDER BYTE OF CPID            03960002
         SLL   R4,5           MULTIPLY BY CPAB LENGTH (32 BYTES)        03970002
         A     R4,PFSTCPAB     + PERMANENT CPAB TABLE ADDRESS           04000002
*                              RESULTING IN THE CPAB ADDRESS IN REG 4.  04050002
          SPACE 3                                                       04100002
*********************************************************************** 04110002
*        *** COMMON PATH *** CHECK FOR MATCHING CPID IN THE CPAB        04150002
*        BEFORE CONTINUING WITH THE DELETION PROCESS.                   04200002
*********************************************************************** 04210002
GOTCPAB  EQU   *                                                        04250002
         USING CPAB,R4                                                  04300002
         C     R9,CPABCPID    VALIDATE THE CPID FOR POOL INTEGRITY      04350002
         BNE   DELERR16       NO MATCH, ERROR RETURN.                   04400002
         SPACE 2                                                        04410002
*********************************************************************** 04420002
*        THIS IS THE CORRECT POOL, NOW CHECK TO SEE IF IT WAS           04450002
*        BUILT BY SYSTEM INITIALIZATION AND THAT THIS IS NOT            04500002
*        AN ATTEMPT TO DELETE THE ENTIRE POOL. THIS WILL PREVENT        04550002
*        ANY POOL WHICH MUST REMAIN AROUND UNTIL SYSTEM SHUT-DOWN       04600002
*        FROM BEING INADVERTENTLY DELETED.                              04650002
*********************************************************************** 04660002
         C     R10,POOLDEL#   IS THIS AN EXTENT DELETION REQUEST?       04700002
         BL    NONIPTST       YES, SKIP THE 'NIP' BUILT TEST            04750002
         TM    CPABFLGS,NIPBLDCP   IF IT WAS BUILT AT SYSTEM            04800002
         BO    DELERR08        INITIALIZATION, ERROR RETURN             04950002
         B     EXTENT         OTHERWISE CONTINUE                        05010002
NONIPTST EQU   *                                                        05050002
         CLC   CPABNXTP,F0    IS THERE A FIRST EXTENT ?                 05100002
         BE    DELERR12       NO, ERROR RETURN                          05200002
         EJECT                                                          05250002
*********************************************************************** 05260002
*        FIND THE LAST EXTENT ON THE QUEUE AND PREPARE TO DELETE IT.    05300002
*********************************************************************** 05310002
EXTENT   EQU   *                                                        05350002
         SR    R6,R6          INITIALIZE PRIOR CPAB POINTER             05360002
EXTENT0  EQU   *                                                        05370002
         CLC   CPABNXTP,F0    IS THIS THE LAST EXTENT?                  05400002
         BE    LASTEXT        YES, GO DEQUEUE IT.                       05450002
         LR    R6,R4          NO, STEP FORWARD DOWN THE QUEUE           05500002
         L     R4,CPABNXTP    AND GET THE NEXT CPAB ADDRESS.            05550002
         B     EXTENT0        SCAN UNTIL LAST EXTENT IS LOCATED         05600002
         SPACE 2                                                        05650002
*********************************************************************** 05660002
*        THIS IS THE LAST EXTENT, TEST IT FOR MUTUALLY                  05700002
*        EXCLUSIVE OPERATIONS, TO PREVENT POOL DESTRUCTION.             05750002
*********************************************************************** 05760002
LASTEXT  EQU   *                                                        05800002
         L     R0,CPABFLGW    GET LOCKING DATA                          05850002
         CLM   R0,LOWHALF,F0  TEST FOR MUTUALLY EXCLUSIVE OPERATIONS    05900002
         BNE   DELERR20       ONE IN PROCESS, ERROR EXIT                05950002
         LR    R1,R0          NONE, SET DELETE LOCK                     06000002
         O     R1,DELETEON    ON IN A COPY OF LOCKING DATA              06050002
         CR    R0,R1          IF THE DELETE BIT WAS ON, A DELETE        06060002
         BE    DELERR20       WAS ALREADY IN PROCESS, ERROR.            06070002
         CS    R0,R1,CPABFLGW OTHERWISE, TRY TO SET THE LOCK.           06100002
         BNE   DELERR20       THE LOCK DATA HAS CHANGED, ERROR          06150002
         SPACE 2                                                        06160002
*********************************************************************** 06170002
*        IF THE STORE WAS SUCCESSFUL, NO OTHER FUNCTION WILL            06200002
*        ATTEMPT TO USE THIS EXTENT, SO THE DELETION CAN                06250002
*        PROCEED SAFELY.                                                06300002
*********************************************************************** 06302002
         LTR   R6,R6          IS THIS THE ORIGINAL EXTENT?              06310002
         BNZ   DEQUEUE        NO, DEQUEUE IT.                           06320002
         C     R10,POOLDEL#   YES, IS THIS A POOL DELETE?               06330002
         BL    UNLOCKIT       NO, RELEASE (UNLOCK) THIS EXTENT.         06340002
         LR    R3,R4          SAVE THE ADDRESS OF THE ORIGINAL EXTENT   06340102
         B     REMOVEAB        AND SKIP THE DEQUEUEING MVC              06340402
DEQUEUE  EQU   *                                                        06342002
         MVC   CPABNXTP-CPAB(L'CPABNXTP,R6),CPABNXTP  DEQUEUE THE CPAB  06350002
          EJECT                                                         07550002
*********************************************************************** 07560002
*        THIS ROUTINE REMOVES THE CPAB WHOSE ADDRESS IS IN REGISTER 4.  07600002
*        IF THE SUPPRESS FREEMAIN OPTION WAS GIVEN, THE ROUTINE STORES  07650002
*        THE FREEMAIN INFORMATION IN THE FIRST TWO WORDS OF THE EXTENT. 07700002
*        IF FREEMAIN IS ALLOWED, THE ROUTINE ISSUES THE FREEMAIN TO     07750002
*        DELETE THE EXTENT AND ITS CPAB.                                07800002
*********************************************************************** 07810002
REMOVEAB EQU   *                                                        07850002
         L     R2,CPABENAD    END OF EXTENT ADDRESS                     07900002
         L     R6,CPABSTAD    STARTING ADDRESS OF EXTENT                07910002
         SR    R2,R6          EXTENT LENGTH = END ADDR - START ADDR     07950002
         BNP   DELERR12       ERROR, UNFORMATTED POOL (LENGTH <= 0)     08000002
         TM    CPABFLGS,CPABEXTN   IS THIS AN EXTENT                    08050002
         BO    BUMPSIZE       YES, ADD CPAB LENGTH TO EXTENT SIZE       08100002
         LTR   R9,R9          NO, IS IT A DYNAMIC POOL?                 08150002
         BM    NOBUMPSZ       NO, DO NOT ADD CPAB SIZE                  08200002
BUMPSIZE EQU   *                                                        08400002
         LA    R15,CPABNXTP-CPAB+L'CPABNXTP  CPAB LENGTH                08450002
         SR    R6,R15         TRUE START ADDRESS (CPAB ADDRESS)         08550002
         AR    R2,R15         TRUE LENGTH (INCLUDES CPAB LENGTH)        08600002
NOBUMPSZ EQU   *                                                        08650002
         SR    R5,R5          CLEAR REGISTER FOR SUBPOOL NUMBER         08652002
         IC    R5,CPABSPID    SUBPOOL NUMBER FOR FREEMAIN               08654002
         L     R4,CPABCPID    LOAD POINTER TO ORIGINAL CPAB             08660002
*                         OR CPID OF THE POOL, IF ORIGINAL BEING FREED. 08670002
         LR    R15,R10        COPY THE OPTION CODE AND TEST             08720002
         N     R15,FRMBIT31    IT FOR THE OCCURRENCE OF THE             08770002
         CLR   R15,R10         OCCURRENCE OF THE FREEMAIN SUPRESS BIT   08820002
         BNE   NOFREEMN        IF ON, SKIP FREEMAIN                     08850002
         FREEMAIN RC,A=(R6),LV=(R2),SP=(R5)                             08900002
         LTR   R15,R15        FREEMAIN SUCCESSFUL?                      08950002
         BZ    REMOVED        YES, PREPARE TO RETURN, IF FINISHED       09050002
          EJECT                                                         09100002
*********************************************************************** 09110002
*        THIS ROUTINE SAVES THE NECESSARY DATA FOR FREEMAINING          09150002
*        THE EXTENT THAT WAS NOT SUCCESSFULLY FREEMAINED IN CASE        09200002
*        THE CALLER HAS ANY BETTER CHANCE OF RECOVERING THE             09250002
*        ERROR THAN THIS PROGRAM DOES.                                  09300002
*********************************************************************** 09310002
DELERR04 EQU   *                                                        09350002
         LR    R1,R6          PUSH DOWN PRIOR FREED EXTENT              09400002
         LR    R0,R15         TRANSFER FREEMAIN ERROR CODE              09450002
         LA    R15,4          SET UP ERROR CODE FOR FREEMAIN FAILURE    09500002
         USING ERRLIST,R6                                               09550002
         ST    R11,ELISTCHN   STORE PRIOR FREED POOL ADDRESS            09560002
         ST    R2,ELISTLEN    STORE LENGTH OF THE AREA                  09570002
         STC   R5,ELISTSP#    STORE SUBPOOL NUMBER OF AREA              09580002
         LR    R11,R6         PUSH DOWN PRIOR FREED AREA (IF ANY)       09590002
         LR    R14,R7         RESTORE CALLER'S RETURN ADDRESS           09592002
         BR    R14            RETURN TO CALLER                          09594002
          SPACE 2                                                       09600002
*********************************************************************** 09610002
*        THIS ROUTINE SAVES THE DATA FOR FREEMAIN SO THAT THE           09650002
*        USER CAN ISSUE HIS OWN WHEN HE HAS SUPPRESSED FREEMAIN         09700002
*        BY DELCPOOL.                                                   09750002
*********************************************************************** 09760002
NOFREEMN EQU   *                                                        09800002
         ST    R11,ELISTCHN   STORE PRIOR FREED POOL ADDRESS            09900002
         ST    R2,ELISTLEN    STORE LENGTH OF THE AREA                  09950002
         STC   R5,ELISTSP#    STORE SUBPOOL NUMBER OF AREA              10000002
         LR    R11,R6         PUSH DOWN PRIOR FREED AREA (IF ANY)       10050002
         SPACE 2                                                        10150002
*********************************************************************** 10170002
*        ON RETURN, REG.4 CONTAINS THE CONTENTS OF 'CPABCPID' FROM THE  10180002
*        CPAB FOR THE EXTENT JUST DELETED. IF THIS WAS THE ORIGINAL     10190002
*        CPAB, THEN REG 4 = THE CPID, OTHERWISE, IT IS THE ADDRESS OF   10192002
*        THE ORIGINAL CPAB, AND CAN BE USED FOR THE QUEUE SEARCH.       10194002
*        NOW THAT THE LAST EXTENT OF THOSE THAT REMAIN HAS BEEN         10196002
*        REMOVED, CHECK TO SEE IF THE REQUEST WAS ONLY FOR THE          10198002
*        DELETION OF THE LAST EXTENT. IF IT WAS, RETURN.                10198402
*********************************************************************** 10198502
REMOVED  EQU   *                                                        10198602
         C     R10,LASTLIM#   WAS THIS EXTENT=LAST?                     10198802
         BNH   DELEXIT0       YES, SUCCESSFUL OPERATION, EXIT           10199202
         CR    R4,R9          NO, IS THE WHOLE POOL GONE?               10199602
         BE    DELEXIT        YES, RETURN TO USER                       10199702
         B     EXTENT         NO, GO FIND NEXT EXTENT TO BE DELETED     10199802
         EJECT                                                          10199902
*********************************************************************** 10210002
*        RETURN TO THE USER WITH R1 POINTING TO THE DELETED EXTENT      10216602
*        QUEUE, IF ANY, AND R0 CONTAINING THE CPID.                     10226602
*        IF THIS WAS THE DELETION OF A SYSTEM POOL, THEN THE CPAB       10230602
*        FIELDS (EXCEPT THE ID 'CPABCPID') ARE TO BE ZEROED. REG. 3     10232602
*        CONTAINS THE ORIGINAL CPAB ADDRESS.                            10233002
*********************************************************************** 10233102
DELEXIT  EQU   *                                                        10233902
         LTR   R9,R9          WAS THIS A PERMANENT POOL?                10236402
         BNM   DELEXIT0       NO, SKIP THE CPAB ZEROING PROCESS         10237202
         DROP  R4                                                       10238802
         USING CPAB,R3                                                  10240802
         MVI   CPABCSZE,0     YES, ZERO OUT THE CPAB FIELDS             10242802
         MVC   CPABCSZE+1(CPABNXTP-CPABCSZE+L'CPABNXTP-1),CPABCSZE      10243202
         DROP  R3                                                       10243602
         USING CPAB,R4                                                  10244002
DELEXIT0 EQU   *                                                        10244102
         LR    R1,R11         ADDRESS OF PUSH-DOWN STACK (IF ANY)       10244202
         LR    R0,R9          CPID OF THIS POOL                         10244402
         LR    R14,R7         RESTORE THE RETURN ADDRESS.               10258202
         SR    R15,R15        RETURN CODE OF ZERO                       10268202
         BR    R14            RETURN TO CALLER                          10270202
         SPACE 2                                                        10270302
*********************************************************************** 10270402
*        THE ORIGINAL CPAB HAS BEEN LOCKED, BUT IS NOT TO BE            10271102
*        DELETED, UNLOCK IT BEFORE RETURNING.                           10273102
*********************************************************************** 10275502
UNLOCKIT EQU   *                                                        10275902
         L     R0,CPABFLGW    GET THE LOCK FOR THE EXTENT               10276002
         LR    R1,R0          COPY IT AND TURN OFF THE                  10276102
         N     R1,DELETOFF    DELETE LOCK BIT                           10276302
         CS    R0,R1,CPABFLGW STORE THE LOCK (SHOULD GO THE FIRST TIME) 10276402
         BE    DELEXIT0       EXIT WHEN LOCK HAS BEEN TURNED OFF.       10276502
         B     UNLOCKIT       LOOP IF NECESSARY TO TURN IT OFF.         10276602
          EJECT                                                         10276702
*********************************************************************** 10276902
*        AN ATTEMPT HAS BEEN MADE TO DELETE A POOL CREATED BY           10277602
*        SYSTEM INITIALIZATION. THE ASSUMPTION IS MADE THAT SUCH        10278302
*        POOLS MUST REMAIN UNTIL THE SYSTEM ITSELF TERMINATES,          10279002
*        THEREFORE, DELETION OF SUCH POOLS IS NOT ALLOWED.              10279702
*********************************************************************** 10280402
DELERR08 EQU   *                                                        10281102
         LA    R15,8          SET RETURN CODE = 8                       10281802
         BR    R7             RETURN TO CALLER                          10282502
         SPACE 2                                                        10283202
*********************************************************************** 10283902
*        THE EXTENT TO BE DELETED IS UNFORMATTED, SO NO ATTEMPT         10284602
*        CAN BE MADE TO DELETE IT, AS ITS LENGTH CANNOT BE              10285302
*        COMPUTED PROPERLY. THIS OCCURS WHEN THE START ADDRESS          10286002
*        OF THE EXTENT 'CPABSTAD' IS LESS THAN OR EQUAL TO THE          10286702
*        END ADDRESS 'CPABENAD'. THE STORAGE IS LEFT UNCHANGED,         10287402
*        AND IT IS THE USER'S RESPONSIBILITY TO FREE THE EXTENT.        10288102
*        THIS RETURN CODE IS ALSO RETURNED WHEN A REQUEST               10288502
*        TO DELETE AN EXTENT OR EXTENTS WAS MADE, AND ONLY              10288602
*        THE ORIGINAL POOL SEGMENT EXISTS.                              10288702
*********************************************************************** 10288802
DELERR12 EQU   *                                                        10289502
         LA    R15,12         SET RETURN CODE = 12                      10290202
         BR    R7             RETURN TO CALLER                          10290902
         SPACE 2                                                        10291602
*********************************************************************** 10292302
*        THE CPID PASSED IS EITHER NULL (=0) OR DOES NOT AGREE          10293002
*        WITH THE CPID IN THE CPAB REFERENCED BY THE ID PASSED.         10293702
*********************************************************************** 10294402
DELERR16 EQU   *                                                        10295102
         LA    R15,16         SET RETURN CODE = 16                      10296502
         BR    R7             RETURN TO CALLER                          10298502
         SPACE 2                                                        10299002
*********************************************************************** 10299102
*        THE EXTENT BEING DELETED WAS FOUND TO BE THE OBJECT OF A       10299402
*        CONCURRENT OPERATION WHICH INHIBITS THE DELETE FUNCTION.       10299802
*        IN THIS CASE, A RETURN CODE OF 20 IS GENERATED AND RETURN      10300002
*        IS MADE TO THE CALLER. THE EXTENT IS LEFT ON THE QUEUE.        10308202
*********************************************************************** 10310102
DELERR20 EQU   *                                                        10310202
         LA    R15,20         SET RETURN CODE = 20                      10312202
         BR    R7             RETURN TO CALLER                          10314202
         EJECT                                                          10314602
*********************************************************************** 10316202
*        CONSTANTS AND DATA AREAS USED BY THE PROGRAM                   10316802
*********************************************************************** 10318802
POOLDEL# DC    F'8'           OPTION CODE FOR POOLDELETE                10325102
F0       DC    F'0'                                                     10333402
F255     DC    F'255'         MASK FOR MODULO DIVIDE BY 256             10341702
*        THE FOLLOWING TWO MASKS ARE USED TO TURN THE DELETE LOCK BIT   10343702
*        ON/OFF WHILE THE FLAG WORD IS IN A REGISTER.                   10345702
DELETEON DC    AL2(DELETELK),AL2(0)                                     10350002
DELETOFF DC    X'FF',AL1(X'FF'-DELETELK),2X'FF'                         10360002
LASTLIM# DC    F'3'           OPTION CODE FOR LAST EXTENT DELETION      10400002
FRMBIT31 DC    F'-2'          MASK TO TEST FOR FREEMAIN SUPRESSION      10450002
         SPACE 3                                                        10610002
*********************************************************************** 10612002
*        THIS DSECT DESCRIBES THE TWO-WORD ERROR LIST SET UP            10620002
*        IN THE FIRST TWO WORDS OF THE UN-FREEMAINED EXTENT.            10630002
*********************************************************************** 10640002
ERRLIST  DSECT                                                          10650002
ELISTLEN DS    0F                                                       10660002
ELISTSP# DS    C              SUBPOOL NUMBER                            10700002
         DS    AL3            LENGTH                                    10750002
ELISTCHN DS    A              CHAINING ADDRESS TO NEXT LIST             10800002
         EJECT                                                          10850002
CVT      DSECT                                                          10900002
         CVT   LIST=NO                                                  10950002
         EJECT                                                          10960002
         IHAGDA                                                         11000002
         EJECT                                                          11010002
         IHACPAB                                                        11050002
         END                                                            11100002
./  ADD  SSI=73490007,NAME=IEAVFRCL
         TITLE 'FREE CELL ROUTINE -- IEAVFRCL'                          00050002
* /* START OF SPECIFICATIONS ****                                       00050102
*                                                                       00060102
*01*  MODULE-NAME = IEAVFRCL                                            00060502
*                                                                       00061702
*02*     CSECT-NAME = IEAVFRCL                                          00061802
*                                                                       00062002
*01*  DESCRIPTIVE-NAME = FREE CELL                                      00068302
*                                                                       00072302
*01*  COPYRIGHT = NONE                                                  00074302
*01*  STATUS = OS/VS2 RELEASE 3.0/3.7                                   00084303
*              PTF LEVEL UZ15960                                        00086303
*                                                                       00096402
*01*  FUNCTION = RETURN A CELL TO A POOL OF CELLS (QUICKCELL POOL).     00097602
*                                                                       00099702
*02*     OPERATION = THIS ROUTINE WILL RETURN A CELL TO THE QUICKCELL   00099802
*        POOL FROM WHICH IT WAS PREVIOUSLY OBTAINED BY THE GETCELL      00101802
*        FUNCTION. IT PERFORMS VERIFICATIONS ON THE CELL TO ASSURE THAT 00103802
*        IT WAS ALLOCATED FROM THE GIVEN POOL. THIS IS                  00105802
*        DONE BY LOOKING FOR THE POOL ID (CPID) IN THE LAST WORD OF THE 00107802
*        CELL, AND BY CHECKING THAT THE CELL LIES FULLY WITHIN THE      00108202
*        BOUNDS OF ONE OF THE POOL EXTENTS. IT FURTHER CHECKS THAT THE  00108302
*        CELL IS A PROPER CELL BASED UPON ITS RELATIVE BOUNDARY IN THE  00110902
*        POOL EXTENT. IF ANY OF THESE TESTS FAIL, THE CELL WILL NOT BE  00112902
*        ACCEPTED. OTHERWISE, IT WILL BE ENQUEUED INTO THE POOL IN      00114902
*        PUSH-DOWN FASHION.                                             00115602
*                                                                       00117002
*01*   NOTES = STANDARD LINKAGE CONVENTIONS                             00117702
*                                                                       00120202
*02*     DEPENDENCIES = 370R-MP INSTRUCTION SET (CS AND CDS).           00122802
*                                                                       00125402
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00128002
*02*     RESTRICTIONS = MAY NOT USE REGISTERS 2 THROUGH 13 INCLUSIVE -- 00130602
*        THIS IS A DESIGN DESIGN RESTRICTION.                           00133202
*                                                                       00135802
*02*     REGISTER-CONVENTIONS = SEE REGISTER EQUATES AFTER CSECT        00138402
*        STATEMENT.                                                     00141002
*                                                                       00143602
*02*     PATCH-LABEL = NUCLEUS PATCH AREA                               00146202
*                                                                       00148802
*01*  MODULE-TYPE = MACRO-INVOKED PROCESSING SUBROUTINE                 00151402
*                                                                       00154002
*02*     PROCESSOR = ASSEMBLER-370R                                     00156602
*                                                                       00159202
*02*     MODULE-SIZE = 350 BYTES                                        00161802
*                                                                       00164402
*02*     ATTRIBUTES = REFRESHABLE NUCLEUS RESIDENT                      00167002
*                                                                       00169602
*01*  ENTRY-POINT = IEAVFRCL                                            00172202
*                                                                       00174802
*02*     PURPOSE = RETURN A CELL TO A QUICKCELL POOL.                   00174902
*                                                                       00175602
*02*     LINKAGE = ENTERED VIA BALR 14,15 --- THE MACRO FREECELL SHOULD 00176002
*        BE USED FOR INVOKATION. REGISTER 0 CONTAINS THE CPID OF THE    00178002
*        POOL WHILE REG. 1 CONTAINS THE ADDRESS OF THE CELL TO BE       00180002
*        FREED.                                                         00180402
*                                                                       00181402
*02*     INPUT = A FORMATTED QUICKCELL POOL (IMPLIED) AND AN ALLOCATED  00183402
*        CELL.                                                          00183802
*                                                                       00184502
*02*     OUTPUT = THE CELL RETURNED TO THE POOL, AND A RETURN CODE.     00186402
*                                                                       00188802
*02*     REGISTERS-SAVED = NONE ... REGISTERS 1 THROUGH 4 AND 15 WILL   00189202
*        BE CHANGED.                                                    00189602
*02*     REGISTER-USAGE = SEE COMMENTS ON REGISTER EQUATES.             00190102
*                                                                       00190302
*02*     REGISTERS-RESTORED = NONE                                      00192202
*01*  EXIT-NORMAL = FRCEXIT0                                            00195002
*                                                                       00196002
*02*     CONDITIONS = THE CELL HAS BEEN RETURNED. (OPTIONALLY, THE      00196102
*        EXTENT CONTAINING THE CELL HAS BEEN DELETED.)                  00196202
*                                                                       00198602
*02*     OUTPUT = WHEN THE RETURN CODE IS 0, REG 0 IS UNCHANGED AND REG 00199302
*        1 = 0. WHEN THE RETURN CODE IS 20, THE ADDRESS OF THE DELETED  00201302
*        EXTENT IS IN REG 1, WHILE REG 0 CONTAINS THE SUBPOOL # AND     00201702
*        LENGTH OF THE EXTENT.                                          00202102
*                                                                       00203102
*02*     RETURN-CODES = 0 = THE CELL HAS BEEN RETURNED                  00203502
*                      20 = THE EXTENT HAS BEEN DEQUEUED AND THE CELL   00203902
*                       RETURNED.                                       00204302
*                                                                       00204902
*01*  EXIT-ERROR = FRCERR04                                             00206902
*                                                                       00212102
*02*     CONDITIONS = THE CELL WAS NOT ALLOCATED FROM THIS POOL.        00212502
*                                                                       00213302
*02*     OUTPUT = RETURN CODE                                           00213402
*                                                                       00215202
*02*     RETURN-CODES = 4                                               00215602
*                                                                       00216902
*01*  EXIT-ERROR = FRCERR08                                             00218902
*                                                                       00219302
*02*     CONDITIONS = THE CELL DOES NOT BELONG TO ANY EXTENT OF THIS    00219402
*        POOL.                                                          00219502
*                                                                       00219602
*02*     OUTPUT = RETURN CODE                                           00219702
*                                                                       00219902
*02*     RETURN-CODES = 8                                               00220302
*                                                                       00220402
*01*  EXIT-ERROR = FRCERR12                                             00220602
*                                                                       00222602
*02*     CONDITIONS = THE POOL CONTAINS NO EXTENTS OR IS UNFORMATTED.   00222702
*                                                                       00222802
*02*     OUTPUT = RETURN CODE                                           00222902
*                                                                       00223002
*02*     RETURN-CODES = 12                                              00223402
*                                                                       00223802
*01*  EXIT-ERROR = FRCERR16                                             00223902
*                                                                       00224002
*02*     CONDITIONS = THE CPID REFERENCES AN UNDEFINED POOL.            00224102
*                                                                       00224502
*02*     OUTPUT = RETURN CODE                                           00224902
*                                                                       00225002
*02*     RETURN-CODES = 16                                              00225102
*                                                                       00225202
*01*  EXTERNAL-REFERENCES = CVT, GDA AND CPAB                           00225302
*                                                                       00225602
*02*     ROUTINES = NONE                                                00225702
*                                                                       00226002
*02*     CONTROL-BLOCKS = CVT AND GDA -- READ ONLY. CPAB (CELL POOL     00226702
*        ANCHOR BLOCK) READ AND WRITE.                                  00227102
*                                                                       00227202
*01*  TABLES = NONE                                                     00227302
*01*  MACROS = NONE                                                     00227702
*02*     SERIALIZATION = THE 'CPABFLGW' FIELD IS USED TO SERIALIZE ALL  00229702
*        OPERATIONS ON ANY SINGLE POOL EXTENT, REGARDLESS OF THE TYPE   00231702
*        OF OPERATION. THIS FIELD IS MANIPULATED WITH THE 'CS' (COMPARE 00232102
*        AND SWAP) INSTRUCTION. ONE BIT IN THIS FIELD, 'DELETELK', IS   00232502
*        USED TO INDICATE THAT THE EXTENT IS BEING DELETED FROM THE     00232902
*        POOL. IF A DELETE IS OCCURING (THE BIT IS 'ON'), ALL OTHER     00233002
*        OPERATIONS ARE PROHIBITED ON THE EXTENT BEING DELETED. IF NO   00233102
*        DELETE IS OCCURRING, THE USE COUNT 'CPABUSE#' IS USED TO       00233202
*        PREVENT A DELETE FROM STARTING IN THE MIDDLE OF SOME OTHER     00233302
*        PROCESS. A NON-ZERO VALUE FOR 'CPABUSE#' WILL PREVENT AN       00233402
*        EXTENT FROM BEING DELETED. ONCE THE EXTENT HAS BEEN LOCKED     00233502
*        AGAINST DELETES, THE DOUBLE-WORD FIELD CONSISTING OF           00234102
*        'CPABDEQC' AND 'CPABFACP' IS USED TO SERIALIZE THE ACQUISITION 00234502
*        AND RELEASE OF CELLS IN THE SINGLE EXTENT. THIS DOUBLE-WORD    00234902
*        FIELD IS MANIPULATED WITH THE 'CDS' (COMPARE DOUBLE AND SWAP)  00235302
*        INSTRUCTION.                                                   00235402
*                                                                       00235602
*01*  CHANGE-ACTIVITY = NEW FOR OS/VS2 RELEASE 2  - LEVEL 02.00         00236202
*                                                                       00236402
*          APARS   OZ18115                                     @ZA18115 00236503
*                  OZ28730                                     @ZA28730 00236703
*                                                                       00236903
*01*  MESSAGES = NONE                                                   00237003
*01*  ABEND-CODES = NONE                                                00237302
**** END OF SPECIFICATIONS ***/                                         00237902
         EJECT                                                          00287702
*/*FREECELL: CHART (AMODE) */                                           06100002
*/* HEADER                                                              06110002
*/*DYNAMIC QUICKCELL FUNCTION                                           06120002
*/*                                                FREE CELL ROUTINE    06140002
*/*                                                                     06142002
*/*                               PAGE # */                             06144002
*/*IEAVFRCL:1A1 E  (,%D1) BRANCH ENTRY */                               06150002
*/*%D1:1B1     D   (YES,PERMCPID,NO,%D2) PERMANENT CPID? */             06200002
*/*%D2:1B2     D   (YES,FRCERR16,NO,%DYN) NULL CPID (=0)? */            06250002
*/*PERMCPID:   P   (,GOTCPAB) GET INDEX INTO CPAB TABLE FOR CPAB */     06300002
*/*%DYN:1B3    P   (,GOTCPAB) COMPUTE CPAB ADDRESS */                   06350002
*/*GOTCPAB:    D   (NO,FRCERR16,YES,%D5) CPID MATCH ONE IN CPAB? */     06400002
*/*%D5:1E1     D   (NO,FRCERR12,YES,%D6) IS THE POOL FORMATTED?  */     06500002
*/*%D6:1F1     D   (NO,FRCERR4,YES,CPABLOOP) IS THIS AN ALLOCATED CELL? 06600002
*/* */                                                                  06650002
*/*CPABLOOP:   D   (NO,GNXTCPAB,YES,%BNDRY) CELL WITHIN THIS POOL       06700002
*/*EXTENT? */                                                           06710002
*/*GNXTCPAB:   D   (NO,FRCERR08,YES,%CHN) ANY OTHER EXTENTS? */         06750002
*/*FRCERR08:   R   RC=8 */                                              06800002
*/*%CHN:1D3    M   (,CPABLOOP) GET NEXT EXTENT ADDRESS */               06850002
*/*%BNDRY:     P   (,%BNDRYT) COMPUTE RELATIVE ADDRESS OF THE CELL IN   06900002
*/*THE EXTENT */                                                        06910002
*/*%BNDRYT:    D   (YES,DLCKCHK,NO,FRCERR08) CELL ON INTEGRAL BOUNDARY  06920002
*/*? */                                                                 06930002
*/*DLCKCHK:    D   (ON,FRCEXIT0,OFF,%INCR) TEST DELETE IN PROCESS FLAG  06950002
*/**/                                                                   06952002
*/*%INCR:      P   (,ENQLOOP) LOCK OUT DELETE (RAISE USE COUNT) */      06960002
*/*ENQLOOP:    M   (,%CDS) SET UP FOR 'CDS' TO ENQUEUE THE CELL */      07000002
*/*%CDS:1J3    D   (YES,UNLCKLP,NO,ENQLOOP) CDS-DID THE STORE OCCUR?    07050002
*/**/                                                                   07052002
*/*UNLCKLP:    P   (,%ADELCHK) UNLOCK THIS EXTENT - LOWER USE COUNT. */ 07052402
*/*%ADELCHK:   D   (NO,FRCEXIT0,YES,%EMPTY) AUTO-DELETE CANDIDATE ? */  07054002
*/*%EMPTY:     D   (NO,FRCEXIT0,YES,%REM1) ALL CELLS RETURNED ?         07054402
*/**/                                                                   07054802
*/*%REM1:      D   (NO,FRCEXIT0,YES,%REMOV) LAST EXTENT ? */            07056002
*/*%REMOV:     P   (,%DELGET) LOCK THE EXTENT AGAINST OTHER OPERATIONS  07058002
*/**/                                                                   07058102
*/*%DELGET:    D   (YES,DEQUEIT,NO,FRCEXIT0) IS IT LOCKED NOW? */       07058202
*/*DEQUEIT:    P   (,FRCERR20) DELETE THE LAST EXTENT */                07058402
*/*FRCERR20:  P   (,%EXIT20) SET UP REGISTERS 0 AND 1 TO ALLOW FREEMAIN 07058802
*/* BY CALLER */                                                        07059202
*/*%EXIT20:    R   RC=20 */                                             07059602
*/*FRCEXIT0:   R   RC=0 --NORMAL-- */                                   07150002
*/*FRCERR4:    R   RC=4 */                                              07152002
*/*FRCERR12:   R   RC=12 */                                             07154002
*/*FRCERR16:   R   RC=16 */                                             07160002
*/*IEAVFRCL: END */                                                     07200002
         EJECT                                                          07210002
IEAVFRCL CSECT                                                          07250002
CELLLINK EQU   0              CELL LINKAGE POINTER                      07300002
CLINKLEN EQU   4              CELL LINKAGE POINTER FIELD LENGTH         07350002
R0       EQU   0              CPID -- INPUT PARAMETER                   07400002
R1       EQU   1              CELL ADDRESS -- INPUT PARAMETER           07450002
@R2      EQU   2              SCRATCH REGISTER                          07500002
@R3      EQU   3              SCRATCH REGISTER                          07550002
*                             ON INPUT, R3 CONTAINS CVT ADDRESS         07600002
R4       EQU   4              CPAB ADDRESS (CALCULATED)                 07650002
*        NOTE: REGISTERS 5 THROUGH 13 ARE EXPLICITLY FORBIDDEN FOR USE *07652002
               BY THIS ROUTINE                                          07654002
R14      EQU   14             RETURN ADDRESS                            07700002
R15      EQU   15             ENTRY POINT ADDRESS (BASE REGISTER)       07750002
         USING IEAVFRCL,R15                                             07800002
         MODID BR=YES                                                   07810002
         LTR   R4,R0          TEST CPID VALUE AND SET CPAB ADDRESS BASE 07850002
         BM    PERMCPID       NEGATIVE, PERMANENT (SYSTEM) CPID         07900002
         BZ    FRCERR16       NULL (=0), ERROR CONDITION                07950002
*********************************************************************** 07960002
*        THE CPID HAS BEEN FOUND TO BE A DYNAMIC POOL ID AND            08000002
*        THE ADDRESS OF THE FIRST CPAB IS FOUND FROM THE CPID           08050002
*        BY MULTIPLYING IT BY 4.                                        08100002
*        SINCE R4 ALREADY CONTAINS THE CPID, MULTIPLY BY 4              08150002
*********************************************************************** 08160002
         SLL   R4,2           GET THE CPAB BASE REGISTER                08200002
         B     GOTCPAB         CONTINUE COMMON PROCESSING.              08250002
         EJECT                                                          08300002
*********************************************************************** 08310002
*        A PERMANENT (SYSTEM) CPID HAS BEEN PASSED, THE CPAB            08350002
*        ADDRESS IS FOUND BY USING THE LOW-ORDER BYTE OF THE            08400002
*        ID AS AN INDEX INTO A TABLE OF CPAB'S. THE TABLE IS            08450002
*        FOUND FROM THE GLOBAL DATA AREA (GDA), WHOSE ADDRESS           08500002
*        IS FOUND IN THE CVT.                                           08550002
*********************************************************************** 08560002
PERMCPID EQU   *                                                        08600002
         USING CVT,@R3                                                  08650002
         L     @R3,CVTGDA         ADDRESS OF THE GLOBAL DATA AREA       08700002
         USING GDA,@R3                                                  08750002
*        REG. 4 ALREADY CONTAINS THE CPID, SO THE CPAB ADDRESS = CPID   08850002
         N     R4,F255             // 256 (MODULO DIVISION)             08900002
         SLL   R4,5                * 32 (CPAB LENGTH)                   08950002
         A     R4,PFSTCPAB         + CPAB TABLE ADDRESS                 09000002
*****    NOTE: THE PREVIOUS CALCULATION IS DEPENDENT UPON THE LENGTH OF*09010002
                THE CPAB REMAINING AT 32.                               09020002
         SPACE 3                                                        09050002
*********************************************************************** 09060002
*        COMMON PATH******** AFTER FINDING THE CPAB FOR THE             09100002
*        ID GIVEN, CHECK FOR MATCHING CPID'S, UNFORMATTED               09150002
*        POOLS, AND UNALLOCATED (NOT GETCELL'ED) CELLS.                 09200002
*********************************************************************** 09202002
GOTCPAB  EQU   *                                                        09210002
         USING CPAB,R4                                                  09250002
         C     R0,CPABCPID        DO THE CPID'S MATCH ?                 09300002
         BNE   FRCERR16            NO, ERROR CONDITION                  09350002
         L     @R2,CPABSTAD       YES, GET POOL START ADDRESS           09400002
         LTR   @R2,@R2            HAS THE POOL EVER BEEN FORMATTED?     09450002
         BZ    FRCERR12            NO, ERROR CONDITION                  09500002
         L     @R3,CPABCSZE       YES, GET THE CELL SIZE FROM THE CPAB  09550002
         C     R0,CELLLINK(@R3,R1) HAS THE CELL BEEN ALLOCATED          09600002
*                                  FROM THIS POOL? (CONTAIN THIS CPID?) 09650002
         BNE   FRCERR04            NO, ERROR CONDITION                  09700002
         EJECT                                                          09750002
*********************************************************************** 09760002
*        THE CELL HAS BEEN SHOWN TO BELONG TO THIS POOL AND             09800002
*        THE POOL IS KNOWN TO BE FORMATTED, NOW FIND THE                09850002
*        SEGMENT (EXTENT) OF THE POOL TO WHICH THE CELL BELONGS.        09900002
*********************************************************************** 09910002
CPABLOOP EQU   *                                                        09950002
         C     R1,CPABSTAD    CHECK CELL AGAINST LOW BOUND              10000002
         BL    GNXTCPAB       OUT OF BOUNDS, GET NEXT EXTENT            10050002
         LA    @R2,CLINKLEN(@R3,R1)  SET UP ADDRESS OF END OF CELL      10100002
         C     @R2,CPABENAD   TEST CELL END AGAINST UPPER BOUND         10150002
         BH    GNXTCPAB       OUT OF BOUNDS, TRY NEXT EXTENT            10200002
         SPACE 2                                                        10250002
*********************************************************************** 10260002
*        THE EXTENT HAS BEEN FOUND TO WHICH THE CELL BELONGS.           10300002
*        CHECK TO SEE THAT THE CELL IS ON AN INTEGRAL BOUNDARY          10350002
*        WITHIN THAT EXTENT.                                            10400002
*********      FROM NOW ON, THE CPID IS NOT AVAILABLE IN A              10450002
*              REGISTER, AND REGISTER 0 WILL CONTAIN VARYING            10500002
*              DATA.                                                    10550002
*********************************************************************** 10560002
         LA    R0,CLINKLEN(@R3)      R0 = COMPLETE CELL SIZE - LINK     10600002
*                             WORD LENGTH (4) IS INCLUDED               10650002
         LR    @R3,R1         CELL ADDRESS                              10700002
         S     @R3,CPABSTAD        - START ADDRESS OF THE POOL          10750002
         BZ    SKIPDVD             GIVES THE RELATIVE ADDRESS           10800002
*                                  OF THE CELL IN THE POOL. IF          10850002
*                                  IT IS ZERO, SKIP DIVISION.           10900002
         SR    @R2,@R2        CLEAR FOR DIVISION                        10950002
         DR    @R2,R0         DIVIDE BY CELL LENGTH                     11000002
         LTR   @R2,@R2        IF REMAINDER IS ZERO, CELL IS             11050002
*                             ON AN INTEGRAL BOUNDARY.                  11100002
         BNZ   FRCERR08       IF NOT, ERROR CONDITION                   11150002
SKIPDVD  EQU   *                                                        11200002
         SPACE 2                                                        11300002
*********************************************************************** 11310002
*        NOW THAT THE EXTENT TO WHICH THE CELL BELONGS IS KNOWN,        11350002
*        CHECK TO SEE IF IS BEING DELETED BEFORE ALLOWING THE CELL      11400002
*        TO BE STORED.                                                  11500002
*********************************************************************** 11510002
DLCKCHK  EQU   *                                                        11550002
         L     @R2,CPABFLGW   GET LOCKING FLAGS AND USE COUNT           11600002
DLCKCHK2 EQU   *                                                        11620002
         LR    @R3,@R2        COPY THEM FOR TESTING                     11650002
         N     @R3,DLFLGOFF   TURN OFF DELETE FLAG IN COPY              11700002
         CR    @R2,@R3        IF THEY ARE THE SAME, THE DELETE LOCK     11750002
*                             WAS ALREADY OFF.                          11800002
         BNE   FRCEXIT0       OTHERWISE A DELETE IS IN PROCESS          11850002
******   NOTE **** A LOAD ADDRESS (LA) INSTRUCTION CANNOT BE USED HERE, 11860002
*        SINCE THE FIELD BEING INCREMENTED CONTAINS THE SUBPOOL ID IN   11870002
*        ITS HIGH-ORDER BYTE.                                           11880002
         LR    @R3,@R2        NO DELETE GOING ON, LOCK OUT DELETE       11900002
         A     @R3,F1         BY RAISING THE OPERATION COUNT.           11950002
         CS    @R2,@R3,CPABFLGW    STORE LOCKS IF NOTHING HAS           12000002
*                                  HAPPENED TO CHANGE THE STATUS.       12050002
         BNE   DLCKCHK2       STATUS CHANGED, SEE WHY.                  12100002
         SPACE 2                                                        12150002
*********************************************************************** 12160002
*        NO DELETES ARE IN PROCESS AND DELETE IS LOCKED OUT OF          12200002
*        THIS EXTENT, RESTORE THE CELL TO THE POOL.                     12250002
*********************************************************************** 12260002
ENQLOOP  EQU   *                                                        12300002
         LM    @R2,@R3,CPABDEQC    GET DEQUEUE COUNT AND FIRST          12350002
*                                  AVAILABLE CELL POINTER FROM          12400002
*                                  THE CPAB.                            12450002
ENQLOOP2 EQU   *                                                        12470002
         A     R1,CPABCSZE    GET LINK POINTER ADDRESS FOR THE          12500002
*                             CELL BEING RETURNED.                      12550002
         ST    @R3,CELLLINK(R1)    PUSH-DOWN THE PRIOR FIRST CELL       12600002
         S     R1,CPABCSZE    CONVERT ADDRESS BACK TO THAT OF THE CELL  12650002
         LR    R0,@R2         REDUCE THE DEQUEUE COUNT BY 1 TO          12700002
         BCTR  R0,R0          ASSURE SERIALIZATION OF THE CDS           12750002
         CDS   @R2,R0,CPABDEQC     ENQUEUE THE CELL IN THE POOL         12800002
         BNE   ENQLOOP2            ENQUEUE FAILED, TRY AGAIN            12850002
         SPACE 3                                                        12900002
*********************************************************************** 12910002
*        THE CELL HAS BEEN SUCCESSFULLY RETURNED TO THE POOL,           12950002
*        TAKE OFF THE LOCK ON THE POOL EXTENT (BY REDUCING THE USE      13000002
*        COUNT).                                                        13004002
*********************************************************************** 13010002
UNLCKLP  EQU   *                                                        13050002
         L     @R2,CPABFLGW   GET THE LOCKING FLAGS AND USE COUNT       13100002
UNLCKLP2 EQU   *                                                        13120002
         LR    @R3,@R2        COPY THEM                                 13150002
         BCTR  @R3,0          REDUCE THE USE COUNT                      13200002
         CS    @R2,@R3,CPABFLGW    UNLOCK THE EXTENT (STORE THE UPDATED 13250002
         BNE   UNLCKLP2       LOCK). IF THE STORE FAILED, TRY AGAIN     13300002
         EJECT                                                          13320002
*********************************************************************** 13320402
*        THE CELL THAT WAS RETURNED MAY HAVE CAUSED THE ENTIRE EXTENT   13322002
*        TO BECOME FREE OF ALLOCATED CELLS. IF THIS WAS THE CASE, AND   13324002
*        THE USER CHOSE THE 'AUTOMATIC DELETE OPTION', THEN THIS        13326002
*        EXTENT WILL BE RELEASED, PROVIDED THAT EITHER:                 13327003
*         (1) THIS IS THE LAST EXTENT AND IS NOT THE ORIGINAL  @ZA28730 13327103
*             EXTENT, OR                                       @ZA28730 13327203
*         (2) THE CALLER HAS GUARANTEED THAT THE CHAIN OF      @ZA28730 13327303
*             EXTENTS IS PROPERLY SERIALIZED AND THIS IS NOT   @ZA28730 13327403
*             THE ORIGINAL EXTENT.                             @ZA28730 13327503
*                                                                       13328603
*        FOR ANY OTHER CONDITIONS, THE NORMAL RETURN IS TAKEN AND THE   13328703
*        EXTENT IS NOT DELETED.                                         13328803
*********************************************************************** 13328902
         TM    CPABFLGS,ADELCAND+CPABEXTN                               13329202
         BNO   FRCEXIT0       EXIT, EITHER NOT AN EXTENT OR NOT         13329602
*                             MARKED AS AN AUTO-DELETE CANDIDATE.       13329702
         LTR   R0,R0          TEST THE DEQUEUE COUNT FOR 0              13329802
         BNZ   FRCEXIT0       THE EXTENT IS NOT FREE, EXIT              13329902
         LR    @R2,@R3        SAVE SP # IN CASE SERIAL SPECF'D @ZA28730 13330403
         TM    CPABFLGS,SERIAL IS SERIALIZATION GUARANTEED?    @ZA28730 13331103
         BO    ORGADDR        YES, GO DEQUEUE THE EXTENT       @ZA28730 13331803
         L     @R2,CPABNXTP   GET NEXT EXTENT POINTER                   13333202
         LTR   @R2,@R2        IS THIS THE LAST EXTENT?                  13335202
         BNZ   FRCEXIT0       NO, THERE IS ANOTHER, EXIT                13335602
         SPACE 2                                                        13336002
*********************************************************************** 13336102
*        IN ADDITION TO THE ABOVE, THE USE COUNT OF THE EXTENT @ZA18115 13337103
*        MUST ALSO BE 0.  THE 'CS' BELOW CHECKS FOR A 0 USE    @ZA18115 13338103
*        COUNT AND IF IT IS 0, TURNS ON THE DELETE LOCK FLAG.  @ZA18115 13339103
*        ALL THE PREREQUISITES FOR AN AUTO-DELETE HAVE BEEN SATISFIED.  13345103
*        DELCPOOL WOULD NOW BE INVOKED TO FREE THE EXTENT WITHOUT       13345603
*        FREEMAINING THE CORE IT OCCUPIES. THE CALLER WILL BE NOTIFIED  13346103
*        AND WILL RECEIVE SUFFICIENT INFORMATION FOR EXECUTING THE      13347102
*        FREEMAIN HIMSELF.                                              13357102
*        NOTE: SINCE THE INVOKATION OF DELCPOOL REQUIRES A SAVE AREA &  13358802
*        NONE IS AVAILABLE TO THIS ROUTINE, THE DELETION OF THE POOL    13359602
*        IS ACCOMPLISHED BY THIS MODULE DIRECTLY.                       13360002
*********************************************************************** 13360602
         N     @R3,ZEROUSE        ONLY SET DELETE LOCK FLAG    @ZA18115 13362203
*                                 IF THE USE COUNT IS ZERO     @ZA18115 13362403
         LR    @R2,@R3            COPY THE LOCKING FLAGS                13362503
         O     @R2,DELETEON       SET THE DELETE LOCK FLAG ON           13362603
         CS    @R3,@R2,CPABFLGW   SEIZE THE EXTENT (IF POSSIBLE)        13362903
         BNE   FRCEXIT0           IN USE, RETURN                        13363002
         EJECT                                                          13363103
*********************************************************************** 13363303
*        ALTHOUGH THE USE COUNT WAS ZERO AT THE TIME OF THE 'CS',       13365303
*        A GETCELL COULD HAVE BEEN COMPLETELY EXECUTED ON THIS          13367303
*        EXTENT BETWEEN NOW AND THE TIME THAT THE DEQUEUE               13371803
*        COUNT WAS LAST CHECKED.  THEREFORE, WITH THE DELETE LOCK       13371903
*        NOW SET, THE DEQUEUE COUNT MUST BE CHECKED AGAIN.  IF IT       13372003
*        IS STILL ZERO, THE EXTENT CAN BE SAFELY DELETED.  IF NOT,      13372103
*        THE EXTENT MUST BE UNLOCKED.                          @ZA18115 13372203
*********************************************************************** 13372303
         L     @R3,CPABDEQC       GET COUNT OF DEQUEUED CELLS  @ZA18115 13372403
         LTR   @R3,@R3            ANY CELLS IN USE ?           @ZA18115 13372503
         BNZ   RESETDLK           YES, TURN OFF DELETE LOCK    @ZA18115 13372603
ORGADDR  L     R1,CPABCPID        GET ADDRESS OF ORIGINAL CPAB @ZA28730 13372703
PREDSRCH EQU   *                                                        13373603
         C     R4,CPABNXTP-CPAB(R1) IS THIS THE PREDECESSOR?            13373802
         BE    DEQUEIT            YES, REMOVE THE CPAB FROM THE CHAIN   13375802
         L     R1,CPABNXTP-CPAB(R1) NO, GET THE NEXT CPAB               13377802
         B     PREDSRCH           AND CONTINUE THE SEARCH               13379102
DEQUEIT  EQU   *                                                        13379202
         MVC   CPABNXTP-CPAB(L'CPABNXTP,R1),CPABNXTP DEQUEUE THE CPAB   13381502
         LR    R0,@R2             PASS THE SUBPOOL NUMBER               13383502
         ICM   R0,ADDRPART,CPABENAD+1    THE EXTENT SIZE                13383602
         S     R0,CPABSTAD         = (END ADDR - START ADDR)            13383802
         A     R0,FCPABLEN        ADD THE CPAB LENGTH.                  13383902
         LR    R1,R4              PASS BACK THE EXTENT ADDRESS          13384202
         LA    R15,20             SET AUTO-DELETE RETURN CODE           13384402
         BR    R14                RETURN TO CALLER                      13386202
         EJECT                                                          13388502
*********************************************************************** 13388603
*        ALTHOUGH THIS INVOCATION OF FREE CELL RETURNED THE LAST        13388703
*        ALLOCATED CELL TO THE EXTENT, AND ALTHOUGH THE USE COUNT       13388803
*        WAS ZERO AT THE TIME THAT THE DELETE LOCK FLAG WAS 'CS'D'      13388903
*        ON, A CELL WAS RE-ALLOCATED FROM THE EXTENT AT SOME POINT      13389603
*        AFTER THE DEQUEUE COUNT WAS FIRST CHECKED FOR ZERO, AND THE    13389703
*        TIME THAT THE DELETE LOCK WAS SET ON.  THEREFORE, THE EXTENT   13389803
*        CANNOT BE DELETED, AND THE DELETE LOCK MUST BE TURNED OFF.     13389903
*                                                              @ZA18115 13390003
*********************************************************************** 13390103
RESETDLK EQU   *                                               @ZA18115 13390203
         NI    CPABFLGS,UNLOCK    TURN OFF DELETE LOCK FLAG    @ZA18115 13390303
         SPACE                                                          13390403
*********************************************************************** 13390502
*        SINCE A POOL BEING DELETED EFFECTS THE FREEING OF THE          13390802
*        CELL, IF A DELETE WAS IN PROCESS AND THE CELL BELONGED         13393102
*        TO THE EXTENT BEING DELETED, A NORMAL RETURN IS TAKEN.         13395402
*                                                                       13397702
*        THE CELL HAS BEEN SUCCESSFULLY RETURNED TO THE POOL, AND       13400002
*        THE POOL IS UNLOCKED, RETURN TO THE USER.                      13450002
*********************************************************************** 13452002
FRCEXIT0 EQU   *                                                        13460002
         TM    CPABFLGS,CPABEXTN   IS THE PRESENT CPAB THE ORIGINAL ?   13461002
         BZ    ORIGINAL       YES, THE CPID IS IN CPABCPID.             13462002
         L     R4,CPABCPID    NO, GET THE ADDRESS OF THE ORIGINAL CPAB. 13463002
ORIGINAL EQU   *                                                        13464002
         L     R0,CPABCPID    GET THE CPID OF THE POOL (RETURN PARM).   13465002
         SR    R1,R1          CLEAR REG 1 (REMOVE CELL ADDRESSABILITY)  13470002
         SR    R15,R15        SET RETURN CODE = 0                       13500002
         BR    R14            RETURN TO THE CALLER                      13550002
         SPACE                                                          13600002
*********************************************************************** 13610002
*        IF THE CELL DID NOT BELONG IN THE EXTENT UNDER INVESTIGATION   13650002
*        AND THERE ARE MORE EXTENTS TO CHECK, CONTINUE THE SEARCH       13700002
*        FOR THE EXTENT TO WHICH THE CELL DOES BELONG.                  13750002
*********************************************************************** 13760002
GNXTCPAB EQU   *                                                        13800002
         L     R4,CPABNXTP    ADDRESS OF THE NEXT CPAB                  13850002
         LTR   R4,R4          IF IT IS ZERO, THERE ARE NO MORE          13900002
*                             EXTENTS.                                  13950002
         BNZ   CPABLOOP       OTHERWISE, CONTINUE THE SEARCH.           14000002
         B     RETCDEQ8       NO MORE EXTENTS, SET ERROR RETURN CODE.   14020002
         EJECT                                                          14030003
*********************************************************************** 14060002
*        IF THERE ARE NO MORE EXTENTS AND THE CELL HAS NOT BEEN         14100002
*        RETURNED, THERE IS AN ERROR AND A CODE OF 8 IS RETURNED.       14150002
*********************************************************************** 14160002
FRCERR08 EQU   *                                                        14200002
         TM    CPABFLGS,CPABEXTN   IS THE PRESENT CPAB THE ORIGINAL ?   14208002
         BZ    ORIGCPAB       YES, THE CPID IS IN CPABCPID.             14216002
         L     R4,CPABCPID    NO, GET THE ADDRESS OF THE ORIGINAL CPAB. 14224002
ORIGCPAB EQU   *                                                        14232002
         L     R0,CPABCPID    GET THE CPID OF THE POOL (RETURN PARM).   14240002
RETCDEQ8 EQU   *                                                        14245002
         LA    R15,8                                                    14250002
         BR    R14            RETURN                                    14300002
         SPACE                                                          14320003
*********************************************************************** 14360002
*        THE CELL WAS NOT ALLOCATED FROM THIS POOL (THE CPID IN THE     14400002
*        CELL DOES NOT MATCH THE CPID OF THE POOL).                     14450002
*********************************************************************** 14460002
FRCERR04 EQU   *                                                        14500002
         LA    R15,4                                                    14550002
         BR    R14                                                      14600002
         SPACE                                                          14650002
*********************************************************************** 14660002
*        THIS POOL HAS NOT BEEN FORMATTED, RETURN AN ERROR CODE         14700002
*        THIS CONDITION ONLY APPLIES TO PERMANENT CPIDS, WHERE THE      14702002
*        ANCHOR BLOCK EXISTS IN AN ESTABLISHED TABLE OF CPABS.          14704002
*********************************************************************** 14710002
FRCERR12 EQU   *                                                        14750002
         LA    R15,12                                                   14800002
         BR    R14            RETURN                                    14850002
         SPACE                                                          14900002
*********************************************************************** 14910002
*        AN INVALID CPID HAS BEEN GIVEN, NO POOL HAVING THIS CPID       14950002
*        HAS EVER BEEN DEFINED TO THE SYSTEM. ---- ERROR RETURN.        14952002
*********************************************************************** 14960002
FRCERR16 EQU   *                                                        15000002
         LA    R15,16                                                   15050002
         BR    R14            RETURN                                    15100002
         EJECT                                                          15150002
*********************************************************************** 15160002
*        CONSTANTS REQUIRED BY THE FREE CELL SERVICE ROUTINE            15200002
*********************************************************************** 15210002
F255     DC    F'255'         USED FOR MODULO DIVIDE BY 256             15250002
F1       DC    F'1'           USED TO INCREMENT USE COUNT               15250402
ZEROUSE  DC    X'FFFF0000'    MASK TO ZERO EXTENT USE COUNT    @ZA18115 15251403
*        THESE NEXT TWO FIELDS ARE USED TO TURN THE DELETE LOCK         15253402
*        OFF AND ON (RESPECTIVELY), WHEN THE FLAG WORD IS IN A REGISTER 15256402
DLFLGOFF DC    X'FF',AL1(X'FF'-DELETELK),2X'FF'   TURN IT OFF           15257403
DELETEON DC    AL2(DELETELK,0)   TURN IT ON                             15270002
FCPABLEN DC    A(CPABLEN)     LENGTH OF THE ANCHOR BLOCK                15280002
ADDRPART EQU   7              MASK USED TO OBTAIN ADDRESS VIA 'ICM'     15290002
UNLOCK   EQU   X'F7'          MASK FOR RESETTING DELETE LOCK   @ZA18115 15295003
CVT      DSECT                                                          15300002
         CVT                                                            15350002
         EJECT                                                          15360002
         IHAGDA   DSECT=YES                                             15400002
         EJECT                                                          15410002
         IHACPAB  DSECT=YES                                             15450002
         END                                                            15550002
./  ADD  SSI=43500690,NAME=IEAVGCAS
         TITLE '***IEAVGCAS-AOS/2,REL 2    CREATE/FREE ADDRESS SPACE RO*00001000
               OUTINE***'                                               00002000
IEAVGCAS CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(19)                                             0001 00008000
         DC    C'IEAVGCASR0300074351'                              0001 00009000
IEAQSPET DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00220-IEAQSPET)                                   00013000
         ENTRY IEAQSPET                                                 00014000
IEAVGFAS DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP00306-IEAVGFAS)                                   00018000
         ENTRY IEAVGFAS                                                 00019000
         DROP  @15                                                      00020000
@PROLOG  ST    @14,12(,@13)                                        0001 00021000
         STM   @00,@12,20(@13)                                     0001 00022000
         BALR  @09,0                                               0001 00023000
@PSTART  DS    0H                                                  0001 00024000
         USING @PSTART,@09                                         0001 00025000
         AH    @15,4(,@15)                                         0001 00026000
         BR    @15                                                 0001 00027000
@EP00001 DS    0H                                                  0002 00028000
        L     @00,@SIZDATD                SIZE OF @DATD DSECT           00029000
        L    @04,PSATOLD                  TCB ADDRESS                   00030000
        L    @07,PSAAOLD                  ASCB ADDRESS                  00031000
        GETMAIN R,LV=(0)                  SPACE FOR @DATD DSECT         00032000
        LR    @05,@01                     DATAREG                       00033000
        L     @01,24(@13)                 RESTORE PARAMETER             00034000
        USING @DATD,@05                   DATAREG                       00035000
        ST    @13,SAVESAVE                SAVE SAVEAREA PTR             00036000
OBTL1   SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LDA,IEAVGCAS(RE**00037000
               LL1))                                                    00038000
        SETFRR A,FRRAD=CASFRR,PARMAD=FRRPARM,WRKREGS=(REG3,REG2)        00039000
*   SAVESV2=SAVESAVE;               /* SAVE FOR FRR USE              */ 00040000
         L     @14,FRRPARM                                         0104 00041000
         L     @12,SAVESAVE                                        0104 00042000
         ST    @12,SAVESV2(,@14)                                   0104 00043000
*   ASCBSAVE=ASCBREG;               /* SAVE FOR FRR USE              */ 00044000
         ST    ASCBREG,ASCBSAVE(,@14)                              0105 00045000
*CASRETRY:                                                         0106 00046000
*   ASCBPTR=PSAAOLD;                /* CURRENT ASCB                  */ 00047000
CASRETRY L     @14,PSAAOLD                                         0106 00048000
         ST    @14,ASCBPTR                                         0106 00049000
*   LDAPTR=ASCBLDA;                 /* LDA BASE                      */ 00050000
         L     LDAPTR,ASCBLDA(,@14)                                0107 00051000
*   GDAPTR=CVTGDA;                  /* GDA BASE                      */ 00052000
         L     @12,CVTPTR                                          0108 00053000
         L     GDAPTR,CVTGDA(,@12)                                 0108 00054000
*   IF ASCBASID¬=MSASID THEN        /* ASID MUST = 1 OR              */ 00055000
         CLC   ASCBASID(2,@14),@CH00068                            0109 00056000
         BNE   @RT00109                                            0109 00057000
*     GOTO NOTAUTH;                 /* NOT AUTHORIZED                */ 00058000
*   ASCBPTR=ASCBREG;                /* BASE FOR NEW ASCB             */ 00059000
         ST    ASCBREG,ASCBPTR                                     0111 00060000
*   GENERATE REFS(CVTCRMN);                                        0112 00061000
        GETMAIN  RC,BRANCH=YES,LV=4096,SP=0,BNDRY=PAGE    GET 4K IN     00062000
*                                           M.S. MEMORY                 00063000
*   PAGEADD=REG1;                   /* SAVE ADDRESS OF PAGE          */ 00064000
         L     @14,FRRPARM                                         0113 00065000
         ST    REG1,PAGEADD(,@14)                                  0113 00066000
*   IF RRETURN¬=ZERO THEN           /* IF BAD RETURN FROM            */ 00067000
         LTR   RRETURN,RRETURN                                     0114 00068000
         BNZ   @RT00114                                            0114 00069000
*     GOTO NOTAUTH;                 /* GO SET R.C. = 4               */ 00070000
*   RESPECIFY                                                      0116 00071000
*    (REG0,                                                        0116 00072000
*     REG13) RESTRICTED;                                           0116 00073000
*   PARAM=ASCBPTR;                  /* SET UP PARMS FOR RSM          */ 00074000
         L     @14,ASCBPTR                                         0117 00075000
         ST    @14,PARAM                                           0117 00076000
*   WORD1=FORMAT;                   /* # OF PAGES TO FORMAT          */ 00077000
         MVI   WORD1,X'01'                                         0118 00078000
*   REG0=PARAM;                                                    0119 00079000
         L     REG0,PARAM                                          0119 00080000
*   REG1=PAGEADD;                   /* ADDRESS OF PAGE               */ 00081000
         L     @14,FRRPARM                                         0120 00082000
         L     @14,PAGEADD(,@14)                                   0120 00083000
         LR    REG1,@14                                            0120 00084000
*   REG13=ADDR(CFAPWKAR);                                          0121 00085000
         LA    REG13,CFAPWKAR(,LDAPTR)                             0121 00086000
*   CALL IEAVITAS;                  /* GO TO RSM TO FORMAT THEIR   0122 00087000
*                                      GLOBAL AND LOCAL ADDRESS SPACE   00088000
*                                      CONTROL BLOCKS. (IEAVITAS USES   00089000
*                                      TWO 72-BYTE AREAS AND A THIRD    00090000
*                                      AREA EQUAL TO THE LENGTH OF AN   00091000
*                                      ACA CONTROL BLOCK IN CFAPWKAR)*/ 00092000
         L     @15,@CV00155                                        0122 00093000
         BALR  @14,@15                                             0122 00094000
*   RSMBIT='1'B;                    /* FRR FOOTPRINT                 */ 00095000
         L     @14,FRRPARM                                         0123 00096000
         OI    RSMBIT(@14),B'10000000'                             0123 00097000
*   RESPECIFY                                                      0124 00098000
*    (REG0,                                                        0124 00099000
*     REG13) UNRESTRICTED;                                         0124 00100000
*   IF RRETURN¬=ZERO THEN           /* IF RSM ERROR FOUND,           */ 00101000
         SLR   @12,@12                                             0125 00102000
         CR    RRETURN,@12                                         0125 00103000
         BNE   @RT00125                                            0125 00104000
*     GOTO RSMERR;                  /* DO NOT CONTINUE               */ 00105000
*   NUMBYTES=PAGEADD+PAGE-RSMADDR;  /* # OF BYTES USED BY RSM        */ 00106000
         L     @11,@CF00064                                        0127 00107000
         AL    @11,PAGEADD(,@14)                                   0127 00108000
         LR    NUMBYTES,@11                                        0127 00109000
         SLR   NUMBYTES,RSMADDR                                    0127 00110000
*   PAEND=PASTRT+PASIZE;            /* END OF PRIVATE AREA           */ 00111000
         L     @14,PASTRT(,GDAPTR)                                 0128 00112000
         L     @10,PASIZE(,GDAPTR)                                 0128 00113000
         LR    @00,@14                                             0128 00114000
         ALR   @00,@10                                             0128 00115000
         ST    @00,PAEND                                           0128 00116000
*   TOPLDAMS=PAGEADD+PAGE-NUMBYTES; /* TOP @ OF LDA IN M.S. ADDRESSES*/ 00117000
         SLR   @11,NUMBYTES                                        0129 00118000
         LR    TOPLDAMS,@11                                        0129 00119000
*   TOPLDANM=PAEND-NUMBYTES;        /* TOP LDA IN NEW ADDR.SPACE     */ 00120000
         SLR   @00,NUMBYTES                                        0130 00121000
         LR    TOPLDANM,@00                                        0130 00122000
*   LDAPTR=TOPLDAMS-LENGTH(LDA);    /* LDA BASE FOR M.S. @'S         */ 00123000
         LA    @11,1496                                            0131 00124000
         LR    LDAPTR,TOPLDAMS                                     0131 00125000
         SLR   LDAPTR,@11                                          0131 00126000
*   LDAPTRNM=TOPLDANM-LENGTH(LDA);  /* LDA PTR IN NEW A.S.           */ 00127000
         LCR   @11,@11                                             0132 00128000
         ALR   @11,TOPLDANM                                        0132 00129000
         ST    @11,LDAPTRNM                                        0132 00130000
*/*                                                                  */ 00131000
*/*  *****************************************************************/ 00132000
*/*     CONSTRUCT  LDA IN THE MASTER SCHEDULER PAGE                  */ 00133000
*/*  *****************************************************************/ 00134000
*                                                                  0133 00135000
*   LVSMFLAG=ZERO;                  /* LDA FLAGS INIT TO 0           */ 00136000
         SLR   @00,@00                                             0133 00137000
         ST    @00,LVSMFLAG(,LDAPTR)                               0133 00138000
*   PASCBSV=ASCBPTR;                /* ASCB = NEW ASCB               */ 00139000
         L     @14,ASCBPTR                                         0134 00140000
         ST    @14,PASCBSV(,LDAPTR)                                0134 00141000
*   VVREGSZ=ZERO;                   /* INIT. REGION SIZE TO 0        */ 00142000
         ST    @00,VVREGSZ(,LDAPTR)                                0135 00143000
*   LDA2=LDAPTR-LENGTH(BELOWLDA);   /* BEGINNING @ OF AREA TO BE   0136 00144000
*                                      FORMATTED IN M.S. PAGE        */ 00145000
         LA    @14,352                                             0136 00146000
         LR    LDA2,LDAPTR                                         0136 00147000
         SLR   LDA2,@14                                            0136 00148000
*   LDA2NM=LDAPTRNM-LENGTH(BELOWLDA);/* @ OF AREA IN NEW MEMORY      */ 00149000
         SLR   @11,@14                                             0137 00150000
         ST    @11,LDA2NM                                          0137 00151000
*   XVALUE=LDA2NM-LDA2;             /* DIFFERENCE BETWEEN @'S IN NEW    00152000
*                                      MEMORY AND M.S.             0138 00153000
*                                      PAGE--INCREMENT VALUE         */ 00154000
         LR    @14,@11                                             0138 00155000
         SLR   @14,LDA2                                            0138 00156000
         ST    @14,XVALUE                                          0138 00157000
*   ASDPQE=ADDR(ASPQE)+XVALUE;      /* PTR TO A.S. PQE               */ 00158000
         LA    @11,ASPQE(,LDA2)                                    0139 00159000
         LR    @10,@11                                             0139 00160000
         ALR   @10,@14                                             0139 00161000
         ST    @10,ASDPQE(,LDAPTR)                                 0139 00162000
*   LSQAPTR=ADDR(LSQASPQE)+XVALUE;  /* PTR TO 1ST LSQA SPQE          */ 00163000
         LA    @00,LSQASPQE(,LDA2)                                 0140 00164000
         ALR   @00,@14                                             0140 00165000
         ST    @00,LSQAPTR(,LDAPTR)                                0140 00166000
*   LDASRPQE=ADDR(SRPQE)+XVALUE;    /* PTR TO SYSTEM REG. PQE        */ 00167000
         LR    @00,LDA2                                            0141 00168000
         ALR   @00,@14                                             0141 00169000
         ST    @00,LDASRPQE(,LDAPTR)                               0141 00170000
*   LDARSVPT=ADDR(PGTABLE)+XVALUE;  /* @ SPACE RESVD FOR PG TAB      */ 00171000
         ST    @00,@TF00001                                        0142 00172000
         LA    @00,PGTABLE(,LDA2)                                  0142 00173000
         ALR   @00,@14                                             0142 00174000
         ST    @00,LDARSVPT(,LDAPTR)                               0142 00175000
*/*                                                                  */ 00176000
*/*  *****************************************************************/ 00177000
*/*        INITIALIZE SYSTEM REGION CONTROL BLOCKS                   */ 00178000
*/*  *****************************************************************/ 00179000
*                                                                  0143 00180000
*   PQESEPTR=ADDR(SRPQE);           /* PQE BASE                      */ 00181000
         LR    PQESEPTR,LDA2                                       0143 00182000
*   FBQESPTR=ADDR(SRFBQE);          /* FBQE BASE                     */ 00183000
         LA    @00,SRFBQE(,LDA2)                                   0144 00184000
         LR    FBQESPTR,@00                                        0144 00185000
*   PQEFFBQE=ADDR(SRFBQE)+XVALUE;   /* @ 1ST S.R. FBQE IN TERMS OF 0145 00186000
*                                      NEW MEMORY                    */ 00187000
         ALR   @00,@14                                             0145 00188000
         ST    @00,PQEFFBQE(,PQESEPTR)                             0145 00189000
*   PQEBFBQE=PQEFFBQE;              /* @ LAST S.R. FBQE              */ 00190000
         ST    @00,PQEBFBQE(,PQESEPTR)                             0146 00191000
*   PQEFPQE=ZERO;                   /* NO OTHER PQE'S                */ 00192000
         SLR   @00,@00                                             0147 00193000
         ST    @00,PQEFPQE(,PQESEPTR)                              0147 00194000
*   PQEBPQE=ZERO;                                                  0148 00195000
         ST    @00,PQEBPQE(,PQESEPTR)                              0148 00196000
*   PQESIZE=SRSIZE;                 /* SIZE OF SYSTEM REGION         */ 00197000
         L     @14,SRSIZE                                          0149 00198000
         ST    @14,PQESIZE(,PQESEPTR)                              0149 00199000
*   PQEREGN=PASTRT;                 /* SYS. REG. STARTS AT BOTTOM OF    00200000
*                                      PRIVATE AREA                  */ 00201000
         L     @14,PASTRT(,GDAPTR)                                 0150 00202000
         ST    @14,PQEREGN(,PQESEPTR)                              0150 00203000
*   VMMFLGS=ONEZERO;                /* REGION IS V=V                 */ 00204000
         MVI   VMMFLGS(PQESEPTR),X'00'                             0151 00205000
*   FWDPTR=ADDR(SRPQE)+XVALUE;      /* ONLY FBQE ON QUEUE            */ 00206000
         L     @14,@TF00001                                        0152 00207000
         ST    @14,FWDPTR(,FBQESPTR)                               0152 00208000
*   BCKPTR=FWDPTR;                  /* ONLY FBQE ON QUEUE            */ 00209000
         ST    @14,BCKPTR(,FBQESPTR)                               0153 00210000
*   SIZE=SRSIZE;                    /* SIZE OF FREE AREA             */ 00211000
         L     @14,SRSIZE                                          0154 00212000
         ST    @14,SIZE(,FBQESPTR)                                 0154 00213000
*   FBQAREA=PASTRT;                 /* START OF FREE AREA            */ 00214000
         L     @14,PASTRT(,GDAPTR)                                 0155 00215000
         ST    @14,FBQAREA(,FBQESPTR)                              0155 00216000
*/*  *****************************************************************/ 00217000
*/*      INITIALIZE ADDRESS SPACE CONTROL BLOCKS                     */ 00218000
*/*  *****************************************************************/ 00219000
*                                                                  0156 00220000
*   FBQESPTR=ADDR(ASFBQE);          /* FBQE BASE                     */ 00221000
         LA    @14,ASFBQE(,LDA2)                                   0156 00222000
         LR    FBQESPTR,@14                                        0156 00223000
*   FWDPTR=ADDR(ASPQE)+XVALUE;      /* ONLY FBQE ON QUEUE            */ 00224000
         ST    @10,FWDPTR(,FBQESPTR)                               0157 00225000
*   BCKPTR=FWDPTR;                                                 0158 00226000
         ST    @10,BCKPTR(,FBQESPTR)                               0158 00227000
*   SIZE=PASIZE-SRSIZE-LSQALLOC*PAGE;/* FREE AREA LEFT IN A.S.       */ 00228000
         L     @10,@CF00099                                        0159 00229000
         L     @00,SRSIZE                                          0159 00230000
         ST    @14,@TF00001                                        0159 00231000
         L     @14,PASIZE(,GDAPTR)                                 0159 00232000
         SLR   @14,@00                                             0159 00233000
         LR    @00,@14                                             0159 00234000
         SLR   @00,@10                                             0159 00235000
         ST    @00,SIZE(,FBQESPTR)                                 0159 00236000
*   FBQAREA=PASTRT+SRSIZE;          /* START OF FREE SPACE           */ 00237000
         L     @00,SRSIZE                                          0160 00238000
         L     @10,PASTRT(,GDAPTR)                                 0160 00239000
         ALR   @10,@00                                             0160 00240000
         ST    @10,FBQAREA(,FBQESPTR)                              0160 00241000
*   CURRGNTP=FBQAREA;               /* INITIALIZE VALUE FOR GETMAIN     00242000
*                                                            @YM00841*/ 00243000
         ST    @10,CURRGNTP(,LDAPTR)                               0161 00244000
*   PQESEPTR=ADDR(ASPQE);           /* PQE BASE                      */ 00245000
         LR    PQESEPTR,@11                                        0162 00246000
*   PQEFFBQE=ADDR(ASFBQE)+XVALUE;   /* 1ST A.S.FBQE                  */ 00247000
         L     @12,XVALUE                                          0163 00248000
         L     @00,@TF00001                                        0163 00249000
         ALR   @00,@12                                             0163 00250000
         ST    @00,PQEFFBQE(,PQESEPTR)                             0163 00251000
*   PQEBFBQE=PQEFFBQE;              /* LAST A.S.FBQE                 */ 00252000
         ST    @00,PQEBFBQE(,PQESEPTR)                             0164 00253000
*   PQEFPQE=ZERO;                   /* ONLY ONE PQE                  */ 00254000
         SLR   @11,@11                                             0165 00255000
         ST    @11,PQEFPQE(,PQESEPTR)                              0165 00256000
*   PQEBPQE=ZERO;                                                  0166 00257000
         ST    @11,PQEBPQE(,PQESEPTR)                              0166 00258000
*   PQESIZE=PASIZE-SRSIZE;          /* SIZE OF A.S. PQE              */ 00259000
         ST    @14,PQESIZE(,PQESEPTR)                              0167 00260000
*   PQEREGN=PASTRT+SRSIZE;          /* START @ OF A.S. PQE           */ 00261000
         ST    @10,PQEREGN(,PQESEPTR)                              0168 00262000
*   VMMFLGS=ONEZERO;                /* REGION IS V=V                 */ 00263000
         MVI   VMMFLGS(PQESEPTR),X'00'                             0169 00264000
*/*                                                                  */ 00265000
*/*  *****************************************************************/ 00266000
*/*        INITIALIZE LSQA CONTROL BLOCKS                            */ 00267000
*/*  *****************************************************************/ 00268000
*                                                                  0170 00269000
*   SPQESPTR=ADDR(LSQASPQE);        /* SPQE BASE                     */ 00270000
         LA    @14,LSQASPQE(,LDA2)                                 0170 00271000
         ST    @14,SPQESPTR                                        0170 00272000
*   SPQEPTR=ZERO;                   /* ONLY SPQE                     */ 00273000
         ST    @11,SPQEPTR(,@14)                                   0171 00274000
*   LASTSPQE='1'B;                                                 0172 00275000
         OI    LASTSPQE(@14),B'01000000'                           0172 00276000
*   SPDQEPTR=ADDR(LSQADQE)+XVALUE;  /* FIRST DQE                     */ 00277000
         LA    @10,LSQADQE(,LDA2)                                  0173 00278000
         LR    @00,@10                                             0173 00279000
         ALR   @00,@12                                             0173 00280000
         ST    @00,SPDQEPTR(,@14)                                  0173 00281000
*   SPQEID=LSQASPID;                /* SP = 255                      */ 00282000
         MVI   SPQEID(@14),X'FF'                                   0174 00283000
*   SPQEKEY=ONEZERO;                /* KEY = 0                       */ 00284000
         MVI   SPQEKEY(@14),X'00'                                  0175 00285000
*   DQESEPTR=ADDR(LSQADQE);         /* DQE BASE                      */ 00286000
         LR    DQESEPTR,@10                                        0176 00287000
*   DQFQEPTR=PAGEADD+LSQAFQEL+XVALUE;/* FIRST FQE            @Z30ENYG*/ 00288000
         LA    @14,8                                               0177 00289000
         L     @10,FRRPARM                                         0177 00290000
         AL    @14,PAGEADD(,@10)                                   0177 00291000
         ALR   @12,@14                                             0177 00292000
         ST    @12,DQFQEPTR(,DQESEPTR)                             0177 00293000
*   DQEPTR=ZERO;                    /* ONLY DQE                      */ 00294000
         ST    @11,DQEPTR(,DQESEPTR)                               0178 00295000
*   DQEBLKAD=PAEND-LSQALLOC*PAGE;   /* LOW ADDRESS OF THIS AREA      */ 00296000
         L     @12,@CF00099                                        0179 00297000
         L     @00,PAEND                                           0179 00298000
         SLR   @00,@12                                             0179 00299000
         ST    @00,DQEBLKAD(,DQESEPTR)                             0179 00300000
*   DQELNTH=LSQALLOC*PAGE;          /* AMOUNT OF SPACE IN     SUBPOOL*/ 00301000
         ST    @12,DQELNTH(,DQESEPTR)                              0180 00302000
*   FQESEPTR=PAGEADD+LSQAFQEL;      /* FQE BASE              @Z30ENYG*/ 00303000
         LR    FQESEPTR,@14                                        0181 00304000
*   FQEPTR=ZER0;                    /* ONLY FQE              @Z30ENYG*/ 00305000
         L     @14,ZER0                                            0182 00306000
         ST    @14,FQEPTR(,FQESEPTR)                               0182 00307000
*   FQELNTH=(LSQALLOC-ONE)*PAGE+LENGTH(CELL);/* LSQA FREE SPACE    0183 00308000
*                                                            @Z30ENYG*/ 00309000
         LA    @14,16                                              0183 00310000
         L     @12,ONE                                             0183 00311000
         LA    @00,4                                               0183 00312000
         SLR   @00,@12                                             0183 00313000
         SLA   @00,12                                              0183 00314000
         ALR   @00,@14                                             0183 00315000
         ST    @00,FQELNTH(,FQESEPTR)                              0183 00316000
*   ASCBASXB=LDA2NM-LENGTH(ASXB);   /* PTR TO ASXB                   */ 00317000
         L     @02,ASCBPTR                                         0184 00318000
         L     @11,LDA2NM                                          0184 00319000
         LA    @10,232                                             0184 00320000
         SLR   @11,@10                                             0184 00321000
         ST    @11,ASCBASXB(,@02)                                  0184 00322000
*   ASCBLDA=LDAPTRNM;               /* PTR TO NEW LDA                */ 00323000
*                                                                  0185 00324000
         L     @00,LDAPTRNM                                        0185 00325000
         ST    @00,ASCBLDA(,@02)                                   0185 00326000
*   /*****************************************************************/ 00327000
*   /*                                                               */ 00328000
*   /* FORMAT REMAINING FREE SPACE IN PAGE INTO A CELL POOL FOR VSM  */ 00329000
*   /* CONTROL BLOCKS                                                */ 00330000
*   /*                                                               */ 00331000
*   /*****************************************************************/ 00332000
*                                                                  0186 00333000
*   CELLPTR=LDA2-LENGTH(ASXB);      /* ADDR FREE AREA IN PAGE      0186 00334000
*                                                            @Z30ENYG*/ 00335000
         LCR   @10,@10                                             0186 00336000
         ALR   @10,LDA2                                            0186 00337000
         ST    @10,CELLPTR                                         0186 00338000
*   RNDCPADR=RNDCPADR&TRUNC;        /* RND TO CELLSIZE MULTIPLE    0187 00339000
*                                                            @Z30ENYG*/ 00340000
         SLR   @00,@00                                             0187 00341000
         IC    @00,RNDCPADR                                        0187 00342000
         SLR   @11,@11                                             0187 00343000
         IC    @11,TRUNC                                           0187 00344000
         NR    @00,@11                                             0187 00345000
         STC   @00,RNDCPADR                                        0187 00346000
*   CELLPTR=CELLPTR-LENGTH(CELL);   /* ADDRESS OF FIRST CELL @Z30ENYG*/ 00347000
         LCR   @14,@14                                             0188 00348000
         AL    @14,CELLPTR                                         0188 00349000
         ST    @14,CELLPTR                                         0188 00350000
*   LCLCELL=CELLPTR+XVALUE;         /* INIT FIELD IN LDA TO POINT TO    00351000
*                                      1ST CELL              @Z30ENYG*/ 00352000
         AL    @14,XVALUE                                          0189 00353000
         ST    @14,LCLCELL(,LDAPTR)                                0189 00354000
*   LCLCELCT=ONE;                   /* NO. OF CELLS CREATED  @Z30ENYG*/ 00355000
         ST    @12,LCLCELCT(,LDAPTR)                               0190 00356000
*   DO WHILE(PAGEADD+LENGTH(CELL)<CELLPTR);/* FORMAT FREE AREA INTO     00357000
*                                      CELLS                 @Z30ENYG*/ 00358000
         B     @DE00191                                            0191 00359000
@DL00191 DS    0H                                                  0192 00360000
*     NEXTCELL=CELLPTR-LENGTH(CELL);/* FWD PTR TO NEXT CELL  @Z30ENYG*/ 00361000
         L     @14,CELLPTR                                         0192 00362000
         LR    NEXTCELL,@14                                        0192 00363000
         SL    NEXTCELL,@CF00038                                   0192 00364000
*     NXTCELNM=NEXTCELL+XVALUE;     /* NEXT CELL IN NEW A.S. @Z30ENYG*/ 00365000
         LR    @12,NEXTCELL                                        0193 00366000
         AL    @12,XVALUE                                          0193 00367000
         ST    @12,NXTCELNM(,@14)                                  0193 00368000
*     LCLCELCT=LCLCELCT+ONE;        /* CELL ADDED TO POOL    @Z30ENYG*/ 00369000
         L     @14,LCLCELCT(,LDAPTR)                               0194 00370000
         AL    @14,ONE                                             0194 00371000
         ST    @14,LCLCELCT(,LDAPTR)                               0194 00372000
*     CELLPTR=NEXTCELL;             /* NEXT CELL TO BE CREATED     0195 00373000
*                                                            @Z30ENYG*/ 00374000
         ST    NEXTCELL,CELLPTR                                    0195 00375000
*   END;                            /*                       @Z30ENYG*/ 00376000
@DE00191 L     @14,CELLPTR                                         0196 00377000
         L     @12,FRRPARM                                         0196 00378000
         L     @12,PAGEADD(,@12)                                   0196 00379000
         LA    @00,16                                              0196 00380000
         ALR   @00,@12                                             0196 00381000
         CR    @00,@14                                             0196 00382000
         BL    @DL00191                                            0196 00383000
*   NXTCELNM=ZERO;                  /* LAST CELL IN POOL     @Z30ENYG*/ 00384000
         SLR   @08,@08                                             0197 00385000
         ST    @08,NXTCELNM(,@14)                                  0197 00386000
*/*   FREE THE VIRTUAL PAGE IN MASTER SCHEDULER MEMORY               */ 00387000
*                                                                  0198 00388000
*   DO;                             /* FREEMAIN(RU)                0198 00389000
*                                      LV(PAGE)A(PAGEADD->AREA)    0198 00390000
*                                      SP(ZERO) BRANCH               */ 00391000
*     RESPECIFY                                                    0199 00392000
*      (GPR01F,                                                    0199 00393000
*       GPR03F,                                                    0199 00394000
*       GPR00F) RESTRICTED;                                        0199 00395000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 00396000
         LR    GPR01F,@08                                          0200 00397000
*     GPR03F=3;                     /* SET TYPE                      */ 00398000
         LA    GPR03F,3                                            0201 00399000
*     GPR00F=PAGE;                  /* LENGTH REQUESTED              */ 00400000
         L     GPR00F,@CF00064                                     0202 00401000
*     GPR01F=ADDR(PAGEADD->AREA);   /* SET REGISTER ONE              */ 00402000
         LR    GPR01F,@12                                          0203 00403000
*     GPR03F=GPR03F+((ZERO)*256);   /* SUBPOOL VALUE                 */ 00404000
*     CALL CVTCRMN;                 /* BRANCH ENTRY POINT            */ 00405000
         L     @12,CVTPTR                                          0205 00406000
         L     @15,CVTCRMN(,@12)                                   0205 00407000
         BALR  @14,@15                                             0205 00408000
*     RESPECIFY                                                    0206 00409000
*      (GPR01F,                                                    0206 00410000
*       GPR03F,                                                    0206 00411000
*       GPR00F) UNRESTRICTED;                                      0206 00412000
*   END;                            /* FREEMAIN(RU)                0207 00413000
*                                      LV(PAGE)A(PAGEADD->AREA)    0207 00414000
*                                      SP(ZERO) BRANCH               */ 00415000
*   RRETURN=ZERO;                   /* SUCCESSFUL RETURN             */ 00416000
         SLR   RRETURN,RRETURN                                     0208 00417000
*   GOTO RET;                       /* RETURN                        */ 00418000
         B     RET                                                 0209 00419000
*RSMERR:                                                           0210 00420000
*   FMADDR=PAGEADD;                 /* PARM FOR FREEMAIN             */ 00421000
RSMERR   L     @14,FRRPARM                                         0210 00422000
         L     FMADDR,PAGEADD(,@14)                                0210 00423000
*   GENERATE REFS(CVTCRMN);                                        0211 00424000
        FREEMAIN RC,BRANCH=YES,LV=4096,SP=0,A=(FMADDR) FREE THE         00425000
*                                          PAGE                         00426000
*NOTAUTH:                                                          0212 00427000
*   RRETURN=NOSUCCES;               /* INDICATE UNSUCCESSFUL       0212 00428000
*                                      PROCESSING                    */ 00429000
NOTAUTH  LA    RRETURN,4                                           0212 00430000
*RET:                                                              0213 00431000
*   GENERATE REFS(PSALITA);                                        0213 00432000
RET      DS    0H                                                  0213 00433000
*                                         /* PREPARE TO RETURN      */  00434000
    SETFRR  D,WRKREGS=(REG2,REG3)        DELETE FRR FROM STACK          00435000
RELL1   SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LDA,IEAVGCAS(OBTL1))        00436000
*   REG13=SAVESAVE;                 /* RESTORE SAVEAREA PTR          */ 00437000
         L     REG13,SAVESAVE                                      0214 00438000
*   REG2=RRETURN;                   /* SAVE R.C.ACROSS FREEMAIN      */ 00439000
         LR    REG2,RRETURN                                        0215 00440000
*   GENERATE REFS(CVTCRMN,CVTMAP);                                 0216 00441000
        L    @00,@SIZDATD                                               00442000
        FREEMAIN  RC,LV=(0),A=(5)                                       00443000
*   RRETURN=REG2;                   /* RESTORE R.C.                  */ 00444000
         LR    RRETURN,REG2                                        0217 00445000
*   RETURN;                         /* RETURN                        */ 00446000
@EL00001 DS    0H                                                  0218 00447000
@EF00001 DS    0H                                                  0218 00448000
@ER00001 L     @14,12(,@13)                                        0218 00449000
         LM    @00,@12,20(@13)                                     0218 00450000
         BR    @14                                                 0218 00451000
*   RFY                                                            0219 00452000
*     GDAPTR UNRESTRICTED;                                         0219 00453000
*                                                                  0220 00454000
*/*                                                                  */ 00455000
*/*  *****************************************************************/ 00456000
*/*       ENTRY POINT FOR TASK TERMINATION INTERFACE---PERFORMS      */ 00457000
*/*         STORAGE CLEAN-UP OPERATIONS AT TASK TERMINATION TIME     */ 00458000
*/*  *****************************************************************/ 00459000
*                                                                  0220 00460000
*IEAQSPET:                                                         0220 00461000
*   ENTRY;                                                         0220 00462000
*                                                                  0220 00463000
@EP00220 DS    0H                                                  0221 00464000
*   /*****************************************************************/ 00465000
*   /*                                                               */ 00466000
*   /* DECLARES FOR TASK TERMINATION SUBROUTINE                      */ 00467000
*   /*                                                               */ 00468000
*   /*****************************************************************/ 00469000
*                                                                  0221 00470000
*   DCL                                                            0221 00471000
*     RSAVE REG(13) RESTRICTED;     /* SAVE AREA PTR                 */ 00472000
*   DCL                                                            0222 00473000
*     RID REG(6);                   /* SUBPOOL ID                    */ 00474000
*   DCL                                                            0223 00475000
*     TCBPTR PTR(31) REG(4);        /* TCB PTR                       */ 00476000
*   DCL                                                            0224 00477000
*     SPQELEN FIXED(31) CONSTANT(32);/* LENGTH OF AN SPQE            */ 00478000
*   DCL                                                            0225 00479000
*     TWO29 PTR(8) CONSTANT(229);                                  0225 00480000
*   DCL                                                            0226 00481000
*     TWO30 PTR(8) CONSTANT(230);                                  0226 00482000
*   DCL                                                            0227 00483000
*     1 SAADDR,                     /* SAVE AREA ADDRESS             */ 00484000
*      2 SAADDR1 PTR(8),                                           0227 00485000
*      2 SAADDR2 PTR(24);                                          0227 00486000
*   DCL                                                            0228 00487000
*     XFF FIXED(8) INIT(255);       /* SUBPOOL FOR DYN.       STORAGE*/ 00488000
*   GENERATE REFS(SCVTRMBR,SCVTSECT);                              0229 00489000
        L     @00,@SIZDATD                SIZE OF @DATD DSECT           00490000
        ICM   @00,8,XFF                                        YM00831  00491000
        GETMAIN R,LV=(0),BRANCH=YES       GET SPACE FOR DATD   YM00831  00492000
*                                          DSECT OUT OF SP 255          00493000
*                                          SO TASK TERM. FREE OF        00494000
*                                          SP 0 DOES NOT FREE           00495000
*                                          DYNAMIC STORAGE              00496000
        LR    @05,@01                     DATAREG                       00497000
        USING @DATD,@05                   DATAREG                       00498000
        SETFRR  A,FRRAD=TTFRR,PARMAD=FRRPARM,WRKREGS=(REG3,REG2)        00499000
*TTRETRY:                                                          0230 00500000
*   RETCOD=ZERO;                    /* INITIALIZE R.C. TO 0          */ 00501000
TTRETRY  SLR   @14,@14                                             0230 00502000
         ST    @14,RETCOD                                          0230 00503000
*   IF TCBFSAB=ZEROS THEN           /* SAVE AREA PRESENT?            */ 00504000
         L     @12,TCBFSAB-1(,TCBPTR)                              0231 00505000
         LA    @12,0(,@12)                                         0231 00506000
         LTR   @12,@12                                             0231 00507000
         BZ    @RT00231                                            0231 00508000
*     GOTO ETSPQE;                  /* IF NOT, BRANCH                */ 00509000
*   IF TCBFETXR='1'B THEN           /* BRANCH IF ETXR SPECIFIED      */ 00510000
         TM    TCBFETXR(TCBPTR),B'00000010'                        0233 00511000
         BO    @RT00233                                            0233 00512000
*     GOTO ETSPQE;                  /* CHECK SPQE'S                  */ 00513000
*   IF TCBECB¬=ZERO THEN            /* BRANCH IF ECB POSTING         */ 00514000
         C     @14,TCBECB(,TCBPTR)                                 0235 00515000
         BNE   @RT00235                                            0235 00516000
*     GOTO ETSPQE;                  /* REQUESTED                     */ 00517000
*   SAADDR=TCBFSA;                  /* SAVE AREA ADDRESS             */ 00518000
         L     @12,TCBFSA(,TCBPTR)                                 0237 00519000
         ST    @12,SAADDR                                          0237 00520000
*   SAADDR1=ONEZERO;                /* ZERO HIGH ORDER BYTE          */ 00521000
         MVI   SAADDR1,X'00'                                       0238 00522000
*/*                                                                  */ 00523000
*/*  *****************************************************************/ 00524000
*/*       SAVE AREA NO LONGER NEEDED----FREE IT                      */ 00525000
*/*  *****************************************************************/ 00526000
*                                                                  0239 00527000
*   TCBFSAB=ZEROS;                  /* ZERO SAVE AREA PTR            */ 00528000
         STCM  @14,7,TCBFSAB(TCBPTR)                               0239 00529000
*   GENERATE REFS(CVTCRMN);                                        0240 00530000
        FREEMAIN  RC,LV=72,SP=250,A=SAADDR,BRANCH=YES                   00531000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM GETMAIN?      */ 00532000
         LTR   RRETURN,RRETURN                                     0241 00533000
         BZ    @RF00241                                            0241 00534000
*     RETCOD=FOUR;                                                 0242 00535000
*                                                                  0242 00536000
         MVC   RETCOD(4),@CF00076                                  0242 00537000
*/*                                                                  */ 00538000
*/*  *****************************************************************/ 00539000
*/*      FREE TASK-RELATED SPACE                                     */ 00540000
*/*  *****************************************************************/ 00541000
*                                                                  0243 00542000
*ETSPQE:                                                           0243 00543000
*   IF TCBMSSB=ZEROS THEN           /* IF THERE ARE NO SPQE'S,       */ 00544000
@RF00241 DS    0H                                                  0243 00545000
ETSPQE   L     @14,TCBMSSB-1(,TCBPTR)                              0243 00546000
         LA    @14,0(,@14)                                         0243 00547000
         LTR   @14,@14                                             0243 00548000
         BZ    @RT00243                                            0243 00549000
*     GOTO ETUKYSP;                 /* FREE AQE'S                    */ 00550000
*ETFSPQE:                                                          0245 00551000
*   SPQESPTR=ZERO;                  /* ZERO OUT FIELD                */ 00552000
ETFSPQE  SLR   @14,@14                                             0245 00553000
         ST    @14,SPQESPTR                                        0245 00554000
*   SPQPTR=TCBMSSB;                 /* GET PTR TO SPQE CHAIN FROM TCB*/ 00555000
         MVC   SPQPTR(3),TCBMSSB(TCBPTR)                           0246 00556000
*   IF SPSHARE='1'B THEN            /* IF SUBPOOL IS SHARED,         */ 00557000
         L     @12,SPQESPTR                                        0247 00558000
         TM    SPSHARE(@12),B'10000000'                            0247 00559000
         BO    @RT00247                                            0247 00560000
*     GOTO ETFSPQE1;                /* DON'T FREE IT                 */ 00561000
*   IF SPQEID='00'X THEN            /* IF THIS IS SP 0,              */ 00562000
         CLI   SPQEID(@12),X'00'                                   0249 00563000
         BNE   @RF00249                                            0249 00564000
*     TCBFSAB=ZEROS;                /* SET SAVE AREA PTR=0           */ 00565000
         STCM  @14,7,TCBFSAB(TCBPTR)                               0250 00566000
*   RID=SPQEID;                     /* SUBPOOL ID FOR FREEMAIN       */ 00567000
@RF00249 L     @14,SPQESPTR                                        0251 00568000
         SLR   RID,RID                                             0251 00569000
         IC    RID,SPQEID(,@14)                                    0251 00570000
*   GENERATE REFS(CVTCRMN);                                        0252 00571000
        FREEMAIN  RC,LV=0,SP=(RID),A=NULL,BRANCH=YES                    00572000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM GETMAIN?      */ 00573000
         LTR   RRETURN,RRETURN                                     0253 00574000
         BZ    @RF00253                                            0253 00575000
*     RETCOD=FOUR;                                                 0254 00576000
         MVC   RETCOD(4),@CF00076                                  0254 00577000
*ETFSPQE1:                                                         0255 00578000
*   TCBMSS=SPQEPTR;                 /* GET NEXT SPQE                 */ 00579000
@RF00253 DS    0H                                                  0255 00580000
ETFSPQE1 L     @14,SPQESPTR                                        0255 00581000
         L     @14,SPQEPTR(,@14)                                   0255 00582000
         ST    @14,TCBMSS(,TCBPTR)                                 0255 00583000
*   TCBFLDPT=ADDR(TCBMSS);          /* QUEUE BEING WORKED UPON       */ 00584000
         LA    TCBFLDPT,TCBMSS(,TCBPTR)                            0256 00585000
*   GOTO FREESPQE;                  /* GO FREE SPQE'S                */ 00586000
*                                                                  0257 00587000
         B     FREESPQE                                            0257 00588000
*   /*****************************************************************/ 00589000
*   /*                                                               */ 00590000
*   /* FREE SPACE IN SUBPOOLS 229 AND 230                            */ 00591000
*   /*                                                               */ 00592000
*   /*****************************************************************/ 00593000
*                                                                  0258 00594000
*ETUKYSP:                                                          0258 00595000
*   IF TCBUKYSP=ZERO THEN           /* IF NO SP 229/230, BRANCH      */ 00596000
ETUKYSP  L     @14,TCBUKYSP(,TCBPTR)                               0258 00597000
         LTR   @14,@14                                             0258 00598000
         BZ    @RT00258                                            0258 00599000
*     GOTO ETFAQE;                  /* BRANCH                @YM00410*/ 00600000
*ETFUKYSP:                                                         0260 00601000
*   SPQESPTR=TCBUKYSP;              /* UPDATE PTR TO SPQE    @YM00410*/ 00602000
ETFUKYSP L     @14,TCBUKYSP(,TCBPTR)                               0260 00603000
         ST    @14,SPQESPTR                                        0260 00604000
*   IF SPSHARE='1'B THEN            /* IF SHARED SP,                 */ 00605000
         TM    SPSHARE(@14),B'10000000'                            0261 00606000
         BO    @RT00261                                            0261 00607000
*     GOTO ETFUKY1;                 /* DON'T FREE SPACE      @YM00410*/ 00608000
*   RID=SPQEID;                     /* SP # IN A REG         @YM00410*/ 00609000
         SLR   RID,RID                                             0263 00610000
         IC    RID,SPQEID(,@14)                                    0263 00611000
*   SPKEY=SPQEKEY;                  /* KEY IN REGISTER       @YM00410*/ 00612000
         SLR   SPKEY,SPKEY                                         0264 00613000
         IC    SPKEY,SPQEKEY(,@14)                                 0264 00614000
*   GENERATE REFS(SPQEKEY,CVTCRMN);                                0265 00615000
*                                                  /* @YM00410*/        00616000
              FREEMAIN RC,LV=0,SP=(RID),KEY=(SPKEY),A=NULL,BRANCH=YES   00617000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM GETMAIN?      */ 00618000
         LTR   RRETURN,RRETURN                                     0266 00619000
         BZ    @RF00266                                            0266 00620000
*     RETCOD=FOUR;                  /*                       @YM00410*/ 00621000
         MVC   RETCOD(4),@CF00076                                  0267 00622000
*ETFUKY1:                                                          0268 00623000
*   TCBUKYSP=SPQEPTR;               /* PTR TO NEXT SPQE      @YM00410*/ 00624000
@RF00266 DS    0H                                                  0268 00625000
ETFUKY1  L     @14,SPQESPTR                                        0268 00626000
         L     @14,SPQEPTR(,@14)                                   0268 00627000
         ST    @14,TCBUKYSP(,TCBPTR)                               0268 00628000
*   TCBFLDPT=ADDR(TCBUKYSP);        /* QUEUE BEING WORKED UPON     0269 00629000
*                                                             @YM0410*/ 00630000
         LA    TCBFLDPT,TCBUKYSP(,TCBPTR)                          0269 00631000
*   GOTO FREESPQE;                  /* GO FREE SPQE'S /*     @YM00410*/ 00632000
         B     FREESPQE                                            0270 00633000
*/*                                                                  */ 00634000
*/*  *****************************************************************/ 00635000
*/*       FREE SPACE DESCRIBED BY AQE'S                              */ 00636000
*/*  *****************************************************************/ 00637000
*                                                                  0271 00638000
*ETFAQE:                                                           0271 00639000
*   IF TCBAQE=ZERO THEN             /* IF NO AQE'S,                  */ 00640000
ETFAQE   L     @14,TCBAQE(,TCBPTR)                                 0271 00641000
         LTR   @14,@14                                             0271 00642000
         BZ    @RT00271                                            0271 00643000
*     GOTO ETFSWA;                  /* FREE SWA                      */ 00644000
*ETFAQE1:                                                          0273 00645000
*   GENERATE REFS(CVTCRMN);                                        0273 00646000
ETFAQE1  DS    0H                                                  0273 00647000
*                                        /* FREE SP 253/254*/           00648000
        FREEMAIN  RC,LV=0,SP=253,A=NULL,BRANCH=YES                      00649000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM GETMAIN?      */ 00650000
         LTR   RRETURN,RRETURN                                     0274 00651000
         BZ    @RF00274                                            0274 00652000
*     RETCOD=FOUR;                                                 0275 00653000
*                                                                  0275 00654000
         MVC   RETCOD(4),@CF00076                                  0275 00655000
*/*                                                                  */ 00656000
*/*  *****************************************************************/ 00657000
*/*       FREE SWA SPACE                                             */ 00658000
*/*  *****************************************************************/ 00659000
*                                                                  0276 00660000
*ETFSWA:                                                           0276 00661000
*   IF TCBSWA=ZERO THEN             /* IF NO SWA, DONE               */ 00662000
@RF00274 DS    0H                                                  0276 00663000
ETFSWA   L     @14,TCBSWA(,TCBPTR)                                 0276 00664000
         LTR   @14,@14                                             0276 00665000
         BZ    @RT00276                                            0276 00666000
*     GOTO ETFRETN;                 /* PROCESSING DONE               */ 00667000
*ETFSPQE2:                                                         0278 00668000
*   SPQESPTR=TCBSWA;                /* PTR TO FIRST SWA SPQE         */ 00669000
ETFSPQE2 L     @14,TCBSWA(,TCBPTR)                                 0278 00670000
         ST    @14,SPQESPTR                                        0278 00671000
*   IF SPSHARE='1'B THEN            /* IF SUBPOOL IS SHARED,         */ 00672000
         TM    SPSHARE(@14),B'10000000'                            0279 00673000
         BO    @RT00279                                            0279 00674000
*     GOTO ETFSPQE3;                /* DO NOT FREE IT                */ 00675000
*   RID=SPQEID;                                                    0281 00676000
         SLR   RID,RID                                             0281 00677000
         IC    RID,SPQEID(,@14)                                    0281 00678000
*   GENERATE REFS(CVTCRMN);                                        0282 00679000
             FREEMAIN  RC,LV=0,SP=(RID),A=NULL,BRANCH=YES               00680000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM GETMAIN?      */ 00681000
         LTR   RRETURN,RRETURN                                     0283 00682000
         BZ    @RF00283                                            0283 00683000
*     RETCOD=FOUR;                                                 0284 00684000
         MVC   RETCOD(4),@CF00076                                  0284 00685000
*ETFSPQE3:                                                         0285 00686000
*   TCBSWA=SPQEPTR;                 /* NEXT SWA SPQE                 */ 00687000
@RF00283 DS    0H                                                  0285 00688000
ETFSPQE3 L     @14,SPQESPTR                                        0285 00689000
         L     @14,SPQEPTR(,@14)                                   0285 00690000
         ST    @14,TCBSWA(,TCBPTR)                                 0285 00691000
*   TCBFLDPT=ADDR(TCBSWA);          /* QUEUE BEING WORKED UPON       */ 00692000
*                                                                  0286 00693000
         LA    TCBFLDPT,TCBSWA(,TCBPTR)                            0286 00694000
*   /*****************************************************************/ 00695000
*   /*                                                               */ 00696000
*   /* SUBROUTINE TO FREE UP SPQE'S                                  */ 00697000
*   /*                                                               */ 00698000
*   /*****************************************************************/ 00699000
*                                                                  0287 00700000
*FREESPQE:                                                         0287 00701000
*   IF LASTSPQE¬='0'B THEN          /* IF THIS WAS LAST SPQE ON    0287 00702000
*                                      CHAIN, SET CHAIN PTR TO ZERO  */ 00703000
FREESPQE L     @14,SPQESPTR                                        0287 00704000
         TM    LASTSPQE(@14),B'01000000'                           0287 00705000
         BZ    @RF00287                                            0287 00706000
*     TCBFLDPT->TCBFIELD=ZERO;                                     0288 00707000
         SLR   @14,@14                                             0288 00708000
         ST    @14,TCBFIELD(,TCBFLDPT)                             0288 00709000
*   GENERATE SETS(REG0,REG1,REG14,REG15) REFS(SPQESPTR);           0289 00710000
@RF00287 DS    0H                                                  0289 00711000
*                                      REGS USED BY MACROS    @Z30ENYG  00712000
          L     REG15,SPQESPTR         ADDR OF SPQE           @Z30ENYG  00713000
          FREEMAIN  P,BRANCH=YES,A=(REG15)                    @Z30ENYG  00714000
*                               FREE SPQE (CELL RET TO LSQA)  @Z30ENYG  00715000
*   IF RRETURN¬=ZERO THEN           /* RECORD BAD RETURN FROM      0290 00716000
*                                      FREEMAIN                      */ 00717000
         LTR   RRETURN,RRETURN                                     0290 00718000
         BZ    @RF00290                                            0290 00719000
*     RETCOD=FOUR;                                                 0291 00720000
*                                                                  0291 00721000
         MVC   RETCOD(4),@CF00076                                  0291 00722000
*   /*****************************************************************/ 00723000
*   /*                                                               */ 00724000
*   /* IF ALL CHAINS HAVE BEEN HANDLED, RETURN TO CALLER. IF ANY     */ 00725000
*   /* CHAIN REMAINS TO BE PROCESSED, BRANCH TO ISSUE SUBPOOL        */ 00726000
*   /* FREEMAINS FOR THAT CHAIN.                                     */ 00727000
*   /*                                                               */ 00728000
*   /*****************************************************************/ 00729000
*                                                                  0292 00730000
*   IF TCBMSS=ZERO THEN             /* REGION SUBPOOLS FREE?         */ 00731000
@RF00290 SLR   @14,@14                                             0292 00732000
         C     @14,TCBMSS(,TCBPTR)                                 0292 00733000
         BNE   @RF00292                                            0292 00734000
*     IF TCBUKYSP=ZERO THEN         /* 229 AND 230 FREE?             */ 00735000
         C     @14,TCBUKYSP(,TCBPTR)                               0293 00736000
         BNE   @RF00293                                            0293 00737000
*       IF TCBAQE=ZERO THEN         /* SP 253 FREE?                  */ 00738000
         C     @14,TCBAQE(,TCBPTR)                                 0294 00739000
         BNE   @RF00294                                            0294 00740000
*         IF TCBSWA=ZERO THEN       /* SWA FREE?                     */ 00741000
         C     @14,TCBSWA(,TCBPTR)                                 0295 00742000
         BE    @RT00295                                            0295 00743000
*           GOTO ETFRETN;           /* DONE--RETURN                  */ 00744000
*         ELSE                      /* SWA NOT FREED                 */ 00745000
*           GOTO ETFSPQE2;          /* SWA FREE                      */ 00746000
         B     ETFSPQE2                                            0297 00747000
*       ELSE                        /* AQE'S NOT FREED               */ 00748000
*         GOTO ETFAQE1;             /* 253 FREE                      */ 00749000
*     ELSE                          /* 229/230 NOT FREED             */ 00750000
*       GOTO ETFUKYSP;              /* 229/230 FREE                  */ 00751000
*   ELSE                            /* TCBMSS NOT FREED              */ 00752000
*     GOTO ETFSPQE;                 /* GO FREE TCBMSS                */ 00753000
*ETFRETN:                                                          0301 00754000
*   GENERATE;                                                      0301 00755000
ETFRETN  DS    0H                                                  0301 00756000
        SETFRR  D,WRKREGS=(REG3,REG2)                                   00757000
*   REG2=RETCOD;                    /* RETURN CODE                   */ 00758000
         L     REG2,RETCOD                                         0302 00759000
*   GENERATE;                                                      0303 00760000
              L    @00,@SIZDATD                                         00761000
              FREEMAIN  RC,LV=(0),A=(5),SP=255,BRANCH=YES               00762000
*   RRETURN=REG2;                   /* R.C. IN REG 15                */ 00763000
         LR    RRETURN,REG2                                        0304 00764000
*   RETURN;                         /* RETURN                        */ 00765000
         B     @EL00001                                            0305 00766000
*                                                                  0306 00767000
*/*                                                                  */ 00768000
*/*  *****************************************************************/ 00769000
*/*       ENTRY POINT FOR FREE ADDRESS SPACE PROCESSING              */ 00770000
*/*        ANY VSM ADDRESS SPACE RELATED GLOBAL SPACE                */ 00771000
*/*        IS FREED AT THIS TIME                                     */ 00772000
*/*  *****************************************************************/ 00773000
*                                                                  0306 00774000
*IEAVGFAS:                                                         0306 00775000
*   ENTRY;                                                         0306 00776000
*                                                                  0306 00777000
@EP00306 DS    0H                                                  0307 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* DECLARES FOR FREE ADDRESS SPACE SUBROUTINE                    */ 00781000
*   /*                                                               */ 00782000
*   /*****************************************************************/ 00783000
*                                                                  0307 00784000
*   DCL                                                            0307 00785000
*     UNCHAINW LABEL LOCAL EXTERNAL;                               0307 00786000
*   DCL                                                            0308 00787000
*     UNCHAINP LABEL LOCAL EXTERNAL;                               0308 00788000
*   DCL                                                            0309 00789000
*     OUT LABEL LOCAL EXTERNAL;                                    0309 00790000
*   RFY                                                            0310 00791000
*     GDAPTR RESTRICTED;                                           0310 00792000
*   GENERATE REFS(PSALITA,CVTCRMN,CVTMAP);                         0311 00793000
        L     @00,@SIZDATD                SIZE OF @DATD DSECT           00794000
        L    @04,PSATOLD                                                00795000
        L    @07,PSAAOLD                                                00796000
        GETMAIN R,LV=(0)                  SPACE FOR @DATD DSECT         00797000
        LR    @05,@01                     DATAREG                       00798000
        L     @01,24(@13)                 RESTORE PARAMETER             00799000
        USING @DATD,@05                   DATAREG                       00800000
        ST    @13,SAVESAVE                SAVE SAVEAREA PTR             00801000
OBTL2   SETLOCK  OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LDA,IEAVGCAS(R**00802000
               ELL2))                                                   00803000
        SETFRR  A,FRRAD=FASFRR,PARMAD=FRRPARM,WRKREGS=(REG3,REG2)       00804000
*   SAVESV2=SAVESAVE;               /* SAVE FOR FRR USE              */ 00805000
         L     @14,FRRPARM                                         0312 00806000
         L     @12,SAVESAVE                                        0312 00807000
         ST    @12,SAVESV2(,@14)                                   0312 00808000
*   ASCBSAVE=ASCBREG;               /* SAVE FOR FRR USE              */ 00809000
         ST    ASCBREG,ASCBSAVE(,@14)                              0313 00810000
*FASRETRY:                                                         0314 00811000
*   RETCOD=ZERO;                    /* INITIALIZE RETURN CODE        */ 00812000
FASRETRY SLR   @14,@14                                             0314 00813000
         ST    @14,RETCOD                                          0314 00814000
*   GDAPTR=CVTGDA;                  /* GDA BASE                      */ 00815000
         L     @14,CVTPTR                                          0315 00816000
         L     GDAPTR,CVTGDA(,@14)                                 0315 00817000
*   ASCBPTR=PSAAOLD;                /* CURRENT ASCB                  */ 00818000
         L     @14,PSAAOLD                                         0316 00819000
         ST    @14,ASCBPTR                                         0316 00820000
*   IF ASCBASID¬=MSASID THEN        /* ASID SHOULD = 1               */ 00821000
         CLC   ASCBASID(2,@14),@CH00068                            0317 00822000
         BNE   @RT00317                                            0317 00823000
*     GOTO NOTAUTH;                 /* IF NOT, UNAUTHORIZED          */ 00824000
*   GENERATE REFS(PSALITA);                                        0319 00825000
OBTS2   SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRWPQEL,IEAVG**00826000
               CAS(RELS2))                                              00827000
*   ASCBREG=PARMPTR;                /* GET ADDRESS OF PARM AREA    0320 00828000
*                                                            @YM04712*/ 00829000
*                                                                  0320 00830000
         L     ASCBREG,PARMPTR(,ASCBREG)                           0320 00831000
*   /*****************************************************************/ 00832000
*   /*                                                               */ 00833000
*   /* CHECK TO SEE IF THE ADDRESS SPACE THAT IS ENDING HAS AN       */ 00834000
*   /* ELEMENT ON EITHER THE WAIT OR POST QUEUES IN SQA              */ 00835000
*   /*                                                               */ 00836000
*   /*****************************************************************/ 00837000
*                                                                  0321 00838000
*   IF VRWFEL=ZERO THEN             /* IF NO ELS ON WAITQ,           */ 00839000
         L     @14,VRWFEL(,GDAPTR)                                 0321 00840000
         LTR   @14,@14                                             0321 00841000
         BZ    @RT00321                                            0321 00842000
*     GOTO PQ;                      /* CHECK POSTQ                   */ 00843000
*   WPQLPTR=VRWFEL;                 /* EL BASE = 1ST EL @            */ 00844000
         LR    WPQLPTR,@14                                         0323 00845000
*TESTW:                                                            0324 00846000
*   IF WPELASCB=ASCBADD THEN        /* IF THIS EL FOR THIS           */ 00847000
TESTW    CLC   WPELASCB(4,WPQLPTR),ASCBADD(ASCBREG)                0324 00848000
         BE    @RT00324                                            0324 00849000
*     GOTO UNCHAINW;                /* DEQUEUE ELEMENT               */ 00850000
*   IF WPNEXTEL=ZERO THEN           /* IF NO MORE ELS ON WAIT,       */ 00851000
         L     @14,WPNEXTEL(,WPQLPTR)                              0326 00852000
         LTR   @14,@14                                             0326 00853000
         BZ    @RT00326                                            0326 00854000
*     GOTO PQ;                      /* CHECK POSTQ                   */ 00855000
*   WPQLPTR=WPNEXTEL;               /* GET NEXT EL ON QUEUE          */ 00856000
         LR    WPQLPTR,@14                                         0328 00857000
*   GOTO TESTW;                     /* CHECK ASCB'S                  */ 00858000
*                                                                  0329 00859000
         B     TESTW                                               0329 00860000
*   /*****************************************************************/ 00861000
*   /*                                                               */ 00862000
*   /* ELEMENT WAS FOUND ON THE VRWAIT QUEUE---UNCHAIN IT            */ 00863000
*   /*                                                               */ 00864000
*   /*****************************************************************/ 00865000
*                                                                  0330 00866000
*UNCHAINW:                                                         0330 00867000
*   WDEQ='1'B;                      /* FRR FOOTPRINT                 */ 00868000
UNCHAINW L     @14,FRRPARM                                         0330 00869000
         OI    WDEQ(@14),B'01000000'                               0330 00870000
*   IF WPNEXTEL=ZERO THEN           /* FIRST EL. ON QUEUE?           */ 00871000
         SLR   @14,@14                                             0331 00872000
         C     @14,WPNEXTEL(,WPQLPTR)                              0331 00873000
         BNE   @RF00331                                            0331 00874000
*     DO;                                                          0332 00875000
*       IF WPPREVEL=ZERO THEN       /* IF THIS IS ONLY EL ON         */ 00876000
         C     @14,WPPREVEL(,WPQLPTR)                              0333 00877000
         BNE   @RF00333                                            0333 00878000
*         DO;                       /* QUEUE, SET ANCHOR             */ 00879000
*           VRWFEL=ZERO;            /* BLOCK PTRS TO 0               */ 00880000
         ST    @14,VRWFEL(,GDAPTR)                                 0335 00881000
*           VRWLEL=ZERO;                                           0336 00882000
         ST    @14,VRWLEL(,GDAPTR)                                 0336 00883000
*           WAITQUE='0'B;           /* NO SPEC ELS WAITING           */ 00884000
         NI    WAITQUE(GDAPTR),B'11111101'                         0337 00885000
*           CALL FREEQEL;           /* GO FREE THE ELEMENT           */ 00886000
         BAL   @14,FREEQEL                                         0338 00887000
*           GOTO OUT;               /* RETURN                        */ 00888000
         B     OUT                                                 0339 00889000
*         END;                                                     0340 00890000
*       ELSE                        /* IF EL IS LAST ON QUEUE,       */ 00891000
*         DO;                       /* UPDATE POINTERS               */ 00892000
@RF00333 DS    0H                                                  0342 00893000
*           WPPREVEL->WPNEXTEL=WPNEXTEL;                           0342 00894000
         L     @14,WPPREVEL(,WPQLPTR)                              0342 00895000
         L     @12,WPNEXTEL(,WPQLPTR)                              0342 00896000
         ST    @12,WPNEXTEL(,@14)                                  0342 00897000
*           VRWLEL=WPPREVEL;                                       0343 00898000
         ST    @14,VRWLEL(,GDAPTR)                                 0343 00899000
*           CALL FREEQEL;           /* GO FREE THE ELEMENT           */ 00900000
         BAL   @14,FREEQEL                                         0344 00901000
*           FSTELPTR=VRWFEL+SPECADDR;                              0345 00902000
         LA    FSTELPTR,24                                         0345 00903000
         AL    FSTELPTR,VRWFEL(,GDAPTR)                            0345 00904000
*           IF FSTELPTR->WPSPADDR=ZERO THEN/* IF FIRST ELEMENT ON  0346 00905000
*                                      QUEUE IS NOT SPECIFIC,        */ 00906000
         L     @14,WPSPADDR(,FSTELPTR)                             0346 00907000
         LTR   @14,@14                                             0346 00908000
         BNZ   @RF00346                                            0346 00909000
*             WAITQUE='0'B;         /* ZERO WAIT BIT                 */ 00910000
         NI    WAITQUE(GDAPTR),B'11111101'                         0347 00911000
*           GOTO OUT;               /* RETURN                        */ 00912000
         B     OUT                                                 0348 00913000
*         END;                                                     0349 00914000
*     END;                                                         0350 00915000
*   IF WPPREVEL=ZERO THEN           /* IF EL IS 1ST ON QUEUE,        */ 00916000
@RF00331 L     @14,WPPREVEL(,WPQLPTR)                              0351 00917000
         LTR   @14,@14                                             0351 00918000
         BNZ   @RF00351                                            0351 00919000
*     DO;                           /* UPDATE POINTERS AND           */ 00920000
*       WPNEXTEL->WPPREVEL=WPPREVEL;/* DEQUEUE ELEMENT               */ 00921000
         L     @12,WPNEXTEL(,WPQLPTR)                              0353 00922000
         ST    @14,WPPREVEL(,@12)                                  0353 00923000
*       VRWFEL=WPNEXTEL;                                           0354 00924000
         ST    @12,VRWFEL(,GDAPTR)                                 0354 00925000
*       CALL FREEQEL;               /* GO FREE THE ELEMENT           */ 00926000
         BAL   @14,FREEQEL                                         0355 00927000
*       FSTELPTR=VRWFEL+SPECADDR;                                  0356 00928000
         LA    FSTELPTR,24                                         0356 00929000
         AL    FSTELPTR,VRWFEL(,GDAPTR)                            0356 00930000
*       IF FSTELPTR->WPSPADDR=ZERO THEN/* IF FIRST ELEMENT ON QUEUE     00931000
*                                      IS NOT SPECIFIC, ZERO WAIT BIT*/ 00932000
         L     @14,WPSPADDR(,FSTELPTR)                             0357 00933000
         LTR   @14,@14                                             0357 00934000
         BNZ   @RF00357                                            0357 00935000
*         WAITQUE='0'B;                                            0358 00936000
         NI    WAITQUE(GDAPTR),B'11111101'                         0358 00937000
*       GOTO OUT;                   /* RETURN                        */ 00938000
         B     OUT                                                 0359 00939000
*     END;                                                         0360 00940000
*   WPNEXTEL->WPPREVEL=WPPREVEL;    /* IF EL IN MIDDLE OF            */ 00941000
@RF00351 L     @14,WPNEXTEL(,WPQLPTR)                              0361 00942000
         L     @12,WPPREVEL(,WPQLPTR)                              0361 00943000
         ST    @12,WPPREVEL(,@14)                                  0361 00944000
*   WPPREVEL->WPNEXTEL=WPNEXTEL;    /* QUEUE, DEQUEUE IT             */ 00945000
         ST    @14,WPNEXTEL(,@12)                                  0362 00946000
*   CALL FREEQEL;                   /* GO FREE THE ELEMENT           */ 00947000
         BAL   @14,FREEQEL                                         0363 00948000
*   GOTO OUT;                       /* RETURN                        */ 00949000
         B     OUT                                                 0364 00950000
*                                                                  0365 00951000
*   /*****************************************************************/ 00952000
*   /*                                                               */ 00953000
*   /* NO ELEMENT FOUND ON THE VRWAITQ. NOW CHECK FOR AN ELEMENT ON  */ 00954000
*   /* THE VRPOSTQ                                                   */ 00955000
*   /*                                                               */ 00956000
*   /*****************************************************************/ 00957000
*                                                                  0365 00958000
*PQ:                                                               0365 00959000
*   IF VRPFEL=ZERO THEN             /* IF NO ELS ON POSTQ,           */ 00960000
PQ       L     @14,VRPFEL(,GDAPTR)                                 0365 00961000
         LTR   @14,@14                                             0365 00962000
         BZ    @RT00365                                            0365 00963000
*     GOTO OUT;                     /* PROCESSING DONE               */ 00964000
*   ELSE                            /* EL BASE = 1ST EL @            */ 00965000
*     WPQLPTR=VRPFEL;                                              0367 00966000
         LR    WPQLPTR,@14                                         0367 00967000
*TESTP:                                                            0368 00968000
*   IF WPELASCB=ASCBADD THEN        /* IF EL ON POSTQ,               */ 00969000
TESTP    CLC   WPELASCB(4,WPQLPTR),ASCBADD(ASCBREG)                0368 00970000
         BE    @RT00368                                            0368 00971000
*     GOTO UNCHAINP;                /* DEQUEUE POST EL.              */ 00972000
*   IF WPNEXTEL=ZERO THEN           /* IF NO MORE ELS ON POSTQ,      */ 00973000
         L     @14,WPNEXTEL(,WPQLPTR)                              0370 00974000
         LTR   @14,@14                                             0370 00975000
         BZ    @RT00370                                            0370 00976000
*     GOTO OUT;                     /* RETURN                        */ 00977000
*   WPQLPTR=WPNEXTEL;               /* GET NEXT POSTQ EL             */ 00978000
         LR    WPQLPTR,@14                                         0372 00979000
*   GOTO TESTP;                     /* CHECK ASCB'S                  */ 00980000
*                                                                  0373 00981000
         B     TESTP                                               0373 00982000
*   /*****************************************************************/ 00983000
*   /*                                                               */ 00984000
*   /* AN ELEMENT WAS FOUND ON THE VRPOSTQ---DEQUEUE IT              */ 00985000
*   /*                                                               */ 00986000
*   /*****************************************************************/ 00987000
*                                                                  0374 00988000
*UNCHAINP:                                                         0374 00989000
*   PDEQ='1'B;                      /* FRR FOOTPRINT                 */ 00990000
UNCHAINP L     @14,FRRPARM                                         0374 00991000
         OI    PDEQ(@14),B'00100000'                               0374 00992000
*   IF WPNEXTEL=ZERO THEN           /* IF EL. IS 1ST ON QUEUE        */ 00993000
         SLR   @14,@14                                             0375 00994000
         C     @14,WPNEXTEL(,WPQLPTR)                              0375 00995000
         BNE   @RF00375                                            0375 00996000
*     DO;                                                          0376 00997000
*       IF WPPREVEL=ZERO THEN       /* IF EL IS ONLY ONE ON          */ 00998000
         C     @14,WPPREVEL(,WPQLPTR)                              0377 00999000
         BNE   @RF00377                                            0377 01000000
*         DO;                       /* QUEUE, SET ANCHOR             */ 01001000
*           VRPFEL=ZERO;            /* BLOCK PTRS TO 0               */ 01002000
         ST    @14,VRPFEL(,GDAPTR)                                 0379 01003000
*           VRPLEL=ZERO;                                           0380 01004000
         ST    @14,VRPLEL(,GDAPTR)                                 0380 01005000
*           CALL FREEQEL;           /* GO FREE THE ELEMENT           */ 01006000
         BAL   @14,FREEQEL                                         0381 01007000
*           GOTO OUT;               /* RETURN                        */ 01008000
         B     OUT                                                 0382 01009000
*         END;                                                     0383 01010000
*       ELSE                        /* IF EL IS LAST ON QUEUE,       */ 01011000
*         DO;                       /* UPDATE PTRS AND DEQUEUE       */ 01012000
@RF00377 DS    0H                                                  0385 01013000
*           WPPREVEL->WPNEXTEL=WPNEXTEL;                           0385 01014000
         L     @14,WPPREVEL(,WPQLPTR)                              0385 01015000
         L     @12,WPNEXTEL(,WPQLPTR)                              0385 01016000
         ST    @12,WPNEXTEL(,@14)                                  0385 01017000
*           VRPLEL=WPPREVEL;                                       0386 01018000
         ST    @14,VRPLEL(,GDAPTR)                                 0386 01019000
*           CALL FREEQEL;           /* GO FREE THE ELEMENT           */ 01020000
         BAL   @14,FREEQEL                                         0387 01021000
*           GOTO OUT;               /* RETURN                        */ 01022000
         B     OUT                                                 0388 01023000
*         END;                                                     0389 01024000
*     END;                                                         0390 01025000
*   IF WPPREVEL=ZERO THEN           /* IF EL IS 1ST ON QUEUE,        */ 01026000
@RF00375 L     @14,WPPREVEL(,WPQLPTR)                              0391 01027000
         LTR   @14,@14                                             0391 01028000
         BNZ   @RF00391                                            0391 01029000
*     DO;                           /* UPDATE PTRS AND DEQUEUE       */ 01030000
*       WPNEXTEL->WPPREVEL=WPPREVEL;                               0393 01031000
         L     @12,WPNEXTEL(,WPQLPTR)                              0393 01032000
         ST    @14,WPPREVEL(,@12)                                  0393 01033000
*       VRPFEL=WPNEXTEL;                                           0394 01034000
         ST    @12,VRPFEL(,GDAPTR)                                 0394 01035000
*       CALL FREEQEL;               /* FREE THE ELEMENT              */ 01036000
         BAL   @14,FREEQEL                                         0395 01037000
*       GOTO OUT;                   /* RETURN                        */ 01038000
         B     OUT                                                 0396 01039000
*     END;                                                         0397 01040000
*   WPNEXTEL->WPPREVEL=WPPREVEL;    /* IF EL IN MIDDLE OF            */ 01041000
@RF00391 L     @14,WPNEXTEL(,WPQLPTR)                              0398 01042000
         L     @12,WPPREVEL(,WPQLPTR)                              0398 01043000
         ST    @12,WPPREVEL(,@14)                                  0398 01044000
*   WPPREVEL->WPNEXTEL=WPNEXTEL;    /* QUEUE, DEQUEUE IT             */ 01045000
         ST    @14,WPNEXTEL(,@12)                                  0399 01046000
*   CALL FREEQEL;                   /* FREE THE ELEMENT              */ 01047000
         BAL   @14,FREEQEL                                         0400 01048000
*OUT:                                                              0401 01049000
*   GENERATE REFS(PSALITA);                                        0401 01050000
OUT      DS    0H                                                  0401 01051000
*                                         /* RELEASE SALLOC         */  01052000
RELS2   SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VRWPQEL,IEAVGCAS(OBTS2))   01053000
*   IF SETRETRN=LOCKVIOL THEN       /* IF LOCK VIOLATION, ABEND      */ 01054000
         C     SETRETRN,@CF00050                                   0402 01055000
         BNE   @RF00402                                            0402 01056000
*     GENERATE;                                                    0403 01057000
              ABEND  X'082',,,SYSTEM                                    01058000
*OUTA:                                                             0404 01059000
*     GENERATE REFS(PSALITA);                                      0404 01060000
@RF00402 DS    0H                                                  0404 01061000
OUTA     DS    0H                                                  0404 01062000
*                                      /* RELEASE LOCAL LOCK & FRR  */  01063000
        SETFRR  D,WRKREGS=(REG3,REG2)   DELETE FRR FROM STACK           01064000
RELL2   SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LDA,IEAVGCAS(OBTL2))        01065000
*OUTB:                                                             0405 01066000
*     REG2=RETCOD;                  /* SET REG 2 = RETURN CODE       */ 01067000
OUTB     L     REG2,RETCOD                                         0405 01068000
*   REG13=SAVESAVE;                 /* RESTORE SAVEAREA PTR          */ 01069000
         L     REG13,SAVESAVE                                      0406 01070000
*   GENERATE REFS(CVTCRMN,CVTMAP);                                 0407 01071000
        L    @00,@SIZDATD                                               01072000
        FREEMAIN  RC,LV=(0),A=(5)                                       01073000
*   RRETURN=REG2;                   /* R.C. IN REG 15                */ 01074000
         LR    RRETURN,REG2                                        0408 01075000
*   RETURN;                         /* RETURN                        */ 01076000
         B     @EL00001                                            0409 01077000
*                                                                  0410 01078000
*/********************************************************************/ 01079000
*/*        THIS IS THE INTERNAL PROCEDURE WHICH FREES                */ 01080000
*/*           ELEMENTS ON THE V=R WAIT/POST QUEUES.                  */ 01081000
*/********************************************************************/ 01082000
*                                                                  0410 01083000
*FREEQEL:                                                          0410 01084000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0410 01085000
FREEQEL  DS    0H                                                  0411 01086000
*   REG2=RETREG;                    /* SAVE RETURN ADDRESS           */ 01087000
         LR    REG2,RETREG                                         0411 01088000
*/* FREE THE ELEMENT                                                 */ 01089000
*                                                                  0412 01090000
*   DO;                             /* FREEMAIN(RC)                0412 01091000
*                                      LV(28)A(WPQLPTR->VRWPQEL)   0412 01092000
*                                      SP(SQASPID) BRANCH            */ 01093000
*     RESPECIFY                                                    0413 01094000
*      (GPR01F,                                                    0413 01095000
*       GPR03F,                                                    0413 01096000
*       GPR00F) RESTRICTED;                                        0413 01097000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 01098000
         SLR   GPR01F,GPR01F                                       0414 01099000
*     GPR03F=1;                     /* SET TYPE                      */ 01100000
         LA    GPR03F,1                                            0415 01101000
*     GPR00F=28;                    /* LENGTH REQUESTED              */ 01102000
         LA    GPR00F,28                                           0416 01103000
*     GPR01F=ADDR(WPQLPTR->VRWPQEL);/* SET REGISTER ONE              */ 01104000
         LR    GPR01F,WPQLPTR                                      0417 01105000
*     GPR03F=GPR03F+((SQASPID)*256);/* SUBPOOL VALUE                 */ 01106000
         AL    GPR03F,@CF01913                                     0418 01107000
*     CALL CVTCRMN;                 /* BRANCH ENTRY POINT            */ 01108000
         L     @12,CVTPTR                                          0419 01109000
         L     @15,CVTCRMN(,@12)                                   0419 01110000
         BALR  @14,@15                                             0419 01111000
*     RESPECIFY                                                    0420 01112000
*      (GPR01F,                                                    0420 01113000
*       GPR03F,                                                    0420 01114000
*       GPR00F) UNRESTRICTED;                                      0420 01115000
*   END;                            /* FREEMAIN(RC)                0421 01116000
*                                      LV(28)A(WPQLPTR->VRWPQEL)   0421 01117000
*                                      SP(SQASPID) BRANCH            */ 01118000
*   IF RRETURN¬=ZERO THEN           /* BAD RETURN FROM FREEMAIN?     */ 01119000
         LTR   RRETURN,RRETURN                                     0422 01120000
         BZ    @RF00422                                            0422 01121000
*     RETCOD=RRETURN;               /* SAVE R.C.                     */ 01122000
         ST    RRETURN,RETCOD                                      0423 01123000
*   RETREG=REG2;                    /* RESTORE RETURN ADDRESS        */ 01124000
@RF00422 LR    RETREG,REG2                                         0424 01125000
*   END FREEQEL;                                                   0425 01126000
@EL00002 DS    0H                                                  0425 01127000
@EF00002 DS    0H                                                  0425 01128000
@ER00002 BR    @14                                                 0425 01129000
*   END IEAVGCAS                                                   0426 01130000
*                                                                  0426 01131000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01132000
*/*%INCLUDE SYSLIB  (IHAGDA  )                                       */ 01133000
*/*%INCLUDE SYSLIB  (EPILOG  )                                       */ 01134000
*/*%INCLUDE SYSLIB  (IHALDA  )                                       */ 01135000
*/*%INCLUDE SYSLIB  (IHAPQE  )                                       */ 01136000
*/*%INCLUDE SYSLIB  (IHAFBQE )                                       */ 01137000
*/*%INCLUDE SYSLIB  (IHASPQE )                                       */ 01138000
*/*%INCLUDE SYSLIB  (IHADQE  )                                       */ 01139000
*/*%INCLUDE SYSLIB  (IHAFQE  )                                       */ 01140000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01141000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01142000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 01143000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01144000
*/*%INCLUDE SYSLIB  (IHAWPQEL)                                       */ 01145000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01146000
*/*%INCLUDE SYSLIB  (FREEMAIN)                                       */ 01147000
*/*%INCLUDE SYSLIB  (AHAFMAIN)                                       */ 01148000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 01149000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 01150000
*                                                                  0426 01151000
*       ;                                                          0426 01152000
@DATA    DS    0H                                                       01153000
@CH00068 DC    H'1'                                                     01154000
@DATD    DSECT                                                          01155000
         DS    0F                                                       01156000
@TF00001 DS    F                                                        01157000
IEAVGCAS CSECT                                                          01158000
         DS    0F                                                       01159000
@CF00076 DC    F'4'                                                     01160000
@CF00050 DC    F'8'                                                     01161000
@CF00038 DC    F'16'                                                    01162000
@CF00064 DC    F'4096'                                                  01163000
@CF00099 DC    F'16384'                                                 01164000
@CF01913 DC    F'62720'                                                 01165000
@DATD    DSECT                                                          01166000
         DS    0D                                                       01167000
ASCBPTR  DS    A                                                        01168000
ASXBPTR  DS    A                                                        01169000
SCVTSPTR DS    A                                                        01170000
SPQESPTR DS    AL4                                                      01171000
         ORG   SPQESPTR                                                 01172000
@NM00001 DS    AL1                                                      01173000
SPQPTR   DS    AL3                                                      01174000
         ORG   SPQESPTR+4                                               01175000
PAEND    DS    A                                                        01176000
LDAPTRNM DS    A                                                        01177000
XVALUE   DS    F                                                        01178000
RETCOD   DS    F                                                        01179000
LDA2NM   DS    A                                                        01180000
CELLPTR  DS    AL4                                                      01181000
         ORG   CELLPTR                                                  01182000
@NM00002 DS    CL3                                                      01183000
RNDCPADR DS    FL1                                                      01184000
         ORG   CELLPTR+4                                                01185000
FRRPARM  DS    A                                                        01186000
SAVESAVE DS    A                                                        01187000
FRREPTR  DS    A                                                        01188000
ZER0     DS    F                                                        01189000
I        DS    F                                                        01190000
PARAM    DS    CL4                                                      01191000
         ORG   PARAM                                                    01192000
WORD1    DS    AL1                                                      01193000
WORD2    DS    AL3                                                      01194000
         ORG   PARAM+4                                                  01195000
SAADDR   DS    CL4                                                      01196000
         ORG   SAADDR                                                   01197000
SAADDR1  DS    AL1                                                      01198000
SAADDR2  DS    AL3                                                      01199000
         ORG   SAADDR+4                                                 01200000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01201000
@ENDDATD EQU   *                                                        01202000
IEAVGCAS CSECT                                                          01203000
         DS    0F                                                       01204000
@SIZDATD DC    AL1(0)                                                   01205000
         DC    AL3(@ENDDATD-@DATD)                                      01206000
@CV00155 DC    V(IEAVITAS)                                              01207000
@CV00156 DC    V(IEAVCARR)                                              01208000
@CV00157 DC    V(IEAVTTRR)                                              01209000
@CV00158 DC    V(IEAVFARR)                                              01210000
         DS    0D                                                       01211000
NULL     DC    F'0'                                                     01212000
SRSIZE   DC    F'16384'                                                 01213000
ONE      DC    F'1'                                                     01214000
CASFRR   DC    VL4(IEAVCARR)                                            01215000
TTFRR    DC    VL4(IEAVTTRR)                                            01216000
FASFRR   DC    VL4(IEAVFARR)                                            01217000
TRUNC    DC    XL1'F0'                                                  01218000
XFF      DC    AL1(255)                                                 01219000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01220000
@01      EQU   01                                                       01221000
@02      EQU   02                                                       01222000
@03      EQU   03                                                       01223000
@04      EQU   04                                                       01224000
@05      EQU   05                                                       01225000
@06      EQU   06                                                       01226000
@07      EQU   07                                                       01227000
@08      EQU   08                                                       01228000
@09      EQU   09                                                       01229000
@10      EQU   10                                                       01230000
@11      EQU   11                                                       01231000
@12      EQU   12                                                       01232000
@13      EQU   13                                                       01233000
@14      EQU   14                                                       01234000
@15      EQU   15                                                       01235000
NEXTCELL EQU   @02                                                      01236000
LDA2     EQU   @03                                                      01237000
TOPLDANM EQU   @12                                                      01238000
TOPLDAMS EQU   @03                                                      01239000
NUMBYTES EQU   @02                                                      01240000
FSTELPTR EQU   @02                                                      01241000
TCBFLDPT EQU   @02                                                      01242000
WPQLPTR  EQU   @08                                                      01243000
FQESEPTR EQU   @02                                                      01244000
DQESEPTR EQU   @02                                                      01245000
FBQESPTR EQU   @12                                                      01246000
PQESEPTR EQU   @02                                                      01247000
LDAPTR   EQU   @08                                                      01248000
ASCBREG  EQU   @01                                                      01249000
SETRETRN EQU   @13                                                      01250000
FMADDR   EQU   @06                                                      01251000
GDAPTR   EQU   @06                                                      01252000
RSMADDR  EQU   @01                                                      01253000
REG1     EQU   @01                                                      01254000
REG0     EQU   @00                                                      01255000
REG2     EQU   @02                                                      01256000
REG5     EQU   @05                                                      01257000
REG13    EQU   @13                                                      01258000
REG14    EQU   @14                                                      01259000
REG15    EQU   @15                                                      01260000
RTCB     EQU   @04                                                      01261000
RASCB    EQU   @07                                                      01262000
RETREG   EQU   @14                                                      01263000
SPKEY    EQU   @15                                                      01264000
RRETURN  EQU   @15                                                      01265000
GPR01F   EQU   @01                                                      01266000
GPR03F   EQU   @03                                                      01267000
GPR00F   EQU   @00                                                      01268000
TCBPTR   EQU   @04                                                      01269000
RSAVE    EQU   @13                                                      01270000
RID      EQU   @06                                                      01271000
REG11    EQU   @11                                                      01272000
REG3     EQU   @03                                                      01273000
         ENTRY NOTAUTH                                                  01274000
         ENTRY CASRETRY                                                 01275000
         ENTRY TTRETRY                                                  01276000
         ENTRY FASRETRY                                                 01277000
         ENTRY UNCHAINW                                                 01278000
         ENTRY UNCHAINP                                                 01279000
         ENTRY OUT                                                      01280000
CVTPTR   EQU   16                                                       01281000
PSA      EQU   0                                                        01282000
FLCRNPSW EQU   PSA                                                      01283000
FLCROPSW EQU   PSA+8                                                    01284000
FLCICCW2 EQU   PSA+16                                                   01285000
PSAEEPSW EQU   PSA+132                                                  01286000
PSAESPSW EQU   PSA+136                                                  01287000
FLCSVILC EQU   PSAESPSW+1                                               01288000
PSAEPPSW EQU   PSA+140                                                  01289000
FLCPIILC EQU   PSAEPPSW+1                                               01290000
FLCPICOD EQU   PSAEPPSW+2                                               01291000
PSAPICOD EQU   FLCPICOD+1                                               01292000
FLCTEA   EQU   PSAEPPSW+4                                               01293000
FLCPER   EQU   PSA+152                                                  01294000
FLCMCLA  EQU   PSA+168                                                  01295000
FLCIOEL  EQU   FLCMCLA+4                                                01296000
FLCIOA   EQU   FLCMCLA+16                                               01297000
FLCFSA   EQU   FLCMCLA+80                                               01298000
PSATOLD  EQU   PSA+540                                                  01299000
PSAAOLD  EQU   PSA+548                                                  01300000
PSASUPER EQU   PSA+552                                                  01301000
PSASUP1  EQU   PSASUPER                                                 01302000
PSASUP2  EQU   PSASUPER+1                                               01303000
PSASUP3  EQU   PSASUPER+2                                               01304000
PSASUP4  EQU   PSASUPER+3                                               01305000
PSACLHT  EQU   PSA+640                                                  01306000
PSALKSA  EQU   PSA+696                                                  01307000
PSAHLHI  EQU   PSA+760                                                  01308000
PSALITA  EQU   PSA+764                                                  01309000
PSADSSFL EQU   PSA+836                                                  01310000
PSADSSF1 EQU   PSADSSFL                                                 01311000
PSADSSF3 EQU   PSADSSFL+2                                               01312000
PSADSSF4 EQU   PSADSSFL+3                                               01313000
PSARSVT  EQU   PSA+896                                                  01314000
TCBFIELD EQU   0                                                        01315000
AREA     EQU   0                                                        01316000
EOTPARM  EQU   0                                                        01317000
ASCBADD  EQU   EOTPARM+4                                                01318000
PARMPTR  EQU   0                                                        01319000
CELL     EQU   0                                                        01320000
NXTCELNM EQU   CELL                                                     01321000
BELOWLDA EQU   0                                                        01322000
SRPQE    EQU   BELOWLDA                                                 01323000
SRFBQE   EQU   BELOWLDA+32                                              01324000
ASPQE    EQU   BELOWLDA+48                                              01325000
ASFBQE   EQU   BELOWLDA+80                                              01326000
LSQASPQE EQU   BELOWLDA+96                                              01327000
LSQADQE  EQU   BELOWLDA+112                                             01328000
PGTABLE  EQU   BELOWLDA+128                                             01329000
RRPARMS  EQU   0                                                        01330000
FLGS     EQU   RRPARMS                                                  01331000
RSMBIT   EQU   FLGS                                                     01332000
WDEQ     EQU   FLGS                                                     01333000
PDEQ     EQU   FLGS                                                     01334000
PAGEADD  EQU   RRPARMS+4                                                01335000
ASCBSAVE EQU   RRPARMS+8                                                01336000
SAVESV2  EQU   RRPARMS+12                                               01337000
GDA      EQU   0                                                        01338000
GVSMFLAG EQU   GDA                                                      01339000
GDAFLAGS EQU   GVSMFLAG                                                 01340000
WAITQUE  EQU   GDAFLAGS                                                 01341000
PASTRT   EQU   GDA+16                                                   01342000
PASIZE   EQU   GDA+20                                                   01343000
VRPOSTQ  EQU   GDA+32                                                   01344000
VRPFEL   EQU   VRPOSTQ                                                  01345000
VRPLEL   EQU   VRPOSTQ+4                                                01346000
VRWAITQ  EQU   GDA+40                                                   01347000
VRWFEL   EQU   VRWAITQ                                                  01348000
VRWLEL   EQU   VRWAITQ+4                                                01349000
LDA      EQU   0                                                        01350000
LVSMFLAG EQU   LDA                                                      01351000
PASCBSV  EQU   LDA+4                                                    01352000
ASDPQE   EQU   LDA+8                                                    01353000
CFAPWKAR EQU   LDA+1164                                                 01354000
LSQAPTR  EQU   LDA+1464                                                 01355000
VVREGSZ  EQU   LDA+1468                                                 01356000
CURRGNTP EQU   LDA+1472                                                 01357000
LDASRPQE EQU   LDA+1476                                                 01358000
LDARSVPT EQU   LDA+1480                                                 01359000
LCLCELL  EQU   LDA+1488                                                 01360000
LCLCELCT EQU   LDA+1492                                                 01361000
PQESECT  EQU   0                                                        01362000
PQEFFBQE EQU   PQESECT                                                  01363000
PQEBFBQE EQU   PQESECT+4                                                01364000
PQEFPQE  EQU   PQESECT+8                                                01365000
PQEBPQE  EQU   PQESECT+12                                               01366000
PQESIZE  EQU   PQESECT+20                                               01367000
PQEREGN  EQU   PQESECT+24                                               01368000
VMMFLGS  EQU   PQESECT+30                                               01369000
FBQESECT EQU   0                                                        01370000
FWDPTR   EQU   FBQESECT                                                 01371000
BCKPTR   EQU   FBQESECT+4                                               01372000
SIZE     EQU   FBQESECT+8                                               01373000
FBQAREA  EQU   FBQESECT+12                                              01374000
SPQESECT EQU   0                                                        01375000
SPQEAD   EQU   SPQESECT                                                 01376000
SPQEPTR  EQU   SPQEAD                                                   01377000
SPDQEPTR EQU   SPQESECT+4                                               01378000
SPQEFLGS EQU   SPQESECT+8                                               01379000
SPSHARE  EQU   SPQEFLGS                                                 01380000
LASTSPQE EQU   SPQEFLGS                                                 01381000
SPQEID   EQU   SPQESECT+10                                              01382000
SPQEKEY  EQU   SPQESECT+11                                              01383000
DQESECT  EQU   0                                                        01384000
DQFQEPTR EQU   DQESECT                                                  01385000
DQEPTR   EQU   DQESECT+4                                                01386000
DQEBLKAD EQU   DQESECT+8                                                01387000
DQELNTH  EQU   DQESECT+12                                               01388000
FQESECT  EQU   0                                                        01389000
FQEPTR   EQU   FQESECT                                                  01390000
FQTYPE   EQU   FQEPTR                                                   01391000
FQELNTH  EQU   FQESECT+4                                                01392000
TCBFIX   EQU   0                                                        01393000
TCBFRS   EQU   TCBFIX                                                   01394000
TCB      EQU   0                                                        01395000
TCBPIE   EQU   TCB+4                                                    01396000
TCBPMASK EQU   TCBPIE                                                   01397000
TCBCMP   EQU   TCB+16                                                   01398000
TCBCMPF  EQU   TCBCMP                                                   01399000
TCBCPP   EQU   TCBCMPF                                                  01400000
TCBSTCC  EQU   TCBCMPF                                                  01401000
TCBCDBL  EQU   TCBCMPF                                                  01402000
TCBCWTO  EQU   TCBCMPF                                                  01403000
TCBCIND  EQU   TCBCMPF                                                  01404000
TCBCMSG  EQU   TCBCMPF                                                  01405000
TCBTRN   EQU   TCB+20                                                   01406000
TCBABF   EQU   TCBTRN                                                   01407000
TCBMSS   EQU   TCB+24                                                   01408000
TCBMSSB  EQU   TCBMSS+1                                                 01409000
TCBPKF   EQU   TCB+28                                                   01410000
TCBFLGS  EQU   TCB+29                                                   01411000
TCBFLGS1 EQU   TCBFLGS                                                  01412000
TCBFLGS2 EQU   TCBFLGS+1                                                01413000
TCBFETXR EQU   TCBFLGS2                                                 01414000
TCBFLGS3 EQU   TCBFLGS+2                                                01415000
TCBFLGS4 EQU   TCBFLGS+3                                                01416000
TCBFLGS5 EQU   TCBFLGS+4                                                01417000
TCBABWF  EQU   TCBFLGS5                                                 01418000
TCBJPQ   EQU   TCB+44                                                   01419000
TCBPURGE EQU   TCBJPQ                                                   01420000
TCBGRS   EQU   TCB+48                                                   01421000
TCBFSA   EQU   TCB+112                                                  01422000
TCBFSAB  EQU   TCBFSA+1                                                 01423000
TCBTME   EQU   TCB+120                                                  01424000
TCBJSTCB EQU   TCB+124                                                  01425000
TCBECB   EQU   TCB+144                                                  01426000
TCBTSFLG EQU   TCB+148                                                  01427000
TCBTSTSK EQU   TCBTSFLG                                                 01428000
TCBAQE   EQU   TCB+156                                                  01429000
TCBSTAB  EQU   TCB+160                                                  01430000
TCBNSTAE EQU   TCBSTAB                                                  01431000
TCBTCT   EQU   TCB+164                                                  01432000
TCBTCTGF EQU   TCBTCT                                                   01433000
TCBSCNDY EQU   TCB+172                                                  01434000
TCBNDSP  EQU   TCBSCNDY                                                 01435000
TCBNDSP1 EQU   TCBNDSP+1                                                01436000
TCBNDSP2 EQU   TCBNDSP+2                                                01437000
TCBNDSP3 EQU   TCBNDSP+3                                                01438000
TCBJSCB  EQU   TCB+180                                                  01439000
TCBRECDE EQU   TCBJSCB                                                  01440000
TCBEXT1  EQU   TCB+196                                                  01441000
TCBBITS  EQU   TCB+200                                                  01442000
TCBNDSP4 EQU   TCBBITS                                                  01443000
TCBNDSP5 EQU   TCBBITS+1                                                01444000
TCBFLGS6 EQU   TCBBITS+2                                                01445000
TCBFLGS7 EQU   TCBBITS+3                                                01446000
TCBDAR   EQU   TCB+204                                                  01447000
TCBDARC  EQU   TCBDAR                                                   01448000
TCBEXT2  EQU   TCB+208                                                  01449000
TCBFOE   EQU   TCB+244                                                  01450000
TCBSWA   EQU   TCB+248                                                  01451000
TCBESTAE EQU   TCB+264                                                  01452000
TCBESTRM EQU   TCBESTAE+1                                               01453000
TCBUKYSP EQU   TCB+268                                                  01454000
TCBFBYT1 EQU   TCB+276                                                  01455000
TCBFBYT2 EQU   TCB+277                                                  01456000
TCBRV124 EQU   TCB+278                                                  01457000
TCBRV133 EQU   TCB+279                                                  01458000
TCBXTNT2 EQU   0                                                        01459000
TCBGTF   EQU   TCBXTNT2                                                 01460000
TCBTFLG  EQU   TCBGTF                                                   01461000
TCBRV146 EQU   TCBXTNT2+28                                              01462000
TCBRV155 EQU   TCBXTNT2+29                                              01463000
TCBRV164 EQU   TCBXTNT2+30                                              01464000
TCBRV173 EQU   TCBXTNT2+31                                              01465000
ASCB     EQU   0                                                        01466000
ASCBASID EQU   ASCB+36                                                  01467000
ASCBLDA  EQU   ASCB+48                                                  01468000
ASCBFW1  EQU   ASCB+100                                                 01469000
ASCBRCTF EQU   ASCBFW1+2                                                01470000
ASCBFLG1 EQU   ASCBFW1+3                                                01471000
ASCBASXB EQU   ASCB+108                                                 01472000
ASCBDSP1 EQU   ASCB+114                                                 01473000
ASCBFLG2 EQU   ASCB+115                                                 01474000
ASXB     EQU   0                                                        01475000
ASXBAEQ  EQU   ASXB+168                                                 01476000
VRWPQEL  EQU   0                                                        01477000
WPNEXTEL EQU   VRWPQEL                                                  01478000
WPPREVEL EQU   VRWPQEL+4                                                01479000
WPELASCB EQU   VRWPQEL+16                                               01480000
WPSPADDR EQU   VRWPQEL+24                                               01481000
CVTMAP   EQU   0                                                        01482000
CVTDAR   EQU   CVTMAP+72                                                01483000
CVTFLGS1 EQU   CVTDAR                                                   01484000
CVTDCB   EQU   CVTMAP+116                                               01485000
CVTIERLC EQU   CVTMAP+144                                               01486000
CVTOPTA  EQU   CVTMAP+182                                               01487000
CVTOPTB  EQU   CVTMAP+183                                               01488000
CVTGTF   EQU   CVTMAP+236                                               01489000
CVTGTFST EQU   CVTGTF                                                   01490000
CVTGTFS  EQU   CVTGTFST                                                 01491000
CVTSTATE EQU   CVTGTFST                                                 01492000
CVTTMODE EQU   CVTGTFST                                                 01493000
CVTFORM  EQU   CVTGTFST                                                 01494000
CVTAQAVT EQU   CVTMAP+240                                               01495000
CVTTCMFG EQU   CVTAQAVT                                                 01496000
CVTVOLM2 EQU   CVTMAP+244                                               01497000
CVTTATA  EQU   CVTVOLM2                                                 01498000
CVTTSKS  EQU   CVTTATA                                                  01499000
CVTVOLF2 EQU   CVTTSKS                                                  01500000
CVTTAT   EQU   CVTTATA+1                                                01501000
CVTATER  EQU   CVTMAP+248                                               01502000
CVTEXT1  EQU   CVTMAP+252                                               01503000
CVTPURG  EQU   CVTMAP+260                                               01504000
CVTQMSG  EQU   CVTMAP+268                                               01505000
CVTDMSR  EQU   CVTMAP+272                                               01506000
CVTERPV  EQU   CVTMAP+316                                               01507000
CVTINTLA EQU   CVTMAP+320                                               01508000
CVTAPF   EQU   CVTMAP+324                                               01509000
CVTEXT2  EQU   CVTMAP+328                                               01510000
CVTHJES  EQU   CVTMAP+332                                               01511000
CVTPGSIA EQU   CVTMAP+348                                               01512000
CVTA1F1  EQU   CVTMAP+356                                               01513000
CVTSYSK  EQU   CVTMAP+357                                               01514000
CVTVOLM1 EQU   CVTMAP+380                                               01515000
CVTVOLF1 EQU   CVTVOLM1                                                 01516000
CVTATMCT EQU   CVTMAP+388                                               01517000
CVTXTNT1 EQU   0                                                        01518000
CVTXTNT2 EQU   0                                                        01519000
CVTDSSV  EQU   CVTXTNT2                                                 01520000
CVTFLGBT EQU   CVTXTNT2+5                                               01521000
CVTQID   EQU   CVTXTNT2+24                                              01522000
CVTRV400 EQU   CVTXTNT2+52                                              01523000
CVTRV409 EQU   CVTXTNT2+53                                              01524000
CVTATCVT EQU   CVTXTNT2+64                                              01525000
CVTRV429 EQU   CVTXTNT2+84                                              01526000
CVTRV438 EQU   CVTXTNT2+85                                              01527000
CVTRV457 EQU   CVTXTNT2+112                                             01528000
CVTRV466 EQU   CVTXTNT2+113                                             01529000
CVTFIX   EQU   0                                                        01530000
CVTRELNO EQU   CVTFIX+252                                               01531000
FRRS     EQU   0                                                        01532000
FRRSHEAD EQU   FRRS                                                     01533000
FRRSENTR EQU   0                                                        01534000
FRRSFLGS EQU   FRRSENTR+4                                               01535000
FRRSFLG1 EQU   FRRSFLGS                                                 01536000
SCVTSECT EQU   0                                                        01537000
SCVTRMBR EQU   SCVTSECT+28                                              01538000
PSARSVTE EQU   PSARSVT                                                  01539000
PSACSTK  EQU   PSARSVTE                                                 01540000
FRRSPTR  EQU   PSACSTK                                                  01541000
CVTS01   EQU   CVTPGSIA                                                 01542000
CVTLPDIA EQU   CVTS01+12                                                01543000
CVTDIRST EQU   CVTLPDIA                                                 01544000
CVTSLIDA EQU   CVTS01+24                                                01545000
CVTCTLFG EQU   CVTS01+50                                                01546000
CVTCRMN  EQU   CVTS01+156                                               01547000
CVTGDA   EQU   CVTS01+212                                               01548000
CVTRV210 EQU   CVTS01+424                                               01549000
CVTRV219 EQU   CVTS01+425                                               01550000
CVTRV228 EQU   CVTS01+426                                               01551000
CVTRV237 EQU   CVTS01+427                                               01552000
CVTMFRTR EQU   CVTS01+452                                               01553000
CVTRV262 EQU   CVTS01+468                                               01554000
CVTRV271 EQU   CVTS01+469                                               01555000
CVTRV280 EQU   CVTS01+470                                               01556000
CVTRV289 EQU   CVTS01+471                                               01557000
CVTGSDA  EQU   CVTS01+600                                               01558000
FLC      EQU   PSA                                                      01559000
*                                      START UNREFERENCED COMPONENTS    01560000
CVTRV628 EQU   CVTS01+728                                               01561000
CVTRV627 EQU   CVTS01+724                                               01562000
CVTRV626 EQU   CVTS01+720                                               01563000
CVTRV625 EQU   CVTS01+716                                               01564000
CVTRV624 EQU   CVTS01+712                                               01565000
CVTRV623 EQU   CVTS01+708                                               01566000
CVTRV622 EQU   CVTS01+704                                               01567000
CVTRV621 EQU   CVTS01+700                                               01568000
CVTRV620 EQU   CVTS01+696                                               01569000
CVTRV619 EQU   CVTS01+692                                               01570000
CVTRV618 EQU   CVTS01+688                                               01571000
CVTRV617 EQU   CVTS01+684                                               01572000
CVTRV616 EQU   CVTS01+680                                               01573000
CVTRV615 EQU   CVTS01+676                                               01574000
CVTRV614 EQU   CVTS01+672                                               01575000
CVTRV613 EQU   CVTS01+668                                               01576000
CVTRV612 EQU   CVTS01+664                                               01577000
CVTRV611 EQU   CVTS01+660                                               01578000
CVTRV610 EQU   CVTS01+656                                               01579000
CVTRV609 EQU   CVTS01+652                                               01580000
CVTRV608 EQU   CVTS01+648                                               01581000
CVTRV607 EQU   CVTS01+644                                               01582000
CVTRV606 EQU   CVTS01+640                                               01583000
CVTRV605 EQU   CVTS01+636                                               01584000
CVTRV604 EQU   CVTS01+632                                               01585000
CVTEFF02 EQU   CVTS01+628                                               01586000
CVTCBBR  EQU   CVTS01+624                                               01587000
CVTSSCR  EQU   CVTS01+620                                               01588000
CVTEVENT EQU   CVTS01+616                                               01589000
CVTCRCA  EQU   CVTS01+612                                               01590000
CVTTPIO  EQU   CVTS01+608                                               01591000
CVTADV   EQU   CVTS01+604                                               01592000
CVTGSDAB EQU   CVTGSDA                                                  01593000
CVTQV3   EQU   CVTS01+596                                               01594000
CVTQV2   EQU   CVTS01+592                                               01595000
CVTQV1   EQU   CVTS01+588                                               01596000
CVTRPT   EQU   CVTS01+584                                               01597000
CVTSSRB  EQU   CVTS01+580                                               01598000
CVTCSDRL EQU   CVTS01+576                                               01599000
CVTEXP1  EQU   CVTS01+572                                               01600000
CVTRMPMT EQU   CVTS01+568                                               01601000
CVTRMPTT EQU   CVTS01+564                                               01602000
CVTVPSA  EQU   CVTS01+560                                               01603000
CVTVSTOP EQU   CVTS01+556                                               01604000
CVTGTFR8 EQU   CVTS01+552                                               01605000
CVTQUIT  EQU   CVTS01+548                                               01606000
CVTVACR  EQU   CVTS01+544                                               01607000
CVTWTCB  EQU   CVTS01+540                                               01608000
CVTSTPRS EQU   CVTS01+536                                               01609000
CVT0PT02 EQU   CVTS01+532                                               01610000
CVTDARCM EQU   CVTS01+528                                               01611000
CVTIRECM EQU   CVTS01+524                                               01612000
CVTJRECM EQU   CVTS01+520                                               01613000
CVTVEMS0 EQU   CVTS01+516                                               01614000
CVTSPFRR EQU   CVTS01+512                                               01615000
CVTRLSTG EQU   CVTS01+508                                               01616000
CVT0TC0A EQU   CVTS01+504                                               01617000
CVTGMBR  EQU   CVTS01+500                                               01618000
CVTLFRM  EQU   CVTS01+496                                               01619000
CVTRMBR  EQU   CVTS01+492                                               01620000
CVTVIOP  EQU   CVTS01+488                                               01621000
CVTRV307 EQU   CVTS01+486                                               01622000
CVTRV306 EQU   CVTS01+484                                               01623000
CVTRV305 EQU   CVTS01+482                                               01624000
CVTRV304 EQU   CVTS01+480                                               01625000
CVTRV303 EQU   CVTS01+478                                               01626000
CVTRV302 EQU   CVTS01+476                                               01627000
CVTTRCA  EQU   CVTS01+472                                               01628000
CVTRV297 EQU   CVTRV289                                                 01629000
CVTRV296 EQU   CVTRV289                                                 01630000
CVTRV295 EQU   CVTRV289                                                 01631000
CVTRV294 EQU   CVTRV289                                                 01632000
CVTRV293 EQU   CVTRV289                                                 01633000
CVTRV292 EQU   CVTRV289                                                 01634000
CVTRV291 EQU   CVTRV289                                                 01635000
CVTRV290 EQU   CVTRV289                                                 01636000
CVTRV288 EQU   CVTRV280                                                 01637000
CVTRV287 EQU   CVTRV280                                                 01638000
CVTRV286 EQU   CVTRV280                                                 01639000
CVTRV285 EQU   CVTRV280                                                 01640000
CVTRV284 EQU   CVTRV280                                                 01641000
CVTRV283 EQU   CVTRV280                                                 01642000
CVTRV282 EQU   CVTRV280                                                 01643000
CVTRV281 EQU   CVTRV280                                                 01644000
CVTRV279 EQU   CVTRV271                                                 01645000
CVTRV278 EQU   CVTRV271                                                 01646000
CVTRV277 EQU   CVTRV271                                                 01647000
CVTRV276 EQU   CVTRV271                                                 01648000
CVTRV275 EQU   CVTRV271                                                 01649000
CVTRV274 EQU   CVTRV271                                                 01650000
CVTRV273 EQU   CVTRV271                                                 01651000
CVTRV272 EQU   CVTRV271                                                 01652000
CVTRV270 EQU   CVTRV262                                                 01653000
CVTRV269 EQU   CVTRV262                                                 01654000
CVTRV268 EQU   CVTRV262                                                 01655000
CVTRV267 EQU   CVTRV262                                                 01656000
CVTRV266 EQU   CVTRV262                                                 01657000
CVTRV265 EQU   CVTRV262                                                 01658000
CVTRV264 EQU   CVTRV262                                                 01659000
CVTRV263 EQU   CVTRV262                                                 01660000
CVTVFP   EQU   CVTS01+464                                               01661000
CVTVSI   EQU   CVTS01+460                                               01662000
CVTVPSIB EQU   CVTS01+456                                               01663000
CVTMFACT EQU   CVTMFRTR                                                 01664000
CVTMFCTL EQU   CVTS01+448                                               01665000
CVTPVBP  EQU   CVTS01+444                                               01666000
CVTPWI   EQU   CVTS01+440                                               01667000
CVTRV254 EQU   CVTS01+438                                               01668000
CVTRV253 EQU   CVTS01+436                                               01669000
CVTRV252 EQU   CVTS01+434                                               01670000
CVTRV251 EQU   CVTS01+433                                               01671000
CVTRV250 EQU   CVTS01+432                                               01672000
CVTRV249 EQU   CVTS01+431                                               01673000
CVTRV248 EQU   CVTS01+430                                               01674000
CVTRV247 EQU   CVTS01+429                                               01675000
CVTRV246 EQU   CVTS01+428                                               01676000
CVTRV245 EQU   CVTRV237                                                 01677000
CVTRV244 EQU   CVTRV237                                                 01678000
CVTRV243 EQU   CVTRV237                                                 01679000
CVTRV242 EQU   CVTRV237                                                 01680000
CVTRV241 EQU   CVTRV237                                                 01681000
CVTRV240 EQU   CVTRV237                                                 01682000
CVTRV239 EQU   CVTRV237                                                 01683000
CVTRV238 EQU   CVTRV237                                                 01684000
CVTRV236 EQU   CVTRV228                                                 01685000
CVTRV235 EQU   CVTRV228                                                 01686000
CVTRV234 EQU   CVTRV228                                                 01687000
CVTRV233 EQU   CVTRV228                                                 01688000
CVTRV232 EQU   CVTRV228                                                 01689000
CVTRV231 EQU   CVTRV228                                                 01690000
CVTRV230 EQU   CVTRV228                                                 01691000
CVTRV229 EQU   CVTRV228                                                 01692000
CVTRV227 EQU   CVTRV219                                                 01693000
CVTRV226 EQU   CVTRV219                                                 01694000
CVTRV225 EQU   CVTRV219                                                 01695000
CVTRV224 EQU   CVTRV219                                                 01696000
CVTRV223 EQU   CVTRV219                                                 01697000
CVTRV222 EQU   CVTRV219                                                 01698000
CVTRV221 EQU   CVTRV219                                                 01699000
CVTRV220 EQU   CVTRV219                                                 01700000
CVTRV218 EQU   CVTRV210                                                 01701000
CVTRV217 EQU   CVTRV210                                                 01702000
CVTRV216 EQU   CVTRV210                                                 01703000
CVTRV215 EQU   CVTRV210                                                 01704000
CVTRV214 EQU   CVTRV210                                                 01705000
CVTRV213 EQU   CVTRV210                                                 01706000
CVTRV212 EQU   CVTRV210                                                 01707000
CVTRV211 EQU   CVTRV210                                                 01708000
CVTLCCAT EQU   CVTS01+420                                               01709000
CVTPCCAT EQU   CVTS01+416                                               01710000
CVTIPCRP EQU   CVTS01+412                                               01711000
CVTIPCRI EQU   CVTS01+408                                               01712000
CVTIPCDS EQU   CVTS01+404                                               01713000
CVTAIDVT EQU   CVTS01+400                                               01714000
CVTSSAP  EQU   CVTS01+396                                               01715000
CVTEHCIR EQU   CVTS01+392                                               01716000
CVTEHDEF EQU   CVTS01+388                                               01717000
CVTDAIR  EQU   CVTS01+384                                               01718000
CVTPERFM EQU   CVTS01+380                                               01719000
CVT044R2 EQU   CVTS01+376                                               01720000
CVTFETCH EQU   CVTS01+372                                               01721000
CVTRSTWD EQU   CVTS01+368                                               01722000
CVTSPOST EQU   CVTS01+364                                               01723000
CVTIOBP  EQU   CVTS01+360                                               01724000
CVTASMVT EQU   CVTS01+356                                               01725000
CVTRECRQ EQU   CVTS01+352                                               01726000
CVTWSAC  EQU   CVTS01+348                                               01727000
CVTRV149 EQU   CVTS01+344                                               01728000
CVTWSAL  EQU   CVTS01+340                                               01729000
CVTSPSA  EQU   CVTS01+336                                               01730000
CVTGLMN  EQU   CVTS01+332                                               01731000
CVTVEAC0 EQU   CVTS01+328                                               01732000
CVT062R1 EQU   CVTS01+324                                               01733000
CVTRPOST EQU   CVTS01+320                                               01734000
CVTDQIQE EQU   CVTS01+316                                               01735000
CVTCSD   EQU   CVTS01+312                                               01736000
CVTLKRMA EQU   CVTS01+308                                               01737000
CVTRSPIE EQU   CVTS01+304                                               01738000
CVTRENQ  EQU   CVTS01+300                                               01739000
CVTLQCB  EQU   CVTS01+296                                               01740000
CVTFQCB  EQU   CVTS01+292                                               01741000
CVTQCS01 EQU   CVTS01+288                                               01742000
CVTAPFT  EQU   CVTS01+284                                               01743000
CVTPARRL EQU   CVTS01+280                                               01744000
CVTVWAIT EQU   CVTS01+276                                               01745000
CVTGSPL  EQU   CVTS01+272                                               01746000
CVTLSMQ  EQU   CVTS01+268                                               01747000
CVTGSMQ  EQU   CVTS01+264                                               01748000
CVTEXPRO EQU   CVTS01+260                                               01749000
CVTOPCTP EQU   CVTS01+256                                               01750000
CVTSIC   EQU   CVTS01+252                                               01751000
CVTTPIOS EQU   CVTS01+248                                               01752000
CVTRTMS  EQU   CVTS01+244                                               01753000
CVTSDBF  EQU   CVTS01+240                                               01754000
CVTSCBP  EQU   CVTS01+236                                               01755000
CVTSDMP  EQU   CVTS01+232                                               01756000
CVTSV60  EQU   CVTS01+228                                               01757000
CVTRTMCT EQU   CVTS01+224                                               01758000
CVTASCBL EQU   CVTS01+220                                               01759000
CVTASCBH EQU   CVTS01+216                                               01760000
CVTASVT  EQU   CVTS01+208                                               01761000
CVTVVMDI EQU   CVTS01+204                                               01762000
CVTAQTOP EQU   CVTS01+200                                               01763000
CVTIOSCS EQU   CVTS01+196                                               01764000
CVTSDRM  EQU   CVTS01+192                                               01765000
CVTOPTE  EQU   CVTS01+188                                               01766000
CVTSTXU  EQU   CVTS01+184                                               01767000
CVTQUIS  EQU   CVTS01+180                                               01768000
CVTPARS  EQU   CVTS01+176                                               01769000
CVTS1EE  EQU   CVTS01+172                                               01770000
CVTFRAS  EQU   CVTS01+168                                               01771000
CVTQSAS  EQU   CVTS01+164                                               01772000
CVTCRAS  EQU   CVTS01+160                                               01773000
CVTDELCP EQU   CVTS01+152                                               01774000
CVTFRECL EQU   CVTS01+148                                               01775000
CVTGETCL EQU   CVTS01+144                                               01776000
CVTBLDCP EQU   CVTS01+140                                               01777000
CVTAUTHL EQU   CVTS01+136                                               01778000
CVTSCAN  EQU   CVTS01+132                                               01779000
CVTRV144 EQU   CVTS01+130                                               01780000
CVTMAXMP EQU   CVTS01+128                                               01781000
CVTSTCK  EQU   CVTS01+124                                               01782000
CVTRV139 EQU   CVTS01+123                                               01783000
CVTDSSAC EQU   CVTS01+122                                               01784000
CVTRV513 EQU   CVTS01+121                                               01785000
CVTIOSPL EQU   CVTS01+120                                               01786000
CVTPTGT  EQU   CVTS01+116                                               01787000
CVTCSPIE EQU   CVTS01+112                                               01788000
CVTSMFEX EQU   CVTS01+108                                               01789000
CVTOLT0A EQU   CVTS01+104                                               01790000
CVTSRBRT EQU   CVTS01+100                                               01791000
CVTPUTL  EQU   CVTS01+96                                                01792000
CVTRV519 EQU   CVTS01+92                                                01793000
CVTRV327 EQU   CVTS01+88                                                01794000
CVTRV326 EQU   CVTS01+84                                                01795000
CVTRV325 EQU   CVTS01+80                                                01796000
CVTRV324 EQU   CVTS01+76                                                01797000
CVT0VL01 EQU   CVTS01+72                                                01798000
CVTSHRVM EQU   CVTS01+68                                                01799000
CVTRV332 EQU   CVTS01+64                                                01800000
CVTTAS   EQU   CVTS01+60                                                01801000
CVTRSCN  EQU   CVTS01+56                                                01802000
CVTTRAC2 EQU   CVTS01+54                                                01803000
CVTTRACE EQU   CVTS01+52                                                01804000
CVTAPG   EQU   CVTS01+51                                                01805000
CVTSDTRC EQU   CVTCTLFG                                                 01806000
CVTGTRCE EQU   CVTCTLFG                                                 01807000
CVTNOMP  EQU   CVTCTLFG                                                 01808000
CVTRSV79 EQU   CVTCTLFG                                                 01809000
CVTDSTAT EQU   CVTCTLFG                                                 01810000
CVTRSV78 EQU   CVTCTLFG                                                 01811000
CVTRV333 EQU   CVTCTLFG                                                 01812000
CVTRV323 EQU   CVTCTLFG                                                 01813000
CVTSPVLK EQU   CVTS01+49                                                01814000
CVTRSV77 EQU   CVTS01+48                                                01815000
CVTRV331 EQU   CVTS01+44                                                01816000
CVTRV330 EQU   CVTS01+40                                                01817000
CVTRV329 EQU   CVTS01+36                                                01818000
CVTRV328 EQU   CVTS01+32                                                01819000
CVTRV322 EQU   CVTS01+28                                                01820000
CVTSLID  EQU   CVTSLIDA+1                                               01821000
CVTSYLK  EQU   CVTSLIDA                                                 01822000
CVTRV321 EQU   CVTS01+20                                                01823000
CVTRV320 EQU   CVTS01+16                                                01824000
CVTLPDIR EQU   CVTLPDIA+1                                               01825000
CVTRSV69 EQU   CVTDIRST                                                 01826000
CVTRSV68 EQU   CVTDIRST                                                 01827000
CVTRSV67 EQU   CVTDIRST                                                 01828000
CVTRSV66 EQU   CVTDIRST                                                 01829000
CVTRSV65 EQU   CVTDIRST                                                 01830000
CVTRSV64 EQU   CVTDIRST                                                 01831000
CVTRSV63 EQU   CVTDIRST                                                 01832000
CVTDICOM EQU   CVTDIRST                                                 01833000
CVTPVTP  EQU   CVTS01+8                                                 01834000
CVTLPDSR EQU   CVTS01+4                                                 01835000
CVTGETL  EQU   CVTS01                                                   01836000
PSARSAV  EQU   PSARSVTE+60                                              01837000
PSARSTK  EQU   PSARSVTE+56                                              01838000
PSAESAV3 EQU   PSARSVTE+52                                              01839000
PSAESTK3 EQU   PSARSVTE+48                                              01840000
PSAESAV2 EQU   PSARSVTE+44                                              01841000
PSAESTK2 EQU   PSARSVTE+40                                              01842000
PSAESAV1 EQU   PSARSVTE+36                                              01843000
PSAESTK1 EQU   PSARSVTE+32                                              01844000
PSAPSAV  EQU   PSARSVTE+28                                              01845000
PSAPSTK  EQU   PSARSVTE+24                                              01846000
PSAMSAV  EQU   PSARSVTE+20                                              01847000
PSAMSTK  EQU   PSARSVTE+16                                              01848000
PSASSAV  EQU   PSARSVTE+12                                              01849000
PSASSTK  EQU   PSARSVTE+8                                               01850000
PSANSTK  EQU   PSARSVTE+4                                               01851000
@NM00066 EQU   SCVTSECT+180                                             01852000
@NM00065 EQU   SCVTSECT+176                                             01853000
SCVTPIQE EQU   SCVTSECT+172                                             01854000
@NM00064 EQU   SCVTSECT+168                                             01855000
SCVTPTRM EQU   SCVTSECT+164                                             01856000
@NM00063 EQU   SCVTSECT+160                                             01857000
@NM00062 EQU   SCVTSECT+156                                             01858000
SCVTQCBR EQU   SCVTSECT+152                                             01859000
SCVTSTAT EQU   SCVTSECT+148                                             01860000
@NM00061 EQU   SCVTSECT+144                                             01861000
SCVTTQE  EQU   SCVTSECT+140                                             01862000
@NM00060 EQU   SCVTSECT+136                                             01863000
SCVTSVCT EQU   SCVTSECT+132                                             01864000
@NM00059 EQU   SCVTSECT+128                                             01865000
@NM00058 EQU   SCVTSECT+124                                             01866000
SCVTRXLQ EQU   SCVTSECT+120                                             01867000
@NM00057 EQU   SCVTSECT+116                                             01868000
SCVTCTCB EQU   SCVTSECT+112                                             01869000
@NM00056 EQU   SCVTSECT+108                                             01870000
@NM00055 EQU   SCVTSECT+104                                             01871000
@NM00054 EQU   SCVTSECT+100                                             01872000
@NM00053 EQU   SCVTSECT+96                                              01873000
SCVTCOMM EQU   SCVTSECT+92                                              01874000
@NM00052 EQU   SCVTSECT+88                                              01875000
@NM00051 EQU   SCVTSECT+84                                              01876000
@NM00050 EQU   SCVTSECT+80                                              01877000
@NM00049 EQU   SCVTSECT+76                                              01878000
@NM00048 EQU   SCVTSECT+72                                              01879000
SCVTGMBR EQU   SCVTSECT+68                                              01880000
SCVTRPTR EQU   SCVTSECT+64                                              01881000
SCVTHSKP EQU   SCVTSECT+60                                              01882000
@NM00047 EQU   SCVTSECT+56                                              01883000
@NM00046 EQU   SCVTSECT+52                                              01884000
SCVTLFRM EQU   SCVTSECT+48                                              01885000
SCVTCDCL EQU   SCVTSECT+44                                              01886000
@NM00045 EQU   SCVTSECT+40                                              01887000
SCVTRACE EQU   SCVTSECT+36                                              01888000
@NM00044 EQU   SCVTSECT+32                                              01889000
@NM00043 EQU   SCVTSECT+24                                              01890000
@NM00042 EQU   SCVTSECT+20                                              01891000
@NM00041 EQU   SCVTSECT+16                                              01892000
@NM00040 EQU   SCVTSECT+14                                              01893000
SCVTBR14 EQU   SCVTSECT+12                                              01894000
SCVTSPET EQU   SCVTSECT+8                                               01895000
SCVTPGWR EQU   SCVTSECT+4                                               01896000
SCVTPGTM EQU   SCVTSECT                                                 01897000
FRRSPARM EQU   FRRSENTR+8                                               01898000
@NM00039 EQU   FRRSFLGS+1                                               01899000
@NM00038 EQU   FRRSFLG1                                                 01900000
FRRSNEST EQU   FRRSFLG1                                                 01901000
FRRSRCUR EQU   FRRSFLG1                                                 01902000
FRRSFRRA EQU   FRRSENTR                                                 01903000
FRRSENTS EQU   FRRS+84                                                  01904000
FRRSRTMW EQU   FRRS+16                                                  01905000
FRRSCURR EQU   FRRSHEAD+12                                              01906000
FRRSELEN EQU   FRRSHEAD+8                                               01907000
FRRSLAST EQU   FRRSHEAD+4                                               01908000
FRRSEMP  EQU   FRRSHEAD                                                 01909000
CVTLEVL  EQU   CVTRELNO+2                                               01910000
CVTNUMB  EQU   CVTRELNO                                                 01911000
CVTMDL   EQU   CVTFIX+250                                               01912000
@NM00037 EQU   CVTFIX+248                                               01913000
@NM00036 EQU   CVTFIX                                                   01914000
CVTRV482 EQU   CVTXTNT2+128                                             01915000
CVTRV481 EQU   CVTXTNT2+124                                             01916000
CVTRV480 EQU   CVTXTNT2+120                                             01917000
CVTRV479 EQU   CVTXTNT2+118                                             01918000
CVTRV478 EQU   CVTXTNT2+117                                             01919000
CVTRV477 EQU   CVTXTNT2+116                                             01920000
CVTRV476 EQU   CVTXTNT2+115                                             01921000
CVTRV475 EQU   CVTXTNT2+114                                             01922000
CVTRV474 EQU   CVTRV466                                                 01923000
CVTRV473 EQU   CVTRV466                                                 01924000
CVTRV472 EQU   CVTRV466                                                 01925000
CVTRV471 EQU   CVTRV466                                                 01926000
CVTRV470 EQU   CVTRV466                                                 01927000
CVTRV469 EQU   CVTRV466                                                 01928000
CVTRV468 EQU   CVTRV466                                                 01929000
CVTRV467 EQU   CVTRV466                                                 01930000
CVTRV465 EQU   CVTRV457                                                 01931000
CVTRV464 EQU   CVTRV457                                                 01932000
CVTRV463 EQU   CVTRV457                                                 01933000
CVTRV462 EQU   CVTRV457                                                 01934000
CVTRV461 EQU   CVTRV457                                                 01935000
CVTRV460 EQU   CVTRV457                                                 01936000
CVTRV459 EQU   CVTRV457                                                 01937000
CVTRV458 EQU   CVTRV457                                                 01938000
CVTRV456 EQU   CVTXTNT2+108                                             01939000
CVTRV455 EQU   CVTXTNT2+104                                             01940000
CVTRV454 EQU   CVTXTNT2+100                                             01941000
CVTRV453 EQU   CVTXTNT2+96                                              01942000
CVTRV452 EQU   CVTXTNT2+94                                              01943000
CVTRV451 EQU   CVTXTNT2+92                                              01944000
CVTRV450 EQU   CVTXTNT2+90                                              01945000
CVTRV449 EQU   CVTXTNT2+88                                              01946000
CVTRV448 EQU   CVTXTNT2+87                                              01947000
CVTRV447 EQU   CVTXTNT2+86                                              01948000
CVTRV446 EQU   CVTRV438                                                 01949000
CVTRV445 EQU   CVTRV438                                                 01950000
CVTRV444 EQU   CVTRV438                                                 01951000
CVTRV443 EQU   CVTRV438                                                 01952000
CVTRV442 EQU   CVTRV438                                                 01953000
CVTRV441 EQU   CVTRV438                                                 01954000
CVTRV440 EQU   CVTRV438                                                 01955000
CVTRV439 EQU   CVTRV438                                                 01956000
CVTRV437 EQU   CVTRV429                                                 01957000
CVTRV436 EQU   CVTRV429                                                 01958000
CVTRV435 EQU   CVTRV429                                                 01959000
CVTRV434 EQU   CVTRV429                                                 01960000
CVTRV433 EQU   CVTRV429                                                 01961000
CVTRV432 EQU   CVTRV429                                                 01962000
CVTRV431 EQU   CVTRV429                                                 01963000
CVTRV430 EQU   CVTRV429                                                 01964000
CVTRV428 EQU   CVTXTNT2+80                                              01965000
CVTRV427 EQU   CVTXTNT2+76                                              01966000
CVTRV426 EQU   CVTXTNT2+72                                              01967000
CVTRV425 EQU   CVTXTNT2+68                                              01968000
CVTATACT EQU   CVTATCVT                                                 01969000
CVTRV423 EQU   CVTXTNT2+62                                              01970000
CVTRV422 EQU   CVTXTNT2+60                                              01971000
CVTRV421 EQU   CVTXTNT2+58                                              01972000
CVTRV420 EQU   CVTXTNT2+56                                              01973000
CVTRV419 EQU   CVTXTNT2+55                                              01974000
CVTRV418 EQU   CVTXTNT2+54                                              01975000
CVTRV417 EQU   CVTRV409                                                 01976000
CVTRV416 EQU   CVTRV409                                                 01977000
CVTRV415 EQU   CVTRV409                                                 01978000
CVTRV414 EQU   CVTRV409                                                 01979000
CVTRV413 EQU   CVTRV409                                                 01980000
CVTRV412 EQU   CVTRV409                                                 01981000
CVTRV411 EQU   CVTRV409                                                 01982000
CVTRV410 EQU   CVTRV409                                                 01983000
CVTRV408 EQU   CVTRV400                                                 01984000
CVTRV407 EQU   CVTRV400                                                 01985000
CVTRV406 EQU   CVTRV400                                                 01986000
CVTRV405 EQU   CVTRV400                                                 01987000
CVTRV404 EQU   CVTRV400                                                 01988000
CVTRV403 EQU   CVTRV400                                                 01989000
CVTRV402 EQU   CVTRV400                                                 01990000
CVTRV401 EQU   CVTRV400                                                 01991000
CVTICB   EQU   CVTXTNT2+48                                              01992000
CVTSKTA  EQU   CVTXTNT2+44                                              01993000
CVTRSV99 EQU   CVTXTNT2+40                                              01994000
CVTRSV98 EQU   CVTXTNT2+36                                              01995000
CVTRSV97 EQU   CVTXTNT2+34                                              01996000
CVTRSV96 EQU   CVTXTNT2+32                                              01997000
CVTOLTEP EQU   CVTXTNT2+28                                              01998000
CVTQIDA  EQU   CVTQID+1                                                 01999000
CVTRSV95 EQU   CVTQID                                                   02000000
CVTRSV94 EQU   CVTXTNT2+20                                              02001000
CVTRSV93 EQU   CVTXTNT2+16                                              02002000
CVTRSV92 EQU   CVTXTNT2+12                                              02003000
CVTDEBVR EQU   CVTXTNT2+8                                               02004000
CVTRSV91 EQU   CVTXTNT2+6                                               02005000
CVTRSV9H EQU   CVTFLGBT                                                 02006000
CVTRSV9G EQU   CVTFLGBT                                                 02007000
CVTRSV9F EQU   CVTFLGBT                                                 02008000
CVTRSV9E EQU   CVTFLGBT                                                 02009000
CVTRSV9D EQU   CVTFLGBT                                                 02010000
CVTRSV9C EQU   CVTFLGBT                                                 02011000
CVTVME   EQU   CVTFLGBT                                                 02012000
CVTNPE   EQU   CVTFLGBT                                                 02013000
CVTNUCLS EQU   CVTXTNT2+4                                               02014000
CVTDSSVA EQU   CVTDSSV+1                                                02015000
CVTRSV89 EQU   CVTDSSV                                                  02016000
CVTRSV88 EQU   CVTXTNT1+8                                               02017000
CVTRSV87 EQU   CVTXTNT1+4                                               02018000
CVTFACHN EQU   CVTXTNT1                                                 02019000
CVTRV488 EQU   CVTMAP+412                                               02020000
CVTRV487 EQU   CVTMAP+408                                               02021000
CVTRV486 EQU   CVTMAP+404                                               02022000
CVTRV485 EQU   CVTMAP+400                                               02023000
CVTACTAP EQU   CVTMAP+396                                               02024000
CVTAUTH  EQU   CVTMAP+392                                               02025000
CVTATMCA EQU   CVTATMCT+1                                               02026000
CVTATMST EQU   CVTATMCT                                                 02027000
CVTRSV61 EQU   CVTMAP+384                                               02028000
CVTVOLT1 EQU   CVTVOLM1+1                                               02029000
CVTVOLI1 EQU   CVTVOLF1                                                 02030000
CVTSTOA  EQU   CVTMAP+376                                               02031000
CVTRSV58 EQU   CVTMAP+374                                               02032000
CVTRSV57 EQU   CVTMAP+372                                               02033000
CVTDDCE  EQU   CVTMAP+368                                               02034000
CVTPNWFR EQU   CVTMAP+364                                               02035000
CVTSMF   EQU   CVTMAP+360                                               02036000
CVTSULK  EQU   CVTMAP+358                                               02037000
CVTSLKO  EQU   CVTSYSK                                                  02038000
CVTSLKP  EQU   CVTSYSK                                                  02039000
CVTSLKQ  EQU   CVTSYSK                                                  02040000
CVTSLKR  EQU   CVTSYSK                                                  02041000
CVTRSV56 EQU   CVTSYSK                                                  02042000
CVTRSV55 EQU   CVTSYSK                                                  02043000
CVTRSV54 EQU   CVTSYSK                                                  02044000
CVTRSV53 EQU   CVTSYSK                                                  02045000
CVTRSV52 EQU   CVTA1F1                                                  02046000
CVTRSV51 EQU   CVTA1F1                                                  02047000
CVTRSV50 EQU   CVTA1F1                                                  02048000
CVTRSV49 EQU   CVTA1F1                                                  02049000
CVTRSV48 EQU   CVTA1F1                                                  02050000
CVTRSV47 EQU   CVTA1F1                                                  02051000
CVTSRSW  EQU   CVTA1F1                                                  02052000
CVTPFSW  EQU   CVTA1F1                                                  02053000
CVTPCVT  EQU   CVTMAP+352                                               02054000
CVTRSV46 EQU   CVTMAP+344                                               02055000
CVTRSV45 EQU   CVTMAP+340                                               02056000
CVTRSV44 EQU   CVTMAP+338                                               02057000
CVTRSV43 EQU   CVTMAP+336                                               02058000
CVTHJESA EQU   CVTHJES+1                                                02059000
CVTRSV42 EQU   CVTHJES                                                  02060000
CVTEXT2A EQU   CVTEXT2+1                                                02061000
CVTRSV41 EQU   CVTEXT2                                                  02062000
CVTAPFA  EQU   CVTAPF+1                                                 02063000
CVTRSV40 EQU   CVTAPF                                                   02064000
CVTRV518 EQU   CVTINTLA                                                 02065000
CVTRV517 EQU   CVTERPV                                                  02066000
CVTEORM  EQU   CVTMAP+312                                               02067000
CVTMCHPR EQU   CVTMAP+308                                               02068000
CVTTZ    EQU   CVTMAP+304                                               02069000
CVTJEPS  EQU   CVTMAP+300                                               02070000
CVTJESCT EQU   CVTMAP+296                                               02071000
CVTMODE  EQU   CVTMAP+292                                               02072000
CVTPTRV  EQU   CVTMAP+288                                               02073000
CVTREAL  EQU   CVTMAP+284                                               02074000
CVTRSV39 EQU   CVTMAP+280                                               02075000
CVTRSV38 EQU   CVTMAP+276                                               02076000
CVTDMSRA EQU   CVTDMSR+1                                                02077000
CVTRSV37 EQU   CVTDMSR                                                  02078000
CVTQMSGA EQU   CVTQMSG+1                                                02079000
CVTRSV36 EQU   CVTQMSG                                                  02080000
CVTAMFF  EQU   CVTMAP+264                                               02081000
CVTPURGA EQU   CVTPURG+1                                                02082000
CVTRSV35 EQU   CVTPURG                                                  02083000
CVTCBSP  EQU   CVTMAP+256                                               02084000
CVTATERA EQU   CVTATER+1                                                02085000
CVTSYST  EQU   CVTATER                                                  02086000
CVTVOLT2 EQU   CVTTAT                                                   02087000
CVTVOLI2 EQU   CVTVOLF2                                                 02088000
CVTAQAVB EQU   CVTAQAVT+1                                               02089000
CVTRSV34 EQU   CVTTCMFG                                                 02090000
CVTRSV33 EQU   CVTTCMFG                                                 02091000
CVTRSV32 EQU   CVTTCMFG                                                 02092000
CVTRSV31 EQU   CVTTCMFG                                                 02093000
CVTRSV30 EQU   CVTTCMFG                                                 02094000
CVTRSV29 EQU   CVTTCMFG                                                 02095000
CVTRSV28 EQU   CVTTCMFG                                                 02096000
CVTTCRDY EQU   CVTTCMFG                                                 02097000
CVTGTFA  EQU   CVTGTF+1                                                 02098000
CVTRSV27 EQU   CVTGTFST                                                 02099000
CVTRNIO  EQU   CVTGTFST                                                 02100000
CVTUSR   EQU   CVTGTFST                                                 02101000
CVTRV318 EQU   CVTFORM                                                  02102000
CVTRV317 EQU   CVTTMODE                                                 02103000
CVTRV316 EQU   CVTSTATE                                                 02104000
CVTRV315 EQU   CVTGTFS                                                  02105000
CVTGTFAV EQU   CVTGTFS                                                  02106000
CVT0SCR1 EQU   CVTMAP+232                                               02107000
CVTRV515 EQU   CVTMAP+228                                               02108000
CVTRMS   EQU   CVTMAP+224                                               02109000
CVTPATCH EQU   CVTMAP+220                                               02110000
CVTTSCE  EQU   CVTMAP+216                                               02111000
CVTLNKSC EQU   CVTMAP+214                                               02112000
CVTQABST EQU   CVTMAP+212                                               02113000
CVTMDLDS EQU   CVTMAP+208                                               02114000
CVTUSER  EQU   CVTMAP+204                                               02115000
CVTABEND EQU   CVTMAP+200                                               02116000
CVTSMCA  EQU   CVTMAP+196                                               02117000
CVTRSV18 EQU   CVTMAP+192                                               02118000
CVTQLPAQ EQU   CVTMAP+188                                               02119000
CVTQCDSR EQU   CVTMAP+184                                               02120000
CVTRSV17 EQU   CVTOPTB                                                  02121000
CVTRSV16 EQU   CVTOPTB                                                  02122000
CVTFP    EQU   CVTOPTB                                                  02123000
CVTAPTHR EQU   CVTOPTB                                                  02124000
CVTNLOG  EQU   CVTOPTB                                                  02125000
CVTTOD   EQU   CVTOPTB                                                  02126000
CVTCTIMS EQU   CVTOPTB                                                  02127000
CVTPROT  EQU   CVTOPTB                                                  02128000
CVTXPFP  EQU   CVTOPTA                                                  02129000
CVTASCII EQU   CVTOPTA                                                  02130000
CVTRSV13 EQU   CVTOPTA                                                  02131000
CVTRSV12 EQU   CVTOPTA                                                  02132000
CVTNIP   EQU   CVTOPTA                                                  02133000
CVTDDR   EQU   CVTOPTA                                                  02134000
CVTAPR   EQU   CVTOPTA                                                  02135000
CVTCCH   EQU   CVTOPTA                                                  02136000
CVTSNCTR EQU   CVTMAP+180                                               02137000
CVTQMWR  EQU   CVTMAP+176                                               02138000
CVTQOCR  EQU   CVTMAP+172                                               02139000
CVT1EF00 EQU   CVTMAP+168                                               02140000
CVTMZ00  EQU   CVTMAP+164                                               02141000
CVTHEAD  EQU   CVTMAP+160                                               02142000
CVTRSV11 EQU   CVTMAP+156                                               02143000
CVT0PT01 EQU   CVTMAP+152                                               02144000
CVTMSER  EQU   CVTMAP+148                                               02145000
CVTRV516 EQU   CVTIERLC                                                 02146000
CVTILCH  EQU   CVTMAP+140                                               02147000
CVT0DS   EQU   CVTMAP+136                                               02148000
CVTFBOSV EQU   CVTMAP+132                                               02149000
CVTNUCB  EQU   CVTMAP+128                                               02150000
CVTIXAVL EQU   CVTMAP+124                                               02151000
CVTIOQET EQU   CVTMAP+120                                               02152000
CVTDCBA  EQU   CVTMAP+117                                               02153000
CVTMVS2  EQU   CVTDCB                                                   02154000
CVT6DAT  EQU   CVTDCB                                                   02155000
CVT4MPS  EQU   CVTDCB                                                   02156000
CVTRSV09 EQU   CVTDCB                                                   02157000
CVT4MS1  EQU   CVTDCB                                                   02158000
CVT2SPS  EQU   CVTDCB                                                   02159000
CVT1SSS  EQU   CVTDCB                                                   02160000
CVTRSV08 EQU   CVTDCB                                                   02161000
CVTSTB   EQU   CVTMAP+112                                               02162000
CVTQTD00 EQU   CVTMAP+108                                               02163000
CVTQTE00 EQU   CVTMAP+104                                               02164000
CVTCUCB  EQU   CVTMAP+100                                               02165000
CVTSJQ   EQU   CVTMAP+96                                                02166000
CVTPBLDL EQU   CVTMAP+92                                                02167000
CVTTPC   EQU   CVTMAP+88                                                02168000
CVTSVDCB EQU   CVTMAP+84                                                02169000
CVTBRET  EQU   CVTMAP+82                                                02170000
CVTEXIT  EQU   CVTMAP+80                                                02171000
CVT0FN00 EQU   CVTMAP+76                                                02172000
CVTDARA  EQU   CVTDAR+1                                                 02173000
CVTRSV07 EQU   CVTFLGS1                                                 02174000
CVTRSV06 EQU   CVTFLGS1                                                 02175000
CVTRSV05 EQU   CVTFLGS1                                                 02176000
CVTRSV04 EQU   CVTFLGS1                                                 02177000
CVTRSV03 EQU   CVTFLGS1                                                 02178000
CVTRSV02 EQU   CVTFLGS1                                                 02179000
CVTRSV01 EQU   CVTFLGS1                                                 02180000
CVTDMPLK EQU   CVTFLGS1                                                 02181000
CVTXITP  EQU   CVTMAP+68                                                02182000
CVTZDTAB EQU   CVTMAP+64                                                02183000
CVTMSLT  EQU   CVTMAP+60                                                02184000
CVTDATE  EQU   CVTMAP+56                                                02185000
CVTBTERM EQU   CVTMAP+52                                                02186000
CVTSYSAD EQU   CVTMAP+48                                                02187000
CVTXTLER EQU   CVTMAP+44                                                02188000
CVTILK2  EQU   CVTMAP+40                                                02189000
CVTILK1  EQU   CVTMAP+36                                                02190000
CVTPRLTV EQU   CVTMAP+32                                                02191000
CVTPCNVT EQU   CVTMAP+28                                                02192000
CVT0VL00 EQU   CVTMAP+24                                                02193000
CVTXAPG  EQU   CVTMAP+20                                                02194000
CVTBUF   EQU   CVTMAP+16                                                02195000
CVTJOB   EQU   CVTMAP+12                                                02196000
CVTLINK  EQU   CVTMAP+8                                                 02197000
CVT0EF00 EQU   CVTMAP+4                                                 02198000
CVTTCBP  EQU   CVTMAP                                                   02199000
CVT      EQU   CVTMAP                                                   02200000
WPELSIZE EQU   VRWPQEL+20                                               02201000
WPERRADD EQU   VRWPQEL+12                                               02202000
WPECBADD EQU   VRWPQEL+8                                                02203000
ASXBEND  EQU   ASXB+232                                                 02204000
ASXBRV25 EQU   ASXB+228                                                 02205000
ASXBRV24 EQU   ASXB+224                                                 02206000
ASXBRV23 EQU   ASXB+220                                                 02207000
ASXBRV22 EQU   ASXB+216                                                 02208000
ASXBRV21 EQU   ASXB+212                                                 02209000
ASXBRV20 EQU   ASXB+208                                                 02210000
ASXBRV19 EQU   ASXB+204                                                 02211000
ASXBRV18 EQU   ASXB+200                                                 02212000
ASXBRV17 EQU   ASXB+196                                                 02213000
ASXBRV16 EQU   ASXB+192                                                 02214000
ASXBLSRB EQU   ASXBAEQ+20                                               02215000
ASXBFSRB EQU   ASXBAEQ+16                                               02216000
ASXBLRQE EQU   ASXBAEQ+12                                               02217000
ASXBFRQE EQU   ASXBAEQ+8                                                02218000
ASXBLIQE EQU   ASXBAEQ+4                                                02219000
ASXBFIQE EQU   ASXBAEQ                                                  02220000
ASXBETSK EQU   ASXB+164                                                 02221000
ASXBSIRB EQU   ASXB+160                                                 02222000
ASXBPSWD EQU   ASXB+152                                                 02223000
ASXBPRG  EQU   ASXB+136                                                 02224000
ASXBRV26 EQU   ASXB+132                                                 02225000
ASXBOUSB EQU   ASXB+128                                                 02226000
ASXBDDR  EQU   ASXB+124                                                 02227000
ASXBRCTD EQU   ASXB+120                                                 02228000
ASXBRSMD EQU   ASXB+116                                                 02229000
ASXBSPSA EQU   ASXB+112                                                 02230000
ASXBFRWA EQU   ASXB+108                                                 02231000
ASXBFLSA EQU   ASXB+36                                                  02232000
ASXBIHSA EQU   ASXB+32                                                  02233000
ASXBRV15 EQU   ASXB+28                                                  02234000
ASXBRV14 EQU   ASXB+24                                                  02235000
ASXBLWA  EQU   ASXB+20                                                  02236000
ASXBMPST EQU   ASXB+16                                                  02237000
ASXBRS00 EQU   ASXB+14                                                  02238000
ASXBTCBS EQU   ASXB+12                                                  02239000
ASXBLTCB EQU   ASXB+8                                                   02240000
ASXBFTCB EQU   ASXB+4                                                   02241000
ASXBASXB EQU   ASXB                                                     02242000
ASXBEGIN EQU   ASXB                                                     02243000
ASCBEND  EQU   ASCB+208                                                 02244000
ASCBSRBT EQU   ASCB+200                                                 02245000
ASCBSWTL EQU   ASCB+196                                                 02246000
ASCBRS14 EQU   ASCB+195                                                 02247000
ASCBSMCT EQU   ASCB+194                                                 02248000
ASCBRS12 EQU   ASCB+192                                                 02249000
ASCBPCTT EQU   ASCB+188                                                 02250000
ASCBVGTT EQU   ASCB+184                                                 02251000
ASCBLGCB EQU   ASCB+180                                                 02252000
ASCBJBNS EQU   ASCB+176                                                 02253000
ASCBJBNI EQU   ASCB+172                                                 02254000
ASCBMCC  EQU   ASCB+168                                                 02255000
ASCBRTWA EQU   ASCB+164                                                 02256000
ASCBIQEA EQU   ASCB+160                                                 02257000
ASCBXMPQ EQU   ASCB+156                                                 02258000
ASCBRS01 EQU   ASCB+154                                                 02259000
ASCBFMCT EQU   ASCB+152                                                 02260000
ASCBOUXB EQU   ASCB+148                                                 02261000
ASCBOUCB EQU   ASCB+144                                                 02262000
ASCBMECB EQU   ASCB+140                                                 02263000
ASCBQECB EQU   ASCB+136                                                 02264000
ASCBCMSB EQU   ASCB+132                                                 02265000
ASCBCMSF EQU   ASCB+128                                                 02266000
ASCBTCBS EQU   ASCB+124                                                 02267000
ASCBNVSC EQU   ASCB+122                                                 02268000
ASCBVSC  EQU   ASCB+120                                                 02269000
ASCBSRBS EQU   ASCB+118                                                 02270000
ASCBSSRB EQU   ASCB+116                                                 02271000
ASCBRV06 EQU   ASCBFLG2                                                 02272000
ASCBRV05 EQU   ASCBFLG2                                                 02273000
ASCBRV04 EQU   ASCBFLG2                                                 02274000
ASCBSNQS EQU   ASCBFLG2                                                 02275000
ASCBS2S  EQU   ASCBFLG2                                                 02276000
ASCBCEXT EQU   ASCBFLG2                                                 02277000
ASCBPXMT EQU   ASCBFLG2                                                 02278000
ASCBXMPT EQU   ASCBFLG2                                                 02279000
ASCBRF07 EQU   ASCBDSP1                                                 02280000
ASCBRF06 EQU   ASCBDSP1                                                 02281000
ASCBRF05 EQU   ASCBDSP1                                                 02282000
ASCBRF04 EQU   ASCBDSP1                                                 02283000
ASCBRF03 EQU   ASCBDSP1                                                 02284000
ASCBRF02 EQU   ASCBDSP1                                                 02285000
ASCBFAIL EQU   ASCBDSP1                                                 02286000
ASCBNOQ  EQU   ASCBDSP1                                                 02287000
ASCBSWCT EQU   ASCB+112                                                 02288000
ASCBTMCH EQU   ASCB+104                                                 02289000
ASCBNSWP EQU   ASCBFLG1                                                 02290000
ASCBTYP1 EQU   ASCBFLG1                                                 02291000
ASCBSTND EQU   ASCBFLG1                                                 02292000
ASCBABNT EQU   ASCBFLG1                                                 02293000
ASCBTERM EQU   ASCBFLG1                                                 02294000
ASCBS3S  EQU   ASCBFLG1                                                 02295000
ASCBCMSH EQU   ASCBFLG1                                                 02296000
ASCBTOFF EQU   ASCBFLG1                                                 02297000
ASCBRF01 EQU   ASCBRCTF                                                 02298000
ASCBTMLW EQU   ASCBRCTF                                                 02299000
ASCBOUT  EQU   ASCBRCTF                                                 02300000
ASCBWAIT EQU   ASCBRCTF                                                 02301000
ASCBRV08 EQU   ASCBRCTF                                                 02302000
ASCBFQU  EQU   ASCBRCTF                                                 02303000
ASCBFRS  EQU   ASCBRCTF                                                 02304000
ASCBTMNO EQU   ASCBRCTF                                                 02305000
ASCBAFFN EQU   ASCBFW1                                                  02306000
ASCBDUMP EQU   ASCB+96                                                  02307000
ASCBQSVC EQU   ASCB+92                                                  02308000
ASCBUBET EQU   ASCB+88                                                  02309000
ASCBECB  EQU   ASCB+84                                                  02310000
ASCBJSTL EQU   ASCB+80                                                  02311000
ASCBEWST EQU   ASCB+72                                                  02312000
ASCBEJST EQU   ASCB+64                                                  02313000
ASCBTSB  EQU   ASCB+60                                                  02314000
ASCBCSCB EQU   ASCB+56                                                  02315000
ASCBRSM  EQU   ASCB+52                                                  02316000
ASCBSTOR EQU   ASCB+44                                                  02317000
ASCBDP   EQU   ASCB+43                                                  02318000
ASCBRV07 EQU   ASCB+42                                                  02319000
ASCBIOSM EQU   ASCB+40                                                  02320000
ASCBSEQN EQU   ASCB+38                                                  02321000
ASCBCPUS EQU   ASCB+32                                                  02322000
ASCBSPL  EQU   ASCB+28                                                  02323000
ASCBLSLQ EQU   ASCB+24                                                  02324000
ASCBFSLQ EQU   ASCB+20                                                  02325000
ASCBIOSP EQU   ASCB+16                                                  02326000
ASCBLOCK EQU   ASCB+12                                                  02327000
ASCBBWDP EQU   ASCB+8                                                   02328000
ASCBFWDP EQU   ASCB+4                                                   02329000
ASCBASCB EQU   ASCB                                                     02330000
ASCBEGIN EQU   ASCB                                                     02331000
@NM00011 EQU   TCBXTNT2+32                                              02332000
TCBRV181 EQU   TCBRV173                                                 02333000
TCBRV180 EQU   TCBRV173                                                 02334000
TCBRV179 EQU   TCBRV173                                                 02335000
TCBRV178 EQU   TCBRV173                                                 02336000
TCBRV177 EQU   TCBRV173                                                 02337000
TCBRV176 EQU   TCBRV173                                                 02338000
TCBRV175 EQU   TCBRV173                                                 02339000
TCBRV174 EQU   TCBRV173                                                 02340000
TCBRV172 EQU   TCBRV164                                                 02341000
TCBRV171 EQU   TCBRV164                                                 02342000
TCBRV170 EQU   TCBRV164                                                 02343000
TCBRV169 EQU   TCBRV164                                                 02344000
TCBRV168 EQU   TCBRV164                                                 02345000
TCBRV167 EQU   TCBRV164                                                 02346000
TCBRV166 EQU   TCBRV164                                                 02347000
TCBRV165 EQU   TCBRV164                                                 02348000
TCBRV163 EQU   TCBRV155                                                 02349000
TCBRV162 EQU   TCBRV155                                                 02350000
TCBRV161 EQU   TCBRV155                                                 02351000
TCBRV160 EQU   TCBRV155                                                 02352000
TCBRV159 EQU   TCBRV155                                                 02353000
TCBRV158 EQU   TCBRV155                                                 02354000
TCBRV157 EQU   TCBRV155                                                 02355000
TCBRV156 EQU   TCBRV155                                                 02356000
TCBRV154 EQU   TCBRV146                                                 02357000
TCBRV153 EQU   TCBRV146                                                 02358000
TCBRV152 EQU   TCBRV146                                                 02359000
TCBRV151 EQU   TCBRV146                                                 02360000
TCBRV150 EQU   TCBRV146                                                 02361000
TCBRV149 EQU   TCBRV146                                                 02362000
TCBRV148 EQU   TCBRV146                                                 02363000
TCBRV147 EQU   TCBRV146                                                 02364000
TCBRV145 EQU   TCBXTNT2+26                                              02365000
TCBRV144 EQU   TCBXTNT2+24                                              02366000
TCBRV143 EQU   TCBXTNT2+20                                              02367000
TCBRV142 EQU   TCBXTNT2+16                                              02368000
TCBRSV49 EQU   TCBXTNT2+12                                              02369000
TCBEVENT EQU   TCBXTNT2+8                                               02370000
TCBRCMP  EQU   TCBXTNT2+5                                               02371000
TCBRSVAB EQU   TCBXTNT2+4                                               02372000
TCBGTFA  EQU   TCBGTF+1                                                 02373000
TCBRSV47 EQU   TCBTFLG                                                  02374000
TCBRSV46 EQU   TCBTFLG                                                  02375000
TCBRSV45 EQU   TCBTFLG                                                  02376000
TCBRSV44 EQU   TCBTFLG                                                  02377000
TCBRSV43 EQU   TCBTFLG                                                  02378000
TCBDSPIT EQU   TCBTFLG                                                  02379000
TCBERRTN EQU   TCBTFLG                                                  02380000
TCBASYNC EQU   TCBTFLG                                                  02381000
@NM00010 EQU   TCB+296                                                  02382000
TCBRV185 EQU   TCB+292                                                  02383000
TCBSWASA EQU   TCB+288                                                  02384000
TCBDBTB  EQU   TCB+284                                                  02385000
TCBRPT   EQU   TCB+280                                                  02386000
TCBRV141 EQU   TCBRV133                                                 02387000
TCBRV140 EQU   TCBRV133                                                 02388000
TCBRV139 EQU   TCBRV133                                                 02389000
TCBRV138 EQU   TCBRV133                                                 02390000
TCBRV137 EQU   TCBRV133                                                 02391000
TCBRV136 EQU   TCBRV133                                                 02392000
TCBRV135 EQU   TCBRV133                                                 02393000
TCBRV134 EQU   TCBRV133                                                 02394000
TCBRV132 EQU   TCBRV124                                                 02395000
TCBRV131 EQU   TCBRV124                                                 02396000
TCBRV130 EQU   TCBRV124                                                 02397000
TCBRV129 EQU   TCBRV124                                                 02398000
TCBRV128 EQU   TCBRV124                                                 02399000
TCBRV127 EQU   TCBRV124                                                 02400000
TCBRV126 EQU   TCBRV124                                                 02401000
TCBRV125 EQU   TCBRV124                                                 02402000
TCBRV123 EQU   TCBFBYT2                                                 02403000
TCBRV122 EQU   TCBFBYT2                                                 02404000
TCBECBNV EQU   TCBFBYT2                                                 02405000
TCBSSSYN EQU   TCBFBYT2                                                 02406000
TCBFPRAP EQU   TCBFBYT2                                                 02407000
TCBFDW   EQU   TCBFBYT2                                                 02408000
TCBFMW   EQU   TCBFBYT2                                                 02409000
TCBCNCB  EQU   TCBFBYT2                                                 02410000
TCBLLH   EQU   TCBFBYT1                                                 02411000
TCBRV113 EQU   TCBFBYT1                                                 02412000
TCBEOT   EQU   TCBFBYT1                                                 02413000
TCBRTM2  EQU   TCBFBYT1                                                 02414000
TCBPGNLY EQU   TCBFBYT1                                                 02415000
TCBNDIOS EQU   TCBFBYT1                                                 02416000
TCBACTIV EQU   TCBFBYT1                                                 02417000
TCBEOTFM EQU   TCBFBYT1                                                 02418000
TCBAFFN  EQU   TCB+274                                                  02419000
TCBCCPVI EQU   TCB+272                                                  02420000
TCBMODE  EQU   TCBESTAE+3                                               02421000
TCBERTYP EQU   TCBESTAE+2                                               02422000
TCBRV314 EQU   TCBESTRM                                                 02423000
TCBRV313 EQU   TCBESTRM                                                 02424000
TCBRV312 EQU   TCBESTRM                                                 02425000
TCBRV311 EQU   TCBESTRM                                                 02426000
TCBRV310 EQU   TCBESTRM                                                 02427000
TCBRV309 EQU   TCBESTRM                                                 02428000
TCBRV308 EQU   TCBESTRM                                                 02429000
TCBETERM EQU   TCBESTRM                                                 02430000
TCBSCBKY EQU   TCBESTAE                                                 02431000
TCBRTM12 EQU   TCB+260                                                  02432000
TCBTCBID EQU   TCB+256                                                  02433000
TCBRSV96 EQU   TCB+252                                                  02434000
TCBFOEA  EQU   TCBFOE+1                                                 02435000
TCBRSV42 EQU   TCBFOE                                                   02436000
TCBRV306 EQU   TCB+240                                                  02437000
TCBRSV41 EQU   TCB+239                                                  02438000
TCBTID   EQU   TCB+238                                                  02439000
TCBRSVAA EQU   TCB+237                                                  02440000
TCBABCUR EQU   TCB+236                                                  02441000
TCBTMSAV EQU   TCB+232                                                  02442000
TCBIOTIM EQU   TCB+228                                                  02443000
TCBRTWA  EQU   TCB+224                                                  02444000
TCBBACK  EQU   TCB+220                                                  02445000
TCBTIRB  EQU   TCB+216                                                  02446000
TCBAECB  EQU   TCB+212                                                  02447000
TCBEXT2A EQU   TCBEXT2+1                                                02448000
TCBRSV39 EQU   TCBEXT2                                                  02449000
TCBSTMCT EQU   TCB+207                                                  02450000
TCBSYSCT EQU   TCB+206                                                  02451000
TCBRSV37 EQU   TCB+205                                                  02452000
TCBEXSVC EQU   TCBDAR                                                   02453000
TCBRSV36 EQU   TCBDAR                                                   02454000
TCBDARWT EQU   TCBDAR                                                   02455000
TCBDARO  EQU   TCBDAR                                                   02456000
TCBDARMC EQU   TCBDARC                                                  02457000
TCBDARD  EQU   TCBDAR                                                   02458000
TCBDARS  EQU   TCBDAR                                                   02459000
TCBDARP  EQU   TCBDAR                                                   02460000
TCBGTOFM EQU   TCBFLGS7                                                 02461000
TCBADMP  EQU   TCBFLGS7                                                 02462000
TCBRSTSK EQU   TCBFLGS7                                                 02463000
TCBRSV35 EQU   TCBFLGS7                                                 02464000
TCBSTACK EQU   TCBFLGS7                                                 02465000
TCBRSV34 EQU   TCBFLGS7                                                 02466000
TCBRSV33 EQU   TCBFLGS7                                                 02467000
TCBGPECB EQU   TCBFLGS7                                                 02468000
TCBNTJS  EQU   TCBFLGS6                                                 02469000
TCBAPG   EQU   TCBFLGS6                                                 02470000
TCBMIGR  EQU   TCBFLGS6                                                 02471000
TCBRV303 EQU   TCBFLGS6                                                 02472000
TCBSPVLK EQU   TCBFLGS6                                                 02473000
TCBCPU   EQU   TCBFLGS6                                                 02474000
TCBPIE17 EQU   TCBFLGS6                                                 02475000
TCBRV    EQU   TCBFLGS6                                                 02476000
TCBRSV79 EQU   TCBNDSP5                                                 02477000
TCBRSV78 EQU   TCBNDSP5                                                 02478000
TCBRSV77 EQU   TCBNDSP5                                                 02479000
TCBRSV76 EQU   TCBNDSP5                                                 02480000
TCBRSV75 EQU   TCBNDSP5                                                 02481000
TCBRSV74 EQU   TCBNDSP5                                                 02482000
TCBRSV95 EQU   TCBNDSP5                                                 02483000
TCBRSV94 EQU   TCBNDSP5                                                 02484000
TCBRSV93 EQU   TCBNDSP4                                                 02485000
TCBRSV92 EQU   TCBNDSP4                                                 02486000
TCBRSV91 EQU   TCBNDSP4                                                 02487000
TCBRSV90 EQU   TCBNDSP4                                                 02488000
TCBRSV89 EQU   TCBNDSP4                                                 02489000
TCBRSV88 EQU   TCBNDSP4                                                 02490000
TCBRSV87 EQU   TCBNDSP4                                                 02491000
TCBRSV86 EQU   TCBNDSP4                                                 02492000
TCBEXT1A EQU   TCBEXT1+1                                                02493000
TCBRSV32 EQU   TCBEXT1                                                  02494000
TCBEXCPD EQU   TCB+192                                                  02495000
TCBIOBRC EQU   TCB+188                                                  02496000
TCBDDWTC EQU   TCB+186                                                  02497000
TCBDDEXC EQU   TCB+184                                                  02498000
TCBJSCBB EQU   TCBJSCB+1                                                02499000
@NM00009 EQU   TCBRECDE                                                 02500000
TCBREC   EQU   TCBRECDE                                                 02501000
TCBMDIDS EQU   TCB+176                                                  02502000
TCBNDINT EQU   TCBNDSP3                                                 02503000
TCBRSV27 EQU   TCBNDSP3                                                 02504000
TCBRSV26 EQU   TCBNDSP3                                                 02505000
TCBRSV25 EQU   TCBNDSP3                                                 02506000
TCBRSV24 EQU   TCBNDSP3                                                 02507000
TCBSRBND EQU   TCBNDSP3                                                 02508000
TCBRV302 EQU   TCBNDSP3                                                 02509000
TCBLJSND EQU   TCBNDSP3                                                 02510000
TCBABE   EQU   TCBNDSP2                                                 02511000
TCBDSS   EQU   TCBNDSP2                                                 02512000
TCBOWAIT EQU   TCBNDSP2                                                 02513000
TCBIWAIT EQU   TCBNDSP2                                                 02514000
TCBNDTS  EQU   TCBNDSP2                                                 02515000
TCBNDSVC EQU   TCBNDSP2                                                 02516000
TCBSTPP  EQU   TCBNDSP2                                                 02517000
TCBABD   EQU   TCBNDSP2                                                 02518000
TCBRSV22 EQU   TCBNDSP1                                                 02519000
TCBPIEND EQU   TCBNDSP1                                                 02520000
TCBTPSP  EQU   TCBNDSP1                                                 02521000
TCBDDRND EQU   TCBNDSP1                                                 02522000
TCBRSPND EQU   TCBNDSP1                                                 02523000
TCBRSTND EQU   TCBNDSP1                                                 02524000
TCBDARPN EQU   TCBNDSP1                                                 02525000
TCBDARTN EQU   TCBNDSP1                                                 02526000
TCBNDSP0 EQU   TCBNDSP                                                  02527000
TCBUSER  EQU   TCB+168                                                  02528000
TCBTCTB  EQU   TCBTCT+1                                                 02529000
TCBRSV9C EQU   TCBTCTGF                                                 02530000
TCBRSV9B EQU   TCBTCTGF                                                 02531000
TCBRSV9A EQU   TCBTCTGF                                                 02532000
TCBRSV99 EQU   TCBTCTGF                                                 02533000
TCBRSV98 EQU   TCBTCTGF                                                 02534000
TCBRSV97 EQU   TCBTCTGF                                                 02535000
TCBRSV20 EQU   TCBTCTGF                                                 02536000
TCBSMFGF EQU   TCBTCTGF                                                 02537000
TCBSTABB EQU   TCBSTAB+1                                                02538000
TCBSTCUR EQU   TCBNSTAE                                                 02539000
TCBRV301 EQU   TCBNSTAE                                                 02540000
TCBSYNCH EQU   TCBNSTAE                                                 02541000
TCBHALT  EQU   TCBNSTAE                                                 02542000
TCBPPSUP EQU   TCBNSTAE                                                 02543000
TCB33E   EQU   TCBNSTAE                                                 02544000
TCBQUIES EQU   TCBNSTAE                                                 02545000
TCBSTABE EQU   TCBNSTAE                                                 02546000
TCBPQE   EQU   TCB+152                                                  02547000
TCBTSDP  EQU   TCB+151                                                  02548000
TCBTSLP  EQU   TCB+150                                                  02549000
TCBSTPCT EQU   TCB+149                                                  02550000
TCBCPUBN EQU   TCBTSFLG                                                 02551000
TCBDYDSP EQU   TCBTSFLG                                                 02552000
TCBRSV18 EQU   TCBTSFLG                                                 02553000
TCBRSV17 EQU   TCBTSFLG                                                 02554000
TCBTIOTG EQU   TCBTSFLG                                                 02555000
TCBATT   EQU   TCBTSFLG                                                 02556000
TCBSTPPR EQU   TCBTSFLG                                                 02557000
TCBRV300 EQU   TCBTSTSK                                                 02558000
TCBIQE   EQU   TCB+140                                                  02559000
TCBLTC   EQU   TCB+136                                                  02560000
TCBOTC   EQU   TCB+132                                                  02561000
TCBNTC   EQU   TCB+128                                                  02562000
TCBJSTCA EQU   TCBJSTCB+1                                               02563000
TCBRSV16 EQU   TCBJSTCB                                                 02564000
TCBTQET  EQU   TCBTME                                                   02565000
TCBTCB   EQU   TCB+116                                                  02566000
TCBQEL   EQU   TCBFSA                                                   02567000
TCBGRS15 EQU   TCBGRS+60                                                02568000
TCBGRS14 EQU   TCBGRS+56                                                02569000
TCBGRS13 EQU   TCBGRS+52                                                02570000
TCBGRS12 EQU   TCBGRS+48                                                02571000
TCBGRS11 EQU   TCBGRS+44                                                02572000
TCBGRS10 EQU   TCBGRS+40                                                02573000
TCBGRS9  EQU   TCBGRS+36                                                02574000
TCBGRS8  EQU   TCBGRS+32                                                02575000
TCBGRS7  EQU   TCBGRS+28                                                02576000
TCBGRS6  EQU   TCBGRS+24                                                02577000
TCBGRS5  EQU   TCBGRS+20                                                02578000
TCBGRS4  EQU   TCBGRS+16                                                02579000
TCBGRS3  EQU   TCBGRS+12                                                02580000
TCBGRS2  EQU   TCBGRS+8                                                 02581000
TCBGRS1  EQU   TCBGRS+4                                                 02582000
TCBGRS0  EQU   TCBGRS                                                   02583000
TCBJPQB  EQU   TCBJPQ+1                                                 02584000
TCBRSV15 EQU   TCBPURGE                                                 02585000
TCBRSV14 EQU   TCBPURGE                                                 02586000
TCBRSV13 EQU   TCBPURGE                                                 02587000
TCBRSV12 EQU   TCBPURGE                                                 02588000
TCBRSV11 EQU   TCBPURGE                                                 02589000
TCBRSV10 EQU   TCBPURGE                                                 02590000
TCBRSV09 EQU   TCBPURGE                                                 02591000
TCBJPQF  EQU   TCBPURGE                                                 02592000
TCBJLB   EQU   TCB+40                                                   02593000
TCBLLS   EQU   TCB+36                                                   02594000
TCBDSP   EQU   TCB+35                                                   02595000
TCBLMP   EQU   TCB+34                                                   02596000
TCBPNDSP EQU   TCBFLGS5                                                 02597000
TCBFCD1  EQU   TCBFLGS5                                                 02598000
TCBSTP   EQU   TCBFLGS5                                                 02599000
TCBSYS   EQU   TCBFLGS5                                                 02600000
TCBANDSP EQU   TCBFLGS5                                                 02601000
TCBPAGE  EQU   TCBFLGS5                                                 02602000
TCBUXNDF EQU   TCBABWF                                                  02603000
TCBFC    EQU   TCBFLGS5                                                 02604000
TCBONDSP EQU   TCBFLGS4                                                 02605000
TCBMPCND EQU   TCBFLGS4                                                 02606000
TCBMPCVQ EQU   TCBFLGS4                                                 02607000
TCBUXNDV EQU   TCBFLGS4                                                 02608000
TCBHNDSP EQU   TCBFLGS4                                                 02609000
TCBRQENA EQU   TCBFLGS4                                                 02610000
TCBSER   EQU   TCBFLGS4                                                 02611000
TCBNDUMP EQU   TCBFLGS4                                                 02612000
TCBDWSTA EQU   TCBFLGS3                                                 02613000
TCBRSV08 EQU   TCBFLGS3                                                 02614000
TCBRSV07 EQU   TCBFLGS3                                                 02615000
TCBRSV06 EQU   TCBFLGS3                                                 02616000
TCBABGM  EQU   TCBFLGS3                                                 02617000
TCBABTRM EQU   TCBFLGS3                                                 02618000
TCBADINP EQU   TCBFLGS3                                                 02619000
TCBFSM   EQU   TCBFLGS3                                                 02620000
TCBFTS   EQU   TCBFLGS2                                                 02621000
TCBFDSOP EQU   TCBFLGS2                                                 02622000
TCBFJMC  EQU   TCBFLGS2                                                 02623000
TCBFSMC  EQU   TCBFLGS2                                                 02624000
TCBFABOP EQU   TCBFLGS2                                                 02625000
TCBFSTI  EQU   TCBFLGS2                                                 02626000
TCBFOINP EQU   TCBFLGS2                                                 02627000
TCBFX    EQU   TCBFLGS1                                                 02628000
TCBFS    EQU   TCBFLGS1                                                 02629000
TCBFT    EQU   TCBFLGS1                                                 02630000
TCBPDUMP EQU   TCBFLGS1                                                 02631000
TCBRSV04 EQU   TCBFLGS1                                                 02632000
TCBFERA  EQU   TCBFLGS1                                                 02633000
TCBFE    EQU   TCBFLGS1                                                 02634000
TCBFA    EQU   TCBFLGS1                                                 02635000
TCBZERO  EQU   TCBPKF                                                   02636000
TCBFLAG  EQU   TCBPKF                                                   02637000
TCBRSV03 EQU   TCBMSS                                                   02638000
TCBTRNB  EQU   TCBTRN+1                                                 02639000
TCBRSV02 EQU   TCBABF                                                   02640000
TCBOLTEP EQU   TCBABF                                                   02641000
TCBTCP   EQU   TCBABF                                                   02642000
TCBTCPP  EQU   TCBABF                                                   02643000
TCBRSV01 EQU   TCBABF                                                   02644000
TCBGRPH  EQU   TCBABF                                                   02645000
TCBNOCHK EQU   TCBABF                                                   02646000
TCBMOD91 EQU   TCBABF                                                   02647000
TCBCMPC  EQU   TCBCMP+1                                                 02648000
TCBRV318 EQU   TCBCMSG                                                  02649000
TCBRV317 EQU   TCBCIND                                                  02650000
TCBRV316 EQU   TCBCWTO                                                  02651000
TCBCASID EQU   TCBCDBL                                                  02652000
TCBNOCC  EQU   TCBSTCC                                                  02653000
TCBDMPO  EQU   TCBCPP                                                   02654000
TCBCSTEP EQU   TCBCMPF                                                  02655000
TCBCREQ  EQU   TCBCMPF                                                  02656000
TCBTIO   EQU   TCB+12                                                   02657000
TCBDEB   EQU   TCB+8                                                    02658000
TCBPIEA  EQU   TCBPIE+1                                                 02659000
TCBPM    EQU   TCBPMASK                                                 02660000
@NM00008 EQU   TCBPMASK                                                 02661000
TCBRBP   EQU   TCB                                                      02662000
TCBFRS6  EQU   TCBFRS+24                                                02663000
TCBFRS4  EQU   TCBFRS+16                                                02664000
TCBFRS2  EQU   TCBFRS+8                                                 02665000
TCBFRS0  EQU   TCBFRS                                                   02666000
FQERSVD  EQU   FQESECT+12                                               02667000
FQAREA   EQU   FQESECT+8                                                02668000
FQEPTRA  EQU   FQEPTR+1                                                 02669000
FQECPB   EQU   FQTYPE                                                   02670000
FQERGNFL EQU   FQTYPE                                                   02671000
DQEHRID  EQU   DQEBLKAD                                                 02672000
SPQERES2 EQU   SPQESECT+12                                              02673000
SPQERES1 EQU   SPQESECT+9                                               02674000
SPQEOWN  EQU   SPQEFLGS                                                 02675000
SPDQEAD  EQU   SPDQEPTR                                                 02676000
PQERSVD  EQU   PQESECT+31                                               02677000
VVVRFLG  EQU   VMMFLGS                                                  02678000
@NM00007 EQU   VMMFLGS                                                  02679000
PQEHRID  EQU   PQESECT+29                                               02680000
PQERFLGS EQU   PQESECT+28                                               02681000
PQETCB   EQU   PQESECT+16                                               02682000
LDAEND   EQU   LDA+1496                                                 02683000
LDALIMIT EQU   LDA+1484                                                 02684000
CSAVE    EQU   LDA+1100                                                 02685000
OBFRSAVE EQU   LDA+1036                                                 02686000
GFRESAVE EQU   LDA+972                                                  02687000
GMREPSAV EQU   LDA+908                                                  02688000
FBQSAVE  EQU   LDA+844                                                  02689000
G4KSAVE  EQU   LDA+780                                                  02690000
FSAVE    EQU   LDA+716                                                  02691000
BSAVE    EQU   LDA+652                                                  02692000
SAVEREG2 EQU   LDA+588                                                  02693000
BRANCHSV EQU   LDA+524                                                  02694000
GMFMWKAR EQU   LDA+24                                                   02695000
LDARES2  EQU   LDA+21                                                   02696000
LDACBSP  EQU   LDA+20                                                   02697000
LDARQSTA EQU   LDA+16                                                   02698000
LDATCB   EQU   LDA+12                                                   02699000
@NM00006 EQU   LVSMFLAG+1                                               02700000
LDABRSW  EQU   LVSMFLAG                                                 02701000
LDAFLAGS EQU   LVSMFLAG                                                 02702000
LDASTART EQU   LDA                                                      02703000
GBLCELCT EQU   GDA+60                                                   02704000
GLBLCELL EQU   GDA+56                                                   02705000
CSASPQEP EQU   GDA+52                                                   02706000
PFSTCPAB EQU   GDA+48                                                   02707000
SQASPLFT EQU   GDA+28                                                   02708000
SQASPQEP EQU   GDA+24                                                   02709000
VRPQEP   EQU   GDA+12                                                   02710000
CSAPQEP  EQU   GDA+8                                                    02711000
VRDREG   EQU   GDA+4                                                    02712000
RESV     EQU   GVSMFLAG+1                                               02713000
@NM00005 EQU   GDAFLAGS                                                 02714000
SQATHRS2 EQU   GDAFLAGS                                                 02715000
SQATHRS1 EQU   GDAFLAGS                                                 02716000
GDAFLAG2 EQU   GDAFLAGS                                                 02717000
NIPFOURK EQU   GDAFLAGS                                                 02718000
GDAFLAG1 EQU   GDAFLAGS                                                 02719000
FLGS2    EQU   RRPARMS+1                                                02720000
@NM00004 EQU   FLGS                                                     02721000
@NM00003 EQU   CELL+4                                                   02722000
EOTTCB   EQU   EOTPARM+8                                                02723000
EOTFLAGS EQU   EOTPARM                                                  02724000
@NM00035 EQU   PSA+3412                                                 02725000
PSASTAK  EQU   PSA+3072                                                 02726000
@NM00034 EQU   PSA+1040                                                 02727000
PSAUSEND EQU   PSA+1040                                                 02728000
PSARV062 EQU   PSA+1036                                                 02729000
PSAATCVT EQU   PSA+1032                                                 02730000
PSAPCPSW EQU   PSA+1024                                                 02731000
PSAPIR2  EQU   PSA+1020                                                 02732000
PSARV059 EQU   PSA+1018                                                 02733000
PSASVC13 EQU   PSA+1016                                                 02734000
PSALSFCC EQU   PSA+1012                                                 02735000
PSASFACC EQU   PSA+1008                                                 02736000
PSASTOP  EQU   PSA+992                                                  02737000
PSASTART EQU   PSA+976                                                  02738000
PSARSPSW EQU   PSA+968                                                  02739000
PSASRPSW EQU   PSA+960                                                  02740000
PSARV045 EQU   PSA+892                                                  02741000
PSARV044 EQU   PSA+888                                                  02742000
PSARV043 EQU   PSA+884                                                  02743000
PSARV042 EQU   PSA+880                                                  02744000
PSARV041 EQU   PSA+876                                                  02745000
PSARV040 EQU   PSA+872                                                  02746000
PSARV025 EQU   PSA+868                                                  02747000
PSADSSED EQU   PSA+868                                                  02748000
PSADSSPR EQU   PSA+864                                                  02749000
PSADSSFW EQU   PSA+860                                                  02750000
PSADSS14 EQU   PSA+856                                                  02751000
PSADSSPP EQU   PSA+848                                                  02752000
PSADSSRP EQU   PSA+840                                                  02753000
PSADSS05 EQU   PSADSSF4                                                 02754000
PSADSS10 EQU   PSADSSF4                                                 02755000
PSADSSVE EQU   PSADSSF4                                                 02756000
PSADSSDE EQU   PSADSSF4                                                 02757000
PSADSSC0 EQU   PSADSSF4                                                 02758000
PSADSSIE EQU   PSADSSF4                                                 02759000
PSADSS12 EQU   PSADSSF4                                                 02760000
PSADSSRC EQU   PSADSSF4                                                 02761000
PSARV057 EQU   PSADSSF3                                                 02762000
PSARV056 EQU   PSADSSF3                                                 02763000
PSARV055 EQU   PSADSSF3                                                 02764000
PSADSSMC EQU   PSADSSF3                                                 02765000
PSADSSRW EQU   PSADSSF3                                                 02766000
PSADSSNM EQU   PSADSSF3                                                 02767000
PSADSSES EQU   PSADSSF3                                                 02768000
PSADSSGP EQU   PSADSSF3                                                 02769000
PSADSSF2 EQU   PSADSSFL+1                                               02770000
PSADSSPI EQU   PSADSSF1                                                 02771000
PSADSSOI EQU   PSADSSF1                                                 02772000
PSADSSSP EQU   PSADSSF1                                                 02773000
PSADSSTP EQU   PSADSSF1                                                 02774000
PSADSSDW EQU   PSADSSF1                                                 02775000
PSADSSDD EQU   PSADSSF1                                                 02776000
PSADSSDM EQU   PSADSSF1                                                 02777000
PSADSSMV EQU   PSADSSF1                                                 02778000
PSADSSTS EQU   PSA+816                                                  02779000
PSADSSWK EQU   PSA+812                                                  02780000
PSADSSR3 EQU   PSA+808                                                  02781000
PSADSSR2 EQU   PSA+804                                                  02782000
PSADSSRS EQU   PSA+800                                                  02783000
PSASTOR  EQU   PSA+796                                                  02784000
PSACPUSA EQU   PSA+794                                                  02785000
PSAVSTAP EQU   PSA+792                                                  02786000
PSAWKVAP EQU   PSA+788                                                  02787000
PSAWKRAP EQU   PSA+784                                                  02788000
PSAMCHIC EQU   PSA+783                                                  02789000
PSARV061 EQU   PSA+782                                                  02790000
PSASYMSK EQU   PSA+781                                                  02791000
PSAMCHFL EQU   PSA+780                                                  02792000
PSACR0   EQU   PSA+776                                                  02793000
PSAPSWSV EQU   PSA+768                                                  02794000
PSACLHS  EQU   PSAHLHI                                                  02795000
PSALKR15 EQU   PSALKSA+60                                               02796000
PSALKR14 EQU   PSALKSA+56                                               02797000
PSALKR13 EQU   PSALKSA+52                                               02798000
PSALKR12 EQU   PSALKSA+48                                               02799000
PSALKR11 EQU   PSALKSA+44                                               02800000
PSALKR10 EQU   PSALKSA+40                                               02801000
PSALKR9  EQU   PSALKSA+36                                               02802000
PSALKR8  EQU   PSALKSA+32                                               02803000
PSALKR7  EQU   PSALKSA+28                                               02804000
PSALKR6  EQU   PSALKSA+24                                               02805000
PSALKR5  EQU   PSALKSA+20                                               02806000
PSALKR4  EQU   PSALKSA+16                                               02807000
PSALKR3  EQU   PSALKSA+12                                               02808000
PSALKR2  EQU   PSALKSA+8                                                02809000
PSALKR1  EQU   PSALKSA+4                                                02810000
PSALKR0  EQU   PSALKSA                                                  02811000
PSARV023 EQU   PSACLHT+52                                               02812000
PSALOCAL EQU   PSACLHT+48                                               02813000
PSACMSL  EQU   PSACLHT+44                                               02814000
PSAOPTL  EQU   PSACLHT+40                                               02815000
PSATPACL EQU   PSACLHT+36                                               02816000
PSATPDNL EQU   PSACLHT+32                                               02817000
PSATPNCL EQU   PSACLHT+28                                               02818000
PSAIOSLL EQU   PSACLHT+24                                               02819000
PSAIOSUL EQU   PSACLHT+20                                               02820000
PSAIOSCL EQU   PSACLHT+16                                               02821000
PSAIOSSL EQU   PSACLHT+12                                               02822000
PSASALCL EQU   PSACLHT+8                                                02823000
PSAASML  EQU   PSACLHT+4                                                02824000
PSADISPL EQU   PSACLHT                                                  02825000
PSASRSA  EQU   PSA+636                                                  02826000
PSARV050 EQU   PSA+634                                                  02827000
PSADSSGO EQU   PSA+633                                                  02828000
PSARECUR EQU   PSA+632                                                  02829000
PSAHLHIS EQU   PSA+628                                                  02830000
PSAIPCSA EQU   PSA+624                                                  02831000
@NM00033 EQU   PSA+621                                                  02832000
PSAIPCDM EQU   PSA+620                                                  02833000
PSAIPCD  EQU   PSA+616                                                  02834000
@NM00032 EQU   PSA+613                                                  02835000
PSAIPCRM EQU   PSA+612                                                  02836000
PSAIPCR  EQU   PSA+608                                                  02837000
PSAMCHEX EQU   PSA+600                                                  02838000
PSAMPSW  EQU   PSA+592                                                  02839000
PSAEXPS2 EQU   PSA+584                                                  02840000
PSAEXPS1 EQU   PSA+576                                                  02841000
PSAPIREG EQU   PSA+572                                                  02842000
PSARSREG EQU   PSA+568                                                  02843000
PSAGPREG EQU   PSA+556                                                  02844000
PSARV022 EQU   PSASUP4                                                  02845000
PSARV021 EQU   PSASUP4                                                  02846000
PSARV020 EQU   PSASUP4                                                  02847000
PSARV019 EQU   PSASUP4                                                  02848000
PSARV018 EQU   PSASUP4                                                  02849000
PSARV017 EQU   PSASUP4                                                  02850000
PSARV016 EQU   PSASUP4                                                  02851000
PSARV015 EQU   PSASUP4                                                  02852000
PSARV014 EQU   PSASUP3                                                  02853000
PSARV013 EQU   PSASUP3                                                  02854000
PSARV012 EQU   PSASUP3                                                  02855000
PSARV011 EQU   PSASUP3                                                  02856000
PSARV010 EQU   PSASUP3                                                  02857000
PSAPSREG EQU   PSASUP3                                                  02858000
PSAPI2   EQU   PSASUP3                                                  02859000
PSAIOSUP EQU   PSASUP3                                                  02860000
PSALCR   EQU   PSASUP2                                                  02861000
PSARTM   EQU   PSASUP2                                                  02862000
PSAACR   EQU   PSASUP2                                                  02863000
PSAIPCE2 EQU   PSASUP2                                                  02864000
PSAIPCES EQU   PSASUP2                                                  02865000
PSAIPCEC EQU   PSASUP2                                                  02866000
PSAGTF   EQU   PSASUP2                                                  02867000
PSAIPCRI EQU   PSASUP2                                                  02868000
PSAIPCRP EQU   PSASUP1                                                  02869000
PSAIPCDR EQU   PSASUP1                                                  02870000
PSADISP  EQU   PSASUP1                                                  02871000
PSALOCK  EQU   PSASUP1                                                  02872000
PSAPI    EQU   PSASUP1                                                  02873000
PSAEXT   EQU   PSASUP1                                                  02874000
PSASVC   EQU   PSASUP1                                                  02875000
PSAIO    EQU   PSASUP1                                                  02876000
PSAANEW  EQU   PSA+544                                                  02877000
PSATNEW  EQU   PSA+536                                                  02878000
PSALCCAR EQU   PSA+532                                                  02879000
PSALCCAV EQU   PSA+528                                                  02880000
PSAPCCAR EQU   PSA+524                                                  02881000
PSAPCCAV EQU   PSA+520                                                  02882000
PSACPULA EQU   PSA+518                                                  02883000
PSACPUPA EQU   PSA+516                                                  02884000
PSAPSA   EQU   PSA+512                                                  02885000
FLCHDEND EQU   PSA+512                                                  02886000
FLCCRSAV EQU   FLCMCLA+280                                              02887000
FLCGRSAV EQU   FLCMCLA+216                                              02888000
FLCFPSAV EQU   FLCMCLA+184                                              02889000
FLCFLA   EQU   FLCMCLA+88                                               02890000
FLCRGNCD EQU   FLCMCLA+84                                               02891000
FLCFSAA  EQU   FLCFSA+1                                                 02892000
@NM00031 EQU   FLCFSA                                                   02893000
@NM00030 EQU   FLCMCLA+72                                               02894000
FLCMCIC  EQU   FLCMCLA+64                                               02895000
@NM00029 EQU   FLCMCLA+20                                               02896000
FLCIOAA  EQU   FLCIOA+1                                                 02897000
@NM00028 EQU   FLCIOA                                                   02898000
@NM00027 EQU   FLCMCLA+15                                               02899000
@NM00026 EQU   FLCMCLA+14                                               02900000
@NM00025 EQU   FLCMCLA+12                                               02901000
FLCLCL   EQU   FLCMCLA+8                                                02902000
FLCIOELA EQU   FLCIOEL+1                                                02903000
@NM00024 EQU   FLCIOEL                                                  02904000
FLCCHNID EQU   FLCMCLA                                                  02905000
@NM00023 EQU   PSA+160                                                  02906000
FLCMTRCD EQU   PSA+157                                                  02907000
@NM00022 EQU   PSA+156                                                  02908000
FLCPERA  EQU   FLCPER+1                                                 02909000
@NM00021 EQU   FLCPER                                                   02910000
@NM00020 EQU   PSA+151                                                  02911000
FLCPERCD EQU   PSA+150                                                  02912000
FLCMCNUM EQU   PSA+149                                                  02913000
@NM00019 EQU   PSA+148                                                  02914000
FLCTEAA  EQU   FLCTEA+1                                                 02915000
@NM00018 EQU   FLCTEA                                                   02916000
PSAPIPC  EQU   PSAPICOD                                                 02917000
PSAPIMC  EQU   PSAPICOD                                                 02918000
PSAPIPER EQU   PSAPICOD                                                 02919000
PSARV049 EQU   FLCPICOD                                                 02920000
FLCPILCB EQU   FLCPIILC                                                 02921000
@NM00017 EQU   FLCPIILC                                                 02922000
@NM00016 EQU   PSAEPPSW                                                 02923000
FLCSVCN  EQU   PSAESPSW+2                                               02924000
FLCSILCB EQU   FLCSVILC                                                 02925000
@NM00015 EQU   FLCSVILC                                                 02926000
@NM00014 EQU   PSAESPSW                                                 02927000
FLCEICOD EQU   PSAEEPSW+2                                               02928000
PSASPAD  EQU   PSAEEPSW                                                 02929000
@NM00013 EQU   PSA+128                                                  02930000
FLCINPSW EQU   PSA+120                                                  02931000
FLCMNPSW EQU   PSA+112                                                  02932000
FLCPNPSW EQU   PSA+104                                                  02933000
FLCSNPSW EQU   PSA+96                                                   02934000
FLCENPSW EQU   PSA+88                                                   02935000
FLCTRACE EQU   PSA+84                                                   02936000
FLCTIMER EQU   PSA+80                                                   02937000
FLCCVT2  EQU   PSA+76                                                   02938000
FLCCAW   EQU   PSA+72                                                   02939000
FLCCSW   EQU   PSA+64                                                   02940000
FLCIOPSW EQU   PSA+56                                                   02941000
FLCMOPSW EQU   PSA+48                                                   02942000
FLCPOPSW EQU   PSA+40                                                   02943000
FLCSOPSW EQU   PSA+32                                                   02944000
FLCEOPSW EQU   PSA+24                                                   02945000
@NM00012 EQU   FLCICCW2+4                                               02946000
FLCCVT   EQU   FLCICCW2                                                 02947000
FLCICCW1 EQU   FLCROPSW                                                 02948000
FLCIPPSW EQU   FLCRNPSW                                                 02949000
*                                      END UNREFERENCED COMPONENTS      02950000
@RT00109 EQU   NOTAUTH                                                  02951000
@RT00114 EQU   NOTAUTH                                                  02952000
@RT00125 EQU   RSMERR                                                   02953000
@RT00231 EQU   ETSPQE                                                   02954000
@RT00233 EQU   ETSPQE                                                   02955000
@RT00235 EQU   ETSPQE                                                   02956000
@RT00243 EQU   ETUKYSP                                                  02957000
@RT00247 EQU   ETFSPQE1                                                 02958000
@RT00258 EQU   ETFAQE                                                   02959000
@RT00261 EQU   ETFUKY1                                                  02960000
@RT00271 EQU   ETFSWA                                                   02961000
@RT00276 EQU   ETFRETN                                                  02962000
@RT00279 EQU   ETFSPQE3                                                 02963000
@RT00295 EQU   ETFRETN                                                  02964000
@RF00295 EQU   ETFSPQE2                                                 02965000
@RF00294 EQU   ETFAQE1                                                  02966000
@RF00293 EQU   ETFUKYSP                                                 02967000
@RF00292 EQU   ETFSPQE                                                  02968000
@RT00317 EQU   NOTAUTH                                                  02969000
@RT00321 EQU   PQ                                                       02970000
@RT00324 EQU   UNCHAINW                                                 02971000
@RT00326 EQU   PQ                                                       02972000
@RF00346 EQU   OUT                                                      02973000
@RF00357 EQU   OUT                                                      02974000
@RT00365 EQU   OUT                                                      02975000
@RT00368 EQU   UNCHAINP                                                 02976000
@RT00370 EQU   OUT                                                      02977000
@ENDDATA EQU   *                                                        02978000
         END   IEAVGCAS,(C'PLS0208',0603,74351)                         02979000
./  ADD  SSI=81940203,NAME=IEAVGFRR
         TITLE 'IEAVGFRR - FUNCTIONAL RECOVERY ROUTINE FOR GETMAIN/FREE*00001000
               EMAIN    '                                               00002000
IEAVGFRR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(22)                                             0001 00007000
         DC    C'IEAVGFRR UZ19994 78194'                           0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*                                                                  0039 00013000
*   /*****************************************************************/ 00014000
*   /*                                                               */ 00015000
*   /* SAVE RETURN ADDRESS, ANALYZE TYPE OF FAILURE, AND PROCESS IT  */ 00016000
*   /* ACCORDINGLY.                                                  */ 00017000
*   /*                                                               */ 00018000
*   /*****************************************************************/ 00019000
*                                                                  0039 00020000
*   PARMSV14=RRETURN;               /* SAVE RETURN ADDRESS           */ 00021000
         L     @15,SDWAPARM(,SDWAPTR)                              0039 00022000
         ST    RRETURN,PARMSV14(,@15)                              0039 00023000
*   RESPECIFY                                                      0040 00024000
*     RRETURN UNRESTRICTED;                                        0040 00025000
*   IF SDWAFMID¬=0&PARMGLBL=OFF THEN/* IS THIS CURRENT ADDRESS SPACE    00026000
*                                      OR A GLOBAL REQUEST           */ 00027000
         LH    @07,SDWAFMID(,SDWAPTR)                              0041 00028000
         N     @07,@CF02575                                        0041 00029000
         LTR   @07,@07                                             0041 00030000
         BZ    @RF00041                                            0041 00031000
         TM    PARMGLBL(@15),B'10000000'                           0041 00032000
         BNZ   @RF00041                                            0041 00033000
*     DO;                           /* NO                            */ 00034000
*                                                                  0042 00035000
*       /*************************************************************/ 00036000
*       /*                                                           */ 00037000
*       /* MASTER SCHEDULER'S ADDRESS SPACE AND A LOCAL STORAGE      */ 00038000
*       /* REQUEST. CANNOT ADDRESS LDA.                              */ 00039000
*       /*                                                           */ 00040000
*       /*************************************************************/ 00041000
*                                                                  0043 00042000
*       IF PARMSALO=ON THEN         /* IF SALLOC LOCK OBTAINED       */ 00043000
         TM    PARMSALO(@15),B'01000000'                           0043 00044000
         BNO   @RF00043                                            0043 00045000
*         SDWASALL=ON;              /* INDICATE SALLOC TO BE FREED   */ 00046000
         OI    SDWASALL(SDWAPTR),B'00000100'                       0044 00047000
*       IF SDWAEAS¬=ON THEN         /* WAS ERROR ALREADY SERVICED    */ 00048000
@RF00043 TM    SDWAEAS(SDWAPTR),B'00001000'                        0045 00049000
         BO    @RF00045                                            0045 00050000
*         DO;                       /* NO, RECORD                    */ 00051000
*           SDWARCRD=ON;            /* SET RECORD FLAG               */ 00052000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0047 00053000
*           SDWAMODN=MDCSNAME;      /* MODULE NAME                   */ 00054000
         MVC   SDWAMODN(8,SDWAPTR),MDCSNAME                        0048 00055000
*           SDWACSCT=MDCSNAME;      /* CSECT NAME                    */ 00056000
         MVC   SDWACSCT(8,SDWAPTR),MDCSNAME                        0049 00057000
*           SDWAREXN=FRRNAME;       /* FRR NAME                      */ 00058000
         MVC   SDWAREXN(8,SDWAPTR),FRRNAME                         0050 00059000
*         END;                                                     0051 00060000
*       RESPECIFY                                                  0052 00061000
*         RRETURN RESTRICTED;                                      0052 00062000
@RF00045 DS    0H                                                  0053 00063000
*       RRETURN=PARMSV14;           /* RESTORE RETURN ADDRESS        */ 00064000
         L     @05,SDWAPARM(,SDWAPTR)                              0053 00065000
         L     RRETURN,PARMSV14(,@05)                              0053 00066000
*       RETURN;                     /* CONTINUE TERMINATION        0054 00067000
*                                      (PERCOLATE)                   */ 00068000
@EL00001 DS    0H                                                  0054 00069000
@EF00001 DS    0H                                                  0054 00070000
@ER00001 BR    @14                                                 0054 00071000
*       RESPECIFY                                                  0055 00072000
*         RRETURN UNRESTRICTED;                                    0055 00073000
*     END;                                                         0056 00074000
*                                                                  0056 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* SEE IF ERROR OCCURRED DURING VALIDITY CHECKING OF PARMS FOR   */ 00078000
*   /* SVC4 OR SVC5.                                         @ZA20641*/ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0057 00082000
*   IF PARMVLCK=ON THEN             /* DOING VALIDITY CK?    @ZA20641*/ 00083000
@RF00041 L     @07,SDWAPARM(,SDWAPTR)                              0057 00084000
         TM    PARMVLCK(@07),B'00100000'                           0057 00085000
         BNO   @RF00057                                            0057 00086000
*     DO;                           /* YES                   @ZA20641*/ 00087000
*       DO;                         /* SETRP RC(4)FRESDWA(YES)RETREGS   00088000
*                                      (YES)RETADDR(RETRYAD)         */ 00089000
*         RESPECIFY                                                0060 00090000
*          (GPR00P,                                                0060 00091000
*           GPR01P,                                                0060 00092000
*           GPR14P,                                                0060 00093000
*           GPR15P) RSTD;                                          0060 00094000
*         GPR01P->SDWARCDE=4;       /* STORE RC INTO SDWA            */ 00095000
         MVI   SDWARCDE(GPR01P),X'04'                              0061 00096000
*         GPR01P->SDWARTYA=ADDR(RETRYAD);/* SAVE RETRY ADDRESS       */ 00097000
         L     @05,@CV02272                                        0062 00098000
         ST    @05,SDWARTYA(,GPR01P)                               0062 00099000
*         GPR01P->SDWAFREE='1'B;    /* SET FLAG TO FREE SDWA         */ 00100000
*         GPR01P->SDWAUPRG='1'B;    /* TURN ON RETREGS INDICATOR     */ 00101000
         OI    SDWAFREE(GPR01P),B'00001100'                        0064 00102000
*         RESPECIFY                                                0065 00103000
*          (GPR00P,                                                0065 00104000
*           GPR01P,                                                0065 00105000
*           GPR14P,                                                0065 00106000
*           GPR15P) UNRSTD;                                        0065 00107000
*       END;                        /* RETRY AT LABEL PLISTERR IN  0066 00108000
*                                      IEAVGM00              @ZA20641*/ 00109000
*       RETURN;                     /* RETURN TO RTM         @ZA20641*/ 00110000
         B     @EL00001                                            0067 00111000
*     END;                          /*                       @ZA20641*/ 00112000
*   ELSE                            /* NOT VALIDITY CHECKING @ZA20641*/ 00113000
*                                                                  0069 00114000
*     /***************************************************************/ 00115000
*     /*                                                             */ 00116000
*     /* CURRENT ADDRESS SPACE, CAN ADDRESS LDA.                     */ 00117000
*     /*                                                             */ 00118000
*     /***************************************************************/ 00119000
*                                                                  0069 00120000
*     LDAPTR=PARMLDA;               /* LOAD LDA POINTER              */ 00121000
@RF00057 L     @07,SDWAPARM(,SDWAPTR)                              0069 00122000
         L     LDAPTR,PARMLDA(,@07)                                0069 00123000
*   SAVAREG=ADDR(REGSAVE);          /* REGISTER SAVE AREA FOR SDUMP     00124000
*                                      AND ADDRESSABILITY FOR      0070 00125000
*                                      AUTOMATIC VARIABLES           */ 00126000
         LA    SAVAREG,REGSAVE(,LDAPTR)                            0070 00127000
*   GEN(USING @DATD,SAVAREG);       /* TELL ASSEMBLER HOW TO ADDRESS    00128000
*                                      AUTOMATIC VARIABLES           */ 00129000
         USING @DATD,SAVAREG                                            00130000
*   VRAPTR=ADDR(SDWAVRA);           /* POINT TO BEGINNING OF SDWAVRA    00131000
*                                                            @ZA08146*/ 00132000
         LA    VRAPTR,SDWAVRA(,SDWAPTR)                            0072 00133000
*   VRADATA(1:4)=LDARQSTA;          /* SAVE CURRENT GM/FM STATUS   0073 00134000
*                                                            @ZA08146*/ 00135000
         MVC   VRADATA(4,VRAPTR),LDARQSTA(LDAPTR)                  0073 00136000
*   SDWAURAL=SDWAURAL+4;            /* UPDATE LENGTH OF USER DATA IN    00137000
*                                      VRA                   @ZA08146*/ 00138000
         LA    @07,4                                               0074 00139000
         SLR   @05,@05                                             0074 00140000
         IC    @05,SDWAURAL(,SDWAPTR)                              0074 00141000
         ALR   @05,@07                                             0074 00142000
         STC   @05,SDWAURAL(,SDWAPTR)                              0074 00143000
*   VRAPTR=VRAPTR+4;                /* POINT TO NEXT AVAIL SPACE IN     00144000
*                                      VRA                   @ZA08146*/ 00145000
         ALR   VRAPTR,@07                                          0075 00146000
*   IF BRENTRY=ON&FREEMB=OFF&EXPANSN=OFF THEN/* BRANCH ENTRY?      0076 00147000
*                                                            @ZA08146*/ 00148000
         TM    BRENTRY(LDAPTR),B'00000001'                         0076 00149000
         BNO   @RF00076                                            0076 00150000
         TM    FREEMB(LDAPTR),B'00010100'                          0076 00151000
         BNZ   @RF00076                                            0076 00152000
*     REGSPTR=ADDR(BRANCHSV);       /* BRANCH ENTRY, USE LDA REGS  0077 00153000
*                                                            @ZA08146*/ 00154000
         LA    REGSPTR,BRANCHSV(,LDAPTR)                           0077 00155000
*   ELSE                            /*                       @ZA08146*/ 00156000
*     DO;                           /*                       @ZA08146*/ 00157000
         B     @RC00076                                            0078 00158000
@RF00076 DS    0H                                                  0079 00159000
*       IF BRENTRY=OFF THEN         /* SVC ENTRY?            @ZA08146*/ 00160000
         TM    BRENTRY(LDAPTR),B'00000001'                         0079 00161000
         BNZ   @RF00079                                            0079 00162000
*         REGSPTR=ADDR(PSATOLD->TCBGRS);/* SVC ENTRY, USE TCB REGS 0080 00163000
*                                                            @ZA08146*/ 00164000
         L     REGSPTR,PSATOLD                                     0080 00165000
         LA    REGSPTR,TCBGRS(,REGSPTR)                            0080 00166000
*       ELSE                        /*                       @ZA08146*/ 00167000
*         GO TO INTGMFM;            /*                       @ZA08146*/ 00168000
*     END;                          /*                       @ZA08146*/ 00169000
*   VRADATA(1:64)=INTFREGS;         /* REGS 0 THRU 15 TO VRA @ZA08146*/ 00170000
@RC00076 MVC   VRADATA(64,VRAPTR),INTFREGS(REGSPTR)                0083 00171000
*   SDWAURAL=SDWAURAL+64;           /* UPDATE LENGTH OF USER DATA IN    00172000
*                                      VRA                   @ZA08146*/ 00173000
         LA    @07,64                                              0084 00174000
         SLR   @05,@05                                             0084 00175000
         IC    @05,SDWAURAL(,SDWAPTR)                              0084 00176000
         ALR   @07,@05                                             0084 00177000
         STC   @07,SDWAURAL(,SDWAPTR)                              0084 00178000
*INTGMFM:                           /*                       @ZA08146*/ 00179000
*   CALL RECORD;                    /* RECORD SDWA                   */ 00180000
INTGMFM  BAL   @14,RECORD                                          0085 00181000
*   CALL SVCDUMP;                   /* ISSUE SVC DUMP                */ 00182000
         BAL   @14,SVCDUMP                                         0086 00183000
*   QFLAGS=0;                       /* RESET QUEUE FLAGS             */ 00184000
         MVI   QFLAGS,X'00'                                        0087 00185000
*   IF SALHELD=ON|SALOBTND=ON THEN  /* IS SALLOC CURRENTLY HELD      */ 00186000
         TM    SALHELD(LDAPTR),B'00000011'                         0088 00187000
         BZ    @RF00088                                            0088 00188000
*     QSALLOC=ON;                   /* YES, INDICATE THIS            */ 00189000
         OI    QSALLOC,B'00100000'                                 0089 00190000
*   GO TO ROUTINE;                  /* GO TO APPROPRIATE ROUTINE FOR    00191000
*                                      ERROR TYPE                    */ 00192000
@RF00088 SLR   @07,@07                                             0090 00193000
         IC    @07,FRRBRNDX(,LDAPTR)                               0090 00194000
         SLA   @07,2                                               0090 00195000
         L     @07,BRTABLE(@07)                                    0090 00196000
         BR    @07                                                 0090 00197000
*                                                                  0091 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /* UNEXPECTED ERROR (FRRBRNDX NEVER SET NON-ZERO). THIS INCLUDES */ 00201000
*   /* RESTART KEY PRESSED, MACHINE ERROR, AND PERCOLATION FROM LOWER*/ 00202000
*   /* LEVEL FRR.                                                    */ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0091 00206000
*UNEXPERR:                                                         0091 00207000
*   ;                                                              0091 00208000
*                                                                  0091 00209000
UNEXPERR DS    0H                                                  0092 00210000
*   /*****************************************************************/ 00211000
*   /*                                                               */ 00212000
*   /* FREE SALLOC LOCK IF HELD, REPAIR QUEUES, AND TERMINATE REQUEST*/ 00213000
*   /* (PERCOLATE TO NEXT HIGHER FRR).                               */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                                  0092 00217000
*   CALL FREELOCK;                  /* FREE SALLOC LOCK IF OBTAINED  */ 00218000
         BAL   @14,FREELOCK                                        0092 00219000
*   CALL QREPAIR;                   /* REPAIR QUEUES                 */ 00220000
         BAL   @14,QREPAIR                                         0093 00221000
*   RESPECIFY                                                      0094 00222000
*     RRETURN RESTRICTED;                                          0094 00223000
*   RRETURN=PARMSV14;               /* RESTORE RETURN ADDRESS        */ 00224000
         L     @05,SDWAPARM(,SDWAPTR)                              0095 00225000
         L     RRETURN,PARMSV14(,@05)                              0095 00226000
*   RETURN;                         /* CONTINUE TERMINATION        0096 00227000
*                                      (PERCOLATE)                   */ 00228000
         B     @EL00001                                            0096 00229000
*   RESPECIFY                                                      0097 00230000
*     RRETURN UNRESTRICTED;                                        0097 00231000
*                                                                  0098 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* SALLOC LOCK RELEASE RETURN CODE WAS GREATER THAN ZERO.        */ 00235000
*   /*                                                               */ 00236000
*   /*****************************************************************/ 00237000
*                                                                  0098 00238000
*CLSALFLD:                                                         0098 00239000
*   ;                                                              0098 00240000
*                                                                  0098 00241000
CLSALFLD DS    0H                                                  0099 00242000
*   /*****************************************************************/ 00243000
*   /*                                                               */ 00244000
*   /* PAGE RELEASE RETURN CODE WAS NOT ZERO OR EIGHT.               */ 00245000
*   /*                                                               */ 00246000
*   /*****************************************************************/ 00247000
*                                                                  0099 00248000
*PGRLSRC4:                                                         0099 00249000
*   ;                                                              0099 00250000
*                                                                  0099 00251000
PGRLSRC4 DS    0H                                                  0100 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* CONTINUE PROCESSING (RETRY).                                  */ 00255000
*   /*                                                               */ 00256000
*   /*****************************************************************/ 00257000
*                                                                  0100 00258000
*   FRRBRNDX=C0;                    /* SET FRRBRNDX TO 0             */ 00259000
         MVI   FRRBRNDX(LDAPTR),X'00'                              0100 00260000
*   SDWARTYA=SDWANXT1;              /* GET RETRY ADDRESS (NEXT     0101 00261000
*                                      INSTRUCTION AFTER C0D ABEND)  */ 00262000
         L     @05,SDWANXT1(,SDWAPTR)                              0101 00263000
         ST    @05,SDWARTYA(,SDWAPTR)                              0101 00264000
*   SDWARCDE=C4;                    /* SET RETURN CODE 4 (RETRY)     */ 00265000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0102 00266000
*   RESPECIFY                                                      0103 00267000
*     RRETURN RESTRICTED;                                          0103 00268000
*   RRETURN=PARMSV14;               /* RESTORE RETURN ADDRESS        */ 00269000
         L     @05,SDWAPARM(,SDWAPTR)                              0104 00270000
         L     RRETURN,PARMSV14(,@05)                              0104 00271000
*   RETURN;                         /* CONTINUE EXECUTION (RETRY)    */ 00272000
         B     @EL00001                                            0105 00273000
*   RESPECIFY                                                      0106 00274000
*     RRETURN UNRESTRICTED;                                        0106 00275000
*                                                                  0107 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* CREATE SEGMENT RETURN CODE WAS GREATER THAN ZERO.             */ 00279000
*   /*                                                               */ 00280000
*   /*****************************************************************/ 00281000
*                                                                  0107 00282000
*CRSEGERR:                                                         0107 00283000
*   ;                                                              0107 00284000
*                                                                  0107 00285000
CRSEGERR DS    0H                                                  0108 00286000
*   /*****************************************************************/ 00287000
*   /*                                                               */ 00288000
*   /* FIND PAGE RETURN CODE NOT ZERO OR FOUR.                       */ 00289000
*   /*                                                               */ 00290000
*   /*****************************************************************/ 00291000
*                                                                  0108 00292000
*FNDPGERR:                                                         0108 00293000
*   ;                                                              0108 00294000
*                                                                  0108 00295000
FNDPGERR DS    0H                                                  0109 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* GFRECORE FAILED ON SQA OR LSQA EXPANSION.                     */ 00299000
*   /*                                                               */ 00300000
*   /*****************************************************************/ 00301000
*                                                                  0109 00302000
*GFREFAIL:                                                         0109 00303000
*   ;                                                              0109 00304000
*                                                                  0109 00305000
GFREFAIL DS    0H                                                  0110 00306000
*   /*****************************************************************/ 00307000
*   /*                                                               */ 00308000
*   /* SALLOC LOCK OBTAIN RETURN CODE WAS NOT ZERO OR FOUR.          */ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0110 00312000
*GTSALFLD:                                                         0110 00313000
*   ;                                                              0110 00314000
*                                                                  0110 00315000
GTSALFLD DS    0H                                                  0111 00316000
*   /*****************************************************************/ 00317000
*   /*                                                               */ 00318000
*   /* SUBPOOL FREEMAIN FOR SUBPOOL 253 FOUND AN AQE WHOSE AREA WAS  */ 00319000
*   /* NOT IN AN LSQA DQE.                                           */ 00320000
*   /*                                                               */ 00321000
*   /*****************************************************************/ 00322000
*                                                                  0111 00323000
*SPFMERR:                                                          0111 00324000
*   ;                                                              0111 00325000
*                                                                  0111 00326000
SPFMERR  DS    0H                                                  0112 00327000
*   /*****************************************************************/ 00328000
*   /*                                                               */ 00329000
*   /* FREE SALLOC LOCK IF HELD, REPAIR QUEUES, AND TERMINATE REQUEST*/ 00330000
*   /* WITH 7XY COMPLETION CODE.                                     */ 00331000
*   /*                                                               */ 00332000
*   /*****************************************************************/ 00333000
*                                                                  0112 00334000
*   CALL FREELOCK;                  /* FREE SALLOC LOCK IF OBTAINED  */ 00335000
         BAL   @14,FREELOCK                                        0112 00336000
*   CALL QREPAIR;                   /* REPAIR QUEUES                 */ 00337000
         BAL   @14,QREPAIR                                         0113 00338000
*   SDWACMPC=(SVCBYTE+SYSERR)*4096; /* CREATE 7XY COMPLETION CODE, 0114 00339000
*                                      SHIFT INTO SYSTEM POSITION (12   00340000
*                                      BITS LEFT), AND PLACE IN SDWA */ 00341000
         SLR   @05,@05                                             0114 00342000
         IC    @05,SVCBYTE(,LDAPTR)                                0114 00343000
         AL    @05,SYSERR                                          0114 00344000
         SLA   @05,12                                              0114 00345000
         STCM  @05,7,SDWACMPC(SDWAPTR)                             0114 00346000
*   RESPECIFY                                                      0115 00347000
*     RRETURN RESTRICTED;                                          0115 00348000
*   RRETURN=PARMSV14;               /* RESTORE RETURN ADDRESS        */ 00349000
         L     @05,SDWAPARM(,SDWAPTR)                              0116 00350000
         L     RRETURN,PARMSV14(,@05)                              0116 00351000
*   RETURN;                         /* CONTINUE TERMINATION        0117 00352000
*                                      (PERCOLATE)                   */ 00353000
         B     @EL00001                                            0117 00354000
*   RESPECIFY                                                      0118 00355000
*     RRETURN UNRESTRICTED;                                        0118 00356000
*                                                                  0119 00357000
*   /*****************************************************************/ 00358000
*   /*                                                               */ 00359000
*   /* PROCEDURE TO INDICATE THAT THE SALLOC LOCK SHOULD BE FREED.   */ 00360000
*   /*                                                               */ 00361000
*   /*****************************************************************/ 00362000
*                                                                  0119 00363000
*FREELOCK:                                                         0119 00364000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0119 00365000
FREELOCK DS    0H                                                  0120 00366000
*   RESPECIFY                                                      0120 00367000
*     RRETURN RESTRICTED;                                          0120 00368000
*   SALHELD=OFF;                    /* INDICATE SALLOC NOT HELD      */ 00369000
         NI    SALHELD(LDAPTR),B'11111110'                         0121 00370000
*   IF SALOBTND=ON THEN             /* WAS SALLOC OBTAINED           */ 00371000
         TM    SALOBTND(LDAPTR),B'00000010'                        0122 00372000
         BNO   @RF00122                                            0122 00373000
*     DO;                           /* YES                           */ 00374000
*       SDWASALL=ON;                /* INDICATE SALLOC TO BE FREED   */ 00375000
         OI    SDWASALL(SDWAPTR),B'00000100'                       0124 00376000
*       SALOBTND=OFF;               /* RESET SALLOC OBTAINED FLAG    */ 00377000
         NI    SALOBTND(LDAPTR),B'11111101'                        0125 00378000
*     END;                                                         0126 00379000
*   RETURN;                         /* RETURN TO CALLER              */ 00380000
@EL00002 DS    0H                                                  0127 00381000
@EF00002 DS    0H                                                  0127 00382000
@ER00002 BR    @14                                                 0127 00383000
*   RESPECIFY                                                      0128 00384000
*     RRETURN UNRESTRICTED;                                        0128 00385000
*   END FREELOCK;                                                  0129 00386000
         B     @EL00002                                            0129 00387000
*                                                                  0130 00388000
*   /*****************************************************************/ 00389000
*   /*                                                               */ 00390000
*   /* PROCEDURE TO ADD FRRBRNDX VALUE TO VARIABLE RECORDING AREA IN */ 00391000
*   /* SDWA, TO PUT MODULE AND CSECT NAMES IN SDWA, AND TO TURN ON   */ 00392000
*   /* RECORDING FLAG.                                               */ 00393000
*   /*                                                               */ 00394000
*   /*****************************************************************/ 00395000
*                                                                  0130 00396000
*RECORD:                                                           0130 00397000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0130 00398000
RECORD   DS    0H                                                  0131 00399000
*   RESPECIFY                                                      0131 00400000
*     RRETURN RESTRICTED;                                          0131 00401000
*   SDWAVRA(SDWAURAL+C1:SDWAURAL+C4)=C0;/* CLEAR SPACE FOR FRRBRNDX  */ 00402000
         SLR   @15,@15                                             0132 00403000
         IC    @15,SDWAURAL(,SDWAPTR)                              0132 00404000
         SLR   @07,@07                                             0132 00405000
         ALR   @15,SDWAPTR                                         0132 00406000
         STCM  @07,15,SDWAVRA(@15)                                 0132 00407000
*   SDWAVRA(SDWAURAL+C4)=FRRBRNDX;  /* PUT FRRBRNDX IN SDWAVRA       */ 00408000
         SLR   @15,@15                                             0133 00409000
         IC    @15,SDWAURAL(,SDWAPTR)                              0133 00410000
         ALR   @15,SDWAPTR                                         0133 00411000
         MVC   SDWAVRA+3(1,@15),FRRBRNDX(LDAPTR)                   0133 00412000
*   SDWAHEX=ON;                     /* INDICATE HEXADECIMAL DATA     */ 00413000
         OI    SDWAHEX(SDWAPTR),B'10000000'                        0134 00414000
*   SDWAURAL=SDWAURAL+C4;           /* ADD 4 TO DATA LENGTH          */ 00415000
         SLR   @15,@15                                             0135 00416000
         IC    @15,SDWAURAL(,SDWAPTR)                              0135 00417000
         AL    @15,@CF00046                                        0135 00418000
         STC   @15,SDWAURAL(,SDWAPTR)                              0135 00419000
*   SDWARCRD=ON;                    /* SET RECORD FLAG               */ 00420000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0136 00421000
*   SDWAMODN=MDCSNAME;              /* MODULE NAME                   */ 00422000
         MVC   SDWAMODN(8,SDWAPTR),MDCSNAME                        0137 00423000
*   SDWACSCT=MDCSNAME;              /* CSECT NAME                    */ 00424000
         MVC   SDWACSCT(8,SDWAPTR),MDCSNAME                        0138 00425000
*   SDWAREXN=FRRNAME;               /* FRR NAME                      */ 00426000
         MVC   SDWAREXN(8,SDWAPTR),FRRNAME                         0139 00427000
*   RETURN;                         /* RETURN TO CALLER              */ 00428000
@EL00003 DS    0H                                                  0140 00429000
@EF00003 DS    0H                                                  0140 00430000
@ER00003 BR    @14                                                 0140 00431000
*   RESPECIFY                                                      0141 00432000
*     RRETURN UNRESTRICTED;                                        0141 00433000
*   END RECORD;                                                    0142 00434000
*                                                                  0143 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* PROCEDURE TO DUMP PORTIONS OF VIRTUAL STORAGE ON THE SYS1.DUMP*/ 00438000
*   /* DATA SET UNLESS THIS WAS A MACHINE ERROR OR THE ERROR WAS     */ 00439000
*   /* ALREADY SERVICED.                                             */ 00440000
*   /*                                                               */ 00441000
*   /*****************************************************************/ 00442000
*                                                                  0143 00443000
*SVCDUMP:                                                          0143 00444000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0143 00445000
SVCDUMP  DS    0H                                                  0144 00446000
*   RESPECIFY                                                      0144 00447000
*     RRETURN RESTRICTED;                                          0144 00448000
*   DECLARE                                                        0145 00449000
*     CURRASID REGISTER(2),         /* CURRENT ASID FOR SDUMP        */ 00450000
*     SAVEREG1,                     /* SAVE REGISTER 1 OVER SDUMP    */ 00451000
*     SAVE14SD,                     /* SAVE RETURN REG IN SVCDUMP    */ 00452000
*     SVPARMFL,                     /* SAVE PARMFLGS                 */ 00453000
*     SVPARM14;                     /* SAVE PARMSV14                 */ 00454000
*   DECLARE                                                        0146 00455000
*     SDUMPL CHAR(LENGTH(SDUMP)) STATIC;/* SDUMP MACRO, LIST FORM    */ 00456000
*   GEN DATA DEFS(SDUMPL);                                         0147 00457000
*   IF SDWAMCHK=ON|SDWAEAS=ON THEN  /* MACHINE CHECK OR ERROR ALREADY   00458000
*                                      SERVICED?                     */ 00459000
         TM    SDWAMCHK(SDWAPTR),B'10000000'                       0148 00460000
         BO    @RT00148                                            0148 00461000
         TM    SDWAEAS(SDWAPTR),B'00001000'                        0148 00462000
         BO    @RT00148                                            0148 00463000
*     RETURN;                       /* YES, DON'T DUMP               */ 00464000
*   SVPARMFL=PARMFLGS;              /* SAVE PARAMETER AREA FLAGS     */ 00465000
         L     @15,SDWAPARM(,SDWAPTR)                              0150 00466000
         L     SVPARMFL,PARMFLGS(,@15)                             0150 00467000
*   SVPARM14=PARMSV14;              /* SAVE FRR RETURN ADDRESS       */ 00468000
         L     SVPARM14,PARMSV14(,@15)                             0151 00469000
*   FRRPARM=SDUMPL;                 /* MOVE DUMP LIST INTO PARAMETER    00470000
*                                      AREA BECAUSE SDUMP MACRO WILL    00471000
*                                      MODIFY IT                     */ 00472000
         MVC   FRRPARM(24,@15),SDUMPL                              0152 00473000
*   SAVEREG1=SDWAPTR;               /* SAVE REGISTER 1               */ 00474000
         LR    SAVEREG1,SDWAPTR                                    0153 00475000
*   SDWAPTR=ADDR(FRRPARM);          /* POINT TO DUMP PARAMETER LIST  */ 00476000
         LR    SDWAPTR,@15                                         0154 00477000
*   SAVE14SD=RRETURN;               /* SAVE RETURN ADDRESS           */ 00478000
         LR    SAVE14SD,RRETURN                                    0155 00479000
*   RESPECIFY                                                      0156 00480000
*     CURRASID RESTRICTED;                                         0156 00481000
*   CURRASID=ASCBASID;              /* GET CURRENT ASID              */ 00482000
         L     @15,ASCBPTR                                         0157 00483000
         LH    CURRASID,ASCBASID(,@15)                             0157 00484000
         N     CURRASID,@CF02575                                   0157 00485000
*   GEN REFS(SDWAPTR,CURRASID,SAVAREG,RRETURN,RTRNCODE,CVTSDMP);   0158 00486000
         SDUMP ASID=(CURRASID),BRANCH=YES,MF=(E,(SDWAPTR))  SVC DUMP    00487000
*   RESPECIFY                                                      0159 00488000
*     CURRASID UNRESTRICTED;                                       0159 00489000
*   SDWAPTR=SAVEREG1;               /* RESTORE REGISTER 1            */ 00490000
         LR    SDWAPTR,SAVEREG1                                    0160 00491000
*   PARMLDA=LDAPTR;                 /* RESTORE FRR PARAMETER AREA, 0161 00492000
*                                      LDA ADDRESS                   */ 00493000
         L     @15,SDWAPARM(,SDWAPTR)                              0161 00494000
         ST    LDAPTR,PARMLDA(,@15)                                0161 00495000
*   PARMFLGS=SVPARMFL;              /* FRR PARAMETER FLAGS           */ 00496000
         ST    SVPARMFL,PARMFLGS(,@15)                             0162 00497000
*   PARMSV14=SVPARM14;              /* FRR RETURN ADDRESS            */ 00498000
         ST    SVPARM14,PARMSV14(,@15)                             0163 00499000
*   RRETURN=SAVE14SD;               /* RESTORE RETURN ADDRESS        */ 00500000
         LR    RRETURN,SAVE14SD                                    0164 00501000
*   SDWAEAS=ON;                     /* SET SERVICEABILITY FLAG       */ 00502000
         OI    SDWAEAS(SDWAPTR),B'00001000'                        0165 00503000
*   RETURN;                         /* RETURN TO CALLER              */ 00504000
@EL00004 DS    0H                                                  0166 00505000
@EF00004 DS    0H                                                  0166 00506000
@ER00004 BR    @14                                                 0166 00507000
*   RESPECIFY                                                      0167 00508000
*     RRETURN UNRESTRICTED;                                        0167 00509000
*   END SVCDUMP;                                                   0168 00510000
         B     @EL00004                                            0168 00511000
*                                                                  0169 00512000
*   /*****************************************************************/ 00513000
*   /*                                                               */ 00514000
*   /* PROCEDURE TO REPAIR SUBPOOL QUEUES. SEVERAL GLOBAL POINTERS   */ 00515000
*   /* ARE CHECKED (WHERE THERE IS REDUNDANCY AVAILABLE) AND THE SPQE*/ 00516000
*   /* CHAINS ARE CHECKED AND REPAIRED FOR THOSE QUEUES USED BY THE  */ 00517000
*   /* FAILING REQUEST. SOME FREE OR ALLOCATED STORAGE MAY BE LOST   */ 00518000
*   /* RESULTING IN SOME 3XY ABENDS BY LATER REQUESTS.               */ 00519000
*   /*                                                               */ 00520000
*   /*****************************************************************/ 00521000
*                                                                  0169 00522000
*QREPAIR:                                                          0169 00523000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0169 00524000
QREPAIR  DS    0H                                                  0170 00525000
*   RESPECIFY                                                      0170 00526000
*     RRETURN RESTRICTED;                                          0170 00527000
*   SAVE14QR=RRETURN;               /* SAVE RETURN ADDRESS           */ 00528000
         ST    RRETURN,SAVE14QR                                    0171 00529000
*   RESPECIFY                                                      0172 00530000
*     RRETURN UNRESTRICTED;                                        0172 00531000
*   CSASTART=PASTRT+PASIZE;         /* START OF CSA FROM GDA         */ 00532000
         L     @05,CVTPTR                                          0173 00533000
         L     @15,GDAPTR(,@05)                                    0173 00534000
         L     CSASTART,PASTRT(,@15)                               0173 00535000
         AL    CSASTART,PASIZE(,@15)                               0173 00536000
*   RWORK1=PVTLCSA*256;             /* START OF CSA FROM PVT         */ 00537000
         L     @11,PVTPTR(,@05)                                    0174 00538000
         LH    RWORK1,PVTLCSA(,@11)                                0174 00539000
         N     RWORK1,@CF02575                                     0174 00540000
         SLA   RWORK1,8                                            0174 00541000
*   IF CSASTART¬=RWORK1 THEN        /* DO BOTH VALUES AGREE          */ 00542000
         CR    CSASTART,RWORK1                                     0175 00543000
         BE    @RF00175                                            0175 00544000
*     DO;                           /* NO, CHECK WITH THIRD VALUE    */ 00545000
*       RWORK2=CSAPQEP->PQEREGN;    /* START OF CSA FROM CSA PQE     */ 00546000
         L     @05,CSAPQEP(,@15)                                   0177 00547000
         L     RWORK2,PQEREGN(,@05)                                0177 00548000
*       IF RWORK2=CSASTART THEN     /* DOES THIS = CSASTART          */ 00549000
         CR    RWORK2,CSASTART                                     0178 00550000
         BNE   @RF00178                                            0178 00551000
*         DO;                       /* YES, PVTLCSA IN ERROR         */ 00552000
*           ERRCODE=ADDR(EC01);     /* SET ERROR CODE 01             */ 00553000
         LA    ERRCODE,EC01                                        0180 00554000
*           DATA1=ADDR(PVTLCSA);    /* DATA = PVTLCSA ADDR           */ 00555000
         LA    DATA1,PVTLCSA(,@11)                                 0181 00556000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 00557000
         BAL   @14,EDVRA                                           0182 00558000
*         END;                                                     0183 00559000
*       ELSE                        /* CSA PQE ¬= CSASTART           */ 00560000
*         DO;                                                      0184 00561000
         B     @RC00178                                            0184 00562000
@RF00178 DS    0H                                                  0185 00563000
*           IF RWORK1¬=RWORK2 THEN  /* DOES PVTLCSA = CSA PQE        */ 00564000
         CR    RWORK1,RWORK2                                       0185 00565000
         BE    @RF00185                                            0185 00566000
*             DO;                   /* NO, ALL THREE SOURCES DIFFER  */ 00567000
*               ERRCODE=ADDR(EC04); /* SET ERROR CODE 04             */ 00568000
         LA    ERRCODE,EC04                                        0187 00569000
*               CALL EDVRA;         /* PUT CODE IN VRA               */ 00570000
         BAL   @14,EDVRA                                           0188 00571000
*             END;                                                 0189 00572000
*           ELSE                    /* PVTLCSA = CSA PQE             */ 00573000
*             DO;                                                  0190 00574000
         B     @RC00185                                            0190 00575000
@RF00185 DS    0H                                                  0191 00576000
*               CSASTART=RWORK2;    /* SET CSASTART FROM CSA PQE     */ 00577000
         LR    CSASTART,RWORK2                                     0191 00578000
*               IF PASTRT¬=PVTLPRIV*256 THEN/* DOES PASTRT = PVTLPRIV*/ 00579000
         L     @11,CVTPTR                                          0192 00580000
         L     @05,GDAPTR(,@11)                                    0192 00581000
         L     @11,PVTPTR(,@11)                                    0192 00582000
         LH    @11,PVTLPRIV(,@11)                                  0192 00583000
         N     @11,@CF02575                                        0192 00584000
         SLA   @11,8                                               0192 00585000
         C     @11,PASTRT(,@05)                                    0192 00586000
         BE    @RF00192                                            0192 00587000
*                 DO;               /* NO, PASTRT WRONG              */ 00588000
*                   PASTRT=PVTLPRIV*256;/* CORRECT PASTRT            */ 00589000
         ST    @11,PASTRT(,@05)                                    0194 00590000
*                   ERRCODE=ADDR(EC02);/* SET ERROR CODE 02          */ 00591000
         LA    ERRCODE,EC02                                        0195 00592000
*                   DATA1=ADDR(PASTRT);/* DATA = PASTRT ADDRESS      */ 00593000
         LA    DATA1,PASTRT(,@05)                                  0196 00594000
*                   CALL EDVRA;     /* ENTER DATA IN VRA             */ 00595000
         BAL   @14,EDVRA                                           0197 00596000
*                 END;                                             0198 00597000
*               ELSE                /* PASTRT = PVTLPRIV             */ 00598000
*                 DO;               /* PASIZE WRONG                  */ 00599000
         B     @RC00192                                            0199 00600000
@RF00192 DS    0H                                                  0200 00601000
*                   ERRCODE=ADDR(EC03);/* SET ERROR CODE 03          */ 00602000
         LA    ERRCODE,EC03                                        0200 00603000
*                   DATA1=ADDR(PASIZE);/* DATA = PASIZE ADDRESS      */ 00604000
         L     @11,CVTPTR                                          0201 00605000
         L     DATA1,GDAPTR(,@11)                                  0201 00606000
         LA    DATA1,PASIZE(,DATA1)                                0201 00607000
*                   CALL EDVRA;     /* ENTER DATA IN VRA             */ 00608000
         BAL   @14,EDVRA                                           0202 00609000
*                 END;                                             0203 00610000
*               PASIZE=CSASTART-PASTRT;/* CORRECT PASIZE             */ 00611000
@RC00192 L     @11,CVTPTR                                          0204 00612000
         L     @11,GDAPTR(,@11)                                    0204 00613000
         LR    @05,CSASTART                                        0204 00614000
         SL    @05,PASTRT(,@11)                                    0204 00615000
         ST    @05,PASIZE(,@11)                                    0204 00616000
*             END;                                                 0205 00617000
*         END;                                                     0206 00618000
@RC00185 DS    0H                                                  0207 00619000
*     END;                                                         0207 00620000
*                                                                  0207 00621000
@RC00178 DS    0H                                                  0208 00622000
*   /*****************************************************************/ 00623000
*   /*                                                               */ 00624000
*   /* CHECK SQA QUEUE                                               */ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0208 00628000
*   IF QSALLOC=ON THEN              /* IS SALLOC LOCK CURRENTLY HELD */ 00629000
@RF00175 TM    QSALLOC,B'00100000'                                 0208 00630000
         BNO   @RF00208                                            0208 00631000
*     DO;                           /* YES, CHECK GLOBAL QUEUES      */ 00632000
*       IF SQA=ON THEN              /* IS CURRENT REQUEST FOR SQA    */ 00633000
         TM    SQA(LDAPTR),B'00000001'                             0210 00634000
         BNO   @RF00210                                            0210 00635000
*         DO;                       /* YES, THEN CHECK SQA QUEUE     */ 00636000
*           SPQEADDR=SQASPQEP;      /* SQA SPQE                      */ 00637000
         L     @11,CVTPTR                                          0212 00638000
         L     @11,GDAPTR(,@11)                                    0212 00639000
         L     @11,SQASPQEP(,@11)                                  0212 00640000
         ST    @11,SPQEADDR                                        0212 00641000
*           IF SPQEFLWD¬=SQASPQCK THEN/* IS SQA SPQE FLAGWORD GOOD   */ 00642000
         L     @05,SPQESPTR                                        0213 00643000
         CLC   SPQEFLWD(4,@05),SQASPQCK                            0213 00644000
         BE    @RF00213                                            0213 00645000
*             DO;                   /* NO, RECORD THIS               */ 00646000
*               ERRCODE=ADDR(ECB2); /* SET ERROR CODE B2             */ 00647000
         LA    ERRCODE,ECB2                                        0215 00648000
*               DATA1=SPQEADDR;     /* DATA = SPQE ADDRESS           */ 00649000
         LR    DATA1,@11                                           0216 00650000
*               CALL EDVRA;         /* ENTER DATA IN VRA             */ 00651000
         BAL   @14,EDVRA                                           0217 00652000
*             END;                                                 0218 00653000
*           QSQATYP=ON;             /* INDICATE SQA QUEUE            */ 00654000
@RF00213 OI    QSQATYP,B'00010000'                                 0219 00655000
*           CALL DQECHK;            /* CHECK SQA QUEUE               */ 00656000
         BAL   @14,DQECHK                                          0220 00657000
*           RESPECIFY                                              0221 00658000
*             RTRNCODE RESTRICTED;                                 0221 00659000
*           QSQATYP=OFF;            /* RESET SQA TYPE QUEUE          */ 00660000
         NI    QSQATYP,B'11101111'                                 0222 00661000
*           IF RTRNCODE¬=C0 THEN    /* IS SQA O.K.                   */ 00662000
         LTR   RTRNCODE,RTRNCODE                                   0223 00663000
         BNZ   @RT00223                                            0223 00664000
*             GO TO QREPAIR3;       /* NO, DISCONTINUE CHECKING      */ 00665000
*           RESPECIFY                                              0225 00666000
*             RTRNCODE UNRESTRICTED;                               0225 00667000
*         END;                                                     0226 00668000
*                                                                  0226 00669000
*       /*************************************************************/ 00670000
*       /*                                                           */ 00671000
*       /* CHECK CSA QUEUE                                           */ 00672000
*       /*                                                           */ 00673000
*       /*************************************************************/ 00674000
*                                                                  0227 00675000
*       IF CSA=ON|GETMB=ON&ADDR(GMBRQSTA)->CSA1=ON|FREEMB=ON&ADDR( 0227 00676000
*           SAVSVTSV)->CSA1=ON THEN /* WAS ORIGINAL REQUEST FOR CSA  */ 00677000
@RF00210 TM    CSA(LDAPTR),B'00000010'                             0227 00678000
         BO    @RT00227                                            0227 00679000
         TM    GETMB(LDAPTR),B'00000010'                           0227 00680000
         BNO   @GL00003                                            0227 00681000
         TM    CSA1+636(LDAPTR),B'00000010'                        0227 00682000
         BO    @RT00227                                            0227 00683000
@GL00003 TM    FREEMB(LDAPTR),B'00000100'                          0227 00684000
         BNO   @RF00227                                            0227 00685000
         TM    CSA1+484(LDAPTR),B'00000010'                        0227 00686000
         BNO   @RF00227                                            0227 00687000
@RT00227 DS    0H                                                  0228 00688000
*         DO;                       /* YES, CHECK CSA QUEUE          */ 00689000
*           SPQEADDR=ADDR(CSASPQEP);/* CSA SPQE POINTER              */ 00690000
         L     @11,CVTPTR                                          0229 00691000
         L     @11,GDAPTR(,@11)                                    0229 00692000
         LA    @11,CSASPQEP(,@11)                                  0229 00693000
         ST    @11,SPQEADDR                                        0229 00694000
*           QCSATYP=ON;             /* INDICATE CSA QUEUE            */ 00695000
         OI    QCSATYP,B'00001000'                                 0230 00696000
*           CALL SPQECHK;           /* CHECK CSA QUEUE               */ 00697000
         BAL   @14,SPQECHK                                         0231 00698000
*           QCSATYP=OFF;            /* RESET CSA TYPE QUEUE          */ 00699000
         NI    QCSATYP,B'11110111'                                 0232 00700000
*         END;                                                     0233 00701000
*                                                                  0233 00702000
*       /*************************************************************/ 00703000
*       /*                                                           */ 00704000
*       /* CHECK GLOBAL CELL QUEUE                                   */ 00705000
*       /*                                                           */ 00706000
*       /*************************************************************/ 00707000
*                                                                  0234 00708000
*       IF INCELL=ON THEN           /* IN A CELL ROUTINE?    @Z30ENWD*/ 00709000
@RF00227 TM    INCELL(LDAPTR),B'00000100'                          0234 00710000
         BNO   @RF00234                                            0234 00711000
*         DO;                       /* YES, CHECK POOL       @Z30ENWD*/ 00712000
*           CELLADD=ADDR(GLBLCELL); /* ADDRESS PARM          @Z30ENWD*/ 00713000
         L     @11,CVTPTR                                          0236 00714000
         L     CELLADD,GDAPTR(,@11)                                0236 00715000
         LA    CELLADD,GLBLCELL(,CELLADD)                          0236 00716000
*           CALL CELLCHK;           /* VALIDITY CHECK        @Z30ENWD*/ 00717000
         BAL   @14,CELLCHK                                         0237 00718000
*         END;                      /*                       @Z30ENWD*/ 00719000
*     END;                                                         0239 00720000
*                                                                  0239 00721000
@RF00234 DS    0H                                                  0240 00722000
*   /*****************************************************************/ 00723000
*   /*                                                               */ 00724000
*   /* CHECK LSQA QUEUE                                              */ 00725000
*   /*                                                               */ 00726000
*   /*****************************************************************/ 00727000
*                                                                  0240 00728000
*   IF LSQA=ON THEN                 /* IS CURRENT REQUEST FOR LSQA   */ 00729000
@RF00208 TM    LSQA(LDAPTR),B'00000100'                            0240 00730000
         BNO   @RF00240                                            0240 00731000
*     DO;                           /* YES, CHECK LSQA QUEUE         */ 00732000
*       SPQEADDR=LSQAPTR;           /* LSQA SPQE                     */ 00733000
         L     @11,LSQAPTR(,LDAPTR)                                0242 00734000
         ST    @11,SPQEADDR                                        0242 00735000
*       IF SPQEFLWD¬=LSQSPQCK THEN  /* IS LSQA SPQE FLAGWORD GOOD    */ 00736000
         L     @05,SPQESPTR                                        0243 00737000
         CLC   SPQEFLWD(4,@05),LSQSPQCK                            0243 00738000
         BE    @RF00243                                            0243 00739000
*         DO;                       /* NO, RECORD THIS               */ 00740000
*           ERRCODE=ADDR(ECB3);     /* SET ERROR CODE B3             */ 00741000
         LA    ERRCODE,ECB3                                        0245 00742000
*           DATA1=SPQEADDR;         /* DATA = SPQE ADDRESS           */ 00743000
         LR    DATA1,@11                                           0246 00744000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 00745000
         BAL   @14,EDVRA                                           0247 00746000
*         END;                                                     0248 00747000
*       QBLCKLOC=ON;                /* BLOCKS IN LSQA                */ 00748000
@RF00243 DS    0H                                                  0250 00749000
*       QLSQATYP=ON;                /* INDICATE LSQA QUEUE           */ 00750000
         OI    QBLCKLOC,B'10000100'                                0250 00751000
*       CALL DQECHK;                /* CHECK LSQA QUEUE              */ 00752000
         BAL   @14,DQECHK                                          0251 00753000
*       QLSQATYP=OFF;               /* RESET LSQA TYPE QUEUE         */ 00754000
         NI    QLSQATYP,B'11111011'                                0252 00755000
*     END;                                                         0253 00756000
*                                                                  0253 00757000
*   /*****************************************************************/ 00758000
*   /*                                                               */ 00759000
*   /* CHECK LOCAL CELL QUEUE                                        */ 00760000
*   /*                                                               */ 00761000
*   /*****************************************************************/ 00762000
*                                                                  0254 00763000
*   IF INCELL=ON&LCLREQ=ON THEN     /* IN A CELL ROUTINE     @Z30ENWD   00764000
*                                      FOR A LOCAL REQUEST?  @Z30ENWD*/ 00765000
@RF00240 TM    INCELL(LDAPTR),B'00100100'                          0254 00766000
         BNO   @RF00254                                            0254 00767000
*     DO;                           /* YES, CHECK POOL       @Z30ENWD*/ 00768000
*       QBLCKLOC=ON;                /* INDICATE LOCAL CELL POOL    0256 00769000
*                                                            @Z30ENYG*/ 00770000
         OI    QBLCKLOC,B'10000000'                                0256 00771000
*       CELLADD=ADDR(LCLCELL);      /* ADDRESS PARM          @Z30ENWD*/ 00772000
         LA    CELLADD,LCLCELL(,LDAPTR)                            0257 00773000
*       CALL CELLCHK;               /* VALIDITY CHECK        @Z30ENWD*/ 00774000
         BAL   @14,CELLCHK                                         0258 00775000
*     END;                                                         0259 00776000
*                                                                  0259 00777000
*   /*****************************************************************/ 00778000
*   /*                                                               */ 00779000
*   /* CHECK SWA, AUK (AUTHORIZED USER KEY SUBPOOLS 229 AND 230), AND*/ 00780000
*   /* REGION SUBPOOLS.                                              */ 00781000
*   /*                                                               */ 00782000
*   /*****************************************************************/ 00783000
*                                                                  0260 00784000
*   IF SQA=OFF&CSA=OFF&LSQA=OFF|GETMB=ON&ADDR(GMBRQSTA)->SQA1=OFF&ADDR( 00785000
*       GMBRQSTA)->CSA1=OFF&ADDR(GMBRQSTA)->LSQA1=OFF|FREEMB=ON&ADDR(   00786000
*       SAVSVTSV)->SQA1=OFF&ADDR(SAVSVTSV)->CSA1=OFF&ADDR(SAVSVTSV)->   00787000
*       LSQA1=OFF THEN              /* WAS ORIGINAL REQUEST FOR    0260 00788000
*                                      REGION, SWA, OR AUK           */ 00789000
@RF00254 TM    SQA(LDAPTR),B'00000111'                             0260 00790000
         BZ    @RT00260                                            0260 00791000
         TM    GETMB(LDAPTR),B'00000010'                           0260 00792000
         BNO   @GL00007                                            0260 00793000
         TM    SQA1+636(LDAPTR),B'00000111'                        0260 00794000
         BZ    @RT00260                                            0260 00795000
@GL00007 TM    FREEMB(LDAPTR),B'00000100'                          0260 00796000
         BNO   @RF00260                                            0260 00797000
         TM    SQA1+484(LDAPTR),B'00000111'                        0260 00798000
         BNZ   @RF00260                                            0260 00799000
@RT00260 DS    0H                                                  0261 00800000
*     DO;                           /* YES, CHECK THESE SUBPOOLS     */ 00801000
*       RFY                                                        0262 00802000
*         RTRNCODE RSTD;            /*                       @ZA08146*/ 00803000
*       RTRNCODE=TCBPTR;            /* GET TCB POINTER       @ZA08146*/ 00804000
         L     RTRNCODE,TCBPTR(,LDAPTR)                            0263 00805000
*       GEN SETS(RTRNCODE) FLOWS(BADTCB);                          0264 00806000
*                                               /* @ZA08146*/           00807000
         LRA   RTRNCODE,0(0,RTRNCODE) IS TCB IN REAL STG     @ZA08146   00808000
         BNZ   BADTCB                 NO, TCB IS INVALID     @ZA08146   00809000
*       RFY                                                        0265 00810000
*         RTRNCODE UNRSTD;          /*                       @ZA08146*/ 00811000
*       IF TCBTCBID=IDOFTCB THEN    /* IF THIS IS A VALID TCB        */ 00812000
         L     @11,TCBPTR(,LDAPTR)                                 0266 00813000
         CLC   TCBTCBID(4,@11),IDOFTCB                             0266 00814000
         BNE   @RF00266                                            0266 00815000
*         DO;                                                      0267 00816000
*           SPQEADDR=ADDR(TCBSWA);  /* SWA SPQE POINTER              */ 00817000
         LA    @11,TCBSWA(,@11)                                    0268 00818000
         ST    @11,SPQEADDR                                        0268 00819000
*           QBLCKLOC=ON;            /* BLOCKS IN LSQA                */ 00820000
*           QREGNTYP=ON;            /* INDICATE REGION, SWA, AUK     */ 00821000
         OI    QBLCKLOC,B'10000010'                                0270 00822000
*           CALL SPQECHK;           /* CHECK SWA QUEUE               */ 00823000
         BAL   @14,SPQECHK                                         0271 00824000
*           SPQEADDR=ADDR(TCBUKYSP);/* AUK SPQE POINTER              */ 00825000
         L     @11,TCBPTR(,LDAPTR)                                 0272 00826000
         LA    @11,TCBUKYSP(,@11)                                  0272 00827000
         ST    @11,SPQEADDR                                        0272 00828000
*           CALL SPQECHK;           /* CHECK AUK SUBPOOLS            */ 00829000
         BAL   @14,SPQECHK                                         0273 00830000
*           SPQEADDR=ADDR(TCBMSS);  /* REGION SPQE POINTER           */ 00831000
         L     @11,TCBPTR(,LDAPTR)                                 0274 00832000
         LA    @11,TCBMSS(,@11)                                    0274 00833000
         ST    @11,SPQEADDR                                        0274 00834000
*           CALL SPQECHK;           /* CHECK REGION SUBPOOLS         */ 00835000
         BAL   @14,SPQECHK                                         0275 00836000
*         END;                                                     0276 00837000
*       ELSE                        /* IF THIS IS NOT A VALID TCB    */ 00838000
*BADTCB:                                                           0277 00839000
*         DO;                       /*                       @ZA08146*/ 00840000
         B     @RC00266                                            0277 00841000
@RF00266 DS    0H                                                  0277 00842000
BADTCB   DS    0H                                                  0278 00843000
*           ERRCODE=ADDR(EC06);     /* SET ERROR CODE 6              */ 00844000
         LA    ERRCODE,EC06                                        0278 00845000
*           DATA1=LDATCB;           /* DATA = TCB ADDRESS            */ 00846000
         L     DATA1,LDATCB(,LDAPTR)                               0279 00847000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 00848000
         BAL   @14,EDVRA                                           0280 00849000
*         END;                                                     0281 00850000
*     END;                                                         0282 00851000
@RC00266 DS    0H                                                  0283 00852000
*   RESPECIFY                                                      0283 00853000
*     RRETURN RESTRICTED;                                          0283 00854000
@RF00260 DS    0H                                                  0284 00855000
*QREPAIR3:                                                         0284 00856000
*   RRETURN=SAVE14QR;               /* RESTORE RETURN ADDRESS        */ 00857000
QREPAIR3 L     RRETURN,SAVE14QR                                    0284 00858000
*   RETURN;                         /* RETURN TO CALLER              */ 00859000
@EL00005 DS    0H                                                  0285 00860000
@EF00005 DS    0H                                                  0285 00861000
@ER00005 BR    @14                                                 0285 00862000
*   RESPECIFY                                                      0286 00863000
*     RRETURN UNRESTRICTED;                                        0286 00864000
*   END QREPAIR;                                                   0287 00865000
*                                                                  0288 00866000
*   /*****************************************************************/ 00867000
*   /*                                                               */ 00868000
*   /* PROCEDURE TO SCAN AN SPQE QUEUE AND CHECK ALL SUBPOOL CONTROL */ 00869000
*   /* BLOCKS.                                                       */ 00870000
*   /*                                                               */ 00871000
*   /*****************************************************************/ 00872000
*                                                                  0288 00873000
*SPQECHK:                                                          0288 00874000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0288 00875000
SPQECHK  DS    0H                                                  0289 00876000
*   RESPECIFY                                                      0289 00877000
*     RRETURN RESTRICTED;                                          0289 00878000
*   IF SPQEADDR->SPQEPTR=C0 THEN    /* IS THERE ANY SPQE             */ 00879000
         L     @15,SPQEADDR                                        0290 00880000
         L     @11,SPQEPTR(,@15)                                   0290 00881000
         LTR   @11,@11                                             0290 00882000
         BZ    @RT00290                                            0290 00883000
*     RETURN;                       /* NO, RETURN TO CALLER          */ 00884000
*   SAVE14SC=RRETURN;               /* SAVE RETURN ADDRESS           */ 00885000
         ST    RRETURN,SAVE14SC                                    0292 00886000
*   RESPECIFY                                                      0293 00887000
*     RRETURN UNRESTRICTED;                                        0293 00888000
*   SPQEANCR=SPQEADDR;              /* SAVE SPQE ANCHOR PTR  @ZA27378*/ 00889000
         ST    @15,SPQEANCR                                        0294 00890000
*   FSTSPQE=SPQEPTR;                /* SAVE FOR CIRCULAR QUE CK      */ 00891000
         L     @11,SPQESPTR                                        0295 00892000
         L     @11,SPQEPTR(,@11)                                   0295 00893000
         ST    @11,FSTSPQE                                         0295 00894000
*SPQECHK1:                                                         0296 00895000
*   PREVSPQE=SPQEADDR;              /* SET SPQE POINTER AS PREV SPQE */ 00896000
SPQECHK1 L     @11,SPQEADDR                                        0296 00897000
         ST    @11,PREVSPQE                                        0296 00898000
*   SPQEADDR=SPQEPTR;               /* GET FIRST/NEXT SPQE ADDRESS   */ 00899000
         L     @05,SPQESPTR                                        0297 00900000
         L     @05,SPQEPTR(,@05)                                   0297 00901000
         ST    @05,SPQEADDR                                        0297 00902000
*   IF SPQEADDR=0 THEN              /* IS THERE AN SPQE              */ 00903000
         LTR   @05,@05                                             0298 00904000
         BNZ   @RF00298                                            0298 00905000
*     DO;                           /* NO, PREVIOUS SPQE DOESN'T HAVE   00906000
*                                      "LAST SPQE" FLAG ON           */ 00907000
*       ERRCODE=ADDR(ECB4);         /* SET ERROR CODE B4             */ 00908000
         LA    ERRCODE,ECB4                                        0300 00909000
*       DATA1=PREVSPQE;             /* DATA = PREVIOUS SPQE ADDRESS  */ 00910000
         LR    DATA1,@11                                           0301 00911000
*       CALL EDVRA;                 /* ENTER DATA IN VRA             */ 00912000
         BAL   @14,EDVRA                                           0302 00913000
*       PREVSPQE->LASTSPQE=ON;      /* INDICATE PREV. SPQE IS LAST   */ 00914000
         L     @11,PREVSPQE                                        0303 00915000
         OI    LASTSPQE(@11),B'01000000'                           0303 00916000
*       RESPECIFY                                                  0304 00917000
*         RRETURN RESTRICTED;                                      0304 00918000
*       RRETURN=SAVE14SC;           /* RESTORE RETURN ADDRESS        */ 00919000
         L     RRETURN,SAVE14SC                                    0305 00920000
*       RETURN;                     /* RETURN TO CALLER              */ 00921000
@EL00006 DS    0H                                                  0306 00922000
@EF00006 DS    0H                                                  0306 00923000
@ER00006 BR    @14                                                 0306 00924000
*       RESPECIFY                                                  0307 00925000
*         RRETURN UNRESTRICTED;                                    0307 00926000
*     END;                                                         0308 00927000
*   ADCKADD=SPQEADDR;               /* START OF SPQE                 */ 00928000
@RF00298 L     ADCKADD,SPQEADDR                                    0309 00929000
*   ADCKLEN=SPQESIZE;               /* SIZE OF SPQE                  */ 00930000
         LA    ADCKLEN,16                                          0310 00931000
*   CALL ADDRCHK;                   /* CHECK SPQE ADDRESS FOR VALID     00932000
*                                      IN SQA OR LSQA (QBLCKLOC)     */ 00933000
         BAL   @14,ADDRCHK                                         0311 00934000
*   RESPECIFY                                                      0312 00935000
*     RTRNCODE RESTRICTED;                                         0312 00936000
*   IF RTRNCODE¬=C0 THEN            /* WAS ADDRESS VALID             */ 00937000
         LTR   RTRNCODE,RTRNCODE                                   0313 00938000
         BZ    @RF00313                                            0313 00939000
*     DO;                           /* NO                            */ 00940000
*B1ERR:                                                            0315 00941000
*       ERRCODE=ADDR(ECB1);         /* SET ERROR CODE B1             */ 00942000
B1ERR    LA    ERRCODE,ECB1                                        0315 00943000
*       DATA1=PREVSPQE;             /* DATA = SPQE ADDRESS           */ 00944000
         L     DATA1,PREVSPQE                                      0316 00945000
*       CALL EDVRA;                 /* ENTER DATA IN VRA             */ 00946000
         BAL   @14,EDVRA                                           0317 00947000
*       PREVSPQE->SPQEPTR=C0;       /* TRUNCATE SPQE QUEUE           */ 00948000
         L     @14,PREVSPQE                                        0318 00949000
         SLR   @11,@11                                             0318 00950000
         ST    @11,SPQEPTR(,@14)                                   0318 00951000
*       IF PREVSPQE¬=SPQEANCR THEN  /* PREV THE ANCHOR?      @ZA27378*/ 00952000
         C     @14,SPQEANCR                                        0319 00953000
         BE    @RF00319                                            0319 00954000
*         PREVSPQE->LASTSPQE=ON;    /* NO, INDICATE PREV IS LAST     */ 00955000
         OI    LASTSPQE(@14),B'01000000'                           0320 00956000
*       RESPECIFY                                                  0321 00957000
*         RRETURN RESTRICTED;                                      0321 00958000
@RF00319 DS    0H                                                  0322 00959000
*       RRETURN=SAVE14SC;           /* RESTORE RETURN ADDRESS        */ 00960000
         L     RRETURN,SAVE14SC                                    0322 00961000
*       RETURN;                     /* RETURN TO CALLER              */ 00962000
         B     @EL00006                                            0323 00963000
*       RESPECIFY                                                  0324 00964000
*         RRETURN UNRESTRICTED;                                    0324 00965000
*     END;                                                         0325 00966000
*   RESPECIFY                                                      0326 00967000
*     RTRNCODE UNRESTRICTED;                                       0326 00968000
@RF00313 DS    0H                                                  0327 00969000
*   CIRSPQE=FSTSPQE;                /* START AT THE TOP              */ 00970000
*                                                                  0327 00971000
         L     CIRSPQE,FSTSPQE                                     0327 00972000
*   /*****************************************************************/ 00973000
*   /*                                                               */ 00974000
*   /* THE LOOP CHECKING CODE IS DONE AFTER THE SPQE ADDRESS IS      */ 00975000
*   /* VALIDATED IN ORDER TO PREVENT AN 0C4 WHEN REFERENCING THE     */ 00976000
*   /* SPQE.                                                 @ZA27378*/ 00977000
*   /*                                                               */ 00978000
*   /*****************************************************************/ 00979000
*                                                                  0328 00980000
*CIRLOOP:                           /*                       @ZA27378*/ 00981000
*   IF SPQEPTR=CIRSPQE THEN         /* IF A LOOP EXISTS      @ZA27378*/ 00982000
CIRLOOP  L     @11,SPQESPTR                                        0328 00983000
         C     CIRSPQE,SPQEPTR(,@11)                               0328 00984000
         BE    @RT00328                                            0328 00985000
*     GOTO B1ERR;                   /* RECORD THE ERROR      @ZA27378*/ 00986000
*   IF SPQEADDR¬=CIRSPQE THEN       /* IF MORE TO CHECK      @ZA27378*/ 00987000
         C     CIRSPQE,SPQEADDR                                    0330 00988000
         BE    @RF00330                                            0330 00989000
*     DO;                           /*                       @ZA27378*/ 00990000
*       CIRSPQE=CIRSPQE->SPQEPTR;   /* GET NEXT              @ZA27378*/ 00991000
         L     CIRSPQE,SPQEPTR(,CIRSPQE)                           0332 00992000
*       GOTO CIRLOOP;               /* TRY AGAIN             @ZA27378*/ 00993000
         B     CIRLOOP                                             0333 00994000
*     END;                          /*                       @ZA27378*/ 00995000
*                                                                  0334 00996000
*   /*****************************************************************/ 00997000
*   /*                                                               */ 00998000
*   /* FOR SUBPOOLS 227 AND 228, THE FQE'S LIE WITHIN THE ALLOCATED  */ 00999000
*   /* AREA (IE. WITHIN THE AREA DESCRIBED BY THE DQE). THE FQE'S    */ 01000000
*   /* MUST THEREFORE BE VALIDATED LIKE THOSE IN SQA. THUS, WHEN     */ 01001000
*   /* EITHER OF THESE CSA SUBPOOLS IS TO BE VALIDATED, THE SQA      */ 01002000
*   /* INDICATOR IS TURNED ON. AFTER VALIDATION, THE INDICATOR IS    */ 01003000
*   /* RESET.                                                        */ 01004000
*   /*                                                               */ 01005000
*   /*****************************************************************/ 01006000
*                                                                  0335 01007000
*   IF QCSATYP=ON&(SPQEID=SP227|SPQEID=SP228) THEN/*         @ZA09498*/ 01008000
@RF00330 TM    QCSATYP,B'00001000'                                 0335 01009000
         BNO   @RF00335                                            0335 01010000
         L     @11,SPQESPTR                                        0335 01011000
         CLI   SPQEID(@11),227                                     0335 01012000
         BE    @RT00335                                            0335 01013000
         CLI   SPQEID(@11),228                                     0335 01014000
         BNE   @RF00335                                            0335 01015000
@RT00335 DS    0H                                                  0336 01016000
*     QSQATYP=ON;                   /* INDICATE SQA ALSO     @ZA09498*/ 01017000
         OI    QSQATYP,B'00010000'                                 0336 01018000
*   IF SPSHARE¬=ON THEN             /* IS SPQE SHARED                */ 01019000
@RF00335 L     @11,SPQESPTR                                        0337 01020000
         TM    SPSHARE(@11),B'10000000'                            0337 01021000
         BO    @RF00337                                            0337 01022000
*     CALL DQECHK;                  /* NO, CHECK DQE'S               */ 01023000
         BAL   @14,DQECHK                                          0338 01024000
*   IF QCSATYP=ON&(SPQEID=SP227|SPQEID=SP228) THEN/*         @ZA09498*/ 01025000
@RF00337 TM    QCSATYP,B'00001000'                                 0339 01026000
         BNO   @RF00339                                            0339 01027000
         L     @11,SPQESPTR                                        0339 01028000
         CLI   SPQEID(@11),227                                     0339 01029000
         BE    @RT00339                                            0339 01030000
         CLI   SPQEID(@11),228                                     0339 01031000
         BNE   @RF00339                                            0339 01032000
@RT00339 DS    0H                                                  0340 01033000
*     QSQATYP=OFF;                  /* RESET SQA INDICATOR   @ZA09498*/ 01034000
         NI    QSQATYP,B'11101111'                                 0340 01035000
*   IF LASTSPQE=ON THEN             /* IS THIS LAST SPQE             */ 01036000
@RF00339 L     @11,SPQESPTR                                        0341 01037000
         TM    LASTSPQE(@11),B'01000000'                           0341 01038000
         BNO   @RF00341                                            0341 01039000
*     DO;                           /* YES                           */ 01040000
*       IF SPQEPTR¬=C0 THEN         /* IF POINTER VALID              */ 01041000
         L     @11,SPQEPTR(,@11)                                   0343 01042000
         LTR   @11,@11                                             0343 01043000
         BZ    @RF00343                                            0343 01044000
*         DO;                       /* BUT LAST WAS ON               */ 01045000
*           ERRCODE=ADDR(ECB1);     /* SET ERROR CODE B1             */ 01046000
         LA    ERRCODE,ECB1                                        0345 01047000
*           DATA1=SPQEADDR;         /* DATA = SPQE ADDRESS           */ 01048000
         L     DATA1,SPQEADDR                                      0346 01049000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 01050000
         BAL   @14,EDVRA                                           0347 01051000
*           SPQEPTR=C0;             /* CLEAR THE POINTER             */ 01052000
         L     @11,SPQESPTR                                        0348 01053000
         SLR   @05,@05                                             0348 01054000
         ST    @05,SPQEPTR(,@11)                                   0348 01055000
*         END;                                                     0349 01056000
*       RESPECIFY                                                  0350 01057000
*         RRETURN RESTRICTED;                                      0350 01058000
@RF00343 DS    0H                                                  0351 01059000
*       RRETURN=SAVE14SC;           /* RESTORE RETURN ADDRESS        */ 01060000
         L     RRETURN,SAVE14SC                                    0351 01061000
*       RETURN;                     /* RETURN TO CALLER              */ 01062000
         B     @EL00006                                            0352 01063000
*       RESPECIFY                                                  0353 01064000
*         RRETURN UNRESTRICTED;                                    0353 01065000
*     END;                                                         0354 01066000
*   GO TO SPQECHK1;                 /* NO, CHECK NEXT SPQE           */ 01067000
         B     SPQECHK1                                            0355 01068000
*   END SPQECHK;                                                   0356 01069000
         B     @EL00006                                            0356 01070000
*                                                                  0357 01071000
*   /*****************************************************************/ 01072000
*   /*                                                               */ 01073000
*   /* PROCEDURE TO SCAN A DQE QUEUE AND CHECK ALL DQE AND FQE       */ 01074000
*   /* CONTROL BLOCKS.                                               */ 01075000
*   /*                                                               */ 01076000
*   /*****************************************************************/ 01077000
*                                                                  0357 01078000
*DQECHK:                                                           0357 01079000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0357 01080000
DQECHK   DS    0H                                                  0358 01081000
*   RESPECIFY                                                      0358 01082000
*     RRETURN RESTRICTED;                                          0358 01083000
*   SAVE14DC=RRETURN;               /* SAVE RETURN ADDRESS           */ 01084000
         ST    RRETURN,SAVE14DC                                    0359 01085000
*   RESPECIFY                                                      0360 01086000
*     RRETURN UNRESTRICTED;                                        0360 01087000
*   PREVDQE=SPQEADDR;               /* SPQE IS PREVIOUS DQE          */ 01088000
*                                                                  0361 01089000
         L     @11,SPQEADDR                                        0361 01090000
         LR    PREVDQE,@11                                         0361 01091000
*   /*****************************************************************/ 01092000
*   /*                                                               */ 01093000
*   /* THE QSQATYP FLAG WILL BE ON FOR SUBPOOLS 227 AND 228 AS WELL  */ 01094000
*   /* AS FOR SQA. HOWEVER, DQE'S FOR SUBPOOLS 227 AND 228 ARE CSA   */ 01095000
*   /* DQE'S AND MUST BE CHECKED ACCORDINGLY.                        */ 01096000
*   /*                                                               */ 01097000
*   /*****************************************************************/ 01098000
*                                                                  0362 01099000
*   IF QCSATYP=ON THEN              /* IS THIS CSA QUEUE     @ZA09498*/ 01100000
         TM    QCSATYP,B'00001000'                                 0362 01101000
         BO    @RT00362                                            0362 01102000
*     GO TO DQECHK1;                /* YES                   @ZA09498*/ 01103000
*   IF QSQATYP¬=ON THEN             /* NO, IS IT SQA QUEUE   @ZA09498*/ 01104000
         TM    QSQATYP,B'00010000'                                 0364 01105000
         BNO   @RT00364                                            0364 01106000
*     GO TO DQECHK9;                /* NO, LSQA OR REGION            */ 01107000
*                                                                  0365 01108000
*   /*****************************************************************/ 01109000
*   /*                                                               */ 01110000
*   /* CHECK SQA DQE(S)                                              */ 01111000
*   /*                                                               */ 01112000
*   /*****************************************************************/ 01113000
*                                                                  0366 01114000
*   DUL=C16M;                       /* UPPER LIMIT FOR DQE           */ 01115000
         L     DUL,C16M                                            0366 01116000
*   DLL=PVTHQSA*256;                /* LOWER LIMIT FOR DQE           */ 01117000
         L     @05,CVTPTR                                          0367 01118000
         L     @05,PVTPTR(,@05)                                    0367 01119000
         LH    DLL,PVTHQSA(,@05)                                   0367 01120000
         N     DLL,@CF02575                                        0367 01121000
         SLA   DLL,8                                               0367 01122000
*   DQEADDR=PREVDQE->DQEPTR;        /* GET FIRST DQE                 */ 01123000
         L     @05,DQEPTR(,PREVDQE)                                0368 01124000
         ST    @05,DQEADDR                                         0368 01125000
*   IF DQEADDR<DLL THEN             /* IS DQE ADDRESS < DLL          */ 01126000
         CR    @05,DLL                                             0369 01127000
         BNL   @RF00369                                            0369 01128000
*     DO;                           /* YES, SQA MAY BE LOST          */ 01129000
*       ERRCODE=ADDR(ECD1);         /* SET ERROR CODE D1             */ 01130000
         LA    ERRCODE,ECD1                                        0371 01131000
*       DATA1=SPQEADDR;             /* DATA = SPQE ADDRESS           */ 01132000
         L     @11,SPQEADDR                                        0372 01133000
         LR    DATA1,@11                                           0372 01134000
*       CALL EDVRA;                 /* ENTER DATA IN VRA             */ 01135000
         BAL   @14,EDVRA                                           0373 01136000
*       RESPECIFY                                                  0374 01137000
*         RRETURN RESTRICTED;                                      0374 01138000
*       RRETURN=SAVE14DC;           /* RESTORE RETURN ADDRESS        */ 01139000
         L     RRETURN,SAVE14DC                                    0375 01140000
*       RETURN CODE(C4);            /* RETURN TO CALLER, QUEUES WILL    01141000
*                                      NOT BE CHECKED FURTHER OR   0376 01142000
*                                      REPAIRED                      */ 01143000
         LA    @15,4                                               0376 01144000
@EL00007 DS    0H                                                  0376 01145000
@EF00007 DS    0H                                                  0376 01146000
@ER00007 BR    @14                                                 0376 01147000
*       RESPECIFY                                                  0377 01148000
*         RRETURN UNRESTRICTED;                                    0377 01149000
*     END;                                                         0378 01150000
*   DUB=DQEBLKAD+DQELNTH;           /* DQE UPPER BOUND = AREA +    0379 01151000
*                                      LENGTH                        */ 01152000
@RF00369 L     @09,DQESEPTR                                        0379 01153000
         L     @05,DQEBLKAD(,@09)                                  0379 01154000
         LR    DUB,@05                                             0379 01155000
         AL    DUB,DQELNTH(,@09)                                   0379 01156000
*   IF DQEBLKAD¬=DLL THEN           /* IS DQE LOWER BOUND CORRECT    */ 01157000
         CR    @05,DLL                                             0380 01158000
         BE    @RF00380                                            0380 01159000
*     DO;                           /* NO, CHECK FURTHER             */ 01160000
*       IF DUB¬=DUL THEN            /* IS UPPER BOUND CORRECT        */ 01161000
         CR    DUB,DUL                                             0382 01162000
         BE    @RF00382                                            0382 01163000
*         DO;                       /* NO, CORRECT THESE             */ 01164000
*           DQEBLKAD=DLL;           /* CORRECT DQE AREA ADDRESS      */ 01165000
         ST    DLL,DQEBLKAD(,@09)                                  0384 01166000
*DQECHK0:                                                          0385 01167000
*           DQELNTH=DUL-DLL;        /* CORRECT DQE AREA LNTH         */ 01168000
DQECHK0  LR    @09,DUL                                             0385 01169000
         SLR   @09,DLL                                             0385 01170000
         L     @07,DQESEPTR                                        0385 01171000
         ST    @09,DQELNTH(,@07)                                   0385 01172000
*           ERRCODE=ADDR(ECD6);     /* SET ERROR CODE 6              */ 01173000
         LA    ERRCODE,ECD6                                        0386 01174000
*           DATA1=DQEADDR;          /* DATA = DQE ADDRESS            */ 01175000
         L     DATA1,DQEADDR                                       0387 01176000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 01177000
         BAL   @14,EDVRA                                           0388 01178000
*           GO TO DQECHK6;          /* GO CHECK FQE'S                */ 01179000
         B     DQECHK6                                             0389 01180000
*         END;                                                     0390 01181000
*       ELSE                        /* PROBABLY PVTHQSA IS WRONG     */ 01182000
*         DO;                       /* LEAVE DQE AND PVT AS IS       */ 01183000
@RF00382 DS    0H                                                  0392 01184000
*           ERRCODE=ADDR(EC05);     /* SET ERROR CODE 5              */ 01185000
         LA    ERRCODE,EC05                                        0392 01186000
*           DATA1=ADDR(PVTHQSA);    /* DATA = PVTHQSA ADDR           */ 01187000
         L     @09,CVTPTR                                          0393 01188000
         L     DATA1,PVTPTR(,@09)                                  0393 01189000
         LA    DATA1,PVTHQSA(,DATA1)                               0393 01190000
*           CALL EDVRA;             /* ENTER DATA IN VRA             */ 01191000
         BAL   @14,EDVRA                                           0394 01192000
*           GO TO DQECHK6;          /* GO CHECK FQE'S                */ 01193000
         B     DQECHK6                                             0395 01194000
*         END;                                                     0396 01195000
*     END;                                                         0397 01196000
*   ELSE                            /* DQE LOWER BOUND O.K.          */ 01197000
*     IF DUB¬=DUL THEN              /* IS UPPER BOUND CORRECT        */ 01198000
@RF00380 CR    DUB,DUL                                             0398 01199000
         BNE   @RT00398                                            0398 01200000
*       GO TO DQECHK0;              /* NO, GO CORRECT IT             */ 01201000
*     ELSE                                                         0400 01202000
*       GO TO DQECHK6;              /* FIRST SQA DQE O.K.            */ 01203000
*                                                                  0400 01204000
         B     DQECHK6                                             0400 01205000
*   /*****************************************************************/ 01206000
*   /*                                                               */ 01207000
*   /* CHECK CSA DQE'S                                               */ 01208000
*   /*                                                               */ 01209000
*   /*****************************************************************/ 01210000
*                                                                  0401 01211000
*DQECHK1:                                                          0401 01212000
*   DLL=CSASTART;                   /* SET DQE LOWER LIMIT           */ 01213000
DQECHK1  LR    DLL,CSASTART                                        0401 01214000
*   DUL=DLL+EVAL(GDAPTR->CSAPQEP->PQESIZE);/* SET            @ZA01891   01215000
*                                      DQE UPPER LIMIT       @ZA01891*/ 01216000
         L     @05,CVTPTR                                          0402 01217000
         L     @05,GDAPTR(,@05)                                    0402 01218000
         L     @05,CSAPQEP(,@05)                                   0402 01219000
         LR    DUL,DLL                                             0402 01220000
         AL    DUL,PQESIZE(,@05)                                   0402 01221000
*DQECHK2:                                                          0403 01222000
*   DQEADDR=PREVDQE->DQEPTR;        /* GET FIRST/NEXT DQE            */ 01223000
DQECHK2  L     @05,DQEPTR(,PREVDQE)                                0403 01224000
         ST    @05,DQEADDR                                         0403 01225000
*   IF DQEADDR=C0 THEN              /* IS THERE A DQE                */ 01226000
         LTR   @05,@05                                             0404 01227000
         BNZ   @RF00404                                            0404 01228000
*     DO;                           /* NO, DONE                      */ 01229000
*       RESPECIFY                                                  0406 01230000
*         RRETURN RESTRICTED;                                      0406 01231000
*       RRETURN=SAVE14DC;           /* RESTORE RETURN ADDRESS        */ 01232000
         L     RRETURN,SAVE14DC                                    0407 01233000
*       RETURN;                     /* RETURN TO CALLER              */ 01234000
         B     @EL00007                                            0408 01235000
*       RESPECIFY                                                  0409 01236000
*         RRETURN UNRESTRICTED;                                    0409 01237000
*     END;                                                         0410 01238000
*   ADCKADD=DQEADDR;                /* START OF DQE                  */ 01239000
@RF00404 L     ADCKADD,DQEADDR                                     0411 01240000
*   ADCKLEN=DQESIZE;                /* SIZE OF DQE                   */ 01241000
         LA    ADCKLEN,16                                          0412 01242000
*   CALL ADDRCHK;                   /* CHECK DQE ADDRESS FOR VALID 0413 01243000
*                                      SQA OR LSQA (QBLCKLOC)        */ 01244000
         BAL   @14,ADDRCHK                                         0413 01245000
*   RESPECIFY                                                      0414 01246000
*     RTRNCODE RESTRICTED;                                         0414 01247000
*   IF RTRNCODE¬=C0 THEN            /* WAS ADDRESS VALID             */ 01248000
         LTR   RTRNCODE,RTRNCODE                                   0415 01249000
         BNZ   @RT00415                                            0415 01250000
*     GO TO DQECHK12;               /* NO                            */ 01251000
*   RESPECIFY                                                      0417 01252000
*     RTRNCODE UNRESTRICTED;                                       0417 01253000
*DQECHK4:                                                          0418 01254000
*   IF DQEBLKAD<DLL THEN            /* DQE AREA ADDRESS O.K.         */ 01255000
DQECHK4  L     @05,DQESEPTR                                        0418 01256000
         L     @15,DQEBLKAD(,@05)                                  0418 01257000
         CR    @15,DLL                                             0418 01258000
         BL    @RT00418                                            0418 01259000
*     GO TO DQECHK15;               /* NO                            */ 01260000
*   DUB=DQEBLKAD+DQELNTH;           /* DQE UPPER BOUND               */ 01261000
         AL    @15,DQELNTH(,@05)                                   0420 01262000
         LR    DUB,@15                                             0420 01263000
*   IF DUB>DUL THEN                 /* CHECK DQE UPPER BOUND         */ 01264000
         CR    DUB,DUL                                             0421 01265000
         BH    @RT00421                                            0421 01266000
*     GO TO DQECHK15;               /* EXCEEDS LIMIT                 */ 01267000
*                                                                  0422 01268000
*   /*****************************************************************/ 01269000
*   /*                                                               */ 01270000
*   /* CHECK OVERLAP WITH PREVIOUS DQE'S                             */ 01271000
*   /*                                                               */ 01272000
*   /*****************************************************************/ 01273000
*                                                                  0423 01274000
*   TPREVDQE=SPQEADDR;              /* FIRST PREVIOUS TEMPORARY DQE  */ 01275000
         L     TPREVDQE,SPQEADDR                                   0423 01276000
*   TDQE=SPDQEPTR;                  /* FIRST TEMPORARY DQE           */ 01277000
         L     @07,SPQESPTR                                        0424 01278000
         L     TDQE,SPDQEPTR(,@07)                                 0424 01279000
*DQECHK5:                                                          0425 01280000
*   IF TDQE=DQEADDR THEN            /* IS THIS CURRENT DQE           */ 01281000
DQECHK5  L     @07,DQEADDR                                         0425 01282000
         CR    TDQE,@07                                            0425 01283000
         BNE   @RF00425                                            0425 01284000
*     IF TPREVDQE¬=PREVDQE THEN     /* YES, ARE PREVIOUS DQE'S THE 0426 01285000
*                                      SAME                          */ 01286000
         CR    TPREVDQE,PREVDQE                                    0426 01287000
         BE    @RF00426                                            0426 01288000
*       DO;                         /* NO, CIRCULAR QUEUE            */ 01289000
*         ERRCODE=ADDR(ECD5);       /* SET ERROR CODE D5             */ 01290000
         LA    ERRCODE,ECD5                                        0428 01291000
*         DATA1=DQEADDR;            /* DATA = DQE ADDRESS            */ 01292000
         LR    DATA1,@07                                           0429 01293000
*         DATA2=PREVDQE;            /* AND PREVIOUS DQE              */ 01294000
         ST    PREVDQE,DATA2                                       0430 01295000
*         CALL EDVRA;               /* ENTER DATA IN VRA             */ 01296000
         BAL   @14,EDVRA                                           0431 01297000
*         PREVDQE->DQEPTR=C0;       /* TRUNCATE DQE QUEUE AFTER LAST    01298000
*                                      GOOD DQE                      */ 01299000
         SLR   @11,@11                                             0432 01300000
         ST    @11,DQEPTR(,PREVDQE)                                0432 01301000
*         RESPECIFY                                                0433 01302000
*           RRETURN RESTRICTED;                                    0433 01303000
*         RRETURN=SAVE14DC;         /* RESTORE RETURN ADDRESS        */ 01304000
         L     RRETURN,SAVE14DC                                    0434 01305000
*         RETURN CODE(C0);          /* RETURN TO CALLER              */ 01306000
         LR    @15,@11                                             0435 01307000
         BR    @14                                                 0435 01308000
*         RESPECIFY                                                0436 01309000
*           RRETURN UNRESTRICTED;                                  0436 01310000
*       END;                                                       0437 01311000
*     ELSE                                                         0438 01312000
*       GO TO DQECHK6;              /* NO OVERLAP                    */ 01313000
*   IF DUB>TDQE->DQEBLKAD THEN      /* DQE UPPER BOUND GREATER THAN     01314000
*                                      TEMPORARY DQE LOWER BOUND?    */ 01315000
@RF00425 L     @05,DQEBLKAD(,TDQE)                                 0439 01316000
         CR    DUB,@05                                             0439 01317000
         BNH   @RF00439                                            0439 01318000
*     DO;                           /* YES                           */ 01319000
*       TDUB=TDQE->DQEBLKAD+TDQE->DQELNTH;/* TEMPORARY DQE UPPER   0441 01320000
*                                      BOUND                         */ 01321000
         AL    @05,DQELNTH(,TDQE)                                  0441 01322000
         LR    TDUB,@05                                            0441 01323000
*       IF DQEBLKAD<TDUB THEN       /* DQE LOWER BOUND LESS THAN   0442 01324000
*                                      TEMPORARY DQE UPPER BOUND?    */ 01325000
         L     @07,DQESEPTR                                        0442 01326000
         C     TDUB,DQEBLKAD(,@07)                                 0442 01327000
         BH    @RT00442                                            0442 01328000
*         GO TO DQECHK16;           /* YES, DQE'S OVERLAP            */ 01329000
*     END;                                                         0444 01330000
*   TPREVDQE=TDQE;                  /* SET CURRENT DQE AS PREVIOUS   */ 01331000
@RF00439 LR    TPREVDQE,TDQE                                       0445 01332000
*   TDQE=TDQE->DQEPTR;              /* GET NEXT DQE                  */ 01333000
         L     TDQE,DQEPTR(,TDQE)                                  0446 01334000
*   GO TO DQECHK5;                  /* CHECK IT                      */ 01335000
*                                                                  0447 01336000
         B     DQECHK5                                             0447 01337000
*   /*****************************************************************/ 01338000
*   /*                                                               */ 01339000
*   /* DQE ALL RIGHT, CHECK FQE'S ON THIS DQE                        */ 01340000
*   /*                                                               */ 01341000
*   /*****************************************************************/ 01342000
*                                                                  0448 01343000
*DQECHK6:                                                          0448 01344000
*   CALL FQECHK;                    /* CHECK FQE'S ON THIS DQE       */ 01345000
DQECHK6  BAL   @14,FQECHK                                          0448 01346000
*   PREVDQE=DQEADDR;                /* SET DQE AS PREVIOUS DQE       */ 01347000
*                                                                  0449 01348000
         L     PREVDQE,DQEADDR                                     0449 01349000
*   /*****************************************************************/ 01350000
*   /*                                                               */ 01351000
*   /* IF SQA OR LSQA, CHECK NEXT DQE ADDRESS BEFORE CONTINUING NEXT */ 01352000
*   /* DQE CHECK                                                     */ 01353000
*   /*                                                               */ 01354000
*   /*****************************************************************/ 01355000
*                                                                  0450 01356000
*DQECHK7:                                                          0450 01357000
*   IF QSQATYP¬=ON THEN             /* SQA QUEUE?                    */ 01358000
DQECHK7  TM    QSQATYP,B'00010000'                                 0450 01359000
         BO    @RF00450                                            0450 01360000
*     DO;                           /* NO                            */ 01361000
*       IF QLSQATYP¬=ON THEN        /* LSQA QUEUE?                   */ 01362000
         TM    QLSQATYP,B'00000100'                                0452 01363000
         BNO   @RT00452                                            0452 01364000
*         GO TO DQECHK2;            /* NO, CHECK NEXT DQE            */ 01365000
*DQECHK8:                                                          0454 01366000
*       DQEADDR=PREVDQE->DQEPTR;    /* GET NEXT LSQA DQE             */ 01367000
DQECHK8  L     @05,DQEPTR(,PREVDQE)                                0454 01368000
         ST    @05,DQEADDR                                         0454 01369000
*       IF DQEADDR=C0 THEN          /* IS THERE ONE                  */ 01370000
         LTR   @05,@05                                             0455 01371000
         BNZ   @RF00455                                            0455 01372000
*         DO;                       /* NO, DONE                      */ 01373000
*           RESPECIFY                                              0457 01374000
*             RRETURN RESTRICTED;                                  0457 01375000
*           RRETURN=SAVE14DC;       /* RESTORE RETURN ADDRESS        */ 01376000
         L     RRETURN,SAVE14DC                                    0458 01377000
*           RETURN;                 /* RETURN TO CALLER              */ 01378000
         B     @EL00007                                            0459 01379000
*           RESPECIFY                                              0460 01380000
*             RRETURN UNRESTRICTED;                                0460 01381000
*         END;                                                     0461 01382000
*       IF DQEADDR=ADDR(DUMYDQE) THEN/* DUMMY CANT BE                */ 01383000
@RF00455 L     @05,DQEADDR                                         0462 01384000
         LA    @00,DUMYDQE(,LDAPTR)                                0462 01385000
         CR    @05,@00                                             0462 01386000
         BE    @RT00462                                            0462 01387000
*         GOTO DQECHK12;            /* LEFT IN CHAIN                 */ 01388000
*       IF DQEADDR¬<DUL THEN        /* DQE ADDRESS IN LSQA?          */ 01389000
         CR    @05,DUL                                             0464 01390000
         BL    @RF00464                                            0464 01391000
*         DO;                       /* NO, CHECK IF IN SQA           */ 01392000
*           QBLCKLOC=OFF;           /* INDICATE CHECK IN SQA         */ 01393000
         NI    QBLCKLOC,B'01111111'                                0466 01394000
*           ADCKADD=DQEADDR;        /* START OF DQE                  */ 01395000
         LR    ADCKADD,@05                                         0467 01396000
*           ADCKLEN=DQESIZE;        /* SIZE OF DQE                   */ 01397000
         LA    ADCKLEN,16                                          0468 01398000
*           CALL ADDRCHK;           /* CHECK FOR DQE VALID IN SQA    */ 01399000
         BAL   @14,ADDRCHK                                         0469 01400000
*           RESPECIFY                                              0470 01401000
*             RTRNCODE RESTRICTED;                                 0470 01402000
*           QBLCKLOC=ON;            /* RESTORE CORRECT VALUE         */ 01403000
         OI    QBLCKLOC,B'10000000'                                0471 01404000
*           IF RTRNCODE¬=C0 THEN    /* WAS ADDRESS VALID             */ 01405000
         LTR   RTRNCODE,RTRNCODE                                   0472 01406000
         BNZ   @RT00472                                            0472 01407000
*             GO TO DQECHK12;       /* NO, BAD DQE POINTER           */ 01408000
*           RESPECIFY                                              0474 01409000
*             RTRNCODE UNRESTRICTED;                               0474 01410000
*           GO TO DQECHK4;          /* YES, DQE POINTER GOOD         */ 01411000
         B     DQECHK4                                             0475 01412000
*         END;                                                     0476 01413000
*       IF DQEADDR<DLL THEN         /* DQE ADDRESS IN LSQA?          */ 01414000
@RF00464 C     DLL,DQEADDR                                         0477 01415000
         BH    @RT00477                                            0477 01416000
*         GO TO DQECHK12;           /* NO, BAD DQE POINTER           */ 01417000
*       GO TO DQECHK4;              /* YES, CHECK DQE                */ 01418000
         B     DQECHK4                                             0479 01419000
*     END;                                                         0480 01420000
*   DLL=CSASTART;                   /* RESET DLL FOR REST OF SQA   0481 01421000
*                                      DQE'S                         */ 01422000
@RF00450 LR    DLL,CSASTART                                        0481 01423000
*   DQEADDR=DQEPTR;                 /* GET NEXT SQA DQE              */ 01424000
         L     @05,DQESEPTR                                        0482 01425000
         L     @05,DQEPTR(,@05)                                    0482 01426000
         ST    @05,DQEADDR                                         0482 01427000
*   IF DQEADDR=C0 THEN              /* IS THERE ONE                  */ 01428000
         SLR   @15,@15                                             0483 01429000
         CR    @05,@15                                             0483 01430000
         BNE   @RF00483                                            0483 01431000
*     DO;                           /* NO, DONE                      */ 01432000
*       RESPECIFY                                                  0485 01433000
*         RRETURN RESTRICTED;                                      0485 01434000
*       RRETURN=SAVE14DC;           /* RESTORE RETURN ADDRESS        */ 01435000
         L     RRETURN,SAVE14DC                                    0486 01436000
*       RETURN CODE(C0);            /* RETURN TO CALLER              */ 01437000
         BR    @14                                                 0487 01438000
*       RESPECIFY                                                  0488 01439000
*         RRETURN UNRESTRICTED;                                    0488 01440000
*     END;                                                         0489 01441000
*   IF DQEADDR=ADDR(DUMYDQE) THEN   /* DQE CANT BE                   */ 01442000
@RF00483 L     @05,DQEADDR                                         0490 01443000
         LA    @00,DUMYDQE(,LDAPTR)                                0490 01444000
         CR    @05,@00                                             0490 01445000
         BE    @RT00490                                            0490 01446000
*     GOTO DQECHK12;                /* LEFT IN CHAIN                 */ 01447000
*   IF DQEADDR¬<SQASTART THEN       /* DQE ADDRESS IN SQA?           */ 01448000
         L     @15,CVTPTR                                          0492 01449000
         L     @15,GDAPTR(,@15)                                    0492 01450000
         L     @14,SQASPQEP(,@15)                                  0492 01451000
         L     @14,SPDQEAD(,@14)                                   0492 01452000
         C     @05,SQASTART(,@14)                                  0492 01453000
         BNL   @RT00492                                            0492 01454000
*     GO TO DQECHK4;                /* YES, CHECK DQE                */ 01455000
*   IF DQEADDR<CSASTART THEN        /* DQE ADDRESS IN CSA?           */ 01456000
         CR    @05,CSASTART                                        0494 01457000
         BL    @RT00494                                            0494 01458000
*     GO TO DQECHK12;               /* NO, BAD DQE POINTER           */ 01459000
*   IF DQEADDR+16>CSASTART+         /* DQE ADDRESS IN CSA?   @ZA01891*/ 01460000
*       EVAL(GDAPTR->CSAPQEP->PQESIZE) THEN/*                @ZA01891*/ 01461000
         AL    @05,@CF00129                                        0496 01462000
         L     @15,CSAPQEP(,@15)                                   0496 01463000
         LR    @00,CSASTART                                        0496 01464000
         AL    @00,PQESIZE(,@15)                                   0496 01465000
         CR    @05,@00                                             0496 01466000
         BH    @RT00496                                            0496 01467000
*     GO TO DQECHK12;               /* NO, BAD DQE POINTER           */ 01468000
*   GO TO DQECHK4;                  /* YES, CHECK DQE                */ 01469000
*                                                                  0498 01470000
         B     DQECHK4                                             0498 01471000
*   /*****************************************************************/ 01472000
*   /*                                                               */ 01473000
*   /* CHECK LSQA AND REGION DQE'S                                   */ 01474000
*   /*                                                               */ 01475000
*   /*****************************************************************/ 01476000
*                                                                  0499 01477000
*DQECHK9:                                                          0499 01478000
*   DLL=PASTRT;                     /* DQE LOWER LIMIT               */ 01479000
DQECHK9  L     @05,CVTPTR                                          0499 01480000
         L     @05,GDAPTR(,@05)                                    0499 01481000
         L     DLL,PASTRT(,@05)                                    0499 01482000
*   DUL=CSASTART;                   /* DQE UPPER LIMIT               */ 01483000
         LR    DUL,CSASTART                                        0500 01484000
*   IF QLSQATYP=ON THEN             /* LSQA QUEUE?                   */ 01485000
         TM    QLSQATYP,B'00000100'                                0501 01486000
         BO    @RT00501                                            0501 01487000
*     GO TO DQECHK8;                /* YES, CHECK LSQA DQE POINTER   */ 01488000
*   GO TO DQECHK2;                  /* NO, GET REGION DQE            */ 01489000
*                                                                  0503 01490000
         B     DQECHK2                                             0503 01491000
*   /*****************************************************************/ 01492000
*   /*                                                               */ 01493000
*   /* ERROR HANDLING                                                */ 01494000
*   /*                                                               */ 01495000
*   /*****************************************************************/ 01496000
*                                                                  0504 01497000
*DQECHK12:                                                         0504 01498000
*   ERRCODE=ADDR(ECD2);             /* SET ERROR CODE D2             */ 01499000
DQECHK12 LA    ERRCODE,ECD2                                        0504 01500000
*   DATA1=PREVDQE;                  /* DATA = PREV DQE ADDRESS       */ 01501000
         LR    DATA1,PREVDQE                                       0505 01502000
*   DATA2=DQEADDR;                  /* DATA = CURRENT DQE ADDR.    0506 01503000
*                                                            @ZA33426*/ 01504000
         L     @07,DQEADDR                                         0506 01505000
         ST    @07,DATA2                                           0506 01506000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01507000
         BAL   @14,EDVRA                                           0507 01508000
*   IF DQEADDR¬=ADDR(TEMPDQE)&DQEADDR¬=ADDR(DUMYDQE) THEN/* IS DQE 0508 01509000
*                                      "TEMPDQE" OR "DUMYDQE"        */ 01510000
         L     @05,DQEADDR                                         0508 01511000
         LA    @00,TEMPDQE(,LDAPTR)                                0508 01512000
         CR    @05,@00                                             0508 01513000
         BE    @RF00508                                            0508 01514000
         LA    @00,DUMYDQE(,LDAPTR)                                0508 01515000
         CR    @05,@00                                             0508 01516000
         BE    @RF00508                                            0508 01517000
*     DO;                           /* NO, TRUNCATE DQE QUEUE        */ 01518000
*       PREVDQE->DQEPTR=C0;         /* ZERO NEXT DQE POINTER IN LAST    01519000
*                                      GOOD DQE                      */ 01520000
         SLR   @11,@11                                             0510 01521000
         ST    @11,DQEPTR(,PREVDQE)                                0510 01522000
*       RESPECIFY                                                  0511 01523000
*         RRETURN RESTRICTED;                                      0511 01524000
*       RRETURN=SAVE14DC;           /* RESTORE RETURN ADDRESS        */ 01525000
         L     RRETURN,SAVE14DC                                    0512 01526000
*       RETURN CODE(C0);            /* RETURN TO CALLER              */ 01527000
         LR    @15,@11                                             0513 01528000
         BR    @14                                                 0513 01529000
*       RESPECIFY                                                  0514 01530000
*         RRETURN UNRESTRICTED;                                    0514 01531000
*     END;                                                         0515 01532000
*DQECHK13:                                                         0516 01533000
*   PREVDQE->DQEPTR=DQEPTR;         /* REMOVE TEMP OR DUMMY          */ 01534000
@RF00508 DS    0H                                                  0516 01535000
DQECHK13 L     @05,DQESEPTR                                        0516 01536000
         L     @00,DQEPTR(,@05)                                    0516 01537000
         ST    @00,DQEPTR(,PREVDQE)                                0516 01538000
*   DQEPTR=C0;                      /* ZERO DUMMY'S POINTER          */ 01539000
         SLR   @00,@00                                             0517 01540000
         ST    @00,DQEPTR(,@05)                                    0517 01541000
*   GO TO DQECHK7;                  /* PROCESS NEXT DQE              */ 01542000
         B     DQECHK7                                             0518 01543000
*DQECHK15:                                                         0519 01544000
*   ERRCODE=ADDR(ECD3);             /* SET ERROR CODE D3             */ 01545000
DQECHK15 LA    ERRCODE,ECD3                                        0519 01546000
*   DATA1=DQEADDR;                  /* DATA = DQE ADDRESS            */ 01547000
         L     DATA1,DQEADDR                                       0520 01548000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01549000
         BAL   @14,EDVRA                                           0521 01550000
*   GO TO DQECHK13;                 /* ELIMINATE DQE                 */ 01551000
         B     DQECHK13                                            0522 01552000
*DQECHK16:                                                         0523 01553000
*   ERRCODE=ADDR(ECD4);             /* SET ERROR CODE D4             */ 01554000
DQECHK16 LA    ERRCODE,ECD4                                        0523 01555000
*   DATA1=DQEADDR;                  /* DATA = DQE ADDRESS            */ 01556000
         L     DATA1,DQEADDR                                       0524 01557000
*   DATA2=TDQE;                     /* AND PREV (TEMP) DQE           */ 01558000
         ST    TDQE,DATA2                                          0525 01559000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01560000
         BAL   @14,EDVRA                                           0526 01561000
*   GO TO DQECHK13;                 /* ELIMINATE DQE                 */ 01562000
         B     DQECHK13                                            0527 01563000
*   END DQECHK;                                                    0528 01564000
*                                                                  0529 01565000
*   /*****************************************************************/ 01566000
*   /*                                                               */ 01567000
*   /* PROCEDURE TO SCAN AN FQE QUEUE AND CHECK ALL FQE CONTROL      */ 01568000
*   /* BLOCKS.                                                       */ 01569000
*   /*                                                               */ 01570000
*   /*****************************************************************/ 01571000
*                                                                  0529 01572000
*FQECHK:                                                           0529 01573000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0529 01574000
FQECHK   DS    0H                                                  0530 01575000
*   RESPECIFY                                                      0530 01576000
*     RRETURN RESTRICTED;                                          0530 01577000
*   SAVE14FC=RRETURN;               /* SAVE RETURN ADDRESS           */ 01578000
         ST    RRETURN,SAVE14FC                                    0531 01579000
*   RESPECIFY                                                      0532 01580000
*     RRETURN UNRESTRICTED;                                        0532 01581000
*   PREVFQE=DQEADDR;                /* DQE IS PREVIOUS FQE           */ 01582000
         L     @09,DQEADDR                                         0533 01583000
         ST    @09,PREVFQE                                         0533 01584000
*   PFLB=DQEBLKAD+DQELNTH;          /* DQE UPPER BOUND IS PREVIOUS 0534 01585000
*                                      FQE LOWER BOUND               */ 01586000
         L     @09,DQESEPTR                                        0534 01587000
         L     @05,DQEBLKAD(,@09)                                  0534 01588000
         AL    @05,DQELNTH(,@09)                                   0534 01589000
         ST    @05,PFLB                                            0534 01590000
*FQECHK1:                                                          0535 01591000
*   FQEADDR=PREVFQE->FQEPTRA;       /* GET NEXT FQE                  */ 01592000
FQECHK1  L     @09,PREVFQE                                         0535 01593000
         L     @09,FQEPTRA-1(,@09)                                 0535 01594000
         LA    @09,0(,@09)                                         0535 01595000
         ST    @09,FQEADDR                                         0535 01596000
*   IF FQEADDR=C0 THEN              /* IS THERE ONE                  */ 01597000
         LTR   @09,@09                                             0536 01598000
         BNZ   @RF00536                                            0536 01599000
*     DO;                           /* NO, DONE                      */ 01600000
*       RESPECIFY                                                  0538 01601000
*         RRETURN RESTRICTED;                                      0538 01602000
*       RRETURN=SAVE14FC;           /* RESTORE RETURN ADDRESS        */ 01603000
         L     RRETURN,SAVE14FC                                    0539 01604000
*       RETURN;                     /* RETURN TO CALLER              */ 01605000
@EL00008 DS    0H                                                  0540 01606000
@EF00008 DS    0H                                                  0540 01607000
@ER00008 BR    @14                                                 0540 01608000
*       RESPECIFY                                                  0541 01609000
*         RRETURN UNRESTRICTED;                                    0541 01610000
*     END;                                                         0542 01611000
*   IF QSQATYP=OFF&QLSQATYP=OFF THEN/* SQA OR LSQA FQE?              */ 01612000
@RF00536 TM    QSQATYP,B'00010100'                                 0543 01613000
         BZ    @RT00543                                            0543 01614000
*     GO TO FQECHK3;                /* NO, REGION FQE                */ 01615000
*                                                                  0544 01616000
*   /*****************************************************************/ 01617000
*   /*                                                               */ 01618000
*   /* CHECK SQA AND LSQA FQE'S                                      */ 01619000
*   /*                                                               */ 01620000
*   /*****************************************************************/ 01621000
*                                                                  0545 01622000
*   IF FQEADDR<DQEBLKAD THEN        /* IF FQE AREA BELOW DQE AREA  0545 01623000
*                                                            @ZA17826*/ 01624000
@RF00543 L     @09,FQEADDR                                         0545 01625000
         L     @05,DQESEPTR                                        0545 01626000
         L     @05,DQEBLKAD(,@05)                                  0545 01627000
         CR    @09,@05                                             0545 01628000
         BL    @RT00545                                            0545 01629000
*     GO TO FQECHK5;                /* THEN BAD FQE POINTER  @ZA17826*/ 01630000
*   FUB=FQEADDR+FQESLNTH;           /* L/SQA FQE UPPER BOUND         */ 01631000
         AL    @09,@CF00038                                        0547 01632000
         LR    FUB,@09                                             0547 01633000
*   IF FUB>PFLB THEN                /* IS UPPER BOUND BELOW PREVIOUS    01634000
*                                      FQE LOWER BOUND               */ 01635000
         C     FUB,PFLB                                            0548 01636000
         BH    @RT00548                                            0548 01637000
*     GO TO FQECHK5;                /* NO, BAD FQE POINTER           */ 01638000
*   FLB=FUB-FQELNTH;                /* FQE LOWER BOUND               */ 01639000
         L     @09,FQESEPTR                                        0550 01640000
         LR    FLB,FUB                                             0550 01641000
         SL    FLB,FQELNTH(,@09)                                   0550 01642000
*   IF FLB<DQEBLKAD|FLB¬<FUB THEN   /* IS FQE AREA BELOW DQE AREA, OR   01643000
*                                      IS FREE LENGTH <= 0   @ZA08146*/ 01644000
         CR    FLB,@05                                             0551 01645000
         BL    @RT00551                                            0551 01646000
         CR    FLB,FUB                                             0551 01647000
         BNL   @RT00551                                            0551 01648000
*     GO TO FQECHK7;                /* NO, BAD FQE POINTER OR LENGTH */ 01649000
*   FQTYPE=FQTYPE&CPBOFF;           /* CLEAR FQECPB          @ZA24796*/ 01650000
         NI    FQTYPE(@09),X'BF'                                   0553 01651000
*   IF FQTYPE¬=ZEROBYTE THEN        /* ANY OTHER FLAGS ON ?  @ZA24796*/ 01652000
         CLI   FQTYPE(@09),X'00'                                   0554 01653000
         BNE   @RT00554                                            0554 01654000
*     GO TO FQECHK8;                /* YES, GO RESET THEM            */ 01655000
*FQECHK2:                                                          0556 01656000
*   PFLB=FLB;                       /* FQE LOWER BOUND IS NOW      0556 01657000
*                                      PREVIOUS FQE LOWER BOUND      */ 01658000
FQECHK2  ST    FLB,PFLB                                            0556 01659000
*   PREVFQE=FQEADDR;                /* FQE IS NOW PREVIOUS FQE       */ 01660000
         L     @09,FQEADDR                                         0557 01661000
         ST    @09,PREVFQE                                         0557 01662000
*   GO TO FQECHK1;                  /* CHECK NEXT FQE                */ 01663000
*                                                                  0558 01664000
         B     FQECHK1                                             0558 01665000
*   /*****************************************************************/ 01666000
*   /*                                                               */ 01667000
*   /* CHECK REGION FQE'S                                            */ 01668000
*   /*                                                               */ 01669000
*   /*****************************************************************/ 01670000
*                                                                  0559 01671000
*FQECHK3:                                                          0559 01672000
*   ADCKADD=FQEADDR;                /* START OF FQE                  */ 01673000
FQECHK3  L     ADCKADD,FQEADDR                                     0559 01674000
*   ADCKLEN=FQERLNTH;               /* SIZE OF FQE                   */ 01675000
         LA    ADCKLEN,16                                          0560 01676000
*   CALL ADDRCHK;                   /* CHECK FQE ADDRESS             */ 01677000
         BAL   @14,ADDRCHK                                         0561 01678000
*   RESPECIFY                                                      0562 01679000
*     RTRNCODE RESTRICTED;                                         0562 01680000
*   IF RTRNCODE¬=C0 THEN            /* WAS ADDRESS VALID             */ 01681000
         LTR   RTRNCODE,RTRNCODE                                   0563 01682000
         BNZ   @RT00563                                            0563 01683000
*     GO TO FQECHK5;                /* NO, BAD FQE POINTER           */ 01684000
*   RESPECIFY                                                      0565 01685000
*     RTRNCODE UNRESTRICTED;                                       0565 01686000
*   IF FQAREA>PFLB THEN             /* IS UPPER BOUND BELOW PREVIOUS    01687000
*                                      FQE LOWER BOUND               */ 01688000
         L     @09,FQESEPTR                                        0566 01689000
         L     @05,FQAREA(,@09)                                    0566 01690000
         C     @05,PFLB                                            0566 01691000
         BH    @RT00566                                            0566 01692000
*     GO TO FQECHK5;                /* NO, BAD FQE POINTER           */ 01693000
*   FLB=FQAREA-FQELNTH;             /* FQE LOWER BOUND               */ 01694000
         LR    FLB,@05                                             0568 01695000
         SL    FLB,FQELNTH(,@09)                                   0568 01696000
*   IF FLB<DQEBLKAD|FLB¬<FQAREA THEN/* IS FQE AREA BELOW DQE AREA, OR   01697000
*                                      IS FREE LENGTH <= 0   @ZA08146*/ 01698000
         L     @06,DQESEPTR                                        0569 01699000
         C     FLB,DQEBLKAD(,@06)                                  0569 01700000
         BL    @RT00569                                            0569 01701000
         CR    FLB,@05                                             0569 01702000
         BNL   @RT00569                                            0569 01703000
*     GO TO FQECHK7;                /* YES, BAD LENGTH               */ 01704000
*   IF FQTYPE¬=REGIONON THEN        /* OTHER THAN FQERGNFL FLAG ON ?    01705000
*                                                            @ZA24796*/ 01706000
         CLI   FQTYPE(@09),X'80'                                   0571 01707000
         BE    @RF00571                                            0571 01708000
*     DO;                           /* YES, THEY SHOULD NOT BE ON    */ 01709000
*       FQTYPE=REGIONON;            /* SET FQERGNFL ON, OTHERS OFF 0573 01710000
*                                                            @ZA24796*/ 01711000
         MVI   FQTYPE(@09),X'80'                                   0573 01712000
*       GO TO FQECHK9;              /* RECORD ERROR                  */ 01713000
         B     FQECHK9                                             0574 01714000
*     END;                                                         0575 01715000
*   GO TO FQECHK2;                  /* CHECK NEXT FQE                */ 01716000
*                                                                  0576 01717000
         B     FQECHK2                                             0576 01718000
*   /*****************************************************************/ 01719000
*   /*                                                               */ 01720000
*   /* ERROR HANDLING                                                */ 01721000
*   /*                                                               */ 01722000
*   /*****************************************************************/ 01723000
*                                                                  0577 01724000
*FQECHK5:                                                          0577 01725000
*   ERRCODE=ADDR(ECF2);             /* SET ERROR CODE F2             */ 01726000
FQECHK5  LA    ERRCODE,ECF2                                        0577 01727000
*   DATA1=PREVFQE;                  /* DATA = PREVIOUS FQE ADDRESS   */ 01728000
         L     DATA1,PREVFQE                                       0578 01729000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01730000
         BAL   @14,EDVRA                                           0579 01731000
*FQECHK6:                                                          0580 01732000
*   PREVFQE->FQEPTRA=C0;            /* SET FQE POINTER IN PREVIOUS 0580 01733000
*                                      FQE TO ZERO                   */ 01734000
FQECHK6  L     @09,PREVFQE                                         0580 01735000
         SLR   @05,@05                                             0580 01736000
         STCM  @05,7,FQEPTRA(@09)                                  0580 01737000
*   RESPECIFY                                                      0581 01738000
*     RRETURN RESTRICTED;                                          0581 01739000
*   RRETURN=SAVE14FC;               /* RESTORE RETURN ADDRESS        */ 01740000
         L     RRETURN,SAVE14FC                                    0582 01741000
*   RETURN;                         /* RETURN TO CALLER              */ 01742000
         B     @EL00008                                            0583 01743000
*   RESPECIFY                                                      0584 01744000
*     RRETURN UNRESTRICTED;                                        0584 01745000
*FQECHK7:                                                          0585 01746000
*   ERRCODE=ADDR(ECF3);             /* SET ERROR CODE F3             */ 01747000
FQECHK7  LA    ERRCODE,ECF3                                        0585 01748000
*   DATA1=FQEADDR;                  /* DATA = FQE ADDRESS            */ 01749000
         L     DATA1,FQEADDR                                       0586 01750000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01751000
         BAL   @14,EDVRA                                           0587 01752000
*   GO TO FQECHK6;                  /* TRUNCATE FQE QUEUE            */ 01753000
         B     FQECHK6                                             0588 01754000
*FQECHK8:                                                          0589 01755000
*   FQTYPE=ZEROBYTE;                /* TURN OFF ALL FLAGS    @ZA24796*/ 01756000
FQECHK8  L     @09,FQESEPTR                                        0589 01757000
         MVI   FQTYPE(@09),X'00'                                   0589 01758000
*FQECHK9:                                                          0590 01759000
*   ERRCODE=ADDR(ECF1);             /* SET ERROR CODE F1             */ 01760000
FQECHK9  LA    ERRCODE,ECF1                                        0590 01761000
*   DATA1=FQEADDR;                  /* DATA = FQE ADDRESS            */ 01762000
         L     DATA1,FQEADDR                                       0591 01763000
*   CALL EDVRA;                     /* ENTER DATA IN VRA             */ 01764000
         BAL   @14,EDVRA                                           0592 01765000
*   GO TO FQECHK2;                  /* CONTINUE                      */ 01766000
         B     FQECHK2                                             0593 01767000
*   END FQECHK;                                                    0594 01768000
*                                                                  0595 01769000
*   /*****************************************************************/ 01770000
*   /*                                                               */ 01771000
*   /* PROCEDURE TO CHECK VALIDITY OF CELLS ON THE INTERNAL QUEUE OF */ 01772000
*   /* FREE CELLS. INPUT IS THE ADDRESS OF THE POOL ANCHOR.  @Z30ENWD*/ 01773000
*   /*                                                               */ 01774000
*   /*****************************************************************/ 01775000
*                                                                  0595 01776000
*CELLCHK:                                                          0595 01777000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z30ENWD*/ 01778000
CELLCHK  DS    0H                                                  0596 01779000
*   RESPECIFY                                                      0596 01780000
*     RRETURN RESTRICTED;                                          0596 01781000
*   SAVE14SC=RRETURN;               /* SAVE RETURN REG       @Z30ENWD*/ 01782000
         ST    RRETURN,SAVE14SC                                    0597 01783000
*   RESPECIFY                                                      0598 01784000
*     RRETURN UNRESTRICTED;                                        0598 01785000
*   CELLANCR=CELLADD;               /* SAVE ANCHOR PTR       @Z30ENWD*/ 01786000
         ST    CELLADD,CELLANCR                                    0599 01787000
*   CBCNT=0;                        /* CLEAR THE COUNTER     @Z30ENWD*/ 01788000
         L     @11,CELLANCR                                        0600 01789000
         SLR   @06,@06                                             0600 01790000
         ST    @06,CBCNT(,@11)                                     0600 01791000
*   FSTCELL=CBPTR;                  /* POINTER TO FIRST CELL @Z30ENWD*/ 01792000
         L     @11,CBPTR(,CELLADD)                                 0601 01793000
         ST    @11,FSTCELL                                         0601 01794000
*   DO WHILE CBPTR¬=0;              /* IF CELLS ON QUE       @Z30ENWD*/ 01795000
         B     @DE00602                                            0602 01796000
@DL00602 DS    0H                                                  0603 01797000
*     PREVCELL=CELLADD;             /* SAVE PREVIOUS PTR     @Z30ENWD*/ 01798000
         ST    CELLADD,PREVCELL                                    0603 01799000
*     CBCNT=CBCNT+1;                /* UPDATE COUNT          @Z30ENWD*/ 01800000
         L     @11,CELLANCR                                        0604 01801000
         LA    @05,1                                               0604 01802000
         AL    @05,CBCNT(,@11)                                     0604 01803000
         ST    @05,CBCNT(,@11)                                     0604 01804000
*     CELLADD=CBPTR;                /* GET NEXT POINTER      @Z30ENWD*/ 01805000
         L     CELLADD,CBPTR(,CELLADD)                             0605 01806000
*     ADCKADD=CELLADD;              /* LOAD ADD PARM         @Z30ENWD*/ 01807000
         LR    ADCKADD,CELLADD                                     0606 01808000
*     ADCKLEN=CELLEN;               /* LOAD LENGTH PARM      @Z30ENWD*/ 01809000
         LA    ADCKLEN,16                                          0607 01810000
*     CALL ADDRCHK;                 /* CALL ADD CHK ROUTINE  @Z30ENWD*/ 01811000
         BAL   @14,ADDRCHK                                         0608 01812000
*     RESPECIFY                                                    0609 01813000
*       RTRNCODE RESTRICTED;                                       0609 01814000
*     IF RTRNCODE¬=C0 THEN          /* WAS RETURN CODE BAD?  @Z30ENWD*/ 01815000
         LTR   RTRNCODE,RTRNCODE                                   0610 01816000
         BZ    @RF00610                                            0610 01817000
*       DO;                         /* YES, ERROR            @Z30ENWD*/ 01818000
*         RESPECIFY                                                0612 01819000
*           RTRNCODE UNRESTRICTED;                                 0612 01820000
*ECCERR:                                                           0613 01821000
*         ERRCODE=ADDR(ECC1);       /* LOAD ERROR CODE       @Z30ENWD*/ 01822000
ECCERR   LA    ERRCODE,ECC1                                        0613 01823000
*         DATA1=CELLADD;            /* LOAD PARM             @Z30ENWD*/ 01824000
         LR    DATA1,CELLADD                                       0614 01825000
*         CALL EDVRA;               /* CALL RECORDING RTN    @Z30ENWD*/ 01826000
         BAL   @14,EDVRA                                           0615 01827000
*         PREVCELL->CBPTR=C0;       /* TRUNCATE THE QUEUE    @Z30ENWD*/ 01828000
         L     @11,PREVCELL                                        0616 01829000
         SLR   @05,@05                                             0616 01830000
         ST    @05,CBPTR(,@11)                                     0616 01831000
*         CBCNT=CBCNT-1;            /* CORRECT COUNT         @Z30ENWD*/ 01832000
         L     @11,CELLANCR                                        0617 01833000
         L     @05,CBCNT(,@11)                                     0617 01834000
         BCTR  @05,0                                               0617 01835000
         ST    @05,CBCNT(,@11)                                     0617 01836000
*         GOTO CELLRTN;             /* CELL POOL REBUILT...RETURN  0618 01837000
*                                                            @Z30ENYG*/ 01838000
         B     CELLRTN                                             0618 01839000
*       END;                        /*                       @Z30ENWD*/ 01840000
*     CIRCELL=FSTCELL;              /* START AT TOP          @ZA18793*/ 01841000
@RF00610 L     CIRCELL,FSTCELL                                     0620 01842000
*CELLOOP:                                                          0621 01843000
*     IF CBPTR=CIRCELL THEN         /* POINTERS LOOPING?     @ZA18793*/ 01844000
CELLOOP  C     CIRCELL,CBPTR(,CELLADD)                             0621 01845000
         BE    @RT00621                                            0621 01846000
*       GOTO ECCERR;                /* RECORD ERROR          @ZA18793*/ 01847000
*     IF CELLADD¬=CIRCELL THEN                                     0623 01848000
         CR    CELLADD,CIRCELL                                     0623 01849000
         BE    @RF00623                                            0623 01850000
*       DO;                         /* LAST TO CHECK         @ZA18793*/ 01851000
*         CIRCELL=CIRCELL->CBPTR;   /* UPDATE POINTER        @ZA18793*/ 01852000
         L     CIRCELL,CBPTR(,CIRCELL)                             0625 01853000
*         GOTO CELLOOP;             /* TRY NEXT              @ZA18793*/ 01854000
         B     CELLOOP                                             0626 01855000
*       END;                        /*                       @ZA18793*/ 01856000
*   END;                            /*                       @Z30ENWD*/ 01857000
@RF00623 DS    0H                                                  0628 01858000
@DE00602 L     @11,CBPTR(,CELLADD)                                 0628 01859000
         LTR   @11,@11                                             0628 01860000
         BNZ   @DL00602                                            0628 01861000
*   RESPECIFY                                                      0629 01862000
*     RRETURN RESTRICTED;                                          0629 01863000
*CELLRTN:                                                          0630 01864000
*   RRETURN=SAVE14SC;               /* RESTORE REG 14        @Z30ENWD*/ 01865000
CELLRTN  L     RRETURN,SAVE14SC                                    0630 01866000
*   RETURN;                         /* RETURN TO CALLER      @Z30ENWD*/ 01867000
@EL00009 DS    0H                                                  0631 01868000
@EF00009 DS    0H                                                  0631 01869000
@ER00009 BR    @14                                                 0631 01870000
*   RESPECIFY                                                      0632 01871000
*     RRETURN UNRESTRICTED;                                        0632 01872000
*   END CELLCHK;                                                   0633 01873000
*                                                                  0634 01874000
*   /*****************************************************************/ 01875000
*   /*                                                               */ 01876000
*   /* PROCEDURE TO VERIFY THAT AN ADDRESS OR CONTROL BLOCK IS IN SQA*/ 01877000
*   /* OR LSQA. IF THE CHECK IS FOR LSQA AND THE ADDRESS IS NOT IN   */ 01878000
*   /* LSQA IT IS ALSO CHECKED FOR SQA.                              */ 01879000
*   /*                                                               */ 01880000
*   /*****************************************************************/ 01881000
*                                                                  0634 01882000
*ADDRCHK:                                                          0634 01883000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0634 01884000
ADDRCHK  DS    0H                                                  0635 01885000
*   RESPECIFY                                                      0635 01886000
*     RRETURN RESTRICTED;                                          0635 01887000
*   RESPECIFY                                                      0636 01888000
*     DQESECT BASED(ADCKDQE);       /* A DIFFERENT DQE POINTER IS  0636 01889000
*                                      USED                          */ 01890000
*   RESPECIFY                                                      0637 01891000
*     FQESECT BASED(ADCKFQE);       /* A DIFFERENT FQE POINTER IS  0637 01892000
*                                      USED                          */ 01893000
*   ADCKAUB=ADCKADD+ADCKLEN;        /* AREA UPPER BOUND              */ 01894000
         LR    @15,ADCKADD                                         0638 01895000
         ALR   @15,ADCKLEN                                         0638 01896000
         ST    @15,ADCKAUB                                         0638 01897000
*   IF QBLCKLOC=ON THEN             /* AREA IN LSQA?                 */ 01898000
         TM    QBLCKLOC,B'10000000'                                0639 01899000
         BNO   @RF00639                                            0639 01900000
*     DO;                           /* YES, INITIALIZE LSQA          */ 01901000
*       ADCKDQE=LSQAPTR;            /* SET LSQA SPQE ADDRESS AS    0641 01902000
*                                      PREVIOUS DQE                  */ 01903000
         L     ADCKDQE,LSQAPTR(,LDAPTR)                            0641 01904000
*       QADCKSQA=OFF;               /* INDICATE LSQA                 */ 01905000
         NI    QADCKSQA,B'10111111'                                0642 01906000
*     END;                                                         0643 01907000
*   ELSE                            /* AREA IS IN SQA                */ 01908000
*     DO;                           /* INITIALIZE SQA                */ 01909000
         B     @RC00639                                            0644 01910000
@RF00639 DS    0H                                                  0645 01911000
*ADDRCHK1:                                                         0645 01912000
*       ADCKDQE=SQASPQEP;           /* SET SQA SPQE ADDRESS AS     0645 01913000
*                                      PREVIOUS DQE                  */ 01914000
ADDRCHK1 L     @15,CVTPTR                                          0645 01915000
         L     @15,GDAPTR(,@15)                                    0645 01916000
         L     ADCKDQE,SQASPQEP(,@15)                              0645 01917000
*       QADCKSQA=ON;                /* INDICATE SQA                  */ 01918000
         OI    QADCKSQA,B'01000000'                                0646 01919000
*     END;                                                         0647 01920000
*ADDRCHK2:                                                         0648 01921000
*   ADCKDQE=DQEPTR;                 /* GET NEXT DQE                  */ 01922000
@RC00639 DS    0H                                                  0648 01923000
ADDRCHK2 L     ADCKDQE,DQEPTR(,ADCKDQE)                            0648 01924000
*   IF ADCKDQE=C0 THEN              /* IS THERE ONE                  */ 01925000
         LTR   ADCKDQE,ADCKDQE                                     0649 01926000
         BNZ   @RF00649                                            0649 01927000
*     DO;                           /* NO, IF LSQA TRY SQA           */ 01928000
*       IF QADCKSQA=OFF THEN        /* WAS THIS LSQA CHECK           */ 01929000
         TM    QADCKSQA,B'01000000'                                0651 01930000
         BZ    @RT00651                                            0651 01931000
*         GO TO ADDRCHK1;           /* YES, TRY SQA                  */ 01932000
*       ELSE                                                       0653 01933000
*         RETURN CODE(C4);          /* NO, RETURN, ADDRESS NOT VALID */ 01934000
         LA    @15,4                                               0653 01935000
@EL00010 DS    0H                                                  0653 01936000
@EF00010 DS    0H                                                  0653 01937000
@ER00010 BR    @14                                                 0653 01938000
*     END;                                                         0654 01939000
*   IF ADCKADD<DQEBLKAD THEN        /* IS AREA BELOW DQE             */ 01940000
@RF00649 L     @15,DQEBLKAD(,ADCKDQE)                              0655 01941000
         CR    ADCKADD,@15                                         0655 01942000
         BL    @RT00655                                            0655 01943000
*     GO TO ADDRCHK2;               /* YES, CHECK NEXT DQE           */ 01944000
*   ADCKDUB=DQEBLKAD+DQELNTH;       /* DQE UPPER BOUND               */ 01945000
         AL    @15,DQELNTH(,ADCKDQE)                               0657 01946000
         LR    ADCKDUB,@15                                         0657 01947000
*   IF ADCKAUB>ADCKDUB THEN         /* IS AREA ABOVE DQE             */ 01948000
         C     ADCKDUB,ADCKAUB                                     0658 01949000
         BL    @RT00658                                            0658 01950000
*     GO TO ADDRCHK2;               /* YES, CHECK NEXT DQE           */ 01951000
*/*                                                                0660 01952000
*   AREA IS IN THIS DQE, SEE IF IT IS ALLOCATED                    0660 01953000
*                                                                    */ 01954000
*                                                                  0660 01955000
*   ADCKFQE=ADCKDQE;                /* SET DQE AS PREVIOUS FQE       */ 01956000
         ST    ADCKDQE,ADCKFQE                                     0660 01957000
*ADDRCHK3:                                                         0661 01958000
*   ADCKFQE=FQEPTRA;                /* GET NEXT FQE                  */ 01959000
ADDRCHK3 L     @15,ADCKFQE                                         0661 01960000
         L     @15,FQEPTRA-1(,@15)                                 0661 01961000
         LA    @15,0(,@15)                                         0661 01962000
         ST    @15,ADCKFQE                                         0661 01963000
*   IF ADCKFQE=C0 THEN              /* IS THERE ONE                  */ 01964000
         SLR   @05,@05                                             0662 01965000
         CR    @15,@05                                             0662 01966000
         BNE   @RF00662                                            0662 01967000
*     RETURN CODE(C0);              /* NO, RETURN, ADDRESS VALID     */ 01968000
         LR    @15,@05                                             0663 01969000
         BR    @14                                                 0663 01970000
*   ADCKFUB=ADCKFQE+FQESLNTH;       /* FQE UPPER BOUND               */ 01971000
@RF00662 LA    ADCKFUB,8                                           0664 01972000
         AL    ADCKFUB,ADCKFQE                                     0664 01973000
*   IF ADCKADD>=ADCKFUB THEN        /* IS AREA ABOVE FQE             */ 01974000
         CR    ADCKADD,ADCKFUB                                     0665 01975000
         BL    @RF00665                                            0665 01976000
*     RETURN CODE(C0);              /* NO, RETURN, ADDRESS VALID     */ 01977000
         SLR   @15,@15                                             0666 01978000
         BR    @14                                                 0666 01979000
*   ADCKFLB=ADCKFUB-FQELNTH;        /* FQE LOWER BOUND               */ 01980000
@RF00665 LR    ADCKFLB,ADCKFUB                                     0667 01981000
         L     @15,ADCKFQE                                         0667 01982000
         SL    ADCKFLB,FQELNTH(,@15)                               0667 01983000
*   IF ADCKFLB<ADCKAUB THEN         /* IS FQE WITHIN AREA            */ 01984000
         C     ADCKFLB,ADCKAUB                                     0668 01985000
         BNL   @RF00668                                            0668 01986000
*     RETURN CODE(C4);              /* YES, RETURN, ADDRESS NOT VALID*/ 01987000
         LA    @15,4                                               0669 01988000
         BR    @14                                                 0669 01989000
*   GO TO ADDRCHK3;                 /* CHECK NEXT FQE                */ 01990000
         B     ADDRCHK3                                            0670 01991000
*   RESPECIFY                                                      0671 01992000
*     RRETURN UNRESTRICTED;                                        0671 01993000
*   END ADDRCHK;                                                   0672 01994000
*                                                                  0673 01995000
*   /*****************************************************************/ 01996000
*   /*                                                               */ 01997000
*   /* PROCEDURE TO ENTER DATA IN THE VARIABLE RECORDING AREA OF THE */ 01998000
*   /* SDWA. A ONE BYTE CODE, THREE BYTE LENGTH, AND UP TO TWO WORDS */ 01999000
*   /* OF DATA ARE ADDED TO THE SDWA VARIABLE RECORDING AREA.        */ 02000000
*   /*                                                               */ 02001000
*   /*****************************************************************/ 02002000
*                                                                  0673 02003000
*EDVRA:                                                            0673 02004000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0673 02005000
EDVRA    DS    0H                                                  0674 02006000
*   RESPECIFY                                                      0674 02007000
*     RRETURN RESTRICTED;                                          0674 02008000
*   IF SDWAVRAL-SDWAURAL-C4<DLEN THEN/* IS THERE ENOUGH SPACE LEFT   */ 02009000
         LH    @15,SDWAVRAL(,SDWAPTR)                              0675 02010000
         N     @15,@CF02575                                        0675 02011000
         SLR   @05,@05                                             0675 02012000
         IC    @05,SDWAURAL(,SDWAPTR)                              0675 02013000
         SLR   @15,@05                                             0675 02014000
         SL    @15,@CF00046                                        0675 02015000
         SLR   @05,@05                                             0675 02016000
         ICM   @05,7,DLEN(ERRCODE)                                 0675 02017000
         CR    @15,@05                                             0675 02018000
         BNL   @RF00675                                            0675 02019000
*     DO;                           /* NO, INDICATE DATA LOST        */ 02020000
*       SDWAVRA(C1)=ECFF;           /* PUT DATA LOST CODE IN FIRST 0677 02021000
*                                      BYTE                          */ 02022000
         MVC   SDWAVRA(1,SDWAPTR),ECFF                             0677 02023000
*       RETURN;                     /* RETURN TO CALLER              */ 02024000
@EL00011 DS    0H                                                  0678 02025000
@EF00011 DS    0H                                                  0678 02026000
@ER00011 BR    @14                                                 0678 02027000
*     END;                                                         0679 02028000
*   SDWAVRA(SDWAURAL+C1:SDWAURAL+C4)=ECDDLN;/* PUT CODE AND LENGTH IN   02029000
*                                      VRA                           */ 02030000
@RF00675 SLR   @15,@15                                             0680 02031000
         IC    @15,SDWAURAL(,SDWAPTR)                              0680 02032000
         ALR   @15,SDWAPTR                                         0680 02033000
         MVC   SDWAVRA(4,@15),ECDDLN(ERRCODE)                      0680 02034000
*   SDWAURAL=SDWAURAL+C4;           /* UPDATE LENGTH FOR CODE AND  0681 02035000
*                                      DATA LENGTH                   */ 02036000
         LA    @15,4                                               0681 02037000
         SLR   @05,@05                                             0681 02038000
         IC    @05,SDWAURAL(,SDWAPTR)                              0681 02039000
         ALR   @05,@15                                             0681 02040000
         STC   @05,SDWAURAL(,SDWAPTR)                              0681 02041000
*   IF DLEN¬<C4 THEN                /* IS THERE AT LEAST ONE DATA  0682 02042000
*                                      ITEM                          */ 02043000
         SLR   @03,@03                                             0682 02044000
         ICM   @03,7,DLEN(ERRCODE)                                 0682 02045000
         CR    @03,@15                                             0682 02046000
         BL    @RF00682                                            0682 02047000
*     DO;                           /* YES                           */ 02048000
*       SDWAVRA(SDWAURAL+C1:SDWAURAL+C4)=DATA1;/* MOVE IN FIRST DATA    02049000
*                                      ITEM                          */ 02050000
         ALR   @05,SDWAPTR                                         0684 02051000
         STCM  DATA1,15,SDWAVRA(@05)                               0684 02052000
*       SDWAURAL=SDWAURAL+C4;       /* UPDATE LENGTH                 */ 02053000
         SLR   @06,@06                                             0685 02054000
         IC    @06,SDWAURAL(,SDWAPTR)                              0685 02055000
         ALR   @06,@15                                             0685 02056000
         STC   @06,SDWAURAL(,SDWAPTR)                              0685 02057000
*       IF DLEN¬<C8 THEN            /* ARE THERE AT LEAST TWO DATA 0686 02058000
*                                      ITEMS                         */ 02059000
         C     @03,@CF00038                                        0686 02060000
         BL    @RF00686                                            0686 02061000
*         DO;                       /* YES                           */ 02062000
*           SDWAVRA(SDWAURAL+C1:SDWAURAL+C4)=DATA2;/* MOVE IN SECOND    02063000
*                                      DATA ITEM                     */ 02064000
         L     @05,DATA2                                           0688 02065000
         ALR   @06,SDWAPTR                                         0688 02066000
         STCM  @05,15,SDWAVRA(@06)                                 0688 02067000
*           SDWAURAL=SDWAURAL+C4;   /* UPDATE LENGTH                 */ 02068000
         SLR   @06,@06                                             0689 02069000
         IC    @06,SDWAURAL(,SDWAPTR)                              0689 02070000
         ALR   @06,@15                                             0689 02071000
         STC   @06,SDWAURAL(,SDWAPTR)                              0689 02072000
*         END;                                                     0690 02073000
*     END;                                                         0691 02074000
*   RETURN;                         /* NO, RETURN TO CALLER          */ 02075000
         B     @EL00011                                            0692 02076000
*   RESPECIFY                                                      0693 02077000
*     RRETURN UNRESTRICTED;                                        0693 02078000
*   END EDVRA;                                                     0694 02079000
         B     @EL00011                                            0694 02080000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 02081000
*     GPR00P PTR(31) REG(0),                                       0695 02082000
*     GPR01P PTR(31) REG(1),                                       0695 02083000
*     GPR14P PTR(31) REG(14),                                      0695 02084000
*     GPR15P PTR(31) REG(15);                                      0695 02085000
*   DECLARE                         /* COMMON VARIABLES              */ 02086000
*     I256C CHAR(256) BASED,                                       0696 02087000
*     I031F FIXED(31) BASED,                                       0696 02088000
*     I031P PTR(31) BASED,                                         0696 02089000
*     I015F FIXED(15) BASED,                                       0696 02090000
*     I015P PTR(15) BASED,                                         0696 02091000
*     I008P PTR(8) BASED,                                          0696 02092000
*     I001C CHAR(1) BASED;          /*                       @ZA20641*/ 02093000
*   END IEAVGFRR                                                   0697 02094000
*                                                                  0697 02095000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02096000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02097000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02098000
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */ 02099000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 02100000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 02101000
*/*%INCLUDE SYSLIB  (IHASDUMP)                                       */ 02102000
*/*%INCLUDE SYSLIB  (IHAGDA  )                                       */ 02103000
*/*%INCLUDE SYSLIB  (IHALDA  )                                       */ 02104000
*/*%INCLUDE SYSLIB  (IHASPQE )                                       */ 02105000
*/*%INCLUDE SYSLIB  (IHADQE  )                                       */ 02106000
*/*%INCLUDE SYSLIB  (IHAFQE  )                                       */ 02107000
*/*%INCLUDE SYSLIB  (IHAPQE  )                                       */ 02108000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 02109000
*                                                                  0697 02110000
*       ;                                                          0697 02111000
@DATA    DS    0H                                                       02112000
@DATD    DSECT                                                          02113000
         DS    0F                                                       02114000
IEAVGFRR CSECT                                                          02115000
         DS    0F                                                       02116000
@CF00046 DC    F'4'                                                     02117000
@CF00038 DC    F'8'                                                     02118000
@CF00129 DC    F'16'                                                    02119000
@CF02575 DC    XL4'0000FFFF'                                            02120000
@DATD    DSECT                                                          02121000
         DS    0D                                                       02122000
SPQEADDR DS    A                                                        02123000
DQEADDR  DS    A                                                        02124000
FQEADDR  DS    A                                                        02125000
CELLANCR DS    A                                                        02126000
SAVE14QR DS    F                                                        02127000
SAVE14SC DS    F                                                        02128000
SAVE14DC DS    F                                                        02129000
SAVE14FC DS    F                                                        02130000
PREVSPQE DS    A                                                        02131000
PREVFQE  DS    A                                                        02132000
FSTSPQE  DS    A                                                        02133000
FSTCELL  DS    A                                                        02134000
PREVCELL DS    A                                                        02135000
PFLB     DS    F                                                        02136000
ADCKFQE  DS    A                                                        02137000
ADCKAUB  DS    F                                                        02138000
DATA2    DS    F                                                        02139000
QFLAGS   DS    BL1                                                      02140000
         ORG   QFLAGS                                                   02141000
QBLCKLOC DS    BL1                                                      02142000
QADCKSQA EQU   QFLAGS+0                                                 02143000
QSALLOC  EQU   QFLAGS+0                                                 02144000
QSQATYP  EQU   QFLAGS+0                                                 02145000
QCSATYP  EQU   QFLAGS+0                                                 02146000
QLSQATYP EQU   QFLAGS+0                                                 02147000
QREGNTYP EQU   QFLAGS+0                                                 02148000
         ORG   QFLAGS+1                                                 02149000
IEAVGFRR CSECT                                                          02150000
         NOPR  ((@ENDDATD-@DATD)/73*16)                                 02151000
         DS    0F                                                       02152000
@SIZDATD DC    AL1(0)                                                   02153000
         DC    AL3(@ENDDATD-@DATD)                                      02154000
@CV02272 DC    V(PLISTERR)                                              02155000
         DS    0D                                                       02156000
SYSERR   DC    XL4'700'                                                 02157000
C16M     DC    XL4'1000000'                                             02158000
SQASPQCK DC    XL4'4000F500'                                            02159000
LSQSPQCK DC    XL4'4000FF00'                                            02160000
MDCSNAME DC    CL8'IEAVGM00'                                            02161000
FRRNAME  DC    CL8'IEAVGFRR'                                            02162000
IDOFTCB  DC    CL4'TCB '                                                02163000
EC01     DC    X'01000004'                                              02164000
EC02     DC    X'02000004'                                              02165000
EC03     DC    X'03000004'                                              02166000
EC04     DC    X'04000000'                                              02167000
EC05     DC    X'05000004'                                              02168000
EC06     DC    X'06000004'                                              02169000
ECB1     DC    X'B1000004'                                              02170000
ECB2     DC    X'B2000004'                                              02171000
ECB3     DC    X'B3000004'                                              02172000
ECB4     DC    X'B4000004'                                              02173000
ECC1     DC    X'C1000004'                                              02174000
ECD1     DC    X'D1000004'                                              02175000
ECD2     DC    X'D2000008'                                              02176000
ECD3     DC    X'D3000004'                                              02177000
ECD4     DC    X'D4000008'                                              02178000
ECD5     DC    X'D5000008'                                              02179000
ECD6     DC    X'D6000004'                                              02180000
ECF1     DC    X'F1000004'                                              02181000
ECF2     DC    X'F2000004'                                              02182000
ECF3     DC    X'F3000004'                                              02183000
ECFF     DC    X'FF'                                                    02184000
         DS    CL3                                                      02185000
BRTABLE  DC    AL4(UNEXPERR)                                            02186000
         DC    AL4(CLSALFLD)                                            02187000
         DC    AL4(CRSEGERR)                                            02188000
         DC    AL4(FNDPGERR)                                            02189000
         DC    AL4(GFREFAIL)                                            02190000
         DC    AL4(GTSALFLD)                                            02191000
         DC    AL4(PGRLSRC4)                                            02192000
         DC    AL4(SPFMERR)                                             02193000
IEAVGFRR CSECT                                                          02194000
*                                  /* SDUMP MACRO, LIST FORM DEF.   */  02195000
SDUMPL   SDUMP HDR='ERROR IN GETMAIN/FREEMAIN',SDATA=(PSA,SQA,LSQA),  **02196000
               MF=L                                                     02197000
@DATD    DSECT                                                          02198000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02199000
@ENDDATD EQU   *                                                        02200000
IEAVGFRR CSECT                                                          02201000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02202000
@01      EQU   01                                                       02203000
@02      EQU   02                                                       02204000
@03      EQU   03                                                       02205000
@04      EQU   04                                                       02206000
@05      EQU   05                                                       02207000
@06      EQU   06                                                       02208000
@07      EQU   07                                                       02209000
@08      EQU   08                                                       02210000
@09      EQU   09                                                       02211000
@10      EQU   10                                                       02212000
@11      EQU   11                                                       02213000
@12      EQU   12                                                       02214000
@13      EQU   13                                                       02215000
@14      EQU   14                                                       02216000
@15      EQU   15                                                       02217000
SVPARM14 EQU   @09                                                      02218000
SVPARMFL EQU   @08                                                      02219000
SAVE14SD EQU   @07                                                      02220000
SAVEREG1 EQU   @05                                                      02221000
VRAPTR   EQU   @02                                                      02222000
REGSPTR  EQU   @03                                                      02223000
DATA1    EQU   @06                                                      02224000
ERRCODE  EQU   @02                                                      02225000
ADCKFLB  EQU   @05                                                      02226000
ADCKFUB  EQU   @02                                                      02227000
ADCKDUB  EQU   @05                                                      02228000
ADCKDQE  EQU   @02                                                      02229000
ADCKLEN  EQU   @02                                                      02230000
ADCKADD  EQU   @06                                                      02231000
FUB      EQU   @02                                                      02232000
FLB      EQU   @07                                                      02233000
TDUB     EQU   @06                                                      02234000
TDQE     EQU   @03                                                      02235000
TPREVDQE EQU   @06                                                      02236000
DUB      EQU   @02                                                      02237000
DUL      EQU   @11                                                      02238000
DLL      EQU   @08                                                      02239000
CELLADD  EQU   @07                                                      02240000
CIRCELL  EQU   @02                                                      02241000
CIRSPQE  EQU   @02                                                      02242000
PREVDQE  EQU   @09                                                      02243000
RWORK2   EQU   @02                                                      02244000
RWORK1   EQU   @07                                                      02245000
CSASTART EQU   @10                                                      02246000
LDAPTR   EQU   @04                                                      02247000
SDWAPTR  EQU   @01                                                      02248000
SAVAREG  EQU   @13                                                      02249000
RRETURN  EQU   @14                                                      02250000
RTRNCODE EQU   @15                                                      02251000
GPR00P   EQU   @00                                                      02252000
GPR01P   EQU   @01                                                      02253000
GPR14P   EQU   @14                                                      02254000
GPR15P   EQU   @15                                                      02255000
CURRASID EQU   @02                                                      02256000
PSA      EQU   0                                                        02257000
FLCRNPSW EQU   PSA                                                      02258000
FLCROPSW EQU   PSA+8                                                    02259000
FLCICCW2 EQU   PSA+16                                                   02260000
FLCCVT   EQU   FLCICCW2                                                 02261000
PSAEEPSW EQU   PSA+132                                                  02262000
PSAESPSW EQU   PSA+136                                                  02263000
FLCSVILC EQU   PSAESPSW+1                                               02264000
PSAEPPSW EQU   PSA+140                                                  02265000
FLCPIILC EQU   PSAEPPSW+1                                               02266000
FLCPICOD EQU   PSAEPPSW+2                                               02267000
PSAPICOD EQU   FLCPICOD+1                                               02268000
FLCTEA   EQU   PSAEPPSW+4                                               02269000
FLCPER   EQU   PSA+152                                                  02270000
FLCMCLA  EQU   PSA+168                                                  02271000
FLCIOEL  EQU   FLCMCLA+4                                                02272000
FLCIOA   EQU   FLCMCLA+16                                               02273000
FLCFSA   EQU   FLCMCLA+80                                               02274000
PSATOLD  EQU   PSA+540                                                  02275000
PSAAOLD  EQU   PSA+548                                                  02276000
PSASUPER EQU   PSA+552                                                  02277000
PSASUP1  EQU   PSASUPER                                                 02278000
PSASUP2  EQU   PSASUPER+1                                               02279000
PSASUP3  EQU   PSASUPER+2                                               02280000
PSASUP4  EQU   PSASUPER+3                                               02281000
PSACLHT  EQU   PSA+640                                                  02282000
PSALKSA  EQU   PSA+696                                                  02283000
PSAHLHI  EQU   PSA+760                                                  02284000
PSADSSFL EQU   PSA+836                                                  02285000
PSADSSF1 EQU   PSADSSFL                                                 02286000
PSADSSF3 EQU   PSADSSFL+2                                               02287000
PSADSSF4 EQU   PSADSSFL+3                                               02288000
PSARSVT  EQU   PSA+896                                                  02289000
CVTMAP   EQU   0                                                        02290000
CVTDAR   EQU   CVTMAP+72                                                02291000
CVTFLGS1 EQU   CVTDAR                                                   02292000
CVTDCB   EQU   CVTMAP+116                                               02293000
CVTIOQET EQU   CVTMAP+120                                               02294000
CVTIERLC EQU   CVTMAP+144                                               02295000
CVTHEAD  EQU   CVTMAP+160                                               02296000
CVTSV76C EQU   CVTHEAD                                                  02297000
CVTOPTA  EQU   CVTMAP+182                                               02298000
CVTOPTB  EQU   CVTMAP+183                                               02299000
CVTGTF   EQU   CVTMAP+236                                               02300000
CVTGTFST EQU   CVTGTF                                                   02301000
CVTGTFS  EQU   CVTGTFST                                                 02302000
CVTSTATE EQU   CVTGTFST                                                 02303000
CVTTMODE EQU   CVTGTFST                                                 02304000
CVTFORM  EQU   CVTGTFST                                                 02305000
CVTAQAVT EQU   CVTMAP+240                                               02306000
CVTTCMFG EQU   CVTAQAVT                                                 02307000
CVTVOLM2 EQU   CVTMAP+244                                               02308000
CVTTATA  EQU   CVTVOLM2                                                 02309000
CVTTSKS  EQU   CVTTATA                                                  02310000
CVTVOLF2 EQU   CVTTSKS                                                  02311000
CVTTAT   EQU   CVTTATA+1                                                02312000
CVTATER  EQU   CVTMAP+248                                               02313000
CVTEXT1  EQU   CVTMAP+252                                               02314000
CVTPURG  EQU   CVTMAP+260                                               02315000
CVTQMSG  EQU   CVTMAP+268                                               02316000
CVTDMSR  EQU   CVTMAP+272                                               02317000
CVTRSV37 EQU   CVTDMSR                                                  02318000
CVTDMSRF EQU   CVTRSV37                                                 02319000
CVTERPV  EQU   CVTMAP+316                                               02320000
CVTINTLA EQU   CVTMAP+320                                               02321000
CVTAPF   EQU   CVTMAP+324                                               02322000
CVTEXT2  EQU   CVTMAP+328                                               02323000
CVTHJES  EQU   CVTMAP+332                                               02324000
CVTPGSIA EQU   CVTMAP+348                                               02325000
CVTA1F1  EQU   CVTMAP+356                                               02326000
CVTSYSK  EQU   CVTMAP+357                                               02327000
CVTVOLM1 EQU   CVTMAP+380                                               02328000
CVTVOLF1 EQU   CVTVOLM1                                                 02329000
CVTATMCT EQU   CVTMAP+388                                               02330000
CVTXTNT1 EQU   0                                                        02331000
CVTXTNT2 EQU   0                                                        02332000
CVTDSSV  EQU   CVTXTNT2                                                 02333000
CVTFLGBT EQU   CVTXTNT2+5                                               02334000
CVTQID   EQU   CVTXTNT2+24                                              02335000
CVTRV400 EQU   CVTXTNT2+52                                              02336000
CVTRV409 EQU   CVTXTNT2+53                                              02337000
CVTATCVT EQU   CVTXTNT2+64                                              02338000
CVTRV429 EQU   CVTXTNT2+84                                              02339000
CVTRV438 EQU   CVTXTNT2+85                                              02340000
CVTRV457 EQU   CVTXTNT2+112                                             02341000
CVTRV466 EQU   CVTXTNT2+113                                             02342000
CVTFIX   EQU   0                                                        02343000
CVTRELNO EQU   CVTFIX+252                                               02344000
PVT      EQU   0                                                        02345000
PVTFLAG1 EQU   PVT                                                      02346000
PVTFLAG2 EQU   PVT+1                                                    02347000
PVTLPRIV EQU   PVT+24                                                   02348000
PVTLCSA  EQU   PVT+26                                                   02349000
PVTHQSA  EQU   PVT+62                                                   02350000
PVTQS    EQU   PVT+304                                                  02351000
PVTWSAX  EQU   PVT+344                                                  02352000
ASCB     EQU   0                                                        02353000
ASCBSUPC EQU   ASCB+16                                                  02354000
ASCBASID EQU   ASCB+36                                                  02355000
ASCBRSM  EQU   ASCB+52                                                  02356000
ASCBRSMF EQU   ASCBRSM                                                  02357000
ASCBFW1  EQU   ASCB+100                                                 02358000
ASCBRCTF EQU   ASCBFW1+2                                                02359000
ASCBFLG1 EQU   ASCBFW1+3                                                02360000
ASCBDSP1 EQU   ASCB+114                                                 02361000
ASCBFLG2 EQU   ASCB+115                                                 02362000
ASCBLKGP EQU   ASCB+128                                                 02363000
ASCBSRQ  EQU   ASCB+180                                                 02364000
ASCBSRQ1 EQU   ASCBSRQ                                                  02365000
ASCBSRQ2 EQU   ASCBSRQ+1                                                02366000
ASCBSRQ3 EQU   ASCBSRQ+2                                                02367000
ASCBSRQ4 EQU   ASCBSRQ+3                                                02368000
TCBFIX   EQU   0                                                        02369000
TCBFRS   EQU   TCBFIX                                                   02370000
TCB      EQU   0                                                        02371000
TCBPIE   EQU   TCB+4                                                    02372000
TCBPMASK EQU   TCBPIE                                                   02373000
TCBCMP   EQU   TCB+16                                                   02374000
TCBCMPF  EQU   TCBCMP                                                   02375000
TCBCPP   EQU   TCBCMPF                                                  02376000
TCBSTCC  EQU   TCBCMPF                                                  02377000
TCBCDBL  EQU   TCBCMPF                                                  02378000
TCBCWTO  EQU   TCBCMPF                                                  02379000
TCBCIND  EQU   TCBCMPF                                                  02380000
TCBCMSG  EQU   TCBCMPF                                                  02381000
TCBTRN   EQU   TCB+20                                                   02382000
TCBABF   EQU   TCBTRN                                                   02383000
TCBMSS   EQU   TCB+24                                                   02384000
TCBPKF   EQU   TCB+28                                                   02385000
TCBFLGS  EQU   TCB+29                                                   02386000
TCBFLGS1 EQU   TCBFLGS                                                  02387000
TCBFLGS2 EQU   TCBFLGS+1                                                02388000
TCBFLGS3 EQU   TCBFLGS+2                                                02389000
TCBFLGS4 EQU   TCBFLGS+3                                                02390000
TCBFLGS5 EQU   TCBFLGS+4                                                02391000
TCBABWF  EQU   TCBFLGS5                                                 02392000
TCBJPQ   EQU   TCB+44                                                   02393000
TCBPURGE EQU   TCBJPQ                                                   02394000
TCBGRS   EQU   TCB+48                                                   02395000
TCBFSA   EQU   TCB+112                                                  02396000
TCBTME   EQU   TCB+120                                                  02397000
TCBJSTCB EQU   TCB+124                                                  02398000
TCBTSFLG EQU   TCB+148                                                  02399000
TCBTSTSK EQU   TCBTSFLG                                                 02400000
TCBSTAB  EQU   TCB+160                                                  02401000
TCBNSTAE EQU   TCBSTAB                                                  02402000
TCBTCT   EQU   TCB+164                                                  02403000
TCBTCTGF EQU   TCBTCT                                                   02404000
TCBSCNDY EQU   TCB+172                                                  02405000
TCBNDSP  EQU   TCBSCNDY                                                 02406000
TCBNDSP1 EQU   TCBNDSP+1                                                02407000
TCBNDSP2 EQU   TCBNDSP+2                                                02408000
TCBNDSP3 EQU   TCBNDSP+3                                                02409000
TCBJSCB  EQU   TCB+180                                                  02410000
TCBRECDE EQU   TCBJSCB                                                  02411000
TCBEXT1  EQU   TCB+196                                                  02412000
TCBBITS  EQU   TCB+200                                                  02413000
TCBNDSP4 EQU   TCBBITS                                                  02414000
TCBNDSP5 EQU   TCBBITS+1                                                02415000
TCBFLGS6 EQU   TCBBITS+2                                                02416000
TCBFLGS7 EQU   TCBBITS+3                                                02417000
TCBDAR   EQU   TCB+204                                                  02418000
TCBDARC  EQU   TCBDAR                                                   02419000
TCBEXT2  EQU   TCB+208                                                  02420000
TCBXSCT  EQU   TCB+240                                                  02421000
TCBXSCT1 EQU   TCBXSCT                                                  02422000
TCBFOE   EQU   TCB+244                                                  02423000
TCBSWA   EQU   TCB+248                                                  02424000
TCBTCBID EQU   TCB+256                                                  02425000
TCBESTAE EQU   TCB+264                                                  02426000
TCBESTRM EQU   TCBESTAE+1                                               02427000
TCBUKYSP EQU   TCB+268                                                  02428000
TCBFBYT1 EQU   TCB+276                                                  02429000
TCBFBYT2 EQU   TCB+277                                                  02430000
TCBRV124 EQU   TCB+278                                                  02431000
TCBRV133 EQU   TCB+279                                                  02432000
TCBXTNT2 EQU   0                                                        02433000
TCBGTF   EQU   TCBXTNT2                                                 02434000
TCBTFLG  EQU   TCBGTF                                                   02435000
TCBRV146 EQU   TCBXTNT2+28                                              02436000
TCBRV155 EQU   TCBXTNT2+29                                              02437000
TCBRV164 EQU   TCBXTNT2+30                                              02438000
TCBRV173 EQU   TCBXTNT2+31                                              02439000
SDUMP    EQU   0                                                        02440000
SDUSDAT1 EQU   SDUMP+2                                                  02441000
SDUSDAT2 EQU   SDUMP+3                                                  02442000
SDUMPPTR EQU   0                                                        02443000
GDA      EQU   0                                                        02444000
GVSMFLAG EQU   GDA                                                      02445000
GDAFLAGS EQU   GVSMFLAG                                                 02446000
CSAPQEP  EQU   GDA+8                                                    02447000
PASTRT   EQU   GDA+16                                                   02448000
PASIZE   EQU   GDA+20                                                   02449000
SQASPQEP EQU   GDA+24                                                   02450000
VRPOSTQ  EQU   GDA+32                                                   02451000
VRWAITQ  EQU   GDA+40                                                   02452000
CSASPQEP EQU   GDA+52                                                   02453000
GLBLCELL EQU   GDA+56                                                   02454000
LDA      EQU   0                                                        02455000
LVSMFLAG EQU   LDA                                                      02456000
LDATCB   EQU   LDA+12                                                   02457000
LDARQSTA EQU   LDA+16                                                   02458000
GMFMWKAR EQU   LDA+24                                                   02459000
BRANCHSV EQU   LDA+524                                                  02460000
SAVEREG2 EQU   LDA+588                                                  02461000
LSQAPTR  EQU   LDA+1464                                                 02462000
LCLCELL  EQU   LDA+1488                                                 02463000
SPQESECT EQU   0                                                        02464000
SPQEAD   EQU   SPQESECT                                                 02465000
SPQEPTR  EQU   SPQEAD                                                   02466000
SPDQEPTR EQU   SPQESECT+4                                               02467000
SPDQEAD  EQU   SPDQEPTR                                                 02468000
SPQEFLGS EQU   SPQESECT+8                                               02469000
SPSHARE  EQU   SPQEFLGS                                                 02470000
LASTSPQE EQU   SPQEFLGS                                                 02471000
SPQEID   EQU   SPQESECT+10                                              02472000
DQESECT  EQU   0                                                        02473000
DQEPTR   EQU   DQESECT+4                                                02474000
DQEBLKAD EQU   DQESECT+8                                                02475000
DQELNTH  EQU   DQESECT+12                                               02476000
FQESECT  EQU   0                                                        02477000
FQEPTR   EQU   FQESECT                                                  02478000
FQTYPE   EQU   FQEPTR                                                   02479000
FQEPTRA  EQU   FQEPTR+1                                                 02480000
FQELNTH  EQU   FQESECT+4                                                02481000
FQAREA   EQU   FQESECT+8                                                02482000
PQESECT  EQU   0                                                        02483000
PQESIZE  EQU   PQESECT+20                                               02484000
PQEREGN  EQU   PQESECT+24                                               02485000
VMMFLGS  EQU   PQESECT+30                                               02486000
PQESEPTR EQU   0                                                        02487000
SDWA     EQU   0                                                        02488000
SDWAPARM EQU   SDWA                                                     02489000
SDWAFIOB EQU   SDWA+4                                                   02490000
SDWAABCC EQU   SDWAFIOB                                                 02491000
SDWACMPF EQU   SDWAABCC                                                 02492000
SDWACMPC EQU   SDWAABCC+1                                               02493000
SDWACTL1 EQU   SDWA+8                                                   02494000
SDWACMKA EQU   SDWACTL1                                                 02495000
SDWAMWPA EQU   SDWACTL1+1                                               02496000
SDWAPMKA EQU   SDWACTL1+4                                               02497000
SDWACTL2 EQU   SDWA+16                                                  02498000
SDWACMKP EQU   SDWACTL2                                                 02499000
SDWAMWPP EQU   SDWACTL2+1                                               02500000
SDWAPMKP EQU   SDWACTL2+4                                               02501000
SDWAGRSV EQU   SDWA+24                                                  02502000
SDWANAME EQU   SDWA+88                                                  02503000
SDWAEC1  EQU   SDWA+104                                                 02504000
SDWAEMK1 EQU   SDWAEC1                                                  02505000
SDWAMWP1 EQU   SDWAEC1+1                                                02506000
SDWAINT1 EQU   SDWAEC1+2                                                02507000
SDWANXT1 EQU   SDWAEC1+4                                                02508000
SDWAAEC1 EQU   SDWA+112                                                 02509000
SDWAILC1 EQU   SDWAAEC1+1                                               02510000
SDWAINC1 EQU   SDWAAEC1+2                                               02511000
SDWAICD1 EQU   SDWAINC1+1                                               02512000
SDWAEC2  EQU   SDWA+120                                                 02513000
SDWAEMK2 EQU   SDWAEC2                                                  02514000
SDWAMWP2 EQU   SDWAEC2+1                                                02515000
SDWAINT2 EQU   SDWAEC2+2                                                02516000
SDWANXT2 EQU   SDWAEC2+4                                                02517000
SDWAAEC2 EQU   SDWA+128                                                 02518000
SDWAILC2 EQU   SDWAAEC2+1                                               02519000
SDWAINC2 EQU   SDWAAEC2+2                                               02520000
SDWAICD2 EQU   SDWAINC2+1                                               02521000
SDWASRSV EQU   SDWA+136                                                 02522000
SDWAIDNT EQU   SDWA+200                                                 02523000
SDWAMCH  EQU   SDWA+204                                                 02524000
SDWASTCK EQU   SDWAMCH                                                  02525000
SDWAMCHI EQU   SDWAMCH+8                                                02526000
SDWAMCHS EQU   SDWAMCHI                                                 02527000
SDWAMCHD EQU   SDWAMCHI+1                                               02528000
SDWARSR1 EQU   SDWAMCH+12                                               02529000
SDWARSR2 EQU   SDWAMCH+13                                               02530000
SDWAFLGS EQU   SDWA+232                                                 02531000
SDWAERRA EQU   SDWAFLGS                                                 02532000
SDWAMCHK EQU   SDWAERRA                                                 02533000
SDWAERRB EQU   SDWAFLGS+1                                               02534000
SDWAERRC EQU   SDWAFLGS+2                                               02535000
SDWAEAS  EQU   SDWAERRC                                                 02536000
SDWAERRD EQU   SDWAFLGS+3                                               02537000
SDWAFMID EQU   SDWA+236                                                 02538000
SDWAIOFS EQU   SDWA+238                                                 02539000
SDWARTYA EQU   SDWA+240                                                 02540000
SDWACPUA EQU   SDWA+248                                                 02541000
SDWAPARQ EQU   SDWA+252                                                 02542000
SDWARCDE EQU   SDWAPARQ                                                 02543000
SDWAACF2 EQU   SDWAPARQ+1                                               02544000
SDWARCRD EQU   SDWAACF2                                                 02545000
SDWAUPRG EQU   SDWAACF2                                                 02546000
SDWAFREE EQU   SDWAACF2                                                 02547000
SDWAACF3 EQU   SDWAPARQ+2                                               02548000
SDWASALL EQU   SDWAACF3                                                 02549000
SDWAACF4 EQU   SDWAPARQ+3                                               02550000
SDWALKWA EQU   SDWA+256                                                 02551000
SDWALKWS EQU   SDWALKWA                                                 02552000
SDWARECP EQU   SDWA+292                                                 02553000
SDWAMODN EQU   SDWARECP                                                 02554000
SDWACSCT EQU   SDWARECP+8                                               02555000
SDWAREXN EQU   SDWARECP+16                                              02556000
SDWASNPA EQU   SDWA+320                                                 02557000
SDWADUMP EQU   SDWASNPA                                                 02558000
SDWADPFS EQU   SDWADUMP+1                                               02559000
SDWADDAT EQU   SDWASNPA+4                                               02560000
SDWASDAT EQU   SDWADDAT                                                 02561000
SDWAPDAT EQU   SDWADDAT+2                                               02562000
SDWADPSA EQU   SDWA+328                                                 02563000
SDWADPSL EQU   SDWADPSA                                                 02564000
SDWARA   EQU   SDWA+400                                                 02565000
SDWAVRAL EQU   SDWARA                                                   02566000
SDWADPVA EQU   SDWARA+2                                                 02567000
SDWAHEX  EQU   SDWADPVA                                                 02568000
SDWAURAL EQU   SDWARA+3                                                 02569000
SDWAVRA  EQU   SDWARA+4                                                 02570000
SQASTART EQU   8                                                        02571000
FRRPARM  EQU   0                                                        02572000
PARMLDA  EQU   FRRPARM                                                  02573000
PARMFLGS EQU   FRRPARM+4                                                02574000
PARMFLG1 EQU   PARMFLGS                                                 02575000
PARMGLBL EQU   PARMFLG1                                                 02576000
PARMSALO EQU   PARMFLG1                                                 02577000
PARMVLCK EQU   PARMFLG1                                                 02578000
PARMSV14 EQU   FRRPARM+8                                                02579000
ROUTINE  EQU   0                                                        02580000
RETRYAD  EQU   0                                                        02581000
ECDDLN   EQU   0                                                        02582000
DLEN     EQU   ECDDLN+1                                                 02583000
DUMYCELL EQU   0                                                        02584000
CBPTR    EQU   DUMYCELL                                                 02585000
DUMYCTL  EQU   0                                                        02586000
CBCNT    EQU   DUMYCTL+4                                                02587000
@NM00098 EQU   0                                                        02588000
SPFLAGS1 EQU   @NM00098+1                                               02589000
LSQA1    EQU   SPFLAGS1                                                 02590000
CSA1     EQU   SPFLAGS1                                                 02591000
SQA1     EQU   SPFLAGS1                                                 02592000
INTFREGS EQU   0                                                        02593000
VRADATA  EQU   0                                                        02594000
I001C    EQU   0                                                        02595000
I008P    EQU   0                                                        02596000
I015F    EQU   0                                                        02597000
I015P    EQU   0                                                        02598000
I031F    EQU   0                                                        02599000
I031P    EQU   0                                                        02600000
I256C    EQU   0                                                        02601000
PSARSVTE EQU   PSARSVT                                                  02602000
CVTPTR   EQU   FLCCVT                                                   02603000
CVTS01   EQU   CVTPGSIA                                                 02604000
CVTPVTP  EQU   CVTS01+8                                                 02605000
CVTLPDIA EQU   CVTS01+12                                                02606000
CVTDIRST EQU   CVTLPDIA                                                 02607000
CVTSLIDA EQU   CVTS01+24                                                02608000
CVTCTLFG EQU   CVTS01+50                                                02609000
CVTGDA   EQU   CVTS01+212                                               02610000
CVTSDMP  EQU   CVTS01+232                                               02611000
CVTRV210 EQU   CVTS01+424                                               02612000
CVTRV219 EQU   CVTS01+425                                               02613000
CVTRV228 EQU   CVTS01+426                                               02614000
CVTRV237 EQU   CVTS01+427                                               02615000
CVTMFRTR EQU   CVTS01+452                                               02616000
CVTRV262 EQU   CVTS01+468                                               02617000
CVTRV271 EQU   CVTS01+469                                               02618000
CVTRV280 EQU   CVTS01+470                                               02619000
CVTRV289 EQU   CVTS01+471                                               02620000
CVTVPSA  EQU   CVTS01+560                                               02621000
CVTGSDA  EQU   CVTS01+600                                               02622000
PVTPTR   EQU   CVTPVTP                                                  02623000
ASCBPTR  EQU   PSAAOLD                                                  02624000
TCBPTR   EQU   LDATCB                                                   02625000
GDAPTR   EQU   CVTGDA                                                   02626000
SPQESPTR EQU   SPQEADDR                                                 02627000
DQESEPTR EQU   DQEADDR                                                  02628000
FQESEPTR EQU   FQEADDR                                                  02629000
SPQEANCR EQU   CELLANCR                                                 02630000
SPQEFLWD EQU   SPQEFLGS                                                 02631000
CURRQSTA EQU   LDARQSTA                                                 02632000
FLAGS    EQU   CURRQSTA                                                 02633000
EXPANSN  EQU   FLAGS                                                    02634000
FREEMB   EQU   FLAGS                                                    02635000
GETMB    EQU   FLAGS                                                    02636000
BRENTRY  EQU   FLAGS                                                    02637000
SPFLAGS  EQU   CURRQSTA+1                                               02638000
LSQA     EQU   SPFLAGS                                                  02639000
CSA      EQU   SPFLAGS                                                  02640000
SQA      EQU   SPFLAGS                                                  02641000
SVCBYTE  EQU   CURRQSTA+2                                               02642000
GMBSAVE  EQU   SAVEREG2                                                 02643000
GMBRQSTA EQU   GMBSAVE+48                                               02644000
WORKAREA EQU   GMFMWKAR                                                 02645000
LOCKFLAG EQU   WORKAREA+6                                               02646000
SALOBTND EQU   LOCKFLAG                                                 02647000
SALHELD  EQU   LOCKFLAG                                                 02648000
FRRBRNDX EQU   WORKAREA+7                                               02649000
REGSAVE  EQU   WORKAREA+8                                               02650000
DUMYDQE  EQU   WORKAREA+236                                             02651000
TEMPDQE  EQU   WORKAREA+252                                             02652000
SAVSVTSV EQU   WORKAREA+460                                             02653000
CELLFLGS EQU   WORKAREA+490                                             02654000
LCLREQ   EQU   CELLFLGS                                                 02655000
INCELL   EQU   CELLFLGS                                                 02656000
CSAEND   EQU   CVTVPSA                                                  02657000
FLC      EQU   PSA                                                      02658000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02659000
@NM00108 EQU   CELLFLGS                                                 02660000
@NM00107 EQU   CELLFLGS                                                 02661000
@NM00106 EQU   CELLFLGS                                                 02662000
@NM00105 EQU   WORKAREA+464                                             02663000
@NM00104 EQU   WORKAREA+268                                             02664000
@NM00103 EQU   WORKAREA+80                                              02665000
@NM00102 EQU   LOCKFLAG                                                 02666000
@NM00101 EQU   WORKAREA                                                 02667000
@NM00097 EQU   GMBSAVE                                                  02668000
MODE     EQU   CURRQSTA+3                                               02669000
SWA      EQU   SPFLAGS                                                  02670000
AUK      EQU   SPFLAGS                                                  02671000
@NM00096 EQU   SPFLAGS                                                  02672000
@NM00095 EQU   FLAGS                                                    02673000
@NM00094 EQU   FLAGS                                                    02674000
CVTRV628 EQU   CVTS01+728                                               02675000
CVTRV627 EQU   CVTS01+724                                               02676000
CVTRV626 EQU   CVTS01+720                                               02677000
CVTRV625 EQU   CVTS01+716                                               02678000
CVTRV624 EQU   CVTS01+712                                               02679000
CVTRV623 EQU   CVTS01+708                                               02680000
CVTRV622 EQU   CVTS01+704                                               02681000
CVTRV621 EQU   CVTS01+700                                               02682000
CVTIHASU EQU   CVTS01+696                                               02683000
CVTSUSP  EQU   CVTS01+692                                               02684000
CVTT6SVC EQU   CVTS01+688                                               02685000
CVTCDAL  EQU   CVTS01+684                                               02686000
CVTTCTL  EQU   CVTS01+680                                               02687000
CVTRSUME EQU   CVTS01+676                                               02688000
CVTJTERM EQU   CVTS01+672                                               02689000
CVTASMRM EQU   CVTS01+668                                               02690000
CVTTCASP EQU   CVTS01+664                                               02691000
CVT0PT03 EQU   CVTS01+660                                               02692000
CVT0PT0E EQU   CVTS01+656                                               02693000
CVTRV609 EQU   CVTS01+652                                               02694000
CVTCGK   EQU   CVTS01+648                                               02695000
CVTRAC   EQU   CVTS01+644                                               02696000
CVTHSM   EQU   CVTS01+640                                               02697000
CVTRV605 EQU   CVTS01+636                                               02698000
CVTRV604 EQU   CVTS01+632                                               02699000
CVTEFF02 EQU   CVTS01+628                                               02700000
CVTCBBR  EQU   CVTS01+624                                               02701000
CVTSSCR  EQU   CVTS01+620                                               02702000
CVTEVENT EQU   CVTS01+616                                               02703000
CVTCRCA  EQU   CVTS01+612                                               02704000
CVTTPIO  EQU   CVTS01+608                                               02705000
CVTADV   EQU   CVTS01+604                                               02706000
CVTGSDAB EQU   CVTGSDA                                                  02707000
CVTQV3   EQU   CVTS01+596                                               02708000
CVTQV2   EQU   CVTS01+592                                               02709000
CVTQV1   EQU   CVTS01+588                                               02710000
CVTRPT   EQU   CVTS01+584                                               02711000
CVTSSRB  EQU   CVTS01+580                                               02712000
CVTCSDRL EQU   CVTS01+576                                               02713000
CVTEXP1  EQU   CVTS01+572                                               02714000
CVTRMPMT EQU   CVTS01+568                                               02715000
CVTRMPTT EQU   CVTS01+564                                               02716000
CVTVSTOP EQU   CVTS01+556                                               02717000
CVTGTFR8 EQU   CVTS01+552                                               02718000
CVTQUIT  EQU   CVTS01+548                                               02719000
CVTVACR  EQU   CVTS01+544                                               02720000
CVTWTCB  EQU   CVTS01+540                                               02721000
CVTSTPRS EQU   CVTS01+536                                               02722000
CVT0PT02 EQU   CVTS01+532                                               02723000
CVTDARCM EQU   CVTS01+528                                               02724000
CVTIRECM EQU   CVTS01+524                                               02725000
CVTJRECM EQU   CVTS01+520                                               02726000
CVTVEMS0 EQU   CVTS01+516                                               02727000
CVTSPFRR EQU   CVTS01+512                                               02728000
CVTRLSTG EQU   CVTS01+508                                               02729000
CVT0TC0A EQU   CVTS01+504                                               02730000
CVTGMBR  EQU   CVTS01+500                                               02731000
CVTLFRM  EQU   CVTS01+496                                               02732000
CVTRMBR  EQU   CVTS01+492                                               02733000
CVTVIOP  EQU   CVTS01+488                                               02734000
CVTRV307 EQU   CVTS01+486                                               02735000
CVTRV306 EQU   CVTS01+484                                               02736000
CVTRV305 EQU   CVTS01+482                                               02737000
CVTRV304 EQU   CVTS01+480                                               02738000
CVTRV303 EQU   CVTS01+478                                               02739000
CVTRV302 EQU   CVTS01+476                                               02740000
CVTTRCA  EQU   CVTS01+472                                               02741000
CVTRV297 EQU   CVTRV289                                                 02742000
CVTRV296 EQU   CVTRV289                                                 02743000
CVTRV295 EQU   CVTRV289                                                 02744000
CVTRV294 EQU   CVTRV289                                                 02745000
CVTRV293 EQU   CVTRV289                                                 02746000
CVTRV292 EQU   CVTRV289                                                 02747000
CVTRV291 EQU   CVTRV289                                                 02748000
CVTRV290 EQU   CVTRV289                                                 02749000
CVTRV288 EQU   CVTRV280                                                 02750000
CVTRV287 EQU   CVTRV280                                                 02751000
CVTRV286 EQU   CVTRV280                                                 02752000
CVTRV285 EQU   CVTRV280                                                 02753000
CVTRV284 EQU   CVTRV280                                                 02754000
CVTRV283 EQU   CVTRV280                                                 02755000
CVTRV282 EQU   CVTRV280                                                 02756000
CVTRV281 EQU   CVTRV280                                                 02757000
CVTRV279 EQU   CVTRV271                                                 02758000
CVTRV278 EQU   CVTRV271                                                 02759000
CVTRV277 EQU   CVTRV271                                                 02760000
CVTRV276 EQU   CVTRV271                                                 02761000
CVTRV275 EQU   CVTRV271                                                 02762000
CVTRV274 EQU   CVTRV271                                                 02763000
CVTRV273 EQU   CVTRV271                                                 02764000
CVTRV272 EQU   CVTRV271                                                 02765000
CVTRV270 EQU   CVTRV262                                                 02766000
CVTRV269 EQU   CVTRV262                                                 02767000
CVTRV268 EQU   CVTRV262                                                 02768000
CVTRV267 EQU   CVTRV262                                                 02769000
CVTRV266 EQU   CVTRV262                                                 02770000
CVTRV265 EQU   CVTRV262                                                 02771000
CVTRV264 EQU   CVTRV262                                                 02772000
CVTRV263 EQU   CVTRV262                                                 02773000
CVTVFP   EQU   CVTS01+464                                               02774000
CVTVSI   EQU   CVTS01+460                                               02775000
CVTVPSIB EQU   CVTS01+456                                               02776000
CVTMFACT EQU   CVTMFRTR                                                 02777000
CVTMFCTL EQU   CVTS01+448                                               02778000
CVTPVBP  EQU   CVTS01+444                                               02779000
CVTPWI   EQU   CVTS01+440                                               02780000
CVTRV254 EQU   CVTS01+438                                               02781000
CVTRV253 EQU   CVTS01+436                                               02782000
CVTRV252 EQU   CVTS01+434                                               02783000
CVTRV251 EQU   CVTS01+433                                               02784000
CVTRV250 EQU   CVTS01+432                                               02785000
CVTRV249 EQU   CVTS01+431                                               02786000
CVTRV248 EQU   CVTS01+430                                               02787000
CVTRV247 EQU   CVTS01+429                                               02788000
CVTRV246 EQU   CVTS01+428                                               02789000
CVTRV245 EQU   CVTRV237                                                 02790000
CVTRV244 EQU   CVTRV237                                                 02791000
CVTRV243 EQU   CVTRV237                                                 02792000
CVTRV242 EQU   CVTRV237                                                 02793000
CVTRV241 EQU   CVTRV237                                                 02794000
CVTRV240 EQU   CVTRV237                                                 02795000
CVTRV239 EQU   CVTRV237                                                 02796000
CVTRV238 EQU   CVTRV237                                                 02797000
CVTRV236 EQU   CVTRV228                                                 02798000
CVTRV235 EQU   CVTRV228                                                 02799000
CVTRV234 EQU   CVTRV228                                                 02800000
CVTRV233 EQU   CVTRV228                                                 02801000
CVTRV232 EQU   CVTRV228                                                 02802000
CVTRV231 EQU   CVTRV228                                                 02803000
CVTRV230 EQU   CVTRV228                                                 02804000
CVTRV229 EQU   CVTRV228                                                 02805000
CVTRV227 EQU   CVTRV219                                                 02806000
CVTRV226 EQU   CVTRV219                                                 02807000
CVTRV225 EQU   CVTRV219                                                 02808000
CVTRV224 EQU   CVTRV219                                                 02809000
CVTRV223 EQU   CVTRV219                                                 02810000
CVTRV222 EQU   CVTRV219                                                 02811000
CVTRV221 EQU   CVTRV219                                                 02812000
CVTRV220 EQU   CVTRV219                                                 02813000
CVTRV218 EQU   CVTRV210                                                 02814000
CVTRV217 EQU   CVTRV210                                                 02815000
CVTRV216 EQU   CVTRV210                                                 02816000
CVTRV215 EQU   CVTRV210                                                 02817000
CVTRV214 EQU   CVTRV210                                                 02818000
CVTRV213 EQU   CVTRV210                                                 02819000
CVTRV212 EQU   CVTRV210                                                 02820000
CVTRV211 EQU   CVTRV210                                                 02821000
CVTLCCAT EQU   CVTS01+420                                               02822000
CVTPCCAT EQU   CVTS01+416                                               02823000
CVTIPCRP EQU   CVTS01+412                                               02824000
CVTIPCRI EQU   CVTS01+408                                               02825000
CVTIPCDS EQU   CVTS01+404                                               02826000
CVTAIDVT EQU   CVTS01+400                                               02827000
CVTSSAP  EQU   CVTS01+396                                               02828000
CVTEHCIR EQU   CVTS01+392                                               02829000
CVTEHDEF EQU   CVTS01+388                                               02830000
CVTDAIR  EQU   CVTS01+384                                               02831000
CVTPERFM EQU   CVTS01+380                                               02832000
CVT044R2 EQU   CVTS01+376                                               02833000
CVTFETCH EQU   CVTS01+372                                               02834000
CVTRSTWD EQU   CVTS01+368                                               02835000
CVTSPOST EQU   CVTS01+364                                               02836000
CVTIOBP  EQU   CVTS01+360                                               02837000
CVTASMVT EQU   CVTS01+356                                               02838000
CVTRECRQ EQU   CVTS01+352                                               02839000
CVTWSAC  EQU   CVTS01+348                                               02840000
CVTRV149 EQU   CVTS01+344                                               02841000
CVTWSAL  EQU   CVTS01+340                                               02842000
CVTSPSA  EQU   CVTS01+336                                               02843000
CVTGLMN  EQU   CVTS01+332                                               02844000
CVTVEAC0 EQU   CVTS01+328                                               02845000
CVT062R1 EQU   CVTS01+324                                               02846000
CVTRPOST EQU   CVTS01+320                                               02847000
CVTDQIQE EQU   CVTS01+316                                               02848000
CVTCSD   EQU   CVTS01+312                                               02849000
CVTLKRMA EQU   CVTS01+308                                               02850000
CVTRSPIE EQU   CVTS01+304                                               02851000
CVTRENQ  EQU   CVTS01+300                                               02852000
CVTLQCB  EQU   CVTS01+296                                               02853000
CVTFQCB  EQU   CVTS01+292                                               02854000
CVTQCS01 EQU   CVTS01+288                                               02855000
CVTAPFT  EQU   CVTS01+284                                               02856000
CVTPARRL EQU   CVTS01+280                                               02857000
CVTVWAIT EQU   CVTS01+276                                               02858000
CVTGSPL  EQU   CVTS01+272                                               02859000
CVTLSMQ  EQU   CVTS01+268                                               02860000
CVTGSMQ  EQU   CVTS01+264                                               02861000
CVTEXPRO EQU   CVTS01+260                                               02862000
CVTOPCTP EQU   CVTS01+256                                               02863000
CVTSIC   EQU   CVTS01+252                                               02864000
CVTTPIOS EQU   CVTS01+248                                               02865000
CVTRTMS  EQU   CVTS01+244                                               02866000
CVTSDBF  EQU   CVTS01+240                                               02867000
CVTSCBP  EQU   CVTS01+236                                               02868000
CVTSV60  EQU   CVTS01+228                                               02869000
CVTRTMCT EQU   CVTS01+224                                               02870000
CVTASCBL EQU   CVTS01+220                                               02871000
CVTASCBH EQU   CVTS01+216                                               02872000
CVTASVT  EQU   CVTS01+208                                               02873000
CVTVVMDI EQU   CVTS01+204                                               02874000
CVTAQTOP EQU   CVTS01+200                                               02875000
CVTIOSCS EQU   CVTS01+196                                               02876000
CVTSDRM  EQU   CVTS01+192                                               02877000
CVTOPTE  EQU   CVTS01+188                                               02878000
CVTSTXU  EQU   CVTS01+184                                               02879000
CVTQUIS  EQU   CVTS01+180                                               02880000
CVTPARS  EQU   CVTS01+176                                               02881000
CVTS1EE  EQU   CVTS01+172                                               02882000
CVTFRAS  EQU   CVTS01+168                                               02883000
CVTQSAS  EQU   CVTS01+164                                               02884000
CVTCRAS  EQU   CVTS01+160                                               02885000
CVTCRMN  EQU   CVTS01+156                                               02886000
CVTDELCP EQU   CVTS01+152                                               02887000
CVTFRECL EQU   CVTS01+148                                               02888000
CVTGETCL EQU   CVTS01+144                                               02889000
CVTBLDCP EQU   CVTS01+140                                               02890000
CVTAUTHL EQU   CVTS01+136                                               02891000
CVTSCAN  EQU   CVTS01+132                                               02892000
CVTRV144 EQU   CVTS01+130                                               02893000
CVTMAXMP EQU   CVTS01+128                                               02894000
CVTSTCK  EQU   CVTS01+124                                               02895000
CVTRV139 EQU   CVTS01+123                                               02896000
CVTDSSAC EQU   CVTS01+122                                               02897000
CVTRV513 EQU   CVTS01+121                                               02898000
CVTIOSPL EQU   CVTS01+120                                               02899000
CVTPTGT  EQU   CVTS01+116                                               02900000
CVTCSPIE EQU   CVTS01+112                                               02901000
CVTSMFEX EQU   CVTS01+108                                               02902000
CVTOLT0A EQU   CVTS01+104                                               02903000
CVTSRBRT EQU   CVTS01+100                                               02904000
CVTPUTL  EQU   CVTS01+96                                                02905000
CVTASCRL EQU   CVTS01+92                                                02906000
CVTASCRF EQU   CVTS01+88                                                02907000
CVTRV326 EQU   CVTS01+84                                                02908000
CVTRV325 EQU   CVTS01+80                                                02909000
CVTRV324 EQU   CVTS01+76                                                02910000
CVT0VL01 EQU   CVTS01+72                                                02911000
CVTSHRVM EQU   CVTS01+68                                                02912000
CVTRV332 EQU   CVTS01+64                                                02913000
CVTTAS   EQU   CVTS01+60                                                02914000
CVTRSCN  EQU   CVTS01+56                                                02915000
CVTTRAC2 EQU   CVTS01+54                                                02916000
CVTTRACE EQU   CVTS01+52                                                02917000
CVTAPG   EQU   CVTS01+51                                                02918000
CVTSDTRC EQU   CVTCTLFG                                                 02919000
CVTGTRCE EQU   CVTCTLFG                                                 02920000
CVTNOMP  EQU   CVTCTLFG                                                 02921000
CVTRSV79 EQU   CVTCTLFG                                                 02922000
CVTDSTAT EQU   CVTCTLFG                                                 02923000
CVTRSV78 EQU   CVTCTLFG                                                 02924000
CVTRV333 EQU   CVTCTLFG                                                 02925000
CVTRV323 EQU   CVTCTLFG                                                 02926000
CVTSPVLK EQU   CVTS01+49                                                02927000
CVTRSV77 EQU   CVTS01+48                                                02928000
CVTRV331 EQU   CVTS01+44                                                02929000
CVTRV330 EQU   CVTS01+40                                                02930000
CVTRV329 EQU   CVTS01+36                                                02931000
CVTRV328 EQU   CVTS01+32                                                02932000
CVTRV322 EQU   CVTS01+28                                                02933000
CVTSLID  EQU   CVTSLIDA+1                                               02934000
CVTSYLK  EQU   CVTSLIDA                                                 02935000
CVTRV321 EQU   CVTS01+20                                                02936000
CVTRV320 EQU   CVTS01+16                                                02937000
CVTLPDIR EQU   CVTLPDIA+1                                               02938000
CVTRSV69 EQU   CVTDIRST                                                 02939000
CVTRSV68 EQU   CVTDIRST                                                 02940000
CVTRSV67 EQU   CVTDIRST                                                 02941000
CVTRSV66 EQU   CVTDIRST                                                 02942000
CVTRSV65 EQU   CVTDIRST                                                 02943000
CVTRSV64 EQU   CVTDIRST                                                 02944000
CVTRSV63 EQU   CVTDIRST                                                 02945000
CVTDICOM EQU   CVTDIRST                                                 02946000
CVTLPDSR EQU   CVTS01+4                                                 02947000
CVTGETL  EQU   CVTS01                                                   02948000
PSARSAV  EQU   PSARSVTE+60                                              02949000
PSARSTK  EQU   PSARSVTE+56                                              02950000
PSAESAV3 EQU   PSARSVTE+52                                              02951000
PSAESTK3 EQU   PSARSVTE+48                                              02952000
PSAESAV2 EQU   PSARSVTE+44                                              02953000
PSAESTK2 EQU   PSARSVTE+40                                              02954000
PSAESAV1 EQU   PSARSVTE+36                                              02955000
PSAESTK1 EQU   PSARSVTE+32                                              02956000
PSAPSAV  EQU   PSARSVTE+28                                              02957000
PSAPSTK  EQU   PSARSVTE+24                                              02958000
PSAMSAV  EQU   PSARSVTE+20                                              02959000
PSAMSTK  EQU   PSARSVTE+16                                              02960000
PSASSAV  EQU   PSARSVTE+12                                              02961000
PSASSTK  EQU   PSARSVTE+8                                               02962000
PSANSTK  EQU   PSARSVTE+4                                               02963000
PSACSTK  EQU   PSARSVTE                                                 02964000
@NM00100 EQU   SPFLAGS1                                                 02965000
@NM00099 EQU   @NM00098                                                 02966000
@NM00093 EQU   DUMYCTL                                                  02967000
@NM00092 EQU   DUMYCELL+4                                               02968000
ECODE    EQU   ECDDLN                                                   02969000
@NM00091 EQU   FRRPARM+12                                               02970000
@NM00090 EQU   PARMFLGS+1                                               02971000
@NM00089 EQU   SDWA+512                                                 02972000
@NM00088 EQU   SDWADPVA                                                 02973000
SDWAEBC  EQU   SDWADPVA                                                 02974000
@NM00087 EQU   SDWA+396                                                 02975000
SDWACOMP EQU   SDWA+392                                                 02976000
SDWARCPL EQU   SDWA+364                                                 02977000
@NM00086 EQU   SDWADPSA+32                                              02978000
SDWATO4  EQU   SDWADPSL+28                                              02979000
SDWAFRM4 EQU   SDWADPSL+24                                              02980000
SDWATO3  EQU   SDWADPSL+20                                              02981000
SDWAFRM3 EQU   SDWADPSL+16                                              02982000
SDWATO2  EQU   SDWADPSL+12                                              02983000
SDWAFRM2 EQU   SDWADPSL+8                                               02984000
SDWATO1  EQU   SDWADPSL+4                                               02985000
SDWAFRM1 EQU   SDWADPSL                                                 02986000
@NM00085 EQU   SDWADDAT+3                                               02987000
@NM00084 EQU   SDWAPDAT                                                 02988000
SDWAUSPL EQU   SDWAPDAT                                                 02989000
SDWADPSW EQU   SDWAPDAT                                                 02990000
SDWATJPA EQU   SDWAPDAT                                                 02991000
SDWATLPA EQU   SDWAPDAT                                                 02992000
SDWADREG EQU   SDWAPDAT                                                 02993000
SDWADSAH EQU   SDWAPDAT                                                 02994000
SDWADSAS EQU   SDWAPDAT                                                 02995000
@NM00083 EQU   SDWADDAT+1                                               02996000
@NM00082 EQU   SDWASDAT                                                 02997000
SDWAQQS  EQU   SDWASDAT                                                 02998000
SDWACBS  EQU   SDWASDAT                                                 02999000
SDWAGTF  EQU   SDWASDAT                                                 03000000
SDWASWA  EQU   SDWASDAT                                                 03001000
SDWALSQA EQU   SDWASDAT                                                 03002000
SDWASQA  EQU   SDWASDAT                                                 03003000
SDWANUC  EQU   SDWASDAT                                                 03004000
@NM00081 EQU   SDWADUMP+2                                               03005000
@NM00080 EQU   SDWADPFS                                                 03006000
SDWASLST EQU   SDWADPFS                                                 03007000
@NM00079 EQU   SDWADPFS                                                 03008000
SDWADLST EQU   SDWADPFS                                                 03009000
SDWADPT  EQU   SDWADPFS                                                 03010000
SDWADPID EQU   SDWADUMP                                                 03011000
SDWADPLA EQU   SDWA+316                                                 03012000
@NM00078 EQU   SDWA+290                                                 03013000
SDWAASID EQU   SDWA+288                                                 03014000
SDWATALW EQU   SDWALKWS+28                                              03015000
SDWATDLW EQU   SDWALKWS+24                                              03016000
SDWATNLW EQU   SDWALKWS+20                                              03017000
SDWAAPLW EQU   SDWALKWS+16                                              03018000
SDWAIPLW EQU   SDWALKWS+12                                              03019000
SDWAILLW EQU   SDWALKWS+8                                               03020000
SDWAIULW EQU   SDWALKWS+4                                               03021000
SDWAICLW EQU   SDWALKWS                                                 03022000
SDWAFLLK EQU   SDWAACF4                                                 03023000
SDWACMS  EQU   SDWAACF4                                                 03024000
SDWAOPTM EQU   SDWAACF4                                                 03025000
SDWATADB EQU   SDWAACF4                                                 03026000
SDWATDNB EQU   SDWAACF4                                                 03027000
SDWATNCB EQU   SDWAACF4                                                 03028000
SDWAILCH EQU   SDWAACF4                                                 03029000
SDWAIUCB EQU   SDWAACF4                                                 03030000
SDWAICAT EQU   SDWAACF3                                                 03031000
SDWAIPRG EQU   SDWAACF3                                                 03032000
SDWAASMP EQU   SDWAACF3                                                 03033000
SDWADISP EQU   SDWAACF3                                                 03034000
@NM00077 EQU   SDWAACF3                                                 03035000
@NM00076 EQU   SDWAACF2                                                 03036000
@NM00075 EQU   SDWAACF2                                                 03037000
SDWASPIN EQU   SDWAACF2                                                 03038000
@NM00074 EQU   SDWAACF2                                                 03039000
SDWALCPU EQU   SDWACPUA+2                                               03040000
@NM00073 EQU   SDWACPUA                                                 03041000
SDWARECA EQU   SDWA+244                                                 03042000
@NM00072 EQU   SDWA+239                                                 03043000
@NM00071 EQU   SDWAIOFS                                                 03044000
SDWANIOP EQU   SDWAIOFS                                                 03045000
SDWANOIO EQU   SDWAIOFS                                                 03046000
SDWAIOHT EQU   SDWAIOFS                                                 03047000
SDWAIOQR EQU   SDWAIOFS                                                 03048000
@NM00070 EQU   SDWAERRD                                                 03049000
SDWAMCIV EQU   SDWAERRD                                                 03050000
SDWARPIV EQU   SDWAERRD                                                 03051000
SDWAMABD EQU   SDWAERRD                                                 03052000
SDWACTS  EQU   SDWAERRD                                                 03053000
SDWASTAE EQU   SDWAERRD                                                 03054000
SDWANRBE EQU   SDWAERRD                                                 03055000
SDWACLUP EQU   SDWAERRD                                                 03056000
@NM00069 EQU   SDWAERRC                                                 03057000
SDWAPERC EQU   SDWAERRC                                                 03058000
SDWAIRB  EQU   SDWAERRC                                                 03059000
SDWASTAI EQU   SDWAERRC                                                 03060000
SDWASTAF EQU   SDWAERRC                                                 03061000
SDWASRBM EQU   SDWAERRB                                                 03062000
SDWALDIS EQU   SDWAERRB                                                 03063000
SDWAENRB EQU   SDWAERRB                                                 03064000
SDWATYP1 EQU   SDWAERRB                                                 03065000
@NM00068 EQU   SDWAERRB                                                 03066000
SDWAPGIO EQU   SDWAERRA                                                 03067000
SDWATEXC EQU   SDWAERRA                                                 03068000
SDWASVCE EQU   SDWAERRA                                                 03069000
SDWAABTM EQU   SDWAERRA                                                 03070000
SDWASVCD EQU   SDWAERRA                                                 03071000
SDWARKEY EQU   SDWAERRA                                                 03072000
SDWAPCHK EQU   SDWAERRA                                                 03073000
SDWATIME EQU   SDWAMCH+20                                               03074000
SDWARFSA EQU   SDWAMCH+16                                               03075000
@NM00067 EQU   SDWAMCH+14                                               03076000
SDWAVEQR EQU   SDWARSR2                                                 03077000
SDWAPGFX EQU   SDWARSR2                                                 03078000
SDWAFLSQ EQU   SDWARSR2                                                 03079000
SDWAFSQA EQU   SDWARSR2                                                 03080000
SDWANUCL EQU   SDWARSR2                                                 03081000
SDWASPER EQU   SDWARSR2                                                 03082000
SDWAINTC EQU   SDWARSR2                                                 03083000
SDWAOFLN EQU   SDWARSR2                                                 03084000
SDWACHNG EQU   SDWARSR1                                                 03085000
SDWAMSER EQU   SDWARSR1                                                 03086000
@NM00066 EQU   SDWARSR1                                                 03087000
SDWACPID EQU   SDWAMCH+10                                               03088000
SDWATERR EQU   SDWAMCHD                                                 03089000
SDWAFPRX EQU   SDWAMCHD                                                 03090000
SDWAINSF EQU   SDWAMCHD                                                 03091000
SDWAACR  EQU   SDWAMCHD                                                 03092000
SDWASCK  EQU   SDWAMCHD                                                 03093000
SDWAPSWU EQU   SDWAMCHD                                                 03094000
SDWAREGU EQU   SDWAMCHD                                                 03095000
SDWASKYF EQU   SDWAMCHD                                                 03096000
@NM00065 EQU   SDWAMCHS                                                 03097000
SDWARSRF EQU   SDWAMCHS                                                 03098000
SDWARSRC EQU   SDWAMCHS                                                 03099000
SDWAINVP EQU   SDWAMCHS                                                 03100000
SDWATSVL EQU   SDWAMCHS                                                 03101000
SDWARCDF EQU   SDWAMCHS                                                 03102000
SDWASRVL EQU   SDWAMCHS                                                 03103000
SDWASCKE EQU   SDWASTCK+4                                               03104000
SDWASCKB EQU   SDWASTCK                                                 03105000
SDWALNTH EQU   SDWAIDNT+1                                               03106000
SDWASPID EQU   SDWAIDNT                                                 03107000
SDWASR15 EQU   SDWASRSV+60                                              03108000
SDWASR14 EQU   SDWASRSV+56                                              03109000
SDWASR13 EQU   SDWASRSV+52                                              03110000
SDWASR12 EQU   SDWASRSV+48                                              03111000
SDWASR11 EQU   SDWASRSV+44                                              03112000
SDWASR10 EQU   SDWASRSV+40                                              03113000
SDWASR09 EQU   SDWASRSV+36                                              03114000
SDWASR08 EQU   SDWASRSV+32                                              03115000
SDWASR07 EQU   SDWASRSV+28                                              03116000
SDWASR06 EQU   SDWASRSV+24                                              03117000
SDWASR05 EQU   SDWASRSV+20                                              03118000
SDWASR04 EQU   SDWASRSV+16                                              03119000
SDWASR03 EQU   SDWASRSV+12                                              03120000
SDWASR02 EQU   SDWASRSV+8                                               03121000
SDWASR01 EQU   SDWASRSV+4                                               03122000
SDWASR00 EQU   SDWASRSV                                                 03123000
SDWATRN2 EQU   SDWAAEC2+4                                               03124000
SDWAIPC2 EQU   SDWAICD2                                                 03125000
SDWAIMC2 EQU   SDWAICD2                                                 03126000
SDWAIPR2 EQU   SDWAICD2                                                 03127000
@NM00064 EQU   SDWAINC2                                                 03128000
@NM00063 EQU   SDWAILC2                                                 03129000
SDWAIL2  EQU   SDWAILC2                                                 03130000
@NM00062 EQU   SDWAILC2                                                 03131000
@NM00061 EQU   SDWAAEC2                                                 03132000
SDWAADD2 EQU   SDWANXT2+1                                               03133000
@NM00060 EQU   SDWANXT2                                                 03134000
@NM00059 EQU   SDWAEC2+3                                                03135000
SDWASGN2 EQU   SDWAINT2                                                 03136000
SDWAEXP2 EQU   SDWAINT2                                                 03137000
SDWADEC2 EQU   SDWAINT2                                                 03138000
SDWAFPO2 EQU   SDWAINT2                                                 03139000
SDWACC2  EQU   SDWAINT2                                                 03140000
@NM00058 EQU   SDWAINT2                                                 03141000
SDWAPGM2 EQU   SDWAMWP2                                                 03142000
SDWAWAT2 EQU   SDWAMWP2                                                 03143000
SDWAMCK2 EQU   SDWAMWP2                                                 03144000
SDWAECT2 EQU   SDWAMWP2                                                 03145000
SDWAKEY2 EQU   SDWAMWP2                                                 03146000
SDWAEXT2 EQU   SDWAEMK2                                                 03147000
SDWAIO2  EQU   SDWAEMK2                                                 03148000
SDWATRM2 EQU   SDWAEMK2                                                 03149000
@NM00057 EQU   SDWAEMK2                                                 03150000
SDWAPER2 EQU   SDWAEMK2                                                 03151000
@NM00056 EQU   SDWAEMK2                                                 03152000
SDWATRAN EQU   SDWAAEC1+4                                               03153000
SDWAIPC1 EQU   SDWAICD1                                                 03154000
SDWAIMC1 EQU   SDWAICD1                                                 03155000
SDWAIPR1 EQU   SDWAICD1                                                 03156000
@NM00055 EQU   SDWAINC1                                                 03157000
@NM00054 EQU   SDWAILC1                                                 03158000
SDWAIL1  EQU   SDWAILC1                                                 03159000
@NM00053 EQU   SDWAILC1                                                 03160000
@NM00052 EQU   SDWAAEC1                                                 03161000
SDWAADD1 EQU   SDWANXT1+1                                               03162000
@NM00051 EQU   SDWANXT1                                                 03163000
@NM00050 EQU   SDWAEC1+3                                                03164000
SDWASGN1 EQU   SDWAINT1                                                 03165000
SDWAEXP1 EQU   SDWAINT1                                                 03166000
SDWADEC1 EQU   SDWAINT1                                                 03167000
SDWAFPO1 EQU   SDWAINT1                                                 03168000
SDWACC1  EQU   SDWAINT1                                                 03169000
@NM00049 EQU   SDWAINT1                                                 03170000
SDWAPGM1 EQU   SDWAMWP1                                                 03171000
SDWAWAT1 EQU   SDWAMWP1                                                 03172000
SDWAMCK1 EQU   SDWAMWP1                                                 03173000
SDWAECT1 EQU   SDWAMWP1                                                 03174000
SDWAKEY1 EQU   SDWAMWP1                                                 03175000
SDWAEXT1 EQU   SDWAEMK1                                                 03176000
SDWAIO1  EQU   SDWAEMK1                                                 03177000
SDWATRM1 EQU   SDWAEMK1                                                 03178000
@NM00048 EQU   SDWAEMK1                                                 03179000
SDWAPER1 EQU   SDWAEMK1                                                 03180000
@NM00047 EQU   SDWAEMK1                                                 03181000
SDWAIOBR EQU   SDWA+100                                                 03182000
SDWAEPA  EQU   SDWA+96                                                  03183000
@NM00046 EQU   SDWANAME+4                                               03184000
SDWARBAD EQU   SDWANAME                                                 03185000
SDWAGR15 EQU   SDWAGRSV+60                                              03186000
SDWAGR14 EQU   SDWAGRSV+56                                              03187000
SDWAGR13 EQU   SDWAGRSV+52                                              03188000
SDWAGR12 EQU   SDWAGRSV+48                                              03189000
SDWAGR11 EQU   SDWAGRSV+44                                              03190000
SDWAGR10 EQU   SDWAGRSV+40                                              03191000
SDWAGR09 EQU   SDWAGRSV+36                                              03192000
SDWAGR08 EQU   SDWAGRSV+32                                              03193000
SDWAGR07 EQU   SDWAGRSV+28                                              03194000
SDWAGR06 EQU   SDWAGRSV+24                                              03195000
SDWAGR05 EQU   SDWAGRSV+20                                              03196000
SDWAGR04 EQU   SDWAGRSV+16                                              03197000
SDWAGR03 EQU   SDWAGRSV+12                                              03198000
SDWAGR02 EQU   SDWAGRSV+8                                               03199000
SDWAGR01 EQU   SDWAGRSV+4                                               03200000
SDWAGR00 EQU   SDWAGRSV                                                 03201000
SDWANXTP EQU   SDWACTL2+5                                               03202000
SDWASGP  EQU   SDWAPMKP                                                 03203000
SDWAEUP  EQU   SDWAPMKP                                                 03204000
SDWADOP  EQU   SDWAPMKP                                                 03205000
SDWAFPP  EQU   SDWAPMKP                                                 03206000
SDWACCP  EQU   SDWAPMKP                                                 03207000
SDWAILP  EQU   SDWAPMKP                                                 03208000
SDWAINTP EQU   SDWACTL2+2                                               03209000
SDWASPVP EQU   SDWAMWPP                                                 03210000
SDWAWATP EQU   SDWAMWPP                                                 03211000
SDWAMCKP EQU   SDWAMWPP                                                 03212000
@NM00045 EQU   SDWAMWPP                                                 03213000
SDWAKEYP EQU   SDWAMWPP                                                 03214000
SDWAEXTP EQU   SDWACMKP                                                 03215000
SDWAIOP  EQU   SDWACMKP                                                 03216000
SDWANXTA EQU   SDWACTL1+5                                               03217000
SDWASGA  EQU   SDWAPMKA                                                 03218000
SDWAEUA  EQU   SDWAPMKA                                                 03219000
SDWADOA  EQU   SDWAPMKA                                                 03220000
SDWAFPA  EQU   SDWAPMKA                                                 03221000
SDWACCA  EQU   SDWAPMKA                                                 03222000
SDWAILA  EQU   SDWAPMKA                                                 03223000
SDWAINTA EQU   SDWACTL1+2                                               03224000
SDWASPVA EQU   SDWAMWPA                                                 03225000
SDWAWATA EQU   SDWAMWPA                                                 03226000
SDWAMCKA EQU   SDWAMWPA                                                 03227000
@NM00044 EQU   SDWAMWPA                                                 03228000
SDWAKEYA EQU   SDWAMWPA                                                 03229000
SDWAEXTA EQU   SDWACMKA                                                 03230000
SDWAIOA  EQU   SDWACMKA                                                 03231000
@NM00043 EQU   SDWACMPF                                                 03232000
SDWASTCC EQU   SDWACMPF                                                 03233000
@NM00042 EQU   SDWACMPF                                                 03234000
SDWASTEP EQU   SDWACMPF                                                 03235000
SDWAREQ  EQU   SDWACMPF                                                 03236000
PQERSVD  EQU   PQESECT+31                                               03237000
VVVRFLG  EQU   VMMFLGS                                                  03238000
@NM00041 EQU   VMMFLGS                                                  03239000
PQEHRID  EQU   PQESECT+29                                               03240000
PQERFLGS EQU   PQESECT+28                                               03241000
PQETCB   EQU   PQESECT+16                                               03242000
PQEBPQE  EQU   PQESECT+12                                               03243000
PQEFPQE  EQU   PQESECT+8                                                03244000
PQEBFBQE EQU   PQESECT+4                                                03245000
PQEFFBQE EQU   PQESECT                                                  03246000
FQERSVD  EQU   FQESECT+12                                               03247000
FQECPB   EQU   FQTYPE                                                   03248000
FQERGNFL EQU   FQTYPE                                                   03249000
DQEHRID  EQU   DQEBLKAD                                                 03250000
DQFQEPTR EQU   DQESECT                                                  03251000
SPQERES2 EQU   SPQESECT+12                                              03252000
SPQEKEY  EQU   SPQESECT+11                                              03253000
SPQERES1 EQU   SPQESECT+9                                               03254000
SPQEOWN  EQU   SPQEFLGS                                                 03255000
LDAEND   EQU   LDA+1496                                                 03256000
LCLCELCT EQU   LDA+1492                                                 03257000
LDALIMIT EQU   LDA+1484                                                 03258000
LDARSVPT EQU   LDA+1480                                                 03259000
LDASRPQE EQU   LDA+1476                                                 03260000
CURRGNTP EQU   LDA+1472                                                 03261000
VVREGSZ  EQU   LDA+1468                                                 03262000
CFAPWKAR EQU   LDA+1164                                                 03263000
CSAVE    EQU   LDA+1100                                                 03264000
OBFRSAVE EQU   LDA+1036                                                 03265000
GFRESAVE EQU   LDA+972                                                  03266000
GMREPSAV EQU   LDA+908                                                  03267000
FBQSAVE  EQU   LDA+844                                                  03268000
G4KSAVE  EQU   LDA+780                                                  03269000
FSAVE    EQU   LDA+716                                                  03270000
BSAVE    EQU   LDA+652                                                  03271000
LDARES2  EQU   LDA+21                                                   03272000
LDACBSP  EQU   LDA+20                                                   03273000
ASDPQE   EQU   LDA+8                                                    03274000
PASCBSV  EQU   LDA+4                                                    03275000
@NM00040 EQU   LVSMFLAG+1                                               03276000
LDABRSW  EQU   LVSMFLAG                                                 03277000
LDAFPFM  EQU   LVSMFLAG                                                 03278000
LDAFLAGS EQU   LVSMFLAG                                                 03279000
LDASTART EQU   LDA                                                      03280000
GBLCELCT EQU   GDA+60                                                   03281000
PFSTCPAB EQU   GDA+48                                                   03282000
VRWLEL   EQU   VRWAITQ+4                                                03283000
VRWFEL   EQU   VRWAITQ                                                  03284000
VRPLEL   EQU   VRPOSTQ+4                                                03285000
VRPFEL   EQU   VRPOSTQ                                                  03286000
SQASPLFT EQU   GDA+28                                                   03287000
VRPQEP   EQU   GDA+12                                                   03288000
VRDREG   EQU   GDA+4                                                    03289000
RESV     EQU   GVSMFLAG+1                                               03290000
@NM00039 EQU   GDAFLAGS                                                 03291000
WAITQUE  EQU   GDAFLAGS                                                 03292000
SQATHRS2 EQU   GDAFLAGS                                                 03293000
SQATHRS1 EQU   GDAFLAGS                                                 03294000
GDAFLAG2 EQU   GDAFLAGS                                                 03295000
NIPFOURK EQU   GDAFLAGS                                                 03296000
GDAFLAG1 EQU   GDAFLAGS                                                 03297000
@NM00038 EQU   SDUMP+20                                                 03298000
@NM00037 EQU   SDUMP+16                                                 03299000
@NM00036 EQU   SDUMP+12                                                 03300000
@NM00035 EQU   SDUMP+8                                                  03301000
@NM00034 EQU   SDUMP+4                                                  03302000
@NM00033 EQU   SDUSDAT2                                                 03303000
SDUSWA   EQU   SDUSDAT2                                                 03304000
SDUCSA   EQU   SDUSDAT2                                                 03305000
SDUTRT   EQU   SDUSDAT1                                                 03306000
SDULPA   EQU   SDUSDAT1                                                 03307000
SDURGN   EQU   SDUSDAT1                                                 03308000
SDULSQA  EQU   SDUSDAT1                                                 03309000
SDUSQA   EQU   SDUSDAT1                                                 03310000
SDUNUC   EQU   SDUSDAT1                                                 03311000
SDUPSA   EQU   SDUSDAT1                                                 03312000
SDUALPSA EQU   SDUSDAT1                                                 03313000
@NM00032 EQU   SDUMP                                                    03314000
@NM00031 EQU   TCBXTNT2+32                                              03315000
TCBRV181 EQU   TCBRV173                                                 03316000
TCBRV180 EQU   TCBRV173                                                 03317000
TCBRV179 EQU   TCBRV173                                                 03318000
TCBRV178 EQU   TCBRV173                                                 03319000
TCBRV177 EQU   TCBRV173                                                 03320000
TCBRV176 EQU   TCBRV173                                                 03321000
TCBRV175 EQU   TCBRV173                                                 03322000
TCBRV174 EQU   TCBRV173                                                 03323000
TCBRV172 EQU   TCBRV164                                                 03324000
TCBRV171 EQU   TCBRV164                                                 03325000
TCBRV170 EQU   TCBRV164                                                 03326000
TCBRV169 EQU   TCBRV164                                                 03327000
TCBRV168 EQU   TCBRV164                                                 03328000
TCBRV167 EQU   TCBRV164                                                 03329000
TCBRV166 EQU   TCBRV164                                                 03330000
TCBRV165 EQU   TCBRV164                                                 03331000
TCBRV163 EQU   TCBRV155                                                 03332000
TCBRV162 EQU   TCBRV155                                                 03333000
TCBRV161 EQU   TCBRV155                                                 03334000
TCBRV160 EQU   TCBRV155                                                 03335000
TCBRV159 EQU   TCBRV155                                                 03336000
TCBRV158 EQU   TCBRV155                                                 03337000
TCBRV157 EQU   TCBRV155                                                 03338000
TCBRV156 EQU   TCBRV155                                                 03339000
TCBRV154 EQU   TCBRV146                                                 03340000
TCBRV153 EQU   TCBRV146                                                 03341000
TCBRV152 EQU   TCBRV146                                                 03342000
TCBRV151 EQU   TCBRV146                                                 03343000
TCBRV150 EQU   TCBRV146                                                 03344000
TCBRV149 EQU   TCBRV146                                                 03345000
TCBRV148 EQU   TCBRV146                                                 03346000
TCBRV147 EQU   TCBRV146                                                 03347000
TCBRV145 EQU   TCBXTNT2+26                                              03348000
TCBRV144 EQU   TCBXTNT2+24                                              03349000
TCBCAUF  EQU   TCBXTNT2+20                                              03350000
TCBRV142 EQU   TCBXTNT2+16                                              03351000
TCBRSV49 EQU   TCBXTNT2+12                                              03352000
TCBEVENT EQU   TCBXTNT2+8                                               03353000
TCBRCMP  EQU   TCBXTNT2+5                                               03354000
TCBRSVAB EQU   TCBXTNT2+4                                               03355000
TCBGTFA  EQU   TCBGTF+1                                                 03356000
TCBRSV47 EQU   TCBTFLG                                                  03357000
TCBRSV46 EQU   TCBTFLG                                                  03358000
TCBRSV45 EQU   TCBTFLG                                                  03359000
TCBRSV44 EQU   TCBTFLG                                                  03360000
TCBRSV43 EQU   TCBTFLG                                                  03361000
TCBDSPIT EQU   TCBTFLG                                                  03362000
TCBERRTN EQU   TCBTFLG                                                  03363000
TCBASYNC EQU   TCBTFLG                                                  03364000
@NM00030 EQU   TCB+296                                                  03365000
TCBSVCA2 EQU   TCB+292                                                  03366000
TCBSWASA EQU   TCB+288                                                  03367000
TCBDBTB  EQU   TCB+284                                                  03368000
TCBRPT   EQU   TCB+280                                                  03369000
TCBRV141 EQU   TCBRV133                                                 03370000
TCBRV140 EQU   TCBRV133                                                 03371000
TCBRV139 EQU   TCBRV133                                                 03372000
TCBRV138 EQU   TCBRV133                                                 03373000
TCBRV137 EQU   TCBRV133                                                 03374000
TCBRV136 EQU   TCBRV133                                                 03375000
TCBRV135 EQU   TCBRV133                                                 03376000
TCBRV134 EQU   TCBRV133                                                 03377000
TCBRV132 EQU   TCBRV124                                                 03378000
TCBRV131 EQU   TCBRV124                                                 03379000
TCBRV130 EQU   TCBRV124                                                 03380000
TCBRV129 EQU   TCBRV124                                                 03381000
TCBRV128 EQU   TCBRV124                                                 03382000
TCBRV127 EQU   TCBRV124                                                 03383000
TCBRV126 EQU   TCBRV124                                                 03384000
TCBRV125 EQU   TCBRV124                                                 03385000
TCBRV123 EQU   TCBFBYT2                                                 03386000
TCBRV122 EQU   TCBFBYT2                                                 03387000
TCBECBNV EQU   TCBFBYT2                                                 03388000
TCBSSSYN EQU   TCBFBYT2                                                 03389000
TCBFPRAP EQU   TCBFBYT2                                                 03390000
TCBFDW   EQU   TCBFBYT2                                                 03391000
TCBFMW   EQU   TCBFBYT2                                                 03392000
TCBCNCB  EQU   TCBFBYT2                                                 03393000
TCBLLH   EQU   TCBFBYT1                                                 03394000
TCBRV113 EQU   TCBFBYT1                                                 03395000
TCBEOT   EQU   TCBFBYT1                                                 03396000
TCBRTM2  EQU   TCBFBYT1                                                 03397000
TCBPGNLY EQU   TCBFBYT1                                                 03398000
TCBNDIOS EQU   TCBFBYT1                                                 03399000
TCBRV327 EQU   TCBFBYT1                                                 03400000
TCBEOTFM EQU   TCBFBYT1                                                 03401000
TCBAFFN  EQU   TCB+274                                                  03402000
TCBRV326 EQU   TCB+272                                                  03403000
TCBMODE  EQU   TCBESTAE+3                                               03404000
TCBERTYP EQU   TCBESTAE+2                                               03405000
TCBRV314 EQU   TCBESTRM                                                 03406000
TCBRV313 EQU   TCBESTRM                                                 03407000
TCBRV312 EQU   TCBESTRM                                                 03408000
TCBRV311 EQU   TCBESTRM                                                 03409000
TCBRV310 EQU   TCBESTRM                                                 03410000
TCBRV309 EQU   TCBESTRM                                                 03411000
TCBSTAFX EQU   TCBESTRM                                                 03412000
TCBETERM EQU   TCBESTRM                                                 03413000
TCBSCBKY EQU   TCBESTAE                                                 03414000
TCBRTM12 EQU   TCB+260                                                  03415000
TCBSTAWA EQU   TCB+252                                                  03416000
TCBFOEA  EQU   TCBFOE+1                                                 03417000
TCBRSV42 EQU   TCBFOE                                                   03418000
TCBCCPVI EQU   TCBXSCT+2                                                03419000
TCBRV325 EQU   TCBXSCT+1                                                03420000
TCBRV324 EQU   TCBXSCT1                                                 03421000
TCBRV323 EQU   TCBXSCT1                                                 03422000
TCBRV322 EQU   TCBXSCT1                                                 03423000
TCBRV321 EQU   TCBXSCT1                                                 03424000
TCBRV320 EQU   TCBXSCT1                                                 03425000
TCBRV319 EQU   TCBXSCT1                                                 03426000
TCBS3A   EQU   TCBXSCT1                                                 03427000
TCBACTIV EQU   TCBXSCT1                                                 03428000
TCBRSV41 EQU   TCB+239                                                  03429000
TCBTID   EQU   TCB+238                                                  03430000
TCBRSVAA EQU   TCB+237                                                  03431000
TCBABCUR EQU   TCB+236                                                  03432000
TCBTMSAV EQU   TCB+232                                                  03433000
TCBIOTIM EQU   TCB+228                                                  03434000
TCBRTWA  EQU   TCB+224                                                  03435000
TCBBACK  EQU   TCB+220                                                  03436000
TCBTIRB  EQU   TCB+216                                                  03437000
TCBAECB  EQU   TCB+212                                                  03438000
TCBEXT2A EQU   TCBEXT2+1                                                03439000
TCBRSV39 EQU   TCBEXT2                                                  03440000
TCBSTMCT EQU   TCB+207                                                  03441000
TCBSYSCT EQU   TCB+206                                                  03442000
TCBRSV37 EQU   TCB+205                                                  03443000
TCBEXSVC EQU   TCBDAR                                                   03444000
TCBDARMS EQU   TCBDAR                                                   03445000
TCBDARWT EQU   TCBDAR                                                   03446000
TCBDARO  EQU   TCBDAR                                                   03447000
TCBDARMC EQU   TCBDARC                                                  03448000
TCBDARD  EQU   TCBDAR                                                   03449000
TCBDARS  EQU   TCBDAR                                                   03450000
TCBDARP  EQU   TCBDAR                                                   03451000
TCBGTOFM EQU   TCBFLGS7                                                 03452000
TCBADMP  EQU   TCBFLGS7                                                 03453000
TCBRSTSK EQU   TCBFLGS7                                                 03454000
TCBSVCS  EQU   TCBFLGS7                                                 03455000
TCBSTACK EQU   TCBFLGS7                                                 03456000
TCBRSV34 EQU   TCBFLGS7                                                 03457000
TCBRSV33 EQU   TCBFLGS7                                                 03458000
TCBGPECB EQU   TCBFLGS7                                                 03459000
TCBNTJS  EQU   TCBFLGS6                                                 03460000
TCBAPG   EQU   TCBFLGS6                                                 03461000
TCBMIGR  EQU   TCBFLGS6                                                 03462000
TCBRV303 EQU   TCBFLGS6                                                 03463000
TCBSPVLK EQU   TCBFLGS6                                                 03464000
TCBCPU   EQU   TCBFLGS6                                                 03465000
TCBPIE17 EQU   TCBFLGS6                                                 03466000
TCBRV    EQU   TCBFLGS6                                                 03467000
TCBRSV79 EQU   TCBNDSP5                                                 03468000
TCBRSV78 EQU   TCBNDSP5                                                 03469000
TCBRSV77 EQU   TCBNDSP5                                                 03470000
TCBRSV76 EQU   TCBNDSP5                                                 03471000
TCBRSV75 EQU   TCBNDSP5                                                 03472000
TCBRSV74 EQU   TCBNDSP5                                                 03473000
TCBRSV95 EQU   TCBNDSP5                                                 03474000
TCBRSV94 EQU   TCBNDSP5                                                 03475000
TCBRSV93 EQU   TCBNDSP4                                                 03476000
TCBRSV92 EQU   TCBNDSP4                                                 03477000
TCBRSV91 EQU   TCBNDSP4                                                 03478000
TCBRSV90 EQU   TCBNDSP4                                                 03479000
TCBRSV89 EQU   TCBNDSP4                                                 03480000
TCBRSV88 EQU   TCBNDSP4                                                 03481000
TCBRSV87 EQU   TCBNDSP4                                                 03482000
TCBRSV86 EQU   TCBNDSP4                                                 03483000
TCBEXT1A EQU   TCBEXT1+1                                                03484000
TCBRSV32 EQU   TCBEXT1                                                  03485000
TCBEXCPD EQU   TCB+192                                                  03486000
TCBIOBRC EQU   TCB+188                                                  03487000
TCBDDWTC EQU   TCB+186                                                  03488000
TCBDDEXC EQU   TCB+184                                                  03489000
TCBJSCBB EQU   TCBJSCB+1                                                03490000
@NM00029 EQU   TCBRECDE                                                 03491000
TCBREC   EQU   TCBRECDE                                                 03492000
TCBMDIDS EQU   TCB+176                                                  03493000
TCBNDINT EQU   TCBNDSP3                                                 03494000
TCBRSV27 EQU   TCBNDSP3                                                 03495000
TCBRSV26 EQU   TCBNDSP3                                                 03496000
TCBRSV25 EQU   TCBNDSP3                                                 03497000
TCBRSV24 EQU   TCBNDSP3                                                 03498000
TCBSRBND EQU   TCBNDSP3                                                 03499000
TCBRV302 EQU   TCBNDSP3                                                 03500000
TCBLJSND EQU   TCBNDSP3                                                 03501000
TCBABE   EQU   TCBNDSP2                                                 03502000
TCBDSS   EQU   TCBNDSP2                                                 03503000
TCBOWAIT EQU   TCBNDSP2                                                 03504000
TCBIWAIT EQU   TCBNDSP2                                                 03505000
TCBNDTS  EQU   TCBNDSP2                                                 03506000
TCBNDSVC EQU   TCBNDSP2                                                 03507000
TCBSTPP  EQU   TCBNDSP2                                                 03508000
TCBABD   EQU   TCBNDSP2                                                 03509000
TCBRSV22 EQU   TCBNDSP1                                                 03510000
TCBPIEND EQU   TCBNDSP1                                                 03511000
TCBTPSP  EQU   TCBNDSP1                                                 03512000
TCBDDRND EQU   TCBNDSP1                                                 03513000
TCBRSPND EQU   TCBNDSP1                                                 03514000
TCBRSTND EQU   TCBNDSP1                                                 03515000
TCBDARPN EQU   TCBNDSP1                                                 03516000
TCBDARTN EQU   TCBNDSP1                                                 03517000
TCBNDSP0 EQU   TCBNDSP                                                  03518000
TCBUSER  EQU   TCB+168                                                  03519000
TCBTCTB  EQU   TCBTCT+1                                                 03520000
TCBRSV9C EQU   TCBTCTGF                                                 03521000
TCBRSV9B EQU   TCBTCTGF                                                 03522000
TCBRSV9A EQU   TCBTCTGF                                                 03523000
TCBRSV99 EQU   TCBTCTGF                                                 03524000
TCBRSV98 EQU   TCBTCTGF                                                 03525000
TCBRSV97 EQU   TCBTCTGF                                                 03526000
TCBRSV20 EQU   TCBTCTGF                                                 03527000
TCBSMFGF EQU   TCBTCTGF                                                 03528000
TCBSTABB EQU   TCBSTAB+1                                                03529000
TCBSTCUR EQU   TCBNSTAE                                                 03530000
TCBRV301 EQU   TCBNSTAE                                                 03531000
TCBSYNCH EQU   TCBNSTAE                                                 03532000
TCBHALT  EQU   TCBNSTAE                                                 03533000
TCBPPSUP EQU   TCBNSTAE                                                 03534000
TCB33E   EQU   TCBNSTAE                                                 03535000
TCBQUIES EQU   TCBNSTAE                                                 03536000
TCBSTABE EQU   TCBNSTAE                                                 03537000
TCBAQE   EQU   TCB+156                                                  03538000
TCBPQE   EQU   TCB+152                                                  03539000
TCBTSDP  EQU   TCB+151                                                  03540000
TCBTSLP  EQU   TCB+150                                                  03541000
TCBSTPCT EQU   TCB+149                                                  03542000
TCBCPUBN EQU   TCBTSFLG                                                 03543000
TCBDYDSP EQU   TCBTSFLG                                                 03544000
TCBRSV18 EQU   TCBTSFLG                                                 03545000
TCBRSV17 EQU   TCBTSFLG                                                 03546000
TCBTIOTG EQU   TCBTSFLG                                                 03547000
TCBATT   EQU   TCBTSFLG                                                 03548000
TCBSTPPR EQU   TCBTSFLG                                                 03549000
TCBRV300 EQU   TCBTSTSK                                                 03550000
TCBECB   EQU   TCB+144                                                  03551000
TCBIQE   EQU   TCB+140                                                  03552000
TCBLTC   EQU   TCB+136                                                  03553000
TCBOTC   EQU   TCB+132                                                  03554000
TCBNTC   EQU   TCB+128                                                  03555000
TCBJSTCA EQU   TCBJSTCB+1                                               03556000
TCBRSV16 EQU   TCBJSTCB                                                 03557000
TCBTQET  EQU   TCBTME                                                   03558000
TCBTCB   EQU   TCB+116                                                  03559000
TCBFSAB  EQU   TCBFSA+1                                                 03560000
TCBQEL   EQU   TCBFSA                                                   03561000
TCBGRS15 EQU   TCBGRS+60                                                03562000
TCBGRS14 EQU   TCBGRS+56                                                03563000
TCBGRS13 EQU   TCBGRS+52                                                03564000
TCBGRS12 EQU   TCBGRS+48                                                03565000
TCBGRS11 EQU   TCBGRS+44                                                03566000
TCBGRS10 EQU   TCBGRS+40                                                03567000
TCBGRS9  EQU   TCBGRS+36                                                03568000
TCBGRS8  EQU   TCBGRS+32                                                03569000
TCBGRS7  EQU   TCBGRS+28                                                03570000
TCBGRS6  EQU   TCBGRS+24                                                03571000
TCBGRS5  EQU   TCBGRS+20                                                03572000
TCBGRS4  EQU   TCBGRS+16                                                03573000
TCBGRS3  EQU   TCBGRS+12                                                03574000
TCBGRS2  EQU   TCBGRS+8                                                 03575000
TCBGRS1  EQU   TCBGRS+4                                                 03576000
TCBGRS0  EQU   TCBGRS                                                   03577000
TCBJPQB  EQU   TCBJPQ+1                                                 03578000
TCBRSV15 EQU   TCBPURGE                                                 03579000
TCBRSV14 EQU   TCBPURGE                                                 03580000
TCBRSV13 EQU   TCBPURGE                                                 03581000
TCBRSV12 EQU   TCBPURGE                                                 03582000
TCBRSV11 EQU   TCBPURGE                                                 03583000
TCBRSV10 EQU   TCBPURGE                                                 03584000
TCBRSV09 EQU   TCBPURGE                                                 03585000
TCBJPQF  EQU   TCBPURGE                                                 03586000
TCBJLB   EQU   TCB+40                                                   03587000
TCBLLS   EQU   TCB+36                                                   03588000
TCBDSP   EQU   TCB+35                                                   03589000
TCBLMP   EQU   TCB+34                                                   03590000
TCBPNDSP EQU   TCBFLGS5                                                 03591000
TCBFCD1  EQU   TCBFLGS5                                                 03592000
TCBSTP   EQU   TCBFLGS5                                                 03593000
TCBSYS   EQU   TCBFLGS5                                                 03594000
TCBANDSP EQU   TCBFLGS5                                                 03595000
TCBPAGE  EQU   TCBFLGS5                                                 03596000
TCBUXNDF EQU   TCBABWF                                                  03597000
TCBFC    EQU   TCBFLGS5                                                 03598000
TCBONDSP EQU   TCBFLGS4                                                 03599000
TCBMPCND EQU   TCBFLGS4                                                 03600000
TCBMPCVQ EQU   TCBFLGS4                                                 03601000
TCBUXNDV EQU   TCBFLGS4                                                 03602000
TCBHNDSP EQU   TCBFLGS4                                                 03603000
TCBRQENA EQU   TCBFLGS4                                                 03604000
TCBSER   EQU   TCBFLGS4                                                 03605000
TCBNDUMP EQU   TCBFLGS4                                                 03606000
TCBDWSTA EQU   TCBFLGS3                                                 03607000
TCBRSV08 EQU   TCBFLGS3                                                 03608000
TCBRSV07 EQU   TCBFLGS3                                                 03609000
TCBRSV06 EQU   TCBFLGS3                                                 03610000
TCBABGM  EQU   TCBFLGS3                                                 03611000
TCBABTRM EQU   TCBFLGS3                                                 03612000
TCBADINP EQU   TCBFLGS3                                                 03613000
TCBFSM   EQU   TCBFLGS3                                                 03614000
TCBFTS   EQU   TCBFLGS2                                                 03615000
TCBFETXR EQU   TCBFLGS2                                                 03616000
TCBFDSOP EQU   TCBFLGS2                                                 03617000
TCBFJMC  EQU   TCBFLGS2                                                 03618000
TCBFSMC  EQU   TCBFLGS2                                                 03619000
TCBFABOP EQU   TCBFLGS2                                                 03620000
TCBFSTI  EQU   TCBFLGS2                                                 03621000
TCBFOINP EQU   TCBFLGS2                                                 03622000
TCBFX    EQU   TCBFLGS1                                                 03623000
TCBFS    EQU   TCBFLGS1                                                 03624000
TCBFT    EQU   TCBFLGS1                                                 03625000
TCBPDUMP EQU   TCBFLGS1                                                 03626000
TCBNONPR EQU   TCBFLGS1                                                 03627000
TCBFERA  EQU   TCBFLGS1                                                 03628000
TCBFE    EQU   TCBFLGS1                                                 03629000
TCBFA    EQU   TCBFLGS1                                                 03630000
TCBZERO  EQU   TCBPKF                                                   03631000
TCBFLAG  EQU   TCBPKF                                                   03632000
TCBMSSB  EQU   TCBMSS+1                                                 03633000
TCBRSV03 EQU   TCBMSS                                                   03634000
TCBTRNB  EQU   TCBTRN+1                                                 03635000
TCBRSV02 EQU   TCBABF                                                   03636000
TCBOLTEP EQU   TCBABF                                                   03637000
TCBTCP   EQU   TCBABF                                                   03638000
TCBTCPP  EQU   TCBABF                                                   03639000
TCBRSV01 EQU   TCBABF                                                   03640000
TCBGRPH  EQU   TCBABF                                                   03641000
TCBNOCHK EQU   TCBABF                                                   03642000
TCBMOD91 EQU   TCBABF                                                   03643000
TCBCMPC  EQU   TCBCMP+1                                                 03644000
TCBRV318 EQU   TCBCMSG                                                  03645000
TCBRV317 EQU   TCBCIND                                                  03646000
TCBRV316 EQU   TCBCWTO                                                  03647000
TCBCASID EQU   TCBCDBL                                                  03648000
TCBNOCC  EQU   TCBSTCC                                                  03649000
TCBDMPO  EQU   TCBCPP                                                   03650000
TCBCSTEP EQU   TCBCMPF                                                  03651000
TCBCREQ  EQU   TCBCMPF                                                  03652000
TCBTIO   EQU   TCB+12                                                   03653000
TCBDEB   EQU   TCB+8                                                    03654000
TCBPIEA  EQU   TCBPIE+1                                                 03655000
TCBPM    EQU   TCBPMASK                                                 03656000
@NM00028 EQU   TCBPMASK                                                 03657000
TCBRBP   EQU   TCB                                                      03658000
TCBFRS6  EQU   TCBFRS+24                                                03659000
TCBFRS4  EQU   TCBFRS+16                                                03660000
TCBFRS2  EQU   TCBFRS+8                                                 03661000
TCBFRS0  EQU   TCBFRS                                                   03662000
ASCBEND  EQU   ASCB+208                                                 03663000
ASCBSRBT EQU   ASCB+200                                                 03664000
ASCBSWTL EQU   ASCB+196                                                 03665000
ASCBRS14 EQU   ASCB+195                                                 03666000
ASCBSMCT EQU   ASCB+194                                                 03667000
ASCBRS12 EQU   ASCB+192                                                 03668000
ASCBPCTT EQU   ASCB+188                                                 03669000
ASCBVGTT EQU   ASCB+184                                                 03670000
ASCBRV43 EQU   ASCBSRQ4                                                 03671000
ASCBRV42 EQU   ASCBSRQ4                                                 03672000
ASCBRV41 EQU   ASCBSRQ4                                                 03673000
ASCBRV40 EQU   ASCBSRQ4                                                 03674000
ASCBRV39 EQU   ASCBSRQ4                                                 03675000
ASCBRV38 EQU   ASCBSRQ4                                                 03676000
ASCBRV37 EQU   ASCBSRQ4                                                 03677000
ASCBRV36 EQU   ASCBSRQ4                                                 03678000
ASCBRV35 EQU   ASCBSRQ3                                                 03679000
ASCBRV34 EQU   ASCBSRQ3                                                 03680000
ASCBRV33 EQU   ASCBSRQ3                                                 03681000
ASCBRV32 EQU   ASCBSRQ3                                                 03682000
ASCBRV31 EQU   ASCBSRQ3                                                 03683000
ASCBRV30 EQU   ASCBSRQ3                                                 03684000
ASCBRV29 EQU   ASCBSRQ3                                                 03685000
ASCBRV28 EQU   ASCBSRQ3                                                 03686000
ASCBRV27 EQU   ASCBSRQ2                                                 03687000
ASCBRV26 EQU   ASCBSRQ2                                                 03688000
ASCBRV25 EQU   ASCBSRQ2                                                 03689000
ASCBRV24 EQU   ASCBSRQ2                                                 03690000
ASCBRV23 EQU   ASCBSRQ2                                                 03691000
ASCBRV22 EQU   ASCBSRQ2                                                 03692000
ASCBRV21 EQU   ASCBSRQ2                                                 03693000
ASCBRV20 EQU   ASCBSRQ2                                                 03694000
ASCBRV19 EQU   ASCBSRQ1                                                 03695000
ASCBRV18 EQU   ASCBSRQ1                                                 03696000
ASCBRV17 EQU   ASCBSRQ1                                                 03697000
ASCBRV16 EQU   ASCBSRQ1                                                 03698000
ASCBRV15 EQU   ASCBSRQ1                                                 03699000
ASCBRV14 EQU   ASCBSRQ1                                                 03700000
ASCBRV13 EQU   ASCBSRQ1                                                 03701000
ASCBSTA  EQU   ASCBSRQ1                                                 03702000
ASCBJBNS EQU   ASCB+176                                                 03703000
ASCBJBNI EQU   ASCB+172                                                 03704000
ASCBMCC  EQU   ASCB+168                                                 03705000
ASCBRTWA EQU   ASCB+164                                                 03706000
ASCBIQEA EQU   ASCB+160                                                 03707000
ASCBXMPQ EQU   ASCB+156                                                 03708000
ASCBRS01 EQU   ASCB+154                                                 03709000
ASCBFMCT EQU   ASCB+152                                                 03710000
ASCBOUXB EQU   ASCB+148                                                 03711000
ASCBOUCB EQU   ASCB+144                                                 03712000
ASCBMECB EQU   ASCB+140                                                 03713000
ASCBQECB EQU   ASCB+136                                                 03714000
ASCBLSQH EQU   ASCBLKGP+4                                               03715000
ASCBLOCK EQU   ASCBLKGP                                                 03716000
ASCBTCBS EQU   ASCB+124                                                 03717000
ASCBNVSC EQU   ASCB+122                                                 03718000
ASCBVSC  EQU   ASCB+120                                                 03719000
ASCBSRBS EQU   ASCB+118                                                 03720000
ASCBSSRB EQU   ASCB+116                                                 03721000
ASCBRV06 EQU   ASCBFLG2                                                 03722000
ASCBRV05 EQU   ASCBFLG2                                                 03723000
ASCBRV04 EQU   ASCBFLG2                                                 03724000
ASCBSNQS EQU   ASCBFLG2                                                 03725000
ASCBS2S  EQU   ASCBFLG2                                                 03726000
ASCBCEXT EQU   ASCBFLG2                                                 03727000
ASCBPXMT EQU   ASCBFLG2                                                 03728000
ASCBXMPT EQU   ASCBFLG2                                                 03729000
ASCBRF07 EQU   ASCBDSP1                                                 03730000
ASCBRF06 EQU   ASCBDSP1                                                 03731000
ASCBRF05 EQU   ASCBDSP1                                                 03732000
ASCBRF04 EQU   ASCBDSP1                                                 03733000
ASCBRF03 EQU   ASCBDSP1                                                 03734000
ASCBRF02 EQU   ASCBDSP1                                                 03735000
ASCBFAIL EQU   ASCBDSP1                                                 03736000
ASCBNOQ  EQU   ASCBDSP1                                                 03737000
ASCBSWCT EQU   ASCB+112                                                 03738000
ASCBASXB EQU   ASCB+108                                                 03739000
ASCBTMCH EQU   ASCB+104                                                 03740000
ASCBNSWP EQU   ASCBFLG1                                                 03741000
ASCBTYP1 EQU   ASCBFLG1                                                 03742000
ASCBSTND EQU   ASCBFLG1                                                 03743000
ASCBABNT EQU   ASCBFLG1                                                 03744000
ASCBTERM EQU   ASCBFLG1                                                 03745000
ASCBS3S  EQU   ASCBFLG1                                                 03746000
ASCBCMSH EQU   ASCBFLG1                                                 03747000
ASCBTOFF EQU   ASCBFLG1                                                 03748000
ASCBRF01 EQU   ASCBRCTF                                                 03749000
ASCBTMLW EQU   ASCBRCTF                                                 03750000
ASCBOUT  EQU   ASCBRCTF                                                 03751000
ASCBWAIT EQU   ASCBRCTF                                                 03752000
ASCBRV08 EQU   ASCBRCTF                                                 03753000
ASCBFQU  EQU   ASCBRCTF                                                 03754000
ASCBFRS  EQU   ASCBRCTF                                                 03755000
ASCBTMNO EQU   ASCBRCTF                                                 03756000
ASCBAFFN EQU   ASCBFW1                                                  03757000
ASCBDUMP EQU   ASCB+96                                                  03758000
ASCBRV44 EQU   ASCB+92                                                  03759000
ASCBUBET EQU   ASCB+88                                                  03760000
ASCBECB  EQU   ASCB+84                                                  03761000
ASCBJSTL EQU   ASCB+80                                                  03762000
ASCBEWST EQU   ASCB+72                                                  03763000
ASCBEJST EQU   ASCB+64                                                  03764000
ASCBTSB  EQU   ASCB+60                                                  03765000
ASCBCSCB EQU   ASCB+56                                                  03766000
ASCBRSMA EQU   ASCBRSM+1                                                03767000
ASCBRV54 EQU   ASCBRSMF                                                 03768000
ASCBRV53 EQU   ASCBRSMF                                                 03769000
ASCBRV52 EQU   ASCBRSMF                                                 03770000
ASCBRV51 EQU   ASCBRSMF                                                 03771000
ASCBVEQR EQU   ASCBRSMF                                                 03772000
ASCBN2LP EQU   ASCBRSMF                                                 03773000
ASCB1LPU EQU   ASCBRSMF                                                 03774000
ASCB2LPU EQU   ASCBRSMF                                                 03775000
ASCBLDA  EQU   ASCB+48                                                  03776000
ASCBSTOR EQU   ASCB+44                                                  03777000
ASCBDP   EQU   ASCB+43                                                  03778000
ASCBRV07 EQU   ASCB+42                                                  03779000
ASCBIOSM EQU   ASCB+40                                                  03780000
ASCBSEQN EQU   ASCB+38                                                  03781000
ASCBCPUS EQU   ASCB+32                                                  03782000
ASCBSPL  EQU   ASCB+28                                                  03783000
ASCBIOSP EQU   ASCB+24                                                  03784000
ASCBSYNC EQU   ASCBSUPC+4                                               03785000
ASCBSVRB EQU   ASCBSUPC                                                 03786000
ASCBCMSF EQU   ASCB+12                                                  03787000
ASCBBWDP EQU   ASCB+8                                                   03788000
ASCBFWDP EQU   ASCB+4                                                   03789000
ASCBASCB EQU   ASCB                                                     03790000
ASCBEGIN EQU   ASCB                                                     03791000
PVTEND   EQU   PVT+1848                                                 03792000
PVTTASID EQU   PVT+1846                                                 03793000
PVTXXXXX EQU   PVT+1844                                                 03794000
PVTMVCLC EQU   PVT+1840                                                 03795000
PVTSPARE EQU   PVT+1838                                                 03796000
PVTCHUIC EQU   PVT+1836                                                 03797000
PVTCOMFX EQU   PVT+1834                                                 03798000
PVTSQAFX EQU   PVT+1832                                                 03799000
PVTCNTFX EQU   PVT+1830                                                 03800000
PVTDEFFX EQU   PVT+1828                                                 03801000
PVTFIXOK EQU   PVT+1826                                                 03802000
PVTPEROK EQU   PVT+1824                                                 03803000
PVTMAXFX EQU   PVT+1822                                                 03804000
PVTPERFX EQU   PVT+1820                                                 03805000
PVTRSRB  EQU   PVT+1776                                                 03806000
PVTRESV5 EQU   PVT+1773                                                 03807000
PVTSRBS  EQU   PVT+1772                                                 03808000
PVTSSRB  EQU   PVT+1768                                                 03809000
PVTACA   EQU   PVTWSAX+1400                                             03810000
PVTSAVE  EQU   PVTWSAX+1328                                             03811000
PVTWSA18 EQU   PVTWSAX+1256                                             03812000
PVTWSA17 EQU   PVTWSAX+1184                                             03813000
PVTWSA16 EQU   PVTWSAX+1112                                             03814000
PVTWSA15 EQU   PVTWSAX+1040                                             03815000
PVTWSA14 EQU   PVTWSAX+968                                              03816000
PVTWSA13 EQU   PVTWSAX+896                                              03817000
PVTWSA12 EQU   PVTWSAX+824                                              03818000
PVTWSA11 EQU   PVTWSAX+752                                              03819000
PVTWSA10 EQU   PVTWSAX+672                                              03820000
PVTWSA9  EQU   PVTWSAX+592                                              03821000
PVTWSA8  EQU   PVTWSAX+504                                              03822000
PVTWSA7  EQU   PVTWSAX+432                                              03823000
PVTWSA6  EQU   PVTWSAX+360                                              03824000
PVTWSA5  EQU   PVTWSAX+288                                              03825000
PVTWSA4  EQU   PVTWSAX+216                                              03826000
PVTWSA3  EQU   PVTWSAX+144                                              03827000
PVTWSA2  EQU   PVTWSAX+72                                               03828000
PVTWSA1  EQU   PVTWSAX                                                  03829000
PVTCIOQL EQU   PVTQS+36                                                 03830000
PVTCIOQF EQU   PVTQS+32                                                 03831000
PVTGFADL EQU   PVTQS+28                                                 03832000
PVTGFADF EQU   PVTQS+24                                                 03833000
PVTFPCBL EQU   PVTQS+20                                                 03834000
PVTFPCBF EQU   PVTQS+16                                                 03835000
PVTSQAQL EQU   PVTQS+14                                                 03836000
PVTSQAQF EQU   PVTQS+12                                                 03837000
PVTCFQL  EQU   PVTQS+10                                                 03838000
PVTCFQF  EQU   PVTQS+8                                                  03839000
PVTRSRVL EQU   PVTQS+6                                                  03840000
PVTRSRVF EQU   PVTQS+4                                                  03841000
PVTAFQL  EQU   PVTQS+2                                                  03842000
PVTAFQF  EQU   PVTQS                                                    03843000
PVTSPFR  EQU   PVT+302                                                  03844000
PVTCFMCT EQU   PVT+300                                                  03845000
PVTSPREC EQU   PVT+296                                                  03846000
PVTCAREC EQU   PVT+292                                                  03847000
PVTCAOUT EQU   PVT+288                                                  03848000
PVTCAIN  EQU   PVT+284                                                  03849000
PVTNSWPS EQU   PVT+280                                                  03850000
PVTNPREC EQU   PVT+276                                                  03851000
PVTSPOUT EQU   PVT+272                                                  03852000
PVTSPIN  EQU   PVT+268                                                  03853000
PVTVAMR  EQU   PVT+264                                                  03854000
PVTVAMO  EQU   PVT+260                                                  03855000
PVTVAMI  EQU   PVT+256                                                  03856000
PVTNPOUT EQU   PVT+252                                                  03857000
PVTNPIN  EQU   PVT+248                                                  03858000
PVTPRSET EQU   PVT+244                                                  03859000
PVTFRSLT EQU   PVT+240                                                  03860000
PVTPAGIO EQU   PVT+236                                                  03861000
PVTSWPIO EQU   PVT+232                                                  03862000
PVTPSWPP EQU   PVT+228                                                  03863000
PVTPPREF EQU   PVT+224                                                  03864000
PVTPOPBR EQU   PVT+220                                                  03865000
PVTPRELF EQU   PVT+216                                                  03866000
PVTPRELV EQU   PVT+212                                                  03867000
PVTPFREE EQU   PVT+208                                                  03868000
PVTPRELS EQU   PVT+204                                                  03869000
PVTPOUT  EQU   PVT+200                                                  03870000
PVTPFXLD EQU   PVT+196                                                  03871000
PVTPITAS EQU   PVT+192                                                  03872000
PVTPSRBP EQU   PVT+188                                                  03873000
PVTPDSEG EQU   PVT+184                                                  03874000
PVTPCSGB EQU   PVT+180                                                  03875000
PVTPCSEG EQU   PVT+176                                                  03876000
PVTPINV  EQU   PVT+172                                                  03877000
PVTPSWPC EQU   PVT+168                                                  03878000
PVTPSOUT EQU   PVT+164                                                  03879000
PVTPSWIN EQU   PVT+160                                                  03880000
PVTPRCV  EQU   PVT+156                                                  03881000
PVTPRCFI EQU   PVT+152                                                  03882000
PVTPRCF  EQU   PVT+148                                                  03883000
PVTPVRC  EQU   PVT+144                                                  03884000
PVTPVRIN EQU   PVT+140                                                  03885000
PVTPVRLS EQU   PVT+136                                                  03886000
PVTPVEQR EQU   PVT+132                                                  03887000
PVTPPIOI EQU   PVT+128                                                  03888000
PVTPVRPO EQU   PVT+124                                                  03889000
PVTPRFR  EQU   PVT+120                                                  03890000
PVTPFP2  EQU   PVT+116                                                  03891000
PVTPFP   EQU   PVT+112                                                  03892000
PVTPFTE  EQU   PVT+108                                                  03893000
PVTPCB   EQU   PVT+104                                                  03894000
PVTREP2  EQU   PVT+100                                                  03895000
PVTPIOCP EQU   PVT+96                                                   03896000
PVTPIOP  EQU   PVT+92                                                   03897000
PVTPGFAD EQU   PVT+88                                                   03898000
PVTPGFA  EQU   PVT+84                                                   03899000
PVTPSQA  EQU   PVT+80                                                   03900000
PVTPSINT EQU   PVT+76                                                   03901000
PVTPSIB  EQU   PVT+72                                                   03902000
PVTSRBID EQU   PVT+68                                                   03903000
PVTPCIWA EQU   PVT+64                                                   03904000
PVTLQSA  EQU   PVT+60                                                   03905000
PVTOROOT EQU   PVT+56                                                   03906000
PVTPRCA  EQU   PVT+52                                                   03907000
PVTREUS  EQU   PVT+48                                                   03908000
PVTSQNPC EQU   PVT+47                                                   03909000
PVTSQVRC EQU   PVT+46                                                   03910000
PVTRSUS  EQU   PVT+44                                                   03911000
PVTVROOT EQU   PVT+40                                                   03912000
PVTPCBLO EQU   PVT+38                                                   03913000
PVTPCBCT EQU   PVT+36                                                   03914000
PVTDFRS  EQU   PVT+34                                                   03915000
PVTRSQA  EQU   PVT+32                                                   03916000
PVTPTLB  EQU   PVT+31                                                   03917000
PVTPCBNO EQU   PVT+30                                                   03918000
PVTSRBNO EQU   PVT+29                                                   03919000
PVTSQDC  EQU   PVT+28                                                   03920000
PVTLVR   EQU   PVT+22                                                   03921000
PVTFVR   EQU   PVT+20                                                   03922000
PVTLPFN  EQU   PVT+18                                                   03923000
PVTFPFN  EQU   PVT+16                                                   03924000
PVTPFTP  EQU   PVT+12                                                   03925000
PVTSSPIN EQU   PVT+11                                                   03926000
PVTPCBS  EQU   PVT+10                                                   03927000
PVTPOOL  EQU   PVT+8                                                    03928000
PVTAFCOK EQU   PVT+6                                                    03929000
PVTAFCLO EQU   PVT+4                                                    03930000
PVTAFC   EQU   PVT+2                                                    03931000
@NM00027 EQU   PVTFLAG2                                                 03932000
PVTRSMGM EQU   PVTFLAG2                                                 03933000
PVTDUMP  EQU   PVTFLAG1                                                 03934000
PVTSIT   EQU   PVTFLAG1                                                 03935000
PVTLSI   EQU   PVTFLAG1                                                 03936000
PVTAPREF EQU   PVTFLAG1                                                 03937000
PVTPCBLT EQU   PVTFLAG1                                                 03938000
PVTSRBIU EQU   PVTFLAG1                                                 03939000
PVTBGMS  EQU   PVTFLAG1                                                 03940000
PVTPMSG  EQU   PVTFLAG1                                                 03941000
CVTLEVL  EQU   CVTRELNO+2                                               03942000
CVTNUMB  EQU   CVTRELNO                                                 03943000
CVTMDL   EQU   CVTFIX+250                                               03944000
@NM00026 EQU   CVTFIX+248                                               03945000
@NM00025 EQU   CVTFIX                                                   03946000
CVTRV482 EQU   CVTXTNT2+128                                             03947000
CVTRV481 EQU   CVTXTNT2+124                                             03948000
CVTRV480 EQU   CVTXTNT2+120                                             03949000
CVTRV479 EQU   CVTXTNT2+118                                             03950000
CVTRV478 EQU   CVTXTNT2+117                                             03951000
CVTRV477 EQU   CVTXTNT2+116                                             03952000
CVTRV476 EQU   CVTXTNT2+115                                             03953000
CVTRV475 EQU   CVTXTNT2+114                                             03954000
CVTRV474 EQU   CVTRV466                                                 03955000
CVTRV473 EQU   CVTRV466                                                 03956000
CVTRV472 EQU   CVTRV466                                                 03957000
CVTRV471 EQU   CVTRV466                                                 03958000
CVTRV470 EQU   CVTRV466                                                 03959000
CVTRV469 EQU   CVTRV466                                                 03960000
CVTRV468 EQU   CVTRV466                                                 03961000
CVTRV467 EQU   CVTRV466                                                 03962000
CVTRV465 EQU   CVTRV457                                                 03963000
CVTRV464 EQU   CVTRV457                                                 03964000
CVTRV463 EQU   CVTRV457                                                 03965000
CVTRV462 EQU   CVTRV457                                                 03966000
CVTRV461 EQU   CVTRV457                                                 03967000
CVTRV460 EQU   CVTRV457                                                 03968000
CVTRV459 EQU   CVTRV457                                                 03969000
CVTRV458 EQU   CVTRV457                                                 03970000
CVTRV456 EQU   CVTXTNT2+108                                             03971000
CVTRV455 EQU   CVTXTNT2+104                                             03972000
CVTRV454 EQU   CVTXTNT2+100                                             03973000
CVTRV453 EQU   CVTXTNT2+96                                              03974000
CVTRV452 EQU   CVTXTNT2+94                                              03975000
CVTRV451 EQU   CVTXTNT2+92                                              03976000
CVTRV450 EQU   CVTXTNT2+90                                              03977000
CVTRV449 EQU   CVTXTNT2+88                                              03978000
CVTRV448 EQU   CVTXTNT2+87                                              03979000
CVTRV447 EQU   CVTXTNT2+86                                              03980000
CVTRV446 EQU   CVTRV438                                                 03981000
CVTRV445 EQU   CVTRV438                                                 03982000
CVTRV444 EQU   CVTRV438                                                 03983000
CVTRV443 EQU   CVTRV438                                                 03984000
CVTRV442 EQU   CVTRV438                                                 03985000
CVTRV441 EQU   CVTRV438                                                 03986000
CVTRV440 EQU   CVTRV438                                                 03987000
CVTRV439 EQU   CVTRV438                                                 03988000
CVTRV437 EQU   CVTRV429                                                 03989000
CVTRV436 EQU   CVTRV429                                                 03990000
CVTRV435 EQU   CVTRV429                                                 03991000
CVTRV434 EQU   CVTRV429                                                 03992000
CVTRV433 EQU   CVTRV429                                                 03993000
CVTRV432 EQU   CVTRV429                                                 03994000
CVTRV431 EQU   CVTRV429                                                 03995000
CVTRV430 EQU   CVTRV429                                                 03996000
CVTRV428 EQU   CVTXTNT2+80                                              03997000
CVTRV427 EQU   CVTXTNT2+76                                              03998000
CVTRV426 EQU   CVTXTNT2+72                                              03999000
CVTRV425 EQU   CVTXTNT2+68                                              04000000
CVTATACT EQU   CVTATCVT                                                 04001000
CVTRV423 EQU   CVTXTNT2+62                                              04002000
CVTRV422 EQU   CVTXTNT2+60                                              04003000
CVTRV421 EQU   CVTXTNT2+58                                              04004000
CVTRV420 EQU   CVTXTNT2+56                                              04005000
CVTRV419 EQU   CVTXTNT2+55                                              04006000
CVTRV418 EQU   CVTXTNT2+54                                              04007000
CVTRV417 EQU   CVTRV409                                                 04008000
CVTRV416 EQU   CVTRV409                                                 04009000
CVTRV415 EQU   CVTRV409                                                 04010000
CVTRV414 EQU   CVTRV409                                                 04011000
CVTRV413 EQU   CVTRV409                                                 04012000
CVTRV412 EQU   CVTRV409                                                 04013000
CVTRV411 EQU   CVTRV409                                                 04014000
CVTRV410 EQU   CVTRV409                                                 04015000
CVTRV408 EQU   CVTRV400                                                 04016000
CVTRV407 EQU   CVTRV400                                                 04017000
CVTRV406 EQU   CVTRV400                                                 04018000
CVTRV405 EQU   CVTRV400                                                 04019000
CVTRV404 EQU   CVTRV400                                                 04020000
CVTRV403 EQU   CVTRV400                                                 04021000
CVTRV402 EQU   CVTRV400                                                 04022000
CVTRV401 EQU   CVTRV400                                                 04023000
CVTICB   EQU   CVTXTNT2+48                                              04024000
CVTSKTA  EQU   CVTXTNT2+44                                              04025000
CVTCCVT  EQU   CVTXTNT2+40                                              04026000
CVTRSV98 EQU   CVTXTNT2+36                                              04027000
CVTRSV97 EQU   CVTXTNT2+34                                              04028000
CVTRSV96 EQU   CVTXTNT2+32                                              04029000
CVTOLTEP EQU   CVTXTNT2+28                                              04030000
CVTQIDA  EQU   CVTQID+1                                                 04031000
CVTRSV95 EQU   CVTQID                                                   04032000
CVTRSV94 EQU   CVTXTNT2+20                                              04033000
CVTRSV93 EQU   CVTXTNT2+16                                              04034000
CVTRSV92 EQU   CVTXTNT2+12                                              04035000
CVTDEBVR EQU   CVTXTNT2+8                                               04036000
CVTRSV91 EQU   CVTXTNT2+6                                               04037000
CVTRSV9H EQU   CVTFLGBT                                                 04038000
CVTRSV9G EQU   CVTFLGBT                                                 04039000
CVTRSV9F EQU   CVTFLGBT                                                 04040000
CVTRSV9E EQU   CVTFLGBT                                                 04041000
CVTRSV9D EQU   CVTFLGBT                                                 04042000
CVTRSV9C EQU   CVTFLGBT                                                 04043000
CVTVME   EQU   CVTFLGBT                                                 04044000
CVTNPE   EQU   CVTFLGBT                                                 04045000
CVTNUCLS EQU   CVTXTNT2+4                                               04046000
CVTDSSVA EQU   CVTDSSV+1                                                04047000
CVTRSV89 EQU   CVTDSSV                                                  04048000
CVTRSV88 EQU   CVTXTNT1+8                                               04049000
CVTRSV87 EQU   CVTXTNT1+4                                               04050000
CVTFACHN EQU   CVTXTNT1                                                 04051000
CVTRV488 EQU   CVTMAP+412                                               04052000
CVTRV487 EQU   CVTMAP+408                                               04053000
CVTRV486 EQU   CVTMAP+404                                               04054000
CVTRV485 EQU   CVTMAP+400                                               04055000
CVTACTAP EQU   CVTMAP+396                                               04056000
CVTAUTH  EQU   CVTMAP+392                                               04057000
CVTATMCA EQU   CVTATMCT+1                                               04058000
CVTATMST EQU   CVTATMCT                                                 04059000
CVTRSV61 EQU   CVTMAP+384                                               04060000
CVTVOLT1 EQU   CVTVOLM1+1                                               04061000
CVTVOLI1 EQU   CVTVOLF1                                                 04062000
CVTSTOA  EQU   CVTMAP+376                                               04063000
CVTRSV58 EQU   CVTMAP+374                                               04064000
CVTRSV57 EQU   CVTMAP+372                                               04065000
CVTDDCE  EQU   CVTMAP+368                                               04066000
CVTPNWFR EQU   CVTMAP+364                                               04067000
CVTSMF   EQU   CVTMAP+360                                               04068000
CVTSULK  EQU   CVTMAP+358                                               04069000
CVTSLKO  EQU   CVTSYSK                                                  04070000
CVTSLKP  EQU   CVTSYSK                                                  04071000
CVTSLKQ  EQU   CVTSYSK                                                  04072000
CVTSLKR  EQU   CVTSYSK                                                  04073000
CVTRSV56 EQU   CVTSYSK                                                  04074000
CVTRSV55 EQU   CVTSYSK                                                  04075000
CVTRSV54 EQU   CVTSYSK                                                  04076000
CVTRSV53 EQU   CVTSYSK                                                  04077000
CVTRSV52 EQU   CVTA1F1                                                  04078000
CVTRSV51 EQU   CVTA1F1                                                  04079000
CVTRSV50 EQU   CVTA1F1                                                  04080000
CVTRSV49 EQU   CVTA1F1                                                  04081000
CVTRSV48 EQU   CVTA1F1                                                  04082000
CVTRSV47 EQU   CVTA1F1                                                  04083000
CVTSRSW  EQU   CVTA1F1                                                  04084000
CVTPFSW  EQU   CVTA1F1                                                  04085000
CVTPCVT  EQU   CVTMAP+352                                               04086000
CVTRSV46 EQU   CVTMAP+344                                               04087000
CVTRSV45 EQU   CVTMAP+340                                               04088000
CVTRSV44 EQU   CVTMAP+338                                               04089000
CVTRSV43 EQU   CVTMAP+336                                               04090000
CVTHJESA EQU   CVTHJES+1                                                04091000
CVTRSV42 EQU   CVTHJES                                                  04092000
CVTEXT2A EQU   CVTEXT2+1                                                04093000
CVTRSV41 EQU   CVTEXT2                                                  04094000
CVTAPFA  EQU   CVTAPF+1                                                 04095000
CVTRSV40 EQU   CVTAPF                                                   04096000
CVTRV518 EQU   CVTINTLA                                                 04097000
CVTRV517 EQU   CVTERPV                                                  04098000
CVTEORM  EQU   CVTMAP+312                                               04099000
CVTMCHPR EQU   CVTMAP+308                                               04100000
CVTTZ    EQU   CVTMAP+304                                               04101000
CVTJEPS  EQU   CVTMAP+300                                               04102000
CVTJESCT EQU   CVTMAP+296                                               04103000
CVTMODE  EQU   CVTMAP+292                                               04104000
CVTPTRV  EQU   CVTMAP+288                                               04105000
CVTREAL  EQU   CVTMAP+284                                               04106000
CVTRSV39 EQU   CVTMAP+280                                               04107000
CVTRSV38 EQU   CVTMAP+276                                               04108000
CVTDMSRA EQU   CVTDMSR+1                                                04109000
CVTRV634 EQU   CVTDMSRF                                                 04110000
CVTRV633 EQU   CVTDMSRF                                                 04111000
CVTRV632 EQU   CVTDMSRF                                                 04112000
CVTRV631 EQU   CVTDMSRF                                                 04113000
CVTRV630 EQU   CVTDMSRF                                                 04114000
CVTRV629 EQU   CVTDMSRF                                                 04115000
CVTUDUMP EQU   CVTDMSRF                                                 04116000
CVTSDUMP EQU   CVTDMSRF                                                 04117000
CVTQMSGA EQU   CVTQMSG+1                                                04118000
CVTRSV36 EQU   CVTQMSG                                                  04119000
CVTAMFF  EQU   CVTMAP+264                                               04120000
CVTPURGA EQU   CVTPURG+1                                                04121000
CVTRSV35 EQU   CVTPURG                                                  04122000
CVTCBSP  EQU   CVTMAP+256                                               04123000
CVTATERA EQU   CVTATER+1                                                04124000
CVTSYST  EQU   CVTATER                                                  04125000
CVTVOLT2 EQU   CVTTAT                                                   04126000
CVTVOLI2 EQU   CVTVOLF2                                                 04127000
CVTAQAVB EQU   CVTAQAVT+1                                               04128000
CVTRSV34 EQU   CVTTCMFG                                                 04129000
CVTRSV33 EQU   CVTTCMFG                                                 04130000
CVTRSV32 EQU   CVTTCMFG                                                 04131000
CVTRSV31 EQU   CVTTCMFG                                                 04132000
CVTRSV30 EQU   CVTTCMFG                                                 04133000
CVTRSV29 EQU   CVTTCMFG                                                 04134000
CVTLDEV  EQU   CVTTCMFG                                                 04135000
CVTTCRDY EQU   CVTTCMFG                                                 04136000
CVTGTFA  EQU   CVTGTF+1                                                 04137000
CVTRSV27 EQU   CVTGTFST                                                 04138000
CVTRNIO  EQU   CVTGTFST                                                 04139000
CVTUSR   EQU   CVTGTFST                                                 04140000
CVTRV318 EQU   CVTFORM                                                  04141000
CVTRV317 EQU   CVTTMODE                                                 04142000
CVTRV316 EQU   CVTSTATE                                                 04143000
CVTRV315 EQU   CVTGTFS                                                  04144000
CVTGTFAV EQU   CVTGTFS                                                  04145000
CVT0SCR1 EQU   CVTMAP+232                                               04146000
CVTRV515 EQU   CVTMAP+228                                               04147000
CVTRMS   EQU   CVTMAP+224                                               04148000
CVTPATCH EQU   CVTMAP+220                                               04149000
CVTTSCE  EQU   CVTMAP+216                                               04150000
CVTLNKSC EQU   CVTMAP+214                                               04151000
CVTQABST EQU   CVTMAP+212                                               04152000
CVTMDLDS EQU   CVTMAP+208                                               04153000
CVTUSER  EQU   CVTMAP+204                                               04154000
CVTABEND EQU   CVTMAP+200                                               04155000
CVTSMCA  EQU   CVTMAP+196                                               04156000
CVTRSV18 EQU   CVTMAP+192                                               04157000
CVTQLPAQ EQU   CVTMAP+188                                               04158000
CVTQCDSR EQU   CVTMAP+184                                               04159000
CVTRSV17 EQU   CVTOPTB                                                  04160000
CVTRSV16 EQU   CVTOPTB                                                  04161000
CVTFP    EQU   CVTOPTB                                                  04162000
CVTAPTHR EQU   CVTOPTB                                                  04163000
CVTNLOG  EQU   CVTOPTB                                                  04164000
CVTTOD   EQU   CVTOPTB                                                  04165000
CVTCTIMS EQU   CVTOPTB                                                  04166000
CVTPROT  EQU   CVTOPTB                                                  04167000
CVTXPFP  EQU   CVTOPTA                                                  04168000
CVTASCII EQU   CVTOPTA                                                  04169000
CVTRSV13 EQU   CVTOPTA                                                  04170000
CVTRSV12 EQU   CVTOPTA                                                  04171000
CVTNIP   EQU   CVTOPTA                                                  04172000
CVTDDR   EQU   CVTOPTA                                                  04173000
CVTAPR   EQU   CVTOPTA                                                  04174000
CVTCCH   EQU   CVTOPTA                                                  04175000
CVTSNCTR EQU   CVTMAP+180                                               04176000
CVTQMWR  EQU   CVTMAP+176                                               04177000
CVTQOCR  EQU   CVTMAP+172                                               04178000
CVT1EF00 EQU   CVTMAP+168                                               04179000
CVTMZ00  EQU   CVTMAP+164                                               04180000
CVTSV76Q EQU   CVTSV76C                                                 04181000
CVTRSV11 EQU   CVTMAP+156                                               04182000
CVT0PT01 EQU   CVTMAP+152                                               04183000
CVTMSER  EQU   CVTMAP+148                                               04184000
CVTRV516 EQU   CVTIERLC                                                 04185000
CVTILCH  EQU   CVTMAP+140                                               04186000
CVT0DS   EQU   CVTMAP+136                                               04187000
CVTFBOSV EQU   CVTMAP+132                                               04188000
CVTNUCB  EQU   CVTMAP+128                                               04189000
CVTIXAVL EQU   CVTMAP+124                                               04190000
CVTSV76M EQU   CVTIOQET                                                 04191000
CVTDCBA  EQU   CVTMAP+117                                               04192000
CVTMVS2  EQU   CVTDCB                                                   04193000
CVT6DAT  EQU   CVTDCB                                                   04194000
CVT4MPS  EQU   CVTDCB                                                   04195000
CVTRSV09 EQU   CVTDCB                                                   04196000
CVT4MS1  EQU   CVTDCB                                                   04197000
CVT2SPS  EQU   CVTDCB                                                   04198000
CVT1SSS  EQU   CVTDCB                                                   04199000
CVTRSV08 EQU   CVTDCB                                                   04200000
CVTSTB   EQU   CVTMAP+112                                               04201000
CVTQTD00 EQU   CVTMAP+108                                               04202000
CVTQTE00 EQU   CVTMAP+104                                               04203000
CVTCUCB  EQU   CVTMAP+100                                               04204000
CVTSJQ   EQU   CVTMAP+96                                                04205000
CVTPBLDL EQU   CVTMAP+92                                                04206000
CVTTPC   EQU   CVTMAP+88                                                04207000
CVTSVDCB EQU   CVTMAP+84                                                04208000
CVTBRET  EQU   CVTMAP+82                                                04209000
CVTEXIT  EQU   CVTMAP+80                                                04210000
CVT0FN00 EQU   CVTMAP+76                                                04211000
CVTDARA  EQU   CVTDAR+1                                                 04212000
CVTRSV07 EQU   CVTFLGS1                                                 04213000
CVTRSV06 EQU   CVTFLGS1                                                 04214000
CVTRSV05 EQU   CVTFLGS1                                                 04215000
CVTRSV04 EQU   CVTFLGS1                                                 04216000
CVTRSV03 EQU   CVTFLGS1                                                 04217000
CVTRSV02 EQU   CVTFLGS1                                                 04218000
CVTRSV01 EQU   CVTFLGS1                                                 04219000
CVTDMPLK EQU   CVTFLGS1                                                 04220000
CVTXITP  EQU   CVTMAP+68                                                04221000
CVTZDTAB EQU   CVTMAP+64                                                04222000
CVTMSLT  EQU   CVTMAP+60                                                04223000
CVTDATE  EQU   CVTMAP+56                                                04224000
CVTBTERM EQU   CVTMAP+52                                                04225000
CVTSYSAD EQU   CVTMAP+48                                                04226000
CVTXTLER EQU   CVTMAP+44                                                04227000
CVTILK2  EQU   CVTMAP+40                                                04228000
CVTILK1  EQU   CVTMAP+36                                                04229000
CVTPRLTV EQU   CVTMAP+32                                                04230000
CVTPCNVT EQU   CVTMAP+28                                                04231000
CVT0VL00 EQU   CVTMAP+24                                                04232000
CVTXAPG  EQU   CVTMAP+20                                                04233000
CVTBUF   EQU   CVTMAP+16                                                04234000
CVTJOB   EQU   CVTMAP+12                                                04235000
CVTLINK  EQU   CVTMAP+8                                                 04236000
CVT0EF00 EQU   CVTMAP+4                                                 04237000
CVTTCBP  EQU   CVTMAP                                                   04238000
CVT      EQU   CVTMAP                                                   04239000
@NM00024 EQU   PSA+3668                                                 04240000
PSASTAK  EQU   PSA+3072                                                 04241000
@NM00023 EQU   PSA+1048                                                 04242000
PSAUSEND EQU   PSA+1048                                                 04243000
PSARV062 EQU   PSA+1044                                                 04244000
PSACDAL  EQU   PSA+1040                                                 04245000
PSAWTCOD EQU   PSA+1036                                                 04246000
PSAATCVT EQU   PSA+1032                                                 04247000
PSAPCPSW EQU   PSA+1024                                                 04248000
PSAPIR2  EQU   PSA+1020                                                 04249000
PSARV059 EQU   PSA+1018                                                 04250000
PSASVC13 EQU   PSA+1016                                                 04251000
PSALSFCC EQU   PSA+1012                                                 04252000
PSASFACC EQU   PSA+1008                                                 04253000
PSASTOP  EQU   PSA+992                                                  04254000
PSASTART EQU   PSA+976                                                  04255000
PSARSPSW EQU   PSA+968                                                  04256000
PSASRPSW EQU   PSA+960                                                  04257000
PSARV045 EQU   PSA+892                                                  04258000
PSARV044 EQU   PSA+888                                                  04259000
PSARV043 EQU   PSA+884                                                  04260000
PSARV042 EQU   PSA+880                                                  04261000
PSARV041 EQU   PSA+876                                                  04262000
PSARV040 EQU   PSA+872                                                  04263000
PSARV025 EQU   PSA+868                                                  04264000
PSADSSED EQU   PSA+868                                                  04265000
PSADSSPR EQU   PSA+864                                                  04266000
PSADSSFW EQU   PSA+860                                                  04267000
PSADSS14 EQU   PSA+856                                                  04268000
PSADSSPP EQU   PSA+848                                                  04269000
PSADSSRP EQU   PSA+840                                                  04270000
PSADSS05 EQU   PSADSSF4                                                 04271000
PSADSS10 EQU   PSADSSF4                                                 04272000
PSADSSVE EQU   PSADSSF4                                                 04273000
PSADSSDE EQU   PSADSSF4                                                 04274000
PSADSSC0 EQU   PSADSSF4                                                 04275000
PSADSSIE EQU   PSADSSF4                                                 04276000
PSADSS12 EQU   PSADSSF4                                                 04277000
PSADSSRC EQU   PSADSSF4                                                 04278000
PSARV057 EQU   PSADSSF3                                                 04279000
PSARV056 EQU   PSADSSF3                                                 04280000
PSARV055 EQU   PSADSSF3                                                 04281000
PSADSSMC EQU   PSADSSF3                                                 04282000
PSADSSRW EQU   PSADSSF3                                                 04283000
PSADSSNM EQU   PSADSSF3                                                 04284000
PSADSSES EQU   PSADSSF3                                                 04285000
PSADSSGP EQU   PSADSSF3                                                 04286000
PSADSSF2 EQU   PSADSSFL+1                                               04287000
PSADSSPI EQU   PSADSSF1                                                 04288000
PSADSSOI EQU   PSADSSF1                                                 04289000
PSADSSSP EQU   PSADSSF1                                                 04290000
PSADSSTP EQU   PSADSSF1                                                 04291000
PSADSSDW EQU   PSADSSF1                                                 04292000
PSADSSDD EQU   PSADSSF1                                                 04293000
PSADSSDM EQU   PSADSSF1                                                 04294000
PSADSSMV EQU   PSADSSF1                                                 04295000
PSADSSTS EQU   PSA+816                                                  04296000
PSADSSWK EQU   PSA+812                                                  04297000
PSADSSR3 EQU   PSA+808                                                  04298000
PSADSSR2 EQU   PSA+804                                                  04299000
PSADSSRS EQU   PSA+800                                                  04300000
PSASTOR  EQU   PSA+796                                                  04301000
PSACPUSA EQU   PSA+794                                                  04302000
PSAVSTAP EQU   PSA+792                                                  04303000
PSAWKVAP EQU   PSA+788                                                  04304000
PSAWKRAP EQU   PSA+784                                                  04305000
PSAMCHIC EQU   PSA+783                                                  04306000
PSARV061 EQU   PSA+782                                                  04307000
PSASYMSK EQU   PSA+781                                                  04308000
PSAMCHFL EQU   PSA+780                                                  04309000
PSACR0   EQU   PSA+776                                                  04310000
PSAPSWSV EQU   PSA+768                                                  04311000
PSALITA  EQU   PSA+764                                                  04312000
PSACLHS  EQU   PSAHLHI                                                  04313000
PSALKR15 EQU   PSALKSA+60                                               04314000
PSALKR14 EQU   PSALKSA+56                                               04315000
PSALKR13 EQU   PSALKSA+52                                               04316000
PSALKR12 EQU   PSALKSA+48                                               04317000
PSALKR11 EQU   PSALKSA+44                                               04318000
PSALKR10 EQU   PSALKSA+40                                               04319000
PSALKR9  EQU   PSALKSA+36                                               04320000
PSALKR8  EQU   PSALKSA+32                                               04321000
PSALKR7  EQU   PSALKSA+28                                               04322000
PSALKR6  EQU   PSALKSA+24                                               04323000
PSALKR5  EQU   PSALKSA+20                                               04324000
PSALKR4  EQU   PSALKSA+16                                               04325000
PSALKR3  EQU   PSALKSA+12                                               04326000
PSALKR2  EQU   PSALKSA+8                                                04327000
PSALKR1  EQU   PSALKSA+4                                                04328000
PSALKR0  EQU   PSALKSA                                                  04329000
PSARV023 EQU   PSACLHT+52                                               04330000
PSALOCAL EQU   PSACLHT+48                                               04331000
PSACMSL  EQU   PSACLHT+44                                               04332000
PSAOPTL  EQU   PSACLHT+40                                               04333000
PSATPACL EQU   PSACLHT+36                                               04334000
PSATPDNL EQU   PSACLHT+32                                               04335000
PSATPNCL EQU   PSACLHT+28                                               04336000
PSAIOSLL EQU   PSACLHT+24                                               04337000
PSAIOSUL EQU   PSACLHT+20                                               04338000
PSAIOSCL EQU   PSACLHT+16                                               04339000
PSAIOSSL EQU   PSACLHT+12                                               04340000
PSASALCL EQU   PSACLHT+8                                                04341000
PSAASML  EQU   PSACLHT+4                                                04342000
PSADISPL EQU   PSACLHT                                                  04343000
PSASRSA  EQU   PSA+636                                                  04344000
PSARV050 EQU   PSA+634                                                  04345000
PSADSSGO EQU   PSA+633                                                  04346000
PSARECUR EQU   PSA+632                                                  04347000
PSAHLHIS EQU   PSA+628                                                  04348000
PSAIPCSA EQU   PSA+624                                                  04349000
@NM00022 EQU   PSA+621                                                  04350000
PSAIPCDM EQU   PSA+620                                                  04351000
PSAIPCD  EQU   PSA+616                                                  04352000
@NM00021 EQU   PSA+613                                                  04353000
PSAIPCRM EQU   PSA+612                                                  04354000
PSAIPCR  EQU   PSA+608                                                  04355000
PSAMCHEX EQU   PSA+600                                                  04356000
PSAMPSW  EQU   PSA+592                                                  04357000
PSAEXPS2 EQU   PSA+584                                                  04358000
PSAEXPS1 EQU   PSA+576                                                  04359000
PSAPIREG EQU   PSA+572                                                  04360000
PSARSREG EQU   PSA+568                                                  04361000
PSAGPREG EQU   PSA+556                                                  04362000
PSARV022 EQU   PSASUP4                                                  04363000
PSARV021 EQU   PSASUP4                                                  04364000
PSARV020 EQU   PSASUP4                                                  04365000
PSARV019 EQU   PSASUP4                                                  04366000
PSARV018 EQU   PSASUP4                                                  04367000
PSARV017 EQU   PSASUP4                                                  04368000
PSARV016 EQU   PSASUP4                                                  04369000
PSARV015 EQU   PSASUP4                                                  04370000
PSARV014 EQU   PSASUP3                                                  04371000
PSAULCMS EQU   PSASUP3                                                  04372000
PSARV012 EQU   PSASUP3                                                  04373000
PSAESTA  EQU   PSASUP3                                                  04374000
PSASPR   EQU   PSASUP3                                                  04375000
PSAPSREG EQU   PSASUP3                                                  04376000
PSAPI2   EQU   PSASUP3                                                  04377000
PSAIOSUP EQU   PSASUP3                                                  04378000
PSALCR   EQU   PSASUP2                                                  04379000
PSARTM   EQU   PSASUP2                                                  04380000
PSAACR   EQU   PSASUP2                                                  04381000
PSAIPCE2 EQU   PSASUP2                                                  04382000
PSAIPCES EQU   PSASUP2                                                  04383000
PSAIPCEC EQU   PSASUP2                                                  04384000
PSAGTF   EQU   PSASUP2                                                  04385000
PSAIPCRI EQU   PSASUP2                                                  04386000
PSATYPE6 EQU   PSASUP1                                                  04387000
PSATCTL  EQU   PSASUP1                                                  04388000
PSADISP  EQU   PSASUP1                                                  04389000
PSALOCK  EQU   PSASUP1                                                  04390000
PSAPI    EQU   PSASUP1                                                  04391000
PSAEXT   EQU   PSASUP1                                                  04392000
PSASVC   EQU   PSASUP1                                                  04393000
PSAIO    EQU   PSASUP1                                                  04394000
PSAANEW  EQU   PSA+544                                                  04395000
PSATNEW  EQU   PSA+536                                                  04396000
PSALCCAR EQU   PSA+532                                                  04397000
PSALCCAV EQU   PSA+528                                                  04398000
PSAPCCAR EQU   PSA+524                                                  04399000
PSAPCCAV EQU   PSA+520                                                  04400000
PSACPULA EQU   PSA+518                                                  04401000
PSACPUPA EQU   PSA+516                                                  04402000
PSAPSA   EQU   PSA+512                                                  04403000
FLCHDEND EQU   PSA+512                                                  04404000
FLCCRSAV EQU   FLCMCLA+280                                              04405000
FLCGRSAV EQU   FLCMCLA+216                                              04406000
FLCFPSAV EQU   FLCMCLA+184                                              04407000
FLCFLA   EQU   FLCMCLA+88                                               04408000
FLCRGNCD EQU   FLCMCLA+84                                               04409000
FLCFSAA  EQU   FLCFSA+1                                                 04410000
@NM00020 EQU   FLCFSA                                                   04411000
@NM00019 EQU   FLCMCLA+72                                               04412000
FLCMCIC  EQU   FLCMCLA+64                                               04413000
@NM00018 EQU   FLCMCLA+20                                               04414000
FLCIOAA  EQU   FLCIOA+1                                                 04415000
@NM00017 EQU   FLCIOA                                                   04416000
@NM00016 EQU   FLCMCLA+15                                               04417000
@NM00015 EQU   FLCMCLA+14                                               04418000
@NM00014 EQU   FLCMCLA+12                                               04419000
FLCLCL   EQU   FLCMCLA+8                                                04420000
FLCIOELA EQU   FLCIOEL+1                                                04421000
@NM00013 EQU   FLCIOEL                                                  04422000
FLCCHNID EQU   FLCMCLA                                                  04423000
@NM00012 EQU   PSA+160                                                  04424000
FLCMTRCD EQU   PSA+157                                                  04425000
@NM00011 EQU   PSA+156                                                  04426000
FLCPERA  EQU   FLCPER+1                                                 04427000
@NM00010 EQU   FLCPER                                                   04428000
@NM00009 EQU   PSA+151                                                  04429000
FLCPERCD EQU   PSA+150                                                  04430000
FLCMCNUM EQU   PSA+149                                                  04431000
@NM00008 EQU   PSA+148                                                  04432000
FLCTEAA  EQU   FLCTEA+1                                                 04433000
@NM00007 EQU   FLCTEA                                                   04434000
PSAPIPC  EQU   PSAPICOD                                                 04435000
PSAPIMC  EQU   PSAPICOD                                                 04436000
PSAPIPER EQU   PSAPICOD                                                 04437000
PSARV049 EQU   FLCPICOD                                                 04438000
FLCPILCB EQU   FLCPIILC                                                 04439000
@NM00006 EQU   FLCPIILC                                                 04440000
@NM00005 EQU   PSAEPPSW                                                 04441000
FLCSVCN  EQU   PSAESPSW+2                                               04442000
FLCSILCB EQU   FLCSVILC                                                 04443000
@NM00004 EQU   FLCSVILC                                                 04444000
@NM00003 EQU   PSAESPSW                                                 04445000
FLCEICOD EQU   PSAEEPSW+2                                               04446000
PSASPAD  EQU   PSAEEPSW                                                 04447000
@NM00002 EQU   PSA+128                                                  04448000
FLCINPSW EQU   PSA+120                                                  04449000
FLCMNPSW EQU   PSA+112                                                  04450000
FLCPNPSW EQU   PSA+104                                                  04451000
FLCSNPSW EQU   PSA+96                                                   04452000
FLCENPSW EQU   PSA+88                                                   04453000
FLCTRACE EQU   PSA+84                                                   04454000
FLCTIMER EQU   PSA+80                                                   04455000
FLCCVT2  EQU   PSA+76                                                   04456000
FLCCAW   EQU   PSA+72                                                   04457000
FLCCSW   EQU   PSA+64                                                   04458000
FLCIOPSW EQU   PSA+56                                                   04459000
FLCMOPSW EQU   PSA+48                                                   04460000
FLCPOPSW EQU   PSA+40                                                   04461000
FLCSOPSW EQU   PSA+32                                                   04462000
FLCEOPSW EQU   PSA+24                                                   04463000
@NM00001 EQU   FLCICCW2+4                                               04464000
FLCICCW1 EQU   FLCROPSW                                                 04465000
FLCIPPSW EQU   FLCRNPSW                                                 04466000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04467000
@RF00079 EQU   INTGMFM                                                  04468000
@RF00122 EQU   @EL00002                                                 04469000
@RT00148 EQU   @EL00004                                                 04470000
@RT00223 EQU   QREPAIR3                                                 04471000
@RT00290 EQU   @EL00006                                                 04472000
@RT00328 EQU   B1ERR                                                    04473000
@RF00341 EQU   SPQECHK1                                                 04474000
@RT00362 EQU   DQECHK1                                                  04475000
@RT00364 EQU   DQECHK9                                                  04476000
@RT00398 EQU   DQECHK0                                                  04477000
@RF00398 EQU   DQECHK6                                                  04478000
@RT00415 EQU   DQECHK12                                                 04479000
@RT00418 EQU   DQECHK15                                                 04480000
@RT00421 EQU   DQECHK15                                                 04481000
@RF00426 EQU   DQECHK6                                                  04482000
@RT00442 EQU   DQECHK16                                                 04483000
@RT00452 EQU   DQECHK2                                                  04484000
@RT00462 EQU   DQECHK12                                                 04485000
@RT00472 EQU   DQECHK12                                                 04486000
@RT00477 EQU   DQECHK12                                                 04487000
@RT00490 EQU   DQECHK12                                                 04488000
@RT00492 EQU   DQECHK4                                                  04489000
@RT00494 EQU   DQECHK12                                                 04490000
@RT00496 EQU   DQECHK12                                                 04491000
@RT00501 EQU   DQECHK8                                                  04492000
@RT00543 EQU   FQECHK3                                                  04493000
@RT00545 EQU   FQECHK5                                                  04494000
@RT00548 EQU   FQECHK5                                                  04495000
@RT00551 EQU   FQECHK7                                                  04496000
@RT00554 EQU   FQECHK8                                                  04497000
@RT00563 EQU   FQECHK5                                                  04498000
@RT00566 EQU   FQECHK5                                                  04499000
@RT00569 EQU   FQECHK7                                                  04500000
@RF00571 EQU   FQECHK2                                                  04501000
@RT00621 EQU   ECCERR                                                   04502000
@RT00651 EQU   ADDRCHK1                                                 04503000
@RT00655 EQU   ADDRCHK2                                                 04504000
@RT00658 EQU   ADDRCHK2                                                 04505000
@RF00668 EQU   ADDRCHK3                                                 04506000
@RF00682 EQU   @EL00011                                                 04507000
@RF00686 EQU   @EL00011                                                 04508000
@ENDDATA EQU   *                                                        04509000
         END   IEAVGFRR,(C'PLS1755',0701,78194)                         04510000
./  ADD  SSI=81450165,NAME=IEAVGM00
         TITLE 'IEAVGM00   OS/VS2 GETMAIN / FREEMAIN SERVICE ROUTINE   *00005003
               CSECT-IEAVGM00'                                          00008003
* /* START OF SPECIFICATIONS ****                                       00011002
*                                                                       00012002
*01*  MODULE-NAME = IEAVGM00                                            00013002
*                                                                       00014002
*02*     CSECT-NAME = IEAVGM00                                          00015002
*                                                                       00016002
*02*     CSECT-NAME = IEAVGM01                                          00016202
*                                                                       00016402
*02*     CSECT-NAME = IEASMFGF                                          00017002
*                                                                       00018002
*01*  DESCRIPTIVE-NAME = OS/VS2 GETMAIN/FREEMAIN SERVICE ROUTINE        00019002
*                                                                       00020002
*01*  COPYRIGHT = NONE                                                  00021002
*                                                                       00022002
*01*  STATUS = OS/VS2 RELEASE 3.7 WITH SU5 AND SU7                      00022140
*              PFT LEVEL UZ18823                                        00022240
*                                                                       00024002
*01*  FUNCTION = THE GETMAIN/FREEMAIN MODULE WILL ALLOCATE (GETMAIN)    00025002
*     AND DEALLOCATE (FREEMAIN) VIRTUAL STORAGE IN THE SQA AND CSA AND  00026002
*     IN THE LSQA, SWA, AND USER REGION OF EACH VIRTUAL MEMORY.  THIS   00027002
*     INVOLVES:                                                         00028002
*                                                                       00029002
*        1. ALLOCATION OF STORAGE BLOCKS ON REQUEST                     00030002
*                                                                       00031002
*        2. RELEASE OF STORAGE BLOCKS ON REQUEST                        00032002
*                                                                       00033002
*        3. MAINTAINING OWNERSHIP OF ALL 4K BLOCKS                      00034002
*                                                                       00035002
*              A. MAINTAINING A RECORD OF ALL 4K BLOCKS ASSIGNED TO     00036002
*                 EACH TASK AND TO EACH SUBPOOL BELONGING TO THAT TASK  00037002
*                                                                       00038002
*              B. MAINTAINING A QUEUE IN LSQA OF FREE AREAS IN THE      00039002
*                 STORAGE ASSIGNED TO EACH TASK SUBPOOL                 00040002
*                                                                       00041002
*              C. MAINTAINING A RECORD OF ASSOCIATION WITH A TASK       00042002
*                 OR JOB STEP OF STORAGE ALLOCATED FROM SUPERVISOR      00043002
*                 OWNED STORAGE (VIA AQE'S - ALLOCATED QUEUE ELEMENTS)  00044002
*                 WHEN REQUESTED TO DO SO                               00045002
*                                                                       00046002
*     A SECONDARY FUNCTION IN SUPPORT OF SYSTEM MANAGEMENT              00047002
*     FACILITIES (SMF) IS TO PRODUCE ACTUAL STORAGE USED VALUES.        00048002
*     THIS INVOLVES:                                                    00049002
*                                                                       00050002
*        1. MONITORING REQUESTS FOR PROBLEM PROGRAM                     00051002
*           SUBPOOLS (INCLUDING SUBPOOLS 250, 251, AND                  00052002
*           252); AND MAINTAINING STORAGE USED FIELDS                   00053002
*           ASSOCIATED WITH EACH PROBLEM PROGRAM TCB                    00054002
*                                                                       00055002
*        2. THE FIELDS MAINTAINED ARE:                                  00056002
*                                                                       00057002
*           TCTLWM      HIGHEST ADDRESS ALLOCATED FROM THE              00058002
*                       BOTTOM OF THE PRIVATE AREA OR REGION            00059002
*                                                                       00060002
*           TCTHWM      LOWEST ADDRESS THAT LSQA, SQA, AND              00061002
*                       SUBPOOLS 229 AND 230 REACH FROM THE             00062002
*                       TOP OF THE PRIVATE AREA                         00063002
*                                                                       00064002
*           TCTMINC     NO LONGER USED                                  00065002
*                                                                       00066002
*        3. DURING TASK TERMINATION (HIGH ORDER BIT OF TCT              00067002
*           ADDRESS IN TCB SET TO ZERO) THIS SMF DATA WILL              00068002
*           NOT BE RECORDED IN ORDER TO PREVENT INITIATOR               00069002
*           PROCESSING FROM AFFECTING THE RESULTS.                      00070002
*                                                                       00071002
*02*     OPERATION = WHEN THE MODULE IS ENTERED ON AN SVC 4 OR SVC 5    00072002
*        REQUEST, ADDRESSABILITY IS ESTABLISHED AND IF THE TASK IS NOT  00073002
*        KEY 0 ALL OF THE INPUT PARAMETERS AND LISTS ARE VALIDITY       00074002
*        CHECKED.                                                       00075002
*                                                                       00076002
*        WHEN THE MODULE IS ENTERED ON ANY OTHER TYPE OF REQUEST,       00077002
*        ADDRESSABILITY IS ESTABLISHED, REGISTERS ARE SAVED             00078002
*        (BRANCH ENTRIES ONLY), AND AN INDICATION OF THE TYPE OF        00079002
*        ENTRY IS SAVED.                                                00080002
*                                                                       00081002
*        FOR ALL ENTRIES INTERNAL PARAMETERS ARE NOW SET UP SO          00082002
*        THAT COMMON ROUTINES MAY BE USED FOR THE ACTUAL GETMAIN        00083002
*        OR FREEMAIN.  THESE PARAMETERS ARE:                            00084002
*                                                                       00085002
*        RIN1 (REG 1) = VALUE OF REG 1 WHEN THIS MODULE WAS             00086002
*                       ENTERED                                         00087002
*                                                                       00088002
*        RLENGTH (REG 10) = LENGTH OR POINTER TO LENGTH LIST            00089002
*                                                                       00090002
*        RADDR (REG 11) = ADDRESS OR ADDRESS SLOT, OR LIST OF ADDRESSES 00091002
*                                                                       00092002
*        RLDA (REG 4) = ADDRESS OF LDA                                  00093002
*                                                                       00096002
*        LDARQSTA = SVC NUMBER OR BRANCH INDICATOR, PROTECT KEY,        00097002
*                    AND MODE FLAGS                                     00098002
*                                                                       00099002
*        AT THIS POINT THE GMCOMMON ROUTINE IS ENTERED FOR A            00100002
*        GETMAIN AND THE FMCOMMON ROUTINE IS ENTERED FOR A              00101002
*        FREEMAIN.  IN EITHER CASE THE SUBPOOL CHECK SUBROUTINE         00102002
*        (CSPCHK) IS CALLED TO LOOK UP THE SUBPOOL NUMBER AND           00103002
*        TAKE SPECIAL ACTION IF NECESSARY.  IF SUBPOOLS 242 OR 247      00104002
*        ARE REFERENCED, CONTROL PASSES TO THE MODULE IEAVPRT0          00105002
*        (GET/FREE PART).  ALL OTHER SUBPOOLS ARE PROCESSED             00106002
*        IN THIS MODULE (IEAVGM00) OR ARE CONSIDERED ERROR              00106502
*        CONDITIONS.  FOR EACH SUBPOOL THE NECESSARY POINTERS ARE       00107002
*        INITIALIZED AND FOR SUBPOOLS OTHER THAN SQA OR LSQA A          00108002
*        SEARCH IS MADE FOR AN SPQE.  IF ONE IS FOUND ITS ADDRESS       00109002
*        IS RETURNED TO THE CALLING ROUTINE.                            00110002
*                                                                       00111002
*        UPON RETURN TO THE GMCOMMON ROUTINE, IF AN SPQE WAS NOT        00112002
*        FOUND ONE IS CREATED, THE REQUEST LENGTH IS ROUNDED UP         00113002
*        TO AN 8 BYTE MULTIPLE, AND THE REQUESTED VIRTUAL STORAGE       00114002
*        IS SEARCHED FOR.  IF IT IS AVAILABLE, RETURN IS MADE TO        00115002
*        THE CALLER WITH THE ADDRESS OF THE ALLOCATED SPACE.  IF        00116002
*        THE STORAGE IS NOT AVAILABLE RETURN IS MADE WITH A             00117002
*        RETURN CODE OF 4 OR 8 IN REGISTER 15 IF THE REQUEST WAS        00118002
*        CONDITIONAL, OR THE TASK IS ABENDED IF THE REQUEST WAS         00119002
*        UNCONDITIONAL.                                                 00120002
*                                                                       00121002
*        FOR A FREEMAIN, WHEN THE CSPCHK ROUTINE RETURNS TO             00122002
*        FMCOMMON, IF NO SPQE WAS FOUND AN ERROR IS INDICATED.          00123002
*        OTHERWISE THE APPROPRIATE STORAGE IS REMOVED FROM THE          00124002
*        ALLOCATED AREA AND RETURNED TO THE FREE QUEUES.                00125002
*        CHECKING IS DONE TO DETERMINE IF A 4K BLOCK OF                 00126002
*        STORAGE HAS BEEN MADE FREE.  IF IT HAS, THE RELEASE PAGE       00127002
*        ROUTINE OF RSM IS ENTERED TO FREE THE PAGE AND UNLESS          00128002
*        THE SPACE IS IN SQA OR CSA, IT IS REMOVED FROM THE             00129002
*        SUBPOOL FREE QUEUE AND ADDED TO THE ADDRESS SPACE FREE         00130002
*        QUEUE.  SQA AND CSA PAGES ARE RETURNED TO THE                  00131002
*        APPROPRIATE GLOBAL FREE QUEUES.                                00132002
*                                                                       00133002
*        IF AN ERROR WAS FOUND DURING THE FREEMAIN PROCESS AND          00134002
*        THE REQUEST WAS UNCONDITIONAL THEN THE REQUESTING TASK         00135002
*        IS ABENDED.  IF THE REQUEST WAS CONDITIONAL AND NO ERROR       00136002
*        WAS DISCOVERED, A RETURN CODE OF 0 IS GIVEN; IF AN ERROR       00137002
*        DID OCCUR, A RETURN CODE OF 4 OR 8 IS GIVEN.  THE RETURN       00138002
*        CODE IS PROVIDED IN REGISTER 15.                               00139002
*                                                                       00140002
*01*   NOTES = NONE                                                     00141002
*                                                                       00142002
*02*     DEPENDENCIES = THE LOCAL MEMORY LOCK MUST BE HELD UPON ENTRY   00143002
*        TO THIS ROUTINE EXCEPT FOR THE GLBRANCH AND MRELEASR ENTRIES   00144002
*        WHICH MUST HAVE THE SALLOC LOCK.  THE STORAGE KEY MUST BE      00145002
*        ZERO, THE SYSTEM MUST BE IN SUPERVISOR MODE, AND DYNAMIC       00146002
*        ADDRESS TRANSLATION MUST BE ON.                                00147002
*                                                                       00148002
*03*       CHARACTER-CODE-DEPENDENCIES = THE MODULE IS INDEPENDENT OF   00149002
*          CHARACTER CODES                                              00150002
*                                                                       00151002
*02*     RESTRICTIONS = NONE                                            00152002
*                                                                       00153002
*02*     REGISTER-CONVENTIONS = SEE SECTION "REGISTER EQUATES"          00154002
*                                                                       00155002
*02*     PATCH-LABEL = NO PATCH AREA PROVIDED                           00156002
*                                                                       00157002
*01*  MODULE-TYPE = PROCEDURE                                           00158002
*                                                                       00159002
*02*     PROCESSOR = ASSEMBLER-370R                                     00160003
*                                                                       00161002
*02*     MODULE-SIZE = 11K BYTES                                        00162003
*                                                                       00163002
*02*     ATTRIBUTES = NUCLEUS, ZERO PSW PROTECT KEY, REFRESHABLE,       00164002
*        SUPERVISOR MODE                                                00165002
*                                                                       00166002
*01*  ENTRY-POINT = IGC004                                              00167002
*                                                                       00168002
*02*     PURPOSE = STORAGE TYPE GETMAIN                                 00169002
*                                                                       00170002
*02*     LINKAGE = CALLED BY E, L, AND V FORMS OF GETMAIN MACRO;        00171002
*        ENTERED FROM SVC INTERRUPTION HANDLER                          00172002
*                                                                       00173002
*02*     INPUT =                                                        00174002
*        REG  1     ADDRESS OF THE PARAMETER LIST                       00175002
*        REG  4     ADDRESS OF CURRENT TCB                              00176002
*        REG  5     ADDRESS OF RB AT TOP OF THE RB QUEUE                00177002
*        REG  7     ADDRESS OF CURRENT ASCB                             00178002
*        REG 14     ADDRESS OF THE TYPE 1 SVC EXIT HANDLER              00179002
*                                                                       00180002
*        THE FORMAT OF THE PARAMETER LIST IS DESCRIBED BELOW UNDER      00181002
*        "INPUT PARAMETER LIST"                                         00182002
*                                                                       00183002
*02*     OUTPUT = THE ADDRESS(ES) OF THE STORAGE ALLOCATED IS PLACED    00184002
*        INTO THE PARAMETER LIST. (SEE "LIST FORMATS" BELOW)            00185002
*                                                                       00186002
*02*     REGISTERS-SAVED = REGISTERS 1 AND 14                           00187002
*                                                                       00188002
*02*     REGISTERS-RESTORED = REGISTERS 1 AND 14                        00189002
*                                                                       00190002
*01*  ENTRY-POINT = IGC005                                              00191002
*                                                                       00192002
*02*     PURPOSE = STORAGE TYPE FREEMAIN                                00193002
*                                                                       00194002
*02*     LINKAGE = CALLED BY E, L, AND V FORMS OF FREEMAIN MACRO;       00195002
*        ENTERED FROM SVC INTERRUPTION HANDLER                          00196002
*                                                                       00197002
*02*     INPUT =                                                        00198002
*        REG  1     ADDRESS OF THE PARAMETER LIST                       00199002
*        REG  4     ADDRESS OF CURRENT TCB                              00200002
*        REG  5     ADDRESS OF RB AT TOP OF THE RB QUEUE                00201002
*        REG  7     ADDRESS OF CURRENT ASCB                             00202002
*        REG 14     ADDRESS OF THE TYPE 1 SVC EXIT HANDLER              00203002
*                                                                       00204002
*        THE FORMAT OF THE PARAMETER LIST IS DESCRIBED BELOW UNDER      00205002
*        "INPUT PARAMETER LIST"                                         00206002
*                                                                       00207002
*02*     OUTPUT = NONE                                                  00208002
*                                                                       00209002
*02*     REGISTERS-SAVED = REGISTERS 1 AND 14                           00210002
*                                                                       00211002
*02*     REGISTERS-RESTORED = REGISTERS 1 AND 14                        00212002
*                                                                       00213002
*01*  ENTRY-POINT = IGC010                                              00214002
*                                                                       00215002
*02*     PURPOSE = REGISTER TYPE, UNCONDITIONAL GETMAIN OR FREEMAIN     00216002
*                                                                       00217002
*02*     LINKAGE = CALLED BY R FORM OF GETMAIN OR FREEMAIN MACRO;       00218002
*        ENTERED FROM SVC INTERRUPTION HANDLER                          00219002
*                                                                       00220002
*02*     INPUT =                                                        00221002
*        REG  0     SUBPOOL ID IN BYTE 0, NUMBER OF BYTES REQUESTED IN  00222002
*                   BYTES 1 TO 3; FOR A SUBPOOL FREEMAIN BYTES 1 TO 3   00223002
*                   MUST BE 0                                           00224002
*        REG  1     ANY NEGATIVE VALUE IF REQUEST IS FOR A GETMAIN,     00225002
*                   ADDRESS TO BE FREED IF REQUEST IS FOR A FREEMAIN;   00226002
*                   FOR A SUBPOOL FREEMAIN MUST BE 0                    00227002
*        REG  4     ADDRESS OF CURRENT TCB                              00228002
*        REG  5     ADDRESS OF RB AT TOP OF THE RB QUEUE                00229002
*        REG  7     ADDRESS OF CURRENT ASCB                             00230002
*        REG 14     ADDRESS OF THE TYPE 1 SVC EXIT HANDLER              00231002
*                                                                       00232002
*02*     OUTPUT = FOR A GETMAIN, REGISTER 1 CONTAINS THE ADDRESS OF     00233002
*        THE STORAGE ALLOCATED; FOR A FREEMAIN, NONE                    00234002
*                                                                       00235002
*02*     REGISTERS-SAVED = REGISTERS 1 AND 14                           00236002
*                                                                       00237002
*02*     REGISTERS-RESTORED = REGISTER 14 IF GETMAIN AND REGISTERS 1    00238002
*        AND 14 IF FREEMAIN                                             00239002
*                                                                       00240002
*01*  ENTRY-POINT = IGC120                                              00241002
*                                                                       00242002
*02*     PURPOSE = REGISTER TYPE GETMAIN OR FREEMAIN                    00243002
*                                                                       00244002
*02*     LINKAGE = CALLED BY RC OR RU FORMS OF GETMAIN OR FREEMAIN      00245002
*        MACRO; ENTERED FROM SVC INTERRUPTION HANDLER                   00246002
*                                                                       00247002
*02*     INPUT =                                                        00248002
*        REG  0     NUMBER OF BYTES REQUESTED; FOR A SUBPOOL FREEMAIN   00249002
*                   MUST BE 0                                           00250002
*        REG  1     ZERO FOR A GETMAIN, ADDRESS TO BE FREED FOR A       00251002
*                   FREEMAIN; FOR A SUBPOOL FREEMAIN MUST BE 0          00252002
*        REG  4     ADDRESS OF CURRENT TCB                              00253002
*        REG  5     ADDRESS OF RB AT TOP OF THE RB QUEUE                00254002
*        REG  7     ADDRESS OF CURRENT ASCB                             00255002
*        REG 14     ADDRESS OF THE TYPE 1 SVC EXIT HANDLER              00256002
*        REG 15     BYTES 0 AND 1 RESERVED, SET TO 0                    00257002
*                   BYTE 2  SUBPOOL ID                                  00257202
*                   BYTE 3  FLAGS AS FOLLOWS:                           00258002
*                     BITS 0-4    RESERVED, SET TO 0                    00259002
*                     BIT 5       = 0  DOUBLEWORD BOUNDARY              00260002
*                                 = 1  PAGE BOUNDARY                    00261002
*                     BIT 6       = 0  CONDITIONAL REQUEST              00262002
*                                 = 1  UNCONDITIONAL REQUEST            00263002
*                     BIT 7       = 0  GETMAIN                          00264002
*                                 = 1  FREEMAIN                         00265002
*                                                                       00266002
*02*     OUTPUT = FOR A GETMAIN, REGISTER 1 CONTAINS THE ADDRESS OF     00267002
*        THE STORAGE ALLOCATED; FOR A FREEMAIN, NONE                    00268002
*                                                                       00269002
*02*     REGISTERS-SAVED = REGISTERS 1 AND 14                           00270002
*                                                                       00271002
*02*     REGISTERS-RESTORED = REGISTER 14 IF GETMAIN AND REGISTERS 1    00272002
*        AND 14 IF FREEMAIN                                             00273002
*                                                                       00274002
*01*  ENTRY-POINT = GMBRANCH                                            00275002
*                                                                       00276002
*02*     PURPOSE = STORAGE TYPE GETMAIN, BRANCH ENTRY                   00277002
*                                                                       00278002
*02*     LINKAGE = CALLED BY E, L, AND V FORMS OF GETMAIN MACRO         00279002
*        WITH BRANCH OPTION SPECIFIED                                   00280002
*                                                                       00281002
*02*     INPUT =                                                        00282002
*        REG  1     ADDRESS OF THE PARAMETER LIST                       00283002
*        REG  4     ADDRESS OF THE TCB UNDER WHICH STORAGE IS TO BE     00284002
*                   ALLOCATED                                           00285002
*        REG  7     ADDRESS OF ASCB                                     00286002
*        REG 14     RETURN ADDRESS                                      00287002
*                                                                       00288002
*        THE FORMAT OF THE PARAMETER LIST IS DESCRIBED BELOW UNDER      00289002
*        "INPUT PARAMETER LIST"                                         00290002
*                                                                       00291002
*02*     OUTPUT = THE ADDRESS(ES) OF THE STORAGE ALLOCATED IS PLACED    00292002
*        INTO THE PARAMETER LIST. (SEE "LIST FORMATS" BELOW)            00293002
*                                                                       00294002
*02*     REGISTERS-SAVED = ALL REGISTERS EXCEPT 7                       00295003
*                                                                       00296002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 1, 7 AND 15          00297003
*                                                                       00298002
*01*  ENTRY-POINT = FMBRANCH                                            00299002
*                                                                       00300002
*02*     PURPOSE = STORAGE TYPE FREEMAIN, BRANCH ENTRY                  00301002
*                                                                       00302002
*02*     LINKAGE = CALLED BY E, L, AND V FORMS OF FREEMAIN MACRO        00303002
*        WITH BRANCH OPTION SPECIFIED                                   00304002
*                                                                       00305002
*02*     INPUT =                                                        00306002
*        REG  1     ADDRESS OF THE PARAMETER LIST                       00307002
*        REG  4     ADDRESS OF THE TCB UNDER WHICH STORAGE IS TO BE     00308002
*                   ALLOCATED                                           00309002
*        REG  7     ADDRESS OF ASCB                                     00310002
*        REG 14     RETURN ADDRESS                                      00311002
*                                                                       00312002
*        THE FORMAT OF THE PARAMETER LIST IS DESCRIBED BELOW UNDER      00313002
*        "INPUT PARAMETER LIST"                                         00314002
*                                                                       00315002
*02*     OUTPUT = NONE                                                  00316002
*                                                                       00317002
*02*     REGISTERS-SAVED = ALL REGISTERS                                00318002
*                                                                       00319002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 15                   00320002
*                                                                       00321002
*01*  ENTRY-POINT = RMBRANCH                                            00322002
*                                                                       00323002
*02*     PURPOSE = REGISTER TYPE, UNCONDITIONAL GETMAIN OR FREEMAIN,    00324002
*        BRANCH ENTRY                                                   00325002
*                                                                       00326002
*02*     LINKAGE = CALLED BY R FORM OF GETMAIN OR FREEMAIN MACRO        00327002
*        WITH BRANCH OPTION SPECIFIED                                   00328002
*                                                                       00329002
*02*     INPUT =                                                        00330002
*        REG  0     SUBPOOL ID IN BYTE 0, NUMBER OF BYTES REQUESTED IN  00331002
*                   BYTES 1 TO 3; FOR A SUBPOOL FREEMAIN BYTES 1 TO 3   00332002
*                   MUST BE 0                                           00333002
*        REG  1     ANY NEGATIVE VALUE IF REQUEST IS FOR A GETMAIN,     00334002
*                   ADDRESS TO BE FREED IF REQUEST IS FOR A FREEMAIN;   00335002
*                   FOR A SUBPOOL FREEMAIN MUST BE 0                    00336002
*        REG  4     ADDRESS OF THE TCB UNDER WHICH STORAGE IS TO BE     00337002
*                   ALLOCATED                                           00338002
*        REG  7     ADDRESS OF ASCB                                     00339002
*        REG 14     RETURN ADDRESS                                      00340002
*                                                                       00341002
*02*     OUTPUT = FOR A GETMAIN, REGISTER 1 CONTAINS THE ADDRESS OF     00342002
*        THE STORAGE ALLOCATED; FOR A FREEMAIN, NONE                    00343002
*                                                                       00344002
*02*     REGISTERS-SAVED = ALL REGISTERS EXCEPT 7                       00345003
*                                                                       00346002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 1, 7 AND 15 IF       00347003
*        GETMAIN AND ALL REGISTERS EXCEPT 7 AND 15 IF FREEMAIN          00347503
*                                                                       00349002
*01*  ENTRY-POINT = QCBRANCH                                            00350002
*                                                                       00351002
*02*     PURPOSE = IDENTICAL TO RMBRANCH, RETAINED FOR COMPATIBILITY    00352002
*        WITH OS/VS2 RELEASE 1 QUICKCELLS                               00353002
*                                                                       00354002
*01*  ENTRY-POINT = CRBRANCH                                            00355002
*                                                                       00356002
*02*     PURPOSE = REGISTER TYPE GETMAIN OR FREEMAIN, BRANCH ENTRY      00357002
*                                                                       00358002
*02*     LINKAGE = CALLED BY RC OR RU FORMS OF GETMAIN OR FREEMAIN      00359002
*        MACRO WITH BRANCH OPTION SPECIFIED                             00360002
*                                                                       00361002
*02*     INPUT =                                                        00362002
*        REG  0     NUMBER OF BYTES REQUESTED; FOR A SUBPOOL FREEMAIN   00363002
*                   MUST BE 0                                           00364002
*        REG  1     ZERO FOR A GETMAIN, ADDRESS TO BE FREED FOR A       00365002
*                   FREEMAIN; FOR A SUBPOOL FREEMAIN MUST BE 0          00366002
*        REG  3     BYTE 0  RESERVED, SET TO 0                          00367002
*                   BYTE 1  PROTECT KEY FOR SP 227-231 AND 241          00368003
*                   BYTE 2  SUBPOOL ID                                  00368202
*                   BYTE 3  FLAGS AS FOLLOWS:                           00369002
*                     BITS 0-4    RESERVED, SET TO 0                    00370002
*                     BIT 5       = 0  DOUBLEWORD BOUNDARY              00371002
*                                 = 1  PAGE BOUNDARY                    00372002
*                     BIT 6       = 0  CONDITIONAL REQUEST              00373002
*                                 = 1  UNCONDITIONAL REQUEST            00374002
*                     BIT 7       = 0  GETMAIN                          00375002
*                                 = 1  FREEMAIN                         00376002
*        REG  4     ADDRESS OF TCB UNDER WHICH STORAGE IS TO BE         00377002
*                   ALLOCATED                                           00378002
*        REG  7     ADDRESS OF ASCB                                     00379002
*        REG 14     RETURN ADDRESS                                      00380002
*                                                                       00381002
*02*     OUTPUT = FOR A GETMAIN, REGISTER 1 CONTAINS THE ADDRESS OF     00382002
*        THE STORAGE ALLOCATED; FOR A FREEMAIN, NONE                    00383002
*                                                                       00384002
*02*     REGISTERS-SAVED = ALL REGISTERS EXCEPT 7                       00385003
*                                                                       00386002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 1, 7 AND 15 IF       00387003
*        GETMAIN AND ALL REGISTERS EXCEPT 7 AND 15 IF FREEMAIN          00387503
*                                                                       00389002
*01*  ENTRY-POINT = GLBRANCH                                            00390002
*                                                                       00391002
*02*     PURPOSE = REGISTER TYPE GETMAIN OR FREEMAIN FOR GLOBAL         00392002
*        SUBPOOLS WITHOUT LOCAL MEMORY LOCK (SALLOC LOCK REQUIRED),     00393002
*        BRANCH ENTRY                                                   00394002
*                                                                       00395002
*02*     LINKAGE = CALLED BY RC OR RU FORMS OF GETMAIN OR FREEMAIN      00396002
*        MACRO WITH BRANCH AND GLOBAL OPTIONS SPECIFIED                 00397002
*                                                                       00398002
*02*     INPUT =                                                        00399002
*        REG  0     NUMBER OF BYTES REQUESTED                           00400002
*        REG  1     ZERO FOR A GETMAIN, ADDRESS TO BE FREED FOR A       00401002
*                   FREEMAIN                                            00402002
*        REG  3     BYTE 0  RESERVED, SET TO 0                          00403002
*                   BYTE 1  PROTECT KEY FOR SUBPOOLS 231 AND 241        00404002
*                   BYTE 2  SUBPOOL ID                                  00404202
*                   BYTE 3  FLAGS AS FOLLOWS:                           00405002
*                     BITS 0-4    RESERVED, SET TO 0                    00406002
*                     BIT 5       = 0  DOUBLEWORD BOUNDARY              00407002
*                                 = 1  PAGE BOUNDARY                    00408002
*                     BIT 6       = 0  CONDITIONAL REQUEST              00409002
*                                 = 1  UNCONDITIONAL REQUEST            00410002
*                     BIT 7       = 0  GETMAIN                          00411002
*                                 = 1  FREEMAIN                         00412002
*        REG  4     ADDRESS OF GLOBAL SAVE AREA                         00413002
*        REG 14     RETURN ADDRESS                                      00414002
*                                                                       00415002
*02*     OUTPUT = FOR A GETMAIN, REGISTER 1 CONTAINS THE ADDRESS OF     00416002
*        THE STORAGE ALLOCATED; FOR A FREEMAIN, NONE                    00417002
*                                                                       00418002
*02*     REGISTERS-SAVED = ALL REGISTERS                                00419002
*                                                                       00420002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 1 AND 15 IF GETMAIN  00421002
*        AND ALL REGISTERS EXCEPT 15 IF FREEMAIN                        00421202
*                                                                       00422002
*01*  ENTRY-POINT = CBBRANCH                                            00423003
*                                                                       00424002
*02*     PURPOSE = SPECIAL ENTRY TO THE INTERNAL GETMAIN (GETMAINC)     00425003
*        OR FREEMAIN (FMAINC) ROUTINES TO GET OR FREE  A CELL FOR       00426003
*        A VSM CONTROL BLOCK.                                           00427003
*                                                                       00427503
*02*     LINKAGE = CALLED VIA A BRANCH ENTRY WITH LOCAL LOCK HELD       00428003
*                                                                       00430002
*02*     INPUT =                                                        00431002
*        REG  0     SPID IN BYTE 0 FOR GETMAIN REQUEST                  00432003
*        REG  1     NEGATIVE FOR GETMAIN                                00434003
*                   POSITIVE FOR FREEMAIN, ADDRESS OF CELL TO BE FREED  00435003
*        REG  7     ASCB ADDRESS                                        00436003
*        REG 14     RETURN ADDRESS                                      00437002
*        REG 15     ENTRY ADDRESS (CBBRANCH)                            00438203
*                                                                       00439202
*        LENGTH IS IMPLIED (EQUAL TO VSM CB LENGTH - 16 BYTES).         00439403
*        CELL IS ZEROED BY GETMAIN BEFORE RETURNING TO CALLER.          00439503
*                                                                       00439603
*02*     OUTPUT = ADDRESS OF CELL ALLOCATED IN REGISTER 1               00439903
*                                                                       00440002
*02*     REGISTERS-SAVED = 2-6, 8-14, (7 IS DESTROYED)                  00441003
*                                                                       00442002
*02*     REGISTERS-RESTORED = ALL REGISTERS EXCEPT 0, 1, 7 AND 15       00443003
*                                                                       00445002
*01*  ENTRY-POINT = GETMAING                                            00445203
*                                                                       00445403
*02*     PURPOSE = SPECIAL ENTRY TO THE INTERNAL GETMAIN ROUTINE        00445603
*        (GETMAINB) TO GET SPACE IN SQA OR LSQA FOR A CONTROL BLOCK     00446003
*                                                                       00457003
*        LINKAGE = CALLED BY GETPART (MODULE IEAVPRT0) VIA BRANCH       00462003
*        ENTRY, WITH LOCAL MEMORY LOCK HELD                             00467003
*                                                                       00467103
*02*     INPUT =                                                        00469203
*        REG  1     SUBPOOL ID IN BYTE ZERO AND LENGTH OF REQUEST       00469403
*                   IN BYTES 1 TO 3                                     00471003
*        REG  4     LDA ADDRESS                                         00472003
*        REG  8     FIRST BASE REGISTER                                 00473003
*        REG 13     SECOND BASE REGISTER                                00474003
*        REG 14     RETURN ADDRESS                                      00475003
*        REG 15     ENTRY ADDRESS (GETMAING)                            00476003
*                                                                       00477003
*02*     OUTPUT = ADDRESS OF ALLOCATED STORAGE IN REGISTER 1            00479003
*                                                                       00480003
*02*     REGISTERS SAVED = ALL REGISTERS                                00481003
*                                                                       00482003
*02*     REGISTERS RESTORED = ALL REGISTERS EXCEPT REGISTER 1           00483003
*                                                                       00484003
*01*  ENTRY-POINT = MRELEASF                                            00485003
*                                                                       00486003
*02*     PURPOSE = SPECIAL ENTRY TO THE INTERNAL ROUTINE THAT           00487003
*        RETURNS FREED STORAGE TO AN FBQE (MRELEASE), TO RETURN V=R     00489003
*        REGION SPACE TO SYSTEM V=R PQE AND ADDRESS SPACE PQE           00510003
*                                                                       00511003
*02*     LINKAGE = CALLED BY FREEPART (MODULE IEAVPRT0) VIA A BRANCH    00521003
*        ENTRY, WITH LOCAL MEMORY LOCK HELD                             00532003
*                                                                       00542003
*02*     INPUT =                                                        00563003
*        REG  4     LDA ADDRESS                                         00564003
*        REG  6     SIZE OF AREA TO BE RETURNED TO AN FBQE              00584203
*        REG  7     ADDRESS OF PQE THAT STORAGE WAS OBTAINED FROM       00585003
*        REG  8     FIRST BASE REGISTER                                 00595003
*                                                                       00610603
*        REG  9     ADDRESS OF AREA BEING RETURNED TO AN FBQE           00616003
*        REG 13     SECOND BASE REGISTER                                00617003
*        REG 14     RETURN ADDRESS                                      00627003
*        REG 15     ENTRY ADDRESS (MRELEASF)                            00638003
*                                                                       00648003
*        IN ADDITION THE SUBPOOL ID WHICH IS TO BE USED IN OBTAINING    00669003
*        AN FBQE MUST BE PRE-STORED IN THE FIELD LDACBSP IN THE LDA     00670003
*                                                                       00680003
*02*     OUTPUT = NONE                                                  00691003
*                                                                       00701003
*02*     REGISTERS-SAVED = REGISTERS 2 TO 15                            00722003
*                                                                       00723003
*02*     REGISTERS-RESTORED = REGISTERS 2 TO 15                         00733003
*                                                                       00743003
*01*  ENTRY-POINT = MRELEASR                                            00753003
*                                                                       00763003
*02*     PURPOSE = SPECIAL ENTRY TO THE INTERNAL ROUTINE THAT           00773003
*        RETURNS FREED STORAGE TO AN FBQE (MRELEASE), TO RETURN ONE     00783003
*        PAGE OF REGION OR CSA SPACE THAT WAS PREVIOUSLY IN DEFERRED    00793003
*        RELEASE STATUS                                                 00803003
*                                                                       00813003
*02*     LINKAGE = CALLED BY THE RSM PAGE RELEASE ROUTINE (MODULE       00823003
*        IEAVRELS) VIA A BRANCH ENTRY WITH THE SALLOC LOCK HELD.  IN    00833003
*        ADDITION THE LOCAL MEMORY LOCK WILL BE HELD ON ENTRIES TO      00843003
*        RELEASE LOCAL STORAGE.                                         00853003
*                                                                       00863003
*02*     INPUT =                                                        00873003
*        REG  0     = 0 FOR LOCAL STORAGE; LDA WILL BE USED FOR THE     00883003
*                   WORK AREA                                           00893003
*                   = 1 FOR GLOBAL STORAGE; GLOBAL SAVE AREA WILL BE    00903003
*                   USED FOR THE WORK AREA                              00913003
*        REG  1     VIRTUAL ADDRESS OF THE PAGE TO BE RETURNED TO AN    00923003
*                   FBQE                                                00933003
*        REG 14     RETURN ADDRESS                                      00943003
*        REG 15     ENTRY ADDRESS (MRELEASR)                            00953003
*                                                                       00963003
*02*     OUTPUT = NONE                                                  00973003
*                                                                       00983003
*02*     REGISTERS-SAVED = REGISTERS 0 TO 14                            00993003
*                                                                       01003003
*02*     REGISTERS-RESTORED = REGISTERS 0 TO 14                         01013003
*                                                                       01023003
*01*  EXIT-NORMAL = NO NAME                                             01033003
*                                                                       01043003
*02*     CONDITIONS = SUCCESSFUL GETMAIN OR FREEMAIN, RETURN TO ADDRESS 01053003
*        IN REGISTER 14                                                 01063003
*                                                                       01073003
*02*     OUTPUT = ADDRESS OF STORAGE OBTAINED FOR A GETMAIN REQUEST IN  01083003
*        THE PARAMETER LIST FOR A STORAGE TYPE REQUEST OR IN REGISTER 1 01093003
*        FOR A REGISTER TYPE REQUEST.                                   01103003
*                                                                       01113003
*02*     RETURN-CODES = REGISTER 15 WILL HAVE A RETURN CODE OF 0        01123003
*        INDICATING SUCCESSFUL COMPLETION OF REQUEST                    01133003
*                                                                       01143003
*01*  EXIT-ERROR = NO NAME                                              01153003
*                                                                       01163003
*02*     CONDITIONS = UNSUCCESSFUL CONDITIONAL GETMAIN OR FREEMAIN,     01173003
*        RETURN TO ADDRESS IN REGISTER 14                               01183003
*                                                                       01193003
*02*     OUTPUT = NONE                                                  01203003
*                                                                       01213003
*02*     RETURN-CODES = REGISTER 15 WILL HAVE A RETURN CODE OF 4 IN ALL 01223003
*        CASES EXCEPT THE FOLLOWING:                                    01233003
*                                                                       01243003
*        ON A GETMAIN FOR SQA OR LSQA IF A REAL PAGE IS NOT AVAILABLE   01253003
*        A RETURN CODE OF 8 WILL BE GIVEN.                              01263003
*                                                                       01273003
*        ON A FREEMAIN OF A LOCAL STORAGE PAGE THAT IS STILL FIXED,     01283003
*        IF THE TCBEOTFM FLAG IS ON A RETURN CODE OF 8 WILL BE GIVEN.   01293003
*                                                                       01303003
*01*  EXIT-ERROR = ABEND                                                01313003
*                                                                       01323003
*02*     CONDITIONS = UNSUCCESSFUL UNCONDITIONAL GETMAIN OR FREEMAIN OR 01333003
*        A PARAMETER ERROR FOR A CONDITIONAL GETMAIN OR FREEMAIN. ABEND 01343003
*        MACRO IS EXECUTED.                                             01353003
*                                                                       01363003
*02*     OUTPUT = NONE                                                  01373003
*                                                                       01383003
*02*     RETURN-CODES = NONE                                            01393003
*                                                                       01403003
*01*  EXTERNAL-REFERENCES:                                              01413003
*                                                                       01423003
*02*     ROUTINES =                                                     01433003
*                                                                       01443003
*        ABEND     ABNORMAL TERMINATION, MACRO USED                     01453003
*        IEAVCSEG  CREATE SEGMENT, BRANCH ENTRY                         01463003
*        IEAVFP1   FIND PAGE, BRANCH ENTRY                              01473003
*        IEAVPRT0  GETPART/FREEPART, BRANCH ENTRY                       01483003
*        IEAVRELV  RELEASE PAGE, BRANCH ENTRY                           01493003
*        IEAVSQA   OBTAIN FIXED PAGE FOR L/SQA, BRANCH ENTRY            01503003
*        IEA0VL00  VALIDITY CHECK ROUTINE, BRANCH ENTRY                 01513003
*        IEA0VL01  VALIDITY CHECK ROUTINE, BRANCH ENTRY                 01523003
*        IGFPTERM  SYSTEM TERMINATION ROUTINE, BRANCH ENTRY             01533003
*        SETFRR    SET FUNCTIONAL RECOVERY ROUTINE, MACRO USED          01543003
*        SETLOCK   OBTAIN AND RELEASE LOCKS, MACRO USED                 01553003
*        SYSEVENT  INFORM SRM OF SQA AVAILABILITY, MACRO USED           01563003
*        TESTAUTH  CHECK CALLER AUTHORIZATION, MACRO USED               01573003
*                                                                       01583003
*02*     DATA-AREAS =                                                   01593003
*                                                                       01603003
*        GLOBAL DATA AREA (GDA) CONTAINS GLOBAL STORAGE POINTERS.       01613003
*                                                                       01623003
*        LOCAL DATA AREA (LDA) CONTAINS LOCAL STORAGE POINTERS AND      01633003
*        IS USED AS WORK AREA SO THAT THIS ROUTINE IS REFRESHABLE.      01643003
*                                                                       01653003
*        GETMAIN/FREEMAIN GLOBAL SAVE AREA USED IN PLACE OF LDA AS A    01663003
*        WORK AREA ON CERTAIN GLOBAL STORAGE REQUESTS.                  01673003
*                                                                       01683003
*        FRR PARAMETER AREA (6 WORDS) USED FOR COMMUNICATION WITH FRR.  01693003
*                                                                       01703003
*02*     CONTROL-BLOCKS =                                               01713003
*                                                                       01723003
*        CVT       (R)                                                  01733003
*        IEFTCT    (W)                                                  01743003
*        IHAAQE    (C) (D)                                              01753003
*        IHAASCB   (R)                                                  01763003
*        IHADQE    (C) (D)                                              01773003
*        IHAFBQE   (C) (D)                                              01783003
*        IHAFQE    (C) (D)                                              01793003
*        IHAFRRS   (R)                                                  01803003
*        IHAGDA    (W)                                                  01813003
*        IHAINF    (W)                                                  01823003
*        IHALDA    (W)                                                  01833003
*        IHAPGTE   (W)                                                  01843003
*        IHAPQE    (W)                                                  01853003
*        IHAPSA    (R)                                                  01863003
*        IHAPVT    (W)                                                  01873003
*        IHARB     (R)                                                  01883003
*        IHARVT    (R)                                                  01893003
*        IHASPQE   (C)                                                  01903003
*        IHAWSAVT  (R)                                                  01913003
*        IHAXPTE   (W)                                                  01923003
*        IKJTCB    (W)                                                  01933003
*                                                                       01943003
*01*  TABLES = AT LABEL RCTABLE IS A RETURN CODE VERSUS ERROR CODE      01953003
*     TABLE FOR CONVERTING ANY ERROR CODE TO THE APPROPRIATE RETURN     01963003
*     CODE                                                              01973003
*                                                                       01983003
*01*  MACROS =                                                          01993003
*                                                                       02003003
*        ABEND                                                          02013003
*        MODID                                                          02023003
*        SETFRR                                                         02033003
*        SETLOCK                                                        02043003
*        SYSEVENT                                                       02053003
*        TESTAUTH                                                       02063003
*        WTO                                                            02073003
*                                                                       02083003
*02*    SERIALIZATION = THE SALLOC LOCK IS SOMETIMES OBTAINED AND       02093003
*       RELEASED BY THIS MODULE                                         02103003
*                                                                       02113003
*01*  CHANGE-ACTIVITY = SIGNIFICANT CHANGES TO THIS MODULE (ANY CHANGE  02123003
*     OTHER THAN A COMMENT) OVER THE OS/VS2 RELEASE 1 VERSION ARE       02133003
*     FLAGGED WITH THE FOLLOWING S/D CODES Y02711, Y02714, Y02751,      02143003
*     Y02753                                                            02153003
*                                                                       02163003
*     APARS = OZ00829 (2) 456772-456776, 456816-456836                  02163540
*             OZ05196 (2) 327241                                        02164040
*             OZ02359 (2) 218055-218073                                 02164840
*             OZ03280 (3) 496520                                        02166440
*             OZ04815 (2) 355552-355576                                 02168140
*             OZ05954 (2) 196641                                        02168340
*             OZ08170 (3) 516500, 517000, 517704, 5178400-517960        02168540
*                         518420-518600, 523040-523046, 523049          02169040
*                         523052-523091                                 02169840
*             OZ09199 (2) 167742-167762                                 02170640
*             OZ10820 (4) 517620                                        02171040
*             OZ11822 (3) 237440-237560, 492646-492663,                 02171140
*                         492912-492918, 700297                         02171240
*             OZ14231 (3) 317100                                        02171340
*             OZ16417 (3) 471586-471587, 473710-473730                  02171540
*             OZ17759 (3) 287400, 288200-288340                         02171840
*             OZ17804 (3) 161960-163460                                 02172040
*             OZ20641 (3)                                               02172140
*             OZ20951 (3)                                               02172240
*             OZ27672 (3)                                               02172340
*             OZ29442 (3)                                               02172440
*             OZ29616 (3)                                               02172540
*             OZ30210 (3)                                               02172640
*             OZ27466 (3)                                               02172740
*                                                                       02172840
*01*  MESSAGES = IEA946W, ISSUED JUST BEFORE TERMINATING SYSTEM WHEN    02173003
*     THERE IS NO VIRTUAL OR REAL STORAGE AVAILABLE FOR SQA             02183003
*                                                                       02193003
*01*  ABEND-CODES =                                                     02203003
*                                                                       02213003
*        ABEND CODE     REASON  RETURN         DESCRIPTION              02223003
*                        CODE    CODE *                                 02233003
*                                                                       02243003
*        104, 10A, 178   NONE     8    CANNOT OBTAIN REAL PAGE OF       02253003
*                                      STORAGE FOR SQA OR LSQA          02263003
*        305, 30A, 378     1      4    STORAGE NOT IN SPECIFIED SUBPOOL 02273003
*                                      (NO DQE FOUND FOR SPECIFIED      02283003
*                                      STORAGE AREA)                    02293003
*                          2      4    SPECIFIED SUBPOOL COULD NOT BE   02303003
*                                      FOUND                            02313003
*                          4     NONE  ZERO LENGTH NOT SPECIFIED FOR    02323003
*                                      SUBPOOL FREEMAIN                 02333003
*        40A, 478          0     NONE  SUBPOOL FREEMAIN FOR SQA, CSA,   02343003
*                                      SUBPOOLS 254 OR 255, OR INVALID  02353003
*                                      SUBPOOL; OR PROBLEM PROGRAM      02363003
*                                      FREEING SUBPOOL 0                02373003
*        504, 505          0     NONE  LENGTH AND ADDRESS LISTS OVERLAP 02383003
*        604, 605          1     NONE  PARAMETER LIST NOT IN PROBLEM    02393003
*                                      PROGRAM AREA, NOT ON WORD        02403003
*                                      BOUNDARY, OR LIST ADDRESS NOT    02413003
*                                      VALID  @                         02423003
*        804, 80A, 878     1      4    NOT ENOUGH VIRTUAL STORAGE       02433003
*                          2     NONE  NEGATIVE LENGTH FOR GETMAIN      02443003
*        905, 90A, 978     0     NONE  ADDRESS NOT MULTIPLE OF 8        02453003
*        A05, A0A, A78     1      4    AREA BEING FREED OVERLAPS A      02463003
*                                      FREE AREA                        02473003
*                          2      8 #  PART OF AREA BEING FREED IS      02483003
*                                      STILL FIXED                      02493003
*        B04, B05, B0A,    0     NONE  PROBLEM PROGRAM REQUESTS SUB-    02503003
*        B78                           POOL 128 TO 255 OR AUTHORIZED    02513003
*                                      PROGRAM REQUESTS INVALID         02523003
*                                      SUBPOOL                          02533003
*        D05, D0A, D78     0      4    NO AQE WHEN THERE SHOULD BE      02543003
*                                      ONE (LSQA NOT OWNED BY           02553003
*                                      REQUESTING TASK)                 02563003
*                                                                       02573003
*        *     RETURN CODE FOR CONDITIONAL REQUESTS.  THE ENTRY         02583003
*              "NONE" MEANS THE REQUEST WILL BE ABENDED EVEN OF IT      02593003
*              IS CONDITIONAL.                                          02603003
*        @     FOR A REQUEST IN KEY 0-7 OR FOR A BRANCH ENTRY THESE     02613040
*              CHECKS ARE BYPASSED.                                     02623003
*        #     FOR A CONDITIONAL REQUEST WITH "TCBEOTFM" BIT IN         02633003
*              TCB, OR LDAFPFM BIT IN LDA, SET TO 1, THIS ERROR         02634040
*              WILL GIVE A RETURN CODE OF 8.  OTHERWISE IT WILL         02635040
*              BE ABENDED.                                              02637040
*                                                                       02663003
*01*  MESSAGE-SYMBOL = STRWTO FOR MESSAGE IEA946W                       02673003
*                                                                       02683003
         EJECT                                                          02693003
*        INPUT PARAMETER LIST                                           02703003
*                                                                       02713003
*                                                                       02723003
*    TO GETMAIN (SVC 4)                                                 02733003
*                                                                       02743003
*        REGISTER 1 = ADDRESS OF A PARAMETER LIST                       02753003
*                                                                       02763003
*                                                                       02773003
*    TO FREEMAIN (SVC 5)                                                02783003
*                                                                       02793003
*        REGISTER 1 = ADDRESS OF A PARAMETER LIST                       02803003
*                                                                       02813003
*                                                                       02823003
*    PARAMETER LIST FORMAT                                              02833003
*                                                                       02843003
*              ********************************************             02853003
*              * LENGTH REQUESTED IF SINGLE AREA REQUEST  *             02863003
*              *  OR ADDRESS OF A LIST OF LENGTHS         *             02873003
*              ********************************************             02883003
*              * ADDRESS OF A LIST IN WHICH THE ADDRESSES *             02893003
*              *  OF ALLOCATED AREAS IS TO BE RETURNED    *             02903003
*              ********************************************             02913003
*              * CODE     * SUBPOOL  *                                  02923003
*              *          *   ID     *                                  02933003
*              ***********************                                  02943003
*                                                                       02953003
*          CODE VALUES                                                  02963003
*              X'00' - UNCONDITIONAL SINGLE ELEMENT REQUEST             02973003
*              X'20' - CONDITIONAL     ''     ''      ''                02983003
*              X'C0' - UNCONDITIONAL VARIABLE REQUEST                   02993003
*              X'E0' - CONDITIONAL      ''      ''                      03003003
*              X'80' - UNCONDITIONAL LIST REQUEST                       03013003
*              X'A0' - CONDITIONAL    ''    ''                          03023003
*              X'10' - PAGE BOUNDARY REQUEST (THIS MAY BE IN            03033003
*                      ADDITION TO THOSE ABOVE)                         03043003
         EJECT                                                          03053003
*    LIST FORMATS                                                       03063003
*                                                                       03073003
*        SINGLE ELEMENT REQUEST                                         03083003
*                                                                       03093003
*           AREA LIST                                                   03103003
*              ********************************************             03113003
*              *          * ADDRESS OF AREA ALLOCATED     *             03123003
*              ********************************************             03133003
*                                                                       03143003
*        VARIABLE REQUEST                                               03153003
*                                                                       03163003
*           LENGTH LIST                                                 03173003
*              ********************************************             03183003
*              *    0     * MINIMUM LENGTH REQUESTED      *             03193003
*              ********************************************             03203003
*              *    0     * MAXIMUM LENGTH REQUESTED      *             03213003
*              ********************************************             03223003
*                                                                       03233003
*           AREA LIST                                                   03243003
*              ********************************************             03253003
*              *          * ADDRESS OF AREA ALLOCATED     *             03263003
*              ********************************************             03273003
*              *          * ACTUAL LENGTH ALLOCATED       *             03283003
*              ********************************************             03293003
*                                                                       03303003
*        LIST REQUEST                                                   03313003
*                                                                       03323003
*           LENGTH LIST                                                 03333003
*              ********************************************             03343003
*              * SIGN = 0 * FIRST LENGTH REQUESTED        *             03353003
*              ********************************************             03363003
*              * SIGN = 0 * SECOND LENGTH REQUESTED       *             03373003
*              ********************************************             03383003
*              /                                          /             03393003
*              ********************************************             03403003
*              * SIGN = 1 * LAST LENGTH REQUESTED         *             03413003
*              ********************************************             03423003
*                                                                       03433003
*           AREA LIST                                                   03443003
*              ********************************************             03453003
*              *          * ADDR OF AREA FOR FIRST LENGTH *             03463003
*              ********************************************             03473003
*              *          * ADDR OF AREA FOR SECOND LENGTH*             03483003
*              ********************************************             03493003
*              /                                          /             03503003
*              ********************************************             03513003
*              *          * ADDR OF AREA FOR LAST LENGTH  *             03523003
*              ********************************************             03533003
*                                                                       03543003
**** END OF SPECIFICATIONS ***/                                         03553003
         EJECT                                                   Y02714 03743002
IEAVGM00 CSECT                                                          15582002
         ENTRY IGC004                                                   15583002
         ENTRY IGC005                                                   15584002
         ENTRY IGC010                                                   15585002
         ENTRY IGC120                                            Y02714 15586002
         ENTRY GMBRANCH                                                 15587002
         ENTRY FMBRANCH                                                 15588002
         ENTRY RMBRANCH                                                 15589002
         ENTRY CRBRANCH                                          Y02714 15589202
         ENTRY GLBRANCH                                          Y02714 15589402
         ENTRY MRELEASF                                          Y02714 15589602
         ENTRY MRELEASR                                          Y02714 15589802
         ENTRY CBBRANCH                                        @Z30ENWD 15589903
         ENTRY QCBRANCH                                                 15590602
         ENTRY GETMAING                                          Y02714 15590703
         ENTRY PLISTERR                                        @ZA20641 15590840
         EJECT                                                          15590940
*********************************************************************** 15591302
*                                                                       15592002
*        GETMAIN/FREEMAIN ENTRY POINT                                   15600002
*                                                                       15620001
*                                                                       15640001
*        ENTRY POINT FOR SVC 4 & 5                                      15650002
*                                                                       15660001
*        THIS ROUTINE CHECKS THE PARAMETER LIST AND ALL ENTRIES         15700001
*            POINTED TO BY THE PARAMETER LIST TO INSURE THAT THEY       15705040
*            ARE ON WORD BOUNDARIES, AND THAT ALL ENTRIES ARE ON        15710040
*            GETMAIN ASSIGNED PAGES.  ADDITIONALLY, THE ADDRESS LIST    15720040
*            IS CHECKED TO INSURE THAT IT IS IN THE USER'S STORAGE      15730040
*            KEY.  THE PARAMETER AND LENGTH LISTS ARE NOT CHECKED       15740040
*            FOR STORAGE KEY SINCE THEY ARE READ ONLY TO IEAVGM00.      15750040
*            NO VALIDITY CHECKING IS PERFORMED FOR INTERFACES           15760040
*            SUPPLIED BY KEY 0-7 CALLERS.                      @ZA20641 15770040
*                                                                       15800001
*        NOTE:  AN ENTRY ON A PAGE THAT IS NOT GETMAIN ASSIGNED WILL    15801040
*               CAUSE A PROGRAM INTERRUPT CODE X'10' OR X'11' TO        15802040
*               OCCUR WHEN THAT ENTRY IS REFERENCED.  MODULE IEAVGFRR   15803040
*               WILL GET CONTROL IN SUCH CASES AND WILL RETRY BACK      15804040
*               INTO IEAVGM00 AT LABEL PLISTERR TO COMPLETE PROCESSING  15805040
*               FOR THE ERROR CONDITION.                       @ZA20641 15806040
*                                                                       15807040
*********************************************************************** 15810002
         SPACE 2                                                 Y02714 15822002
         MODID BR=NO                                             Y02714 15824002
         SPACE 2                                                 Y02714 15826002
         USING PSA,0               ADDRESSABILITY FOR LOW STOR.  Y02714 15828002
         USING TCB,RTCB1                                         Y02714 15830002
         SPACE 2                                                        15840001
IGC005   DS    0H      IGC004 AND IGC005 HAVE SAME ENTRY POINT   Y02714 15850002
IGC004   BALR  RBASE1,0            SET UP BASE REGISTER          Y02714 15860002
         USING *,RBASE1            ESTABLISH PRELIMINARY BASE    Y02714 15900002
         USING ASCB,RASCB                                        Y02714 15939402
GMBASE   L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 15939502
         USING LDA,RASCB                                         Y02714 15939602
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 15939702
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 15939802
         DROP  RASCB                                             Y02714 15948002
         USING LDA,RLDA                                          Y02714 15952002
         ST    RRETURN,RETSAVE     SAVE RETURN ADDRESS                  15962002
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 15963002
         LR    SAVEPARM,RIN1       SAVE PARAMETER PTR                   15988802
         ST    RIN1,SAVEREG1       SAVE FOR RESTORE ON EXIT      Y02714 15990802
         LA    RRBPRXLN,RBPRFLNA   GET PREFIX LENGTH             Y02714 15998802
         SR    RRB,RRBPRXLN        GET BASE FOR RB INCLUDING PREFIX     15998902
         USING RBPRFXST,RRB        SET ADDRESSABILITY TO RB PREFIX      15999002
         SR    RFLAGWD,RFLAGWD     CLEAR REGISTER                Y02714 15999202
         ICM   RFLAGWD,M2,RBINTCOD+C1  GET SVC TYPE              Y02714 16009602
         IC    RFLAGWD,RBOPSW+C1   GET KEY                       Y02714 16020002
         DROP  RRB                                               Y02714 16030002
         SR    INDEX,INDEX         CLEAR INDEX REGISTER                 16160001
         LA    RIN0,KEY0           GET KEY 0 MASK                       16190001
         NR    RIN0,RFLAGWD        KEY FOR VALIDITY CHECK BYPASS Y02714 16192002
         STC   RIN0,RQSTRKEY       SAVE KEY                      Y02714 16194002
         MVC   CODE1,CODE(RIN1)    SAVE OPTION CODE            @ZA20641 16196040
         TM    RQSTRKEY,CX80       KEY 0-7 ?                   @ZA20641 16206040
         BZ    AUTHUSER            YES, SKIP VALIDITY CHECKS   @ZA20641 16216040
         OI    PARMFLG1(R2),PARMVLCK VALIDITY CK BEING DONE    @ZA20641 16226040
         BAL   RVALRET,CHECKWB     CHECK BOUNDARY ALIGNMENT    @ZA20641 16276040
         LM    RLENGTH,RADDR,C0(SAVEPARM) GET LENGTH AND ADDRESS PTRS   16316040
         LR    RIN1,RADDR          GET ADDRESS OF 1ST ADDR ENTRY        16336040
         L     RVALBASE,VALIDCK1   GET IEA0VL01 ENTRY ADDRESS  @ZA20641 16356040
         BAL   RVALRET,CHEKEY1     CK KEY/WB OF 1ST ADDR ENTRY @ZA20641 16376040
         TM    C8(SAVEPARM),LISTVAR ELEMENT REQUEST?           @ZA20641 16396040
         BZ    ENDCHECK            YES, PREPARE TO EXIT        @ZA20641 16416040
         LR    RIN1,RLENGTH        GET LENGTH LIST START ADDR  @ZA20641 16436040
         BO    VARIABLE            NO, VARIABLE REQUEST        @ZA20641 16456040
         BAL   RVALRET,CHECKWB     CHECK BOUNDARY ALIGNMENT    @ZA20641 16476040
         LR    PARMREG,RLENGTH     GET LENGTH LIST START ADDR  @ZA20641 16496040
CHECK5   TM    C0(PARMREG),CX80    IS THIS THE LAST ENTRY?       Y02714 16516040
         BO    LISTEND             YES, SAVE ITS ADDRESS       @ZA20641 16536040
         LA    INDEX,C4(INDEX)     INCREMENT INDEX             @ZA20641 16556040
         LA    PARMREG,C0(INDEX,RLENGTH) GET LENGTH ENTRY ADDR @ZA20641 16606040
         LA    RIN1,C0(INDEX,RADDR) GET ADDRESS ENTRY ADDRESS           16616040
         L     RVALBASE,VALIDCK0   GET IEA0VL00 ENTRY ADDRESS  @ZA20641 16626040
         BAL   RVALRET,CHEKEY1     CK KEY OF NTH ADDRESS ENTRY @ZA20641 16636040
         B     CHECK5              GO CHECK FOR END OF LIST    @ZA20641 16752640
         SPACE 2                                                        16753240
VARIABLE LA    RIN15,SV5           SVC 5 COMPARISON VALUE        Y02714 16755640
         LR    SVTYPE,RFLAGWD      GET FLAGWORD                  Y02714 16756240
         SRL   SVTYPE,C8           ISOLATE SVC TYPE              Y02714 16756840
         CR    SVTYPE,RIN15        SVC 5 (FREEMAIN) ?                   16757440
         BE    OUTLNTH             YES, SKIP LENGTH LIST CHECK @ZA20641 16758040
         BAL   RVALRET,CHECKWB     CHECK BOUNDARY ALIGNMENT    @ZA20641 16758840
         LM    RMIN,RMAX,C0(RIN1)  REFERENCE LENGTH LIST       @ZA20641 16759640
OUTLNTH  LA    RIN1,C4(RADDR)      GET OUTPUT LENGTH ENTRY     @ZA20641 16760440
         L     RVALBASE,VALIDCK0   GET IEA0VL00 ENTRY ADDRESS  @ZA20641 16761240
         BAL   RVALRET,CHEKEY1     CK KEY OF OUTPUT LNTH ENTRY @ZA20641 16762040
         B     ENDCHECK            PREPARE TO EXIT             @ZA20641 16762840
         SPACE 2                                                        16764840
AUTHUSER SR    RWORK,RWORK         CALCULATE                   @ZA20641 16765840
         BCTR  RWORK,C0              THE LARGEST               @ZA20641 16766040
         SRL   RWORK,C1                POSITIVE NUMBER         @ZA20641 16766240
         ST    RWORK,LASTLSTA      END OF LIST FOR AUTH USERS  @ZA20641 16766440
         B     CHECKTYP            PREPARE TO EXIT             @ZA20641 16766840
         SPACE 2                                                        16767840
CHECKWB  LA    RWORK,FWBMASK       FULL WORD BOUNDARY MASK     @ZA20641 16787040
         NR    RWORK,RIN1          ADDR ON FULL WORD BOUNDARY? @ZA20641 16787140
         BZR   RVALRET             YES, RETURN                 @ZA20641 16787840
         B     PLISTERR            NO, PARAMETER ERROR         @ZA09199 16787940
         SPACE 2                                                        16788040
LISTEND  ST    PARMREG,LASTLSTA    SAVE ADDR LAST LIST ENTRY   @ZA20641 16788140
         SR    RLENGTH,RADDR       GET NUMBER OF BYTES BETWEEN @ZA20641 16788240
         BNM   CKOVLAP1            STARTING ADDRESSES                   16788302
         LCR   RLENGTH,RLENGTH     OF LISTS                             16789602
CKOVLAP1 LA    INDEX,C4(INDEX)     INCREMENT INDEX                      16790902
         SR    RLENGTH,INDEX       DO LISTS OVERLAP?                    16792202
         LA    RERROR,ERR5         SET UP ERROR CODE           @Z30ENWD 16793503
         MVI   MSGLEN,C4           REASON CODE 0 - LENGTH 4             16794802
         BM    LSTOVLAP            YES                                  16796102
         SPACE 2                                                        16797402
ENDCHECK L     R2,FRRPARM          GET ADDR OF FRR PARM AREA   @ZA20641 16800040
         NI    PARMFLG1(R2),ALL-PARMVLCK VALIDITY CK FINISHED  @ZA20641 16800340
CHECKTYP LM    RLENGTH,RADDR,C0(SAVEPARM) LENGTH AND ADDR PTRS @ZA20641 16800640
         LR    RIN1,SAVEPARM       RESTORE PARAMETER POINTER            16801302
         SR    RSPID,RSPID         INITIALIZE SPID REG                  16811302
         IC    RSPID,SPIDISP(RIN1) GET SPID                             16821302
         ST    RFLAGWD,LDARQSTA    SAVE STATUS FLAGWORD          Y02714 16831302
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 16841302
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 16847702
         USING BASE1,RBASE1                                      Y02714 16848102
         CLI   SVCBYTE,SV5         SVC 5?                        Y02714 16849302
         BE    FMCOMMON            YES - FREEMAIN                Y02714 16849702
         B     GMCOMMON            NO - GETMAIN                         16850102
         SPACE 2                                                        16850502
CHEKEY1  SR    R2,R2               VALIDITY CK RTN NEEDS R2 = 0  Y02714 16861902
         LR    RWORK,RLDA          SAVE LDA POINTER              Y02714 16862302
         L     RTCB,LDATCB         GET TCB ADDRESS               Y02714 16866202
         BALR  RRETURN,RVALBASE    ENTER VALIDITY CHECK ROUTINE  Y02714 16868202
         LR    RLDA,RWORK          RESTORE LDA POINTER           Y02714 16868602
         BZR   RVALRET             VALID PARAMETER, RETURN       Y02714 16869002
*                                  INVALID PARAMETER, ERROR      Y02714 16869402
         SPACE 2                                                        16877902
PLISTERR LA    RERROR,ERR6         SET UP ERROR ADDRESS        @Z30ENWD 16884940
         MVI   MSGLEN,H24          REASON CODE 1 - MSGLEN OF 4          16893602
LSTOVLAP LR    RLENGTH,SAVEPARM    GET PARAMETER LIST POINTER           16894102
         SR    RSPID,RSPID         ZERO SUBPOOL ID SO THAT WHEN STC IS  16894302
*                                  DONE,ONLY PARAMETER LIST POINTER     16896802
*                                  WILL BE GIVEN AS INFO                16899302
         ST    RFLAGWD,LDARQSTA    SAVE FLAGWORD                 Y02714 16904302
         USING GMBASE,RBASE1                                   @ZA20641 16905340
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 16906802
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 16909302
         USING BASE1,RBASE1                                    @Z30ENYF 16910303
         B     GERROR              GO TO ERROR ROUTINE         @Z30ENWD 16911803
         SPACE 2                                                        16914302
VALIDCK0 DC    V(IEA0VL00)         VALIDITY CHECK ROUTINE (KEY)  Y02714 16916802
VALIDCK1 DC    V(IEA0VL01)         VALIDITY CHECK ROUTINE ("+WB) Y02714 16919302
         SPACE 2                                                 Y02714 16921802
         DROP  RBASE1,RLDA                                       Y02714 16924302
         EJECT                                                          16926802
*********************************************************************** 16929302
*                                                                       16929702
*        SVC 4 EQUIVALENT BRANCH ENTRY                                  16930102
*                                                                       16930502
*********************************************************************** 16931302
         SPACE 2                                                 Y02714 16945302
GMBRANCH EQU   *                                                        16951302
         USING ASCB,RASCB                                        Y02714 16961302
         L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 16971302
         USING LDA,RASCB                                         Y02714 16981302
         STM   RIN0,RIN15,BRANCHSV SAVE CALLER'S REGISTERS       Y02714 16991302
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 16993302
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 16995302
         DROP  RASCB                                             Y02714 16997302
         USING LDA,RLDA                                          Y02714 16999302
         BALR  TEMPBASE,0          ESTABLISH TEMPORARY BASE             17001302
         USING *,TEMPBASE                                               17051302
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 17052302
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 17151302
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 17161302
         USING BASE1,RBASE1,RBASE2 SET UP ADDRESSABILITY         Y02714 17201302
         OI    FLAGS,BRENTRY       SET BRANCH ENTRY              Y02714 17281302
         MVI   SVCBYTE,SV4         INDICATE SVC 4                Y02714 17291302
         MVI   RQSTRKEY,C0         SET REQUESTER KEY TO ZERO     Y02714 17341302
         LM    RLENGTH,RADDR,C0(RIN1) GET LENGTH & ADDRESS              17401302
         L     RWORK,LGPOSNUM      SET LAST LIST ADDRESS VERY    Y02714 17411302
         ST    RWORK,LASTLSTA       LARGE SO IT WON'T FAIL       Y02714 17421302
         SR    RSPID,RSPID                                              17451302
         IC    RSPID,SPIDISP(RIN1) GET SUBPOOL ID                       18240002
         MVC   CODE1,CODE(RIN1)    SAVE OPTION CODE              Y02714 18290002
         B     GMCOMMON            GO TO GETMAIN COMMON ROUTINE         18300002
         SPACE 2                                                        18320001
         DROP  RBASE1,RBASE2,RLDA,TEMPBASE                       Y02714 18330002
         EJECT                                                   Y02714 18340002
*********************************************************************** 18342002
*                                                                       18342402
*        SVC 5 EQUIVALENT BRANCH ENTRY                                  18342802
*                                                                       18343202
*********************************************************************** 18344002
         SPACE 2                                                        18350001
FMBRANCH EQU   *                                                        18360001
         USING ASCB,RASCB                                        Y02714 18362002
         L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 18364002
         USING LDA,RASCB                                         Y02714 18366002
         STM   RIN0,RIN15,BRANCHSV SAVE CALLER'S REGISTERS       Y02714 18368002
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 18368402
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 18368802
         DROP  RASCB                                             Y02714 18369202
         USING LDA,RLDA                                          Y02714 18369602
         BALR  TEMPBASE,0          ESTABLISH TEMPORARY BASE             18370002
         USING *,TEMPBASE                                               18400001
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 18401002
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 18420002
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 18430002
         USING BASE1,RBASE1,RBASE2 SET UP ADDRESSABILITY         Y02714 18440002
         OI    FLAGS,BRENTRY       SET BRANCH ENTRY              Y02714 18554002
         MVI   SVCBYTE,SV5         INDICATE SVC 5                Y02714 18556002
         MVI   RQSTRKEY,C0         SET REQUESTER KEY TO ZERO     Y02714 18566002
         LM    RLENGTH,RADDR,C0(RIN1) GET LENGTH & ADDRESS              18600002
         L     RWORK,LGPOSNUM      SET LAST LIST ADDRESS VERY    Y02714 18610002
         ST    RWORK,LASTLSTA       LARGE SO IT WON'T FAIL       Y02714 18612002
         SR    RSPID,RSPID                                              18620001
         IC    RSPID,SPIDISP(RIN1) GET SUBPOOL ID                       18640002
         MVC   CODE1,CODE(RIN1)    SAVE OPTION CODE              Y02714 18710002
         B     FMCOMMON            GO TO FREEMAIN COMMON ROUTINE        18720002
         SPACE 2                                                        18730001
         DROP  RBASE1,RBASE2,RLDA,TEMPBASE                       Y02714 18732002
         EJECT                                                   Y02714 18834302
*********************************************************************** 18834702
*                                                                       18834802
*        SVC 10 EQUIVALENT BRANCH ENTRY                                 18834902
*                                                                       18835002
*********************************************************************** 18835102
         SPACE 2                                                 Y02714 18835902
RMBRANCH EQU   *                                                        18840002
QCBRANCH EQU   *                                                        18848002
         USING ASCB,RASCB                                        Y02714 18850002
         L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 18852002
         USING LDA,RASCB                                         Y02714 18854002
         STM   RIN0,RIN15,BRANCHSV SAVE CALLER'S REGISTERS       Y02714 18854402
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 18854802
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 18855202
         DROP  RASCB                                             Y02714 18855602
         USING LDA,RLDA                                          Y02714 18855702
         BALR  TEMPBASE,0          ESTABLISH TEMPORARY BASE             18856002
         USING *,TEMPBASE          ESTABLISH TEMP ADDRESSABILITY        18864002
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 18865002
         OI    FLAGS,BRENTRY       SET BRANCH ENTRY              Y02714 18970002
         MVI   SVCBYTE,SV10        INDICATE SVC 10               Y02714 18972002
         MVI   RQSTRKEY,C0         SET REQUESTER KEY TO ZERO     Y02714 18982002
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 19010002
         B     SVC10A              CONTINUE                             19040002
         SPACE 2                                                        19050001
         DROP  TEMPBASE,RLDA                                     Y02714 19170002
         SPACE 5                                                        19172002
*********************************************************************** 19174002
*                                                                       19174402
*        SVC 10 ENTRY POINT                                             19174802
*                                                                       19175202
*********************************************************************** 19176002
         SPACE 2                                                        19180002
IGC010   BALR  RBASE1,0            SET UP TEMP ADDRESSABILITY    Y02714 19200002
         USING *,RBASE1                                          Y02714 19220002
         USING ASCB,RASCB                                        Y02714 19282002
         L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 19284002
         USING LDA,RASCB                                         Y02714 19286002
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 19288402
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 19288802
         DROP  RASCB                                             Y02714 19289202
         USING LDA,RLDA                                          Y02714 19289602
         ST    RRETURN,RETSAVE     SAVE RETURN REG                      19289802
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19290802
         LA    RRBPRXLN,RBPRFLNA   GET PREFIX LENGTH             Y02714 19344002
         SR    RRB,RRBPRXLN        GET BASE FOR RB INCL. PREFIX  Y02714 19348002
         USING RBPRFXST,RRB        SET ADDRESSABILITY TO PREFIX  Y02714 19348102
         IC    RWORK,RBOPSW+C1     GET KEY AND MODE              Y02714 19348402
         STC   RWORK,MODE          SAVE IN LDARQSTA              Y02714 19348702
         MVI   SVCBYTE,SV10        INDICATE SVC 10               Y02714 19349002
         STC   RWORK,RQSTRKEY      SAVE REQUESTER KEY            Y02714 19349402
         NI    RQSTRKEY,KEY0       REMOVE MODE FROM KEY          Y02714 19349702
         DROP  RRB                                               Y02714 19350002
         ST    RIN1,SAVEREG1       SAVE FOR RESTORE ON FREEMAIN  Y02714 19350402
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 19352002
         USING BASE1,RBASE1                                      Y02714 19354002
SVC10A   L     RBASE2,ABASE2       GET SECOND BASE               Y02714 19356002
         LR    RSPID,RIN0          GET SUBPOOL ID AND LENGTH            19400002
         LA    RIN0,C0(0,RSPID)    REMOVE SPID FROM LENGTH       Y02714 19410002
         SRL   RSPID,C24           MOVE SPID TO LOW ORDER BYTE   Y02714 19420002
         MVI   CODE1,C0            ZERO OPTION FIELD                    19520002
         LR    RLENGTH,RIN0        GET LENGTH                    Y02714 19550002
         LTR   RIN1,RIN1           IS IT A GETMAIN?                     19551002
         BNM   FMCOMM1             NO, FREEMAIN                  Y02714 19552002
         B     GMCOMM1             GETMAIN                              19560001
         SPACE 2                                                        19580001
         DROP  RBASE1                                            Y02714 19590002
         EJECT                                                   Y02714 19600002
**************************************************************** Y02714 19602002
*                                                                Y02714 19610002
*        GLOBAL STORAGE BRANCH ENTRY WITH SALLOC LOCK HELD       Y02714 19620002
*                                                                Y02714 19622002
**************************************************************** Y02714 19622102
         SPACE 2                                                 Y02714 19622402
GLBRANCH STM   RIN0,RIN15,BRANCHSV SAVE CALLER'S REGISTERS       Y02714 19624002
         ST    RASCB,PASCBSV       SETUP SO GM/FM COMMON WILL    Y02714 19626002
         ST    RLDA,BRANCHSV+C28    RESTORE REGS CORRECTLY       Y02714 19628002
         BALR  TEMPBASE,0          ESTABLISH TEMPORARY BASE             19630002
         USING *,TEMPBASE                                               19660001
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19661002
         OI    PARMFLG1(R2),PARMGLBL  SET GLOBAL REQUEST FOR FRR Y02753 19662002
         OI    LOCKFLAG,SALHELD    INDICATE SALLOC ALREADY HELD  Y02751 19664002
         MVI   LDAFLAGS,C0         CLEAR FREEPART FLAGS        @ZA05954 19665040
         LA    RBASE1,IGC120BS     GET COMMON TEMP BASE          Y02714 19670002
         USING IGC120BS,RBASE1                                   Y02714 19670102
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 19670402
         USING BASE2,RBASE2                                      Y02714 19678602
         SR    RWORK,RWORK         SET TCB ADDRESS               Y02714 19703402
         ST    RWORK,LDATCB         TO ZERO                      Y02714 19711602
         LR    RSPID,RIN3          GET SPID (+ KEY & FLAGS)      Y02714 19719802
         SRL   RSPID,C8            MOVE TO LOW ORDER BYTE        Y02714 19728002
         N     RSPID,BYTE3MSK      ELIMINATE KEY                 Y02714 19736202
         LA    INDEX,C6            CHECK FOR SIX SUBPOOLS      @Y30APYF 19744403
GLBRNCH1 IC    RWORK,GLSPIDS-1(INDEX) GET NEXT VALID SPID        Y02714 19752602
         CR    RWORK,RSPID         IS THIS A VALID SUBPOOL?      Y02714 19760802
         BE    SVC120A             YES, CONTINUE                 Y02714 19769002
         BCT   INDEX,GLBRNCH1      TRY NEXT SUBPOOL              Y02714 19777202
*                                                                Y02714 19785402
* INVALID SUBPOOL, SET UP GERROR ROUTINE INTERFACE               Y02714 19793602
*                                                                Y02714 19801802
         LR    RLENGTH,RIN0        GET LENGTH FOR MESSAGE        Y02714 19810002
         MVI   CODE1,C0            SET UNCONDITIONAL REQUEST     Y02714 19816002
         MVI   MSGLEN,C4           REASON CODE 0 - MSGLEN OF 4   Y02714 19818402
         MVI   SVCBYTE,SV120       SET UP SVC TYPE FOR MESSAGE   Y02714 19818502
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 19820802
         USING BASE1,RBASE1                                      Y02714 19821802
         LA    RERROR,ERRB         SET UP ERROR CODE           @Z30ENWD 19822003
         B     GERROR              ABEND, B78 COMP CODE        @Z30ENWD 19822803
         SPACE 2                                                 Y02714 19823602
         DROP  RBASE1,RBASE2,RLDA,TEMPBASE                       Y02714 19824402
         EJECT                                                   Y02714 19824502
*********************************************************************** 19825902
*                                                                       19826502
*        SVC 120 EQUIVALENT BRANCH ENTRY                                19827102
*                                                                       19827902
*********************************************************************** 19828702
         SPACE 2                                                 Y02714 19829302
CRBRANCH EQU   *                                                 Y02714 19830102
         USING ASCB,RASCB                                        Y02714 19830902
         L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 19831702
         USING LDA,RASCB                                         Y02714 19832502
         STM   RIN0,RIN15,BRANCHSV SAVE CALLER'S REGISTERS       Y02714 19833302
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 19834802
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 19834902
         DROP  RASCB                                             Y02714 19835702
         USING LDA,RLDA                                          Y02714 19836502
         BALR  TEMPBASE,0          ESTABLISH TEMPORARY BASE             19837302
         USING *,TEMPBASE                                               19838802
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19839602
         LA    RBASE1,IGC120BS     GET COMMON TEMP BASE          Y02714 19839702
         USING IGC120BS,RBASE1                                   Y02714 19840502
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 19841402
         DROP  TEMPBASE                                          Y02714 19842202
SVC120A  OI    FLAGS,BRENTRY       SET BRANCH ENTRY              Y02714 19843002
         MVI   SVCBYTE,SV120       INDICATE SVC 120              Y02714 19844402
         LR    RIN15,RIN3          SIMULATE SVC 120 - DATA IN    Y02714 19845202
*                                  REGISTER 15                   Y02714 19845302
         B     SVC120B             CONTINUE AS FOR SVC 120       Y02714 19846802
         SPACE 5                                                 Y02714 19847602
*********************************************************************** 19848402
*                                                                       19848602
*        SVC 120 ENTRY POINT                                            19849402
*                                                                       19850202
*********************************************************************** 19851102
         SPACE 2                                                 Y02714 19852102
IGC120   BALR  RBASE1,0            SET TEMPORARY ADDRESSABILITY  Y02714 19853102
         USING *,RBASE1                                          Y02714 19853702
         USING ASCB,RASCB                                        Y02714 19854302
IGC120BS L     RASCB,ASCBLDA       GET ADDRESS OF LDA            Y02714 19855102
         USING LDA,RASCB                                         Y02714 19856102
         ST    RTCB,LDATCB         SAVE TCB POINTER              Y02714 19857202
         LR    RLDA,RASCB          SET ADDRESSABILITY TO LDA     Y02714 19857302
         DROP  RASCB                                             Y02714 19858502
         USING LDA,RLDA                                          Y02714 19859102
         ST    RRETURN,RETSAVE     SAVE RETURN REG               Y02714 19859702
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19860602
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 19861402
         USING BASE2,RBASE2                                      Y02714 19862202
         MVI   SVCBYTE,SV120       INDICATE SVC 120              Y02714 19863402
         LA    RRBPRXLN,RBPRFLNA   GET PREFIX LENGTH             Y02714 19864302
         SR    RRB,RRBPRXLN        GET BASE FOR RB INCL. PREFIX  Y02714 19865202
         USING RBPRFXST,RRB        SET ADDRESSABILITY TO PREFIX  Y02714 19865702
         MVC   MODE(C1),RBOPSW+C1  GET KEY AND MODE              Y02714 19866202
         ICM   RIN15,MKEY,RBOPSW+C1 GET KEY FROM RB OLD PSW      Y02714 19867202
         N     RIN15,KEYMASK       REMOVE MODE FROM KEY          Y02714 19868402
         DROP  RRB                                               Y02714 19869102
         ST    RIN1,SAVEREG1       SAVE FOR RESTORE ON FREEMAIN  Y02714 19869802
         SPACE 2                                                 Y02714 19870602
SVC120B  LR    RSPID,RIN15         GET SPID (+ KEY & FLAGS)      Y02714 19871302
         SRL   RSPID,C8            MOVE TO LOW ORDER BYTE        Y02714 19872002
         N     RSPID,BYTE3MSK      ELIMINATE KEY                 Y02714 19872802
         STCM  RIN15,MKEY,RQSTRKEY SAVE REQUESTER KEY            Y02714 19873502
         MVI   CODE1,C0            ZERO OPTION CODE BYTE         Y02714 19875002
         STC   RIN15,CODE2         STORE ACTUAL OPTION CODE      Y02714 19876002
         TM    CODE2,S120UNCD      UNCONDITIONAL REQUEST?        Y02714 19877202
         BO    SVC120C             YES                           Y02714 19877702
         OI    CODE1,CONDTNL       NO, SET SVC 4 COND. FLAG      Y02714 19878202
SVC120C  TM    CODE2,S120PBND      PAGE BOUNDARY REQUEST?        Y02714 19879402
         BZ    SVC120D             NO                            Y02714 19880102
         OI    CODE1,BOUND         YES, SET SVC 4 PAGE BNDRY FLG Y02714 19880802
SVC120D  L     RBASE1,ABASE1       GET PERMANENT FIRST BASE      Y02714 19881602
         USING BASE1,RBASE1                                      Y02714 19882302
         LR    RLENGTH,RIN0        GET LENGTH                    Y02714 19883002
         TM    CODE2,S120FM        FREEMAIN REQUEST?             Y02714 19883802
         BO    FMCOMM1             YES, FREEMAIN                 Y02714 19884802
         B     GMCOMM1             GETMAIN                       Y02714 19886002
         SPACE 2                                                        19886702
         DROP  RBASE1,RBASE2,RLDA                                Y02714 19887402
         EJECT                                                   Y02714 19888202
**************************************************************** Y02714 19888902
*                                                                Y02714 19890002
*        ENTRY POINT FROM REAL STORAGE MANAGEMENT TO RETURN ONE  Y02714 19890202
*        PAGE TO AN FBQE                                         Y02714 19891002
*                                                                Y02714 19891802
**************************************************************** Y02714 19892602
         SPACE 2                                                 Y02714 19893602
         USING *,RIN15                                           Y02714 19894802
MRELEASR LTR   RIN0,RIN0           LOCAL OR GLOBAL REQUEST?      Y02714 19895502
         BZ    MRLSER1             LOCAL, USE LDA                Y02714 19896202
         L     RIN15,CVTPTR        GLOBAL, USE GLOBAL SAVE AREA  Y02714 19897002
         USING CVT,RIN15                                         Y02714 19897702
         L     RIN15,CVTSPSA       GLOBAL SAVE AREA VECTOR TABLE Y02714 19898402
         USING WSAG,RIN15                                        Y02714 19899202
         L     RIN15,WSAGGMFM      GLOBAL SAVE AREA ADDRESS      Y02714 19899902
         USING LDA,RIN15                                         Y02714 19900602
         STM   RIN0,RRETURN,MSAVE  SAVE REGISTERS 0 TO 14        Y02714 19901402
         LR    RLDA,RIN15          PUT LDA POINTER IN REG 4      Y02714 19902402
         DROP  RIN15                                             Y02714 19903602
         BALR  TEMPBASE,0          SET UP TEMPORARY BASE         Y02714 19904302
         USING *,TEMPBASE                                        Y02714 19905002
         B     MRLSER2             CONTINUE                      Y02714 19905702
         DROP  TEMPBASE                                          Y02714 19906402
         SPACE 2                                                 Y02714 19907102
MRLSER1  L     RIN15,PSAAOLD       GET CURRENT ASCB POINTER      Y02714 19907802
         USING ASCB,RIN15                                        Y02714 19908502
         L     RIN15,ASCBLDA       GET ADDRESS OF LDA            Y02714 19909202
         USING LDA,RIN15                                         Y02714 19910202
         STM   RIN0,RRETURN,MSAVE  SAVE REGISTERS 0 TO 14        Y02714 19911202
         LR    RLDA,RIN15          PUT LDA POINTER IN REG 4      Y02714 19912402
         DROP  RIN15                                             Y02714 19913102
         USING LDA,RLDA                                          Y02714 19913802
MRLSER2  BALR  TEMPBASE,0          SET UP TEMPORARY BASE         Y02714 19914602
         USING *,TEMPBASE                                        Y02714 19915302
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19916002
         L     RBASE1,ABASE1       GET FIRST BASE                Y02714 19916802
         L     RBASE2,ABASE2       GET SECOND BASE               Y02714 19917602
         USING BASE1,RBASE1,RBASE2                               Y02714 19918802
         LR    RADDRM,RIN1         MOVE ADDRESS FOR MRELEASE     Y02714 19918902
         L     RSIZEM,PAGE         SET LENGTH TO 1 PAGE          Y02714 19920402
         LTR   RWORK3,RIN0         LOCAL OR GLOBAL REQUEST?      Y02714 19921202
         BZ    MRLSER3             LOCAL, GET A. S. PQE          Y02714 19921502
         OI    PARMFLG1(R2),PARMGLBL  SET GLOBAL REQUEST FOR FRR Y02753 19922202
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 19923402
         USING CVT,RCVT                                          Y02714 19924402
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 19924902
         DROP  RCVT                                              Y02714 19925402
         USING GDA,RGDA                                          Y02714 19926402
         L     RPQEM,CSAPQEP       GET CSA PQE POINTER           Y02714 19927402
         DROP  RGDA                                              Y02714 19928402
         LR    RIN0,RSIZEM         SET UP FOR SRM                Y02714 19929002
         BAL   RCOMRET1,SRM         INTERFACE ROUTINE, CSA FREED Y02714 19929602
         LR    RADDRM,RIN1         GET ADDRESS AGAIN             Y02714 19930402
         MVI   LDACBSP,CBSQA       FBQE IS IN SQA                Y02714 19931402
         B     MRLSER4             GO DO MRELEASE                Y02714 19932402
         SPACE 2                                                 Y02714 19933102
MRLSER3  L     RPQEM,ASDPQE        GET ADDRESS SPACE PQE POINTER Y02714 19933802
         MVI   LDACBSP,CBLSQA      FBQE IS IN LSQA               Y02714 19934502
MRLSER4  BAL   RRETURN,MRELEASE    GO RETURN STORAGE TO FBQE     Y02714 19935202
         LTR   RWORK3,RWORK3       LOCAL OR GLOBAL REQUEST?      Y02714 19936002
         BNZ   MRLSER5             GLOBAL, DON'T UPDATE CURRGNTP Y02714 19936802
         L     RBLKAD,MSAVE+C4     GET STARTING ADDRESS          Y02714 19937602
         LA    RCWRK,C0(RBLKAD,RSIZEM)  DEVELOP AUB              Y02714 19938402
         C     RCWRK,CURRGNTP      AUB = CURRGNTP?               Y02714 19939202
         BNE   MRLSER5             NO, UPDATE NOT NEEDED         Y02714 19940002
         LR    RSIZE,RSIZEM        GET SIZE                      Y02714 19940802
         LR    REGA,RPQEM          GET A. S. PQE                 Y02714 19941602
         L     RDQE,AFMSMF         GET FMSMF ENTRY POINT         Y02714 19942402
         BAL   RCOMRET1,FMSMFMR-FMSMFCRE(0,RDQE) UPDATE CURRGNTP Y02714 19943202
MRLSER5  BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 19944002
         LM    RIN0,RRETURN,MSAVE  RESTORE REGISTERS 0 TO 14     Y02714 19944802
         BR    RRETURN             RETURN TO RSM                 Y02714 19945602
         SPACE 2                                                 Y02714 19946402
         DROP  TEMPBASE                                          Y02714 19947602
         EJECT                                                   Y02714 19954202
**************************************************************** Y02714 19956402
*                                                                Y02714 19958602
*        ENTRY POINT FROM FREEPART TO RETURN REGION SPACE TO AN  Y02714 19960802
*        APPROPRIATE FBQE                                        Y02714 19963002
*                                                                Y02714 19965202
**************************************************************** Y02714 19967402
         SPACE 2                                                 Y02714 19969602
         USING MRELEASF,RIN15                                    Y02753 19970602
MRELEASF STM   R2,RIN15,BRANCHSV+C8  SAVE REGISTERS 2 THRU 15    Y02714 19971802
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR LDARQSTA Y02753 19973802
         DROP  RIN15                                             Y02753 19973902
         BAL   RRETURN,MRELEASE    GO TO MRELEASE                Y02714 19974002
         USING *,RRETURN                                         Y02714 19976203
         B     COMRET              DO COMMON RETURN PROCESSING   Y02714 19986003
         SPACE 2                                                        19986403
         DROP  RRETURN                                           Y02714 19986503
         SPACE 5                                                        19986603
**************************************************************** Y02714 19986803
*                                                                Y02714 19986903
*        ENTRY POINT FROM GETPART TO ALLOCATE SPACE IN LSQA      Y02714 19989403
*        FOR VSM CONTROL BLOCKS THAT ARE NOT CELL LENGTH       @Z30ENWD 19991603
*                                                                Y02714 19994203
**************************************************************** Y02714 19994603
         SPACE 2                                                        19995003
         USING GETMAING,RIN15                                    Y02753 19995103
GETMAING STM   R2,RIN15,BRANCHSV+C8  SAVE REGISTERS 2 THRU 15    Y02714 19995203
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR FLAGS  @Z30ENWD 19995403
         DROP  RIN15                                             Y02753 19995603
         BAL   RRETURN,GETMAINB    GO TO GET STORAGE             Y02714 19995803
COMRET   BAL   RRETURN,FMPOSTP     FREE Q'D AREAS AND SALLOC   @Z30ENWD 19996603
         BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 19997003
         LM    R2,RIN15,BRANCHSV+C8  RESTORE REGISTERS 2 THRU 15 Y02714 19997103
         BR    RRETURN             RETURN                        Y02714 19997203
         SPACE 2                                                        19997303
         DROP  RBASE1,RBASE2                                     Y02714 19997403
         EJECT                                                          19997803
***************************************************************@Z30ENWD 19997903
*                                                              @Z30ENWD 19998603
*        ENTRY POINT TO ALLOCATE OR RELEASE VSM CONTROL BLOCK           19998803
*        CELLS IN SQA OR LSQA                                  @Z30ENYF 19999003
*                                                              @Z30ENWD 20000703
***************************************************************@Z30ENWD 20001403
         SPACE 2                                               @Z30ENWD 20002103
         USING CBBRANCH,RIN15                                  @Z30ENWD 20002803
CBBRANCH EQU   *                                               @Z30ENWD 20003503
         USING ASCB,RASCB                                      @Z30ENWD 20004203
         L     RASCB,ASCBLDA       PICK UP LDA ADDRESS         @Z30ENWD 20004903
         USING LDA,RASCB                                       @Z30ENWD 20005603
         STM   R2,RRETURN,BRANCHSV+C8  SAVE REGISTERS 2 THRU 14@Z30ENWD 20006303
         LR    RLDA,RASCB          LOAD PROPER REG             @Z30ENWD 20007003
         DROP  RASCB                                           @Z30ENWD 20007703
         USING LDA,RLDA                                        @Z30ENWD 20008403
         BAL   RRETURN,FRRINIT     ESTABLISH FRR, CLEAR FLAGS  @Z30ENWD 20009103
         OI    CELLFLGS,INCBBRAN   SET CBBRANCH ENTERED FLAG   @Z30ENWD 20009803
         L     RBASE1,ABASE1       LOAD BASE REG               @Z30ENWD 20010503
         L     RBASE2,ABASE2       LOAD BASE REG               @Z30ENWD 20011203
         USING BASE1,RBASE1                                    @Z30ENWD 20011903
         USING BASE2,RBASE2                                    @Z30ENWD 20012603
         SR    R2,R2         CLEAR REG                         @Z30ENYF 20013303
         ST    R2,BRANCHSV+C60  PRESET RETURN CODE             @Z30ENYF 20014003
         LTR   RIN1,RIN1           CHECK REQUEST TYPE          @Z30ENWD 20014703
         BNM   FCEL                FREEMAIN REQUEST            @Z30ENWD 20015403
         SPACE                                                          20016903
         LR    RIN1,RIN0           SET UP SPID PARM            @Z30ENWD 20017203
         BAL   RRETURN,GETMAINC    REQUEST A CELL FOR USER     @Z30ENWD 20017703
         LTR   RIN1,RIN1           GET A CELL?                 @Z30ENWD 20018203
         BZ    CBSETRC             NO CELL, SET BAD R.C.       @Z30ENWD 20018703
         B     CLNUP               GO TO COMMON LOGIC          @Z30ENWD 20019203
         SPACE                                                          20020003
FCEL     C     RIN1,CURRGNTP       ADDRESS REASONABLE?         @Z30ENWD 20020303
         BNL   FCELBR              YES, FREE IT                @Z30ENYF 20021303
CBSETRC  LA    R2,FOUR             LOAD RETURN CODE            @Z30ENYF 20022303
         ST    R2,BRANCHSV+C60     STORE RETURN CODE           @Z30ENYF 20023303
         B     CLNUP                                           @Z30ENWD 20024303
FCELBR   BAL   RCOMRET1,FMAINC     FREE A CELL FOR USER        @Z30ENWD 20025303
         SPACE                                                          20026503
CLNUP    BAL   RRETURN,FMPOSTP     FREE ANY QUEUED AREAS       @Z30ENWD 20027303
         BAL   RRETURN,FRRDELET    GO DELETE FRR               @Z30ENWD 20028303
         LM    R2,RIN15,BRANCHSV+C8 RESTORE REGISTERS 2 THRU 15@Z30ENWD 20029303
         DROP  RLDA                                            @Z30ENWD 20030303
         USING LDA,RASCB                                       @Z30ENWD 20031303
         L     RASCB,PASCBSV       RESTORE REG FROM SAVE       @Z30ENWD 20032303
         BR    RRETURN             RETURN                      @Z30ENWD 20033303
         SPACE 2                                                        20040803
         DROP  RBASE1,RBASE2,RIN15,RASCB                       @Z30ENWD 20044003
         USING LDA,RLDA                                        @Z30ENWD 20046003
         EJECT                                                   Y02753 20048003
**************************************************************** Y02753 20048803
*                                                                Y02753 20052003
*        ROUTINE TO ESTABLISH A FUNCTIONAL RECOVERY ROUTINE      Y02753 20052803
*        (FRR) AND DO COMMON ENTRY INITIALIZATION                Y02753 20056003
*                                                                Y02753 20056803
*        INPUT                                                   Y02753 20058403
*              RLDA     - LDA ADDRESS                            Y02753 20060203
*              RRETURN  - RETURN ADDRESS                         Y02753 20062203
*        OUTPUT                                                  Y02753 20064203
*              LDARQSTA SET TO ZERO                              Y02753 20066203
*              LOCKFLAG SET TO ZERO                              Y02753 20070003
*              CELLFLGS SET TO ZERO                            @Z30ENWD 20070903
*              FRRBRNDX SET TO ZERO                              Y02753 20071803
*              FRR ESTABLISHED                                   Y02753 20072703
*              FRR PARAMETER AREA INITIALIZED AND ADDRESS SAVED  Y02753 20074503
*                  IN FRRPARM                                    Y02753 20076303
*              R2       - ADDRESS OF FRR PARAMETER AREA          Y02753 20080003
*        WORK                                                    Y02753 20082003
*              R2, REGA, REGB, WORK                              Y02753 20084003
*                                                                Y02753 20086003
**************************************************************** Y02753 20088003
         SPACE 2                                                 Y02753 20090003
FRRINIT  BALR  REGB,0              SET ADDRESSABILITY            Y02753 20092003
         USING *,REGB                                            Y02753 20094003
         SR    WORK,WORK           CLEAR CURRENT                 Y02753 20096003
         ST    WORK,LDARQSTA        REQUEST STATUS, LOCK FLAGS,  Y02753 20098003
         STH   WORK,LOCKFLAG        FRR BRANCH INDEX,          @Z30ENWD 20100003
         MVI   CELLFLGS,OFF         AND CELLFLAGS              @Z30ENYF 20102003
         L     R2,AFRR             GET FRR ADDRESS               Y02753 20104003
         SETFRR A,FRRAD=(R2),PARMAD=(R2),WRKREGS=(REGA,WORK)     Y02753 20106003
         ST    R2,FRRPARM          SAVE PARM AREA ADDRESS        Y02753 20108003
         ST    RLDA,PARMLDA(0,R2)  PLACE LDA ADDR IN PARM AREA   Y02753 20110003
         BR    RRETURN             RETURN                        Y02753 20112003
         SPACE 2                                                 Y02753 20114003
         DROP  REGB                                              Y02753 20116003
AFRR     DC    V(IEAVGFRR)         FUNCT. RECOVERY ROUTINE (FRR) Y02753 20118003
         EJECT                                                   Y02714 20120003
**************************************************************** Y02714 20122003
*                                                                Y02714 20124003
*        PERMANENT BASE REGISTER DEFINITIONS                     Y02714 20126003
*                                                                Y02714 20128003
**************************************************************** Y02714 20130003
         SPACE 2                                                 Y02714 20132003
BASE1    EQU   *                   START OF FIRST PERMANENT BASE Y02714 20134003
BASE2    EQU   BASE1+4096          START OF SECOND PERM. BASE    Y02714 20136003
ABASE1   DC    A(BASE1)            FIRST PERMANENT BASE          Y02714 20138003
ABASE2   DC    A(BASE2)            SECOND PERMANENT BASE         Y02714 20140003
         SPACE 2                                                 Y02714 20142003
         USING BASE1,RBASE1,RBASE2                               Y02714 20144003
         EJECT                                                          20146003
*********************************************************************** 20148003
*                                                                       20150003
*        GETMAIN FOR A VSM QUEUE ELEMENT - A CELL FROM LOCAL OR         20152003
*        CELL POOL.                                                     20154003
*                                                                       20156003
*          INPUT  - RIN1     -  SPID IN BYTE ZERO                       20158003
*                   RRETURN  -  RETURN REGISTER                         20160001
*          OUTPUT - RIN1     -  ADDRESS OF ASSIGNED STORAGE, OR         20180003
*                               ZERO IF NO CELLS AVAILABLE              20182003
*                   R2 - R15 -  RESTORED OR UNCHANGED                   20190003
*                                                                       20200001
*********************************************************************** 20210002
         SPACE 2                                                        20210103
GETMAINC STM   RRETURN,RCOMRET1,CSAVE SAVE CALLERS REGS 14-9   @Z30ENWD 20210403
         OI    CELLFLGS,INCELL     SET GETMAINC FLAG           @Z30ENWD 20210603
         SRL   RIN1,C24            ADJUST SPID FOR COMPARE     @Z30ENWD 20210803
         C     RIN1,SP245F         SQA REQUEST ?               @Z30ENWD 20211003
         BE    SQACEL              YES, SQA REQUEST            @Z30ENWD 20211203
         SPACE                                                          20211703
         OI    CELLFLGS,LCLREQ     REMEMBER REQUEST TYPE = LSQA@Z30ENWD 20211803
         LA    RANCHOR,LCLCELL     LOAD ANCHOR ADDRESS         @Z30ENWD 20215803
         B     REMOVCEL            GO TAKE A CELL              @Z30ENWD 20219803
         SPACE                                                          20226003
SQACEL   BAL   RCOMRET1,GTSALLOC   OBTAIN SALLOC               @Z30ENWD 20228003
         L     RCVT,CVTPTR         GET CVT POINTER             @Z30ENWD 20229003
         USING CVT,RCVT                                        @Z30ENWD 20230003
         L     RGDA,CVTGDA         GET GDA POINTER             @Z30ENWD 20231003
         DROP  RCVT                                            @Z30ENWD 20232003
         USING GDA,RGDA                                        @Z30ENWD 20233003
         LA    RANCHOR,GLBLCELL    LOAD ANCHOR ADDRESS         @Z30ENWD 20234003
         DROP  RGDA                                            @Z30ENWD 20235003
         SPACE                                                          20242003
REMOVCEL L     RIN1,C0(,RANCHOR)   GET FIRST CELL              @Z30ENWD 20244003
         LTR   RIN1,RIN1           GOT A CELL?                 @Z30ENWD 20244803
         BZ    QTEST               NO CELL AVAILABLE           @Z30ENWD 20245603
         SPACE                                                          20246603
RECHAINQ MVC   C0(C4,RANCHOR),C0(RIN1) RECHAIN QUEUE           @Z30ENWD 20252003
         L     RCTR,C4(,RANCHOR)   LOAD COUNT                  @Z30ENWD 20252903
         BCTR  RCTR,C0             MINUS 1                     @Z30ENWD 20253803
         ST    RCTR,C4(,RANCHOR)   STORE NEW COUNT             @Z30ENWD 20254703
         C     RCTR,CELLOW         IS QUEUE LOW?               @Z30ENWD 20255603
         BNL   GMCCLEAR            NO                          @Z30ENWD 20256503
         TM    CELLFLGS,LCLREQ     IS THIS A LOCAL REQUEST?    @Z30ENWD 20257403
         BZ    GBLEXP              NO, GLOBAL                  @Z30ENWD 20258303
         OI    CELLFLGS,LCLEXP     YES, SET LOCAL FLAG         @Z30ENWD 20259203
         B     GMCCLEAR            CLEAR CELL                  @Z30ENWD 20260103
GBLEXP   OI    CELLFLGS,GLBLEXP    SET GLOBAL FLAG             @Z30ENWD 20261003
         EJECT                                                          20262803
GMCCLEAR XC    C0(CELLEN,RIN1),C0(RIN1)   CLEAR CELL           @Z30ENWD 20266003
GMCRSET  NI    CELLFLGS,ALL-INCELL-LCLREQ RESET FLAGS          @Z30ENWD 20266403
         LM    RRETURN,RIN0,CSAVE  RESTORE REGISTERS 14-0      @Z30ENWD 20266803
         LM    RAREG,RCOMRET1,CSAVE+C16    AND 2-9             @Z30ENWD 20267203
         BR    RRETURN             RETURN                               20267703
         SPACE 3                                                        20268103
QTEST    TM    CELLFLGS,LCLREQ     LOCAL REQUEST?              @Z30ENWD 20268203
         BZ    SETGLBL             NO, GLOBAL REQUEST          @Z30ENWD 20268303
         OI    CELLFLGS,LCLEXP     SET LOCAL EXPANSION FLAG    @Z30ENWD 20268403
         B     TESTGNOT            TEST FOR CALLER             @Z30ENWD 20268503
SETGLBL  OI    CELLFLGS,GLBLEXP    SET GLOBAL EXPANSION FLAG   @Z30ENWD 20268603
         SPACE                                                          20269103
TESTGNOT TM    CELLFLGS,GNOTCALL   IS GNOTSAT THE CALLER       @Z30ENWD 20269203
         BZ    TRYEXPN             NO, EXPANSION ALLOWED       @Z30ENWD 20271203
         TM    CELLFLGS,LCLREQ     LOCAL REQUEST?              @Z30ENWD 20273203
         BZ    GMCRSET             NO, RETURN WITH ZERO        @Z30ENWD 20275203
RSETLCL  NI    CELLFLGS,ALL-LCLREQ RESET FLAG                  @Z30ENWD 20277203
         B     SQACEL              TRY TO GET SQA              @Z30ENWD 20279203
         SPACE                                                          20281403
TRYEXPN  BAL   RRETURN,GETMAINE    TRY TO EXTEND POOL          @Z30ENWD 20281503
         L     RIN1,C0(,RANCHOR)   TAKE CELL                   @Z30ENWD 20282003
         LTR   RIN1,RIN1           HAVE ANY NOW?               @Z30ENWD 20282503
         BNZ   RECHAINQ            YES, RECHAIN QUEUE          @Z30ENWD 20283003
         TM    CELLFLGS,LCLREQ     IS THIS A LOCAL REQUEST?    @Z30ENWD 20283503
         BO    RSETLCL             YES, TRY FOR SQA            @Z30ENWD 20284003
         SPACE                                                          20284903
         TM    CELLFLGS,INCBBRAN   WAS CBBRANCH THE CALLER?    @Z30ENWD 20285403
         BO    GMCRSET             YES                         @Z30ENWD 20286403
         B     WAITPREP            NO, PREPARE FOR WAIT        @Z30ENWD 20287403
         EJECT                                                          20288403
*********************************************************************** 20288703
*                                                              @Z30ENWD 20288803
*        GETMAINE/GETMAINB - ENTRY POINTS FOR INTERNAL GETMAIN @Z30ENWD 20289303
*               GETMAINE - EXPANDS CELL POOL                   @Z30ENWD 20289803
*               GETMAINB - PAGETABLE SPACE, GETMAING, GETMAINE @Z30ENWD 20290303
*                                                              @Z30ENWD 20290803
*          GETMAINE INPUT - FLAGS (LCLEXP AND/OR GLBLEXP)      @Z30ENWD 20291303
*                   OUTPUT - CELLS ON APPROPRIATE QUEUE        @Z30ENWD 20291803
*                                                              @Z30ENWD 20292303
*********************************************************************** 20292903
         SPACE                                                          20294003
GETMAINE STM   RAREG,RIN1,BSAVE    STORE REGS                  @Z30ENWD 20294903
         OI    CELLFLGS,INEXPN     SET GETMAINE ENTERED FLAG   @Z30ENWD 20295703
         TM    CELLFLGS,LCLEXP     ENTER TO EXPAND LSQA CELLS? @Z30ENWD 20296503
         BZ    SETSQASP            NO,SQA CELLS                @Z30ENWD 20297303
         L     RSPID,SP255F        LOAD LSQA SPID              @Z30ENWD 20298103
         B     SETLEN              GO SET LENGTH               @Z30ENWD 20298903
SETSQASP L     RSPID,SP245F        LOAD SQA SPID               @Z30ENWD 20299703
SETLEN   L     RLENGTH,CELEXPNL    LOAD EXPANSION LENGTH       @Z30ENWD 20300503
         B     GMB1                DO A MODIFIED GETMAINB      @Z30ENWD 20301303
         SPACE 2                                                        20302803
*********************************************************************** 20303503
*                                                              @Z30ENWD 20304203
*          GETMAINB INPUT - RIN1 = SPID AND LENGTH             @Z30ENWD 20304903
*                   OUTPUT - RIN1 = ADDRESS                    @Z30ENWD 20305603
*                                                              @Z30ENWD 20306303
*********************************************************************** 20307003
         SPACE 2                                                        20307703
GETMAINB STM   RAREG,RIN1,BSAVE    SAVE CALLERS REGS                    20308403
         LR    RSPID,RIN1          ISOLATE SUBPOOL ID                   20309103
         SRL   RSPID,C24           INTO CORRECT REG                     20310003
         LA    RLENGTH,0(0,RIN1)   GET LENGTH WITHOUT SPID       Y02714 20312003
GMB1     L     RRETURN,LDARQSTA    SAVE FLAG WORD              @Z30ENWD 20314003
GMB2     MVI   SPFLAGS,C0          ZERO FLAG BYTE              @Z30ENWD 20316003
         C     RSPID,SP255F        SQA OR LSQA?                  Y02714 20318003
         BE    GTLSQASP            LSQA                                 20320001
GETSQAPT L     RCVT,CVTPTR         GET CVT POINTER               Y02714 20330002
         USING CVT,RCVT                                          Y02714 20332002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 20334002
         DROP  RCVT                                              Y02714 20336002
         USING GDA,RGDA                                          Y02714 20338002
         L     RSPQE,SQASPQEP      GET SPQE FOR SQA              Y02714 20340002
         DROP  RGDA                                              Y02714 20350002
         OI    SPFLAGS,SQA         SET SQA FLAG                  Y02714 20360002
         B     SETGMBSW            GO SET GETMAINB SW                   20380001
         EJECT                                                          20382003
CHNTOSQA NI    CELLFLGS,ALL-LCLEXP RESET FLAG                  @Z30ENWD 20382503
         TM    CELLFLGS,INEXPN     WAS EXPANSION THE CALLER?   @Z30ENWD 20384503
         BO    GMBRSET             YES, DON'T CONVERT          @Z30ENWD 20386503
         LA    RSPID,C245          CHANGE TO SQA               @Z30ENWD 20388503
         B     GETSQAPT            GO GET SPQE FOR SQA                  20392002
         SPACE 1                                                 Y02714 20402002
GTLSQASP L     RSPQE,LSQAPTR       GET SPQE FOR LSQA             Y02714 20420002
         LTR   RSPQE,RSPQE         IS THERE AN SPQE FOR LSQA?           20450002
         BZ    CHNTOSQA            NO - CHANGE TO SQA                   20460002
         OI    SPFLAGS,LSQA        SET LSQA FLAG                 Y02714 20470002
SETGMBSW OI    FLAGS,GETMB         SET GETMAINB SWITCH           Y02714 20480002
         STM   RAREG,RIN1,SAVEREG2 SAVE REGS-RETRY FROM GNOTSAT@Z30ENWD 20500003
*                                                              @Z30ENWD 20505003
*         THE GNOTSAT ROUTINE CAN ENTER AT THIS LABEL          @Z30ENWD 20510003
*                                                              @Z30ENWD 20515003
GMBRETRY BAL   RCOMRET1,GFRECORE   TRY TO GET STORAGE FROM SUBPOOL      20520002
         B     GNOTSATA            NOT FOUND                            20540001
         BAL   RCOMRET1,GFQEUPDT   FOUND - REMOVE ASGNED CORE FROM FQE  20560001
         LR    RIN1,RFQE           ADDRESS OF ASSIGNED AREA             20580001
         TM    CELLFLGS,INEXPN     NEED TO FORMAT?             @Z30ENWD 20590003
         BO    EXPNFMT             YES                         @Z30ENWD 20591003
         SPACE                                                          20592303
         BCTR  RLENGTH,0           DECREMENT TO CLEAR CORE              20592603
         EX    RLENGTH,CLEARCOR    CLEAR ASSIGNED CORE                  20592903
GMBRSET  ST    RRETURN,LDARQSTA    RESTORE FLAG WORD             Y02714 20593203
         NI    CELLFLGS,ALL-INEXPN-LCLEXP-GLBLEXP RESET FLAGS  @Z30ENWD 20593503
         LM    RAREG,RIN0,BSAVE    RESTORE REGISTERS                    20594103
         BR    RRETURN             RETURN                               20596103
         SPACE 1                                                        20599603
CLEARCOR XC    C0(C0,RIN1),C0(RIN1) CLEAR ASSIGNED CORE                 20600003
         SPACE 3                                                        20601003
*        EXPANSION FORMAT ROUTINE OF GETMAINB                  @Z30ENWD 20602003
         SPACE 3                                                        20603003
EXPNFMT  TM    CELLFLGS,LCLEXP     LOCAL REQUEST?              @Z30ENWD 20604003
         BZ    GLSETUP             NO, MUST BE GLOBAL          @Z30ENWD 20605003
         NI    CELLFLGS,ALL-LCLEXP RESET FLAG                  @Z30ENWD 20606003
         LA    RANCHOR,LCLCELL     LOAD ANCHOR ADDRESS         @Z30ENWD 20607003
         B     LENCK               CHECK LENGTH                @Z30ENWD 20608003
         SPACE                                                          20610003
GLSETUP  NI    CELLFLGS,ALL-GLBLEXP RESET FLAG                 @Z30ENWD 20613003
         L     RCVT,CVTPTR         GET CVT POINTER             @Z30ENWD 20614003
         USING CVT,RCVT                                        @Z30ENWD 20615003
         L     RGDA,CVTGDA         GET GDA POINTER             @Z30ENWD 20616003
         DROP RCVT                                             @Z30ENWD 20617003
         USING GDA,RGDA                                        @Z30ENWD 20618003
         LA    RANCHOR,GLBLCELL    GET ANCHOR ADDRESS          @Z30ENWD 20619003
         DROP  RGDA                                            @Z30ENWD 20620003
         SPACE                                                          20625003
LENCK    LTR   RLENGTH,RLENGTH     LENGTH EQUAL ZERO?          @Z30ENWD 20626303
         BZ    CKDBLENT            YES, NO FORMAT REQUIRED     @Z30ENWD 20627303
         SPACE                                                          20628303
         L     ROLDQ,C0(,RANCHOR)  SAVE OLD QUEUE POINTER      @Z30ENWD 20629303
         LA    RSTOP,C0(RLENGTH,RIN1) GET STOP ADDRESS         @Z30ENWD 20630303
         LR    RNEXT,RIN1          PRESET NEXT ADDRESS         @Z30ENWD 20631303
         SR    RCTR,RCTR           CLEAR THE COUNTER           @Z30ENWD 20632303
         ST    RIN1,C0(,RANCHOR)   STORE FIRST CELL ADDRESS    @Z30ENWD 20633303
CELLOOP  LA    RCTR,C1(,RCTR)      ADD ONE TO COUNTER          @Z30ENWD 20634303
         LA    RNEXT,CELLEN(,RNEXT) UPDATE NEXT POINTER        @Z30ENWD 20635303
         CR    RNEXT,RSTOP         LAST CELL?                  @Z30ENWD 20636303
         BNL   WRAPUP              YES, GET OUT OF LOOP        @Z30ENWD 20637303
         SPACE                                                          20647003
         ST    RNEXT,C0(,RIN1)     STORE FORWARD POINTER       @Z30ENWD 20649003
         LR    RIN1,RNEXT          UPDATE CELL POINTER         @Z30ENWD 20650003
         B     CELLOOP             DO NEXT CELL                @Z30ENWD 20651003
         SPACE                                                          20653503
WRAPUP   ST    ROLDQ,C0(RIN1)      RECHAIN OLD QUEUE           @Z30ENWD 20654003
         A     RCTR,C4(,RANCHOR)   ADD IN OLD COUNT            @Z30ENWD 20655003
         ST    RCTR,C4(,RANCHOR)   STORE NEW COUNT             @Z30ENWD 20656003
         SPACE                                                          20659503
CKDBLENT TM    CELLFLGS,GLBLEXP    SQA REQUEST ALSO?           @Z30ENWD 20661503
         BZ    GMBRSET             NO, DON'T TRY SQA           @Z30ENWD 20663503
         SPACE                                                          20666003
         L     RLENGTH,CELEXPNL    GET EXPANSION LENGTH        @Z30ENWD 20668003
         L     RSPID,SP245F        SET SQA SPID                @Z30ENWD 20698003
         B     GMB2                EXPAND FOR SQA              @Z30ENWD 20728003
         EJECT                                                          20760001
*********************************************************************** 20770002
*                                                                       20800001
*        SUBROUTINE TO DETERMINE SUBPOOL REQUEST AND TO GET SPQE FOR    20820001
*          REQUESTED SUBPOOL                                            20840001
*                                                                       20850002
*              INPUT                                                    20860001
*                 RSPID   - SPID                                        20900001
*                 RCOMRET1 _ RETURN ADDRESS                             20910001
*              OUTPUT                                                   20920001
*                 RSPQE   - SPQE ADDRESS                                20940001
*                         - 0 IF SPQE NOT FOUND                         20960001
*              WORK                                                     20970002
*                 RWORK, RCVT, RGDA, RRETURN, RRETCODE                  20972002
*                                                                       20980001
*********************************************************************** 20990002
         SPACE 2                                                 Y02714 21000002
CSPCHK   LA    RWORK,C128          PROBLEM PROGRAM                      21020001
         STC   RSPID,SAVSPID       SAVE SPID FOR FREEMAIN ERROR         21030001
         MVI   LDACBSP,CBLSQA      CONTROL BLOCKS IN LSQA        Y02714 21032002
         SR    RWORK,RSPID         IS THIS PROBLEM PROGRAM SUBPOOL?     21040002
         BP    PGTSPQE             YES                                  21060001
         LA    RWORK,SUPSPLIM      BELOW SUPERV. SUBPOOL LIMIT?  Y02714 21080002
         SR    RWORK,RSPID                                              21100001
         LCR   RWORK,RWORK                                              21120001
         BM    ERROR11A            YES - INVALID SUBPOOL                21140002
         SLL   RWORK,C2            X 4 FOR BRANCH TABLE                 21160002
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 21180002
         BO    TABLE(RWORK)        YES, DETERMINE REQUESTED SUBP Y02714 21200002
         TM    MODE,X'80'+SUP      KEY 0 TO 7 OR SUPERV MODE?    Y02714 21203002
         BNO   TABLE(RWORK)        YES, DETERMINE REQUESTED SUBP Y02714 21206002
         STM   RIN0,RIN1,CSPCKSAV  SAVE REGISTERS 0 AND 1        Y02714 21210002
         TESTAUTH FCTN=1,BRANCH=YES                              Y02714 21214002
         LM    RIN0,RIN1,CSPCKSAV  RESTORE REGISTERS 0 AND 1     Y02714 21216002
         LTR   RRETCODE,RRETCODE   IS CALLER AUTHORIZED?         Y02714 21218402
         BZ    TABLE(RWORK)        YES, DETERMINE REQUESTED SUBP Y02714 21218802
         B     ERROR11A            NO, ABEND BXY                 Y02714 21219202
         SPACE 2                                                        21280001
*                                SUBPOOL                                21290002
         SPACE 1                                                 Y02714 21292002
TABLE    B     SP227               227                         @Y30APYF 21294003
         B     SP228               228                         @Y30APYF 21294603
         B     SP229               229                           Y02714 21295203
         B     SP230               230                           Y02714 21296002
         B     SP231               231                           Y02714 21298002
         B     ERROR11A            232                           Y02714 21298402
         B     SP233               233                                  21310002
         B     SP233               234                                  21320002
         B     SP233               235                                  21340002
         B     SP236               236                                  21360002
         B     SP236               237                                  21380002
         B     ERROR11A            238                                  21400002
         B     SP239               239                           Y02714 21420002
         B     SP250               240                                  21440002
         B     SP241               241                                  21460002
         B     SP242               242                                  21480002
         B     ERROR11A            243                           Y02714 21500002
         B     ERROR11A            244                           Y02714 21520002
         B     SP245               245                                  21540002
         B     ERROR11A            246                                  21560002
         B     SP242               247                           Y02714 21580002
         B     ERROR11A            248                                  21600002
         B     ERROR11A            249                           Y02714 21620002
         B     SP250               250                                  21640002
         B     SP251               251                                  21660002
         B     SP251               252                                  21680002
         B     SP253               253                                  21700002
         B     SP254               254                                  21720002
         B     SP255               255                           Y02714 21740002
         SPACE 2                                                 Y02714 21750002
SP229    OI    SPFLAGS,FPROTECT    FETCH PROTECTED SUBPOOL       Y02714 21752002
SP230    L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 21752402
         LA    RSPQE,TCBUKYSP      GET SPQE POINTER FROM TCB     Y02714 21754002
         OI    SPFLAGS,AUK         AUTH. USER KEY SUBPOOL        Y02714 21756002
         B     UKSPQE              CONTINUE PROCESSING           Y02714 21758002
         SPACE 2                                                 Y02714 21758102
SP239    MVI   RQSTRKEY,C0         SET REQUESTER KEY TO ZERO     Y02714 21761303
         LA    RSPID,C227          CONVERT TO SP 227           @Y30APYF 21763303
SP227    OI    SPFLAGS,FPROTECT    FETCH PROTECTED SUBPOOL     @Y30APYF 21763603
SP228    OI    SPFLAGS,SQA         BACKED LIKE SQA             @Y30APYF 21763903
         B     SP241               FIND SPQE ON CSA CHAIN      @Y30APYF 21764203
         SPACE 2                                                        21764603
SP231    OI    SPFLAGS,FPROTECT    FETCH PROTECTED SUBPOOL       Y02714 21771603
SP241    L     RCVT,CVTPTR         GET CVT POINTER               Y02714 21780103
         USING CVT,RCVT                                          Y02714 21783203
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 21786303
         DROP  RCVT                                              Y02714 21789403
         USING GDA,RGDA                                          Y02714 21792503
         LA    RSPQE,CSASPQEP      GET CSA SPQE POINTER          Y02714 21795603
         DROP  RGDA                                              Y02714 21798703
         OI    SPFLAGS,CSA         CSA SUBPOOL                   Y02714 21801803
         MVI   LDACBSP,CBSQA       CONTROL BLOCKS IN SQA         Y02714 21804903
         LR    RWORK,RCOMRET1      SAVE CSPCHK RETURN ADDRESS  @ZA02359 21805503
         BAL   RCOMRET1,GTSALLOC   GET SALLOC LOCK TO PREVENT  @ZA02359 21806103
*                                  BUILDING DUPLICATE SPQES    @ZA02359 21806703
         LR    RCOMRET1,RWORK      RESTORE RETURN ADDRESS      @ZA02359 21807303
         SPACE 2                                                 Y02714 21808003
UKSPQE   ST    RSPQE,SPQESAVE      SAVE SPQE PTR FOR GSPQESPC    Y02714 21814203
         L     RSPQE,0(0,RSPQE)    GET FIRST SPQE ADDRESS        Y02714 21820403
         LTR   RSPQE,RSPQE         IS THERE ONE?                 Y02714 21823503
         BZR   RCOMRET1            NO, RETURN WITH ZERO POINTER  Y02714 21826603
         SR    RWORK,RWORK         CLEAR FOR SPID                Y02714 21829703
UKSPQE1  IC    RWORK,SPQEID(0,RSPQE) GET SPQE SPID               Y02714 21832803
         CR    RWORK,RSPID         IS THIS SPID REQUESTED?       Y02714 21835903
         BNE   UKSPQE2             NO, GO TRY NEXT               Y02714 21839003
         CLC   RQSTRKEY,SPQEKEY(RSPQE) DOES THE KEY MATCH?       Y02714 21842103
         BE    GETSPQE1            YES, CORRECT SPQE FOUND       Y02714 21845203
UKSPQE2  TM    SPQEFLGS(RSPQE),LASTSPQE LAST SPQE?               Y02714 21848303
         BO    UKSPQE3             YES                           Y02714 21851403
         L     RSPQE,SPQEPTR(0,RSPQE) NO, GET NEXT SPQE          Y02714 21854503
         B     UKSPQE1             CHECK IT                      Y02714 21857603
         SPACE 2                                                 Y02714 21860703
UKSPQE3  SR    RSPQE,RSPQE         INDICATE SPQE NOT FOUND       Y02714 21863803
         BR    RCOMRET1            RETURN                        Y02714 21866903
         SPACE 2                                                        21870003
SP233    LA    RSPID,C20(RSPID)    CHANGE SP TO 253,254, OR 255         21873003
         LA    RWORK,C80(RWORK)    CHANGE BRANCH VALUE           Y02714 21876003
         B     TABLE(RWORK)        GO TO PROPER ROUTINE                 21880003
         SPACE 2                                                 Y02714 21883003
SP236    L     RTCB1,LDATCB        GET TCB ADDRESS               Y02711 21886003
         LA    RSPQE,TCBSWA        GET SWA SPQE ADDRESS          Y02711 21890003
         ST    RSPQE,SPQESAVE      SAVE SPQE PTR FOR GSPQESPC    Y02711 21892003
         OI    SPFLAGS,SWA         SWA SUBPOOL                   Y02711 21896003
         L     RSPQE,0(0,RSPQE)    GET FIRST SPQE PTR            Y02711 21900003
         B     ANYSPQE             GO FIND CORRECT SPQE          Y02711 21903003
         SPACE 2                                                        21906003
SP242    L     RIN15,GFPART        GET GET/FREE PART ADDRESS            21910002
         LR    PARMREG,RSPID       PUT SUBPOOL ID IN CORRECT REG Y02714 21920002
         MVI   FREESW,C0           CLEAR FREESW                  Y02714 21922002
         BAL   RRETURN,FRRDELET    DELETE FRR BEFORE GET PART  @YM07647 21924003
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 21930002
         BZR   RIN15               NO, GO TO GET/FREE PART       Y02714 21940002
         OI    LDAFLAGS,LDABRSW    INDICATE BRANCH ENTRY         Y02714 21942002
         MVC   BRANCHSV+C28(C4),PASCBSV  RESTORE REG 7 POSITION  Y02714 21944002
         BR    RIN15               GO TO GET/FREE PART                  21946002
         SPACE 2                                                        21948002
SP245    OI    SPFLAGS,SQA         SET SQA SWITCH                Y02714 21980002
         MVI   LDACBSP,CBSQA       CONTROL BLOCKS IN SQA         Y02714 21990002
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 22000002
         USING CVT,RCVT                                          Y02714 22010002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 22012002
         DROP  RCVT                                              Y02714 22014002
         USING GDA,RGDA                                          Y02714 22016002
         L     RSPQE,SQASPQEP      GET SQA SPQE POINTER          Y02714 22018002
         DROP  RGDA                                              Y02714 22018402
         BR    RCOMRET1            RETURN                               22020001
         SPACE 2                                                        22040001
SP250    SR    RSPID,RSPID         CHANGE TO SUBPOOL 0                  22042002
         B     PGTSPQE1            TREAT AS IF PP                       22044002
         SPACE 2                                                        22046002
SP254    L     RTCB1,LDATCB        GET ADDRESS OF TCB            Y02714 22050002
         TM    TCBFLGS3,TCBABGM    REQUESTING TCB ABENDING ?   @ZA29616 22052040
         L     RTCB1,TCBJSTCB      GET ADDRESS OF JOBSTEP TCB    Y02714 22056040
         ST    RTCB1,LDATCB        SAVE AS REQUESTING TCB        Y02714 22060040
         BNO   SP253               NO, CONTINUE                @ZA29616 22064040
         OI    FLAGS,LDAABGM       YES, INDICATE TCB ABENDING  @ZA29616 22068040
SP253    OI    SPFLAGS,NEEDAQE     INDICATE AQE NEEDED           Y02714 22080002
SP255    OI    SPFLAGS,LSQA        SET LSQA SWITCH               Y02714 22120002
         L     RSPQE,LSQAPTR       PICK UP LSQA SPQE             Y02714 22140002
         LTR   RSPQE,RSPQE         IS THERE AN SPQE?             Y02714 22190002
         BNZR  RCOMRET1            YES, RETURN                   Y02714 22220002
         LA    RSPID,C245          NO, CHANGE TO SQA (SP 245)    Y02714 22270002
         NI    SPFLAGS,ALL-LSQA    RESET LSQA FLAG               Y02714 22280002
         B     SP245               GO PROCESS AS SUBPOOL 245            22300002
         SPACE 2                                                        22310001
*                                                                       22520001
*        FIND SUBPOOL QUEUE ELEMENT FOR PROBLEM PROGRAM SUBPOOLS        22540001
*              AND FOR SUBPOOLS 250, 251, AND 252                       22560002
*                                                                       22580001
         SPACE 1                                                        22600001
PGTSPQE  TM    MODE,KEY0+SUP       KEY 0 AND SUPERVISOR STATE    Y02714 22660002
         BZ    SUPVPPSP            YES                                  22680001
         SPACE 2                                                        22700001
PGTSPQE1 L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 22710002
PGTSPQE2 LA    RSPQE,TCBMSS        GET SPQE PTR FROM TCB         Y02714 22712002
         ST    RSPQE,SPQESAVE      SAVE SPQE PTR FOR GSPQESPC    Y02714 22714002
         L     RSPQE,TCBMSS        GET 1ST SPQE                  Y02714 22720002
         OI    SPFLAGS,FPROTECT    SET FETCH PROTECT FLAG        Y02714 22730002
ANYSPQE  LTR   RSPQE,RSPQE         IS THERE ONE?                 Y02714 22740002
         BZR   RCOMRET1            NO - RETURN WITH 0 POINTER    Y02714 22780002
         SR    RWORK,RWORK                                              22800001
GETSPQE  IC    RWORK,SPQEID(RSPQE) PICK UP SPID                         22820001
         CR    RWORK,RSPID         SAME ID?                             22840002
         BE    GETSPQE1            YES - CHECK IF SHARED                22860001
         TM    SPQEFLGS(RSPQE),LASTSPQE LAST SPQE?                      22880002
         BZ    GETSPQE2            NO                                   22900001
         SR    RSPQE,RSPQE         INDICATE SPQE NOT FOUND              22920001
         BR    RCOMRET1            RETURN                               22940001
         SPACE 2                                                        22960001
GETSPQE2 L     RSPQE,SPQEPTR(RSPQE) GET NEXT SPQE                Y02714 22980002
         B     GETSPQE             CHECK IT OUT                         23020001
         SPACE 2                                                        23040001
GETSPQE1 TM    SPQEFLGS(RSPQE),SPSHARE SHARED?                          23060002
         BZ    SVSPQEKY            NO, CONTINUE                  Y02714 23080002
         L     RSPQE,SPDQEAD(RSPQE) LOAD OWNING SPQE             Y02714 23100002
SVSPQEKY IC    RWORK,SPQEKEY(RSPQE)  SAVE SPQE KEY               Y02714 23110002
         STC   RWORK,LSPQEKEY       FOR SETTING STORAGE KEY      Y02714 23111002
         BR    RCOMRET1            RETURN - SPQE FOUND                  23120001
         SPACE 2                                                        23140001
SUPVPPSP TM    MODE,SUBFRMN        SUBPOOL FREEMAIN?                    23160002
         BO    PGTSPQE1            YES                                  23180001
         LTR   RSPID,RSPID         IS THIS SUBPOOL 0             Y02714 23190002
         BNZ   PGTSPQE1            NO, LEAVE AS IS               Y02714 23192002
         LA    RSPID,C252          CHANGE TO SUBPOOL 252         Y02714 23200002
         SPACE 2                                                 Y02714 23210002
SP251    L     RTCB1,LDATCB        GET ADDRESS OF TCB            Y02714 23212002
         L     RTCB1,TCBJSTCB      GET ADDRESS OF JOBSTEP TCB    Y02714 23214002
         ST    RTCB1,LDATCB        SAVE AS REQUESTING TCB        Y02714 23216002
         B     PGTSPQE2            GO FIND SPQE                  Y02714 23240002
         SPACE 2                                                        23376001
ERROR11A MVI   MSGLEN,C4           REASON CODE 0 - MSGLEN OF 4   Y02714 23376802
         LA    RERROR,ERRB         SET ERROR CODE 11           @Z30ENWD 23377003
         CLI   SVCBYTE,SV5         IS THIS SVC 5?                Y02714 23377202
         BNE   GERROR              NO  -  MSGLEN OK            @Z30ENWD 23377603
         L     RADDR,C0(RADDR)     GET ADDRESS TO BE FREED              23377701
         MVI   MSGLEN,C8           REASON CODE 0 - MSGLEN OF 8          23377801
         B     GERROR              INVALID SUBPOOL             @Z30ENWD 23377903
         EJECT                                                          23394501
*********************************************************************** 23404502
*                                                                       23420001
*        ROUND REQUESTED LENGTH TO DOUBLE WORD BOUNDARY                 23440001
*                                                                       23450002
*              IF AQE NEEDED - FLAG REQ4K IS SET IF ROUNDED LENGTH      23452040
*                              IS EXACTLY 4096 BYTES (1 PAGE)           23454040
*                            - LENGTH IS INCREMENTED BY 8               23456040
*                   INPUT                                               23480001
*                        RLENGTH  - LENGTH REQUESTED                    23500002
*                        RCOMRET1 - RETURN ADDRESS                      23510001
*                   OUTPUT                                              23520001
*                        RLENGTH  - ROUNDED LENGTH                      23540002
*                        RWORK    - 7, USED BY FMCOMMON                 23550002
*                                                                       23620001
*********************************************************************** 23630002
         SPACE 2                                                 Y02714 23632002
CRNDLNTH LA    RWORK,C7            ROUND                                23640001
         AR    RLENGTH,RWORK            LENGTH                          23660001
         OR    RLENGTH,RWORK                 TO 8 BYTE                  23680001
         XR    RLENGTH,RWORK                      MULTIPLE              23700001
         TM    SPFLAGS,NEEDAQE     AQE NEEDED                           23720002
         BZR   RCOMRET1            NO                                   23740002
         C     RLENGTH,PAGE        LENGTH EXACTLY 4096 BYTES   @ZA11822 23744040
         BNE   NOTAPAGE            NO                          @ZA11822 23748040
         OI    SPFLAGS,REQ4K       INDICATE 4096 BYTE REQUEST  @ZA11822 23752040
NOTAPAGE LA    RLENGTH,C8(RLENGTH) ADD 8 BYTES TO LNTH FOR AQE @ZA11822 23756040
         BR    RCOMRET1            RETURN                               23780001
         EJECT                                                          23800001
*********************************************************************** 23810002
*                                                                       23840001
*        CREATE AN SPQE FOR A NEW SUBPOOL                               23860001
*                                                                       23870002
*              INPUT                                                    23880001
*                   RSPID - SUBPOOL ID                                  23920001
*                   RCOMRET1 - RETURN ADDRESS                           23930001
*              OUTPUT                                                   23940001
*                   RSPQE - ADDRESS OF SPQE                             23960001
*              WORK                                                     23970002
*                   RWORK, RIN15                                        23972002
*                                                                       23980001
*********************************************************************** 23990002
         SPACE 2                                                 Y02714 24000002
GSPQESPC EQU   *                                                        24020001
         LR    RIN15,RIN1          SAVE PARAMETER POINTER               24040001
         ICM   RIN1,MASK1,LDACBSP  INDICATE CONTROL BLOCK SUBPOOLY02714 24070002
         BAL   RRETURN,GETMAINC    GET SPACE FOR SPQE          @Z30ENWD 24120003
         LR    RSPQE,RIN1          GET SPQE ADDRESS                     24160001
         L     RWORK,SPQESAVE      GET ADDRESS OF SPQE POINTER   Y02714 24170002
*                                  SAVED BY CSPCHK               Y02714 24172002
         MVC   SPQEPTR(C4,RSPQE),0(RWORK)  NEXT SPQE PTR TO SPQE Y02714 24180002
         ST    RSPQE,0(0,RWORK)    NEW SPQE ADDR TO SPQE PTR     Y02714 24200002
         STC   RSPID,SPQEID(RSPQE) SPID TO SPQE                         24240001
         TM    SPFLAGS,CSA+AUK     CSA OR AUTH. USER KEY SP?     Y02714 24250002
         BNZ   GTCSAKEY            YES, GO GET KEY               Y02714 24252002
         TM    SPFLAGS,SWA         SWA SUBPOOL?                  Y02714 24254002
         BO    GTSCHEDK            YES, GET SCHEDULER KEY        Y02714 24256002
         LA    RWORK,C252          GET COMPARISON VALUE                 24256140
         CR    RSPID,RWORK         SUBPOOL 252 REQUESTED?               24256340
         BNE   GETCBKEY            NO, GET KEY FROM TCB                 24256640
         SR    RWORK,RWORK         YES, MAKE KEY = 0                    24256940
         B     SAVKEY              GO STORE KEY                         24257240
GETCBKEY L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 24257540
         IC    RWORK,TCBPKF        GET TCB KEY                   Y02714 24258402
SAVKEY   STC   RWORK,LSPQEKEY      SAVE FOR SETTING STORAGE KEYS Y02714 24258802
         STC   RWORK,SPQEKEY(0,RSPQE) ALSO PLACE IN SPQE         Y02714 24259202
         OC    SPQEPTR(C4,RSPQE),SPQEPTR(RSPQE) FIRST SPQE       Y02714 24260002
*                                  IF POINTER = 0                Y02714 24270002
         BNZ   GSPQESP1            NOT FIRST                     Y02714 24280002
         MVI   SPQEFLGS(RSPQE),LASTSPQE INDICATE LAST SPQE              24300002
GSPQESP1 LR    RIN1,RIN15          RESTORE REG1                         24320002
         BR    RCOMRET1            RETURN                               24340002
         SPACE 2                                                 Y02714 24350002
GTCSAKEY IC    RWORK,RQSTRKEY      GET REQUESTER KEY             Y02714 24352002
         B     SAVKEY              GO SAVE IT                    Y02714 24354002
GTSCHEDK LA    RWORK,SCHEDKEY      GET SCHEDULER KEY (FOR SWA)   Y02711 24356002
         B     SAVKEY              GO SAVE IT                    Y02711 24358002
         EJECT                                                          24360001
*********************************************************************** 24410002
*                                                                       26180001
*        ROUTINE TO HANDLE FREEING OF LIST REQUESTS                     26200001
*                                                                       26210002
*              INPUT                                                    26220001
*                   RLENGTH - ADDRESS OF LENGTH LIST                    26240001
*                   RADDR   - ADDRESS OF AREA LIST                      26260001
*              OUTPUT                                                   26280001
*                   RIN0    - ADDRESS OF CURRENT LENGTH IN LENGTH LIST  26300001
*                   RIN1    - ADDRESS OF CURRENT ADDRESS IN ADDR LIST   26320001
*              WORK                                                     26340002
*                   RFMRET                                              26360002
*                                                                       26370002
*********************************************************************** 26372002
         SPACE 2                                                 Y02714 26374002
FLISTADV LA    RFMRET,FMCOM        GO TO FMCOM FIRST TIME               26380002
         L     INDEX,CLHIBYTE      MASK TO CLEAR HIGH BYTE              26420002
FLISTAD1 L     RIN0,C0(RLENGTH)    GET CURRENT LENGTH                   26440001
         NR    RIN0,INDEX          CLEAR LAST INDICATOR                 26460001
         L     RIN1,C0(RADDR)      GET CURRENT ADDRESS                  26480001
         NR    RIN1,INDEX          CLEAR HIGH BYTE               Y02714 26530002
         STM   INDEX,RADDR,SAV911  SAVE NINE THRU ELEVEN                26540001
         BALR  RCOMRET1,RFMRET     PROCESS CURRENT ENTRY                26560001
         BAL   RCOMRET1,CLSALLOC   CLEAR SALLOC LOCK IF OBTAINED Y02751 26570002
         LM    INDEX,RADDR,SAV911  RESTORE REGS                         26580001
         TM    C0(RLENGTH),CX80    LAST ENTRY?                   Y02714 26590002
         BO    FRETRN2             YES                           Y02714 26592002
         LA    RLENGTH,C4(RLENGTH) GET NEXT LENGTH ENTRY POINTER        26600002
         LA    RADDR,C4(RADDR)     GET NEXT AREA ENTRY POINTER          26620002
         C     RLENGTH,LASTLSTA    THIS ENTRY > ORIG END OF LIST?Y02714 26630002
         BH    FRETRN2             YES, TERMINATE REQUEST HERE   Y02714 26632002
         LA    RFMRET,FCOM1        GO TO FCOM1 FOR REST OF LIST         26640002
         L     RSPQE,SPQESAVE      RESTORE SPQE REG                     26650002
         NI    FREESW,FREESWM      RESET FREESW EXCEPT FM FLAG   Y02714 26652002
         B     FLISTAD1                                                 26660001
         EJECT                                                          26760001
*********************************************************************** 26770002
*                                                                       26800001
*        ROUTINE TO HANDLE FREEING OF VARIABLE REQUESTS                 26820001
*                                                                       26830002
*              INPUT                                                    26840001
*                   RADDR - ADDRESS OF AREA; ADDRESS OF LENGTH          26860002
*              OUTPUT                                                   26880001
*                   RIN0  - LENGTH OF AREA TO BE FREED                  26900001
*                   RIN1  - ADDRESS OF AREA TO BE FREED                 26920001
*                                                                       26940001
*********************************************************************** 26950002
         SPACE 2                                                 Y02714 26960002
FVARCHK  L     RIN1,C4(RADDR)      PICK UP LENGTH                Y02714 26980002
         LA    RIN0,0(0,RIN1)      CLEAR HIGH BYTE               Y02714 26990002
         L     RIN1,C0(RADDR)      PICK UP ADDRESS TO BE FREED          27000001
         LA    RIN1,0(0,RIN1)      CLEAR HIGH BYTE               Y02714 27010002
         B     FMCOMM1A                                                 27020001
         SPACE 5                                                        27040002
*********************************************************************** 27050002
*                                                                       27080001
*        ROUTINE TO HANDLE FREEING OF ELEMENT REQUESTS                  27100001
*                                                                       27110002
*              INPUT                                                    27120001
*                   RLENGTH - LENGTH                                    27140001
*                   RADDR   - ADDRESS OF LOCATION CONTAINING ADDRESS    27160001
*              OUTPUT                                                   27180001
*                   RIN0    - LENGTH                                    27200001
*                   RIN1    - ADDRESS TO BE FREED                       27220001
*                                                                       27240001
*********************************************************************** 27250002
         SPACE 2                                                 Y02714 27260002
FELEMENT LA    RIN0,0(0,RLENGTH)   SET LENGTH, CLEAR HIGH BYTE   Y02714 27280002
         L     RIN1,C0(RADDR)      GET ADDRESS                          27300001
         LA    RIN1,0(0,RIN1)      CLEAR HIGH BYTE               Y02714 27310002
         B     FMCOMM1A                                                 27320001
         EJECT                                                          27340001
*********************************************************************** 27350002
*                                                                       27380001
*        RETURN CODE AND ABEND INTERFACE ROUTINE                        27400002
*                                                                       27410402
*              INPUT                                                    27420001
*                   RERROR   - ERROR CODE                               27440003
*                   RLENGTH  - LENGTH REQUESTED                         27450002
*                   RADDR    - ADDRESS TO BE FREED                      27452002
*                   RSPID    - SPID (GETMAIN ONLY)                      27454002
*              OUTPUT                                                   27460001
*                   ABEND CALLED                                        27470002
*                       OR                                              27480002
*                   RRETCODE - RETURN CODE TO REQUESTER                 27490002
*                                                                       27500001
* GERROR1      REAL PAGE NOT OBTAINED FOR L/SQA REQUEST                 27500803
* GERROR2      NOT USED                                                 27501803
* GERROR3      STORAGE NOT IN SPECIFIED SUBPOOL OR                      27504003
*                 NEGATIVE LENGTH FREEMAIN ON SVC 120                   27504803
* GERROR4      PP ATTEMPTING TO FREE ALL OF SP 0                        27508003
*                 SP FREEMAIN FOR INVALID SUBPOOL                       27508403
* GERROR5      LENGTH & ADDRESS LISTS OVERLAP                           27508803
* GERROR6      PARAMETER LIST NOT IN PP AREA                            27509203
*                 INPUT LIST ADDRESS NOT ON WORD BOUNDARY               27509603
*                 LIST ADDRESS NOT VALID                                27509703
* GERROR7      ISSUED BY FRR, SYSTEM ERROR                              27509803
* GERROR8      STORAGE UNAVAILABLE                                      27509903
*                 NEGATIVE LENGTH                                       27510003
* GERROR9      ADDRESS TO FREE NOT A MULTIPLE OF 8                      27514003
* GERROR10     AREA BEING FREED OVERLAPS A FREE AREA                    27515003
*                 PART OF AREA BEING FREED IS STILL FIXED               27516003
* GERROR11     PP REQUESTS SP 128-255                                   27516203
*                 AUTH. PROGRAM REQUESTS INVALID SUBPOOL                27516403
* GERROR12     NOT USED                                                 27516603
* GERROR13     REQUEST TO FREE CORE FROM SQA NOT OWNED                  27517003
*                                                                       27521003
*********************************************************************** 27525003
         SPACE 2                                                 Y02714 27530003
GERROR   EQU   *                                                        27540001
         SPACE 2                                                 Y02714 27910002
         LR    RIN1,RERROR         LOAD ERROR VALUE            @Z30ENWD 27920003
         SLL   RIN1,C8             MOVE TO BYTE 2                       27940002
         IC    RIN1,SVCBYTE        GET SVC TYPE                  Y02714 27960002
         BAL   RRETURN,FMPOSTP     FREE ANY QUEUED AREAS         Y02714 27964402
         TM    CODE1,CONDTNL       CONDITIONAL REQUEST?          Y02714 27966002
         BO    RETCODE             YES, GO CHECK R. C. TABLE     Y02714 27968002
CKERRCDE LA    RWORK,C1            ERROR 1 COMPARE VALUE         Y02714 27968402
         CR    RERROR,RWORK        IS THIS ERROR 1?              Y02714 27968802
         BE    ERRMSG3A            YES, NO MESSAGE               Y02714 27969202
         OC    LDATCB,LDATCB       IS TCB ADDRESS = 0?           YO2714 27979202
         BZ    ERRMSG3A            YES, SKIP TABLE ENTRY         Y02714 27989202
         L     RCVT,CVTPTR         GET CVT ADDRESS               Y02714 28000002
         USING CVT,RCVT                                                 28079801
*                                                                       28080703
*        CVTQMSG POINTS TO A MESSAGE TABLE, THE FIRST WORD OF THE       28081603
*        TABLE IS THE ADDRESS OF THE END OF THE TABLE, THE SECOND WORD  28082503
*        IS THE ADDRESS OF THE FIRST ENTRY, AN ADDRESS IN THE FIRST     28083403
*        WORD OF AN ENTRY INDICATES IT IS IN USE                        28084303
*                                                                       28085203
         L     RIN15,CVTQMSG       GET ADDRESS OF INFOLIST              28086602
         DROP  RCVT                                              Y02714 28087002
         L     RWORK,C0(RIN15)     ADDRESS OF END OF LIST               28088601
         LA    RIN15,C4(RIN15)     ADDRESS OF 1ST ENTRY                 28090601
         L     RASCB,PSAAOLD       GET CURRENT ASCB ADDRESS      Y02714 28092602
ERRMSG1  CR    RIN15,RWORK         ANY MORE ENTRIES TO SEARCH?          28093101
         BE    ERRMSG3A            NO - CANNOT MAKE ENTRY               28093202
         SR    RWORK3,RWORK3       ZERO REG FOR COMPARE                 28095202
         USING INFOLIST,RIN15                                           28097401
         CS    RWORK3,RASCB,INFASCB  IF AVAIL., STORE ASCB ADDR. Y02714 28099402
         BZ    ERRMSG2             ENTRY WAS OBTAINED            Y02714 28101402
         LA    RIN15,INFLEN(RIN15) GET NEXT ENTRY                       28101501
         B     ERRMSG1             SEE IF THERE IS ONE                  28104501
         SPACE 2                                                        28106501
ERRMSG2  MVC   INFTCB,PSATOLD      STORE CURRENT TCB ADDRESS     Y02714 28108502
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 28108902
         BZ    SVCENTRY            NO - MOVE IN DATA                    28109201
         OI    INFFLG,INFFLG0      SET BRANCH ENTRY SW                  28109601
         MVC   INFBADDR(C4),BRANCHSV+C56 MOVE RETURN ADDRESS            28110501
SVCENTRY STH   RIN1,INFCC          STORE ABEND CODE                     28111301
         TM    SPFLAGS,NEEDAQE     AQE REQUEST?                  Y02714 28111702
         BZ    ERRMSG2A            NO - NO ADJUSTMENTS NEEDED           28111801
         TM    FREESW,INCR         HAS LENGTH BEEN INCREMENTED?         28111901
         BZ    ERRMSG2A            NO                                   28112401
         SH    RLENGTH,H8          DECREMENT LENGTH BY 8 (AQE LEN)      28112802
         TM    FREESW,DECR         HAS ADDRESS BEEN DECREMENTED?        28113201
         BZ    ERRMSG2A            NO                                   28113301
         AH    RADDR,H8            INCREMENT ADDRESS BY 8 (AQE LEN)     28113401
ERRMSG2A ST    RLENGTH,INFVAR1     ST LENGTH OR PARAMETER LIST ADDR     28114301
         TM    FREESW,FREESWM      FREEMAIN?                            28114401
         BZ    ERRMSG2B            NO                                   28114501
         IC    RSPID,SAVSPID       GET SUBPOOL ID                       28114601
ERRMSG2B STC   RSPID,INFVAR1       STORE SPID OR ZERO                   28114701
         TM    FREESW,FREESWM      FREEMAIN?                            28114801
         BO    FREE                YES                                  28114901
         MVC   INFVAR2(C4),ABNDATA VARIABLE DATA                        28115301
         B     ERRMSG3             GO SET REASON CODE                   28115701
         SPACE 2                                                        28115801
FREE     MVC   INFVAR3(C4),ABNDATA VARIABLE DATA                        28115901
         TM    FLAGS,DEFERR10      IS IT DEFERED ERROR 10      @YM07648 28116003
         BZ    STVAR2              IF NOT RADDR IS OK          @YM07648 28118003
         TM    MODE,SUBFRMN        IS IT SUBPOOL FREEMAIN      @YM07648 28120003
         BZ    STVAR2              IF NOT RADDR IS OK          @YM07648 28122003
         MVC   INFVAR2(4),SVRLB    GET CORRECT ADDRESS FROM THE CALL    28127802
*                                  TO RELEASE                  @YM07648 28133803
         B     ERRMSG3             GO SET REASON CODE          @YM07648 28139803
STVAR2   ST    RADDR,INFVAR2       STORE ADDRESS BEING FREED            28145802
ERRMSG3  MVC   INFRCL(C1),MSGLEN   SET REASON CODE & MSGLEN             28151802
         DROP  RIN15                                             Y02714 28157802
ERRMSG3A XC    ABNDATA(ABNDATAL),ABNDATA  CLEAR WORK FIELDS             28163802
         BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 28169802
ABENDUSR ABEND (1),DUMP,,SYSTEM    ABEND USER                    Y02714 28175802
         SPACE 2                                                        28186801
RETCODE  SR    RRETCODE,RRETCODE   CLEAR FOR RETURN CODE         Y02714 28187202
         LA    RWORK,RCTABLE-1(RERROR) GET RETURN CODE TABLE ADDRY02714 28187602
         IC    RRETCODE,0(0,RWORK) GET TABLE ENTRY               Y02714 28188002
         LTR   RRETCODE,RRETCODE   IS CODE ZERO?                 Y02714 28188402
         BZ    CKERRCDE            YES, ABEND REQUESTER          Y02714 28188502
         TM    0(RWORK),CX80       SHOULD REASON CODE BE CHECKED?Y02714 28188602
         BZ    DLTFRR              NO, FINISH PROCESSING         Y02714 28190602
         LA    RWORK,C3            CONSTANT OF 3                 Y02714 28192602
         CR    RERROR,RWORK        IS IT ERROR 3?                Y02714 28193002
         BE    ERRCODE3            YES                           Y02714 28193402
         LA    RWORK,C8            CONSTANT OF 8                 Y02714 28193802
         CR    RERROR,RWORK        IS IT ERROR 8?                Y02714 28193902
         BE    ERRCODE8            YES                           Y02714 28194002
         TM    MSGLEN,CX40         ERROR CODE 10, CK REAS CODE   Y02714 28194102
         BZ    RESETBT0            NOT REASON CODE 2             Y02714 28194202
         L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 28194302
         TM    TCBFBYT1,TCBEOTFM   EOT?                          Y02714 28194802
         BZ    CHKFPFM             NO, CHECK FOR FREEMAIN FROM @ZA05954 28195040
*                                  FREEPART                             28195240
         B     SETRC8              YES, GO SET RETURN CODE     @ZA05954 28195740
CHKFPFM  TM    LDAFLAGS,LDAFPFM    FREEMAIN DONE BY FREEPART?  @ZA05954 28195940
         BZ    CKERRCDE            NO, ABEND REQUESTER                  28196140
SETRC8   LA    RRETCODE,C8         YES, SET RETURN CODE OF 8     Y02714 28196340
RESETBT0 N     RRETCODE,RCMASK     RESET BIT 0 IN RETURN CODE    Y02714 28196540
DLTFRR   BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 28197140
         XC    ABNDATA(ABNDATAL),ABNDATA  CLEAR WORK FIELDS      Y02714 28197702
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 28199802
         BO    RSTREGS             YES                           Y02714 28201702
         L     RRETURN,RETSAVE     GET RETURN ADDRESS            Y02714 28203602
         BR    RRETURN             RETURN TO SVC INTERRUPT HANDLRY02714 28205502
         SPACE 2                                                 Y02714 28207402
RSTREGS  LM    RIN0,RRETURN,BRANCHSV RESTORE REGISTERS           Y02714 28209302
         USING LDA,RASCB                                         Y02714 28211202
         L     RASCB,PASCBSV       RESTORE ASCB POINTER          Y02714 28213102
         DROP  RASCB                                             Y02714 28215002
         BR    RRETURN             RETURN WITH RETURN CODE       Y02714 28216902
         SPACE 2                                                 Y02714 28218802
ERRCODE3 TM    MSGLEN,CX80         IS REASON CODE 4?             Y02714 28220702
         BZ    RESETBT0            NO, GIVE RETURN CODE          Y02714 28222602
         B     CKERRCDE            YES, ABEND                    Y02714 28224502
         SPACE 2                                                 Y02714 28226402
ERRCODE8 TM    MSGLEN,CX40         IS REASON CODE 2?             Y02714 28228302
         BZ    RESETBT0            NO, GIVE RETURN CODE          Y02714 28230202
         B     CKERRCDE            YES, ABEND                    Y02714 28232102
         EJECT                                                          28234002
*********************************************************************** 28284003
*                                                                       28334003
*        THIS ROUTINE BUILDS AN AQE AT THE BEGINNING OF THE AREA TO BE  28384003
*              ALLOCATED AND CHAINS THE AQE ONTO THE TCBAQE QUEUE.      28434003
*                                                                       28437003
*                   INPUT  - RFQE     - ADDRESS OF FQE                  28446003
*                            RLENGTH  - LENGTH OF REQUEST               28464003
*                            RCOMRET1 _ RETURN ADDRESS                  28464703
*                   OUTPUT - AQE BUILT & IN TCBAQE QUEUE                28466103
*                   WORK   -  RWORK, RIN15                              28468203
*                                                                       28468503
*********************************************************************** 28469203
         SPACE 2                                                 Y02714 28469503
GBLDAQE  LA    RWORK,C8(RFQE)      GET END ADDRESS OF AREA              28469703
         SR    RWORK,RLENGTH       GET BEGINNING ADDRESS                28470003
         L     RIN15,LDATCB        GET TCB ADDRESS               Y02714 28482003
         USING TCB,RIN15                                         Y02714 28491003
         MVC   C0(C4,RWORK),TCBAQE PUT POINTER IN NEW AQE               28494003
         ST    RLENGTH,C4(RWORK)   PUT LENGTH IN AQE                    28495603
         ST    RWORK,TCBAQE        PUT AQE IN QUEUE                     28496003
         DROP  RIN15                                             Y02714 28496403
         BR    RCOMRET1            RETURN                               28496503
         EJECT                                                          28496603
*********************************************************************** 28496703
*                                                                       28500001
*        MAINLINE CONTROL ROUTINE FOR GETMAIN                           28520001
*                                                                       28530002
*              INPUT                                                    28540001
*                   RIN1    - ADDRESS OF PARAMETER LIST                 28560001
*                   RSPID   - SPID                                      28600001
*                   RADDR   - ADDRESS OR LIST OF ADDRESSES              28620001
*                   RLENGTH - LENGTH OR LIST OF LENGTHS                 28640001
*                                                                       28660001
*********************************************************************** 28670002
         SPACE 2                                                 Y02714 28680002
GMCOMMON TM    CODE1,LISTVAR       LIST REQUEST                  Y02714 28700002
         BM    GLIST               YES                                  28720001
         BZ    CLRHIBYT            BR IF SINGLE ELEMENT        @ZA17759 28730040
*                                  IT IS A VARIABLE REQUEST             28760003
         MVC   MINMAX(C8),C0(RLENGTH) GET MAX & MIN LENGTHS             28780002
         L     RLENGTH,MINMAX+4    GET MAXIMUM LENGTH                   28820002
*                                                                       28822040
*        FOR ELEMENT AND VARIABLE REQUESTS, THE HIGH ORDER BYTE         28824040
*        OF THE LENGTH IS CLEARED TO PREVENT GOING THROUGH GETMAIN      28826040
*        WITH A REQUEST FOR ZERO BYTES.  ROUTINE GLIST DOES THIS        28828040
*        FOR LIST REQUESTS. A 32 BIT LENGTH VALUE COULD RESULT IN       28830040
*        X'00000000' OR X'80000000' AFTER IT WAS ROUNDED UP BY          28830840
*        ROUTINE CRNDLNTH.                                     @ZA17759 28831640
*                                                                       28832440
CLRHIBYT LA    RLENGTH,0(0,RLENGTH) CLEAR HIGH BYTE OF LENGTH  @ZA17759 28834040
GMCOMM1  BAL   RCOMRET1,CSPCHK     FIND SPQE                            28840001
GCOMM4   LTR   RLENGTH,RLENGTH     NEGATIVE REQUEST                     28860001
         BM    GERROR8A            YES, ERROR                    Y02714 28880002
         BZ    GCOMM11             ZERO BYTES                           28900002
         LTR   RSPQE,RSPQE         SPQE FOUND                           28920001
         BNZ   ROUND               YES                                  28940001
         BAL   RCOMRET1,GSPQESPC   GETMAIN & CREATE SPQE                28960001
ROUND    BAL   RCOMRET1,CRNDLNTH   ROUND TO 8 BYTE MULTIPLE             28980001
         STM   RIN0,RIN15,GMREPSAV SAVE REGS FOR REPEAT REQUEST         29000001
GMREPEAT TM    SPFLAGS,LSQA+SQA    L/SQA REQUEST                        29020002
         BNZ   CLGFORE             YES                                  29040001
         TM    CODE1,BOUND         PAGE BOUNDARY?                Y02714 29050002
         BO    GLSTDQE             YES                                  29052001
         C     RLENGTH,MAXFQESZ    REQ GREATER THAN MAX FQE SIZE Y02714 29060002
         BH    GLSTDQE             YES                                  29080001
         BAL   RCOMRET1,GFRECORE   SEARCH FOR FREE STORAGE              29100002
         B     DET4KBLK            NOT FOUND                            29120002
         BAL   RCOMRET1,GFQEUPDT   REMOVE STORAGE FROM FQE              29140002
         SPACE 2                                                        29160001
GCOMM2   BAL   RCOMRET1,CLSALLOC   CLEAR SALLOC LOCK IF OBTAINED Y02751 29170002
         SPACE 2                                                 Y02751 29172002
GCOMM3   TM    CODE1,LISTVAR       LIST REQUEST                  Y02714 29180002
         BM    GLIST1              YES                                  29200001
         BZ    GCOMM8              SINGLE ELEMENT                       29220001
         ST    RFQE,C0(RADDR)      ADDRESS ASSIGNED                     29240002
         ST    RLENGTH,C4(RADDR)   LENGTH OF AREA ASSIGNED              29260002
GCOMM5   SR    RRETCODE,RRETCODE   SET RETURN CODE = 0           Y02714 29280002
         BAL   RRETURN,FMPOSTP     FREE ANY QUEUED AREAS         Y02714 29290002
         BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 29291002
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 29300002
         L     RRETURN,RETSAVE     GET RETURN ADDRESS                   29310002
         L     RIN1,SAVEREG1       RESTORE PARAMETER LIST ADDR   Y02714 29312002
         BZR   RRETURN             NO                            Y02714 29320002
         LM    RIN0,RRETURN,BRANCHSV RESTORE REGISTERS                  29340002
         USING LDA,RASCB                                         Y02714 29342002
         L     RASCB,PASCBSV       RESTORE ASCB ADDRESS          Y02714 29350002
         DROP  RASCB                                             Y02714 29352002
         BR    RRETURN             RETURN                               29360001
         SPACE 2                                                        29380001
GCOMM11  SR    RFQE,RFQE           ZERO ADDRESS ASSIGNED                29382001
         B     GCOMM3              STORE ADDRESS IN AREA SPECIFIED      29384002
         SPACE 2                                                        29386001
GCOMM8   CLI   SVCBYTE,SV10        REGISTER TYPE REQUEST?        Y02714 29390002
         BNL   GCOMM9              YES                                  29392002
         ST    RFQE,C0(RADDR) STORE ASSIGNED ADDRESS WHERE INDICATED    29394002
         B     GCOMM5              RETURN                               29396002
         SPACE 2                                                        29398001
GCOMM9   LR    RIN1,RFQE           PUT ADDRESS ASSIGNED IN REG 1        29398402
         SR    RRETCODE,RRETCODE   ZERO RETURN CODE              Y02714 29398802
         BAL   RRETURN,FMPOSTP     FREE ANY QUEUED AREAS         Y02714 29398902
         BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 29399102
         TM    FLAGS,BRENTRY       BRANCH ENTRY?                 Y02714 29399202
         BO    GCOMM10             YES                                  29399602
         L     RRETURN,RETSAVE     GET RETURN ADDRESS                   29399702
         BR    RRETURN             RETURN                               29399802
         SPACE 2                                                        29399901
GCOMM10  L     RIN0,BRANCHSV       RESTORE REG 0                        29406602
         LM    RAREG,RRETURN,BRANCHSV+C8 RESTORE REMAINING REGS         29408602
         USING LDA,RASCB                                         Y02714 29409002
         L     RASCB,PASCBSV       RESTORE ASCB ADDRESS          Y02714 29410602
         DROP  RASCB                                             Y02714 29411002
         BR    RRETURN             RETURN                               29412602
         SPACE 2                                                        29413001
CLGFORE  BAL   RCOMRET1,GFRECORE   SEARCH FOR FREE CORE          Y02714 29413302
         B     GNOTSATA            OUT OF VIRTUAL L/SQA                 29420001
         TM    SPFLAGS,NEEDAQE     AQE NEEDED?                   Y02714 29440002
         BZ    GCOMM6              NO                                   29460001
         BAL   RCOMRET1,GBLDAQE    BUILD AQE                   @Z30ENWD 29490003
GCOMM6   BAL   RCOMRET1,GFQEUPDT   REMOVE CORE FROM FQE                 29500001
         B     GCOMM2                                            Y02714 29520002
         SPACE 2                                                        29640001
GLSTDQE  L     RDQE,SPDQEPTR(RSPQE) GET FIRST DQE                Y02714 29680002
         LTR   RDQE,RDQE           IS THERE ONE                  Y02714 29700002
         BZ    NODQE               NO                                   29720002
LASTDQE  LR    RPREVDQE,RDQE       MAKE CURRENT PREVIOUS                29740002
         L     RDQE,DQEPTR(RPREVDQE) GET NEXT DQE                       29760002
         LTR   RDQE,RDQE           IS THERE ONE                  Y02714 29780002
         BNZ   LASTDQE             YES - KEEP SEARCHING FOR LAST        29800002
DET4KBLK LA    SIZEREG,C4095       DETERMINE                     Y02714 29820002
         LR    RAREG,SIZEREG          NUMBER                            29840002
         AR    SIZEREG,RLENGTH             OF 4K                        29860002
         OR    SIZEREG,RAREG                BLOCKS                      29880002
         XR    SIZEREG,RAREG                   REQUIRED                 29900002
         BAL   RRETURN,G4KSRCH1    GET 4K BLOCKS               @Y30APYF 29920003
         B     GCOMM2              FOUND                         Y02714 29940002
         B     GNOTSATB            NOT FOUND                            29980002
         SPACE 2                                                        30000001
NODQE    LR    RPREVDQE,RSPQE      MAKE SPQE THE LAST DQE               30020002
         B     DET4KBLK                                                 30040001
         SPACE 2                                                        30042001
GERROR8A MVI   MSGLEN,H48          REASON 2 - MSGLEN 8           Y02714 30046002
         ST    RLENGTH,ABNDATA     SAVE FULL LENGTH              Y02714 30047002
         LA    RERROR,ERR8         NEGATIVE LENGTH SPECIFIED   @Z30ENWD 30047203
         B     GERROR                                          @Z30ENWD 30047803
         EJECT                                                          30048402
*********************************************************************** 30048802
*                                                                       30049202
*        GETMAIN LIST PROCESSOR                                         30049602
*                                                                       30049702
*              INPUT                                                    30049802
*                   RADDR   - POINTER TO ADDRESS LIST                   30049902
*                   RLENGTH - POINTER TO LENGTH LIST                    30050002
*              OUTPUT                                                   30052702
*                   RLENGTH - CURRENT LENGTH REQUESTED                  30054702
*              WORK                                                     30054802
*                   RWORK, INDEX                                        30054902
*                                                                       30055102
*********************************************************************** 30055502
         SPACE 2                                                 Y02714 30055602
GLIST    XC    LSTINDEX,LSTINDEX   CLEAR INDEX FIELD                    30055902
         ST    RLENGTH,LENSAVE     SAVE LENGTH LIST POINTER             30056002
         L     RLENGTH,C0(RLENGTH) GET 1ST LENGTH                       30056102
         ST    RLENGTH,LASTSAVE    SAVE POSSIBLE LAST ENTRY             30056202
         LA    RLENGTH,0(0,RLENGTH) CLEAR LIST END FLAG          Y02714 30056302
         B     GMCOMM1             PROCESS FIRST ENTRY                  30056502
         SPACE 2                                                        30056602
GLIST1   L     RWORK,LSTINDEX      GET ENTRY DISPLACEMENT               30056702
         ST    RFQE,C0(RWORK,RADDR)  STORE ADDRESS IN LIST              30056802
         L     INDEX,LENSAVE       RESTORE LENGTH LIST POINTER          30057102
         TM    LASTSAVE,CX80       LAST ENTRY?                   Y02714 30057502
         BO    GCOMM5              RETURN - LIST SATISFIED              30057902
         LA    RWORK,C4(RWORK)     INCREMENT INDEX                      30058002
         ST    RWORK,LSTINDEX      SAVE IT                              30058102
         L     RLENGTH,C0(RWORK,INDEX)  GET NEXT LENGTH                 30058202
         ST    RLENGTH,LASTSAVE    SAVE POSSIBLE LAST LENGTH            30058302
         LA    RLENGTH,0(0,RLENGTH) CLEAR LIST END FLAG          Y02714 30058402
         LA    RWORK,0(RWORK,INDEX) GET ADDRESS OF CURRENT LENGTHY02714 30058502
         C     RWORK,LASTLSTA      ORIG END OF LIST EXCEEDED?    Y02714 30058602
         BH    GCOMM5              YES, TERMINATE REQUEST        Y02714 30058702
         B     GCOMM4              PROCESS NEXT LENGTH                  30058802
         EJECT                                                          30058902
*********************************************************************** 30060402
*                                                                       30061702
*        TURN ON INHIBIT GETMAIN FLAG FOR REAL STORAGE MANAGEMENT       30061802
*                                                                       30061902
*              INPUT                                                    30064902
*                   RCOMRET1 - RETURN ADDRESS                           30067602
*              OUTPUT                                                   30068002
*                   PVTBGMS FLAG IN PVT TURNED ON                       30068402
*              WORK                                                     30068802
*                   RPVT                                                30068902
*                                                                       30069202
*********************************************************************** 30070002
         SPACE 2                                                        30072002
TRNONPVT L     RCVT,CVTPTR         GET CVT POINTER               Y02714 30078002
         USING CVT,RCVT                                          Y02714 30081002
         L     RPVT,CVTPVTP        GET POINTER TO PVT                   30084002
         DROP  RCVT                                                     30090002
         USING PVT,RPVT                                                 30093002
         SPACE 2                                                        30096002
         OI    PVTFLAG1,PVTBGMS    TURN ON PVTBGMS                      30099002
         BR    RCOMRET1            RETURN TO MAINLINE                   30102002
         SPACE 2                                                 Y02714 30105002
         DROP  RPVT                                              Y02714 30108002
         EJECT                                                          30111002
*********************************************************************** 30114002
*                                                                     * 30117002
*   THE FREEMAIN COMMON ROUTINE IS ENTERED AT VARIOUS ENTRY POINTS    * 30120002
*   TO HANDLE ALL FREEMAINS. FOR A REGION FREEMAIN, IF A PAGE OR      * 30140002
*   MULTIPLES OF A PAGE ARE FREED, THE PAGE IS MARKED NOT GETMAINED   * 30160001
*   AND A RELEASE PAGE IS DONE ON IT TO UNHOOK IT FROM THE PAGING     * 30180002
*   SUPERVISOR QUEUES. FOR SQA/LSQA THE SAME IS DONE, IN ADDITION THE * 30200001
*   RELEASE PAGE CAUSES THE FIXED PAGE TO BE RELEASED. THE VARIOUS    * 30220002
*   ENTRY POINTS AND THEIR CALLERS ARE:                               * 30240002
*                                                                     * 30260001
*      ENTRY                                                          * 30280001
*                                                                     * 30300001
*      FMCOMMON  -  FROM ENTRY PROCESSING TO FREE SPACE FOR SVC 5 TYPE* 30320001
*                   REQUESTS                                          * 30340001
*                                                                     * 30360001
*      FMCOMM1   -  FROM ENTRY PROCESSING TO FREE SPACE FOR SVC 10    * 30380001
*                   AND SVC 120 TYPE REQUESTS                         * 30400002
*                                                                     * 30420001
*      FCOM1     -  FOR SECOND AND SUBSEQUENT ENTRIES IN A LIST       * 30440001
*                   REQUEST TO BYPASS THE SPQE CHECK                  * 30460001
*                                                                     * 30480001
*      SP253FR   -  FROM SUBPOOL FREEMAIN (SPFRMAIN) TO FREE AQE AND  * 30500001
*                   AREA ASSOCIATED WITH IT                           * 30520001
*                                                                     * 30560001
*      SPREL     -  FROM SPFRMAIN TO FREE DQE AND ALL SPACE ASSOCIATED* 30580002
*                   WITH IT.                                          * 30600001
*                                                                     * 30620001
*      FMAINC    -  FROM VIRTUAL STORAGE MANAGEMENT ROUTINES TO FREE  * 30630003
*                   VSM CELLS                                         * 30632003
*                                                                     * 30634003
*      FMAINB    -  FROM VIRTUAL STORAGE MANAGEMENT ROUTINES TO FREE  * 30640002
*                   CONTROL BLOCKS THAT ARE NOT CELL LENGTH           * 30660003
*                                                                     * 30680001
*      CONTENTS OF REGS ON INPUT TO FMAINB                            * 30700002
*                                                                     * 30720001
*        RIN0     (0) - SUBPOOL ID IN HIGH ORDER BYTE AND LENGTH IN   * 30820002
*                       THREE LOW ORDER BYTES                         * 30830002
*        RIN1     (1) - ADDRESS TO BE FREED                           * 30890002
*                                                                     * 31040001
*        LDARQSTA     - BYTE 0   - FLAGS                              * 31050002
*                       BYTE 1   - SUBPOOL FLAGS                      * 31052002
*                       BYTE 2   - SVC NUMBER                         * 31054002
*                       BYTE 3   - KEY AND MODE                       * 31056002
*                                                                     * 31058002
*      WHEN REQUEST IS AN SVC 10 OR SVC 120 OR FROM RMBRANCH,         * 31060002
*      CRBRANCH, OR GLBRANCH                                          * 31070002
*                                                                     * 31080001
*        RIN1     (1) - ADDRESS TO BE FREED OR ZERO IF FREE OF        * 31100002
*                       COMPLETE SUBPOOL                              * 31120002
*        RLENGTH (10) - LENGTH TO BE FREED OR ZERO IF FREE OF         * 31160002
*                       COMPLETE  SUBPOOL                             * 31180002
*                                                                     * 31200001
*      WHEN REQUEST IS AN SVC 5 OR FROM FMBRANCH                      * 31220001
*                                                                     * 31240001
*        1 - NORMAL FREEMAIN                                          * 31260001
*                                                                     * 31280001
*        RLENGTH (10) - POINTER TO LENGTH LIST OR LENGTH              * 31300002
*        RADDR   (11) - POINTER TO ADDRESS OR LIST OF ADDRESSES       * 31340002
*                                                                     * 31360001
*        2 - VARIABLE FREEMAIN                                        * 31380001
*                                                                     * 31400001
*        RIN1     (1) - ADDRESS OF PARAMETER LIST                     * 31420002
*        RADDR   (11) - POINTER TO TWO WORDS; FIRST WORD ADDRESS,     * 31460002
*                       SECOND WORD CONTAINS LENGTH                   * 31480002
*                                                                     * 31500001
*********************************************************************** 31560001
         SPACE 2                                                 Y02714 31570002
FMCOMMON TM    CODE1,LISTVAR       CHECK TYPE OF REQUEST         Y02714 31600002
         BM    FLISTADV            LIST REQUEST                  Y02714 31620002
         BO    FVARCHK             VARIABLE REQUEST              Y02714 31640002
         B     FELEMENT            ELEMENT REQUEST                      31660002
         SPACE 2                                                 Y02714 31670002
FMCOMM1  LTR   RIN1,RIN1           SUBPOOL FREEMAIN                     31680002
         BZ    SPFRMAIN            YES                                  31700002
         LA    RIN1,0(0,RIN1)      CLEAR HIGH BYTE OF ADDRESS  @ZA14231 31710040
FMCOMM1A BAL   RCOMRET1,FMCOM      GO TO COMMON PROCESSING ROUTINE      31720002
FRETRN2  SR    RRETCODE,RRETCODE   ZERO RETURN CODE              Y02714 31722002
         MVI   FREESW,C0           ZERO FREESW                          31752001
         BAL   RRETURN,FMPOSTP     DO FREEMAIN POST PROCESSING   Y02714 31754002
         BAL   RRETURN,FRRDELET    GO DELETE FRR                 Y02753 31755002
         TM    FLAGS,BRENTRY       BRANCH ENTRY                  Y02714 31760002
         BO    FRETRN3             YES                           Y02714 31780002
         L     RRETURN,RETSAVE     GET RETURN ADDRESS            Y02714 31790002
         L     RIN1,SAVEREG1       RESTORE REGISTER 1            Y02714 31790402
         BR    RRETURN             RETURN                        Y02714 31792002
         SPACE 2                                                 Y02714 31794002
FRETRN3  LM    RIN0,RRETURN,BRANCHSV RESTORE REGS                Y02714 31800002
         USING LDA,RASCB                                         Y02714 31802002
         L     RASCB,PASCBSV       RESTORE ASCB ADDRESS          Y02714 31810002
         DROP  RASCB                                             Y02714 31812002
         BR    RRETURN              RETURN TO BR ENTRY CALLER           31820003
         EJECT                                                          31830003
FMAINC   STM   RCOMRET1,REGB,CSAVE+C48  SAVE REGS 9-11         @Z30ENWD 31830203
         OI    CELLFLGS,INCELL     SET FLAG FOR FRR USE        @Z30ENWD 31830403
         L     REGA,CVTPTR         GET CVT ADDRESS             @Z30ENWD 31830603
         USING CVT,REGA                                        @Z30ENWD 31830803
         C     RIN1,CVTSHRVM       IS CELL IN PRIVATE AREA?    @Z30ENWD 31831003
         BL    LCLRTN              YES, A LOCAL REQUEST        @Z30ENWD 31831203
         SPACE                                                          31831603
         BAL   RCOMRET1,GTSALLOC   GET THE GLOBAL LOCK         @Z30ENWD 31831703
         L     REGA,CVTGDA         GET THE GDA ADDRESS         @Z30ENWD 31831803
         DROP  REGA                                                     31831903
         USING GDA,REGA                                                 31832003
         LA    REGA,GLBLCELL       GET THE ANCHOR ADDRESS      @Z30ENWD 31834003
         B     CELRTN              RETURN THE CELL             @Z30ENWD 31834603
         SPACE                                                          31835203
LCLRTN   LA    REGA,LCLCELL        GET THE ANCHOR ADDRESS      @Z30ENWD 31835803
         OI    CELLFLGS,LCLREQ     SET FLAG FOR FRR USE        @Z30ENWD 31836103
         SPACE                                                          31836403
CELRTN   L     REGB,C0(,REGA)      GET POINTER TO FIRST CELL   @Z30ENWD 31837603
         ST    RIN1,C0(,REGA)      CHAIN RETURNED CELL         @Z30ENWD 31838003
         ST    REGB,C0(,RIN1)      RECHAIN QUEUE               @Z30ENWD 31838403
         L     REGB,C4(,REGA)      PICK UP CELL COUNT          @Z30ENWD 31838803
         LA    REGB,C1(REGB)       UPDATE COUNT                @Z30ENWD 31839203
         ST    REGB,C4(,REGA)      STORE UPDATED COUNT         @Z30ENWD 31839603
         LM    RCOMRET1,REGB,CSAVE+C48  RESTORE REGS 9-11      @Z30ENWD 31840003
         NI    CELLFLGS,ALL-INCELL-LCLREQ RESET FLAGS          @Z30ENWD 31840403
         BR    RCOMRET1            RETURN TO CALLER            @Z30ENWD 31840803
         DROP  REGA                                                     31842003
         SPACE 3                                                        31842503
FMAINB   STM   RIN0,RIN15,FSAVE    SAVE REGS                            31843003
         MVC   DQESAVE1(C32),DQESAVE SAVE DQE AND OTHER POINTERS Y02714 31852003
         L     RWORK,LDARQSTA      SAVE CURRENT                  Y02714 31854003
         ST    RWORK,SAVSVTSV         REQUEST STATUS             Y02714 31856003
         L     RWORK,SETUPFMB      SET UP STATUS FOR FREEMAIN    Y02714 31858503
         ST    RWORK,LDARQSTA         OF A CONTROL BLOCK         Y02714 31861403
         MVC   SAVSPID2(1),SAVSPID SAVE SP ID FOR MESSAGES     @YM07648 31864403
         MVC   SAVFRESW,FREESW     SAVE CURRENT FREESW           Y02714 31867503
         MVI   FREESW,C0           CLEAR NEW FREESW              Y02714 31870403
         LR    RSPID,RIN0          GET SPID AND LENGTH           Y02714 31871403
         LA    RIN0,0(0,RSPID)     CLEAR SPID FROM LENGTH        Y02714 31873303
         SRL   RSPID,C24           MOVE SPID TO LOW ORDER BYTE   Y02714 31875303
         BAL   RCOMRET1,FMCOM      GO TO COMMON PROCESSING ROUTINE      31880003
         MVC   SAVSPID(1),SAVSPID2 REST SP ID FOR MESSAGES     @YM07648 31882003
         L     RWORK,SAVSVTSV      RESTORE CURRENT               Y02714 31884003
         ST    RWORK,LDARQSTA       REQUEST STATUS               Y02714 31886003
         LM    RIN0,RIN15,FSAVE    RESTORE REGS                         31888003
         MVC   DQESAVE(C32),DQESAVE1  RESTORE POINTERS           Y02714 31892002
         MVC   FREESW,SAVFRESW     RESTORE FREESW                Y02714 31894002
         BR    RCOMRET1            RETURN                               31900002
         EJECT                                                          31910003
*********************************************************************** 31920002
*                                                                     * 31930002
*        FMCOM IS THE ROUTINE WHICH HANDLES ALL COMMON FREEMAIN       * 31940002
*        PROCESSING. EXCEPTIONS TO THIS ARE THE TWO SUBPOOL           * 31960002
*        FREEMAIN ENTRIES SP253FR AND SPREL. FCOM1 IS ALSO            * 31980002
*        USED FOR THE SECOND AND ALL SUBSEQUENT ENTRIES OF A LIST     * 32000001
*        REQUEST TO BYPASS THE SPQE CHECK.                            * 32020002
*                                                                     * 32040001
*********************************************************************** 32060001
         SPACE 2                                                 Y02714 32062002
FMCOM    OI    FREESW,FREESWM      INDICATE FREEMAIN                    32072002
         ST    RCOMRET1,FMSAVE     SAVE RETURN REG                      32080001
         BAL   RCOMRET1,CSPCHK     GO TO CHECK FOR SPQE                 32100002
FCOM1    LTR   RSPQE,RSPQE         SUBPOOL FOUND                 Y02714 32560002
         BNZ   SPQEFND             YES                           Y02714 32570002
         LR    RADDR,RIN1          SAVE AREA ADDRESS           @YM33014 32575003
         MVI   MSGLEN,H4C          REASON CODE 2 - LENGTH 12            32580002
         LA    RERROR,ERR3         SET PROPER ERROR CODE       @Z30ENWD 32590003
         B     GERROR3C            GO SET UP REMAINING PARAMETERS       32600001
         SPACE 2                                                        32602001
SPQEFND  TM    SPFLAGS,LSQA        LSQA REQUEST                  Y02714 32620002
         BZ    INLSQA              NO                                   32640002
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 32690002
         USING CVT,RCVT                                          Y02714 32692002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 32694002
         DROP  RCVT                                              Y02714 32696002
         USING GDA,RGDA                                          Y02714 32698002
         L     RWORK,PASTRT        GET PRIVATE AREA SIZE         Y02714 32698402
         A     RWORK,PASIZE        ADD LENGTH, GIVES BOTTOM CSA  Y02714 32698802
         CR    RIN1,RWORK          IS STORAGE IN SQA?            Y02714 32699602
         BL    INLSQA              NO                                   32700002
         L     RSPQE,SQASPQEP      SQA SPQE INSTEAD OF LSQA      Y02714 32720002
         DROP  RGDA                                              Y02714 32722002
         XI    SPFLAGS,SQA+LSQA    RESET LSQA; SET SQA           Y02714 32724002
         MVI   LDACBSP,CBSQA       CONTROL BLOCKS IN SQA       @ZA05196 32725040
INLSQA   LR    RLENGTH,RIN0        LENGTH                               32730002
         ST    RSPQE,SPQESAVE      SAVE SPQE REG IN CASE OF LIST        32750002
         LR    RADDR,RIN1          PICK UP ADDR                @YM07655 32751003
         LTR   RLENGTH,RLENGTH     ZERO BYTE REQUEST             Y02714 32752002
         BZ    FMLEAVE             YES, RETURN                          32754002
         BM    NEGLEN78            BR IF LENGTH NEGATIVE       @YM07655 32755003
         LTR   RADDR,RADDR         TEST FOR NEGATIVE ADDRESS   @YM07655 32756003
         BM    NEGLEN78            BR IF ADDRESS NEGATIVE      @YM07655 32757003
         BAL   RCOMRET1,CRNDLNTH   ROUND LENGTH TO MULTIPLE OF 8 BYTES  32760002
*                                  RWORK CONTAINS SEVEN FROM CRNDLNTH   32780002
         NR    RWORK,RADDR         TEST ADDRESS FOR MULTIPLE OF 8       32820002
         BNZ   GERROR9A            ADDRESS NOT A MULTIPLE OF 8          32840002
         TM    SPFLAGS,NEEDAQE     AQE REQUEST                   Y02714 32860002
         BZ    DONTBACK            NO                                   32880002
         LA    RWORK,AQESIZE       SUBTRACT AQESIZE (8) FROM     Y02714 32900002
         SR    RADDR,RWORK          BEGIN ADDRESS                       32920002
         SPACE 5                                                 Y02714 32970002
*                                                                       32980002
*        FMCOMMON - FIND DQE WHICH ENCOMPASSES AREA BEING FREED         32982002
*                                                                       32984002
         SPACE 2                                                 Y02714 32986002
DONTBACK TM    SPFLAGS,SQA+CSA     IS THIS SQA OR CSA REQUEST?   Y02751 32990002
         BZ    SCDQE               NO                            Y02751 32992002
         BAL   RCOMRET1,GTSALLOC   GET SALLOC LOCK               Y02751 32994002
SCDQE    LR    RDQE,RSPQE          INITIALIZE DQE PTR            Y02751 33000002
         TM    SPFLAGS,SQA+CSA     IF SP227, 228, OR 239 SET NOT FIRST  33001003
*                                  DQE                         @Y30APYF 33001503
         BNO   NEXTDQE              SO FIRST DQE CAN GO AWAY     Y02714 33002002
         SPACE 2                                                 Y02714 33006202
NOTFIRST OI    FREESW,NFRSTDQE     SET "NOT FIRST DQE" FOR L/SQA Y02714 33007202
NEXTDQE  LR    RPREVDQE,RDQE       DQE NOW PREVIOUS                     33008602
         L     RDQE,DQEPTR(RPREVDQE) PICK UP DQE                        33010002
         LTR   RDQE,RDQE           DQE EXIST                            33060002
         BNZ   NEXT1               YES                                  33110001
NEGLEN78 MVI   MSGLEN,H2C    REASON CODE 1 - LENGTH 12           Y02714 33112002
         LA    RERROR,ERR3         NO DQE FOR SUBPOOL IN WHICH @Z30ENWD 33114003
*                                  FREE IS BEING ATTEMPTED     @YM07655 33116003
*                                  OR INVALID LENGTH OR        @YM07655 33116603
*                                  ADDRESS (NEGATIVE)                   33116903
         B     GERROR3A            SET UP REMAINING PARAMETERS          33118001
         SPACE 2                                                        33118401
NEXT1    L     RUB,DQELNTH(RDQE)   LENGTH OF AREA DESCRIBED BY DQE      33120002
         A     RUB,DQEBLKAD(RDQE)  UPPER BOUND OF DQE                   33140002
         LR    RAUB,RADDR          ADDRESS TO BE FREED                  33160002
         AR    RAUB,RLENGTH        UPPER BOUND OF AREA TO BE FREED      33180002
         C     RADDR,DQEBLKAD(RDQE) ADDR LESS THAN LOWER BOUND          33200002
         BL    NOTFIRST            YES NOT RIGHT DQE             Y02714 33220002
         CLR   RAUB,RUB           AREA TO BE FREED UPPER BOUND @YM07655 33240003
         BH    NOTFIRST            GREATER THAN DQE UPPER BOUND  Y02714 33250003
         ST    RDQE,DQESAVE        SAVE DQE POINTER                     33270002
         TM    SPFLAGS,NEEDAQE     AQE REQUEST?                  Y02714 33300002
         ST    RPREVDQE,DQESAVE+4  SAVE PREV DQE REG                    33301002
         BZ    NOAQE               NO, SKIP AQE PROCESSING              33320002
         SPACE 5                                                 Y02714 33322002
*                                                                       33324002
*        FMCOMMON - REMOVE ANY AQE'S FOR AREA BEING FREED               33326002
*                                                                       33328002
         SPACE 2                                                 Y02714 33328402
SP253FR  L     RIN1,LDATCB         GET TCB ADDRESS               Y02714 33330002
         DROP  RTCB1                                             Y02714 33330402
         USING TCB,RIN1                                          Y02714 33332002
         L     RAQE,TCBAQE         PICK UP AQE POINTER           Y02714 33340002
         LTR   RAQE,RAQE           TCBAQE ZERO                          33360002
         BZ    ERROR13A            YES - ERROR13                        33380002
         LA    RAQE,TCBAQE         INITIALIZE PREV                      33400002
         DROP  RIN1                                              Y02714 33410002
         USING TCB,RTCB1                                         Y02714 33412002
AQECHECK LR    RPREVAQE,RAQE       SAVE PREV                            33420002
         L     RAQE,AQEPTR(RAQE)   PICK UP AQE                          33440002
         CR    RADDR,RAQE          ADDRESS LESS THAN AQE ADDR           33460002
         BL    AQECHECK            YES                                  33480002
         LTR   RAQE,RAQE           END OF CHAIN                         33500002
         BZ    ERROR13A            YES ERROR 13                         33520002
         LR    RUB,RAQE            AQE ADDRESS                          33540002
         A     RUB,AQELEN(RAQE)    UPPER BOUND OF AQE                   33560002
         CR    RAUB,RUB            AREA UPPER BOUND GREATER THAN        33580002
         BH    AQECHECK            AQE UPPER BOUND - YES                33600002
         BL    FREELMID            FREEING LOWER OR MIDDLE              33620002
         CR    RADDR,RAQE          FREEING TOP; ALL OF IT?              33640002
         BNE   FREETOP             NO, FREEING TOP PART ONLY            33660002
         MVC   AQEPTR(FOUR,RPREVAQE),AQEPTR(RAQE) REMOVE AQE FROM CHAIN 33680001
*                                  AS WHOLE AREA IS BEING FREED         33700002
         B     NOAQE               RETURN TO NORMAL PROCESSING          33710002
*                                                                       33760003
*        FREEING LOWER OR MIDDLE PART OF AN AREA DESCRIBED BY AN AQE    33810003
*                                                                       33860003
FREELMID SR    RAUB,RWORK          SUBTRACT 8 FROM AREA UPPER BOUND FOR 34710002
*                                  NEW OR MOVED AQE                     34712002
         SR    RLENGTH,RWORK       SUBTRACT 8 FROM LENGTH FOR SIZE OF   34714002
*                                  AQE (CRNDLNTH HAS ADDED 8)           34716002
         ST    RAUB,AQEPTR(RPREVAQE)                                    34718001
         LR    WORK,RUB            OLD AQE UPPER BOUND MINUS NEW        34718402
         SR    WORK,RAUB            AQE START IS LENGTH OF NEW AQE      34718802
         ST    WORK,AQELEN(RAUB)   PLACE LENGTH IN AQE                  34719202
         CR    RADDR,RAQE          FREEING BOTTOM ONLY                  34719602
         BNE   FREEMID             NO  FREEING MIDDLE                   34719702
         MVC   AQEPTR(FOUR,RAUB),AQEPTR(RAQE)  MOVE NEXT POINTER FROM   34719802
*                                  OLD TO NEW AQE                       34719902
         B     NOAQE               RESUME NORMAL PROCESSING             34726602
*                                                                       34726703
*        FREEING MIDDLE PART OF AREA DESCRIBED BY AN AQE                34726803
*                                                                       34726903
FREEMID  ST    RAQE,AQEPTR(RAUB)   PLACE POINTER TO OLD AQE IN NEW AQE  34728602
         AR    RADDR,RWORK         FREEING MIDDLE SO START ADDRESS MUST 34730602
*                                  BE PLACED BACK AT ITS ORIGINAL       34732602
*                                  LOCATION AS NO AQE IS BEING FREED    34733002
         SR    RLENGTH,RWORK       8 WAS ADDED TO LENGTH IN CRNDLNTH    34733102
*                                  FOR AN AQE - IT WAS SUBTRACTED       34733202
*                                  WHEN THE NEW AQE WAS BUILT.          34735402
*                                  NOW AS THE MIDDLE IS BEING FREED THE 34737402
*                                  ORIGINAL AQE IS NOT BEING FREED SO   34737502
*                                  THE 8 THAT CRNDLNTH ADDED MUST BE    34739402
*                                  SUBTRACTED ALSO.                     34742002
         LR    RPREVAQE,RADDR      ADDR TO BE FREED                     34743902
         SR    RPREVAQE,RAQE       START OF AREA TO BE FREED MINUS      34745802
*                                  OLD AQE ADDR IS LENGTH OF OLD AQE    34747702
         ST    RPREVAQE,AQELEN(RAQE)  PLACE LENGTH IN OLD AQE           34749602
         B     NOAQE               RETURN TO NORMAL PROCESSING          34751502
*                                                                       34751603
*        FREEING TOP PART OF AN AREA DESCRIBED BY AN AQE                34751703
*                                                                       34751803
FREETOP  AR    RADDR,RWORK         PLACE ADDR BACK TO ORIGINAL   Y02714 34755302
*                                  LOCATION AS AQE IS NOT BEING FREED   34757202
         SR    RLENGTH,RWORK       REPLACE AQE SIZE ADDED BY CRNDLNTH   34759102
         LTR   RLENGTH,RLENGTH     ZERO BYTE FREE                       34761002
         BZ    FMLEAVE             YES, RETURN                          34762902
         L     RWORK,AQELEN(RAQE)  AQE LENGTH                           34764802
         SR    RWORK,RLENGTH       SUBTRACT LENGTH OF AREA TO BE FREED  34766702
         ST    RWORK,AQELEN(RAQE)  NEW LENGTH                           34768602
         SPACE 5                                                 Y02714 34769002
*                                                                       34769402
*        FMCOMMON - FIND FQE AND RECONSTRUCT FQE'S TO REFLECT           34769802
*        ADDITIONAL FREE AREA                                           34770202
*                                                                       34770302
         SPACE 2                                                 Y02714 34770402
NOAQE    BAL   RCOMRET1,QELOCATE   GO TO LOCATE FQE WHOSE LOW ADDR IS   34770602
*                                  LOW OR EQUAL TO THE HIGH BOUND OF    34770702
*                                  THE AREA BEING FREED                 34770802
         CR    RAUB,RLB            AREA UPPER BOUND EQUAL TO FQE        34774402
*                                  LOWER BOUND                          34776402
         BNE   CHKFQE              NO                                   34776802
         L     RWORK,FQELNTH(RFQE) PICK UP LENGTH                       34777202
         AR    RWORK,RLENGTH       ADD LENGTH OF AREA BEING FREED       34777602
         ST    RWORK,FQELNTH(RFQE) PLACE NEW LENGTH IN FQE              34778002
         B     CKNXTFQE            GO TO CHECK NEXT FQE FOR COMBINATION 34778102
         SPACE 2                                                 Y02714 34778402
CHKFQE   LTR   RLB,RLB             ANY FQE EXIST ON THIS DQE?    Y02714 34785602
         BZ    CHECTYP             NO, CREATE FQE IF NEEDED             34788602
         CR    RADDR,RUB           FQE UPPER BOUND EQUAL ADDRESS?       34791602
         BNE   CREATFQE            NO, MUST CREATE FQE                  34794602
         TM    FQTYPE(RFQE),REGION REGION FQE?                          34800002
         BZ    NOTREG1             NO                                   34820002
         ST    RAUB,FQAREA(RFQE)   YES, PLACE NEW ADDRESS IN FQE        34840002
         L     RWORK,FQELNTH(RFQE) PICK UP LENGTH                       34860002
         B     LSQA1               ADJUST LENGTH                        34880002
         SPACE 2                                                 Y02714 34890002
NOTREG1  OI    FREESW,FQEBELOW     INDICATE FQE BELOW FREED AREA Y02714 34892002
         LA    RWORK,FQESLNTH      FQE LENGTH                    Y02714 34900002
         LR    WORK,RAUB           NEW FQE ADDR PLUS FQE LENGTH         34920002
         SR    WORK,RWORK          NEW FQE ADDR                         34940002
         ST    WORK,FQEPTR(RPREVFQE)  PLACE MOVED FQE                   34960002
         MVC   FQEPTR(FOUR,WORK),FQEPTR(RFQE)  INTO CHAIN               34980001
         L     RWORK,FQELNTH(RFQE) LENGTH                               35000001
         LR    RFQE,WORK           NEW FQE LOCATION                     35020002
LSQA1    AR    RWORK,RLENGTH       NEW FQE LENGTH                       35040002
         ST    RWORK,FQELNTH(RFQE) NEW FQE AREA LENGTH                  35060002
         B     CHECK4K             GO TO SEE IF 4K CAN BE RELEASED      35080002
         SPACE 2                                                 Y02714 35090002
CREATFQE TM    SPFLAGS,SQA+LSQA    REGION FQE REQUIRED?          Y02714 35100002
         BNZ   LNTHADJ             NO, ADJUST LENGTH             Y02714 35120002
         LR    RWORK,RPREVFQE      SAVE PREV FQE POINTER                35130002
         ICM   RIN1,MASK1,LDACBSP  GET SPID FOR FQE              Y02714 35160002
         BAL   RRETURN,GETMAINC    OBTAIN FQE                  @Z30ENWD 35180003
         LR    RFQE,RIN1           NEW FQE                              35240001
         LR    RPREVFQE,RWORK      RESTORE PREV FQE POINTER             35250002
         MVI   FQTYPE(RFQE),REGION INDICATE REGION FQE                  35252002
         ST    RAUB,FQAREA(RFQE)   HIGH ADDRESS OF FREE SPACE           35254002
ADJLNTH  ST    RLENGTH,FQELNTH(RFQE)  PLACE LENGTH IN FQE               35260002
         MVC   FQEPTR+1(C3,RFQE),FQEPTR+1(RPREVFQE) PREV FQENXT IS NEW  35280001
*                                  FQENXT                               35300001
         STCM  RFQE,MASK,FQEPTR+1(RPREVFQE) NEW FQE IS PREVIOUS FQENXT  35320001
         B     CHECK4K             GO TO SEE IF 4K TO BE RELEASED       35340001
         SPACE 2                                                 Y02714 35350002
LNTHADJ  LA    RWORK,FQESLNTH      FQE SIZE                      Y02714 35360002
         LR    RFQE,RAUB           NEW FQE PLUS FQE SIZE                35380002
         SR    RFQE,RWORK          NEW FQE                              35400001
         MVI   FQTYPE(RFQE),C0     INDICATE NON REGION FQE              35410002
         B     ADJLNTH             ADJUST LENGTH                        35420001
         SPACE 2                                                 Y02714 35430002
CHECTYP  L     RWORK,DQELNTH(RPREVFQE)  IF NO FQE EXISTS THE PREVIOUS   35440002
*                                  FQE IS A DQE                         35460001
         CR    RLENGTH,RWORK       LENGTH OF FREEMAIN EQUAL TO DQESIZE  35480002
         BNE   CREATFQE            NO, GO CREATE FQE                    35540002
         L     RLB,DQEBLKAD(RPREVFQE)  LOWER BOUND                      35550002
         LR    RUB,RLENGTH         LENGTH OF DQE                        35550240
         AR    RUB,RLB             UPPER BOUND                          35550440
*                                                                       35550640
*        THE FREEMAIN IS FOR ALL OF THE SPACE DESCRIBED BY THE DQE.     35550840
*        AT LEAST 1 PAGE IS BEING FREEMAINED, AND NO FQE WILL BE        35551040
*        REQUIRED.  THE PAGE(S) CAN BE PUT BACK INTO AN FBQE IF THE     35551240
*        PROPER CONDITIONS EXIST.  THE TESTS BELOW CHECK FOR THOSE      35551440
*        CONDITIONS.                                                    35551640
*                                                                       35552040
         ST    RPREVFQE,PREVFQSV   SAVE PREV POINTER                    35554040
         TM    SPFLAGS,SQA+LSQA    SQA OR LSQA SUBPOOL?          Y02714 35554440
         BZ    CHECK4K1            NO                          @ZA04815 35555040
         TM    FREESW,NFRSTDQE     CAN SPACE GO BACK TO FBQE   @ZA04815 35555240
         BO    CHECK4K1            YES                         @ZA04815 35556040
         B     SQABND1             N0                          @ZA04815 35556840
         SPACE 2                                                 Y02714 35559202
CKNXTFQE L     RWORK,FQEPTR(RFQE)  PICK UP NEXT FQE                     35560001
         LA    RWORK,0(0,RWORK)    CLEAR REGION INDICATOR        Y02714 35570002
         LTR   RWORK,RWORK         IS THERE A NEXT FQE?          Y02714 35580002
         BZ    CHECK4K             NO CONTINUE PROCESSING               35600001
         TM    FQTYPE(RWORK),REGION  REGION FQE?                        35620002
         BZ    CHECKCOM            NO, GET AREA + 8 AS UPPER BOUND      35640002
         L     WORK,FQAREA(RWORK)  UPPER BOUND OF FQE AREA              35660002
         B     COMBCK              GO SEE IF FQE'S CAN BE COMBINED      35680002
         SPACE 2                                                 Y02714 35690002
CHECKCOM LA    WORK,FQESLNTH(RWORK)  FQE ADDR PLUS 8 IS UPPER BOUND     35700002
COMBCK   CR    WORK,RADDR          CAN FQE'S BE COMBINED                35720002
         BNE   CHECK4K             NO, CONTINUE PROCESSING              35740002
         OI    FREESW,FQEBELOW     INDICATE FQE BELOW FREED AREA Y02714 35750002
         L     WORK,FQELNTH(RWORK) LENGTH OF FQE                        35760001
         A     WORK,FQELNTH(RFQE)  ADD ORIGINAL FQE LENGTH              35780001
         ST    WORK,FQELNTH(RFQE)  NEW FQE LENGTH                       35800001
         MVC   FQEPTR(FOUR,RFQE),FQEPTR(RWORK)  DEQUEUE FQE             35820002
         TM    FQTYPE(RFQE),REGION REGION FQE?                          35840002
         BZ    CHECK4K             NO, CONTINUE PROCESSING              35860002
         LR    WORK,RPREVFQE       SAVE PREV POINTER                    35900002
         LR    RIN1,RWORK          FQE ADDR                             35920002
         BAL   RCOMRET1,FMAINC     FREE FQE                    @Z30ENWD 36000003
         LR    RPREVFQE,WORK       RESTORE PREV FQE POINTER             36060002
         SPACE 5                                                 Y02714 36070002
*                                                                       36072002
*        FMCOMMON - DETERMINE (SEPARATELY FOR REGION AND CSA            36074002
*        STORAGE OR FOR SQA AND LSQA STORAGE) WHETHER OR NOT            36076002
*        ONE OR MORE COMPLETE PAGES OF STORAGE HAVE BECOME FREE         36078002
*                                                                       36078402
         SPACE 2                                                 Y02714 36078802
CHECK4K  STM   RPREVFQE,RFQE,PREVFQSV  SAVE PREV AND FQE POINTER        36080002
         TM    FQTYPE(RFQE),REGION REGION FQE?                          36100002
         BZ    SQABNDRY            NO, SQA OR LSQA               Y02714 36120002
         L     RUB,FQAREA(RFQE)    FQE AREA EQUALS UPPER BOUND   Y02714 36170002
CHECK4K0 LR    RLB,RUB             TO OBTAIN LOWER BOUND         Y02714 36180002
         S     RLB,FQELNTH(RFQE)   SUBTRACT LENGTH TO GET RLB    Y02714 36190002
CHECK4K1 LA    RWORK,C4095         4K MINUS 1                    Y02714 36240002
         LR    WORK,RUB            UPPER BOUND                   Y02714 36320002
         OR    WORK,RWORK          WORK NOW CONTAINS THE UPPER          36340002
         XR    WORK,RWORK           BOUND OF THE FREE AREA ROUNDED DOWN 36360002
         LR    RWORK2,RLB          LOWER BOUND                          36380002
         AR    RWORK2,RWORK        ADD 4K - 1                           36400002
         OR    RWORK2,RWORK        RWORK2 NOW CONTAINS THE LOWER        36420002
         XR    RWORK2,RWORK         BOUND OF THE FREE AREA ROUNDED UP   36440002
         LR    RSIZE,WORK          UPPER BOUND                          36460002
         SR    RSIZE,RWORK2        DIFFERENCE OF TWO ROUNDED AREAS      36480002
         BNP   FMLEAVE             IF NEGATIVE OR ZERO NO 4K BLOCKS TO  36500002
*                                  BE RELEASED                          36520002
         ST    RLENGTH,RQSTSIZE    SAVE RQSTD SIZE FOR AXX-2   @ZA27672 36521040
         B     RSTRCDQE            GO RESTRUCTURE DQE            Y02714 36522002
         SPACE 2                                                 Y02714 36524002
SQABNDRY LA    RUB,FQESLNTH(RFQE)  END OF FREE AREA (FUB)        Y02714 36530002
         TM    FREESW,NFRSTDQE     IS THIS FIRST DQE             Y02714 36530102
         BO    CHECK4K0            NO, DON'T KEEP PAGE WITH FQE  Y02714 36530202
         LR    RLB,RUB             START WITH FUB AND            Y02714 36530402
         S     RLB,FQELNTH(RFQE)    SUBTRACT LENGTH TO GET FLB   Y02714 36530802
SQABND1  LA    RWORK,C4095         4K MINUS 1                    Y02714 36538002
         LR    WORK,RAUB           GET AREA UPPER BOUNDARY       Y02714 36546002
         AR    WORK,RWORK          AUB + 4095                    Y02714 36556002
         OR    WORK,RWORK          GET AREA UPPER BOUND ROUNDED  Y02714 36568002
         XR    WORK,RWORK           UP TO PAGE BOUNDARY (RUB)    Y02714 36568402
         CR    WORK,RUB            COMPARE RUB TO FUB            Y02714 36568802
         BL    SQABND2             RUB < FUB, LEAVE RUB AS IS    Y02714 36569202
*                                  KEEP PAGE WITH FQE            Y02714 36571402
         S     WORK,PAGE           GO DOWN ONE PAGE              Y02714 36573102
SQABND2  LR    RWORK2,RADDR        GET AREA LOWER BOUNDARY       Y02714 36573602
         TM    FREESW,FQEBELOW     WAS FQE BELOW AREA?           Y02714 36574702
         BZ    SQABND3             NO                            Y02714 36575802
         LA    RIN15,FQESLNTH      LENGTH OF FQE                 Y02714 36576902
         SR    RWORK2,RIN15        INCLUDE FQE IN AREA           Y02714 36578002
SQABND3  OR    RWORK2,RWORK        GET AREA LOWER BOUND ROUNDED  Y02714 36579102
         XR    RWORK2,RWORK         DOWN TO PAGE BOUNDARY (RLB)  Y02714 36580202
         CR    RWORK2,RLB          IS RLB < FLB?                 Y02714 36581302
         BNL   SQABND4             NO, LEAVE AS IS               Y02714 36582402
         A     RWORK2,PAGE         YES, GO UP ONE PAGE           Y02714 36583502
SQABND4  LR    RSIZE,WORK          UPPER BOUND                   Y02714 36584602
         SR    RSIZE,RWORK2        DIFFERENCE OF ROUNDED BOUNDS  Y02714 36585702
         BNP   FMLEAVE             NO BLOCKS TO RELEASE          Y02714 36586802
         B     TSTSQA              KEEP ALL OF FIRST DQE         Y02714 36587002
         SPACE 5                                                 Y02714 37984402
*                                                                       37986402
*        FMCOMMON - RESTRUCTURE DQE'S AND THEIR FQE'S TO ACCOUNT        37988402
*        FOR AREA JUST FREED                                            37990402
*                                                                       37990802
         SPACE 2                                                 Y02714 37990902
SPREL    EQU   *                   SUBPOOL FREEMAIN ENTRY        Y02714 37995702
RSTRCDQE ST    RWORK2,SVRLB        SAVE RLB AND                  Y02714 38000802
         ST    RSIZE,SVSIZE         SIZE FOR LATER               Y02714 38005602
         L     RDQE,DQESAVE        RESTORE DQE REG                      38010402
         L     RPREVDQE,DQESAVE+C4 RESTORE PREV DQE REG          Y02714 38015202
         L     RLENGTH,DQELNTH(RDQE)  PICK UP LENGTH                    38020002
         CR    RLENGTH,RSIZE       WHOLE DQE AREA BEING FREED?          38040002
         BNE   FPARTDQE            NO, FREEING SOME PART OF DQE         38060002
         MVC   DQEPTR(C4,RPREVDQE),DQEPTR(RDQE)  REMOVE DQE FROM Y02714 38080002
*                                  CHAIN                                38090002
         L     RFQE,DQFQEPTR(RDQE) FQE                                  38100002
         LTR   RFQE,RFQE           FQE EXIST                            38160001
         BZ    FREEDQE             NO, FREE DQE                         38180002
         TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 38182002
         BZ    FREEDQE             NO, FREE DQE                  Y02714 38184002
         LR    RIN1,RFQE           FQE ADDR                             38220002
         BAL   RCOMRET1,FMAINC     FREE FQE                    @Z30ENWD 38240003
FREEDQE  LR    RIN1,RDQE           DQE ADDR                             38280003
         BAL   RCOMRET1,FMAINC     FREE DQE                    @Z30ENWD 38290003
         B     RSTRLBSZ            GO RELEASE PAGES              Y02714 38310002
         SPACE 2                                                 Y02714 38342002
FPARTDQE A     RLENGTH,DQEBLKAD(RDQE)  UPPER BOUND OF DQE               38360001
         CR    RLENGTH,WORK        FREEING UPPER END OF DQE             38380002
         BNE   DQELOWMD            NO FREEING BOTTOM OR MIDDLE          38400002
         L     RWORK,DQELNTH(RDQE) LENGTH OF DQE                        38420002
         SR    RWORK,RSIZE         SUBTRACT AMOUNT FREED                38440002
         ST    RWORK,DQELNTH(RDQE) NEW SIZE OF DQE                      38460002
         L     RFQE,FQESAVE        RESTORE FQE REG                      38470002
         L     RLENGTH,FQELNTH(RFQE)  LENGTH OF FQE                     38480002
         LR    RWORK,WORK          UPPER BOUND OF AREA           Y02714 38481002
         SR    RWORK,RLENGTH       LOWER BOUND OF AREA           Y02714 38500002
         CR    RWORK2,RWORK        COMPLETE FQE AREA FREED?      Y02714 38520002
         BNZ   ADJREMAN            NO, GO ADJUST FQE                    38540002
         MVC   DQFQEPTR+1(C3,RDQE),FQEPTR+1(RFQE)  REMOVE FQE FROM      38560002
*                                  CHAIN BY POINTING DQE TO NEXT FQE    38580002
COMFQEFR TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 38590002
         BZ    RSTRLBSZ            NO, DON'T FREE IT             Y02714 38600002
         LR    RIN1,RFQE           FQE ADDR                             38640002
         BAL   RCOMRET1,FMAINC     FREE FQE                    @Z30ENWD 38680003
         B     RSTRLBSZ            GO RELEASE PAGES              Y02714 38720002
         SPACE 2                                                 Y02714 38730002
ADJREMAN TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 38732002
         BZ    CRNEWFQE            NO, CREATE NEW FQE            Y02714 38734002
         ST    RWORK2,FQAREA(RFQE) NEW START ADDR OF FQE         Y02714 38740002
         L     RLENGTH,FQELNTH(RFQE)  FQE LENGTH                        38760002
         SR    RLENGTH,RSIZE       SIZE OF FREED AREA                   38780002
         ST    RLENGTH,FQELNTH(RFQE)  NEW FQE LENGTH                    38800002
         B     RSTRLBSZ            GO RELEASE PAGES              Y02714 38810002
         SPACE 2                                                 Y02714 38822002
CRNEWFQE LA    RWORK,FQESLNTH      GET FQE LENGTH                Y02714 38824002
         SR    RWORK2,RWORK        NEW FQE ADDRESS               Y02714 38826002
         L     RWORK,FQEPTR(RFQE)  GET OLD FORWARD POINTER       Y02714 38828002
         ST    RWORK,FQEPTR(RWORK2)  PUT IN NEW FQE              Y02714 38828402
         ST    RWORK2,DQFQEPTR(RDQE)  POINT DQE TO NEW FQE       Y02714 38828802
         L     RLENGTH,FQELNTH(RFQE)  GET LENGTH IN OLD FQE      Y02714 38829202
         SR    RLENGTH,RSIZE       LESS SIZE OF FREED AREA       Y02714 38829602
         ST    RLENGTH,FQELNTH(RWORK2)  NEW LENGTH IN NEW FQE    Y02714 38829702
         B     RSTRLBSZ            GO RELEASE PAGES              Y02714 38829802
         SPACE 2                                                 Y02714 38830002
DQELOWMD C     RWORK2,DQEBLKAD(RDQE)  LOW BOUND OF DQE BEING FREED?     38840002
         BNE   DQEMIDFR            NO, FREEING MIDDLE                   38860002
         ST    WORK,DQEBLKAD(RDQE) NEW DQE START ADDR                   38880001
         L     RLENGTH,DQELNTH(RDQE)  ORIGINAL LENGTH                   38900002
         SR    RLENGTH,RSIZE       SUBTRACT AMOUNT FREED                38920001
         ST    RLENGTH,DQELNTH(RDQE)  NEW LENGTH OF DQE                 38940002
         L     RFQE,FQESAVE        RESTORE FQE REG                      38950002
         TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 38952002
         BZ    NOTREGFQ            NO, PROCESS ACCORDINGLY       Y02714 38954002
         C     WORK,FQAREA(RFQE)   COMPLETE FQE AREA BEING FREED?       38960002
         BE    FREFQE              YES, FREE FQE                        38980002
GETNEWLN L     RLENGTH,FQELNTH(RFQE)  LENGTH OF FQE ENCOMPASSING Y02714 39000002
*                                  BLOCKS FREED                         39010002
         SR    RLENGTH,RSIZE       NEW LENGTH = LENGTH - 4K BLCKS FREED 39020002
         ST    RLENGTH,FQELNTH(RFQE)  NEW LENGTH IN FQE                 39040002
         B     RSTRLBSZ            GO RELEASE PAGES              Y02714 39050002
         SPACE 2                                                 Y02714 39062002
NOTREGFQ LA    RWORK,FQESLNTH(0,RFQE)  FQE AREA POINTER          Y02714 39065202
         CR    WORK,RWORK          COMPLETE FQE AREA BEING FREED Y02714 39066002
         BE    FREFQE              YES, FQE NOT NEEDED           Y02714 39068002
         B     GETNEWLN            NO, UPDATE FQE LENGTH         Y02714 39068402
         SPACE 2                                                 Y02714 39070002
FREFQE   L     RPREVFQE,PREVFQSV   RESTORE PREVIOUS FQE REG             39080001
         XC    FQEPTR+1(C3,RPREVFQE),FQEPTR+1(RPREVFQE)  ZERO PREVIOUS  39100002
*                                  NEXT POINTER AS IT IS NOW LAST       39120002
         B     COMFQEFR            FREE FQE                             39140002
         SPACE 2                                                 Y02714 39142002
DQEMIDFR TM    SPFLAGS,SQA+LSQA    L/SQA FQE?                    Y02714 39144002
         BZ    DQEMIDF1            NO, GET FINAL DQE             Y02714 39146002
         LA    RNEWDQE,TEMPDQE     YES, USE TEMPORARY DQE TO     Y02714 39148002
*                                  AVOID CHANGING FQE'S          Y02714 39148102
         XC    DQFQEPTR(FOUR,RNEWDQE),DQFQEPTR(RNEWDQE) NO FQE'S Y02714 39148202
         B     DQEMIDF2             NOW; CONTINUE                Y02714 39148402
         SPACE 2                                                 Y02714 39148802
DQEMIDF1 ICM   RIN1,MASK1,LDACBSP  GET SPID FOR DQE            @Z30ENWD 39160003
         BAL   RRETURN,GETMAINC    OBTAIN DQE                  @Z30ENWD 39200003
DQEMIDF2 MVC   DQEPTR(FOUR,RNEWDQE),DQEPTR(RDQE)  MOVE DQENXT    Y02714 39240002
*                                  FROM OLD TO NEW DQE                  39260002
         ST    RNEWDQE,DQEPTR(RDQE)  POINT OLD DQE TO NEW DQE           39280002
         ST    WORK,DQEBLKAD(RNEWDQE)  START ADDRESS OF NEW DQE         39300002
         SR    RLENGTH,WORK        TO OBTAIN LENGTH OF NEW DQE (RLENGTH 39320002
*                                  CONTAINED UPPER BOUND OF OLD DQE)    39330002
         ST    RLENGTH,DQELNTH(RNEWDQE)  PLACE LENGTH IN NEW DQE        39340002
         L     RWORK,DQEBLKAD(RDQE)  ADDR OF OLD DQE                    39360001
         LR    RLENGTH,RWORK2      UPPER BOUND OF OLD DQE AFTER FREE    39380002
         SR    RLENGTH,RWORK       TO OBTAIN NEW LENGTH OF OLD DQE      39400002
         ST    RLENGTH,DQELNTH(RDQE)  PLACE NEW LENGTH IN OLD DQE       39420002
         L     RADDR,DQFQEPTR(RDQE)  BEGINNING OF FQE QUEUE OF OLD DQE  39440002
         L     RFQE,FQESAVE        RESTORE FQE REG                      39450002
         TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 39452002
         BO    GETFQEPT            YES, GET FQE POINTERS         Y02714 39454002
         LA    RWORK,FQESLNTH(0,RFQE)  TOP OF AREA DESCRIBED     Y02714 39456002
*                                  BY FQE                        Y02714 39456102
         LA    RADDR,FQESLNTH(0,RADDR)  TOP OF FIRST FQE         Y02714 39465602
         B     ANYTOP              GO DO COMPARE                 Y02714 39469202
         SPACE 2                                                 Y02714 39472802
GETFQEPT L     RWORK,FQAREA(RFQE)  TOP OF AREA DESCRIBED BY FQE  Y02714 39476402
         L     RADDR,FQAREA(RADDR) NOW HAVE TOP OF AREA DESCRIBED BY    39480001
*                                  FIRST FQE OFF QUEUE                  39500002
ANYTOP   CR    RADDR,RWORK         COMPARE TWO AREAS             Y02714 39520002
         BH    MVFQEPTR            THE BRANCH WILL BE TAKEN IF PART     39540002
*                                  OF THE OLD FQE QUEUE DESCRIBES OLD   39560002
*                                  FREE AREAS THAT ARE NOW WITHIN       39580002
*                                  THE AREA DESCRIBED BY THE NEW DQE    39600002
****     XC    DQFQEPTR(FOUR,RNEWDQE),DQFQEPTR(RNEWDQE)  NO FQE'S       39620002
*                                  IN AREA NEW DQE DESCRIBES. THIS      39640002
*                                  INSTRUCTION IS NOT NEEDED AS         39650002
*                                  GETMAINB ZEROED OUT THE NEW DQE      39652002
         B     UPPERCK             GO TO CHECK FOR A REMAINDER ABOVE    39660002
*                                  THE AREA BEING FREED                 39680002
         SPACE 2                                                 Y02714 39690002
MVFQEPTR MVC   DQFQEPTR(FOUR,RNEWDQE),DQFQEPTR(RDQE)  NEW DQE NOW HAS   39700002
*                                  OLD DQE FQE PTR                      39720002
UPPERCK  SR    RWORK,WORK          IS THERE A REMAINDER OF FREE AREA    39740002
*                                  ABOVE THE 4K BLOCKS FREED            39760002
         BZ    NOUPPER             NO ADJUST QUEUE                      39780002
         TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 39782002
         BZ    NONRGFQE            NO, UPDATE ONLY REQUIRED      Y02714 39784002
         LR    RLENGTH,RNEWDQE     SAVE NEW DQE PTR                     39790002
         ICM   RIN1,MASK1,LDACBSP  GET SPID FOR FQE              Y02714 39852002
         BAL   RRETURN,GETMAINC    GET FQE                     @Z30ENWD 39860003
         LR    RIN15,RIN1          NEW FQE                              39900002
         LR    RNEWDQE,RLENGTH     RESTORE NEW DQE REG                  39920002
         MVC   FQAREA(FOUR,RIN15),FQAREA(RFQE)  ADDR OF FQE DESCRIBING  39960002
*                                  AREA ABOVE 4K BLOCKS FREED.          39980001
         MVI   FQTYPE(RIN15),FQERGNFL  INDICATE REGION FQE              39992001
SETNEWLN ST    RWORK,FQELNTH(RIN15)  LENGTH IN NEW FQE           Y02714 39994002
         L     RWORK4,PREVFQSV     PREVIOUS FQE                  Y02714 40000002
         CR    RWORK4,RDQE         PREVIOUS FQE THE DQE          Y02714 40020002
         BNE   PREVISFQ            NO UPDATE FQE CHAIN                  40040002
         ST    RIN15,DQFQEPTR(RNEWDQE)  THIS IS FIRST AND ONLY FQE      40060001
*                                  FOR NEW DQE                          40080002
         B     LOWERCK             GO CHECK FOR REMAINDER BELOW         40100001
         SPACE 2                                                 Y02714 40102002
NONRGFQE LR    RIN15,RFQE          NEW FQE = OLD FQE             Y02714 40108002
         LA    RADDR,FQESLNTH      GET NON-REGION FQE SIZE       Y02714 40108102
         SR    RFQE,RADDR          SAVE OLD FQE IN SPACE BELOW   Y02714 40110002
*                                  NEW FQE                       Y02714 40112002
         MVC   0(FQESLNTH,RFQE),0(RIN15)  SAVE OLD FQE CONTENTS  Y02714 40112102
         AR    RADDR,RIN15         TOP OF OLD FQE FOR LATER      Y02714 40112202
         XC    FQEPTR(FOUR,RIN15),FQEPTR(RIN15)  THIS IS LAST    Y02714 40112402
*                                  FQE ON NEW DQE                Y02714 40114302
         B     SETNEWLN            GO UPDATE LENGTH              Y02714 40116202
         SPACE 2                                                 Y02714 40118102
PREVISFQ STCM  RIN15,MASK,FQEPTR+1(RWORK4)  MAKE NEW FQE NEXT OF Y02714 40120002
*                                  PREVIOUS                      Y02714 40130002
         B     LOWERCK             GO CHECK FOR REMAINDER BELOW         40140002
         SPACE 2                                                 Y02714 40150002
NOUPPER  L     RADDR,PREVFQSV      PREVIOUS FQE                         40160001
         XC    FQEPTR+1(C3,RADDR),FQEPTR+1(RADDR)  ZERO NEXT IN         40220002
*                                  PREVIOUS AS IT IS NOW LAST           40222002
         TM    SPFLAGS,SQA+LSQA    L/SQA FQE?                    Y02714 40224002
         BZ    LOWERCK1            NO                            Y02714 40226002
         LA    RADDR,FQESLNTH(0,RFQE)  TOP OF L/SQA FQE AREA     Y02714 40228002
         B     LOWERCK2            CONTINUE                      Y02714 40228402
         SPACE 2                                                 Y02714 40228802
LOWERCK  TM    SPFLAGS,SQA+LSQA    L/SQA FQE?                    Y02714 40229202
         BNZ   LOWERCK2            YES, RADDR ALREADY SET        Y02714 40229602
LOWERCK1 L     RADDR,FQAREA(RFQE)  TOP OF FQE AREA               Y02714 40240002
LOWERCK2 S     RADDR,FQELNTH(RFQE) BOT. OF AREA DESCRIBED BY FQE Y02714 40260002
         LR    RLENGTH,RWORK2      BOTTOM OF FREED 4K BLOCKS            40280002
         SR    RLENGTH,RADDR       IS THERE A REMAINDER                 40300001
         BNZ   CRFQELOW            YES ADJUST OLD FQE TO DESCRIBE IT    40320001
         MVC   DQFQEPTR+1(C3,RDQE),FQEPTR+1(RFQE)  IF NO REMAINDER      40340002
*                                  THEN FQE NEXT OF THE FQE DESCRIBING  40360002
*                                  THE AREA TO BE FREED IS THE FIRST    40380001
*                                  FQE OF THE OLD DQE                   40400001
         TM    SPFLAGS,SQA+LSQA    L/SQA FQE?                    Y02714 40410002
         BNZ   MOVEDQE             YES, GET PERMANENT DQE        Y02714 40412002
         B     COMFQEFR            FREE OLD FQE                         40420001
         SPACE 2                                                 Y02714 40430002
CRFQELOW TM    FQTYPE(RFQE),REGION REGION FQE?                   Y02714 40432002
         BO    MODFYFQE            YES, MODIFY OLD FQE           Y02714 40434002
         LA    RWORK,FQESLNTH      GET FQE LENGTH                Y02714 40436002
         SR    RWORK2,RWORK        NEW FQE ADDRESS               Y02714 40438002
         L     RWORK,FQEPTR(RFQE)  NEXT LOWER FQE                Y02714 40438402
         ST    RWORK,FQEPTR(RWORK2)  PUT IN NEW FQE              Y02714 40438802
         LR    RFQE,RWORK2         MAKE NEW, CURRENT             Y02714 40439202
         B     FINISHFQ            FINISH FQE                    Y02714 40439602
         SPACE 2                                                 Y02714 40439702
MODFYFQE ST    RWORK2,FQAREA(RFQE) START ADDR                    Y02714 40440002
FINISHFQ ST    RLENGTH,FQELNTH(RFQE)  NEW LENGTH                 Y02714 40460002
         ST    RFQE,DQFQEPTR(RDQE) MAKE THIS FIRST FQE OF OLD    Y02714 40480002
*                                  DQE                                  40490002
         TM    SPFLAGS,SQA+LSQA    L/SQA FQE?                    Y02714 40490102
         BZ    RSTRLBSZ            NO, GO RELEASE PAGES          Y02714 40490202
MOVEDQE  ICM   RIN1,MASK1,LDACBSP  GET SPID                    @Z30ENWD 40491103
         BAL   RRETURN,GETMAINC    OBTAIN DQE                  @Z30ENWD 40492103
         MVC   0(DQESIZE,RNEWDQE),TEMPDQE  MOVE DQE              Y02714 40493502
         ST    RNEWDQE,DQEPTR(0,RDQE)  POINT OLD DQE TO NEW DQE  Y02714 40493602
         SPACE 2                                                 Y02714 40495702
RSTRLBSZ L     RWORK2,SVRLB        RESTORE RLB AND               Y02714 40497702
         L     RSIZE,SVSIZE         SIZE TO BE RELEASED          Y02714 40497802
         TM    SPFLAGS,SQA+LSQA    SQA OR LSQA REQUEST?          Y02714 40497902
         BZ    FREE4KR             NO, REGION OR CSA REQUEST     Y02714 40498002
         SPACE 5                                                 Y02714 40508002
*                                                                       40510002
*        FMCOMMON - RELEASE SQA AND LSQA PAGES AND RETURN THEM          40510402
*        TO PROPER FBQE.  IN THIS CASE, SQA INCLUDES THOSE CSA @ZA20951 40510540
*        SUBPOOLS THAT ARE FIXED (IE. 227, 228, 239).          @ZA20951 40510740
*                                                                       40510940
         SPACE 2                                                 Y02714 40511140
TSTSQA   TM    SPFLAGS,SQA+CSA     SQA (SP245) REQUEST?        @ZA20951 40511340
         BC    NOTMIXED,TSTNIP4K   NO, IT IS LSQA OR FIXED CSA @ZA20951 40511540
         LR    RIN0,RSIZE          GET SIZE IN REG 0 FOR SRM     Y02714 40512402
         BAL   RCOMRET1,SRM        TELL SRM, SQA FREED           Y02714 40512502
TSTNIP4K L     RCVT,CVTPTR         GET CVT POINTER               Y02714 40512602
         USING CVT,RCVT                                          Y02714 40512702
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 40513102
         DROP  RCVT                                              Y02714 40513502
         USING GDA,RGDA                                          Y02714 40513902
         TM    GDAFLAGS,NIPFOURK   IS NIP IN PROCESS             Y02714 40514002
         DROP  RGDA                                              Y02714 40514102
         BO    CKFSTDQE            IF NIP IS IN PROCESS RSM      Y02714 40514202
*                                  CANNOT BE ENTERED TO RELEASE         40514302
*                                  FIXED PAGES AS NIP IS MANAGING       40514702
*                                  PAGES OF SQA AT THIS TIME            40515102
         BAL   RAREG,RLSEPAGE      GO RELEASE PAGES              Y02714 40515502
         L     RSIZE,GFRESAVE+C60  RESTORE SIZE                  Y02714 40515902
CKFSTDQE TM    FREESW,NFRSTDQE     IS "NOT FIRST DQE" SET?       Y02714 40516002
         BZ    FMLEAVE             NO, KEEP FIRST DQE            Y02714 40516602
         STM   RIN0,RIN15,MSAVE    SAVE ALL REGISTERS            Y02714 40517002
RETPGFBQ TM    SPFLAGS,CSA         CSA SUBPOOL?                  Y02714 40517402
         BZ    RETPPFBQ            NO                            Y02714 40517502
         LR    RIN0,RSIZE          GET SIZE IN REG 0 FOR SRM     Y02714 40517602
         BAL   RCOMRET1,SRM        TELL SRM, CSA FREED           Y02714 40517702
RETPPFBQ LR    RADDRM,RWORK2       START ADDRESS                 Y02714 40518302
         TM    SPFLAGS,SQA+CSA     SQA OR CSA SUBPOOL?           Y02714 40518402
         BZ    RETFBQ0             NO                            Y02714 40518502
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 40518602
         USING CVT,RCVT                                          Y02714 40518702
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 40518802
         DROP  RCVT                                              Y02714 40519302
         USING GDA,RGDA                                          Y02714 40519702
         L     RPQEM,CSAPQEP       GET CSA PQE PTR               Y02714 40520102
         DROP  RGDA                                              Y02714 40520202
         B     RETFBQ2             CONTINUE                      Y02714 40520302
         SPACE 2                                                 Y02714 40520402
RETFBQ0  TM    SPFLAGS,LSQA+SWA+AUK  HIGH END SUBPOOL?           Y02714 40520502
         BNZ   RETFBQ1             YES, USE A. S. PQE            Y02714 40520602
         L     RTCB1,LDATCB        GET TCB POINTER               Y02714 40520702
         L     RPQEM,TCBPQE        DUMMY PQE MINUS 8             Y02714 40520802
         L     RPQEM,PQEFPQE(RPQEM)  REGION PQE                  Y02714 40520902
         B     RETFBQ2             CONTINUE                      Y02714 40521102
         SPACE 2                                                 Y02714 40521202
RETFBQ1  L     RPQEM,ASDPQE        GET A. S. PQE PTR             Y02714 40521302
RETFBQ2  LR    RSIZEM,RSIZE        SIZE TO RETURN TO FBQE        Y02714 40521402
         BAL   RRETURN,MRELEASE    RETURN PAGES(S) TO FBQE       Y02714 40521502
         TM    FREESW,NEEDRLSE     FURTHER PAGE RELEASE NEEDED?  Y02714 40521602
         BO    RSETNDRL            YES                           Y02714 40521702
RETFBQ3  LM    RIN0,RIN15,MSAVE    RESTORE ALL REGISTERS         Y02714 40521802
         B     FSMFINTR            GO RECORD FOR SMF             Y02714 40521902
         SPACE 5                                                        40522002
*                                                                       40522102
*        SUBROUTINE TO INTERFACE WITH THE RSM RELEASE PAGE ROUTINE,     40522203
*         RSM MAY RETURN PAGETABLE SPACE TO BE FREED.          @Z30ENWD 40523003
*                                                                       40523203
         SPACE 2                                                 Y02714 40524203
RLSEPAGE STM   RIN0,RIN15,GFRESAVE SAVE REGS ACROSS RELEASE CALL Y02714 40525203
         BAL   RCOMRET1,GTSALLOC   GET SALLOC IF NOT ALREADY HELDY02751 40526203
         BAL   RCOMRET1,TRNONPVT   TURN ON GETMAIN INHIBITED FLAG       40527203
         LR    RIN0,RWORK2         LOWER BOUND                   Y02714 40528203
         LR    RIN1,WORK           UPPER BOUND                   Y02714 40529203
         L     R2,PSAAOLD          CURRENT ASCB ADDRESS          Y02714 40532003
         LR    RWORK3,RPVT         SAVE PVT ADDRESS              Y02714 40532903
         USING PVT,RPVT                                          Y02714 40533303
         L     RIN15,PVTPRELV      GET RELEASE ENTRY ADDRESS     Y02714 40533803
         DROP  RPVT                                              Y02714 40534703
         BALR  RRETURN,RIN15       RELEASE PAGES                        40535603
         USING PVT,RWORK3                                        Y02714 40536503
         NI    PVTFLAG1,ALL-PVTBGMS  TURN OFF GETMAIN INHIB. FLAGY02714 40537403
         DROP  RWORK3                                            Y02714 40538303
         LTR   RIN1,R2             ANY STORAGE TO BE FREEMAINED  Y02714 40539203
         BZ    RLSEPG2             NO, CONTINUE                  Y02714 40539703
         L     RIN0,FMPGTBSP       GET SPID AND LENGTH           Y02714 40540203
         SPACE 2                                                 Y02714 40542003
         LA    RWORK,FMAREAS       POINT TO START OF CHAIN OF    Y02714 40542803
*                                  ANY EXISTING AREAS TO BE FREEDY02714 40543603
QFMAINB1 L     RWORK2,C0(0,RWORK)  GET NEXT AREA POINTER       @Z30ENWD 40544903
         LTR   RWORK2,RWORK2       IS THERE ONE                @Z30ENWD 40545803
         BZ    QFMAINB2            NO, CHAIN IN HERE           @Z30ENWD 40546703
         LR    RWORK,RWORK2        YES, SET AS PREVIOUS        @Z30ENWD 40547603
         B     QFMAINB1            GO CHECK NEXT               @Z30ENWD 40548503
         SPACE 2                                               @Z30ENWD 40549403
QFMAINB2 ST    RIN1,C0(0,RWORK)    ADD AREA TO QUEUE           @Z30ENWD 40550303
RLSEPG1  ST    RIN0,C4(0,RIN1)     SPID & LENGTH IN WORD 2     @Z30ENWD 40551203
         L     RIN1,C0(0,RIN1)     GET NEXT AREA IN QUEUE      @Z30ENWD 40552103
         LTR   RIN1,RIN1           IS THERE ONE?                 Y02714 40553003
         BNZ   RLSEPG1             YES, DO NEXT                @Z30ENWD 40553803
         SPACE 2                                                 Y02714 40556203
RLSEPG2  LM    RIN0,R2,GFRESAVE    RESTORE REGS, PRESERVE R.C.   Y02714 40557003
         LM    RLDA,RRETURN,GFRESAVE+C16   AND REG 3             Y02714 40557803
         BR    RAREG               RETURN TO MAIN LINE                  40558603
         SPACE 5                                                 Y02714 40559403
*                                                                       40560903
*        FMCOMMON - RELEASE REGION AND CSA PAGES (UNLESS V=R) AND       40561003
*        RETURN THEM TO PROPER FBQE                                     40561203
*                                                                       40561403
         SPACE 2                                                 Y02714 40561703
FREE4KR  TM    SPFLAGS,CSA+SWA+AUK CSA, SWA, OR AUK SUBPOOL?     Y02714 40561903
         BNZ   RELSEPGS            YES, GO RELEASE PAGES         Y02714 40562103
         L     RTCB1,LDATCB        GET TCB POINTER               Y02714 40563503
         TM    TCBFLGS6,TCBRV      V=R TASK?                     Y02714 40564403
         BZ    RELSEPGS            NO, GO RELEASE PAGES          Y02714 40565303
         STM   RIN0,RIN15,MSAVE    SAVE REGS                     Y02714 40566203
         LR    RADDRM,RWORK2       START ADDRESS OF AREA TO BE RELEASED 40568003
         L     RPQEM,TCBPQE        DUMMY PQE MINUS 8                    40568903
         L     RPQEM,PQEFPQE(RPQEM)  PQE                                40569803
         LR    RSIZEM,RSIZE        SIZE OF AREA TO BE RELEASED          40570703
         BAL   RRETURN,MRELEASE    RELEASE 4K BLOCKS             Y02714 40571603
         LM    RIN0,RIN15,MSAVE    RESTORE REGS                         40572503
         LA    RWORK,C8            KEY ZERO FETCH PROTECT MASK   Y02714 40573403
         LR    RLENGTH,RWORK2      FIRST BLOCK IN WHICH KEYS ARE TO     40574303
*                                  BE SET                               40575203
SETAGAIN SSK   RWORK,RLENGTH       SET KEYS                             40577003
         LA    RLENGTH,C2K(RLENGTH) INCREMENT BY 2K                     40577903
         CR    RLENGTH,WORK        END OF AREA TO SET KEYS              40578803
         BNE   SETAGAIN            NO SET NEXT 2K                       40579703
         B     FSMFINTR            DON'T UPDATE PAGE TABLES FOR V = R   40580603
         SPACE 2                                                 Y02714 40581503
RELSEPGS STM   RIN0,RIN15,MSAVE    SAVE ALL REGISTERS            Y02714 40582403
RELSEPG1 BAL   RAREG,RLSEPAGE      RELEASE PAGES                 Y02714 40583303
         LTR   RRETCODE,RRETCODE   IS RETURN CODE ZERO?          Y02714 40584203
         BZ    RESTSIZE            YES, RETURN PG(S) TO FBQE     Y02714 40586003
         LA    RAREG,C8            GET AN 8                      Y02753 40586903
         CR    RAREG,RRETCODE      IS RETURN CODE 8?             Y02753 40587803
         BNE   RCDPRERR            NO, RECORD PG REL. ERROR      Y02753 40588703
         TM    SPFLAGS,CSA         CSA SUBPOOL?                  Y02714 40589603
         BO    NDRLSFLG            YES, DON'T ABEND              Y02714 40590503
         OI    FLAGS,DEFERR10      SET DEFERRED ERROR 10         Y02714 40591403
NDRLSFLG OI    FREESW,NEEDRLSE     SET FURTHER PG RELEASE NEEDED Y02714 40592303
         LR    RWORK3,RIN3         SAVE DEFERRED PAGE ADDRESS    Y02714 40593203
         LR    WORK,RIN3           NEW RFUB                      Y02714 40595003
         LR    RSIZE,WORK          GET NEW SIZE (RFUB - RFLB) TO Y02714 40595903
         SR    RSIZE,RWORK2         RETURN TO FBQE               Y02714 40596803
         BP    RETPGFBQ            RETURN PAGES TO FBQE, IF ANY  Y02714 40597703
RSETNDRL NI    FREESW,ALL-NEEDRLSE RESET RELEASE NEEDED FLAG     Y02714 40598603
         LR    RWORK2,RWORK3       NEW RFLB = PAGE ABOVE THAT IN Y02714 40599503
         A     RWORK2,PAGE          DEFERRED RELEASE STATUS      Y02714 40600403
         L     WORK,MSAVE+C48      RESTORE ORIGINAL RFUB         Y02714 40601303
         LR    RSIZE,WORK          GET NEW SIZE (RFUB - RFLB)    Y02714 40602203
         SR    RSIZE,RWORK2         TO RELEASE                   Y02714 40604003
         ST    RWORK2,MSAVE+C28    SAVE UPDATED ADDRESS AND      Y02714 40604903
         ST    RSIZE,MSAVE+C60      SIZE FOR CURRGNTP UPDATE     Y02714 40605803
         BP    RELSEPG1            RELEASE REST OF PAGES         Y02714 40606703
         B     RETFBQ3             CONTINUE PROCESSING           Y02714 40607603
         SPACE 2                                                 Y02714 40608503
RCDPRERR MVI   FRRBRNDX,PGRLSRC4   SET RETURN CODE 4 FOR FRR     Y02753 40609403
         ABEND X'C0D',DUMP,,SYSTEM GO TO FRR TO RECORD ERROR     Y02753 40610303
RESTSIZE L     RSIZE,GFRESAVE+C60  RESTORE SIZE                  Y02714 40611203
         B     RETPGFBQ            GO RETURN STORAGE TO FBQE     Y02753 40613003
         SPACE 5                                                 Y02753 40613903
*                                                                       40614803
*        FMCOMMON - DO ANY NECESSARY SMF INTERFACING                    40615703
*                                                                       40616603
         SPACE 2                                                 Y02714 40617503
FSMFINTR TM    SPFLAGS,SQA+CSA+LSQA+SWA+AUK  SKIP SMF?           Y02714 40618403
         BNZ   FMLEAVE             YES                           Y02714 40619303
         LR    RBLKAD,RWORK2       START ADDRESS IN 14 - SIZE IS IN 15  40620203
         L     RDQE,AFMSMF         GET FMSMF ENTRY POINT                40622003
         BALR  RCOMRET1,RDQE       GO TO SMF INTERFACE ROUTINE          40622903
         SPACE 5                                                 Y02714 40623803
*                                                                       40624703
*        FMCOMMON - EXIT AND ERROR PROCESSING                           40625603
*                                                                       40626503
         SPACE 2                                                 Y02714 40627403
FMLEAVE  TM    FLAGS,DEFERR10      IS DEFERRED ERROR 10 SET?     Y02714 40628303
         BZ    FMLEAVE1            NO, GO RETURN                 Y02714 40629203
         LA    RERROR,ERRA         SET ERROR CODE 10           @Z30ENWD 40631003
         MVI   MSGLEN,H4C          REASON CODE 2 - LENGTH 12     Y02714 40631903
         L     RLENGTH,RQSTSIZE    RESTORE ORIGINAL SIZE       @ZA27672 40632340
         B     GERROR3C            GO SAVE TCB ADDRESS           Y02714 40632803
         SPACE 2                                                 Y02714 40633703
FMLEAVE1 L     RCOMRET1,FMSAVE     RESTORE RETURN REG                   40634603
         BR    RCOMRET1            RETURN TO FMCOM                      40635503
         SPACE 2                                                        40636403
GERROR3A OI    FREESW,DECR         INDICATE ADDRESS DECREMENTED  Y02714 40637303
GERROR3B OI    FREESW,INCR         INDICATE LENGTH INCREMENTED          40638203
GERROR3C MVC   ABNDATA,LDATCB      SAVE TCB ADDRESS FOR VAR DATA Y02714 40639103
         B     GERROR              GO TO HANDLE ERROR          @Z30ENWD 40640103
         SPACE 2                                                        40641103
GERROR9A MVI   MSGLEN,C12          REASON CODE 0 - LENGTH 12     Y02714 40642103
         LA    RERROR,ERR9         SET APPROPRIATE ERROR       @Z30ENWD 40643103
         CLI   SVCBYTE,SV5         SVC 5?                        Y02714 40644103
         BE    GERROR3B            YES - MSGLEN OK                      40645103
         MVI   MSGLEN,C8           CHANGE LENGTH TO 8                   40646103
         B     GERROR3B            SET UP REMAINING PARAMETERS          40647103
         SPACE 2                                                        40648103
ERROR13A MVI   MSGLEN,C12          REASON CODE 0 - MSG LENGTH 12 Y02714 40649103
         LA    RERROR,ERRD         SET APPROPRIATE ERROR       @Z30ENWD 40650103
         B     GERROR3A            SET UP REMAINING PARAMETERS          40651103
         EJECT                                                          40652103
*********************************************************************** 40653103
*                                                                     * 40654103
*     MRELEASE GIVES BACK 4K BLOCKS TO THE QUEUE OF FREE STORAGE FOR  * 40655103
*     A REGION. IT ALSO GIVES BACK PARTITIONS TO THE QUEUE OF         * 40656103
*     UNASSIGNED SYSTEM STORAGE.                                      * 40657103
*                                                                     * 40658103
*        ENTRY: MRELEASE                                              * 40660002
*                                                                     * 40720001
*              INPUT                                                  * 40730002
*                     RSIZEM = SIZE OF AREA TO BE RELEASED            * 40740002
*                     RPQEM  = PQE FROM WHICH FBQE CHAIN IS ORIGINED  * 40780001
*                     RADDRM = ADDRESS OF AREA TO BE RELEASED         * 40820001
*                     RRETURN = RETURN REG                            * 40860001
*                     LDACBSP = SPID OF CONTROL BLOCKS (SQA OR LSQA)  * 40870002
*              OUTPUT                                                 * 40880002
*                     ON RETURN - STORAGE RELEASED                    * 40900002
*              WORK                                                   * 40910002
*                     RIN0, RIN1, RPREFBQE, RCOMRET1, RFBQNXT, RBLOCK * 40912002
*                                                                     * 40920001
*********************************************************************** 40940001
         SPACE 2                                                 Y02714 40990002
MRELEASE LA    RBLOCK,DUMFBQE      INITIALIZE DUMMY FBQE         Y02714 41020002
         ST    RSIZEM,SIZE(RBLOCK) INITIALIZE SIZE                      41040001
         ST    RADDRM,FBQAREA(RBLOCK) INITIALIZE AREA                   41060001
         LR    RPREFBQE,RPQEM      PQE IS PREVIOUS FBQE                 41080001
         L     RFBQNXT,FWDPTR(RPREFBQE)  FOWARD FBQE IS NEXT FBQE       41100002
         OI    GMFMSW,GM           INDICATE GETMAIN TO BE DONE          41120001
         CR    RFBQNXT,RPQEM       FBQENXT EQUAL PQE - NO FBQE'S        41140001
         BNE   MFBQEXST            NO SOME FBQE'S EXIST                 41160001
         LR    RFBQNXT,RPQEM       FBQENXT FOR NEW FBQE WILL BE PQE     41180001
MFOUND   ST    RBLOCK,FWDPTR(RPREFBQE)  RBLOCK IS NEXT TO PREVIOUS      41190002
         ST    RPREFBQE,BCKPTR(RBLOCK)  PREV FBQE IS BACK OF RBLOCK     41220002
         ST    RFBQNXT,FWDPTR(RBLOCK)  FBQENXT IS FORWARD TO RBLOCK     41240002
         ST    RBLOCK,BCKPTR(RFBQNXT)  RBLOCK IS PREV TO NEXT           41250002
         B     MCKCOMB             GO TO CHECK FOR COMBINATION          41280001
         SPACE 2                                                 Y02714 41290002
MFBQEXST CLC   FBQAREA(FOUR,RBLOCK),FBQAREA(RFBQNXT)  DOES RBLOCK       41300002
*                                  DESCRIBE AN AREA LOWER IN            41320002
*                                  ADDRESS THAN FBQE NEXT?              41330002
         BL    MFOUND              YES, PLACE FBQE IN QUEUE             41340002
         LR    RPREFBQE,RFBQNXT    OLD NEXT IS NOW PREVIOUS             41360002
         L     RFBQNXT,FWDPTR(RFBQNXT) NEW NEXT                         41380002
         CR    RFBQNXT,RPQEM       NEXT EQUAL PQE?                      41400002
         BE    MFOUND              YES, ADD RBLOCK INTO QUEUE           41420002
         B     MFBQEXST            NO - CHECK NEXT FBQE FOR PROPER SLOT 41440002
         SPACE 2                                                 Y02714 41450002
MCKCOMB  CR    RPREFBQE,RPQEM      PREVIOUS FBQE EQUAL PQE?             41460002
         ST    RPREFBQE,MPTRS      SAVE POINTERS FOR LATER QUEUING      41480002
         ST    RFBQNXT,MPTRS+4     SAVE NEXT ALSO                       41490002
         BE    MSKIP1              YES, CANNOT BE COMBINED              41500002
         BAL   RCOMRET1,COMBINE    GO SEE IF PREV CAN BE COMBINED       41520002
MSKIP1   LR    RPREFBQE,RBLOCK     A COMBINATION WAS NOT DONE SO        41540002
*                                  RBLOCK IS NOW THE PREVIOUS BLOCK     41560002
*                                  WHEN THE NEXT COMBINATION CHECK      41580002
*                                  IS MADE. IF, HOWEVER, A              41600002
*                                  COMBINATION HAS BEEN DONE, RBLOCK    41620002
*                                  HAS BEEN COMBINED WITH THE PREV FBQE 41640002
*                                  SO THAT RPREFBQE REMAINS THE SAME.   41650002
*                                  THIS RETURN IS PLUS 2 TO ELIMINATE   41660002
*                                  THIS INSTRUCTION.                    41680002
         CR    RFBQNXT,RPQEM       NEXT THE PQE                         41700002
         BE    MSKIP2              YES CAN'T COMBINE WITH A PQE         41720002
         OI    GMFMSW,FIRSTSW      TURN ON FIRST TIME THRU SWITCH       41740002
         LR    RBLOCK,RFBQNXT      RBLOCK IS PREV - NEXT IS RBLOCK      41760002
         L     RFBQNXT,FWDPTR(RFBQNXT) NEW NEXT                         41780001
         BAL   RCOMRET1,COMBINE    GO TO SEE IF NEXT CAN BE COMBINED    41800002
         NOPR  RCOMRET1            NO MORE COMBINATION TO BE DONE       41820002
MSKIP2   L     RPREFBQE,MPTRS      RESTORE POINTERS                     41840002
         L     RFBQNXT,MPTRS+4     RESTORE NEXT POINTER                 41850002
         TM    GMFMSW,GM           GETMAIN TO BE DONE                   41860002
         BZ    MCKFM               NO CHECK FOR FREEMAIN                41880002
         ICM   RIN1,MASK1,LDACBSP  INSERT PROPER SUBPOOL ID      Y02714 41920002
         LR    RCOMRET1,RRETURN    SAVE RETURN REG                      41930002
         BAL   RRETURN,GETMAINC    GET FBQE                    @Z30ENWD 41940003
         LR    RRETURN,RCOMRET1    RESTORE RETURN REG                   41950002
         MVC   FWDPTR(FBQESIZE,RIN1),DUMFBQE  MOVE INFO IN FROM DUMMY   41960002
         L     RPREFBQE,BCKPTR(RIN1)  PREV AND NEXT FBQE         Y02714 41970002
         L     RFBQNXT,FWDPTR(RIN1)   MAY HAVE BEEN CHANGED      Y02714 41974002
         ST    RIN1,FWDPTR(RPREFBQE)  NEW IS FORWARD OF PREVIOUS        41980001
         ST    RIN1,BCKPTR(RFBQNXT)  NEW IS BACKWARD OF NEXT            42000002
MCLRSW   MVI   GMFMSW,OFF          CLEAR SWITCHES                       42020002
         BR    RRETURN             RETURN                               42040002
         SPACE 2                                                 Y02714 42050002
MCKFM    TM    GMFMSW,FM           FREEMAIN TO BE DONE                  42060002
         BZ    MCLRSW              NO CLEAR SWITCHES AND RETURN         42080002
         LR    RIN1,RPREFBQE       FREE PREVIOUS FBQE                   42170002
         BAL   RCOMRET1,FMAINC     FREE THE FBQE               @Z30ENWD 42172003
         B     MCLRSW              CLEAR SWITCHES AND RETURN            42173202
         SPACE 4                                                 Y02714 42176702
COMBINE  L     RUB,FBQAREA(RPREFBQE) START OF AREA                      42180001
         A     RUB,SIZE(RPREFBQE)  ADD SIZE TO GET UPPER BOUND          42200001
         C     RUB,FBQAREA(RBLOCK) CAN COMBINATION BE DONE              42220001
         BNER  RCOMRET1            NO CANNOT COMBINE             Y02714 42240002
         TM    GMFMSW,FIRSTSW      FIRST SW ON                          42260001
         BZ    MNFSTSW             NO FIRST TIME THRU                   42280001
         MVC   FBQAREA(FOUR,RBLOCK),FBQAREA(RPREFBQE) NEW START ADDRESS 42300001
*                                  FOR RBLOCK                           42320002
         L     RIN1,SIZE(RPREFBQE) SIZE OF PREVIOUS                     42340002
         A     RIN1,SIZE(RBLOCK)   SIZE OF RBLOCK                       42360002
         ST    RIN1,SIZE(RBLOCK)   PUT NEW SIZE IN                      42380002
         L     RIN1,BCKPTR(RPREFBQE) PREVIOUS PREVIOUS                  42400001
         ST    RBLOCK,FWDPTR(RIN1) RBLOCK IS NOW FORWARD OF PREV        42420002
*                                  PREVIOUS                             42440002
         ST    RIN1,BCKPTR(RBLOCK) PREV PREVIOUS IS NOW BACK            42460001
*                                  OF RBLOCK                            42480002
         TM    GMFMSW,GM           GETMAIN SWITCH ON                    42500002
         BZ    MTURNFM             NO TURN ON FREEMAIN SW               42520002
MGMOFF   NI    GMFMSW,ALL-GM       TURN OFF GM SW                Y02714 42540002
         B     TWO(RCOMRET1)       INDICATE COMBINATION DONE            42560002
         SPACE 2                                                 Y02714 42570002
MTURNFM  OI    GMFMSW,FM           INDICATE FREEMAIN NEEDED             42580002
         B     TWO(RCOMRET1)       INDICATE COMBINATION DONE            42600002
         SPACE 2                                                 Y02714 42610002
MNFSTSW  L     RIN1,SIZE(RPREFBQE) PICK UP SIZE OF PREVIOUS             42620002
         A     RIN1,SIZE(RBLOCK)   SIZE TO BE COMBINED                  42640002
         ST    RIN1,SIZE(RPREFBQE) COMBINE SIZES                        42660002
         ST    RFBQNXT,FWDPTR(RPREFBQE)  SET NEXT AS FWD TO PREV Y02714 42710002
         ST    RPREFBQE,BCKPTR(RFBQNXT)  SET PREV AS BACK TO NEXT       42720002
         B     MGMOFF              TURN OFF GM SWITCH AND RETURN        42740002
         EJECT                                                          42750001
*********************************************************************** 42760001
*                                                                     * 42780001
*     THE SPFRMAIN ROUTINE HANDLES THE FREEING OF AN ENTIRE SUBPOOL.  * 42800001
*     PROCESSING IS DONE FOR BOTH REGION REQUESTS AND FOR SUBPOOLS    * 42840002
*     253 (LSQA) AND 236 AND 237 (SWA).                               * 42860002
*                                                                     * 42900001
*         INPUT: RSPID   = SUBPOOL ID                                 * 42920002
*                RIN0    = 0 TO INDICATE SUBPOOL FREEMAIN (LENGTH)    * 42930002
*                RIN1    = 0 TO INDICATE SUBPOOL FREEMAIN (ADDRESS)   * 42960002
*                                                                     * 43100001
*********************************************************************** 43120001
         SPACE 2                                                 Y02714 43122002
SPFRMAIN OI    FREESW,FREESWM      INDICATE FREEMAIN                    43130001
         STC   RSPID,SAVSPID       SAVE SPID FOR FREEMAIN ERROR  Y02714 43135002
         LTR   RIN0,RIN0           LENGTH EQUAL ZERO             Y02714 43140002
         BNZ   GERROR3D            NO, ERROR                            43160002
         STC   RSPID,SPID          TEST AREA                            43180002
         CLI   SPID,C128           SUBPOOL < 128?                Y02714 43190002
         BL    SOK                 YES                           Y02714 43192002
         CLI   SPID,C253           SUBPOOL > 253?                Y02714 43194002
         BH    GERROR4A            YES, ERROR                    Y02714 43196002
         CLI   SPID,C250           SUBPOOL >= 250?               Y02714 43196402
         BNL   SOK                 YES                           Y02714 43196802
         CLI   SPID,C237           SUBPOOL = 237?                Y02714 43198002
         BE    SOK                 YES                           Y02714 43198402
         CLI   SPID,C236           SUBPOOL = 236?                Y02714 43198802
         BE    SOK                 YES                           Y02714 43199202
         CLI   SPID,C229           SUBPOOL = 229?                Y02714 43199302
         BE    SOK                 YES                           Y02714 43199402
         CLI   SPID,C230           SUBPOOL = 230?                Y02714 43199502
         BE    SOK                 YES                           Y02714 43199602
         CLI   SPID,C233           SUBPOOL = 233?                Y02714 43199902
         BNE   GERROR4A            NO, ERROR                     Y02714 43200002
SOK      OI    MODE,SUBFRMN        INDICATE SUBPOOL FREEMAIN            43400002
         BAL   RCOMRET1,CSPCHK     GO TO OBTAIN SPQE                    43420002
         LTR   RSPQE,RSPQE         SUBPOOL FOUND                        43440002
         BZ    FRETRN2             NO RETURN                     Y02714 43480002
         TM    MODE,KEY0           SUPERVISOR KEY                Y02714 43500002
         BZ    SLSQACK             YES, CHECK FOR AQE REQUEST           43520002
         CLI   SPID,C0             SUBPOOL ZERO REQUEST          Y02714 43530002
         BZ    GERROR4A            YES, ABEND                           43560002
SLSQACK  CLI   SPID,C253           253 REQUEST                          43580002
         BE    SAQE                YES, FREE SUBPOOL 253                43600002
         LR    RPRSDQE,RSPQE       SPQE IS FIRST PREV DQE PTR           43620002
         ST    RPRSDQE,DQESAVE+4   SAVE PREVIOUS POINTER FOR FREEMAIN   43630002
SPFRET   L     RDQE,DQEPTR(RPRSDQE) PICK UP FIRST OR NEXT DQE           43640001
         LTR   RDQE,RDQE           END OF QUEUE                         43660002
         BZ    FRETRN2             YES, RETURN                 @Z30ENWD 43700003
*                                                                       43705003
*        FREE EACH FQE                                                  43710003
*                                                                       43715003
         L     RFQE,DQFQEPTR(RDQE) FIRST FQE                            43720002
SCKNXTFQ LA    RFQE,0(0,RFQE)      CLEAR REGION INDICATOR        Y02714 43730002
         LTR   RFQE,RFQE           END OF QUEUE                  Y02714 43740002
         BZ    SFQEND              YES, SET UP TO FREE DQE              43760002
         LR    RIN1,RFQE           FQE TO FREE                          43800002
         L     RFQE,FQEPTR(RFQE)   NEXT FQE PTR                         43820002
         BAL   RCOMRET1,FMAINC     FREE FQE                    @Z30ENWD 43840003
         B     SCKNXTFQ            CHECK NEXT FQE                       43860002
*                                                                       43870003
*        FREE SPACE DESCRIBED BY DQE                                    43873003
*                                                                       43876003
SFQEND   LA    RCOMRET1,SPFRET     RETURN TO PROCESS NEXT DQE           43880002
         ST    RCOMRET1,FMSAVE                                          43890001
         XC    DQFQEPTR(FOUR,RDQE),DQFQEPTR(RDQE) ZERO FQE PTR          43900001
         ST    RDQE,DQESAVE        FOR FMCOMMON                         43920001
         L     RSIZE,DQELNTH(RDQE) SIZE TO BE RELEASED                  43940002
         L     RWORK2,DQEBLKAD(RDQE) START ADDR                         43960001
         LA    WORK,0(RSIZE,RWORK2)  UPPER BOUND                 Y02714 43970002
         B     SPREL               FREE DQE AND AREA, RETURN WILL BE BY 43980002
*                                  FMLEAVE TO SPFRET                    44000001
*                                                                       44002003
*        SUBPOOL FREEMAIN IS FOR SUBPOOL 253                            44004003
*                                                                       44006003
SAQE     LA    RCOMRET1,SP253RET   RETURN REG                           44020001
         ST    RCOMRET1,FMSAVE                                          44030001
SP253RET L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 44032002
         L     RAQE,TCBAQE         PICK UP AQE QUEUE             Y02714 44040002
         LTR   RAQE,RAQE           END OF QUEUE                         44060001
         BZ    FRETRN2             YES, RETURN                 @Z30ENWD 44100003
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 44110002
         USING CVT,RCVT                                          Y02714 44112002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 44114002
         DROP  RCVT                                              Y02714 44116002
         USING GDA,RGDA                                          Y02714 44118002
         L     RWORK,PASTRT        GET PRIVATE AREA START        Y02714 44118402
         A     RWORK,PASIZE        ADD LENGTH, GIVES BOTTOM CSA  Y02714 44118802
         CR    RAQE,RWORK          IS AQE IN SQA?                Y02714 44119602
         BL    SNOTSQA             NO, CONTINUE PROCESSING              44140002
         L     RSPQE,SQASPQEP      SQA SPQE                      Y02714 44160002
         DROP  RGDA                                              Y02714 44170002
         MVI   SPFLAGS,SQA         INDICATE SQA REQUEST          Y02714 44172002
         B     SSQA                CONTINUE PROCESSING                  44180002
         SPACE 2                                                 Y02714 44190002
SNOTSQA  L     RSPQE,LSQAPTR       LSQA SPQE                     Y02714 44200002
         MVI   SPFLAGS,LSQA        INDICATE LSQA REQUEST         Y02714 44220002
SSQA     L     RLENGTH,AQELEN(RAQE)  LENGTH                      Y02714 44240002
         LR    RADDR,RAQE          ADDRESS TO BE FREED IS AQE ADDR      44260001
         L     RDQE,SPDQEPTR(RSPQE)  FIRST DQE ADDRESS                  44270002
         LR    RPREVDQE,RSPQE      SPQE IS PREVIOUS DQE          Y02714 44280002
         LA    RAUB,0(RLENGTH,RADDR)  UPPER BOUND OF AREA        Y02714 44290402
SPFRDQAD L     RIN0,DQEBLKAD(0,RDQE)  START ADDRESS IN DQE       Y02714 44292802
         CR    RADDR,RIN0          IS AREA AT OR ABOVE THIS      Y02714 44293202
         BL    SPFRNXDQ            NO, TRY NEXT DQE              Y02714 44293602
         A     RIN0,DQELNTH(0,RDQE)  TOP OF AREA IN DQE          Y02714 44293702
         CR    RAUB,RIN0           IS AREA AT OR BELOW THIS      Y02714 44293802
         BNH   SPFRDQFN            YES, CORRECT DQE              Y02714 44293902
SPFRNXDQ LR    RPREVDQE,RDQE       DQE IS NOW PREVIOUS           Y02714 44295902
         L     RDQE,DQEPTR(0,RDQE) POINT TO NEXT DQE             Y02714 44300402
         OI    FREESW,NFRSTDQE     INDICATE THIS ISN'T FIRST DQE Y02714 44300802
         LTR   RDQE,RDQE           IS THERE ONE                  Y02714 44301202
         BNZ   SPFRDQAD            YES, CHECK IT                 Y02714 44301602
         LA    RIN0,SPFMERR        INDICATE ERROR TYPE           Y02753 44301702
         L     RBASE1,BASE101      SET BASE FOR CSECT01        @Y30APYF 44301803
         USING G4KSRCH,RBASE1                                  @Y30APYF 44304003
         B     STBRNDX             GO TO FRR, QUEUES MESSED UP   Y02753 44305003
         USING BASE1,RBASE1        REG ALREADY SET             @Y30APYF 44305503
         SPACE 2                                                        44306003
SPFRDQFN ST    RDQE,DQESAVE        SAVE DQE FOR FMCOMMON         Y02714 44308003
         ST    RPREVDQE,DQESAVE+C4 SAVE PREVIOUS DQE ALSO        Y02714 44309703
         B     SP253FR             GO FREE AREA DESCRIBED BY     Y02714 44311703
*                                  AQE, RETURN IS BY FMLEAVE            44313703
*                                  TO SP253RET                          44315703
         SPACE 2                                                 Y02714 44317703
GERROR3D MVI   MSGLEN,H8C          REASON CODE 4 - LENGTH 12            44319703
         SR    RADDR,RADDR         ZERO ADDRESS POINTER                 44321703
         MVC   ABNDATA,LDATCB      SAVE TCB ADDRESS FOR VAR DATA Y02714 44323703
         LA    RERROR,ERR3         0 LENGTH NOT SPECIFIED FOR  @Z30ENWD 44323903
         B     GERROR              SUBPOOL FREEMAIN            @Z30ENWD 44325903
         SPACE 2                                                        44329703
GERROR4A MVI   MSGLEN,C8           REASON CODE 0 - LENGTH 8             44331703
         SR    RADDR,RADDR         0 ADDRESS POINTER                    44333703
         LA    RERROR,ERR4         INVALID SP FREEMAIN REQUEST @Z30ENWD 44335703
         B     GERROR                                          @Z30ENWD 44336703
         EJECT                                                          44337703
*********************************************************************** 44340001
*                                                                     * 44360001
*  THE QELOCATE ROUTINE FINDS AN FQE WHOSE ADDRESS IS EQUAL TO OR     * 44380002
*  LESS THAN THE HIGH BOUND OF THE AREA BEING FREED. IT ALSO VALIDITY * 44420002
*  CHECKS THE REQUEST TO SEE THAT THE AREA BEING FREED DOES NOT       * 44460001
*  OVERLAP AN AREA WHICH IS PRESENTLY FREE.                           * 44500002
*                                                                     * 44520001
*        INPUT:  RADDR    - ADDRESS OF AREA BEING FREED               * 44540002
*                RLENGTH  - LENGTH OF AREA BEING FREED                * 44580002
*                RAUB     - UPPER BOUND OF AREA BEING FREED           * 44620002
*                RDQE     - DQE INCLUDING AREA TO BE FREED            * 44660002
*                RCOMRET1 - RETURN ADDRESS                            * 44661002
*                                                                     * 44720001
*        OUTPUT: RFQE     - FQE WHOSE ADDR IS EQUAL TO OR LESS THAN   * 44740002
*                           HIGH BOUND OF AREA BEING FREED            * 44780002
*                RPREVFQE - FQE PREV TO RFQE                          * 44820002
*                RUB      - UPPER BOUND OF FQE                        * 44860002
*                RLB      - LOWER BOUND OF FQE                        * 44920002
*                                                                     * 44921002
*        WORK:   RWORK, RWORK4, RIN15                                 * 44922002
*                                                                     * 44940001
*  THE FIRST SECTION OF THIS ROUTINE HAS BEEN OPTIMIZED FOR SPEED.    * 44941002
*  DO NOT MAKE CHANGES WITHOUT CONSIDERING THEIR EFFECT UPON          * 44942002
*  EXECUTION TIME.                                                    * 44943002
*                                                                     * 44944002
*              REGISTER USAGE                                         * 44945002
*                                                                     * 44946002
*  REG   NAME              CONTAINS                                   * 44947002
*                                                                     * 44948002
*   0    RUB       UPPER BOUND OF FQE                                 * 44949002
*   1    RPREVFQE  PREVIOUS FQE                                       * 44950002
*   2    RFQE      CURRENT FQE                                        * 44951002
*   3    RDQE      DQE INCLUDING AREA TO BE FREED (ON ENTRY)          * 44952002
*        RLB       LOWER BOUND OF FQE (DURING LOOP)                   * 44953002
*   4    RLDA      LDA ADDRESS                                        * 44954002
*   5    RERROR    ERROR CODE                                         * 44955003
*   6    RWORK     NEXT FQE (PRELOADED)                               * 44956002
*   7    RAUB      UPPER BOUND OF AREA BEING FREED                    * 44957002
*   8    RBASE1    FIRST BASE REGISTER                                * 44958002
*   9    RCOMRET1  RETURN ADDRESS                                     * 44959002
*  10    RLENGTH   LENGTH OF AREA BEING FREED                         * 44959202
*  11    RADDR     ADDRESS OF AREA BEING FREED                        * 44959402
*  12              NOT USED                                           * 44959602
*  13    RBASE2    SECOND BASE REGISTER                               * 44959802
*  14    RWORK4    MASK TO CLEAR HIGH BIT OF FQE                      * 44959902
*  15    RIN15     LOOP BRANCH ADDRESS                                * 44960902
*                                                                     * 44961102
*********************************************************************** 44961902
         SPACE 2                                                 Y02714 44970002
         CNOP  4,8                 PLACE LOOPS ON DOUBLE WORD    Y02714 44971002
QELOCATE LR    RPREVFQE,RDQE       INITIALIZE PREV FQE IS DQE           44980002
         L     RFQE,FQEPTR(RPREVFQE)  GET FIRST FQE                     45000002
         SLR   RLB,RLB             IN CASE FQE DOESN'T EXIST     Y02714 45010002
         LA    RFQE,0(0,RFQE)      CLEAR REGION INDICATOR        Y02714 45020002
         LTR   RFQE,RFQE           FQE EXIST?                    Y02714 45030002
         BZR   RCOMRET1            NO, RETURN                    Y02714 45040002
         TM    FQTYPE(RFQE),REGION REGION FQE?                          45060002
         BO    QREG                YES                           Y02714 45061002
         LA    RIN15,QNREG         LOOP BRANCH ADDRESS           Y02714 45062002
QNREG    L     RWORK,FQEPTR(0,RFQE)  PRELOAD NEXT FQE ADDRESS    Y02714 45064002
         LA    RUB,FQESLNTH(0,RFQE)  UPPER BOUND OF FQE          Y02714 45065002
         LR    RLB,RUB             GET LOWER BOUND FROM UPPER    Y02714 45066002
         SL    RLB,FQELNTH(0,RFQE)  BOUND MINUS LENGTH           Y02714 45067002
         CLR   RLB,RAUB            LOWER BOUND OF FQE LESS THAN  Y02714 45220002
*                                  UPPER BOUND OF AREA?                 45260002
         BL    QCKOVLP             YES, RIGHT FQE, CHECK FOR OVERLAP    45280002
         BE    QTEMP               CHECK FOR OVERLAP OF NEXT FQE        45300002
         LR    RPREVFQE,RFQE       MAKE CURRENT FQE PREVIOUS            45320002
         LTR   RFQE,RWORK          GET NEXT FQE                  Y02714 45321002
         BNZR  RIN15               IF THERE IS ONE CHECK IT      Y02714 45322002
         BR    RCOMRET1            NONE, RETURN                  Y02714 45323002
         SPACE 2                                                 Y02714 45324002
QREG     L     RWORK4,CLRHIBIT     MASK TO CLEAR FQE HIGH BIT    Y02714 45325002
         LA    RIN15,QREG1         LOOP BRANCH ADDRESS           Y02714 45326002
QREG1    L     RUB,FQAREA(0,RFQE)  UPPER BOUND OF FQE            Y02714 45327002
         L     RWORK,FQEPTR(0,RFQE)  PRELOAD NEXT FQE ADDRESS    Y02714 45328002
         LR    RLB,RUB             GET LOWER BOUND FROM UPPER    Y02714 45329002
         SL    RLB,FQELNTH(0,RFQE)  BOUND MINUS LENGTH           Y02714 45330002
         CLR   RLB,RAUB            LOWER BOUND OF FQE LESS THAN  Y02714 45331002
*                                  UPPER BOUND OF AREA?          Y02714 45332002
         BL    QCKOVLP             YES, RIGHT FQE, CHECK OVERLAP Y02714 45333002
         BE    QTEMP               CHECK FOR OVERLAP OF NEXT FQE Y02714 45334002
         LR    RPREVFQE,RFQE       MAKE CURRENT FQE PREVIOUS     Y02714 45335002
         LR    RFQE,RWORK          GET NEXT FQE                  Y02714 45336002
         NR    RFQE,RWORK4         IS THERE ONE                  Y02714 45337002
         BNZR  RIN15               YES, CHECK IT                 Y02714 45338002
         BR    RCOMRET1            NO, RETURN                    Y02714 45339002
         SPACE 2                                                 Y02714 45340002
*        END OF OPTIMIZED SECTION                                       45341002
         SPACE 2                                                 Y02714 45370002
QCKOVLP  CR    RUB,RADDR           FQE UPPER BOUND GREATER THAN RADDR   45380002
         BH    ERROR10A            YES, AREA TO BE FREED OVERLAPS AN    45400002
*                                  AREA WHICH IS PRESENTLY FREE         45420002
         BR    RCOMRET1            RETURN FQE FOUND                     45440002
         SPACE 2                                                 Y02714 45450002
QTEMP    L     RWORK,FQEPTR(RFQE)  NEXT FQE                             45460002
         LA    RWORK,0(0,RWORK)    CLEAR REGION INDICATOR        Y02714 45470002
         LTR   RWORK,RWORK         ANOTHER FQE EXIST?            Y02714 45480002
         BZR   RCOMRET1            NO - CAN'T OVERLAP - RETURN   Y02714 45500002
         TM    FQTYPE(RWORK),REGION  REGION FQE                         45520001
         BZ    QNOTREG1            NO                                   45540002
         L     RWORK,FQAREA(RWORK) UPPER BOUND OF NEXT FQE              45560001
         B     QUPPRCK             CHECK FOR OVERLAP                    45580002
         SPACE 2                                                 Y02714 45590002
QNOTREG1 LA    RWORK,FQESLNTH(RWORK)  UPPER BOUND OF NEXT FQE    Y02714 45600002
QUPPRCK  CR    RWORK,RADDR         OVERLAP?                             45620002
         BH    ERROR10C            YES, GO TO GERROR                    45640002
         BR    RCOMRET1            NO RETURN FQE FOUND                  45660001
         SPACE 2                                                        45670001
ERROR10A CR    RUB,RAUB            IS FQE HIGH ADDRESS GREATER THAN     45672001
*                                  UPPER BOUND OF AREA BEING FREED?     45674001
         BL    ERROR10B            NO                                   45676401
         LR    RWORK,RAUB          GET HIGH AREA ADDRESS        YA00829 45677203
         CR    RADDR,RLB           IS AREA LOW ADDRESS GREATER  YA00829 45677303
*                                  THAN FQE LOWER BOUND?        YA00829 45677403
         BH    ERROR10C            YES                          YA00829 45677503
ERROR10E SR    RWORK,RLB           CALCULATE OVERLAP            YA00829 45677603
         B     ERROR10D            STORE VARIABLE DATA                  45678603
         SPACE 2                                                        45679603
ERROR10B LR    RWORK,RUB           SET UP HIGH ADDRESS                  45680603
         CR    RLB,RADDR           IS FQE LOWER BOUND GREATER   YA00829 45681603
*                                  THAN AREA ADDRESS?           YA00829 45682603
         BH    ERROR10E            YES                          YA00829 45683603
ERROR10C SR    RWORK,RADDR         GET AMOUNT OF OVERLAP                45684603
ERROR10D ST    RWORK,ABNDATA       SET UP VARIABLE DATA FIELD           45685603
         MVI   MSGLEN,H2C          REASON CODE 1 - LENGTH 12            45690702
         LA    RERROR,ERRA         AREA BEING FREED OVERLAPS   @Z30ENWD 45693803
         B     GERROR               FREE AREA                  @Z30ENWD 45694803
         EJECT                                                          45696901
*********************************************************************** 45700001
*                                                                     * 45720001
*       THIS ROUTINE PROCESSES THE CONDITIONS OF OUT OF REGION,       * 45740002
*       L/SQA VIRTUAL SPACE AND OUT OF REAL L/SQA SPACE.              * 45780002
*                                                                     * 45800001
*       ENTRY POINTS: GNOTSATA - FROM GETMAIN COMMON OR GETMAINB      * 45860002
*                                WHEN OUT OF VIRTUAL L/SQA            * 45900002
*                     GNOTSATB - FROM GETMAIN COMMON WHEN OUT OF      * 45960002
*                                VIRTUAL REGION SPACE                 * 46000002
*                     GNOTSATC - FROM GFRECORE WHEN A REAL PAGE       * 46040002
*                                CANNOT BE OBTAINED                   * 46080002
*                                                                     * 46100001
*       REGISTERS UPON INPUT THAT ARE USED                            * 46120002
*                                                                     * 46140001
*                     RLENGTH  - ACTUAL LENGTH REQUIRED               * 46150002
*                     RSPID    - SPID                                 * 46160002
*                     RSPQE    - SPQE POINTER                         * 46170002
*                     RPREVDQE - LAST DQE ON CHAIN                    * 46172002
*                     RIN15    - LARGEST SIZE AVAILABLE               * 46173002
*                                                                     * 46180001
*********************************************************************** 46200001
         SPACE 2                                                 Y02714 46202002
GNOTSATA LR    RIN0,RIN15          LARGEST SIZE FROM GFRECORE    Y02714 46212003
         TM    CELLFLGS,INCELL     IS GMC THE CALLER?          @Z30ENWD 46215003
         BZ    GREQCEL             NO, GET A CELL              @Z30ENWD 46218003
         SR    RCELLP,RCELLP       YES, ZERO THE CELL POINTER  @Z30ENWD 46221003
         B     ADDSIZE             GO TO ADD CELL LENGTH       @Z30ENWD 46224003
         SPACE                                                          46230003
GREQCEL  TM    SPFLAGS,LSQA        LSQA REQUEST?               @Z30ENWD 46233003
         BO    SETLCL              YES                         @Z30ENWD 46235003
         ICM   RIN1,MASK1,SP245B   NO, SQA REQUEST             @Z30ENWD 46237003
         B     GETCNOW             GET A CELL                  @Z30ENWD 46239003
SETLCL   ICM   RIN1,MASK1,SP255B   LSQA                        @Z30ENWD 46241003
GETCNOW  OI    CELLFLGS,GNOTCALL   GNOT IS CALLING GME         @Z30ENWD 46243003
         LR    RCELLP,RPREVDQE      SAVE RPREVDQE              @Z30ENYF 46244003
         BAL   RRETURN,GETMAINC    GET A CELL                  @Z30ENWD 46245003
         NI    CELLFLGS,ALL-GNOTCALL  RESET GNOT CALLING FLAG  @Z30ENWD 46247003
         SR    SIZEREG,SIZEREG     PRESET                      @Z30ENWD 46249003
         XR    RCELLP,RPREVDQE        SWITCH REGISTERS         @Z30ENYF 46249503
         XR    RPREVDQE,RCELLP                                 @Z30ENYF 46250003
         XR    RCELLP,RPREVDQE                                 @Z30ENYF 46250503
         LTR   RCELLP,RCELLP       DID I GET ONE?              @Z30ENWD 46251003
         BNZ   DONTADD             YES                         @Z30ENWD 46253003
         SPACE                                                          46259003
ADDSIZE  LA    SIZEREG,DQESIZE     GET SIZE OF DQE             @Z30ENWD 46260803
DONTADD  LA    RAREG,C4095         GET PAGE SIZE - 1           @Z30ENWD 46261803
         AR    SIZEREG,RAREG       SUM OF THESE                  Y02714 46264403
         AR    SIZEREG,RLENGTH     TOTAL LENGTH + 4095           Y02714 46266203
         TM    SPFLAGS,LSQA        LSQA REQUEST?                 Y02714 46268003
         BZ    ROUNDUP             NO                            Y02714 46268903
         TM    FLAGS,GETMB         GETMAINB REQUEST?             Y02714 46269803
         BO    ROUNDUP             YES                           Y02714 46272603
         LA    RIN15,PGTABLEN      LENGTH OF PAGE TABLES         Y02714 46273603
         LR    RIN3,RLENGTH        LENGTH OF REQUEST             Y02714 46274603
         SRL   RIN3,C16            NUMBER OF WHOLE SEGMENTS      Y02714 46277003
         LA    RIN3,C1(0,RIN3)     TOTAL NUMBER OF SEGMENTS      Y02714 46278803
         MR    RRETURN,RIN3        LENGTH NEEDED FOR PG. TABLES  Y02714 46279603
         AR    SIZEREG,RIN15       ADD TO TOTAL LENGTH           Y02714 46281203
         TM    SPFLAGS,REQ4K       SP=253/254 AND LENGTH=4K?   @ZA30210 46281740
         BNO   ROUNDUP             NO, SIZEREG IS O. K.        @ZA30210 46282240
         A     SIZEREG,PAGE        GET AN EXTRA PAGE           @ZA30210 46282740
ROUNDUP  OR    SIZEREG,RAREG       RESET 12 LOW ORDER            Y02714 46283303
         XR    SIZEREG,RAREG        BITS; NOW HAVE # OF 4K PAGES Y02714 46284303
         MVC   OBFRSAVE(C64),FBQSAVE  SAVE REGISTER SAVE AREA    Y02714 46286003
         MVC   GNOTSAVE(C64),G4KSAVE  SAVE REGISTER SAVE AREA    Y02714 46288803
         MVC   CODE2,CODE1         SAVE OPTION CODE              Y02714 46289803
         MVI   CODE1,C0            ZERO OPTION CODE - G4KSRCH    Y02714 46291403
*                                  CHECKS CODE1 FOR PG. BOUNDARY Y02714 46293203
*                                  AND VARIABLE                  Y02714 46295003
         MVI   OUTSW,VIRTUAL       PRESET - OUT OF VIRTUAL       Y02714 46296003
         BAL   RRETURN,G4KSRCH1    SEARCH FBQES FOR STORAGE    @Y30APYF 46298603
         B     GNTSATA1            FOUND                         Y02714 46299603
         MVC   FBQSAVE(C64),OBFRSAVE  NONE AVAILABLE, RESTORE    Y02714 46302203
         MVC   G4KSAVE(C64),GNOTSAVE   REGISTER SAVE AREAS       Y02714 46304003
         MVC   CODE1,CODE2         RESTORE OPTION CODE           Y02714 46305803
         CR    RIN0,RIN15          FQE SIZE LARGEST?             Y02714 46306803
         BH    GNOTSTC1            YES, MAX SIZE O. K.         @Z30ENYF 46307803
         TM    SPFLAGS,LSQA        LSQA SUBPOOL?                 Y02714 46309403
         BZ    GNTSATA0            NO                            Y02714 46310403
         TM    FLAGS,GETMB         GETMAINB REQUEST?             Y02714 46312803
         BO    GNTSATA0            YES                           Y02714 46316003
         LA    RWORK2,PGTABLEN     LENGTH OF PAGE TABLES         Y02714 46317003
         LR    RWORK,RIN15         SIZE AVAILABLE                Y02714 46318003
         SRL   RWORK,C16           NUMBER OF WHOLE SEGMENTS      Y02714 46320003
         LA    RWORK,C1(0,RWORK)   TOTAL NUMBER OF SEGMENTS      Y02714 46321003
         MR    RWORK,RWORK         LENGTH NEEDED FOR PG. TABLES  Y02714 46323803
         SR    RIN15,RWORK2        MAX LENGTH FOR REQUEST        Y02714 46325803
GNTSATA0 LTR   RIN1,RCELLP         DO WE HAVE A CELL?          @Z30ENWD 46326803
         BZ    REDUCESZ            NO                          @Z30ENWD 46327803
         BAL   RCOMRET1,FMAINC     FREE THE CELL               @Z30ENWD 46328803
         B     CKGFREE             CHECK FOR LARGEST           @Z30ENWD 46329803
REDUCESZ LA    RWORK,DQESIZE       SIZE OF DQE                 @Z30ENWD 46330803
         SR    RIN15,RWORK         REDUCE SIZE AVAILABLE         Y02714 46335603
CKGFREE  CR    RIN0,RIN15          GFRECORE HAVE MORE?           Y02714 46338203
         BNH   GNOTSTC1            NO, LEAVE AS IS               Y02714 46339203
         LR    RIN15,RIN0          YES, SET AS MAX               Y02714 46340203
         B     GNOTSTC1            CONTINUE PROCESSING                  46343203
         SPACE 2                                                 Y02714 46344203
GNTSATA1 LTR   RFQE,RCELLP         DID I GET A CELL?           @Z30ENYF 46346203
         BNZ   COPYDUMY            YES, INITIALIZE IT          @Z30ENWD 46347203
         MVC   NOTSATS1,LDARQSTA   SAVE CURRENT REQUEST STATUS @Z30ENWD 46348203
         MVC   LDARQSTA,SETUP      REINIT STATUS FOR DQE REQUEST Y02714 46350203
         CLI   LDACBSP,CBSQA       CONTROL BLOCKS IN SQA?        Y02714 46352803
         BNE   GNTSATA2            NO, LEAVE AS IS               Y02714 46354403
         XI    SPFLAGS,SQA+LSQA    YES, CHANGE TO SQA            Y02714 46355303
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 46357203
         USING CVT,RCVT                                          Y02714 46360003
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 46362003
         DROP  RCVT                                              Y02714 46363003
         USING GDA,RGDA                                          Y02714 46364003
         L     RSPQE,SQASPQEP      GET SQA SPQE POINTER (IN CASE Y02714 46366003
         DROP  RGDA                  OF SP 239)                  Y02714 46368003
GNTSATA2 OI    FLAGS,EXPANSN       INDICATE EXPANS. FOR GNOTSATC Y02714 46370003
         LA    RLENGTH,DQESIZE     SET LENGTH TO DQE SIZE        Y02714 46372003
         BAL   RCOMRET1,GFRECORE   GET STORAGE FOR DQE           Y02714 46373003
         B     GOOF1               STORAGE NOT AVAILABLE         Y02714 46374003
         BAL   RCOMRET1,GFQEUPDT   REMOVE STORAGE FROM FQE       Y02714 46376003
         MVC   LDARQSTA,NOTSATS1   RESTORE CURRENT REQ STATUS  @Z30ENWD 46378003
COPYDUMY MVC   0(DQESIZE,RFQE),DUMYDQE MOVE DQE CONTENTS       @Z30ENWD 46379003
         L     RPREVDQE,G4KSAVE+C4 RESTORE PREVIOUS DQE POINTER  Y02714 46381003
         ST    RFQE,DQEPTR(0,RPREVDQE) CORRECT DQE POINTER       Y02714 46384003
         MVC   FBQSAVE(C64),OBFRSAVE  RESTORE REG SAVE AREA      Y02714 46385003
         MVC   G4KSAVE(C64),GNOTSAVE  RESTORE REG SAVE AREA      Y02714 46387003
         MVC   CODE1,CODE2         RESTORE OPTION CODE           Y02714 46389003
         TM    FLAGS,GETMB         GETMAINB REQUEST?             Y02714 46390003
         BO    GNTSATA3            YES                           Y02714 46392003
         LM    RIN0,RIN15,GMREPSAV RESTORE REGS FOR RETRY        Y02714 46394003
*                                                              @ZA29442 46394140
*        SEE IF THE REQUEST WAS CONVERTED FROM LSQA TO SQA.    @ZA29442 46394240
*        THIS CAN HAPPEN IF THERE WAS INSUFFICIENT LSQA, THE   @ZA29442 46394340
*        REQUEST WAS CONDITIONAL, AND THE REQUESTING TASK WAS  @ZA29442 46394440
*        ABENDING.  IF SO, PICK UP THE SQA SPQE POINTER SO     @ZA29442 46394540
*        THAT THE CORRECT QUEUES WILL BE SEARCHED.             @ZA29442 46394640
*                                                              @ZA29442 46394740
         TM    SPFLAGS,CSA+SQA     LOOKING FOR SQA ?           @ZA29442 46394840
         BC    NOTMIXED,GMREPEAT   NO, USE SPQE PTR AS IS      @ZA29442 46394940
         L     RCVT,CVTPTR         GET CVT POINTER             @ZA29442 46395340
         USING CVT,RCVT                                        @ZA29442 46395440
         L     RGDA,CVTGDA         GET GDA POINTER             @ZA29442 46395540
         DROP  RCVT                                            @ZA29442 46395640
         USING GDA,RGDA                                        @ZA29442 46395740
         L     RSPQE,SQASPQEP      GET SQA SPQE                @ZA29442 46395840
         DROP  RGDA                                            @ZA29442 46395940
         B     GMREPEAT            REPEAT REQUEST                Y02714 46396003
         SPACE 2                                                 Y02714 46397003
GNTSATA3 LM    RAREG,RIN1,SAVEREG2 RESTORE GETMAINB RETRY REGS   Y02714 46398003
         B     GMBRETRY            TRY REQUEST AGAIN             Y02714 46400003
         SPACE 2                                                 Y02714 46402003
GOOF1    MVI   FRRBRNDX,GFREFAIL   GFRECORE FAILED TO FIND SPACE Y02753 46404003
         ABEND X'C0D',DUMP,,SYSTEM GO TO FRR TO RECORD           Y02753 46405003
         SPACE 2                                                 Y02714 46406003
GNOTSATC MVI   OUTSW,REALOUT       INDICATE OUT OF REAL                 46408003
GNOTSTC1 TM    FLAGS,GETMB         IS IT A GETMAINB REQUEST      Y02714 46413003
         BO    NGMBPROC            YES, PROCESS FOR GETMAINB REQUEST    46414003
         TM    FLAGS,EXPANSN       SQA OR LSQA EXPANSION?        Y02714 46415003
         BO    GOOF1               YES, SHOULD NEVER OCCUR       Y02714 46417003
         TM    CODE1,VARBLE        IS IT A VARIABLE REQUEST?            46418003
         BO    NVARPROC            YES, PROCESS VARIABLE REQUEST        46420003
BRINGTST TM    CODE1,CONDTNL       IS IT A CONDITIONAL REQUEST?         46422003
         BZ    CNDTNPRO            NO, TERMINATE REQUEST         Y02714 46424003
         TM    SPFLAGS,LSQA        LSQA REQUEST?                 Y02714 46426003
         BZ    CNDTNPRO            NO, TERMINATE REQUEST         Y02714 46428003
         TM    FLAGS,LDAABGM       ABEND IN PROCESS ?          @ZA29616 46430040
         BO    TRYSQA              YES, CONVERT REQUEST TO SQA @ZA29616 46440040
         CLI   SAVSPID,C254        MAYBE. IS REQUEST FOR 254 ? @ZA29616 46450040
         BE    CNDTNPRO            YES, THERE IS NO ABEND      @ZA29616 46460040
         L     RTCB1,LDATCB        GET TCB ADDRESS               Y02714 46470040
         TM    TCBFLGS3,TCBABGM    ABEND IN PROCESS?                    46480040
         BZ    CNDTNPRO            NO, TERMINATE REQUEST                46490040
TRYSQA   LM    RIN0,RIN15,GMREPSAV RESTORE REGS FOR RETRY      @ZA29616 46500040
         LA    RSPID,C245          GET SQA SPID                  Y02714 46550002
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 46552002
         USING CVT,RCVT                                          Y02714 46554002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 46556002
         DROP  RCVT                                              Y02714 46558002
         USING GDA,RGDA                                          Y02714 46558402
         L     RSPQE,SQASPQEP      GET SQA SPQE                  Y02714 46558802
         DROP  RGDA                                              Y02714 46559202
         XI    SPFLAGS,LSQA+SQA    RESET LSQA; SET SQA           Y02714 46559602
         B     GMREPEAT            REPEAT REQUEST                       46640002
         SPACE 2                                                 Y02714 46650002
NGMBPROC TM    CELLFLGS,INEXPN     WAS EXPANSION THE CALLER    @Z30ENWD 46650903
         BZ    TESTYPE             NO                          @Z30ENWD 46651903
         LA    REG5,CELLEN         LENGTH OF ONE CELL          @Z30ENWD 46652903
         CR    RIN15,REG5          ENOUGH FOR ONE CELL?        @Z30ENWD 46653903
         BNL   SETMAXC             YES                         @Z30ENWD 46654903
         LM    RAREG,RIN1,SAVEREG2 RESTORE REGS                @Z30ENWD 46655903
         SR    RLENGTH,RLENGTH     ZERO LENGTH                 @Z30ENWD 46656903
         B     EXPNFMT             RETURN WITH ZERO LENGTH     @Z30ENWD 46657903
         SPACE                                                          46659603
SETMAXC  LR    RLENGTH,RIN15       SET NEW REQUEST LENGTH      @Z30ENWD 46659703
         SRL   RLENGTH,C3          ROUND TO 16 BYTE LENGTH     @Z30ENWD 46660703
         SLL   RLENGTH,C3          REPOSITION                  @Z30ENWD 46661703
         LM    RAREG,RCOMRET1,SAVEREG2 RESTORE                 @Z30ENWD 46662703
         LM    REGB,RIN1,SAVEREG2+C36   REGS FOR RETRY         @Z30ENYF 46663703
         B     GMBRETRY            RETRY SMALLER AMOUNT        @Z30ENWD 46664703
         SPACE                                                          46670003
TESTYPE  TM    SPFLAGS,LSQA        LSQA REQUEST?               @Z30ENWD 46672003
         BO    NLSQARTY            YES, PICK UP SQA AND RETRY  @Z30ENWD 46679003
WAITPREP L     REGB,ASTERMR        SYSTEM TERM ROUTINE, REAL - @Z30ENWD 46686003
*                                  MAY BE BRANCHED TO FROM GMC @Z30ENWD 46693003
         TM    OUTSW,VIRTUAL       OUT OF VIRTUAL?               Y02714 46700002
         BZR   REGB                NO, OUT OF REAL               Y02751 46720002
         L     REGB,ASTERMV        SYSTEM TERM ROUTINE, VIRTUAL  Y02751 46721002
         BR    REGB                TERMINATE SYSTEM              Y02751 46770002
         SPACE 2                                                 Y02714 46772002
NLSQARTY LM    RAREG,RIN1,SAVEREG2 RESTORE REGS FOR RETRY               46780001
         LA    RSPID,C245          GET SQA SPID                  Y02714 46800002
         XI    SPFLAGS,LSQA+SQA    RESET LSQA; SET SQA           Y02714 46810002
         L     RCVT,CVTPTR         GET CVT POINTER               Y02714 46812002
         USING CVT,RCVT                                          Y02714 46814002
         L     RGDA,CVTGDA         GET GDA POINTER               Y02714 46816002
         DROP  RCVT                                              Y02714 46818002
         USING GDA,RGDA                                          Y02714 46818402
         L     RSPQE,SQASPQEP      GET SQA SPQE                  Y02714 46818802
         DROP  RGDA                                              Y02714 46819202
         B     GMBRETRY            RETRY REQUEST                        46860002
         SPACE 2                                                 Y02714 46862002
GNOTSATB MVI   OUTSW,VIRTUAL       INDICATE  OUT OF VIRTUAL             46870003
         TM    CODE1,VARBLE        VARIABLE REQUEST?                    46920002
         BO    NVARPROC            YES, PROCESS VARIABLE REQUEST        46940002
CNDTNPRO TM    CODE1,LIST          IS IT A LIST ENTRY                   46960002
         BM    NLISTPRO            YES, PROCESS LIST ENTRY              46980002
NFIRST   TM    OUTSW,VIRTUAL       OUT OF REAL?                  Y02714 47040002
         LA    RERROR,ERR1         SET ERROR CODE              @Z30ENWD 47050003
         BZ    GERROR              YES                         @Z30ENWD 47060003
         ST    RIN15,ABNDATA       SAVE LARGEST AVAILABLE FOR VAR DATA  47070001
         MVI   MSGLEN,H28          REASON CODE 1 - LENGTH 8      Y02714 47072002
         OI    FREESW,INCR         INDICATE LENGTH INCREMENTED          47074001
         LA    RERROR,ERR8         OUT OF VIRTUAL              @Z30ENWD 47080003
         B     GERROR              HANDLE THE ERROR            @Z30ENWD 47110003
         SPACE 2                                                        47156001
NVARPROC EQU   *                                                        47158001
         L     RLENGTH,MINMAX      GET MINIMUM REQUEST                  47158401
         LTR   RLENGTH,RLENGTH     NEGATIVE MINIMUM REQUEST?   @ZA16417 47158640
         BM    GERROR8A            YES, ERROR                  @ZA16417 47158940
         BAL   RCOMRET1,CRNDLNTH   ROUND UP MIN AND ACCOUNT FOR AQE     47159140
*                                  IF NEEDED                            47159540
         CR    RIN15,RLENGTH       WILL AVAILABLE FULFILL MIN?          47159601
         BL    NLSQACK             NO REQUEST CAN'T BE SATISFIED        47200002
         LR    RLENGTH,RIN15       SET LENGTH TO LARGEST AVAILABLE      47220002
         B     RETRYMIN            RETRY REQUEST                 Y02714 47280002
         SPACE 2                                                 Y02714 47290002
NLSQACK  TM    SPFLAGS,SQA+CSA+LSQA+SWA+AUK PROB. PROG. SUBPOOL? Y02714 47300002
         BNZ   BRINGTST            NO, CONTINUE                  Y02714 47340002
         L     RWORK,VVREGSZ       GET EXPLICIT V=V REGION SIZE  Y02714 47350002
         LTR   RWORK,RWORK         IS ONE GIVEN?                 Y02714 47352002
         BZ    NFIRST              NO, TERMINATE REQUEST         Y02714 47354002
         TM    FLAGS,VARPASS2      YES, IS THIS THE SECOND PASS? Y02714 47356002
         BZ    RETRYMIN            NO, IGNORE REGION AND RETRY   Y02714 47358002
         NI    FLAGS,ALL-VARPASS2  RESET FLAG                    Y02714 47358402
         B     NFIRST              TERMINATE REQUEST             Y02714 47358802
         SPACE 2                                                 Y02714 47359202
RETRYMIN OI    FLAGS,VARPASS2      INDICATE SECOND PASS          Y02714 47359602
         ST    RLENGTH,GMREPSAV+C40  SAVE NEW LENGTH             Y02714 47359840
         LM    RIN0,RIN15,GMREPSAV RESTORE REGS 0-15             Y02714 47370002
         LTR   RLENGTH,RLENGTH     ZERO MINIMUM REQUEST?       @ZA16417 47371040
         BZ    GCOMM11             YES                         @ZA16417 47372040
         B     GMREPEAT            RETRY REQUEST FOR MINIMUM SIZE       47380002
         SPACE 2                                                 Y02714 47390002
NLISTPRO LA    RWORK,FOUR          WORD SIZE                            47400002
         C     RWORK,LSTINDEX      IS THIS FIRST ENTRY                  47410002
         BH    NFIRST              YES                                  47420002
         L     RLENGTH,LENSAVE     BEGINNING OF LENGTH LIST             47440002
         A     RLENGTH,LSTINDEX    GET PRESENT ENTRY                    47450002
         SR    RLENGTH,RWORK       DECREMENT TO PREVIOUS ENTRY          47480001
         OI    0(RLENGTH),LAST     MAKE TEMPORARILY LAST         Y02714 47500002
         ST    RLENGTH,NOTSATSV    SAVE TEMPORARY END POINTER           47520002
         LM    RIN0,RIN15,GMREPSAV RESTORE ORIGINAL REGS  0-15   Y02714 47540002
         L     RLENGTH,LENSAVE     POINTER TO BEGINNING OF LIST         47552002
         MVC   NOTSATS1,LDARQSTA   SAVE STATUS                   Y02714 47554002
         NI    FLAGS,ALL-BRENTRY   INSURE FREEMAIN RETURNS HERE  Y02714 47556002
         MVC   GNOTSAVE(FOUR),RETSAVE  SAVE USER RETURN ADDRESS  Y02714 47558002
         LA    RRETURN,NLISTPR1    GET LOCAL RETURN ADDRESS      Y02714 47558402
         ST    RRETURN,RETSAVE     SAVE FOR FMCOMMON             Y02714 47558802
         B     FLISTADV            FREE ALREADY OBTAINED ENTRIES Y02714 47560002
         SPACE 2                                                 Y02714 47560402
NLISTPR1 MVC   RETSAVE(FOUR),GNOTSAVE  RESTORE USER RETURN ADDR  Y02714 47562002
         MVC   LDARQSTA,NOTSATS1   RESTORE STATUS                Y02714 47570002
         L     RLENGTH,NOTSATSV    LENGTH POINTER                       47600002
         NI    0(RLENGTH),ALL-LAST RESET TEMPORARY END OF LIST   Y02714 47620002
         B     NFIRST              CONTINUE PROCESSING                  47640001
         EJECT                                                          48340001
*********************************************************************** 48344003
*                                                                       48348003
*        GFQEUPDT - REMOVES AREA TO BE ALLOCATED FROM FQE               48352003
*                                                                       48356003
*              INPUT                                                    48360003
*                   RFQE     - FQE ADDRESS                              48364003
*                   RPREVFQE - PREVIOUS FQE ADDRESS                     48368003
*                   RLENGTH  - LENGTH OF REQUEST                        48372003
*                   RCOMRET1 - RETURN ADDRESS                           48376003
*              OUTPUT                                                   48380003
*                   RFQE     - ADDRESS OF ALLOCATED AREA                48384003
*              WORK REGS                                                48388003
*                   RWORK, RNEWFQE, RIN0, RIN15                         48392003
*                                                                       48396003
*********************************************************************** 48400003
         SPACE 2                                                 Y02714 48404003
GFQEUPDT L     RWORK,FQELNTH(RFQE) PICK UP FQE LENGTH                   48408003
         SR    RWORK,RLENGTH       GET REMAINING STORAGE                48412003
         LTR   RWORK,RWORK         ANY REMAINING                        48416003
         BZ    REMFQE              NO                                   48420003
         TM    FQTYPE(RFQE),REGION REGION FQE                    Y02714 48424003
         BZ    MOVEFQE             NO - FQE MUST BE MOVED               48428003
         ST    RWORK,FQELNTH(RFQE) PUT NEW LENGTH IN FQE                48432003
         L     RWORK,FQAREA(RFQE)  PICK UP AREA ADDRESS                 48436003
         SR    RWORK,RLENGTH       GET NEW AREA ADDRESS                 48440003
         ST    RWORK,FQAREA(RFQE)  PLACE ADDRESS IN FQE                 48444003
AQECHK   TM    SPFLAGS,NEEDAQE     AQE NEEDED?                   Y02714 48448003
         BZ    GFQERET             NO                                   48452003
         LA    RFQE,AQESIZE        GET AQE SIZE                  Y02714 48456003
         AR    RWORK,RFQE          ACCOUNT FOR AQE AT            Y02714 48460003
*                                  BEGINNING OF AREA             Y02714 48464003
         SR    RLENGTH,RFQE        DECREMENT LENGTH DUE TO AQE   Y02714 48468003
GFQERET  LR    RFQE,RWORK          POINT TO AREA ASSIGNED               48472003
         BR    RCOMRET1            RETURN                               48476003
         SPACE 2                                                        48480003
REMFQE   MVC   FQEPTR+1(C3,RPREVFQE),FQEPTR+1(RFQE)  DEQUEUE FQE Y02714 48484003
         TM    FQTYPE(RFQE),REGION REGION FQE                    Y02714 48488003
         BZ    GETSTRT             NO                                   48492003
         LR    RIN15,RCOMRET1      SAVE RETURN REG                      48500003
         L     RWORK,FQAREA(RFQE)  GET AREA ADDRESS                     48504003
         SR    RWORK,RLENGTH       GET BEGINNING ADDRESS                48508003
         LR    RIN1,RFQE           GET ADDRESS TO FREE                  48520003
         BAL   RCOMRET1,FMAINC     FREEMAIN FQE                @Z30ENWD 48524003
         LR    RCOMRET1,RIN15      RESTORE RETURN REG                   48528003
         B     AQECHK              CHECK ON AQE                         48532003
         SPACE 2                                                        48536003
GETSTRT  LR    RWORK,RFQE          GET FQE ADDRESS                      48540003
         LA    RWORK,FQESLNTH(RWORK)  GET END ADDRESS            Y02714 48544003
         SR    RWORK,RLENGTH       GET BEGINNING ADDRESS                48548003
         B     AQECHK              CHECK FOR AQE                        48552003
         SPACE 2                                                        48556003
MOVEFQE  LR    RNEWFQE,RFQE        GET ADDRESS                          48560003
         SR    RNEWFQE,RLENGTH      OF NEW FQE                          48564003
         ST    RWORK,FQELNTH(RNEWFQE)  PUT NEW LENGTH IN NEW FQE        48568003
         L     RWORK,FQEPTR(0,RFQE)  GET OLD FORWARD POINTER     Y02714 48572003
         ST    RWORK,FQEPTR(0,RNEWFQE)  PLACE IN NEW FQE         Y02714 48576003
         ST    RNEWFQE,FQEPTR(RPREVFQE)  CHAIN PREV FQE TO NEW FQE      48580003
         LA    RWORK,FQESLNTH(RNEWFQE)  ADDRESS OF AREA ASSIGNED Y02714 48584003
         B     AQECHK                                                   48588003
         EJECT                                                          48592003
*********************************************************************** 48596003
*                                                                       48600003
*  THE GFRECORE ROUTINE SEARCHES THE FQE CHAIN(S) OF A SUBPOOL TO       48604003
*  LOCATE AN FQE TO SATISFY A GETMAIN REQUEST, USING A BEST FIT         48608003
*  ALGORITHM.  SPECIAL PROCESSING IS DONE TO FIX A PAGE                 48612003
*  TO BACK UP ALL SATISFIED L/SQA REQUESTS.  L/SQA REQUESTS             48616003
*  OF 4K OR LESS ARE NOT SATISFIED ACROSS PAGE BOUNDARIES.              48620003
*                                                                       48624003
*              INPUT                                                    48628003
*                   RSPQE    - ADDRESS OF SUBPOOL QUEUE ELEMENT         48632003
*                   RLENGTH  - REQUESTED LENGTH                         48636003
*                   RCOMRET1 - RETURN ADDRESS                           48640003
*                                                                       48644003
*              OUTPUT                                                   48648003
*                   RPREVDQE - LAST DQE ON CHAIN - STORAGE NOT FOUND    48652003
*                   RFQE     - ADDRESS OF CURRENT FQE                   48656003
*                   RPREVFQE - ADDRESS OF PREVIOUS FQE                  48660003
*                   RIN15    - LARGEST AREA AVAILABLE - STORAGE         48664003
*                              NOT FOUND                                48668003
*                                                                       48672003
*                                                                       48676003
*  THE FIRST SECTION OF THIS ROUTINE HAS BEEN OPTIMIZED FOR SPEED.      48680003
*  DO NOT MAKE CHANGES WITHOUT CONSIDERING THEIR EFFECT UPON            48684003
*  EXECUTION TIME.                                                      48688003
*                                                                       48692003
*              REGISTER USAGE                                           48696003
*                                                                       48700003
*  REG   NAME              CONTAINS                                     48704003
*                                                                       48708003
*   0    RIN0      NEXT DQE (PRELOADED)                                 48712003
*   1    RPREVFQE  PREVIOUS FQE                                         48716003
*   2    RFQE      CURRENT FQE                                          48720003
*   3    RDQE      CURRENT DQE                                          48724003
*   4    RLDA      LDA ADDRESS                                          48728003
*   5    RWORK3    PREVIOUS FQE TO CLOSEST FQE                          48732003
*   6    RWORK     CLOSEST FQE (IN SIZE)                                48736003
*   7    RSPQE     SPQE ADDRESS (ON ENTRY)                              48740003
*        RPRVDQE   PREVIOUS DQE (DURING LOOP)                           48744003
*   8    RBASE1    FIRST BASE REGISTER                                  48748003
*   9    SEGREG    MASK TO CLEAR HIGH BYTE OF FQE                       48752003
*  10    RLENGTH   REQUESTED LENGTH                                     48756003
*  11    RFQESIZE  CURRENT FQE SIZE                                     48760003
*  12    WORK      CLOSEST FQE SIZE (LARGER THAN REQUEST)               48764003
*  13    RBASE2    SECOND BASE REGISTER                                 48768003
*  14    RWORK4    NEXT FQE (PRELOADED)                                 48772003
*  15    RLGSOFAR  LARGEST AVAILABLE FQE SIZE (LESS THAN REQUEST)       48776003
*                                                                       48780003
*********************************************************************** 48784003
         SPACE 2                                                 Y02714 48788003
         CNOP  2,8                 PLACE LOOPS ON DOUBLE WORD    Y02714 48792003
GFRECORE STM   RIN0,RIN15,GFRESAVE SAVE CALLERS REGS             Y02714 48796003
         TM    SPFLAGS,SQA+CSA     SALLOC LOCK NEEDED?           Y02751 48800003
         BZ    GFRECOR1            NO                            Y02751 48804003
         BAL   RCOMRET1,GTSALLOC   GET SALLOC LOCK               Y02751 48808003
         SPACE 2                                                        48812003
GFRECOR1 SLR   RLGSOFAR,RLGSOFAR   CLEAR LARGEST SIZE FOUND      Y02714 48816003
GFRECOR2 L     RDQE,SPDQEAD(0,RSPQE)  GET POINTER TO FIRST DQE   Y02714 48820003
         LTR   RDQE,RDQE           IS THERE A DQE                Y02714 48824003
         BZ    SKIPCLER            NO, STORAGE NOT AVAILABLE     Y02714 48828003
         L     SEGREG,CLHIBYTE     MASK TO CLEAR FQE HIGH BYTE   Y02714 48832003
         SLR   RWORK,RWORK         ZERO CLOSEST FQE ADDRESS      Y02714 48836003
         L     WORK,LGPOSNUM       SET CLOSEST FQE SIZE LARGE    Y02714 48840003
GDQESRCH L     RFQE,DQFQEPTR(0,RDQE)  GET POINTER TO FIRST FQE   Y02714 48844003
         L     RIN0,DQEPTR(0,RDQE) PRELOAD NEXT DQE ADDRESS      Y02714 48848003
         LR    RPREVFQE,RDQE       MAKE DQE PREVIOUS FQE         Y02714 48852003
         NR    RFQE,SEGREG         IS THERE AN FQE               Y02714 48856003
         BZ    NXTDQE              NO, CHECK NEXT DQE            Y02714 48860003
GFQESRCH L     RFQESIZE,FQELNTH(0,RFQE)  GET FQE SIZE            Y02714 48864003
         L     RWORK4,FQEPTR(0,RFQE)  PRELOAD NEXT FQE ADDRESS   Y02714 48868003
         TM    FQTYPE(RFQE),FQECPB FQE CROSS PAGE BOUNDARY?      Y02714 48872003
         BO    NXTFQE              YES, GET NEXT FQE             Y02714 48876003
         CLR   RLENGTH,RFQESIZE    IS FQE LARGE ENOUGH           Y02714 48880003
         BH    GREATEST            NO, CHECK FOR LARGEST SO FAR  Y02714 48884003
         BE    SAVEPREV            EQUAL, USE THIS FQE           Y02714 48888003
         CLR   WORK,RFQESIZE       YES, CLOSER THAN BEFORE?      Y02714 48892003
         BNH   NXTFQE              NO, TRY NEXT FQE              Y02714 48896003
         LR    RWORK3,RPREVFQE     SAVE PREVIOUS TO CLOSEST FQE  Y02714 48900003
         LR    RWORK,RFQE          SAVE CURRENT CLOSEST FQE      Y02714 48904003
         LR    WORK,RFQESIZE       SAVE NEW CLOSEST SIZE         Y02714 48908003
         SPACE 2                                                 Y02714 48912003
NXTFQE   LR    RPREVFQE,RFQE       MAKE CURRENT FQE PREVIOUS     Y02714 48916003
         LR    RFQE,RWORK4         GET NEXT FQE                  Y02714 48920003
         NR    RFQE,SEGREG         IS THERE ONE?                 Y02714 48924003
         BNZ   GFQESRCH            YES, CHECK IT                 Y02714 48928003
         SPACE 2                                                 Y02714 48932003
NXTDQE   LR    RPRVDQE,RDQE        MAKE CURRENT DQE PREVIOUS     Y02714 48936003
         LTR   RDQE,RIN0           GET NEXT DQE                  Y02714 48940003
         BNZ   GDQESRCH            IF ANY GO CHECK IT            Y02714 48944003
         SPACE 2                                                 Y02714 48948003
         LTR   RWORK,RWORK         WAS THERE A CLOSE FQE         Y02714 48952003
         BZ    CHCKLSW             NO, CHECK CLEARSW             Y02714 48956003
         LR    RPREVFQE,RWORK3     GET PREVIOUS CLOSEST FQE      Y02714 48960003
         LR    RFQE,RWORK          GET CLOSEST FQE               Y02714 48964003
SAVEPREV STM   RPREVFQE,RFQE,CLOPREV  SAVE PREVIOUS AND CLOSEST FQE     48968003
         ST    RLGSOFAR,LARGESTA   SAVE LARGEST AVAILABLE SIZE   Y02714 48972003
         TM    SPFLAGS,LSQA+SQA    SQA OR LSQA REQUEST?          Y02714 48976003
         BNZ   PGBOUND             YES, CHECK PAGE BOUNDARIES           48980003
GFREFND  L     RIN0,GFRESAVE       RESTORE                              48984003
         LM    RIN3,RIN15,GFRESAVE+C12  CALLERS REGS             Y02714 48988003
         B     C4(RCOMRET1)        STORAGE FOUND - FQE, PREVFQE         48992003
         SPACE 2                                                 Y02714 48996003
GREATEST CR    RFQESIZE,RLGSOFAR   THIS FQE LARGEST SO FAR?      Y02714 49000003
         BNH   NXTFQE              NO, CHECK NEXT FQE            Y02714 49004003
         LR    RLGSOFAR,RFQESIZE   YES, SAVE NEW LARGEST SIZE    Y02714 49008003
         B     NXTFQE              GO CHECK NEXT FQE             Y02714 49012003
         SPACE 2                                                        49016003
CHCKLSW  TM    CLEARSW,CLEARON     CLEARSW ON?                          49020003
         BZ    SKIPCLER            NO - RETURN STORAGE NOT FOUND        49024003
         BAL   RCOMRET1,FQECLEAR   CLEAR CPB FLAG IN FQE'S              49028003
SKIPCLER ST    RLGSOFAR,LARGESTA   SAVE LARGEST AVAILABLE SIZE   Y02714 49032003
         LR    RPREVDQE,RPRVDQE    GET LAST DQE                  Y02714 49036003
         L     RIN0,GFRESAVE       RESTORE                              49040003
         LM    RAREG,RRETURN,GFRESAVE+C8  CALLERS REGS                  49044003
         BR    RCOMRET1            RETURN - NOT FOUND - PREVDQE         49048003
*                                  & LARGEST AVAILABLE                  49052003
         SPACE 2                                                 Y02714 49056003
*        END OF OPTIMIZED SECTION                                       49060003
         SPACE 5                                                        49064003
*                                                                       49068003
*        FQECLEAR - CLEARS FQECPB INDICATORS IN FQE (FQE CROSSES        49072003
*                   PAGE BOUNDARY)                                      49076003
*                                                                       49080003
FQECLEAR XI    CLEARSW,CLEARON     TURN OFF CLEARSW                     49230003
         L     RDQE,GFRESAVE+C28   GET SPQE ADDRESS              Y02714 49233003
FQECLR1  L     RDQE,DQEPTR(0,RDQE) GET FIRST/NEXT DQE            Y02714 49236003
         LTR   RDQE,RDQE           IS THERE ONE                  Y02714 49239003
         BZR   RCOMRET1            NO, RETURN                    Y02714 49242003
         L     RFQE,DQFQEPTR(RDQE) PICK UP 1ST FQE POINTER              49245003
FQECLR2  LTR   RFQE,RFQE           IS THERE AN FQE               Y02714 49248003
         BZ    FQECLR1             NO, GET NEXT DQE              Y02714 49251003
         NI    FQTYPE(RFQE),ALL-FQECPB  TURN OFF CPB FLAG        Y02714 49254003
         L     RFQE,FQTYPE(RFQE)   GET NEXT FQE POINTER                 49257003
         B     FQECLR2             CHECK THIS FQE                Y02714 49260003
*                                                                       49262003
*        AREA DESCRIBED BY FQE CROSSED A PAGE BOUNDARY                  49262603
*                                                                       49263203
*        SINCE A REQUEST FOR SP 253 OR 254 WILL HAVE HAD ITS            49263440
*        LENGTH INCREMENTED BY 8 TO ACCOMODATE THE AQE, SPECIAL         49263640
*        PROCESSING MUST BE PERFORMED FOR REQUESTS OF EXACTLY           49263840
*        4096 BYTES FROM THOSE SUBPOOLS SO THAT SUCH REQUESTS           49264040
*        WILL NOT BE ALLOCATED ACROSS A PAGE BOUNDARY                   49264240
*                                                                       49264440
PGBOUND  TM    SPFLAGS,REQ4K       SP=253/254 AND LENGTH=4K?   @ZA11822 49264640
         BNO   LENGTHOK            NO                          @ZA11822 49264840
         SH    RLENGTH,H8          GET REQUESTED LENGTH        @ZA11822 49265840
LENGTHOK LA    RWORK,FQESLNTH(RFQE)  GET END ADDRESS           @ZA11822 49266340
         ST    RWORK,ENDADD         & SAVE IT                           49267540
         LR    RWORK3,RWORK        SAVE END ADDRESS                     49268003
         SR    RWORK,RLENGTH       GET START ADDRESS                    49270003
         ST    RWORK,STRTADD        & SAVE IT                           49272003
         N     RWORK,BND4K         ROUND START DOWN TO 4K BOUND         49274003
         ST    RWORK,RSTRTADD       & SAVE IT                           49280003
*                                                                       49281040
*        THE FOLLOWING INSTRUCTION WILL DECREMENT THE END ADDRESS BY    49281540
*        ONE BEFORE ROUNDING IT TO THE NEXT LOWER PAGE BOUNDARY, IN     49282040
*        CASE IT HAPPENS TO FALL ON A PAGE BOUNDARY.                    49282540
*                                                                       49283040
         BCTR  RWORK3,0            DECREMENT END ADDRESS BY 1    Y02714 49284003
         N     RWORK3,BND4K        ROUND END DOWN TO 4K BOUND           49285003
         ST    RWORK3,RENDADD       & SAVE IT                           49286003
         C     RLENGTH,PAGE        LENGTH > PAGE                        49290003
         BH    PGBND1              YES                                  49291003
         TM    SPFLAGS,REQ4K       SP=253/254 AND LENGTH=4K?   @ZA11822 49291240
         BNO   NOAQEADD            NO                          @ZA11822 49291440
         LA    RLENGTH,C8(RLENGTH) GET LENGTH PLUS AQE SIZE    @ZA11822 49291640
*                                                                       49291840
*        WILL THE ALLOCATED AREA START ON THE SAME PAGE AS THE          49291940
*        FREE AREA ENDS ON ?  IF NOT, THE FREE AREA IN THE HIGH         49292040
*        ADDRESSED PAGE (OLDFQELN) CANNOT BE BIG ENOUGH TO              49292140
*        SATISFY THE REQUEST.                                           49292240
*                                                                       49292340
NOAQEADD CR    RWORK,RWORK3        ROUNDED ADDRS EQ(SAME PAGE) @ZA11822 49292440
         BNE   PGBND2              NO                                   49293003
         C     RLENGTH,FQELNTH(RFQE)  REQUEST EQUAL FQE SIZE     Y02714 49294003
         BE    CHCKCL1             YES - CHECK CLEARSW                  49295003
         L     RWORK,STRTADD       GET START ADDRESS                    49296003
         N     RWORK,PGBNDMSK      START ADDRESS ON 4K BOUNDARY?        49297003
         BZ    LRA1                YES - LRA ON START-4K                49300003
CHCKCL1  TM    CLEARSW,CLEARON     CLEARSW ON                           49305003
         BZ    GFREFND             NO - RETURN - STORAGE FOUND          49310003
         BAL   RCOMRET1,FQECLEAR   CLEAR CPB FLAG IN FQE'S              49315003
         LM    RPREVFQE,RFQE,CLOPREV  GET CLOSEST AND PREVIOUS FQE      49320003
         B     GFREFND             RETURN - STORAGE FOUND               49325003
         SPACE 2                                                 Y02714 49330003
*                                                                       49330540
*        THE ALLOCATED AREA WILL START ON A 4K BOUNDARY, BUT THE        49331040
*        FQE ALSO DESCRIBES SPACE BELOW THE BOUNDARY.  IF THE FQE       49331540
*        IS NOT AN EXACT FIT FOR THE REQUEST, A NEW FQE MUST BE         49332040
*        BUILT ON THE NEXT LOWER PAGE.  THEREFORE, A CHECK MUST BE      49332540
*        MADE TO ENSURE THAT THE NEXT LOWER PAGE IS BACKED BY REAL      49333040
*        STORAGE SO THAT THE FQE CAN BE BUILT THERE.                    49333540
*                                                                       49334040
LRA1     L     RWORK3,STRTADD      GET START ADDRESS                    49335003
         S     RWORK3,PAGE         SUBTRACT 4K                   Y02714 49340003
         BAL   WORK,PGINCORE       CHECK IF PAGE IS IN STORAGE          49345003
         B     CHCKCL1             YES, IT IS                           49350003
         B     GFRENO              FIXED PAGE NOT OBTAINED              49355003
         SPACE 2                                                        49360003
PGBND2   L     RWORK,ENDADD        GET END ADDRESS                      49365003
         S     RWORK,RENDADD       SUBTRACT ROUNDED END ADDRESS         49370003
         ST    RWORK,OLDFQELN      SAVE AS OLD LENGTH                   49375003
         L     RWORK3,FQELNTH(RFQE)  GET FQE LENGTH                     49380003
         SR    RWORK3,RWORK        SUBTRACT OLD LENGTH FROM FQE LENGTH  49385003
         ST    RWORK3,NEWFQELN      & SAVE AS NEW LENGTH                49390003
         CR    RLENGTH,RWORK3      NEW LENGTH LARGE ENOUGH       Y02714 49395003
         BH    OLDVSNEW            NO - COMPARE OLD TO NEW              49400003
         L     RWORK3,RSTRTADD     GET ROUNDED START ADDRESS            49405003
         BAL   WORK,PGINCORE       CHECK IF PAGE IS IN STORAGE          49420003
         B     IS4KREQ             YES IT IS                            49423003
         B     GFRENO              NO IT IS NOT                         49426003
IS4KREQ  C     RLENGTH,PAGE        4K REQUEST                           49429003
         BE    NEWVS4K             YES - SEE IF NEWLEN = 4K             49432003
         TM    SPFLAGS,REQ4K       SP=253/254 AND LENGTH=4K?   @ZA30210 49432340
         BO    NEWVS4K             YES - SEE IF NEWLEN = 4K    @ZA30210 49432640
*                                                                       49432940
*        THE REQUEST IS NOT FOR EXACTLY 4K.  BUILD AN FQE TO            49433240
*        DESCRIBE THE FREE SPACE ON THE LOWER PAGE AFTER UPDATING       49433540
*        THE LENGTH IN THE FQE ON THE HIGHER PAGE.  THEN CHAIN          49433840
*        THE LOWER FQE FROM THE HIGHER ONE.                             49434140
*                                                                       49434540
CREATNFQ MVC   FQELNTH(C4,RFQE),OLDFQELN  NEW LENGTH FOR OLD FQE        49435003
         L     RWORK,RENDADD       PICK UP ROUNDED END ADDRESS          49438003
         LA    RWORK2,FQESLNTH     GET FQE LENGTH                Y02714 49441003
         SR    RWORK,RWORK2        GET NEW FQE ADDRESS           Y02714 49444003
         MVC   FQEPTR(C4,RWORK),FQEPTR(RFQE) CHAIN IN            Y02714 49447003
         ST    RWORK,FQEPTR(RFQE)  NEW FQE                       Y02714 49450003
         LR    RPREVFQE,RFQE       MAKE CURRENT PREVIOUS FQE            49453003
         LR    RFQE,RWORK          MAKE NEW CURRENT FQE                 49456003
         MVC   FQELNTH(C4,RFQE),NEWFQELN  SET LENGTH                    49459003
         STM   RPREVFQE,RFQE,CLOPREV  NEW FQE IS NOW PROPER ONE         49470003
         B     CHCKCL1             CHECK CLEARSW                        49471003
         SPACE 2                                                 Y02714 49472003
OLDVSNEW CR    RWORK,RWORK3        OLD > NEW LENGTH              Y02714 49473003
         BH    LENVSLRG            YES - COMPARE TO LARGEST AVAILABLE   49474003
         LR    RWORK,RWORK3        GET NEW FQE LENGTH            Y02714 49475003
LENVSLRG CR    RWORK,RLGSOFAR      LESS THAN LARGEST AVAILABLE?  Y02714 49480003
         BL    REPEAT              YES - REPEAT REQUEST                 49483003
         LR    RLGSOFAR,RWORK      GET LARGEST AVAILABLE         Y02714 49486003
REPEAT   OI    CLEARSW,CLEARON     TURN ON CLEARSW                      49489003
         OI    FQTYPE(RFQE),FQECPB SET CPB FLAG IN FQE           Y02714 49492003
         LM    RIN0,RWORK4,GFRESAVE  RESTORE REGS, KEEP RLGSOFAR Y02714 49495003
         B     GFRECOR2            TRY AGAIN                     Y02714 49498003
         SPACE 2                                                        49501003
NEWVS4K  CLC   NEWFQELN(C4),PAGE   NEW LENGTH = 4K?                     49504003
         BE    CREATNFQ            YES - CREATE NEW FQE                 49510003
*                                                                       49510140
*        THE LENGTH DESCRIBED BY THE NEW FQE IS NOT 4K.  AN FQE         49510240
*        MUST BE BUILT ON THE PAGE BELOW THE 4K PAGE THAT WILL BE       49510340
*        ALLOCATED.  THEREFORE, REAL STORAGE MUST BE OBTAINED FOR       49510440
*        THE PAGE CONTAINING THIS FQE.  IF REAL STORAGE CANNOT BE       49510540
*        ASSIGNED, THE FRAME PREVIOUSLY GOTTEN TO BACK THE NEXT         49510640
*        HIGHER PAGE MUST BE RELEASED.                                  49510740
*                                                                       49510840
         L     RWORK3,RSTRTADD     GET ROUNDED START ADDRESS            49511003
         S     RWORK3,PAGE         SUBTRACT 4K                          49512003
         BAL   WORK,PGINCORE       CHECK IF PAGE IS IN STORAGE          49513003
         B     CREATNFQ            YES IT IS                            49514003
         L     RIN0,RSTRTADD       GET BEGINNING ADDR TO RELEASE Y02714 49515003
         LR    RIN1,RIN0           GET ENDING ADDRESS            Y02714 49516003
         A     RIN1,PAGE            TO RELEASE                   Y02714 49520003
         B     NOTASIG1            GO RELEASE THE PAGE                  49521003
         SPACE 2                                                        49522003
PGBND1   L     RWORK,STRTADD       GET START ADDRESS                    49523003
         C     RLENGTH,FQELNTH(RFQE)  IS REQUEST EQUAL TO FQE SIZE?     49524003
         BE    PGBND1A             YES - DO NOT ALLOW FOR FQE           49525003
         LA    RWORK2,FQESLNTH     GET FQE LENGTH                Y02714 49526003
         SR    RWORK,RWORK2        SUBTRACT FQE LENGTH           Y02714 49527003
PGBND1A  N     RWORK,BND4K         ROUND DOWN TO 4K BOUNDARY            49528003
         L     RWORK3,RENDADD      GET ROUNDED END ADDRESS              49530003
         ST    RWORK3,FIXEND       SAVE IT                              49531003
         SR    RWORK3,RWORK        GET LENGTH                           49532003
         ST    RWORK3,DIFF         SAVE IN DIFFERENCE                   49533003
         XC    FIXSTART(C4),FIXSTART  CLEAR WORK AREA                   49534003
         L     RWORK3,RENDADD      GET END ADDRESS                      49535003
CHECKDIF OC    DIFF,DIFF           DIFFERENCE = 0?               Y02714 49540003
         BZ    GFREFND             YES - RETURN - STORAGE FOUND         49541003
         S     RWORK3,PAGE         SUBTRACT 4K FROM ROUNDED END ADDRESS 49542003
         BAL   WORK,PGINCORE       CHECK IF PAGE IS IN STORAGE          49543003
         B     DECFXST             YES IT IS                            49544003
         B     NOTASSIG            NO IT IS NOT                         49545003
         SPACE 2                                                        49550003
DECFXST  ST    RWORK3,FIXSTART     FIXSTART = RENDADD - 4K              49551003
         ST    RWORK3,RENDADD      FROM RENDADD                         49552003
         L     RWORK,DIFF          SUBTRACT 4K                          49553003
         S     RWORK,PAGE               FROM                            49554003
         ST    RWORK,DIFF                    DIFFERENCE                 49555003
         B     CHECKDIF            CHECK DIFFERENCE                     49556003
         SPACE 2                                                        49560003
NOTASSIG OC    FIXSTART,FIXSTART   FIXSTART = 0?                 Y02714 49562003
         BZ    GFRENO              YES - PAGE NOT OBTAINED              49564003
         LM    RIN0,RIN1,FIXSTART  GET ADDRESSES TO RELEASE      Y02714 49566003
NOTASIG1 BAL   RCOMRET1,TRNONPVT   INHIBIT GETMAINS              Y02714 49568003
         L     R2,PSAAOLD          CURRENT ASCB ADDRESS          Y02714 49570003
         LR    RWORK2,RPVT         SAVE PVT ADDRESS              Y02714 49572003
         USING PVT,RPVT                                          Y02714 49580003
         L     RIN15,PVTPRELV      GET ENTRY TO RELEASE PAGE     Y02714 49581003
         DROP  RPVT                                              Y02714 49582003
         BALR  RRETURN,RIN15       RELEASE PAGE                         49583003
         USING PVT,RWORK2                                        Y02714 49584003
         NI    PVTFLAG1,ALL-PVTBGMS  RESET GETMAIN INHIB. FLAG   Y02714 49585003
         DROP  RWORK2                                            Y02714 49586003
GFRENO   TM    CLEARSW,CLEARON     CLEARSW ON                           49587003
         BO    CALFQCLR            YES                                  49588003
CALGNOTC L     RIN15,LARGESTA      PICK UP LARGEST AVAILABLE            49589003
         B     GNOTSATC            PAGE NOT OBTAINED                    49591003
         SPACE 2                                                        49592003
CALFQCLR BAL   RCOMRET1,FQECLEAR   CLEAR CPB FLAG IN FQE'S              49593003
         B     CALGNOTC            PAGE NOT OBTAINED                    49594003
         EJECT                                                          49595003
**************************************************************** Y02753 49596003
*                                                                Y02753 49597003
*        ROUTINE TO DELETE A FUNCTIONAL RECOVERY ROUTINE (FRR)   Y02753 49598003
*                                                                Y02753 49599003
*        INPUT                                                   Y02753 49600003
*              RRETURN  - RETURN ADDRESS                         Y02753 49601003
*        OUTPUT                                                  Y02753 49602003
*              FRR DELETED                                       Y02753 49603003
*        WORK                                                    Y02753 49604003
*              RWORK, RWORK2                                     Y02753 49605003
*                                                                Y02753 49606003
**************************************************************** Y02753 49607003
         SPACE 2                                                 Y02753 49608003
FRRDELET SETFRR D,WRKREGS=(RWORK,RWORK2)  DELETE FRR             Y02753 49609003
         BR    RRETURN             RETURN                        Y02753 49610003
         EJECT                                                   Y02714 49611003
**************************************************************** Y02751 49612003
*                                                                Y02751 49613003
*        LOCKING INTERFACE ROUTINES - GTSALLOC & CLSALLOC        Y02751 49614003
*                                                                Y02751 49615003
*              INPUT                                             Y02751 49616003
*                   RCOMRET1 - RETURN ADDRESS                    Y02751 49617003
*              OUTPUT                                            Y02751 49618003
*                   SALLOC LOCK OBTAINED OR FREED AS REQUESTED   Y02751 49619003
*                                                                Y02751 49620003
**************************************************************** Y02751 49621003
         SPACE 2                                                 Y02751 49622003
GTSALLOC TM    LOCKFLAG,SALHELD+SALOBTND LOCK ALREADY HELD OR    Y02751 49623003
*                                  OBTAINED?                     Y02751 49624003
         BNZR  RCOMRET1            YES, RETURN                   Y02751 49625003
         STM   RCOMRET1,RRETURN,LOCKSAVE SAVE REGS 9-14          Y02751 49626003
SOBTAIN  SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VSM,    Y02751*49627003
               IEAVGM00(SRELEASE)) GET SALLOC LOCK               Y02751 49628003
         LTR   RCOMRET1,RBASE2     SAVE AND TEST RETURN CODE     Y02751 49629003
         LM    REGB,RRETURN,LOCKSAVE+C8 RESTORE REGISTERS 11-14  Y02751 49630003
         BZ    GTSALOK4            LOCK OBTAINED                 Y02751 49631003
         LA    REGA,C4             IS RETURN                     Y02751 49632003
         CR    RCOMRET1,REGA        CODE = 4?                    Y02751 49633003
         BE    GTSALOK3            YES, LOCK ALREADY HELD        Y02751 49634003
*                                                                Y02751 49635003
*        UNDEFINED RETURN CODE - GO RECORD ERROR & TERMINATE     Y02751 49636003
*                                                                Y02751 49637003
         LA    RIN0,GTSALFLD       INDICATE SALLOC OBTAIN        Y02751 49638003
*                                   RETURN CODE NOT 0 OR 4       Y02751 49639003
         L     RBASE1,BASE101      SET BASE FOR CSECT01        @Y30APYF 49639303
         USING G4KSRCH,RBASE1                                  @Y30APYF 49639603
         B     STBRNDX             GO TERMINATE USER             Y02751 49640003
         USING BASE1,RBASE1        REG ALREADY SET             @Y30APYF 49640503
         SPACE 2                                                 Y02751 49641003
GTSALOK3 OI    LOCKFLAG,SALHELD    INDICATE LOCK ALREADY HELD    Y02751 49642003
         B     GTSALOK5            GO RESTORE REGISTERS          Y02751 49643003
         SPACE 2                                                 Y02751 49644003
GTSALOK4 OI    LOCKFLAG,SALOBTND   INDICATE LOCK OBTAINED        Y02751 49645003
         L     REGA,FRRPARM        POINT TO FRR PARAMETER AREA   Y02753 49646003
         OI    PARMFLG1(REGA),PARMSALO  INDICATE LOCK OBTAINED   Y02753 49647003
GTSALOK5 LM    RCOMRET1,REGA,LOCKSAVE RESTORE REGS 9-10          Y02751 49648003
         BR    RCOMRET1            RETURN, LOCK OBTAINED         Y02751 49649003
         SPACE 5                                                 Y02751 49650003
CLSALLOC TM    LOCKFLAG,SALOBTND   WAS LOCK OBTAINED?          @ZA03280 49651040
         BZR   RCOMRET1            NO, DON'T RELEASE IT          Y02751 49653003
         STM   RCOMRET1,RRETURN,LOCKSAVE SAVE REGS 9-14          Y02751 49654003
SRELEASE SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VSM,               Y02751*49655003
               IEAVGM00(SOBTAIN))  RELEASE SALLOC LOCK           Y02751 49656003
         LTR   RCOMRET1,RBASE2     SAVE AND TEST RETURN CODE     Y02751 49657003
         LM    REGA,RRETURN,LOCKSAVE+C4 RESTORE REGISTERS 10-14  Y02751 49658003
         BNZ   CLSALOK2            RETURN CODE NOT ZERO          Y02751 49659003
CLSALOK1 NI    LOCKFLAG,ALL-SALOBTND RESET LOCK OBTAINED FLAG    Y02751 49660003
         L     RCOMRET1,FRRPARM    POINT TO FRR PARAMETER AREA   Y02753 49661003
         NI    PARMFLG1(RCOMRET1),ALL-PARMSALO  RESET LOCK FLAG  Y02753 49662003
         L     RCOMRET1,LOCKSAVE   RESTORE RETURN REGISTER       Y02751 49663003
         BR    RCOMRET1            RETURN,LOCK RELEASED          Y02751 49664003
         SPACE 2                                                 Y02751 49665003
CLSALOK2 STM   RIN15,RIN1,LOCKSAVE+C4 SAVE REGISTERS 15-1        Y02753 49666003
         MVI   FRRBRNDX,CLSALFLD   SALLOC RELEASE R. C. > 4      Y02753 49667003
         ABEND X'C0D',DUMP,,SYSTEM GO TO FRR TO RECORD ERROR     Y02753 49668003
         LM    RIN15,RIN1,LOCKSAVE+C4 RESTORE REGISTERS 15-1     Y02753 49669003
         B     CLSALOK1            CONTINUE AS IF NO ERROR       Y02753 49670003
         EJECT                                                          50960003
**************************************************************** Y02714 50980003
*                                                                Y02714 51050003
*        POST PROCESSING ROUTINE TO FREE BLOCKS OF STORAGE       Y02714 51060003
*        QUEUED TO THE "FMAREAS" FIELD, AND TO CHECK FOR       @Z30ENWD 51060803
*        INTERNAL CELL EXPANSION REQUIREMENT. CALLS CLSALLOC   @Z30ENWD 51061803
*        TO FREE LOCK IF OBTAINED.                             @Z30ENWD 51062803
*              INPUT                                             Y02714 51064803
*                   RLDA     - LDA ADDRESS                       Y02714 51066403
*                   RBASE1   - BASE REGISTER                     Y02714 51066803
*                   RBASE2   - BASE REGISTER                     Y02714 51066903
*                   RRETURN  - RETURN ADDRESS                    Y02714 51067003
*              OUTPUT                                            Y02714 51067203
*                   ALL REGISTERS RESTORED                     @Z30ENWD 51067603
*              WORK                                              Y02714 51068003
*                   GMREPSAV USED TO SAVE REGISTERS              Y02714 51068403
*                                                                Y02714 51070403
**************************************************************** Y02714 51072603
         SPACE 2                                               @Y30APYF 51072703
FMPOSTP  STM   RIN0,RCOMRET1,GMREPSAV  SAVE REGISTERS 0 TO 9     Y02714 51072803
         SPACE                                                          51084503
FMPOST1  L     RIN1,FMAREAS        FIRST/NEXT AREA TO FREE       Y02714 51085403
         LTR   RIN1,RIN1           IS THERE ONE?                 Y02714 51088403
         BZ    FMPOST2             NO, GO CHECK FOR EXPANSION           51090203
         L     RWORK,C0(0,RIN1)    POINT TO NEXT AREA IF ANY     Y02714 51090803
         ST    RWORK,FMAREAS       RE-CHAIN REMAINING AREAS      Y02714 51091103
         L     RIN0,C4(0,RIN1)     SPID AND LENGTH               Y02714 51091403
         BAL   RCOMRET1,FMAINB     GO FREE CURRENT AREA          Y02714 51091503
         B     FMPOST1             GO CHECK FOR MORE             Y02714 51091603
         SPACE 2                                                 Y02714 51091803
FMPOST2  TM    CELLFLGS,LCLEXP+GLBLEXP NEED TO REFILL POOL?    @Z30ENWD 51092203
         BZ    FMPOST3             NO                          @Z30ENWD 51092403
         LR    RERROR,RRETURN       SAVE RETURN ADDRESS        @Z30ENYF 51092503
         BAL   RRETURN,GETMAINE    EXPANSION INTERNAL POOL     @Z30ENYF 51092603
         LR    RRETURN,RERROR                                           51092703
FMPOST3  BAL   RCOMRET1,CLSALLOC   CLEAR SALLOC IF OBTAINED    @Z30ENWD 51092803
         LM    RIN0,RCOMRET1,GMREPSAV  RESTORE REGISTERS 0 TO 9  Y02714 51093203
         BR    RRETURN                                           Y02714 51093603
         TITLE 'IEAVGM00   OS/VS2 GETMAIN / FREEMAIN SERVICE ROUTINE   *51093803
               CSECT-IEAVGM01'                                          51093903
*********************************************************************** 51094203
*                                                                       51095003
*        G4KSRCH - ENTERED ON A REGION REQUEST TO OBTAIN SOME MULTIPLE  51095603
*              OF 4K TO SATISFY A REQUEST                               51100003
*                                                                       51105003
*              INPUT                                                    51110003
*                   RPREVDQE - LAST DQE ON THE CHAIN                    51115003
*                   SIZEREG  - NUMBER OF BYTES REQUESTED (ROUNDED UP    51120002
*                              TO 4K)                                   51140002
*                   RSPID    - SPID                                     51160001
*                   RLENGTH  - ACTUAL LENGTH REQUIRED                   51170002
*                   RRETURN  - RETURN ADDRESS                           51172002
*              OUTPUT                                                   51180001
*                   RFQE     - ADDRESS ALLOCATED AREA                   51200002
*                   RIN15    - LARGEST AVAILABLE IF REQUEST NOT FILLED  51220002
*                                                                       51226003
*                   NOTE     - REGISTER 8 CONTAINS THE CSECT01 VALUE    51232003
*                                                                       51240001
*********************************************************************** 51250002
         SPACE 2                                                        51250303
IEAVGM00 CSECT                                                 @Y30APYF 51250603
G4KSRCH1 STM   RIN0,RIN15,G4KSAVE  SAVE REGS ON ENTRY          @Y30APYF 51250903
         L     RBASE1,BASE101      SET UP ADDRESSABILITY       @Y30APYF 51251203
         BR    RBASE1              GO TO G4KSRCH               @Y30APYF 51251503
         SPACE 2                                               @Y30APYF 51252003
IEAVGM01 CSECT                                                 @Y30APYF 51254003
         SPACE 2                                               @Y30APYF 51256003
         MODID BR=NO                                           @Y30APYF 51258003
         SPACE 2                                                 Y02714 51260002
         USING G4KSRCH,RBASE1                                  @Y30APYF 51270003
         USING PGTPTE,RPTE                                       Y02714 51300002
         USING XPTE,REPTE                                        Y02714 51320002
G4KSRCH  TM    SPFLAGS,CSA         CSA SUBPOOL?                @Y30APYF 51330003
         BZ    G4KSRA              NO, NECESSARY LOCKS HELD      Y02751 51332002
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 51333003
         USING BASE1,RBASE1                                    @Y30APYF 51333503
         BAL   RCOMRET1,GTSALLOC   YES, GET SALLOC LOCK          Y02751 51334002
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 51337003
         USING G4KSRCH,RBASE1                                  @Y30APYF 51338003
G4KSRA   BAL   RRETURN,FBQSRCH     GET STORAGE                   Y02714 51340002
         B     SQORLSQ             BR IF SATISFIED               Y02714 51360003
*                                                                       51360103
*        THE REQUEST WAS NOT SATISFIED                                  51361003
*                                                                       51362003
         TM    SPFLAGS,SQA+LSQA    SQA OR LSQA REQUEST?          Y02714 51363003
         BNZ   G4KSRB              YES, GFRECORE ALREADY CALLED  Y02714 51364003
         TM    CODE1,BOUND         PAGE BOUNDARY?                       51366003
         BO    G4KSR1              YES                                  51367003
         C     RLENGTH,MAXFQESZ    WAS GFRECORE ENTERED?         Y02714 51368003
         BH    G4KSR2              NO                                   51370003
G4KSRB   C     RIN15,LARGESTA      IS LARGEST AVAILABLE LARGER   Y02714 51371003
*                                  THAN THAT JUST RETURNED?             51372003
         BNL   G4KSR1              NO                                   51373003
         L     RIN15,LARGESTA      GET LARGEST AVAILABLE                51374003
G4KSR1   LM    RIN0,RRETURN,G4KSAVE  RESTORE REGS                       51375003
         B     C4(RRETURN)         NOT FOUND                     Y02714 51380002
*                                                                       51390003
*        IF A VARIABLE REQUEST, GET MAXIMUM AVAILABLE                   51391003
*                                                                       51392003
G4KSR2   TM    CODE1,VARBLE        VARIABLE REQUEST?             Y02714 51394002
         BNO   G4KSR1              NO, NO NEED TO CHECK FOR LARGEST     51396002
*                                  AVAILABLE IN FQE                     51398402
         C     RIN15,MAXFQESZ      IS LARGEST AVAILABLE GREATER  Y02714 51398802
*                                  THAN MAXIMUM FQE SIZE?               51399202
         BH    G4KSR1              YES, NO NEED FOR FURTHER CHECK       51399601
         ST    RIN15,LARGEST       SAVE LARGEST 4K AVAILABLE            51399701
         L     RLENGTH,MAXFQESZ    GET MAX VALUE FOR FQE SEARCH  Y02714 51399802
         BAL   RCOMRET1,GFRECORE   GET LARGEST AVAILABLE IN FQE         51399903
         USING G4KULAB,RCOMRET1                                @Y30APYF 51403903
G4KULAB  B     G4KSR3              CORE NOT FOUND - GET LARGEST         51407903
         DROP  RCOMRET1                                                 51409903
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 51413103
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 51414103
         L     RIN15,FQELNTH(RFQE)  GET VALUE FROM FQE                  51417403
         B     G4KSR1              RETURN WITH LARGEST AVAILABLE        51418403
         SPACE 2                                                        51419403
G4KSR3   L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 51422403
         C     RIN15,LARGEST       IS THE LENGTH IN THE FQE GREATER     51425403
*                                  THAN THAT IN THE FBQE?      @Y30APYF 51428403
         BH    G4KSR1              YES, USE FQE LENGTH                  51431403
*                                  AS LARGEST AVAILABLE                 51437201
         L     RIN15,LARGEST       VALUE OF LARGEST FROM FBQE    Y02714 51447202
         B     G4KSR1              RETURN WITH LARGEST AVAILABLE        51449201
*                                                                       51449603
*        FBQSRCH FOUND ENOUGH FREE SPACE, GET IT INTO A DQE             51450103
*                                                                       51450603
SQORLSQ  TM    SPFLAGS,SQA+LSQA    SQA OR LSQA REQUEST?          Y02714 51451202
         BZ    CALLGMC             NO, GET A DQE               @Z30ENWD 51451603
         LA    RIN1,DUMYDQE        GET DUMMY DQE TO PREVENT      Y02714 51452002
         B     GETDQEP             RECURSION THROUGH GETMAINB    Y02714 51452402
         SPACE 2                                                        51452901
CALLGMC  ICM   RIN1,MASK1,LDACBSP  INDICATE CORRECT SUBPOOL    @Z30ENWD 51484303
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 51486303
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 51488303
         BAL   RRETURN,GETMAINC    GET DQE SPACE               @Z30ENWD 51490303
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 51492303
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 51494303
GETDQEP  L     RPREDQE,G4KSAVE+C4  GET PREVIOUS DQE POINTER      Y02714 51520002
         ST    RIN1,DQEPTR(RPREDQE)  CHAIN IN DQE                Y02714 51560002
         ST    SEGREG,DQEBLKAD(RIN1)  PUT ADDR IN DQE                   51580002
         ST    SIZEREG,DQELNTH(RIN1)  PUT LENGTH IN DQE                 51590002
         LR    RPREDQE,RIN1        SAVE DQE ADDRESS                     51592002
         TM    SPFLAGS,SQA         SQA REQUEST?                  Y02714 51592402
         BO    CRETFQE             YES, CREATE FQE               Y02714 51592802
         TM    SPFLAGS,CSA         CSA REQUEST?                  Y02714 51593802
         BO    SETUPCSA            YES, GO SET UP KEY FOR CSA    Y02714 51593902
         TM    SPFLAGS,SWA+AUK     SWA OR SP 229, 230?           Y02714 51594002
         BNZ   SETUPREG            YES, GO SET UP KEY FOR REGION Y02714 51596002
         TM    SPFLAGS,LSQA        LSQA REQUEST?                 Y02714 51598902
         BO    CRSEG               YES, CREATE SEGMENT IF NECESS.Y02714 51599002
         L     RWORK2,LDATCB       GET TCB ADDRESS               Y02714 51599202
         USING TCB,RWORK2                                        Y02714 51599602
         TM    TCBFLGS6,TCBRV      V=R                                  51600002
         BZ    SETUPREG            NO, GO SET UP KEY FOR REGION  Y02714 51640002
         MVI   FETCH,ZEROKEY       INIT KEY TO 0               @ZA08170 51650040
         CH    RSPID,H252          SUBPOOL 252                   Y02714 51660002
         LR    RIN15,SIZEREG       SAVE SIZE                            51680002
         BE    SKIPKEY             YES - TURN OFF FETCH PROTCT @ZA08170 51700040
         MVC   FETCH,LSPQEKEY      GET PROTECT KEY             @ZA10820 51730040
         DROP  RWORK2                                            Y02714 51762002
         OI    FETCH,FETCHON       SET FETCH PROTECT ON                 51770002
SKIPKEY  SR    RWORK2,RWORK2                                   @ZA08170 51770440
         IC    RWORK2,FETCH        PICK UP KEY & FETCH PROTECT FOR      51772002
         SRL   SIZEREG,C12         GET NO. 4K BLOCKS             Y02714 51773040
*                                  STORAGE BLOCKS                       51774002
SSKLOOP0 LR    RADSAV,SEGREG       GET ALLOCATED AREA                   51780001
SSKLOOP1 LRA   RIN1,C0(0,RADSAV)   IS FRAME BACKING ALLOC PAGE @ZA08170 51784040
         BNZ   MTERM028            NO                          @ZA08170 51788040
         CR    RADSAV,RIN1         IS PAGE MAPPED 1 TO 1       @ZA08170 51792040
         BNE   MTERM028            NO                          @ZA08170 51796040
         SSK   RWORK2,RADSAV       SET STORAGE KEY TO TASK'S PROTECT    51800040
         LA    RADSAV,C2K(RADSAV)   KEY IN ALL ALLOCATED 4K BLOCKS      51820002
         SSK   RWORK2,RADSAV                                            51832001
         LA    RADSAV,C2K(RADSAV)                                       51834001
         BCT   SIZEREG,SSKLOOP1                                         51840001
         CH    RSPID,H252          SUBPOOL 252                 @ZA08170 51843040
         BNE   SKIPCLR             NO, DONT CLEAR AREA         @ZA08170 51846040
         LR    RSPQE,RIN15         SET LENGTH TO BE CLEARED    @ZA08170 51847040
         LR    SIZEREG,SEGREG      GET ADDRESS TO BE CLEARED   @ZA08170 51852040
         SR    COMREG,COMREG       0 PADDING, 0 BYTES          @ZA08170 51855040
         MVCL  SIZEREG,RAREG       CLEAR AREA ASSIGNED         @ZA08170 51860040
SKIPCLR  LR    SIZEREG,RIN15       RESTORE SIZE                @ZA08170 51861040
         LR    RRETURN,SEGREG      START ADDRESS FOR SMF ROUTINE        51880002
         ST    SIZEREG,SAVESIZE    SAVE SIZE                            51900001
         ST    SEGREG,SAVESEG      SAVE ADDRESS                         51920001
CALLSMF1 L     RWORK,AGMSMF        SET UP BASE REG & ENTRY POINT Y02714 51940002
         BALR  RCOMRET1,RWORK      GO TO SMF INTERFACE ROUTINE          51950002
         L     SIZEREG,SAVESIZE    RESTORE SIZE                  Y02714 51960002
         L     SEGREG,SAVESEG      RESTORE ADDRESS                      51980001
         SR    SIZEREG,RLENGTH     IS THE AREA                          52000001
         LTR   SIZEREG,SIZEREG     THE EXACT SIZE                       52020002
         BZ    ALLOCFD             YES                                  52040001
         ICM   RIN1,MASK1,LDACBSP  INDICATE CORRECT SUBPOOL      Y02714 52070002
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52078003
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52086003
         BAL   RRETURN,GETMAINC    GET STORAGE FOR FQE         @Z30ENWD 52094003
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52102003
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52110003
         ST    RIN1,FQEPTR(RPREDQE)  CHAIN IN FQE                       52140002
         ST    SIZEREG,FQELNTH(RIN1) PUT LENGTH IN FQE                  52160002
         MVI   FQTYPE(RIN1),REGION INDICATE REGION FQE           Y02714 52170002
         TM    CODE1,BOUND         PAGE BOUNDARY?                       52172001
         BZ    HIADDR              NO                                   52174001
         LR    SIZEREG,SEGREG      GET START ADDRESS                    52176002
         A     SIZEREG,SAVESIZE    GET HIGH BOUND                       52178001
         ST    SIZEREG,FQAREA(RIN1)  HIGH BOUND OF FREE  AREA           52178401
         B     ALLOCFD             RETURN - STORAGE FOUND               52178802
         SPACE 2                                                        52179201
HIADDR   AR    SEGREG,SIZEREG      HIGH ADD OF FREE SPACE               52180001
         ST    SEGREG,FQAREA(RIN1) STORE HI ADDR IN FQE                 52200002
ALLOCFD  LR    RFQE,SEGREG         SET ADDRESS OF ALLOCATED AREA        52260002
         LM    RIN0,RIN1,G4KSAVE   RESTORE REGISTERS                    52280002
         LM    COMREG,RIN15,G4KSAVE+C12                          Y02714 52290002
         BR    RRETURN             RETURN - STORAGE FOUND        Y02714 52300002
         SPACE 2                                                        52302002
MTERM028 LR    RADSAV,RBASE2       SAVE BASEREG ACROSS CALLRTM @ZA08170 52304040
         LA    RSAVAREA,REGSAVE    GET ADDRESS OF SAVEAREA     @ZA08170 52304240
         CALLRTM TYPE=MEMTERM,COMPCOD=X'028'  TERMINATE MEMORY @ZA08170 52304440
         SETLOCK RELEASE,TYPE=ALL,RELATED=('ANY GM00 OR USER LOCKS')    52304640
*                                  RELEASE  ALL LOCKS          @ZA08170 52304840
         LR    RBASE2,RADSAV       RESTORE BASE REG            @ZA08170 52305040
         BAL   RRETURN,FRRDELET    DELETE FRR                  @ZA08170 52305240
         L     RIN3,CVTPTR         GET CVT PTR                 @ZA08170 52305440
         USING CVT,RIN3                                        @ZA08170 52305640
         L     RIN15,PSALCCAV      GET LCCA PTR                @ZA08170 52306040
         USING LCCA,RIN15                                      @ZA08170 52306140
         TM    LCCADSF2,LCCASRBM   SRB MODE?                   @ZA08170 52306240
         BO    SRBEXIT             YES                         @ZA08170 52306340
         L     RIN15,CVT0DS        DISPATCHER ENTRY            @ZA08170 52306440
         BR    RIN15               EXIT TO DISPATCHER          @ZA08170 52306540
SRBEXIT  L     RIN15,CVTSRBRT      SRB EXIT                    @ZA08170 52306640
         BR    RIN15               GO TO SRB EXIT              @ZA08170 52306740
         DROP  RIN3                                            @ZA08170 52306840
         DROP  RIN15                                           @ZA08170 52306940
         SPACE 2                                                 Y02714 52310002
CRSEG    LR    RLENGTH,SIZEREG     GET AREA SIZE FOR FQE         Y02714 52310102
         TM    FLAGS,GETMB         GETMAINB REQUEST?             Y02714 52310402
         BZ    CRSEG1              NO                            Y02714 52310802
         LRA   RWORK2,C0(0,SEGREG) IS SEGMENT VALID              Y02714 52311202
         BC    11,CRETFQE0         YES, CREATE FQE               Y02714 52311602
         LR    RIN0,SEGREG         GET START OF AREA             Y02714 52311702
         BAL   WORK,CRSEGA         GO TO CREATE SEGMENT          Y02714 52311802
         LR    RFQE,SEGREG         AREA ADDRESS                  Y02714 52311902
         LR    RWORK3,SEGREG       ALSO NEEDED FOR PGINCORE      Y02714 52312302
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52312403
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52312503
         USING CRSEG11,WORK                                    @Y30APYF 52312603
         BAL   WORK,PGINCORE       GET REAL PAGE FOR TABLES      Y02714 52312703
CRSEG11  B     CRSEG0              OBTAINED O. K.                Y02714 52313503
         DROP  WORK                                            @Y30APYF 52313703
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52313803
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52314503
         LR    RADDRM,RWORK3       FAILED, GET START OF AREA     Y02714 52315203
         B     CRETFQE2            RETURN STORAGE TO FBQE        Y02714 52315903
         SPACE 2                                                 Y02714 52316303
CRSEG0   L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52316803
         LR    SEGREG,RWORK3       RESTORE AREA ADDRESS          Y02714 52317303
         LA    RFQE,CPAGE-PGTABLEN(0,RFQE)  NEW RESERVED AREA    Y02714 52317803
         ST    RFQE,LDARSVPT       SAVE FOR LATER PAGE TABLE     Y02714 52318303
         LA    RWORK2,PGTABLEN     GET PAGE TABLE SIZE           Y02714 52319203
         SR    RLENGTH,RWORK2      REDUCE FQE SIZE BY THIS SIZE  Y02714 52319903
         B     CRETFQE1            CREATE FQE BELOW RSVD. AREA   Y02714 52320603
         SPACE 2                                                 Y02714 52321303
CRSEG1   LR    RAUB,SEGREG         AREA ADDRESS                  Y02714 52322303
         AR    RAUB,SIZEREG        AREA UPPER BOUND (AUB)        Y02714 52323303
         LR    WORK,RAUB           SET TEMP AUB (TAUB) = AUB     Y02714 52324902
         N     WORK,SEGBND         ROUND TAUB DOWN TO SEG. BOUND Y02714 52325302
         LR    RWORK3,WORK         SET TEMP ALB (TALB)           Y02714 52325502
         BCTR  RWORK3,0             = TAUB - 1                   Y02714 52326003
         CR    RWORK3,SEGREG       TALB > AREA LOWER BOUND (ALB) Y02714 52326103
         BNH   CRETFQE0            NO, SEGMENT CREATE NOT NEEDED Y02714 52327103
         SR    R2,R2               INIT SEGMENT COUNT (SC) TO 0  Y02714 52328103
         N     RWORK3,SEGBND       ROUND TALB DOWN TO SEG. BOUND Y02714 52328603
CRSEG3   LRA   RIN0,C0(0,RWORK3)   IS THIS SEGMENT VALID         Y02714 52329103
         BC    11,CRSEG5           YES, MUST BE BOTTOM SEGMENT   Y02714 52329603
         LA    R2,C1(0,R2)         NO, INCREMENT SC              Y02714 52330103
         CR    RWORK3,SEGREG       TALB > ALB                    Y02714 52331003
         BNH   CRSEG6              NO, BOTTOM SEGMENT REACHED    Y02714 52332303
         S     RWORK3,SEGMENT      DECREMENT TALB BY 1 SEGMENT   Y02714 52333003
         B     CRSEG3              CONTINUE CHECKING             Y02714 52333703
         SPACE 2                                                 Y02714 52333803
CRSEG5   LTR   R2,R2               SC > 0                        Y02714 52334803
         BZ    CRETFQE0            NO, NO INVALID SEGMENTS       Y02714 52335303
         A     RWORK3,SEGMENT      INCREMENT TALB BY 1 SEGMENT   Y02714 52336303
CRSEG6   LA    RIN15,PGTABLEN      LENGTH OF PAGE TABLES         Y02714 52336903
         MR    RRETURN,R2          LENGTH NEEDED FOR PAGE TABLES Y02714 52337503
         LR    RIN1,RAUB           GET SIZE AVAILABLE IN TOP     Y02714 52338103
         SR    RIN1,WORK            SEGMENT (AUB - TAUB)         Y02714 52338703
         ST    RWORK3,TEMPSAV1     SAVE TALB OVER PGINCORE       Y02714 52339303
         CR    RIN1,RIN15          SIZE AVAIL < SIZE NEEDED?     Y02714 52339903
         BL    CRSEG7              YES, USE RESERVED AREA        Y02714 52340503
         LR    RIN1,RAUB           USE TOP OF NEW AREA           Y02714 52341103
         SR    RIN1,RIN15           FOR PAGE TABLES              Y02714 52341703
         SR    RLENGTH,RIN15       REDUCE FQE SIZE               Y02714 52342303
         LR    RWORK3,RIN1         GET PAGE TABLE ADDRESS        Y02714 52342903
         N     RWORK3,BND4K        ROUND DOWN TO PAGE BOUNDARY   Y02714 52343503
         ST    SEGREG,TEMPSAV2     SAVE AREA ADDRESS             Y02714 52344103
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52344703
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52345303
         BAL   WORK,PGINCORE       GET REAL PAGE FOR TABLES      Y02714 52345903
         USING CRSEG66,WORK                                    @Y30APYF 52346503
CRSEG66  B     CRSEG6A             OBTAINED O. K.                Y02714 52347103
         DROP  WORK                                            @Y30APYF 52347703
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52348303
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52348903
         L     RADDRM,TEMPSAV2     FAILED, GET START OF AREA     Y02714 52350503
         B     CRETFQE2            RETURN STORAGE TO FBQE        Y02714 52352303
         SPACE 2                                                 Y02714 52354103
CRSEG6A  L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52355003
         L     RWORK3,TEMPSAV1     RESTORE TALB                  Y02714 52355903
         L     SEGREG,TEMPSAV2     RESTORE AREA ADDRESS          Y02714 52356903
         LR    RIN0,R2             SEGMENT COUNT                 Y02714 52359503
         SLL   RIN0,C8             POSITION TO BYTE 2            Y02714 52360403
         LR    RFQE,RIN1           SAVE TOP OF FQE               Y02714 52362203
         SRL   RWORK3,C16          GET SEGMENT INDEX FROM TALB   Y02714 52364003
         OR    RIN0,RWORK3         PUT IN BYTE 3                 Y02714 52365803
         BAL   WORK,CRSEGB         CREATE NECESSARY SEGMENTS     Y02714 52367603
         B     CRETFQE1            CREATE FQE BELOW PAGE TABLES  Y02714 52369403
         SPACE 2                                                 Y02714 52371203
CRSEG7   ST    WORK,TEMPSAV3       SAVE TAUB                     Y02714 52373003
         LR    RIN0,WORK           GET TAUB - 1 (AN ADDR IN      Y02714 52374003
         BCTR  RIN0,0               TOP SEGMENT)                 Y02714 52376603
         LR    RWORK3,RIN0         SAVE TAUB - 1 FOR PGINCORE    Y02714 52377503
         BAL   WORK,CRSEGA         GO CREATE TOP SEGMENT         Y02714 52380203
         LR    RIN1,SEGREG         SAVE AREA ADDRESS             Y02714 52381103
         ST    RAUB,TEMPSAV2       SAVE AUB                      Y02714 52382903
         N     RWORK3,BND4K        ROUND TAUB - 1 DOWN TO PAGE   Y02714 52384703
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52386503
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52386803
         BAL   WORK,PGINCORE       GET REAL PAGE FOR TABLES      Y02714 52387103
         USING CRSEG77,WORK                                    @Y30APYF 52387203
CRSEG77  B     CRSEG8              OBTAINED O. K.                Y02714 52387703
         DROP  WORK                                            @Y30APYF 52387903
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52388103
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52388303
         LR    RADDRM,RIN1         FAILED, GET START OF AREA     Y02714 52390103
         B     CRETFQE2            RETURN STORAGE TO FBQE        Y02714 52391103
         SPACE 2                                                 Y02714 52393703
CRSEG8   L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52394103
         LR    SEGREG,RIN1         RESTORE AREA ADDRESS          Y02714 52394603
         L     RWORK3,TEMPSAV1     RESTORE TALB                  Y02714 52396403
         L     RAUB,TEMPSAV2       RESTORE AUB                   Y02714 52398203
         LA    RIN0,PGTABLEN       LENGTH OF PAGE TABLES         Y02714 52400003
         SR    RAUB,RIN0           NEW RESERVED AREA             Y02714 52402003
         ST    RAUB,LDARSVPT       SAVE FOR LATER PAGE TABLES    Y02714 52404003
         SR    RLENGTH,RIN0        REDUCE FQE SIZE               Y02714 52405003
         BCTR  R2,0                REDUCE SC BY 1                Y02714 52407003
         LTR   RIN0,R2             ANY SEGMENTS LEFT TO CREATE?  Y02714 52408003
         LR    RFQE,RAUB           TOP ADDRESS OF FQE            Y02714 52409003
         BNP   CRETFQE1            NO, CREATE FQE                Y02714 52411003
         LR    R2,RIN0             RESTORE SC                    Y02714 52413003
         L     WORK,TEMPSAV3       RESTORE TAUB                  Y02714 52415003
         S     WORK,SEGMENT        GO DOWN 1 SEGMENT             Y02714 52416003
         B     CRSEG6              GO PROCESS REST OF SEGMENTS   Y02714 52418003
         SPACE 5                                                 Y02714 52421003
*                                                                Y02714 52422003
*        SUBROUTINE TO INTERFACE WITH THE RSM CREATE SEGMENT     Y02714 52423003
*        ROUTINE                                                 Y02714 52425003
*                                                                Y02714 52427003
         SPACE 2                                                 Y02714 52428003
CRSEGA   SRL   RIN0,C16            GET SEGMENT INDEX             Y02714 52430003
         LA    RIN1,ONESEG         GET A ONE IN BYTE 2           Y02714 52432003
         OR    RIN0,RIN1           SET SEGMENT COUNT TO 1        Y02714 52433003
         L     RIN1,LDARSVPT       RESERVED AREA FOR PAGE TABLES Y02714 52435003
CRSEGB   L     RIN15,VCRSEG        "CREATE SEGMENT" ENTRY ADDRESSY02714 52438003
         LA    RSAVAREA,REGSAVE    POINT TO REG. SAVE AREA       Y02714 52439003
         BALR  RRETURN,RIN15       CREATE SEGMENT                Y02714 52440003
         L     RBASE2,G4KSAVE+C52  RESTORE BASE REGISTER         Y02714 52442003
         LTR   RRETCODE,RRETCODE   IS RETURN CODE ZERO           Y02714 52444003
         BZR   WORK                YES, RETURN                   Y02714 52445003
         LA    RIN0,CRSEGERR       INDICATE ERROR IN CREATE SEG. Y02753 52447003
STBRNDX  STC   RIN0,FRRBRNDX       STORE FOR FRR                 Y02753 52449003
         ABEND X'C0D',DUMP,,SYSTEM RECORD ERROR, TERMINATE USER  Y02753 52450003
*                                                                       52452003
*        REQUEST WAS SQA, CHAIN IN AN FQE AND GET A PAGE TO BACK UP     52453003
*        THE PAGE JUST GOTTEN FROM THE FBQE                             52454003
*                                                                       52454503
CRETFQE  LR    RLENGTH,SIZEREG     GET AREA SIZE FOR FQE         Y02714 52455003
CRETFQE0 LR    RFQE,SEGREG         AREA ADDRESS                  Y02714 52456003
         AR    RFQE,SIZEREG        TOP OF AREA + 1               Y02714 52457003
CRETFQE1 LA    RWORK2,FQESLNTH     GET FQE LENGTH                Y02714 52459003
         SR    RFQE,RWORK2         START OF FQE                  Y02714 52461003
         ST    RFQE,FQEPTR(0,RPREDQE) CHAIN IN FQE               Y02714 52462003
         LR    RWORK3,RFQE         GET START OF FQE              Y02714 52464003
         N     RWORK3,BND4K        AND ROUND DOWN TO PG BOUNDARY Y02714 52466003
         LR    RADDR,SEGREG        SAVE AREA ADDRESS             Y02714 52467003
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52469003
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52469403
         BAL   WORK,PGINCORE       BRING PAGE INTO STORAGE       Y02714 52469803
         USING CRETFQ11,WORK                                   @Y30APYF 52470203
CRETFQ11 B     CRETFQE3            STORAGE WAS AVAILABLE       @Y30APYF 52470603
         DROP  WORK                                            @Y30APYF 52471003
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52471403
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52472003
*                                  STORAGE NOT AVAILABLE, MUST   Y02714 52473003
*                                  RESTORE STORAGE TO PQE        Y02714 52474003
         LR    RADDRM,RADDR        GET START OF AREA             Y02714 52476003
CRETFQE2 L     RPQEM,SAVEPQE       GET PQE ADDR SAVED IN FBQSRCH Y02714 52478003
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52480003
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52482003
         BAL   RRETURN,MRELEASE    GO RETURN STORAGE TO PQE      Y02714 52484003
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52486003
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52488003
         MVI   OUTSW,REALOUT       INDICATE OUT OF REAL          Y02714 52490003
         L     RPREDQE,G4KSAVE+C4  GET PREVIOUS DQE POINTER      Y02714 52492003
         SR    RIN15,RIN15         SET LARGEST AVAIL = 0         Y02714 52494003
         ST    RIN15,DQEPTR(RPREDQE)  CLEAR NEXT DQE POINTER TO  Y02714 52496003
*                                  UNCHAIN DUMMY DQE             Y02714 52498003
         B     G4KSR1              RETURN, STORAGE NOT OBTAINED  Y02714 52500003
         SPACE 2                                                 Y02714 52502003
CRETFQE3 L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52503003
         SR    RWORK2,RWORK2       ZERO NEXT FQE PTR             Y02714 52504003
         ST    RWORK2,FQEPTR(0,RFQE)  AND REGION FLAG            Y02714 52506003
         ST    RLENGTH,FQELNTH(0,RFQE)  PUT SIZE IN FQE          Y02714 52508003
         LR    SEGREG,RADDR        RESTORE AREA ADDRESS          Y02714 52510003
         TM    SPFLAGS,LSQA        LSQA REQUEST?                 Y02714 52512003
         BZ    ALLOCFD             NO, GO FINISH                 Y02714 52514003
         LR    RRETURN,SEGREG      GET AREA ADDRESS FOR SMF      Y02714 52516003
         LR    RIN15,SIZEREG       GET SIZE FOR SMF              Y02714 52518003
         L     RWORK,AGMSMF        SET UP BASE REG & ENTRY POINT Y02714 52520003
         BALR  RCOMRET1,RWORK      GO TO SMF INTERFACE ROUTINE   Y02714 52522003
         LR    SEGREG,RRETURN      RESTORE AREA ADDRESS          Y02714 52524003
         B     ALLOCFD             GO FINISH UP                  Y02714 52526003
         SPACE 2                                                        52528003
SETUPCSA L     RIN15,VPFP2         GET FIND PAGE ENTRY THAT      Y02714 52540003
         ST    RIN15,VPFP           REQUIRES SALLOC LOCK         Y02714 52542003
         L     R2,PSAAOLD          GET CURRENT ASCB              Y02714 52544003
         USING ASCB,R2                                           Y02714 52546003
         L     R2,ASCBRSM          GET RSM HEADER ADDRESS        Y02714 52548003
         DROP  R2                                                Y02714 52550003
         L     RIN3,CVTPTR         GET CVT ADDRESS               YO2714 52552003
         USING CVT,RIN3                                          Y02714 52554003
         L     RIN3,CVTPVTP        GET PVT ADDRESS               Y02714 52556003
         DROP  RIN3                                              Y02714 52558003
         B     SETUPKEY            CONTINUE                      Y02714 52560003
*                                                                       52562003
*        CALL FIND PAGE TO PUT KEY INTO XPT                             52564003
*                                                                       52566003
SETUPREG L     RIN15,VPFP1         GET FIND PAGE ENTRY THAT      Y02714 52568003
         ST    RIN15,VPFP           REQUIRES LOCAL MEMORY LOCK   Y02714 52570003
SETUPKEY ST    SIZEREG,SAVESIZE    SAVE SIZE                     Y02714 52572003
         SRL   SIZEREG,C12         NUMBER OF 4K BLOCKS           Y02714 52580002
         SR    RWORK2,RWORK2       KEY 0, NO FETCH PROTECT              52580402
         ST    SEGREG,SAVESEG      SAVE ADDRESS                         52581402
         CH    RSPID,H252          SUBPOOL 252?                  Y02714 52582002
         BE    CALLPFP             YES, GO CALL FIND PAGE        Y02714 52590002
         MVC   FETCH,LSPQEKEY      GET PROTECT KEY               Y02714 52592002
         TM    SPFLAGS,FPROTECT    SHOULD FETCH PROTECT BE SET?  Y02714 52592402
         BZ    GETKEY              NO                            Y02714 52592802
         OI    FETCH,FETCHON       SET FETCH PROTECT ON                 52594001
GETKEY   IC    RWORK2,FETCH        GET PROTECT KEY               Y02714 52596002
CALLPFP  L     RIN15,VPFP          FIND PAGE                     Y02714 52696002
         LR    RIN1,SEGREG         START ADDRESS                 Y02714 52697002
         BALR  RRETURN,RIN15       GO TO FIND PAGE                      52706002
         LTR   RRETCODE,RRETCODE   IS RETURN CODE ZERO           Y02714 52716002
         BZ    SETUPPTE            YES, MARK PAGES ASSIGNED      Y02714 52726002
         LA    RIN0,C4             CONSTANT OF 4                 Y02714 52736002
         CR    RRETCODE,RIN0       IS RETURN CODE 4              Y02714 52738002
         BNE   PFPRC8              NO, ERROR                     Y02714 52738402
         LA    RIN1,PGTABLEN       YES, GET SPACE FOR PAGE TABLESY02714 52738802
         ICM   RIN1,MASK1,LDACBSP  GET LSQA SUBPOOL              Y02714 52739202
         LR    RIN0,RIN1           SAVE IN CASE OF FREEMAIN      Y02714 52739302
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 52739403
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 52739603
         BAL   RRETURN,GETMAINB    GO GET SPACE                  Y02714 52741803
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 52742503
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 52743203
         LRA   WORK,C0(0,SEGREG)   HAS SEGMENT BECOME VALID      Y02714 52743603
         BC    11,SEGVALID         YES, GO FREE SPACE            Y02714 52745603
         LR    RIN0,SEGREG         START ADDRESS                 Y02714 52748803
         SRL   RIN0,C16            SEGMENT INDEX                 Y02714 52751203
         LA    WORK,ONESEG         GET A 1 IN BYTE 2             Y02714 52751603
         OR    RIN0,WORK           SET SEGMENT COUNT TO 1        Y02714 52752603
         BAL   WORK,CRSEGB         GO CREATE SEGMENT             Y02714 52753603
         B     CALLPFP             GO GET PAGE TABLE ADDRESSES   Y02714 52756303
         SPACE 2                                                 Y02714 52757303
PFPRC8   L     RRETURN,SAVESEG     GET ADDRESS FOR SMF           Y02753 52760003
         L     RIN15,SAVESIZE      GET SIZE FOR SMF              Y02753 52761003
         L     RWORK,AGMSMF        SET UP BASE REG & ENTRY POINT Y02753 52762003
         BALR  RCOMRET1,RWORK      GO TO SMF INTERFACE ROUTINE   Y02753 52763003
*                                  TO GET TCT AND CURRGNTP       Y02753 52764003
*                                  UPDATED                       Y02753 52765003
         LA    RIN0,FNDPGERR       INDICATE FIND PAGE ERROR      Y02753 52766003
         B     STBRNDX             GO TERMINATE USER             Y02753 52767003
         SPACE 2                                                 Y02753 52768003
SETUPPTE LR    RPTE,RIN0           SET UP PTE REGISTER           Y02714 52769003
ADPAGE   A     SEGREG,PAGE         NEXT PAGE ADDRESS                    52770003
         OI    PGTBITS,PGTPAM      MARK PAGE ASSIGNED            Y02714 52771003
         STC   RWORK2,XPTPROT      PUT PROTECT KEY IN XPT               52780002
         NI    XPTFLAGS,ALL-XPTCKF TURN CHANGE KEY BIT OFF     @Z40EPYG 52786040
         BCT   SIZEREG,ENDSEG      PROCESS NEXT PAGE             Y02714 52800002
         L     RRETURN,SAVESEG     GET ADDRESS FOR SMF                  52820001
         L     RIN15,SAVESIZE      GET SIZE FOR SMF                     52840001
         B     CALLSMF1                                                 52860001
         SPACE 2                                                        52870001
ENDSEG   STH   SEGREG,SEGTEST      TEST FOR END                         52900002
         TM    SEGTEST,END          OF SEGMENT                          52920002
         BZ    CALLPFP             YES, CALL FIND PAGE           Y02714 52940002
         LA    REPTE,XPTLEN(REPTE) NO, GET NEXT XPTE             Y02714 53100002
         LA    RPTE,PGTLEN(RPTE)   NEXT PTE                      Y02714 53120002
         B     ADPAGE              RETURN TO MAINSTREAM          Y02714 53160002
         SPACE 2                                                 Y02714 53210002
SEGVALID LR    RRETURN,SEGREG      SAVE START ADDRESS            Y02714 53220002
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 53221003
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 53222003
         BAL   RCOMRET1,FMAINB     FREE PAGE TABLE SPACE         Y02714 53223003
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 53224003
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 53225003
         LR    SEGREG,RRETURN      RESTORE START ADDRESS         Y02714 53240002
         B     CALLPFP             TRY AGAIN                     Y02714 53250002
         SPACE 2                                                        53260001
         DROP  RPTE                                              Y02714 53560002
         DROP  REPTE                                                    53580001
         EJECT                                                          53600001
*********************************************************************** 53600803
*                                                                       53601603
*        THIS ROUTINE SEARCHES AN FBQE CHAIN FOR 4K MULTIPLES           53602403
*                                                                       53603203
*              INPUT                                                    53604003
*                   SIZEREG - LENGTH IN BYTES                           53604803
*                   RRETURN - RETURN ADDRESS                            53605603
*              OUTPUT                                                   53606403
*                   SEGREG  - ADDRESS OF AREA ASSIGNED                  53607203
*                   RIN15   - LARGEST AVAILABLE IF REQUEST NOT HONORED  53608003
*                   ALL REMAINING REGISTERS RESTORED                    53608803
*                                                                       53609203
*              NOTE  REGISTER 8 CONTAINS THE CSECT01 VALUE              53609603
*                                                                       53610003
*********************************************************************** 53613003
         SPACE 2                                                 Y02714 53616003
FBQSRCH  EQU   *                                                        53619003
         STM   RIN0,RIN15,FBQSAVE  SAVE REGISTERS                       53622003
         SR    RWORK2,RWORK2       SET LARGEST AVAILABLE         Y02714 53625003
         ST    RWORK2,LARSOFAR      TO ZERO                      Y02714 53628003
         LA    RAREG,C4            INITIALIZE TO BACKWARD POINTER       53631003
         TM    SPFLAGS,SQA+CSA     SQA OR CSA SUBPOOL?           Y02714 53634003
         BNZ   GETPQEC             YES, CHECK SPACE LEFT         Y02714 53640003
         TM    SPFLAGS,LSQA+SWA+AUK  LSQA, SWA OR AUTH U. K. SP? Y02714 53640903
         BNZ   GETPQEL             GET LSQA PQE                  Y02714 53641803
         SR    RAREG,RAREG         SET TO FORWARD POINTER, FBQE  Y02714 53642703
         L     RWORK2,LDATCB       GET TCB ADDRESS               Y02714 53643603
         USING TCB,RWORK2                                        Y02714 53644503
         L     RPQE,TCBPQE         GET DUMMY PQE POINTER         Y02714 53645403
         DROP  RWORK2                                            Y02714 53646303
GETPQE   LTR   RPQE,RPQE           IS THERE A PQE POINTER?       Y02714 53647203
         BZ    RETNOTFD            NO, RETURN, STORAGE NOT FOUND Y02714 53648103
         LA    RWORK3,DUMFBQE      ADDR OF MRELEASE DUMMY FBQE   Y02714 53649003
         L     RPQE,PQEFPQE(RPQE)  GET ADDRESS OF ACTUAL PQE            53649903
         ST    RPQE,SAVEPQE        SAVE PQE POINTER FOR G4KSRCH  Y02714 53650803
         L     RFBQE,C0(RAREG,RPQE)  GET PROPER FBQE                    53651703
ANYFBQE  CR    RFBQE,RPQE          ANY FBQES?                    Y02714 53652603
         BE    RETNOTFD            NO, RETURN, STORAGE NOT FOUND        53653503
         TM    SPFLAGS,SQA+CSA     SQA OR CSA SUBPOOL ?        @ZA27466 53654440
         BNZ   BESTCSA             YES, FIND BEST FITTING BLK  @ZA27466 53655040
         L     SEGREG,FBQAREA(0,RFBQE)  GET FBQE AREA ADDRESS  @ZA27466 53655640
         TM    SPFLAGS,LSQA+SWA+AUK  LSQA, SWA OR AUTH U. K. SP? Y02714 53657103
         BZ    FBQSPPSP            NO, PROBLEM PROGRAM SUBPOOL   Y02714 53658003
         C     SEGREG,CURRGNTP     FBQE START BELOW CURRGNTP?    Y02714 53658903
         BL    RETNOTFD            YES, STORAGE NOT AVAILABLE    Y02714 53660003
CKFBQESZ CLC   LARSOFAR,SIZE(RFBQE) LARGEST SO FAR?              Y02714 53660903
         BNL   CHLAST              NO                                   53661803
         CR    RWORK3,RFBQE        IS THIS DUMMY FBQE            Y02714 53662703
         BE    CHLAST              YES, CAN'T USE IT             Y02714 53663603
         TM    FLAGS,ERGNRCHD      IS V=V REGION IN THIS FBQE?   Y02714 53664503
         BZ    SETLARGS            NO, SET LARGEST SO FAR        Y02714 53665403
         SR    RSIZE,SEGREG        GET AVAILABLE SPACE IN FBQE   Y02714 53666303
         C     RSIZE,LARSOFAR      AVAILABLE SPACE > LARSOFAR    Y02714 53667203
         BNH   RETNOTFD            NO, STORAGE NOT AVAILABLE     Y02714 53668103
         ST    RSIZE,LARSOFAR      SET LARSOFAR TO AVAIL SPACE   Y02714 53669003
         CR    SIZEREG,RSIZE       REQUEST SIZE <= AVAIL SPACE   Y02714 53670003
         BH    RETNOTFD            NO, STORAGE NOT AVAILABLE     Y02714 53671003
         MVC   LARSOFAR,SIZE(RFBQE)  YES, SET TO FBQE AREA SIZE  Y02714 53672003
         B     USEFBQE             USE THIS FBQE                 Y02714 53673003
         SPACE 2                                                 Y02714 53674003
SETLARGS MVC   LARSOFAR,SIZE(RFBQE) SAVE LARGEST                 Y02714 53675003
         C     SIZEREG,LARSOFAR    LARGE ENOUGH?                        53676003
         BH    CHLAST              NO                                   53677003
USEFBQE  L     RLGSOFAR,LARSOFAR   GET BYTES LEFT OVER           Y02714 53678003
         SR    RLGSOFAR,SIZEREG    EXACT SIZE?                   Y02714 53679003
         BE    DEQUEUE             YES - DEQUEUE FBQE                   53680003
SAVXCESS ST    RLGSOFAR,SIZE(RFBQE)  REFLECT REMAINING CORE    @ZA27466 53681040
         AR    SEGREG,RLGSOFAR     GET ADDRESS OF AREA TO BE     Y02714 53682003
*                                  ASSIGNED IF HIGH                     53683003
         LTR   RAREG,RAREG         REQUEST OBTAINED HIGH?               53684003
         BNE   RETFOUND            YES                                  53685003
         SR    SEGREG,RLGSOFAR     DECREMENT ADDRESS IF LOW             53686003
         LR    RWORK2,SIZEREG      COPY REQUESTED SIZE         @ZA27466 53687040
         AR    RWORK2,SEGREG       CALC NEW FREE AREA ADDR     @ZA27466 53687540
         ST    RWORK2,FBQAREA(RFBQE) STORE IT INTO FBQE        @ZA27466 53688040
RETFOUND TM    SPFLAGS,CSA         CSA SUBPOOL?                  Y02714 53689003
         BZ    RETFND1             NO                            Y02714 53690003
         TM    SPFLAGS,SQA         SUBPOOL 227, 228, OR 239    @Y30APYF 53691003
         BO    RETFND1             YES, SKIP SRM                 Y02714 53692003
         LR    RWORK2,SEGREG       SAVE AREA ADDRESS             Y02714 53693003
         LNR   RIN0,SIZEREG        GET - REQUEST SIZE            Y02714 53694003
         STM   REGB,RIN1,LOCKSAVE  SAVE REGS AS IS DONE BY     @Y30APYF 53694203
*                                  CODE AT LABEL SRM           @Y30APYF 53694403
         L     REGB,ASRM           LOAD UP ITS BASE REG        @Y30APYF 53694603
         BALR  RCOMRET1,REGB       TELL SRM, CSA ALLOCATED     @Y30APYF 53695003
         LR    SEGREG,RWORK2       RESTORE AREA ADDRESS          Y02714 53745203
RETFND1  NI    FLAGS,ALL-VARPASS2-ERGNRCHD RESET FLAGS           Y02714 53825203
         LM    RIN0,RWORK2,FBQSAVE RESTORE                       Y02714 53905203
         LM    RLENGTH,RIN15,FBQSAVE+C40  REGS                   Y02714 53985203
         BR    RRETURN             RETURN - STORAGE FOUND               54065203
         SPACE 2                                                        54145203
CHLAST   L     RFBQE,C0(RAREG,RFBQE)  GET NEXT FBQE                     54225203
         B     ANYFBQE             CHECK FOR END OF CHAIN        Y02714 54305203
         SPACE 2                                                 Y02714 54385203
*                                                                       54387240
*        THIS ROUTINE PERFORMS A BEST FIT SEARCH OF FBQE'S IN  @ZA27466 54389240
*        ORDER TO SATISFY REQUESTS FOR CSA, OR SQA THAT HAS    @ZA27466 54391240
*        EXPANDED INTO CSA.  FOR REQUESTS OF 4K, FBQE'S ARE    @ZA27466 54393240
*        SEARCHED DOWN FROM HIGH CSA ADDRESSES.  FOR REQUESTS  @ZA27466 54395240
*        GREATER THAN 4K, FBQE'S ARE SEARCHED UP FROM LOW CSA  @ZA27466 54397240
*        ADDRESSES.                                            @ZA27466 54399240
*                                                                       54401240
         SPACE 1                                                        54401840
BESTCSA  L     REGA,LGPOSNUM       GET LARGEST POSITIVE NUMBER @ZA27466 54403240
AREAADDR L     SEGREG,FBQAREA(0,RFBQE)  GET FBQE AREA ADDRESS  @ZA27466 54405240
         CLC   LARSOFAR,SIZE(RFBQE) LARGEST AREA SO FAR ?      @ZA27466 54407240
         BNL   CHKSIZE             NO, DO NOT SAVE IT          @ZA27466 54409240
         MVC   LARSOFAR,SIZE(RFBQE) SAVE NEW LARGEST-SO-FAR    @ZA27466 54411240
CHKSIZE  C     SIZEREG,SIZE(RFBQE) BIG ENOUGH TO FILL REQUEST? @ZA27466 54413240
         BH    NEXTFBQE            NO, GET NEXT FBQE           @ZA27466 54415240
         CR    RWORK3,RFBQE        DUMMY FBQE                  @ZA27466 54417240
         BE    NEXTFBQE            YES, GET NEXT FBQE          @ZA27466 54419240
         L     RIN15,SIZE(RFBQE)   GET FREE AREA SIZE          @ZA27466 54421240
         SR    RIN15,SIZEREG       CALCULATE EXCESS FREE       @ZA27466 54423240
         BE    DEQUEUE             BR IF EXACT FIT             @ZA27466 54425240
         CR    RIN15,REGA          CLOSEST SO FAR ?            @ZA27466 54427240
         BNL   NEXTFBQE            NO, GET NEXT FBQE           @ZA27466 54429240
         LR    REGB,RFBQE          SAVE ADDR CLOSEST FBQE      @ZA27466 54431240
         LR    REGA,RIN15          SAVE CLOSEST EXCESS         @ZA27466 54433240
NEXTFBQE L     RFBQE,C0(RAREG,RFBQE) GET ADDR NEXT FBQE        @ZA27466 54435240
         CR    RFBQE,RPQE          ANY MORE FBQE'S ?           @ZA27466 54437240
         BNE   AREAADDR            YES, CHECK IT OUT           @ZA27466 54439240
         C     REGA,LGPOSNUM       ANY CLOSE FBQE FOUND ?      @ZA27466 54441240
         LR    RFBQE,REGB          GET FBQE ADDRESS            @ZA27466 54443240
         LR    RIN15,REGA          GET EXCESS FREE             @ZA27466 54445240
         L     SEGREG,FBQAREA(0,RFBQE) GET FREE AREA ADDRESS   @ZA27466 54447240
         BNE   SAVXCESS            BR, CLOSE FBQE FOUND        @ZA27466 54449240
         SPACE 2                                               @ZA27466 54451240
RETNOTFD L     RIN15,LARSOFAR      PICK UP LARGEST AVAILABLE            54465203
         NI    FLAGS,ALL-ERGNRCHD  RESET REGION FLAG             Y02714 54545203
         LM    RIN0,RRETURN,FBQSAVE  RESTORE REGS                       54625203
         B     C4(RRETURN)         STORAGE NOT FOUND                    54705203
         SPACE 2                                                        54785203
DEQUEUE  LM    REGA,REGB,FWDPTR(RFBQE)  ELIMINATE                       54865203
         ST    REGA,FWDPTR(REGB)             FBQE                       54945203
         ST    REGB,BCKPTR(REGA)                  FROM QUEUE            55025203
         LR    RIN1,RFBQE          GET ADDRESS TO FREE                  55345203
         LR    RRETURN,SEGREG      SAVE ADDRESS OF AREA          Y02714 55425203
         L     RBASE1,BASE100      BASE AS FOR CSECT00         @Y30APYF 55505203
         USING BASE1,RBASE1        TELL ASSEMBER               @Y30APYF 55585203
         BAL   RCOMRET1,FMAINC     FREEMAIN FBQE               @Z30ENWD 55665203
         L     RBASE1,BASE101      BASE AS FOR CSECT01         @Y30APYF 55745203
         USING G4KSRCH,RBASE1      TELL ASSEMBLER              @Y30APYF 55825203
         LR    SEGREG,RRETURN      RESTORE ADDRESS OF AREA              55905203
         B     RETFOUND                                                 55985203
         SPACE 2                                                 Y02714 56065203
GETPQEC  L     RCVT,CVTPTR         GET CVT ADDRESS               Y02714 56145203
         USING CVT,RCVT                                          Y02714 56225203
         L     RGDA,CVTGDA         GET GDA ADDRESS               Y02714 56305203
         DROP  RCVT                                              Y02714 56385203
         USING GDA,RGDA                                          Y02714 56465203
         TM    GDAFLAGS,SQATHRS2   HAS CRITICAL THRESH PASSED?   Y02714 56545203
         BZ    GETPQEC1            NO, GET PQE                   Y02714 56625203
         TM    SPFLAGS,SQA         SQA? (EXPANSION INTO CSA)     Y02714 56705203
         BO    GETPQEC1            YES, GET CSA PQE              Y02714 56785203
         L     RWORK2,SQASPLFT     GET SQA SPACE LEFT            Y02714 56865203
         C     RWORK2,PAGE         IS THERE ONLY 1 PAGE?         Y02714 56945203
         BNH   RETNOTFD            YES, SAVE IT FOR SQA          Y02714 57025203
GETPQEC1 LA    RPQE,CSAPQEP-C8     GET CSA DUMMY PQE POINTER     Y02714 57105203
         DROP  RGDA                                              Y02714 57185203
         C     SIZEREG,PAGE        TRYING TO FIND 1 PAGE ?     @ZA27466 57205240
         BE    GETPQE              YES, SEARCH FROM TOP OF CSA @ZA27466 57215240
         SR    RAREG,RAREG         NO, SEARCH FROM BOTTOM      @ZA27466 57225240
         B     GETPQE              CONTINUE                      Y02714 57265203
         SPACE 2                                                 Y02714 57345203
GETPQEL  LA    RPQE,ASDPQE-C8      GET A. S. DUMMY PQE POINTER   Y02714 57425203
         B     GETPQE              CONTINUE                      Y02714 57505203
         SPACE 2                                                 Y02714 57585203
FBQSPPSP L     RSIZE,LDALIMIT      GET INSTALLATION REGION LIMIT Y02714 57665203
         LTR   RSIZE,RSIZE         IS THERE ONE                  Y02714 57745203
         BNZ   FBQSPP2             YES, GO PROCESS IT            Y02714 57825203
         L     RSIZE,VVREGSZ       GET V=V REGION SIZE           Y02714 57905203
         LTR   RSIZE,RSIZE         IS ONE GIVEN?                 Y02714 57985203
         BZ    CKCRGNTP            NO                            Y02714 58065203
         TM    CODE1,VARBLE        VARIABLE REQUEST?             Y02714 58145203
         BNO   CKCRGNTP            NO                            Y02714 58225203
         TM    FLAGS,VARPASS2      IS THIS SECOND ATTEMPT?       Y02714 58305203
         BO    CKCRGNTP            YES, IGNORE REGION SIZE       Y02714 58385203
FBQSPP1  TM    FLAGS,ERGNRCHD      EXPLICIT REGION SIZE PASSED?  Y02714 58465203
         BO    RETNOTFD            YES, STORAGE NOT FOUND        Y02714 58545203
         A     RSIZE,PQEREGN(0,RPQE)  GET REGION TOP             Y02714 58625203
         LR    WORK,SEGREG         GET FBQE AREA ADDRESS         Y02714 58705203
         A     WORK,SIZE(0,RFBQE)  TOP OF FREE AREA              Y02714 58785203
         CR    RSIZE,WORK          IS REGION WITHIN FREE AREA?   Y02714 58865203
         BH    CKCRGNTP            NO                            Y02714 58945203
         OI    FLAGS,ERGNRCHD      YES, INDICATE THIS            Y02714 59025203
CKCRGNTP C     SEGREG,CURRGNTP     IS FBQE ABOVE CURRGNTP?       Y02714 59105203
         BH    RETNOTFD            YES, CANNOT CONTINUE          Y02714 59185203
         B     CKFBQESZ            TRY THIS FBQE                 Y02714 59265203
         SPACE 2                                                 Y02714 59345203
FBQSPP2  L     WORK,VVREGSZ        GET V=V REGION SIZE           Y02714 59425203
         LTR   WORK,WORK           IS ONE GIVEN                  Y02714 59505203
         BZ    FBQSPP1             NO                            Y02714 59585203
         TM    CODE1,VARBLE        VARIABLE REQUEST?             Y02714 59665203
         BNO   FBQSPP1             NO                            Y02714 59745203
         TM    FLAGS,VARPASS2      IS THIS SECOND ATTEMPT        Y02714 59825203
         BO    FBQSPP1             YES, IGNORE REGION SIZE       Y02714 59905203
         CR    WORK,RSIZE          IS V=V REGION < INST. LIMIT   Y02714 59985203
         BNL   FBQSPP1             NO, LEAVE AS IS               Y02714 60065203
         LR    RSIZE,WORK          YES, SET V=V REGION AS LIMIT  Y02714 60145203
         B     FBQSPP1             CONTINUE                      Y02714 60225203
         EJECT                                                          60305203
*********************************************************************** 60345203
*                                                                       60385203
*        CHECK TO SEE IF SUBPOOLS 227, 228, 239, 245, OR 255 PAGES ARE  60425203
*        IN STORAGE, AND IF NOT TRY TO BRING IT IN. KEY IS SET IF       60465203
*        PAGE IS NOT ALREADY IN STORAGE.                                60555203
*                                                                       60555303
*              INPUTS                                                   60566003
*                   RWORK3 - VIRTUAL ADDRESS OF PAGE TO BE CHECKED      60578003
*                   WORK   - RETURN ADDRESS                             60589103
*              OUTPUT                                                   60596303
*                   RETURN +0 IF PAGE IS IN STORAGE                     60598303
*                   RETURN +4 IF PAGE CANNOT BE BROUGHT INTO STORAGE    60601203
*                             (NO REAL STORAGE AVAILABLE)               60601603
*              WORK REGISTERS                                           60602103
*                   RIN0, RPVT, RWORK2, RCOMRET1, RRETURN, RWORK4,      60602603
*                   RIN15                                               60603103
*                                                                       60603603
*              NOTE REGISTER 8 CONTAIN THE CSECT00 VALUE                60634803
*                                                                       60644803
*********************************************************************** 60654803
         SPACE 2                                                        60664803
IEAVGM00 CSECT                                                 @Y30APYF 60665803
         SPACE 2                                                        60666803
PGINCORE L     R3,APGINCOR         GET ADDRESS OF PGINC01      @YM07648 60667003
         BR    R3                  GO TO PAGE IN CORE ROUTINE  @YM07648 60667103
         SPACE 2                                                        60667603
IEAVGM01 CSECT                                                 @YM07648 60668003
         SPACE 2                                                        60668403
         USING BASE1,RBASE1                                    @Y30APYF 60668503
         USING PGINC01,R3                                               60668603
PGINC01  LRA   RIN15,C0(RWORK3)    IS IT IN STORAGE              Y02714 60668703
         BZR   WORK                YES - RETURN                  Y02714 60668803
         LR    RWORK2,RPREVFQE     SAVE PREVIOUS FQE ADDRESS            60669603
         LR    RIN1,RWORK3         GET VA FOR SQA/LSQA ALLOCATION       60670003
         TM    SPFLAGS,LSQA        LSQA REQUEST?                 Y02714 60670603
         BO    PGINCOR2            YES                                  60670703
         L     RIN0,PAGE           GET PAGE SIZE                 Y02714 60670803
         LNR   RIN0,RIN0           INDICATE GETMAIN              Y02714 60673803
         DROP  R3                  DROP ADDRESSABILITY                  60675803
         STM   REGB,RIN1,LOCKSAVE  SAVE REGS AS IS DONE BY CODE@Y30APYF 60677303
*                                  AT LABEL SRM                @Y30APYF 60678003
         L     REGB,ASRM           LOAD UP ITS BASE REG        @Y30APYF 60678103
         BALR  RCOMRET1,REGB       TELL SRM, CSA ALLOCATED     @Y30APYF 60678203
PGINCOR1 BAL   RCOMRET1,TRNONPVT   INHIBIT GETMAINS              Y02714 60678303
         USING PVT,RPVT            REG WAS LOADED BY "TRNONPVT"  Y02714 60680403
         L     RIN15,PVTPSQA       GET ENTRY FOR OBTAIN L/SQA PG Y02714 60681403
         DROP  RPVT                                              Y02714 60698203
*                                                                       60729003
         BALR  RRETURN,RIN15       OBTAIN PAGE FROM RSM ROUTINE  Y02714 60759003
*                                                                       60799003
         USING PVT,RPVT                                          Y02714 60829003
         NI    PVTFLAG1,ALL-PVTBGMS  TURN OFF GETMAIN INHIBITED FLAG    60869003
         DROP  RPVT                                              Y02714 60899003
         USING PGINC01,R3                                      @YM07648 60939003
         BALR  R3,0                GET VALUE FOR BASE REG      @YM07648 60959003
         LA    RIN0,*-PGINC01      GET ABSOLUTE VALUE TO CORRECT BASE   60979003
         SR    R3,RIN0             CORRECT BASE AMOUNT         @YM07648 61009003
         LR    RPREVFQE,RWORK2     RESTORE PREVIOUS FQE ADDRESS         61039003
         LTR   RIN15,RIN15         PAGE OBTAINED                        61079003
         BZ    PGINCOR3            YES, PAGE IN STORAGE          Y02714 61109003
         B     C4(WORK)            RETURN - PAGE NOT IN STORAGE         61149003
         SPACE 2                                                 Y02751 61169003
PGINCOR2 BAL   RCOMRET1,GTSALLOC   GET SALLOC LOCK               Y02751 61189003
         B     PGINCOR1            GO OBTAIN PAGE                Y02751 61219003
*                                                                       61249003
*        KEY ZERO NO FETCH PROTECT HAS BEEN SET BY RSM. MOST REQUESTS   61289003
*        FOR CSA ARE FOR NON ZERO KEY STORAGE SO SET KEY FOR ALL CSA    61319003
*        REQUESTS. SQA AND LSQA ARE KEY ZERO NO FETCH PROTECT.          61359003
*                                                                       61389003
PGINCOR3 TM    SPFLAGS,CSA         SP OTHER THAN 245 OR 255    @Y30APYF 61429003
         BZR   WORK                NO, RETURN                    Y02714 61449003
         MVC   FETCH,LSPQEKEY      GET STGKEY                  @Y30APYF 61469003
         TM    SPFLAGS,FPROTECT    SHOULD F. P. BE SET         @Y30APYF 61499003
         BZ    NOFETCH             NO                          @Y30APYF 61529003
         OI    FETCH,FETCHON       SET F.P. ON                 @Y30APYF 61569003
NOFETCH  IC    RWORK2,FETCH        LOAD KEY                    @Y30APYF 61599003
         LRA   RWORK4,0(0,RWORK3)  GET REAL ADDRESS OF BLOCK     Y02714 61639003
         SSK   RWORK2,RWORK4       SET KEY ON FIRST 2K           Y02714 61659003
         LA    RWORK4,C2K(0,RWORK4)  POINT TO SECOND 2K          Y02714 61679003
         SSK   RWORK2,RWORK4       SET KEY ON REST OF PAGE       Y02714 61709003
         BR    WORK                RETURN                        Y02714 61739003
         SPACE 2                                                        61779003
         DROP R3                                               @YM07648 61809003
         EJECT                                                   Y02714 61849003
**************************************************************** Y02714 63360002
*                                                                Y02714 63370002
*        SYSTEM RESOURCES MANAGER (SRM) INTERFACE ROUTINE        Y02714 63371002
*                                                                Y02714 63470002
*              INPUT                                             Y02714 63520002
*                   RIN0 - SIZE OF SQA OR CSA REQUEST;           Y02714 63570002
*                          NEGATIVE IF GETMAIN, POSITIVE IF      Y02714 63620002
*                          FREEMAIN                              Y02714 63670002
*                   RCOMRET1 - RETURN ADDRESS                    Y02714 63720002
*              OUTPUT                                            Y02714 63770002
*                   SQA SPACE LEFT (SQASPLFT) UPDATED AND        Y02714 63820002
*                   SRM BRANCHED TO IF NECESSARY                 Y02714 63870002
*                                                                       63880003
*              NOTE REGISTER 8 CONTAINS EITHER CSECT00 OR        Y02714 63890003
*                   CSECT01 VALUE                                Y02714 63900003
*                                                                Y02714 63920002
**************************************************************** Y02714 64010002
         SPACE 2                                               @Y30APYF 64010603
IEAVGM00 CSECT                                                 @Y30APYF 64011303
         SPACE 2                                                 Y02714 64012002
SRM      STM   REGB,RIN1,LOCKSAVE  SAVE REGISTERS 11-1           Y02714 64020002
         L     REGB,ASRM           GET ENTRY AND BASE FOR SRM    Y02714 64021002
         BR    REGB                GO TO SRM (AT SRMSTART)       Y02714 64022002
         SPACE 2                                                 Y02714 64022502
IEAVGM01 CSECT                                                   Y02714 64023002
         SPACE 2                                                 Y02714 64026002
         USING SRMSTART,REGB                                     Y02714 64027002
SRMSTART L     RIN1,CVTPTR         GET CVT POINTER               Y02714 64070002
         USING CVT,RIN1                                          Y02714 64120002
         L     RIN1,CVTGDA         GET GDA POINTER               Y02714 64170002
         USING GDA,RIN1                                          Y02714 64220002
         L     RWORK4,SQASPLFT     GET SQA SPACE LEFT            Y02714 64270002
         AR    RWORK4,RIN0         ADD REQUEST SIZE              Y02714 64320002
*                                  (NEGATIVE IF GETMAIN)         Y02714 64370002
         ST    RWORK4,SQASPLFT     SAVE NEW VALUE                Y02714 64420002
         TM    GDAFLAGS,SQATHRS1+SQATHRS2 EITHER THRESHOLD       Y02714 64470002
*                                  PREVIOUSLY PASSED?            Y02714 64480002
         BM    SRM3                YES,THRESHOLD 1 PASSED        Y02714 64482002
         BO    SRM4                YES, BOTH THRESHOLDS PASSED   Y02714 64484002
         C     RWORK4,THR1PASD     NO, THRESHOLD PASSED NOW?     Y02714 64486002
         BH    SRMRSTRG            NO, RESTORE REGS AND RETURN   Y02714 64488002
         C     RWORK4,THR2PASD     YES, SECOND THRESHOLD PASSED? Y02714 64488402
         BNH   SRM1                YES                           Y02714 64488802
         OI    GDAFLAGS,SQATHRS1   SET THRESH 1 PASSED           Y02714 64489202
         LA    RIN1,C1             INDICATE FIRST THRESHOLD      Y02714 64489602
         B     SRM2                GO SET UP SRM INTERFACE       Y02714 64490902
         SPACE 2                                                 Y02714 64496502
SRM1     OI    GDAFLAGS,SQATHRS1+SQATHRS2 SET THRESH 1 & 2 PASSEDY02714 64497802
         LA    RIN1,C2             INDICATE SECOND THRESHOLD     Y02714 64499102
SRM2     LR    WORK,RBASE2         SAVE BASE                     Y02714 64503302
         LA    RSAVAREA,REGSAVE    POINT TO REGISTER SAVE AREA   Y02714 64503702
         SYSEVENT SQALOW,ENTRY=BRANCH  NOTIFY SRM                Y02714 64503802
         LR    RBASE2,WORK         RESTORE BASE REGISTER         Y02714 64503902
         B     SRMRSTRG            GO RESTORE REGS AND RETURN    Y02714 64504002
         SPACE 2                                                 Y02714 64504302
SRM3     C     RWORK4,THR1CLRD     THRESHOLD 1 CLEARED?          Y02714 64504902
         BH    SRM5                YES                           Y02714 64505802
         C     RWORK4,THR2PASD     THRESHOLD 2 PASSED?           Y02714 64506702
         BH    SRMRSTRG            NO, RESTORE REGS AND RETURN   Y02714 64507602
         B     SRM1                YES                           Y02714 64508202
         SPACE 2                                                 Y02714 64509502
SRM4     C     RWORK4,THR2CLRD     THRESHOLD 2 CLEARED?          Y02714 64510802
         BNH   SRMRSTRG            NO, RESTORE REGS AND RETURN   Y02714 64512102
         C     RWORK4,THR1CLRD     THRESHOLD 1 CLEARED?          Y02714 64513402
         BH    SRM5                YES                           Y02714 64514702
         NI    GDAFLAGS,ALL-SQATHRS2 RESET THRESH 2 FLAG         Y02714 64516002
         LA    RIN1,C2             INDICATE SECOND THRESHOLD     Y02714 64518002
         B     SRM6                GO SET UP SRM INTERFACE       Y02714 64518502
         SPACE 2                                                 Y02714 64519902
SRM5     NI    GDAFLAGS,ALL-SQATHRS1-SQATHRS2 RESET THRESH 1 & 2 Y02714 64521202
         LA    RIN1,C1             INDICATE FIRST THRESHOLD      Y02714 64521602
SRM6     LR    WORK,RBASE2         SAVE BASE                     Y02714 64523602
         LA    RSAVAREA,REGSAVE    POINT TO REG. SAVE AREA       Y02714 64523702
         SYSEVENT SQAOK,ENTRY=BRANCH  NOTIFY SRM                 Y02714 64526702
         LR    RBASE2,WORK         RESTORE BASE REGISTER         Y02714 64528702
         SPACE 2                                                 Y02714 64530002
SRMRSTRG LM    REGB,RIN1,LOCKSAVE  RESTORE REGS 11-1             Y02714 64533002
         BR    RCOMRET1            RETURN                        Y02714 64536002
         SPACE 2                                                 Y02714 64538002
         DROP  RIN1,REGB                                         Y02714 64538402
         EJECT                                                   Y02751 64538802
**************************************************************** Y02751 64538902
*                                                                Y02751 64542402
*        SYSTEM TERMINATION ROUTINE INTERFACE (TO PUT ENTIRE     Y02751 64542802
*        SYSTEM INTO A WAIT STATE)                               Y02751 64542902
*                                                                Y02751 64543003
*        NOTE REGISTER 8 CONTAINS EITHER CSECT00 OR              Y02751 64543103
*             CSECT01 VALUE                                      Y02751 64543203
*                                                                Y02751 64543602
**************************************************************** Y02751 64545002
         SPACE 2                                                 Y02751 64547002
         USING STERMV,REGB                                       Y02751 64547102
STERMV   LA    REGB,STERMR         MODIFY ADDRESSABILITY         Y02751 64547202
         USING STERMR,REGB                                       Y02751 64547402
         LA    RWORK,WSC101        OUT OF VIRTUAL, CODE 101      Y02751 64547502
         LA    RWORK2,STRVIRT      POINT TO "VIRTUAL" FOR MSG    Y02751 64547602
         B     STERM1              CONTINUE                      Y02751 64547702
         SPACE 2                                                 Y02751 64547802
STERMR   LA    RWORK,WSC102        OUT OF REAL, CODE 102         Y02751 64547902
         LA    RWORK2,STRREAL      POINT TO "REAL" FOR MSG       Y02751 64548102
STERM1   L     RCVT,CVTPTR         POINT TO CVT                  Y02751 64548602
         USING CVT,RCVT                                          Y02751 64548902
         L     RIN15,CVTRMS        POINT TO RMS VECTOR TABLE     Y02751 64550902
         DROP  RCVT                                              Y02751 64551602
         USING RVT,RIN15                                         Y02751 64552002
         L     RIN15,RVTPTERM      TERM. ROUTINE ENTRY ADDRESS   Y02751 64552402
         DROP  RIN15                                             Y02751 64553202
         XC    STRLRB(LRBSIZE),STRLRB  CLEAR LOGREC RECORD BUFFR Y02751 64553902
         ST    RWORK,LRBWSC        STORE WAIT STATE CODE         Y02751 64554302
         MVI   LRBRCTYP,X'81'      SYSTEM TERM. RECORD TYPE      Y02751 64554702
         MVI   LRBRCLEN+C3,LRBSIZE LRB LENGTH                    Y02751 64555102
         LA    RIN0,STRWTO         ADDRESS OF WTO MSG            Y02751 64555502
         LRA   RIN1,STRLRB         ADDRESS OF LRB                Y02751 64556202
         STM   RIN0,RIN1,STRPL     PUT IN PARAMETER LIST         Y02751 64556602
         LRA   RIN1,STRPL          ADDRESS OF PARM LIST          Y02751 64557002
         STNSM SEGTEST,B'00000000' NO TRANSLATION OR INTERRUPTS  Y02751 64557402
         MVC   STRVIRT(C7),0(RWORK2)  PLACE "VIRTUAL" OR "REAL"  Y02751 64557602
*                                  IN MESSAGE                    Y02751 64557702
         BALR  RRETURN,RIN15       GO TO SYSTEM TERMINATION      Y02751 64557802
*                                  ROUTINE (NO RETURN WILL BE    Y02751 64558102
*                                  MADE)                         Y02751 64558502
         SPACE 2                                                 Y02751 64558702
         DROP  REGB                                              Y02751 64558802
         TITLE 'IEAVGM00   OS/VS2 GETMAIN / FREEMAIN SERVICE ROUTINE   *64558903
               CSECT-IEASMFGF'                                          64559003
IEASMFGF CSECT                                                          64559202
         ENTRY GMSMFCRE                                                 64559502
         ENTRY FMSMFCRE                                                 64560002
*********************************************************************** 64563602
*                                                                       64567702
*              SMF CORE USED ROUTINES                                   64571802
*                                                                       64575902
*    CALLED WHEN 4K BLOCKS ARE OBTAINED OR FREED FROM SUBPOOLS OTHER    64580002
*                  THAN SQA OR CSA.                                     64600002
*                                                                       64610002
*********************************************************************** 64620002
*                                                                       64630002
*          INPUT  - INITIALIZED CORE USED FIELDS IN TCT.                64660002
*                   FIELDS ARE INITIALIZED BY SCHEDULER.                64670002
*                 - REG 14 (RBLKAD) BEGINNING ADDRESS OF BLOCK,         64700002
*                   ASSUMED TO BE A 4K BOUNDARY.                        64720002
*                 - REG 15 (RSIZE) SIZE OF BLOCK, ASSUMED TO BE A       64740002
*                   4K MULTIPLE                                         64760002
*          OUTPUT - MODIFIED CORE USED FIELDS IN TCT.                   64820001
*                                                                       64822003
*        NOTE REGISTER 8 CAN CONTAIN EITHER CSECT00 OR CSECT01          64824003
*             VALUE                                                     64826003
*                                                                       64830002
*********************************************************************** 64840002
*                                                                       64880001
*              GETMAIN ROUTINE                                          64900001
*                                                                       64920001
*        DETERMINE IF THERE IS A TCT ASSOCIATED WITH THIS REQUEST.      64940001
*        CONVERT CURRENT ALLOCATED SPACE INTO ALB AND AUB               64960002
*              (ALB - LOW ADDRESS OF ALLOCATED CORE)                    64980002
*              (AUB - HIGH ADDRESS PLUS 1 OF ALLOCATED CORE)            65000002
*        DETERMINE FROM WHICH END OF REGION CORE IS GIVEN.              65020001
*        UPDATE APPROPRIATE WATER MARK IF NECESSARY.                    65040001
*                                                                       65090002
*********************************************************************** 65100002
         SPACE 2                                                 Y02714 65120002
         MODID BR=NO                                             Y02714 65122002
         SPACE 2                                                 Y02714 65124002
         USING GMSMFCRE,RWORK                                           65140001
GMSMFCRE TM    SPFLAGS,SQA+CSA     SQA OR CSA REQUEST?           Y02714 65150002
         BNZR  RCOMRET1            RETURN TO CALLER              Y02714 65152002
         STM   RTCT,RCWRKA,GFSMFSVE  SAVE WORK REGISTERS                65160002
         LA    RCWRK,C0(RSIZE,RBLKAD)  DEVELOP AUB               Y02714 65194002
         L     RCWRKA,LDATCB       GET TCB ADDRESS               Y02714 65196002
         USING TCB,RCWRKA                                        Y02714 65198002
         TM    TCBTCTGF,TCBSMFGF   IS SMF RECORDING DISABLED?    Y02714 65198402
         BZ    CKLSQA              YES, SKIP SMF RECORDING       Y02714 65198802
         L     RTCT,TCBTCT         GET TCT POINTER                      65200002
         LA    RTCT,0(0,RTCT)      CLEAR HIGH ORDER FLAG BYTE    Y02714 65210002
         LTR   RTCT,RTCT           IS THERE A TCT?                      65240002
         BNP   CKLSQA              NO, SKIP SMF RECORDING        Y02714 65260002
         USING SMFTCT,RTCT                                              65270001
         L     RCORE,TCTCRTBL      INITIALIZE TCT CORE AREA PTR         65280002
         USING TCTCORE,RCORE                                            65310001
         TM    SPFLAGS,LSQA+SWA+AUK  HIGH END SUBPOOL?           Y02714 65312002
         BNZ   NOTBOT              YES                           Y02714 65314002
         C     RCWRK,TCTLWM        AUB > LWM?                    Y02714 65316002
         BNH   CKCURGN             NO                            Y02714 65318002
         ST    RCWRK,TCTLWM        STORE NEW LWM                 Y02714 65360002
CKCURGN  C     RCWRK,CURRGNTP      HAS CURRGNTP BEEN EXCEEDED?   Y02714 65370002
         BNH   RCEXITA             NO                            Y02714 65372002
         ST    RCWRK,CURRGNTP      YES, SAVE NEW VALUE           Y02714 65374002
         B     RCEXITA                                           Y02714 65540002
         SPACE 2                                                 Y02714 65590002
NOTBOT   C     RBLKAD,TCTHWM       IS STORAGE INSIDE HWM         Y02714 65720002
         BNL   RCEXITA             BRANCH IF YES                 Y02714 65740002
         ST    RBLKAD,TCTHWM       STORE NEW HWM                 Y02714 65750002
RCEXITA  LM    RTCT,RCWRKA,GFSMFSVE   RESTORE REGISTERS                 65912002
         BR    RCOMRET1            RETURN TO CALLER                     65914001
         SPACE 2                                                 Y02714 65914402
CKLSQA   TM    SPFLAGS,LSQA+SWA+AUK  HIGH END SUBPOOL?           Y02714 65914802
         BNZ   RCEXITA             YES, DON'T UPDATE CURRGNTP    Y02714 65915202
         B     CKCURGN             NO, CHECK CURRGNTP            Y02714 65915602
         SPACE 2                                                 Y02714 65915702
         DROP  RWORK                                                    65916001
         EJECT                                                   Y02714 65920002
*********************************************************************** 65930002
*                                                                       65960001
*              FREEMAIN ROUTINE                                         65980001
*                                                                       66000001
*        UPDATE CURRGNTP IF NECESSARY.                                  66060002
*                                                                       66070002
*********************************************************************** 66080002
         SPACE 2                                                        66100002
         USING FMSMFCRE,RDQE                                            66130001
FMSMFCRE STM   RTCT,RCWRKA,GFSMFSVE   SAVE WORK REGISTERS        Y02714 66140002
         LA    RCWRK,C0(RBLKAD,RSIZE)  DEVELOP AUB                      66270002
         C     RCWRK,CURRGNTP      AUB = CURRGNTP?               Y02714 66270402
         BNE   RCEXIT              NO, UPDATE NOT NEEDED         Y02714 66270802
         L     RCWRKA,LDATCB       GET TCB ADDRESS               Y02714 66272002
         L     REGA,TCBPQE         GET REGION DPQE               Y02714 66274002
         DROP  RCWRKA                                            Y02714 66276002
         L     REGA,PQEFPQE(REGA)  GET REGION PQE                Y02714 66278002
         C     REGA,LDASRPQE       IS THIS SYSTEM REGION PQE     Y02714 66278202
         BE    RCEXIT              YES, DON'T CHANGE CURRGNTP    Y02714 66278302
FMSMFMR  EQU   *                   MRELEASR ENTRY                Y02714 66278402
         LR    RCWRKA,REGA         CURRENT FBQE = REGION PQE     Y02714 66279202
FMCHKFBQ L     RCWRKA,FWDPTR(RCWRKA) GET FIRST/NEXT FBQE         Y02714 66280102
         CR    REGA,RCWRKA         IS THERE ONE?                 Y02714 66281002
         BE    RCEXIT              NO, FORGET IT                 Y02714 66281902
         L     RCWRK,FBQAREA(RCWRKA)  GET FLB                    Y02714 66282802
         A     RCWRK,SIZE(RCWRKA)  GET FUB                       Y02714 66283702
         CR    RCWRK,RBLKAD        IS FUB > ALB?                 Y02714 66284802
         BNH   FMCHKFBQ            NO, TRY NEXT FBQE             Y02714 66299902
         L     RCWRK,FBQAREA(RCWRKA)  GET FLB                    Y02714 66309902
         ST    RCWRK,CURRGNTP      STORE NEW CURRGNTP            Y02714 66319902
RCEXIT   LM    RTCT,RCWRKA,GFSMFSVE  RESTORE WORK REGISTERS      Y02714 66520002
         BR    RCOMRET1            RETURN                               66540002
         SPACE 2                                                 Y02714 66542002
         DROP  RCORE                                                    66550001
         DROP  RDQE                                                     66552001
         TITLE 'IEAVGM00   OS/VS2 GETMAIN / FREEMAIN SERVICE ROUTINE'   66560003
*********************************************************************** 67016702
*                                                                       67017001
*        REGISTER EQUATES                                               67019302
*                                                                       67021601
*********************************************************************** 67022002
         SPACE 2                                                 Y02714 67023602
RIN0     EQU   0                   INPUT PARAMETER REGISTER             67023902
RUB      EQU   0                   DQE & FQE UPPER BOUND REG            67026202
RIN1     EQU   1                   PARAMETER LIST POINTER               67028501
RPREVAQE EQU   1                   PREV AQE POINTER                     67030802
RPREVFQE EQU   1                   PREVIOUS FQE POINTER                 67033102
RPREVDQE EQU   1                   PREVIOUS DQE REG                     67035402
REPTE    EQU   1                   EXTERNAL PAGE TABLE ENTRY REG        67037702
RNEWDQE  EQU   1                   NEW DQE REG                          67060002
RANCHOR  EQU   2                   ANCHOR FOR CELLS            @Z30ENWD 67070003
RAREG    EQU   2                   LRA REGISTER                         67080001
RFQE     EQU   2                   FQE REG                              67120002
RAQE     EQU   2                   AQE POINTER                          67140002
RPREFBQE EQU   2                   PREV FBQE REG                        67170002
R2       EQU   2                   VALIDITY CK RTN NEEDS R2 = 0  Y02714 67174002
ROLDQ    EQU   3                   USED IN CELL FORMAT         @Z30ENWD 67175003
R3       EQU   3                   USED AS A BASE REG IN PGINCORE       67177002
COMREG   EQU   3                   COMPARISON FOR SVC NUMBER            67180001
RADSAV   EQU   3                   ADDRESS FOR SET STORAGE KEYS         67200002
RCVT     EQU   3                   CVT REG                              67220002
RFBQE    EQU   3                   FBQE ADDRESS                         67240002
RGDA     EQU   3                   GDA ADDRESS                   Y02714 67242002
RIN3     EQU   3                   CRBRANCH INPUT REGISTER       Y02714 67250002
RNEWFQE  EQU   3                   ADDRESS OF NEW FQE                   67260002
RDQE     EQU   3                   DQE REG                              67270002
RPVT     EQU   3                   PVT REG                              67272002
RTCB     EQU   4                   TCB ADDRESS                          67280001
RLDA     EQU   4                   LDA ADDRESS                   Y02714 67290002
REG5     EQU   5                   WORK REG                    @Z30ENWD 67292003
RCELLP   EQU   5                   CELL POINTER FOR FORMAT     @Z30ENWD 67301003
RCTR     EQU   5                   COUNTER TO UPDATE CELL COUNT@Z30ENWD 67310003
PARMREG  EQU   5                   INPUT PARAMETER SAVE REGISTER        67320002
RERROR   EQU   5                   ERROR CODE                           67340001
RPTE     EQU   5                   PAGE TABLE ENTRY REG          Y02714 67350002
RRB      EQU   5                   RB REG                               67380002
RWORK3   EQU   5                   WORK REGISTER                        67400002
RMIN     EQU   5                   FOR VAL CK OF SVC 4, V TYPE @ZA20641 67405040
RSTOP    EQU   6                   USED IN CELL FORMAT         @Z30ENWD 67410003
SVTYPE   EQU   6                   SVC, KEY, MODE, ENTRY TYPE           67440001
RTCB1    EQU   6                   TEMPORARY TCB REGISTER        Y02714 67470002
RWORK    EQU   6                   WORK REGISTER                        67480002
SIZEREG  EQU   6                   BYTES REQUIRED                       67500002
RFMRET   EQU   6                   LIST FREEMAIN RETURN REG             67540002
RSIZEM   EQU   6                   SIZE REG FOR MRELEASE                67580002
RMAX     EQU   6                   FOR VAL CK OF SVC 4, V TYPE @ZA20641 67580140
RNEXT    EQU   7                   USED IN CELL FORMAT         @Z30ENWD 67580740
RASCB    EQU   7                   ASCB ADDRESS                  Y02714 67581002
RAUB     EQU   7                   AREA UPPER BOUND REG                 67680002
RPQE     EQU   7                   PQE ADDRESS                          67700002
RPQEM    EQU   7                   PQE  REG FOR MRELEASE                67701002
RPRVDQE  EQU   7                   PREVIOUS DQE FOR GFRECORE     Y02714 67701202
RSPQE    EQU   7                   ADDRESS OF SPQE                      67702002
RWORK2   EQU   7                   WORK REGISTER                        67711002
SAVEPARM EQU   7                   PARAMETER LIST POINTER               67712002
RBASE1   EQU   8                   FIRST BASE REGISTER           Y02714 67740002
INDEX    EQU   9                   INDEX THROUGH LIST                   67780002
SEGREG   EQU   9                   ADDRESS OF ALLOCATED AREA            67800002
RCOMRET1 EQU   9                   RETURN REG                           67820001
RADDRM   EQU   9                   ADDRESS REG FOR MRELEASE             67840002
RLENGTH  EQU   10                  LENGTH/ADDRESS OF LENGTH LIST        67860001
REGA     EQU   10                  WORK REG                             67900002
RFBQNXT  EQU   10                  NEXT FBQE REG                        67902002
RTCT     EQU   10                  TCT POINTER                          67910002
RCORE    EQU   10                  CORE AREA POINTER                    67912002
RADDR    EQU   11                  ADDRESS OF ADDRESS LIST              67913002
RCWRK    EQU   11                  WORK REGISTER                        67914002
REGB     EQU   11                  WORK REGISTER                        67920002
RFQESIZE EQU   11                  CURRENT FQE SIZE FOR GFRECORE Y02714 67921002
RPREDQE  EQU   11                  PREVIOUS DQE                         67990002
RPRSDQE  EQU   11                  PREV DQE REG FOR SPFRMAIN            67991002
RBLOCK   EQU   12                  DUMMY FBQE FOR MRELEASE              67991202
RCWRKA   EQU   12                  WORK REGISTER                        67992002
RRBPRXLN EQU   12                  TEMP. USED TO GET RB PREFIX   Y02714 68002002
RSPID    EQU   12                  SPID                                 68020001
RVALRET  EQU   12                  RETURN FROM VALIDITY CHECK           68040001
WORK     EQU   12                  WORK REGISTER                        68080002
RBASE2   EQU   13                  SECOND BASE REGISTER          Y02714 68140002
RFLAGWD  EQU   13                  FLAGS, SVC #, KEY, & MODE     Y02714 68142002
RSAVAREA EQU   13                  STANDARD SAVE AREA REGISTER   Y02714 68144002
RBLKAD   EQU   14                  ADDRESS OF BLOCK FROM GET/FREE       68150002
RRETURN  EQU   14                  RETURN REGISTER                      68180002
RWORK4   EQU   14                  WORK REGISTER                 Y02714 68192002
RIN15    EQU   15                  BRANCH ENTRY ADDR                    68220001
RLGSOFAR EQU   15                  LARGEST AVAILABLE (FBQE OR FQE)      68221002
RRETCODE EQU   15                  RETURN CODE REGISTER          Y02714 68222002
RSIZE    EQU   15                  SIZE REG                             68240002
RVALBASE EQU   15                  BASE FOR VALIDITY CHECK       Y02714 68250002
TEMPBASE EQU   15                  TEMPORARY BASE FOR BRANCH ENTRIES    68270002
         EJECT                                                          68280001
*********************************************************************** 68290002
*                                                                       68300001
*        SYMBOL EQUATES                                                 68320002
*                                                                       68340001
*********************************************************************** 68342002
         SPACE 2                                                 Y02714 68350002
C0       EQU   0                   CONSTANT                             68360002
OFF      EQU   0                   USED TO TURN OFF GMFM SWITCH         68420002
ZEROKEY  EQU   X'00'               0 KEY NO FETCH PROTECT FOR V=V TASK  68440002
ERR1     EQU   1                   CONSTANT                    @Z30ENWD 68470003
C1       EQU   1                   CONSTANT                             68504002
TWO      EQU   2                   PAGE TABLE INDEX                     68600002
C2       EQU   2                   CONSTANT                             68620002
M2       EQU   X'02'               MASK TO GET SVC                      68650002
ERR3     EQU   3                   CONSTANT                    @Z30ENWD 68652003
C3       EQU   3                   CONSTANT                             68660002
RLB      EQU   3                   LOWER BOUND OF AREA DESCRIBED BY FQE 68670002
FWBMASK  EQU   X'03'               FULL WORD BOUNDARY MASK     @ZA09199 68671040
ERR4     EQU   4                   CONSTANT                    @Z30ENWD 68672003
SV4      EQU   4                   SVC 4                                68680001
C4       EQU   4                   CONSTANT                             68700002
MKEY     EQU   4                   MASK FOR KEY IN REG 15        Y02714 68710002
FOUR     EQU   4                   WORD LENGTH                          68740002
ERR5     EQU   5                   CONSTANT                    @Z30ENWD 68780003
SV5      EQU   5                   SVC 5                                68820002
ERR6     EQU   6                   CONSTANT                    @Z30ENWD 68822003
C6       EQU   6                   CONSTANT                    @Y30APYF 68830003
C7       EQU   7                   CONSTANT                             68840002
MASK     EQU   X'07'               ACCESS LAST 3 BYTES OF FULL WORD     68890002
ERR8     EQU   8                   CONSTANT                    @Z30ENWD 68900003
AQESIZE  EQU   8                   SIZE OF AQE                   Y02714 68910002
C8       EQU   8                   CONSTANT                             68920002
MASK1    EQU   X'08'               MASK TO ACCESS FIRST BYTE            68950002
CODE     EQU   8                   OFFSET FOR CODE INDIC. IN PARM LIST  69000002
ERR9     EQU   9                   CONSTANT                    @Z30ENWD 69010003
SPIDISP  EQU   9                   SPID DISPLACEMENT IN PAR LIST        69020002
NOTMIXED EQU   9                   NOT MIXED COND CODE FOR TM  @ZA20951 69025040
ERRA     EQU   10                  CONSTANT                    @Z30ENWD 69030003
SV10     EQU   10                  SVC 10                               69060002
ERRB     EQU   11                  CONSTANT                    @Z30ENWD 69068003
C12      EQU   12                  CONSTANT                             69084002
ERRD     EQU   13                  CONSTANT                    @Z30ENWD 69094003
C16      EQU   16                  CONSTANT                             69100002
CELLEN   EQU   16                  LENGTH OF AN INTERNAL CELL  @Z30ENWD 69110003
DQESIZE  EQU   16                  SIZE OF DQE                   Y02714 69120002
FBQESIZE EQU   16                  FBQE SIZE                            69140002
SPQESIZE EQU   16                  SPQE SIZE                     Y02714 69150002
SCHEDKEY EQU   X'10'               SCHEDULER KEY = 1             Y02714 69152002
C20      EQU   20                  CONSTANT                             69160002
C24      EQU   24                  CONSTANT                             69180002
C28      EQU   28                  CONSTANT                             69200002
C32      EQU   32                  CONSTANT                      Y02714 69250002
C36      EQU   36                                              @Z30ENYF 69270003
C40      EQU   40                  SAVE AREA DISPLACEMENT REG 10 Y02714 69290002
C48      EQU   48                  SAVE AREA DISPLACEMENT REG 12 Y02714 69295402
C52      EQU   52                  SAVE AREA DISPLACEMENT REG 13 Y02714 69299202
C56      EQU   56                  SAVE AREA DISPLACEMENT REG 14        69302602
C60      EQU   60                  CONSTANT                      Y02714 69306002
H24      EQU   X'24'               REASON CODE 1 & MSGLEN  4            69306102
H28      EQU   X'28'               REASON CODE 1 & MSGLEN  8     Y02714 69306202
H2C      EQU   X'2C'               REASON CODE 1 & MSGLEN 12            69306402
H48      EQU   X'48'               REASON CODE 2 & MSGLEN  8     Y02714 69309402
H4C      EQU   X'4C'               REASON CODE 2 & MSGLEN 12            69316202
H8C      EQU   X'8C'               REASON CODE 4 & MSGLEN 12            69319602
CX40     EQU   X'40'               CONSTANT                      Y02714 69329802
C64      EQU   64                  SAVE AREA LENGTH              Y02714 69333202
C80      EQU   80                  CONSTANT                      Y02714 69336602
SV120    EQU   120                 SVC 120                       Y02714 69370002
C128     EQU   128                 CONSTANT                             69380002
REGION   EQU   X'80'               REGION INDICATOR IN FQE              69390002
CX80     EQU   X'80'               CONSTANT                      Y02714 69400002
PGTABLEN EQU   224                 LENGTH OF PGT AND XPT         Y02714 69430002
C227     EQU   227                 SUBPOOL 227                 @Y30APYF 69435003
SUPSPLIM EQU   227                 LIMIT FOR SUPERVISOR SP     @Y30APYF 69440003
C229     EQU   229                 SUBPOOL 229                   Y02714 69450002
C230     EQU   230                 SUBPOOL 230                   Y02714 69460002
C233     EQU   233                 SUBPOOL 233                   Y02714 69490002
C236     EQU   236                 SUBPOOL 236                   Y02711 69492002
C237     EQU   237                 SUBPOOL 237                   Y02711 69494002
CBSQA    EQU   245                 CONTROL BLOCKS IN SQA         Y02714 69510002
C245     EQU   245                 SUBPOOL 245                          69520002
C250     EQU   250                 SUBPOOL 250                   Y02714 69522002
C252     EQU   252                 SUBPOOL 252                   Y02714 69530002
C253     EQU   253                 SUBPOOL 253                   Y02714 69540002
C254     EQU   254                 SUBPOOL 254                 @ZA29616 69560040
KEY0     EQU   X'F0'               KEY OF 0 TEST; KEY MASK              69580002
END      EQU   X'F0'               TEST FOR END OF SEGMENT              69600002
LAST     EQU   X'80'               END OF LIST INDICATOR                69620002
CBLSQA   EQU   255                 CONTROL BLOCKS IN LSQA        Y02714 69670002
ALL      EQU   X'FF'               ALL BITS, FOR RESETTING FLAGS Y02714 69700002
ONESEG   EQU   X'0100'             SEGMENT COUNT OF 1            Y02714 69710002
WSC101   EQU   X'101'              WAIT STATE CODE, NO VIRTUAL   Y02751 69720002
WSC102   EQU   X'102'              WAIT STATE CODE, NO REAL      Y02751 69730002
C2K      EQU   2048                2K INCREMENT FOR SSK                 69740002
C4095    EQU   4095                ONE PAGE - 1                  Y02714 69750002
CPAGE    EQU   4096                PAGE SIZE                     Y02714 69750402
         TITLE 'IEAVGM00   OS/VS2 GETMAIN / FREEMAIN SERVICE ROUTINE   *69756903
               CSECT-IEAVGM00'                                          69757303
IEAVGM00 CSECT                                                 @Y30APYF 69763003
*********************************************************************** 69766003
*                                                                       69770003
*        THESE CONSTANTS ARE ADDRESSED VIA REG 13 FROM ANY OF           69773003
*        THE CSECT IN THIS ASSEMBLY                                     69776003
*                                                                       69779003
*********************************************************************** 69782003
         SPACE 2                                                 Y02714 69785003
         DS    0D                                                       69788003
CELLOW   DC    F'5'                EXPAND POOL BELOW THIS VALUE@Z30ENWD 69791003
CELEXPNL DC    F'1024'             LENGTH FOR POOL EXPANSION   @Z30ENWD 69796003
PAGE     DC    F'4096'             PAGE SIZE                            69802002
MAXFQESZ DC    F'8176'             MAXIMUM FQE SIZE              Y02714 69810002
SEGMENT  DC    F'65536'            SEGMENT SIZE                  Y02714 69820002
BASE100  DC    A(BASE1)            VALUE FOR BASE REG 8 FOR    @Y30APYF 69820203
*                                  CSECT00, ACCESSABLE VIA BASE@Y30APYF 69820503
*                                  REGISTER 13                 @Y30APYF 69820803
BASE101  DC    A(G4KSRCH)          VALUE FOR BASE REG 8 FOR    @Y30APYF 69821103
*                                  CSECT01, ACCESSABLE VIA BASE@Y30APYF 69821403
*                                  REGISTER 13                 @Y30APYF 69821703
AFMSMF   DC    A(FMSMFCRE)         ENTRY POINT FOR FMSMF INTERFACE      69824002
AGMSMF   DC    A(GMSMFCRE)         ENTRY POINT FOR GMSMF INTERFACE      69826002
ASRM     DC    A(SRMSTART)         SRM ENTRY AND BASE            Y02714 69827002
ASTERMR  DC    A(STERMR)           SYS TERM REAL, ENTRY AND BASE Y02751 69828002
ASTERMV  DC    A(STERMV)           SYS TERM VIRT, ENTRY AND BASE Y02751 69829002
APGINCOR DC    A(PGINC01)          PGINCORE ENTRY AND BASE     @YM07648 69829503
GFPART   DC    V(IEAVPRT0)         GET/FREE PART                        69830002
VPFP1    DC    V(IEAVFP1)          FIND PAGE, LOCAL LOCK ENTRY   Y02714 69840002
VPFP2    DC    V(IEAVFP2)          FIND PAGE, SALLOC LOCK ENTRY  Y02714 69841202
VCRSEG   DC    V(IEAVCSEG)         CREATE SEGMENT                Y02714 69844002
SP245F   DC    F'245'              SUBPOOL 245 (SQA)           @Z30ENWD 69844203
SP255F   DC    F'255'              SUBPOOL 255 (LSQA)            Y02714 69846002
THR2PASD DC    A(2*4096)           THRESHOLD 2 PASSED, 2 PAGES   Y02714 69846103
THR2CLRD DC    A(3*4096)           THRESHOLD 2 CLEARED, 3 PAGES  Y02714 69851003
THR1PASD DC    A(6*4096)           THRESHOLD 1 PASSED, 6 PAGES   Y02714 69853003
THR1CLRD DC    A(7*4096)           THRESHOLD 1 CLEARED, 7 PAGES  Y02714 69854003
GLSPIDS  DC    AL1(227,228,231,239,241,245) GLBRANCH SPIDS     @Y30APYF 69855003
SP245B   DC    X'F5'               SQA                         @Z30ENWD 69855603
SP255B   DC    X'FF'               LSQA                        @Z30ENWD 69856303
         DS    0F                                              @Y30APYF 69857003
RCMASK   DC    X'0000007F'         RESET BIT 0 IN RETURN CODE    YO2714 69858003
BYTE3MSK DC    X'000000FF'         MASK FOR BYTE 3 IN REGISTER   Y02714 69859003
PGBNDMSK DC    X'00000FFF'         PAGE BOUNDARY MASK                   69860403
CLHIBYTE DC    X'00FFFFFF'         MASK TO CLEAR HIGH BYTE              69861403
LGPOSNUM DC    X'7FFFFFFF'         LARGEST POSSIBLE NUMBER       Y02714 69863403
CLRHIBIT EQU   LGPOSNUM            MASK TO CLEAR HIGH BIT        Y02714 69864403
KEYMASK  DC    X'FFF0FFFF'         REMOVE MODE FROM KEY          Y02714 69865803
SEGBND   DC    X'FFFF0000'         ROUND TO SEGMENT BOUNDARY     Y02714 69867803
BND4K    DC    X'FFFFF000'         ROUND TO 4K BOUNDARY                 69868803
SETUP    DC    X'01040A00' BR ENT, LSQA, SVC10, KEY 0, SUP STATE Y02714 69869803
SETUPFMB DC    X'05000A00'         SETUP REQUEST STATUS FOR      Y02714 69870603
*                                  FMAINB; BR ENT & FREEMB,      Y02714 69872603
*                                  SVC10, KEY 0, SUP STATE       Y02714 69873603
FMPGTBSP DC    AL1(CBLSQA),AL3(PGTABLEN) FREEM PG TAB SPID & LEN Y02714 69874603
H8       DC    H'8'                CONSTANT                             69876603
H252     DC    H'252'              SUBPOOL 252                          69878602
STRWTO   WTO   'IEA946W NO VIRTUAL STORAGE IS AVAILABLE FOR SQA',      *69879003
               ROUTCDE=1,DESC=1,MF=L  SYSTEM TERMINATION MSG     Y02751 69880403
STRVIRT  EQU   STRWTO+15           START OF WORD "VIRTUAL" IN    Y02751 69881403
*                                  MSG, THIS DISPLACEMENT IS     Y02751 69882603
*                                  MACRO DEPENDENT               Y02751 69883603
STRREAL  DC    C'REAL   '          MAY REPLACE "VIRTUAL" IN MSG  Y02751 69885603
         EJECT                                                   Y02714 69886603
**************************************************************** Y02714 69887603
*                                                                Y02714 69888803
*        RETURN CODE VERSUS ERROR CODE TABLE. ZERO MEANS         Y02714 69890803
*        ABEND ONLY. BIT 0 ON MEANS CHECK REASON CODE FOR        Y02714 69891803
*        SPECIAL CASE.                                           Y02714 69892803
*                                                                Y02714 69894003
**************************************************************** Y02714 69896003
         SPACE 2                                                 Y02714 69897003
*           RETURN CODE        ERROR CODE                        Y02714 69898003
         SPACE 1                                                 Y02714 69899003
RCTABLE  DC    X'08'                1                            Y02714 69900703
         DC    X'00'                2       NOT USED             Y02714 69901703
         DC    X'84'                3                            Y02714 69903703
         DC    X'00'                4                            Y02714 69904703
         DC    X'00'                5                            Y02714 69905703
         DC    X'00'                6                            Y02714 69907703
         DC    X'00'                7       NOT USED             Y02714 69908703
         DC    X'84'                8                            Y02714 69910702
         DC    X'00'                9                            Y02714 69912702
         DC    X'84'               10                            Y02714 69913102
         DC    X'00'               11                            Y02714 69913502
         DC    X'00'               12       NOT USED             Y02714 69920102
         DC    X'04'               13                            Y02714 69930102
         EJECT                                                   Y02714 69932102
         IHALDA                                                  Y02714 69932502
         EJECT                                                   Y02714 69932902
*********************************************************************** 69933302
*                                                                Y02714 69933402
*        THE FOLLOWING STORAGE AREAS WILL ACTUALLY BE LOCATED    Y02714 69940002
*        IN THE LOCAL DATA AREA (LDA) OF EACH ADDRESS SPACE OR   Y02714 69950002
*        THE GLOBAL SAVE AREA FOR THE GLBRANCH ENTRY POINT.  IF  Y02714 70000002
*        ANY CHANGE IS MADE IN DISPLACEMENTS, A CORRESPONDING    Y02714 70001002
*        CHANGE MAY BE REQUIRED IN MODULE IEAVGFRR (GETMAIN/     Y02714 70002002
*        FREEMAIN FRR).                                          Y02714 70003002
*                                                                Y02714 70010002
*********************************************************************** 70010402
         SPACE 2                                                 Y02714 70010802
         ORG   GMFMWKAR            PUT FOLLOWING INTO LDA        Y02714 70012002
         SPACE 2                                                 Y02714 70018602
* LDARQSTA                         STATUS OF CURRENT REQUEST     Y02714 70018802
*                                  BYTE 0 - FLAGS                Y02714 70019202
*                                  BYTE 1 - SUBPOOL FLAGS        Y02714 70019602
*                                  BYTE 2 - SVC NUMBER           Y02714 70019902
*                                  BYTE 3 - KEY AND MODE         Y02714 70023202
         SPACE 2                                                 Y02714 70023302
FLAGS    EQU   LDARQSTA            MISC. FLAGS                   Y02714 70023402
BRENTRY  EQU   X'01'               BRANCH ENTRY                  Y02714 70023502
GETMB    EQU   X'02'               GETMAINB REQUEST              Y02714 70024002
FREEMB   EQU   X'04'               FMAINB OR MRELEASR REQUEST    Y02714 70024102
DEFERR10 EQU   X'08'               DEFERRED ERROR 10 FLAG        Y02714 70024402
EXPANSN  EQU   X'10'               SQA OR LSQA EXPANSION         Y02714 70024802
VARPASS2 EQU   X'20'               VARIABLE REQUEST, PASS 2      Y02714 70025202
ERGNRCHD EQU   X'40'               EXPLICIT V=V REGION REACHED   Y02714 70025602
LDAABGM  EQU   X'80'               SP254 REQSTR HAS TCBABGM ON @ZA29616 70025740
         SPACE 2                                                 Y02714 70026140
SPFLAGS  EQU   LDARQSTA+C1         SUBPOOL FLAGS                 Y02714 70026240
SQA      EQU   X'01'               SQA SUBPOOL                   Y02714 70026302
CSA      EQU   X'02'               CSA SUBPOOL                   Y02714 70026802
LSQA     EQU   X'04'               LSQA SUBPOOL                  Y02714 70027302
SWA      EQU   X'08'               SWA SUBPOOL                   Y02711 70027802
AUK      EQU   X'10'               AUTHORIZED USER KEY SUBPOOL   Y02714 70028302
FPROTECT EQU   X'20'               FETCH PROTECTED SUBPOOL       Y02714 70028802
NEEDAQE  EQU   X'40'               AN AQE IS NEEDED              Y02714 70029302
REQ4K    EQU   X'80'               4096 BYTE REQ FROM SP253/4  @ZA11822 70029740
         SPACE 2                                                 Y02714 70030202
SVCBYTE  EQU   LDARQSTA+C2         SVC NUMBER                    Y02714 70030402
         SPACE 2                                                 Y02714 70031202
MODE     EQU   LDARQSTA+C3         KEY & MODE                    Y02714 70034402
SUP      EQU   X'01'               SUPERVISOR MODE (IF ZERO)            70035202
SUBFRMN  EQU   X'02'               SUBPOOL FREEMAIN                     70036002
         SPACE 2                                                 Y02714 70036602
*                                                                       70036802
*        THE FOLLOWING FIELDS MUST REMAIN IN THE SAME ORDER             70038202
*        AS 1 INSTRUCTION CLEARS THE FIELDS.                            70038602
*                                                                       70039202
ABNDATA  DS    F                   VARIABLE DATA                 Y02714 70040002
MSGLEN   DS    X                   REASON CODE & LNTH OF VAR DATAY02714 70041202
FREESW   DS    B                   MULTIPURPOSE SWITCH           Y02714 70043202
FREESWM  EQU   X'80'               FREEMAIN IN PROCESS                  70043402
INCR     EQU   X'40'               LENGTH HAS BEEN INCREMENTED          70043502
DECR     EQU   X'20'               ADDRESS HAS BEEN DECREMENTED         70043602
NFRSTDQE EQU   X'10'               NOT FIRST DQE (FOR L/SQA)     Y02714 70043702
FQEBELOW EQU   X'08'               AN FQE WAS BELOW FREED AREA   Y02714 70043802
NEEDRLSE EQU   X'04'               FURTHER PAGE RELEASE NEEDED   Y02714 70043902
ABNDATAL EQU   *-ABNDATA           LENGTH OF FIELDS TO BE CLEARED       70046402
         SPACE 2                                                 Y02714 70048402
*        LOCKFLAG & FRRBRNDX ARE CLEARED WITH ONE STH, KEEP TOGETHER    70048802
         SPACE 1                                                 Y02714 70049202
LOCKFLAG DS    B                   LOCKING FLAGS                 Y02751 70050402
SALHELD  EQU   X'01'               SALLOC LOCK ALREADY HELD      Y02751 70052402
SALOBTND EQU   X'02'               SALLOC LOCK OBTAINED          Y02751 70052802
         SPACE 2                                                 Y02714 70053302
FRRBRNDX DS    X                   BRANCH INDEX FOR FRR          Y02753 70054902
*        EQU   0        UNEXPECTED ERROR, CHECK STATUS FLAGS     Y02753 70055002
CLSALFLD EQU   1        SALLOC RELEASE RETURN CODE > 0           Y02753 70055202
CRSEGERR EQU   2        CREATE SEGMENT RETURN CODE > 0           Y02753 70060702
FNDPGERR EQU   3        FIND PAGE RETURN CODE NOT 0 OR 4         Y02753 70062702
GFREFAIL EQU   4        ON L/SQA EXPAN., GFRECORE FAILED         Y02753 70067202
GTSALFLD EQU   5        SALLOC OBTAIN RETURN CODE NOT 0 OR 4     Y02753 70069202
PGRLSRC4 EQU   6        PAGE RELEASE RETURN CODE OF 4            Y02753 70078402
SPFMERR  EQU   7        SUBPOOL FREEMAIN, AQE AREA NOT IN DQE    Y02753 70080402
         SPACE 2                                                 Y02753 70084002
REGSAVE  DS    18F                 STANDARD REGISTER SAVE AREA   Y02714 70086002
*                                  (72 BYTES),  USED FOR         Y02714 70088002
*                                  SRM (SYSEVENT) AND RSM        Y02714 70088102
REGSVEND EQU   *                   END OF REGISTER SAVE AREA     Y02714 70088902
STRPL    EQU   REGSAVE             SYSTEM TERM ROUTINE PARM LIST Y02751 70089002
         ORG   REGSAVE+C8          RESET INSTRUCTION COUNTER SO  Y02714 70089102
*                                  LRB CAN BE ON NEXT AVAILABLE  Y02714 70089202
*                                  DOUBLE WORD BOUNDARY IN       Y02714 70089302
*                                  REGSAVE                       Y02714 70089402
STRLRB   DS    0D                  LOGREC RECORD BUFFER          Y02751 70089502
LRBRCTYP EQU   STRLRB              LRB RECORD TYPE               Y02751 70089602
LRBWSC   EQU   STRLRB+C24          LRB WAIT STATE CODE           Y02751 70094502
LRBRCLEN EQU   STRLRB+C28          LRB RECORD LENGTH             Y02751 70096502
LRBSIZE  EQU   32                  SIZE OF LRB                   Y02751 70098502
         ORG   REGSVEND            RESTORE INSTRUCTION COUNTER   Y02714 70098902
         SPACE 2                                                 Y02714 70099902
MSAVE    DS    16F                 SAVE AREA FOR MRELEASE        Y02714 70100002
GNOTSAVE DS    16F                 SAVE AREA USED IN GNOTSAT     Y02714 70105002
LOCKSAVE DS    2F                  GT/CLSALLOC, QFMAINB, AND SRM Y02751 70110002
*                                  SAVE AREA OVERLAPS INTO       Y02751 70115002
*                                  GFSMFSVE AND MPTRS            Y02751 70116002
GFSMFSVE DS    3F                  SMF CORE ROUTINES SAVE AREA   Y02714 70120002
CSPCKSAV EQU   GFSMFSVE            SAVE AREA FOR CSPCHK          Y02714 70125002
MPTRS    DS    2F                  SAVE PREVIOUS AND NEXT PTRS.  Y02714 70130002
DUMYDQE  DS    4F                  DUMMY DQE FOR L/SQA EXPANSION Y02714 70135002
TEMPDQE  DS    4F                  TEMPORARY DQE FOR FMCOMMON    Y02714 70140002
DUMFBQE  DS    4F                  DUMMY FBQE FOR MRELEASE       Y02714 70145002
SAVEREG1 EQU   BRANCHSV+C4         SAVE INPUT REG 1 FOR FREEMAIN Y02714 70150002
RETSAVE  EQU   BRANCHSV+C56        SAVE RETURN ADDRESS           Y02714 70155002
SAV911   DS    3F                  SAVE REGS 9-11                Y02714 70160002
LASTSAVE DS    F                   SAVE POSSIBLE LAST LIST ENTRY Y02714 70172002
MINMAX   DS    2F                  MAX & MIN LENGTH FOR VARIABLE Y02714 70180002
LASTLSTA DS    F                   LAST LIST ENTRY ADDRESS       Y02714 70190002
LSTINDEX DS    F                   INDEX FOR LIST REQUEST        Y02714 70200002
FMAREAS  DS    F                   PTR TO AREAS TO BE FREEMAINED Y02714 70210002
FRRPARM  DS    F                   FRR PARAMETER AREA ADDRESS    Y02753 70211002
PARMLDA  EQU   0                   LDA ADDRESS IN FRR PARM       Y02753 70212002
PARMFLG1 EQU   4                   FIRST FLAG BYTE IN FRR PARM   Y02753 70213002
PARMGLBL EQU   X'80'               GLOBAL REQUEST (GLBRANCH OR   Y02753 70214002
*                                  MRELEASR ON GLOBAL REQUEST)   Y02753 70215002
PARMSALO EQU   X'40'               SALLOC LOCK OBTAINED BY GM/FM Y02753 70215202
PARMVLCK EQU   X'20'               SVC 4/SVC 5 INTERFACE BEING @ZA20641 70215440
*                                  VALIDITY CHECKED            @ZA20641 70215640
         SPACE 2                                                 Y02714 70216002
*                                                                       70250001
*    THE FOLLOWING 3 LINES MUST REMAIN IN THE SPECIFIED ORDER           70252001
*    AS 1 INSTRUCTION IS USED TO CLEAR THEM                             70254001
*                                                                       70256001
CLOPREV  DS    F                   PREVIOUS FQE TO CLOSEST       Y02714 70260002
CLOSEST  DS    F                   CLOSEST IN SIZE FQE           Y02714 70270002
LARGESTA DS    F                   LARGEST AVAILABLE             Y02714 70280002
         SPACE 2                                                 Y02714 70290002
LARGEST  DS    F                   LARGEST AVAILABLE FBQE        Y02714 70300002
LENSAVE  DS    F                   SAVE AREA FOR LENGTH LIST POINTER    70640002
SAVESIZE DS    F                   SIZE OF MULTIPLE OF 4K CORE   Y02714 70680002
ENDADD   DS    F                   END ADDRESS                   Y02714 70700002
TEMPSAV1 EQU   ENDADD              TEMPORARY SAVE AREA 1         Y02714 70710002
STRTADD  DS    F                   START ADDRESS                 Y02714 70720002
TEMPSAV2 EQU   STRTADD             TEMPORARY SAVE AREA 2         Y02714 70730002
DIFF     DS    F                   DIFFERENCE                    Y02714 70760002
SAVEPQE  EQU   DIFF                SAVE PQE ADDRESS IN FBQSRCH   Y02714 70810002
FIXSTART DS    F                   STARTING ADDRESS TO BE CLEAREDY02714 70812002
FIXEND   DS    F                   ENDING ADDRESS TO BE CLEARED  Y02714 70814002
NOTSATSV DS    F                   LENGTH POINTER USED BY GNOTSATY02714 70816002
NOTSATS1 DS    F                   SAVE LDARQSTA WHEN GNOTSAT IS Y02714 70818002
*                                  DOING A FREEMAIN FOR A LIST   Y02714 70818402
SAVESEG  DS    F                   ADDRESS OF MULTIPLE OF 4K COREY02714 70840002
LARSOFAR DS    F                   LARGEST AVAILABLE IN FBQE     Y02714 70860002
RSTRTADD DS    F                   ROUNDED START ADDRESS         Y02714 71360002
TEMPSAV3 EQU   RSTRTADD            TEMPORARY SAVE AREA 3         Y02714 71370002
RENDADD  DS    F                   ROUNDED END ADDRESS           Y02714 71380002
VPFP     DS    F                   FIND PAGE ADDRESS TO BE USED  Y02714 71381002
*********************************************************************** 71430001
*     THE FOLLOWING DS'S MUST REMAIN IN THE SAME ORDER AS ONE MOVE    * 71440002
*    INSTRUCTION IS USED TO SAVE THEM ALL                             * 71450001
*********************************************************************** 71454001
DQESAVE  DS    2F                  SAVE DQE PTR AND PREV DQE PTR        71460002
FMSAVE   DS    1F                  SAVE RETURN REG FOR FREEMAIN         71470002
PREVFQSV DS    1F                  SAVE AREA FOR PREVIOUS FQE POINTER   71472002
FQESAVE  DS    1F                  SAVE AREA FOR FQE                    71474002
SPQESAVE DS    1F                  SAVE AREA FOR SPQE                   71476002
SVRLB    DS    F                   SAVE AREA FOR RLB             Y02714 71478002
SVSIZE   DS    F                   SAVE AREA FOR ROUNDED SIZE    Y02714 71478402
DQESAVE1 DS    2F                  SAVE DQE INFO WHEN USING FMAINB      71480002
FMSAVE1  DS    1F                  SAVE RETURN REG WHEN USING FMAINB    71500002
FQESAVE1 DS    1F                  SAVE FQE INFO WHEN USING FMAINB      71502002
PREVFQS1 DS    1F                  SAVE PREVIOUS FQE WHEN USING FMAINB  71510002
SPQSAVE1 DS    1F                  SAVE SPQE WHEN USING FMAINB          71510402
SVRLB1   DS    F                   SAVE RLB FOR FMAINB           Y02714 71510802
SVSIZE1  DS    F                   SAVE ROUNDED SIZE FOR FMAINB  Y02714 71511202
*********************************************************************** 71512001
SAVSVTSV DS    F                   SAVE LDARQSTA DURING FMAINB   Y02714 71514002
FQENXTSV DS    F                   FQE NEXT SAVE AREA            Y02714 71520002
OLDFQELN DS    F                   OLD FQE LENGTH                Y02714 71560002
NEWFQELN DS    F                   NEW FQE LENGTH                Y02714 71580002
RQSTSIZE DS    F                   SAVED SIZE OF ORIGINAL      @ZA27672 71600040
*                                  REQUEST FOR MSG IEA700I ON  @ZA27672 71610040
*                                  AXX-2 ABENDS.               @ZA27672 71620040
SEGTEST  DS    H                   AREA TO TEST END OF SEGMENT   Y02714 71660002
         SPACE 2                                                 Y02714 71710002
CODE1    DS    B                   SAVE AREA FOR OPTION CODE     Y02714 71800002
S120FM   EQU   X'01'               SVC 120 FREEMAIN REQUEST      Y02714 71802002
S120UNCD EQU   X'02'               SVC 120 UNCONDITIONAL REQUEST Y02714 71804002
S120PBND EQU   X'04'               SVC 120 PAGE BOUNDRY REQUEST  Y02714 71805002
BOUND    EQU   X'10'               MASK FOR PAGE BOUNDARY               71806002
CONDTNL  EQU   X'20'               CONDITIONAL  INDICATOR               71806802
LIST     EQU   X'C0'               LIST INDICATOR (IF MIXED IS LIST)    71807202
LISTVAR  EQU   X'C0'               USED TO CHECK FOR LIST AND VARIABLE  71808002
VARBLE   EQU   X'C0'               VARIABLE TEST INDICATOR              71808102
         SPACE 2                                                 Y02714 71812402
CLEARSW  DS    B                   CLEARSW FOR GFRECORE          Y02714 71814002
CLEARON  EQU   X'01'               FQECPB INDICATOR IS ON IN FQE        71816002
         SPACE 2                                                 Y02714 71816402
GMFMSW   DS    B                   GM/FM SWITCH FOR MRELEASE     Y02714 71840002
GM       EQU   X'01'               INDICATES GM TO BE DONE FOR FBQE     71840402
FM       EQU   X'02'               INDICATES FM TO BE DONE FOR FBQE     71842002
FIRSTSW  EQU   X'04'               FIRST TIME THRU SW FOR MRELEASE      71852002
         SPACE 2                                                 Y02714 71860002
FETCH    DS    B                   KEY AND FETCH PROTECT         Y02714 71890002
FETCHON  EQU   X'08'               FETCH PROTECT ON                     71900002
         SPACE 2                                                 Y02714 71902002
OUTSW    DS    X                   SWITCH FOR OUT OF REAL OR VIRTY02714 71904002
VIRTUAL  EQU   X'FF'               VIRTUAL INDICATOR FOR OUT SWITCH     71906002
REALOUT  EQU   X'00'               REAL INDICATOR FOR OUT SWITCH        71908002
         SPACE 2                                                 Y02714 72150002
CODE2    DS    B                   SAVE AREA FOR OPTION CODE     Y02714 72152002
SAVFRESW DS    B                   SAVE FREESW DURING FMAINB     Y02714 72152402
SPID     DS    X                   SPID FOR MRELEASE             Y02714 72154002
LSPQEKEY DS    X                   PROTECT KEY FROM CURRENT SPQE Y02714 72156002
RQSTRKEY DS    X                   REQUESTER KEY OR KEY= PARAM.  Y02714 72156402
SAVSPID  DS    X                   SAVE SPID FOR FREEMAIN        Y02714 72156502
SAVSPID2 DS    X                   SAVE SPID FOR MESSAGES      @YM07648 72156603
CELLFLGS DS    B                   CONTROL OF INTERNAL CB POOL @Z30ENWD 72156703
LCLEXP   EQU   X'80'               LOCAL POOL EXPANSION REQ'D  @Z30ENWD 72158703
GLBLEXP  EQU   X'40'               GLOBAL POOL EXPANSION REQ'D @Z30ENWD 72160703
LCLREQ   EQU   X'20'               LOCAL CELL REQUEST          @Z30ENWD 72162703
GNOTCALL EQU   X'08'               ON =GNOTSAT CALLING GETMAINE@Z30ENWD 72164703
INCELL   EQU   X'04'               ON = IN GETMAINC            @Z30ENWD 72166703
INEXPN   EQU   X'02'               ON = IN EXPANSION ROUTINE   @Z30ENWD 72168703
INCBBRAN EQU   X'01'               ON = CBBRANCH WAS ENTRY     @Z30ENWD 72170703
         EJECT                                                          72177003
         IHAGDA                                                  Y02714 72180003
         EJECT                                                   Y02714 72183003
         IHALCCA                                               @ZA08170 72184040
         EJECT                                                 @ZA08170 72185040
         IHASPQE   INTERNAL                                             72186003
         SPACE 4                                                        72190003
         IHAFBQE   INTERNAL                                             72193003
         SPACE 4                                                        72196003
         IHAFQE    INTERNAL                                             72200001
         SPACE 4                                                        72210002
         IHAAQE    INTERNAL                                             72220001
         SPACE 4                                                        72230002
         IHADQE    INTERNAL                                             72240001
         SPACE 4                                                        72250002
         IHAPQE    INTERNAL                                             72260001
         EJECT                                                          72270002
         IHAPGTE                                                        72280001
         EJECT                                                          72290002
         IHAXPTE                                                        72300001
         EJECT                                                          72302001
         IHAPVT                                                         72304001
         EJECT                                                          72306001
         IHAPSA                                                  Y02714 72307502
         EJECT                                                   Y02714 72308702
         IHAWSAVT CLASS=GLOBAL                                   Y02714 72309102
         EJECT                                                   Y02714 72309202
         IHAASCB                                                 Y02714 72309502
         EJECT                                                   Y02714 72311002
         IHARB DSECT=YES                                         Y02714 72312502
         EJECT                                                          72314002
         CVT   SYS=AOS2,OPTIONS=(TSLICE),TSO=YES,DSECT=YES,PREFIX=NO    72315502
         EJECT                                                          72318502
         IKJTCB                                                         72320001
         EJECT                                                          72330001
         IEFTCT                                                         72370001
         EJECT                                                          72378401
RVT      IHARVT                                                  Y02751 72378802
         EJECT                                                   Y02753 72379802
         IHAFRRS                                                 Y02753 72380802
         EJECT                                                          72479101
         IHAINF                                                         72529101
         SPACE 5                                                 Y02714 72539102
         END                                                            72579101
./  ADD  SSI=60870135,NAME=IEAVGPRR
         TITLE '***IEAVGPRR---IEAVPRT0 FUNCTIONAL RECOVERY RTN***      *00001000
                        '                                               00002000
*                        /* @ZA01896*/                                  00003000
IEAVGPRR CSECT                                                          00004000
   BALR  RBASE,@00                     SET UP ADDRESSABILITY            00005000
   USING *,RBASE                                                        00006000
        MODID                                                           00007000
*   GPR02F=GPR00F;                  /* SAVE FRR WORKAREA PTR IN    0083 00008000
*                                      USEABLE REG           @ZA01896*/ 00009000
         LR    GPR02F,GPR00F                                       0083 00010000
*   GPR03F=GPR01F->SDWAPARM->LDAADD;/* GET LDA ADDRESS       @ZA01896*/ 00011000
         L     @12,SDWAPARM(,GPR01F)                               0084 00012000
         L     GPR03F,LDAADD(,@12)                                 0084 00013000
*   IF GPR03F=0 THEN                /* IF THERE IS NO LDA ADDRESS, 0085 00014000
*                                      THEN THE ERROR OCCURRED IN THE   00015000
*                                      MAINLINE BEFORE THE FRR 6   0085 00016000
*                                      WORDS COULD BE INITIALIZED, OR   00017000
*                                      THEY WERE CLOBBERED   @ZA01896*/ 00018000
         LTR   GPR03F,GPR03F                                       0085 00019000
         BNZ   @RF00085                                            0085 00020000
*     DO;                           /* PERCOLATE IF THIS IS SO     0086 00021000
*                                                            @ZA01896*/ 00022000
*       RFY                                                        0087 00023000
*         SDWA BASED(GPR01F);       /*                       @ZA01896*/ 00024000
*       SDWARCDE=SDWACWT;           /*                       @ZA01896*/ 00025000
         MVI   SDWARCDE(GPR01F),X'00'                              0088 00026000
*       RFY                                                        0089 00027000
*         SDWA BASED(SDWAPTR);      /*                       @ZA01896*/ 00028000
*       GOTO RET1;                  /* RETURN PROCESSING     @ZA01896*/ 00029000
         B     RET1                                                0090 00030000
*     END;                          /*                       @ZA01896*/ 00031000
*/********************************************************************/ 00032000
*/*                                                                  */ 00033000
*/*  SAVE LDA FIELDS USED BY GETPART/FREEPART MAINLINE SO THEY WONT  */ 00034000
*/*  BE CLOBBERED BY THE GETMAIN AND FREEMAIN IN THIS MODULE.        */ 00035000
*/*                                                                  */ 00036000
*/********************************************************************/ 00037000
*                                                                  0092 00038000
*   RFY                                                            0092 00039000
*     FRRSAVE BASED(GPR02F);        /*                       @ZA01896*/ 00040000
@RF00085 DS    0H                                                  0093 00041000
*   RFY                                                            0093 00042000
*     LDA BASED(GPR03F);            /*                       @ZA01896*/ 00043000
*   SAVBRSV=BRANCHSV;               /*                       @ZA01896*/ 00044000
         MVC   SAVBRSV(64,GPR02F),BRANCHSV(GPR03F)                 0094 00045000
*   SAVTCB=LDATCB;                  /*                       @ZA01896*/ 00046000
         L     @12,LDATCB(,GPR03F)                                 0095 00047000
         ST    @12,SAVTCB(,GPR02F)                                 0095 00048000
*   SAVRQSTA=LDARQSTA;              /*                       @ZA01896*/ 00049000
         L     @12,LDARQSTA(,GPR03F)                               0096 00050000
         ST    @12,SAVRQSTA(,GPR02F)                               0096 00051000
*   SAVFLAG=LVSMFLAG;               /*                       @ZA01896*/ 00052000
         MVC   SAVFLAG(4,GPR02F),LVSMFLAG(GPR03F)                  0097 00053000
*   SAVCBSP=LDACBSP;                /*                       @ZA01896*/ 00054000
         IC    @12,LDACBSP(,GPR03F)                                0098 00055000
         STC   @12,SAVCBSP(,GPR02F)                                0098 00056000
*   RFY                                                            0099 00057000
*     LDA BASED(LDAPTR);            /*                       @ZA01896*/ 00058000
*   GENERATE REFS(SCVTRMBR,SCVTSECT,PSAAOLD,PSATOLD);              0100 00059000
*                                                    /* @ZA01896*/      00060000
   L     @00,@SIZDATD                  SIZE FOR DYNAMIC STG             00061000
   ICM   @00,B'1000',XFF               SUBPOOL 255                      00062000
   LR    @05,@01                                                        00063000
   L     GPR04F,PSATOLD                TCB ADDRESS                      00064000
   L     GPR07F,PSAAOLD                ASCB ADDRESS                     00065000
   LR    @06,@14                       SAVE RETURN REG                  00066000
   GETMAIN  R,LV=(0),BRANCH=YES        GET DYNAMIC STORAGE              00067000
   LR    @08,@01                       DATA REGISTER                    00068000
   USING @DATD,@08                                                      00069000
   ST    @05,SDWAPTR                   INPUT PARAMETER                  00070000
   ST    @06,R14SAVE                                                    00071000
*   WRKPTR=GPR02F;                  /* SAVE FRR WORKAREA PTR @ZA01896*/ 00072000
         ST    GPR02F,WRKPTR                                       0101 00073000
*   PARMBASE=SDWAPARM;              /* FRR PARM AREA BASE            */ 00074000
         L     @12,SDWAPTR                                         0102 00075000
         L     @11,SDWAPARM(,@12)                                  0102 00076000
         ST    @11,PARMBASE                                        0102 00077000
*   SDWAMODN=MODN;                  /* MODULE NAME           @YM07262*/ 00078000
         MVC   SDWAMODN(8,@12),MODN                                0103 00079000
*   SDWACSCT=MODN;                  /* CSECT NAME            @YM07262*/ 00080000
         MVC   SDWACSCT(8,@12),MODN                                0104 00081000
*   SDWAREXN=REXN;                  /* FRR ROUTINE NAME      @YM07262*/ 00082000
         MVC   SDWAREXN(8,@12),REXN                                0105 00083000
*   LDAPTR=LDAADD;                  /* LDA BASE                      */ 00084000
         L     @11,LDAADD(,@11)                                    0106 00085000
         ST    @11,LDAPTR                                          0106 00086000
*   TCBPTR=LDATCB;                  /* TCB ADDRESS                   */ 00087000
         L     TCBPTR,LDATCB(,@11)                                 0107 00088000
*   GDAPTR=CVTGDA;                  /* GDA BASE                      */ 00089000
         L     @05,CVTPTR                                          0108 00090000
         L     @05,CVTGDA(,@05)                                    0108 00091000
         ST    @05,GDAPTR                                          0108 00092000
*   RASCB=PASCBSV;                  /* ASCB ADDRESS                  */ 00093000
         L     RASCB,PASCBSV(,@11)                                 0109 00094000
*   SDWARCRD='1'B;                  /* INDICATE RECORDING DESIRED    */ 00095000
         OI    SDWARCRD(@12),B'10000000'                           0110 00096000
*   IF SDWAFMID¬=SAME THEN          /* IF THIS MEMORY NOT FAILING  0111 00097000
*                                      MEMORY, PERCOLATE             */ 00098000
         LH    @11,SDWAFMID(,@12)                                  0111 00099000
         N     @11,@CF02485                                        0111 00100000
         CH    @11,SAME                                            0111 00101000
         BE    @RF00111                                            0111 00102000
*     DO;                                                          0112 00103000
*       SDWARCDE=SDWACWT;           /* NO RETRY                      */ 00104000
         MVI   SDWARCDE(@12),X'00'                                 0113 00105000
*       GOTO RET;                   /* RETURN PROCESSING             */ 00106000
         B     RET                                                 0114 00107000
*     END;                                                         0115 00108000
*   SDWAUPRG='1'B;                  /* REGS UPDATED FOR RETRY        */ 00109000
@RF00111 L     @12,SDWAPTR                                         0116 00110000
         OI    SDWAUPRG(@12),B'00001000'                           0116 00111000
*   IF GPFPFLG='1'B THEN            /* IF GETPART REQUEST,BRANCH     */ 00112000
         L     @11,PARMBASE                                        0117 00113000
         TM    GPFPFLG(@11),B'00000001'                            0117 00114000
         BO    @RT00117                                            0117 00115000
*     GOTO GPFRR;                   /* GO TO GETPART PROCESS         */ 00116000
*   IF RECURSE='1'B THEN            /* IF THIS IS RECURSION ENTRY,   */ 00117000
         TM    RECURSE(@11),B'00001000'                            0119 00118000
         BO    @RT00119                                            0119 00119000
*     GOTO RECRS1;                  /* DO NOT RETRY                  */ 00120000
*   ELSE                            /* NON-RECURSION                 */ 00121000
*     RECURSE='1'B;                 /* SET ON BIT FOR RECURSION      */ 00122000
         OI    RECURSE(@11),B'00001000'                            0121 00123000
*   IF SDWAPERC='0'B THEN           /* ONLY IF NOT PERCOLATION       */ 00124000
         TM    SDWAPERC(@12),B'00010000'                           0122 00125000
         BNZ   @RF00122                                            0122 00126000
*     IF SDWAMCHK='1'B|SDWAPCHK='1'B THEN/* THESE ARE RETRYABLE    0123 00127000
*                                      ERRORS                        */ 00128000
         TM    SDWAMCHK(@12),B'11000000'                           0123 00129000
         BNZ   @RT00123                                            0123 00130000
*       GOTO RETRY;                 /* RETRY                         */ 00131000
*   IF SDWACMPC=O82 THEN            /* IF ERROR IS BAD RETURN FROM 0125 00132000
*                                      SETLOCK, DO NOT FREE SALLOC   */ 00133000
@RF00122 L     @12,SDWAPTR                                         0125 00134000
         CLC   SDWACMPC(3,@12),O82                                 0125 00135000
         BE    @RT00125                                            0125 00136000
*     GOTO RECRSION;                /* DO NOT RETRY ABENDS           */ 00137000
*RECRS1:                                                           0127 00138000
*   SDWASALL='1'B;                  /* INDICATE TO FREE LOCKS        */ 00139000
RECRS1   L     @12,SDWAPTR                                         0127 00140000
         OI    SDWASALL(@12),B'00000100'                           0127 00141000
*RECRSION:                                                         0128 00142000
*   IF SDWAPCHK='1'B THEN           /* IF PGM CHECK, SET UP TO ISSUE    00143000
*                                      SDUMP                         */ 00144000
RECRSION L     @12,SDWAPTR                                         0128 00145000
         TM    SDWAPCHK(@12),B'01000000'                           0128 00146000
         BNO   @RF00128                                            0128 00147000
*     DO;                                                          0129 00148000
*       GPR13F=ADDR(SAVEAR);                                       0130 00149000
         L     GPR13F,LDAPTR                                       0130 00150000
         LA    GPR13F,SAVEAR(,GPR13F)                              0130 00151000
*       GPR15F=PSAAOLD;                                            0131 00152000
         L     GPR15F,PSAAOLD                                      0131 00153000
*       GPR01F=ADDR(LFSDUMP2);                                     0132 00154000
         LA    GPR01F,LFSDUMP2                                     0132 00155000
*       LFSDUMP2=LFSDUMP;                                          0133 00156000
         MVC   LFSDUMP2(24),LFSDUMP                                0133 00157000
*       GENERATE;                                                  0134 00158000
  SDUMP  ASID=ASCBASID(15),SDATA=(PSA,NUC,LSQA),BRANCH=YES,MF=(E,(1))   00159000
*     END;                                                         0135 00160000
*   TCBPQE=ZERO;                    /* CLEAN UP                      */ 00161000
@RF00128 L     @12,ZERO                                            0136 00162000
         ST    @12,TCBPQE(,TCBPTR)                                 0136 00163000
*   TCBMSS=ZERO;                    /* ZERO SUBPOOLS PTR             */ 00164000
         ST    @12,TCBMSS(,TCBPTR)                                 0137 00165000
*   SDWARCDE=SDWACWT;               /* DO NOT RETRY                  */ 00166000
         L     @12,SDWAPTR                                         0138 00167000
         MVI   SDWARCDE(@12),X'00'                                 0138 00168000
*RET:                               /*                       @ZA01896*/ 00169000
*   WORKREG=WRKPTR;                 /* RETURN PROCESSING. RESTORE FRR   00170000
*                                      WORKAREA POINTER.     @ZA01896*/ 00171000
RET      L     WORKREG,WRKPTR                                      0139 00172000
*   RFY                                                            0140 00173000
*     FRRSAVE BASED(WORKREG);       /*                       @ZA01896*/ 00174000
*   GENERATE REFS(SCVTRMBR,SCVTSECT,PSAAOLD,PSATOLD);              0141 00175000
   L    @00,@SIZDATD                                                    00176000
   L    @04,PSATOLD                                                     00177000
   L    @05,SDWAPTR                    RESTORE SDWA POINTER             00178000
   L    @07,PSAAOLD                                                     00179000
   L    @02,R14SAVE                     RETURN ADDRESS                  00180000
   FREEMAIN  RC,LV=(0),A=(REG8),SP=255,BRANCH=YES  FREE DYNAMIC STG     00181000
*   GPR01F=RDATASAV;                /* RESTORE REG 1                 */ 00182000
         LR    GPR01F,RDATASAV                                     0142 00183000
*   RRETURN=GPR02F;                                                0143 00184000
*                                                                  0143 00185000
         LR    RRETURN,GPR02F                                      0143 00186000
*/********************************************************************/ 00187000
*/*                                                                  */ 00188000
*/*  RESTORE LDA FIELDS SAVED PREVIOUSLY.                            */ 00189000
*/*                                                                  */ 00190000
*/********************************************************************/ 00191000
*                                                                  0144 00192000
*   GPR03F=GPR01F->SDWAPARM->LDAADD;/* GET LDA PTR           @ZA01896*/ 00193000
         L     @12,SDWAPARM(,GPR01F)                               0144 00194000
         L     GPR03F,LDAADD(,@12)                                 0144 00195000
*   RFY                                                            0145 00196000
*     LDA BASED(GPR03F);            /*                       @ZA01896*/ 00197000
*   BRANCHSV=SAVBRSV;               /*                       @ZA01896*/ 00198000
         MVC   BRANCHSV(64,GPR03F),SAVBRSV(WORKREG)                0146 00199000
*   LDATCB=SAVTCB;                  /*                       @ZA01896*/ 00200000
         L     @12,SAVTCB(,WORKREG)                                0147 00201000
         ST    @12,LDATCB(,GPR03F)                                 0147 00202000
*   LDARQSTA=SAVRQSTA;              /*                       @ZA01896*/ 00203000
         L     @12,SAVRQSTA(,WORKREG)                              0148 00204000
         ST    @12,LDARQSTA(,GPR03F)                               0148 00205000
*   LVSMFLAG=SAVFLAG;               /*                       @ZA01896*/ 00206000
         MVC   LVSMFLAG(4,GPR03F),SAVFLAG(WORKREG)                 0149 00207000
*   LDACBSP=SAVCBSP;                /*                       @ZA01896*/ 00208000
         IC    @12,SAVCBSP(,WORKREG)                               0150 00209000
         STC   @12,LDACBSP(,GPR03F)                                0150 00210000
*   RFY                                                            0151 00211000
*     LDA BASED(LDAPTR);            /*                       @ZA01896*/ 00212000
*RET1:                                                             0152 00213000
*   GENERATE;                                                      0152 00214000
*                                                                  0152 00215000
RET1     DS    0H                                                  0152 00216000
*                                /* BRANCH HERE IF NO LDA @ZA01896*/    00217000
   BR    RRETURN                        RETURN                          00218000
*/********************************************************************/ 00219000
*/*                  RETRYABLE V=V FREEPART'S                        */ 00220000
*/*                       PROGRAM CHECKS, MACHINE CHECKS             */ 00221000
*/********************************************************************/ 00222000
*                                                                  0153 00223000
*RETRY:                                                            0153 00224000
*   IF VERREQ='1'B THEN             /* IF REQUEST WAS V=R,           */ 00225000
RETRY    L     @12,LDAPTR                                          0153 00226000
         TM    VERREQ(@12),B'00000010'                             0153 00227000
         BO    @RT00153                                            0153 00228000
*     GOTO FREERL;                  /* PROCEED TO V=R FP PROCESSING  */ 00229000
*/*                                                                  */ 00230000
*/********************************************************************/ 00231000
*/*     IF THIS IS A RETRYABLE V=V FREEPART, THEN IF REGION SPACE    */ 00232000
*/*       HAS NOT ALREADY BEEN FREED, RETRY AT BEGINNING OF ROUTINE  */ 00233000
*/********************************************************************/ 00234000
*                                                                  0155 00235000
*   IF ZPFLG='0'B THEN                                             0155 00236000
         L     @12,PARMBASE                                        0155 00237000
         TM    ZPFLG(@12),B'00000010'                              0155 00238000
         BZ    @RT00155                                            0155 00239000
*     GO TO GPRETSET;               /* GO SETUP FOR RETRY AT GPRETRY */ 00240000
*/********************************************************************/ 00241000
*/*     IF REGION SPACE ALREADY FREED, REENTER ROUTINE TO RESTORE    */ 00242000
*/*       ADDRESS SPACE CONTROL BLOCKS                               */ 00243000
*/********************************************************************/ 00244000
*                                                                  0157 00245000
*   ELSE                                                           0157 00246000
*     SDWARTYA=ADDR(ZEROPTRS);      /* RETRY ADDRESS                 */ 00247000
         L     @12,SDWAPTR                                         0157 00248000
         L     @11,@CV02262                                        0157 00249000
         ST    @11,SDWARTYA(,@12)                                  0157 00250000
*   SDWARCDE=SDWARETY;              /* INDICATE RETRY                */ 00251000
         MVI   SDWARCDE(@12),X'04'                                 0158 00252000
*   GOTO RET;                       /* RETURN PROCESSING             */ 00253000
         B     RET                                                 0159 00254000
*/*                                                                  */ 00255000
*/********************************************************************/ 00256000
*/*                         RETRYABLE V=R FREEPART'S                 */ 00257000
*/*     DETERMINE THE STEP OF THE FREEPART PROCESSING THAT CONTAINED */ 00258000
*/*     THE ERROR BY CHECKING FOOTPRINTS IN THE FRR PARAMETER AREA,  */ 00259000
*/*     AND RETRY AT BEGINNING OF THAT STEP. LOGICAL STEPS ARE       */ 00260000
*/*     (1)ADDING REGION SPACE BACK TO V=R STORAGE Q'S (2)ADDING     */ 00261000
*/*     REGION SPACE BACK TO RSM'S STORAGE Q'S (3)ADDING REGION SPACE*/ 00262000
*/*     BACK TO ADDRESS SPACE Q'S (4) ZERO APPROPRIATE TCB AND       */ 00263000
*/*     LDA FIELDS (5)CHECK FOR WAITING REQUESTS WHICH MIGHT         */ 00264000
*/*     BE HONORED (6)DEQUEUE A WAITING REQUEST FROM VRWAITQ.        */ 00265000
*/********************************************************************/ 00266000
*                                                                  0160 00267000
*FREERL:                                                           0160 00268000
*   IF VEQRDONE='1'B THEN                                          0160 00269000
FREERL   L     @12,PARMBASE                                        0160 00270000
         TM    VEQRDONE(@12),B'00010000'                           0160 00271000
         BNO   @RF00160                                            0160 00272000
*     IF RSMDONE='1'B THEN                                         0161 00273000
         TM    RSMDONE(@12),B'10000000'                            0161 00274000
         BNO   @RF00161                                            0161 00275000
*       IF ASDONE='1'B THEN                                        0162 00276000
         TM    ASDONE(@12),B'01000000'                             0162 00277000
         BNO   @RF00162                                            0162 00278000
*         IF ZPFLG='1'B THEN                                       0163 00279000
         TM    ZPFLG(@12),B'00000010'                              0163 00280000
         BNO   @RF00163                                            0163 00281000
*           IF FPFLG='1'B THEN                                     0164 00282000
         TM    FPFLG(@12),B'00000100'                              0164 00283000
         BNO   @RF00164                                            0164 00284000
*             IF DEQFLG='1'B THEN                                  0165 00285000
         TM    DEQFLG(@12),B'10000000'                             0165 00286000
         BNO   @RF00165                                            0165 00287000
*               SDWARTYA=ADDR(DEQUEUE);                            0166 00288000
         L     @12,@CV02263                                        0166 00289000
         L     @11,SDWAPTR                                         0166 00290000
         ST    @12,SDWARTYA(,@11)                                  0166 00291000
*             ELSE                                                 0167 00292000
*               DO;                                                0167 00293000
         B     @RC00165                                            0167 00294000
@RF00165 DS    0H                                                  0168 00295000
*                 SDWASR04=LDAADD;                                 0168 00296000
         L     @12,SDWAPTR                                         0168 00297000
         L     @11,PARMBASE                                        0168 00298000
         L     @11,LDAADD(,@11)                                    0168 00299000
         ST    @11,SDWASR04(,@12)                                  0168 00300000
*                 SDWASR14=ADDR(WORKAREA);                         0169 00301000
         L     @11,LDAPTR                                          0169 00302000
         LA    @11,WORKAREA(,@11)                                  0169 00303000
         ST    @11,SDWASR14(,@12)                                  0169 00304000
*                 SDWARTYA=ADDR(GPRETURN);                         0170 00305000
         L     @11,@CV02264                                        0170 00306000
         ST    @11,SDWARTYA(,@12)                                  0170 00307000
*               END;                                               0171 00308000
*           ELSE                                                   0172 00309000
*             SDWARTYA=ADDR(ZEROPTRS);                             0172 00310000
         B     @RC00164                                            0172 00311000
@RF00164 L     @12,@CV02262                                        0172 00312000
         L     @11,SDWAPTR                                         0172 00313000
         ST    @12,SDWARTYA(,@11)                                  0172 00314000
*         ELSE                                                     0173 00315000
*           DO;                                                    0173 00316000
         B     @RC00163                                            0173 00317000
@RF00163 DS    0H                                                  0174 00318000
*             SDWASR04=LDAADD;                                     0174 00319000
         L     @12,SDWAPTR                                         0174 00320000
         L     @11,PARMBASE                                        0174 00321000
         L     @11,LDAADD(,@11)                                    0174 00322000
         ST    @11,SDWASR04(,@12)                                  0174 00323000
*             SDWASR08=LDATCB;                                     0175 00324000
         L     @11,LDAPTR                                          0175 00325000
         L     @05,LDATCB(,@11)                                    0175 00326000
         ST    @05,SDWASR08(,@12)                                  0175 00327000
*             SDWASR07=VRPQEP;                                     0176 00328000
         L     @05,GDAPTR                                          0176 00329000
         L     @05,VRPQEP(,@05)                                    0176 00330000
         ST    @05,SDWASR07(,@12)                                  0176 00331000
*             SDWASR14=ADDR(WORKAREA);                             0177 00332000
         LA    @11,WORKAREA(,@11)                                  0177 00333000
         ST    @11,SDWASR14(,@12)                                  0177 00334000
*             SDWARTYA=ADDR(ZEROPTRS);                             0178 00335000
         L     @11,@CV02262                                        0178 00336000
         ST    @11,SDWARTYA(,@12)                                  0178 00337000
*           END;                                                   0179 00338000
*       ELSE                                                       0180 00339000
*         SDWARTYA=ADDR(FREEASQ);                                  0180 00340000
         B     @RC00162                                            0180 00341000
@RF00162 L     @12,@CV02261                                        0180 00342000
         L     @11,SDWAPTR                                         0180 00343000
         ST    @12,SDWARTYA(,@11)                                  0180 00344000
*     ELSE                                                         0181 00345000
*       SDWARTYA=ADDR(FREERSM);                                    0181 00346000
         B     @RC00161                                            0181 00347000
@RF00161 L     @12,@CV02260                                        0181 00348000
         L     @11,SDWAPTR                                         0181 00349000
         ST    @12,SDWARTYA(,@11)                                  0181 00350000
*   ELSE                                                           0182 00351000
*     IF DEQFLG='1'B THEN           /* IF DEQUEUE IN PROCESS FOR   0182 00352000
*                                      ELEMENT ON VRWAITQ OR VRPOSTQ,   00353000
*                                      RETRY AT DEQUEUE STEP         */ 00354000
         B     @RC00160                                            0182 00355000
@RF00160 L     @12,PARMBASE                                        0182 00356000
         TM    DEQFLG(@12),B'10000000'                             0182 00357000
         BNO   @RF00182                                            0182 00358000
*       SDWARTYA=ADDR(DEQUEUE);                                    0183 00359000
         L     @12,@CV02263                                        0183 00360000
         L     @11,SDWAPTR                                         0183 00361000
         ST    @12,SDWARTYA(,@11)                                  0183 00362000
*     ELSE                                                         0184 00363000
*       GO TO GPRETSET;             /* GO SETUP FOR RETRY AT GPRETRY */ 00364000
*   SDWARCDE=SDWARETY;              /* INDICATE RETRY                */ 00365000
@RC00160 L     @12,SDWAPTR                                         0185 00366000
         MVI   SDWARCDE(@12),X'04'                                 0185 00367000
*   GOTO RET;                       /* RETURN PROCESS                */ 00368000
         B     RET                                                 0186 00369000
*/*                                                                  */ 00370000
*/********************************************************************/ 00371000
*/*                     GETPART ERRORS                               */ 00372000
*/********************************************************************/ 00373000
*                                                                  0187 00374000
*GPFRR:                                                            0187 00375000
*   IF VERREQ='1'B THEN             /* IF REQUEST WAS V=R,           */ 00376000
GPFRR    L     @12,LDAPTR                                          0187 00377000
         TM    VERREQ(@12),B'00000010'                             0187 00378000
         BO    @RT00187                                            0187 00379000
*     GOTO GETRL;                   /* PROCEED TO V=R GP ACTION      */ 00380000
*   IF GPSSW='1'B THEN              /* IF SPECIFIC V=V GETPART     0189 00381000
*                                      REQUEST, READJUST ADDRESS   0189 00382000
*                                      SPACE CONTROL BLOCKS TO TIME 0*/ 00383000
         TM    GPSSW(@12),B'00001000'                              0189 00384000
         BNO   @RF00189                                            0189 00385000
*     DO;                                                          0190 00386000
*       TCBRV='0'B;                                                0191 00387000
         NI    TCBRV(TCBPTR),B'01111111'                           0191 00388000
*       VVREGSZ=ZERO;                                              0192 00389000
         L     @11,ZERO                                            0192 00390000
         ST    @11,VVREGSZ(,@12)                                   0192 00391000
*       PQESEPTR=LDASRPQE;                                         0193 00392000
         L     @11,LDASRPQE(,@12)                                  0193 00393000
         ST    @11,PQESEPTR                                        0193 00394000
*       SRSIZE=PQESIZE;                                            0194 00395000
         L     SRSIZE,PQESIZE(,@11)                                0194 00396000
*       PQESEPTR=ASDPQE;                                           0195 00397000
         L     @12,ASDPQE(,@12)                                    0195 00398000
         ST    @12,PQESEPTR                                        0195 00399000
*       PQESIZE=PASIZE-SRSIZE;                                     0196 00400000
         L     @11,GDAPTR                                          0196 00401000
         L     @07,PASIZE(,@11)                                    0196 00402000
         SLR   @07,SRSIZE                                          0196 00403000
         ST    @07,PQESIZE(,@12)                                   0196 00404000
*       PQEREGN=PASTRT+SRSIZE;                                     0197 00405000
         L     @11,PASTRT(,@11)                                    0197 00406000
         LR    @07,SRSIZE                                          0197 00407000
         ALR   @07,@11                                             0197 00408000
         ST    @07,PQEREGN(,@12)                                   0197 00409000
*       FBQESPTR=PQEFFBQE;                                         0198 00410000
         L     FBQESPTR,PQEFFBQE(,@12)                             0198 00411000
*       SIZE=FBQAREA-PASTRT-SRSIZE+SIZE;                           0199 00412000
         LCR   @11,@11                                             0199 00413000
         AL    @11,FBQAREA(,FBQESPTR)                              0199 00414000
         SLR   @11,SRSIZE                                          0199 00415000
         AL    @11,SIZE(,FBQESPTR)                                 0199 00416000
         ST    @11,SIZE(,FBQESPTR)                                 0199 00417000
*       FBQAREA=PASTRT+SRSIZE;                                     0200 00418000
         ST    @07,FBQAREA(,FBQESPTR)                              0200 00419000
*     END;                                                         0201 00420000
*   IF RECURSE='1'B|SDWAPERC='1'B THEN/* ENTERED FOR RECURSION?      */ 00421000
@RF00189 L     @12,PARMBASE                                        0202 00422000
         TM    RECURSE(@12),B'00001000'                            0202 00423000
         BO    @RT00202                                            0202 00424000
         L     @12,SDWAPTR                                         0202 00425000
         TM    SDWAPERC(@12),B'00010000'                           0202 00426000
         BO    @RT00202                                            0202 00427000
*     GOTO RECRSION;                /* HANDLE RECURSION ENTRY        */ 00428000
*   IF SDWAPCHK='0'B&SDWAMCHK='0'B THEN/* IF NOT A PGM CHK AND NOT A    00429000
*                                      MACHINE CHK                   */ 00430000
         TM    SDWAPCHK(@12),B'11000000'                           0204 00431000
         BZ    @RT00204                                            0204 00432000
*     GOTO RECRSION;                /* ERROR NOT RETRYABLE           */ 00433000
*   TCBPQE=ZERO;                    /* IF RETRYABLE, RESTORE ORIGINAL   00434000
*                                      ENVIRONMENT AND RETRY AT    0206 00435000
*                                      BEGINNING                     */ 00436000
@RF00204 L     @12,ZERO                                            0206 00437000
         ST    @12,TCBPQE(,TCBPTR)                                 0206 00438000
*   RECURSE='1'B;                   /* SET FLAG TO STOP RECURSIONS   */ 00439000
*                                                                  0207 00440000
         L     @12,PARMBASE                                        0207 00441000
         OI    RECURSE(@12),B'00001000'                            0207 00442000
*   /*****************************************************************/ 00443000
*   /*                                                               */ 00444000
*   /* SETUP TO RETRY AT LOCATION GPRETRY IN IEAVPRT0                */ 00445000
*   /*                                                               */ 00446000
*   /*****************************************************************/ 00447000
*                                                                  0208 00448000
*GPRETSET:                                                         0208 00449000
*   SDWASR04=LDAADD;                /* GET ADDRESS OF LDA     YM07262*/ 00450000
GPRETSET L     @12,SDWAPTR                                         0208 00451000
         L     @11,PARMBASE                                        0208 00452000
         L     @05,LDAADD(,@11)                                    0208 00453000
         ST    @05,SDWASR04(,@12)                                  0208 00454000
*   SDWASR09=PRT0BASE;              /* GET R9 FOR GPRETRY     YM07262*/ 00455000
         L     @11,PRT0BASE(,@11)                                  0209 00456000
         ST    @11,SDWASR09(,@12)                                  0209 00457000
*   SDWASR14=ADDR(WORKAREA);        /* GET WORK AREA ADDRESS  YM07262*/ 00458000
         L     @11,LDAPTR                                          0210 00459000
         LA    @11,WORKAREA(,@11)                                  0210 00460000
         ST    @11,SDWASR14(,@12)                                  0210 00461000
*   SDWASR13=SDWASR04->GMBASE2;     /* GET GETMAINS R13       YM07262*/ 00462000
         L     @11,GMBASE2(,@05)                                   0211 00463000
         ST    @11,SDWASR13(,@12)                                  0211 00464000
*   SDWASR01=SDWASR04->SAVE1FRR;    /* GET R1 AS IT WAS ON INPUT TO     00465000
*                                      GETPART                YM07262*/ 00466000
         L     @05,SAVE1FRR(,@05)                                  0212 00467000
         ST    @05,SDWASR01(,@12)                                  0212 00468000
*   SDWASR08=SDWASR13-4096;         /* ADJUST TO OTHER BASE REG    0213 00469000
*                                                             YM07262*/ 00470000
         SL    @11,@CF02438                                        0213 00471000
         ST    @11,SDWASR08(,@12)                                  0213 00472000
*   SDWASR03=CVTPTR;                /* GET R3 FOR RETRY       YM07262*/ 00473000
         L     @11,CVTPTR                                          0214 00474000
         ST    @11,SDWASR03(,@12)                                  0214 00475000
*   SDWARTYA=ADDR(GPRETRY);         /* ADDRESS TO RETRY AT    YM07262*/ 00476000
         L     @11,@CV02271                                        0215 00477000
         ST    @11,SDWARTYA(,@12)                                  0215 00478000
*   SDWARCDE=SDWARETY;              /* INDICATE RETRY                */ 00479000
         MVI   SDWARCDE(@12),X'04'                                 0216 00480000
*   GOTO RET;                       /* RETURN PROCESSING             */ 00481000
         B     RET                                                 0217 00482000
*/*                                                                  */ 00483000
*/********************************************************************/ 00484000
*/*                        V=R GETPART RETRYABLE ERRORS              */ 00485000
*/*    FOR RETRYABLE ERRORS, DETERMINE STEP THAT ALLOCATION STOPPED  */ 00486000
*/*    AT, CLEAN UP PARTIAL PROCESSING OF THE ERROR STEP, AND RETRY  */ 00487000
*/*    AT THAT STEP. THE LOGICAL STEPS ARE (1)ELEMENT IN PROCESS     */ 00488000
*/*    OF BEING ENQUEUED ON VRWAITQ, (2)REGION ALLOCATION PERFORMED  */ 00489000
*/*    FROM RSM QUEUES, (3)REGION SPACE SUBTRACTED FROM ADDRESS      */ 00490000
*/*    SPACE QUEUES, (4)REGION SPACE SUBTRACTED FROM V=R QUEUES,     */ 00491000
*/*    (5)FBQE, DPQE, PQE BUILT FOR V=R REGION, (6)CHECK MADE FOR    */ 00492000
*/*    WAITING V=R REQUESTS WHICH MIGHT NOW BE HONORED, (7)DEQUEUE OF*/ 00493000
*/*    ELEMENT FROM VRWAITQ IN PROCESS.                              */ 00494000
*/********************************************************************/ 00495000
*                                                                  0218 00496000
*GETRL:                                                            0218 00497000
*   IF SDWAMCHK='1'B|SDWAPCHK='1'B THEN/* ONLY RETRY PGM CHKS OR   0218 00498000
*                                      MACHINE CHKS                  */ 00499000
GETRL    L     @12,SDWAPTR                                         0218 00500000
         TM    SDWAMCHK(@12),B'11000000'                           0218 00501000
         BZ    @RF00218                                            0218 00502000
*     DO;                                                          0219 00503000
*       IF RECURSE='1'B|SDWAPERC='1'B THEN/* IF RECURSION, CAN'T ETRY   00504000
*                                      AND IF PERCOLATION, DON'T   0220 00505000
*                                      RETRY                         */ 00506000
         L     @11,PARMBASE                                        0220 00507000
         TM    RECURSE(@11),B'00001000'                            0220 00508000
         BO    @RT00220                                            0220 00509000
         TM    SDWAPERC(@12),B'00010000'                           0220 00510000
         BNO   @RF00220                                            0220 00511000
@RT00220 DS    0H                                                  0221 00512000
*         DO;                                                      0221 00513000
*           IF SDWAPCHK='1'B THEN   /* ISSUE SDUMP FOR PGM CHECKS  0222 00514000
*                                      THAT ARE NOT SUCCESSFULLY   0222 00515000
*                                      RETRIED                       */ 00516000
         L     @12,SDWAPTR                                         0222 00517000
         TM    SDWAPCHK(@12),B'01000000'                           0222 00518000
         BNO   @RF00222                                            0222 00519000
*             DO;                                                  0223 00520000
*               GPR13F=ADDR(SAVEAR);                               0224 00521000
         L     GPR13F,LDAPTR                                       0224 00522000
         LA    GPR13F,SAVEAR(,GPR13F)                              0224 00523000
*               GPR15F=PSAAOLD;                                    0225 00524000
         L     GPR15F,PSAAOLD                                      0225 00525000
*               GPR01F=ADDR(LFSDUMP2);                             0226 00526000
         LA    GPR01F,LFSDUMP2                                     0226 00527000
*               LFSDUMP2=LFSDUMP;                                  0227 00528000
         MVC   LFSDUMP2(24),LFSDUMP                                0227 00529000
*               GENERATE;                                          0228 00530000
  SDUMP  ASID=ASCBASID(15),SDATA=(PSA,NUC,LSQA,SQA),BRANCH=YES,       **00531000
               MF=(E,(1))                                               00532000
*             END;                                                 0229 00533000
*           GOTO OTHRERRS;          /* GO CLEAN UP ADDRESS SPACE     */ 00534000
         B     OTHRERRS                                            0230 00535000
*         END;                                                     0231 00536000
*       RECURSE='1'B;                                              0232 00537000
@RF00220 L     @12,PARMBASE                                        0232 00538000
         OI    RECURSE(@12),B'00001000'                            0232 00539000
*       IF WENQFLG='1'B THEN        /* PROCESSING WAS INTERRUPTED  0233 00540000
*                                      WHILE ENQUEUING AN ELEMENT ON    00541000
*                                      VRWAITQ                       */ 00542000
         TM    WENQFLG(@12),B'01000000'                            0233 00543000
         BNO   @RF00233                                            0233 00544000
*         DO;                                                      0234 00545000
*           SDWARCDE=SDWARETY;                                     0235 00546000
         L     @12,SDWAPTR                                         0235 00547000
         MVI   SDWARCDE(@12),X'04'                                 0235 00548000
*WENQFIX:                                                          0236 00549000
*           ELBASE=SDWASR01;        /* REG 1 CONTAINS PTR TO ELEMENT    00550000
*                                      THAT WAS BEING ENQUEUED       */ 00551000
WENQFIX  L     @12,SDWAPTR                                         0236 00552000
         L     ELBASE,SDWASR01(,@12)                               0236 00553000
*FIX:                                                              0237 00554000
*           IF VRWFEL=ELBASE THEN   /* IF ELEMENT 1ST ON QUEUE,      */ 00555000
FIX      L     @12,GDAPTR                                          0237 00556000
         C     ELBASE,VRWFEL(,@12)                                 0237 00557000
         BNE   @RF00237                                            0237 00558000
*             DO;                                                  0238 00559000
*               IF ELBASE->WPNEXTEL¬=ZERO THEN/* AND NOT ONLY      0239 00560000
*                                      ELEMENT,                      */ 00561000
         L     @12,WPNEXTEL(,ELBASE)                               0239 00562000
         C     @12,ZERO                                            0239 00563000
         BE    @RF00239                                            0239 00564000
*                 DO;               /* CHAIN IT PROPERLY             */ 00565000
*                   WPQLPTR=ELBASE->WPNEXTEL;                      0241 00566000
         LR    WPQLPTR,@12                                         0241 00567000
*                   WPPREVEL=ELBASE;                               0242 00568000
         ST    ELBASE,WPPREVEL(,WPQLPTR)                           0242 00569000
*                   GOTO UNLRET;    /* DETERMINE RETRY               */ 00570000
         B     UNLRET                                              0243 00571000
*                 END;                                             0244 00572000
*               ELSE                /* IF IT IS ONLY EL ON Q, CHAIN     00573000
*                                      IT AS LAST EL                 */ 00574000
*                 VRWLEL=ELBASE;                                   0245 00575000
@RF00239 L     @12,GDAPTR                                          0245 00576000
         ST    ELBASE,VRWLEL(,@12)                                 0245 00577000
*UNLRET:                                                           0246 00578000
*               IF SDWARCDE¬=SDWARETY THEN/* IF WENQFIX WAS ENTERED     00579000
*                                      FROM OTHRERRS FOR CLEAN-UP, DO   00580000
*                                      NOT RETRY                     */ 00581000
UNLRET   L     @12,SDWAPTR                                         0246 00582000
         CLI   SDWARCDE(@12),4                                     0246 00583000
         BNE   @RT00246                                            0246 00584000
*                 GOTO RET;         /* RETURN                        */ 00585000
*               SDWARTYA=ADDR(UNL); /* RETRY AT UNL                  */ 00586000
         L     @11,@CV02269                                        0248 00587000
         ST    @11,SDWARTYA(,@12)                                  0248 00588000
*               GOTO RET;           /* GO RETRY                      */ 00589000
         B     RET                                                 0249 00590000
*             END;                                                 0250 00591000
*           ELSE                    /* SEARCH QUEUE FOR ELEMENT AT 0251 00592000
*                                      ELBASE                        */ 00593000
*             DO;                                                  0251 00594000
@RF00237 DS    0H                                                  0252 00595000
*               WPQLPTR=VRWFEL;                                    0252 00596000
         L     @12,GDAPTR                                          0252 00597000
         L     WPQLPTR,VRWFEL(,@12)                                0252 00598000
*ZEROCHK:                                                          0253 00599000
*               IF WPQLPTR=ZERO THEN/* IS THIS LAST EL?              */ 00600000
ZEROCHK  L     @12,ZERO                                            0253 00601000
         CR    WPQLPTR,@12                                         0253 00602000
         BE    @RT00253                                            0253 00603000
*                 GOTO LASTEL;      /* CHECK IT                      */ 00604000
*               IF WPNEXTEL=ELBASE THEN/* ELEMENT FOUND?             */ 00605000
         C     ELBASE,WPNEXTEL(,WPQLPTR)                           0255 00606000
         BNE   @RF00255                                            0255 00607000
*                 DO;                                              0256 00608000
*                   IF ELBASE->WPNEXTEL=ZERO THEN/* IF LAST EL ON  0257 00609000
*                                      QUEUE,                        */ 00610000
         C     @12,WPNEXTEL(,ELBASE)                               0257 00611000
         BNE   @RF00257                                            0257 00612000
*                     DO;           /* CHAIN AS LAST ELEMENT         */ 00613000
*                       VRWLEL=ELBASE;                             0259 00614000
         L     @12,GDAPTR                                          0259 00615000
         ST    ELBASE,VRWLEL(,@12)                                 0259 00616000
*                       GOTO UNLRET;/* DETERMINE RETRY               */ 00617000
         B     UNLRET                                              0260 00618000
*                     END;                                         0261 00619000
*                   ELSE            /* IF IN MIDDLE OF QUEUE, CHAIN     00620000
*                                      PROPERLY                      */ 00621000
*                     DO;                                          0262 00622000
@RF00257 DS    0H                                                  0263 00623000
*                       WPQLPTR=ELBASE->WPNEXTEL;                  0263 00624000
         L     WPQLPTR,WPNEXTEL(,ELBASE)                           0263 00625000
*                       WPPREVEL=ELBASE;                           0264 00626000
         ST    ELBASE,WPPREVEL(,WPQLPTR)                           0264 00627000
*                       GOTO UNLRET;/* DETERMINE RETRY               */ 00628000
         B     UNLRET                                              0265 00629000
*                     END;                                         0266 00630000
*                 END;                                             0267 00631000
*               ELSE                /* ELEMENT NOT FOUND             */ 00632000
*                 DO;                                              0268 00633000
@RF00255 DS    0H                                                  0269 00634000
*                   WPQLPTR=WPNEXTEL;                              0269 00635000
         L     WPQLPTR,WPNEXTEL(,WPQLPTR)                          0269 00636000
*                   GOTO ZEROCHK;   /* KEEP SEARCHING                */ 00637000
         B     ZEROCHK                                             0270 00638000
*                 END;                                             0271 00639000
*             END;                                                 0272 00640000
*LASTEL:                                                           0273 00641000
*           IF VRWLEL=ELBASE THEN   /* IF ELEMENT IS LAST ON QUEUE,     00642000
*                                      CHAIN PROPERLY                */ 00643000
LASTEL   L     @12,GDAPTR                                          0273 00644000
         C     ELBASE,VRWLEL(,@12)                                 0273 00645000
         BNE   @RF00273                                            0273 00646000
*             DO;                                                  0274 00647000
*               IF ELBASE->WPPREVEL=ZERO THEN/* IF SO, ONLY EL ON  0275 00648000
*                                      QUEUE                         */ 00649000
         CLC   WPPREVEL(4,ELBASE),ZERO                             0275 00650000
         BNE   @RF00275                                            0275 00651000
*                 DO;                                              0276 00652000
*                   VRWFEL=ELBASE;                                 0277 00653000
         ST    ELBASE,VRWFEL(,@12)                                 0277 00654000
*                   GOTO UNLRET;    /* DETERMINE RETRY               */ 00655000
         B     UNLRET                                              0278 00656000
*                 END;                                             0279 00657000
*               ELSE                /* NOT ONLY EL ON Q              */ 00658000
*                 DO;                                              0280 00659000
@RF00275 DS    0H                                                  0281 00660000
*                   WPQLPTR=ELBASE->WPPREVEL;                      0281 00661000
         L     WPQLPTR,WPPREVEL(,ELBASE)                           0281 00662000
*                   WPNEXTEL=ELBASE;                               0282 00663000
         ST    ELBASE,WPNEXTEL(,WPQLPTR)                           0282 00664000
*                   GOTO UNLRET;    /* DETERMINE RETRY               */ 00665000
         B     UNLRET                                              0283 00666000
*                 END;                                             0284 00667000
*             END;                                                 0285 00668000
*                                                                  0285 00669000
*/********************************************************************/ 00670000
*/*    IF CHAINING HAD NOT BEGUN FOR ELEMENT, RETRY                  */ 00671000
*/*    AT LABEL ELBUILD                                              */ 00672000
*/********************************************************************/ 00673000
*                                                                  0286 00674000
*           IF SDWARCDE=SDWARETY THEN                              0286 00675000
@RF00273 L     @12,SDWAPTR                                         0286 00676000
         CLI   SDWARCDE(@12),4                                     0286 00677000
         BNE   @RF00286                                            0286 00678000
*             SDWARTYA=ADDR(ELBUILD);                              0287 00679000
         L     @11,@CV02268                                        0287 00680000
         ST    @11,SDWARTYA(,@12)                                  0287 00681000
*           GOTO RET;               /* GO RETRY                      */ 00682000
         B     RET                                                 0288 00683000
*         END;                                                     0289 00684000
*                                                                  0289 00685000
*/*                                                                  */ 00686000
*/********************************************************************/ 00687000
*/*    DETERMINE STEP IN ERROR AND RETRY ADDRESS AS DESCRIBED ABOVE  */ 00688000
*/********************************************************************/ 00689000
*                                                                  0290 00690000
*       IF RSMDONE='1'B THEN                                       0290 00691000
@RF00233 L     @12,PARMBASE                                        0290 00692000
         TM    RSMDONE(@12),B'10000000'                            0290 00693000
         BNO   @RF00290                                            0290 00694000
*         IF ASDONE='1'B THEN                                      0291 00695000
         TM    ASDONE(@12),B'01000000'                             0291 00696000
         BNO   @RF00291                                            0291 00697000
*           IF VEQRDONE='1'B THEN                                  0292 00698000
         TM    VEQRDONE(@12),B'00010000'                           0292 00699000
         BNO   @RF00292                                            0292 00700000
*             IF CBGFLG='1'B THEN                                  0293 00701000
         TM    CBGFLG(@12),B'00100000'                             0293 00702000
         BNO   @RF00293                                            0293 00703000
*               IF FPFLG='1'B THEN                                 0294 00704000
         TM    FPFLG(@12),B'00000100'                              0294 00705000
         BNO   @RF00294                                            0294 00706000
*                 IF DEQFLG='1'B THEN                              0295 00707000
         TM    DEQFLG(@12),B'10000000'                             0295 00708000
         BNO   @RF00295                                            0295 00709000
*                   SDWARTYA=ADDR(DEQUEUE);                        0296 00710000
         L     @12,@CV02263                                        0296 00711000
         L     @11,SDWAPTR                                         0296 00712000
         ST    @12,SDWARTYA(,@11)                                  0296 00713000
*                 ELSE                                             0297 00714000
*                   DO;                                            0297 00715000
         B     @RC00295                                            0297 00716000
@RF00295 DS    0H                                                  0298 00717000
*                     SDWARTYA=ADDR(GPRETURN);                     0298 00718000
         L     @12,SDWAPTR                                         0298 00719000
         L     @11,@CV02264                                        0298 00720000
         ST    @11,SDWARTYA(,@12)                                  0298 00721000
*                     SDWASR04=LDAADD;                             0299 00722000
         L     @11,PARMBASE                                        0299 00723000
         L     @11,LDAADD(,@11)                                    0299 00724000
         ST    @11,SDWASR04(,@12)                                  0299 00725000
*                     SDWASR14=ADDR(WORKAREA);                     0300 00726000
         L     @11,LDAPTR                                          0300 00727000
         LA    @11,WORKAREA(,@11)                                  0300 00728000
         ST    @11,SDWASR14(,@12)                                  0300 00729000
*                   END;                                           0301 00730000
*               ELSE                                               0302 00731000
*                 SDWARTYA=ADDR(CBGETS);                           0302 00732000
         B     @RC00294                                            0302 00733000
@RF00294 L     @12,@CV02265                                        0302 00734000
         L     @11,SDWAPTR                                         0302 00735000
         ST    @12,SDWARTYA(,@11)                                  0302 00736000
*             ELSE                                                 0303 00737000
*               SDWARTYA=ADDR(CBGETS);                             0303 00738000
         B     @RC00293                                            0303 00739000
@RF00293 L     @12,@CV02265                                        0303 00740000
         L     @11,SDWAPTR                                         0303 00741000
         ST    @12,SDWARTYA(,@11)                                  0303 00742000
*           ELSE                                                   0304 00743000
*             DO;                                                  0304 00744000
         B     @RC00292                                            0304 00745000
@RF00292 DS    0H                                                  0305 00746000
*               PQESEPTR=VRPQEP;                                   0305 00747000
         L     @12,GDAPTR                                          0305 00748000
         L     @12,VRPQEP(,@12)                                    0305 00749000
         ST    @12,PQESEPTR                                        0305 00750000
*               CALL QREBUILD;      /* REBUILD QUEUES                */ 00751000
         BAL   @14,QREBUILD                                        0306 00752000
*               SDWARTYA=ADDR(ENDASQS);                            0307 00753000
         L     @12,@CV02266                                        0307 00754000
         L     @11,SDWAPTR                                         0307 00755000
         ST    @12,SDWARTYA(,@11)                                  0307 00756000
*             END;                                                 0308 00757000
*         ELSE                                                     0309 00758000
*           DO;                                                    0309 00759000
         B     @RC00291                                            0309 00760000
@RF00291 DS    0H                                                  0310 00761000
*             PQESEPTR=ASDPQE;                                     0310 00762000
         L     @12,LDAPTR                                          0310 00763000
         L     @12,ASDPQE(,@12)                                    0310 00764000
         ST    @12,PQESEPTR                                        0310 00765000
*             CALL QREBUILD;        /* REBUILD QUEUES                */ 00766000
         BAL   @14,QREBUILD                                        0311 00767000
*             SDWARTYA=ADDR(SUCVR);                                0312 00768000
         L     @12,@CV02267                                        0312 00769000
         L     @11,SDWAPTR                                         0312 00770000
         ST    @12,SDWARTYA(,@11)                                  0312 00771000
*           END;                                                   0313 00772000
*       ELSE                                                       0314 00773000
*         GO TO GPRETSET;           /* GO RETRY AT GPRETRY           */ 00774000
*       SDWARCDE=SDWARETY;                                         0315 00775000
@RC00290 L     @12,SDWAPTR                                         0315 00776000
         MVI   SDWARCDE(@12),X'04'                                 0315 00777000
*       GOTO RET;                   /* GO RETRY                      */ 00778000
         B     RET                                                 0316 00779000
*     END;                                                         0317 00780000
*                                                                  0317 00781000
*/*                                                                  */ 00782000
*/********************************************************************/ 00783000
*/*                       V=R GETPART UNRETRYABLE ERRORS             */ 00784000
*/*     CHECK IS MADE FOR THE STEP CONTAINING THE ERROR. CLEAN-UP    */ 00785000
*/*     OF THAT STEP AND ALL PREVIOUS STEPS IS PERFORMED IN ORDER    */ 00786000
*/*     TO PRESERVE THE VALIDITY OF THE STORAGE QUEUES. THE LOGICAL  */ 00787000
*/*     PROCESSING STEPS ARE THE SAME AS DESCRIBED AT GETRL.         */ 00788000
*/********************************************************************/ 00789000
*                                                                  0318 00790000
*OTHRERRS:                                                         0318 00791000
*   ;                                                              0318 00792000
@RF00218 DS    0H                                                  0318 00793000
OTHRERRS DS    0H                                                  0319 00794000
*   IF SDWACMPC=O82 THEN            /* IF ERROR IN SETLOCK,          */ 00795000
         L     @12,SDWAPTR                                         0319 00796000
         CLC   SDWACMPC(3,@12),O82                                 0319 00797000
         BNE   @RF00319                                            0319 00798000
*     SDWASALL='0'B;                /* DO NOT ATTEMPT TO FREE SALLOC */ 00799000
         NI    SDWASALL(@12),B'11111011'                           0320 00800000
*   ELSE                                                           0321 00801000
*     SDWASALL='1'B;                /* INDICATE TO FREE SALLOC LOCK  */ 00802000
         B     @RC00319                                            0321 00803000
@RF00319 L     @12,SDWAPTR                                         0321 00804000
         OI    SDWASALL(@12),B'00000100'                           0321 00805000
*   SDWARCDE=SDWACWT;               /* CONTINUE WITH TERMINATION     */ 00806000
@RC00319 L     @12,SDWAPTR                                         0322 00807000
         MVI   SDWARCDE(@12),X'00'                                 0322 00808000
*   IF SDWAPERC='1'B THEN           /* DO NOT CLEAN UP ON PERCOLATION   00809000
*                                      BECAUSE OF POSSIBLE FREEMAIN     00810000
*                                      LOOP                          */ 00811000
         TM    SDWAPERC(@12),B'00010000'                           0323 00812000
         BO    @RT00323                                            0323 00813000
*     GOTO RET;                     /* RETURN TO RTM                 */ 00814000
*   IF RSMDONE='1'B THEN                                           0325 00815000
         L     @12,PARMBASE                                        0325 00816000
         TM    RSMDONE(@12),B'10000000'                            0325 00817000
         BNO   @RF00325                                            0325 00818000
*     IF ASDONE='1'B THEN                                          0326 00819000
         TM    ASDONE(@12),B'01000000'                             0326 00820000
         BNO   @RF00326                                            0326 00821000
*       IF VEQRDONE='1'B THEN                                      0327 00822000
         TM    VEQRDONE(@12),B'00010000'                           0327 00823000
         BNO   @RF00327                                            0327 00824000
*         IF FPFLG='1'B THEN                                       0328 00825000
         TM    FPFLG(@12),B'00000100'                              0328 00826000
         BNO   @RF00328                                            0328 00827000
*           IF DEQFLG='1'B THEN                                    0329 00828000
         TM    DEQFLG(@12),B'10000000'                             0329 00829000
         BO    @RT00329                                            0329 00830000
*             GOTO RET;             /* RETURN TO RTM                 */ 00831000
*           ELSE                                                   0331 00832000
*             DO;                                                  0331 00833000
*L4:                                                               0332 00834000
*               ;                   /* THE FOLLOWING CODE CLEANS UP     00835000
*                                      ALL THAT AN UNSUCCESSFUL    0332 00836000
*                                      GETPART WOULD HAVE DONE       */ 00837000
L4       DS    0H                                                  0333 00838000
*               GENERATE;                                          0333 00839000
OBTS  SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVGPRR(RE**00840000
               LSS))                                                    00841000
*               SIZEREG=REGSIZE;                                   0334 00842000
         L     @12,PARMBASE                                        0334 00843000
         L     SIZEREG,REGSIZE(,@12)                               0334 00844000
*               SEGREG=REGADD;                                     0335 00845000
         L     SEGREG,REGADD(,@12)                                 0335 00846000
*               LDACBSP=245;                                       0336 00847000
         L     @12,LDAPTR                                          0336 00848000
         MVI   LDACBSP(@12),X'F5'                                  0336 00849000
*               PQEREG=VRPQEP;                                     0337 00850000
         L     @11,GDAPTR                                          0337 00851000
         L     PQEREG,VRPQEP(,@11)                                 0337 00852000
*               RGMBASE2=GMBASE2;   /* SAVE TCB @ BASE REG AND DATA     00853000
*                                      REG ACROSS MRELF              */ 00854000
         L     RGMBASE2,GMBASE2(,@12)                              0338 00855000
*               W1=TCBPTR;                                         0339 00856000
         ST    TCBPTR,W1(,@12)                                     0339 00857000
*               TCBPTR=LDAPTR;                                     0340 00858000
         LR    TCBPTR,@12                                          0340 00859000
*               W2=RBASE;                                          0341 00860000
         ST    RBASE,W2(,@12)                                      0341 00861000
*               RDATASAV=REG8;                                     0342 00862000
         LR    RDATASAV,REG8                                       0342 00863000
*               RGMBASE=GMBASE;                                    0343 00864000
         L     RGMBASE,GMBASE(,@12)                                0343 00865000
*               CALL MRELEASF;      /* RETURN V=R SPACE TO QUEUES VIA   00866000
*                                      FREEMAIN                      */ 00867000
         L     @15,@CV02272                                        0344 00868000
         BALR  @14,@15                                             0344 00869000
*               GENERATE;                                          0345 00870000
RELSS   SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VEQRS,IEAVGPRR(OBTS))      00871000
*               REG8=RDATASAV;                                     0346 00872000
         LR    REG8,RDATASAV                                       0346 00873000
*               RBASE=W2;                                          0347 00874000
         L     @12,LDAPTR                                          0347 00875000
         L     RBASE,W2(,@12)                                      0347 00876000
*               TCBPTR=W1;                                         0348 00877000
         L     TCBPTR,W1(,@12)                                     0348 00878000
*L5:                                                               0349 00879000
*               SIZEREG=REGSIZE;    /* THIS BLOCK RETURNS THE      0349 00880000
*                                      ALLOCATED SPACE TO THE ADDRESS   00881000
*                                      SPACE CONTROL BLOCKS          */ 00882000
L5       L     @12,PARMBASE                                        0349 00883000
         L     SIZEREG,REGSIZE(,@12)                               0349 00884000
*               SEGREG=REGADD;                                     0350 00885000
         L     SEGREG,REGADD(,@12)                                 0350 00886000
*               LDACBSP=255;                                       0351 00887000
         L     @12,LDAPTR                                          0351 00888000
         MVI   LDACBSP(@12),X'FF'                                  0351 00889000
*               PQEREG=ASDPQE;                                     0352 00890000
         L     PQEREG,ASDPQE(,@12)                                 0352 00891000
*               RGMBASE2=GMBASE2;   /* SAVE TCB @ BASE REG AND DATA     00892000
*                                      REG ACROSS MRELEASF           */ 00893000
         L     RGMBASE2,GMBASE2(,@12)                              0353 00894000
*               W1=TCBPTR;                                         0354 00895000
         ST    TCBPTR,W1(,@12)                                     0354 00896000
*               TCBPTR=LDAPTR;                                     0355 00897000
         LR    TCBPTR,@12                                          0355 00898000
*               W2=RBASE;                                          0356 00899000
         ST    RBASE,W2(,@12)                                      0356 00900000
*               RDATASAV=REG8;                                     0357 00901000
         LR    RDATASAV,REG8                                       0357 00902000
*               RGMBASE=GMBASE;                                    0358 00903000
         L     RGMBASE,GMBASE(,@12)                                0358 00904000
*               CALL MRELEASF;      /* RETURN SPACE TO ADDRESS SPACE    00905000
*                                      QUEUES VIA FREEMAIN           */ 00906000
         L     @15,@CV02272                                        0359 00907000
         BALR  @14,@15                                             0359 00908000
*               REG8=RDATASAV;                                     0360 00909000
         LR    REG8,RDATASAV                                       0360 00910000
*               RBASE=W2;                                          0361 00911000
         L     @12,LDAPTR                                          0361 00912000
         L     RBASE,W2(,@12)                                      0361 00913000
*               TCBPTR=W1;                                         0362 00914000
         L     TCBPTR,W1(,@12)                                     0362 00915000
*L6:                                                               0363 00916000
*               VRPARMS1=REGADD;    /* THIS BLOCK ALLOWS RSM A CHANCE   00917000
*                                      TO CLEAN UP THE ALLOCATED   0363 00918000
*                                      SPACE                         */ 00919000
L6       L     @12,PARMBASE                                        0363 00920000
         L     @11,REGADD(,@12)                                    0363 00921000
         ST    @11,VRPARMS1                                        0363 00922000
*               SIZEREG=REGSIZE;                                   0364 00923000
         L     SIZEREG,REGSIZE(,@12)                               0364 00924000
*               GENERATE;                                          0365 00925000
    SRL   SIZEREG,12                                                    00926000
*               VRPARMS2=SIZEREG;                                  0366 00927000
         ST    SIZEREG,VRPARMS2                                    0366 00928000
*               GPR01F=ADDR(VRPARMS);                              0367 00929000
         LA    GPR01F,VRPARMS                                      0367 00930000
*               GENERATE;                                          0368 00931000
OBTS2  SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVGPRR(**00932000
               RELSS2))                                                 00933000
*               GPR13F=ADDR(SAVEAR);                               0369 00934000
         L     GPR13F,LDAPTR                                       0369 00935000
         LA    GPR13F,SAVEAR(,GPR13F)                              0369 00936000
*               CALL IEAVEQRF;      /* GO TO RSM TO FREE UP V=R SPACE*/ 00937000
         L     @12,CVTPTR                                          0370 00938000
         L     @12,PVTPTR(,@12)                                    0370 00939000
         L     @15,PVTPVRLS(,@12)                                  0370 00940000
         BALR  @14,@15                                             0370 00941000
*               GENERATE;                                          0371 00942000
RELSS2  SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVGPRR(OBTS2))     00943000
*               TCBPQE=ZERO;                                       0372 00944000
         L     @12,ZERO                                            0372 00945000
         ST    @12,TCBPQE(,TCBPTR)                                 0372 00946000
*               GOTO RET;           /* RETURN PROCESSING             */ 00947000
         B     RET                                                 0373 00948000
*             END;                                                 0374 00949000
*         ELSE                                                     0375 00950000
*           GOTO L4;                /* CLEAN UP ADDRESS SPACE AND V=R   00951000
*                                      QUEUES                        */ 00952000
*       ELSE                                                       0376 00953000
*         DO;                                                      0376 00954000
@RF00327 DS    0H                                                  0377 00955000
*           PQESEPTR=VRPQEP;                                       0377 00956000
         L     @12,GDAPTR                                          0377 00957000
         L     @12,VRPQEP(,@12)                                    0377 00958000
         ST    @12,PQESEPTR                                        0377 00959000
*           CALL QREBUILD;          /* REBUILD QUEUES                */ 00960000
         BAL   @14,QREBUILD                                        0378 00961000
*           GOTO L5;                /* CLEAN UP ADDRESS SPACE QS     */ 00962000
         B     L5                                                  0379 00963000
*         END;                                                     0380 00964000
*     ELSE                                                         0381 00965000
*       DO;                                                        0381 00966000
@RF00326 DS    0H                                                  0382 00967000
*         PQESEPTR=ASDPQE;                                         0382 00968000
         L     @12,LDAPTR                                          0382 00969000
         L     @12,ASDPQE(,@12)                                    0382 00970000
         ST    @12,PQESEPTR                                        0382 00971000
*         CALL QREBUILD;            /* REBUILD QUEUES                */ 00972000
         BAL   @14,QREBUILD                                        0383 00973000
*         GOTO L6;                  /* GO TO RSM FOR CLEAN UP        */ 00974000
         B     L6                                                  0384 00975000
*       END;                                                       0385 00976000
*   ELSE                                                           0386 00977000
*     ;                             /* ESSENTIALLY NOTHING WAS     0386 00978000
*                                      DONE:NO CLEANUP               */ 00979000
@RF00325 DS    0H                                                  0387 00980000
*   IF WENQFLG='1'B THEN            /* IF AN ENQUEUE WAS IN PROCESS, */ 00981000
         L     @12,PARMBASE                                        0387 00982000
         TM    WENQFLG(@12),B'01000000'                            0387 00983000
         BNO   @RF00387                                            0387 00984000
*     IF RECURSE¬='1'B THEN         /* AND THIS NOT A RECURSION    0388 00985000
*                                      ENTRY,                        */ 00986000
         TM    RECURSE(@12),B'00001000'                            0388 00987000
         BO    @RF00388                                            0388 00988000
*       DO;                                                        0389 00989000
*         TCBPQE=ZERO;                                             0390 00990000
         L     @12,ZERO                                            0390 00991000
         ST    @12,TCBPQE(,TCBPTR)                                 0390 00992000
*         GOTO WENQFIX;             /* GO TO COMMON CLEANUP CODE     */ 00993000
         B     WENQFIX                                             0391 00994000
*       END;                                                       0392 00995000
*   TCBPQE=ZERO;                    /* THE NEXT LOGICAL            0393 00996000
*                                      INSTRUCTION--GOTORET--IS    0393 00997000
*                                      LOCATED AFTER THE QREBUILD  0393 00998000
*                                      PROC TO FIX A BUG IN THE PLS     00999000
*                                      COMPILER WHICH WON'T ALLOW AN    01000000
*                                      ENTRY STATEMENT TO FOLLOW AN     01001000
*                                      END OF AN INTERNAL PROC.      */ 01002000
@RF00388 DS    0H                                                  0393 01003000
@RF00387 L     @12,ZERO                                            0393 01004000
         ST    @12,TCBPQE(,TCBPTR)                                 0393 01005000
*                                                                  0394 01006000
*/*                                                                  */ 01007000
*/****************************************************************** */ 01008000
*/*        THIS ROUTINE UNDOES THE PROCESSING PERFORMED IN THE       */ 01009000
*/*        GETSPEC ROUTINE OF IEAVPRT0. IF THE ERROR OCCURED         */ 01010000
*/*        IN A STEP WHICH SUBTRACTS REGION SPACE FROM V=R OR V=V    */ 01011000
*/*        QUEUES, CLEAN-UP MUST BE PERFORMED BY THE FRR RATHER      */ 01012000
*/*        THAN BY A FREEMAIN INTERFACE. IF THE SPACE WAS NOT        */ 01013000
*/*        COMPLETELY OFF THE QUEUES WHEN THE ERROR OCCURED,         */ 01014000
*/*        A BRANCH TO FREEMAIN TO RESTORE THE SPACE COULD RESULT    */ 01015000
*/*        IN DUPLICATE SPACE ON THE FBQE QUEUES.                    */ 01016000
*/*        SOME SPACE MAY BE LOST FROM THE FBQE AS A RESULT OF THIS  */ 01017000
*/*        CLEAN-UP; HOWEVER QUEUING SHOULD REMAIN VALID AS LONG     */ 01018000
*/*        AS THE FRR ROUTINE DOES NOT FAIL.                         */ 01019000
*/****************************************************************** */ 01020000
*                                                                  0394 01021000
*QREBUILD:                                                         0394 01022000
*   PROC;                                                          0394 01023000
         B     @PB00002                                            0394 01024000
QREBUILD STM   @14,@12,@SA00002                                    0394 01025000
*   FBQESPTR=PQEFFBQE;                                             0395 01026000
         L     @12,PQESEPTR                                        0395 01027000
         L     FBQESPTR,PQEFFBQE(,@12)                             0395 01028000
*   FBQEBASE=RW1SAVE;               /* RW1SAVE CONTAINS THE @ OF THE    01029000
*                                      FBQE BEING WORKED UPON        */ 01030000
         L     @12,PARMBASE                                        0396 01031000
         L     FBQEBASE,RW1SAVE(,@12)                              0396 01032000
*   IF FBQEBASE=ZERO THEN           /* IF NO FBQE TO WORK ON,        */ 01033000
         C     FBQEBASE,ZERO                                       0397 01034000
         BE    @RT00397                                            0397 01035000
*     RETURN;                       /* RETURN TO CALLER              */ 01036000
*LOOP:                                                             0399 01037000
*   IF FBQESPTR=PQESEPTR THEN       /* IF THE FBQE NOT FOUND BY    0399 01038000
*                                      SEARCH,                       */ 01039000
LOOP     C     FBQESPTR,PQESEPTR                                   0399 01040000
         BE    @RT00399                                            0399 01041000
*     GOTO NEWFBQE;                 /* GO BUILD A NEW FBQE           */ 01042000
*   IF FBQESPTR¬=FBQEBASE THEN      /* IF THIS FBQE NOT THE ONE IN 0401 01043000
*                                      QUESTION,                     */ 01044000
         CR    FBQESPTR,FBQEBASE                                   0401 01045000
         BE    @RF00401                                            0401 01046000
*     DO;                                                          0402 01047000
*       FBQESPTR=FWDPTR;                                           0403 01048000
         L     FBQESPTR,FWDPTR(,FBQESPTR)                          0403 01049000
*       GOTO LOOP;                  /* KEEP SEARCHING THE FBQE CHAIN */ 01050000
         B     LOOP                                                0404 01051000
*     END;                                                         0405 01052000
*   FBQEEND=FBQAREA+SIZE;                                          0406 01053000
@RF00401 L     @12,FBQAREA(,FBQESPTR)                              0406 01054000
         LR    FBQEEND,@12                                         0406 01055000
         AL    FBQEEND,SIZE(,FBQESPTR)                             0406 01056000
*   REGEND=REGADD+REGSIZE;          /* END OF REG BEING ALLOCATED    */ 01057000
         L     @15,PARMBASE                                        0407 01058000
         L     @14,REGADD(,@15)                                    0407 01059000
         LR    REGEND,@14                                          0407 01060000
         AL    REGEND,REGSIZE(,@15)                                0407 01061000
*   IF FBQAREA=REGADD THEN          /* IF START @'S =                */ 01062000
         CR    @12,@14                                             0408 01063000
         BNE   @RF00408                                            0408 01064000
*     IF FBQEEND=REGEND THEN        /* AND END ADDRESSES =,          */ 01065000
         CR    FBQEEND,REGEND                                      0409 01066000
         BNE   @RF00409                                            0409 01067000
*       DO;                         /* CHAIN FBQE PROPERLY           */ 01068000
*         FBQESPTR=FBQEBASE->FWDPTR;                               0411 01069000
         L     FBQESPTR,FWDPTR(,FBQEBASE)                          0411 01070000
*         BCKPTR=FBQEBASE;                                         0412 01071000
         ST    FBQEBASE,BCKPTR(,FBQESPTR)                          0412 01072000
*         FBQESPTR=FBQEBASE->BCKPTR;                               0413 01073000
         L     FBQESPTR,BCKPTR(,FBQEBASE)                          0413 01074000
*         FWDPTR=FBQEBASE;                                         0414 01075000
         ST    FBQEBASE,FWDPTR(,FBQESPTR)                          0414 01076000
*         RETURN;                   /* RETURN TO CALLER              */ 01077000
@EL00002 DS    0H                                                  0415 01078000
@EF00002 DS    0H                                                  0415 01079000
@ER00002 LM    @14,@12,@SA00002                                    0415 01080000
         BR    @14                                                 0415 01081000
*       END;                                                       0416 01082000
*   IF REGADD<FBQAREA THEN          /* IF REG START < FREE AREA    0417 01083000
*                                      START,                        */ 01084000
@RF00409 DS    0H                                                  0417 01085000
@RF00408 L     @12,PARMBASE                                        0417 01086000
         L     @11,REGADD(,@12)                                    0417 01087000
         C     @11,FBQAREA(,FBQESPTR)                              0417 01088000
         BNL   @RF00417                                            0417 01089000
*     DO;                           /* ADD REG SIZE BACK IN TO BOTTOM   01090000
*                                      OF FBQE                       */ 01091000
*       FBQAREA=REGADD;                                            0419 01092000
         ST    @11,FBQAREA(,FBQESPTR)                              0419 01093000
*       SIZE=SIZE+REGSIZE;                                         0420 01094000
         L     @11,SIZE(,FBQESPTR)                                 0420 01095000
         AL    @11,REGSIZE(,@12)                                   0420 01096000
         ST    @11,SIZE(,FBQESPTR)                                 0420 01097000
*       RETURN;                     /* RETURN TO CALLER              */ 01098000
         B     @EL00002                                            0421 01099000
*     END;                                                         0422 01100000
*   IF REGADD>FBQEEND THEN          /* IF REG START > FREE AREA END, */ 01101000
@RF00417 L     @12,PARMBASE                                        0423 01102000
         C     FBQEEND,REGADD(,@12)                                0423 01103000
         BNL   @RF00423                                            0423 01104000
*     DO;                           /* ADD REG SIZE BACK INTO TOP OF    01105000
*                                      FBQE AND COMBINE WITH NEXT  0424 01106000
*                                      HIGHER FBQE IF CONTIGUOUS     */ 01107000
*       SIZE=SIZE+REGSIZE;                                         0425 01108000
         L     @11,SIZE(,FBQESPTR)                                 0425 01109000
         AL    @11,REGSIZE(,@12)                                   0425 01110000
         ST    @11,SIZE(,FBQESPTR)                                 0425 01111000
*       FBQEEND=FBQAREA+SIZE;                                      0426 01112000
         L     FBQEEND,FBQAREA(,FBQESPTR)                          0426 01113000
         ALR   FBQEEND,@11                                         0426 01114000
*       IF FBQEEND=FWDPTR->FBQAREA THEN/* ARE THE TWO CONTIGUOUS?  0427 01115000
*                                                            @ZA02394*/ 01116000
         L     @15,FWDPTR(,FBQESPTR)                               0427 01117000
         C     FBQEEND,FBQAREA(,@15)                               0427 01118000
         BNE   @RF00427                                            0427 01119000
*         DO;                       /* COMBINE AREAS AND REMOVE    0428 01120000
*                                      HIGHER CONTIGUOUS FBQE        */ 01121000
*           RW1SAVE=FWDPTR;         /* SAVE PTR TO NEXT FBQE         */ 01122000
         ST    @15,RW1SAVE(,@12)                                   0429 01123000
*           SIZE=SIZE+FWDPTR->SIZE; /* ADD AREA SIZES                */ 01124000
         AL    @11,SIZE(,@15)                                      0430 01125000
         ST    @11,SIZE(,FBQESPTR)                                 0430 01126000
*           FWDPTR=FWDPTR->DUMMYWRD;/* REMOVE HIGHER                 */ 01127000
         L     @12,DUMMYWRD(,@15)                                  0431 01128000
         ST    @12,FWDPTR(,FBQESPTR)                               0431 01129000
*           FWDPTR->BCKPTR=FBQEBASE;/* CONTIGUOUS FBQE               */ 01130000
         ST    FBQEBASE,BCKPTR(,@12)                               0432 01131000
*           RETURN;                 /* RETURN TO CALLER              */ 01132000
         B     @EL00002                                            0433 01133000
*         END;                                                     0434 01134000
*     END;                                                         0435 01135000
@RF00427 DS    0H                                                  0436 01136000
*   FWDPTR->BCKPTR=FBQEBASE;                                       0436 01137000
@RF00423 L     @12,FWDPTR(,FBQESPTR)                               0436 01138000
         ST    FBQEBASE,BCKPTR(,@12)                               0436 01139000
*   BCKPTR->DUMMYWRD=FBQEBASE;      /* RECHAIN FBQE CORRECTLY        */ 01140000
         L     @12,BCKPTR(,FBQESPTR)                               0437 01141000
         ST    FBQEBASE,DUMMYWRD(,@12)                             0437 01142000
*   RETURN;                                                        0438 01143000
*                                                                  0438 01144000
         B     @EL00002                                            0438 01145000
*/*                                                                  */ 01146000
*/********************************************************************/ 01147000
*/*     IF NOT FOUND, GET A NEW FBQE, PUT REGION SPACE IN IT,        */ 01148000
*/*     AND CHAIN IT PROPERLY ON FBQE CHAIN.                         */ 01149000
*/********************************************************************/ 01150000
*                                                                  0439 01151000
*   RESPECIFY                                                      0439 01152000
*    (GPR00F,                                                      0439 01153000
*     GPR01F,                                                      0439 01154000
*     GPR07F,                                                      0439 01155000
*     GPR14F,                                                      0439 01156000
*     GPR15F) RESTRICTED;                                          0439 01157000
*                                                                  0439 01158000
*/*                                  REGS USED BY GM         @Z30ENYG*/ 01159000
*                                                                  0440 01160000
*NEWFBQE:                                                          0440 01161000
*   IF ASDONE='1'B THEN                                            0440 01162000
NEWFBQE  L     @12,PARMBASE                                        0440 01163000
         TM    ASDONE(@12),B'01000000'                             0440 01164000
         BNO   @RF00440                                            0440 01165000
*     GPR15F=245;                   /* IF V=R FBQE, SP 245   @Z30ENYG*/ 01166000
         LA    GPR15F,245                                          0441 01167000
*   ELSE                                                           0442 01168000
*     GPR15F=255;                   /* IF A.S. FBQE, SP 255  @Z30ENYG*/ 01169000
         B     @RC00440                                            0442 01170000
@RF00440 LA    GPR15F,255                                          0442 01171000
*   GEN REFS(PASCBSV,LDAPTR);                                      0443 01172000
@RC00440 DS    0H                                                  0443 01173000
*                          /*@Z30ENYG*/                                 01174000
          L      RASCB,LDAPTR           ASCB ADDR IS IN LDA   @Z30ENYG  01175000
          L      RASCB,PASCBSV(RASCB)   ADDR ASCB FOR CELL GM @Z30ENYG  01176000
          GETMAIN P,BRANCH=YES,SP=(GPR15F) GM CELL FOR FBQE   @Z30ENYG  01177000
*   RESPECIFY                                                      0444 01178000
*    (GPR00F,                                                      0444 01179000
*     GPR01F,                                                      0444 01180000
*     GPR07F,                                                      0444 01181000
*     GPR14F,                                                      0444 01182000
*     GPR15F) UNRESTRICTED;                                        0444 01183000
*                                                                  0444 01184000
*/*                                                          @Z30ENYG*/ 01185000
*                                                                  0445 01186000
*   FBQESPTR=GPR01F;                                               0445 01187000
         LR    FBQESPTR,GPR01F                                     0445 01188000
*   SIZE=REGSIZE;                                                  0446 01189000
         L     @12,PARMBASE                                        0446 01190000
         L     @11,REGSIZE(,@12)                                   0446 01191000
         ST    @11,SIZE(,FBQESPTR)                                 0446 01192000
*   FBQAREA=REGADD;                                                0447 01193000
         L     @12,REGADD(,@12)                                    0447 01194000
         ST    @12,FBQAREA(,FBQESPTR)                              0447 01195000
*   FBQEBASE=FBQESPTR;                                             0448 01196000
         LR    FBQEBASE,FBQESPTR                                   0448 01197000
*   FBQESPTR=PQEFFBQE;                                             0449 01198000
         L     @12,PQESEPTR                                        0449 01199000
         L     FBQESPTR,PQEFFBQE(,@12)                             0449 01200000
*LOOP2:                                                            0450 01201000
*   IF FBQESPTR=PQESEPTR THEN       /* IS NEW FBQE ONLY ONE OR LAST     01202000
*                                      ONE ON CHAIN?                 */ 01203000
LOOP2    L     @12,PQESEPTR                                        0450 01204000
         CR    FBQESPTR,@12                                        0450 01205000
         BNE   @RF00450                                            0450 01206000
*     DO;                           /* CHAIN IT PROPERLY             */ 01207000
*       FBQEBASE->DUMMYWRD=PQESEPTR;                               0452 01208000
         ST    @12,DUMMYWRD(,FBQEBASE)                             0452 01209000
*       FBQEBASE->BCKPTR=PQESEPTR;                                 0453 01210000
         ST    @12,BCKPTR(,FBQEBASE)                               0453 01211000
*       PQEFFBQE=FBQEBASE;          /* CHAIN PQE TO FBQE     @Z30ENYG*/ 01212000
         ST    FBQEBASE,PQEFFBQE(,@12)                             0454 01213000
*       PQEBFBQE=FBQEBASE;          /*                       @Z30ENYG*/ 01214000
         ST    FBQEBASE,PQEBFBQE(,@12)                             0455 01215000
*       RETURN;                                                    0456 01216000
         B     @EL00002                                            0456 01217000
*     END;                                                         0457 01218000
*   IF FBQEBASE->FBQAREA<FBQAREA THEN/* CHAIN NEW FBQE IN ASCENDING     01219000
*                                      ORDER OF ADDRESS              */ 01220000
@RF00450 CLC   FBQAREA(4,FBQEBASE),FBQAREA(FBQESPTR)               0458 01221000
         BNL   @RF00458                                            0458 01222000
*     DO;                                                          0459 01223000
*       BCKPTR->DUMMYWRD=FBQEBASE;                                 0460 01224000
         L     @12,BCKPTR(,FBQESPTR)                               0460 01225000
         ST    FBQEBASE,DUMMYWRD(,@12)                             0460 01226000
*       FBQEBASE->DUMMYWRD=FBQESPTR;                               0461 01227000
         ST    FBQESPTR,DUMMYWRD(,FBQEBASE)                        0461 01228000
*       FBQEBASE->BCKPTR=BCKPTR;                                   0462 01229000
         ST    @12,BCKPTR(,FBQEBASE)                               0462 01230000
*       BCKPTR=FBQEBASE;                                           0463 01231000
         ST    FBQEBASE,BCKPTR(,FBQESPTR)                          0463 01232000
*       RETURN;                     /* RETURN TO CALLER              */ 01233000
         B     @EL00002                                            0464 01234000
*     END;                                                         0465 01235000
*   FBQESPTR=FWDPTR;                                               0466 01236000
@RF00458 L     FBQESPTR,FWDPTR(,FBQESPTR)                          0466 01237000
*   GOTO LOOP2;                     /* CHAIN FBQE IN PROPER POSITION */ 01238000
         B     LOOP2                                               0467 01239000
*   END QREBUILD;                                                  0468 01240000
         B     @EL00002                                            0468 01241000
*   GOTO RET;                       /* RETURN TO CALLER              */ 01242000
         B     RET                                                 0469 01243000
*/*                                                                  */ 01244000
*/********************************************************************/ 01245000
*/*     THIS IS THE ASYNCHRONOUS ERROR EXIT ROUTINE USED BY XMPOST   */ 01246000
*/*     FOR ERRORS DISCOVERED DURING POST PROCESSING. THE ROUTINE    */ 01247000
*/*     SCHEDULES A SRB TO ABEND THE INITIATOR THAT COULD NOT BE     */ 01248000
*/*     WITH AN ABEND CODE OF X'304'.                                */ 01249000
*/********************************************************************/ 01250000
*                                                                  0470 01251000
*PRT0ERTN:                                                         0470 01252000
*   ENTRY;                                                         0470 01253000
*   GENERATE REFS(CVTCRMN,CVTMAP,PSATOLD,PSAAOLD);                 0471 01254000
PRT0ERTN DS    0H                                                       01255000
   DROP  @08                                                            01256000
   USING *,@09                                                          01257000
   LR   @09,@15                                                         01258000
   B    ENTPT                       BRANCH AROUND ENTRY INSTRUCTION     01259000
   ENTRY PRT0ERTN                                                       01260000
*   RESPECIFY                                                      0472 01261000
*    (RDATASAV,                                                    0472 01262000
*     RETSAVE,                                                     0472 01263000
*     POSTASCB) RSTD;                                              0472 01264000
*ENTPT:                                                            0473 01265000
*   RETSAVE=RRETURN;                /* SAVE RETURN REG               */ 01266000
ENTPT    LR    RETSAVE,RRETURN                                     0473 01267000
*   POSTASCB=ASCBPTR;               /* SAVE ASCB ADDRESS             */ 01268000
         LR    POSTASCB,ASCBPTR                                    0474 01269000
*   R0=PVTSRBID;                    /* CELL POOL ID FOR SRB          */ 01270000
         L     @12,CVTPTR                                          0475 01271000
         L     @12,PVTPTR(,@12)                                    0475 01272000
         L     R0,PVTSRBID(,@12)                                   0475 01273000
*   GENERATE(GETCELL  CPID=(R0),BRANCH=YES,SAVE=NO);               0476 01274000
         GETCELL  CPID=(R0),BRANCH=YES,SAVE=NO                          01275000
*   IF RRETREG=0 THEN                                              0477 01276000
         LTR   RRETREG,RRETREG                                     0477 01277000
         BNZ   @RF00477                                            0477 01278000
*     DO;                                                          0478 01279000
*       SRBSECT='0'B;                                              0479 01280000
         XC    SRBSECT+1(43,SRBPTR),SRBSECT+1(SRBPTR)              0479 01281000
         MVI   SRBSECT(SRBPTR),B'00000000'                         0479 01282000
*       SRBID='SRB ';                                              0480 01283000
         MVC   SRBID(4,SRBPTR),@CC02475                            0480 01284000
*       SRBASCB=POSTASCB;                                          0481 01285000
         ST    POSTASCB,SRBASCB(,SRBPTR)                           0481 01286000
*       SRBEP=ADDR(IEAVGPRS);                                      0482 01287000
         L     @12,@CA02476                                        0482 01288000
         ST    @12,SRBEP(,SRBPTR)                                  0482 01289000
*       SRBPARM=POSTASCB;                                          0483 01290000
         ST    POSTASCB,SRBPARM(,SRBPTR)                           0483 01291000
*       SRBRMTR=PVTPSRBP;                                          0484 01292000
         L     @12,CVTPTR                                          0484 01293000
         L     @12,PVTPTR(,@12)                                    0484 01294000
         L     @12,PVTPSRBP(,@12)                                  0484 01295000
         ST    @12,SRBRMTR(,SRBPTR)                                0484 01296000
*       GEN(SCHEDULE  SRB=(SRBPTR),SCOPE=GLOBAL);                  0485 01297000
         SCHEDULE  SRB=(SRBPTR),SCOPE=GLOBAL                            01298000
*     END;                                                         0486 01299000
*   RRETURN=RETSAVE;                                               0487 01300000
@RF00477 LR    RRETURN,RETSAVE                                     0487 01301000
*   GOTO RRETURN;                                                  0488 01302000
         BR    RRETURN                                             0488 01303000
*                                                                  0489 01304000
*   /*****************************************************************/ 01305000
*   /*                                                               */ 01306000
*   /* THIS IS THE ENTRY POINT FOR IEAVGPRS, THE SRB SCHEDULED BY    */ 01307000
*   /* PRT0ERTN (XMPOST ASYNCHRONOUS ERROR ROUTINE) TO CAUSE THE     */ 01308000
*   /* INITIATOR WHICH COULD NOT BE POSTED TO BE ABENDED WITH ABEND  */ 01309000
*   /* CODE X'304'.                                                  */ 01310000
*   /*                                                               */ 01311000
*   /*****************************************************************/ 01312000
*                                                                  0489 01313000
*IEAVGPRS:                                                         0489 01314000
*   ENTRY;                                                         0489 01315000
*   GENERATE;                                                      0490 01316000
IEAVGPRS  DS    0H                                                      01317000
   DROP  @09                                                            01318000
 USING *,@09                                                            01319000
 LR     @09,@15                                                         01320000
 B     INITWAKE                                                         01321000
 ENTRY IEAVGPRS                                                         01322000
*INITWAKE:                                                         0491 01323000
*   POSTASCB=PARM;                                                 0491 01324000
INITWAKE LR    POSTASCB,PARM                                       0491 01325000
*   RETSAVE=RRETURN;                                               0492 01326000
         LR    RETSAVE,RRETURN                                     0492 01327000
*   SRBPTR=R0;                                                     0493 01328000
         LR    SRBPTR,R0                                           0493 01329000
*   R0=PVTSRBID;                                                   0494 01330000
         L     @12,CVTPTR                                          0494 01331000
         L     @12,PVTPTR(,@12)                                    0494 01332000
         L     R0,PVTSRBID(,@12)                                   0494 01333000
*   GEN(FREECELL  CPID=(R0),CELL=(SRBPTR),BRANCH=YES,SAVE=NO);     0495 01334000
         FREECELL  CPID=(R0),CELL=(SRBPTR),BRANCH=YES,SAVE=NO           01335000
*   GENERATE;                                                      0496 01336000
OBTL SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LDA,IEAVGPRR(REL))  01337000
      L     @00,@SIZDATD                 SIZE FOR GETMAIN               01338000
      ICM   @00,B'1000',XFF              SPACE FROM SUBPOOL 255         01339000
*   TCBPTR=POSTASCB->ASCBLDA->LDATCB;/* GET INITS TCB @              */ 01340000
         L     @12,ASCBLDA(,POSTASCB)                              0497 01341000
         L     TCBPTR,LDATCB(,@12)                                 0497 01342000
*   GENERATE REFS(CVTCRMN,CVTMAP);                                 0498 01343000
 GETMAIN  R,LV=(R0),BRANCH=YES                                          01344000
*   RDATASAV=PARM;                                                 0499 01345000
         LR    RDATASAV,PARM                                       0499 01346000
*   GEN(USING @DATD,@05);                                          0500 01347000
         USING @DATD,@05                                                01348000
*   SAVEREG=ADDR(SAV);                                             0501 01349000
         LA    SAVEREG,SAV                                         0501 01350000
*   GEN(CALLRTM TYPE=ABTERM,COMPCOD=X'304',TCB=(TCBPTR));          0502 01351000
         CALLRTM TYPE=ABTERM,COMPCOD=X'304',TCB=(TCBPTR)                01352000
*   GEN(L     @00,@SIZDATD);                                       0503 01353000
         L     @00,@SIZDATD                                             01354000
*   GEN(ICM   @00,B'1000',XFF);                                    0504 01355000
         ICM   @00,B'1000',XFF                                          01356000
*   GEN REFS(CVTCRMN,CVTMAP);                                      0505 01357000
 FREEMAIN  R,LV=(R0),A=(RDATASAV),BRANCH=YES                            01358000
REL   SETLOCK  RELEASE,TYPE=LOCAL,RELATED=(LDA,IEAVGPRR(OBTL))          01359000
*   RRETURN=RETSAVE;                                               0506 01360000
         LR    RRETURN,RETSAVE                                     0506 01361000
*   GOTO RRETURN;                                                  0507 01362000
         BR    RRETURN                                             0507 01363000
*   END IEAVGPRR                                                   0508 01364000
*                                                                  0508 01365000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01366000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01367000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01368000
*/*%INCLUDE SYSLIB  (IHAPQE  )                                       */ 01369000
*/*%INCLUDE SYSLIB  (IHAGDA  )                                       */ 01370000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01371000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 01372000
*/*%INCLUDE SYSLIB  (IHASDUMP)                                       */ 01373000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 01374000
*/*%INCLUDE SYSLIB  (IHAFBQE )                                       */ 01375000
*/*%INCLUDE SYSLIB  (FREEMAIN)                                       */ 01376000
*/*%INCLUDE SYSLIB  (GETMAIN )                                       */ 01377000
*/*%INCLUDE SYSLIB  (IHAWPQEL)                                       */ 01378000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 01379000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01380000
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */ 01381000
*/*%INCLUDE SYSLIB  (IHALDA  )                                       */ 01382000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 01383000
*                                                                  0508 01384000
*       ;                                                          0508 01385000
@DATA    DS    0H                                                       01386000
@DATD    DSECT                                                          01387000
         DS    0F                                                       01388000
@SA00002 DS    15F                                                      01389000
IEAVGPRR CSECT                                                          01390000
         DS    0F                                                       01391000
@CF02438 DC    F'4096'                                                  01392000
@CF02485 DC    XL4'0000FFFF'                                            01393000
@DATD    DSECT                                                          01394000
         DS    0D                                                       01395000
PQESEPTR DS    A                                                        01396000
GDAPTR   DS    A                                                        01397000
SDWAPTR  DS    A                                                        01398000
SDUMPPTR DS    A                                                        01399000
FRREPTR  DS    A                                                        01400000
SCVTSPTR DS    A                                                        01401000
LDAPTR   DS    A                                                        01402000
WRKPTR   DS    A                                                        01403000
PARMBASE DS    A                                                        01404000
DPQEPTR  DS    A                                                        01405000
R14      DS    A                                                        01406000
R14SAVE  DS    A                                                        01407000
LFSDUMP2 DS    CL24                                                     01408000
VRPARMS  DS    CL8                                                      01409000
         ORG   VRPARMS                                                  01410000
VRPARMS1 DS    AL4                                                      01411000
VRPARMS2 DS    AL4                                                      01412000
         ORG   VRPARMS+8                                                01413000
ASIDVAL  DS    CL4                                                      01414000
         ORG   ASIDVAL                                                  01415000
@NM00131 DS    CL2                                                      01416000
ID       DS    FL2                                                      01417000
         ORG   ASIDVAL+4                                                01418000
SAV      DS    CL72                                                     01419000
IEAVGPRR CSECT                                                          01420000
         DS    0F                                                       01421000
@SIZDATD DC    AL1(0)                                                   01422000
         DC    AL3(@ENDDATD-@DATD)                                      01423000
@CA02476 DC    A(IEAVGPRS)                                              01424000
@CV02260 DC    V(FREERSM)                                               01425000
@CV02261 DC    V(FREEASQ)                                               01426000
@CV02262 DC    V(ZEROPTRS)                                              01427000
@CV02263 DC    V(DEQUEUE)                                               01428000
@CV02264 DC    V(GPRETURN)                                              01429000
@CV02265 DC    V(CBGETS)                                                01430000
@CV02266 DC    V(ENDASQS)                                               01431000
@CV02267 DC    V(SUCVR)                                                 01432000
@CV02268 DC    V(ELBUILD)                                               01433000
@CV02269 DC    V(UNL)                                                   01434000
@CV02271 DC    V(GPRETRY)                                               01435000
@CV02272 DC    V(MRELEASF)                                              01436000
@CV02270 DC    V(FREEPART)                                              01437000
         DS    0D                                                       01438000
ZERO     DC    A(0)                                                     01439000
CLEAR    DC    F'0'                                                     01440000
SAME     DC    H'0'                                                     01441000
XFF      DC    AL1(255)                                                 01442000
@CC02475 DC    C'SRB '                                                  01443000
         DS    CL1                                                      01444000
ZEROES   DS    CL24                                                     01445000
         ORG   ZEROES                                                   01446000
@NM00122 DC    6F'0'                                                    01447000
         ORG   ZEROES+24                                                01448000
O82      DC    B'000010000010000000000000'                              01449000
MODN     DC    CL8'IEAVPRT0'                                            01450000
REXN     DC    CL8'IEAVGPRR'                                            01451000
IEAVGPRR CSECT                                                          01452000
LFSDUMP  SDUMP  HDR='PGM CHECK IN IEAVPRT0',MF=L                        01453000
@DATD    DSECT                                                          01454000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01455000
@ENDDATD EQU   *                                                        01456000
IEAVGPRR CSECT                                                          01457000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01458000
@01      EQU   01                                                       01459000
@02      EQU   02                                                       01460000
@03      EQU   03                                                       01461000
@04      EQU   04                                                       01462000
@05      EQU   05                                                       01463000
@06      EQU   06                                                       01464000
@07      EQU   07                                                       01465000
@08      EQU   08                                                       01466000
@09      EQU   09                                                       01467000
@10      EQU   10                                                       01468000
@11      EQU   11                                                       01469000
@12      EQU   12                                                       01470000
@13      EQU   13                                                       01471000
@14      EQU   14                                                       01472000
@15      EQU   15                                                       01473000
FBQEBASE EQU   @06                                                      01474000
FBQEEND  EQU   @07                                                      01475000
ELBASE   EQU   @05                                                      01476000
REGEND   EQU   @11                                                      01477000
SRSIZE   EQU   @06                                                      01478000
WPQLPTR  EQU   @06                                                      01479000
FBQESPTR EQU   @05                                                      01480000
TCBPTR   EQU   @04                                                      01481000
ASCBPTR  EQU   @01                                                      01482000
SRBPTR   EQU   @01                                                      01483000
GPR00F   EQU   @00                                                      01484000
GPR01F   EQU   @01                                                      01485000
GPR02F   EQU   @02                                                      01486000
GPR03F   EQU   @03                                                      01487000
GPR07F   EQU   @07                                                      01488000
GPR13F   EQU   @13                                                      01489000
GPR14F   EQU   @14                                                      01490000
GPR15F   EQU   @15                                                      01491000
REG8     EQU   @08                                                      01492000
RBASE    EQU   @10                                                      01493000
RDATASAV EQU   @05                                                      01494000
RGMBASE  EQU   @08                                                      01495000
RGMBASE2 EQU   @13                                                      01496000
RRETURN  EQU   @14                                                      01497000
RASCB    EQU   @07                                                      01498000
PQEREG   EQU   @07                                                      01499000
SIZEREG  EQU   @06                                                      01500000
SEGREG   EQU   @09                                                      01501000
WORKREG  EQU   @09                                                      01502000
R0       EQU   @00                                                      01503000
PARM     EQU   @01                                                      01504000
RETSAVE  EQU   @06                                                      01505000
POSTASCB EQU   @07                                                      01506000
RRETREG  EQU   @15                                                      01507000
SAVEREG  EQU   @13                                                      01508000
GPR04F   EQU   @04                                                      01509000
RCVT     EQU   @03                                                      01510000
CVTPTR   EQU   16                                                       01511000
PSA      EQU   0                                                        01512000
FLCRNPSW EQU   PSA                                                      01513000
FLCROPSW EQU   PSA+8                                                    01514000
FLCICCW2 EQU   PSA+16                                                   01515000
PSAEEPSW EQU   PSA+132                                                  01516000
PSAESPSW EQU   PSA+136                                                  01517000
FLCSVILC EQU   PSAESPSW+1                                               01518000
PSAEPPSW EQU   PSA+140                                                  01519000
FLCPIILC EQU   PSAEPPSW+1                                               01520000
FLCPICOD EQU   PSAEPPSW+2                                               01521000
PSAPICOD EQU   FLCPICOD+1                                               01522000
FLCTEA   EQU   PSAEPPSW+4                                               01523000
FLCPER   EQU   PSA+152                                                  01524000
FLCMCLA  EQU   PSA+168                                                  01525000
FLCIOEL  EQU   FLCMCLA+4                                                01526000
FLCIOA   EQU   FLCMCLA+16                                               01527000
FLCFSA   EQU   FLCMCLA+80                                               01528000
PSATOLD  EQU   PSA+540                                                  01529000
PSAAOLD  EQU   PSA+548                                                  01530000
PSASUPER EQU   PSA+552                                                  01531000
PSASUP1  EQU   PSASUPER                                                 01532000
PSASUP2  EQU   PSASUPER+1                                               01533000
PSASUP3  EQU   PSASUPER+2                                               01534000
PSASUP4  EQU   PSASUPER+3                                               01535000
PSACLHT  EQU   PSA+640                                                  01536000
PSALKSA  EQU   PSA+696                                                  01537000
PSAHLHI  EQU   PSA+760                                                  01538000
PSADSSFL EQU   PSA+836                                                  01539000
PSADSSF1 EQU   PSADSSFL                                                 01540000
PSADSSF3 EQU   PSADSSFL+2                                               01541000
PSADSSF4 EQU   PSADSSFL+3                                               01542000
PSARSVT  EQU   PSA+896                                                  01543000
TCBFIX   EQU   0                                                        01544000
TCBFRS   EQU   TCBFIX                                                   01545000
TCB      EQU   0                                                        01546000
TCBPIE   EQU   TCB+4                                                    01547000
TCBPMASK EQU   TCBPIE                                                   01548000
TCBCMP   EQU   TCB+16                                                   01549000
TCBCMPF  EQU   TCBCMP                                                   01550000
TCBCPP   EQU   TCBCMPF                                                  01551000
TCBSTCC  EQU   TCBCMPF                                                  01552000
TCBCDBL  EQU   TCBCMPF                                                  01553000
TCBCWTO  EQU   TCBCMPF                                                  01554000
TCBCIND  EQU   TCBCMPF                                                  01555000
TCBCMSG  EQU   TCBCMPF                                                  01556000
TCBTRN   EQU   TCB+20                                                   01557000
TCBABF   EQU   TCBTRN                                                   01558000
TCBMSS   EQU   TCB+24                                                   01559000
TCBPKF   EQU   TCB+28                                                   01560000
TCBFLGS  EQU   TCB+29                                                   01561000
TCBFLGS1 EQU   TCBFLGS                                                  01562000
TCBFLGS2 EQU   TCBFLGS+1                                                01563000
TCBFLGS3 EQU   TCBFLGS+2                                                01564000
TCBFLGS4 EQU   TCBFLGS+3                                                01565000
TCBFLGS5 EQU   TCBFLGS+4                                                01566000
TCBABWF  EQU   TCBFLGS5                                                 01567000
TCBJPQ   EQU   TCB+44                                                   01568000
TCBPURGE EQU   TCBJPQ                                                   01569000
TCBGRS   EQU   TCB+48                                                   01570000
TCBFSA   EQU   TCB+112                                                  01571000
TCBTME   EQU   TCB+120                                                  01572000
TCBJSTCB EQU   TCB+124                                                  01573000
TCBTSFLG EQU   TCB+148                                                  01574000
TCBTSTSK EQU   TCBTSFLG                                                 01575000
TCBPQE   EQU   TCB+152                                                  01576000
TCBSTAB  EQU   TCB+160                                                  01577000
TCBNSTAE EQU   TCBSTAB                                                  01578000
TCBTCT   EQU   TCB+164                                                  01579000
TCBTCTGF EQU   TCBTCT                                                   01580000
TCBSCNDY EQU   TCB+172                                                  01581000
TCBNDSP  EQU   TCBSCNDY                                                 01582000
TCBNDSP1 EQU   TCBNDSP+1                                                01583000
TCBNDSP2 EQU   TCBNDSP+2                                                01584000
TCBNDSP3 EQU   TCBNDSP+3                                                01585000
TCBJSCB  EQU   TCB+180                                                  01586000
TCBRECDE EQU   TCBJSCB                                                  01587000
TCBEXT1  EQU   TCB+196                                                  01588000
TCBBITS  EQU   TCB+200                                                  01589000
TCBNDSP4 EQU   TCBBITS                                                  01590000
TCBNDSP5 EQU   TCBBITS+1                                                01591000
TCBFLGS6 EQU   TCBBITS+2                                                01592000
TCBRV    EQU   TCBFLGS6                                                 01593000
TCBFLGS7 EQU   TCBBITS+3                                                01594000
TCBDAR   EQU   TCB+204                                                  01595000
TCBDARC  EQU   TCBDAR                                                   01596000
TCBEXT2  EQU   TCB+208                                                  01597000
TCBXSCT  EQU   TCB+240                                                  01598000
TCBXSCT1 EQU   TCBXSCT                                                  01599000
TCBFOE   EQU   TCB+244                                                  01600000
TCBESTAE EQU   TCB+264                                                  01601000
TCBESTRM EQU   TCBESTAE+1                                               01602000
TCBFBYT1 EQU   TCB+276                                                  01603000
TCBFBYT2 EQU   TCB+277                                                  01604000
TCBRV124 EQU   TCB+278                                                  01605000
TCBRV133 EQU   TCB+279                                                  01606000
TCBXTNT2 EQU   0                                                        01607000
TCBGTF   EQU   TCBXTNT2                                                 01608000
TCBTFLG  EQU   TCBGTF                                                   01609000
TCBRV146 EQU   TCBXTNT2+28                                              01610000
TCBRV155 EQU   TCBXTNT2+29                                              01611000
TCBRV164 EQU   TCBXTNT2+30                                              01612000
TCBRV173 EQU   TCBXTNT2+31                                              01613000
CVTMAP   EQU   0                                                        01614000
CVTDAR   EQU   CVTMAP+72                                                01615000
CVTFLGS1 EQU   CVTDAR                                                   01616000
CVTDCB   EQU   CVTMAP+116                                               01617000
CVTIERLC EQU   CVTMAP+144                                               01618000
CVTOPTA  EQU   CVTMAP+182                                               01619000
CVTOPTB  EQU   CVTMAP+183                                               01620000
CVTGTF   EQU   CVTMAP+236                                               01621000
CVTGTFST EQU   CVTGTF                                                   01622000
CVTGTFS  EQU   CVTGTFST                                                 01623000
CVTSTATE EQU   CVTGTFST                                                 01624000
CVTTMODE EQU   CVTGTFST                                                 01625000
CVTFORM  EQU   CVTGTFST                                                 01626000
CVTAQAVT EQU   CVTMAP+240                                               01627000
CVTTCMFG EQU   CVTAQAVT                                                 01628000
CVTVOLM2 EQU   CVTMAP+244                                               01629000
CVTTATA  EQU   CVTVOLM2                                                 01630000
CVTTSKS  EQU   CVTTATA                                                  01631000
CVTVOLF2 EQU   CVTTSKS                                                  01632000
CVTTAT   EQU   CVTTATA+1                                                01633000
CVTATER  EQU   CVTMAP+248                                               01634000
CVTEXT1  EQU   CVTMAP+252                                               01635000
CVTPURG  EQU   CVTMAP+260                                               01636000
CVTQMSG  EQU   CVTMAP+268                                               01637000
CVTDMSR  EQU   CVTMAP+272                                               01638000
CVTRSV37 EQU   CVTDMSR                                                  01639000
CVTDMSRF EQU   CVTRSV37                                                 01640000
CVTERPV  EQU   CVTMAP+316                                               01641000
CVTINTLA EQU   CVTMAP+320                                               01642000
CVTAPF   EQU   CVTMAP+324                                               01643000
CVTEXT2  EQU   CVTMAP+328                                               01644000
CVTHJES  EQU   CVTMAP+332                                               01645000
CVTPGSIA EQU   CVTMAP+348                                               01646000
CVTA1F1  EQU   CVTMAP+356                                               01647000
CVTSYSK  EQU   CVTMAP+357                                               01648000
CVTVOLM1 EQU   CVTMAP+380                                               01649000
CVTVOLF1 EQU   CVTVOLM1                                                 01650000
CVTATMCT EQU   CVTMAP+388                                               01651000
CVTXTNT1 EQU   0                                                        01652000
CVTXTNT2 EQU   0                                                        01653000
CVTDSSV  EQU   CVTXTNT2                                                 01654000
CVTFLGBT EQU   CVTXTNT2+5                                               01655000
CVTQID   EQU   CVTXTNT2+24                                              01656000
CVTRV400 EQU   CVTXTNT2+52                                              01657000
CVTRV409 EQU   CVTXTNT2+53                                              01658000
CVTATCVT EQU   CVTXTNT2+64                                              01659000
CVTRV429 EQU   CVTXTNT2+84                                              01660000
CVTRV438 EQU   CVTXTNT2+85                                              01661000
CVTRV457 EQU   CVTXTNT2+112                                             01662000
CVTRV466 EQU   CVTXTNT2+113                                             01663000
CVTFIX   EQU   0                                                        01664000
CVTRELNO EQU   CVTFIX+252                                               01665000
PQESECT  EQU   0                                                        01666000
PQEFFBQE EQU   PQESECT                                                  01667000
PQEBFBQE EQU   PQESECT+4                                                01668000
PQESIZE  EQU   PQESECT+20                                               01669000
PQEREGN  EQU   PQESECT+24                                               01670000
VMMFLGS  EQU   PQESECT+30                                               01671000
GDA      EQU   0                                                        01672000
GVSMFLAG EQU   GDA                                                      01673000
GDAFLAGS EQU   GVSMFLAG                                                 01674000
VRPQEP   EQU   GDA+12                                                   01675000
PASTRT   EQU   GDA+16                                                   01676000
PASIZE   EQU   GDA+20                                                   01677000
VRPOSTQ  EQU   GDA+32                                                   01678000
VRWAITQ  EQU   GDA+40                                                   01679000
VRWFEL   EQU   VRWAITQ                                                  01680000
VRWLEL   EQU   VRWAITQ+4                                                01681000
SDWA     EQU   0                                                        01682000
SDWAPARM EQU   SDWA                                                     01683000
SDWAFIOB EQU   SDWA+4                                                   01684000
SDWAABCC EQU   SDWAFIOB                                                 01685000
SDWACMPF EQU   SDWAABCC                                                 01686000
SDWACMPC EQU   SDWAABCC+1                                               01687000
SDWACTL1 EQU   SDWA+8                                                   01688000
SDWACMKA EQU   SDWACTL1                                                 01689000
SDWAMWPA EQU   SDWACTL1+1                                               01690000
SDWAPMKA EQU   SDWACTL1+4                                               01691000
SDWACTL2 EQU   SDWA+16                                                  01692000
SDWACMKP EQU   SDWACTL2                                                 01693000
SDWAMWPP EQU   SDWACTL2+1                                               01694000
SDWAPMKP EQU   SDWACTL2+4                                               01695000
SDWAGRSV EQU   SDWA+24                                                  01696000
SDWANAME EQU   SDWA+88                                                  01697000
SDWAEC1  EQU   SDWA+104                                                 01698000
SDWAEMK1 EQU   SDWAEC1                                                  01699000
SDWAMWP1 EQU   SDWAEC1+1                                                01700000
SDWAINT1 EQU   SDWAEC1+2                                                01701000
SDWANXT1 EQU   SDWAEC1+4                                                01702000
SDWAAEC1 EQU   SDWA+112                                                 01703000
SDWAILC1 EQU   SDWAAEC1+1                                               01704000
SDWAINC1 EQU   SDWAAEC1+2                                               01705000
SDWAICD1 EQU   SDWAINC1+1                                               01706000
SDWAEC2  EQU   SDWA+120                                                 01707000
SDWAEMK2 EQU   SDWAEC2                                                  01708000
SDWAMWP2 EQU   SDWAEC2+1                                                01709000
SDWAINT2 EQU   SDWAEC2+2                                                01710000
SDWANXT2 EQU   SDWAEC2+4                                                01711000
SDWAAEC2 EQU   SDWA+128                                                 01712000
SDWAILC2 EQU   SDWAAEC2+1                                               01713000
SDWAINC2 EQU   SDWAAEC2+2                                               01714000
SDWAICD2 EQU   SDWAINC2+1                                               01715000
SDWASRSV EQU   SDWA+136                                                 01716000
SDWASR01 EQU   SDWASRSV+4                                               01717000
SDWASR03 EQU   SDWASRSV+12                                              01718000
SDWASR04 EQU   SDWASRSV+16                                              01719000
SDWASR07 EQU   SDWASRSV+28                                              01720000
SDWASR08 EQU   SDWASRSV+32                                              01721000
SDWASR09 EQU   SDWASRSV+36                                              01722000
SDWASR13 EQU   SDWASRSV+52                                              01723000
SDWASR14 EQU   SDWASRSV+56                                              01724000
SDWAIDNT EQU   SDWA+200                                                 01725000
SDWAMCH  EQU   SDWA+204                                                 01726000
SDWASTCK EQU   SDWAMCH                                                  01727000
SDWAMCHI EQU   SDWAMCH+8                                                01728000
SDWAMCHS EQU   SDWAMCHI                                                 01729000
SDWAMCHD EQU   SDWAMCHI+1                                               01730000
SDWARSR1 EQU   SDWAMCH+12                                               01731000
SDWARSR2 EQU   SDWAMCH+13                                               01732000
SDWAFLGS EQU   SDWA+232                                                 01733000
SDWAERRA EQU   SDWAFLGS                                                 01734000
SDWAMCHK EQU   SDWAERRA                                                 01735000
SDWAPCHK EQU   SDWAERRA                                                 01736000
SDWAERRB EQU   SDWAFLGS+1                                               01737000
SDWAERRC EQU   SDWAFLGS+2                                               01738000
SDWAPERC EQU   SDWAERRC                                                 01739000
SDWAERRD EQU   SDWAFLGS+3                                               01740000
SDWAFMID EQU   SDWA+236                                                 01741000
SDWAIOFS EQU   SDWA+238                                                 01742000
SDWARTYA EQU   SDWA+240                                                 01743000
SDWACPUA EQU   SDWA+248                                                 01744000
SDWAPARQ EQU   SDWA+252                                                 01745000
SDWARCDE EQU   SDWAPARQ                                                 01746000
SDWAACF2 EQU   SDWAPARQ+1                                               01747000
SDWARCRD EQU   SDWAACF2                                                 01748000
SDWAUPRG EQU   SDWAACF2                                                 01749000
SDWAACF3 EQU   SDWAPARQ+2                                               01750000
SDWASALL EQU   SDWAACF3                                                 01751000
SDWAACF4 EQU   SDWAPARQ+3                                               01752000
SDWALKWA EQU   SDWA+256                                                 01753000
SDWALKWS EQU   SDWALKWA                                                 01754000
SDWARECP EQU   SDWA+292                                                 01755000
SDWAMODN EQU   SDWARECP                                                 01756000
SDWACSCT EQU   SDWARECP+8                                               01757000
SDWAREXN EQU   SDWARECP+16                                              01758000
SDWASNPA EQU   SDWA+320                                                 01759000
SDWADUMP EQU   SDWASNPA                                                 01760000
SDWADPFS EQU   SDWADUMP+1                                               01761000
SDWADDAT EQU   SDWASNPA+4                                               01762000
SDWASDAT EQU   SDWADDAT                                                 01763000
SDWAPDAT EQU   SDWADDAT+2                                               01764000
SDWADPSA EQU   SDWA+328                                                 01765000
SDWADPSL EQU   SDWADPSA                                                 01766000
SDWARA   EQU   SDWA+400                                                 01767000
SDWADPVA EQU   SDWARA+2                                                 01768000
SDUMP    EQU   0                                                        01769000
SDUSDAT1 EQU   SDUMP+2                                                  01770000
SDUSDAT2 EQU   SDUMP+3                                                  01771000
FRRS     EQU   0                                                        01772000
FRRSHEAD EQU   FRRS                                                     01773000
FRRSENTR EQU   0                                                        01774000
FRRSFLGS EQU   FRRSENTR+4                                               01775000
FRRSFLG1 EQU   FRRSFLGS                                                 01776000
FBQESECT EQU   0                                                        01777000
FWDPTR   EQU   FBQESECT                                                 01778000
BCKPTR   EQU   FBQESECT+4                                               01779000
SIZE     EQU   FBQESECT+8                                               01780000
FBQAREA  EQU   FBQESECT+12                                              01781000
VRWPQEL  EQU   0                                                        01782000
WPNEXTEL EQU   VRWPQEL                                                  01783000
WPPREVEL EQU   VRWPQEL+4                                                01784000
SCVTSECT EQU   0                                                        01785000
SCVTRMBR EQU   SCVTSECT+28                                              01786000
ASCB     EQU   0                                                        01787000
ASCBSUPC EQU   ASCB+16                                                  01788000
ASCBLDA  EQU   ASCB+48                                                  01789000
ASCBFW1  EQU   ASCB+100                                                 01790000
ASCBRCTF EQU   ASCBFW1+2                                                01791000
ASCBFLG1 EQU   ASCBFW1+3                                                01792000
ASCBDSP1 EQU   ASCB+114                                                 01793000
ASCBFLG2 EQU   ASCB+115                                                 01794000
ASCBLKGP EQU   ASCB+128                                                 01795000
ASCBSRQ  EQU   ASCB+180                                                 01796000
ASCBSRQ1 EQU   ASCBSRQ                                                  01797000
ASCBSRQ2 EQU   ASCBSRQ+1                                                01798000
ASCBSRQ3 EQU   ASCBSRQ+2                                                01799000
ASCBSRQ4 EQU   ASCBSRQ+3                                                01800000
PVT      EQU   0                                                        01801000
PVTFLAG1 EQU   PVT                                                      01802000
PVTSRBID EQU   PVT+68                                                   01803000
PVTPVRLS EQU   PVT+136                                                  01804000
PVTPSRBP EQU   PVT+188                                                  01805000
PVTQS    EQU   PVT+304                                                  01806000
PVTWSAX  EQU   PVT+344                                                  01807000
LDA      EQU   0                                                        01808000
LVSMFLAG EQU   LDA                                                      01809000
PASCBSV  EQU   LDA+4                                                    01810000
ASDPQE   EQU   LDA+8                                                    01811000
LDATCB   EQU   LDA+12                                                   01812000
LDARQSTA EQU   LDA+16                                                   01813000
LDACBSP  EQU   LDA+20                                                   01814000
BRANCHSV EQU   LDA+524                                                  01815000
CFAPWKAR EQU   LDA+1164                                                 01816000
VVREGSZ  EQU   LDA+1468                                                 01817000
LDASRPQE EQU   LDA+1476                                                 01818000
SRBSECT  EQU   0                                                        01819000
SRB      EQU   SRBSECT                                                  01820000
SRBID    EQU   SRB                                                      01821000
SRBASCB  EQU   SRB+8                                                    01822000
SRBFLC   EQU   SRB+12                                                   01823000
SRBEP    EQU   SRB+20                                                   01824000
SRBRMTR  EQU   SRB+24                                                   01825000
SRBPARM  EQU   SRB+28                                                   01826000
IEAVEQRF EQU   0                                                        01827000
PARMS    EQU   0                                                        01828000
FLGS1    EQU   PARMS                                                    01829000
RSMDONE  EQU   FLGS1                                                    01830000
ASDONE   EQU   FLGS1                                                    01831000
CBGFLG   EQU   FLGS1                                                    01832000
FPFLG    EQU   FLGS1                                                    01833000
ZPFLG    EQU   FLGS1                                                    01834000
GPFPFLG  EQU   FLGS1                                                    01835000
FLGS2    EQU   PARMS+1                                                  01836000
DEQFLG   EQU   FLGS2                                                    01837000
WENQFLG  EQU   FLGS2                                                    01838000
VEQRDONE EQU   FLGS2                                                    01839000
RECURSE  EQU   FLGS2                                                    01840000
REGSIZE  EQU   PARMS+4                                                  01841000
REGADD   EQU   PARMS+8                                                  01842000
LDAADD   EQU   PARMS+12                                                 01843000
RW1SAVE  EQU   PARMS+16                                                 01844000
PRT0BASE EQU   PARMS+20                                                 01845000
DUMMYWRD EQU   0                                                        01846000
FRRSAVE  EQU   0                                                        01847000
SAVBRSV  EQU   FRRSAVE                                                  01848000
SAVTCB   EQU   FRRSAVE+64                                               01849000
SAVRQSTA EQU   FRRSAVE+68                                               01850000
SAVFLAG  EQU   FRRSAVE+72                                               01851000
SAVCBSP  EQU   FRRSAVE+76                                               01852000
CVTS01   EQU   CVTPGSIA                                                 01853000
CVTPVTP  EQU   CVTS01+8                                                 01854000
CVTLPDIA EQU   CVTS01+12                                                01855000
CVTDIRST EQU   CVTLPDIA                                                 01856000
CVTSLIDA EQU   CVTS01+24                                                01857000
CVTCTLFG EQU   CVTS01+50                                                01858000
CVTCRMN  EQU   CVTS01+156                                               01859000
CVTGDA   EQU   CVTS01+212                                               01860000
CVTRV210 EQU   CVTS01+424                                               01861000
CVTRV219 EQU   CVTS01+425                                               01862000
CVTRV228 EQU   CVTS01+426                                               01863000
CVTRV237 EQU   CVTS01+427                                               01864000
CVTMFRTR EQU   CVTS01+452                                               01865000
CVTRV262 EQU   CVTS01+468                                               01866000
CVTRV271 EQU   CVTS01+469                                               01867000
CVTRV280 EQU   CVTS01+470                                               01868000
CVTRV289 EQU   CVTS01+471                                               01869000
CVTGSDA  EQU   CVTS01+600                                               01870000
PSARSVTE EQU   PSARSVT                                                  01871000
PSACSTK  EQU   PSARSVTE                                                 01872000
FRRSPTR  EQU   PSACSTK                                                  01873000
PVTPTR   EQU   CVTPVTP                                                  01874000
WORKAREA EQU   CFAPWKAR                                                 01875000
SAVEAR   EQU   WORKAREA                                                 01876000
VEQRWORK EQU   WORKAREA+72                                              01877000
W1       EQU   VEQRWORK                                                 01878000
@NM00125 EQU   WORKAREA+88                                              01879000
GMBASE2  EQU   @NM00125+60                                              01880000
REGSAVE  EQU   WORKAREA+152                                             01881000
W2       EQU   REGSAVE                                                  01882000
GMBASE   EQU   REGSAVE+12                                               01883000
GPSW     EQU   WORKAREA+196                                             01884000
GPSSW    EQU   GPSW                                                     01885000
VERREQ   EQU   GPSW                                                     01886000
SAVE1FRR EQU   WORKAREA+212                                             01887000
FLC      EQU   PSA                                                      01888000
*                                      START UNREFERENCED COMPONENTS    01889000
RSMFREE  EQU   WORKAREA+208                                             01890000
ALLOCUR  EQU   WORKAREA+204                                             01891000
SRREG    EQU   WORKAREA+200                                             01892000
@NM00130 EQU   WORKAREA+198                                             01893000
BIT1     EQU   GPSW                                                     01894000
BITS4    EQU   GPSW                                                     01895000
FRRPARMS EQU   WORKAREA+192                                             01896000
VRPARMSA EQU   WORKAREA+180                                             01897000
@NM00129 EQU   WORKAREA+178                                             01898000
RCSAVE   EQU   WORKAREA+176                                             01899000
@NM00128 EQU   REGSAVE+16                                               01900000
@NM00127 EQU   REGSAVE+4                                                01901000
@NM00126 EQU   @NM00125                                                 01902000
@NM00124 EQU   VEQRWORK+4                                               01903000
@NM00123 EQU   SAVEAR+64                                                01904000
RINSAV15 EQU   SAVEAR+60                                                01905000
RINSAV14 EQU   SAVEAR+56                                                01906000
RINSAV13 EQU   SAVEAR+52                                                01907000
RINSAV12 EQU   SAVEAR+48                                                01908000
RINSAV11 EQU   SAVEAR+44                                                01909000
RINSAV10 EQU   SAVEAR+40                                                01910000
RINSAV9  EQU   SAVEAR+36                                                01911000
RINSAV8  EQU   SAVEAR+32                                                01912000
RINSAV7  EQU   SAVEAR+28                                                01913000
RINSAV6  EQU   SAVEAR+24                                                01914000
RINSAV5  EQU   SAVEAR+20                                                01915000
RINSAV4  EQU   SAVEAR+16                                                01916000
RINSAV3  EQU   SAVEAR+12                                                01917000
RINSAV2  EQU   SAVEAR+8                                                 01918000
RINSAV1  EQU   SAVEAR+4                                                 01919000
RINSAV0  EQU   SAVEAR                                                   01920000
PSARSAV  EQU   PSARSVTE+60                                              01921000
PSARSTK  EQU   PSARSVTE+56                                              01922000
PSAESAV3 EQU   PSARSVTE+52                                              01923000
PSAESTK3 EQU   PSARSVTE+48                                              01924000
PSAESAV2 EQU   PSARSVTE+44                                              01925000
PSAESTK2 EQU   PSARSVTE+40                                              01926000
PSAESAV1 EQU   PSARSVTE+36                                              01927000
PSAESTK1 EQU   PSARSVTE+32                                              01928000
PSAPSAV  EQU   PSARSVTE+28                                              01929000
PSAPSTK  EQU   PSARSVTE+24                                              01930000
PSAMSAV  EQU   PSARSVTE+20                                              01931000
PSAMSTK  EQU   PSARSVTE+16                                              01932000
PSASSAV  EQU   PSARSVTE+12                                              01933000
PSASSTK  EQU   PSARSVTE+8                                               01934000
PSANSTK  EQU   PSARSVTE+4                                               01935000
CVTRV628 EQU   CVTS01+728                                               01936000
CVTRV627 EQU   CVTS01+724                                               01937000
CVTRV626 EQU   CVTS01+720                                               01938000
CVTRV625 EQU   CVTS01+716                                               01939000
CVTRV624 EQU   CVTS01+712                                               01940000
CVTRV623 EQU   CVTS01+708                                               01941000
CVTRV622 EQU   CVTS01+704                                               01942000
CVTRV621 EQU   CVTS01+700                                               01943000
CVTIHASU EQU   CVTS01+696                                               01944000
CVTSUSP  EQU   CVTS01+692                                               01945000
CVTT6SVC EQU   CVTS01+688                                               01946000
CVTCDAL  EQU   CVTS01+684                                               01947000
CVTTCTL  EQU   CVTS01+680                                               01948000
CVTRSUME EQU   CVTS01+676                                               01949000
CVTJTERM EQU   CVTS01+672                                               01950000
CVTASMRM EQU   CVTS01+668                                               01951000
CVTTCASP EQU   CVTS01+664                                               01952000
CVT0PT03 EQU   CVTS01+660                                               01953000
CVT0PT0E EQU   CVTS01+656                                               01954000
CVTRV609 EQU   CVTS01+652                                               01955000
CVTCGK   EQU   CVTS01+648                                               01956000
CVTRAC   EQU   CVTS01+644                                               01957000
CVTRV606 EQU   CVTS01+640                                               01958000
CVTRV605 EQU   CVTS01+636                                               01959000
CVTRV604 EQU   CVTS01+632                                               01960000
CVTEFF02 EQU   CVTS01+628                                               01961000
CVTCBBR  EQU   CVTS01+624                                               01962000
CVTSSCR  EQU   CVTS01+620                                               01963000
CVTEVENT EQU   CVTS01+616                                               01964000
CVTCRCA  EQU   CVTS01+612                                               01965000
CVTTPIO  EQU   CVTS01+608                                               01966000
CVTADV   EQU   CVTS01+604                                               01967000
CVTGSDAB EQU   CVTGSDA                                                  01968000
CVTQV3   EQU   CVTS01+596                                               01969000
CVTQV2   EQU   CVTS01+592                                               01970000
CVTQV1   EQU   CVTS01+588                                               01971000
CVTRPT   EQU   CVTS01+584                                               01972000
CVTSSRB  EQU   CVTS01+580                                               01973000
CVTCSDRL EQU   CVTS01+576                                               01974000
CVTEXP1  EQU   CVTS01+572                                               01975000
CVTRMPMT EQU   CVTS01+568                                               01976000
CVTRMPTT EQU   CVTS01+564                                               01977000
CVTVPSA  EQU   CVTS01+560                                               01978000
CVTVSTOP EQU   CVTS01+556                                               01979000
CVTGTFR8 EQU   CVTS01+552                                               01980000
CVTQUIT  EQU   CVTS01+548                                               01981000
CVTVACR  EQU   CVTS01+544                                               01982000
CVTWTCB  EQU   CVTS01+540                                               01983000
CVTSTPRS EQU   CVTS01+536                                               01984000
CVT0PT02 EQU   CVTS01+532                                               01985000
CVTDARCM EQU   CVTS01+528                                               01986000
CVTIRECM EQU   CVTS01+524                                               01987000
CVTJRECM EQU   CVTS01+520                                               01988000
CVTVEMS0 EQU   CVTS01+516                                               01989000
CVTSPFRR EQU   CVTS01+512                                               01990000
CVTRLSTG EQU   CVTS01+508                                               01991000
CVT0TC0A EQU   CVTS01+504                                               01992000
CVTGMBR  EQU   CVTS01+500                                               01993000
CVTLFRM  EQU   CVTS01+496                                               01994000
CVTRMBR  EQU   CVTS01+492                                               01995000
CVTVIOP  EQU   CVTS01+488                                               01996000
CVTRV307 EQU   CVTS01+486                                               01997000
CVTRV306 EQU   CVTS01+484                                               01998000
CVTRV305 EQU   CVTS01+482                                               01999000
CVTRV304 EQU   CVTS01+480                                               02000000
CVTRV303 EQU   CVTS01+478                                               02001000
CVTRV302 EQU   CVTS01+476                                               02002000
CVTTRCA  EQU   CVTS01+472                                               02003000
CVTRV297 EQU   CVTRV289                                                 02004000
CVTRV296 EQU   CVTRV289                                                 02005000
CVTRV295 EQU   CVTRV289                                                 02006000
CVTRV294 EQU   CVTRV289                                                 02007000
CVTRV293 EQU   CVTRV289                                                 02008000
CVTRV292 EQU   CVTRV289                                                 02009000
CVTRV291 EQU   CVTRV289                                                 02010000
CVTRV290 EQU   CVTRV289                                                 02011000
CVTRV288 EQU   CVTRV280                                                 02012000
CVTRV287 EQU   CVTRV280                                                 02013000
CVTRV286 EQU   CVTRV280                                                 02014000
CVTRV285 EQU   CVTRV280                                                 02015000
CVTRV284 EQU   CVTRV280                                                 02016000
CVTRV283 EQU   CVTRV280                                                 02017000
CVTRV282 EQU   CVTRV280                                                 02018000
CVTRV281 EQU   CVTRV280                                                 02019000
CVTRV279 EQU   CVTRV271                                                 02020000
CVTRV278 EQU   CVTRV271                                                 02021000
CVTRV277 EQU   CVTRV271                                                 02022000
CVTRV276 EQU   CVTRV271                                                 02023000
CVTRV275 EQU   CVTRV271                                                 02024000
CVTRV274 EQU   CVTRV271                                                 02025000
CVTRV273 EQU   CVTRV271                                                 02026000
CVTRV272 EQU   CVTRV271                                                 02027000
CVTRV270 EQU   CVTRV262                                                 02028000
CVTRV269 EQU   CVTRV262                                                 02029000
CVTRV268 EQU   CVTRV262                                                 02030000
CVTRV267 EQU   CVTRV262                                                 02031000
CVTRV266 EQU   CVTRV262                                                 02032000
CVTRV265 EQU   CVTRV262                                                 02033000
CVTRV264 EQU   CVTRV262                                                 02034000
CVTRV263 EQU   CVTRV262                                                 02035000
CVTVFP   EQU   CVTS01+464                                               02036000
CVTVSI   EQU   CVTS01+460                                               02037000
CVTVPSIB EQU   CVTS01+456                                               02038000
CVTMFACT EQU   CVTMFRTR                                                 02039000
CVTMFCTL EQU   CVTS01+448                                               02040000
CVTPVBP  EQU   CVTS01+444                                               02041000
CVTPWI   EQU   CVTS01+440                                               02042000
CVTRV254 EQU   CVTS01+438                                               02043000
CVTRV253 EQU   CVTS01+436                                               02044000
CVTRV252 EQU   CVTS01+434                                               02045000
CVTRV251 EQU   CVTS01+433                                               02046000
CVTRV250 EQU   CVTS01+432                                               02047000
CVTRV249 EQU   CVTS01+431                                               02048000
CVTRV248 EQU   CVTS01+430                                               02049000
CVTRV247 EQU   CVTS01+429                                               02050000
CVTRV246 EQU   CVTS01+428                                               02051000
CVTRV245 EQU   CVTRV237                                                 02052000
CVTRV244 EQU   CVTRV237                                                 02053000
CVTRV243 EQU   CVTRV237                                                 02054000
CVTRV242 EQU   CVTRV237                                                 02055000
CVTRV241 EQU   CVTRV237                                                 02056000
CVTRV240 EQU   CVTRV237                                                 02057000
CVTRV239 EQU   CVTRV237                                                 02058000
CVTRV238 EQU   CVTRV237                                                 02059000
CVTRV236 EQU   CVTRV228                                                 02060000
CVTRV235 EQU   CVTRV228                                                 02061000
CVTRV234 EQU   CVTRV228                                                 02062000
CVTRV233 EQU   CVTRV228                                                 02063000
CVTRV232 EQU   CVTRV228                                                 02064000
CVTRV231 EQU   CVTRV228                                                 02065000
CVTRV230 EQU   CVTRV228                                                 02066000
CVTRV229 EQU   CVTRV228                                                 02067000
CVTRV227 EQU   CVTRV219                                                 02068000
CVTRV226 EQU   CVTRV219                                                 02069000
CVTRV225 EQU   CVTRV219                                                 02070000
CVTRV224 EQU   CVTRV219                                                 02071000
CVTRV223 EQU   CVTRV219                                                 02072000
CVTRV222 EQU   CVTRV219                                                 02073000
CVTRV221 EQU   CVTRV219                                                 02074000
CVTRV220 EQU   CVTRV219                                                 02075000
CVTRV218 EQU   CVTRV210                                                 02076000
CVTRV217 EQU   CVTRV210                                                 02077000
CVTRV216 EQU   CVTRV210                                                 02078000
CVTRV215 EQU   CVTRV210                                                 02079000
CVTRV214 EQU   CVTRV210                                                 02080000
CVTRV213 EQU   CVTRV210                                                 02081000
CVTRV212 EQU   CVTRV210                                                 02082000
CVTRV211 EQU   CVTRV210                                                 02083000
CVTLCCAT EQU   CVTS01+420                                               02084000
CVTPCCAT EQU   CVTS01+416                                               02085000
CVTIPCRP EQU   CVTS01+412                                               02086000
CVTIPCRI EQU   CVTS01+408                                               02087000
CVTIPCDS EQU   CVTS01+404                                               02088000
CVTAIDVT EQU   CVTS01+400                                               02089000
CVTSSAP  EQU   CVTS01+396                                               02090000
CVTEHCIR EQU   CVTS01+392                                               02091000
CVTEHDEF EQU   CVTS01+388                                               02092000
CVTDAIR  EQU   CVTS01+384                                               02093000
CVTPERFM EQU   CVTS01+380                                               02094000
CVT044R2 EQU   CVTS01+376                                               02095000
CVTFETCH EQU   CVTS01+372                                               02096000
CVTRSTWD EQU   CVTS01+368                                               02097000
CVTSPOST EQU   CVTS01+364                                               02098000
CVTIOBP  EQU   CVTS01+360                                               02099000
CVTASMVT EQU   CVTS01+356                                               02100000
CVTRECRQ EQU   CVTS01+352                                               02101000
CVTWSAC  EQU   CVTS01+348                                               02102000
CVTRV149 EQU   CVTS01+344                                               02103000
CVTWSAL  EQU   CVTS01+340                                               02104000
CVTSPSA  EQU   CVTS01+336                                               02105000
CVTGLMN  EQU   CVTS01+332                                               02106000
CVTVEAC0 EQU   CVTS01+328                                               02107000
CVT062R1 EQU   CVTS01+324                                               02108000
CVTRPOST EQU   CVTS01+320                                               02109000
CVTDQIQE EQU   CVTS01+316                                               02110000
CVTCSD   EQU   CVTS01+312                                               02111000
CVTLKRMA EQU   CVTS01+308                                               02112000
CVTRSPIE EQU   CVTS01+304                                               02113000
CVTRENQ  EQU   CVTS01+300                                               02114000
CVTLQCB  EQU   CVTS01+296                                               02115000
CVTFQCB  EQU   CVTS01+292                                               02116000
CVTQCS01 EQU   CVTS01+288                                               02117000
CVTAPFT  EQU   CVTS01+284                                               02118000
CVTPARRL EQU   CVTS01+280                                               02119000
CVTVWAIT EQU   CVTS01+276                                               02120000
CVTGSPL  EQU   CVTS01+272                                               02121000
CVTLSMQ  EQU   CVTS01+268                                               02122000
CVTGSMQ  EQU   CVTS01+264                                               02123000
CVTEXPRO EQU   CVTS01+260                                               02124000
CVTOPCTP EQU   CVTS01+256                                               02125000
CVTSIC   EQU   CVTS01+252                                               02126000
CVTTPIOS EQU   CVTS01+248                                               02127000
CVTRTMS  EQU   CVTS01+244                                               02128000
CVTSDBF  EQU   CVTS01+240                                               02129000
CVTSCBP  EQU   CVTS01+236                                               02130000
CVTSDMP  EQU   CVTS01+232                                               02131000
CVTSV60  EQU   CVTS01+228                                               02132000
CVTRTMCT EQU   CVTS01+224                                               02133000
CVTASCBL EQU   CVTS01+220                                               02134000
CVTASCBH EQU   CVTS01+216                                               02135000
CVTASVT  EQU   CVTS01+208                                               02136000
CVTVVMDI EQU   CVTS01+204                                               02137000
CVTAQTOP EQU   CVTS01+200                                               02138000
CVTIOSCS EQU   CVTS01+196                                               02139000
CVTSDRM  EQU   CVTS01+192                                               02140000
CVTOPTE  EQU   CVTS01+188                                               02141000
CVTSTXU  EQU   CVTS01+184                                               02142000
CVTQUIS  EQU   CVTS01+180                                               02143000
CVTPARS  EQU   CVTS01+176                                               02144000
CVTS1EE  EQU   CVTS01+172                                               02145000
CVTFRAS  EQU   CVTS01+168                                               02146000
CVTQSAS  EQU   CVTS01+164                                               02147000
CVTCRAS  EQU   CVTS01+160                                               02148000
CVTDELCP EQU   CVTS01+152                                               02149000
CVTFRECL EQU   CVTS01+148                                               02150000
CVTGETCL EQU   CVTS01+144                                               02151000
CVTBLDCP EQU   CVTS01+140                                               02152000
CVTAUTHL EQU   CVTS01+136                                               02153000
CVTSCAN  EQU   CVTS01+132                                               02154000
CVTRV144 EQU   CVTS01+130                                               02155000
CVTMAXMP EQU   CVTS01+128                                               02156000
CVTSTCK  EQU   CVTS01+124                                               02157000
CVTRV139 EQU   CVTS01+123                                               02158000
CVTDSSAC EQU   CVTS01+122                                               02159000
CVTRV513 EQU   CVTS01+121                                               02160000
CVTIOSPL EQU   CVTS01+120                                               02161000
CVTPTGT  EQU   CVTS01+116                                               02162000
CVTCSPIE EQU   CVTS01+112                                               02163000
CVTSMFEX EQU   CVTS01+108                                               02164000
CVTOLT0A EQU   CVTS01+104                                               02165000
CVTSRBRT EQU   CVTS01+100                                               02166000
CVTPUTL  EQU   CVTS01+96                                                02167000
CVTASCRL EQU   CVTS01+92                                                02168000
CVTASCRF EQU   CVTS01+88                                                02169000
CVTRV326 EQU   CVTS01+84                                                02170000
CVTRV325 EQU   CVTS01+80                                                02171000
CVTRV324 EQU   CVTS01+76                                                02172000
CVT0VL01 EQU   CVTS01+72                                                02173000
CVTSHRVM EQU   CVTS01+68                                                02174000
CVTRV332 EQU   CVTS01+64                                                02175000
CVTTAS   EQU   CVTS01+60                                                02176000
CVTRSCN  EQU   CVTS01+56                                                02177000
CVTTRAC2 EQU   CVTS01+54                                                02178000
CVTTRACE EQU   CVTS01+52                                                02179000
CVTAPG   EQU   CVTS01+51                                                02180000
CVTSDTRC EQU   CVTCTLFG                                                 02181000
CVTGTRCE EQU   CVTCTLFG                                                 02182000
CVTNOMP  EQU   CVTCTLFG                                                 02183000
CVTRSV79 EQU   CVTCTLFG                                                 02184000
CVTDSTAT EQU   CVTCTLFG                                                 02185000
CVTRSV78 EQU   CVTCTLFG                                                 02186000
CVTRV333 EQU   CVTCTLFG                                                 02187000
CVTRV323 EQU   CVTCTLFG                                                 02188000
CVTSPVLK EQU   CVTS01+49                                                02189000
CVTRSV77 EQU   CVTS01+48                                                02190000
CVTRV331 EQU   CVTS01+44                                                02191000
CVTRV330 EQU   CVTS01+40                                                02192000
CVTRV329 EQU   CVTS01+36                                                02193000
CVTRV328 EQU   CVTS01+32                                                02194000
CVTRV322 EQU   CVTS01+28                                                02195000
CVTSLID  EQU   CVTSLIDA+1                                               02196000
CVTSYLK  EQU   CVTSLIDA                                                 02197000
CVTRV321 EQU   CVTS01+20                                                02198000
CVTRV320 EQU   CVTS01+16                                                02199000
CVTLPDIR EQU   CVTLPDIA+1                                               02200000
CVTRSV69 EQU   CVTDIRST                                                 02201000
CVTRSV68 EQU   CVTDIRST                                                 02202000
CVTRSV67 EQU   CVTDIRST                                                 02203000
CVTRSV66 EQU   CVTDIRST                                                 02204000
CVTRSV65 EQU   CVTDIRST                                                 02205000
CVTRSV64 EQU   CVTDIRST                                                 02206000
CVTRSV63 EQU   CVTDIRST                                                 02207000
CVTDICOM EQU   CVTDIRST                                                 02208000
CVTLPDSR EQU   CVTS01+4                                                 02209000
CVTGETL  EQU   CVTS01                                                   02210000
@NM00121 EQU   PARMS+2                                                  02211000
PENQFLG  EQU   FLGS2                                                    02212000
@NM00120 EQU   FLGS1                                                    02213000
@NM00119 EQU   SRB+40                                                   02214000
@NM00118 EQU   SRB+38                                                   02215000
SRBPRIOR EQU   SRB+37                                                   02216000
SRBPKF   EQU   SRB+36                                                   02217000
SRBSAVE  EQU   SRB+32                                                   02218000
SRBPTCB  EQU   SRBFLC+4                                                 02219000
SRBPASID EQU   SRBFLC+2                                                 02220000
SRBCPAFF EQU   SRBFLC                                                   02221000
SRBFLNK  EQU   SRB+4                                                    02222000
LDAEND   EQU   LDA+1496                                                 02223000
LCLCELCT EQU   LDA+1492                                                 02224000
LCLCELL  EQU   LDA+1488                                                 02225000
LDALIMIT EQU   LDA+1484                                                 02226000
LDARSVPT EQU   LDA+1480                                                 02227000
CURRGNTP EQU   LDA+1472                                                 02228000
LSQAPTR  EQU   LDA+1464                                                 02229000
CSAVE    EQU   LDA+1100                                                 02230000
OBFRSAVE EQU   LDA+1036                                                 02231000
GFRESAVE EQU   LDA+972                                                  02232000
GMREPSAV EQU   LDA+908                                                  02233000
FBQSAVE  EQU   LDA+844                                                  02234000
G4KSAVE  EQU   LDA+780                                                  02235000
FSAVE    EQU   LDA+716                                                  02236000
BSAVE    EQU   LDA+652                                                  02237000
SAVEREG2 EQU   LDA+588                                                  02238000
GMFMWKAR EQU   LDA+24                                                   02239000
LDARES2  EQU   LDA+21                                                   02240000
@NM00117 EQU   LVSMFLAG+1                                               02241000
LDABRSW  EQU   LVSMFLAG                                                 02242000
LDAFPFM  EQU   LVSMFLAG                                                 02243000
LDAFLAGS EQU   LVSMFLAG                                                 02244000
LDASTART EQU   LDA                                                      02245000
PVTEND   EQU   PVT+1840                                                 02246000
PVTSPARE EQU   PVT+1838                                                 02247000
PVTCHUIC EQU   PVT+1836                                                 02248000
PVTCOMFX EQU   PVT+1834                                                 02249000
PVTSQAFX EQU   PVT+1832                                                 02250000
PVTCNTFX EQU   PVT+1830                                                 02251000
PVTDEFFX EQU   PVT+1828                                                 02252000
PVTFIXOK EQU   PVT+1826                                                 02253000
PVTPEROK EQU   PVT+1824                                                 02254000
PVTMAXFX EQU   PVT+1822                                                 02255000
PVTPERFX EQU   PVT+1820                                                 02256000
PVTRSRB  EQU   PVT+1776                                                 02257000
PVTRESV5 EQU   PVT+1773                                                 02258000
PVTSRBS  EQU   PVT+1772                                                 02259000
PVTSSRB  EQU   PVT+1768                                                 02260000
PVTACA   EQU   PVTWSAX+1400                                             02261000
PVTSAVE  EQU   PVTWSAX+1328                                             02262000
PVTWSA18 EQU   PVTWSAX+1256                                             02263000
PVTWSA17 EQU   PVTWSAX+1184                                             02264000
PVTWSA16 EQU   PVTWSAX+1112                                             02265000
PVTWSA15 EQU   PVTWSAX+1040                                             02266000
PVTWSA14 EQU   PVTWSAX+968                                              02267000
PVTWSA13 EQU   PVTWSAX+896                                              02268000
PVTWSA12 EQU   PVTWSAX+824                                              02269000
PVTWSA11 EQU   PVTWSAX+752                                              02270000
PVTWSA10 EQU   PVTWSAX+672                                              02271000
PVTWSA9  EQU   PVTWSAX+592                                              02272000
PVTWSA8  EQU   PVTWSAX+504                                              02273000
PVTWSA7  EQU   PVTWSAX+432                                              02274000
PVTWSA6  EQU   PVTWSAX+360                                              02275000
PVTWSA5  EQU   PVTWSAX+288                                              02276000
PVTWSA4  EQU   PVTWSAX+216                                              02277000
PVTWSA3  EQU   PVTWSAX+144                                              02278000
PVTWSA2  EQU   PVTWSAX+72                                               02279000
PVTWSA1  EQU   PVTWSAX                                                  02280000
PVTCIOQL EQU   PVTQS+36                                                 02281000
PVTCIOQF EQU   PVTQS+32                                                 02282000
PVTGFADL EQU   PVTQS+28                                                 02283000
PVTGFADF EQU   PVTQS+24                                                 02284000
PVTFPCBL EQU   PVTQS+20                                                 02285000
PVTFPCBF EQU   PVTQS+16                                                 02286000
PVTSQAQL EQU   PVTQS+14                                                 02287000
PVTSQAQF EQU   PVTQS+12                                                 02288000
PVTCFQL  EQU   PVTQS+10                                                 02289000
PVTCFQF  EQU   PVTQS+8                                                  02290000
PVTRSRVL EQU   PVTQS+6                                                  02291000
PVTRSRVF EQU   PVTQS+4                                                  02292000
PVTAFQL  EQU   PVTQS+2                                                  02293000
PVTAFQF  EQU   PVTQS                                                    02294000
PVTSPFR  EQU   PVT+302                                                  02295000
PVTCFMCT EQU   PVT+300                                                  02296000
PVTSPREC EQU   PVT+296                                                  02297000
PVTCAREC EQU   PVT+292                                                  02298000
PVTCAOUT EQU   PVT+288                                                  02299000
PVTCAIN  EQU   PVT+284                                                  02300000
PVTNSWPS EQU   PVT+280                                                  02301000
PVTNPREC EQU   PVT+276                                                  02302000
PVTSPOUT EQU   PVT+272                                                  02303000
PVTSPIN  EQU   PVT+268                                                  02304000
PVTVAMR  EQU   PVT+264                                                  02305000
PVTVAMO  EQU   PVT+260                                                  02306000
PVTVAMI  EQU   PVT+256                                                  02307000
PVTNPOUT EQU   PVT+252                                                  02308000
PVTNPIN  EQU   PVT+248                                                  02309000
PVTPRSET EQU   PVT+244                                                  02310000
PVTFRSLT EQU   PVT+240                                                  02311000
PVTPAGIO EQU   PVT+236                                                  02312000
PVTSWPIO EQU   PVT+232                                                  02313000
PVTPSWPP EQU   PVT+228                                                  02314000
PVTPPREF EQU   PVT+224                                                  02315000
PVTPOPBR EQU   PVT+220                                                  02316000
PVTPRELF EQU   PVT+216                                                  02317000
PVTPRELV EQU   PVT+212                                                  02318000
PVTPFREE EQU   PVT+208                                                  02319000
PVTPRELS EQU   PVT+204                                                  02320000
PVTPOUT  EQU   PVT+200                                                  02321000
PVTPFXLD EQU   PVT+196                                                  02322000
PVTPITAS EQU   PVT+192                                                  02323000
PVTPDSEG EQU   PVT+184                                                  02324000
PVTPCSGB EQU   PVT+180                                                  02325000
PVTPCSEG EQU   PVT+176                                                  02326000
PVTPINV  EQU   PVT+172                                                  02327000
PVTPSWPC EQU   PVT+168                                                  02328000
PVTPSOUT EQU   PVT+164                                                  02329000
PVTPSWIN EQU   PVT+160                                                  02330000
PVTPRCV  EQU   PVT+156                                                  02331000
PVTPRCFI EQU   PVT+152                                                  02332000
PVTPRCF  EQU   PVT+148                                                  02333000
PVTPVRC  EQU   PVT+144                                                  02334000
PVTPVRIN EQU   PVT+140                                                  02335000
PVTPVEQR EQU   PVT+132                                                  02336000
PVTPPIOI EQU   PVT+128                                                  02337000
PVTPVRPO EQU   PVT+124                                                  02338000
PVTPRFR  EQU   PVT+120                                                  02339000
PVTPFP2  EQU   PVT+116                                                  02340000
PVTPFP   EQU   PVT+112                                                  02341000
PVTPFTE  EQU   PVT+108                                                  02342000
PVTPCB   EQU   PVT+104                                                  02343000
PVTREP2  EQU   PVT+100                                                  02344000
PVTPIOCP EQU   PVT+96                                                   02345000
PVTPIOP  EQU   PVT+92                                                   02346000
PVTPGFAD EQU   PVT+88                                                   02347000
PVTPGFA  EQU   PVT+84                                                   02348000
PVTPSQA  EQU   PVT+80                                                   02349000
PVTPSINT EQU   PVT+76                                                   02350000
PVTPSIB  EQU   PVT+72                                                   02351000
PVTPCIWA EQU   PVT+64                                                   02352000
PVTHQSA  EQU   PVT+62                                                   02353000
PVTLQSA  EQU   PVT+60                                                   02354000
PVTOROOT EQU   PVT+56                                                   02355000
PVTPRCA  EQU   PVT+52                                                   02356000
PVTREUS  EQU   PVT+48                                                   02357000
PVTRESV4 EQU   PVT+46                                                   02358000
PVTRSUS  EQU   PVT+44                                                   02359000
PVTVROOT EQU   PVT+40                                                   02360000
PVTPCBLO EQU   PVT+38                                                   02361000
PVTPCBCT EQU   PVT+36                                                   02362000
PVTDFRS  EQU   PVT+34                                                   02363000
PVTRSQA  EQU   PVT+32                                                   02364000
PVTPTLB  EQU   PVT+31                                                   02365000
PVTPCBNO EQU   PVT+30                                                   02366000
PVTSRBNO EQU   PVT+29                                                   02367000
PVTSQDC  EQU   PVT+28                                                   02368000
PVTLCSA  EQU   PVT+26                                                   02369000
PVTLPRIV EQU   PVT+24                                                   02370000
PVTLVR   EQU   PVT+22                                                   02371000
PVTFVR   EQU   PVT+20                                                   02372000
PVTLPFN  EQU   PVT+18                                                   02373000
PVTFPFN  EQU   PVT+16                                                   02374000
PVTPFTP  EQU   PVT+12                                                   02375000
PVTSSPIN EQU   PVT+11                                                   02376000
PVTPCBS  EQU   PVT+10                                                   02377000
PVTPOOL  EQU   PVT+8                                                    02378000
PVTAFCOK EQU   PVT+6                                                    02379000
PVTAFCLO EQU   PVT+4                                                    02380000
PVTAFC   EQU   PVT+2                                                    02381000
PVTFLAG2 EQU   PVT+1                                                    02382000
PVTDUMP  EQU   PVTFLAG1                                                 02383000
PVTSIT   EQU   PVTFLAG1                                                 02384000
PVTLSI   EQU   PVTFLAG1                                                 02385000
PVTRESV1 EQU   PVTFLAG1                                                 02386000
PVTPCBLT EQU   PVTFLAG1                                                 02387000
PVTSRBIU EQU   PVTFLAG1                                                 02388000
PVTBGMS  EQU   PVTFLAG1                                                 02389000
PVTPMSG  EQU   PVTFLAG1                                                 02390000
ASCBEND  EQU   ASCB+208                                                 02391000
ASCBSRBT EQU   ASCB+200                                                 02392000
ASCBSWTL EQU   ASCB+196                                                 02393000
ASCBRS14 EQU   ASCB+195                                                 02394000
ASCBSMCT EQU   ASCB+194                                                 02395000
ASCBRS12 EQU   ASCB+192                                                 02396000
ASCBPCTT EQU   ASCB+188                                                 02397000
ASCBVGTT EQU   ASCB+184                                                 02398000
ASCBRV43 EQU   ASCBSRQ4                                                 02399000
ASCBRV42 EQU   ASCBSRQ4                                                 02400000
ASCBRV41 EQU   ASCBSRQ4                                                 02401000
ASCBRV40 EQU   ASCBSRQ4                                                 02402000
ASCBRV39 EQU   ASCBSRQ4                                                 02403000
ASCBRV38 EQU   ASCBSRQ4                                                 02404000
ASCBRV37 EQU   ASCBSRQ4                                                 02405000
ASCBRV36 EQU   ASCBSRQ4                                                 02406000
ASCBRV35 EQU   ASCBSRQ3                                                 02407000
ASCBRV34 EQU   ASCBSRQ3                                                 02408000
ASCBRV33 EQU   ASCBSRQ3                                                 02409000
ASCBRV32 EQU   ASCBSRQ3                                                 02410000
ASCBRV31 EQU   ASCBSRQ3                                                 02411000
ASCBRV30 EQU   ASCBSRQ3                                                 02412000
ASCBRV29 EQU   ASCBSRQ3                                                 02413000
ASCBRV28 EQU   ASCBSRQ3                                                 02414000
ASCBRV27 EQU   ASCBSRQ2                                                 02415000
ASCBRV26 EQU   ASCBSRQ2                                                 02416000
ASCBRV25 EQU   ASCBSRQ2                                                 02417000
ASCBRV24 EQU   ASCBSRQ2                                                 02418000
ASCBRV23 EQU   ASCBSRQ2                                                 02419000
ASCBRV22 EQU   ASCBSRQ2                                                 02420000
ASCBRV21 EQU   ASCBSRQ2                                                 02421000
ASCBRV20 EQU   ASCBSRQ2                                                 02422000
ASCBRV19 EQU   ASCBSRQ1                                                 02423000
ASCBRV18 EQU   ASCBSRQ1                                                 02424000
ASCBRV17 EQU   ASCBSRQ1                                                 02425000
ASCBRV16 EQU   ASCBSRQ1                                                 02426000
ASCBRV15 EQU   ASCBSRQ1                                                 02427000
ASCBRV14 EQU   ASCBSRQ1                                                 02428000
ASCBRV13 EQU   ASCBSRQ1                                                 02429000
ASCBSTA  EQU   ASCBSRQ1                                                 02430000
ASCBJBNS EQU   ASCB+176                                                 02431000
ASCBJBNI EQU   ASCB+172                                                 02432000
ASCBMCC  EQU   ASCB+168                                                 02433000
ASCBRTWA EQU   ASCB+164                                                 02434000
ASCBIQEA EQU   ASCB+160                                                 02435000
ASCBXMPQ EQU   ASCB+156                                                 02436000
ASCBRS01 EQU   ASCB+154                                                 02437000
ASCBFMCT EQU   ASCB+152                                                 02438000
ASCBOUXB EQU   ASCB+148                                                 02439000
ASCBOUCB EQU   ASCB+144                                                 02440000
ASCBMECB EQU   ASCB+140                                                 02441000
ASCBQECB EQU   ASCB+136                                                 02442000
ASCBLSQH EQU   ASCBLKGP+4                                               02443000
ASCBLOCK EQU   ASCBLKGP                                                 02444000
ASCBTCBS EQU   ASCB+124                                                 02445000
ASCBNVSC EQU   ASCB+122                                                 02446000
ASCBVSC  EQU   ASCB+120                                                 02447000
ASCBSRBS EQU   ASCB+118                                                 02448000
ASCBSSRB EQU   ASCB+116                                                 02449000
ASCBRV06 EQU   ASCBFLG2                                                 02450000
ASCBRV05 EQU   ASCBFLG2                                                 02451000
ASCBRV04 EQU   ASCBFLG2                                                 02452000
ASCBSNQS EQU   ASCBFLG2                                                 02453000
ASCBS2S  EQU   ASCBFLG2                                                 02454000
ASCBCEXT EQU   ASCBFLG2                                                 02455000
ASCBPXMT EQU   ASCBFLG2                                                 02456000
ASCBXMPT EQU   ASCBFLG2                                                 02457000
ASCBRF07 EQU   ASCBDSP1                                                 02458000
ASCBRF06 EQU   ASCBDSP1                                                 02459000
ASCBRF05 EQU   ASCBDSP1                                                 02460000
ASCBRF04 EQU   ASCBDSP1                                                 02461000
ASCBRF03 EQU   ASCBDSP1                                                 02462000
ASCBRF02 EQU   ASCBDSP1                                                 02463000
ASCBFAIL EQU   ASCBDSP1                                                 02464000
ASCBNOQ  EQU   ASCBDSP1                                                 02465000
ASCBSWCT EQU   ASCB+112                                                 02466000
ASCBASXB EQU   ASCB+108                                                 02467000
ASCBTMCH EQU   ASCB+104                                                 02468000
ASCBNSWP EQU   ASCBFLG1                                                 02469000
ASCBTYP1 EQU   ASCBFLG1                                                 02470000
ASCBSTND EQU   ASCBFLG1                                                 02471000
ASCBABNT EQU   ASCBFLG1                                                 02472000
ASCBTERM EQU   ASCBFLG1                                                 02473000
ASCBS3S  EQU   ASCBFLG1                                                 02474000
ASCBCMSH EQU   ASCBFLG1                                                 02475000
ASCBTOFF EQU   ASCBFLG1                                                 02476000
ASCBRF01 EQU   ASCBRCTF                                                 02477000
ASCBTMLW EQU   ASCBRCTF                                                 02478000
ASCBOUT  EQU   ASCBRCTF                                                 02479000
ASCBWAIT EQU   ASCBRCTF                                                 02480000
ASCBRV08 EQU   ASCBRCTF                                                 02481000
ASCBFQU  EQU   ASCBRCTF                                                 02482000
ASCBFRS  EQU   ASCBRCTF                                                 02483000
ASCBTMNO EQU   ASCBRCTF                                                 02484000
ASCBAFFN EQU   ASCBFW1                                                  02485000
ASCBDUMP EQU   ASCB+96                                                  02486000
ASCBRV44 EQU   ASCB+92                                                  02487000
ASCBUBET EQU   ASCB+88                                                  02488000
ASCBECB  EQU   ASCB+84                                                  02489000
ASCBJSTL EQU   ASCB+80                                                  02490000
ASCBEWST EQU   ASCB+72                                                  02491000
ASCBEJST EQU   ASCB+64                                                  02492000
ASCBTSB  EQU   ASCB+60                                                  02493000
ASCBCSCB EQU   ASCB+56                                                  02494000
ASCBRSM  EQU   ASCB+52                                                  02495000
ASCBSTOR EQU   ASCB+44                                                  02496000
ASCBDP   EQU   ASCB+43                                                  02497000
ASCBRV07 EQU   ASCB+42                                                  02498000
ASCBIOSM EQU   ASCB+40                                                  02499000
ASCBSEQN EQU   ASCB+38                                                  02500000
ASCBASID EQU   ASCB+36                                                  02501000
ASCBCPUS EQU   ASCB+32                                                  02502000
ASCBSPL  EQU   ASCB+28                                                  02503000
ASCBIOSP EQU   ASCB+24                                                  02504000
ASCBSYNC EQU   ASCBSUPC+4                                               02505000
ASCBSVRB EQU   ASCBSUPC                                                 02506000
ASCBCMSF EQU   ASCB+12                                                  02507000
ASCBBWDP EQU   ASCB+8                                                   02508000
ASCBFWDP EQU   ASCB+4                                                   02509000
ASCBASCB EQU   ASCB                                                     02510000
ASCBEGIN EQU   ASCB                                                     02511000
@NM00116 EQU   SCVTSECT+180                                             02512000
@NM00115 EQU   SCVTSECT+176                                             02513000
SCVTPIQE EQU   SCVTSECT+172                                             02514000
@NM00114 EQU   SCVTSECT+168                                             02515000
SCVTPTRM EQU   SCVTSECT+164                                             02516000
@NM00113 EQU   SCVTSECT+160                                             02517000
@NM00112 EQU   SCVTSECT+156                                             02518000
SCVTQCBR EQU   SCVTSECT+152                                             02519000
SCVTSTAT EQU   SCVTSECT+148                                             02520000
@NM00111 EQU   SCVTSECT+144                                             02521000
SCVTTQE  EQU   SCVTSECT+140                                             02522000
@NM00110 EQU   SCVTSECT+136                                             02523000
SCVTSVCT EQU   SCVTSECT+132                                             02524000
@NM00109 EQU   SCVTSECT+128                                             02525000
@NM00108 EQU   SCVTSECT+124                                             02526000
SCVTRXLQ EQU   SCVTSECT+120                                             02527000
@NM00107 EQU   SCVTSECT+116                                             02528000
SCVTCTCB EQU   SCVTSECT+112                                             02529000
@NM00106 EQU   SCVTSECT+108                                             02530000
@NM00105 EQU   SCVTSECT+104                                             02531000
@NM00104 EQU   SCVTSECT+100                                             02532000
@NM00103 EQU   SCVTSECT+96                                              02533000
SCVTCOMM EQU   SCVTSECT+92                                              02534000
@NM00102 EQU   SCVTSECT+88                                              02535000
@NM00101 EQU   SCVTSECT+84                                              02536000
@NM00100 EQU   SCVTSECT+80                                              02537000
@NM00099 EQU   SCVTSECT+76                                              02538000
@NM00098 EQU   SCVTSECT+72                                              02539000
SCVTGMBR EQU   SCVTSECT+68                                              02540000
SCVTRPTR EQU   SCVTSECT+64                                              02541000
SCVTHSKP EQU   SCVTSECT+60                                              02542000
@NM00097 EQU   SCVTSECT+56                                              02543000
@NM00096 EQU   SCVTSECT+52                                              02544000
SCVTLFRM EQU   SCVTSECT+48                                              02545000
SCVTCDCL EQU   SCVTSECT+44                                              02546000
@NM00095 EQU   SCVTSECT+40                                              02547000
SCVTRACE EQU   SCVTSECT+36                                              02548000
@NM00094 EQU   SCVTSECT+32                                              02549000
@NM00093 EQU   SCVTSECT+24                                              02550000
@NM00092 EQU   SCVTSECT+20                                              02551000
@NM00091 EQU   SCVTSECT+16                                              02552000
@NM00090 EQU   SCVTSECT+14                                              02553000
SCVTBR14 EQU   SCVTSECT+12                                              02554000
SCVTSPET EQU   SCVTSECT+8                                               02555000
SCVTPGWR EQU   SCVTSECT+4                                               02556000
SCVTPGTM EQU   SCVTSECT                                                 02557000
WPSPADDR EQU   VRWPQEL+24                                               02558000
WPELSIZE EQU   VRWPQEL+20                                               02559000
WPELASCB EQU   VRWPQEL+16                                               02560000
WPERRADD EQU   VRWPQEL+12                                               02561000
WPECBADD EQU   VRWPQEL+8                                                02562000
FRRSPARM EQU   FRRSENTR+8                                               02563000
@NM00089 EQU   FRRSFLGS+1                                               02564000
@NM00088 EQU   FRRSFLG1                                                 02565000
FRRSNEST EQU   FRRSFLG1                                                 02566000
FRRSRCUR EQU   FRRSFLG1                                                 02567000
FRRSFRRA EQU   FRRSENTR                                                 02568000
FRRSENTS EQU   FRRS+84                                                  02569000
FRRSRTMW EQU   FRRS+16                                                  02570000
FRRSCURR EQU   FRRSHEAD+12                                              02571000
FRRSELEN EQU   FRRSHEAD+8                                               02572000
FRRSLAST EQU   FRRSHEAD+4                                               02573000
FRRSEMP  EQU   FRRSHEAD                                                 02574000
@NM00087 EQU   SDUMP+20                                                 02575000
@NM00086 EQU   SDUMP+16                                                 02576000
@NM00085 EQU   SDUMP+12                                                 02577000
@NM00084 EQU   SDUMP+8                                                  02578000
@NM00083 EQU   SDUMP+4                                                  02579000
@NM00082 EQU   SDUSDAT2                                                 02580000
SDUSWA   EQU   SDUSDAT2                                                 02581000
SDUCSA   EQU   SDUSDAT2                                                 02582000
SDUTRT   EQU   SDUSDAT1                                                 02583000
SDULPA   EQU   SDUSDAT1                                                 02584000
SDURGN   EQU   SDUSDAT1                                                 02585000
SDULSQA  EQU   SDUSDAT1                                                 02586000
SDUSQA   EQU   SDUSDAT1                                                 02587000
SDUNUC   EQU   SDUSDAT1                                                 02588000
SDUPSA   EQU   SDUSDAT1                                                 02589000
SDUALPSA EQU   SDUSDAT1                                                 02590000
@NM00081 EQU   SDUMP                                                    02591000
@NM00080 EQU   SDWA+512                                                 02592000
SDWAVRA  EQU   SDWARA+4                                                 02593000
SDWAURAL EQU   SDWARA+3                                                 02594000
@NM00079 EQU   SDWADPVA                                                 02595000
SDWAEBC  EQU   SDWADPVA                                                 02596000
SDWAHEX  EQU   SDWADPVA                                                 02597000
SDWAVRAL EQU   SDWARA                                                   02598000
@NM00078 EQU   SDWA+396                                                 02599000
SDWACOMP EQU   SDWA+392                                                 02600000
SDWARCPL EQU   SDWA+364                                                 02601000
@NM00077 EQU   SDWADPSA+32                                              02602000
SDWATO4  EQU   SDWADPSL+28                                              02603000
SDWAFRM4 EQU   SDWADPSL+24                                              02604000
SDWATO3  EQU   SDWADPSL+20                                              02605000
SDWAFRM3 EQU   SDWADPSL+16                                              02606000
SDWATO2  EQU   SDWADPSL+12                                              02607000
SDWAFRM2 EQU   SDWADPSL+8                                               02608000
SDWATO1  EQU   SDWADPSL+4                                               02609000
SDWAFRM1 EQU   SDWADPSL                                                 02610000
@NM00076 EQU   SDWADDAT+3                                               02611000
@NM00075 EQU   SDWAPDAT                                                 02612000
SDWAUSPL EQU   SDWAPDAT                                                 02613000
SDWADPSW EQU   SDWAPDAT                                                 02614000
SDWATJPA EQU   SDWAPDAT                                                 02615000
SDWATLPA EQU   SDWAPDAT                                                 02616000
SDWADREG EQU   SDWAPDAT                                                 02617000
SDWADSAH EQU   SDWAPDAT                                                 02618000
SDWADSAS EQU   SDWAPDAT                                                 02619000
@NM00074 EQU   SDWADDAT+1                                               02620000
@NM00073 EQU   SDWASDAT                                                 02621000
SDWAQQS  EQU   SDWASDAT                                                 02622000
SDWACBS  EQU   SDWASDAT                                                 02623000
SDWAGTF  EQU   SDWASDAT                                                 02624000
SDWASWA  EQU   SDWASDAT                                                 02625000
SDWALSQA EQU   SDWASDAT                                                 02626000
SDWASQA  EQU   SDWASDAT                                                 02627000
SDWANUC  EQU   SDWASDAT                                                 02628000
@NM00072 EQU   SDWADUMP+2                                               02629000
@NM00071 EQU   SDWADPFS                                                 02630000
SDWASLST EQU   SDWADPFS                                                 02631000
@NM00070 EQU   SDWADPFS                                                 02632000
SDWADLST EQU   SDWADPFS                                                 02633000
SDWADPT  EQU   SDWADPFS                                                 02634000
SDWADPID EQU   SDWADUMP                                                 02635000
SDWADPLA EQU   SDWA+316                                                 02636000
@NM00069 EQU   SDWA+290                                                 02637000
SDWAASID EQU   SDWA+288                                                 02638000
SDWATALW EQU   SDWALKWS+28                                              02639000
SDWATDLW EQU   SDWALKWS+24                                              02640000
SDWATNLW EQU   SDWALKWS+20                                              02641000
SDWAAPLW EQU   SDWALKWS+16                                              02642000
SDWAIPLW EQU   SDWALKWS+12                                              02643000
SDWAILLW EQU   SDWALKWS+8                                               02644000
SDWAIULW EQU   SDWALKWS+4                                               02645000
SDWAICLW EQU   SDWALKWS                                                 02646000
SDWAFLLK EQU   SDWAACF4                                                 02647000
SDWACMS  EQU   SDWAACF4                                                 02648000
SDWAOPTM EQU   SDWAACF4                                                 02649000
SDWATADB EQU   SDWAACF4                                                 02650000
SDWATDNB EQU   SDWAACF4                                                 02651000
SDWATNCB EQU   SDWAACF4                                                 02652000
SDWAILCH EQU   SDWAACF4                                                 02653000
SDWAIUCB EQU   SDWAACF4                                                 02654000
SDWAICAT EQU   SDWAACF3                                                 02655000
SDWAIPRG EQU   SDWAACF3                                                 02656000
SDWAASMP EQU   SDWAACF3                                                 02657000
SDWADISP EQU   SDWAACF3                                                 02658000
@NM00068 EQU   SDWAACF3                                                 02659000
@NM00067 EQU   SDWAACF2                                                 02660000
SDWAFREE EQU   SDWAACF2                                                 02661000
@NM00066 EQU   SDWAACF2                                                 02662000
SDWASPIN EQU   SDWAACF2                                                 02663000
@NM00065 EQU   SDWAACF2                                                 02664000
SDWALCPU EQU   SDWACPUA+2                                               02665000
@NM00064 EQU   SDWACPUA                                                 02666000
SDWARECA EQU   SDWA+244                                                 02667000
@NM00063 EQU   SDWA+239                                                 02668000
@NM00062 EQU   SDWAIOFS                                                 02669000
SDWANIOP EQU   SDWAIOFS                                                 02670000
SDWANOIO EQU   SDWAIOFS                                                 02671000
SDWAIOHT EQU   SDWAIOFS                                                 02672000
SDWAIOQR EQU   SDWAIOFS                                                 02673000
@NM00061 EQU   SDWAERRD                                                 02674000
SDWAMCIV EQU   SDWAERRD                                                 02675000
SDWARPIV EQU   SDWAERRD                                                 02676000
SDWAMABD EQU   SDWAERRD                                                 02677000
SDWACTS  EQU   SDWAERRD                                                 02678000
SDWASTAE EQU   SDWAERRD                                                 02679000
SDWANRBE EQU   SDWAERRD                                                 02680000
SDWACLUP EQU   SDWAERRD                                                 02681000
@NM00060 EQU   SDWAERRC                                                 02682000
SDWAEAS  EQU   SDWAERRC                                                 02683000
SDWAIRB  EQU   SDWAERRC                                                 02684000
SDWASTAI EQU   SDWAERRC                                                 02685000
SDWASTAF EQU   SDWAERRC                                                 02686000
SDWASRBM EQU   SDWAERRB                                                 02687000
SDWALDIS EQU   SDWAERRB                                                 02688000
SDWAENRB EQU   SDWAERRB                                                 02689000
SDWATYP1 EQU   SDWAERRB                                                 02690000
@NM00059 EQU   SDWAERRB                                                 02691000
SDWAPGIO EQU   SDWAERRA                                                 02692000
SDWATEXC EQU   SDWAERRA                                                 02693000
SDWASVCE EQU   SDWAERRA                                                 02694000
SDWAABTM EQU   SDWAERRA                                                 02695000
SDWASVCD EQU   SDWAERRA                                                 02696000
SDWARKEY EQU   SDWAERRA                                                 02697000
SDWATIME EQU   SDWAMCH+20                                               02698000
SDWARFSA EQU   SDWAMCH+16                                               02699000
@NM00058 EQU   SDWAMCH+14                                               02700000
SDWAVEQR EQU   SDWARSR2                                                 02701000
SDWAPGFX EQU   SDWARSR2                                                 02702000
SDWAFLSQ EQU   SDWARSR2                                                 02703000
SDWAFSQA EQU   SDWARSR2                                                 02704000
SDWANUCL EQU   SDWARSR2                                                 02705000
SDWASPER EQU   SDWARSR2                                                 02706000
SDWAINTC EQU   SDWARSR2                                                 02707000
SDWAOFLN EQU   SDWARSR2                                                 02708000
SDWACHNG EQU   SDWARSR1                                                 02709000
SDWAMSER EQU   SDWARSR1                                                 02710000
@NM00057 EQU   SDWARSR1                                                 02711000
SDWACPID EQU   SDWAMCH+10                                               02712000
SDWATERR EQU   SDWAMCHD                                                 02713000
SDWAFPRX EQU   SDWAMCHD                                                 02714000
SDWAINSF EQU   SDWAMCHD                                                 02715000
SDWAACR  EQU   SDWAMCHD                                                 02716000
SDWASCK  EQU   SDWAMCHD                                                 02717000
SDWAPSWU EQU   SDWAMCHD                                                 02718000
SDWAREGU EQU   SDWAMCHD                                                 02719000
SDWASKYF EQU   SDWAMCHD                                                 02720000
@NM00056 EQU   SDWAMCHS                                                 02721000
SDWARSRF EQU   SDWAMCHS                                                 02722000
SDWARSRC EQU   SDWAMCHS                                                 02723000
SDWAINVP EQU   SDWAMCHS                                                 02724000
SDWATSVL EQU   SDWAMCHS                                                 02725000
SDWARCDF EQU   SDWAMCHS                                                 02726000
SDWASRVL EQU   SDWAMCHS                                                 02727000
SDWASCKE EQU   SDWASTCK+4                                               02728000
SDWASCKB EQU   SDWASTCK                                                 02729000
SDWALNTH EQU   SDWAIDNT+1                                               02730000
SDWASPID EQU   SDWAIDNT                                                 02731000
SDWASR15 EQU   SDWASRSV+60                                              02732000
SDWASR12 EQU   SDWASRSV+48                                              02733000
SDWASR11 EQU   SDWASRSV+44                                              02734000
SDWASR10 EQU   SDWASRSV+40                                              02735000
SDWASR06 EQU   SDWASRSV+24                                              02736000
SDWASR05 EQU   SDWASRSV+20                                              02737000
SDWASR02 EQU   SDWASRSV+8                                               02738000
SDWASR00 EQU   SDWASRSV                                                 02739000
SDWATRN2 EQU   SDWAAEC2+4                                               02740000
SDWAIPC2 EQU   SDWAICD2                                                 02741000
SDWAIMC2 EQU   SDWAICD2                                                 02742000
SDWAIPR2 EQU   SDWAICD2                                                 02743000
@NM00055 EQU   SDWAINC2                                                 02744000
@NM00054 EQU   SDWAILC2                                                 02745000
SDWAIL2  EQU   SDWAILC2                                                 02746000
@NM00053 EQU   SDWAILC2                                                 02747000
@NM00052 EQU   SDWAAEC2                                                 02748000
SDWAADD2 EQU   SDWANXT2+1                                               02749000
@NM00051 EQU   SDWANXT2                                                 02750000
@NM00050 EQU   SDWAEC2+3                                                02751000
SDWASGN2 EQU   SDWAINT2                                                 02752000
SDWAEXP2 EQU   SDWAINT2                                                 02753000
SDWADEC2 EQU   SDWAINT2                                                 02754000
SDWAFPO2 EQU   SDWAINT2                                                 02755000
SDWACC2  EQU   SDWAINT2                                                 02756000
@NM00049 EQU   SDWAINT2                                                 02757000
SDWAPGM2 EQU   SDWAMWP2                                                 02758000
SDWAWAT2 EQU   SDWAMWP2                                                 02759000
SDWAMCK2 EQU   SDWAMWP2                                                 02760000
SDWAECT2 EQU   SDWAMWP2                                                 02761000
SDWAKEY2 EQU   SDWAMWP2                                                 02762000
SDWAEXT2 EQU   SDWAEMK2                                                 02763000
SDWAIO2  EQU   SDWAEMK2                                                 02764000
SDWATRM2 EQU   SDWAEMK2                                                 02765000
@NM00048 EQU   SDWAEMK2                                                 02766000
SDWAPER2 EQU   SDWAEMK2                                                 02767000
@NM00047 EQU   SDWAEMK2                                                 02768000
SDWATRAN EQU   SDWAAEC1+4                                               02769000
SDWAIPC1 EQU   SDWAICD1                                                 02770000
SDWAIMC1 EQU   SDWAICD1                                                 02771000
SDWAIPR1 EQU   SDWAICD1                                                 02772000
@NM00046 EQU   SDWAINC1                                                 02773000
@NM00045 EQU   SDWAILC1                                                 02774000
SDWAIL1  EQU   SDWAILC1                                                 02775000
@NM00044 EQU   SDWAILC1                                                 02776000
@NM00043 EQU   SDWAAEC1                                                 02777000
SDWAADD1 EQU   SDWANXT1+1                                               02778000
@NM00042 EQU   SDWANXT1                                                 02779000
@NM00041 EQU   SDWAEC1+3                                                02780000
SDWASGN1 EQU   SDWAINT1                                                 02781000
SDWAEXP1 EQU   SDWAINT1                                                 02782000
SDWADEC1 EQU   SDWAINT1                                                 02783000
SDWAFPO1 EQU   SDWAINT1                                                 02784000
SDWACC1  EQU   SDWAINT1                                                 02785000
@NM00040 EQU   SDWAINT1                                                 02786000
SDWAPGM1 EQU   SDWAMWP1                                                 02787000
SDWAWAT1 EQU   SDWAMWP1                                                 02788000
SDWAMCK1 EQU   SDWAMWP1                                                 02789000
SDWAECT1 EQU   SDWAMWP1                                                 02790000
SDWAKEY1 EQU   SDWAMWP1                                                 02791000
SDWAEXT1 EQU   SDWAEMK1                                                 02792000
SDWAIO1  EQU   SDWAEMK1                                                 02793000
SDWATRM1 EQU   SDWAEMK1                                                 02794000
@NM00039 EQU   SDWAEMK1                                                 02795000
SDWAPER1 EQU   SDWAEMK1                                                 02796000
@NM00038 EQU   SDWAEMK1                                                 02797000
SDWAIOBR EQU   SDWA+100                                                 02798000
SDWAEPA  EQU   SDWA+96                                                  02799000
@NM00037 EQU   SDWANAME+4                                               02800000
SDWARBAD EQU   SDWANAME                                                 02801000
SDWAGR15 EQU   SDWAGRSV+60                                              02802000
SDWAGR14 EQU   SDWAGRSV+56                                              02803000
SDWAGR13 EQU   SDWAGRSV+52                                              02804000
SDWAGR12 EQU   SDWAGRSV+48                                              02805000
SDWAGR11 EQU   SDWAGRSV+44                                              02806000
SDWAGR10 EQU   SDWAGRSV+40                                              02807000
SDWAGR09 EQU   SDWAGRSV+36                                              02808000
SDWAGR08 EQU   SDWAGRSV+32                                              02809000
SDWAGR07 EQU   SDWAGRSV+28                                              02810000
SDWAGR06 EQU   SDWAGRSV+24                                              02811000
SDWAGR05 EQU   SDWAGRSV+20                                              02812000
SDWAGR04 EQU   SDWAGRSV+16                                              02813000
SDWAGR03 EQU   SDWAGRSV+12                                              02814000
SDWAGR02 EQU   SDWAGRSV+8                                               02815000
SDWAGR01 EQU   SDWAGRSV+4                                               02816000
SDWAGR00 EQU   SDWAGRSV                                                 02817000
SDWANXTP EQU   SDWACTL2+5                                               02818000
SDWASGP  EQU   SDWAPMKP                                                 02819000
SDWAEUP  EQU   SDWAPMKP                                                 02820000
SDWADOP  EQU   SDWAPMKP                                                 02821000
SDWAFPP  EQU   SDWAPMKP                                                 02822000
SDWACCP  EQU   SDWAPMKP                                                 02823000
SDWAILP  EQU   SDWAPMKP                                                 02824000
SDWAINTP EQU   SDWACTL2+2                                               02825000
SDWASPVP EQU   SDWAMWPP                                                 02826000
SDWAWATP EQU   SDWAMWPP                                                 02827000
SDWAMCKP EQU   SDWAMWPP                                                 02828000
@NM00036 EQU   SDWAMWPP                                                 02829000
SDWAKEYP EQU   SDWAMWPP                                                 02830000
SDWAEXTP EQU   SDWACMKP                                                 02831000
SDWAIOP  EQU   SDWACMKP                                                 02832000
SDWANXTA EQU   SDWACTL1+5                                               02833000
SDWASGA  EQU   SDWAPMKA                                                 02834000
SDWAEUA  EQU   SDWAPMKA                                                 02835000
SDWADOA  EQU   SDWAPMKA                                                 02836000
SDWAFPA  EQU   SDWAPMKA                                                 02837000
SDWACCA  EQU   SDWAPMKA                                                 02838000
SDWAILA  EQU   SDWAPMKA                                                 02839000
SDWAINTA EQU   SDWACTL1+2                                               02840000
SDWASPVA EQU   SDWAMWPA                                                 02841000
SDWAWATA EQU   SDWAMWPA                                                 02842000
SDWAMCKA EQU   SDWAMWPA                                                 02843000
@NM00035 EQU   SDWAMWPA                                                 02844000
SDWAKEYA EQU   SDWAMWPA                                                 02845000
SDWAEXTA EQU   SDWACMKA                                                 02846000
SDWAIOA  EQU   SDWACMKA                                                 02847000
@NM00034 EQU   SDWACMPF                                                 02848000
SDWASTCC EQU   SDWACMPF                                                 02849000
@NM00033 EQU   SDWACMPF                                                 02850000
SDWASTEP EQU   SDWACMPF                                                 02851000
SDWAREQ  EQU   SDWACMPF                                                 02852000
GBLCELCT EQU   GDA+60                                                   02853000
GLBLCELL EQU   GDA+56                                                   02854000
CSASPQEP EQU   GDA+52                                                   02855000
PFSTCPAB EQU   GDA+48                                                   02856000
VRPLEL   EQU   VRPOSTQ+4                                                02857000
VRPFEL   EQU   VRPOSTQ                                                  02858000
SQASPLFT EQU   GDA+28                                                   02859000
SQASPQEP EQU   GDA+24                                                   02860000
CSAPQEP  EQU   GDA+8                                                    02861000
VRDREG   EQU   GDA+4                                                    02862000
RESV     EQU   GVSMFLAG+1                                               02863000
@NM00008 EQU   GDAFLAGS                                                 02864000
WAITQUE  EQU   GDAFLAGS                                                 02865000
SQATHRS2 EQU   GDAFLAGS                                                 02866000
SQATHRS1 EQU   GDAFLAGS                                                 02867000
GDAFLAG2 EQU   GDAFLAGS                                                 02868000
NIPFOURK EQU   GDAFLAGS                                                 02869000
GDAFLAG1 EQU   GDAFLAGS                                                 02870000
PQERSVD  EQU   PQESECT+31                                               02871000
VVVRFLG  EQU   VMMFLGS                                                  02872000
@NM00007 EQU   VMMFLGS                                                  02873000
PQEHRID  EQU   PQESECT+29                                               02874000
PQERFLGS EQU   PQESECT+28                                               02875000
PQETCB   EQU   PQESECT+16                                               02876000
PQEBPQE  EQU   PQESECT+12                                               02877000
PQEFPQE  EQU   PQESECT+8                                                02878000
CVTLEVL  EQU   CVTRELNO+2                                               02879000
CVTNUMB  EQU   CVTRELNO                                                 02880000
CVTMDL   EQU   CVTFIX+250                                               02881000
@NM00006 EQU   CVTFIX+248                                               02882000
@NM00005 EQU   CVTFIX                                                   02883000
CVTRV482 EQU   CVTXTNT2+128                                             02884000
CVTRV481 EQU   CVTXTNT2+124                                             02885000
CVTRV480 EQU   CVTXTNT2+120                                             02886000
CVTRV479 EQU   CVTXTNT2+118                                             02887000
CVTRV478 EQU   CVTXTNT2+117                                             02888000
CVTRV477 EQU   CVTXTNT2+116                                             02889000
CVTRV476 EQU   CVTXTNT2+115                                             02890000
CVTRV475 EQU   CVTXTNT2+114                                             02891000
CVTRV474 EQU   CVTRV466                                                 02892000
CVTRV473 EQU   CVTRV466                                                 02893000
CVTRV472 EQU   CVTRV466                                                 02894000
CVTRV471 EQU   CVTRV466                                                 02895000
CVTRV470 EQU   CVTRV466                                                 02896000
CVTRV469 EQU   CVTRV466                                                 02897000
CVTRV468 EQU   CVTRV466                                                 02898000
CVTRV467 EQU   CVTRV466                                                 02899000
CVTRV465 EQU   CVTRV457                                                 02900000
CVTRV464 EQU   CVTRV457                                                 02901000
CVTRV463 EQU   CVTRV457                                                 02902000
CVTRV462 EQU   CVTRV457                                                 02903000
CVTRV461 EQU   CVTRV457                                                 02904000
CVTRV460 EQU   CVTRV457                                                 02905000
CVTRV459 EQU   CVTRV457                                                 02906000
CVTRV458 EQU   CVTRV457                                                 02907000
CVTRV456 EQU   CVTXTNT2+108                                             02908000
CVTRV455 EQU   CVTXTNT2+104                                             02909000
CVTRV454 EQU   CVTXTNT2+100                                             02910000
CVTRV453 EQU   CVTXTNT2+96                                              02911000
CVTRV452 EQU   CVTXTNT2+94                                              02912000
CVTRV451 EQU   CVTXTNT2+92                                              02913000
CVTRV450 EQU   CVTXTNT2+90                                              02914000
CVTRV449 EQU   CVTXTNT2+88                                              02915000
CVTRV448 EQU   CVTXTNT2+87                                              02916000
CVTRV447 EQU   CVTXTNT2+86                                              02917000
CVTRV446 EQU   CVTRV438                                                 02918000
CVTRV445 EQU   CVTRV438                                                 02919000
CVTRV444 EQU   CVTRV438                                                 02920000
CVTRV443 EQU   CVTRV438                                                 02921000
CVTRV442 EQU   CVTRV438                                                 02922000
CVTRV441 EQU   CVTRV438                                                 02923000
CVTRV440 EQU   CVTRV438                                                 02924000
CVTRV439 EQU   CVTRV438                                                 02925000
CVTRV437 EQU   CVTRV429                                                 02926000
CVTRV436 EQU   CVTRV429                                                 02927000
CVTRV435 EQU   CVTRV429                                                 02928000
CVTRV434 EQU   CVTRV429                                                 02929000
CVTRV433 EQU   CVTRV429                                                 02930000
CVTRV432 EQU   CVTRV429                                                 02931000
CVTRV431 EQU   CVTRV429                                                 02932000
CVTRV430 EQU   CVTRV429                                                 02933000
CVTRV428 EQU   CVTXTNT2+80                                              02934000
CVTRV427 EQU   CVTXTNT2+76                                              02935000
CVTRV426 EQU   CVTXTNT2+72                                              02936000
CVTRV425 EQU   CVTXTNT2+68                                              02937000
CVTATACT EQU   CVTATCVT                                                 02938000
CVTRV423 EQU   CVTXTNT2+62                                              02939000
CVTRV422 EQU   CVTXTNT2+60                                              02940000
CVTRV421 EQU   CVTXTNT2+58                                              02941000
CVTRV420 EQU   CVTXTNT2+56                                              02942000
CVTRV419 EQU   CVTXTNT2+55                                              02943000
CVTRV418 EQU   CVTXTNT2+54                                              02944000
CVTRV417 EQU   CVTRV409                                                 02945000
CVTRV416 EQU   CVTRV409                                                 02946000
CVTRV415 EQU   CVTRV409                                                 02947000
CVTRV414 EQU   CVTRV409                                                 02948000
CVTRV413 EQU   CVTRV409                                                 02949000
CVTRV412 EQU   CVTRV409                                                 02950000
CVTRV411 EQU   CVTRV409                                                 02951000
CVTRV410 EQU   CVTRV409                                                 02952000
CVTRV408 EQU   CVTRV400                                                 02953000
CVTRV407 EQU   CVTRV400                                                 02954000
CVTRV406 EQU   CVTRV400                                                 02955000
CVTRV405 EQU   CVTRV400                                                 02956000
CVTRV404 EQU   CVTRV400                                                 02957000
CVTRV403 EQU   CVTRV400                                                 02958000
CVTRV402 EQU   CVTRV400                                                 02959000
CVTRV401 EQU   CVTRV400                                                 02960000
CVTICB   EQU   CVTXTNT2+48                                              02961000
CVTSKTA  EQU   CVTXTNT2+44                                              02962000
CVTRSV99 EQU   CVTXTNT2+40                                              02963000
CVTRSV98 EQU   CVTXTNT2+36                                              02964000
CVTRSV97 EQU   CVTXTNT2+34                                              02965000
CVTRSV96 EQU   CVTXTNT2+32                                              02966000
CVTOLTEP EQU   CVTXTNT2+28                                              02967000
CVTQIDA  EQU   CVTQID+1                                                 02968000
CVTRSV95 EQU   CVTQID                                                   02969000
CVTRSV94 EQU   CVTXTNT2+20                                              02970000
CVTRSV93 EQU   CVTXTNT2+16                                              02971000
CVTRSV92 EQU   CVTXTNT2+12                                              02972000
CVTDEBVR EQU   CVTXTNT2+8                                               02973000
CVTRSV91 EQU   CVTXTNT2+6                                               02974000
CVTRSV9H EQU   CVTFLGBT                                                 02975000
CVTRSV9G EQU   CVTFLGBT                                                 02976000
CVTRSV9F EQU   CVTFLGBT                                                 02977000
CVTRSV9E EQU   CVTFLGBT                                                 02978000
CVTRSV9D EQU   CVTFLGBT                                                 02979000
CVTRSV9C EQU   CVTFLGBT                                                 02980000
CVTVME   EQU   CVTFLGBT                                                 02981000
CVTNPE   EQU   CVTFLGBT                                                 02982000
CVTNUCLS EQU   CVTXTNT2+4                                               02983000
CVTDSSVA EQU   CVTDSSV+1                                                02984000
CVTRSV89 EQU   CVTDSSV                                                  02985000
CVTRSV88 EQU   CVTXTNT1+8                                               02986000
CVTRSV87 EQU   CVTXTNT1+4                                               02987000
CVTFACHN EQU   CVTXTNT1                                                 02988000
CVTRV488 EQU   CVTMAP+412                                               02989000
CVTRV487 EQU   CVTMAP+408                                               02990000
CVTRV486 EQU   CVTMAP+404                                               02991000
CVTRV485 EQU   CVTMAP+400                                               02992000
CVTACTAP EQU   CVTMAP+396                                               02993000
CVTAUTH  EQU   CVTMAP+392                                               02994000
CVTATMCA EQU   CVTATMCT+1                                               02995000
CVTATMST EQU   CVTATMCT                                                 02996000
CVTRSV61 EQU   CVTMAP+384                                               02997000
CVTVOLT1 EQU   CVTVOLM1+1                                               02998000
CVTVOLI1 EQU   CVTVOLF1                                                 02999000
CVTSTOA  EQU   CVTMAP+376                                               03000000
CVTRSV58 EQU   CVTMAP+374                                               03001000
CVTRSV57 EQU   CVTMAP+372                                               03002000
CVTDDCE  EQU   CVTMAP+368                                               03003000
CVTPNWFR EQU   CVTMAP+364                                               03004000
CVTSMF   EQU   CVTMAP+360                                               03005000
CVTSULK  EQU   CVTMAP+358                                               03006000
CVTSLKO  EQU   CVTSYSK                                                  03007000
CVTSLKP  EQU   CVTSYSK                                                  03008000
CVTSLKQ  EQU   CVTSYSK                                                  03009000
CVTSLKR  EQU   CVTSYSK                                                  03010000
CVTRSV56 EQU   CVTSYSK                                                  03011000
CVTRSV55 EQU   CVTSYSK                                                  03012000
CVTRSV54 EQU   CVTSYSK                                                  03013000
CVTRSV53 EQU   CVTSYSK                                                  03014000
CVTRSV52 EQU   CVTA1F1                                                  03015000
CVTRSV51 EQU   CVTA1F1                                                  03016000
CVTRSV50 EQU   CVTA1F1                                                  03017000
CVTRSV49 EQU   CVTA1F1                                                  03018000
CVTRSV48 EQU   CVTA1F1                                                  03019000
CVTRSV47 EQU   CVTA1F1                                                  03020000
CVTSRSW  EQU   CVTA1F1                                                  03021000
CVTPFSW  EQU   CVTA1F1                                                  03022000
CVTPCVT  EQU   CVTMAP+352                                               03023000
CVTRSV46 EQU   CVTMAP+344                                               03024000
CVTRSV45 EQU   CVTMAP+340                                               03025000
CVTRSV44 EQU   CVTMAP+338                                               03026000
CVTRSV43 EQU   CVTMAP+336                                               03027000
CVTHJESA EQU   CVTHJES+1                                                03028000
CVTRSV42 EQU   CVTHJES                                                  03029000
CVTEXT2A EQU   CVTEXT2+1                                                03030000
CVTRSV41 EQU   CVTEXT2                                                  03031000
CVTAPFA  EQU   CVTAPF+1                                                 03032000
CVTRSV40 EQU   CVTAPF                                                   03033000
CVTRV518 EQU   CVTINTLA                                                 03034000
CVTRV517 EQU   CVTERPV                                                  03035000
CVTEORM  EQU   CVTMAP+312                                               03036000
CVTMCHPR EQU   CVTMAP+308                                               03037000
CVTTZ    EQU   CVTMAP+304                                               03038000
CVTJEPS  EQU   CVTMAP+300                                               03039000
CVTJESCT EQU   CVTMAP+296                                               03040000
CVTMODE  EQU   CVTMAP+292                                               03041000
CVTPTRV  EQU   CVTMAP+288                                               03042000
CVTREAL  EQU   CVTMAP+284                                               03043000
CVTRSV39 EQU   CVTMAP+280                                               03044000
CVTRSV38 EQU   CVTMAP+276                                               03045000
CVTDMSRA EQU   CVTDMSR+1                                                03046000
CVTRV634 EQU   CVTDMSRF                                                 03047000
CVTRV633 EQU   CVTDMSRF                                                 03048000
CVTRV632 EQU   CVTDMSRF                                                 03049000
CVTRV631 EQU   CVTDMSRF                                                 03050000
CVTRV630 EQU   CVTDMSRF                                                 03051000
CVTRV629 EQU   CVTDMSRF                                                 03052000
CVTUDUMP EQU   CVTDMSRF                                                 03053000
CVTSDUMP EQU   CVTDMSRF                                                 03054000
CVTQMSGA EQU   CVTQMSG+1                                                03055000
CVTRSV36 EQU   CVTQMSG                                                  03056000
CVTAMFF  EQU   CVTMAP+264                                               03057000
CVTPURGA EQU   CVTPURG+1                                                03058000
CVTRSV35 EQU   CVTPURG                                                  03059000
CVTCBSP  EQU   CVTMAP+256                                               03060000
CVTATERA EQU   CVTATER+1                                                03061000
CVTSYST  EQU   CVTATER                                                  03062000
CVTVOLT2 EQU   CVTTAT                                                   03063000
CVTVOLI2 EQU   CVTVOLF2                                                 03064000
CVTAQAVB EQU   CVTAQAVT+1                                               03065000
CVTRSV34 EQU   CVTTCMFG                                                 03066000
CVTRSV33 EQU   CVTTCMFG                                                 03067000
CVTRSV32 EQU   CVTTCMFG                                                 03068000
CVTRSV31 EQU   CVTTCMFG                                                 03069000
CVTRSV30 EQU   CVTTCMFG                                                 03070000
CVTRSV29 EQU   CVTTCMFG                                                 03071000
CVTRSV28 EQU   CVTTCMFG                                                 03072000
CVTTCRDY EQU   CVTTCMFG                                                 03073000
CVTGTFA  EQU   CVTGTF+1                                                 03074000
CVTRSV27 EQU   CVTGTFST                                                 03075000
CVTRNIO  EQU   CVTGTFST                                                 03076000
CVTUSR   EQU   CVTGTFST                                                 03077000
CVTRV318 EQU   CVTFORM                                                  03078000
CVTRV317 EQU   CVTTMODE                                                 03079000
CVTRV316 EQU   CVTSTATE                                                 03080000
CVTRV315 EQU   CVTGTFS                                                  03081000
CVTGTFAV EQU   CVTGTFS                                                  03082000
CVT0SCR1 EQU   CVTMAP+232                                               03083000
CVTRV515 EQU   CVTMAP+228                                               03084000
CVTRMS   EQU   CVTMAP+224                                               03085000
CVTPATCH EQU   CVTMAP+220                                               03086000
CVTTSCE  EQU   CVTMAP+216                                               03087000
CVTLNKSC EQU   CVTMAP+214                                               03088000
CVTQABST EQU   CVTMAP+212                                               03089000
CVTMDLDS EQU   CVTMAP+208                                               03090000
CVTUSER  EQU   CVTMAP+204                                               03091000
CVTABEND EQU   CVTMAP+200                                               03092000
CVTSMCA  EQU   CVTMAP+196                                               03093000
CVTRSV18 EQU   CVTMAP+192                                               03094000
CVTQLPAQ EQU   CVTMAP+188                                               03095000
CVTQCDSR EQU   CVTMAP+184                                               03096000
CVTRSV17 EQU   CVTOPTB                                                  03097000
CVTRSV16 EQU   CVTOPTB                                                  03098000
CVTFP    EQU   CVTOPTB                                                  03099000
CVTAPTHR EQU   CVTOPTB                                                  03100000
CVTNLOG  EQU   CVTOPTB                                                  03101000
CVTTOD   EQU   CVTOPTB                                                  03102000
CVTCTIMS EQU   CVTOPTB                                                  03103000
CVTPROT  EQU   CVTOPTB                                                  03104000
CVTXPFP  EQU   CVTOPTA                                                  03105000
CVTASCII EQU   CVTOPTA                                                  03106000
CVTRSV13 EQU   CVTOPTA                                                  03107000
CVTRSV12 EQU   CVTOPTA                                                  03108000
CVTNIP   EQU   CVTOPTA                                                  03109000
CVTDDR   EQU   CVTOPTA                                                  03110000
CVTAPR   EQU   CVTOPTA                                                  03111000
CVTCCH   EQU   CVTOPTA                                                  03112000
CVTSNCTR EQU   CVTMAP+180                                               03113000
CVTQMWR  EQU   CVTMAP+176                                               03114000
CVTQOCR  EQU   CVTMAP+172                                               03115000
CVT1EF00 EQU   CVTMAP+168                                               03116000
CVTMZ00  EQU   CVTMAP+164                                               03117000
CVTHEAD  EQU   CVTMAP+160                                               03118000
CVTRSV11 EQU   CVTMAP+156                                               03119000
CVT0PT01 EQU   CVTMAP+152                                               03120000
CVTMSER  EQU   CVTMAP+148                                               03121000
CVTRV516 EQU   CVTIERLC                                                 03122000
CVTILCH  EQU   CVTMAP+140                                               03123000
CVT0DS   EQU   CVTMAP+136                                               03124000
CVTFBOSV EQU   CVTMAP+132                                               03125000
CVTNUCB  EQU   CVTMAP+128                                               03126000
CVTIXAVL EQU   CVTMAP+124                                               03127000
CVTIOQET EQU   CVTMAP+120                                               03128000
CVTDCBA  EQU   CVTMAP+117                                               03129000
CVTMVS2  EQU   CVTDCB                                                   03130000
CVT6DAT  EQU   CVTDCB                                                   03131000
CVT4MPS  EQU   CVTDCB                                                   03132000
CVTRSV09 EQU   CVTDCB                                                   03133000
CVT4MS1  EQU   CVTDCB                                                   03134000
CVT2SPS  EQU   CVTDCB                                                   03135000
CVT1SSS  EQU   CVTDCB                                                   03136000
CVTRSV08 EQU   CVTDCB                                                   03137000
CVTSTB   EQU   CVTMAP+112                                               03138000
CVTQTD00 EQU   CVTMAP+108                                               03139000
CVTQTE00 EQU   CVTMAP+104                                               03140000
CVTCUCB  EQU   CVTMAP+100                                               03141000
CVTSJQ   EQU   CVTMAP+96                                                03142000
CVTPBLDL EQU   CVTMAP+92                                                03143000
CVTTPC   EQU   CVTMAP+88                                                03144000
CVTSVDCB EQU   CVTMAP+84                                                03145000
CVTBRET  EQU   CVTMAP+82                                                03146000
CVTEXIT  EQU   CVTMAP+80                                                03147000
CVT0FN00 EQU   CVTMAP+76                                                03148000
CVTDARA  EQU   CVTDAR+1                                                 03149000
CVTRSV07 EQU   CVTFLGS1                                                 03150000
CVTRSV06 EQU   CVTFLGS1                                                 03151000
CVTRSV05 EQU   CVTFLGS1                                                 03152000
CVTRSV04 EQU   CVTFLGS1                                                 03153000
CVTRSV03 EQU   CVTFLGS1                                                 03154000
CVTRSV02 EQU   CVTFLGS1                                                 03155000
CVTRSV01 EQU   CVTFLGS1                                                 03156000
CVTDMPLK EQU   CVTFLGS1                                                 03157000
CVTXITP  EQU   CVTMAP+68                                                03158000
CVTZDTAB EQU   CVTMAP+64                                                03159000
CVTMSLT  EQU   CVTMAP+60                                                03160000
CVTDATE  EQU   CVTMAP+56                                                03161000
CVTBTERM EQU   CVTMAP+52                                                03162000
CVTSYSAD EQU   CVTMAP+48                                                03163000
CVTXTLER EQU   CVTMAP+44                                                03164000
CVTILK2  EQU   CVTMAP+40                                                03165000
CVTILK1  EQU   CVTMAP+36                                                03166000
CVTPRLTV EQU   CVTMAP+32                                                03167000
CVTPCNVT EQU   CVTMAP+28                                                03168000
CVT0VL00 EQU   CVTMAP+24                                                03169000
CVTXAPG  EQU   CVTMAP+20                                                03170000
CVTBUF   EQU   CVTMAP+16                                                03171000
CVTJOB   EQU   CVTMAP+12                                                03172000
CVTLINK  EQU   CVTMAP+8                                                 03173000
CVT0EF00 EQU   CVTMAP+4                                                 03174000
CVTTCBP  EQU   CVTMAP                                                   03175000
CVT      EQU   CVTMAP                                                   03176000
@NM00004 EQU   TCBXTNT2+32                                              03177000
TCBRV181 EQU   TCBRV173                                                 03178000
TCBRV180 EQU   TCBRV173                                                 03179000
TCBRV179 EQU   TCBRV173                                                 03180000
TCBRV178 EQU   TCBRV173                                                 03181000
TCBRV177 EQU   TCBRV173                                                 03182000
TCBRV176 EQU   TCBRV173                                                 03183000
TCBRV175 EQU   TCBRV173                                                 03184000
TCBRV174 EQU   TCBRV173                                                 03185000
TCBRV172 EQU   TCBRV164                                                 03186000
TCBRV171 EQU   TCBRV164                                                 03187000
TCBRV170 EQU   TCBRV164                                                 03188000
TCBRV169 EQU   TCBRV164                                                 03189000
TCBRV168 EQU   TCBRV164                                                 03190000
TCBRV167 EQU   TCBRV164                                                 03191000
TCBRV166 EQU   TCBRV164                                                 03192000
TCBRV165 EQU   TCBRV164                                                 03193000
TCBRV163 EQU   TCBRV155                                                 03194000
TCBRV162 EQU   TCBRV155                                                 03195000
TCBRV161 EQU   TCBRV155                                                 03196000
TCBRV160 EQU   TCBRV155                                                 03197000
TCBRV159 EQU   TCBRV155                                                 03198000
TCBRV158 EQU   TCBRV155                                                 03199000
TCBRV157 EQU   TCBRV155                                                 03200000
TCBRV156 EQU   TCBRV155                                                 03201000
TCBRV154 EQU   TCBRV146                                                 03202000
TCBRV153 EQU   TCBRV146                                                 03203000
TCBRV152 EQU   TCBRV146                                                 03204000
TCBRV151 EQU   TCBRV146                                                 03205000
TCBRV150 EQU   TCBRV146                                                 03206000
TCBRV149 EQU   TCBRV146                                                 03207000
TCBRV148 EQU   TCBRV146                                                 03208000
TCBRV147 EQU   TCBRV146                                                 03209000
TCBRV145 EQU   TCBXTNT2+26                                              03210000
TCBRV144 EQU   TCBXTNT2+24                                              03211000
TCBRV143 EQU   TCBXTNT2+20                                              03212000
TCBRV142 EQU   TCBXTNT2+16                                              03213000
TCBRSV49 EQU   TCBXTNT2+12                                              03214000
TCBEVENT EQU   TCBXTNT2+8                                               03215000
TCBRCMP  EQU   TCBXTNT2+5                                               03216000
TCBRSVAB EQU   TCBXTNT2+4                                               03217000
TCBGTFA  EQU   TCBGTF+1                                                 03218000
TCBRSV47 EQU   TCBTFLG                                                  03219000
TCBRSV46 EQU   TCBTFLG                                                  03220000
TCBRSV45 EQU   TCBTFLG                                                  03221000
TCBRSV44 EQU   TCBTFLG                                                  03222000
TCBRSV43 EQU   TCBTFLG                                                  03223000
TCBDSPIT EQU   TCBTFLG                                                  03224000
TCBERRTN EQU   TCBTFLG                                                  03225000
TCBASYNC EQU   TCBTFLG                                                  03226000
@NM00003 EQU   TCB+296                                                  03227000
TCBSVCA2 EQU   TCB+292                                                  03228000
TCBSWASA EQU   TCB+288                                                  03229000
TCBDBTB  EQU   TCB+284                                                  03230000
TCBRPT   EQU   TCB+280                                                  03231000
TCBRV141 EQU   TCBRV133                                                 03232000
TCBRV140 EQU   TCBRV133                                                 03233000
TCBRV139 EQU   TCBRV133                                                 03234000
TCBRV138 EQU   TCBRV133                                                 03235000
TCBRV137 EQU   TCBRV133                                                 03236000
TCBRV136 EQU   TCBRV133                                                 03237000
TCBRV135 EQU   TCBRV133                                                 03238000
TCBRV134 EQU   TCBRV133                                                 03239000
TCBRV132 EQU   TCBRV124                                                 03240000
TCBRV131 EQU   TCBRV124                                                 03241000
TCBRV130 EQU   TCBRV124                                                 03242000
TCBRV129 EQU   TCBRV124                                                 03243000
TCBRV128 EQU   TCBRV124                                                 03244000
TCBRV127 EQU   TCBRV124                                                 03245000
TCBRV126 EQU   TCBRV124                                                 03246000
TCBRV125 EQU   TCBRV124                                                 03247000
TCBRV123 EQU   TCBFBYT2                                                 03248000
TCBRV122 EQU   TCBFBYT2                                                 03249000
TCBECBNV EQU   TCBFBYT2                                                 03250000
TCBSSSYN EQU   TCBFBYT2                                                 03251000
TCBFPRAP EQU   TCBFBYT2                                                 03252000
TCBFDW   EQU   TCBFBYT2                                                 03253000
TCBFMW   EQU   TCBFBYT2                                                 03254000
TCBCNCB  EQU   TCBFBYT2                                                 03255000
TCBLLH   EQU   TCBFBYT1                                                 03256000
TCBRV113 EQU   TCBFBYT1                                                 03257000
TCBEOT   EQU   TCBFBYT1                                                 03258000
TCBRTM2  EQU   TCBFBYT1                                                 03259000
TCBPGNLY EQU   TCBFBYT1                                                 03260000
TCBNDIOS EQU   TCBFBYT1                                                 03261000
TCBRV327 EQU   TCBFBYT1                                                 03262000
TCBEOTFM EQU   TCBFBYT1                                                 03263000
TCBAFFN  EQU   TCB+274                                                  03264000
TCBRV326 EQU   TCB+272                                                  03265000
TCBUKYSP EQU   TCB+268                                                  03266000
TCBMODE  EQU   TCBESTAE+3                                               03267000
TCBERTYP EQU   TCBESTAE+2                                               03268000
TCBRV314 EQU   TCBESTRM                                                 03269000
TCBRV313 EQU   TCBESTRM                                                 03270000
TCBRV312 EQU   TCBESTRM                                                 03271000
TCBRV311 EQU   TCBESTRM                                                 03272000
TCBRV310 EQU   TCBESTRM                                                 03273000
TCBRV309 EQU   TCBESTRM                                                 03274000
TCBRV308 EQU   TCBESTRM                                                 03275000
TCBETERM EQU   TCBESTRM                                                 03276000
TCBSCBKY EQU   TCBESTAE                                                 03277000
TCBRTM12 EQU   TCB+260                                                  03278000
TCBTCBID EQU   TCB+256                                                  03279000
TCBSTAWA EQU   TCB+252                                                  03280000
TCBSWA   EQU   TCB+248                                                  03281000
TCBFOEA  EQU   TCBFOE+1                                                 03282000
TCBRSV42 EQU   TCBFOE                                                   03283000
TCBCCPVI EQU   TCBXSCT+2                                                03284000
TCBRV325 EQU   TCBXSCT+1                                                03285000
TCBRV324 EQU   TCBXSCT1                                                 03286000
TCBRV323 EQU   TCBXSCT1                                                 03287000
TCBRV322 EQU   TCBXSCT1                                                 03288000
TCBRV321 EQU   TCBXSCT1                                                 03289000
TCBRV320 EQU   TCBXSCT1                                                 03290000
TCBRV319 EQU   TCBXSCT1                                                 03291000
TCBS3A   EQU   TCBXSCT1                                                 03292000
TCBACTIV EQU   TCBXSCT1                                                 03293000
TCBRSV41 EQU   TCB+239                                                  03294000
TCBTID   EQU   TCB+238                                                  03295000
TCBRSVAA EQU   TCB+237                                                  03296000
TCBABCUR EQU   TCB+236                                                  03297000
TCBTMSAV EQU   TCB+232                                                  03298000
TCBIOTIM EQU   TCB+228                                                  03299000
TCBRTWA  EQU   TCB+224                                                  03300000
TCBBACK  EQU   TCB+220                                                  03301000
TCBTIRB  EQU   TCB+216                                                  03302000
TCBAECB  EQU   TCB+212                                                  03303000
TCBEXT2A EQU   TCBEXT2+1                                                03304000
TCBRSV39 EQU   TCBEXT2                                                  03305000
TCBSTMCT EQU   TCB+207                                                  03306000
TCBSYSCT EQU   TCB+206                                                  03307000
TCBRSV37 EQU   TCB+205                                                  03308000
TCBEXSVC EQU   TCBDAR                                                   03309000
TCBDARMS EQU   TCBDAR                                                   03310000
TCBDARWT EQU   TCBDAR                                                   03311000
TCBDARO  EQU   TCBDAR                                                   03312000
TCBDARMC EQU   TCBDARC                                                  03313000
TCBDARD  EQU   TCBDAR                                                   03314000
TCBDARS  EQU   TCBDAR                                                   03315000
TCBDARP  EQU   TCBDAR                                                   03316000
TCBGTOFM EQU   TCBFLGS7                                                 03317000
TCBADMP  EQU   TCBFLGS7                                                 03318000
TCBRSTSK EQU   TCBFLGS7                                                 03319000
TCBSVCS  EQU   TCBFLGS7                                                 03320000
TCBSTACK EQU   TCBFLGS7                                                 03321000
TCBRSV34 EQU   TCBFLGS7                                                 03322000
TCBRSV33 EQU   TCBFLGS7                                                 03323000
TCBGPECB EQU   TCBFLGS7                                                 03324000
TCBNTJS  EQU   TCBFLGS6                                                 03325000
TCBAPG   EQU   TCBFLGS6                                                 03326000
TCBMIGR  EQU   TCBFLGS6                                                 03327000
TCBRV303 EQU   TCBFLGS6                                                 03328000
TCBSPVLK EQU   TCBFLGS6                                                 03329000
TCBCPU   EQU   TCBFLGS6                                                 03330000
TCBPIE17 EQU   TCBFLGS6                                                 03331000
TCBRSV79 EQU   TCBNDSP5                                                 03332000
TCBRSV78 EQU   TCBNDSP5                                                 03333000
TCBRSV77 EQU   TCBNDSP5                                                 03334000
TCBRSV76 EQU   TCBNDSP5                                                 03335000
TCBRSV75 EQU   TCBNDSP5                                                 03336000
TCBRSV74 EQU   TCBNDSP5                                                 03337000
TCBRSV95 EQU   TCBNDSP5                                                 03338000
TCBRSV94 EQU   TCBNDSP5                                                 03339000
TCBRSV93 EQU   TCBNDSP4                                                 03340000
TCBRSV92 EQU   TCBNDSP4                                                 03341000
TCBRSV91 EQU   TCBNDSP4                                                 03342000
TCBRSV90 EQU   TCBNDSP4                                                 03343000
TCBRSV89 EQU   TCBNDSP4                                                 03344000
TCBRSV88 EQU   TCBNDSP4                                                 03345000
TCBRSV87 EQU   TCBNDSP4                                                 03346000
TCBRSV86 EQU   TCBNDSP4                                                 03347000
TCBEXT1A EQU   TCBEXT1+1                                                03348000
TCBRSV32 EQU   TCBEXT1                                                  03349000
TCBEXCPD EQU   TCB+192                                                  03350000
TCBIOBRC EQU   TCB+188                                                  03351000
TCBDDWTC EQU   TCB+186                                                  03352000
TCBDDEXC EQU   TCB+184                                                  03353000
TCBJSCBB EQU   TCBJSCB+1                                                03354000
@NM00002 EQU   TCBRECDE                                                 03355000
TCBREC   EQU   TCBRECDE                                                 03356000
TCBMDIDS EQU   TCB+176                                                  03357000
TCBNDINT EQU   TCBNDSP3                                                 03358000
TCBRSV27 EQU   TCBNDSP3                                                 03359000
TCBRSV26 EQU   TCBNDSP3                                                 03360000
TCBRSV25 EQU   TCBNDSP3                                                 03361000
TCBRSV24 EQU   TCBNDSP3                                                 03362000
TCBSRBND EQU   TCBNDSP3                                                 03363000
TCBRV302 EQU   TCBNDSP3                                                 03364000
TCBLJSND EQU   TCBNDSP3                                                 03365000
TCBABE   EQU   TCBNDSP2                                                 03366000
TCBDSS   EQU   TCBNDSP2                                                 03367000
TCBOWAIT EQU   TCBNDSP2                                                 03368000
TCBIWAIT EQU   TCBNDSP2                                                 03369000
TCBNDTS  EQU   TCBNDSP2                                                 03370000
TCBNDSVC EQU   TCBNDSP2                                                 03371000
TCBSTPP  EQU   TCBNDSP2                                                 03372000
TCBABD   EQU   TCBNDSP2                                                 03373000
TCBRSV22 EQU   TCBNDSP1                                                 03374000
TCBPIEND EQU   TCBNDSP1                                                 03375000
TCBTPSP  EQU   TCBNDSP1                                                 03376000
TCBDDRND EQU   TCBNDSP1                                                 03377000
TCBRSPND EQU   TCBNDSP1                                                 03378000
TCBRSTND EQU   TCBNDSP1                                                 03379000
TCBDARPN EQU   TCBNDSP1                                                 03380000
TCBDARTN EQU   TCBNDSP1                                                 03381000
TCBNDSP0 EQU   TCBNDSP                                                  03382000
TCBUSER  EQU   TCB+168                                                  03383000
TCBTCTB  EQU   TCBTCT+1                                                 03384000
TCBRSV9C EQU   TCBTCTGF                                                 03385000
TCBRSV9B EQU   TCBTCTGF                                                 03386000
TCBRSV9A EQU   TCBTCTGF                                                 03387000
TCBRSV99 EQU   TCBTCTGF                                                 03388000
TCBRSV98 EQU   TCBTCTGF                                                 03389000
TCBRSV97 EQU   TCBTCTGF                                                 03390000
TCBRSV20 EQU   TCBTCTGF                                                 03391000
TCBSMFGF EQU   TCBTCTGF                                                 03392000
TCBSTABB EQU   TCBSTAB+1                                                03393000
TCBSTCUR EQU   TCBNSTAE                                                 03394000
TCBRV301 EQU   TCBNSTAE                                                 03395000
TCBSYNCH EQU   TCBNSTAE                                                 03396000
TCBHALT  EQU   TCBNSTAE                                                 03397000
TCBPPSUP EQU   TCBNSTAE                                                 03398000
TCB33E   EQU   TCBNSTAE                                                 03399000
TCBQUIES EQU   TCBNSTAE                                                 03400000
TCBSTABE EQU   TCBNSTAE                                                 03401000
TCBAQE   EQU   TCB+156                                                  03402000
TCBTSDP  EQU   TCB+151                                                  03403000
TCBTSLP  EQU   TCB+150                                                  03404000
TCBSTPCT EQU   TCB+149                                                  03405000
TCBCPUBN EQU   TCBTSFLG                                                 03406000
TCBDYDSP EQU   TCBTSFLG                                                 03407000
TCBRSV18 EQU   TCBTSFLG                                                 03408000
TCBRSV17 EQU   TCBTSFLG                                                 03409000
TCBTIOTG EQU   TCBTSFLG                                                 03410000
TCBATT   EQU   TCBTSFLG                                                 03411000
TCBSTPPR EQU   TCBTSFLG                                                 03412000
TCBRV300 EQU   TCBTSTSK                                                 03413000
TCBECB   EQU   TCB+144                                                  03414000
TCBIQE   EQU   TCB+140                                                  03415000
TCBLTC   EQU   TCB+136                                                  03416000
TCBOTC   EQU   TCB+132                                                  03417000
TCBNTC   EQU   TCB+128                                                  03418000
TCBJSTCA EQU   TCBJSTCB+1                                               03419000
TCBRSV16 EQU   TCBJSTCB                                                 03420000
TCBTQET  EQU   TCBTME                                                   03421000
TCBTCB   EQU   TCB+116                                                  03422000
TCBFSAB  EQU   TCBFSA+1                                                 03423000
TCBQEL   EQU   TCBFSA                                                   03424000
TCBGRS15 EQU   TCBGRS+60                                                03425000
TCBGRS14 EQU   TCBGRS+56                                                03426000
TCBGRS13 EQU   TCBGRS+52                                                03427000
TCBGRS12 EQU   TCBGRS+48                                                03428000
TCBGRS11 EQU   TCBGRS+44                                                03429000
TCBGRS10 EQU   TCBGRS+40                                                03430000
TCBGRS9  EQU   TCBGRS+36                                                03431000
TCBGRS8  EQU   TCBGRS+32                                                03432000
TCBGRS7  EQU   TCBGRS+28                                                03433000
TCBGRS6  EQU   TCBGRS+24                                                03434000
TCBGRS5  EQU   TCBGRS+20                                                03435000
TCBGRS4  EQU   TCBGRS+16                                                03436000
TCBGRS3  EQU   TCBGRS+12                                                03437000
TCBGRS2  EQU   TCBGRS+8                                                 03438000
TCBGRS1  EQU   TCBGRS+4                                                 03439000
TCBGRS0  EQU   TCBGRS                                                   03440000
TCBJPQB  EQU   TCBJPQ+1                                                 03441000
TCBRSV15 EQU   TCBPURGE                                                 03442000
TCBRSV14 EQU   TCBPURGE                                                 03443000
TCBRSV13 EQU   TCBPURGE                                                 03444000
TCBRSV12 EQU   TCBPURGE                                                 03445000
TCBRSV11 EQU   TCBPURGE                                                 03446000
TCBRSV10 EQU   TCBPURGE                                                 03447000
TCBRSV09 EQU   TCBPURGE                                                 03448000
TCBJPQF  EQU   TCBPURGE                                                 03449000
TCBJLB   EQU   TCB+40                                                   03450000
TCBLLS   EQU   TCB+36                                                   03451000
TCBDSP   EQU   TCB+35                                                   03452000
TCBLMP   EQU   TCB+34                                                   03453000
TCBPNDSP EQU   TCBFLGS5                                                 03454000
TCBFCD1  EQU   TCBFLGS5                                                 03455000
TCBSTP   EQU   TCBFLGS5                                                 03456000
TCBSYS   EQU   TCBFLGS5                                                 03457000
TCBANDSP EQU   TCBFLGS5                                                 03458000
TCBPAGE  EQU   TCBFLGS5                                                 03459000
TCBUXNDF EQU   TCBABWF                                                  03460000
TCBFC    EQU   TCBFLGS5                                                 03461000
TCBONDSP EQU   TCBFLGS4                                                 03462000
TCBMPCND EQU   TCBFLGS4                                                 03463000
TCBMPCVQ EQU   TCBFLGS4                                                 03464000
TCBUXNDV EQU   TCBFLGS4                                                 03465000
TCBHNDSP EQU   TCBFLGS4                                                 03466000
TCBRQENA EQU   TCBFLGS4                                                 03467000
TCBSER   EQU   TCBFLGS4                                                 03468000
TCBNDUMP EQU   TCBFLGS4                                                 03469000
TCBDWSTA EQU   TCBFLGS3                                                 03470000
TCBRSV08 EQU   TCBFLGS3                                                 03471000
TCBRSV07 EQU   TCBFLGS3                                                 03472000
TCBRSV06 EQU   TCBFLGS3                                                 03473000
TCBABGM  EQU   TCBFLGS3                                                 03474000
TCBABTRM EQU   TCBFLGS3                                                 03475000
TCBADINP EQU   TCBFLGS3                                                 03476000
TCBFSM   EQU   TCBFLGS3                                                 03477000
TCBFTS   EQU   TCBFLGS2                                                 03478000
TCBFETXR EQU   TCBFLGS2                                                 03479000
TCBFDSOP EQU   TCBFLGS2                                                 03480000
TCBFJMC  EQU   TCBFLGS2                                                 03481000
TCBFSMC  EQU   TCBFLGS2                                                 03482000
TCBFABOP EQU   TCBFLGS2                                                 03483000
TCBFSTI  EQU   TCBFLGS2                                                 03484000
TCBFOINP EQU   TCBFLGS2                                                 03485000
TCBFX    EQU   TCBFLGS1                                                 03486000
TCBFS    EQU   TCBFLGS1                                                 03487000
TCBFT    EQU   TCBFLGS1                                                 03488000
TCBPDUMP EQU   TCBFLGS1                                                 03489000
TCBNONPR EQU   TCBFLGS1                                                 03490000
TCBFERA  EQU   TCBFLGS1                                                 03491000
TCBFE    EQU   TCBFLGS1                                                 03492000
TCBFA    EQU   TCBFLGS1                                                 03493000
TCBZERO  EQU   TCBPKF                                                   03494000
TCBFLAG  EQU   TCBPKF                                                   03495000
TCBMSSB  EQU   TCBMSS+1                                                 03496000
TCBRSV03 EQU   TCBMSS                                                   03497000
TCBTRNB  EQU   TCBTRN+1                                                 03498000
TCBRSV02 EQU   TCBABF                                                   03499000
TCBOLTEP EQU   TCBABF                                                   03500000
TCBTCP   EQU   TCBABF                                                   03501000
TCBTCPP  EQU   TCBABF                                                   03502000
TCBRSV01 EQU   TCBABF                                                   03503000
TCBGRPH  EQU   TCBABF                                                   03504000
TCBNOCHK EQU   TCBABF                                                   03505000
TCBMOD91 EQU   TCBABF                                                   03506000
TCBCMPC  EQU   TCBCMP+1                                                 03507000
TCBRV318 EQU   TCBCMSG                                                  03508000
TCBRV317 EQU   TCBCIND                                                  03509000
TCBRV316 EQU   TCBCWTO                                                  03510000
TCBCASID EQU   TCBCDBL                                                  03511000
TCBNOCC  EQU   TCBSTCC                                                  03512000
TCBDMPO  EQU   TCBCPP                                                   03513000
TCBCSTEP EQU   TCBCMPF                                                  03514000
TCBCREQ  EQU   TCBCMPF                                                  03515000
TCBTIO   EQU   TCB+12                                                   03516000
TCBDEB   EQU   TCB+8                                                    03517000
TCBPIEA  EQU   TCBPIE+1                                                 03518000
TCBPM    EQU   TCBPMASK                                                 03519000
@NM00001 EQU   TCBPMASK                                                 03520000
TCBRBP   EQU   TCB                                                      03521000
TCBFRS6  EQU   TCBFRS+24                                                03522000
TCBFRS4  EQU   TCBFRS+16                                                03523000
TCBFRS2  EQU   TCBFRS+8                                                 03524000
TCBFRS0  EQU   TCBFRS                                                   03525000
@NM00032 EQU   PSA+3668                                                 03526000
PSASTAK  EQU   PSA+3072                                                 03527000
@NM00031 EQU   PSA+1048                                                 03528000
PSAUSEND EQU   PSA+1048                                                 03529000
PSARV062 EQU   PSA+1044                                                 03530000
PSACDAL  EQU   PSA+1040                                                 03531000
PSAWTCOD EQU   PSA+1036                                                 03532000
PSAATCVT EQU   PSA+1032                                                 03533000
PSAPCPSW EQU   PSA+1024                                                 03534000
PSAPIR2  EQU   PSA+1020                                                 03535000
PSARV059 EQU   PSA+1018                                                 03536000
PSASVC13 EQU   PSA+1016                                                 03537000
PSALSFCC EQU   PSA+1012                                                 03538000
PSASFACC EQU   PSA+1008                                                 03539000
PSASTOP  EQU   PSA+992                                                  03540000
PSASTART EQU   PSA+976                                                  03541000
PSARSPSW EQU   PSA+968                                                  03542000
PSASRPSW EQU   PSA+960                                                  03543000
PSARV045 EQU   PSA+892                                                  03544000
PSARV044 EQU   PSA+888                                                  03545000
PSARV043 EQU   PSA+884                                                  03546000
PSARV042 EQU   PSA+880                                                  03547000
PSARV041 EQU   PSA+876                                                  03548000
PSARV040 EQU   PSA+872                                                  03549000
PSARV025 EQU   PSA+868                                                  03550000
PSADSSED EQU   PSA+868                                                  03551000
PSADSSPR EQU   PSA+864                                                  03552000
PSADSSFW EQU   PSA+860                                                  03553000
PSADSS14 EQU   PSA+856                                                  03554000
PSADSSPP EQU   PSA+848                                                  03555000
PSADSSRP EQU   PSA+840                                                  03556000
PSADSS05 EQU   PSADSSF4                                                 03557000
PSADSS10 EQU   PSADSSF4                                                 03558000
PSADSSVE EQU   PSADSSF4                                                 03559000
PSADSSDE EQU   PSADSSF4                                                 03560000
PSADSSC0 EQU   PSADSSF4                                                 03561000
PSADSSIE EQU   PSADSSF4                                                 03562000
PSADSS12 EQU   PSADSSF4                                                 03563000
PSADSSRC EQU   PSADSSF4                                                 03564000
PSARV057 EQU   PSADSSF3                                                 03565000
PSARV056 EQU   PSADSSF3                                                 03566000
PSARV055 EQU   PSADSSF3                                                 03567000
PSADSSMC EQU   PSADSSF3                                                 03568000
PSADSSRW EQU   PSADSSF3                                                 03569000
PSADSSNM EQU   PSADSSF3                                                 03570000
PSADSSES EQU   PSADSSF3                                                 03571000
PSADSSGP EQU   PSADSSF3                                                 03572000
PSADSSF2 EQU   PSADSSFL+1                                               03573000
PSADSSPI EQU   PSADSSF1                                                 03574000
PSADSSOI EQU   PSADSSF1                                                 03575000
PSADSSSP EQU   PSADSSF1                                                 03576000
PSADSSTP EQU   PSADSSF1                                                 03577000
PSADSSDW EQU   PSADSSF1                                                 03578000
PSADSSDD EQU   PSADSSF1                                                 03579000
PSADSSDM EQU   PSADSSF1                                                 03580000
PSADSSMV EQU   PSADSSF1                                                 03581000
PSADSSTS EQU   PSA+816                                                  03582000
PSADSSWK EQU   PSA+812                                                  03583000
PSADSSR3 EQU   PSA+808                                                  03584000
PSADSSR2 EQU   PSA+804                                                  03585000
PSADSSRS EQU   PSA+800                                                  03586000
PSASTOR  EQU   PSA+796                                                  03587000
PSACPUSA EQU   PSA+794                                                  03588000
PSAVSTAP EQU   PSA+792                                                  03589000
PSAWKVAP EQU   PSA+788                                                  03590000
PSAWKRAP EQU   PSA+784                                                  03591000
PSAMCHIC EQU   PSA+783                                                  03592000
PSARV061 EQU   PSA+782                                                  03593000
PSASYMSK EQU   PSA+781                                                  03594000
PSAMCHFL EQU   PSA+780                                                  03595000
PSACR0   EQU   PSA+776                                                  03596000
PSAPSWSV EQU   PSA+768                                                  03597000
PSALITA  EQU   PSA+764                                                  03598000
PSACLHS  EQU   PSAHLHI                                                  03599000
PSALKR15 EQU   PSALKSA+60                                               03600000
PSALKR14 EQU   PSALKSA+56                                               03601000
PSALKR13 EQU   PSALKSA+52                                               03602000
PSALKR12 EQU   PSALKSA+48                                               03603000
PSALKR11 EQU   PSALKSA+44                                               03604000
PSALKR10 EQU   PSALKSA+40                                               03605000
PSALKR9  EQU   PSALKSA+36                                               03606000
PSALKR8  EQU   PSALKSA+32                                               03607000
PSALKR7  EQU   PSALKSA+28                                               03608000
PSALKR6  EQU   PSALKSA+24                                               03609000
PSALKR5  EQU   PSALKSA+20                                               03610000
PSALKR4  EQU   PSALKSA+16                                               03611000
PSALKR3  EQU   PSALKSA+12                                               03612000
PSALKR2  EQU   PSALKSA+8                                                03613000
PSALKR1  EQU   PSALKSA+4                                                03614000
PSALKR0  EQU   PSALKSA                                                  03615000
PSARV023 EQU   PSACLHT+52                                               03616000
PSALOCAL EQU   PSACLHT+48                                               03617000
PSACMSL  EQU   PSACLHT+44                                               03618000
PSAOPTL  EQU   PSACLHT+40                                               03619000
PSATPACL EQU   PSACLHT+36                                               03620000
PSATPDNL EQU   PSACLHT+32                                               03621000
PSATPNCL EQU   PSACLHT+28                                               03622000
PSAIOSLL EQU   PSACLHT+24                                               03623000
PSAIOSUL EQU   PSACLHT+20                                               03624000
PSAIOSCL EQU   PSACLHT+16                                               03625000
PSAIOSSL EQU   PSACLHT+12                                               03626000
PSASALCL EQU   PSACLHT+8                                                03627000
PSAASML  EQU   PSACLHT+4                                                03628000
PSADISPL EQU   PSACLHT                                                  03629000
PSASRSA  EQU   PSA+636                                                  03630000
PSARV050 EQU   PSA+634                                                  03631000
PSADSSGO EQU   PSA+633                                                  03632000
PSARECUR EQU   PSA+632                                                  03633000
PSAHLHIS EQU   PSA+628                                                  03634000
PSAIPCSA EQU   PSA+624                                                  03635000
@NM00030 EQU   PSA+621                                                  03636000
PSAIPCDM EQU   PSA+620                                                  03637000
PSAIPCD  EQU   PSA+616                                                  03638000
@NM00029 EQU   PSA+613                                                  03639000
PSAIPCRM EQU   PSA+612                                                  03640000
PSAIPCR  EQU   PSA+608                                                  03641000
PSAMCHEX EQU   PSA+600                                                  03642000
PSAMPSW  EQU   PSA+592                                                  03643000
PSAEXPS2 EQU   PSA+584                                                  03644000
PSAEXPS1 EQU   PSA+576                                                  03645000
PSAPIREG EQU   PSA+572                                                  03646000
PSARSREG EQU   PSA+568                                                  03647000
PSAGPREG EQU   PSA+556                                                  03648000
PSARV022 EQU   PSASUP4                                                  03649000
PSARV021 EQU   PSASUP4                                                  03650000
PSARV020 EQU   PSASUP4                                                  03651000
PSARV019 EQU   PSASUP4                                                  03652000
PSARV018 EQU   PSASUP4                                                  03653000
PSARV017 EQU   PSASUP4                                                  03654000
PSARV016 EQU   PSASUP4                                                  03655000
PSARV015 EQU   PSASUP4                                                  03656000
PSARV014 EQU   PSASUP3                                                  03657000
PSARV013 EQU   PSASUP3                                                  03658000
PSARV012 EQU   PSASUP3                                                  03659000
PSAESTA  EQU   PSASUP3                                                  03660000
PSASPR   EQU   PSASUP3                                                  03661000
PSAPSREG EQU   PSASUP3                                                  03662000
PSAPI2   EQU   PSASUP3                                                  03663000
PSAIOSUP EQU   PSASUP3                                                  03664000
PSALCR   EQU   PSASUP2                                                  03665000
PSARTM   EQU   PSASUP2                                                  03666000
PSAACR   EQU   PSASUP2                                                  03667000
PSAIPCE2 EQU   PSASUP2                                                  03668000
PSAIPCES EQU   PSASUP2                                                  03669000
PSAIPCEC EQU   PSASUP2                                                  03670000
PSAGTF   EQU   PSASUP2                                                  03671000
PSAIPCRI EQU   PSASUP2                                                  03672000
PSATYPE6 EQU   PSASUP1                                                  03673000
PSATCTL  EQU   PSASUP1                                                  03674000
PSADISP  EQU   PSASUP1                                                  03675000
PSALOCK  EQU   PSASUP1                                                  03676000
PSAPI    EQU   PSASUP1                                                  03677000
PSAEXT   EQU   PSASUP1                                                  03678000
PSASVC   EQU   PSASUP1                                                  03679000
PSAIO    EQU   PSASUP1                                                  03680000
PSAANEW  EQU   PSA+544                                                  03681000
PSATNEW  EQU   PSA+536                                                  03682000
PSALCCAR EQU   PSA+532                                                  03683000
PSALCCAV EQU   PSA+528                                                  03684000
PSAPCCAR EQU   PSA+524                                                  03685000
PSAPCCAV EQU   PSA+520                                                  03686000
PSACPULA EQU   PSA+518                                                  03687000
PSACPUPA EQU   PSA+516                                                  03688000
PSAPSA   EQU   PSA+512                                                  03689000
FLCHDEND EQU   PSA+512                                                  03690000
FLCCRSAV EQU   FLCMCLA+280                                              03691000
FLCGRSAV EQU   FLCMCLA+216                                              03692000
FLCFPSAV EQU   FLCMCLA+184                                              03693000
FLCFLA   EQU   FLCMCLA+88                                               03694000
FLCRGNCD EQU   FLCMCLA+84                                               03695000
FLCFSAA  EQU   FLCFSA+1                                                 03696000
@NM00028 EQU   FLCFSA                                                   03697000
@NM00027 EQU   FLCMCLA+72                                               03698000
FLCMCIC  EQU   FLCMCLA+64                                               03699000
@NM00026 EQU   FLCMCLA+20                                               03700000
FLCIOAA  EQU   FLCIOA+1                                                 03701000
@NM00025 EQU   FLCIOA                                                   03702000
@NM00024 EQU   FLCMCLA+15                                               03703000
@NM00023 EQU   FLCMCLA+14                                               03704000
@NM00022 EQU   FLCMCLA+12                                               03705000
FLCLCL   EQU   FLCMCLA+8                                                03706000
FLCIOELA EQU   FLCIOEL+1                                                03707000
@NM00021 EQU   FLCIOEL                                                  03708000
FLCCHNID EQU   FLCMCLA                                                  03709000
@NM00020 EQU   PSA+160                                                  03710000
FLCMTRCD EQU   PSA+157                                                  03711000
@NM00019 EQU   PSA+156                                                  03712000
FLCPERA  EQU   FLCPER+1                                                 03713000
@NM00018 EQU   FLCPER                                                   03714000
@NM00017 EQU   PSA+151                                                  03715000
FLCPERCD EQU   PSA+150                                                  03716000
FLCMCNUM EQU   PSA+149                                                  03717000
@NM00016 EQU   PSA+148                                                  03718000
FLCTEAA  EQU   FLCTEA+1                                                 03719000
@NM00015 EQU   FLCTEA                                                   03720000
PSAPIPC  EQU   PSAPICOD                                                 03721000
PSAPIMC  EQU   PSAPICOD                                                 03722000
PSAPIPER EQU   PSAPICOD                                                 03723000
PSARV049 EQU   FLCPICOD                                                 03724000
FLCPILCB EQU   FLCPIILC                                                 03725000
@NM00014 EQU   FLCPIILC                                                 03726000
@NM00013 EQU   PSAEPPSW                                                 03727000
FLCSVCN  EQU   PSAESPSW+2                                               03728000
FLCSILCB EQU   FLCSVILC                                                 03729000
@NM00012 EQU   FLCSVILC                                                 03730000
@NM00011 EQU   PSAESPSW                                                 03731000
FLCEICOD EQU   PSAEEPSW+2                                               03732000
PSASPAD  EQU   PSAEEPSW                                                 03733000
@NM00010 EQU   PSA+128                                                  03734000
FLCINPSW EQU   PSA+120                                                  03735000
FLCMNPSW EQU   PSA+112                                                  03736000
FLCPNPSW EQU   PSA+104                                                  03737000
FLCSNPSW EQU   PSA+96                                                   03738000
FLCENPSW EQU   PSA+88                                                   03739000
FLCTRACE EQU   PSA+84                                                   03740000
FLCTIMER EQU   PSA+80                                                   03741000
FLCCVT2  EQU   PSA+76                                                   03742000
FLCCAW   EQU   PSA+72                                                   03743000
FLCCSW   EQU   PSA+64                                                   03744000
FLCIOPSW EQU   PSA+56                                                   03745000
FLCMOPSW EQU   PSA+48                                                   03746000
FLCPOPSW EQU   PSA+40                                                   03747000
FLCSOPSW EQU   PSA+32                                                   03748000
FLCEOPSW EQU   PSA+24                                                   03749000
@NM00009 EQU   FLCICCW2+4                                               03750000
FLCCVT   EQU   FLCICCW2                                                 03751000
FLCICCW1 EQU   FLCROPSW                                                 03752000
FLCIPPSW EQU   FLCRNPSW                                                 03753000
*                                      END UNREFERENCED COMPONENTS      03754000
@RT00117 EQU   GPFRR                                                    03755000
@RT00119 EQU   RECRS1                                                   03756000
@RT00123 EQU   RETRY                                                    03757000
@RT00125 EQU   RECRSION                                                 03758000
@RT00153 EQU   FREERL                                                   03759000
@RT00155 EQU   GPRETSET                                                 03760000
@RC00161 EQU   @RC00160                                                 03761000
@RF00182 EQU   GPRETSET                                                 03762000
@RT00187 EQU   GETRL                                                    03763000
@RT00202 EQU   RECRSION                                                 03764000
@RT00204 EQU   RECRSION                                                 03765000
@RF00222 EQU   OTHRERRS                                                 03766000
@RT00246 EQU   RET                                                      03767000
@RT00253 EQU   LASTEL                                                   03768000
@RF00286 EQU   RET                                                      03769000
@RC00291 EQU   @RC00290                                                 03770000
@RF00290 EQU   GPRETSET                                                 03771000
@RT00323 EQU   RET                                                      03772000
@RT00329 EQU   RET                                                      03773000
@RF00328 EQU   L4                                                       03774000
@RT00397 EQU   @EL00002                                                 03775000
@RT00399 EQU   NEWFBQE                                                  03776000
@PB00002 EQU   RET                                                      03777000
@RC00162 EQU   @RC00161                                                 03778000
@RC00292 EQU   @RC00291                                                 03779000
@RC00163 EQU   @RC00162                                                 03780000
@RC00293 EQU   @RC00292                                                 03781000
@RC00164 EQU   @RC00163                                                 03782000
@RC00294 EQU   @RC00293                                                 03783000
@RC00165 EQU   @RC00164                                                 03784000
@RC00295 EQU   @RC00294                                                 03785000
@ENDDATA EQU   *                                                        03786000
         END   IEAVGPRR,(C'PLS1401',0701,76087)                         03787000
./  ADD  SSI=43120059,NAME=IEAVGTCL
                 TITLE 'GET CELL ROUTINE --- IEAVGTCL'                  00050002
* /* START OF SPECIFICATIONS ****                                       00050102
*                                                                       00060102
*01*  MODULE-NAME = IEAVGTCL                                            00060502
*                                                                       00061702
*02*     CSECT-NAME = IEAVGTCL                                          00061802
*                                                                       00066402
*01*  DESCRIPTIVE-NAME = GET CELL FROM A QUICK-CELL POOL                00068402
*                                                                       00070802
*01*  COPYRIGHT = NONE                                                  00070902
*01*  STATUS = 02.00 -- 2/28/73                                         00077902
*                                                                       00078402
*01*  FUNCTION = ALLOCATE A CELL FROM A  QUICK-CELL POOL                00078502
*                                                                       00079402
*02*     OPERATION = USING THE CPID TO IDENTIFY AND LOCATE THE PROPER   00079802
*        POOL, THE GET CELL ROUTINE FINDS THE FIRST AVAILABLE CELL IN   00081802
*        THE FIRST NON-EMPTY SEGMENT (EXTENT) OF THE POOL. THE CELL     00083802
*        THUS FOUND IS SYNCHRONOUSLY DEQUEUED AND TESTES FOR ADDRESS    00084202
*        VALIDITY (IS THE ADDRESS IN THE POOL BOUNDS AND ON AN INTEGRAL 00084602
*        CELL BOUNDARY?). IF IT PASSES THESE TESTS, IT IS MARKED AS     00085002
*        ALLOCATED FROM THIS POOL AND RETURNED TO THE CALLER.           00085402
*                                                                       00085602
*01*   NOTES = STANDARD LINKAGE CONVENTIONS                             00086002
*                                                                       00086402
*02*     DEPENDENCIES = 370R-MP INSTRUCTION SET (CS AND CDS)            00086502
*                                                                       00089902
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00098402
*02*     RESTRICTIONS = DESIGN RESTRICTION --- CANNOT USE REGISTERS 5   00106402
*        THROUGH 13 INCLUSIVE.                                          00106802
*                                                                       00107202
*02*     REGISTER-CONVENTIONS = SEE REGISTER EQUATES AFTER CSECT        00107302
*        STATEMENT.                                                     00117302
*                                                                       00130902
*02*     PATCH-LABEL = NUCLEUS PATCH AREA                               00131602
*                                                                       00132802
*01*  MODULE-TYPE = MACRO-INVOKED PROCESSING SUBROUTINE                 00132902
*                                                                       00137702
*02*     PROCESSOR = ASSEMBLER-370R                                     00139702
*                                                                       00145502
*02*     MODULE-SIZE = 380 BYTES                                        00147502
*                                                                       00147802
*02*     ATTRIBUTES = REFRESHABLE NUCLEUS                               00151302
*                                                                       00154902
*01*  ENTRY-POINT = IEAVGTCL                                            00158502
*                                                                       00164302
*02*     PURPOSE = TO ACQUIRE A CELL FROM A QUICK-CELL POOL.            00164702
*                                                                       00165202
*02*     LINKAGE = ENTERED VIA BALR 14,15 .... ENTRY SHOULD BE MADE     00165302
*        USING THE GETCELL MACRO.                                       00167302
*                                                                       00171102
*02*     INPUT = THE MACRO PLACES THE ADDRESS OF THE CVT IN REGISTER 3. 00171502
*        REGISTER 0 CONTAINS THE ID OF THE POOL (CPID).                 00171902
*                                                                       00173302
*02*     OUTPUT = NORMAL OUTPUT IS THE ADDRESS OF THE ACQUIRED CELL,    00174202
*        AND A CHANGED POOL (PRIOR FIRST CELL REMOVED). SEE THE EXITS   00174602
*        FOR SPECIFIC OUTPUT ITEMS.                                     00174702
*                                                                       00175002
*02*     REGISTERS-SAVED = NONE ... REGISTERS 1 THROUGH 4 AND 15        00175402
*        WILL BE CHANGED                                                00175802
*02*     REGISTER-USAGE = SEE COMMENTS ON REGISTER EQUATES              00176002
*                                                                       00181002
*02*     REGISTERS-RESTORED = NONE                                      00181402
*01*  EXIT-NORMAL = UNNAMED EXIT POINT                                  00182702
*                                                                       00184302
*02*     CONDITIONS = A CELL HAS BEEN ALLOCATED                         00184502
*                                                                       00185602
*02*     OUTPUT = REG 1 = ADDRESS OF ALLOCATED CELL.                    00186002
*                                                                       00187202
*02*     RETURN-CODES = 0 = CELL ALLOCATED                              00199202
*                                                                       00200002
*01*  EXIT-ERROR = GTCERR04                                             00200602
*                                                                       00201602
*02*     CONDITIONS = NO AVAILABLE CELLS                                00211402
*                                                                       00221502
*02*     OUTPUT = RETURN CODE                                           00221802
*                                                                       00228602
*02*     RETURN-CODES = 4                                               00229002
*                                                                       00232902
*01*  EXIT-ERROR = GTCERR08                                             00233002
*                                                                       00233102
*02*     CONDITIONS = THE POOL POINTERS TO AVAILABLE CELLS HAVE BEEN    00233202
*        DESTROYED.                                                     00233302
*                                                                       00233702
*02*     OUTPUT = ZEROED DEQUEUE COUNT AND FIRST AVAILABLE CELL POINTER 00233802
*        IN THE CPAB.                                                   00234002
*                                                                       00235102
*02*     RETURN-CODES = 8                                               00235302
*                                                                       00235502
*01*  EXIT-ERROR = GTCERR12                                             00235602
*                                                                       00236102
*02*     CONDITIONS = THE POOL HAS NEVER BEEN FORMATTED.                00236502
*                                                                       00237002
*02*     OUTPUT = RETURN CODE.                                          00237302
*                                                                       00237802
*02*     RETURN-CODES = 12                                              00237902
*                                                                       00238002
*01*  EXIT-ERROR = GTCERR16                                             00238802
*                                                                       00240102
*02*     CONDITIONS = THE CPID SPECIFIED HAS NOT BEEN DEFINED TO THE    00240202
*        SYSTEM VIA A BLDCPOOL.                                         00240302
*                                                                       00240602
*02*     OUTPUT = RETURN CODE                                           00241002
*                                                                       00241802
*02*     RETURN-CODES = 16                                              00242102
*                                                                       00243102
*01*  EXTERNAL-REFERENCES = CVT, GDA, AND CPAB                          00244502
*                                                                       00244802
*02*     ROUTINES = NONE                                                00245202
*02*     DATA-AREAS = NONE                                              00246002
*02*     CONTROL-BLOCKS = CPAB (CELL POOL ANCHOR BLOCK) - READ AND      00246802
*        WRITE. CVT AND GDA - READ ONLY.                                00247602
*                                                                       00248402
*01*  TABLES = NONE                                                     00249202
*01*  MACROS = NONE                                                     00250002
*02*     SERIALIZATION = THE 'CPABFLGW' FIELD IS USED TO SERIALIZE ALL  00260002
*        OPERATIONS ON ANY SINGLE POOL EXTENT, REGARDLESS OF THE TYPE   00262002
*        OF OPERATION. THIS FIELD IS MANIPULATED WITH THE 'CS' (COMPARE 00264002
*        AND SWAP) INSTRUCTION. ONE BIT IN THIS FIELD, 'DELETELK', IS   00264402
*        USED TO INDICATE THAT THE EXTENT IS BEING DELETED FROM THE     00264502
*        POOL. IF A DELETE IS OCCURING (THE BIT IS 'ON'), ALL OTHER     00264602
*        OPERATIONS ARE PROHIBITED ON THE EXTENT BEING DELETED. IF NO   00266502
*        DELETE IS OCCURRING, THE USE COUNT 'CPABUSE#' IS USED TO       00268502
*        PREVENT A DELETE FROM STARTING IN THE MIDDLE OF SOME OTHER     00268902
*        PROCESS. A NON-ZERO VALUE FOR 'CPABUSE#' WILL PREVENT AN       00269302
*        EXTENT FROM BEING DELETED. ONCE THE EXTENT HAS BEEN LOCKED     00269702
*        AGAINST DELETES, THE DOUBLE-WORD FIELD CONSISTING OF           00270102
*        'CPABDEQC' AND 'CPABFACP' IS USED TO SERIALIZE THE ACQUISITION 00270202
*        AND RELEASE OF CELLS IN THE SINGLE EXTENT. THIS DOUBLE-WORD    00270302
*        FIELD IS MANIPULATED WITH THE 'CDS' (COMPARE DOUBLE AND SWAP)  00271402
*        INSTRUCTION.                                                   00273402
*                                                                       00273502
*01*  CHANGE-ACTIVITY = NEW FOR OS/VS2 RELEASE 2.                       00273602
*                                                                       00274702
*01*  MESSAGES = NONE                                                   00275802
*01*  ABEND-CODES = NONE                                                00276902
**** END OF SPECIFICATIONS ***/                                         00278002
                 EJECT                                                  00326902
*/*GETCELL: CHART (AMODE) */                                            08850002
*/* HEADER                                                              08860002
*/*DYNAMIC QUICKCELL FUNCTION                                           08870002
*/*                                               GET CELL ROUTINE      08880002
*/*                                                                     08892002
*/*                            PAGE # */                                08894002
*/*IEAVGTCL:1A1 E   (,%D1) BRANCH ENTRY */                              08900002
*/*%D1:1B1     D   (YES,PERMCPID,NO,%DYN) PERMANENT CPID? */            08950002
*/*PERMCPID:   P   (,GOTCPAB) CALCULATE CPAB OFFSET IN CPAB TABLE */    09000002
*/*%DYN:1B2    D   (YES,GTCERR16,NO,%DY2) NULL CPID (=0)? */            09050002
*/*%DY2:1B3    P   (,GOTCPAB) CALCULATE CPAB ADDRESS */                 09150002
*/*GOTCPAB:    D   (NO,GTCERR16,YES,GTCRETRY) CPID MATCH ONE IN CPAB?*/ 09200002
*/*GTCRETRY:1E1 D  (YES,DLCKCHK,NO,GNXTCPAB) ANY CELLS AVAILABLE? */    09250002
*/*DLCKCHK:    D   (YES,%EXT2,NO,%DLCK) EXTENT BEING DELETED? */        09260002
*/*%DLCK:      P   (,DEQLOOP) LOCK OUT DELETE (RAISE USE COUNT) */      09270002
*/*DEQLOOP:    M   (,%ANY) SET UP FOR NEXT CDS TO TAKE CELL */          09300002
*/*%ANY:       D   (YES,%CDS2,NO,EXTEMPTY) ANY CELLS LEFT IN THE        09360002
*/*EXTENT ? */                                                          09370002
*/*%CDS2:1G1   D   (YES,%LIM,NO,DEQLOOP) 'CDS' - IS IT MINE? */         09372002
*/*EXTEMPTY:   P   (,GNXTCPAB) UNLOCK THE EXTENT (LOWER THE USE COUNT)  09380002
*/**/                                                                   09390002
*/*%LIM:1H1    D   (YES,%BDY,NO,GTCERR08) CELL ADDR IN POOL LIMITS? */  09400002
*/*%BDY:1J1    D   (YES,%CFREE,NO,GTCERR08) CORRECT CELL BOUNDARY? */   09450002
*/*%CFREE:1K1  D   (YES,%TAKE,NO,GTCERR08) IS THE CELL FREE? */         09500002
*/*%TAKE:1K2   P   (,%RC0) STORE CPID IN CELL'S LAST WORD */            09550002
*/*%RC0:1K3    R   RC=0 -NORMAL- */                                     09600002
*/*GTCERR08:1H2 M  (,%CDS3) SET UP FOR 'CDS' TO INDICATE BAD POOL */    09650002
*/*%CDS3:1J2   D   (YES,%RC8,NO,GTCERR08) 'CDS' HAVE I STORED? */       09700002
*/*%RC8:1J3    R   RC=8 */                                              09750002
*/*GTCERR16:   R   RC=16 */                                             09760002
*/*GNXTCPAB:   D   (YES,%NCPAB,NO,%EXT2) ANY OTHER EXTENTS? (CPABE'S)*/ 09800002
*/*%NCPAB:1F2  P   (,GTCRETRY) GET NEXT CPABE ADDRESS */                09850002
*/*%EXT2:1E4   D   (NO,GTCERR04,YES,GTCERR12) UNFORMATTED POOL?  */     09900002
*/*GTCERR12:   R   RC=12 */                                             09950002
*/*GTCERR04:   R   RC=4 */                                              10050002
*/*GETCELL:    END */                                                   10150002
         EJECT                                                          10200002
IEAVGTCL CSECT                                                          10250002
CELLLINK EQU   0              CELL LINKAGE POINTER (LAST WORD IN CELL)  10300002
R0       EQU   0              CPID -- INPUT PARAMETER                   10350002
R1       EQU   1              CELL ADDRESS -- OUTPUT PARAMETER          10400002
@R2      EQU   2              SCRATCH REGISTER                          10450002
@R3      EQU   3              SCRATCH REGISTER                          10500002
*                             ON INPUT, R3 CONTAINS CVT ADDRESS         10550002
R4       EQU   4              CPAB ADDRESS (CALCULATED)                 10600002
*        NOTE: REGS 5 THROUGH 13 ARE EXPRESSLY FORBIDDEN FOR USE       *10610002
               BY THIS ROUTINE.                                         10620002
R14      EQU   14             RETURN ADDRESS                            10650002
R15      EQU   15             ENTRY POINT ADDRESS (BASE REGISTER)       10700002
         USING IEAVGTCL,R15                                             10750002
         MODID BR=YES                                                   10760002
         LTR   R4,R0          TEST CPID VALUE AND SET CPAB ADDR. BASE   10800002
         BM    PERMCPID       NEGATIVE, PERMANENT (SYSTEM) CPID         10850002
         BZ    GTCERR16       NULL (=0), ERROR CONDITION                10900002
**********************************************************************  10910002
*        THE CPID HAS BEEN FOUND TO BE A DYNAMIC POOL ID AND            10950002
*        THE ADDRESS OF THE FIRST CPAB IS FOUND FROM THE CPID           11000002
*        BY MULTIPLYING IT BY 4.                                        11050002
*        THE CPAB ADDRESS IS TAKEN FROM THE CPID (ALREADY IN REG 4)     11100002
**********************************************************************  11110002
         SLL   R4,2           MULTIPLIED BY 4.                          11150002
         B     GOTCPAB        RETURN TO COMMON MAINLINE                 11200002
         SPACE                                                          11250002
**********************************************************************  11260002
*        A PERMANENT (SYSTEM) CPID HAS BEEN PASSED, THE CPAB            11300002
*        ADDRESS IS FOUND BY USING THE LOW-ORDER BYTE OF THE            11350002
*        ID AS AN INDEX INTO A TABLE OF CPAB'S. THE TABLE IS            11400002
*        FOUND FROM THE GLOBAL DATA AREA (GDA), WHOSE ADDRESS           11450002
*        IS FOUND IN THE CVT.                                           11500002
**********************************************************************  11510002
PERMCPID EQU   *                                                        11550002
         USING CVT,@R3                                                  11600002
         L     @R3,CVTGDA     GDA ADDRESS                               11650002
         USING GDA,@R3                                                  11700002
*        THE CPID IS ALREADY IN REG 4, LET CPAB ADDRESS = CPID          11800002
         N     R4,F255             // 256 (MODULO DIVISION)             11850002
         SLL   R4,5                * 32 (CPAB LENGTH)                   11900002
         A     R4,PFSTCPAB         + CPAB TABLE ADDRESS                 11950002
*****    NOTE: THIS CALCULATION IS DEPENDENT UPON THE LENGTH OF THE    *11960002
               CPAB REMAINING AT 32.                                    11970002
         EJECT                                                          12000002
**********************************************************************  12010002
*        COMMON PATH******** AFTER FINDING THE CPAB FOR THE             12050002
*        ID GIVEN, CHECK FOR MATCHING CPID'S, AND EMPTY                 12100002
*        POOLS.                                                         12150002
**********************************************************************  12160002
GOTCPAB  EQU   *                                                        12200002
         USING CPAB,R4                                                  12250002
         C     R0,CPABCPID    CPID'S MATCH ?                            12300002
         BNE   GTCERR16            NO, ERROR CONDITION                  12350002
GTCRETRY EQU   *                                                        12352002
         L     @R3,CPABFACP   GET ADDRESS OF FIRST AVAILABLE CELL       12360002
         LTR   @R3,@R3        IS THIS EXTENT EMPTY?                     12370002
         BZ    GNXTCPAB       YES, GET NEXT CPAB ADDRESS                12380002
         SPACE 3                                                        14300002
**********************************************************************  14310002
*        NOW THAT AN EXTENT HAS BEEN FOUND THAT HAS AT LEAST ONE        14350002
*        AVAILABLE CELL, CHECK TO SEE IF A DELETE IS                    14400002
*        IN PROCESS TO DETERMINE IF THE CELL SHOULD NOT BE              14450002
*        OBTAINED FROM THIS EXTENT.                                     14500002
**********************************************************************  14510002
DLCKCHK  EQU   *                                                        14550002
         L     @R2,CPABFLGW   GET LOCKING FLAGS AND COUNT               14600002
         LR    @R3,@R2        COPY THEM FOR TESTING                     14650002
         N     @R3,DLFLGOFF   TURN OFF DELETE FLAG IN COPY              14700002
         CR    @R2,@R3        IF THEY ARE THE SAME, THE LOCK            14750002
*                             WAS ALREADY OFF.                          14800002
         BNE   GTCERR20       OTHERWISE A DELETE IS IN PROCESS          14850002
*****    NOTE **** THIS INSTRUCTION CANNOT BE REPLACED BY A LOAD        14860002
*        ADDRESS (LA) BECAUSE THERE IS A SUBPOOL NUMBER IN THE HIGH-    14870002
*        ORDER BYTE OF THIS FIELD.                                      14880002
         LR    @R3,@R2        NO DELETE GOING ON, LOCK OUT DELETE       14900002
         A     @R3,F1         BY RAISING THE OPERATION COUNT.           14950002
         CS    @R2,@R3,CPABFLGW    STORE LOCKS IF NOTHING HAS           15000002
*                                  HAPPENED TO CHANGE THE STATUS.       15050002
         BNE   DLCKCHK        STATUS CHANGED, SEE WHY.                  15100002
         EJECT                                                          15150002
**********************************************************************  15160002
*        NO DELETES ARE IN PROCESS AND DELETE IS LOCKED OUT OF          15200002
*        THIS EXTENT, OBTAIN THE CELL FROM THE POOL.                    15250002
**********************************************************************  15260002
DEQLOOP  EQU   *                                                        15300002
*********      FROM NOW ON, THE CPID IS NOT AVAILABLE IN A              15310002
*              REGISTER, AND REGISTER 0 WILL CONTAIN VARYING            15320002
*              DATA.                                                    15330002
         LM    R0,R1,CPABDEQC      GET DEQUEUE COUNT AND FIRST          15350002
*                                  AVAILABLE CELL POINTER FROM          15400002
*                                  THE CPAB.                            15450002
         LTR   @R3,R1         COPY FIRST AVAILABLE POINTER              15460002
         BZ    EXTEMPTY       BRANCH IF THE EXTENT HAS GONE EMPTY       15470002
         A     @R3,CPABCSZE   GET LINK POINTER ADDRESS FOR THE          15500002
*                             CELL BEING TAKEN.                         15550002
         L     @R3,CELLLINK(@R3)    REMOVE THE FIRST CELL               15600002
         LR    @R2,R0         INCREASE THE DEQUEUE COUNT BY 1           15700002
         A     @R2,F1                                                   15750002
         CDS   R0,@R2,CPABDEQC     DEQUEUE THE CELL FROM THE POOL       15800002
         BNE   DEQLOOP        DEQUEUE FAILED, TRY AGAIN                 15850002
         SPACE 3                                                        15902002
**********************************************************************  15902402
*        A CELL HAS BEEN OBTAINED FROM THE POOL, NOW CHECK              15904002
*        TO SEE THAT IT IS A PROPER CELL. THIS IS DONE BY               15906002
*        TESTING ITS BOUNDARIES FOR RESIDENCE INSIDE THE                15908002
*        EXTENT FROM WHICH IT WAS OBTAINED, AND BY CHECKING             15908402
*        THAT IT STARTS ON AN INTEGRAL BOUNDARY WITHIN ITS              15908502
*        EXTENT.                                                        15908902
**********************************************************************  15909302
         C     R1,CPABSTAD    CHECK CELL AGAINST LOW BOUND              15909402
         BL    GTCERR08       OUT OF BOUNDS, ERROR CONDITION            15909502
         L     @R3,CPABCSZE   GET CELL LENGTH                           15909602
         LA    @R2,4(@R3,R1)  SET UP ADDRESS OF END OF CELL             15909702
         C     @R2,CPABENAD   TEST CELL END AGAINST UPPER BOUND         15909802
         BH    GTCERR08       OUT OF BOUNDS, ERROR CONDITION            15909902
         EJECT                                                          15910002
**********************************************************************  15912002
*        CHECK TO SEE THAT THE CELL IS ON AN INTEGRAL BOUNDARY          15915202
*        WITHIN THAT EXTENT.                                            15915602
**********************************************************************  15917602
         LA    R0,4(@R3)       R0 = COMPLETE CELL SIZE - LINK           15919902
*                             WORD LENGTH (4) IS INCLUDED               15921902
         LR    @R3,R1         TAKE THE CELL ADDRESS AND SUBTRACT        15922302
         S     @R3,CPABSTAD        THE STARTING ADDRESS OF THE POOL,    15922702
         BZ    SKIPDVD             THIS GIVES THE RELATIVE ADDRESS      15923102
*                                  OF THE CELL IN THE POOL. IF          15923202
*                                  IT IS ZERO, SKIP DIVISION.           15923302
         SR    @R2,@R2        CLEAR FOR DIVISION                        15926602
         DR    @R2,R0         DIVIDE BY CELL LENGTH                     15928602
         LTR   @R2,@R2        IF REMAINDER IS ZERO, CELL IS             15929002
*                             ON AN INTEGRAL BOUNDARY.                  15929402
         BNZ   GTCERR08       IF NOT, ERROR CONDITION                   15929802
         SPACE 2                                                        15934802
**********************************************************************  15942002
*        NOW THAT THE CELL HAS BEEN SHOWN TO BE VALID, STORE            15945002
*        THE CPID IN IT FOR FUTURE REFERENCE WHEN FREEING THE           15950002
*        CELL.                                                          15955002
**********************************************************************  15957002
SKIPDVD  EQU   *                                                        15959002
         TM    CPABFLGS,CPABEXTN   IS THIS AN EXTENSION CPAB?           15960002
         BZ    NOLOAD         NO, SKIP ADDRESS LOADING                  15965002
         L     @R3,CPABCPID   YES, LOAD THE ADDRESS OF THE FIRST CPAB   15970002
         L     R0,CPABCPID-CPAB(@R3)  GET THE TRUE CPID                 15970402
         B     STORCPID            RETURN TO MAINLINE                   15971202
         SPACE 2                                                        15972002
NOLOAD   EQU   *                                                        15975002
         L     R0,CPABCPID    GET THE TRUE CPID                         15980002
STORCPID EQU   *                                                        15982002
         L     @R3,CPABCSZE   GET THE CELL SIZE FROM THE CPAB           15985002
         C     R0,CELLLINK(@R3,R1) IS THE CELL ALREADY ALLOCATED?       15987002
         BE    GTCERR08       YES, ERROR, EXTENT DESTROYED              15989002
         ST    R0,CELLLINK(@R3,R1) STORE THE CPID IN THE CELL           15990002
         EJECT                                                          16000002
**********************************************************************  16010002
*        THE CELL HAS BEEN SUCCESSFULLY OBTAINED FROM THE POOL,         16022202
*        NOW THE POOL EXTENT MUST BE UNLOCKED TO ALLOW                  16072202
*        OTHER OPERATIONS.                                              16122202
**********************************************************************  16132202
UNLCKLP  EQU   *                                                        16172202
         L     @R2,CPABFLGW   GET THE LOCKING FLAGS AND USE COUNT       16222202
         LR    @R3,@R2        COPY THEM                                 16272202
         BCTR  @R3,0          REDUCE THE USE COUNT                      16322202
         CS    @R2,@R3,CPABFLGW    UNLOCK THE EXTENT                    16332202
         BNE   UNLCKLP        FAILED, TRY AGAIN                         16342202
         SPACE 2                                                        16350002
**********************************************************************  16400002
*        THE CELL HAS BEEN SUCCESSFULLY OBTAINED FROM THE POOL, AND     16650002
*        THE POOL IS UNLOCKED, RETURN TO THE USER.                      16700002
*        REGISTER 1 = ADDRESS OF THE CELL                               16710002
*        REGISTER 0 = CPID OF THE POOL                                  16720002
**********************************************************************  16730002
         SR    R15,R15        SET RETURN CODE = 0                       16750002
         BR    R14            RETURN TO THE CALLER                      16800002
         SPACE 2                                                        16802002
**********************************************************************  16802402
*        THE EXTENT HAS BEEN DRAINED OF CELLS BY ONE OR MORE CONCURRENT 16804002
*        OPERATIONS, IT MUST BE ABANDONED, BUT FIRST, WE MUST           16806002
*        TAKE OFF THE LOCK ON THE POOL EXTENT ( THE USE COUNT).         16810002
**********************************************************************  16812002
EXTEMPTY EQU   *                                                        16820002
         L     @R2,CPABFLGW   GET THE LOCKING FLAGS AND USE COUNT       16830002
         LR    @R3,@R2        COPY THEM                                 16840002
         BCTR  @R3,0          REDUCE THE USE COUNT                      16842002
         CS    @R2,@R3,CPABFLGW    UNLOCK THE EXTENT                    16844002
         BE    GNXTCPAB       SUCCESS, GET NEXT EXTENT                  16844402
         B     EXTEMPTY       FAILED, TRY AGAIN                         16846002
         EJECT                                                          16850002
**********************************************************************  16860002
*        IF THERE WERE NO FREE CELLS IN THE EXTENT UNDER INVESTIGATION  16900002
*        AND THERE ARE MORE EXTENTS TO CHECK, CONTINUE THE SEARCH       16950002
*        FOR AN EXTENT IN WHICH THERE IS A FREE CELL.                   17000002
**********************************************************************  17010002
GNXTCPAB EQU   *                                                        17050002
         CLC   CPABNXTP,F0    IS THERE ANOTHER EXTENT?                  17052002
         BE    GTCFMTCK       NO, CHECK IF POOL WAS FORMATTED           17054002
         L     R4,CPABNXTP    YES, GET ADDRESS OF NEXT CPAB             17060002
         B     GTCRETRY       AND CONTINUE THE SEARCH                   17090002
GTCFMTCK EQU   *                                                        17140002
         L     @R2,CPABSTAD   GET POOL START ADDRESS                    17260002
         LTR   @R2,@R2        HAS THE POOL BEEN FORMATTED?              17270002
         BZ    GTCERR12            NO, ERROR CONDITION                  17280002
**********************************************************************  17280402
*        THE POOL IS EMPTY OF CELLS, BUT IT IS FORMATTED,               17282002
*        ERROR CODE = 4                                                 17284002
**********************************************************************  17286002
GTCERR04 EQU   *                                                        17290002
         SPACE                                                          17290402
**********************************************************************  17290502
*        THE FIRST EXTENT IN WHICH A FREE CELL COULD BE FOUND           17290802
*        WAS BEING DELETED, RETURN AN ERROR CODE.                       17291202
**********************************************************************  17291302
GTCERR20 EQU   *                                                        17291602
         SR    R1,R1               ASSURE NO APPARENT ADDR. IS RETURNED 17291702
         LA    R15,4               SET UP THE NECESSARY RETURN CODE.    17292002
         BR    R14                 RETURN TO CALLER                     17294002
         EJECT                                                          17300002
**********************************************************************  17310002
*        AN ERROR HAS OCCURRED INDICATING THAT THE EXTENT IS DESTROYED, 17350002
*        THE POINTERS IN THE CELL POOL ANCHOR BLOCK MUST BE SET UP TO   17410002
*        PREVENT ANY ATTEMPTED GETCELLS FROM THIS EXTENT. THIS IS       17430002
*        DONE BY SETTING THE DEQUEUE COUNT AND FIRST CELL POINTER       17440002
*        TO ZERO.                                                       17442002
**********************************************************************  17444002
GTCERR08 EQU   *                                                        17450002
         LM    @R2,@R3,CPABDEQC    GET DEQUEUE COUNT AND FIRST          17478402
*                                  AVAILABLE CELL POINTER FROM          17478802
*                                  THE CPAB.                            17479202
         SR    R0,R0          SET UP ZERO VALUES FOR DESTROYED CPAB     17481202
         SR    R1,R1          THE USER WILL RECEIVE ZEROED PARAMETERS   17483202
         CDS   @R2,R0,CPABDEQC     DEQUEUE THE CELL FROM THE POOL       17485602
         BNE   GTCERR08       DEQUEUE FAILED, TRY AGAIN                 17486002
**********************************************************************  17486502
*        NOW THE POOL EXTENT MUST BE UNLOCKED TO ALLOW                  17486602
*        OTHER OPERATIONS.                                              17486702
**********************************************************************  17491802
EUNLCKLP EQU   *                                                        17498002
         L     @R2,CPABFLGW   GET THE LOCKING FLAGS AND USE COUNT       17503202
         LR    @R3,@R2        COPY THEM                                 17508402
         BCTR  @R3,0          REDUCE THE USE COUNT                      17513602
         CS    @R2,@R3,CPABFLGW    UNLOCK THE EXTENT                    17518802
         BNE   EUNLCKLP     FAILED, TRY AGAIN                           17524002
**********************************************************************  17531202
*        RETURN AN ERROR CODE INDICATING THAT THE POOL IS NO LONGER     17534402
*        RELIABLE, OR CONTAINS AT LEAST ONE BAD EXTENT.                 17539602
**********************************************************************  17541602
         SR    R1,R1          ASSURE NO APPARENT ADDR. IS RETURNED      17543602
         LA    R15,8          SET UP THE REQUIRED RETURN CODE.          17544802
         BR    R14            RETURN TO THE CALLER.                     17550002
         SPACE                                                          17600002
**********************************************************************  17650002
*        THIS POOL HAS NOT BEEN FORMATTED, RETURN AN ERROR CODE         17950002
**********************************************************************  17960002
GTCERR12 EQU   *                                                        18000002
         SR    R1,R1          ASSURE NO APPARENT ADDR. IS RETURNED      18010002
         LA    R15,12         SET UP THE REQUIRED RETURN CODE.          18050002
         BR    R14            RETURN TO THE CALLER .                    18100002
         SPACE 2                                                        18150002
**********************************************************************  18160002
*        AN INVALID CPID HAS BEEN GIVEN, RETURN WITH AN ERROR CODE      18200002
**********************************************************************  18210002
GTCERR16 EQU   *                                                        18250002
         SR    R1,R1          ASSURE NO APPARENT ADDR. IS RETURNED      18260002
         LA    R15,16         SET UP THE PROPER RETURN CODE.            18300002
         BR    R14            RETURN TO THE CALLER.                     18350002
         EJECT                                                          18400002
**********************************************************************  18410002
*        CONSTANTS REQUIRED BY THE GET CELL SERVICE ROUTINE             18450002
**********************************************************************  18460002
F255     DC    F'255'         USED FOR MODULO DIVIDE BY 256             18500002
F0       DC    F'0'           FIELD USED TO TEST FOR EMPTY QUEUE        18502002
F1       DC    F'1'           USED TO INCREASE USE COUNT                18510002
DLFLGOFF DC    X'FF',AL1(X'FF'-DELETELK),2X'FF'                         18600002
         SPACE 2                                                        18660002
CVT      DSECT                                                          18750002
         CVT                                                            18800002
         EJECT                                                          18810002
         IHAGDA   DSECT=YES                                             18850002
         EJECT                                                          18860002
         IHACPAB  DSECT=YES                                             18900002
         END                                                            19000002
./  ADD  SSI=60840722,NAME=IEAVNP08
         TITLE '*****  VSM INITIALIZATION ROUTINE  *****               *00001000
                        '                                               00002000
IEAVNP08 CSECT ,                                                   0001 00003000
IEAVNPA8 DS    0H                                                  0001 00004000
         ENTRY IEAVNPA8                                                 00005000
@MAINENT DS    0H                                                  0001 00006000
         USING *,@15                                               0001 00007000
         B     @PROLOG                                             0001 00008000
         DC    AL2(@EP00001-@MAINENT)                                   00009000
         DC    AL1(16)                                             0001 00010000
         DC    C'IEAVNP08  76.086'                                 0001 00011000
IEAVNPB8 DS    0H                                                  0001 00012000
         USING *,@15                                               0001 00013000
         B     @PROLOG                                             0001 00014000
         DC    AL2(@EP00317-IEAVNPB8)                                   00015000
         ENTRY IEAVNPB8                                                 00016000
IEAVNPC8 DS    0H                                                  0001 00017000
         USING *,@15                                               0001 00018000
         B     @PROLOG                                             0001 00019000
         DC    AL2(@EP00416-IEAVNPC8)                                   00020000
         ENTRY IEAVNPC8                                                 00021000
         DROP  @15                                                      00022000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00023000
         BALR  @12,0                                               0001 00024000
@PSTART  DS    0H                                                  0001 00025000
         USING @PSTART,@12                                         0001 00026000
         ST    @13,@SA00001+4                                      0001 00027000
         LA    @14,@SA00001                                        0001 00028000
         ST    @14,8(,@13)                                         0001 00029000
         LR    @13,@14                                             0001 00030000
         AH    @15,4(,@15)                                         0001 00031000
         BR    @15                                                 0001 00032000
@EP00001 DS    0H                                                  0002 00033000
*                                                                       00034000
* REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF           00035000
* NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES       00036000
* WILL ASSEMBLE PROPERLY.                                               00037000
         EJECT                                                          00038000
*   GDAPTR=CVTGDA;                  /* SET UP GDA ADDR FROM CVT      */ 00039000
         L     GDAPTR,CVTGDA(,CVTPTR)                              0152 00040000
*   RPTAB=NVTPTAB;                  /* LOAD PARM TABLE ADDRESS       */ 00041000
         L     RPTAB,NVTPTAB(,RNVT)                                0153 00042000
*   RSCAN=SQA;                      /* LOAD SQA PARM ADDRESS         */ 00043000
*                                                                  0154 00044000
         L     RSCAN,SQA(,RPTAB)                                   0154 00045000
*   /*****************************************************************/ 00046000
*   /*                                                               */ 00047000
*   /* IF NO SQA PARAMETER IS SPECIFIED AND QUICKSTART IS NOT IN     */ 00048000
*   /* PROCESS , THEN TAKE DEFAULT SQA SIZE AND PROCESS. IF SQA WAS  */ 00049000
*   /* SPECIFIED, CALL SYNTAX CHECKER TO SCAN PARM                   */ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0155 00053000
*   IF RSCAN=0                      /* SQA PARM ADDRESS = 0 ?        */ 00054000
*     THEN                                                         0155 00055000
         LTR   RSCAN,RSCAN                                         0155 00056000
         BNZ   @RF00155                                            0155 00057000
*     DO;                                                          0156 00058000
*                                                                  0156 00059000
*       /*************************************************************/ 00060000
*       /*                                                           */ 00061000
*       /* IF QUICKSTART WAS SPECIFIED (NVTFLQS=1), THEN CALCULATE   */ 00062000
*       /* SIZE OF PREVIOUS SQA AND CONTINUE PROCESS.                */ 00063000
*       /*                                                           */ 00064000
*       /*************************************************************/ 00065000
*                                                                  0157 00066000
*       IF NVTFLQS='0'B             /* NVTFLQS=1 MEANS QS SPECIFIED  */ 00067000
*         THEN                                                     0157 00068000
         TM    NVTFLQS(RNVT),B'00001000'                           0157 00069000
         BNZ   @RF00157                                            0157 00070000
*         VALUE=SQADFLT;            /* QS NOT SPECIFIED TAKE DEFAULT    00071000
*                                      OF 1 SEGMENT.                 */ 00072000
         MVC   VALUE(4),@CF00062                                   0158 00073000
*       ELSE                        /* GET SQA SIZE OF RECLAIMED IPL */ 00074000
*         DO;                       /* AND CONVERT TO NO. SEGMENTS   */ 00075000
         B     @RC00157                                            0159 00076000
@RF00157 DS    0H                                                  0160 00077000
*           VALUE=((NVTLVIRT-NVTLPAND)/NP864K);/* NVTLPAND = HIGH  0160 00078000
*                                      VIRTUAL ADDR OF PLPA BEING  0160 00079000
*                                      RECLAIMED                     */ 00080000
         L     @00,NVTLVIRT(,RNVT)                                 0160 00081000
         SL    @00,NVTLPAND(,RNVT)                                 0160 00082000
         SRDA  @00,32                                              0160 00083000
         D     @00,@CF00109                                        0160 00084000
         ST    @01,VALUE                                           0160 00085000
*         END;                                                     0161 00086000
*       GOTO NP8SQOK;               /* BYPASS SYNTAX CHECKING        */ 00087000
         B     NP8SQOK                                             0162 00088000
*     END;                                                         0163 00089000
*                                                                  0163 00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* SET UP FOR SQA PARAMETER SCAN CHECK. SCAN PARAMETER FOR       */ 00093000
*   /* DELIMITER (BLANK,COMMA,QUOTE). SCAN TILL FOUND OR LENGTH IS   */ 00094000
*   /* GREATER THAN 3 CHARACTERS. PROCEED TO VALIDITY CHECK PARM     */ 00095000
*   /* AFTER DELIMITER FOUND.                                        */ 00096000
*   /*                                                               */ 00097000
*   /*****************************************************************/ 00098000
*                                                                  0164 00099000
*NP8SQALP:                                                         0164 00100000
*   PCT=MAXSQA;                     /* MAX NO OF DIGITS ALLOWED=3    */ 00101000
@RF00155 DS    0H                                                  0164 00102000
NP8SQALP LA    PCT,3                                               0164 00103000
*   CALL NP8VNUM;                   /* SYNTAX CHECKING ROUTINE       */ 00104000
         BAL   @14,NP8VNUM                                         0165 00105000
*   IF RCODE=0                      /* IF RETURN CODE=0 , SYNTAX OK  */ 00106000
*     THEN                                                         0166 00107000
         LTR   RCODE,RCODE                                         0166 00108000
         BZ    @RT00166                                            0166 00109000
*     GO TO NP8SQOK;                /* GOTO GOOD CONTINUE            */ 00110000
*   ELSE                                                           0168 00111000
*     GO TO NP8SQINV;               /* IF RETURN CODE=4, SYNTAX BAD  */ 00112000
         B     NP8SQINV                                            0168 00113000
*   RFY                                                            0169 00114000
*     RSCAN UNRSTD;                                                0169 00115000
*                                                                  0169 00116000
*   /*****************************************************************/ 00117000
*   /*                                                               */ 00118000
*   /* THIS CODE IS ENTERED WHEN A SYNTAX ERROR FREE PARM IS FOUND.  */ 00119000
*   /* THE SIZE AND LOW ADDR OF SQA IS DETERMINED AND STORED.        */ 00120000
*   /*                                                               */ 00121000
*   /*****************************************************************/ 00122000
*                                                                  0170 00123000
*NP8SQOK:                                                          0170 00124000
*   AREASZ=(VALUE*NP864K);          /* CALC. NEW SQA SIZE            */ 00125000
NP8SQOK  L     @09,VALUE                                           0170 00126000
         SLA   @09,16                                              0170 00127000
         ST    @09,AREASZ                                          0170 00128000
*   LOWADDR=NVTLVIRT-AREASZ;        /* FIND LOW SQA ADDR             */ 00129000
*                                                                  0171 00130000
         LCR   @09,@09                                             0171 00131000
         AL    @09,NVTLVIRT(,RNVT)                                 0171 00132000
         ST    @09,LOWADDR                                         0171 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* COMPARE LOW SQA ADDRESS WITH HIGH NIP REGION ADDRESS. IF SQA  */ 00136000
*   /* ADDRESS IS LOWER, THERE IS OVERLAP. ISSUE 'SPACE EXCEEDED'    */ 00137000
*   /* MESSAGE AND ASK OPERATOR TO TO RESPECIFY SQA SIZE.            */ 00138000
*   /*                                                               */ 00139000
*   /*****************************************************************/ 00140000
*                                                                  0172 00141000
*   IF LOWADDR<NVTVVPG1             /* LOW SQA < 1ST V=V PAGE ADDR   */ 00142000
*     THEN                          /* IF SO, SPACE EXCEEDED         */ 00143000
         C     @09,NVTVVPG1(,RNVT)                                 0172 00144000
         BL    @RT00172                                            0172 00145000
*     GOTO NP8SQAEX;                /* ISSUE MESSAGE                 */ 00146000
*                                                                  0173 00147000
*   /*****************************************************************/ 00148000
*   /*                                                               */ 00149000
*   /* IF A QUICKSTART HAS BEEN SPECIFIED, THEN THE OPERATOR IS      */ 00150000
*   /* INFORMED IF THE SQA VALUE HE ENTERED, OR THE ONE THAT CAME    */ 00151000
*   /* FROM SYS1.PARMLIB, IS NOT THE PREVIOUS IPL SQA SIZE REQUIRED  */ 00152000
*   /* BY THE QUICKSTART PROCESS.                                    */ 00153000
*   /*                                                               */ 00154000
*   /*****************************************************************/ 00155000
*                                                                  0174 00156000
*NP8SQUIK:                                                         0174 00157000
*   IF NVTFLQS='1'B THEN            /* IF SO - CHECK SQA SIZES     0174 00158000
*                                                            @ZA04106*/ 00159000
NP8SQUIK TM    NVTFLQS(RNVT),B'00001000'                           0174 00160000
         BNO   @RF00174                                            0174 00161000
*     CALL NP8SQACS;                /* CHECK QS MSG                  */ 00162000
*                                                                  0175 00163000
         BAL   @14,NP8SQACS                                        0175 00164000
*   /*****************************************************************/ 00165000
*   /*                                                               */ 00166000
*   /* THIS CODE IS ENTERED AFTER A VALID SQA PARAMETER HAS BEEN     */ 00167000
*   /* SPECIFIED. NOW ALLOCATE AND INITIALIZE PAGE TABLES FOR THE NEW*/ 00168000
*   /* SQA SEGMENTS AND RESET VSM CONTROL BLOCKS TO REFLECT THE SQA  */ 00169000
*   /* EXPANSION. IF NUMBER OF ADDITIONAL SEGMENTS WAS 0, DO NOT     */ 00170000
*   /* ALLOCATE AND NEW PAGE TABLES. NIP HAS ALREADY DONE IT FOR     */ 00171000
*   /* THEIR 2 SEGMENTS.                                             */ 00172000
*   /*                                                               */ 00173000
*   /*****************************************************************/ 00174000
*                                                                  0176 00175000
*NP8SQACH:                                                         0176 00176000
*   IF VALUE=0                      /* SPECIFIED AS ZERO ?           */ 00177000
*     THEN                          /* IF SO, DONT ALLOCATE          */ 00178000
@RF00174 DS    0H                                                  0176 00179000
NP8SQACH L     @09,VALUE                                           0176 00180000
         LTR   @09,@09                                             0176 00181000
         BZ    @RT00176                                            0176 00182000
*     GOTO NP8NSQAP;                /* EXIT FROM SUBROUTINE UPDATE 0177 00183000
*                                      TOTAL SQA SPACE IN GDA        */ 00184000
*   SQASPLFT=SQASPLFT+(VALUE*NP864K);                              0178 00185000
         LR    @15,@09                                             0178 00186000
         SLA   @15,16                                              0178 00187000
         AL    @15,SQASPLFT(,GDAPTR)                               0178 00188000
         ST    @15,SQASPLFT(,GDAPTR)                               0178 00189000
*   SEGINDX=(NVTLVIRT/NP864K)-VALUE;                               0179 00190000
         L     @15,NVTLVIRT(,RNVT)                                 0179 00191000
         SRL   @15,16                                              0179 00192000
         SLR   @15,@09                                             0179 00193000
         ST    @15,SEGINDX                                         0179 00194000
*   DALUE=VALUE;                                                   0180 00195000
         ST    @09,DALUE                                           0180 00196000
*   SQABIT='1'B;                                                   0181 00197000
         OI    SQABIT,B'10000000'                                  0181 00198000
*   CALL BUILDPG;                   /* BUILD PAGE TABLES FOR SQA     */ 00199000
         BAL   @14,BUILDPG                                         0182 00200000
*   SQABIT='0'B;                                                   0183 00201000
         NI    SQABIT,B'01111111'                                  0183 00202000
*   CALL NP8SQBLK;                  /* BUILD VSM CONTROL BLOCKS      */ 00203000
*                                                                  0184 00204000
         BAL   @14,NP8SQBLK                                        0184 00205000
*   /*****************************************************************/ 00206000
*   /*                                                               */ 00207000
*   /* SQA EXIT ROUTINE ALL PATHS OF CODE FOR SQA MANIPULATION EXIT  */ 00208000
*   /* THROUGH HERE EXCEPT IN THE CASE WHERE THERE IS NO MORE VIRUAL */ 00209000
*   /* SPACE FOR SQA. THIS INDICATES A SEVERE SYSTEM PROBLEM SO NIP  */ 00210000
*   /* ISSUES A DISABLED WAIT.                                       */ 00211000
*   /*                                                               */ 00212000
*   /*****************************************************************/ 00213000
*                                                                  0185 00214000
*NP8NSQAP:                                                         0185 00215000
*   NVTLVIRT=LOWADDR;               /* STORE LOW SQA ADDR IN NVT     */ 00216000
NP8NSQAP L     @09,LOWADDR                                         0185 00217000
         ST    @09,NVTLVIRT(,RNVT)                                 0185 00218000
*   RETURN;                                                        0186 00219000
@EL00001 L     @13,4(,@13)                                         0186 00220000
@EF00001 DS    0H                                                  0186 00221000
@ER00001 LM    @14,@12,12(@13)                                     0186 00222000
         BR    @14                                                 0186 00223000
*   RFY                                                            0187 00224000
*    (RLIST,                                                       0187 00225000
*     RSCAN) RSTD;                                                 0187 00226000
*                                                                  0187 00227000
*   /*****************************************************************/ 00228000
*   /*                                                               */ 00229000
*   /* ISSUES MESSAGE : 'ONLY XXXK OF VIRTUAL SPACE AVAILABLE -      */ 00230000
*   /* RESPECIFY OR CANCEL'                                          */ 00231000
*   /*                                                               */ 00232000
*   /*****************************************************************/ 00233000
*                                                                  0188 00234000
*NP8SQAEX:                                                         0188 00235000
*   ;                                                              0188 00236000
NP8SQAEX DS    0H                                                  0189 00237000
*   RWRK1=(NVTLVIRT-NVTVVPG1)/NP81K;                               0189 00238000
         L     @00,NVTLVIRT(,RNVT)                                 0189 00239000
         SL    @00,NVTVVPG1(,RNVT)                                 0189 00240000
         SRDA  @00,32                                              0189 00241000
         D     @00,@CF00111                                        0189 00242000
         LR    RWRK1,@01                                           0189 00243000
*   GENERATE REFS(RWRK1,DWRD,MSG6A);                               0190 00244000
         CVD   6,DWRD               CONVERT TO DECIMAL FORM BINARY      00245000
         UNPK  MSG6A(7),DWRD+4(4)   UNPK FOR EBCDIC                     00246000
         OI    MSG6A+6,X'F0'        CORRECT LAST ZONE                   00247000
*   MSG6B='VIRTUAL';                /* VIRTUAL TYPE OF STORAGE       */ 00248000
         MVC   MSG6B(7),@CC01908                                   0191 00249000
*   MSG6C='SQA ';                                                  0192 00250000
         MVC   MSG6C(4),@CC01909                                   0192 00251000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDR           */ 00252000
         LA    RLIST,NP8PLST1                                      0193 00253000
*   RSCAN=ADDR(NP8RMSG1);           /* SET RSCAN TO REPLY            */ 00254000
         LA    RSCAN,NP8RMSG1                                      0194 00255000
*   NWTORMSG=ADDR(MSG6);            /* SET MSG ADDR IN PLIST         */ 00256000
*                                                                  0195 00257000
         LA    @07,MSG6                                            0195 00258000
         ST    @07,NWTORMSG(,RLIST)                                0195 00259000
*   /*****************************************************************/ 00260000
*   /*                                                               */ 00261000
*   /* ISSUE MESSAGE VIA NIPWTOR                                     */ 00262000
*   /*                                                               */ 00263000
*   /*****************************************************************/ 00264000
*                                                                  0196 00265000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   00266000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0196 00267000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             00268000
*   RFY                                                            0197 00269000
*     RLIST UNRSTD;                                                0197 00270000
*   GOTO NP8SQNEW;                  /* SYNTAX CHECK REPLY            */ 00271000
         B     NP8SQNEW                                            0198 00272000
*   RFY                                                            0199 00273000
*     RSCAN UNRSTD;                                                0199 00274000
*BUILDPG:                                                          0200 00275000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0200 00276000
*                                                                  0200 00277000
BUILDPG  DS    0H                                                  0201 00278000
*   /*****************************************************************/ 00279000
*   /*                                                               */ 00280000
*   /* THIS SECTION OF CODE IS ENTERED TO GETMAIN PAGE TABLE SPACE   */ 00281000
*   /* FOR SQA AND CSA AREAS. THESE TABLES ARE THEN SENT TO IEAVCSEG */ 00282000
*   /* TO INITIALIZE THEM.                                           */ 00283000
*   /*                                                               */ 00284000
*   /*****************************************************************/ 00285000
*                                                                  0201 00286000
*   SAVEE=REXIT;                                                   0201 00287000
         ST    REXIT,SAVEE                                         0201 00288000
*   RESPECIFY                                                      0202 00289000
*    (REG0,                                                        0202 00290000
*     REG1) RSTD;                                                  0202 00291000
*   RFY                                                            0203 00292000
*    (REG13,                                                       0203 00293000
*     RWRK1) RSTD;                                                 0203 00294000
*   AREA13=REG13;                   /* SAVE SAVE AREA ADDRESS        */ 00295000
         ST    REG13,AREA13                                        0204 00296000
*   REG13=0;                        /* INIT FOR GETMAIN              */ 00297000
         SLR   REG13,REG13                                         0205 00298000
*   RWRK1=72;                       /* 72 BYTES FOR SAVE AREA FOR  0206 00299000
*                                      CSEG                          */ 00300000
*                                                                  0206 00301000
         LA    RWRK1,72                                            0206 00302000
*   /*****************************************************************/ 00303000
*   /*                                                               */ 00304000
*   /* IF SQA BIT ON, THEN GETMAIN FOR PAGE TABLES NOT INCLUDING     */ 00305000
*   /* EXTERNAL PAGE TABLES                                          */ 00306000
*   /*                                                               */ 00307000
*   /*****************************************************************/ 00308000
*                                                                  0207 00309000
*   IF SQABIT='1'B THEN                                            0207 00310000
         TM    SQABIT,B'10000000'                                  0207 00311000
         BNO   @RF00207                                            0207 00312000
*     GMSIZE=DALUE*PAGELEN;                                        0208 00313000
         L     GMSIZE,DALUE                                        0208 00314000
         SLA   GMSIZE,5                                            0208 00315000
*   ELSE                                                           0209 00316000
*     DO;                                                          0209 00317000
*                                                                  0209 00318000
         B     @RC00207                                            0209 00319000
@RF00207 DS    0H                                                  0210 00320000
*       /*************************************************************/ 00321000
*       /*                                                           */ 00322000
*       /* SINCE PAGE TABLES CANNOT CROSS PAGE BOUNDARIES, DO        */ 00323000
*       /* MULTIPLE GETMAINS TO ENSURE THIS. IF THE LENGTH IS EQUAL  */ 00324000
*       /* TO OR LESS THAN 4096 BYTES, GETMAIN WILL HAVE AREA WITHIN */ 00325000
*       /* A PAGE. PAGE TABLE SPACE FOR 17 SEGMENTS AND 72 BYTE SAVE */ 00326000
*       /* AREA WILL FIT ON 1 PAGE.                                  */ 00327000
*       /*                                                           */ 00328000
*       /*************************************************************/ 00329000
*                                                                  0210 00330000
*       IF DALUE>17                 /* GREATER THAN 17 SEGMENTS      */ 00331000
*         THEN                                                     0210 00332000
         L     @09,DALUE                                           0210 00333000
         LA    @07,17                                              0210 00334000
         CR    @09,@07                                             0210 00335000
         BNH   @RF00210                                            0210 00336000
*         DO;                                                      0211 00337000
*           EXTRA=DALUE-17;                                        0212 00338000
         SLR   @09,@07                                             0212 00339000
         ST    @09,EXTRA                                           0212 00340000
*           DALUE=17;                                              0213 00341000
         ST    @07,DALUE                                           0213 00342000
*         END;                                                     0214 00343000
*                                                                  0214 00344000
*       /*************************************************************/ 00345000
*       /*                                                           */ 00346000
*       /* SET UP CORRECT GETMAIN SIZE TO INCLUDE PAGE TABLES AND    */ 00347000
*       /* SAVE AREA                                                 */ 00348000
*       /*                                                           */ 00349000
*       /*************************************************************/ 00350000
*                                                                  0215 00351000
*GETIT:                                                            0215 00352000
*       ;                                                          0215 00353000
@RF00210 DS    0H                                                  0215 00354000
GETIT    DS    0H                                                  0216 00355000
*       GMSIZE=DALUE*PAGELEN2;                                     0216 00356000
         L     GMSIZE,DALUE                                        0216 00357000
         MH    GMSIZE,@CH00120                                     0216 00358000
*     END;                                                         0217 00359000
*   RWRK1=RWRK1+GMSIZE;                                            0218 00360000
@RC00207 ALR   RWRK1,GMSIZE                                        0218 00361000
*   GENERATE REFS(RWRK1);                                          0219 00362000
*                                                                  0219 00363000
*                                   /* GENERATE UNCONDITIONL GETMAIN*/  00364000
         LA    0,245                   FROM SUBPOOL 245 SQA             00365000
         SLL   0,24                    PLACE IN HIGH ORDER BYTE         00366000
         AR    0,RWRK1                 INSERT TABLES LENGTH             00367000
         GETMAIN  R,LV=(0)             ISSUE GETMAIN                    00368000
*   /*****************************************************************/ 00369000
*   /*                                                               */ 00370000
*   /* IF SQA REQUEST, NO XPTE TABLES NEEDED                         */ 00371000
*   /*                                                               */ 00372000
*   /*****************************************************************/ 00373000
*                                                                  0220 00374000
*   IF SQABIT='1'B                  /* IF SQA NO XPTE NEEDED         */ 00375000
*     THEN                                                         0220 00376000
         TM    SQABIT,B'10000000'                                  0220 00377000
         BNO   @RF00220                                            0220 00378000
*     DO;                                                          0221 00379000
*       GENERATE;                                                  0222 00380000
         LA   0,64                 00000040  BIT ON INPLIES NO XPTES    00381000
         SLL  0,16                 00400000                             00382000
*     END;                                                         0223 00383000
*   ELSE                                                           0224 00384000
*     REG0=0;                                                      0224 00385000
         B     @RC00220                                            0224 00386000
@RF00220 SLR   REG0,REG0                                           0224 00387000
*   GENERATE REFS(DALUE,SEGINDX);                                  0225 00388000
@RC00220 DS    0H                                                  0225 00389000
*                                      /* @ZA04808*/                    00390000
         IC   0,DALUE+3            004000XX, WHERE XX IS NO. OF SEGS    00391000
         SLL  0,8                  4000XX00                             00392000
         IC   0,SEGINDX+3          4000XXYY, WHERE YY IS SEG INDEX      00393000
*   RESPECIFY                                                      0226 00394000
*     REG9 RSTD;                                                   0226 00395000
*                                                                  0226 00396000
*   /*****************************************************************/ 00397000
*   /*                                                               */ 00398000
*   /* IF REG13 = ZERO, THEN HAVE NOT GONE TO CREATE SEGMENT BEFORE  */ 00399000
*   /* WITH SAVE AREA ADDRESS. IF REG13 DOES NOT = ZERO, THEN ADDR IN*/ 00400000
*   /* REG13 IS VALID SAVE AREA DDRESSS.                             */ 00401000
*   /*                                                               */ 00402000
*   /*****************************************************************/ 00403000
*                                                                  0227 00404000
*   IF REG13=0 THEN                                                0227 00405000
         LTR   REG13,REG13                                         0227 00406000
         BNZ   @RF00227                                            0227 00407000
*     REG13=REG1+GMSIZE;                                           0228 00408000
         LR    REG13,REG1                                          0228 00409000
         ALR   REG13,GMSIZE                                        0228 00410000
*   PVTPTR=CVTPVTP;                 /* ADDR OF PVT IN CVT            */ 00411000
@RF00227 L     PVTPTR,CVTPVTP(,CVTPTR)                             0229 00412000
*   CALL IEAVCSEG;                  /* CALL CREATE SEG ROUTINE INPUT    00413000
*                                      TO RSM ROUTINE IS: R0= BYTE 0,   00414000
*                                      BIT 1 = 1 MEANS NO XPTES    0230 00415000
*                                      CREATED BYTE 1 = 0 BYTE 2 = 0230 00416000
*                                      NUMBER OF SEGS BYTE 3 =     0230 00417000
*                                      BEGINNING INDEX OF SEGMENT  0230 00418000
*                                      ADDRESS R1= PAGE TABLE AREA 0230 00419000
*                                      R13= SAVE AREA ADRESS R14=  0230 00420000
*                                      RETURN ADDRESS R15= IEAVCSEG     00421000
*                                      ENTRY ADDR                    */ 00422000
         L     @15,PVTPCSEG(,PVTPTR)                               0230 00423000
         BALR  @14,@15                                             0230 00424000
*   IF RCODE=0                      /* RC = 0, INIT OF TABLES OK     */ 00425000
*     THEN                                                         0231 00426000
         SLR   @14,@14                                             0231 00427000
         CR    RCODE,@14                                           0231 00428000
         BNE   @RF00231                                            0231 00429000
*     DO;                                                          0232 00430000
*                                                                  0232 00431000
*       /*************************************************************/ 00432000
*       /*                                                           */ 00433000
*       /* IF SQA REQUEST, THEN CAN ONLY CREATE 1 PAGE OF PAGE TABLES*/ 00434000
*       /*                                                           */ 00435000
*       /*************************************************************/ 00436000
*                                                                  0233 00437000
*       IF SQABIT='1'B THEN                                        0233 00438000
         TM    SQABIT,B'10000000'                                  0233 00439000
         BO    @RT00233                                            0233 00440000
*         GOTO FREIT;                                              0234 00441000
*                                                                  0234 00442000
*       /*************************************************************/ 00443000
*       /*                                                           */ 00444000
*       /* IF CSA REQUEST, CNA ONLY CREATE 17 SEGMENTS WORTH AT A    */ 00445000
*       /* TIME                                                      */ 00446000
*       /*                                                           */ 00447000
*       /*************************************************************/ 00448000
*                                                                  0235 00449000
*       IF EXTRA¬=0 THEN                                           0235 00450000
         L     @07,EXTRA                                           0235 00451000
         CR    @07,@14                                             0235 00452000
         BE    @RF00235                                            0235 00453000
*         DO;                                                      0236 00454000
*           IF EXTRA>17 THEN                                       0237 00455000
         LA    @15,17                                              0237 00456000
         CR    @07,@15                                             0237 00457000
         BNH   @RF00237                                            0237 00458000
*             DO;                                                  0238 00459000
*               EXTRA=EXTRA-17;                                    0239 00460000
         SLR   @07,@15                                             0239 00461000
         ST    @07,EXTRA                                           0239 00462000
*               DALUE=17;                                          0240 00463000
         ST    @15,DALUE                                           0240 00464000
*             END;                                                 0241 00465000
*           ELSE                                                   0242 00466000
*             DO;                                                  0242 00467000
         B     @RC00237                                            0242 00468000
@RF00237 DS    0H                                                  0243 00469000
*               DALUE=EXTRA;                                       0243 00470000
         L     @07,EXTRA                                           0243 00471000
         ST    @07,DALUE                                           0243 00472000
*               EXTRA=0;            /* LAST TIME THROUGH             */ 00473000
         SLR   @07,@07                                             0244 00474000
         ST    @07,EXTRA                                           0244 00475000
*             END;                                                 0245 00476000
*           SEGINDX=SEGINDX+17;                                    0246 00477000
@RC00237 LA    @07,17                                              0246 00478000
         AL    @07,SEGINDX                                         0246 00479000
         ST    @07,SEGINDX                                         0246 00480000
*           RWRK1=0;                                               0247 00481000
         SLR   RWRK1,RWRK1                                         0247 00482000
*           GOTO GETIT;             /* GO TO GETMAIN                 */ 00483000
         B     GETIT                                               0248 00484000
*         END;                                                     0249 00485000
*                                                                  0249 00486000
*       /*************************************************************/ 00487000
*       /*                                                           */ 00488000
*       /* FREE SAVE AREA USED BY CREATE SEGMENT ROUTINE             */ 00489000
*       /*                                                           */ 00490000
*       /*************************************************************/ 00491000
*                                                                  0250 00492000
*FREIT:                                                            0250 00493000
*       ;                                                          0250 00494000
@RF00235 DS    0H                                                  0250 00495000
FREIT    DS    0H                                                  0251 00496000
*       REG1=REG13;                 /* REG13 SAVE AREA ADDRESS       */ 00497000
         LR    REG1,REG13                                          0251 00498000
*       GENERATE;                                                  0252 00499000
               FREEMAIN  R,LV=72,A=(1),SP=245                           00500000
*       RESPECIFY                                                  0253 00501000
*         REG9 UNRSTD;                                             0253 00502000
*       RESPECIFY                                                  0254 00503000
*        (REG0,                                                    0254 00504000
*         REG1) UNRSTD;                                            0254 00505000
*     END;                                                         0255 00506000
*   ELSE                            /* INFORM OPERATOR OF SQA        */ 00507000
*     DO;                           /* CREATION PROBLEM              */ 00508000
*                                                                  0256 00509000
         B     @RC00231                                            0256 00510000
@RF00231 DS    0H                                                  0257 00511000
*       /*************************************************************/ 00512000
*       /*                                                           */ 00513000
*       /* UNABLE TO INIT. PAGE AND/OR SEGMENT TABLES FOR SQA OR CSA.*/ 00514000
*       /*                                                           */ 00515000
*       /*************************************************************/ 00516000
*                                                                  0257 00517000
*W:                                                                0257 00518000
*       ;                                                          0257 00519000
W        DS    0H                                                  0258 00520000
*       GEN REFS(NVTWTO,RNVT,MSG4) SETS(RPARM,REXIT,RENTRY)        0258 00521000
*           (IEAPMNIP  TYPE=WTO,PARAM=MSG4) ;                      0258 00522000
         IEAPMNIP  TYPE=WTO,PARAM=MSG4                                  00523000
*       NVTFLWSC='3D'X;             /* 03D IS WAIT STATE CODE        */ 00524000
         MVI   NVTFLWSC(RNVT),X'3D'                                0259 00525000
*       GEN REFS(NVTSWAIT)(IEAPMNIP  TYPE=SWAIT) ;/* SEVERE SYSTEM 0260 00526000
*                                      PROBLEM, SEND SYSTEM INTO   0260 00527000
*                                      DISABLED WAIT                 */ 00528000
         IEAPMNIP  TYPE=SWAIT                                           00529000
*     END;                                                         0261 00530000
*   REG13=AREA13;                                                  0262 00531000
@RC00231 L     REG13,AREA13                                        0262 00532000
*   REXIT=SAVEE;                                                   0263 00533000
         L     REXIT,SAVEE                                         0263 00534000
*   RFY                                                            0264 00535000
*    (REG13,                                                       0264 00536000
*     RWRK1) UNRSTD;                                               0264 00537000
*   END BUILDPG;                                                   0265 00538000
@EL00002 DS    0H                                                  0265 00539000
@EF00002 DS    0H                                                  0265 00540000
@ER00002 BR    @14                                                 0265 00541000
*NP8SQACS:                                                         0266 00542000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0266 00543000
*                                                                  0266 00544000
NP8SQACS DS    0H                                                  0267 00545000
*   /*****************************************************************/ 00546000
*   /*                                                               */ 00547000
*   /* THIS ROUTINE IS ENTERED TO COMPARE THE PREVIOUS SQA SIZE WITH */ 00548000
*   /* THE REQUESTED ONE. IF THEY ARE THE SAME, WHICH THEY SHOULD BE */ 00549000
*   /* IN A QUICKSTART SITUATION, THEN RETURN AND CONTINUE           */ 00550000
*   /* PROCESSING. OTHERWISE, ISSUE A MESSAGE TO THE OPERATOR AND    */ 00551000
*   /* INFORM HIM THAT THE SYSTEM IS ASSUMING THE SAME SQA SIZE AS   */ 00552000
*   /* THE LAST IPL SIZE. AFTER THE WTOR, CONTROL IS RETURNED AND SQA*/ 00553000
*   /* PROCESSING CONTINUES.                                         */ 00554000
*   /*                                                               */ 00555000
*   /*****************************************************************/ 00556000
*                                                                  0267 00557000
*   SAVEE=REXIT;                    /* SAVE RETURN ADDRESS           */ 00558000
         ST    REXIT,SAVEE                                         0267 00559000
*   IF LOWADDR¬=NVTLPAND            /* IF NEW SQA SIZE IS NOT EQUAL  */ 00560000
*     THEN                          /* TO RECLAIMED SQA INFORM       */ 00561000
         CLC   LOWADDR(4),NVTLPAND(RNVT)                           0268 00562000
         BE    @RF00268                                            0268 00563000
*     DO;                           /* OPERATOR OF DEFAULT AND GOON  */ 00564000
*       RFY                                                        0270 00565000
*         RLIST RSTD;                                              0270 00566000
*                                                                  0270 00567000
*       /*************************************************************/ 00568000
*       /*                                                           */ 00569000
*       /* ISSUE MESSAGE : 'QUICKSTART REQUIRES PREVIOUS IPL SQA SIZE*/ 00570000
*       /* - PREVIOUS SIZE USED.'                                    */ 00571000
*       /*                                                           */ 00572000
*       /*************************************************************/ 00573000
*                                                                  0271 00574000
*       GEN REFS(NVTWTO)(IEAPMNIP TYPE=WTO,PARAM=MSG3) ;           0271 00575000
         IEAPMNIP TYPE=WTO,PARAM=MSG3                                   00576000
*       RFY                                                        0272 00577000
*         RLIST UNRSTD;                                            0272 00578000
*       LOWADDR=NVTLPAND;           /* CHANGE SQA LOW ADDR           */ 00579000
         L     @09,NVTLPAND(,RNVT)                                 0273 00580000
         ST    @09,LOWADDR                                         0273 00581000
*       AREASZ=NVTLVIRT-NVTLPAND;                                  0274 00582000
*                                                                  0274 00583000
         LCR   @09,@09                                             0274 00584000
         AL    @09,NVTLVIRT(,RNVT)                                 0274 00585000
         ST    @09,AREASZ                                          0274 00586000
*       /*************************************************************/ 00587000
*       /*                                                           */ 00588000
*       /* CHANGE AREA SIZE FOR ADDNL SQA                            */ 00589000
*       /*                                                           */ 00590000
*       /*************************************************************/ 00591000
*                                                                  0275 00592000
*       VALUE=AREASZ/NP864K;                                       0275 00593000
*                                                                  0275 00594000
         SRL   @09,16                                              0275 00595000
         ST    @09,VALUE                                           0275 00596000
*       /*************************************************************/ 00597000
*       /*                                                           */ 00598000
*       /* CHANGE NO. OF ADDITIONAL SEGS                             */ 00599000
*       /*                                                           */ 00600000
*       /*************************************************************/ 00601000
*                                                                  0276 00602000
*     END;                                                         0276 00603000
*   REXIT=SAVEE;                    /* RESTORE RETURN ADDRESS        */ 00604000
@RF00268 L     REXIT,SAVEE                                         0277 00605000
*   END NP8SQACS;                                                  0278 00606000
@EL00003 DS    0H                                                  0278 00607000
@EF00003 DS    0H                                                  0278 00608000
@ER00003 BR    @14                                                 0278 00609000
*NP8SQBLK:                                                         0279 00610000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0279 00611000
*                                                                  0279 00612000
NP8SQBLK DS    0H                                                  0280 00613000
*   /*****************************************************************/ 00614000
*   /*                                                               */ 00615000
*   /* RESET IN THE GDA THE DQE FOR SQA AND THE LOWEST FQE ON THE FQE*/ 00616000
*   /* CHAIN AND RETURN TO THE MAINLINE. THESE CONTROL BLOCKS MUST BE*/ 00617000
*   /* UPDATED TO REFLECT THE NEW AREA OBTAINED FOR SQA.             */ 00618000
*   /*                                                               */ 00619000
*   /*****************************************************************/ 00620000
*                                                                  0280 00621000
*   RFY                                                            0280 00622000
*    (DQESEPTR,                                                    0280 00623000
*     FQESEPTR) RSTD;                                              0280 00624000
*   SAVEE=REXIT;                    /* SAVE RETURN ADDRESS           */ 00625000
         ST    REXIT,SAVEE                                         0281 00626000
*   SPQESPTR=SQASPQEP;              /* INIT. SQA SPQE PTR            */ 00627000
         L     SPQESPTR,SQASPQEP(,GDAPTR)                          0282 00628000
*   DQESEPTR=SPDQEAD;               /* LOAD SQA DQE ADDRESS          */ 00629000
         L     DQESEPTR,SPDQEAD(,SPQESPTR)                         0283 00630000
*   DQEBLKAD=LOWADDR;               /* ALTER SQA BEGIN ADDRESS       */ 00631000
         L     @09,LOWADDR                                         0284 00632000
         ST    @09,DQEBLKAD(,DQESEPTR)                             0284 00633000
*   DQELNTH=DQELNTH+AREASZ;         /* ALTER SQA LENGTH FIELD        */ 00634000
         L     @09,DQELNTH(,DQESEPTR)                              0285 00635000
         AL    @09,AREASZ                                          0285 00636000
         ST    @09,DQELNTH(,DQESEPTR)                              0285 00637000
*   FQESEPTR=DQFQEPTR;              /* LOAD FQE ADDR - TOP OF CHAIN  */ 00638000
*                                                                  0286 00639000
         L     FQESEPTR,DQFQEPTR(,DQESEPTR)                        0286 00640000
*   /*****************************************************************/ 00641000
*   /*                                                               */ 00642000
*   /* SEARCH TO BOTTOM OF SQA FQE CHAIN. WHEN THE LOWEST FQE IS     */ 00643000
*   /* FOUND, SET FQELNTH TO REFLECT SQA EXPANSION.                  */ 00644000
*   /*                                                               */ 00645000
*   /*****************************************************************/ 00646000
*                                                                  0287 00647000
*NP8FQELP:                                                         0287 00648000
*   IF FQEPTR¬=0                    /* THIS THE LOWEST FQE ?         */ 00649000
*     THEN                          /* IF NOT, NOT AT BOTTOM         */ 00650000
NP8FQELP L     @09,FQEPTR(,FQESEPTR)                               0287 00651000
         LTR   @09,@09                                             0287 00652000
         BZ    @RF00287                                            0287 00653000
*     DO;                           /* CONTINUE FQE LOOP             */ 00654000
*       FQESEPTR=FQEPTR;            /* SET FQE BASE TO FORWARD PTR   */ 00655000
         LR    FQESEPTR,@09                                        0289 00656000
*       GOTO NP8FQELP;              /* GO TO TOP OF LOOP             */ 00657000
         B     NP8FQELP                                            0290 00658000
*     END;                                                         0291 00659000
*                                                                  0291 00660000
*   /*****************************************************************/ 00661000
*   /*                                                               */ 00662000
*   /* BOTTOM FQE FOUND - ALTER FOR SQA EXPANSION                    */ 00663000
*   /*                                                               */ 00664000
*   /*****************************************************************/ 00665000
*                                                                  0292 00666000
*   FQELNTH=FQELNTH+AREASZ;                                        0292 00667000
@RF00287 L     @09,FQELNTH(,FQESEPTR)                              0292 00668000
         AL    @09,AREASZ                                          0292 00669000
         ST    @09,FQELNTH(,FQESEPTR)                              0292 00670000
*   REXIT=SAVEE;                    /* RESTORE RETURN ADDRESS        */ 00671000
         L     REXIT,SAVEE                                         0293 00672000
*   RFY                                                            0294 00673000
*    (DQESEPTR,                                                    0294 00674000
*     FQESEPTR) UNRSTD;                                            0294 00675000
*   END NP8SQBLK;                                                  0295 00676000
@EL00004 DS    0H                                                  0295 00677000
@EF00004 DS    0H                                                  0295 00678000
@ER00004 BR    @14                                                 0295 00679000
*   RFY                                                            0296 00680000
*    (RLIST,                                                       0296 00681000
*     RSCAN) RSTD;                                                 0296 00682000
*                                                                  0296 00683000
*   /*****************************************************************/ 00684000
*   /*                                                               */ 00685000
*   /* ENTERED WHENEVER AN INVALID SQA PARAMETER HAS BEEN            */ 00686000
*   /* ENCOUNTERED. THE MESSAGE 'INVALID SQA PARM- RESPECIFY OR      */ 00687000
*   /* CANCEL' IS ISSUED. IF REPLY IS EOB, REPLY IS ANALYZED AGAIN.  */ 00688000
*   /*                                                               */ 00689000
*   /*****************************************************************/ 00690000
*                                                                  0297 00691000
*NP8SQINV:                                                         0297 00692000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDRESS        */ 00693000
NP8SQINV LA    RLIST,NP8PLST1                                      0297 00694000
*   RSCAN=ADDR(NP8RMSG1);           /* SET SCAN POINTER TO REPLY     */ 00695000
         LA    RSCAN,NP8RMSG1                                      0298 00696000
*   MSG1A='SQA   ';                 /* SET PARM TO 'SQA'             */ 00697000
         MVC   MSG1A(6),@CC01930                                   0299 00698000
*   NWTORMSG=ADDR(MSG1);            /* SET MSG ADDR IN PARM LIST     */ 00699000
*                                                                  0300 00700000
         LA    @07,MSG1                                            0300 00701000
         ST    @07,NWTORMSG(,RLIST)                                0300 00702000
*   /*****************************************************************/ 00703000
*   /*                                                               */ 00704000
*   /* ISSUE MESSAGE: 'INVALID SQA PARM - - RESPECIFY OR CANCEL'     */ 00705000
*   /*                                                               */ 00706000
*   /*****************************************************************/ 00707000
*                                                                  0301 00708000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   00709000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0301 00710000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             00711000
*   RFY                                                            0302 00712000
*     RLIST UNRSTD;                                                0302 00713000
*                                                                  0302 00714000
*   /*****************************************************************/ 00715000
*   /*                                                               */ 00716000
*   /* ANALYZE REPLY - IF EOB, SUPPLY DEFAULT AND CONTINUE. IF NOT   */ 00717000
*   /* EOB, BRANCH TO NP4SQNEW TO PROCESS REPLY AGAIN. DEFAULT IS    */ 00718000
*   /* TAKEN AND PROCESSING CONTINUES. IF NOT,                       */ 00719000
*   /*                                                               */ 00720000
*   /*****************************************************************/ 00721000
*                                                                  0303 00722000
*NP8SQNEW:                                                         0303 00723000
*   IF S2CHAR=' '''                 /* REPLY = EOB ?                 */ 00724000
*     THEN                                                         0303 00725000
NP8SQNEW CLC   S2CHAR(2,RSCAN),@CC01931                            0303 00726000
         BNE   @RF00303                                            0303 00727000
*     DO;                                                          0304 00728000
*       VALUE=SQADFLT;              /* SUPPLY DEFAULT                */ 00729000
         MVC   VALUE(4),@CF00062                                   0305 00730000
*       GOTO NP8SQOK;               /* CONTINUE PROCESSING           */ 00731000
         B     NP8SQOK                                             0306 00732000
*     END;                                                         0307 00733000
*                                                                  0307 00734000
*   /*****************************************************************/ 00735000
*   /*                                                               */ 00736000
*   /* ANALYZE RESPECIFIED REPLY. REPLY MUST BEGIN WITH 'SQA=' IF IT */ 00737000
*   /* DOES, GO TO SYNTAX CHECKER FOR PARM VALUE. OTHERWISE, ASK     */ 00738000
*   /* OPERATOR TO RESPECIFY SQA REPLY.                              */ 00739000
*   /*                                                               */ 00740000
*   /*****************************************************************/ 00741000
*                                                                  0308 00742000
*   IF S4CHAR¬='SQA='               /* KEYWORD = 'SQA=' ?            */ 00743000
*     THEN                          /* IF NOT, THEN REPLY NOT VALID  */ 00744000
@RF00303 CLC   S4CHAR(4,RSCAN),@CC01933                            0308 00745000
         BNE   @RT00308                                            0308 00746000
*     GOTO NP8SQINV;                /* ISSUE INVALID PARM MESSAGE    */ 00747000
*   RSCAN=RSCAN+LENGTH('SQA=');     /* POINT PAST KEYWORD            */ 00748000
         AL    RSCAN,@CF00059                                      0310 00749000
*   PCT=MAXSQA;                     /* MAXIMUM ALLOWED DIGITS = 3    */ 00750000
         LA    PCT,3                                               0311 00751000
*   CALL NP8VNUM;                   /* SYNTAX ROUTINE                */ 00752000
         BAL   @14,NP8VNUM                                         0312 00753000
*   IF RCODE=0                      /* IF RETURN CODE=0,THEN SYNTAX     00754000
*                                      OK                            */ 00755000
*     THEN                                                         0313 00756000
         LTR   RCODE,RCODE                                         0313 00757000
         BZ    @RT00313                                            0313 00758000
*     GO TO NP8SQOK;                /* GOTO GOOD CONTINUE            */ 00759000
*   ELSE                                                           0315 00760000
*     GO TO NP8SQINV;               /* IF RETRN CODE=4,THEN SYNTX BAD*/ 00761000
         B     NP8SQINV                                            0315 00762000
*   RFY                                                            0316 00763000
*     RSCAN UNRSTD;                                                0316 00764000
*IEAVNPB8:                                                         0317 00765000
*   ENTRY;                                                         0317 00766000
*                                                                  0317 00767000
@EP00317 DS    0H                                                  0318 00768000
*   /*****************************************************************/ 00769000
*   /*                                                               */ 00770000
*   /* THE CSA PARM VALUE SPECIFIES THE SIZE OF THE COMMON STORAGE   */ 00771000
*   /* AREA IN 1K BLOCKS. A MAXIMUM OF 4 DIGITS IS VALID. CSA IS     */ 00772000
*   /* LOCATED RIGHT BELOW LPA. ITS HIGH ADDR IS ON A (4K -1 BDRY)   */ 00773000
*   /* AND ITS LOW ADDR IS ON A SEGMENT BOUNDARY. IF A CSA VALUE IS  */ 00774000
*   /* NOT SPECIFIED, THE SYSTEM SUPPLIES A DEFAULT OF 100K.         */ 00775000
*   /* PAGE,PAGE EXTENSION, AND SEGMENT TABLES MUST NOT BE ALLOCATED */ 00776000
*   /* AND INITIALIZED FOR THIS AREA SINCE NIP PROCESSING HAS ALREADY*/ 00777000
*   /* CREATED THEM. VSM CONTROL BLOCKS LOCATED IN GDA ARE           */ 00778000
*   /* INITIALIZED I.E. PQE AND FBQE.                                */ 00779000
*   /*                                                               */ 00780000
*   /*****************************************************************/ 00781000
*                                                                  0318 00782000
*   RFY                                                            0318 00783000
*     RSCAN RSTD;                                                  0318 00784000
*   GDAPTR=CVTGDA;                                                 0319 00785000
         L     GDAPTR,CVTGDA(,CVTPTR)                              0319 00786000
*   RPTAB=NVTPTAB;                  /* LOAD PARM TABLE ADDRESS       */ 00787000
         L     RPTAB,NVTPTAB(,RNVT)                                0320 00788000
*   RSCAN=CSA;                      /* LOAD CSA PARM ADDRESS         */ 00789000
*                                                                  0321 00790000
         L     RSCAN,CSA(,RPTAB)                                   0321 00791000
*   /*****************************************************************/ 00792000
*   /*                                                               */ 00793000
*   /* IF THE CSA PARM IS ZERO, THEN GIVE USER DEFAULT OF 100 IF PARM*/ 00794000
*   /* ADDR IS NOT 0, THEN SYNTAX CHECK THE PARAMETER                */ 00795000
*   /*                                                               */ 00796000
*   /*****************************************************************/ 00797000
*                                                                  0322 00798000
*   IF RSCAN=0                      /* IF 0, NO CSA PARM SPECIFIED   */ 00799000
*     THEN                                                         0322 00800000
         LTR   RSCAN,RSCAN                                         0322 00801000
         BNZ   @RF00322                                            0322 00802000
*     VALUE=CSADFLT;                /* DEFAULT TO 100K AREA FOR CSA  */ 00803000
         MVC   VALUE(4),@CF00123                                   0323 00804000
*   ELSE                                                           0324 00805000
*     DO;                           /* SYNTAX CHECK CSA PARM FOR 4   */ 00806000
         B     @RC00322                                            0324 00807000
@RF00322 DS    0H                                                  0325 00808000
*       RFY                                                        0325 00809000
*         RSCAN UNRSTD;                                            0325 00810000
*       PCT=MAXCSA;                 /* SET UP INPUT PARMS TO CALL  0326 00811000
*                                      SYNTAX CHECKER                */ 00812000
         LA    PCT,4                                               0326 00813000
*       CALL NP8VNUM;               /* IF SYNTAX IS CORRECT, RETURN     00814000
*                                      CODE = 0. IF INVALID, RC = 4  */ 00815000
         BAL   @14,NP8VNUM                                         0327 00816000
*       IF RCODE=0                  /* SYNTAX OK, IF R.C. = 0        */ 00817000
*         THEN                                                     0328 00818000
         LTR   RCODE,RCODE                                         0328 00819000
         BZ    @RT00328                                            0328 00820000
*         GO TO NP8CSAOK;           /* GOTO GGOD CSA                 */ 00821000
*       ELSE                                                       0330 00822000
*         GO TO NP8CSINV;           /* GO TO INVALID CSA             */ 00823000
         B     NP8CSINV                                            0330 00824000
*       RFY                                                        0331 00825000
*         RSCAN UNRSTD;                                            0331 00826000
*     END;                                                         0332 00827000
*                                                                  0332 00828000
*   /*****************************************************************/ 00829000
*   /*                                                               */ 00830000
*   /* IF LOW ADDR OF LPA NOT ON PAGE BDRY(4K),THEN ROUND DOWN AND   */ 00831000
*   /* SET HIGH CSA ADDR ON NEXT LOWEST 4K BOUNDARY.                 */ 00832000
*   /*                                                               */ 00833000
*   /*****************************************************************/ 00834000
*                                                                  0333 00835000
*NP8CSAOK:                                                         0333 00836000
*   IF(NVTLVIRT//NP84K)¬=0          /* NVTLVIRT MULTIPLE OF 4K ?     */ 00837000
*     THEN                                                         0333 00838000
@RC00322 DS    0H                                                  0333 00839000
NP8CSAOK L     @09,NVTLVIRT(,RNVT)                                 0333 00840000
         LR    @00,@09                                             0333 00841000
         SRDA  @00,32                                              0333 00842000
         D     @00,@CF00113                                        0333 00843000
         LTR   @00,@00                                             0333 00844000
         BZ    @RF00333                                            0333 00845000
*     HIADDR=NVTLVIRT-(NVTLVIRT//NP84K);                           0334 00846000
         LR    @00,@09                                             0334 00847000
         SRDA  @00,32                                              0334 00848000
         D     @00,@CF00113                                        0334 00849000
         SLR   @09,@00                                             0334 00850000
         LR    HIADDR,@09                                          0334 00851000
*   ELSE                            /* IF LPA ON 4K BDRY, HIGH       */ 00852000
*     HIADDR=NVTLVIRT;              /* CSA ADDR IS LPA ADDR MINUS 1  */ 00853000
*                                                                  0335 00854000
         B     @RC00333                                            0335 00855000
@RF00333 L     HIADDR,NVTLVIRT(,RNVT)                              0335 00856000
*   /*****************************************************************/ 00857000
*   /*                                                               */ 00858000
*   /* IF TOP OF CSA WOULD BE BETWEEN 0 AND 8 MEGS, DO NOT ALLOW     */ 00859000
*   /*                                                               */ 00860000
*   /*****************************************************************/ 00861000
*                                                                  0336 00862000
*   IF HIADDR<=NVTVVPG1 THEN                                       0336 00863000
@RC00333 L     @09,NVTVVPG1(,RNVT)                                 0336 00864000
         CR    HIADDR,@09                                          0336 00865000
         BNH   @RT00336                                            0336 00866000
*     GOTO W;                       /* LOW CSA ADDR IS FOUND BY      */ 00867000
*   VALUE=VALUE*NP81K;              /* VALUE IN BYTES                */ 00868000
*                                                                  0338 00869000
         L     @05,VALUE                                           0338 00870000
         SLA   @05,10                                              0338 00871000
         ST    @05,VALUE                                           0338 00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* IF REQUESTED SIZE IS GREATER THAN 8 MEGS, DONOT ALLOW         */ 00875000
*   /*                                                               */ 00876000
*   /*****************************************************************/ 00877000
*                                                                  0339 00878000
*   IF VALUE>=NVTVVPG1 THEN                                        0339 00879000
         CR    @05,@09                                             0339 00880000
         BL    @RF00339                                            0339 00881000
*     CALL NP8COLAP;                                               0340 00882000
         BAL   @14,NP8COLAP                                        0340 00883000
*   LOWADDR=HIADDR-VALUE;           /* SUBTRACTING SIZE OF CSA FROM     00884000
*                                      HIGH ADDR.                    */ 00885000
*                                                                  0341 00886000
@RF00339 LR    @09,HIADDR                                          0341 00887000
         SL    @09,VALUE                                           0341 00888000
         ST    @09,LOWADDR                                         0341 00889000
*   /*****************************************************************/ 00890000
*   /*                                                               */ 00891000
*   /* IF LOW ADDR NOT ON 64K BOUNDARY, THEN ROUND DOWN TO NEAREST   */ 00892000
*   /* 64K MULTIPLE.                                                 */ 00893000
*   /*                                                               */ 00894000
*   /*****************************************************************/ 00895000
*                                                                  0342 00896000
*   IF(LOWADDR//NP864K)¬=0          /* LOW CSA ADDR ON SEG. BDRY ?   */ 00897000
*     THEN                                                         0342 00898000
         LR    @00,@09                                             0342 00899000
         SRDA  @00,32                                              0342 00900000
         D     @00,@CF00109                                        0342 00901000
         LTR   @00,@00                                             0342 00902000
         BZ    @RF00342                                            0342 00903000
*     DO;                                                          0343 00904000
*       LOWADDR=(LOWADDR/NP864K)*NP864K;                           0344 00905000
         SRL   @09,16                                              0344 00906000
         SLA   @09,16                                              0344 00907000
         ST    @09,LOWADDR                                         0344 00908000
*       VALUE=HIADDR-LOWADDR;                                      0345 00909000
         LCR   @09,@09                                             0345 00910000
         ALR   @09,HIADDR                                          0345 00911000
         ST    @09,VALUE                                           0345 00912000
*     END;                                                         0346 00913000
*                                                                  0346 00914000
*   /*****************************************************************/ 00915000
*   /*                                                               */ 00916000
*   /* COMPARE LOWCSA ADDRESS TO FIRST PAGE ADDR OF V=V AREA IF CSA  */ 00917000
*   /* CANNOT BE CONTAINED IN V=V REGION, INFORM OP AND ASK HIM TO   */ 00918000
*   /* RESPECIFY CSA SIZE.                                           */ 00919000
*   /*                                                               */ 00920000
*   /*****************************************************************/ 00921000
*                                                                  0347 00922000
*   IF LOWADDR<NVTVVPG1             /* LOWCSA OUT OF V=V AREA ?      */ 00923000
*     THEN                                                         0347 00924000
@RF00342 CLC   LOWADDR(4),NVTVVPG1(RNVT)                           0347 00925000
         BNL   @RF00347                                            0347 00926000
*     CALL NP8COLAP;                /* ASK OPERATOR TO RESPECIFY     */ 00927000
         BAL   @14,NP8COLAP                                        0348 00928000
*   SEGINDX=LOWADDR/NP864K;         /* SEGINDX =FIRST SEGMENT INDEX  */ 00929000
@RF00347 L     @09,LOWADDR                                         0349 00930000
         SRL   @09,16                                              0349 00931000
         ST    @09,SEGINDX                                         0349 00932000
*   DALUE=VALUE/NP864K;             /* NEED TO BE NUMBER OF SEGS     */ 00933000
*                                                                  0350 00934000
         L     @09,VALUE                                           0350 00935000
         SRL   @09,16                                              0350 00936000
         ST    @09,DALUE                                           0350 00937000
*   /*****************************************************************/ 00938000
*   /*                                                               */ 00939000
*   /* IF NO SEGMENTS TO CREATE, CONTINUE                            */ 00940000
*   /*                                                               */ 00941000
*   /*****************************************************************/ 00942000
*                                                                  0351 00943000
*   IF DALUE=0 THEN                                                0351 00944000
         LTR   @09,@09                                             0351 00945000
         BZ    @RT00351                                            0351 00946000
*     GOTO NC;                                                     0352 00947000
*   PVTPTR=CVTPVTP;                                                0353 00948000
         L     PVTPTR,CVTPVTP(,CVTPTR)                             0353 00949000
*   CSABIT='1'B;                                                   0354 00950000
         OI    CSABIT,B'10000000'                                  0354 00951000
*   CALL BUILDPG;                   /* BUILD PAGE TABLES FOR CSA     */ 00952000
         BAL   @14,BUILDPG                                         0355 00953000
*   CSABIT='0'B;                                                   0356 00954000
*                                                                  0356 00955000
         NI    CSABIT,B'01111111'                                  0356 00956000
*   /*****************************************************************/ 00957000
*   /*                                                               */ 00958000
*   /* BUILD VSM CONTROL BLOCKS TO DESCRIBE CSA                      */ 00959000
*   /*                                                               */ 00960000
*   /*****************************************************************/ 00961000
*                                                                  0357 00962000
*NC:                                                               0357 00963000
*   CALL NP8CSBLK;                                                 0357 00964000
NC       BAL   @14,NP8CSBLK                                        0357 00965000
*   NVTLVIRT=LOWADDR;               /* CURRENT LOW VIRTUAL ADDR USED */ 00966000
         L     @09,LOWADDR                                         0358 00967000
         ST    @09,NVTLVIRT(,RNVT)                                 0358 00968000
*   CVTSHRVM=LOWADDR;               /* LOWEST SHARED VIRT ADDR       */ 00969000
         ST    @09,CVTSHRVM(,CVTPTR)                               0359 00970000
*   RFY                                                            0360 00971000
*     PVTPTR RSTD;                                                 0360 00972000
*   PVTPTR=CVTPVTP;                 /* GET PVT ADDR FROM CVT         */ 00973000
         L     PVTPTR,CVTPVTP(,CVTPTR)                             0361 00974000
*   PVTLCSA=LOWADDR/NP84K;          /* SHIFT SSP DOWN                */ 00975000
         SRL   @09,12                                              0362 00976000
         STH   @09,PVTLCSA(,PVTPTR)                                0362 00977000
*   PVTLCSA=PVTLCSA*16;             /* PAD WITH 1 BYTE ZER0          */ 00978000
         SLA   @09,4                                               0363 00979000
         STH   @09,PVTLCSA(,PVTPTR)                                0363 00980000
*   RFY                                                            0364 00981000
*     PVTPTR UNRSTD;                                               0364 00982000
*   RETURN;                                                        0365 00983000
         B     @EL00001                                            0365 00984000
*NP8CSBLK:                                                         0366 00985000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0366 00986000
*                                                                  0366 00987000
NP8CSBLK DS    0H                                                  0367 00988000
*   /*****************************************************************/ 00989000
*   /*                                                               */ 00990000
*   /* INITIALIZE THE PQE AND FBQE FOR CSA. THESE CONTROL BLKS ARE   */ 00991000
*   /* FOUND IN GDA. DISABLE SYSTEM TO SET UP VSM CONTROL BLOCKS     */ 00992000
*   /*                                                               */ 00993000
*   /*****************************************************************/ 00994000
*                                                                  0367 00995000
*   RFY                                                            0367 00996000
*    (PQESEPTR,                                                    0367 00997000
*     FBQESPTR) RSTD;                                              0367 00998000
*   SAVEE=REXIT;                    /* SAVE RETURN ADDRESS           */ 00999000
         ST    REXIT,SAVEE                                         0368 01000000
*   PQESEPTR=CSAPQEP;               /* PQE POINTER                   */ 01001000
         L     PQESEPTR,CSAPQEP(,GDAPTR)                           0369 01002000
*   FBQESPTR=PQEFFBQE;              /* GET FBQE PTR FORM PQE         */ 01003000
         L     FBQESPTR,PQEFFBQE(,PQESEPTR)                        0370 01004000
*   PQESIZE=VALUE;                  /* CSA SIZE IN BYTES             */ 01005000
         L     @09,VALUE                                           0371 01006000
         ST    @09,PQESIZE(,PQESEPTR)                              0371 01007000
*   SQASPLFT=VALUE+SQASPLFT;        /* CSA MAY BE USED FOR SQA       */ 01008000
         LR    @06,@09                                             0372 01009000
         AL    @06,SQASPLFT(,GDAPTR)                               0372 01010000
         ST    @06,SQASPLFT(,GDAPTR)                               0372 01011000
*   PQEREGN=LOWADDR;                /* ADDR OF FIRST BYTE OF REGION  */ 01012000
         L     @06,LOWADDR                                         0373 01013000
         ST    @06,PQEREGN(,PQESEPTR)                              0373 01014000
*   FWDPTR=ADDR(PQESECT);           /* PTR TO NEXT FBQE OR PQE IN  0374 01015000
*                                      THIS CASE ADDR(PQE)           */ 01016000
         ST    PQESEPTR,FWDPTR(,FBQESPTR)                          0374 01017000
*   BCKPTR=ADDR(PQESECT);           /* PTR TO PREVIOUS FBQE OR PQE IN   01018000
*                                      THIS CASE ADDR(PQE)           */ 01019000
         ST    PQESEPTR,BCKPTR(,FBQESPTR)                          0375 01020000
*   SIZE=VALUE;                     /* SIZE IN BYTES OF WHOLE CSA    */ 01021000
         ST    @09,SIZE(,FBQESPTR)                                 0376 01022000
*   FBQAREA=LOWADDR;                /* LOW ADDR OF FREE BLOCK AFTER     01023000
*                                      CONROL BLOCKS SET UP          */ 01024000
         ST    @06,FBQAREA(,FBQESPTR)                              0377 01025000
*   REXIT=SAVEE;                    /* RESTORE RETURN ADDRESS        */ 01026000
         L     @09,SAVEE                                           0378 01027000
         LR    REXIT,@09                                           0378 01028000
*   END NP8CSBLK;                                                  0379 01029000
@EL00005 DS    0H                                                  0379 01030000
@EF00005 DS    0H                                                  0379 01031000
@ER00005 BR    @14                                                 0379 01032000
*   RFY                                                            0380 01033000
*    (PQESEPTR,                                                    0380 01034000
*     FBQESPTR) UNRSTD;                                            0380 01035000
*NP8COLAP:                                                         0381 01036000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0381 01037000
NP8COLAP DS    0H                                                  0382 01038000
*   RFY                                                            0382 01039000
*    (RLIST,                                                       0382 01040000
*     RSCAN) RSTD;                                                 0382 01041000
*                                                                  0382 01042000
*   /*****************************************************************/ 01043000
*   /*                                                               */ 01044000
*   /* THIS ROUTINE IS ENTERED WHEN ALLOCATION FOR CSA RUNS OUT OF   */ 01045000
*   /* V=V SPACE.. A MESSAGE IS ISSUED TO OPERATOR INFORMING HIM AND */ 01046000
*   /* ASKING HIM TO RESPECIFY CSA AGAIN.                            */ 01047000
*   /*                                                               */ 01048000
*   /*****************************************************************/ 01049000
*                                                                  0383 01050000
*   RWRK1=(NVTLVIRT-NVTVVPG1)/NP81K;                               0383 01051000
         L     @00,NVTLVIRT(,RNVT)                                 0383 01052000
         SL    @00,NVTVVPG1(,RNVT)                                 0383 01053000
         SRDA  @00,32                                              0383 01054000
         D     @00,@CF00111                                        0383 01055000
         LR    RWRK1,@01                                           0383 01056000
*   GENERATE SETS(MSG6A) REFS(RWRK1,DWRD);                         0384 01057000
         CVD    6,DWRD              CONVERT TO DECIMAL FROM BINARY      01058000
         UNPK   MSG6A(7),DWRD+4(4) UNPACK FOR ZONE EBCDIC               01059000
         OI     MSG6A+6,X'F0'       CORRECT LAST ZONE NUMBER            01060000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDR           */ 01061000
         LA    RLIST,NP8PLST1                                      0385 01062000
*   MSG6B='VIRTUAL';                /* VIRTUAL TYPE OF STORAGE       */ 01063000
         MVC   MSG6B(7),@CC01908                                   0386 01064000
*   MSG6C='CSA ';                                                  0387 01065000
*                                                                  0387 01066000
         MVC   MSG6C(4),@CC01951                                   0387 01067000
*   /*****************************************************************/ 01068000
*   /*                                                               */ 01069000
*   /* ISSUE MESSAGE ONLY XXXK OF VIRTUAL STORAGE AVAILABLE -        */ 01070000
*   /* RESPECIFY OR CANCEL                                           */ 01071000
*   /*                                                               */ 01072000
*   /*****************************************************************/ 01073000
*                                                                  0388 01074000
*   RSCAN=ADDR(NP8RMSG1);           /* SET RSCAN TO REPLY            */ 01075000
         LA    RSCAN,NP8RMSG1                                      0388 01076000
*   NWTORMSG=ADDR(MSG6);            /* SET MSG ADDR IN PLIST         */ 01077000
*                                                                  0389 01078000
         LA    @07,MSG6                                            0389 01079000
         ST    @07,NWTORMSG(,RLIST)                                0389 01080000
*   /*****************************************************************/ 01081000
*   /*                                                               */ 01082000
*   /* ISSUE MESSAGE VIA NIPWTOR                                     */ 01083000
*   /*                                                               */ 01084000
*   /*****************************************************************/ 01085000
*                                                                  0390 01086000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   01087000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0390 01088000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             01089000
*   GOTO NP8CSNEW;                  /* SYNTAX CHECK NEW PARM         */ 01090000
         B     NP8CSNEW                                            0391 01091000
*   RFY                                                            0392 01092000
*     RLIST UNRSTD;                                                0392 01093000
*   RFY                                                            0393 01094000
*     RSCAN UNRSTD;                                                0393 01095000
*   END NP8COLAP;                                                  0394 01096000
*   RFY                                                            0395 01097000
*    (RLIST,                                                       0395 01098000
*     RSCAN) RSTD;                                                 0395 01099000
*                                                                  0395 01100000
*   /*****************************************************************/ 01101000
*   /*                                                               */ 01102000
*   /* ENTERED WHENEVER AN INVALID CSA PARAMETER HAS BEEN            */ 01103000
*   /* ENCOUNTERED. THE MESSAGE 'INVALID CSA PARM - RESPECIFY OR     */ 01104000
*   /* CANCEL ' IS ISSUED. IF REPLY IS EOB, DEFAULT IS SUPPLIED      */ 01105000
*   /* (100K). IF NOT, REPLY IS ANALYZED AGAIN.                      */ 01106000
*   /*                                                               */ 01107000
*   /*****************************************************************/ 01108000
*                                                                  0396 01109000
*NP8CSINV:                                                         0396 01110000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDRESS        */ 01111000
NP8CSINV LA    RLIST,NP8PLST1                                      0396 01112000
*   RSCAN=ADDR(NP8RMSG1);           /* SET SCAN POINTER TO REPLY     */ 01113000
         LA    RSCAN,NP8RMSG1                                      0397 01114000
*   MSG1A='CSA   ';                 /* SET PARM TO 'CSA'             */ 01115000
         MVC   MSG1A(6),@CC01954                                   0398 01116000
*   NWTORMSG=ADDR(MSG1);            /* SET MSG ADDR IN PARM LIST     */ 01117000
*                                                                  0399 01118000
         LA    @07,MSG1                                            0399 01119000
         ST    @07,NWTORMSG(,RLIST)                                0399 01120000
*   /*****************************************************************/ 01121000
*   /*                                                               */ 01122000
*   /* ISSUE MESSAGE: 'INVALID CSA PARM - - RESPECIFY OR CANCEL'     */ 01123000
*   /*                                                               */ 01124000
*   /*****************************************************************/ 01125000
*                                                                  0400 01126000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   01127000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0400 01128000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             01129000
*   RFY                                                            0401 01130000
*     RLIST UNRSTD;                                                0401 01131000
*                                                                  0401 01132000
*   /*****************************************************************/ 01133000
*   /*                                                               */ 01134000
*   /* ANALYZE REPLY. IF EOB, SUPPLY DEFAULT SIZE OF 100K AND        */ 01135000
*   /* CONTINUE. OTHERWISE SYNTAX CHECK NEW REPLY PARM.              */ 01136000
*   /*                                                               */ 01137000
*   /*****************************************************************/ 01138000
*                                                                  0402 01139000
*NP8CSNEW:                                                         0402 01140000
*   IF S2CHAR=' '''                 /* REPLY = EOB ?                 */ 01141000
*     THEN                                                         0402 01142000
NP8CSNEW CLC   S2CHAR(2,RSCAN),@CC01931                            0402 01143000
         BNE   @RF00402                                            0402 01144000
*     DO;                                                          0403 01145000
*       VALUE=CSADFLT;              /* SUPPLY DEFAULT PARAMETER      */ 01146000
         MVC   VALUE(4),@CF00123                                   0404 01147000
*       GOTO NP8CSAOK;              /* CONTINUE PROCESSING PARM      */ 01148000
         B     NP8CSAOK                                            0405 01149000
*     END;                                                         0406 01150000
*                                                                  0406 01151000
*   /*****************************************************************/ 01152000
*   /*                                                               */ 01153000
*   /* THE OPERATOR MUST REPLY WITH 'CSA=' AS FIRST 4 CHAR. IF HE    */ 01154000
*   /* DOES, CONTINUE TO SYNTAX CHECK PARM. OTHERWISE, REISSUE       */ 01155000
*   /* MESSAGE FOR HIM TO REPLY, IE.GIVE HIM ANOTHER CHANCE.         */ 01156000
*   /*                                                               */ 01157000
*   /*****************************************************************/ 01158000
*                                                                  0407 01159000
*   IF S4CHAR¬='CSA='               /* KEYWORD = 'CSA=' ?            */ 01160000
*     THEN                                                         0407 01161000
@RF00402 CLC   S4CHAR(4,RSCAN),@CC01956                            0407 01162000
         BNE   @RT00407                                            0407 01163000
*     GOTO NP8CSINV;                /* ISSUE INVALID PARM MESSAGE    */ 01164000
*   RSCAN=RSCAN+LENGTH('CSA=');     /* POINT PAST KEYWORD            */ 01165000
         LA    @09,4                                               0409 01166000
         ALR   RSCAN,@09                                           0409 01167000
*   PCT=MAXCSA;                     /* MAXCSA DIGITS ALLOWED =4      */ 01168000
         LR    PCT,@09                                             0410 01169000
*   CALL NP8VNUM;                   /* CALL SYNTAX ROUTINE           */ 01170000
         BAL   @14,NP8VNUM                                         0411 01171000
*   IF RCODE=0                      /* R.C. = 0, THEN SYNTAX OK      */ 01172000
*     THEN                                                         0412 01173000
         LTR   RCODE,RCODE                                         0412 01174000
         BZ    @RT00412                                            0412 01175000
*     GO TO NP8CSAOK;               /* GOTO GOOD CSA                 */ 01176000
*   ELSE                                                           0414 01177000
*     GO TO NP8CSINV;               /* GO TO INVALID CSA             */ 01178000
         B     NP8CSINV                                            0414 01179000
*   RFY                                                            0415 01180000
*     RSCAN UNRSTD;                                                0415 01181000
*IEAVNPC8:                                                         0416 01182000
*   ENTRY;                                                         0416 01183000
*                                                                  0416 01184000
@EP00416 DS    0H                                                  0417 01185000
*   /*****************************************************************/ 01186000
*   /*                                                               */ 01187000
*   /* THE REAL AND VRREGN PARMS WILL BE ANALYZED IN THIS ROUTINE.   */ 01188000
*   /* THE REAL PARM IS A 4 OR LESS DIGIT NUMBER SPECIFYING THE SIZE */ 01189000
*   /* OF THE V=R REGION IN 1K BLOCKS. THE LOW ADDR IS ON A SEGMENT  */ 01190000
*   /* BOUNDARY. THE HIGH ADDRESS IS ROUNDED TO A PAGE BDRY. THE     */ 01191000
*   /* VRREGN PARM IS A 4 OR LESS DIGIT NUMBER SPECIFYING THE DEFAULT*/ 01192000
*   /* V=R REGION SIZE SUPPLIED TO JOBS RUNNING IN THE V=R REGION    */ 01193000
*   /* WITH NO SIZE PARM SPECIFIED. IF VRREGN=0, THEN NO JOB WITHOUT */ 01194000
*   /* A SIZE PARM WILL BE ALLOWED TO EXECUTE. THIS DEFAULT VALUE IS */ 01195000
*   /* STORED IN THE GDA. THE PQE AND FBQE IN GDA ARE SET UP FOR THE */ 01196000
*   /* V=R REGION AND THE PAGE FIX TABLE IS INITIALIZED. THE SYSTEM  */ 01197000
*   /* DEFAULT FOR REAL PARM IS 76K.                                 */ 01198000
*   /*                                                               */ 01199000
*   /*****************************************************************/ 01200000
*                                                                  0417 01201000
*   RFY                                                            0417 01202000
*     RSCAN RSTD;                                                  0417 01203000
*   GDAPTR=CVTGDA;                                                 0418 01204000
         L     GDAPTR,CVTGDA(,CVTPTR)                              0418 01205000
*   RPTAB=NVTPTAB;                  /* GET PARM TABLE ADDR           */ 01206000
         L     RPTAB,NVTPTAB(,RNVT)                                0419 01207000
*   RSCAN=VRREGN;                   /* LOAD PARAMETER ADDRESS        */ 01208000
*                                                                  0420 01209000
         L     RSCAN,VRREGN(,RPTAB)                                0420 01210000
*   /*****************************************************************/ 01211000
*   /*                                                               */ 01212000
*   /* IF RSCAN = 0 THEN SUPPLY SYSTEM DEFAULT VALUE OF 64K.         */ 01213000
*   /* OTHERWISE, SYNTAX CHECK USER SUPPLIED PARAMETER.              */ 01214000
*   /*                                                               */ 01215000
*   /*****************************************************************/ 01216000
*                                                                  0421 01217000
*   IF RSCAN=0 THEN                                                0421 01218000
         LTR   RSCAN,RSCAN                                         0421 01219000
         BNZ   @RF00421                                            0421 01220000
*     DO;                                                          0422 01221000
*       VALUE=VRDFLT;               /* SUPPLY DEFAULT OF 64 K        */ 01222000
         MVC   VALUE(4),@CF00125                                   0423 01223000
*       GOTO NP8VROK;               /* CONTINUE PROCESSING VRREGN    */ 01224000
         B     NP8VROK                                             0424 01225000
*     END;                                                         0425 01226000
*   PCT=MAXREAL;                    /* MAXIMUM NO. OF DIGITS ALLOWED */ 01227000
@RF00421 LA    PCT,4                                               0426 01228000
*   CALL NP8VNUM;                   /* SYNTAX CHECKER                */ 01229000
         BAL   @14,NP8VNUM                                         0427 01230000
*   IF RCODE=0                      /* R.C.= 0, THEN SYNTAX OK       */ 01231000
*     THEN                                                         0428 01232000
         LTR   RCODE,RCODE                                         0428 01233000
         BZ    @RT00428                                            0428 01234000
*     GO TO NP8VROK;                /* GO TO OK VR PROCESS           */ 01235000
*   ELSE                                                           0430 01236000
*     GO TO NP8VRINV;               /* GOTO INVALID VR PROCESS       */ 01237000
         B     NP8VRINV                                            0430 01238000
*NP8VROK:                                                          0431 01239000
*   VRDREG=VALUE*NP81K;             /* STORE PARM IN GDA. JOBS W/O 0431 01240000
*                                      REGION SIZE SPECIFIED AND   0431 01241000
*                                      REQUIRING REAL CORE WILL GET     01242000
*                                      THIS DEFAULT VALUE SIZE       */ 01243000
*                                                                  0431 01244000
NP8VROK  L     @09,VALUE                                           0431 01245000
         SLA   @09,10                                              0431 01246000
         ST    @09,VRDREG(,GDAPTR)                                 0431 01247000
*   /*****************************************************************/ 01248000
*   /*                                                               */ 01249000
*   /* NOW PROCESS THE REAL PARAMETER VALUE WHICH SPECIFIES THE SIZE */ 01250000
*   /* OF CORE FOR THE V=R REGION. IT HAS A LOW ADDRESS ON PAGE      */ 01251000
*   /* BOUNDARY AND A HIGH ADDRESS ON A PAGE (4K) BOUNDARY.          */ 01252000
*   /*                                                               */ 01253000
*   /*****************************************************************/ 01254000
*                                                                  0432 01255000
*   RSCAN=REAL;                     /* LOAD THE REAL PARM ADDRESS    */ 01256000
*                                                                  0432 01257000
         L     RSCAN,REAL(,RPTAB)                                  0432 01258000
*   /*****************************************************************/ 01259000
*   /*                                                               */ 01260000
*   /* IF NO PARM WAS SUPPLIED, VALUE DEFAULTS TO 76K REAL REGION.   */ 01261000
*   /* OTHERWISE, IF PARM WAS SUPPLIED, SYNTAX CHECK THE PARM FOR 4  */ 01262000
*   /* OR LESS DIGITS.                                               */ 01263000
*   /*                                                               */ 01264000
*   /*****************************************************************/ 01265000
*                                                                  0433 01266000
*   IF RSCAN=0 THEN                                                0433 01267000
         LTR   RSCAN,RSCAN                                         0433 01268000
         BNZ   @RF00433                                            0433 01269000
*     VALUE=RLDFLT;                 /* MINIMUM REAL REGION SIZE      */ 01270000
         MVC   VALUE(4),@CF00127                                   0434 01271000
*   ELSE                                                           0435 01272000
*     DO;                                                          0435 01273000
         B     @RC00433                                            0435 01274000
@RF00433 DS    0H                                                  0436 01275000
*       PCT=MAXREAL;                /* MAXIMUM NO. OF DIGITS ALLOWED */ 01276000
         LA    PCT,4                                               0436 01277000
*       CALL NP8VNUM;               /* SYNTAX CHECKER                */ 01278000
         BAL   @14,NP8VNUM                                         0437 01279000
*       IF RCODE=0                  /* IF R.C. = 0, THEN SYNTAX OK   */ 01280000
*         THEN                                                     0438 01281000
         LTR   RCODE,RCODE                                         0438 01282000
         BZ    @RT00438                                            0438 01283000
*         GO TO NP8RLOK;            /* GOTO REAL OK PARM             */ 01284000
*       ELSE                                                       0440 01285000
*         GO TO NP8RLINV;           /* GOTO INVALID REAL PARM        */ 01286000
         B     NP8RLINV                                            0440 01287000
*       RFY                                                        0441 01288000
*         RSCAN UNRSTD;                                            0441 01289000
*     END;                                                         0442 01290000
*                                                                  0442 01291000
*   /*****************************************************************/ 01292000
*   /*                                                               */ 01293000
*   /* ENTER THIS CODE IF THE PARM IS VALID                          */ 01294000
*   /*                                                               */ 01295000
*   /*****************************************************************/ 01296000
*                                                                  0443 01297000
*NP8RLOK:                                                          0443 01298000
*   VALUE=VALUE*NP81K;              /* CONVERT TO BYTES              */ 01299000
*                                                                  0443 01300000
@RC00433 DS    0H                                                  0443 01301000
NP8RLOK  L     @09,VALUE                                           0443 01302000
         SLA   @09,10                                              0443 01303000
         ST    @09,VALUE                                           0443 01304000
*   /*****************************************************************/ 01305000
*   /*                                                               */ 01306000
*   /* IF VALUE IS NOT A MULTIPLE OF 4K THEN ROUND UP. THIS IS NEEDED*/ 01307000
*   /* SO A REAL PAGE(4K) WILL NOT BE PARTLY REAL AND PARTLY VIRTUAL.*/ 01308000
*   /*                                                               */ 01309000
*   /*****************************************************************/ 01310000
*                                                                  0444 01311000
*   IF VALUE//NP84K¬=0              /* IS AREA SIZE A MULTIPLE OF 4K */ 01312000
*     THEN                                                         0444 01313000
         LR    @00,@09                                             0444 01314000
         SRDA  @00,32                                              0444 01315000
         D     @00,@CF00113                                        0444 01316000
         LTR   @00,@00                                             0444 01317000
         BZ    @RF00444                                            0444 01318000
*     VALUE=((VALUE/NP84K)*NP84K)+NP84K;                           0445 01319000
*                                                                  0445 01320000
         SRL   @09,12                                              0445 01321000
         SLA   @09,12                                              0445 01322000
         AL    @09,@CF00113                                        0445 01323000
         ST    @09,VALUE                                           0445 01324000
*   /*****************************************************************/ 01325000
*   /*                                                               */ 01326000
*   /* ADD IN THE SIZE OF RCT REGION                                 */ 01327000
*   /*                                                               */ 01328000
*   /*****************************************************************/ 01329000
*                                                                  0446 01330000
*   HIADDR=NVTVRREG+(4096*4)+VALUE;                                0446 01331000
*                                                                  0446 01332000
@RF00444 L     @09,VALUE                                           0446 01333000
         L     @15,NVTVRREG(,RNVT)                                 0446 01334000
         L     HIADDR,@CF01997                                     0446 01335000
         ALR   HIADDR,@15                                          0446 01336000
         ALR   HIADDR,@09                                          0446 01337000
*   /*****************************************************************/ 01338000
*   /*                                                               */ 01339000
*   /* IF REAL CORE AVAILABLE IS GREATER THEN OR EQUAL TO THE AMOUNT */ 01340000
*   /* SPECIFIED, THEN INIT. CVT AND PVT AREAS FOR REAL              */ 01341000
*   /*                                                               */ 01342000
*   /*****************************************************************/ 01343000
*                                                                  0447 01344000
*   IF NVTVRLNG=>(VALUE/NP84K)+4 THEN                              0447 01345000
         SRL   @09,12                                              0447 01346000
         AL    @09,@CF00059                                        0447 01347000
         C     @09,NVTVRLNG(,RNVT)                                 0447 01348000
         BH    @RF00447                                            0447 01349000
*     DO;                           /* CHECK FOR ENOUGH SPACE        */ 01350000
*                                                                  0448 01351000
*       /*************************************************************/ 01352000
*       /*                                                           */ 01353000
*       /* FOR RCT AND V=R REGION                                    */ 01354000
*       /*                                                           */ 01355000
*       /*************************************************************/ 01356000
*                                                                  0449 01357000
*       NVTREALR=HIADDR;            /* SET HIGH REAL ADDR IN CVT AND    01358000
*                                      INITIALIZE IN PVT THE LAST  0449 01359000
*                                      PAGE INDEX OF REAL REGN       */ 01360000
         ST    HIADDR,NVTREALR(,RNVT)                              0449 01361000
*       RFY                                                        0450 01362000
*         PVTPTR RSTD;                                             0450 01363000
*       RFY                                                        0451 01364000
*         PQESEPTR RSTD;                                           0451 01365000
*       PQESEPTR=CSAPQEP;           /* CSA PQE PTR FOR START OF CSA     01366000
*                                      RIGHT BELOW CSA AREA TOP LIMIT   01367000
*                                      FOR PRIVATE AREA IS           */ 01368000
         L     PQESEPTR,CSAPQEP(,GDAPTR)                           0452 01369000
*       PASIZE=PQEREGN-NVTVRREG;    /* SUBT TWO LIMITS FOR SIZE      */ 01370000
         L     @09,PQEREGN(,PQESEPTR)                              0453 01371000
         SLR   @09,@15                                             0453 01372000
         ST    @09,PASIZE(,GDAPTR)                                 0453 01373000
*       PASTRT=NVTVRREG;            /* START ADDR OF PRIVATE AREA    */ 01374000
         ST    @15,PASTRT(,GDAPTR)                                 0454 01375000
*       RFY                                                        0455 01376000
*         PQESEPTR UNRSTD;                                         0455 01377000
*       RFY                                                        0456 01378000
*         PVTPTR RSTD;                                             0456 01379000
*       PVTPTR=CVTPVTP;                                            0457 01380000
         L     PVTPTR,CVTPVTP(,CVTPTR)                             0457 01381000
*       PVTLPRIV=PASTRT/NP84K;      /* GET SSP OF PASTRT             */ 01382000
         SRL   @15,12                                              0458 01383000
         STH   @15,PVTLPRIV(,PVTPTR)                               0458 01384000
*       PVTLPRIV=PVTLPRIV*16;       /* PAD WITH ON BYTE ZERO         */ 01385000
         SLA   @15,4                                               0459 01386000
         STH   @15,PVTLPRIV(,PVTPTR)                               0459 01387000
*       RFY                                                        0460 01388000
*         PVTPTR UNRSTD;            /* ADDRESS OF PRIVATE AREA       */ 01389000
*     END;                                                         0461 01390000
*   ELSE                                                           0462 01391000
*     CALL NP8RSPC;                 /* RESPECIFY SIZE AND LOOK AT  0462 01392000
*                                      PARM AGAIN                    */ 01393000
         B     @RC00447                                            0462 01394000
@RF00447 BAL   @14,NP8RSPC                                         0462 01395000
*   CALL NP8REAL;                   /* DEFINE V=R SYSTEM CORE        */ 01396000
@RC00447 BAL   @14,NP8REAL                                         0463 01397000
*   RETURN;                                                        0464 01398000
         B     @EL00001                                            0464 01399000
*NP8RSPC:                                                          0465 01400000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0465 01401000
*                                                                  0465 01402000
NP8RSPC  DS    0H                                                  0466 01403000
*   /*****************************************************************/ 01404000
*   /*                                                               */ 01405000
*   /* THIS ROUTINE ENTERED WHEN REAL SPACE REQUESTED EXCEEDS        */ 01406000
*   /* AVAILABLE SPACE IN SYSTEM. A MESSAGE INFORMING THE OPERATOR OF*/ 01407000
*   /* THE AVAILABLE SPACE AMOUNT IS ISSUED IN ADDITION, HE IS       */ 01408000
*   /* REQUESTED TO RESPECIFY THE REAL PARM.                         */ 01409000
*   /*                                                               */ 01410000
*   /*****************************************************************/ 01411000
*                                                                  0466 01412000
*   IF NVTVRLNG>3 THEN                                             0466 01413000
         L     @09,NVTVRLNG(,RNVT)                                 0466 01414000
         C     @09,@CF00057                                        0466 01415000
         BNH   @RF00466                                            0466 01416000
*     RWRK1=(NVTVRLNG-4)*4;         /* NUMBER OF K OF REAL STORAGE 0467 01417000
*                                      AVAILABLE                     */ 01418000
         SL    @09,@CF00059                                        0467 01419000
         SLA   @09,2                                               0467 01420000
         LR    RWRK1,@09                                           0467 01421000
*   ELSE                                                           0468 01422000
*     RWRK1=0;                                                     0468 01423000
         B     @RC00466                                            0468 01424000
@RF00466 SLR   RWRK1,RWRK1                                         0468 01425000
*   GENERATE REFS(RWRK1,DWRD) SETS(MSG6A);                         0469 01426000
@RC00466 DS    0H                                                  0469 01427000
         CVD   6,DWRD                 CONVERT NUMBER TO DEC             01428000
         UNPK  MSG6A(7),DWRD+4(4)     UNPACK INTO MSG AREA              01429000
         OI    MSG6A+6,X'F0'          OR IN ZONE OF LAST NO             01430000
*   MSG6B='  REAL ';                                               0470 01431000
         MVC   MSG6B(7),@CC01972                                   0470 01432000
*   MSG6C='REAL';                                                  0471 01433000
         MVC   MSG6C(4),@CC01973                                   0471 01434000
*   RFY                                                            0472 01435000
*    (RLIST,                                                       0472 01436000
*     RSCAN) RSTD;                                                 0472 01437000
*   RLIST=ADDR(NP8PLST1);           /* ADDR OF PARM LIST FOR WTOR    */ 01438000
         LA    RLIST,NP8PLST1                                      0473 01439000
*   RSCAN=ADDR(NP8RMSG1);           /* SET RSCAN TO REPLY            */ 01440000
         LA    RSCAN,NP8RMSG1                                      0474 01441000
*   NWTORMSG=ADDR(MSG6);            /* SET MSG ADDR IN LIST          */ 01442000
*                                                                  0475 01443000
         LA    @07,MSG6                                            0475 01444000
         ST    @07,NWTORMSG(,RLIST)                                0475 01445000
*   /*****************************************************************/ 01446000
*   /*                                                               */ 01447000
*   /* ISSUE MESSAGE VIA NIPWTOR ONLY XXXK OF REAL STORAGE AVAILABLE */ 01448000
*   /* FOR REAL - RESPECIFY OR CANCEL                                */ 01449000
*   /*                                                               */ 01450000
*   /*****************************************************************/ 01451000
*                                                                  0476 01452000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   01453000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0476 01454000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             01455000
*   GOTO NP8RLNEW;                  /* SYNTAX CHECK NEW PARM         */ 01456000
         B     NP8RLNEW                                            0477 01457000
*   RFY                                                            0478 01458000
*     RLIST UNRSTD;                                                0478 01459000
*   RFY                                                            0479 01460000
*     RSCAN UNRSTD;                                                0479 01461000
*   END NP8RSPC;                                                   0480 01462000
*   RFY                                                            0481 01463000
*    (RLIST,                                                       0481 01464000
*     RSCAN) RSTD;                                                 0481 01465000
*                                                                  0481 01466000
*   /*****************************************************************/ 01467000
*   /*                                                               */ 01468000
*   /* ENTERED WHENEVER AN INVALID REAL PARAMETER HAS BEEN           */ 01469000
*   /* ENCOUNTERED. THE MESSAGE 'INVALID REAL PARM- RESPECIFY OR     */ 01470000
*   /* CANCEL' IS ISSUED. IF REPLY IS EOB, DEFAULT IS SUPPLIED (76K) */ 01471000
*   /* . IF NOT, REPLY IS ANALYZED AGAIN.                            */ 01472000
*   /*                                                               */ 01473000
*   /*****************************************************************/ 01474000
*                                                                  0482 01475000
*NP8RLINV:                                                         0482 01476000
*   ;                                                              0482 01477000
NP8RLINV DS    0H                                                  0483 01478000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDR           */ 01479000
         LA    RLIST,NP8PLST1                                      0483 01480000
*   RSCAN=ADDR(NP8RMSG1);           /* SET RSCAN TO REPLY            */ 01481000
         LA    RSCAN,NP8RMSG1                                      0484 01482000
*   MSG1A='REAL  ';                 /* PARM IN QUESTION              */ 01483000
         MVC   MSG1A(6),@CC01976                                   0485 01484000
*   NWTORMSG=ADDR(MSG1);            /* SET MSG ADDR IN PARM LIST     */ 01485000
*                                                                  0486 01486000
         LA    @07,MSG1                                            0486 01487000
         ST    @07,NWTORMSG(,RLIST)                                0486 01488000
*   /*****************************************************************/ 01489000
*   /*                                                               */ 01490000
*   /* ISSUE MESSAGE: 'INVALID REAL PARM - - RESPECIFY OR CANCEL '   */ 01491000
*   /*                                                               */ 01492000
*   /*****************************************************************/ 01493000
*                                                                  0487 01494000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   01495000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0487 01496000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             01497000
*   RFY                                                            0488 01498000
*     RLIST UNRSTD;                                                0488 01499000
*                                                                  0488 01500000
*   /*****************************************************************/ 01501000
*   /*                                                               */ 01502000
*   /* ANALYZE REPLY. IF EOB, SUPPLY DEFAULT SIZE OF 64K AND         */ 01503000
*   /* CONTINUE. OTHERWISE SYNTAX CHECK NEW REPLY PARM.              */ 01504000
*   /*                                                               */ 01505000
*   /*****************************************************************/ 01506000
*                                                                  0489 01507000
*NP8RLNEW:                                                         0489 01508000
*   IF S2CHAR=' '''                 /* REPLY = EOB ?                 */ 01509000
*     THEN                                                         0489 01510000
NP8RLNEW CLC   S2CHAR(2,RSCAN),@CC01931                            0489 01511000
         BNE   @RF00489                                            0489 01512000
*     DO;                                                          0490 01513000
*       VALUE=RLDFLT;               /* SUPPLY DEFAULT AND GO ON      */ 01514000
         MVC   VALUE(4),@CF00127                                   0491 01515000
*       GOTO NP8RLOK;               /* CONTINUE PROCESSING PARM      */ 01516000
         B     NP8RLOK                                             0492 01517000
*     END;                                                         0493 01518000
*   IF S5CHAR¬='REAL='              /* FIRST 5 CHARS='REAL=' ?       */ 01519000
*     THEN                                                         0494 01520000
@RF00489 CLC   S5CHAR(5,RSCAN),@CC01978                            0494 01521000
         BNE   @RT00494                                            0494 01522000
*     GOTO NP8RLINV;                /* MSG AND GO WTOR               */ 01523000
*   RSCAN=RSCAN+LENGTH('REAL=');    /* UPDATE RSCAN PTR TO PARM VALUE*/ 01524000
         AL    RSCAN,@CF00100                                      0496 01525000
*   PCT=MAXREAL;                    /* MAX ALLOWABLE DIGITS FOR REAL */ 01526000
         LA    PCT,4                                               0497 01527000
*   CALL NP8VNUM;                                                  0498 01528000
         BAL   @14,NP8VNUM                                         0498 01529000
*   IF RCODE=0                      /* IF R.C. = 0, THEN SYNTAX OK   */ 01530000
*     THEN                                                         0499 01531000
         LTR   RCODE,RCODE                                         0499 01532000
         BZ    @RT00499                                            0499 01533000
*     GO TO NP8RLOK;                /* GOTO VALID PARM               */ 01534000
*   ELSE                                                           0501 01535000
*     GO TO NP8RLINV;               /* GOTO INVALID PARM             */ 01536000
         B     NP8RLINV                                            0501 01537000
*   RFY                                                            0502 01538000
*     RSCAN UNRSTD;                                                0502 01539000
*NP8REAL:                                                          0503 01540000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0503 01541000
*                                                                  0503 01542000
NP8REAL  DS    0H                                                  0504 01543000
*   /*****************************************************************/ 01544000
*   /*                                                               */ 01545000
*   /* THE V=R PQE PTR IS FOUND IN GDA. IT POINTS TO THE PQE WHICH   */ 01546000
*   /* POINTS TO FBQE. BOTH OF THESE BLOCK ARE INIT. TO REFLECT NEW  */ 01547000
*   /* V=R AREA. EACH PAGE IS FIXED FOR THIS REGION BY SETTING THE   */ 01548000
*   /* PFTVR BIT IN THE PAGE FIX TABLE ENTRIES FOR EVERY PAGE IN V=R */ 01549000
*   /* REGION.                                                       */ 01550000
*   /*                                                               */ 01551000
*   /*****************************************************************/ 01552000
*                                                                  0504 01553000
*   RFY                                                            0504 01554000
*    (PQESEPTR,                                                    0504 01555000
*     FBQESPTR) RSTD;                                              0504 01556000
*   SAVEE=REXIT;                    /* SAVE RETURN ADDR              */ 01557000
         ST    REXIT,SAVEE                                         0505 01558000
*   NVTVRREG=NVTVRREG+(4096*4);     /* INCRE FOR RCT REGION IN     0506 01559000
*                                      ADDRESS SPACE                 */ 01560000
         L     @09,@CF01997                                        0506 01561000
         AL    @09,NVTVRREG(,RNVT)                                 0506 01562000
         ST    @09,NVTVRREG(,RNVT)                                 0506 01563000
*   PQESEPTR=VRPQEP;                /* V=R PQE POINTER               */ 01564000
         L     PQESEPTR,VRPQEP(,GDAPTR)                            0507 01565000
*   PQEREGN=NVTVRREG;               /* STARTING V=R ADDR             */ 01566000
         ST    @09,PQEREGN(,PQESEPTR)                              0508 01567000
*   PQESIZE=VALUE;                  /* SIZE OF V=R REGION            */ 01568000
         L     @06,VALUE                                           0509 01569000
         ST    @06,PQESIZE(,PQESEPTR)                              0509 01570000
*   VVVRFLG='1'B;                   /* INDICATES V=R REGION          */ 01571000
         OI    VVVRFLG(PQESEPTR),B'00000001'                       0510 01572000
*   FBQESPTR=PQEFFBQE;              /* ADDR OF FBQE                  */ 01573000
         L     FBQESPTR,PQEFFBQE(,PQESEPTR)                        0511 01574000
*   FWDPTR=PQESEPTR;                /* ADDR OF PQE, NO MORE FBQES    */ 01575000
         ST    PQESEPTR,FWDPTR(,FBQESPTR)                          0512 01576000
*   BCKPTR=PQESEPTR;                /* ADDR OF PQE, NO MORE FBQES    */ 01577000
         ST    PQESEPTR,BCKPTR(,FBQESPTR)                          0513 01578000
*   FBQAREA=NVTVRREG;               /* STARTING V=R ADDR             */ 01579000
         ST    @09,FBQAREA(,FBQESPTR)                              0514 01580000
*   SIZE=VALUE;                     /* SIZE OF FREE AREA IN BYTES    */ 01581000
         ST    @06,SIZE(,FBQESPTR)                                 0515 01582000
*   RFY                                                            0516 01583000
*    (PQESEPTR,                                                    0516 01584000
*     FBQESPTR) UNRSTD;                                            0516 01585000
*                                                                  0516 01586000
*   /*****************************************************************/ 01587000
*   /*                                                               */ 01588000
*   /* IF NO V = R REGION IS REQUESTED DO NOT INIT PVT AND PFTE      */ 01589000
*   /*                                                               */ 01590000
*   /*****************************************************************/ 01591000
*                                                                  0517 01592000
*   IF VALUE¬=0                     /* VALUE=0 MEANS NO V=R REGION   */ 01593000
*     THEN                                                         0517 01594000
         LTR   @06,@06                                             0517 01595000
         BZ    @RF00517                                            0517 01596000
*     DO;                                                          0518 01597000
*       RFY                                                        0519 01598000
*         PVTPTR RSTD;                                             0519 01599000
*       PVTPTR=CVTPVTP;             /* PVT ADDR                      */ 01600000
         L     PVTPTR,CVTPVTP(,CVTPTR)                             0520 01601000
*       PVTFVR=NVTVRREG/NP84K;      /* SHIFT RIGHT LOGICAL 3 HEX   0521 01602000
*                                      DIGITS, GET SSP VALUE FOR VBN */ 01603000
         LR    @05,@09                                             0521 01604000
         SRL   @05,12                                              0521 01605000
         STH   @05,PVTFVR(,PVTPTR)                                 0521 01606000
*       PVTFVR=PVTFVR*16;           /* PAD WITH 1 HEX ZERO ON RIGHT  */ 01607000
         SLA   @05,4                                               0522 01608000
         STH   @05,PVTFVR(,PVTPTR)                                 0522 01609000
*       PVTLVR=(NVTVRREG+(VALUE-NP84K))/NP84K;/* GET HIGH V=R VBN    */ 01610000
         L     @05,@CF00113                                        0523 01611000
         SLR   @06,@05                                             0523 01612000
         LR    @00,@09                                             0523 01613000
         ALR   @00,@06                                             0523 01614000
         SRDA  @00,32                                              0523 01615000
         DR    @00,@05                                             0523 01616000
         STH   @01,PVTLVR(,PVTPTR)                                 0523 01617000
*       PVTLVR=PVTLVR*16;           /* PAD WITH HEX 0 ON RIGHT       */ 01618000
         SLA   @01,4                                               0524 01619000
         STH   @01,PVTLVR(,PVTPTR)                                 0524 01620000
*     END;                                                         0525 01621000
*   ELSE                                                           0526 01622000
*     DO;                                                          0526 01623000
         B     @RC00517                                            0526 01624000
@RF00517 DS    0H                                                  0527 01625000
*       PVTPTR=CVTPVTP;                                            0527 01626000
         L     PVTPTR,CVTPVTP(,CVTPTR)                             0527 01627000
*       PVTFVR=0;                                                  0528 01628000
         SLR   @09,@09                                             0528 01629000
         STH   @09,PVTFVR(,PVTPTR)                                 0528 01630000
*       PVTLVR=0;                                                  0529 01631000
         STH   @09,PVTLVR(,PVTPTR)                                 0529 01632000
*     END;                                                         0530 01633000
*   REXIT=SAVEE;                    /* RESTORE RETURN ADDR           */ 01634000
@RC00517 L     REXIT,SAVEE                                         0531 01635000
*   END NP8REAL;                                                   0532 01636000
@EL00008 DS    0H                                                  0532 01637000
@EF00008 DS    0H                                                  0532 01638000
@ER00008 BR    @14                                                 0532 01639000
*   RFY                                                            0533 01640000
*     PVTPTR UNRSTD;                                               0533 01641000
*   RFY                                                            0534 01642000
*    (RLIST,                                                       0534 01643000
*     RSCAN) RSTD;                                                 0534 01644000
*                                                                  0534 01645000
*   /*****************************************************************/ 01646000
*   /*                                                               */ 01647000
*   /* ENTERED WHENEVER AN INVALID VRREGN PARAMETER HAS BEEN         */ 01648000
*   /* ENCOUNTERED. THE MESSAGE 'INVALID VRREGN PARM - RESPECIFY' IS */ 01649000
*   /* ISSUED. THEN REPLY IS ANALYZED AGAIN.                         */ 01650000
*   /*                                                               */ 01651000
*   /*****************************************************************/ 01652000
*                                                                  0535 01653000
*NP8VRINV:                                                         0535 01654000
*   ;                                                              0535 01655000
NP8VRINV DS    0H                                                  0536 01656000
*   MSG1A='VRREGN';                 /* PARM = VRRENG                 */ 01657000
         MVC   MSG1A(6),@CC01983                                   0536 01658000
*   RLIST=ADDR(NP8PLST1);           /* LOAD PARM LIST ADDRESS        */ 01659000
         LA    RLIST,NP8PLST1                                      0537 01660000
*   RSCAN=ADDR(NP8RMSG1);           /* SET SCAN POINTER TO REPLY     */ 01661000
         LA    RSCAN,NP8RMSG1                                      0538 01662000
*   NWTORMSG=ADDR(MSG1);            /* SET MSG ADDR IN PARM LIST     */ 01663000
         LA    @07,MSG1                                            0539 01664000
         ST    @07,NWTORMSG(,RLIST)                                0539 01665000
*   GEN REFS(NVTWTOR,RNVT,NP8PLST1) SETS(RPARM,REXIT,RENTRY,NP8RMSG1)   01666000
*       (IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1) ;                     0540 01667000
         IEAPMNIP  TYPE=WTOR,PARAM=NP8PLST1                             01668000
*   RFY                                                            0541 01669000
*     RLIST UNRSTD;                                                0541 01670000
*   IF S2CHAR=' '''                 /* REPLY = EOB ?                 */ 01671000
*     THEN                                                         0542 01672000
         CLC   S2CHAR(2,RSCAN),@CC01931                            0542 01673000
         BNE   @RF00542                                            0542 01674000
*     DO;                                                          0543 01675000
*       VALUE=VRDFLT;               /* SUPPLY DEFAULT OF 64          */ 01676000
         MVC   VALUE(4),@CF00125                                   0544 01677000
*       GOTO NP8VROK;               /* CONTINUE PROCESSING           */ 01678000
         B     NP8VROK                                             0545 01679000
*     END;                                                         0546 01680000
*                                                                  0546 01681000
*   /*****************************************************************/ 01682000
*   /*                                                               */ 01683000
*   /* OPERATOR MUST REPLAY WITH VRREGN=PARM                         */ 01684000
*   /*                                                               */ 01685000
*   /*****************************************************************/ 01686000
*                                                                  0547 01687000
*   IF S7CHAR¬='VRREGN='            /* KEYWORD = 'VRREGN' ?          */ 01688000
*     THEN                                                         0547 01689000
@RF00542 CLC   S7CHAR(7,RSCAN),@CC01984                            0547 01690000
         BNE   @RT00547                                            0547 01691000
*     GOTO NP8VRINV;                /* ISSUE INVALID PARM MSG AGAIN  */ 01692000
*   RSCAN=RSCAN+LENGTH('VRREGN=');  /* POINT PAST KEYWORD            */ 01693000
         AL    RSCAN,@CF00104                                      0549 01694000
*   PCT=MAXREAL;                    /* MAXIMUM ALLOWED DIGITS = 4    */ 01695000
         LA    PCT,4                                               0550 01696000
*   CALL NP8VNUM;                   /* SYNTAX CHECKER                */ 01697000
*                                                                  0551 01698000
         BAL   @14,NP8VNUM                                         0551 01699000
*   /*****************************************************************/ 01700000
*   /*                                                               */ 01701000
*   /* IF RETURN CODE = ZERO, THEN CONTINUE PROCESSING               */ 01702000
*   /*                                                               */ 01703000
*   /*****************************************************************/ 01704000
*                                                                  0552 01705000
*   IF RCODE=0 THEN                                                0552 01706000
         LTR   RCODE,RCODE                                         0552 01707000
         BZ    @RT00552                                            0552 01708000
*     GO TO NP8VROK;                /* CONTINUE PROCESSING           */ 01709000
*   ELSE                                                           0554 01710000
*     GO TO NP8VRINV;               /* GO TO ERROR PROCESSING        */ 01711000
         B     NP8VRINV                                            0554 01712000
*   RFY                                                            0555 01713000
*     RSCAN UNRSTD;                                                0555 01714000
*NP8VNUM:                                                          0556 01715000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0556 01716000
*                                                                  0556 01717000
NP8VNUM  DS    0H                                                  0557 01718000
*   /*****************************************************************/ 01719000
*   /*                                                               */ 01720000
*   /* INPUT RSCAN ADDRESS OF FIRST BYTE OF EBCDIC PARAMETER PCT     */ 01721000
*   /* MAXIMUM SIZE IN BYTES OF PARAMETER OUTPUT VALUE HEXADECIMAL   */ 01722000
*   /* VALUE OF EBCDIC PARAMETER RETURN CODES 0 PARAMETER ALL NUMERIC*/ 01723000
*   /* AND LENGTH DOES NOT EXCEED PCT SPECIFICATION 4 PARAMETER NOT  */ 01724000
*   /* ALL NUMERIC ORLENGTH EXCEEDS PCT SPECIFICATION NOTE: THE      */ 01725000
*   /* MAXIMUM VALUE FOR PCT IS 4                                    */ 01726000
*   /*                                                               */ 01727000
*   /*****************************************************************/ 01728000
*                                                                  0557 01729000
*   RFY                                                            0557 01730000
*    (RSCAN,                                                       0557 01731000
*     RPTAB) RSTD;                  /*                       @ZM40324*/ 01732000
*   SAVEE=REXIT;                    /* SAVE RESTURN ADDR             */ 01733000
         ST    REXIT,SAVEE                                         0558 01734000
*   M=PCT+1;                        /* END OF SCAN                   */ 01735000
         LA    @09,1                                               0559 01736000
         LR    M,PCT                                               0559 01737000
         ALR   M,@09                                               0559 01738000
*   DO N=1 TO M;                                                   0560 01739000
*                                                                  0560 01740000
         LR    N,@09                                               0560 01741000
         B     @DE00560                                            0560 01742000
@DL00560 DS    0H                                                  0561 01743000
*     /***************************************************************/ 01744000
*     /*                                                             */ 01745000
*     /* IF DELIMITER IS FOUND BEFORE PCT IS EXCEEDED THE PARAMETER  */ 01746000
*     /* LENGTH IS VALID                                             */ 01747000
*     /*                                                             */ 01748000
*     /***************************************************************/ 01749000
*                                                                  0561 01750000
*     IF SCAN(N)=''''               /* QUOTE VALID DELIMITER         */ 01751000
*       THEN                                                       0561 01752000
         LR    @09,RSCAN                                           0561 01753000
         ALR   @09,N                                               0561 01754000
         BCTR  @09,0                                               0561 01755000
         CLI   SCAN(@09),C''''                                     0561 01756000
         BE    @RT00561                                            0561 01757000
*       GOTO NPXVNUMB;                                             0562 01758000
*     IF SCAN(N)=' '                /* BLANK                         */ 01759000
*       THEN                                                       0563 01760000
         LR    @09,RSCAN                                           0563 01761000
         ALR   @09,N                                               0563 01762000
         BCTR  @09,0                                               0563 01763000
         CLI   SCAN(@09),C' '                                      0563 01764000
         BE    @RT00563                                            0563 01765000
*       GOTO NPXVNUMB;                                             0564 01766000
*     IF SCAN(N)=','                /* COMMA                         */ 01767000
*       THEN                                                       0565 01768000
         LR    @09,RSCAN                                           0565 01769000
         ALR   @09,N                                               0565 01770000
         BCTR  @09,0                                               0565 01771000
         CLI   SCAN(@09),C','                                      0565 01772000
         BE    @RT00565                                            0565 01773000
*       GOTO NPXVNUMB;                                             0566 01774000
*     IF SCAN(N)=')'                /* RIGHT PAREN                   */ 01775000
*       THEN                                                       0567 01776000
         LR    @09,RSCAN                                           0567 01777000
         ALR   @09,N                                               0567 01778000
         BCTR  @09,0                                               0567 01779000
         CLI   SCAN(@09),C')'                                      0567 01780000
         BE    @RT00567                                            0567 01781000
*       GOTO NPXVNUMB;                                             0568 01782000
*     IF SCAN(N)¬='(' THEN                                         0569 01783000
         LR    @09,RSCAN                                           0569 01784000
         ALR   @09,N                                               0569 01785000
         BCTR  @09,0                                               0569 01786000
         CLI   SCAN(@09),C'('                                      0569 01787000
         BE    @RF00569                                            0569 01788000
*       DO;                                                        0570 01789000
*                                                                  0570 01790000
*         /***********************************************************/ 01791000
*         /*                                                         */ 01792000
*         /* IF CHARACTER IS NEITHER A DELIMETER OR A NUMERIC IT IS  */ 01793000
*         /* INVALID                                                 */ 01794000
*         /*                                                         */ 01795000
*         /***********************************************************/ 01796000
*                                                                  0571 01797000
*         IF SCANZ(N)¬='1111'B THEN                                0571 01798000
         LR    @09,RSCAN                                           0571 01799000
         ALR   @09,N                                               0571 01800000
         BCTR  @09,0                                               0571 01801000
         TM    SCANZ(@09),B'11110000'                              0571 01802000
         BNO   @RT00571                                            0571 01803000
*           GOTO NPXVNINV;          /* NOT NUMERIC, SET RETURN CODE  */ 01804000
*       END;                                                       0573 01805000
*     ELSE                                                         0574 01806000
*       M=M+1;                      /* MAKE ALLOWANCE FOR EXTRA    0574 01807000
*                                      DELIMITER                     */ 01808000
         B     @RC00569                                            0574 01809000
@RF00569 LA    M,1(,M)                                             0574 01810000
*   END;                                                           0575 01811000
@RC00569 LA    N,1(,N)                                             0575 01812000
@DE00560 CR    N,M                                                 0575 01813000
         BNH   @DL00560                                            0575 01814000
*NPXVNINV:                          /* INVALID PARAMETER             */ 01815000
*   RCODE=4;                        /* ERROR CODE OF 4               */ 01816000
NPXVNINV LA    RCODE,4                                             0576 01817000
*   REXIT=SAVEE;                    /* RESTORE RETRUN ADDR           */ 01818000
         L     REXIT,SAVEE                                         0577 01819000
*   RETURN;                                                        0578 01820000
@EL00009 DS    0H                                                  0578 01821000
@EF00009 DS    0H                                                  0578 01822000
@ER00009 BR    @14                                                 0578 01823000
*NPXVNUMB:                          /* VALID PARAMETER               */ 01824000
*                                                                  0579 01825000
*   /*****************************************************************/ 01826000
*   /*                                                               */ 01827000
*   /* IF THE FIRST CHARACTER WAS A DELIMETER THEN THE PARAMETER IS  */ 01828000
*   /* INVALID                                                       */ 01829000
*   /*                                                               */ 01830000
*   /*****************************************************************/ 01831000
*                                                                  0579 01832000
*   IF N=1 THEN                                                    0579 01833000
NPXVNUMB C     N,@CF00062                                          0579 01834000
         BE    @RT00579                                            0579 01835000
*     GOTO NPXVNINV;                /* NO VALUE GIVEN = INVALID      */ 01836000
*                                                                  0580 01837000
*   /*****************************************************************/ 01838000
*   /*                                                               */ 01839000
*   /* IF LEFT PAREN. WAS FIRST CHARACTER DELIMITER, THEN SUBTRACT   */ 01840000
*   /* ONE FROM PARAMETER LENGTH FOR THAT CHARACTER. THAT IS THE ONLY*/ 01841000
*   /* ALLOWABLE FIRST CHARACTER DELIMITER.                          */ 01842000
*   /*                                                               */ 01843000
*   /*****************************************************************/ 01844000
*                                                                  0581 01845000
*   CONV=CONV&&CONV;                /* ZERO BUFFER FOR WORKING       */ 01846000
         XC    CONV(8),CONV                                        0581 01847000
*   IF SCAN(1)='(' THEN                                            0582 01848000
         CLI   SCAN(RSCAN),C'('                                    0582 01849000
         BNE   @RF00582                                            0582 01850000
*     DO;                                                          0583 01851000
*       N=N-2;                      /* COUNT 2 DELIMITERS            */ 01852000
         BCTR  N,0                                                 0584 01853000
         BCTR  N,0                                                 0584 01854000
*       I=5-N;                      /* SET UP CONVERSION AREA        */ 01855000
         LA    I,5                                                 0585 01856000
         SLR   I,N                                                 0585 01857000
*       CONV2(I:4)=SCAN4(2:N);                                     0586 01858000
         LA    @07,CONV2-1(I)                                      0586 01859000
         LA    @15,4                                               0586 01860000
         SLR   @15,I                                               0586 01861000
         EX    @15,@SM02001                                        0586 01862000
*     END;                                                         0587 01863000
*   ELSE                                                           0588 01864000
*     DO;                                                          0588 01865000
         B     @RC00582                                            0588 01866000
@RF00582 DS    0H                                                  0589 01867000
*       M=N-1;                      /* COUNT 1 DELIMITER             */ 01868000
         LR    M,N                                                 0589 01869000
         BCTR  M,0                                                 0589 01870000
*       I=5-M;                      /* SET UP CONVERSION AREA        */ 01871000
         LA    I,5                                                 0590 01872000
         SLR   I,M                                                 0590 01873000
*       CONV2(I:4)=SCAN4(1:M);                                     0591 01874000
         LA    @04,CONV2-1(I)                                      0591 01875000
         LA    @15,4                                               0591 01876000
         SLR   @15,I                                               0591 01877000
         EX    @15,@SM02003                                        0591 01878000
*     END;                          /* CONVERT PARM FROM EBCDIC TO 0592 01879000
*                                      BINARY                        */ 01880000
*   GENERATE REFS(CONV2) SETS(CONV2,RWRK1);                        0593 01881000
@RC00582 DS    0H                                                  0593 01882000
         PACK   CONV2(4),CONV2(4)     PACK PARM                         01883000
         CVB    RWRK1,CONV1           CONVERT TO BINARY                 01884000
*   VALUE=RWRK1;                    /* HEX VALUE OF PARM             */ 01885000
         ST    RWRK1,VALUE                                         0594 01886000
*   RCODE=0;                        /* VALID PARM, R.C. = 0          */ 01887000
         SLR   RCODE,RCODE                                         0595 01888000
*   REXIT=SAVEE;                    /* RESTORE RETURN ADDR           */ 01889000
         L     REXIT,SAVEE                                         0596 01890000
*   RFY                                                            0597 01891000
*    (RSCAN,                                                       0597 01892000
*     RPTAB) UNRSTD;                /*                       @ZM40324*/ 01893000
*   END NP8VNUM;                                                   0598 01894000
         B     @EL00009                                            0598 01895000
*   END IEAVNP08;                                                  0599 01896000
*                                                                  0599 01897000
*/*IEAVNP08: CHART                                                   */ 01898000
*/* HEADER                                                         0600 01899000
*/*                                                                0600 01900000
*/*                                                                0600 01901000
*/* VSM INITIALIZATION ROUTINE:  IEAVNP08                            */ 01902000
*/* IEAVNP08: E ENTRY                                                */ 01903000
*/* IEAVNPA8: E ENTRY FOR SQA PROCESSING                             */ 01904000
*/* M SET MODULE ADDR'TY                                             */ 01905000
*/* P SAVE INPUT REGISTERS                                           */ 01906000
*/* P GET SQA PARM ADDRESS                                           */ 01907000
*/* D (YES,,NO,NP8SQALP) PARM ADDR = 0?                              */ 01908000
*/* D (NO,,YES,%L1) QUICKSTART SPECIFIED?                            */ 01909000
*/* M (,NP8SQOK)  SET VALUE=1                                        */ 01910000
*/*%L1: M (,NP8SQOK) SET VALUE = PREVIOUS SQA SIZE                   */ 01911000
*/*NP8SQALP: M SET MAX NO. OF PARM DIGITS                            */ 01912000
*/* L NP8VNUM SYNTAX CHECKER                                         */ 01913000
*/* D (=0,,=4,NP8SQINV) RCODE=0?                                     */ 01914000
*/*NP8SQOK: N VALUE NOW CONTAINS VALID SYNTAX NUMBER                 */ 01915000
*/* P CALCULATE SIZE OF SQA                                          */ 01916000
*/* P CALCULATE LOW SQA ADDRESS                                      */ 01917000
*/* D (YES,,NO,NP8SQAEX) IS SQA WITHIN V=V REGION?                   */ 01918000
*/*NP8SQUIK: N SQA REGION IS WITHIN ITS LIMITS                       */ 01919000
*/* D (YES,NP8SQACS,NO,) DID OPERATOR SPECIFY QUCKSTRT ?             */ 01920000
*/*NP8SQACH: D (YES,NP8NSQAP,NO,) IS VALUE=0?                        */ 01921000
*/* P UPDATE TOTAL SQA SPACE IN GDA                                  */ 01922000
*/* L BUILDPG                                                        */ 01923000
*/*%L20: L NP8SQBLK                                                  */ 01924000
*/* P UPDATE NVTLVIRT WITH SQA LOW ADDR                              */ 01925000
*/*NP8NSQAP: R RETURN                                                */ 01926000
*/*BUILDPG: E SUBROUTINE TO GET PAGE TABLES                          */ 01927000
*/* D (YES,,NO,%BU1) SQA REQUEST ?                                   */ 01928000
*/* P (,%BU2) GETMAIN LENGTH = PGTES LENGTH                          */ 01929000
*/*%BU1: P GM LENGTH = PGTES + XPTES LENGTH                          */ 01930000
*/*%BU2: P GMLENGTH = GMLENGTH + 72 SAVE AREA BYTES                  */ 01931000
*/* S GETMAIN: GET PAGE TABLES AREA                                  */ 01932000
*/* D (YES,,NO,%BU3) SQA REQUEST ?                                   */ 01933000
*/* P SET BIT FOR NO XPTE                                            */ 01934000
*/*%BU3: S CREATE: INIT SEGMENTS                                     */ 01935000
*/* D (YES,%BU4,NO,) CREATE SUCCESSFUL ?                             */ 01936000
*/* S WAIT STATE X'03D'                                              */ 01937000
*/*%BU4: R RETURN                                                    */ 01938000
*/*NP8SQAEX: N ISSUES MSG 'ONLY XX OF VIRTUAL SPACE AVAILABLE -    0600 01939000
*/*RESPECIFY'                                                        */ 01940000
*/* P CONVERT AVAILABLE AREA SIZE INTO EBCDIC                        */ 01941000
*/* M SET UP WTOR PARAMETERS                                         */ 01942000
*/* L (,NP8SQNEW) WTOR THRU IEAPMNIP                                 */ 01943000
*/*NP8SQACS: E SUBROUTINE                                            */ 01944000
*/*  N ENTERED TO COMPARE PREVIOUS SQA SIZE WITH REQUESTED ONE       */ 01945000
*/* D (YES,%L2,NO,) NEW SQA SIZE = PREVIOUS ONE?                     */ 01946000
*/* L WTO THRU IEAPMNIP                                              */ 01947000
*/* N 'QUICKSTART REQUIRES PREVIOUS IPL SQA SIZE-'                   */ 01948000
*/* N 'PREVIOUS SIZE USED'                                           */ 01949000
*/* P CALCULATE PREVIOUS SQA SIZE                                    */ 01950000
*/* P CALCULATE PREVIOUS LOW SQA ADDR                                */ 01951000
*/*%L2: R RETURN                                                     */ 01952000
*/*NP8SQBLK: E ENTRY                                                 */ 01953000
*/* P UPDATE SQA DQE                                                 */ 01954000
*/* P UPDATE SQA FQE                                                 */ 01955000
*/* R RETURN                                                         */ 01956000
*/*NP8SQINV: N INVALID SQA PARM ROUTINE                              */ 01957000
*/* P SET UP MESSAGE                                                 */ 01958000
*/* L WTOR THRU IEAPMNIP                                             */ 01959000
*/*NP8SQNEW: N ANALYZE OPERATOR'S REPLY                              */ 01960000
*/* D (YES,%L3,NO,) REPLY=EOB?                                       */ 01961000
*/* D (YES,,NO,%L4) 1ST 4 CHAR OF REPLY = 'SQA='?                    */ 01962000
*/* L NP8VNUM SYSTAX CHECKER                                         */ 01963000
*/* D (YES,NP8SQOK,NO,NP8SQINV) VALID SYNTAX?                        */ 01964000
*/*%L3: M (,NP8SQOK) VALUE+ DEFAULT OF 1                             */ 01965000
*/*%L4: M (,NP8SQINV) PUT INVALID CHARACTERS IN WTOR MSG             */ 01966000
*/*IEAVNPB8: E ENTRY FOR CSA PROCESSING                              */ 01967000
*/* M SET MODULE ADDITY                                              */ 01968000
*/* P SAVE INPUT REGISTERS                                           */ 01969000
*/* P GET SQA PARM ADDRESS                                           */ 01970000
*/* D (YES,,NO,%L5) CSA PARM ADDR = 0?                               */ 01971000
*/* M (,NP8CSAOK) VALUE=100 DEFAULT                                  */ 01972000
*/*%L5: L NP8VNUM SYNTAX CHECKER                                     */ 01973000
*/* D (YES,NP8CSAOK,NO,NP8CSINV) VALID SYNTAX?                       */ 01974000
*/*NP8CSAOK: N CSA MUST BEGIN ON A SEGMENT BOUNDARY AND END ON A PAGE.  01975000
*/*                                                                  */ 01976000
*/* D (YES,,NO,%L6) HIGH ADDR ON PAGE BOUNDARY?                      */ 01977000
*/* P (,%L7) GET HIGH CSA ADDRESS                                    */ 01978000
*/*%L6: P ROUND CSA HIGH ADDRESS TO PAGE BOUNDARY                    */ 01979000
*/*%L7: P CALCULATE LOW ADDR FOR CSA                                 */ 01980000
*/* D (YES,%L8,NO,) LOW ADDR ON SEGMENT BOUNDARY?                    */ 01981000
*/* P ROUND LOW ADDR TO SEGMENT BOUNDARY                             */ 01982000
*/*%L8: D (NO,,YES,%L21) CSA WITHIN V=V AREA BOUNDS?                 */ 01983000
*/* L (,NP8CSNEW) NP8COLAP                                           */ 01984000
*/*%L21: L BUILDPG                                                   */ 01985000
*/* L NP8CSBLK                                                       */ 01986000
*/* P PUT PRIVATE AREA ADDRESS IN NVT,CVT AND PVT                    */ 01987000
*/* R RETURN                                                         */ 01988000
*/*NP8CSBLK: E SUBROUTINE TO INIT CSA PQE AND FBQE                   */ 01989000
*/* P UPDATE CSA PQE                                                 */ 01990000
*/* P UPDATE AVAILABLE SQA AREA SIZE IN GDA WITH SIZE OF CSA         */ 01991000
*/* P UPDATE CSA FBQE                                                */ 01992000
*/* R RETURN                                                         */ 01993000
*/*NP8COLAP: E SUBROUTINE                                            */ 01994000
*/* N INFORM OPERATOR THAT SPECIFIED CSA PARM WAS TOO LARGE          */ 01995000
*/* P SET UP WTOR MESSAGE                                            */ 01996000
*/* N 'ONLY XK OF VIRTUAL STORAGE AVAILABLE -RESPECIFY OR CANCEL'    */ 01997000
*/* L (,NP8CSNEW) WTOR THRU IEAPMNIP                                 */ 01998000
*/*NP8CSINV: N INVALID CSA PARAMETER ROUTINE.                        */ 01999000
*/* P SET UP WTOR MESSAGE                                            */ 02000000
*/* L WTOR THRU IEAPMNIP                                             */ 02001000
*/*NP8CSNEW: D (YES,,NO,%L10) REPLY=EOB?                             */ 02002000
*/* M (,NP8CSAOK) VALUE = DEFAULT OF 100K                            */ 02003000
*/*%L10: D (NO,NP8CSINV,YES,) 1ST 4 CHARS OF REPLY = 'CSA='          */ 02004000
*/* L NP8VNUM SYNTAX CHECKER                                         */ 02005000
*/* D (YES,NP8CSAOK,A0,NP8CSINV) VALID SYNTAX                        */ 02006000
*/*IEAVNPC8: E ENTRY                                                 */ 02007000
*/* M SET MODULE ADDR'TY                                             */ 02008000
*/* P SAVE INPUT REGISTERS                                           */ 02009000
*/* P GET VRREGN PARM ADDRESS                                        */ 02010000
*/* D (YES,,NO,%L12) VRREGN PARM ADDRESS = 0?                        */ 02011000
*/* M (,NP8VROK) VALUE = DEFAULT OF 64K                              */ 02012000
*/*%L12: L NP8VNUM SYNTAX CHECKER                                    */ 02013000
*/* D (YES,,NO,NP8VRINV) VALID SYNTAX?                               */ 02014000
*/*NP8VROK: P STORE PARM IN GDA                                      */ 02015000
*/* P GET REAL PARM ADDRESS                                          */ 02016000
*/* D (YES,,NO,%L14) REAL PARM ADDRESS = 0?                          */ 02017000
*/* M (,NP8RLOK) VALUE = DEFAULT OF 64K                              */ 02018000
*/*%L14: L NP8VNUM SYNTAX CHECKER                                    */ 02019000
*/* D (YES,NP8RLOK,NO,NP8RLINV) VALID SYNTAX?                        */ 02020000
*/*NP8RLOK: P CONVERT REAL VALUE TO BYTES                            */ 02021000
*/* N V=R REGION MUST BEGIN ON A PAGE BOUNDARY AND END ON A PAGE.    */ 02022000
*/* D (NO,,YES,%L16) IS HIGH ADDR ON PAGE BOUNDARY?                  */ 02023000
*/* P ROUND HIGH ADDRESS TO PAGE BOUNDARY                            */ 02024000
*/*%L16: D (YES,,NO,NP8RSPC) IS THERE ENOUGH AVAILABLE CORE?         */ 02025000
*/* P UPDATE HIGH REAL ADDR IN CVT                                   */ 02026000
*/* P CALCULATE PRIVATE AREA BEGIN AND END ADDRESS TO PUT IN GDA     */ 02027000
*/* P UPDATE LOW PRIVATE AREA VBN IN PVT                             */ 02028000
*/* L NP8REAL                                                        */ 02029000
*/* R RETURN                                                         */ 02030000
*/*NP8RSPC: E SUBROUTINE                                             */ 02031000
*/* N ROUTINE ENTERED WHEN REAL SPACE REQUESTED EXCEEDS AVAIL SPACE  */ 02032000
*/* P SET UP WTOR MESSAGE                                            */ 02033000
*/* N 'ONLY XK OF REAL STORAGE AVAIL FOR REAL- RESPECIFY OR CANCEL'  */ 02034000
*/* L (,NP8RLNEW) WTOR THRU IEAPMNIP                                 */ 02035000
*/*NP8RLINV: N INVALID REA PARAMETER ROUTINE                         */ 02036000
*/* P SET UP WTOR MSG                                                */ 02037000
*/* N 'INVALID  REA PARM -XXX- RESPECIFY OR CANCEL'                  */ 02038000
*/* L WTOR THRU IEAPMNIP                                             */ 02039000
*/*NP8RLNEW: D (YES,,NO,%L30) REPLY=EOB?                             */ 02040000
*/* M (,NP8RLOK) SET VALUE = DEFAULT OF 64K                          */ 02041000
*/*%L30: D (YES,,NO,NP8RLINV) 1ST 5 CHARS = 'REAL='?                 */ 02042000
*/* L NP8VNUM SYNTAX CHECKER                                         */ 02043000
*/* D (YES,NP8RLOK,NO,NP8RLINV) VALID SYNTAX?                        */ 02044000
*/*NP8REAL: E SUBROUTINE                                             */ 02045000
*/* N BUILD V=R REGION BY UPDATING CONTROL BLOCKS                    */ 02046000
*/* P UPDATE PQE FOR REAL REGION                                     */ 02047000
*/* P UPDATE FBQE                                                    */ 02048000
*/* P SET LOW AND HIGH RBN'S OF V=R IN PVT                           */ 02049000
*/* R RETURN                                                         */ 02050000
*/*NP8VRINV: N INVALID VRREGN PARAMETER ROUTINE                      */ 02051000
*/* P SET UP WTOR MESSAGE                                            */ 02052000
*/* N 'INVALID VRREGN PARM - RESPECIFY OR CANCEL'                    */ 02053000
*/* L WTOR THRU IEAPMNIP                                             */ 02054000
*/* D (YES,,NO,%L18) REPLY = EOB?                                    */ 02055000
*/* M (,NP8VROK) SET VALUE TO DEFAULT OF 64                          */ 02056000
*/*%L18: D (NO,NP8VRINV,YES,) 1ST 7 CHARS OF REPLY = 'VRREGN=' ?     */ 02057000
*/* L NP8VNUM SYNTAX CHECKER                                         */ 02058000
*/* D (YES,NP8VROK,NO,NP8VRINV) VALID SYNTAX?                        */ 02059000
*/*NP8VNUM: E SUBROUTINE SYNTAX CHECKER                              */ 02060000
*/* N CHECKER CAN ISSUE 2 RETURN CODES IN REG15: 0=VALID AND 4=INVALID  02061000
*/*                                                                  */ 02062000
*/*%L22: D (YES,NPXVNUMB,NO,) CHARACTER = QUOTE?                     */ 02063000
*/* D (YES,NPXVNUMB,NO,) CHARACTER = BLANK?                          */ 02064000
*/* D (YES,NPXVNUMB,NO,) CHARACTER = COMMA?                          */ 02065000
*/* D (YES,NPXVNUMB,NO,) CHARACTER = RIGHT PAREN ?                   */ 02066000
*/* D (YES,%L19,NO,NPXVNINV) ZONE OF CHARACTER  = '1111'B?           */ 02067000
*/*%L19: D (YES,NPXVNUMB,NO,%L22) ALL CHARACTERS CHECKED?            */ 02068000
*/*NPXVNINV: M RETURN CODE = 4 FOR INVALID SYNTAX                    */ 02069000
*/* R RETURN                                                         */ 02070000
*/*NPXVNUMB: D (YES,NPXVNINV,NO,) IS DELIMITER THE ONLY DIGIT?       */ 02071000
*/* P CONVERT PARAMETER VALUE TO BINARY                              */ 02072000
*/* M RETURN CODE = 0 FOR VALID SYNTAX                               */ 02073000
*/* R RETURN                                                         */ 02074000
@DATA    DS    0H                                                       02075000
@CH00120 DC    H'224'                                                   02076000
@SM02001 MVC   0(0,@07),SCAN4+1(RSCAN)                                  02077000
@SM02003 MVC   0(0,@04),SCAN4(RSCAN)                                    02078000
         DS    0F                                                       02079000
@SA00001 DS    18F                                                      02080000
         DS    0F                                                       02081000
@CF00062 DC    F'1'                                                     02082000
@CF00057 DC    F'3'                                                     02083000
@CF00059 DC    F'4'                                                     02084000
@CF00100 DC    F'5'                                                     02085000
@CF00104 DC    F'7'                                                     02086000
@CF00125 DC    F'64'                                                    02087000
@CF00127 DC    F'76'                                                    02088000
@CF00123 DC    F'100'                                                   02089000
@CF00111 DC    F'1024'                                                  02090000
@CF00113 DC    F'4096'                                                  02091000
@CF01997 DC    F'16384'                                                 02092000
@CF00109 DC    F'65536'                                                 02093000
         DS    0D                                                       02094000
EXTRA    DC    F'0'                                                     02095000
AREASZ   DS    A                                                        02096000
LOWADDR  DS    A                                                        02097000
VALUE    DS    A                                                        02098000
DALUE    DS    A                                                        02099000
SAVEE    DS    A                                                        02100000
AREA13   DC    F'0'                                                     02101000
SEGINDX  DS    F                                                        02102000
@CC01908 DC    C'VIRTUAL'                                               02103000
@CC01972 DC    C'  REAL '                                               02104000
@CC01984 DC    C'VRREGN='                                               02105000
@CC01930 DC    C'SQA   '                                                02106000
@CC01954 DC    C'CSA   '                                                02107000
@CC01976 DC    C'REAL  '                                                02108000
@CC01983 EQU   @CC01984                                                 02109000
@CC01978 DC    C'REAL='                                                 02110000
@CC01909 EQU   @CC01930                                                 02111000
@CC01933 DC    C'SQA='                                                  02112000
@CC01951 EQU   @CC01954                                                 02113000
@CC01956 DC    C'CSA='                                                  02114000
@CC01973 EQU   @CC01976                                                 02115000
@CC01931 DC    C' '''                                                   02116000
         DS    CL2                                                      02117000
CONV     DS    CL8                                                      02118000
         ORG   CONV                                                     02119000
CONV1    DS    CL4                                                      02120000
CONV2    DS    CL4                                                      02121000
         ORG   CONV+8                                                   02122000
NP8RMSG1 DC    CL80' '                                                  02123000
SQABIT   DC    B'00000000'                                              02124000
CSABIT   DC    B'00000000'                                              02125000
         DS    CL6                                                      02126000
NP8CVBAR DS    CL8                                                      02127000
         ORG   NP8CVBAR                                                 02128000
@NM00001 DC    F'0'                                                     02129000
NP8PCKAR DC    F'0'                                                     02130000
         ORG   NP8CVBAR+8                                               02131000
DWRD     DS    CL8                                                      02132000
IEAVNP08 CSECT                                                          02133000
MSG1    DS    0H                                                        02134000
        IEAPMNIP  TYPE=HEADER,MSGST=MSG1,MSGEND=MSG1END                 02135000
        DC    CL18'IEA906A RESPECIFY '                                  02136000
MSG1A   DC    CL6' '                (SQA,CSA,REAL,VRREGN)               02137000
        DC    CL18' PARM OR ENTER EOB'                                  02138000
MSG1END EQU   *                                                         02139000
MSG4    DS    0H                                                        02140000
        IEAPMNIP  TYPE=HEADER,MSGST=MSG4,MSGEND=MSG4END                 02141000
        DC    CL49'IEA907I UNABLE TO INITIALIZE PAGE AND/OR SEGMENT '   02142000
        DC    CL21'TABLES FOR SQA OR CSA'                               02143000
MSG4END EQU   *                                                         02144000
MSG3    DS    0H                                                        02145000
        IEAPMNIP  TYPE=HEADER,MSGST=MSG3,MSGEND=MSG3END                 02146000
        DC    CL50'IEA908I QUICKSTART REQUIRES PREVIOUS IPL SQA SIZE '  02147000
        DC    CL20'- PREVIOUS SIZE USED'                                02148000
MSG3END EQU   *                                                         02149000
MSG6    DS    0H                                                        02150000
        IEAPMNIP  TYPE=HEADER,MSGST=MSG6,MSGEND=MSG6END                 02151000
        DC    CL8'IEA909A '                                             02152000
        DC    CL5'ONLY '                                                02153000
MSG6A   DC    CL7'       '                                              02154000
        DC    CL5'K OF '                                                02155000
MSG6B   DC    CL7'       '   (REAL,VIRTUAL)                             02156000
        DC    CL23' STORAGE AVAILABLE FOR '                             02157000
MSG6C   DC    CL4'    '    (SQA,CSA,REAL)                               02158000
        DC    CL35' RESPECIFY OR ENTER EOB FOR DEFAULT'                 02159000
MSG6END EQU   *                                                         02160000
NP8PLST1 DS   0F                                                        02161000
        IEAPMNIP  TYPE=PLIST,RMSGST=NP8RMSG1,RMSGL=80,MSGST=0           02162000
IEAVNP08 CSECT                                                          02163000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02164000
@01      EQU   01                                                       02165000
@02      EQU   02                                                       02166000
@03      EQU   03                                                       02167000
@04      EQU   04                                                       02168000
@05      EQU   05                                                       02169000
@06      EQU   06                                                       02170000
@07      EQU   07                                                       02171000
@08      EQU   08                                                       02172000
@09      EQU   09                                                       02173000
@10      EQU   10                                                       02174000
@11      EQU   11                                                       02175000
@12      EQU   12                                                       02176000
@13      EQU   13                                                       02177000
@14      EQU   14                                                       02178000
@15      EQU   15                                                       02179000
HIADDR   EQU   @04                                                      02180000
GMSIZE   EQU   @04                                                      02181000
PCT      EQU   @04                                                      02182000
M        EQU   @07                                                      02183000
N        EQU   @04                                                      02184000
I        EQU   @09                                                      02185000
CVTPTR   EQU   @03                                                      02186000
RCODE    EQU   @15                                                      02187000
RPARM    EQU   @01                                                      02188000
SPQESPTR EQU   @05                                                      02189000
DQESEPTR EQU   @06                                                      02190000
FBQESPTR EQU   @07                                                      02191000
FQESEPTR EQU   @07                                                      02192000
PQESEPTR EQU   @05                                                      02193000
RPTAB    EQU   @05                                                      02194000
RSCAN    EQU   @06                                                      02195000
RWRK1    EQU   @06                                                      02196000
RLIST    EQU   @09                                                      02197000
GDAPTR   EQU   @08                                                      02198000
PVTPTR   EQU   @04                                                      02199000
REG0     EQU   @00                                                      02200000
REG1     EQU   @01                                                      02201000
REG9     EQU   @09                                                      02202000
REG13    EQU   @13                                                      02203000
RNVT     EQU   @02                                                      02204000
RCVT     EQU   @03                                                      02205000
REXIT    EQU   @14                                                      02206000
RENTRY   EQU   @15                                                      02207000
SCANPTR  EQU   @09                                                      02208000
PSA      EQU   0                                                        02209000
FLCRNPSW EQU   PSA                                                      02210000
FLCROPSW EQU   PSA+8                                                    02211000
FLCICCW2 EQU   PSA+16                                                   02212000
PSAEEPSW EQU   PSA+132                                                  02213000
PSAESPSW EQU   PSA+136                                                  02214000
FLCSVILC EQU   PSAESPSW+1                                               02215000
PSAEPPSW EQU   PSA+140                                                  02216000
FLCPIILC EQU   PSAEPPSW+1                                               02217000
FLCPICOD EQU   PSAEPPSW+2                                               02218000
PSAPICOD EQU   FLCPICOD+1                                               02219000
FLCTEA   EQU   PSAEPPSW+4                                               02220000
FLCPER   EQU   PSA+152                                                  02221000
FLCMCLA  EQU   PSA+168                                                  02222000
FLCIOEL  EQU   FLCMCLA+4                                                02223000
FLCIOA   EQU   FLCMCLA+16                                               02224000
FLCFSA   EQU   FLCMCLA+80                                               02225000
PSAAOLD  EQU   PSA+548                                                  02226000
PSASUPER EQU   PSA+552                                                  02227000
PSASUP1  EQU   PSASUPER                                                 02228000
PSASUP2  EQU   PSASUPER+1                                               02229000
PSASUP3  EQU   PSASUPER+2                                               02230000
PSASUP4  EQU   PSASUPER+3                                               02231000
PSACLHT  EQU   PSA+640                                                  02232000
PSALKSA  EQU   PSA+696                                                  02233000
PSAHLHI  EQU   PSA+760                                                  02234000
PSADSSFL EQU   PSA+836                                                  02235000
PSADSSF1 EQU   PSADSSFL                                                 02236000
PSADSSF3 EQU   PSADSSFL+2                                               02237000
PSADSSF4 EQU   PSADSSFL+3                                               02238000
PSARSVT  EQU   PSA+896                                                  02239000
SCAN     EQU   0                                                        02240000
SCANZ    EQU   SCAN                                                     02241000
SCAN4    EQU   0                                                        02242000
S2CHAR   EQU   0                                                        02243000
S4CHAR   EQU   0                                                        02244000
S5CHAR   EQU   0                                                        02245000
S7CHAR   EQU   0                                                        02246000
SPQESECT EQU   0                                                        02247000
SPQEAD   EQU   SPQESECT                                                 02248000
SPDQEPTR EQU   SPQESECT+4                                               02249000
SPDQEAD  EQU   SPDQEPTR                                                 02250000
SPQEFLGS EQU   SPQESECT+8                                               02251000
DQESECT  EQU   0                                                        02252000
DQFQEPTR EQU   DQESECT                                                  02253000
DQEBLKAD EQU   DQESECT+8                                                02254000
DQELNTH  EQU   DQESECT+12                                               02255000
FQESECT  EQU   0                                                        02256000
FQEPTR   EQU   FQESECT                                                  02257000
FQTYPE   EQU   FQEPTR                                                   02258000
FQELNTH  EQU   FQESECT+4                                                02259000
FBQESECT EQU   0                                                        02260000
FWDPTR   EQU   FBQESECT                                                 02261000
BCKPTR   EQU   FBQESECT+4                                               02262000
SIZE     EQU   FBQESECT+8                                               02263000
FBQAREA  EQU   FBQESECT+12                                              02264000
PQESECT  EQU   0                                                        02265000
PQEFFBQE EQU   PQESECT                                                  02266000
PQESIZE  EQU   PQESECT+20                                               02267000
PQEREGN  EQU   PQESECT+24                                               02268000
VMMFLGS  EQU   PQESECT+30                                               02269000
VVVRFLG  EQU   VMMFLGS                                                  02270000
PVT      EQU   0                                                        02271000
PVTFLAG1 EQU   PVT                                                      02272000
PVTFVR   EQU   PVT+20                                                   02273000
PVTLVR   EQU   PVT+22                                                   02274000
PVTLPRIV EQU   PVT+24                                                   02275000
PVTLCSA  EQU   PVT+26                                                   02276000
PVTPCSEG EQU   PVT+176                                                  02277000
PVTQS    EQU   PVT+304                                                  02278000
PVTWSAX  EQU   PVT+344                                                  02279000
CVTMAP   EQU   0                                                        02280000
CVTDAR   EQU   CVTMAP+72                                                02281000
CVTFLGS1 EQU   CVTDAR                                                   02282000
CVTDCB   EQU   CVTMAP+116                                               02283000
CVTIERLC EQU   CVTMAP+144                                               02284000
CVTOPTA  EQU   CVTMAP+182                                               02285000
CVTOPTB  EQU   CVTMAP+183                                               02286000
CVTGTF   EQU   CVTMAP+236                                               02287000
CVTGTFST EQU   CVTGTF                                                   02288000
CVTGTFS  EQU   CVTGTFST                                                 02289000
CVTSTATE EQU   CVTGTFST                                                 02290000
CVTTMODE EQU   CVTGTFST                                                 02291000
CVTFORM  EQU   CVTGTFST                                                 02292000
CVTAQAVT EQU   CVTMAP+240                                               02293000
CVTTCMFG EQU   CVTAQAVT                                                 02294000
CVTVOLM2 EQU   CVTMAP+244                                               02295000
CVTTATA  EQU   CVTVOLM2                                                 02296000
CVTTSKS  EQU   CVTTATA                                                  02297000
CVTVOLF2 EQU   CVTTSKS                                                  02298000
CVTTAT   EQU   CVTTATA+1                                                02299000
CVTATER  EQU   CVTMAP+248                                               02300000
CVTEXT1  EQU   CVTMAP+252                                               02301000
CVTPURG  EQU   CVTMAP+260                                               02302000
CVTQMSG  EQU   CVTMAP+268                                               02303000
CVTDMSR  EQU   CVTMAP+272                                               02304000
CVTRSV37 EQU   CVTDMSR                                                  02305000
CVTDMSRF EQU   CVTRSV37                                                 02306000
CVTERPV  EQU   CVTMAP+316                                               02307000
CVTINTLA EQU   CVTMAP+320                                               02308000
CVTAPF   EQU   CVTMAP+324                                               02309000
CVTEXT2  EQU   CVTMAP+328                                               02310000
CVTHJES  EQU   CVTMAP+332                                               02311000
CVTPGSIA EQU   CVTMAP+348                                               02312000
CVTA1F1  EQU   CVTMAP+356                                               02313000
CVTSYSK  EQU   CVTMAP+357                                               02314000
CVTVOLM1 EQU   CVTMAP+380                                               02315000
CVTVOLF1 EQU   CVTVOLM1                                                 02316000
CVTATMCT EQU   CVTMAP+388                                               02317000
CVTXTNT1 EQU   0                                                        02318000
CVTXTNT2 EQU   0                                                        02319000
CVTDSSV  EQU   CVTXTNT2                                                 02320000
CVTFLGBT EQU   CVTXTNT2+5                                               02321000
CVTQID   EQU   CVTXTNT2+24                                              02322000
CVTRV400 EQU   CVTXTNT2+52                                              02323000
CVTRV409 EQU   CVTXTNT2+53                                              02324000
CVTATCVT EQU   CVTXTNT2+64                                              02325000
CVTRV429 EQU   CVTXTNT2+84                                              02326000
CVTRV438 EQU   CVTXTNT2+85                                              02327000
CVTRV457 EQU   CVTXTNT2+112                                             02328000
CVTRV466 EQU   CVTXTNT2+113                                             02329000
CVTFIX   EQU   0                                                        02330000
CVTRELNO EQU   CVTFIX+252                                               02331000
NVT      EQU   0                                                        02332000
NVTNPATR EQU   NVT+54                                                   02333000
NVTNPREN EQU   NVTNPATR                                                 02334000
NVTFLLB  EQU   NVT+55                                                   02335000
NVTABSAV EQU   NVT+140                                                  02336000
NVTVVPG1 EQU   NVT+188                                                  02337000
NVTFLCN  EQU   NVT+211                                                  02338000
NVTWTPSW EQU   NVT+224                                                  02339000
NVTWPSW2 EQU   NVTWTPSW+4                                               02340000
NVTFLWSC EQU   NVTWPSW2+3                                               02341000
NVTLOAD  EQU   NVT+232                                                  02342000
NVTSENSE EQU   NVT+236                                                  02343000
NVTSWAIT EQU   NVT+240                                                  02344000
NVTTIME  EQU   NVT+244                                                  02345000
NVTUCBFN EQU   NVT+248                                                  02346000
NVTWTO   EQU   NVT+252                                                  02347000
NVTWTOR  EQU   NVT+256                                                  02348000
NVTWTOR2 EQU   NVT+260                                                  02349000
NVTOPEN  EQU   NVT+264                                                  02350000
NVTMOUNT EQU   NVT+268                                                  02351000
NVTVIRT  EQU   NVT+276                                                  02352000
NVTREAL  EQU   NVT+280                                                  02353000
NVTSCHED EQU   NVT+284                                                  02354000
NVTOPIO  EQU   NVT+288                                                  02355000
NVTPTAB  EQU   NVT+372                                                  02356000
NVTXCTL  EQU   NVT+428                                                  02357000
NVTLOCAT EQU   NVT+436                                                  02358000
NVTLPAND EQU   NVT+476                                                  02359000
NVTLVIRT EQU   NVT+484                                                  02360000
NVTVRREG EQU   NVT+488                                                  02361000
NVTVRLNG EQU   NVT+492                                                  02362000
NVTREALR EQU   NVT+508                                                  02363000
NVTFLPO  EQU   NVT+528                                                  02364000
NVTFLQS  EQU   NVTFLPO                                                  02365000
NWTOHDR  EQU   0                                                        02366000
NWTOFL   EQU   NWTOHDR+2                                                02367000
NWTORLST EQU   0                                                        02368000
NWTORFL  EQU   NWTORLST+10                                              02369000
NWTORMSG EQU   NWTORLST+12                                              02370000
NIPSPE   EQU   0                                                        02371000
NIPMNTPL EQU   0                                                        02372000
NMNTDS   EQU   NIPMNTPL                                                 02373000
NMNTVS   EQU   NIPMNTPL+12                                              02374000
NMNTFL   EQU   NIPMNTPL+20                                              02375000
NIPOPNPL EQU   0                                                        02376000
NOPNDS   EQU   NIPOPNPL                                                 02377000
NOPNFL   EQU   NIPOPNPL+20                                              02378000
NIPSCHDL EQU   0                                                        02379000
NIPPAHDR EQU   0                                                        02380000
NIPPAREA EQU   0                                                        02381000
NIPPABDL EQU   NIPPAREA+12                                              02382000
NIPPABDH EQU   NIPPABDL                                                 02383000
NIPPAIOD EQU   NIPPAREA+32                                              02384000
NIPPAECB EQU   NIPPAIOD+84                                              02385000
PARMTAB  EQU   0                                                        02386000
CSA      EQU   PARMTAB+72                                               02387000
REAL     EQU   PARMTAB+200                                              02388000
SQA      EQU   PARMTAB+216                                              02389000
VRREGN   EQU   PARMTAB+240                                              02390000
@NM00068 EQU   PARMTAB+272                                              02391000
NIPPAFLG EQU   @NM00068                                                 02392000
NIPPTE   EQU   0                                                        02393000
NIPPTOPF EQU   NIPPTE+4                                                 02394000
NIPPTATF EQU   NIPPTE+5                                                 02395000
GDA      EQU   0                                                        02396000
GVSMFLAG EQU   GDA                                                      02397000
GDAFLAGS EQU   GVSMFLAG                                                 02398000
VRDREG   EQU   GDA+4                                                    02399000
CSAPQEP  EQU   GDA+8                                                    02400000
VRPQEP   EQU   GDA+12                                                   02401000
PASTRT   EQU   GDA+16                                                   02402000
PASIZE   EQU   GDA+20                                                   02403000
SQASPQEP EQU   GDA+24                                                   02404000
SQASPLFT EQU   GDA+28                                                   02405000
VRPOSTQ  EQU   GDA+32                                                   02406000
VRWAITQ  EQU   GDA+40                                                   02407000
RSMHD    EQU   0                                                        02408000
RSMFLG1  EQU   RSMHD+12                                                 02409000
RSMQS    EQU   RSMHD+20                                                 02410000
RSMLFQ   EQU   RSMQS                                                    02411000
RSMLSQA  EQU   RSMQS+4                                                  02412000
RSMLIOQ  EQU   RSMQS+8                                                  02413000
ASCB     EQU   0                                                        02414000
ASCBSUPC EQU   ASCB+16                                                  02415000
ASCBRSM  EQU   ASCB+52                                                  02416000
ASCBFW1  EQU   ASCB+100                                                 02417000
ASCBRCTF EQU   ASCBFW1+2                                                02418000
ASCBFLG1 EQU   ASCBFW1+3                                                02419000
ASCBDSP1 EQU   ASCB+114                                                 02420000
ASCBFLG2 EQU   ASCB+115                                                 02421000
ASCBLKGP EQU   ASCB+128                                                 02422000
ASCBSRQ  EQU   ASCB+180                                                 02423000
ASCBSRQ1 EQU   ASCBSRQ                                                  02424000
ASCBSRQ2 EQU   ASCBSRQ+1                                                02425000
ASCBSRQ3 EQU   ASCBSRQ+2                                                02426000
ASCBSRQ4 EQU   ASCBSRQ+3                                                02427000
IEAVCSEG EQU   0                                                        02428000
SCHAR    EQU   0                                                        02429000
S3CHAR   EQU   0                                                        02430000
S6CHAR   EQU   0                                                        02431000
RSMHDPTR EQU   ASCBRSM                                                  02432000
ASCBPTR  EQU   PSAAOLD                                                  02433000
CVTS01   EQU   CVTPGSIA                                                 02434000
CVTPVTP  EQU   CVTS01+8                                                 02435000
CVTLPDIA EQU   CVTS01+12                                                02436000
CVTDIRST EQU   CVTLPDIA                                                 02437000
CVTSLIDA EQU   CVTS01+24                                                02438000
CVTCTLFG EQU   CVTS01+50                                                02439000
CVTSHRVM EQU   CVTS01+68                                                02440000
CVTGDA   EQU   CVTS01+212                                               02441000
CVTRV210 EQU   CVTS01+424                                               02442000
CVTRV219 EQU   CVTS01+425                                               02443000
CVTRV228 EQU   CVTS01+426                                               02444000
CVTRV237 EQU   CVTS01+427                                               02445000
CVTMFRTR EQU   CVTS01+452                                               02446000
CVTRV262 EQU   CVTS01+468                                               02447000
CVTRV271 EQU   CVTS01+469                                               02448000
CVTRV280 EQU   CVTS01+470                                               02449000
CVTRV289 EQU   CVTS01+471                                               02450000
CVTGSDA  EQU   CVTS01+600                                               02451000
PSARSVTE EQU   PSARSVT                                                  02452000
FLC      EQU   PSA                                                      02453000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02454000
PSARSAV  EQU   PSARSVTE+60                                              02455000
PSARSTK  EQU   PSARSVTE+56                                              02456000
PSAESAV3 EQU   PSARSVTE+52                                              02457000
PSAESTK3 EQU   PSARSVTE+48                                              02458000
PSAESAV2 EQU   PSARSVTE+44                                              02459000
PSAESTK2 EQU   PSARSVTE+40                                              02460000
PSAESAV1 EQU   PSARSVTE+36                                              02461000
PSAESTK1 EQU   PSARSVTE+32                                              02462000
PSAPSAV  EQU   PSARSVTE+28                                              02463000
PSAPSTK  EQU   PSARSVTE+24                                              02464000
PSAMSAV  EQU   PSARSVTE+20                                              02465000
PSAMSTK  EQU   PSARSVTE+16                                              02466000
PSASSAV  EQU   PSARSVTE+12                                              02467000
PSASSTK  EQU   PSARSVTE+8                                               02468000
PSANSTK  EQU   PSARSVTE+4                                               02469000
PSACSTK  EQU   PSARSVTE                                                 02470000
CVTRV628 EQU   CVTS01+728                                               02471000
CVTRV627 EQU   CVTS01+724                                               02472000
CVTRV626 EQU   CVTS01+720                                               02473000
CVTRV625 EQU   CVTS01+716                                               02474000
CVTRV624 EQU   CVTS01+712                                               02475000
CVTRV623 EQU   CVTS01+708                                               02476000
CVTRV622 EQU   CVTS01+704                                               02477000
CVTRV621 EQU   CVTS01+700                                               02478000
CVTIHASU EQU   CVTS01+696                                               02479000
CVTSUSP  EQU   CVTS01+692                                               02480000
CVTT6SVC EQU   CVTS01+688                                               02481000
CVTCDAL  EQU   CVTS01+684                                               02482000
CVTTCTL  EQU   CVTS01+680                                               02483000
CVTRSUME EQU   CVTS01+676                                               02484000
CVTJTERM EQU   CVTS01+672                                               02485000
CVTASMRM EQU   CVTS01+668                                               02486000
CVTTCASP EQU   CVTS01+664                                               02487000
CVT0PT03 EQU   CVTS01+660                                               02488000
CVT0PT0E EQU   CVTS01+656                                               02489000
CVTRV609 EQU   CVTS01+652                                               02490000
CVTCGK   EQU   CVTS01+648                                               02491000
CVTRAC   EQU   CVTS01+644                                               02492000
CVTRV606 EQU   CVTS01+640                                               02493000
CVTRV605 EQU   CVTS01+636                                               02494000
CVTRV604 EQU   CVTS01+632                                               02495000
CVTEFF02 EQU   CVTS01+628                                               02496000
CVTCBBR  EQU   CVTS01+624                                               02497000
CVTSSCR  EQU   CVTS01+620                                               02498000
CVTEVENT EQU   CVTS01+616                                               02499000
CVTCRCA  EQU   CVTS01+612                                               02500000
CVTTPIO  EQU   CVTS01+608                                               02501000
CVTADV   EQU   CVTS01+604                                               02502000
CVTGSDAB EQU   CVTGSDA                                                  02503000
CVTQV3   EQU   CVTS01+596                                               02504000
CVTQV2   EQU   CVTS01+592                                               02505000
CVTQV1   EQU   CVTS01+588                                               02506000
CVTRPT   EQU   CVTS01+584                                               02507000
CVTSSRB  EQU   CVTS01+580                                               02508000
CVTCSDRL EQU   CVTS01+576                                               02509000
CVTEXP1  EQU   CVTS01+572                                               02510000
CVTRMPMT EQU   CVTS01+568                                               02511000
CVTRMPTT EQU   CVTS01+564                                               02512000
CVTVPSA  EQU   CVTS01+560                                               02513000
CVTVSTOP EQU   CVTS01+556                                               02514000
CVTGTFR8 EQU   CVTS01+552                                               02515000
CVTQUIT  EQU   CVTS01+548                                               02516000
CVTVACR  EQU   CVTS01+544                                               02517000
CVTWTCB  EQU   CVTS01+540                                               02518000
CVTSTPRS EQU   CVTS01+536                                               02519000
CVT0PT02 EQU   CVTS01+532                                               02520000
CVTDARCM EQU   CVTS01+528                                               02521000
CVTIRECM EQU   CVTS01+524                                               02522000
CVTJRECM EQU   CVTS01+520                                               02523000
CVTVEMS0 EQU   CVTS01+516                                               02524000
CVTSPFRR EQU   CVTS01+512                                               02525000
CVTRLSTG EQU   CVTS01+508                                               02526000
CVT0TC0A EQU   CVTS01+504                                               02527000
CVTGMBR  EQU   CVTS01+500                                               02528000
CVTLFRM  EQU   CVTS01+496                                               02529000
CVTRMBR  EQU   CVTS01+492                                               02530000
CVTVIOP  EQU   CVTS01+488                                               02531000
CVTRV307 EQU   CVTS01+486                                               02532000
CVTRV306 EQU   CVTS01+484                                               02533000
CVTRV305 EQU   CVTS01+482                                               02534000
CVTRV304 EQU   CVTS01+480                                               02535000
CVTRV303 EQU   CVTS01+478                                               02536000
CVTRV302 EQU   CVTS01+476                                               02537000
CVTTRCA  EQU   CVTS01+472                                               02538000
CVTRV297 EQU   CVTRV289                                                 02539000
CVTRV296 EQU   CVTRV289                                                 02540000
CVTRV295 EQU   CVTRV289                                                 02541000
CVTRV294 EQU   CVTRV289                                                 02542000
CVTRV293 EQU   CVTRV289                                                 02543000
CVTRV292 EQU   CVTRV289                                                 02544000
CVTRV291 EQU   CVTRV289                                                 02545000
CVTRV290 EQU   CVTRV289                                                 02546000
CVTRV288 EQU   CVTRV280                                                 02547000
CVTRV287 EQU   CVTRV280                                                 02548000
CVTRV286 EQU   CVTRV280                                                 02549000
CVTRV285 EQU   CVTRV280                                                 02550000
CVTRV284 EQU   CVTRV280                                                 02551000
CVTRV283 EQU   CVTRV280                                                 02552000
CVTRV282 EQU   CVTRV280                                                 02553000
CVTRV281 EQU   CVTRV280                                                 02554000
CVTRV279 EQU   CVTRV271                                                 02555000
CVTRV278 EQU   CVTRV271                                                 02556000
CVTRV277 EQU   CVTRV271                                                 02557000
CVTRV276 EQU   CVTRV271                                                 02558000
CVTRV275 EQU   CVTRV271                                                 02559000
CVTRV274 EQU   CVTRV271                                                 02560000
CVTRV273 EQU   CVTRV271                                                 02561000
CVTRV272 EQU   CVTRV271                                                 02562000
CVTRV270 EQU   CVTRV262                                                 02563000
CVTRV269 EQU   CVTRV262                                                 02564000
CVTRV268 EQU   CVTRV262                                                 02565000
CVTRV267 EQU   CVTRV262                                                 02566000
CVTRV266 EQU   CVTRV262                                                 02567000
CVTRV265 EQU   CVTRV262                                                 02568000
CVTRV264 EQU   CVTRV262                                                 02569000
CVTRV263 EQU   CVTRV262                                                 02570000
CVTVFP   EQU   CVTS01+464                                               02571000
CVTVSI   EQU   CVTS01+460                                               02572000
CVTVPSIB EQU   CVTS01+456                                               02573000
CVTMFACT EQU   CVTMFRTR                                                 02574000
CVTMFCTL EQU   CVTS01+448                                               02575000
CVTPVBP  EQU   CVTS01+444                                               02576000
CVTPWI   EQU   CVTS01+440                                               02577000
CVTRV254 EQU   CVTS01+438                                               02578000
CVTRV253 EQU   CVTS01+436                                               02579000
CVTRV252 EQU   CVTS01+434                                               02580000
CVTRV251 EQU   CVTS01+433                                               02581000
CVTRV250 EQU   CVTS01+432                                               02582000
CVTRV249 EQU   CVTS01+431                                               02583000
CVTRV248 EQU   CVTS01+430                                               02584000
CVTRV247 EQU   CVTS01+429                                               02585000
CVTRV246 EQU   CVTS01+428                                               02586000
CVTRV245 EQU   CVTRV237                                                 02587000
CVTRV244 EQU   CVTRV237                                                 02588000
CVTRV243 EQU   CVTRV237                                                 02589000
CVTRV242 EQU   CVTRV237                                                 02590000
CVTRV241 EQU   CVTRV237                                                 02591000
CVTRV240 EQU   CVTRV237                                                 02592000
CVTRV239 EQU   CVTRV237                                                 02593000
CVTRV238 EQU   CVTRV237                                                 02594000
CVTRV236 EQU   CVTRV228                                                 02595000
CVTRV235 EQU   CVTRV228                                                 02596000
CVTRV234 EQU   CVTRV228                                                 02597000
CVTRV233 EQU   CVTRV228                                                 02598000
CVTRV232 EQU   CVTRV228                                                 02599000
CVTRV231 EQU   CVTRV228                                                 02600000
CVTRV230 EQU   CVTRV228                                                 02601000
CVTRV229 EQU   CVTRV228                                                 02602000
CVTRV227 EQU   CVTRV219                                                 02603000
CVTRV226 EQU   CVTRV219                                                 02604000
CVTRV225 EQU   CVTRV219                                                 02605000
CVTRV224 EQU   CVTRV219                                                 02606000
CVTRV223 EQU   CVTRV219                                                 02607000
CVTRV222 EQU   CVTRV219                                                 02608000
CVTRV221 EQU   CVTRV219                                                 02609000
CVTRV220 EQU   CVTRV219                                                 02610000
CVTRV218 EQU   CVTRV210                                                 02611000
CVTRV217 EQU   CVTRV210                                                 02612000
CVTRV216 EQU   CVTRV210                                                 02613000
CVTRV215 EQU   CVTRV210                                                 02614000
CVTRV214 EQU   CVTRV210                                                 02615000
CVTRV213 EQU   CVTRV210                                                 02616000
CVTRV212 EQU   CVTRV210                                                 02617000
CVTRV211 EQU   CVTRV210                                                 02618000
CVTLCCAT EQU   CVTS01+420                                               02619000
CVTPCCAT EQU   CVTS01+416                                               02620000
CVTIPCRP EQU   CVTS01+412                                               02621000
CVTIPCRI EQU   CVTS01+408                                               02622000
CVTIPCDS EQU   CVTS01+404                                               02623000
CVTAIDVT EQU   CVTS01+400                                               02624000
CVTSSAP  EQU   CVTS01+396                                               02625000
CVTEHCIR EQU   CVTS01+392                                               02626000
CVTEHDEF EQU   CVTS01+388                                               02627000
CVTDAIR  EQU   CVTS01+384                                               02628000
CVTPERFM EQU   CVTS01+380                                               02629000
CVT044R2 EQU   CVTS01+376                                               02630000
CVTFETCH EQU   CVTS01+372                                               02631000
CVTRSTWD EQU   CVTS01+368                                               02632000
CVTSPOST EQU   CVTS01+364                                               02633000
CVTIOBP  EQU   CVTS01+360                                               02634000
CVTASMVT EQU   CVTS01+356                                               02635000
CVTRECRQ EQU   CVTS01+352                                               02636000
CVTWSAC  EQU   CVTS01+348                                               02637000
CVTRV149 EQU   CVTS01+344                                               02638000
CVTWSAL  EQU   CVTS01+340                                               02639000
CVTSPSA  EQU   CVTS01+336                                               02640000
CVTGLMN  EQU   CVTS01+332                                               02641000
CVTVEAC0 EQU   CVTS01+328                                               02642000
CVT062R1 EQU   CVTS01+324                                               02643000
CVTRPOST EQU   CVTS01+320                                               02644000
CVTDQIQE EQU   CVTS01+316                                               02645000
CVTCSD   EQU   CVTS01+312                                               02646000
CVTLKRMA EQU   CVTS01+308                                               02647000
CVTRSPIE EQU   CVTS01+304                                               02648000
CVTRENQ  EQU   CVTS01+300                                               02649000
CVTLQCB  EQU   CVTS01+296                                               02650000
CVTFQCB  EQU   CVTS01+292                                               02651000
CVTQCS01 EQU   CVTS01+288                                               02652000
CVTAPFT  EQU   CVTS01+284                                               02653000
CVTPARRL EQU   CVTS01+280                                               02654000
CVTVWAIT EQU   CVTS01+276                                               02655000
CVTGSPL  EQU   CVTS01+272                                               02656000
CVTLSMQ  EQU   CVTS01+268                                               02657000
CVTGSMQ  EQU   CVTS01+264                                               02658000
CVTEXPRO EQU   CVTS01+260                                               02659000
CVTOPCTP EQU   CVTS01+256                                               02660000
CVTSIC   EQU   CVTS01+252                                               02661000
CVTTPIOS EQU   CVTS01+248                                               02662000
CVTRTMS  EQU   CVTS01+244                                               02663000
CVTSDBF  EQU   CVTS01+240                                               02664000
CVTSCBP  EQU   CVTS01+236                                               02665000
CVTSDMP  EQU   CVTS01+232                                               02666000
CVTSV60  EQU   CVTS01+228                                               02667000
CVTRTMCT EQU   CVTS01+224                                               02668000
CVTASCBL EQU   CVTS01+220                                               02669000
CVTASCBH EQU   CVTS01+216                                               02670000
CVTASVT  EQU   CVTS01+208                                               02671000
CVTVVMDI EQU   CVTS01+204                                               02672000
CVTAQTOP EQU   CVTS01+200                                               02673000
CVTIOSCS EQU   CVTS01+196                                               02674000
CVTSDRM  EQU   CVTS01+192                                               02675000
CVTOPTE  EQU   CVTS01+188                                               02676000
CVTSTXU  EQU   CVTS01+184                                               02677000
CVTQUIS  EQU   CVTS01+180                                               02678000
CVTPARS  EQU   CVTS01+176                                               02679000
CVTS1EE  EQU   CVTS01+172                                               02680000
CVTFRAS  EQU   CVTS01+168                                               02681000
CVTQSAS  EQU   CVTS01+164                                               02682000
CVTCRAS  EQU   CVTS01+160                                               02683000
CVTCRMN  EQU   CVTS01+156                                               02684000
CVTDELCP EQU   CVTS01+152                                               02685000
CVTFRECL EQU   CVTS01+148                                               02686000
CVTGETCL EQU   CVTS01+144                                               02687000
CVTBLDCP EQU   CVTS01+140                                               02688000
CVTAUTHL EQU   CVTS01+136                                               02689000
CVTSCAN  EQU   CVTS01+132                                               02690000
CVTRV144 EQU   CVTS01+130                                               02691000
CVTMAXMP EQU   CVTS01+128                                               02692000
CVTSTCK  EQU   CVTS01+124                                               02693000
CVTRV139 EQU   CVTS01+123                                               02694000
CVTDSSAC EQU   CVTS01+122                                               02695000
CVTRV513 EQU   CVTS01+121                                               02696000
CVTIOSPL EQU   CVTS01+120                                               02697000
CVTPTGT  EQU   CVTS01+116                                               02698000
CVTCSPIE EQU   CVTS01+112                                               02699000
CVTSMFEX EQU   CVTS01+108                                               02700000
CVTOLT0A EQU   CVTS01+104                                               02701000
CVTSRBRT EQU   CVTS01+100                                               02702000
CVTPUTL  EQU   CVTS01+96                                                02703000
CVTASCRL EQU   CVTS01+92                                                02704000
CVTASCRF EQU   CVTS01+88                                                02705000
CVTRV326 EQU   CVTS01+84                                                02706000
CVTRV325 EQU   CVTS01+80                                                02707000
CVTRV324 EQU   CVTS01+76                                                02708000
CVT0VL01 EQU   CVTS01+72                                                02709000
CVTRV332 EQU   CVTS01+64                                                02710000
CVTTAS   EQU   CVTS01+60                                                02711000
CVTRSCN  EQU   CVTS01+56                                                02712000
CVTTRAC2 EQU   CVTS01+54                                                02713000
CVTTRACE EQU   CVTS01+52                                                02714000
CVTAPG   EQU   CVTS01+51                                                02715000
CVTSDTRC EQU   CVTCTLFG                                                 02716000
CVTGTRCE EQU   CVTCTLFG                                                 02717000
CVTNOMP  EQU   CVTCTLFG                                                 02718000
CVTRSV79 EQU   CVTCTLFG                                                 02719000
CVTDSTAT EQU   CVTCTLFG                                                 02720000
CVTRSV78 EQU   CVTCTLFG                                                 02721000
CVTRV333 EQU   CVTCTLFG                                                 02722000
CVTRV323 EQU   CVTCTLFG                                                 02723000
CVTSPVLK EQU   CVTS01+49                                                02724000
CVTRSV77 EQU   CVTS01+48                                                02725000
CVTRV331 EQU   CVTS01+44                                                02726000
CVTRV330 EQU   CVTS01+40                                                02727000
CVTRV329 EQU   CVTS01+36                                                02728000
CVTRV328 EQU   CVTS01+32                                                02729000
CVTRV322 EQU   CVTS01+28                                                02730000
CVTSLID  EQU   CVTSLIDA+1                                               02731000
CVTSYLK  EQU   CVTSLIDA                                                 02732000
CVTRV321 EQU   CVTS01+20                                                02733000
CVTRV320 EQU   CVTS01+16                                                02734000
CVTLPDIR EQU   CVTLPDIA+1                                               02735000
CVTRSV69 EQU   CVTDIRST                                                 02736000
CVTRSV68 EQU   CVTDIRST                                                 02737000
CVTRSV67 EQU   CVTDIRST                                                 02738000
CVTRSV66 EQU   CVTDIRST                                                 02739000
CVTRSV65 EQU   CVTDIRST                                                 02740000
CVTRSV64 EQU   CVTDIRST                                                 02741000
CVTRSV63 EQU   CVTDIRST                                                 02742000
CVTDICOM EQU   CVTDIRST                                                 02743000
CVTLPDSR EQU   CVTS01+4                                                 02744000
CVTGETL  EQU   CVTS01                                                   02745000
ASCBEND  EQU   ASCB+208                                                 02746000
ASCBSRBT EQU   ASCB+200                                                 02747000
ASCBSWTL EQU   ASCB+196                                                 02748000
ASCBRS14 EQU   ASCB+195                                                 02749000
ASCBSMCT EQU   ASCB+194                                                 02750000
ASCBRS12 EQU   ASCB+192                                                 02751000
ASCBPCTT EQU   ASCB+188                                                 02752000
ASCBVGTT EQU   ASCB+184                                                 02753000
ASCBRV43 EQU   ASCBSRQ4                                                 02754000
ASCBRV42 EQU   ASCBSRQ4                                                 02755000
ASCBRV41 EQU   ASCBSRQ4                                                 02756000
ASCBRV40 EQU   ASCBSRQ4                                                 02757000
ASCBRV39 EQU   ASCBSRQ4                                                 02758000
ASCBRV38 EQU   ASCBSRQ4                                                 02759000
ASCBRV37 EQU   ASCBSRQ4                                                 02760000
ASCBRV36 EQU   ASCBSRQ4                                                 02761000
ASCBRV35 EQU   ASCBSRQ3                                                 02762000
ASCBRV34 EQU   ASCBSRQ3                                                 02763000
ASCBRV33 EQU   ASCBSRQ3                                                 02764000
ASCBRV32 EQU   ASCBSRQ3                                                 02765000
ASCBRV31 EQU   ASCBSRQ3                                                 02766000
ASCBRV30 EQU   ASCBSRQ3                                                 02767000
ASCBRV29 EQU   ASCBSRQ3                                                 02768000
ASCBRV28 EQU   ASCBSRQ3                                                 02769000
ASCBRV27 EQU   ASCBSRQ2                                                 02770000
ASCBRV26 EQU   ASCBSRQ2                                                 02771000
ASCBRV25 EQU   ASCBSRQ2                                                 02772000
ASCBRV24 EQU   ASCBSRQ2                                                 02773000
ASCBRV23 EQU   ASCBSRQ2                                                 02774000
ASCBRV22 EQU   ASCBSRQ2                                                 02775000
ASCBRV21 EQU   ASCBSRQ2                                                 02776000
ASCBRV20 EQU   ASCBSRQ2                                                 02777000
ASCBRV19 EQU   ASCBSRQ1                                                 02778000
ASCBRV18 EQU   ASCBSRQ1                                                 02779000
ASCBRV17 EQU   ASCBSRQ1                                                 02780000
ASCBRV16 EQU   ASCBSRQ1                                                 02781000
ASCBRV15 EQU   ASCBSRQ1                                                 02782000
ASCBRV14 EQU   ASCBSRQ1                                                 02783000
ASCBRV13 EQU   ASCBSRQ1                                                 02784000
ASCBSTA  EQU   ASCBSRQ1                                                 02785000
ASCBJBNS EQU   ASCB+176                                                 02786000
ASCBJBNI EQU   ASCB+172                                                 02787000
ASCBMCC  EQU   ASCB+168                                                 02788000
ASCBRTWA EQU   ASCB+164                                                 02789000
ASCBIQEA EQU   ASCB+160                                                 02790000
ASCBXMPQ EQU   ASCB+156                                                 02791000
ASCBRS01 EQU   ASCB+154                                                 02792000
ASCBFMCT EQU   ASCB+152                                                 02793000
ASCBOUXB EQU   ASCB+148                                                 02794000
ASCBOUCB EQU   ASCB+144                                                 02795000
ASCBMECB EQU   ASCB+140                                                 02796000
ASCBQECB EQU   ASCB+136                                                 02797000
ASCBLSQH EQU   ASCBLKGP+4                                               02798000
ASCBLOCK EQU   ASCBLKGP                                                 02799000
ASCBTCBS EQU   ASCB+124                                                 02800000
ASCBNVSC EQU   ASCB+122                                                 02801000
ASCBVSC  EQU   ASCB+120                                                 02802000
ASCBSRBS EQU   ASCB+118                                                 02803000
ASCBSSRB EQU   ASCB+116                                                 02804000
ASCBRV06 EQU   ASCBFLG2                                                 02805000
ASCBRV05 EQU   ASCBFLG2                                                 02806000
ASCBRV04 EQU   ASCBFLG2                                                 02807000
ASCBSNQS EQU   ASCBFLG2                                                 02808000
ASCBS2S  EQU   ASCBFLG2                                                 02809000
ASCBCEXT EQU   ASCBFLG2                                                 02810000
ASCBPXMT EQU   ASCBFLG2                                                 02811000
ASCBXMPT EQU   ASCBFLG2                                                 02812000
ASCBRF07 EQU   ASCBDSP1                                                 02813000
ASCBRF06 EQU   ASCBDSP1                                                 02814000
ASCBRF05 EQU   ASCBDSP1                                                 02815000
ASCBRF04 EQU   ASCBDSP1                                                 02816000
ASCBRF03 EQU   ASCBDSP1                                                 02817000
ASCBRF02 EQU   ASCBDSP1                                                 02818000
ASCBFAIL EQU   ASCBDSP1                                                 02819000
ASCBNOQ  EQU   ASCBDSP1                                                 02820000
ASCBSWCT EQU   ASCB+112                                                 02821000
ASCBASXB EQU   ASCB+108                                                 02822000
ASCBTMCH EQU   ASCB+104                                                 02823000
ASCBNSWP EQU   ASCBFLG1                                                 02824000
ASCBTYP1 EQU   ASCBFLG1                                                 02825000
ASCBSTND EQU   ASCBFLG1                                                 02826000
ASCBABNT EQU   ASCBFLG1                                                 02827000
ASCBTERM EQU   ASCBFLG1                                                 02828000
ASCBS3S  EQU   ASCBFLG1                                                 02829000
ASCBCMSH EQU   ASCBFLG1                                                 02830000
ASCBTOFF EQU   ASCBFLG1                                                 02831000
ASCBRF01 EQU   ASCBRCTF                                                 02832000
ASCBTMLW EQU   ASCBRCTF                                                 02833000
ASCBOUT  EQU   ASCBRCTF                                                 02834000
ASCBWAIT EQU   ASCBRCTF                                                 02835000
ASCBRV08 EQU   ASCBRCTF                                                 02836000
ASCBFQU  EQU   ASCBRCTF                                                 02837000
ASCBFRS  EQU   ASCBRCTF                                                 02838000
ASCBTMNO EQU   ASCBRCTF                                                 02839000
ASCBAFFN EQU   ASCBFW1                                                  02840000
ASCBDUMP EQU   ASCB+96                                                  02841000
ASCBRV44 EQU   ASCB+92                                                  02842000
ASCBUBET EQU   ASCB+88                                                  02843000
ASCBECB  EQU   ASCB+84                                                  02844000
ASCBJSTL EQU   ASCB+80                                                  02845000
ASCBEWST EQU   ASCB+72                                                  02846000
ASCBEJST EQU   ASCB+64                                                  02847000
ASCBTSB  EQU   ASCB+60                                                  02848000
ASCBCSCB EQU   ASCB+56                                                  02849000
ASCBLDA  EQU   ASCB+48                                                  02850000
ASCBSTOR EQU   ASCB+44                                                  02851000
ASCBDP   EQU   ASCB+43                                                  02852000
ASCBRV07 EQU   ASCB+42                                                  02853000
ASCBIOSM EQU   ASCB+40                                                  02854000
ASCBSEQN EQU   ASCB+38                                                  02855000
ASCBASID EQU   ASCB+36                                                  02856000
ASCBCPUS EQU   ASCB+32                                                  02857000
ASCBSPL  EQU   ASCB+28                                                  02858000
ASCBIOSP EQU   ASCB+24                                                  02859000
ASCBSYNC EQU   ASCBSUPC+4                                               02860000
ASCBSVRB EQU   ASCBSUPC                                                 02861000
ASCBCMSF EQU   ASCB+12                                                  02862000
ASCBBWDP EQU   ASCB+8                                                   02863000
ASCBFWDP EQU   ASCB+4                                                   02864000
ASCBASCB EQU   ASCB                                                     02865000
ASCBEGIN EQU   ASCB                                                     02866000
RSMASMHD EQU   RSMHD+40                                                 02867000
RSMFOEQ  EQU   RSMHD+36                                                 02868000
RSMLIOQL EQU   RSMLIOQ+4                                                02869000
RSMLIOQF EQU   RSMLIOQ                                                  02870000
RSMLSQAL EQU   RSMLSQA+2                                                02871000
RSMLSQAF EQU   RSMLSQA                                                  02872000
RSMLFQL  EQU   RSMLFQ+2                                                 02873000
RSMLFQF  EQU   RSMLFQ                                                   02874000
RSMRSV2  EQU   RSMHD+16                                                 02875000
RSMCNTFX EQU   RSMHD+14                                                 02876000
RSMRSV1  EQU   RSMHD+13                                                 02877000
@NM00078 EQU   RSMFLG1                                                  02878000
RSMFAIL  EQU   RSMFLG1                                                  02879000
RSMGFADD EQU   RSMFLG1                                                  02880000
RSMCPNC  EQU   RSMFLG1                                                  02881000
RSMCPNU  EQU   RSMFLG1                                                  02882000
RSMGFAD  EQU   RSMFLG1                                                  02883000
RSMIOCPC EQU   RSMFLG1                                                  02884000
RSMIOCPU EQU   RSMFLG1                                                  02885000
RSMASCB  EQU   RSMHD+8                                                  02886000
RSMSPCT  EQU   RSMHD+4                                                  02887000
RSMVSTO  EQU   RSMHD                                                    02888000
GBLCELCT EQU   GDA+60                                                   02889000
GLBLCELL EQU   GDA+56                                                   02890000
CSASPQEP EQU   GDA+52                                                   02891000
PFSTCPAB EQU   GDA+48                                                   02892000
VRWLEL   EQU   VRWAITQ+4                                                02893000
VRWFEL   EQU   VRWAITQ                                                  02894000
VRPLEL   EQU   VRPOSTQ+4                                                02895000
VRPFEL   EQU   VRPOSTQ                                                  02896000
RESV     EQU   GVSMFLAG+1                                               02897000
@NM00077 EQU   GDAFLAGS                                                 02898000
WAITQUE  EQU   GDAFLAGS                                                 02899000
SQATHRS2 EQU   GDAFLAGS                                                 02900000
SQATHRS1 EQU   GDAFLAGS                                                 02901000
GDAFLAG2 EQU   GDAFLAGS                                                 02902000
NIPFOURK EQU   GDAFLAGS                                                 02903000
GDAFLAG1 EQU   GDAFLAGS                                                 02904000
NIPPTSID EQU   NIPPTE+6                                                 02905000
@NM00076 EQU   NIPPTATF                                                 02906000
NIPPTMRG EQU   NIPPTATF                                                 02907000
@NM00075 EQU   NIPPTOPF                                                 02908000
NIPPTCAN EQU   NIPPTOPF                                                 02909000
NIPPTLST EQU   NIPPTOPF                                                 02910000
NIPPTOPI EQU   NIPPTOPF                                                 02911000
NIPPTADR EQU   NIPPTE                                                   02912000
PTABEND  EQU   PARMTAB+312                                              02913000
@NM00074 EQU   PARMTAB+308                                              02914000
DUPLEX   EQU   PARMTAB+304                                              02915000
@NM00073 EQU   PARMTAB+300                                              02916000
PAGNUM   EQU   PARMTAB+296                                              02917000
@NM00072 EQU   PARMTAB+292                                              02918000
SWAP     EQU   PARMTAB+288                                              02919000
@NM00071 EQU   PARMTAB+284                                              02920000
RSU      EQU   PARMTAB+280                                              02921000
@NM00070 EQU   @NM00068+1                                               02922000
@NM00069 EQU   NIPPAFLG                                                 02923000
NIPPAFL1 EQU   NIPPAFLG                                                 02924000
@NM00067 EQU   PARMTAB+268                                              02925000
PURGE    EQU   PARMTAB+264                                              02926000
@NM00066 EQU   PARMTAB+260                                              02927000
WTORPLY  EQU   PARMTAB+256                                              02928000
@NM00065 EQU   PARMTAB+252                                              02929000
WTOBFRS  EQU   PARMTAB+248                                              02930000
@NM00064 EQU   PARMTAB+244                                              02931000
@NM00063 EQU   PARMTAB+236                                              02932000
VAL      EQU   PARMTAB+232                                              02933000
@NM00062 EQU   PARMTAB+228                                              02934000
SYSP     EQU   PARMTAB+224                                              02935000
@NM00061 EQU   PARMTAB+220                                              02936000
@NM00060 EQU   PARMTAB+212                                              02937000
SMF      EQU   PARMTAB+208                                              02938000
@NM00059 EQU   PARMTAB+204                                              02939000
@NM00058 EQU   PARMTAB+196                                              02940000
PAGEO    EQU   PARMTAB+192                                              02941000
@NM00057 EQU   PARMTAB+188                                              02942000
PAGEP    EQU   PARMTAB+184                                              02943000
@NM00056 EQU   PARMTAB+180                                              02944000
OPT      EQU   PARMTAB+176                                              02945000
@NM00055 EQU   PARMTAB+172                                              02946000
OPI      EQU   PARMTAB+168                                              02947000
@NM00054 EQU   PARMTAB+164                                              02948000
NUCMAP   EQU   PARMTAB+160                                              02949000
@NM00053 EQU   PARMTAB+156                                              02950000
MLPA     EQU   PARMTAB+152                                              02951000
@NM00052 EQU   PARMTAB+148                                              02952000
MAXUSER  EQU   PARMTAB+144                                              02953000
@NM00051 EQU   PARMTAB+140                                              02954000
LOGLMT   EQU   PARMTAB+136                                              02955000
@NM00050 EQU   PARMTAB+132                                              02956000
LOGCLS   EQU   PARMTAB+128                                              02957000
@NM00049 EQU   PARMTAB+124                                              02958000
LNK      EQU   PARMTAB+120                                              02959000
@NM00048 EQU   PARMTAB+116                                              02960000
IPS      EQU   PARMTAB+112                                              02961000
@NM00047 EQU   PARMTAB+108                                              02962000
HARDCPY  EQU   PARMTAB+104                                              02963000
@NM00046 EQU   PARMTAB+100                                              02964000
FIX      EQU   PARMTAB+96                                               02965000
@NM00045 EQU   PARMTAB+92                                               02966000
DUMP     EQU   PARMTAB+88                                               02967000
@NM00044 EQU   PARMTAB+84                                               02968000
CVIO     EQU   PARMTAB+80                                               02969000
@NM00043 EQU   PARMTAB+76                                               02970000
@NM00042 EQU   PARMTAB+68                                               02971000
CPQE     EQU   PARMTAB+64                                               02972000
@NM00041 EQU   PARMTAB+60                                               02973000
CONT     EQU   PARMTAB+56                                               02974000
@NM00040 EQU   PARMTAB+52                                               02975000
CMD      EQU   PARMTAB+48                                               02976000
@NM00039 EQU   PARMTAB+44                                               02977000
CLPA     EQU   PARMTAB+40                                               02978000
@NM00038 EQU   PARMTAB+36                                               02979000
BLDLF    EQU   PARMTAB+32                                               02980000
@NM00037 EQU   PARMTAB+28                                               02981000
BLDL     EQU   PARMTAB+24                                               02982000
@NM00036 EQU   PARMTAB+20                                               02983000
APG      EQU   PARMTAB+16                                               02984000
@NM00035 EQU   PARMTAB+12                                               02985000
APF      EQU   PARMTAB+8                                                02986000
PTABSTRT EQU   PARMTAB                                                  02987000
NIPPABUF EQU   NIPPAREA+572                                             02988000
NIPPAPTB EQU   NIPPAREA+252                                             02989000
@NM00034 EQU   NIPPAREA+248                                             02990000
NIPPARCD EQU   NIPPAIOD+136                                             02991000
NIPPADEB EQU   NIPPAIOD+88                                              02992000
@NM00033 EQU   NIPPAECB+1                                               02993000
NIPPAECC EQU   NIPPAECB                                                 02994000
NIPPADCB EQU   NIPPAIOD+80                                              02995000
NIPPAIOB EQU   NIPPAIOD+40                                              02996000
@NM00032 EQU   NIPPAIOD+37                                              02997000
NIPPASID EQU   NIPPAIOD+32                                              02998000
NIPPATXT EQU   NIPPAIOD                                                 02999000
@NM00031 EQU   NIPPAREA+30                                              03000000
@NM00030 EQU   NIPPABDL+15                                              03001000
NIPPATTR EQU   NIPPABDL+12                                              03002000
NIPPANAM EQU   NIPPABDL+4                                               03003000
NIPPA2BF EQU   NIPPABDH                                                 03004000
NIPPARC  EQU   NIPPAREA+8                                               03005000
@NM00029 EQU   NIPPAREA                                                 03006000
NIPPABYT EQU   NIPPAHDR+4                                               03007000
NIPPAQ   EQU   NIPPAHDR                                                 03008000
NSCHDCPU EQU   NIPSCHDL+8                                               03009000
NSCHDPRM EQU   NIPSCHDL+4                                               03010000
NSCHDPTR EQU   NIPSCHDL                                                 03011000
@NM00028 EQU   NIPOPNPL+22                                              03012000
NOPNRC   EQU   NIPOPNPL+21                                              03013000
NOPNFLSX EQU   NOPNFL                                                   03014000
NOPNFLLC EQU   NOPNFL                                                   03015000
NOPNFLLB EQU   NOPNFL                                                   03016000
NOPNFLNB EQU   NOPNFL                                                   03017000
NOPNFLI  EQU   NOPNFL                                                   03018000
NOPNFLM  EQU   NOPNFL                                                   03019000
NOPNFAU  EQU   NOPNFL                                                   03020000
NOPNFRS  EQU   NOPNFL                                                   03021000
NOPNUCB  EQU   NIPOPNPL+16                                              03022000
NOPNDCB  EQU   NIPOPNPL+12                                              03023000
NOPNDSA  EQU   NOPNDS                                                   03024000
@NM00027 EQU   NIPMNTPL+21                                              03025000
NMNTFLB  EQU   NMNTFL                                                   03026000
NMNTFLC  EQU   NMNTFL                                                   03027000
NMNTFLI  EQU   NMNTFL                                                   03028000
NMNTFUS  EQU   NMNTFL                                                   03029000
@NM00026 EQU   NMNTFL                                                   03030000
NMNTDT   EQU   NIPMNTPL+18                                              03031000
NMNTUCB  EQU   NMNTVS                                                   03032000
NMNTDSA  EQU   NMNTDS                                                   03033000
NIPSPEA  EQU   NIPSPE+4                                                 03034000
NIPSPEQ  EQU   NIPSPE                                                   03035000
@NM00025 EQU   NWTORLST+11                                              03036000
@NM00024 EQU   NWTORFL                                                  03037000
NWTORFLB EQU   NWTORFL                                                  03038000
@NM00023 EQU   NWTORFL                                                  03039000
NWTORFLA EQU   NWTORFL                                                  03040000
NMTORRDL EQU   NWTORLST+8                                               03041000
NWTORECB EQU   NWTORLST+4                                               03042000
NWTORRPA EQU   NWTORLST                                                 03043000
@NM00022 EQU   NWTOFL                                                   03044000
NWTOFLNC EQU   NWTOFL                                                   03045000
NWTOFLNH EQU   NWTOFL                                                   03046000
NWTOLNG  EQU   NWTOHDR                                                  03047000
NVTLPAHA EQU   NVT+548                                                  03048000
NVTLPALO EQU   NVT+544                                                  03049000
NVTRMSG  EQU   NVT+540                                                  03050000
NVTRLOCK EQU   NVT+536                                                  03051000
NVTRCODE EQU   NVT+532                                                  03052000
@NM00021 EQU   NVT+529                                                  03053000
@NM00020 EQU   NVTFLPO                                                  03054000
NVTFLWS  EQU   NVTFLPO                                                  03055000
@NM00019 EQU   NVTFLPO                                                  03056000
NVTSYSP  EQU   NVTFLPO                                                  03057000
NVTFLLST EQU   NVTFLPO                                                  03058000
NVTRSV48 EQU   NVT+524                                                  03059000
NVTRSV47 EQU   NVT+520                                                  03060000
NVTRSV46 EQU   NVT+516                                                  03061000
@NM00018 EQU   NVT+512                                                  03062000
NVTFASVT EQU   NVT+504                                                  03063000
NVTRSV45 EQU   NVT+496                                                  03064000
NVTRSV4A EQU   NVT+480                                                  03065000
NVTRMSS  EQU   NVT+472                                                  03066000
NVTRPQE  EQU   NVT+468                                                  03067000
NVTRLLE  EQU   NVT+464                                                  03068000
NVTRJPQ  EQU   NVT+460                                                  03069000
NVTVMSS  EQU   NVT+456                                                  03070000
NVTVPQE  EQU   NVT+452                                                  03071000
NVTVLLE  EQU   NVT+448                                                  03072000
NVTVJPQ  EQU   NVT+444                                                  03073000
NVTLSEC  EQU   NVTLOCAT+4                                               03074000
NVTLFST  EQU   NVTLOCAT                                                 03075000
NVTXSEC  EQU   NVTXCTL+4                                                03076000
NVTXFST  EQU   NVTXCTL                                                  03077000
@NM00017 EQU   NVT+425                                                  03078000
NVTLPACT EQU   NVT+424                                                  03079000
NVTCSLPG EQU   NVT+420                                                  03080000
NVTCSIOB EQU   NVT+416                                                  03081000
NVTCSLNM EQU   NVT+412                                                  03082000
NVTCSLIB EQU   NVT+408                                                  03083000
NVTBLDL  EQU   NVT+404                                                  03084000
NVTVRBLD EQU   NVT+400                                                  03085000
@NM00016 EQU   NVT+392                                                  03086000
NVTVRTCB EQU   NVT+388                                                  03087000
NVTVVTCB EQU   NVT+384                                                  03088000
NVTSPUCB EQU   NVT+382                                                  03089000
NVTRSV44 EQU   NVT+380                                                  03090000
NVTQSBUF EQU   NVT+376                                                  03091000
NVTPAREA EQU   NVT+368                                                  03092000
NVTRSV43 EQU   NVT+364                                                  03093000
@NM00015 EQU   NVT+363                                                  03094000
NVTABWS1 EQU   NVT+362                                                  03095000
NVTABCD1 EQU   NVT+360                                                  03096000
@NM00014 EQU   NVT+358                                                  03097000
NVTCPUAD EQU   NVT+356                                                  03098000
NVTTOD   EQU   NVT+352                                                  03099000
NVTSPE   EQU   NVT+344                                                  03100000
NVTMBEND EQU   NVT+340                                                  03101000
NVTMBUF  EQU   NVT+336                                                  03102000
NVTDCBSN EQU   NVT+332                                                  03103000
NVTDCBOC EQU   NVT+328                                                  03104000
NVTDCBIC EQU   NVT+324                                                  03105000
@NM00013 EQU   NVT+308                                                  03106000
NVTNMBLD EQU   NVT+304                                                  03107000
NVTNIPM  EQU   NVT+292                                                  03108000
NVTPRMPT EQU   NVT+272                                                  03109000
NVTIX    EQU   NVTFLWSC                                                 03110000
NVTFLWS1 EQU   NVTWPSW2+2                                               03111000
NVTIDPSW EQU   NVTWPSW2                                                 03112000
NVTWPSW1 EQU   NVTWTPSW                                                 03113000
NVTMCPSW EQU   NVT+216                                                  03114000
@NM00012 EQU   NVT+212                                                  03115000
@NM00011 EQU   NVTFLCN                                                  03116000
NVTFLRAC EQU   NVTFLCN                                                  03117000
NVTFLNCK EQU   NVTFLCN                                                  03118000
NVTFLNHC EQU   NVTFLCN                                                  03119000
NVTFLASM EQU   NVTFLCN                                                  03120000
NVTMP    EQU   NVTFLCN                                                  03121000
NVTFLIOC EQU   NVTFLCN                                                  03122000
NVTFLAC  EQU   NVTFLCN                                                  03123000
NVTFLSG  EQU   NVT+210                                                  03124000
NVTTRACE EQU   NVT+208                                                  03125000
NVTNXPTR EQU   NVT+204                                                  03126000
NVTNXSIZ EQU   NVT+202                                                  03127000
@NM00010 EQU   NVT+200                                                  03128000
NVTSGPSA EQU   NVT+196                                                  03129000
NVTN0MSG EQU   NVT+192                                                  03130000
NVTNBFND EQU   NVT+184                                                  03131000
NVTNUCND EQU   NVT+180                                                  03132000
NVTSTMAP EQU   NVT+176                                                  03133000
NVTRTMSA EQU   NVT+172                                                  03134000
NVTMFASA EQU   NVT+168                                                  03135000
NVTLSPQE EQU   NVT+164                                                  03136000
NVTALSQA EQU   NVT+160                                                  03137000
NVTPQSAV EQU   NVT+156                                                  03138000
NVTSVC60 EQU   NVT+148                                                  03139000
NVTABSEC EQU   NVTABSAV+4                                               03140000
NVTABFST EQU   NVTABSAV                                                 03141000
NVTNVSQA EQU   NVT+138                                                  03142000
NVTRSVMN EQU   NVT+136                                                  03143000
NVTNBMIN EQU   NVT+134                                                  03144000
NVTRGNAV EQU   NVT+132                                                  03145000
NVTLSQNO EQU   NVT+130                                                  03146000
NVTSQANO EQU   NVT+128                                                  03147000
NVTLSQAS EQU   NVT+124                                                  03148000
NVTLNGFX EQU   NVT+120                                                  03149000
NVTIGXER EQU   NVT+116                                                  03150000
@NM00009 EQU   NVT+112                                                  03151000
NVTRSV49 EQU   NVT+108                                                  03152000
NVTNVRSZ EQU   NVT+104                                                  03153000
NVTMFA   EQU   NVT+100                                                  03154000
NVTDSSNG EQU   NVT+96                                                   03155000
NVTMSLNK EQU   NVT+92                                                   03156000
NVTVVMDI EQU   NVT+88                                                   03157000
NVTIGCER EQU   NVT+84                                                   03158000
NVTVBLDL EQU   NVT+80                                                   03159000
NVTSVCTB EQU   NVT+76                                                   03160000
NVTRSV42 EQU   NVT+72                                                   03161000
NVTRSV41 EQU   NVT+68                                                   03162000
NVTMASCB EQU   NVT+64                                                   03163000
NVTCMTCB EQU   NVT+60                                                   03164000
NVTMSTCB EQU   NVT+56                                                   03165000
@NM00008 EQU   NVTFLLB                                                  03166000
NVTFLSLB EQU   NVTFLLB                                                  03167000
@NM00007 EQU   NVTNPATR                                                 03168000
NVTNPREU EQU   NVTNPREN                                                 03169000
@NM00006 EQU   NVTNPREN                                                 03170000
NVTNPSFX EQU   NVT+53                                                   03171000
@NM00005 EQU   NVT+52                                                   03172000
NVTNPSUF EQU   NVT                                                      03173000
CVTLEVL  EQU   CVTRELNO+2                                               03174000
CVTNUMB  EQU   CVTRELNO                                                 03175000
CVTMDL   EQU   CVTFIX+250                                               03176000
@NM00004 EQU   CVTFIX+248                                               03177000
@NM00003 EQU   CVTFIX                                                   03178000
CVTRV482 EQU   CVTXTNT2+128                                             03179000
CVTRV481 EQU   CVTXTNT2+124                                             03180000
CVTRV480 EQU   CVTXTNT2+120                                             03181000
CVTRV479 EQU   CVTXTNT2+118                                             03182000
CVTRV478 EQU   CVTXTNT2+117                                             03183000
CVTRV477 EQU   CVTXTNT2+116                                             03184000
CVTRV476 EQU   CVTXTNT2+115                                             03185000
CVTRV475 EQU   CVTXTNT2+114                                             03186000
CVTRV474 EQU   CVTRV466                                                 03187000
CVTRV473 EQU   CVTRV466                                                 03188000
CVTRV472 EQU   CVTRV466                                                 03189000
CVTRV471 EQU   CVTRV466                                                 03190000
CVTRV470 EQU   CVTRV466                                                 03191000
CVTRV469 EQU   CVTRV466                                                 03192000
CVTRV468 EQU   CVTRV466                                                 03193000
CVTRV467 EQU   CVTRV466                                                 03194000
CVTRV465 EQU   CVTRV457                                                 03195000
CVTRV464 EQU   CVTRV457                                                 03196000
CVTRV463 EQU   CVTRV457                                                 03197000
CVTRV462 EQU   CVTRV457                                                 03198000
CVTRV461 EQU   CVTRV457                                                 03199000
CVTRV460 EQU   CVTRV457                                                 03200000
CVTRV459 EQU   CVTRV457                                                 03201000
CVTRV458 EQU   CVTRV457                                                 03202000
CVTRV456 EQU   CVTXTNT2+108                                             03203000
CVTRV455 EQU   CVTXTNT2+104                                             03204000
CVTRV454 EQU   CVTXTNT2+100                                             03205000
CVTRV453 EQU   CVTXTNT2+96                                              03206000
CVTRV452 EQU   CVTXTNT2+94                                              03207000
CVTRV451 EQU   CVTXTNT2+92                                              03208000
CVTRV450 EQU   CVTXTNT2+90                                              03209000
CVTRV449 EQU   CVTXTNT2+88                                              03210000
CVTRV448 EQU   CVTXTNT2+87                                              03211000
CVTRV447 EQU   CVTXTNT2+86                                              03212000
CVTRV446 EQU   CVTRV438                                                 03213000
CVTRV445 EQU   CVTRV438                                                 03214000
CVTRV444 EQU   CVTRV438                                                 03215000
CVTRV443 EQU   CVTRV438                                                 03216000
CVTRV442 EQU   CVTRV438                                                 03217000
CVTRV441 EQU   CVTRV438                                                 03218000
CVTRV440 EQU   CVTRV438                                                 03219000
CVTRV439 EQU   CVTRV438                                                 03220000
CVTRV437 EQU   CVTRV429                                                 03221000
CVTRV436 EQU   CVTRV429                                                 03222000
CVTRV435 EQU   CVTRV429                                                 03223000
CVTRV434 EQU   CVTRV429                                                 03224000
CVTRV433 EQU   CVTRV429                                                 03225000
CVTRV432 EQU   CVTRV429                                                 03226000
CVTRV431 EQU   CVTRV429                                                 03227000
CVTRV430 EQU   CVTRV429                                                 03228000
CVTRV428 EQU   CVTXTNT2+80                                              03229000
CVTRV427 EQU   CVTXTNT2+76                                              03230000
CVTRV426 EQU   CVTXTNT2+72                                              03231000
CVTRV425 EQU   CVTXTNT2+68                                              03232000
CVTATACT EQU   CVTATCVT                                                 03233000
CVTRV423 EQU   CVTXTNT2+62                                              03234000
CVTRV422 EQU   CVTXTNT2+60                                              03235000
CVTRV421 EQU   CVTXTNT2+58                                              03236000
CVTRV420 EQU   CVTXTNT2+56                                              03237000
CVTRV419 EQU   CVTXTNT2+55                                              03238000
CVTRV418 EQU   CVTXTNT2+54                                              03239000
CVTRV417 EQU   CVTRV409                                                 03240000
CVTRV416 EQU   CVTRV409                                                 03241000
CVTRV415 EQU   CVTRV409                                                 03242000
CVTRV414 EQU   CVTRV409                                                 03243000
CVTRV413 EQU   CVTRV409                                                 03244000
CVTRV412 EQU   CVTRV409                                                 03245000
CVTRV411 EQU   CVTRV409                                                 03246000
CVTRV410 EQU   CVTRV409                                                 03247000
CVTRV408 EQU   CVTRV400                                                 03248000
CVTRV407 EQU   CVTRV400                                                 03249000
CVTRV406 EQU   CVTRV400                                                 03250000
CVTRV405 EQU   CVTRV400                                                 03251000
CVTRV404 EQU   CVTRV400                                                 03252000
CVTRV403 EQU   CVTRV400                                                 03253000
CVTRV402 EQU   CVTRV400                                                 03254000
CVTRV401 EQU   CVTRV400                                                 03255000
CVTICB   EQU   CVTXTNT2+48                                              03256000
CVTSKTA  EQU   CVTXTNT2+44                                              03257000
CVTRSV99 EQU   CVTXTNT2+40                                              03258000
CVTRSV98 EQU   CVTXTNT2+36                                              03259000
CVTRSV97 EQU   CVTXTNT2+34                                              03260000
CVTRSV96 EQU   CVTXTNT2+32                                              03261000
CVTOLTEP EQU   CVTXTNT2+28                                              03262000
CVTQIDA  EQU   CVTQID+1                                                 03263000
CVTRSV95 EQU   CVTQID                                                   03264000
CVTRSV94 EQU   CVTXTNT2+20                                              03265000
CVTRSV93 EQU   CVTXTNT2+16                                              03266000
CVTRSV92 EQU   CVTXTNT2+12                                              03267000
CVTDEBVR EQU   CVTXTNT2+8                                               03268000
CVTRSV91 EQU   CVTXTNT2+6                                               03269000
CVTRSV9H EQU   CVTFLGBT                                                 03270000
CVTRSV9G EQU   CVTFLGBT                                                 03271000
CVTRSV9F EQU   CVTFLGBT                                                 03272000
CVTRSV9E EQU   CVTFLGBT                                                 03273000
CVTRSV9D EQU   CVTFLGBT                                                 03274000
CVTRSV9C EQU   CVTFLGBT                                                 03275000
CVTVME   EQU   CVTFLGBT                                                 03276000
CVTNPE   EQU   CVTFLGBT                                                 03277000
CVTNUCLS EQU   CVTXTNT2+4                                               03278000
CVTDSSVA EQU   CVTDSSV+1                                                03279000
CVTRSV89 EQU   CVTDSSV                                                  03280000
CVTRSV88 EQU   CVTXTNT1+8                                               03281000
CVTRSV87 EQU   CVTXTNT1+4                                               03282000
CVTFACHN EQU   CVTXTNT1                                                 03283000
CVTRV488 EQU   CVTMAP+412                                               03284000
CVTRV487 EQU   CVTMAP+408                                               03285000
CVTRV486 EQU   CVTMAP+404                                               03286000
CVTRV485 EQU   CVTMAP+400                                               03287000
CVTACTAP EQU   CVTMAP+396                                               03288000
CVTAUTH  EQU   CVTMAP+392                                               03289000
CVTATMCA EQU   CVTATMCT+1                                               03290000
CVTATMST EQU   CVTATMCT                                                 03291000
CVTRSV61 EQU   CVTMAP+384                                               03292000
CVTVOLT1 EQU   CVTVOLM1+1                                               03293000
CVTVOLI1 EQU   CVTVOLF1                                                 03294000
CVTSTOA  EQU   CVTMAP+376                                               03295000
CVTRSV58 EQU   CVTMAP+374                                               03296000
CVTRSV57 EQU   CVTMAP+372                                               03297000
CVTDDCE  EQU   CVTMAP+368                                               03298000
CVTPNWFR EQU   CVTMAP+364                                               03299000
CVTSMF   EQU   CVTMAP+360                                               03300000
CVTSULK  EQU   CVTMAP+358                                               03301000
CVTSLKO  EQU   CVTSYSK                                                  03302000
CVTSLKP  EQU   CVTSYSK                                                  03303000
CVTSLKQ  EQU   CVTSYSK                                                  03304000
CVTSLKR  EQU   CVTSYSK                                                  03305000
CVTRSV56 EQU   CVTSYSK                                                  03306000
CVTRSV55 EQU   CVTSYSK                                                  03307000
CVTRSV54 EQU   CVTSYSK                                                  03308000
CVTRSV53 EQU   CVTSYSK                                                  03309000
CVTRSV52 EQU   CVTA1F1                                                  03310000
CVTRSV51 EQU   CVTA1F1                                                  03311000
CVTRSV50 EQU   CVTA1F1                                                  03312000
CVTRSV49 EQU   CVTA1F1                                                  03313000
CVTRSV48 EQU   CVTA1F1                                                  03314000
CVTRSV47 EQU   CVTA1F1                                                  03315000
CVTSRSW  EQU   CVTA1F1                                                  03316000
CVTPFSW  EQU   CVTA1F1                                                  03317000
CVTPCVT  EQU   CVTMAP+352                                               03318000
CVTRSV46 EQU   CVTMAP+344                                               03319000
CVTRSV45 EQU   CVTMAP+340                                               03320000
CVTRSV44 EQU   CVTMAP+338                                               03321000
CVTRSV43 EQU   CVTMAP+336                                               03322000
CVTHJESA EQU   CVTHJES+1                                                03323000
CVTRSV42 EQU   CVTHJES                                                  03324000
CVTEXT2A EQU   CVTEXT2+1                                                03325000
CVTRSV41 EQU   CVTEXT2                                                  03326000
CVTAPFA  EQU   CVTAPF+1                                                 03327000
CVTRSV40 EQU   CVTAPF                                                   03328000
CVTRV518 EQU   CVTINTLA                                                 03329000
CVTRV517 EQU   CVTERPV                                                  03330000
CVTEORM  EQU   CVTMAP+312                                               03331000
CVTMCHPR EQU   CVTMAP+308                                               03332000
CVTTZ    EQU   CVTMAP+304                                               03333000
CVTJEPS  EQU   CVTMAP+300                                               03334000
CVTJESCT EQU   CVTMAP+296                                               03335000
CVTMODE  EQU   CVTMAP+292                                               03336000
CVTPTRV  EQU   CVTMAP+288                                               03337000
CVTREAL  EQU   CVTMAP+284                                               03338000
CVTRSV39 EQU   CVTMAP+280                                               03339000
CVTRSV38 EQU   CVTMAP+276                                               03340000
CVTDMSRA EQU   CVTDMSR+1                                                03341000
CVTRV634 EQU   CVTDMSRF                                                 03342000
CVTRV633 EQU   CVTDMSRF                                                 03343000
CVTRV632 EQU   CVTDMSRF                                                 03344000
CVTRV631 EQU   CVTDMSRF                                                 03345000
CVTRV630 EQU   CVTDMSRF                                                 03346000
CVTRV629 EQU   CVTDMSRF                                                 03347000
CVTUDUMP EQU   CVTDMSRF                                                 03348000
CVTSDUMP EQU   CVTDMSRF                                                 03349000
CVTQMSGA EQU   CVTQMSG+1                                                03350000
CVTRSV36 EQU   CVTQMSG                                                  03351000
CVTAMFF  EQU   CVTMAP+264                                               03352000
CVTPURGA EQU   CVTPURG+1                                                03353000
CVTRSV35 EQU   CVTPURG                                                  03354000
CVTCBSP  EQU   CVTMAP+256                                               03355000
CVTATERA EQU   CVTATER+1                                                03356000
CVTSYST  EQU   CVTATER                                                  03357000
CVTVOLT2 EQU   CVTTAT                                                   03358000
CVTVOLI2 EQU   CVTVOLF2                                                 03359000
CVTAQAVB EQU   CVTAQAVT+1                                               03360000
CVTRSV34 EQU   CVTTCMFG                                                 03361000
CVTRSV33 EQU   CVTTCMFG                                                 03362000
CVTRSV32 EQU   CVTTCMFG                                                 03363000
CVTRSV31 EQU   CVTTCMFG                                                 03364000
CVTRSV30 EQU   CVTTCMFG                                                 03365000
CVTRSV29 EQU   CVTTCMFG                                                 03366000
CVTRSV28 EQU   CVTTCMFG                                                 03367000
CVTTCRDY EQU   CVTTCMFG                                                 03368000
CVTGTFA  EQU   CVTGTF+1                                                 03369000
CVTRSV27 EQU   CVTGTFST                                                 03370000
CVTRNIO  EQU   CVTGTFST                                                 03371000
CVTUSR   EQU   CVTGTFST                                                 03372000
CVTRV318 EQU   CVTFORM                                                  03373000
CVTRV317 EQU   CVTTMODE                                                 03374000
CVTRV316 EQU   CVTSTATE                                                 03375000
CVTRV315 EQU   CVTGTFS                                                  03376000
CVTGTFAV EQU   CVTGTFS                                                  03377000
CVT0SCR1 EQU   CVTMAP+232                                               03378000
CVTRV515 EQU   CVTMAP+228                                               03379000
CVTRMS   EQU   CVTMAP+224                                               03380000
CVTPATCH EQU   CVTMAP+220                                               03381000
CVTTSCE  EQU   CVTMAP+216                                               03382000
CVTLNKSC EQU   CVTMAP+214                                               03383000
CVTQABST EQU   CVTMAP+212                                               03384000
CVTMDLDS EQU   CVTMAP+208                                               03385000
CVTUSER  EQU   CVTMAP+204                                               03386000
CVTABEND EQU   CVTMAP+200                                               03387000
CVTSMCA  EQU   CVTMAP+196                                               03388000
CVTRSV18 EQU   CVTMAP+192                                               03389000
CVTQLPAQ EQU   CVTMAP+188                                               03390000
CVTQCDSR EQU   CVTMAP+184                                               03391000
CVTRSV17 EQU   CVTOPTB                                                  03392000
CVTRSV16 EQU   CVTOPTB                                                  03393000
CVTFP    EQU   CVTOPTB                                                  03394000
CVTAPTHR EQU   CVTOPTB                                                  03395000
CVTNLOG  EQU   CVTOPTB                                                  03396000
CVTTOD   EQU   CVTOPTB                                                  03397000
CVTCTIMS EQU   CVTOPTB                                                  03398000
CVTPROT  EQU   CVTOPTB                                                  03399000
CVTXPFP  EQU   CVTOPTA                                                  03400000
CVTASCII EQU   CVTOPTA                                                  03401000
CVTRSV13 EQU   CVTOPTA                                                  03402000
CVTRSV12 EQU   CVTOPTA                                                  03403000
CVTNIP   EQU   CVTOPTA                                                  03404000
CVTDDR   EQU   CVTOPTA                                                  03405000
CVTAPR   EQU   CVTOPTA                                                  03406000
CVTCCH   EQU   CVTOPTA                                                  03407000
CVTSNCTR EQU   CVTMAP+180                                               03408000
CVTQMWR  EQU   CVTMAP+176                                               03409000
CVTQOCR  EQU   CVTMAP+172                                               03410000
CVT1EF00 EQU   CVTMAP+168                                               03411000
CVTMZ00  EQU   CVTMAP+164                                               03412000
CVTHEAD  EQU   CVTMAP+160                                               03413000
CVTRSV11 EQU   CVTMAP+156                                               03414000
CVT0PT01 EQU   CVTMAP+152                                               03415000
CVTMSER  EQU   CVTMAP+148                                               03416000
CVTRV516 EQU   CVTIERLC                                                 03417000
CVTILCH  EQU   CVTMAP+140                                               03418000
CVT0DS   EQU   CVTMAP+136                                               03419000
CVTFBOSV EQU   CVTMAP+132                                               03420000
CVTNUCB  EQU   CVTMAP+128                                               03421000
CVTIXAVL EQU   CVTMAP+124                                               03422000
CVTIOQET EQU   CVTMAP+120                                               03423000
CVTDCBA  EQU   CVTMAP+117                                               03424000
CVTMVS2  EQU   CVTDCB                                                   03425000
CVT6DAT  EQU   CVTDCB                                                   03426000
CVT4MPS  EQU   CVTDCB                                                   03427000
CVTRSV09 EQU   CVTDCB                                                   03428000
CVT4MS1  EQU   CVTDCB                                                   03429000
CVT2SPS  EQU   CVTDCB                                                   03430000
CVT1SSS  EQU   CVTDCB                                                   03431000
CVTRSV08 EQU   CVTDCB                                                   03432000
CVTSTB   EQU   CVTMAP+112                                               03433000
CVTQTD00 EQU   CVTMAP+108                                               03434000
CVTQTE00 EQU   CVTMAP+104                                               03435000
CVTCUCB  EQU   CVTMAP+100                                               03436000
CVTSJQ   EQU   CVTMAP+96                                                03437000
CVTPBLDL EQU   CVTMAP+92                                                03438000
CVTTPC   EQU   CVTMAP+88                                                03439000
CVTSVDCB EQU   CVTMAP+84                                                03440000
CVTBRET  EQU   CVTMAP+82                                                03441000
CVTEXIT  EQU   CVTMAP+80                                                03442000
CVT0FN00 EQU   CVTMAP+76                                                03443000
CVTDARA  EQU   CVTDAR+1                                                 03444000
CVTRSV07 EQU   CVTFLGS1                                                 03445000
CVTRSV06 EQU   CVTFLGS1                                                 03446000
CVTRSV05 EQU   CVTFLGS1                                                 03447000
CVTRSV04 EQU   CVTFLGS1                                                 03448000
CVTRSV03 EQU   CVTFLGS1                                                 03449000
CVTRSV02 EQU   CVTFLGS1                                                 03450000
CVTRSV01 EQU   CVTFLGS1                                                 03451000
CVTDMPLK EQU   CVTFLGS1                                                 03452000
CVTXITP  EQU   CVTMAP+68                                                03453000
CVTZDTAB EQU   CVTMAP+64                                                03454000
CVTMSLT  EQU   CVTMAP+60                                                03455000
CVTDATE  EQU   CVTMAP+56                                                03456000
CVTBTERM EQU   CVTMAP+52                                                03457000
CVTSYSAD EQU   CVTMAP+48                                                03458000
CVTXTLER EQU   CVTMAP+44                                                03459000
CVTILK2  EQU   CVTMAP+40                                                03460000
CVTILK1  EQU   CVTMAP+36                                                03461000
CVTPRLTV EQU   CVTMAP+32                                                03462000
CVTPCNVT EQU   CVTMAP+28                                                03463000
CVT0VL00 EQU   CVTMAP+24                                                03464000
CVTXAPG  EQU   CVTMAP+20                                                03465000
CVTBUF   EQU   CVTMAP+16                                                03466000
CVTJOB   EQU   CVTMAP+12                                                03467000
CVTLINK  EQU   CVTMAP+8                                                 03468000
CVT0EF00 EQU   CVTMAP+4                                                 03469000
CVTTCBP  EQU   CVTMAP                                                   03470000
CVT      EQU   CVTMAP                                                   03471000
PVTEND   EQU   PVT+1840                                                 03472000
PVTSPARE EQU   PVT+1838                                                 03473000
PVTCHUIC EQU   PVT+1836                                                 03474000
PVTCOMFX EQU   PVT+1834                                                 03475000
PVTSQAFX EQU   PVT+1832                                                 03476000
PVTCNTFX EQU   PVT+1830                                                 03477000
PVTDEFFX EQU   PVT+1828                                                 03478000
PVTFIXOK EQU   PVT+1826                                                 03479000
PVTPEROK EQU   PVT+1824                                                 03480000
PVTMAXFX EQU   PVT+1822                                                 03481000
PVTPERFX EQU   PVT+1820                                                 03482000
PVTRSRB  EQU   PVT+1776                                                 03483000
PVTRESV5 EQU   PVT+1773                                                 03484000
PVTSRBS  EQU   PVT+1772                                                 03485000
PVTSSRB  EQU   PVT+1768                                                 03486000
PVTACA   EQU   PVTWSAX+1400                                             03487000
PVTSAVE  EQU   PVTWSAX+1328                                             03488000
PVTWSA18 EQU   PVTWSAX+1256                                             03489000
PVTWSA17 EQU   PVTWSAX+1184                                             03490000
PVTWSA16 EQU   PVTWSAX+1112                                             03491000
PVTWSA15 EQU   PVTWSAX+1040                                             03492000
PVTWSA14 EQU   PVTWSAX+968                                              03493000
PVTWSA13 EQU   PVTWSAX+896                                              03494000
PVTWSA12 EQU   PVTWSAX+824                                              03495000
PVTWSA11 EQU   PVTWSAX+752                                              03496000
PVTWSA10 EQU   PVTWSAX+672                                              03497000
PVTWSA9  EQU   PVTWSAX+592                                              03498000
PVTWSA8  EQU   PVTWSAX+504                                              03499000
PVTWSA7  EQU   PVTWSAX+432                                              03500000
PVTWSA6  EQU   PVTWSAX+360                                              03501000
PVTWSA5  EQU   PVTWSAX+288                                              03502000
PVTWSA4  EQU   PVTWSAX+216                                              03503000
PVTWSA3  EQU   PVTWSAX+144                                              03504000
PVTWSA2  EQU   PVTWSAX+72                                               03505000
PVTWSA1  EQU   PVTWSAX                                                  03506000
PVTCIOQL EQU   PVTQS+36                                                 03507000
PVTCIOQF EQU   PVTQS+32                                                 03508000
PVTGFADL EQU   PVTQS+28                                                 03509000
PVTGFADF EQU   PVTQS+24                                                 03510000
PVTFPCBL EQU   PVTQS+20                                                 03511000
PVTFPCBF EQU   PVTQS+16                                                 03512000
PVTSQAQL EQU   PVTQS+14                                                 03513000
PVTSQAQF EQU   PVTQS+12                                                 03514000
PVTCFQL  EQU   PVTQS+10                                                 03515000
PVTCFQF  EQU   PVTQS+8                                                  03516000
PVTRSRVL EQU   PVTQS+6                                                  03517000
PVTRSRVF EQU   PVTQS+4                                                  03518000
PVTAFQL  EQU   PVTQS+2                                                  03519000
PVTAFQF  EQU   PVTQS                                                    03520000
PVTSPFR  EQU   PVT+302                                                  03521000
PVTCFMCT EQU   PVT+300                                                  03522000
PVTSPREC EQU   PVT+296                                                  03523000
PVTCAREC EQU   PVT+292                                                  03524000
PVTCAOUT EQU   PVT+288                                                  03525000
PVTCAIN  EQU   PVT+284                                                  03526000
PVTNSWPS EQU   PVT+280                                                  03527000
PVTNPREC EQU   PVT+276                                                  03528000
PVTSPOUT EQU   PVT+272                                                  03529000
PVTSPIN  EQU   PVT+268                                                  03530000
PVTVAMR  EQU   PVT+264                                                  03531000
PVTVAMO  EQU   PVT+260                                                  03532000
PVTVAMI  EQU   PVT+256                                                  03533000
PVTNPOUT EQU   PVT+252                                                  03534000
PVTNPIN  EQU   PVT+248                                                  03535000
PVTPRSET EQU   PVT+244                                                  03536000
PVTFRSLT EQU   PVT+240                                                  03537000
PVTPAGIO EQU   PVT+236                                                  03538000
PVTSWPIO EQU   PVT+232                                                  03539000
PVTPSWPP EQU   PVT+228                                                  03540000
PVTPPREF EQU   PVT+224                                                  03541000
PVTPOPBR EQU   PVT+220                                                  03542000
PVTPRELF EQU   PVT+216                                                  03543000
PVTPRELV EQU   PVT+212                                                  03544000
PVTPFREE EQU   PVT+208                                                  03545000
PVTPRELS EQU   PVT+204                                                  03546000
PVTPOUT  EQU   PVT+200                                                  03547000
PVTPFXLD EQU   PVT+196                                                  03548000
PVTPITAS EQU   PVT+192                                                  03549000
PVTPSRBP EQU   PVT+188                                                  03550000
PVTPDSEG EQU   PVT+184                                                  03551000
PVTPCSGB EQU   PVT+180                                                  03552000
PVTPINV  EQU   PVT+172                                                  03553000
PVTPSWPC EQU   PVT+168                                                  03554000
PVTPSOUT EQU   PVT+164                                                  03555000
PVTPSWIN EQU   PVT+160                                                  03556000
PVTPRCV  EQU   PVT+156                                                  03557000
PVTPRCFI EQU   PVT+152                                                  03558000
PVTPRCF  EQU   PVT+148                                                  03559000
PVTPVRC  EQU   PVT+144                                                  03560000
PVTPVRIN EQU   PVT+140                                                  03561000
PVTPVRLS EQU   PVT+136                                                  03562000
PVTPVEQR EQU   PVT+132                                                  03563000
PVTPPIOI EQU   PVT+128                                                  03564000
PVTPVRPO EQU   PVT+124                                                  03565000
PVTPRFR  EQU   PVT+120                                                  03566000
PVTPFP2  EQU   PVT+116                                                  03567000
PVTPFP   EQU   PVT+112                                                  03568000
PVTPFTE  EQU   PVT+108                                                  03569000
PVTPCB   EQU   PVT+104                                                  03570000
PVTREP2  EQU   PVT+100                                                  03571000
PVTPIOCP EQU   PVT+96                                                   03572000
PVTPIOP  EQU   PVT+92                                                   03573000
PVTPGFAD EQU   PVT+88                                                   03574000
PVTPGFA  EQU   PVT+84                                                   03575000
PVTPSQA  EQU   PVT+80                                                   03576000
PVTPSINT EQU   PVT+76                                                   03577000
PVTPSIB  EQU   PVT+72                                                   03578000
PVTSRBID EQU   PVT+68                                                   03579000
PVTPCIWA EQU   PVT+64                                                   03580000
PVTHQSA  EQU   PVT+62                                                   03581000
PVTLQSA  EQU   PVT+60                                                   03582000
PVTOROOT EQU   PVT+56                                                   03583000
PVTPRCA  EQU   PVT+52                                                   03584000
PVTREUS  EQU   PVT+48                                                   03585000
PVTRESV4 EQU   PVT+46                                                   03586000
PVTRSUS  EQU   PVT+44                                                   03587000
PVTVROOT EQU   PVT+40                                                   03588000
PVTPCBLO EQU   PVT+38                                                   03589000
PVTPCBCT EQU   PVT+36                                                   03590000
PVTDFRS  EQU   PVT+34                                                   03591000
PVTRSQA  EQU   PVT+32                                                   03592000
PVTPTLB  EQU   PVT+31                                                   03593000
PVTPCBNO EQU   PVT+30                                                   03594000
PVTSRBNO EQU   PVT+29                                                   03595000
PVTSQDC  EQU   PVT+28                                                   03596000
PVTLPFN  EQU   PVT+18                                                   03597000
PVTFPFN  EQU   PVT+16                                                   03598000
PVTPFTP  EQU   PVT+12                                                   03599000
PVTSSPIN EQU   PVT+11                                                   03600000
PVTPCBS  EQU   PVT+10                                                   03601000
PVTPOOL  EQU   PVT+8                                                    03602000
PVTAFCOK EQU   PVT+6                                                    03603000
PVTAFCLO EQU   PVT+4                                                    03604000
PVTAFC   EQU   PVT+2                                                    03605000
PVTFLAG2 EQU   PVT+1                                                    03606000
PVTDUMP  EQU   PVTFLAG1                                                 03607000
PVTSIT   EQU   PVTFLAG1                                                 03608000
PVTLSI   EQU   PVTFLAG1                                                 03609000
PVTRESV1 EQU   PVTFLAG1                                                 03610000
PVTPCBLT EQU   PVTFLAG1                                                 03611000
PVTSRBIU EQU   PVTFLAG1                                                 03612000
PVTBGMS  EQU   PVTFLAG1                                                 03613000
PVTPMSG  EQU   PVTFLAG1                                                 03614000
PQERSVD  EQU   PQESECT+31                                               03615000
@NM00002 EQU   VMMFLGS                                                  03616000
PQEHRID  EQU   PQESECT+29                                               03617000
PQERFLGS EQU   PQESECT+28                                               03618000
PQETCB   EQU   PQESECT+16                                               03619000
PQEBPQE  EQU   PQESECT+12                                               03620000
PQEFPQE  EQU   PQESECT+8                                                03621000
PQEBFBQE EQU   PQESECT+4                                                03622000
FQERSVD  EQU   FQESECT+12                                               03623000
FQAREA   EQU   FQESECT+8                                                03624000
FQEPTRA  EQU   FQEPTR+1                                                 03625000
FQECPB   EQU   FQTYPE                                                   03626000
FQERGNFL EQU   FQTYPE                                                   03627000
DQEHRID  EQU   DQEBLKAD                                                 03628000
DQEPTR   EQU   DQESECT+4                                                03629000
SPQERES2 EQU   SPQESECT+12                                              03630000
SPQEKEY  EQU   SPQESECT+11                                              03631000
SPQEID   EQU   SPQESECT+10                                              03632000
SPQERES1 EQU   SPQESECT+9                                               03633000
SPQEOWN  EQU   SPQEFLGS                                                 03634000
LASTSPQE EQU   SPQEFLGS                                                 03635000
SPSHARE  EQU   SPQEFLGS                                                 03636000
SPQEPTR  EQU   SPQEAD                                                   03637000
SCANN    EQU   SCAN                                                     03638000
@NM00102 EQU   PSA+3668                                                 03639000
PSASTAK  EQU   PSA+3072                                                 03640000
@NM00101 EQU   PSA+1048                                                 03641000
PSAUSEND EQU   PSA+1048                                                 03642000
PSARV062 EQU   PSA+1044                                                 03643000
PSACDAL  EQU   PSA+1040                                                 03644000
PSAWTCOD EQU   PSA+1036                                                 03645000
PSAATCVT EQU   PSA+1032                                                 03646000
PSAPCPSW EQU   PSA+1024                                                 03647000
PSAPIR2  EQU   PSA+1020                                                 03648000
PSARV059 EQU   PSA+1018                                                 03649000
PSASVC13 EQU   PSA+1016                                                 03650000
PSALSFCC EQU   PSA+1012                                                 03651000
PSASFACC EQU   PSA+1008                                                 03652000
PSASTOP  EQU   PSA+992                                                  03653000
PSASTART EQU   PSA+976                                                  03654000
PSARSPSW EQU   PSA+968                                                  03655000
PSASRPSW EQU   PSA+960                                                  03656000
PSARV045 EQU   PSA+892                                                  03657000
PSARV044 EQU   PSA+888                                                  03658000
PSARV043 EQU   PSA+884                                                  03659000
PSARV042 EQU   PSA+880                                                  03660000
PSARV041 EQU   PSA+876                                                  03661000
PSARV040 EQU   PSA+872                                                  03662000
PSARV025 EQU   PSA+868                                                  03663000
PSADSSED EQU   PSA+868                                                  03664000
PSADSSPR EQU   PSA+864                                                  03665000
PSADSSFW EQU   PSA+860                                                  03666000
PSADSS14 EQU   PSA+856                                                  03667000
PSADSSPP EQU   PSA+848                                                  03668000
PSADSSRP EQU   PSA+840                                                  03669000
PSADSS05 EQU   PSADSSF4                                                 03670000
PSADSS10 EQU   PSADSSF4                                                 03671000
PSADSSVE EQU   PSADSSF4                                                 03672000
PSADSSDE EQU   PSADSSF4                                                 03673000
PSADSSC0 EQU   PSADSSF4                                                 03674000
PSADSSIE EQU   PSADSSF4                                                 03675000
PSADSS12 EQU   PSADSSF4                                                 03676000
PSADSSRC EQU   PSADSSF4                                                 03677000
PSARV057 EQU   PSADSSF3                                                 03678000
PSARV056 EQU   PSADSSF3                                                 03679000
PSARV055 EQU   PSADSSF3                                                 03680000
PSADSSMC EQU   PSADSSF3                                                 03681000
PSADSSRW EQU   PSADSSF3                                                 03682000
PSADSSNM EQU   PSADSSF3                                                 03683000
PSADSSES EQU   PSADSSF3                                                 03684000
PSADSSGP EQU   PSADSSF3                                                 03685000
PSADSSF2 EQU   PSADSSFL+1                                               03686000
PSADSSPI EQU   PSADSSF1                                                 03687000
PSADSSOI EQU   PSADSSF1                                                 03688000
PSADSSSP EQU   PSADSSF1                                                 03689000
PSADSSTP EQU   PSADSSF1                                                 03690000
PSADSSDW EQU   PSADSSF1                                                 03691000
PSADSSDD EQU   PSADSSF1                                                 03692000
PSADSSDM EQU   PSADSSF1                                                 03693000
PSADSSMV EQU   PSADSSF1                                                 03694000
PSADSSTS EQU   PSA+816                                                  03695000
PSADSSWK EQU   PSA+812                                                  03696000
PSADSSR3 EQU   PSA+808                                                  03697000
PSADSSR2 EQU   PSA+804                                                  03698000
PSADSSRS EQU   PSA+800                                                  03699000
PSASTOR  EQU   PSA+796                                                  03700000
PSACPUSA EQU   PSA+794                                                  03701000
PSAVSTAP EQU   PSA+792                                                  03702000
PSAWKVAP EQU   PSA+788                                                  03703000
PSAWKRAP EQU   PSA+784                                                  03704000
PSAMCHIC EQU   PSA+783                                                  03705000
PSARV061 EQU   PSA+782                                                  03706000
PSASYMSK EQU   PSA+781                                                  03707000
PSAMCHFL EQU   PSA+780                                                  03708000
PSACR0   EQU   PSA+776                                                  03709000
PSAPSWSV EQU   PSA+768                                                  03710000
PSALITA  EQU   PSA+764                                                  03711000
PSACLHS  EQU   PSAHLHI                                                  03712000
PSALKR15 EQU   PSALKSA+60                                               03713000
PSALKR14 EQU   PSALKSA+56                                               03714000
PSALKR13 EQU   PSALKSA+52                                               03715000
PSALKR12 EQU   PSALKSA+48                                               03716000
PSALKR11 EQU   PSALKSA+44                                               03717000
PSALKR10 EQU   PSALKSA+40                                               03718000
PSALKR9  EQU   PSALKSA+36                                               03719000
PSALKR8  EQU   PSALKSA+32                                               03720000
PSALKR7  EQU   PSALKSA+28                                               03721000
PSALKR6  EQU   PSALKSA+24                                               03722000
PSALKR5  EQU   PSALKSA+20                                               03723000
PSALKR4  EQU   PSALKSA+16                                               03724000
PSALKR3  EQU   PSALKSA+12                                               03725000
PSALKR2  EQU   PSALKSA+8                                                03726000
PSALKR1  EQU   PSALKSA+4                                                03727000
PSALKR0  EQU   PSALKSA                                                  03728000
PSARV023 EQU   PSACLHT+52                                               03729000
PSALOCAL EQU   PSACLHT+48                                               03730000
PSACMSL  EQU   PSACLHT+44                                               03731000
PSAOPTL  EQU   PSACLHT+40                                               03732000
PSATPACL EQU   PSACLHT+36                                               03733000
PSATPDNL EQU   PSACLHT+32                                               03734000
PSATPNCL EQU   PSACLHT+28                                               03735000
PSAIOSLL EQU   PSACLHT+24                                               03736000
PSAIOSUL EQU   PSACLHT+20                                               03737000
PSAIOSCL EQU   PSACLHT+16                                               03738000
PSAIOSSL EQU   PSACLHT+12                                               03739000
PSASALCL EQU   PSACLHT+8                                                03740000
PSAASML  EQU   PSACLHT+4                                                03741000
PSADISPL EQU   PSACLHT                                                  03742000
PSASRSA  EQU   PSA+636                                                  03743000
PSARV050 EQU   PSA+634                                                  03744000
PSADSSGO EQU   PSA+633                                                  03745000
PSARECUR EQU   PSA+632                                                  03746000
PSAHLHIS EQU   PSA+628                                                  03747000
PSAIPCSA EQU   PSA+624                                                  03748000
@NM00100 EQU   PSA+621                                                  03749000
PSAIPCDM EQU   PSA+620                                                  03750000
PSAIPCD  EQU   PSA+616                                                  03751000
@NM00099 EQU   PSA+613                                                  03752000
PSAIPCRM EQU   PSA+612                                                  03753000
PSAIPCR  EQU   PSA+608                                                  03754000
PSAMCHEX EQU   PSA+600                                                  03755000
PSAMPSW  EQU   PSA+592                                                  03756000
PSAEXPS2 EQU   PSA+584                                                  03757000
PSAEXPS1 EQU   PSA+576                                                  03758000
PSAPIREG EQU   PSA+572                                                  03759000
PSARSREG EQU   PSA+568                                                  03760000
PSAGPREG EQU   PSA+556                                                  03761000
PSARV022 EQU   PSASUP4                                                  03762000
PSARV021 EQU   PSASUP4                                                  03763000
PSARV020 EQU   PSASUP4                                                  03764000
PSARV019 EQU   PSASUP4                                                  03765000
PSARV018 EQU   PSASUP4                                                  03766000
PSARV017 EQU   PSASUP4                                                  03767000
PSARV016 EQU   PSASUP4                                                  03768000
PSARV015 EQU   PSASUP4                                                  03769000
PSARV014 EQU   PSASUP3                                                  03770000
PSARV013 EQU   PSASUP3                                                  03771000
PSARV012 EQU   PSASUP3                                                  03772000
PSAESTA  EQU   PSASUP3                                                  03773000
PSASPR   EQU   PSASUP3                                                  03774000
PSAPSREG EQU   PSASUP3                                                  03775000
PSAPI2   EQU   PSASUP3                                                  03776000
PSAIOSUP EQU   PSASUP3                                                  03777000
PSALCR   EQU   PSASUP2                                                  03778000
PSARTM   EQU   PSASUP2                                                  03779000
PSAACR   EQU   PSASUP2                                                  03780000
PSAIPCE2 EQU   PSASUP2                                                  03781000
PSAIPCES EQU   PSASUP2                                                  03782000
PSAIPCEC EQU   PSASUP2                                                  03783000
PSAGTF   EQU   PSASUP2                                                  03784000
PSAIPCRI EQU   PSASUP2                                                  03785000
PSATYPE6 EQU   PSASUP1                                                  03786000
PSATCTL  EQU   PSASUP1                                                  03787000
PSADISP  EQU   PSASUP1                                                  03788000
PSALOCK  EQU   PSASUP1                                                  03789000
PSAPI    EQU   PSASUP1                                                  03790000
PSAEXT   EQU   PSASUP1                                                  03791000
PSASVC   EQU   PSASUP1                                                  03792000
PSAIO    EQU   PSASUP1                                                  03793000
PSAANEW  EQU   PSA+544                                                  03794000
PSATOLD  EQU   PSA+540                                                  03795000
PSATNEW  EQU   PSA+536                                                  03796000
PSALCCAR EQU   PSA+532                                                  03797000
PSALCCAV EQU   PSA+528                                                  03798000
PSAPCCAR EQU   PSA+524                                                  03799000
PSAPCCAV EQU   PSA+520                                                  03800000
PSACPULA EQU   PSA+518                                                  03801000
PSACPUPA EQU   PSA+516                                                  03802000
PSAPSA   EQU   PSA+512                                                  03803000
FLCHDEND EQU   PSA+512                                                  03804000
FLCCRSAV EQU   FLCMCLA+280                                              03805000
FLCGRSAV EQU   FLCMCLA+216                                              03806000
FLCFPSAV EQU   FLCMCLA+184                                              03807000
FLCFLA   EQU   FLCMCLA+88                                               03808000
FLCRGNCD EQU   FLCMCLA+84                                               03809000
FLCFSAA  EQU   FLCFSA+1                                                 03810000
@NM00098 EQU   FLCFSA                                                   03811000
@NM00097 EQU   FLCMCLA+72                                               03812000
FLCMCIC  EQU   FLCMCLA+64                                               03813000
@NM00096 EQU   FLCMCLA+20                                               03814000
FLCIOAA  EQU   FLCIOA+1                                                 03815000
@NM00095 EQU   FLCIOA                                                   03816000
@NM00094 EQU   FLCMCLA+15                                               03817000
@NM00093 EQU   FLCMCLA+14                                               03818000
@NM00092 EQU   FLCMCLA+12                                               03819000
FLCLCL   EQU   FLCMCLA+8                                                03820000
FLCIOELA EQU   FLCIOEL+1                                                03821000
@NM00091 EQU   FLCIOEL                                                  03822000
FLCCHNID EQU   FLCMCLA                                                  03823000
@NM00090 EQU   PSA+160                                                  03824000
FLCMTRCD EQU   PSA+157                                                  03825000
@NM00089 EQU   PSA+156                                                  03826000
FLCPERA  EQU   FLCPER+1                                                 03827000
@NM00088 EQU   FLCPER                                                   03828000
@NM00087 EQU   PSA+151                                                  03829000
FLCPERCD EQU   PSA+150                                                  03830000
FLCMCNUM EQU   PSA+149                                                  03831000
@NM00086 EQU   PSA+148                                                  03832000
FLCTEAA  EQU   FLCTEA+1                                                 03833000
@NM00085 EQU   FLCTEA                                                   03834000
PSAPIPC  EQU   PSAPICOD                                                 03835000
PSAPIMC  EQU   PSAPICOD                                                 03836000
PSAPIPER EQU   PSAPICOD                                                 03837000
PSARV049 EQU   FLCPICOD                                                 03838000
FLCPILCB EQU   FLCPIILC                                                 03839000
@NM00084 EQU   FLCPIILC                                                 03840000
@NM00083 EQU   PSAEPPSW                                                 03841000
FLCSVCN  EQU   PSAESPSW+2                                               03842000
FLCSILCB EQU   FLCSVILC                                                 03843000
@NM00082 EQU   FLCSVILC                                                 03844000
@NM00081 EQU   PSAESPSW                                                 03845000
FLCEICOD EQU   PSAEEPSW+2                                               03846000
PSASPAD  EQU   PSAEEPSW                                                 03847000
@NM00080 EQU   PSA+128                                                  03848000
FLCINPSW EQU   PSA+120                                                  03849000
FLCMNPSW EQU   PSA+112                                                  03850000
FLCPNPSW EQU   PSA+104                                                  03851000
FLCSNPSW EQU   PSA+96                                                   03852000
FLCENPSW EQU   PSA+88                                                   03853000
FLCTRACE EQU   PSA+84                                                   03854000
FLCTIMER EQU   PSA+80                                                   03855000
FLCCVT2  EQU   PSA+76                                                   03856000
FLCCAW   EQU   PSA+72                                                   03857000
FLCCSW   EQU   PSA+64                                                   03858000
FLCIOPSW EQU   PSA+56                                                   03859000
FLCMOPSW EQU   PSA+48                                                   03860000
FLCPOPSW EQU   PSA+40                                                   03861000
FLCSOPSW EQU   PSA+32                                                   03862000
FLCEOPSW EQU   PSA+24                                                   03863000
@NM00079 EQU   FLCICCW2+4                                               03864000
FLCCVT   EQU   FLCICCW2                                                 03865000
FLCICCW1 EQU   FLCROPSW                                                 03866000
FLCIPPSW EQU   FLCRNPSW                                                 03867000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03868000
@RC00157 EQU   NP8SQOK                                                  03869000
@RT00166 EQU   NP8SQOK                                                  03870000
@RF00166 EQU   NP8SQINV                                                 03871000
@RT00172 EQU   NP8SQAEX                                                 03872000
@RT00176 EQU   NP8NSQAP                                                 03873000
@RT00233 EQU   FREIT                                                    03874000
@RT00308 EQU   NP8SQINV                                                 03875000
@RT00313 EQU   NP8SQOK                                                  03876000
@RF00313 EQU   NP8SQINV                                                 03877000
@RT00328 EQU   NP8CSAOK                                                 03878000
@RF00328 EQU   NP8CSINV                                                 03879000
@RT00336 EQU   W                                                        03880000
@RT00351 EQU   NC                                                       03881000
@RT00407 EQU   NP8CSINV                                                 03882000
@RT00412 EQU   NP8CSAOK                                                 03883000
@RF00412 EQU   NP8CSINV                                                 03884000
@RT00428 EQU   NP8VROK                                                  03885000
@RF00428 EQU   NP8VRINV                                                 03886000
@RT00438 EQU   NP8RLOK                                                  03887000
@RF00438 EQU   NP8RLINV                                                 03888000
@RT00494 EQU   NP8RLINV                                                 03889000
@RT00499 EQU   NP8RLOK                                                  03890000
@RF00499 EQU   NP8RLINV                                                 03891000
@RT00547 EQU   NP8VRINV                                                 03892000
@RT00552 EQU   NP8VROK                                                  03893000
@RF00552 EQU   NP8VRINV                                                 03894000
@RT00561 EQU   NPXVNUMB                                                 03895000
@RT00563 EQU   NPXVNUMB                                                 03896000
@RT00565 EQU   NPXVNUMB                                                 03897000
@RT00567 EQU   NPXVNUMB                                                 03898000
@RT00571 EQU   NPXVNINV                                                 03899000
@RT00579 EQU   NPXVNINV                                                 03900000
@ENDDATA EQU   *                                                        03901000
         END   IEAVNP08,(C'PLS0836',0701,76086)                         03902000
./  ADD  SSI=63410238,NAME=IEAVPRT0
  TITLE 'GETPART/FREEPART ROUTINE FOR OS/VS2 REL 3.7 WITH SU7'          00020040
* /* START OF SPECIFICATIONS ****                                       01158302
*                                                                       01160302
*01*  MODULE-NAME = IEAVPRT0                                            01160702
*                                                                       01161702
*02*     CSECT-NAME = IEAVPRT0                                          01162102
*                                                                       01162302
*01*  DESCRIPTIVE-NAME = GETPART/FREEPART ROUTINE                       01162402
*                                                                       01163202
*01*  COPYRIGHT = NONE                                                  01163602
*                                                                       01164002
*01*  STATUS = OS/VS2 RELEASE 3.7 WITH SU7                              01164240
*              PTF LEVEL UZ07644                                        01164540
*                                                                       01165602
*01*  FUNCTION = ROUTINE TO GET OR FREE A REGION                        01166002
*                                                                       01166502
*02*     OPERATION = FOR A GETPART REQUEST, NECESSARY CONTROL BLOCKS    01166602
*         DEFINING THE EXISTENCE OF A USER REGION WITHIN THE PRIVATE    01167002
*         AREA ARE CREATED AND INITIALIZED AND CONTROL IS RETURNED      01167202
*         TO THE INITIATOR. FOR FREEPART REQUESTS, REGION SPACE         01167402
*         AND CONTROL BLOCKS ARE FREED, AND ANY WAITING REQUESTS        01167602
*         WHICH MAY NOW BE HONORED ARE POST'ED. RECOVERY CONSISTS       01167802
*         OF ISOLATING THE ERROR, PROVIDING AS MUCH STORAGE             01168002
*         CLEAN-UP AS POSSIBLE, AND RETRYING THE REQUEST OR             01168202
*         TERMINATING THE REQUESTOR.                                    01168402
*                                                                       01169102
*01*   NOTES = NONE                                                     01169402
*                                                                       01171002
*02*     DEPENDENCIES = LOCAL LOCK MUST BE HELD UPON ENTRY; SALLOC MUST 01171402
*         BE AVAILABLE                                                  01171802
*                                                                       01172602
*03*        CHARACTER-CODE-DEPENDENCIES = EBCDIC IS USED, BUT THERE     01173002
*            APPEAR TO BE NO PROBLEMS WHICH COULD NOT BE SOLVED WITH A  01173402
*            REASSEMBLY                                                 01173802
*                                                                       01174302
*02*     RESTRICTIONS = NONE                                            01174702
*                                                                       01175102
*02*     REGISTER-CONVENTIONS = REFER TO END OF MODULE IEAVPRT0 FOR     01175702
*         REGISTER EQUATES                                              01176102
*                                                                       01176702
*02*     PATCH-LABEL = USE NUCLEUS PATCH AREA                           01176802
*                                                                       01177102
*01*  MODULE-TYPE = PROCEDURE                                           01178902
*                                                                       01179702
*02*     PROCESSOR = ASSEMBLER                                          01180103
*                                                                       01181802
*02*     MODULE-SIZE = 4300 BYTES                                       01182202
*                                                                       01182502
*02*     ATTRIBUTES = NUCLEUS,ZERO PROTECT KEY,REENTERABLE,REFRESHABLE, 01182902
*         SUPERVISOR MODE                                               01183702
*                                                                       01184302
*01*  ENTRY-POINT = IEAVPRT0  (SEE FOLLOWING COMMENTARY)                01184702
*                                                                       01185602
*01*  ENTRY-POINT = IEALIMIT                                            01188902
*                                                                       01190902
*02*     PURPOSE = TO ALLOW THE USER TO INCLUDE A USER EXIT ROUTINE TO  01199102
*         LIMIT AS REQUIRED THE SIZE OF ANY OR ALL REGION REQUESTS      01201102
*         THE IBM SUPPLIED ROUTINE ADDS 64K TO THE REGION REQUESTED     01203103
*         AND SETS THIS AS A LIMIT ON ALL GETMAINS FROM SUBPOOL         01206103
*         0-127, 251, AND 252.                                          01209703
*                                                                       01209903
*02*     LINKAGE = BALR FROM IEAVPRT0                                   01210102
*                                                                       01210902
*02*     INPUT = REGISTER 1: NUMBER OF BYTES REQUESTED                  01217902
*                REGISTER 13: ADDRESS OF STANDARD SAVE AREA             01224902
*                REGISTER 14: RETURN ADDRESS                            01231902
*                REGISTER 15: ENTRY POINT ADDRESS                       01238902
*                                                                       01245902
*02*     OUTPUT = REGISTER 1 CONTAINS THE NUMBER OF BYTES TO WHICH THE  01252902
*         REGION REQUESTED IS TO BE LIMITED, OR ZERO IF NO LIMIT IS     01259902
*         PROVIDED.                                                     01266902
*                                                                       01273902
*01*  EXIT-NORMAL = USER EXIT RETURNS TO IEAVPRT0                       01280902
*                                                                       01287902
*02*     CONDITIONS = BR 14 BACK TO IEAVPRT0, WITH LOCAL LOCK STILL     01294902
*        HELD                                                           01301902
*                                                                       01308902
*02*     OUTPUT = REGISTER 1 CONTAINS THE LIMIT SIZE FOR THE REQUEST,   01315902
*         OR ZERO IF NO LIMIT                                           01322902
*                                                                       01329902
*02*     RETURN-CODES = NONE                                            01336902
*                                                                       01343902
*01*  EXIT-ERROR = NONE                                                 01350902
*                                                                       01357902
*01*  EXTERNAL-REFERENCES = SEE FOLLOWING COMMENTARY                    01364902
*                                                                       01371902
*02*     ROUTINES = SAME AS ABOVE                                       01378902
*                                                                       01385902
*02*     DATA-AREAS = SAME AS ABOVE                                     01392902
*                                                                       01399902
*02*     CONTROL-BLOCKS = SEE FOLLOWING COMMENTARY                      01406902
*                                                                       01413902
*01*  TABLES = SEE FOLLOWING COMMENTARY                                 01420902
*                                                                       01441902
*01*  MACROS = GETMAIN, FREEMAIN, SETLOCK, SETFRR, CALLRTM              01448902
*                                                                       01455902
*02*    SERIALIZATION = THE LOCAL LOCK IS HELD AT ENTRY TO IEAVPRT0;    01462902
*       THE SALLOC LOCK IS OBTAINED AND RELEASED BY IEAVPRT0.           01469902
*                                                                       01476902
*01*  CHANGE-ACTIVITY =                                                 01483902
*                        PTMS: VS00464,VS00845,VS00850,VS00856,VS00857, 01490902
*                        VS00885,VS01903,VS01960,VS03454,VS05423,       01500902
*                        VS07262, VS07625                               01508902
*                                                                       01517602
*        APARS = OZ02596   463585                                       01617603
*                OZ05651   156300, 180100, 186950, 187220, 187240,      01627640
*                          187400, 187900-188100, 191260-191500,        01637640
*                          194100, 197700, 197800                       01667640
*                OZ05954   412234, 412245-412249, 412254                01677640
*                OZ08170   312900, 313400, 371200-372500,               01697640
*                          372800-373200                                01702640
*                OZ10088   187410, 187930, 187960, 197650               01707640
*                OZ15799   290600, 290700                               01712640
*                                                                       01717603
*01*  MESSAGES = NONE                                                   01817602
*                                                                       02117602
*01*  ABEND-CODES = 082,A0A                                             02417602
*                                                                       02717602
**** END OF SPECIFICATIONS ***/                                         03017602
         EJECT                                                          03570001
*********************************************************************** 03640001
* STATUS                                                              * 03710001
*    CHANGE LEVEL 000                                                 * 03780001
* FUNCTION                                                            * 03850001
*    THIS SUBCOMPONENT OF VIRTUAL STORAGE MANAGEMENT PERFORMS THE     * 03920001
*    FUNCTION OF ALLOCATING AND FREEING REGION SPACE AT THE REQUEST OF* 03990001
*    THE SYSTEM. THE FOLLOWING TYPES OF GETPART ARE SUPPORTED. 1) REG-* 04060001
*    ISTER FORM GETMAIN REQUEST(SVC 10,120). 2) ECB MODE GETPART REQST* 04130002
*    (SVC 4) WHICH CAN BE A SINGLE REGION LIST REQUEST OR A SPLIT RE- * 04200001
*    GION LIST REQUEST OF TWO ELEMENTS. THE ONE TYPE OF FREEPART WHICH* 04270001
*    IS SUPPORTED IS REGISTER FORM FREEMAIN (SVC 10,120).             * 04340002
* ENTRY POINTS                                                        * 04410001
*         IEAVPRT0                                                    * 04480001
*    THIS IS THE MAIN ENTRY POINT. A REQUEST TO OBTAIN SPACE FOR A RE-* 04550001
*    GION IS INITIATED BY THE SYSTEM VIA A GETMAIN(SVC 4 ) FOR SPACE  * 04620002
*    FROM SUBPOOL 242(V=R REGION) OR GETMAIN(SVC4,10,120) FOR         * 04740002
*    SUBPOOL 247(V=V REGION).                                         * 04750002
*    FREEPART IS INVOKED THROUGH THE ISSUANCE OF A SVC 10 OR 120 FOR  * 04760002
*    SUBPOOL 242 OR 247 TO REQUEST THE FREEING OF A V=R OR V=V REGION * 04830001
*    RESPECTIVELY.                                                    * 04900002
* INPUT                                                               * 05040001
*    IF THE REQUEST IS FROM GETMAIN AND IS AN SVC 4, REGISTER 1 CON-  * 05110001
*    TAINS THE ADDRESS OF THE GETMAIN PARAMETER LIST.  THE FORMAT OF  * 05180003
*    THE FIRST 2 1/2 WORDS OF THE GETPART PARAMETER LIST IS THE       * 05200003
*    SAME AS THE GETMAIN SVC 4 PARAMETER LIST.  IF THE REQUEST          05220003
*    IS FROM GETMAIN AND IS AN SVC 10, REGISTER 0 CONTAINS REGION SIZE* 05250002
*    AND REGISTER 1 IS ZERO SIGNIFYING A GETPART REQUEST. REGISTER 4  * 05460002
*    CONTAINS LDA ADDRESS AND REGISTER 5 CONTAINS SPID IN LOW BYTE.IF * 05510002
*    REQUEST IS FROM FREEMAIN, REGISTER 1 IS POSITIVE INDICATING A    * 05530002
*    FREEPART REQUEST. REGISTER 4 MUST CONTAIN THE ADDRESS OF THE LDA,* 05670002
*    REGISTER 5 CONTAINS THE SUBPOOL ID IN THE LOW-ORDER BYTE. REGS 8 * 05740002
*    AND 13 ARE THE GETMAIN BASE REGISTERS.                           * 05790002
* OUTPUT                                                              * 05950001
*    IF THE EXIT IS NORMAL, REGISTER 15 CONTAINS ONE OF THE FOLLOWING * 06020001
*    RETURN CODES. 0-THE REGION WAS SUCCESSFULLY ALLOCATED. 4-SUFFI-  * 06090001
*    CIENT VIRTUAL SPACE WAS NOT AVAILABLE TO BACK THE V=R REQUEST.  *  06160002
*     8-INVALID REQUEST. 12-A SUFFICIENT NUMBER OF CONTIGUOUS REAL    * 06230002
*    PAGES ARE NOT AVAILABLE TO IMMEDIATLEY SATISFY THE V=R REGION    * 06300002
*    REQUEST. 16-THE AVAILABLE ALLOCATABLE V=R AREA HAS BEEN          * 06350002
*    DECREASED SUCH THAT THE V=R REQUEST CANNOT BE HONORED.           * 06360002
*    20-PRIVATE AREA IS FRAGMENTED WITH SYSTEM SPACE SO THAT          * 06362002
*    THE REGION REQUEST CANNOT BE HONORED.24-V=R REGION SIZE REQUESTED* 06364002
*    IS GREATER THAN THE INSTALLATION IMPOSED LIMIT FROM IEALIMIT     * 06464002
*    ROUTINE.                                                         * 06564002
* EXTERNAL REFERENCES                                                 * 06720001
*    THE FOLLOWING INTERFACES ARE DEFINED FOR GETPART-                * 06790001
*         RSM'S ALLOCATE V=R REGION - IEAVEQR                         * 07350002
*    TO ALLOCATE AND FIX CONTIGUOUS PAGES IN REAL MEMORY WHICH DES-   * 07420001
*    CRIBE THE VIRTUAL EXTENTS OF THE REGION ON A 1:1 VIRTUAL TO REAL * 07490001
*    BASIS.                                                           * 07560001
*         GETMAING                                                    * 07630002
*    TO ALLOCATE SPACE IN LSQA FOR VSM CONTROL BLOCKS.                * 07700001
*         CBBRANCH                                                    * 07780003
*    TO ALLOCATE/FREE CELLS IN LSQA/SQA FOR VSM INTERNAL CONTROL      * 07870003
*    BLOCKS.                                                          * 07960003
*         XMPOST ROUTINE                                              * 08050002
*    TO POST EACH ECB BEING WAITED UPON BY AN INITIATOR DUE TO A 'WAIT* 08120002
*    FOR REGION' CONDITION.                                           * 08170002
*                                                                     * 08220002
*    THE FOLLOWING INTERFACES ARE DEFINED FOR FREEPART:               * 08270002
*                                                                     * 08320002
*         MRELEASF                                                    * 08680002
*    TO RETURN THE REGION SPACE TO THE QUEUE OF FREE BLOCKS FOR DYNAM-* 08750001
*    IC VIRTUAL SPACE.                                                * 08820001
*         RMBRANCH                                                    * 09380001
*    TO FREE SPACE IN LSQA ALLOCATED TO VSM CONTROL BLOCKS.           * 09450001
*         RSM'S FREE V=R REGION - IEAVEQRF                            * 09500002
*    TO FREE PAGES THAT ARE ALLOCATED TO A V=R REGION.                * 09550002
*         XMPOST ROUTINE                                              * 09730002
*    TO POST EACH ECB BEING WAITED UPON BY AN INITIATOR DUE TO A 'WAIT* 09800002
*    FOR REGION' CONDITION.                                           * 09820002
*         RTM                                                           09854002
*    TO RTM VIA CALLRTM FOR A MEMORY TERMINATION WHEN A SITUATION IS  * 09858002
*    DETECTED WHICH MIGHT CAUSE FREEPART TO PUT DEFERRED RELEASE PAGES* 09862002
*    BACK INTO A FBQE.                                                * 09866002
*         IEALIMIT USER EXIT ROUTINE                                  * 09870002
*    TO ALLOW THE USER TO LIMIT IF DESIRED THE SIZE OF ANY OR ALL     * 09890002
*    REGION REQUESTS                                                    09910002
*    THE FOLLOWING CONTROL BLOCKS ARE REFERENCED: CVT, GDA, LDA, DPQE,* 09940002
*    PQE, FBQE, TCT, VRWPQEL, PVT, AND TCB.                           * 10010002
* EXITS,NORMAL                                                        * 10080001
*    EITHER TO TYPE 1 SVC EXIT OR TO BRANCH ENTRY CALLER VIA A BR 14  * 10150002
* EXITS,ERROR                                                         * 10220001
*    NONE                                                             * 10290002
* TABLES AND WORK AREAS                                               * 10500001
*    THIS ROUTINE REFERENCES THE GETPART WORK TABLE. THE FORMAT OF    * 10570001
*    THIS TABLE IS AS FOLLOWS.                                        * 10640001
*        *****************************************                    * 10710001
*        *                                       *                    * 10780001
*   0    *          REGION SIZE POINTER          *                    * 10850001
*        *                                       *                    * 10920001
*        *****************************************                    * 10990001
*        *                                       *                    * 11060001
*   4    *          REGION ADDRESS POINTER       *                    * 11130001
*        *                                       *                    * 11200001
*        *****************************************                    * 11270001
*        * REQUEST * SUBPOOL *                   *                    * 11340001
*   8    *         *         * RESERVED          *                    * 11410001
*        *  CODE   *   ID    *                   *                    * 11480001
*        *****************************************                    * 11550001
*        *         *                             *                    * 11620001
*   12   * H0 CODE *REGION ADDR REQUEST (OR 0)   *                    * 11690001
*        *         *                             *                    * 11760001
*        *****************************************                    * 11830001
*        *         *                             *                    * 11900001
*   16   *    0    *            0                *                    * 11970002
*        *         *                             *                    * 12040001
*        *****************************************                    * 12110001
*        * END OF  *                             *                    * 12180001
*   20   *LIST CODE*H0 REGION SIZE REQUEST       *                    * 12250001
*        *  OR 0   *                             *                    * 12320001
*        *****************************************                    * 12390001
*        * END OF  *                             *                    * 12460001
*   24   *  LIST   *H1 REGION SIZE REQUEST       *                    * 12530002
*        *  CODE   *                             *                    * 12600001
*        *****************************************                    * 12670001
*    the cfapWKAR WORKAREA IN THE LDA IS USED TO PROVIDE REENTRANCY.  * 12720002
*    see workaREA DSECT FOR A MAPPING OF THIS AREA.                   * 12730002
* ATTRIBUTES                                                          * 12740001
*    REENTRANT, REFRESHABLE                                           * 12810002
* CHARACTER CODE DEPENDENCY                                           * 12880001
*    EBCDIC IS USED, BUT THERE APPEAR TO BE NO PROBLEMS WHICH COULD   * 12950001
*    NOT BE SOLVED WITH A REASSEMBLY.                                 * 13020001
* NOTES                                                               * 13090001
*    NONE                                                             * 13160001
*********************************************************************** 13230002
         EJECT                                                          13300002
*/*IEAVPRT0: CHART (AMODE)*/                                            13350002
*/* HEADER                                                              13360002
*/*IEAVPRT0    MAY, 1972                                                13362002
*/*                                                      PAGE #     */  13364002
*/*START: E BRANCH ENTRY FROM GETMAIN*/                                 13366002
*/* P SAVE REGS,                                                        13368002
*/*   SAVE GM BASE*/                                                    13368402
*/* P SET FRR */                                                        13368502
*/*P INITIALIZE FRR PARM AREA */                                        13368602
*/* P INIT GP INTERNAL SWITCHES                                         13368802
*/*   (GPSW=0)*/                                                        13369202
*/* D (NO,,YES,%VR) V=R REQUEST?*/                                      13369602
*/* P GET @ AS PQE FROM LDA*/                                           13369702
*/*%SVCBYT: P GET @ OF SVCBYT IN IEAVGM00*/                             13369802
*/* D (NO,,YES,SVC4) SVC 4?*/                                           13369902
*/* D (NO,REGPART,YES,FREEPART) FREEPART?                               13373202
*/*                     (REG1 > 0)*/                                    13375202
*/*%VR: P GET @ V=R PQE FROM GDA                                        13375602
*/*       (VRPQEP)*/                                                    13376002
*/* P (,%SVCBYT) SET V=R REQUEST FLAG                                   13376402
*/*   X'02' IN GPSW*/                                                   13376502
*/*FREEPART: D (YES,,NO,%REG1) IS V=R REGION FREEPARTING*/              13376602
*/* P OBTAIN SALLOC LOCK*/                                              13387402
*/* D (NO,,YES,%DEQW) IS ITS EL ON VRWAITQ?*/                           13397402
*/* D (YES,,NO,%REG2) IS ITS EL ON VRPOSTQ?*/                           13397802
*/*%DEQ: P DEQUEUE EL FROM Q AND FREE IT*/                              13398202
*/*%REG2: P RELEASE SALLOC LOCK*/                                       13398302
*/* D (NO,,YES,6F4) TCB HAS A REGION?*/                                 13401902
*/* P (,8A2) RC=0 IN REG 15*/                                           13403902
*/*%DEQW: P DEQUEUE EL FROM Q AND FREE IT*/                             13404302
*/* D (NO,,YES,%REG2) ANY MORE SPEC REQUESTS ON Q? */                   13404702
*/* P (,%REG2) TURN OFF WAITQUE BIT */                                  13405102
*/*%REG1: D (NO,,YES,6F4) TCB HAS A REGION*/                            13405502
*/* P (,RETURN) RC=0 IN REG 15*/                                        13409102
*/*6F4: P ACCESS TCBMSS FIELD*/                                         13411102
*/*%G4: D (YES,,NO,A27) ANY MORE SPQE'S REMAIN?*/                       13411502
*/* P GET @ OF DQE FROM SPQE (SPDQEAD)*/                                13411902
*/* D (NO,,YES,%X01) SPQEAD=0 ?*/                                       13412703
*/* P SUBPOOL FM TO FREE REMAINING SPACE*/                              13413703
*/*%X01: P FREEMAIN SPQE (CELL RETURNED TO LSQA)*/                      13415203
*/* P (,%G4) GET ADDRESS OF NEXT SPQE*/                                 13424103
*/*A27: D (YES,,NO,%H27) V=R REGION?*/                                  13434902
*/* P SET UP INTERFACE TO FREE REGION SPACE*/                           13435302
*/* P OBTAIN SALLOC LOCK*/                                              13435702
*/* S MRELEASE:RETURN REG SPACE TO FREE V=R AREA*/                      13439502
*/* P SET UP PARM LIST TO FREE V=R REGION*/                             13441502
*/* S IEAVEQRR:FREE REAL PAGES*/                                        13441902
*/* P RELEASE SALLOC LOCK */                                            13442302
*/* P ACCESS A.S. PQE PTR */                                            13442702
*/* S MRELEASE: ADD REGION SPACE TO FREE A.S. SPACE*/                   13443102
*/* P RESTORE V=R PQE PTR */                                            13443202
*/* P FREEMAIN FBQE (CELL RETURNED TO LSQA)*/                           13444203
*/* S RMBRANCH: FREE PQE,DPQE FROM LSQA*/                               13444603
*/*%H27: P SET TCBPQE=0 IN TCB*/                                        13447102
*/* P SET TCBRV=0*/                                                     13449102
*/* P SET VVREGSZ IN LDA = 0*/                                          13449502
*/* D (NO,,YES,8A2) V=R REQUEST FLAG SET?*/                             13449902
*/*  D (NO,,YES,%B5) IS THIS SYSTEM REGION? */                          13450103
*/*  D  (YES,,NO,MEMTERM)  CURRGNTP = PQEREGN? */                       13450703
*/* P ENSURE PQEREGN = P.A. START @ + SYS. REG. SIZE*/                  13450803
*/* P ENSURE PQE SIZE = P.A. SIZE - SYS. REG. SIZE*/                    13451803
*/* P FIRST FBQE @ - P.A.START = DIFFERENCE*/                           13452803
*/* P FIRST FBQE SIZE = SIZE + DIFFERENCE - SYS. REG. SIZE*/            13454703
*/* P FIRST FBQE ADDRESS = P.A.START + SYS. REG. SIZE*/                 13456703
*/*   P READJUST CURRGNTP IN LDA*/                                      13457903
*/*%B5: P (,RETURN) PLACE RC=0 IN REG 15*/                              13458303
*/*MEMTERM:  P (,%B5) MEMTERM CURRENT ASID - A0A */                     13459303
*/*8A2: P OBTAIN SALLOC LOCK*/                                          13460303
*/* D (YES,,NO,%B38) IS WAITQUE BIT ON?*/                               13461303
*/* P SET POSTCHK FLAG*/                                                13462303
*/*%D28: N (,%J210) BRANCH TO SEE IF FIRST OR NEXT REQUEST CAN BE       13463303
*/*HONORED*/                                                            13464303
*/*%B38: D (YES,,NO,%C38) ANY ELS ON VRWAITQ?*/                         13465303
*/* P RETRIEVE FIRST NON-SPEC REQUEST*/                                 13468702
*/* P BUILD TABLE OF LENGTHS AVAILABLE IN V=R FBQE'S*/                  13478702
*/*%D48: D (YES,,NO,%J48) IS REQUESTED SIZE <=_ ANY FBQE SIZE?*/       13479102
*/* P SUBTRACT REQUESTED SIZE FROM FBQE SIZE IN TABLE*/                 13482502
*/* P DEQUEUE EL FROM VRWAITQ*/                                         13484502
*/* S XMPOST:POST THE REQUESTOR*/                                       13484902
*/* P FREE THE DEQUEUED VRWPQEL*/                                       13485302
*/*%J48: D (YES,%D48,NO,)  ANY MORE ELS ON Q?*/                         13485702
*/*   P READJUST CURRGNTP IN LDA*/                                      13485802
*/*%C38: P (,RETURN) RELEASE SALLOC LOCK*/                              13489302
*/*%F28: D (YES,,NO,%G28) IS RETURN SUCCESSFUL?*/                       13491702
*/* P DEQUEUE VRWPQEL FROM VRWAITQ*/                                    13492702
*/* D (NO,,YES,%J38) ANY MORE SPEC REQUESTS ON Q?*/                     13493702
*/* P TURN OFF WAITQUE BIT*/                                            13496102
*/*%J38: S XMPOST:POST THE REQUESTOR*/                                  13498502
*/* P ENQUEUE VRWPQEL ON VRPOSTQ*/                                      13498902
*/* P (,RETURN) RELEASE SALLOC LOCK*/                                   13499902
*/*%G28: D (YES,,NO,%C38) IS NEXT EL ON THE Q A SPEC. REQUEST?*/        13500902
*/* D (YES,,NO,%D28) DOES ITS @ RANGE OVERLAP 1ST REQUEST'S RANGE*/     13502902
*/* P (,%G28) IF SO, DO NOT HONOR IT*/                                  13504902
*/*SVC4: P SET SVC 4 GP FLAG (X'01' IN GPSW)*/                          13505702
*/* P GET FIRST LIST AND ADDRESS ENTRY*/                                13506702
*/* D (YES,,NO,%D34) LAST ENTRY?*/                                      13507702
*/* D (YES,,NO,%G24) SPECIFIC REQUEST?*/                                13508702
*/* P SET SPEC. REQUEST FLAG                                            13509702
*/*   X'08'IN GPSW*/                                                    13510702
*/*%G24: D (NO,,YES,%G34) IS REQUEST V=V?*/                             13511702
*/* D (NO,%C22,YES,) IS V=R DEFAULT INDICATED?*/                        13515402
*/* P (,%C22) GET DEFAULT SIZE FROM GDA AND SET LENGTH=SIZE*/           13517402
*/*%G34: D (NO,%C22,YES,REGLIM) IS V=V DEFAULT INDICATED?*/             13519402
*/*%D34: D (YES,%D44,NO,) SPECIFIC REQUEST?*/                           13520402
*/* P RETRIEVE 2ND LENGTH LIST EL*/                                     13521402
*/* D (YES,,NO,%H54) IS EITHER LENGTH = 0?*/                            13523402
*/* D (NO,,YES,REGLIM) IS REQUEST V=V?*/                                13523802
*/* P (,%C22) ADD NON-ZERO EL TO V=R DEFAULT SIZE*/                     13524802
*/*%H54: P (,%C22) ADD THE 2 LENGTHS*/                                  13525802
*/*%D44: P INVALID GETPART REQUEST*/                                    13526802
*/* P (,RETURN) RC=8 IN REG 15*/                                        13527802
*/*REGPART: P GET REQUEST LENGTH FROM GPR0*/                            13528802
*/* D (NO,,YES,REGLIM) IS V=V DEFAULT INDICATED?*/                      13529802
*/*%C22: P SET ROUNDING VALUE FOR PAGE MULTIPLES*/                      13530802
*/* P ROUND REQUEST UPWARDS*/                                           13536302
*/* D (NO,,YES,%E32) REG SIZE > PQE SIZE?*/                             13546302
*/* D (NO,REGLIMIT,YES,%G32) IS REQUEST V=V?*/                          13548302
*/*REGLIM: P ZERO SIZE REG IF DEFAULT*/                                 13548402
*/*REGLIMIT: P REG 1 = SIZE OF REQUEST*/                                13549602
*/*   S  IEALIMIT:USER EXIT ROUTINE*/                                   13551602
*/*   P STORE REGION LIMIT IN LDA*/                                     13551702
*/*   D (YES,,NO,%D23) V=R REQUEST?*/                                   13552002
*/*   D (YES,,NO,%VRQCHK) IS A LIMIT INDICATED?*/                       13552302
*/*   D (YES,,NO,%VRQCHK) IS REQUEST > LIMIT?*/                         13552602
*/*   P (,RETURN) R. C. = 24*/                                          13552902
*/*%VRQCHK: D (YES,,NO,%H32) IS WAITQUE BIT ON?*/                       13553202
*/* D (YES,,NO,ELBUILD) IS THIS A SPECIFIC REQUEST?*/                   13553502
*/* P OBTAIN SALLOC LOCK */                                             13554002
*/* D (NO,,YES,%A33) IS ITS EL ON VRPOSTQ?*/                            13554602
*/* P COMPARE THIS REQUESTED @ RANGE WITH 1ST ON VRWAITQ*/              13555202
*/* D (NO,,YES,%C33) IS THERE ANY OVERLAP?*/                            13556002
*/*%D23: D (NO,,YES,GPSPEC) IS SPEC. REQUEST FLAG SET?*/                13557002
*/* D (NO,,YES,VRREQ) IS V=R FLAG SET?*/                                13558002
*/*LOOP: P GET 1ST OR NEXT A.S. FBQE*/                                  13558402
*/* D (NO,,YES,%G13) FBQE PTR = PQE @?*/                                13559102
*/* D (YES,%J23,NO,LOOP) REG SIZE <= FBQE SIZE?*/                       13559902
*/*%J23: P SET TCBPQE TO POINT TO A.S.DPQE - 8*/                        13560802
*/*   P PUT START @ IN CURRGNTP IN LDA*/                                13561202
*/* P PUT START @ IN TCT*/                                              13561702
*/* P INDICATE V=V REGION (SET TCBRV AND BIT 7 OF                       13562802
*/*   PQE'S VMMFLGS =0*/                                                13563802
*/* P (,RETURN) RC = 0 IN REG 15*/                                      13564802
*/*%E32: P INVALID REQUEST*/                                            13565802
*/* P RC = 8 IN REG 15*/                                                13566802
*/*RETURN: D (NO,,YES,%G52) BRANCH ENTRY TO FREEPART?*/                 13567202
*/* P RESTORE REGS FROM GP/FP SAVE AREA*/                               13568102
*/* R RETURN VIA BR14*/                                                 13569002
*/*%G52: P TURN OFF BRANCH ENTRY FLAG*/                                 13569902
*/* P RESTORE REGS FROM OBFRSAVE IN IEAVGM00*/                          13570802
*/* R RETURN TO USER VIA BR14*/                                         13572802
*/*%G32: P (,REGLIMIT) STORE ROUNDED V=V REQUEST SIZE IN LDA */         13573202
*/*%H32: P OBTAIN SALLOCK LOCK*/                                        13573602
*/* D (YES,,NO,%D29) IS THIS A SPECIFIC REQUEST?*/                      13574002
*/* D (YES,%A33,NO,GPSPEC) IS ITS EL ON VRPOSTQ?*/                      13574102
*/*%A33: P DEQUEUE EL FROM VRPOSTQ*/                                    13574202
*/* P FREE THE ELEMENT*/                                                13574302
*/* P (,GPSPEC) SET FLAG IN GPSW TO INDICATE "POSTED-SPEC"*/            13577902
*/*%G13: P (,RETURN) RC = 20 IN REG 15*/                                13579902
*/*%C33: P RELEASE SALLOC LOCK*/                                        13580302
*/* P ACCESS V=R AREA START @ (PQEREGN) */                              13580702
*/* D (NO,,YES,%E32) IS REG START < DYNAMIC AREA START?*/               13581102
*/* P CALCULATE V=R AREA END @*/                                        13581502
*/* D (NO,,YES,%E32) IS REG START >=_ DYNAMIC AREA END?*/              13581602
*/* P CALCULATE REGION END ADDRESS*/                                    13581702
*/* D (NO,ELBUILD,YES,%E32) REG END > DYNAMIC AREA END?*/               13582502
*/*GPSPEC: P ACCESS DYNAMIC AREA START @ (PQEREGN)*/                    13582902
*/* D (NO,,YES,%E32) REG START < DYNAMIC AREA START?*/                  13583302
*/* P CALCULATE DYNAMIC AREA END @*/                                    13583702
*/* D (NO,,YES,%E32) REG START >= DYNAMIC AREA END?*/                   13584102
*/* P CALCULATE REG END @*/                                             13584202
*/* D (NO,,YES,%E32) IS REG END > DYNAMIC AREA END?*/                   13587602
*/*%J210: P GET @ OF FIRST OR NEXT FBQE*/                               13589602
*/* D (NO,,YES,%C510) ADDRESS NEXT= ADDRESS PQE?*/                      13590002
*/* D (NO,,YES,%A49) FREE AREA START > REG START?*/                     13590402
*/* D (NO,,YES,%J210) FREE AREA END < REG START?*/                      13590802
*/* D (NO,,YES,%C510) REG END > FREE AREA END?*/                        13590902
*/* D (NO,,YES,%D510) IS POSTCHK FLAG ON?*/                             13591002
*/* D (YES,,NO,%H40)  IS THIS A V=R SPEC. REQUEST?*/                    13591502
*/* D (YES,,NO,%B49) IS "ALLOCATE PASS" FLAG ON?*/                      13591902
*/* P TURN OFF "ALLOCATE PASS" FLAG*/                                   13592302
*/*%H40: P CALCULATE REG START - FREE AREA START*/                      13592402
*/* D (NO,,YES,%J510) IS DIFFERENCE = 0?*/                              13592502
*/* D (NO,,YES,%A412) IS THIS A V=V REQUEST?*/                          13593402
*/* P STORE DIFFERENCE IN SIZE FIELD OF FBQE*/                          13593802
*/*%B211: P CALCULATE FREE AREA END @ - REG END @*/                     13594202
*/* D (YES,,NO,%C311) FREE AREA END = REG END?*/                        13594602
*/* D (NO,%H311,YES,) REG START = FREE AREA START?*/                    13595002
*/* P REMOVE THE FBQE FROM THE CHAIN*/                                  13595102
*/* P FREEMAIN FBQE (CELL RETURNED TO LSQA)*/                           13596203
*/*%H311: P RELEASE SALLOC LOCK*/                                       13598302
*/* D (NO,%J23,YES,) IS THIS A V=R REGION?*/                            13600302
*/* S GETMAINB:GET LSQA SPACE FOR A PQE*/                               13600703
*/* S GETMAINB:GET SPACE IN LSQA FOR DPQE*/                             13601102
*/* P SET TCBPQE = ADDRESS DPQE - 8*/                                   13601202
*/* P INITIALIZE FIELDS IN PQE*/                                        13602103
*/* P INITIALIZE DPQE TO POINT TO PQE*/                                 13602502
*/* P GETMAIN CELL FROM LSQA FOR FBQE*/                                 13602703
*/* P INITIALIZE FIELDS IN PQE AND FBQE*/                               13602903
*/*%G212: P INDICATE V=R REGION (TCBRV AND BIT 7 OF PQE VMMFLGS = 1*/   13606303
*/* P REGION START ADDRESS IN TCT*/                                     13606403
*/*   P REGION START @ IN CURRGNTP IN LDA*/                             13607403
*/* P RETURN CODE IN REG 15*/                                           13608403
*/* D (YES,,NO,RETURN) IS "POSTED-SPEC" FLAG ON*/                       13609403
*/* P (,8A2) TURN IT OFF*/                                              13610403
*/*%C510: P (,%A49) RC = 20 IN REG 15*/                                 13611403
*/*%D510: P TURN POSTCHK FLAG OFF*/                                     13614203
*/* P UNLOCK V=R QUEUE */                                               13616203
*/* P (,%F28) RC = 0 IN REG 0*/                                         13617203
*/*ELBUILD: P GETMAIN AN ELEMENT FOR VRWPQEL*/                          13618203
*/* P PLACE ASID IN WPELASID*/                                          13620603
*/* P TCB @ FROM LDA IN WPTCBADD*/                                      13621003
*/* P ECB @ FROM JSCB IN WPECBADD*/                                     13622003
*/* D (NO,,YES,%G35) SPEC. REQUEST?*/                                   13623003
*/* P ROUNDED SIZE IN WPELSIZE*/                                        13624003
*/* P ZERO IN WPSPADDR*/                                                13625003
*/* P OBTAIN SALLOC LOCK*/                                              13626003
*/* P ENQ NON-SPEC REQUEST AT END OF Q*/                                13627003
*/*%K35: P RELEASE SALLOC LOCK*/                                        13628003
*/* P (,RETURN) RC=4 IN REG 15*/                                        13631403
*/*%G35: P REGION END @ IN WPELSIZE*/                                   13632403
*/* P REG. START @ IN WPSPADDR*/                                        13633403
*/* P OBTAIN SALLOC LOCK*/                                              13634403
*/* D (NO,,YES,%J45) IS WAITQUE BIT ON?*/                               13635403
*/* P TURN IT ON*/                                                      13636403
*/*%J45: P (,%K35) ENQ. REQUEST EL AFTER LAST SPEC.*/                   13637403
*/*%A412: P FBQE SIZE = SIZE - DIFFERENCE*/                             13641402
*/* P FREE AREA START = REGION START*/                                  13641502
*/* P PQEREGN = REG. START*/                                            13641802
*/* P (,%J23) PQESIZE = SIZE - DIFFERENCE*/                             13642202
*/*%J510: P REG START = FREE AREA START*/                               13642302
*/* P SET REG START = FREE AREA START FLAG                              13644602
*/*   X'20' IN GPSW+1*/                                                 13646602
*/* D (YES,%J23,NO,%B211) IS THIS A V=V REQUEST?*/                      13648602
*/*%C311: N REG END < FREE AREA END*/                                   13649002
*/* D (NO,,YES,%D411) REG START = FREE AREA START?*/                    13649102
*/* P ENSURE STADDRE FLAG IS OFF*/                                      13649202
*/* P GETMAIN CELL FROM LSQA/SQA FOR FBQE*/                             13651503
*/* P INSERT THE FBQE IN THE CHAIN*/                                    13652902
*/* P (,%H311) INITIALIZE SIZE AND FBQAREA FIELDS*/                     13653302
*/*%D411: P (,%H311) ADJUST SIZE AND FBQAREA FIELDS IN FBQE*/           13653702
*/*VRREQ: P ACCESS SYSTEM V=R PQE*/                                     13654102
*/*%D29: P GET @ OF FIRST OR NEXT FBQE*/                                13654202
*/* D (NO,,YES,%A49) FBQE @ = PQE @?*/                                  13654302
*/* D (YES,,NO,%D29) ENOUGH SPACE IN FBQE?*/                            13654402
*/*%9G2: S IEAVEQR:ALLOCATE REAL REGION*/                               13656102
*/* P RETURN CODE IN RCSAVE*/                                           13658102
*/* D (NO,,YES,%J39) RC = 16?*/                                         13658502
*/* D (NO,,YES,%K39) RC = 8?*/                                          13658902
*/* D (YES,,NO,%A29A) RC = 4?*/                                         13659302
*/* P PUT 12 IN RCSAVE*/                                                13659402
*/*%A29A: P PICK UP @ THAT V=R VIRTUAL REG SHOULD START AT*/            13659502
*/* P ACCESS ADDRESS SPACE PQE*/                                        13659602
*/*%C39A: P SUBTRACT SPACE FROM A.S. FREE SPACE*/                       13660102
*/* P (,%J210) RESTORE V=R PQE PTR*/                                    13660502
*/*%K39: P  INDICATE THAT RC=8 OCCURRED*/                               13660902
*/* P (,%9G2) FIND 1ST FREE AREA @ > @ RSM STOPPED SEARCH AT */         13661002
*/*%J39: D (NO,%UNLOCK,YES,) ANY RC = 8? */                             13661102
*/* P RC = 20 IN REG 15 */                                              13662802
*/*%UNLOCK: P (,RETURN) RELEASE SALLOC LOCK*/                           13664802
*/*%A49: D (NO,,YES,%A59) IS POSTCHK FLAG ON?*/                         13665202
*/* D (NO,,YES,%C59) V=R REQUEST?*/                                     13665602
*/* D (NO,,YES,RETURN) DOES RC IN REG 15 = 20?*/                        13666002
*/* P (,RETURN) RC=8 IN REG 15*/                                        13666402
*/*%C59: P (,ELBUILD) RELEASE SALLOC LOCK */                            13666502
*/*%A59: P TURN IT OFF*/                                                13675902
*/* P (,%F28) RC=4 IN REG 0*/                                           13677902
*/*%B49: P SET UP GP SPEC. PARMS FOR RSM ALLOC*/                        13679902
*/* S IEAVEQR: ALLOCATE REAL REGION*/                                   13681902
*/* P RETURN CODE IN RCSAVE*/                                           13683902
*/* D (YES,,NO,%F39B) RC=16? */                                         13684302
*/* P TURN OFF POSTED-SPEC FLAG */                                      13684702
*/* P (,RETURN) RELEASE SALLOC LOCK */                                  13685102
*/*%F39B: P TURN ON 'ALLOCATE BYPASS' FLAG */                           13685202
*/* D (YES,,NO,%A29A) RC=4? */                                          13685302
*/* P (,%A29A) PUT 12 IN RCSAVE */                                      13687002
*/*IEAVPRT0: END*/                                                      13690202
IEAVPRT0 CSECT                                                          13690602
         ENTRY GPRETRY                                                  13694802
         ENTRY  FREERSM                                                 13704202
         ENTRY  FREEASQ                                                 13713602
         ENTRY  ZEROPTRS                                                13723002
         ENTRY DEQUEUE                                                  13732402
         ENTRY GPRETURN                                                 13741802
         ENTRY CBGETS                                                   13751202
         ENTRY ENDASQS                                                  13760602
         ENTRY SUCVR                                                    13770002
         ENTRY ELBUILD                                                  13820002
         ENTRY UNL                                                      13870002
         ENTRY FREEPART                                                 13920002
         BALR  RBASE2,REG0               ESTABLISH TEMP ADDRESSABILITY  14210002
         USING *,RBASE2                                          Y02714 14280002
         MODID BR=YES                                                   14290002
         USING PSA,0                                                    14300002
         USING LDA,RLDA                                                 14330002
         USING WORKAREA,REG14                                           14412002
         L     RBASE,BASE2              PERMANENT ADDRESSABILITY Y02714 14462002
         USING RNDSIZE,RBASE                                     Y02714 14512002
PART     MVC   DRINSAV(60),BRANCHSV     GM S CALLERS REGS 0-14   Y02714 14591602
PRT0GO   ST    GMBASE2,DRINSV15         SAVE GETMAIN BASE 2             14615602
         MVC   DGPSW(FLWD),ZEROES       ZERO OUT BIT INDICATORS YM00464 14630002
         L     RCVT,CVTADDR             CVT ADDRESSABILITY      YM00856 14680002
         USING CVT,RCVT                                                 14730002
         LA    REG14,CFAPWKAR           BASE FOR GP/FP WORKAREA  Y02714 14780002
         ST    RIN1,SAVE1FRR            SAVE REGISTER 1 FOR FRR YM07262 14781002
         SETFRR A,FRRAD=FRRTN,PARMAD=FRRPARMS,WRKREGS=(RWORK1,RWORK2)   14782002
         L     RWORK1,FRRPARMS          @ OF FRR PARM AREA       Y02703 14792002
         USING RECOVERY,RWORK1                                          14794002
         ST    RBASE2,PRT0BASE          SAVE HIS BASE REGISTER  YM07262 14794202
         ST    RLDA,LDAADD              SAVE FOR FRR USE         Y02703 14794402
         USING PVT,RWORK1                                        Y02714 14796002
         ST    GMBASE,REGSAVE4          SAVE GETMAIN BASE        Y02714 14798002
GPRETRY  L     RWORK1,CVTPVTP           BASE FOR THE PVT         Y02714 14800002
         L     RWORK2,PVTPVEQR          ENTRY PT FOR IEAVEQR     Y02714 14810002
         ST    RWORK2,ALLOCVR           SAVE E.P. FOR LATER USE  Y02714 14820002
         L     RWORK2,PVTPVRLS          ENTRY PT. FOR IEAVEQRF   Y02714 14822002
         ST    RWORK2,RSMFREE           SAVE E.P. FOR LATER USE  Y02714 14824002
         DROP  RWORK1                                                   14826002
         L     RGDA,CVTGDA              OBTAIN ADDRESS OF GDA    Y02714 14830002
         DROP  RCVT                                                     14880002
         USING GDA,RGDA                 ADDRESSABILITY FOR GDA   Y02714 14930002
         LA    RWORK2,VVSPID            V=V SUBPOOL ID IN A REGISTER    15190001
         CR    RSPID,RWORK2             IS REQUEST FOR V=V REGION       15260001
         BL    VRREQ                    BRANCH IF V=R REQUEST           15330001
         L     PQEREG,ASDPQE            OBTAIN @ OF ADDR SP PQE  Y02714 15400002
         B     CKSVCBYT                 BRANCH TO DETERMINE SVC         15470001
VRREQ    L     PQEREG,VRPQEP            OBTAIN @ OF V=R PQE             15540002
         OI    GPSW,VERREQ              SET SWITCH FOR V=R REQUEST      15610001
         USING PQESECT,PQEREG           ADDRESSABILITY FOR PQE @ZA05651 15620040
CKSVCBYT L     RWORK15,FRRPARMS         FRR PARM AREA           YM00885 15660002
         USING RECOVERY,RWORK15                                  Y02714 15710002
         CLI   LDARQSTA+2,SVCFOUR       CHECK FOR SVC 4                 15750002
         BE    SVC4                     BRANCH IF SVC 4                 15820001
         LTR   RIN1,RIN1                CHECK FOR FREEPART REQUEST      15890001
         BP    FREEPART                 BRANCH IF FREEPART              15960002
         OI    FRRFLAGS,GPFPFLG         FRR FOOTPRINT            Y02703 16020002
         SR    RADDR,RADDR              ZERO REGION ADDRESS     YM01903 16025002
REGREQ   LTR    RWORK2,RLENGTH          SAVE LENGTH OF REGISTER REQUEST 16030002
         BZ    REGLIM                   BRANCH IF V=V DEFAULT           16090002
         B     RNDSIZE                  BRANCH TO ROUND REQUEST SIZE    16100001
BASE2    DC    A(RNDSIZE)               VALUE FOR BASE REG       Y02714 16150002
SVC4     OI    GPSW,SVC4SW              SET SWITCH FOR SVC 4 REQUEST    16170001
         OI    FRRFLAGS,GPFPFLG         FRR FOOTPRINT            Y02703 16220002
*   THIS CODE CALCULATES THE TOTAL LENGTH REQUESTED                     16450001
GPART    L     RWORK1,FSTWORD(RIN1)     PICK UP PTR TO LENGTH LIST      16520001
         L     RADDR,SNDWORD(RIN1)      PICK UP ADDRESS POINTER         16590001
         L     RADDR,FSTWORD(RADDR)     PICK UP ADDRESS ENTRY           16660001
NLCSGP   L     RWORK2,FSTWORD(RWORK1)   PICK UP LENGTH                  16730001
         CLI   FSTBYTE(RWORK1),LASTENT  CHECK FOR LAST ENTRY            16800002
         BE    SPECLST                  BRANCH IF LAST ENTRY            16870001
         LTR   RADDR,RADDR              CHECK FOR SPECIFIC REQUEST      16940001
         BNZ   RTN08                    ERROR IF SPLIT SPECIFIC REQUEST 17010001
         L     RWORK1,SNDWORD(RWORK1)   RETRIEVE 2ND LENGTH      Y02714 17060002
         TM    GPSW,VERREQ              TEST FOR V=R REQUEST     Y02714 17070002
         BO    VRDEFCHK                 BRANCH IF V=R            Y02714 17072002
         LTR   RWORK2,RWORK2            CHECK FOR V=V DEFAULT    Y02714 17074002
         BZ    REGLIM                   BRANCH IF DEFAULT        Y02714 17076002
         C     RWORK1,DEFAULT           CHK FOR 2ND EL = DEFAULT Y02714 17078002
         BE    REGLIM                   BRANCH IF YES            Y02714 17078402
ADD      ALR   RWORK2,RWORK1            ADD 2 LENGTHS            Y02714 17078802
         B     RNDSIZE                  BRANCH TO ROUND SIZE     Y02714 17079202
VRDEFCHK LTR   RWORK2,RWORK2            CHECK FOR V=R DEFAULT   Y02714  17079602
         BNZ   CHKLEN2                  CHECK 2ND LENGTH         Y02714 17079702
         L     RWORK2,VRDREG            LOAD DEFAULT SIZE        Y02714 17079802
CHKLEN2  C     RWORK1,DEFAULT           2ND LENGTH = DEFAULT     Y02714 17079902
         BNE   ADD                      ADD 2 LENGTHS            Y02714 17113202
         L     RWORK1,VRDREG            LOAD DEFAULT SIZE        Y02714 17123202
         B     ADD                      ADD THE 2 SIZES          Y02714 17125202
SPECLST  LTR   RADDR,RADDR              CHECK FOR SPECIFIC REQUEST      17220001
         BZ    DEFLTCHK                 IF NOT, ROUND LENGTH            17290002
         OI    GPSW,GPSSW               SET SPECIFIC SWITCH             17360001
         ST    RADDR,REGADD             REGION ADDRESS FOR FRR   Y02703 17390002
DEFLTCHK C     RWORK2,DEFAULT           CHK FOR DEFAULT REQUEST  Y02714 17410002
         BNE   RNDSIZE                  ROUND SIZE IF NOT        Y02714 17420002
         TM    GPSW,VERREQ              CHECK FOR V=R            Y02714 17422002
         BZ    REGLIM                   BRANCH IF NOT            Y02714 17424002
         L     RWORK2,VRDREG            LOAD DEFAULT SIZE        Y02714 17426002
         DROP  RBASE2                                                   17428002
*   ROUND UP REGION SIZE TO NEXT 4K FOR V=V OR V=R REQUESTS             17430002
RNDSIZE  LA    RWORK2,FSTBYTE(RWORK2)   CLEAR HI BYTE OF LENGTH REG     17500002
         LA    RWORK1,PAGERND           LOAD PAGE ROUNDING INDEX        17710001
         LR    RWORK3,RWORK1            ROUND TO PAGE MULTIPLE          17760002
         AR    RWORK1,RWORK2            RWORK2 CONTAINS LENGTH          17850001
         OR    RWORK1,RWORK3                                            17920001
         XR    RWORK1,RWORK3            RWORK1 CONTAINS ROUNDED SIZE    17990001
         LR    SIZEREG,RWORK1           SIZE FOR IEALIMIT INTF @ZA05651 18000040
         B     REGLIMIT                 SET UP FOR USER EXIT            18050040
*   THIS CODE DETERMINES IF THE REQUEST IS VALID                        18270001
REGLIM   SR    SIZEREG,SIZEREG          ZERO REG FOR DEFAULT SIZEY02714 18670002
REGLIMIT L     RBRANCH,LIMIT            @ OF USER EXIT ROUTINE   Y02714 18676002
         LA    RWORK3,SAVEAREA          SAVEAREA FOR EXIT ROUTINEY02714 18682002
         LR    LIM,SIZEREG              SIZE REQUESTED IN REG1   Y02714 18690002
         LR    REG0,LIM                 SIZE REQUESTED IN REG0 @ZA05651 18692040
         BALR  RRETURN,RBRANCH          USER EXIT ROUTINE        Y02714 18700002
*   THE IEALIMIT ROUTINE MAY CHANGE THE REGION SIZE (REG0) AND THE      18702040
*   LDALIMIT VALUE (LIM).  THSES VALUES, HOWEVER, ARE NOT MEANINGFUL    18704040
*   FOR V=R REQUESTS SINCE A SEPARATE PQE IS BUILT TO DEFINE THE        18706040
*   LIMITS OF THE REAL REGION.                                          18708040
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 18710002
         ST    LIM,LDALIMIT             STORE REG. LIMIT         Y02714 18720002
         L     RWORK15,FRRPARMS         FRR PARM AREA ADDR     @ZA05651 18721040
         TM    GPSW,VERREQ              V=R REQUEST?             Y02714 18730002
         BZ    STVVREGN                 BRANCH IF NOT          @ZA05651 18735040
         ST    SIZEREG,REGSIZE          RGN SIZE FOR FRR USE   @ZA10088 18740040
         LTR   LIM,LIM                  CHECK FOR NO LIMIT       Y02714 18743002
         BZ    VRQCHK                   OK IF NO LIMIT           Y02714 18746002
         CR    LIM,SIZEREG              REQUEST > LIMIT?         Y02714 18750002
         BNL   VRQCHK                   OK TO ALLOCATE           Y02714 18760002
         LA    RRETREG,RC24             RETURN CODE OF 24        Y02714 18770002
         B     RETURN                   RETURN TO REQUESTOR      Y02714 18780002
STVVREGN ST    REG0,VVREGSZ             SAVE NEW RGN SIZE      @ZA05651 18785040
         ST    REG0,REGSIZE             RGN SIZE FOR FRR USE   @ZA10088 18790040
         DROP  RWORK15                                         @ZA10088 18792040
         LR    SIZEREG,REG0             RELOAD SIZEREG WITH    @ZA05651 18794040
*                                       NEW REGION SIZE        @ZA05651 18800040
NOTHRESH STM   SIZEREG,PQEREG,REGSAVE2  SAVE REGS 6-8                   18830002
         TM    GPSW,GPSSW               TEST FOR SPECIFIC REQUEST       18900001
         BO    GETSPEC                  BRANCH TO SPECIFIC PROCESSING   18970001
         TM    GPSW,VERREQ              CHECK FOR V=R REQUEST           19040001
         BO    REALREG                  BRANCH FOR V=R SCAN IF SO       19110002
*   MUST BE A REGULAR V=V REQUEST                                       19114040
         L     LIM,LDALIMIT             GET LDALIMIT VALUE     @ZA05651 19118040
         C     LIM,VVREGSZ              LDALIMIT > REGION?     @ZA05651 19126040
         BNH   LDALIMOK                 NO. USE LDALIMIT       @ZA05651 19134040
         L     LIM,VVREGSZ              YES.  USE REGN SIZE    @ZA05651 19142040
LDALIMOK L     RWORK1,PQEFFBQE          ADDRESSABILITY FOR FBQE  Y02714 19150040
         USING FBQESECT,RWORK1                                   Y02714 19210002
ASLOOP   CR    RWORK1,PQEREG            ARE THERE ANY FBQES?  Y02714    19260002
         BE    RTN20                    NO--SYS SPACE OCCUPIES   Y02714 19310002
*                                       ALL ADDRESS SPACE        Y02714 19360002
         C     LIM,SIZE                 DOES REQUEST FIT?      @ZA05651 19380040
         BNH   VVEND                    BRANCH IF YES            Y02714 19460002
         L     RWORK1,FWDPTR            GET NEXT FBQE            Y02714 19510002
         B     ASLOOP                   TRY NEXT SIZE            Y02714 19560002
RTN20    LA    RRETREG,RC20             RETURN CODE = 20         Y02714 19710002
         MVC   VVREGSZ(FLWD),ZEROES     ZERO REGION SIZE         Y02714 19720002
         B     RETURN                   RETURN TO CALLER         Y02714 19760002
VRQCHK   EQU   *                                               @ZA10088 19765040
         TM    GVSMFLAG,WAITQUE         IS SPEC REQUEST WAITING?        19770040
         BO    WAITON                   BRANCH IF YES            Y02714 19860002
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 19922002
OBT1     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVPRT0*19924002
               (REL2,REL3,REL4,REL8,RET8))  OBTAIN LOCK          Y02714 19926002
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 19929602
         TM    GPSW,GPSSW               IS THIS A SPEC REQUEST   Y02714 19930002
         BZ    REALREG                  NO-TO REAL PROCESSING    Y02714 19940002
         L     ELBASE,VRPFEL            BASE FOR VRPOSTQ ELS     Y02714 19942002
         USING VRWPQEL,ELBASE                                    Y02714 19944002
         LTR   ELBASE,ELBASE            ANY ELS ON Q?            Y02714 19946002
         BZ    GETSPEC                  NO-TO SPEC PROCESSING    Y02714 19948002
         L     RWORK3,PASCBSV           GET ASCB FOR THIS REQ    Y02714 19948402
LOOP6    C     RWORK3,WPELASCB          REQUEST HAS POSTEL?      Y02714 19948802
         BNE   COMPNXT                  NEXT EL                  Y02714 19949202
         ST    SIZEREG,SAVEAREA+8       SAVE SIZE                Y02714 19961002
         L     RWORK15,FRRPARMS                                  Y02703 19963002
         LA    RRETURN,DEQRET           RETURN FROM DEQUE RTN    Y02714 19971002
         LA    RWORK5,VRPOSTQ           DEQUEUE FROM VRPOSTQ     Y02714 19972502
         B     DEQUEUE                  BRANCH TO DEQUEUE EL     Y02714 19983902
COMPNXT  CLC   WPNEXTEL(FLWD),ZEROES    IS THERE ANOTHER SPEC?   Y02714 19995302
         BE    WAITON2                  NO MORE ELS ON POSTQ     Y02714 20006702
         L     ELBASE,WPNEXTEL          GET NEXT EL              Y02714 20016702
         B     LOOP6                    CONTINUE SEARCH          Y02714 20018702
DEQRET   LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 20028702
         L     SIZEREG,SAVEAREA+8       RESTORE SIZE             Y02714 20029102
         ST    RADDR,SAVEAREA+8                                         20029302
         BAL   RADDR,FMAIN                                              20029502
         L     RADDR,SAVEAREA+8                                         20029902
         OI    GPSW,PSPEC               INDICATE THE REQUEST IS  Y02714 20060702
*                                       AN ATTEMPT TO HONOR A    Y02714 20063202
*                                       POSTED SPEC REQUEST      Y02714 20065202
         B     GETSPEC                  BRANCH TO SPEC PROCESSINGY02714 20065602
WAITON   TM    GPSW,GPSSW               IS THIS SPEC?            Y02714 20066402
         BZ    ELBUILD                  NO-REQUEST MUST WAIT     Y02714 20066502
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 20070602
OBT2     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVPRT0*20072602
               (REL1,REL2,REL4,REL8)) SET SALLOC                 Y02714 20072702
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 20091102
         L     ELBASE,VRPFEL            BASE FOR POSTQ ELS       Y02714 20093702
         LTR   ELBASE,ELBASE            ANY ELS ON Q?            Y02714 20096302
         BZ    COMPADDS                 BRANCH IF NOT            Y02714 20098902
         L     RWORK3,PASCBSV           ASCB OF THIS REQUEST     Y02714 20101502
         B     LOOP6                    SEARCH POST Q            Y02714 20102502
WAITON2  TM    GVSMFLAG,WAITQUE                                         20104102
         BZ    GETSPEC                  THIS EL IS NOT ON POSTQ - GO    20114502
*                                       ALLOCATE REQUEST         Y02714 20124902
*  CHECK TO SEE IF THIS SPECIFIC REQUEST CAN BE HONORED WITHOUT  Y02714 20130102
*  INTERFERING WITH FIRST SPECIFIC REQUEST WAITING FOR REGION    Y02714 20132702
COMPADDS L     ELBASE,VRWFEL            BASE OF 1ST SPEC ON WAITQY02714 20135302
         USING VRWPQEL,ELBASE                                    Y02714 20137902
         C     RADDR,WPSPADDR           REQUEST START > EL START?Y02714 20140502
         BH    TEST3                    BRANCH IF HIGHER         Y02714 20143102
         LR    RWORK2,RADDR             REQUEST START            Y02714 20145702
         AR    RWORK2,SIZEREG           END @ OF REQUEST         Y02714 20148302
         C     RWORK2,WPSPADDR          REQUEST END >= EL START? Y02714 20150902
         BH    OVRLAP                   BRANCH IF YES           YM05423 20153502
         B     NOTHRESH                 NO OVERLAP-HONOR REQUEST Y02714 20156102
TEST3    C     RADDR,WPELSIZE           REQUEST START > EL END?  Y02714 20158702
         DROP  ELBASE                                            Y02714 20161302
         BH    NOTHRESH                 IF YES, NO OVERLAP       Y02714 20163902
*  THIS REGION REQUEST WOULD INTERFERE WITH THE FIRST SPECIFIC   Y02714 20166502
*  REQUEST ON THE VRWAITQ IF HONORED. IF THE REQUEST IS VALID,   Y02714 20169102
*  ENQUEUE IT ON THE VRWAITQ.                                    Y02714 20171702
OVRLAP   STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 20174302
REL1     SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT2))     20174702
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 20178702
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 20180702
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 20182702
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 20183102
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 20185202
         C     RADDR,PQEREGN            REQUEST START < V=R AREA Y02714 20191102
*                                       START?                   Y02714 20193202
         BL    RTN08                    INVALID REQUEST          Y02714 20195302
         L     RWORK3,PQESIZE           V=R AREA END             Y02714 20197402
         A     RWORK3,PQEREGN           V=R AREA END             Y02714 20199502
         CR    RADDR,RWORK3             REQST START>V=R AREA END?Y02714 20201602
         BNL   RTN08                    INVALID REQUEST          Y02714 20203702
         LR    RWORK2,SIZEREG           REQUEST SIZE IN A REG    Y02714 20205802
         AR    RWORK2,RADDR             REQUEST END              Y02714 20207902
         CR    RWORK2,RWORK3            REQUST END>V=R AREA END? Y02714 20210002
         BH    RTN08                    INVALID REQUEST          Y02714 20212102
         B     ELBUILD                  VALID REQUEST-MUST WAIT  Y02714 20214202
VVEND    L     RTCB,LDATCB              TCB BASE                 Y02714 20216302
         USING TCB,RTCB                                                 20218402
         L     RTCT,TCBTCT              TCT BASE                 Y02714 20220502
         LTR   RTCT,RTCT                                        YM00850 20222502
         BZ    STLDA                    BRANCH IF NO TCT        YM00850 20225502
         USING SMFTCT,RTCT                                              20228802
         L     RWORK3,PQESIZE           SIZE OF REG.             Y02714 20230402
         SRL   RWORK3,ELEVEN            SIZE IN 2K BLOCKS        Y02714 20232002
         STH   RWORK3,TCTRSZ            SIZE IN TCT              Y02714 20233602
STPASTRT MVC   TCTRBA(FLWD),PQEREGN     REGION START IN TCT      Y02714 20241602
         DROP  RTCT                                                     20243202
STLDA    ST    RLDA,TCBPQE              @A.S. DPQE - 8 IN TCB    Y02714 20244802
         ST    RTCB,PQETCB              TCB @ IN PQE             Y02714 20246402
         NI    VMMFLGS,X'FF'-VVVRFLG    INDICATE VIRTUAL IN PQE  Y02714 20248002
         L     PQEREG,FSTWORD(PQEREG)   GET 1ST FBQE             Y02714 20248402
         MVC   CURRGNTP(FLWD),FBQAREA-FBQESECT(PQEREG) READJUST  Y02714 20248802
*                                       CURRGNTP VALUE           Y02714 20249202
         NI    TCBFLGS6,X'FF'-TCBRV     INDICATE VIRTUAL IN TCB  Y02714 20249902
         LA    RRETREG,RC0              SUCCESSFUL RETURN        Y02714 20252002
         B     RETURN                   RETURN TO CALLER         Y02714 20254102
CKONEDN  TM    GPSW,ASQFLAG             WAS THIS A BRANCH FROM   Y02714 20256202
*                                       A.S.QUEUE PROCESSING?    Y02714 20258302
         BO    ENDASQS                  IF YES, BRANCH BACK      Y02714 20260402
         L     RWORK4,FRRPARMS          BASE FOR FRR PARM AREA   Y02703 20260802
         USING RECOVERY,RWORK4                                          20261202
         OI    FRRFLGS2,VEQRDONE        V=R ALLOCATION DONE      Y02714 20262402
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 20265902
REL2     SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT1,OBT2)) 20266202
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 20267002
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 20268702
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 20269102
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 20269502
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 20270202
         TM    GPSW,VERREQ              TEST FOR V=R REQUEST     Y02714 20286802
         BZ    VVEND                    BRANCH IF VIRTUAL        Y02714 20300002
*   OBTAIN CORE FOR DPQE AND PQE                               @Z30ENYG 21140003
CBGETS   OI    FRRFLAGS,CBGFLG          FRR FOOTPRINT            Y02703 21190002
         L     RIN1,QELNTH              PQE,DPQE SIZE IN REG 1 @Z30ENYG 21210003
         L     GMBASE2,RINSAV15         RESTORE GETMAIN BASE 2          21280002
         L     GMBASE,REGSAVE4          GM BASE                  Y02714 21330002
         L     RBRANCH,GETMNB           OBTAIN ADDRESS OF GETMAING      21350002
         BALR  RRETURN,RBRANCH          BRANCH TO GETMAING              21420002
         LA    RWORK1,24(RIN1)          @ OF DPQE-8            @Z30ENYG 21770003
         L     RTCB,LDATCB              TCB BASE                 Y02714 21820002
         ST    RWORK1,TCBPQE            STORE ADDRESS IN TCB   @Z30ENYG 21840003
*   INITIALIZE PQE AND DPQE FIELDS                             @Z30ENYG 22120003
         DROP  PQEREG                                            Y02714 22590002
         USING PQESECT,RIN1             ADDRESSABILITY FOR PQE          22610001
         ST    RTCB,PQETCB              ADDR TCB IN PQE                 22820001
         ST    SIZEREG,PQESIZE          REGION SIZE IN PQE              22890001
         ST    SEGREG,PQEREGN           REGION ADDRESS IN PQE           22960001
         ST    SEGREG,CURRGNTP          ADJUST PTR FOR VGM00    YM01960 22990002
         ST    RIN1,VRPQE(RWORK1)       ADDRESS OF PQE IN DPQE          23100001
         ST    RIN1,VVPQE(RWORK1)       ADDRESS OF PQE IN DPQE          23170001
         LR    RWORK1,RIN1              SAVE ADDR PQE BUILT    @Z30ENYG 23173003
         ST    PQEREG,CFAPWKAR          SAVE ADDR V=R PQE      @Z30ENYG 23176003
*   OBTAIN CORE FOR FBQE                                       @Z30ENYG 23179003
         L     PQEREG,PASCBSV           ASCB ADDR FOR CELL GM  @Z30ENYG 23200003
         GETMAIN P,BRANCH=YES,SP=SP255  GET CELL FOR FBQE      @Z30ENYG 23203003
         L     PQEREG,CFAPWKAR          RESTORE V=R PQE ADDR   @Z30ENYG 23215003
         XR    RWORK1,RIN1              SWAP REGS: RIN1=PQE @  @Z30ENYG 23315003
         XR    RIN1,RWORK1                      RWORK1=FBQE @  @Z30ENYG 23415003
         XR    RWORK1,RIN1                                              23515003
         ST    RWORK1,PQEFFBQE          FIRST FBQE @ IN PQE    @Z30ENYG 23620003
         ST    RWORK1,PQEBFBQE          LAST FBQE @ IN PQE     @Z30ENYG 23820003
         USING FBQESECT,RWORK1          ADDRESSABILITY FOR FBQE         24020003
         ST    RIN1,FWDPTR              FBQE FORWARD POINTER            24220003
         ST    RIN1,BCKPTR              FBQE BACKWARD POINTER           24420003
         ST    SIZEREG,SIZE             REGION SIZE IN FBQE             24620003
         ST    SEGREG,FBQAREA           REGION ADDRESS IN FBQE          24820003
         ST    RWORK1,RW1SAVE           FRR FOOTPRINT                   25020003
         DROP  RWORK4                                                   25120003
         DROP  RWORK1                                                   25220003
         LA    REG14,CFAPWKAR           GP/FP WORKAREA BASE      Y02714 25420003
         OI    VMMFLGS,VVVRFLG          INDICATE REAL IN PQE            26180001
         DROP  RIN1                                                     26250001
         OI    TCBFLGS6,TCBRV           INDICATE REAL IN TCB            26320001
         L     RTCT,TCBTCT              TCT BASE                 Y02714 26370002
         LTR   RTCT,RTCT                                        YM00850 26374002
         BZ    NOTCT                    BRANCH IF NO TCT        YM00850 26377002
         USING SMFTCT,RTCT                                       Y02714 26380002
         ST    SEGREG,TCTRBA            REGION START IN TCT      Y02714 26430002
         LR    RWORK3,SIZEREG           SIZE OF REGION           Y02714 26450002
         SRL   RWORK3,ELEVEN            SIZE IN 2K BLOCKS        Y02714 26460002
         STH   RWORK3,TCTRSZ            REGION SIZE IN TCT       Y02714 26470002
         DROP  RTCT                                              Y02714 26480002
NOTCT    LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 26530002
         LH    RRETREG,RCSAVE           RESTORE RETURN CODE      Y02714 26580002
         TM    GPSW,PSPEC               IS THIS REQUEST ONE THAT Y02714 26630002
*                                       WAS POSTED FROM VRWAITQ? Y02714 26640002
         BZ    RETURN                   RETURN IF NOT            Y02714 26650002
         NI    GPSW,X'FF'-PSPEC         TURN FLAG OFF            Y02714 26660002
         B     FPCHK                    CHECK TO SEE IF OTHER    Y02714 26662002
*                                       ELS ON THE VRWAITQ CAN   Y02714 26664002
*                                       NOW BE HONORED           Y02714 26666002
*   ALLOCATE THE V=R REGION                                             26670001
SPECREAL ST    RADDR,VRPARMS1           REGION ADDRESS IN PARM LIST     26740002
         LR    RWORK2,SIZEREG           SIZE IN PARM LIST        Y02714 26802002
         SRL   RWORK2,TWELVE            GET # OF 4K BLOCKS       Y02714 26804002
         ST    RWORK2,VRPARMS2          # 4K BLOCKS IN PARM LIST Y02714 26806002
         OI    VRPARMS2,LASTENT         FLAG HIGH BYTE           Y02714 26856002
         L     RTCB,LDATCB              TCB BASE                 Y02714 27000002
         L     RWORK1,TCBJSCB           ACCESS JSCB ADDRESS             27020002
         LA    RWORK1,0(RWORK1)         ZERO HIGH BYTE                  27050002
         USING IEZJSCB,RWORK1           ADDRESSABILITY FOR JSCB         27090001
         LA    RWORK1,JSCBSECB          ACCESS ECB ADDRESS              27160001
         DROP  RWORK1                   DROP JSCB ADDRESSABILITY        27230001
         ST    RWORK1,VRPARMS3          ADDR OF GPI ECB IN PARM LIST    27300002
         LA    RIN1,VRPARMS             ADDR OF PARM LIST IN REG 1      27370001
         LA    RWORK3,SAVEAREA          SAVE AREA @              Y02714 27420002
         L     RBRANCH,ALLOCVR          OBTAIN ADDRESS OF ALLOCATE V=R  27440001
         BALR  RRETURN,RBRANCH          BRANCH TO ALLOCATE V=R          27510001
         LA    REG14,CFAPWKAR           GP/FP WORKAREA BASE      Y02714 27560002
         LA    RWORK1,RC16              PUT 16 IN A REG                 27580001
         CR    RRETREG,RWORK1           IS RETURN CODE 16               27650001
         BE    RTN16                    IF SO, UNSUCCESSFUL ALLOCATION  27720002
         L     RWORK1,FRRPARMS          BASE FOR FRR PARM AREA   Y02714 27730002
         USING RECOVERY,RWORK1                                          27740002
         OI    FRRFLAGS,RSMDONE         FRR FOOTPRINT            Y02714 27750002
         DROP  RWORK1                                                   27760002
         OI    GPSW,ALOCPASS            ALLOCATION DONE          Y02714 27770002
SRC      STH   RRETREG,RCSAVE           SAVE RETURN CODE                27790001
         LA    RWORK1,RC4               COMPARE VALUE            Y02714 27840002
         CR    RRETREG,RWORK1           WAS RSM RC=4?            Y02714 27850002
         BNE   SUCVR                    IF NO, SUCCESS           Y02714 27852002
         LA    RWORK1,RC12              IF YES, CHANGE TO 12     Y02714 27854002
         STH   RWORK1,RCSAVE            SAVE RC                  Y02714 27856002
         B     SUCVR                    BRANCH TO V=R PROCESSING Y02714 27858002
         EJECT                                                          28140001
*   PERFORM THE FBQE SEARCH AND V=R SCAN FOR                            28210002
*   V=R REGION ALLOCATION                                               28280002
REALREG  LR    RWORK2,SIZEREG           SIZE IN PARM LIST        Y02714 28400002
         SRL   RWORK2,TWELVE            GET # OF 4K BLOCKS       Y02714 28410002
         ST    RWORK2,VRPARMS2          # 4K BLOCKS IN PARM LIST Y02714 28412002
         L     RTCB,LDATCB              TCB BASE                 Y02714 28610002
         L     RWORK1,TCBJSCB           ACCESS JSCB ADDRESS             28630002
         LA    RWORK1,0(RWORK1)         CLEAR HIGH BYTE                 28660002
         USING IEZJSCB,RWORK1           ADDRESSABILITY FOR JSCB         28700001
         LA    RWORK1,JSCBSECB          ACCESS ECB ADDRESS              28770001
         DROP  RWORK1                   DROP JSCB ADDRESSABILITY        28840001
         ST    RWORK1,VRPARMS3          ECB ADDRESS IN THIRD PARAMETER  28910002
         LA    RIN1,VRPARMS             ADDR PARAMETER LIST IN REG 1    28980001
         USING PQESECT,PQEREG           ADDRESSABILITY FOR PQE          29050001
         C     SIZEREG,PQESIZE          REQUEST > V=R AREA?    @ZA15799 29070040
         BH    RET8                     YES, INVALID REQUEST   @ZA15799 29080040
         L     RWORK1,PQEFFBQE          ACCESS FIRST FBQE ON PQE CHAIN  29120001
         USING FBQESECT,RWORK1          ADDRESSABILITY FOR FBQE         29260001
VRLOOP   CR    RWORK1,PQEREG            CHECK FOR END OF FBQE CHAIN     29330001
         BE    RET4                     REQUEST MUST WAIT        Y02714 29400002
         C     SIZEREG,SIZE             CHECK FOR SIZE LARGE ENOUGH     29470001
         BH    FBQLOOP                  CHECK NEXT FBQE IF TOO SMALL    29540001
         MVC   VRPARMS1(FLWD),FBQAREA   FBQE START IN PARAMETER LIST    29680002
RSMBR    LA    RWORK3,SAVEAREA          SAVE AREA ADDRESS        Y02714 29750002
         L     RBRANCH,ALLOCVR          ACCESS ADDRESS OF IEAVEQRY02714 29800002
         BALR  RRETURN,RBRANCH          BRANCH TO IEAVEQR               29820002
         LA    REG14,CFAPWKAR           GP/FP WORKAREA BASE      Y02714 29870002
         STH   RRETREG,RCSAVE           SAVE RETURN CODE FROM IEAVEQR   29890002
         LA    RWORK2,RC16              ACCESS RC 16 FOR COMPARE        29960001
         CR    RRETREG,RWORK2           CHECK FOR RC 16                 30030001
         BE    FOUND16                  BRANCH IF RC=16          Y02714 30080002
         LA    RWORK2,RC8               ACCESS RC 8 FOR COMPARE  Y02714 30090002
         CR    RRETREG,RWORK2           CHECK FOR RC=8           Y02714 30092002
         BE    FOUND8                   NO-SUCCESSFUL ALLOCATION Y02714 30094002
         L     RWORK1,FRRPARMS          BASE FOR FRR PARM AREA   Y02703 30094402
         USING RECOVERY,RWORK1                                          30094802
         OI    FRRFLAGS,RSMDONE         FRR FOOTPRINT            Y02703 30095202
         DROP  RWORK1                                                   30095602
         LA    RWORK2,RC4               COMPARE VALUE            Y02714 30096002
         CR    RRETREG,RWORK2           RSM RC = 4?              Y02714 30098002
         BNE   SUCVR                    SUCCESSFUL ALLOCATION IF NOT    30100001
         LA    RWORK2,RC12              CHANGE RC TO 12          Y02714 30150002
         STH   RWORK2,RCSAVE            SAVE RC                  Y02714 30160002
         B     SUCVR                    BRANCH TO PROCESS V=R    Y02714 30162002
FOUND8   OI    BIGPSW,UNCSCAN           INDICATE AN RC 8 FROM RSMY02714 30170002
         L     PQEREG,ASDPQE            PQE ADDRESS              Y02714 30220002
         L     FBQEREG,PQEFFBQE         FBQE ADDRESSABILITY      Y02714 30230002
         USING FBQESECT,FBQEREG                                  Y02714 30232002
FREEADDR CR    FBQEREG,PQEREG           ANY MORE FBQE'S?         Y02714 30232402
         BE    FOUND16                  BRANCH IF NOT            Y02714 30232802
         L     RWORK3,FBQAREA           ADDRESS OF FREE AREA     Y02714 30234002
         C     RWORK3,VRPARMS1          IS RSM STOP ADDRESS LOW? Y02714 30236002
         BNH   NEXTFREE                 NO--GET NEXT FREE AREA   Y02714 30238002
         ST    RWORK3,VRPARMS1          PASS RSM THIS ADDRESS    Y02714 30238402
         LA    RIN1,VRPARMS             ADDRESS OF PARM LIST     Y02714 30238802
         B     RSMBR                    TRY TO ALLOCATE AGAIN    Y02714 30239202
NEXTFREE L     FBQEREG,FWDPTR           NEXT FREE AREA ADDRESS   Y02714 30239602
         B     FREEADDR                 TRY NEXT FREE AREA       Y02714 30239702
FOUND16  TM    BIGPSW,UNCSCAN           ANY RC=8 FROM RSM?       Y02714 30239802
         BZ    UNLK                     RETURN IF NOT            Y02714 30239902
         LA    RRETREG,RC20             IF YES, SYS. SPACE       Y02714 30286602
*                                       FRAGMENTS V=R AREA       Y02714 30296602
UNLK     STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 30310602
REL3     SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT1))     30312602
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 30315002
         LA    RWORK2,RC8               VALUE TO COMPARE         Y02714 30315402
         CR    RWORK2,RWORK3            R.C.= 8?                 Y02714 30315802
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 30315902
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 30316002
         MVC   VVREGSZ(FLWD),ZEROES     ZERO REGION SIZE         Y02714 30316302
         B     RETURN                   RETURN TO CALLER         Y02714 30316602
FBQLOOP  L     RWORK1,FWDPTR            ACCESS NEXT FBQE                30333302
         B     VRLOOP                   BRANCH TO CHECK NEXT FBQE       30380001
*   SUBTRACT SAME SPACE FROM ADDRESS SPACE PQE                   Y02714 30710002
SUCVR    L     RWORK15,FRRPARMS         FRR PARM BASE                   30712002
         USING RECOVERY,RWORK15                                         30714002
         MVC   REGADD(FLWD),VRPARMS1    REG ADDRESS FOR FRR USE  Y02714 30716002
         L     REGSTART,VRPARMS1        @ FROM RSM TO START      Y02714 30720002
*                                       VIRTUAL REGION           Y02714 30722002
         LA    REGSTART,0(REGSTART)     ZERO HIGH BYTE           Y02714 30722402
         LR    REGEND,REGSTART          REGION START ADDRESS     Y02714 30724002
         AR    REGEND,SIZEREG           REGION END ADDRESS       Y02714 30726002
         L     PQEREG,ASDPQE            A.S.PQE ADDRESS          Y02714 30728002
         USING PQESECT,PQEREG                                    Y02714 30728402
         L     FBQEREG,PQEFFBQE         GET FIRST FBQE           Y02714 30728802
         USING FBQESECT,FBQEREG                                  Y02714 30729202
NXTFBQE  L     RWORK3,FBQAREA           START OF FREE AREA       Y02714 30729602
         A     RWORK3,SIZE              END OF FREE AREA         Y02714 30729702
         CR    REGSTART,RWORK3          REG START<FREE AREA END? Y02714 30729802
         BL    ASAVAIL                  SUBTRACT FROM THIS FBQE  Y02714 30729902
         L     FBQEREG,FWDPTR           NEXT FBQE ADDRESS        Y02714 30753202
         B     NXTFBQE                  TRY NEXT FREE AREA       Y02714 30763202
ASAVAIL  ST    FBQEREG,RW1SAVE          FRR INFO                 Y02703 30765202
         LR    RSIZE,REGSTART           REGION START             Y02714 30773202
         S     RSIZE,FBQAREA            SUBTRACT FREE AREA START Y02714 30775202
         BZ    SETEQ                    IF DIFF =0, BRANCH       Y02714 30776002
         NI    BIGPSW,X'FF'-STADDRE     TURN OFF SWITCH          Y02714 30776102
         ST    RSIZE,SIZE               STORE DIFFERENCE IN FBQE Y02714 30776402
CHKENDS  OI    GPSW,ASQFLAG             INDICATE A.S.Q PROCESSINGY02714 30776502
         B     OTHREND                  BRANCH TO SET UP FBQE'S  Y02714 30776602
*                                       TO SHOW SPACE SUBTRACTED Y02714 30784402
*                                       FROM A. S. PQE           Y02714 30786402
ENDASQS  L     RWORK15,FRRPARMS         BASE FOR FRR PARM AREA   Y02714 30786802
         OI    FRRFLAGS,ASDONE          FRR FOOTPRINT            Y02714 30787602
         MVC   RW1SAVE(FLWD),ZEROES     ZERO FRR INFO            Y02714 30787702
         DROP  RWORK15                                                  30788002
         L     PQEREG,VRPQEP            RESTORE V=R PQE          Y02714 30788402
         LR    RWORK2,SIZEREG           REGION START             Y02714 30788502
         AR    RWORK2,RADDR             REGION END               Y02714 30788602
         NI    GPSW,X'FF'-ASQFLAG       TURN OFF FLAG            Y02714 30788802
         B     COMONCHK                 BRANCH TO COMPLETE ALLOC.Y02714 30790402
SETEQ    OI    BIGPSW,STADDRE           START ADDRESSES EQUAL    Y02714 30790802
         B     CHKENDS                  CHECK END ADDRESSES      Y02714 30791202
*   UNSUCCESSFUL RETURNS                                         Y02714 30791602
RET20    LA    RRETREG,RC20             RETURN CODE = 20         Y02714 30792002
RET4     TM    GPSW,POSTCHK             WAS THIS CHECKING FOR    Y02714 30792102
*                                       POSTING ELEMENTS?        Y02714 30811502
         BZ    RTEST                    BRANCH IF NOT            Y02714 30821502
         NI    GPSW,X'FF'-POSTCHK       TURN OFF POSTCHK FLAG    Y02714 30823502
         LA    REG0,RC4                 RETURN CODE 4 IN REG 0   Y02714 30827502
         B     PSTCHK                   RETURN TO POST CHECKING  Y02714 30829502
RTEST    TM    GPSW,VERREQ              IS THIS V=R REGION?      Y02714 30829902
         BZ    SEEIF20                  IF NOT, RC=20?           Y02714 30830302
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 30830802
REL4     SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT1,OBT2)) 30830902
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 30834902
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 30836902
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 30837302
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 30837702
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 30839802
         B     ELBUILD                  ENQUEUE EL ON VRWAITQ    Y02714 30844602
SEEIF20  MVC   VVREGSZ(FLWD),ZEROES     ZERO REGION SIZE         Y02714 30846702
         LA    RWORK1,RC20              RC = 20 FOR COMPARE      Y02714 30848802
         CR    RRETREG,RWORK1           RC = 20?                 Y02714 30850902
         BE    RETURN                   RETURN IF SO             Y02714 30853002
         B     RTN08                    OTHERWISE, RC=8          Y02714 30855102
O82ABEND ABEND X'082',,,SYSTEM                                   Y02714 30859202
         EJECT                                                          30860802
*   BUILD AND ENQUEUE AN ELEMENT ON THE VRWAITQ                  Y02714 30865202
ELBUILD  LR    RTCB,RLDA                SAVE LDA @ ACROSS GM     Y02714 30868002
         L     PQEREG,PASCBSV           ASCB ADDRESS             Y02714 30868402
         ST    RGDA,SAVEAREA            SAVE REG 3               Y02714 30870002
         L     RLDA,LDATCB              TCB  ADDRESS             Y02714 30871602
         GETMAIN  RC,LV=28,SP=245,BRANCH=YES  GET AN ELEMENT     Y02714 30873202
         LR    RLDA,RTCB                RESTORE LDA @            Y02714 30874802
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 30876402
         L     RGDA,SAVEAREA            RESTORE REG 3            Y02714 30878002
         LTR   RRETREG,RRETREG          RETURN CODE = 0?         Y02714 30879602
         BNZ   RTN16                    BRANCH NOT SUCCESSFUL    Y02714 30881202
         L     RWORK15,FRRPARMS                                  Y02703 30883202
         USING RECOVERY,RWORK15                                         30883302
         OI    FRRFLGS2,WENQFLG         FRR FOOTPRINT            Y02703 30883402
         DROP  RWORK15                                                  30885802
         USING VRWPQEL,ELBASE                                    Y02714 30889202
         MVC   WPELASCB(FLWD),PASCBSV   ASCB IN WAIT EL          Y02714 30891602
         MVC   WPERRADD(FLWD),ERRADD    @ ASYNC.ERROR EXIT RTN   Y02714 30893602
         L     RTCB,LDATCB              TCB BASE                 Y02714 30896402
         USING TCB,RTCB                                          Y02714 30898802
         L     RWORK3,TCBJSCB           JSCB ADDRESS             Y02714 30901202
         LA    RWORK3,0(RWORK3)         CLEAR HIGH BYTE                 30902202
         USING IEZJSCB,RWORK3                                    Y02714 30903602
         LA    RWORK2,JSCBSECB          PTR TO ECB               Y02714 30906002
         DROP  RWORK3                                            Y02714 30908402
         ST    RWORK2,WPECBADD          ECB ADDRESS IN WAIT EL   Y02714 30910802
         TM    GPSW,GPSSW               IS THIS REQUEST SPECIFIC Y02714 30913202
         BO    SPECREQ                  BRANCH IF YES            Y02714 30915602
         ST    SIZEREG,WPELSIZE         REQUEST SIZE IN WAIT EL  Y02714 30918002
         MVC   WPSPADDR(4),ZEROES       ZERO SPECIFIC ADDRESS    Y02714 30920402
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 30922802
OBT3     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRWPQEL,IEAVP*30925202
               RT0(REL6))               GET SALLOC               Y02714 30927602
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 30930002
         L     RWORK2,VRWLEL            ENQUEUE EL AT END OF Q   Y02714 30933002
         LTR   RWORK2,RWORK2            ANY ELS ON Q?            Y02714 30936002
         BZ    STNEXT                   BRANCH IF NOT            Y02714 30939002
         MVC   WPNEXTEL(FLWD),ZEROES    NEW FORWARD PTR          Y02714 30941902
         ST    RWORK2,WPPREVEL          NEW BACK PTR             Y02714 30944002
         ST    ELBASE,0(RWORK2)         OLD FORWARD PTR          Y02714 30945002
         ST    ELBASE,VRWLEL            NEW LAST EL PTR          Y02714 30951002
         B     UNL                      UNLOCK AND RETURN        Y02714 30969002
SPECREQ  LR    RWORK2,SIZEREG           REGION SIZE              Y02714 30972002
         AR    RWORK2,RADDR             ADD REGION START         Y02714 30975002
         BCTR  RWORK2,0                 HIGH ALLOCATED @ OF REG. Y02714 30977002
         ST    RWORK2,WPELSIZE          STORE END @ IN EL        Y02714 30978002
         ST    RADDR,WPSPADDR           STORE SPEC @ IN EL       Y02714 30981002
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 30984002
OBT4     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRWPQEL,IEAVP*30987002
               RT0(REL6))               GET SALLOC               Y02714 30990002
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 31005002
         TM    GDAFLAGS,WAITQUE         ANY SPEC REQUESTS WAITINGY02714 31008002
         BO    ENQ                      BRANCH IF YES            Y02714 31011002
ENQFIRST OI    GDAFLAGS,WAITQUE         TURN BIT ON              Y02714 31014002
         L     RWORK2,VRWFEL            ENQ. EL 1ST ON WAITQ     Y02714 31017002
         LTR   RWORK2,RWORK2            ANY ELS ON QUEUE?        Y02714 31020002
         BZ    STNEXT                   BRANCH IF NOT            Y02714 31023002
         ST    ELBASE,FLWD(RWORK2)      OLD EL BACK PTR          Y02714 31026002
STNEXT   ST    RWORK2,WPNEXTEL          NEW FORWARD PTR          Y02714 31029002
         MVC   WPPREVEL(FLWD),ZEROES    THIS IS 1ST QUEUE EL     Y02714 31032002
         ST    ELBASE,VRWFEL            1ST ELEMENT ADDRESS      Y02714 31035002
         CLC   VRWLEL(FLWD),ZEROES      DID LAST PTR=0?          Y02714 31038002
         BNE   UNL                      IF NOT,ITS OK            Y02714 31041002
         ST    ELBASE,VRWLEL            OTHERWISE, NEW EL=LAST ELY02714 31044002
UNL      STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 31047002
REL6     SETLOCK      RELEASE,TYPE=SALLOC,RELATED=(VRWPQEL,IEAVPRT0(OBT*31050002
               3,OBT4))    RELEASE LOCK                          Y02714 31053002
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 31055002
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 31055402
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 31055802
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 31055902
         LM    RWORK2,REG14,CFAPWKAR+4 RESTORE REGS              Y02714 31056902
         LA    RRETREG,RC4              RETURN CODE=4            Y02714 31059902
         B     RETURN                   RETURN                   Y02714 31062002
ENQ      L     RWORK2,VRWFEL            1ST EL ON VRWAITQ        Y02714 31065002
NOTYET   CLC   FSTWORD(FLWD,RWORK2),ZEROES    ANY MORE ELS?    @YM03454 31066002
         BE    ENQAFTER                 BRANCH IF NOT          @YM03454 31067002
         L     RWORK2,0(RWORK2)          @ NEXT EL ON QUEUE      Y02714 31068002
NSPEC    CLC   SPADDR(FLWD,RWORK2),ZEROES  EL FOR SPEC REQUEST?  Y02714 31071002
         BE    INSERT                   FIND LAST SPEC REQUEST   Y02714 31074002
         B     NOTYET                   CHECK NEXT EL ON Q       Y02714 31083002
ENQAFTER ST    RWORK2,WPPREVEL          PREVIOUS EL              Y02714 31088002
         MVC   WPNEXTEL(FLWD),ZEROES    THIS IS LAST EL          Y02714 31088402
         ST    ELBASE,FSTWORD(RWORK2)   FORWARD PTR              Y02714 31088802
         ST    ELBASE,VRWLEL            NEW LAST EL              Y02714 31089002
         B     UNL                      BRANCH TO UNLOCK         Y02714 31098002
INSERT   L     RWORK3,SNDWORD(RWORK2)   @ PREV. EL.              Y02714 31101002
         ST    RWORK2,WPNEXTEL          FORWARD PTR              Y02714 31103002
         ST    RWORK3,WPPREVEL          BACK PTR                 Y02714 31103402
         ST    ELBASE,FSTWORD(RWORK3)   CHAIN THIS TO PREV EL    Y02714 31104002
         ST    ELBASE,SNDWORD(RWORK2)   CHAIN THIS TO 1ST NONSPECY02714 31107002
         B     UNL                      UNLOCK AND RETURN        Y02714 31154002
         EJECT                                                          31161202
*     FREEMAIN AN ELEMENT FROM THE VRWAITQ OR THE VRPOSTQ               31162002
FMAIN    ST    PQEREG,SAVEAREA          STORE PQE @              Y02714 31162802
         ST    RGDA,SAVEAREA+4          SAVE REG3                Y02714 31163602
         LR    RWORK2,RLDA              SAVE LDA @ ACROSS FM     Y02714 31164402
         L     PQEREG,PASCBSV           ASCB @                   Y02714 31165202
         L     RLDA,LDATCB              TCB @                    Y02714 31166002
         FREEMAIN  RC,LV=28,A=(1),SP=245,BRANCH=YES  FREE EL     Y02714 31166802
         LR    RLDA,RWORK2              RESTORE LDA @            Y02714 31167602
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 31168402
         L     PQEREG,SAVEAREA          RESTORE PQE @            Y02714 31175602
         L     RGDA,SAVEAREA+4          RESTORE REG 3            Y02714 31176602
         BR    RADDR                    RETURN TO PROPER POINT   Y02714 31177602
         EJECT                                                          31178602
*   UNSUCCESSFUL GETPART PROCESSING                                     31180802
RET8     ST    RBASE,CFAPWKAR           SAVE BASE REG            Y02714 31181602
         SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT1,OBT2)) 31190002
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 31196002
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 31202002
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 31208002
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 31214002
         LA    REG14,CFAPWKAR           RESTORE REGS             Y02714 31220002
RTN08    LA    RRETREG,RC8              RETURN CODE OF 8         Y02714 31226002
         MVC   VVREGSZ(FLWD),ZEROES     ZERO REGION SIZE         Y02714 31232002
RETURN   SETFRR  D,WRKREGS=(RWORK1,RWORK2) DELETE FRR            Y02714 31240002
         TM    GPSW,FRPRT+VERREQ        V=R FREEPART ?         @ZA08170 31290040
         BO    CKVRFAIL                 YES, CK FOR ERROR      @ZA08170 31340040
CKBRNTRY TM    LDAFLAGS,LDABRSW         CHECK FOR BRANCH ENTRY @ZA08170 31390040
         BO    FPBRNT                   PROCESS BRANCH ENTRY EXIT       36470001
         LM    RIN0,RIN1,RINSAVE        RESTORE REGS 0 AND 1            36610002
         L     RRETURN,RINSAV14         RESTORE RETURN REGISTER         36660002
         BR    RRETURN                  RETURN                          36680001
FPBRNT   NI    LDAFLAGS,X'FF'-LDABRSW   TURN OFF BRANCH ENTRY SW        36750002
         LA    RRETURN,RINSAVE          ACCESS GM SAVEAREA              36820002
         LM    RIN0,RRETURN,FSTBYTE(RRETURN) RESTORE ALL REGISTERS      36890001
         BR    RRETURN                  RETURN TO CALLER                36960001
RTN16    NI    GPSW,X'FF'-PSPEC         TURN OFF POSTED SPEC FLG Y02714 37010002
ULK      STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 37020802
REL8     SETLOCK RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT1,OBT2)) 37021202
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 37084002
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 37086002
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 37086402
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 37086802
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 37086902
         LA    RRETREG,RC16             RETURN CODE OF 16        Y02714 37087002
         MVC   VVREGSZ(FLWD),ZEROES     ZERO REGION SIZE         Y02714 37097002
         B     RETURN                   RETURN                   Y02714 37100002
*   THE ENTRY WAS FOR A V=R FREEPART. THE ONLY POSSIBLE        @ZA08170 37120040
*   RETURN CODES  ARE 0 AND 4. IF THE RETURN CODE IS 4,        @ZA08170 37140040
*   THE ATTEMPT TO FREE THE V=R FRAMES HAS FAILED. THUS        @ZA08170 37160040
*   THE ADDRESS SPACE MUST BE TERMINATED.                      @ZA08170 37180040
CKVRFAIL LTR   RRETREG,RRETREG          RC = 0 ?               @ZA08170 37200040
         BZ    CKBRNTRY                 YES                    @ZA08170 37220040
         LA    REG13,SAVEAREA           SAVEAREA FOR MEMTERM   @ZA08170 37240040
         CALLRTM TYPE=MEMTERM,COMPCOD=X'028' TERMINATE MEMORY  @ZA08170 37260040
         LA    REG14,CFAPWKAR           RESTORE WORKAREA       @ZA08170 37280040
         LA    REG15,4                  RESTORE ERROR CODE     @ZA08170 37300040
         B     CKBRNTRY                 RETURN                 @ZA08170 37320040
         EJECT                                                          37450001
FREEPART STM   PQEREG,GMBASE,REGSAVE3   SAVE REGS 7-8            Y02714 37460002
         OI    GPSW,FRPRT               FLAG FOR FREEPART      @ZA08170 37465040
         L     RTCB,LDATCB              TCB POINTER              Y02714 37470002
         TM    GPSW,VERREQ              FP FOR V=R REGION?       Y02714 37500002
         BZ    SUBPOLCK                 BRANCH IF V=V            Y02714 37510002
         USING LDA,RLDA                                          Y02714 37512002
*  IF V=R REGION IS FREEPARTING, CHECK TO SEE IF IT HAS AN       Y02714 37514002
*  ELEMENT ON THE VRWAITQ OR THE VRPOSTQ. IF SO, DEQUEUE THE     Y02714 37516002
*  ELEMENT AND FREE IT                                           Y02714 37518002
         L     RWORK5,PASCBSV           LOAD ASCB TO COMPARE     Y02714 37518402
         L     RCVT,CVTADDR             CVT BASE                 Y02714 37518802
         USING CVT,RCVT                                          Y02714 37519202
         L     RGDA,CVTGDA              GDA BASE                 Y02714 37519602
         USING GDA,RGDA                                          Y02714 37519702
         USING VRWPQEL,ELBASE                                    Y02714 37519802
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 37539902
OBT5     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRWPQEL,IEAVP*37549902
               RT0(REL9)) GET LOCK                               Y02714 37551902
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 37555102
         L     ELBASE,VRWFEL            @ 1ST EL ON VRWAITQ      Y02714 37559902
         C     ELBASE,ZEROES            ANY ELS ON QUEUE         Y02714 37563202
         BE    VRPSTQ                   CHECK VRPOSTQ            Y02714 37565202
LOOP4    C     RWORK5,WPELASCB          IS FIRST EL FOR THIS REG.Y02714 37565602
         BE    DEQUEW                   DEQUEUE IT IF SO         Y02714 37566002
         CLC   WPNEXTEL(FLWD),ZEROES    ANY MORE ELS?            Y02714 37566402
         BE    VRPSTQ                   CHECK VRPOSTQ IF NOT     Y02714 37566502
         L     ELBASE,WPNEXTEL          GET NEXT ELEMENT         Y02714 37566602
         B     LOOP4                    CHECK NEXT EL ON WAITQ   Y02714 37574402
DEQUEW   LA    RWORK5,VRWAITQ           INDICATE WAITQ           Y02714 37576402
         L     RWORK15,FRRPARMS                                  Y02703 37576802
         BAL   RRETURN,DEQUEUE          DEQUEUE ELEMENT          Y02714 37578402
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 37578802
         ST    RADDR,SAVEAREA+8         SAVE REG 2               Y02714 37580402
         BAL   RADDR,FMAIN              BRANCH TO FREE ELEMENT   Y02714 37580602
         L     RADDR,SAVEAREA+8         RESTORE REG 2            Y02714 37580802
         L     ELBASE,VRWFEL            GET 1ST EL ON WAITQ      Y02714 37585802
         LTR   ELBASE,ELBASE            ANY ELS ON QUEUE?        Y02714 37590802
         BZ    ZEROBIT                  NO-ZERO WAITQUE BIT      Y02714 37595802
         CLC   SPADDR(FLWD,ELBASE),ZEROES   ANY SPEC. ELS LEFT?  Y02714 37601502
         BNE   REGOWNED                 BRANCH IF SPEC LEFT      Y02714 37611502
ZEROBIT  NI    GDAFLAGS,X'FF'-WAITQUE   ZERO WAITQUE BIT         Y02714 37613502
         B     REGOWNED                 CHECK FOR OWNED REGION   Y02714 37615502
VRPSTQ   L     ELBASE,VRPFEL            GET 1ST EL ON POSTQ      Y02714 37617502
         C     ELBASE,ZEROES            ANY ELS ON POSTQ?        Y02714 37619502
         BE    REGOWNED                 BRANCH IF NOT            Y02714 37619902
LOOP5    C     RWORK5,WPELASCB          IS THIS EL FOR THIS REG. Y02714 37620302
         BE    DEQUE                    DEQUEUE IT IF SO         Y02714 37620702
         CLC   WPNEXTEL(FLWD),ZEROES    ANY MORE ELS?            Y02714 37621102
         BE    REGOWNED                 BRANCH IF NOT            Y02714 37627602
         L     ELBASE,WPNEXTEL          GET NEST EL              Y02714 37629602
         B     LOOP5                    CONTINUE SEARCH          Y02714 37631602
DEQUE    LA    RWORK5,VRPOSTQ           INDICATE POSTQ           Y02714 37633602
         L     RWORK15,FRRPARMS                                  Y02703 37633702
         BAL   RRETURN,DEQUEUE          DEQUEUE EL               Y02714 37634002
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 37634402
         ST    RADDR,SAVEAREA+8         SAVE REG 2               Y02714 37636002
         BAL   RADDR,FMAIN              GO FREE THE ELEMENT      Y02714 37647202
         L     RADDR,SAVEAREA+8         RESTORE REG 2            Y02714 37649202
REGOWNED STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 37651202
REL9     SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRWPQEL,IEAVRT0(OBT5))   37653202
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 37665502
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 37665602
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 37715602
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 37725602
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 37735602
         CLC   TCBPQE(FLWD),ZEROES      CHECK FOR TCB HAVING REG.Y02714 37815602
         BNE   SPQFREE                  BRANCH TO FREE SPACE     Y02714 37865602
         LA    RRETREG,RC0              IF NO REGION, RC=0       Y02714 37915602
         B     FPCHK                    SEE IF ANY WAITING       Y02714 37965602
*                                       REQUESTS CAN BE HONORED  Y02714 38015602
RTN0     LA    RRETREG,RC0              LOAD RETURN CODE                38780001
         B     RETURN                   RESTORE INPUT REGISTERS         38850001
*   CHECK FOR VALID FREEPART.  FREE ALL REGION SUBPOOLS CHAINED OFF     38900040
*   THE INITIATOR TCB.  BEFORE FREEING THE SUBPOOL, SET ON FLAG         39900040
*   LDAFPFM IN THE LDA SO THAT FREEMAIN WILL SEND BACK A RETURN CODE    39910040
*   RATHER THAN ISSUING AN ABEND, IF AN ABEND A0A-2 SITUATION IS        39920040
*   ENCOUNTERED.  AFTER THE SUBPOOL STORAGE HAS BEEN FREEMAINED, OR     39930040
*   IF THERE WAS AN SPQE BUT NO ALLOCATED STORAGE, FREE THE SPQE.       39940040
SUBPOLCK CLC   TCBPQE(FLWD),ZEROES      CHECK FOR TCB HAVING A REGION   39970001
         BE    RTN0                     RETURN IF NOT                   40040001
SPQFREE  L     RSPQE,TCBMSS             ACCESS FIRST SPQE               40180002
         USING SPQESECT,RSPQE           ADDRESSABILITY FOR SPQE         40250001
         LA    RSPQE,0(RSPQE)           CLEAR HIGH ORDER BYTE           40320002
TESTEND  LTR   RSPQE,RSPQE              TEST COMPLETE IF END OF QY02714 40370002
         BZ    BRMREL                   BRANCH IF END                   40390002
         L     RDQE,SPDQEPTR            ACCESS DQE /OWNING SPQE  Y02714 40440002
         TM    SPQEFLGS,SPSHARE         CHECK FOR SHARED SUBPOOL        40460001
         BZ    CKSPQE                   BRANCH TO FREE SPACE     Y02714 40590003
         L     RDQE,FLWD(RDQE)          ACCESS DQE OF OWNER             40610003
CKSPQE   LTR   RDQE,RDQE                ANY DQE'S?               Y02714 41223003
         BZ    FREESPQE                 FREE SPQE IF NO DQE      Y02714 41223203
         OI    LDAFLAGS,LDAFPFM         FREEMAIN FROM FREEPART @ZA05954 41223340
         LR    RWORK2,RLDA              SAVE LDA @               Y02714 41224003
         L     PQEREG,PASCBSV           ASCB PTR                 Y02714 41224203
         LR    RLDA,RTCB                TCB @                    Y02714 41224403
         LR    RTCB,RGDA                SAVE GDA ADDRESS       @ZA05954 41224540
         SR    RGDA,RGDA                CLEAR R3               @ZA05954 41224740
         IC    RGDA,SPQEID              SP FOR FREEMAIN INTF   @ZA05954 41224940
         FREEMAIN RC,SP=(3),BRANCH=YES  FREE ENTIRE SUBPOOL    @ZA05954 41227740
         LR    RGDA,RTCB                RESTORE GDA ADDRESS    @ZA05954 41228640
         LR    RTCB,RLDA                RESTORE TCB ADDRESS             41229540
         LR    RLDA,RWORK2              RESTORE LDA @            Y02714 41230440
         NI    LDAFLAGS,X'FF'-LDAFPFM   NOT FREEPART FREEMAIN  @ZA05954 41231340
FREESPQE LR    RIN1,RSPQE               SPQE ADDR FOR FM       @Z30ENYG 41232240
         L     RSPQE,SPQEAD             @ NEXT SPQE              702714 41234040
         ST    RSPQE,TCBMSS             REMOVE SPQE FROM Q      YM07625 41234940
         L     PQEREG,PASCBSV           ASCB ADDR FOR FM       @Z30ENYG 41235803
         FREEMAIN P,BRANCH=YES,A=(RIN1) FREE SPQE CELL         @Z30ENYG 41250003
         LA    REG14,CFAPWKAR           RESTORE ADDR WRKAREA   @Z30ENYG 41268003
         B     TESTEND                  TEST NEXT SPQE                  41271003
         EJECT                                                          41470002
BRMREL   MVC   TCBMSS(FLWD),ZEROES      ZERO TCBMSS FIELD        Y02714 41620002
         L     RTCB,LDATCB              TCB BASE                 Y02714 41630002
         TM    GPSW,VERREQ              V=R REQUEST?             Y02714 41670002
         BZ    ZEROPTRS                 BRANCH IF VIRTUAL        Y02714 41720002
         L     RIN1,TCBPQE              ACCESS DPQE FOR THE TASK        43750002
         L     RWORK1,VRPQE(RIN1)       ACCESS PQE FOR THE TASK         43820001
         USING PQESECT,RWORK1           ADDRESSABILITY FOR PQE          43890001
         L     SIZEREG,PQESIZE          SIZE OF REGION IN A REG         43960001
         L     SEGREG,PQEREGN           ADDRESS OF REGION IN A REG      44030001
         ST    SIZEREG,REGSAVE2         SAVE REG 6                      44100001
         ST    SEGREG,REGSAVE5          SAVE REG 9                      44170001
         MVI   LDACBSP,SP245            SPID FOR CONTROL BLKS    Y02714 44220002
         L     PQEREG,REGSAVE3          RESTORE PQE PTR          Y02714 44230402
         L     GMBASE,REGSAVE4          GM BASE REGISTER         Y02714 44232002
         L     GMBASE2,RINSAV15         RESTORE GETMAIN BASE 2          44240002
         L     RBRANCH,RELEASE          OBTAIN ADDRESS OF MRELEASF      44310002
         STM   RBASE,GMBASE2,CFAPWKAR   SAVE REGS ACROSS SETLK   Y02714 44330002
OBT6     SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVPRT0*44360002
               (REL10))  GET SALLOC LOCK                         Y02714 44370002
         LM    RBASE,GMBASE2,CFAPWKAR   RESTORE REGS            Y02714  44378002
         BALR  RRETURN,RBRANCH          BRANCH TO MRELEASF              44380002
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 44382002
         L     RWORK4,FRRPARMS                                   Y02703 44390002
         USING RECOVERY,RWORK4                                          44400002
         OI    FRRFLGS2,VEQRDONE        FRR FOOTPRINT            Y02703 44410002
FREERSM  LM    SIZEREG,SEGREG,REGSAVE2  RESTORE REGS 6-9                44590002
         ST    SEGREG,VRPARMS1          PUT ADDR IN PARM LIST    Y02714 44640002
         SRL   SIZEREG,TWELVE           GET # 4K BLOCKS          Y02714 44650002
         ST    SIZEREG,VRPARMS2         # PAGES IN PARM LIST     Y02714 44652002
         LA    RIN1,VRPARMS             @ PARM LIST              Y02714 44654002
         LA    RWORK3,SAVEAREA          STANDARD SAVE AREA       Y02714 44654402
         L     RBRANCH,RSMFREE          BRANCH @ TO RSM          Y02714 44656002
         BALR  RRETURN,RBRANCH          BRANCH TO FREE REAL REG. Y02714 44658002
         OI    FRRFLAGS,RSMDONE         FRR FOOTPRINT            Y02703 44660002
FREEASQ  LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 44660302
         LM    SIZEREG,SEGREG,REGSAVE2  RESTORE REGS             Y02714 44663302
         LTR   RRETREG,RRETREG          IS RSM R.C. = 0?         Y02714 44665302
         BZ    RETSAVE                  BRANCH IF SO             Y02714 44665402
         LA    RRETREG,RC4              IF NOT, FREEPART R.C.=4  Y02714 44665502
RETSAVE  STH   RRETREG,RCSAVE           SAVE RETURN CODE         Y02714 44665602
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 44667902
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 44670202
REL10    SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRQS,IEAVPRT0(OBT6))     44672502
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 44674602
         LA    RRETREG,RC8              VALUE TO COMPARE         Y02714 44674702
         CR    RRETREG,RWORK3           R.C.= 8?                 Y02714 44677002
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 44679002
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 44679402
         MVI   LDACBSP,SP255            SPID FOR CONTROL BLKS    Y02714 44682502
         L     GMBASE2,RINSAV15         RESTORE GM BASE          Y02714 44687102
         L     PQEREG,ASDPQE            GET @ A.S. PQE           Y02714 44689402
         L     RBRANCH,RELEASE          @ MRELEASF               Y02714 44691702
         BALR  RRETURN,RBRANCH          RETURN REG SPACE TO A.S. Y02714 44694002
*                                       PQE                      Y02714 44696302
         OI    FRRFLAGS,ASDONE          FRR FOOTPRINT            Y02703 44698302
         DROP  RWORK4                                                   44698402
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 44698602
         L     RCVT,CVTADDR             CVT BASE                 Y02714 44700902
         USING CVT,RCVT                                          Y02714 44703202
         LM    SIZEREG,SEGREG,REGSAVE2  RESTORE REGS 6-9         Y02714 44705202
         L     RGDA,CVTGDA              GDA BASE                 Y02714 44705602
         USING GDA,RGDA                                          Y02714 44755602
*   FREE FBQE FROM LSQA                                        @Z30ENYG 44940003
FREECBS  L     RTCB,LDATCB              TCB BASE                 Y02714 44990002
         L     RIN1,TCBPQE              ACCESS DPQE FOR THE TASK        45010002
         L     RWORK1,VRPQE(RIN1)       ACCESS PQE FOR THE TASK         45080001
         L     RIN1,PQEFFBQE            ADDR OF FBQE IN REG 1           45150001
         DROP  RWORK1                   DROP PQE ADDRESSABILITY         45220001
         ST    PQEREG,SAVEAREA          SAVE PQE ADDRESS BY FM @Z30ENYG 45225003
         L     PQEREG,PASCBSV           ADDR ASCB FOR CELL FM  @Z30ENYG 45250003
         FREEMAIN P,BRANCH=YES,A=(RIN1) FREE FBQE CELL         @Z30ENYG 45265003
*   FREE PQE AND DPQE FROM LSQA                                @Z30ENYG 45285003
         L     RIN0,QELNTH              PQE,DPQE IN LSQA       @Z30ENYG 45290003
         LR    RIN1,RWORK1              ADDRESS TO BE FREED    @Z30ENYG 45296003
*                                       (PQE,DPQE ARE CONTIG)  @Z30ENYG 45302003
         LR    RWORK1,RLDA              SAVE LDA ADDR BY FM    @Z30ENYG 45314003
         LR    RLDA,RTCB                TCB ADDR FOR FREEMAIN  @Z30ENYG 45320003
         L     RBRANCH,REGMAIN          FM ENTRY PT (RMBRANCH) @Z30ENYG 45326003
         BALR  RRETURN,RBRANCH          FREE PQE,DPQE          @Z30ENYG 45332003
         LR    RLDA,RWORK1              RESTORE LDA ADDR       @Z30ENYG 45338003
         LA    REG14,CFAPWKAR           RESTORE ADDR SAVEAREA  @Z30ENYG 45344003
         L     PQEREG,SAVEAREA          RESTORE PQE ADDRESS    @Z30ENYG 45350003
         LH    RRETREG,RCSAVE           RESTORE R.C.             Y02714 46192002
ZEROPTRS L     RWORK1,FRRPARMS          BASE FOR FRR PARM AREA   Y02703 46192402
         USING RECOVERY,RWORK1                                          46192802
         OI    FRRFLAGS,ZPFLG           FRR FOOTPRINT            Y02703 46193202
         DROP  RWORK1                                                   46193602
         L     RWORK1,TCBPQE            PQE BASE                 Y02714 46194002
         MVC   TCBPQE(FLWD),ZEROES      ZERO OUT TCBPQE                 46200002
         NI    TCBFLGS6,X'FF'-TCBRV     ZERO REAL VIRTUAL FLAG          46270001
         MVC   VVREGSZ(4),ZEROES        ZERO REG. SIZE IN LDA    Y02714 46320002
         TM    GPSW,VERREQ              IS THIS A V=R REGION?    Y02714 46330002
         BO    FPCHK                    SEE IF WAITING REQUESTS  Y02714 46332002
*                                       CAN BE HONORED NOW       Y02714 46334002
         USING PQESECT,RWORK1                                    Y02714 46338002
         L     RWORK1,VRPQE(RWORK1)     ACCESS PQE @             Y02714 46340502
*  RESTORE POINTERS THAT COULD HAVE BEEN CHANGED FOR A V=V       Y02714 46345702
*  SPECIFIC REQUEST.                                             Y02714 46348202
         L     RWORK3,LDASRPQE          GET @ SYS. REG PQE       Y02714 46350202
         CR    RWORK1,RWORK3            IS THIS SYS REG PQE?     Y02714 46350302
         BE    RTN0                     IF SO, DO NOT ADJUST     Y02714 46350402
         CLC   CURRGNTP(FLWD),PQEREGN   CHECK FOR CURRGNTP = START      46350502
*                                       OF PQE BEFORE ANY ADJUSTMENT.   46350602
*                                       IF NOT, THIS MEANS THERE        46350802
*                                       ARE FIXED, DEFERRED RELEASE     46351002
*                                       PAGES IN THE ADDRESS SPACE.     46351402
         BE    OKNOFIX                  IF =, BRANCH OK                 46352202
         LA    RWORK3,SAVEAREA          SAVEAREA FOR RTM                46356002
         CALLRTM  TYPE=MEMTERM,COMPCOD=FIXDPAGE   TERMINATE CURRENT     46356902
*                                       ADDRESS SPACE.                  46358102
         LA    REG14,CFAPWKAR           RESTORE REGISTER 14    @ZA02596 46358603
         B     RTN0                     GO THRU MOTIONS OF RETURN       46359102
*                                       PROCESSING---BUT CURRENT        46359502
*                                       ADDRESS SPACE WILL BE           46359902
*                                       TERMINATED.                     46360402
OKNOFIX  L     RWORK3,PQESIZE-PQESECT(RWORK3) SIZE OF SYSTEM REGION     46361002
         LR    RWORK15,RWORK3           SIZE IN REG 15           Y02714 46362002
         A     RWORK15,PASTRT           ADD SIZE TO P.A. START   Y02714 46363002
         ST    RWORK15,PQEREGN          V=V PQE START            Y02714 46364002
         L     RWORK15,PASIZE           SIZE OF PRIVATE AREA     Y02714 46365002
         SR    RWORK15,RWORK3           SUBTRACT SIZE OF SYS. REGION    46366002
         ST    RWORK15,PQESIZE          V=V PQE SIZE             Y02714 46367002
         L     RWORK2,PQEFFBQE          @ 1ST FBQE               Y02714 46368002
         USING FBQESECT,RWORK2                                   Y02714 46369002
         L     RWORK15,FBQAREA          1ST FREE AREA START @    Y02714 46370002
         S     RWORK15,PASTRT           SUBTRACT START OF PRIVATE AREA  46370902
         SR    RWORK15,RWORK3           SUBTRACT SIZE OF SYS. REGION    46371802
         A     RWORK15,SIZE             ADD SIZE OF FREE AREA    Y02714 46372802
         ST    RWORK15,SIZE             THIS IS SIZE OF FREE AREAY02714 46373802
         L     RWORK15,PASTRT           START OF PRIVATE AREA    Y02714 46374802
         AR    RWORK15,RWORK3           ADD SIZE OF SYSTEM REGIONY02714 46375802
         ST    RWORK15,FBQAREA          THIS IS FREE AREA START  Y02714 46376802
         ST    RWORK15,CURRGNTP         ADJUST PTR FOR VGM00    YM01960 46377802
         B     RTN0                     END OF V=V FREEPART      Y02714 46378802
FPCHK    L     RWORK1,FRRPARMS          BASE FOR FRR PARM AREA   Y02703 46379802
         USING RECOVERY,RWORK1                                          46381802
         OI    FRRFLAGS,FPFLG           FRR FOOTPRINT            Y02703 46391802
         DROP  RWORK1                                                   46393802
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 46396002
OBT7     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(VRQS,IEAVPRT0(*46397002
               REL11,REL12)) GET SALLOC LOCK                     Y02714 46397402
         LM    RBASE,REG14,CFAPWKAR     RESTORE REGS             Y02714 46402002
         TM    GDAFLAGS,WAITQUE         ANY SPEC REQUESTS WAITINGY02714 46403002
         BO    CHKSPEC1                 BRANCH IF SO             Y02714 46404002
         CLC   VRWFEL(FLWD),ZEROES      ANY ELS ON WAITQ?        Y02714 46405002
         BE    UNLOCK                   BRANCH IF NOT            Y02714 46406002
*  IF ONLY NON-SPECIFIC REQUESTS ON VRWAITQ, POST AS MANY OF     Y02714 46407002
*  THEM AS WILL FIT IN FREE SPACE.                               Y02714 46408002
         L     FBQEREG,PQEFFBQE         GET 1ST V=R FREE AREA    Y02714 46409002
         CR    FBQEREG,PQEREG           ARE THERE ANY MORE?      Y02714 46410002
         BE    RETURN                   BRANCH IF NONE           Y02714 46421502
         DROP  RWORK2                                            Y02714 46423502
         USING FBQESECT,FBQEREG                                  Y02714 46431502
         SR    CTR,CTR                  ZERO COUNTER             Y02714 46433502
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 46435502
         L     RWORK4,SIZE              GET FREE AREA SIZE       Y02714 46437502
         ST    RWORK4,SIZES             FREE AREA SIZE IN TABLE  Y02714 46439502
COMPPQE  LA    RSIZE,SIZES              @ OF SIZE TABLE          Y02714 46439602
         LA   RWORK4,FSTWORD(CTR,RSIZE) @ LAST EL IN TABLE       Y02714 46439702
         C     PQEREG,FWDPTR            ANY MORE V=R FREE AREAS  Y02714 46439902
         BNE   NEXTFBQE                 BRANCH IF YES            Y02714 46440302
         OI    FSTBYTE(RWORK4),LASTENT  FLAG EL IN TABLE AS LAST Y02714 46440702
         B     CHKELS                   BRANCH TO CHECK Q ELS    Y02714 46441102
NEXTFBQE LA    CTR,FLWD(CTR)            INCREMENT COUNTER        Y02714 46447602
         L     FBQEREG,FWDPTR           GET NEXT FREE AREA       Y02714 46451602
         L     RWORK4,SIZE              GET NEXT SIZE            Y02714 46453602
         ST    RWORK4,FSTWORD(CTR,RSIZE) STORE SIZE NEXT IN TABLEY02714 46454002
         B     COMPPQE                  SEE IF MORE              Y02714 46460502
CHKELS   L     ELBASE,VRWFEL            GET 1ST EL ON WAITQ      Y02714 46462502
         USING VRWPQEL,ELBASE                                    Y02714 46464502
COMP     CLC   WPELSIZE+1(BYTES3),SNDBYTE(RSIZE) COMPARE REQUESTED SIZE 46466502
*                                       WITH SIZE OF FREE AREA   Y02714 46466902
         BNH   SUBTRACT                 IF NOT GREATER, BRANCH   Y02714 46483502
         TM    FSTBYTE(RSIZE),LASTENT   LAST TABLE ENTRY?        Y02714 46493502
         BO    LASTSIZE                 BRANCH IF YES            Y02714 46495502
         LA    RSIZE,FLWD(RSIZE)        INCREMENT POINTER        Y02714 46497502
         B     COMP                     CHECK NEXT FREE AREA SIZEY02714 46499502
LASTSIZE L     ELBASE,WPNEXTEL          GET NEXT NON-SPEC ON Q   Y02714 46499902
         LTR   ELBASE,ELBASE            MORE ELS?                Y02714 46500002
         BZ    UNLOCK                   DONE IF NOT              Y02714 46500102
         LA    RSIZE,SIZES              RESET POINTER            Y02714 46505602
         B     COMP                     COMPARE SIZES            Y02714 46507602
SUBTRACT L     RWORK3,WPELSIZE          SIZE                     Y02714 46509602
         L     RWORK2,FSTWORD(RSIZE)    FREE AREA SIZE FROM TABLEY02714 46510002
         LA    RWORK2,0(RWORK2)         CLEAR HIGH ORDER BYTE    Y02714 46510102
         SR    RWORK2,RWORK3            SUBTRACT SIZES           Y02714 46510402
         STCM  RWORK2,MASK7,SNDBYTE(RSIZE) STORE REMAINING FREE AREA    46510802
*                                       IN TABLE (DON'T CLOBBER         46511802
*                                       LASTEL FLAG)             Y02714 46512802
         LA    RWORK5,VRWAITQ           INDICATE WAITQ           Y02714 46516702
         L     RWORK15,FRRPARMS                                  Y02703 46517102
         BAL   RRETURN,DEQUEUE          BRANCH TO DEQUEUE EL     Y02714 46518702
SAVENEXT L     NEXT,WPNEXTEL            SAVE @ NEXT EL ON Q      Y02714 46520702
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 46530702
         STM   REG0,REG14,CFAPWKAR      SAVE REGS ACROSS POST    Y02714 46531102
         LR    SEGREG,RLDA              SAVE LDA BASE ACROSS POSTY02714 46531502
         LA    RWORK1,RC4               COMPLETION CODE          Y02714 46531902
         LM    RWORK2,RWORK3,WPERRADD   PARMS FOR XMPOST         Y02714 46532302
         L     RBASE,HIBITON            INDICATE XMPOST          Y02714 46532402
         ICM   RBASE,MASK7,WPECBADD+1   ECB ADDRESS              Y02714 46532502
         L     RCVT,CVTADDR             CVT BASE ADDRESS         Y02714 46534402
         USING CVT,RCVT                                          Y02714 46538302
         L     RBRANCH,CVT0PT01         BRANCH ENTRY POINT       Y02714 46539202
         BALR  RRETURN,RBRANCH          POST THE REQUESTOR       Y02714 46540202
         USING GDA,RGDA                                          Y02714 46542102
         LR    RLDA,SEGREG              RESTORE LDA ADDRESS      Y02714 46544002
         LM    REG0,REG14,CFAPWKAR      RESTORE REGS             Y02714 46544902
         L     RWORK2,VRWFEL            FIRST EL ON WAITQ        Y02714 46545902
         LTR   RWORK2,RWORK2            ANY ELS ON Q?            Y02714 46547802
         BZ    TURNOFF                  IF NOT TURN OFF WAITQUE  Y02714 46548802
         CLC   SPADDR(FLWD,RWORK2),ZEROES   ANY SPECS ON WAITQ?  Y02714 46549802
         BNE   SPECTST1                 BRANCH IF SPEC           Y02714 46550802
TURNOFF  NI    GDAFLAGS,X'FF'-WAITQUE   TURN OFF WAIT BIT        Y02714 46551802
SPECTST1 CLC   WPSPADDR(FLWD),ZEROES    THIS EL FOR SPEC REQUEST?Y02714 46552802
         BNE   PENQ                     IF SO, ENQ EL ON POSTQ   Y02714 46557802
         ST    RADDR,SAVEAREA+8         SAVE REG 2               Y02714 46558202
         BAL   RADDR,FMAIN              GO FREE THE ELEMENT      Y02714 46558402
         L     RADDR,SAVEAREA+8         RESTORE REG 2            Y02714 46558602
LAST     LR    ELBASE,NEXT              GET NEXT WAITING ELEMENT Y02714 46570302
         LA    RSIZE,SIZES              BEGINNING OF SIZE TABLE  Y02714 46573802
         LTR   ELBASE,ELBASE            ARE THERE MORE ELS?      Y02714 46577302
         BNZ   COMP                     SEE IF SHOULD POST IT    Y02714 46580802
UNLOCK   LH    RRETREG,RCSAVE           GET RETURN CODE          Y02714 46584302
         STM   RBASE,REG14,CFAPWKAR     SAVE REGS ACROSS SETLK   Y02714 46587802
REL11    SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VRWPQEL,IEAVPRT0(OBT7))  46589902
         L     RBASE,CFAPWKAR           RESTORE BASE REG         Y02714 46602402
         LA    RWORK2,RC8               VALUE TO COMPARE         Y02714 46604502
         CR    RWORK2,RWORK3            R.C.= 8?                 Y02714 46606502
         BE    O82ABEND                 GO TO FRR TO RECORD      Y02714 46608502
         LM    RWORK2,REG14,CFAPWKAR+FLWD RESTORE REGS           Y02714 46608602
         L     RWORK2,FRRPARMS          BASE FOR FRR PARMS       Y02714 46608702
         USING RECOVERY,RWORK2                                          46612502
         TM    FRRFLAGS,GPFPFLG         IS THIS A GETPART?       Y02714 46614602
         BO    RETURN                   DO NOT ADJUST CURRGNTP IF GP    46616702
         DROP  RWORK2                                                   46617702
         L     PQEREG,ASDPQE            @ OF AS PQE                     46618802
         L     PQEREG,PQEFFBQE-PQESECT(PQEREG)   @ OF 1ST FBQE          46620902
         MVC   CURRGNTP(FLWD),FBQAREA-FBQESECT(PQEREG) ADJUST FOR VGM00 46622902
*                                                               YM01960 46625102
         B     RETURN                   RETURN                   Y02714 46631402
CHKSPEC1 L     ELBASE,VRWFEL            1ST EL ON WAITQ          Y02714 46641902
         USING VRWPQEL,ELBASE                                    Y02714 46648202
CHKSPEC  L     RADDR,WPSPADDR           SPECIFIC ADDRESS         Y02714 46654502
         L     RWORK2,WPELSIZE          END ADDRESS              Y02714 46658702
         OI    GPSW,POSTCHK             INDICATE THIS IS POST    Y02714 46665002
*                                       CHECKING                 Y02714 46671302
         B     COMONCHK                 BRANCH TO SEE IF THIS    Y02714 46677602
*                                       REQUEST WILL FIT IN FREE Y02714 46681802
*                                       SPACE                    Y02714 46688102
PSTCHK   LTR   REG0,REG0                SUCCESSFUL RETURN        Y02714 46694402
         BNZ   LP1                      BRANCH IF NOT            Y02714 46700702
         LA    RWORK5,VRWAITQ           INDICATE EL ON WAITQ     Y02714 46710402
         L     RWORK15,FRRPARMS                                  Y02703 46713402
         LA    RRETURN,SAVENEXT         RETURN POINT             Y02714 46716402
         B     DEQUEUE                  DEQUEUE EL FROM WAITQ    Y02714 46722402
LP1      LR    FIRSTSAV,ELBASE          SAVE 1ST EL @            Y02714 46728402
*  SEE IF ANOTHER REQUEST CAN BE HONORED WITHOUT INTERFERING     Y02714 46734402
*  WITH FIRST REQUEST ON VRWAITQ.                                Y02714 46740402
LOOP1    L     ELBASE,WPNEXTEL          GET NEXT EL              Y02714 46745402
         LTR   ELBASE,ELBASE            ANOTHER ELEMENT?         Y02714 46750402
         BZ    UNLOCK                   BRANCH IF NOT            Y02714 46755402
         CLC   WPSPADDR(FLWD),ZEROES    IS THIS A SPEC EL        Y02714 46760402
         BE    UNLOCK                   BRANCH IF NON-SPEC       Y02714 46765402
OVERLAP  CLC   WPSPADDR(FLWD),SPADDR(FIRSTSAV) START 2>START 1?  Y02714 46770402
         BH    TEST2                    BRANCH IF YES            Y02714 46775402
         CLC   WPELSIZE,SPADDR(FIRSTSAV)    END 2>=START 1?      Y02714 46780402
         BNL   LOOP1                    OVERLAPS-TRY NEXT EL     Y02714 46785402
         B     CHKSPEC                  CAN THIS REQUEST BE HON         46790402
TEST2    CLC   WPSPADDR(FLWD),ELSIZE(FIRSTSAV) START 2>END 1?    Y02714 46795402
         BNH   LOOP1                    IF NOT, OVERLAPS         Y02714 46800402
         B     CHKSPEC                  YES-ATTEMPT TO HONOR IT  Y02714 46805402
*  ENQUEUE AN ELEMENT ON THE VRPOSTQ                             Y02714 46810402
PENQ     MVC   WPPREVEL(FLWD),ZEROES    ENQUEUE AT HEAD OF QUEUE Y02714 46815402
         MVC   WPNEXTEL(FLWD),VRPFEL    NEW FORWARD PTR          Y02714 46820402
         CLC   VRPFEL(FLWD),ZEROES      WERE THERE ELS ON Q?     Y02714 46825402
         BE    STBASE                   BRANCH IF NOT            Y02714 46830402
         L     RWORK4,VRPFEL            @ PREVIOUS FIRST EL      Y02714 46835402
         ST    ELBASE,SNDWORD(RWORK4)   OLD ELS BACK PTR         Y02714 46840402
STBASE   ST    ELBASE,VRPFEL            NEW 1ST EL @             Y02714 46845402
         CLC   VRPLEL(FLWD),ZEROES      WERE THERE ELS ON Q      Y02714 46850402
         BNE   UNLOCK                   BRANCH IF SO             Y02714 46855402
         ST    ELBASE,VRPLEL            NEW LAST EL @            Y02714 46860402
         B     UNLOCK                   GO RELEASE LOCK                 46865402
*  DEQUEUE AN ELEMENT FROM VRWAITQ OR VRPOSTQ                    Y02714 46896002
         USING RECOVERY,RWORK15                                         46916002
DEQUEUE  OI    FRRFLGS2,DEQFLG          FRR FOOTPRINT            Y02703 46926002
         CLC   WPNEXTEL(FLWD),ZEROES    IS THIS THE LAST EL      Y02714 46942802
         BNE   NOTLAST                  BRANCH IF NOT LAST       Y02714 46989602
         CLC   WPPREVEL(FLWD),ZEROES    IS THIS THE FIRST EL     Y02714 47036402
         BNE   NOTONLY                  BRANCH IF NOT            Y02714 47083202
         SR    RWORK4,RWORK4            ZERO REG                 Y02714 47130002
         ST    RWORK4,FSTWORD(RWORK5)   ZERO 1ST EL PTR          Y02714 47176802
         ST    RWORK4,SNDWORD(RWORK5)   ZERO LAST EL PTR         Y02714 47223602
         NI    FRRFLGS2,X'FF'-DEQFLG    TURN OFF FLAG            Y02714 47233602
         BR    RRETURN                  BRANCH TO POST REQUESTER Y02714 47270402
NOTONLY  L     RWORK4,WPPREVEL          PREVIOUS EL @            Y02714 47317202
         MVC   FSTWORD(FLWD,RWORK4),WPNEXTEL     NEW NEXT PTR    Y02714 47364002
*                                       IN PREVIOUS EL                  47410802
         MVC   SNDWORD(FLWD,RWORK5),WPPREVEL     NEW LAST PTR IN Y02714 47457602
*                                       ANCHOR BLOCK                    47504402
         NI    FRRFLGS2,X'FF'-DEQFLG    TURN OFF FLAG            Y02703 47514402
         BR    RRETURN                  BRANCH TO POST REQUESTER Y02714 47551202
NOTLAST  CLC   WPPREVEL(FLWD),ZEROES    IS THIS THE FIRST EL     Y02714 47598002
         BNE   MIDDLE                   NO-DEQUEUE FROM MIDDLE   Y02714 47644802
         L     RWORK4,WPNEXTEL          @ OF NEXT EL             Y02714 47691602
         MVC   SNDWORD(FLWD,RWORK4),WPPREVEL     NEW PREV PTR IN Y02714 47738402
*                                       OLD NEXT                        47785202
         MVC   FSTWORD(FLWD,RWORK5),WPNEXTEL     NEW 1ST PTR IN  Y02714 47832002
*                                       ANCHOR BLOCK                    47878802
         NI    FRRFLGS2,X'FF'-DEQFLG    TURN OFF FLAG            Y02703 47888802
         BR    RRETURN                  BRANCH TO POST REQUESTER Y02714 47925602
MIDDLE   L     RWORK4,WPNEXTEL          NEXT EL @                Y02714 47972402
         MVC   SNDWORD(FLWD,RWORK4),WPPREVEL     NEW PREV PTR IN Y02714 48019202
*                                       NEXT EL                         48066002
         L     RWORK4,WPPREVEL          PREV EL @                Y02714 48112802
         MVC   FSTWORD(FLWD,RWORK4),WPNEXTEL     NEW NEXT PTR IN Y02714 48159602
*                                       PREVIOUS EL                     48206402
         NI    FRRFLGS2,X'FF'-DEQFLG    TURN OFF FLAG            Y02703 48216402
         BR    RRETURN                  RETURN                   Y02714 48253202
         EJECT                                                          48300002
*********************************************************************** 48370001
* STATUS                                                              * 48440001
*    CHANGE LEVEL 000                                                 * 48510001
* FUNCTION                                                            * 48580001
*    THIS SECTION OF GETPART, THAT IS GETPART SPECIFIC, OBTAINS CORE  * 48650001
*    AT AN ACTUAL ADDRESS. THE FOLLOWING TYPE OF GETPART SPECIFIC IS  * 48720001
*    SUPPORTED: ECB MODE SINGLE REGION LIST REQUEST(SVC 4).           * 48790001
* ENTRY POINTS                                                        * 48860001
*         GETSPEC                                                     * 48930001
*    THIS IS THE INTERNAL BRANCH ENTRY POINT. THIS FUNCTION OF GETPART* 49000001
*    IS ENTERED WHEN THE ROUTINE RECOGNIZES THAT THE REGION ADDRESS   * 49070001
*    REQUESTED FIELD IN THE GETPART WORK AREA IS NON-ZERO.            * 49140002
*    THIS ROUTINE IS ALSO ENTERED AFTER A V=R REGION HAS BEEN         * 49280002
*    ALLOCATED, AND THE V=V REGION MUST BE ALLOCATED AT THE SAME      * 49350002
*    ADDRESS.                                                         * 49420002
* INPUT                                                               * 49490001
*    AT THE TIME THIS LOGIC IS ENTERED, DETERMINATION HAS BEEN MADE AS* 49560001
*    TO WHETHER THE REQUEST IS FOR A V=V OR V=R REGION. THE ADDRESS OF* 49630001
*    THE V=R OR V=V PQE IS PASSED IN PQEREG, AND THE ROUNDED REGION   * 49700001
*    SIZE IS PASSED IN SIZEREG. THE SPECIFIC ADDRESS OF THE REGION IS * 49770001
*    PASSED IN RADDR. IF ENTRY IS FROM V=R ALLOCATION THEN RWORK2     * 49840002
*    MUST CONTAIN THE END ADDRESS OF THE SPECIFIC REGION.             * 49910001
* OUTPUT                                                              * 49980001
*    THE ADDRESS OF THE V=V OR V=R PQE IS PASSED IN PQEREG; THE       * 50050001
*    ROUNDED REGION SIZE IS IN SIZEREG, AND IF THE GETPART IS SUCCESS-* 50120001
*    FUL, THE SPECIFIC ADDRESS OF THE REGION IS IN SEGREG.            * 50190001
* EXTERNAL REFERENCES                                                 * 50260001
*         GETMAING                                                    * 50330002
*    TO ALLOCATE SPACE IN SQA FOR AN ADDITIONAL FBQE.                 * 50400001
*         RMBRANCH                                                    * 50470001
*    TO FREE SPACE IN SQA FOR AN FBQE NO LONGER NEEDED                * 50540001
* EXITS,NORMAL                                                        * 50820001
*    TO RTN04 IN THE GETPART LOGIC WHEN THE FREE SPACE AVAILABLE AT   * 50890001
*    THE CURRENT TIME CANNOT CONTAIN THE SPECIFIC REGION REQUESTED. TO* 50960001
*    CKONEDN OF THE GETPART LOGIC WHEN THE REGION HAS BEEN SUCCESS-   * 51030001
*    FULLY ALLOCATED.                                                 * 51100001
* EXITS,ERROR                                                         * 51170001
*    TO RTN08 IN THE GETPART LOGIC WHEN THE REQUEST IS OUTSIDE THE    * 51240001
*    BOUNDS OF THE DYNAMIC AREA. TO RET20 IN GETPART LOGIC WHEN THE   * 51310002
*    requested SPACE IS FRAGMENTED WITH SYSTEM SPACE LSQA/SWA/SP229,230 51360002
* TABLES AND WORK AREAS                                               * 51380001
*    THE CHAIN OF FBQES FOR THE DYNAMIC AREA WHICH IS ANCHORED BY THE * 51450001
*    PQEFFBQE FIELD OF THE PQE.                                       * 51520001
* ATTRIBUTES                                                          * 51590001
*    REENTRANT, REFRESHABLE                                           * 51660002
* CHARACTER CODE DEPENDENCY                                           * 51730001
*    SAME AS GETPART                                                  * 51800001
* NOTES                                                               * 51870001
*    NONE                                                             * 51940001
*********************************************************************** 52010001
         USING PQESECT,PQEREG                                           52080001
GETSPEC  C     RADDR,PQEREGN            COMPARE REGION START @ TO DY-   52150001
         BL    RET8                     NAMIC START @. BRANCH IF LOW    52220002
         L     RWORK3,PQEREGN           ACCESS DYNAMIC START @          52290001
         A     RWORK3,PQESIZE           ADD DYNAMIC AREA SIZE           52360001
         CR    RADDR,RWORK3             COMPARE REGION START @ TO DY-   52430001
         BNL   RET8                     NAMIC END @. BRANCH IF NOT LOW  52500002
         LR    RWORK2,SIZEREG           ACCESS REGION SIZE              52570001
         AR    RWORK2,RADDR             ADD REGION START @              52640001
         CR    RWORK2,RWORK3            COMPARE REGION END @ TO DYNAMIC 52710001
         BH    RET8                     END @. BRANCH IF HIGH           52780002
COMONCHK L     RWORK1,PQEFFBQE          ACCESS FIRST FBQE               52850002
         USING FBQESECT,RWORK1          ADDRESSABILITY FOR FBQE         52920001
LOOP     CR    RWORK1,PQEREG            IS THERE ANOTHER FBQE?          52990001
         BE    RET20                    BRANCH IF NOT                   53060002
         C     RADDR,FBQAREA            COMPARE REGION START @ TO FREE  53130001
         BL    RET4                     START @. BRANCH IF LOW.         53200002
         L     RWORK3,SIZE              ACCESS FREE AREA SIZE           53270001
         A     RWORK3,FBQAREA           ADD FREE AREA START @           53340001
         CR    RWORK3,RADDR             COMPARE FREE END @ TO REGION    53410001
         BL    FBQELOOP                 START @. BRANCH IF LOW          53480001
         CR    RWORK2,RWORK3            COMPARE REGION END @ TO FREE    53550001
         BH    RET20                    END @. BRANCH IF HIGH.          53620002
         TM    GPSW,POSTCHK             IS POSTCHK FLAG ON?      Y02714 53670002
         BZ    VRSTEST                  IF NOT, V=R SPEC?        Y02714 53680002
         NI    GPSW,X'FF'-POSTCHK       TURN OFF POSTCHK FLAG    Y02714 53682002
         LA    REG0,RC0                 RC = 0 IN REG 0          Y02714 53684002
         B     PSTCHK                   BRANCH TO POSTING ATTEMPTY02714 53686002
VRSTEST  TM    GPSW,VERREQ              V=R REQUEST?             Y02714 53688002
         BZ    NOTVRSPC                 BRANCH IF NOT            Y02714 53688402
         TM    GPSW,GPSSW               V=R SPECIFIC?            Y02714 53688502
         BZ    NOTVRSPC                 BRANCH IF NOT            Y02714 53688602
         TM    GPSW,ALOCPASS            HAS ALLOCATION BEEN DONE Y02714 53688802
         BZ    SPECREAL                 BRANCH TO ALLOCATE V=R   Y02714 53689202
         NI    GPSW,X'FF'-ALOCPASS      TURN FLAG OFF            Y02714 53689602
NOTVRSPC L     RWORK15,FRRPARMS         FRR PARM BASE            Y02703 53739602
         ST    RWORK1,RW1SAVE           FRR INFO                 Y02703 53789602
         DROP  RWORK15                                                  53839602
         LR    RSIZE,RADDR              ACCESS REGION START @           54390002
         S     RSIZE,FBQAREA            SUBTRACT FREE START @           54460001
         BZ    SET1                     BRANCH IF ADDRESSES EQUAL       54600001
         NI    BIGPSW,X'FF'-STADDRE     TURN OFF SWITCH          Y02714 54610002
         TM    GPSW,VERREQ                                       Y02714 54650002
         BZ    VIRTSPEC                 BRANCH IF V=V            Y02714 54660002
         ST    RSIZE,SIZE               STORE DIFFERENCE IN FBQE        54670001
OTHREND  SR    RWORK3,RWORK2            DIFFERENCE IN END ADDRESSES     54740001
         LR    SEGREG,RADDR             PUT REGION START @ IN SEGREG    54810001
         LTR   RWORK3,RWORK3            CHECK FOR END ADDRESSES EQUAL   54880001
         BZ    CKSWX                    BRANCH IF EQUAL                 54950001
         TM    BIGPSW,STADDRE           CHECK FOR START ADDRESSES EQUAL 55020001
         BO    USEOLD                   BRANCH IF EQUAL                 55090001
*   CONDITION 2: REGION START ADDRESS>FREE AREA START ADDRESS AND       55160001
*   REGION END ADDRESS<FREE AREA END ADDRESS                            55230001
         TM    GPSW,VRORAS              V=R REQUEST?             Y02714 55280002
         BM    SQAID                    BRANCH IF SO             Y02714 55286002
         LA    RIN1,SP255               GET FBQE FROM LSQA     @Z30ENYG 55286603
         B     SAVEREG                    AND NOT FROM SQA     @Z30ENYG 55287203
SQAID    LA    RIN1,SP245               GET FBQE FROM SQA      @Z30ENYG 55287803
SAVEREG  ST    PQEREG,REGSAVE6          SAVE PQE ADDR BY GM    @Z30ENYG 55288403
         L     PQEREG,PASCBSV           ADDR ASCB FOR CELL GM  @Z30ENYG 55302003
         GETMAIN P,BRANCH=YES,SP=(RIN1) GET CELL FOR FBQE      @Z30ENYG 55312003
         LA    REG14,CFAPWKAR           WORKAREA BASE            702714 55332003
         L     PQEREG,REGSAVE6          RESTORE PQE ADDR       @Z30ENYG 55352003
         DROP  RWORK1                                                   55650001
         USING FBQESECT,RIN1            ADDRESSABILITY FOR FBQE         55720001
*   LINES 557700,557900,558400 WERE DROPPED                    @ZM03329 55740003
         ST    RWORK3,SIZE              REMAINING SIZE IN FBQE          55860001
         ST    RWORK2,FBQAREA           NEW FREE START @ IN FBQE        55930001
         MVC   FWDPTR(FLWD),FWDPTR-FBQESECT(RWORK1) NEW POINTS TO NEXT  56000001
         ST    RWORK1,BCKPTR            NEW POINTS TO PREVIOUS          56070001
         L     RWORK2,FWDPTR-FBQESECT(RWORK1) OBTAIN ADDR OF NEXT       56140001
         ST    RIN1,BCKPTR-FBQESECT(RWORK2) NEXT POINTS TO NEW          56210001
         ST    RIN1,FWDPTR-FBQESECT(RWORK1) PREVIOUS POINTS TO NEW      56280001
         B     CKONEDN                  BRANCH TO MAINLINE GETPART      56350001
         DROP  RIN1                                                     56420001
         USING FBQESECT,RWORK1          ADDRESSABILITY FOR FREE FBQE    56490001
*   CONDITION 1: REGION START ADDRESS=FREE AREA START ADDRESS AND       56560001
*   REGION END ADDRESS<FREE AREA END ADDRESS                            56630001
USEOLD   ST    RWORK3,SIZE              REMAINING SIZE IN FBQE          56700001
         ST    RWORK2,FBQAREA           NEW FREE START @ IN FBQE        56770001
         B     CKONEDN                  BRANCH TO MAINLINE GETPART      56840001
CKSWX    TM    BIGPSW,STADDRE           CHECK FOR START ADDRESSES EQUAL 56910001
*   CONDITION 3: REGION START ADDRESS>FREE AREA START ADDRESS AND       56980001
*   REGION END ADDRESS=FREE AREA END ADDRESS                            57050001
         BZ    CKONEDN                  BRANCH TO MAINLINE GETPART      57120001
*   CONDITION 4: REGION START ADDRESS=FREE AREA START ADDRESS AND       57190001
*   REGION END ADDRESS=FREE AREA END ADDRESS                            57260001
         L     RWORK2,BCKPTR            ADDR OF PREVIOUS FBQE           57330001
         L     RWORK3,FWDPTR            ADDR OF NEXT FBQE               57400001
         ST    RWORK3,FWDPTR-FBQESECT(RWORK2) PREVIOUS POINTS TO NEXT   57470001
         ST    RWORK2,BCKPTR-FBQESECT(RWORK3) NEXT POINTS TO PREVIOUS   57540001
         ST    PQEREG,SAVEAREA          SAVE PQE ADDR          @Z30ENYG 57545003
         L     PQEREG,PASCBSV           ASCB ADDR FOR CELL FM  @Z30ENYG 57585003
         FREEMAIN P,BRANCH=YES,A=(RWORK1) FREE FBQE CELL       @Z30ENYG 57590003
         LA    REG14,CFAPWKAR           WORKAREA BASE            Y02714 57620003
         L     PQEREG,SAVEAREA          RESTORE PQE ADDRESS    @Z30ENYG 57720003
         B     CKONEDN                  BRANCH TO MAINLINE GETPART      57960001
FBQELOOP L     RWORK1,FWDPTR            ACCESS ADDR OF NEXT FBQE        58030001
         B     LOOP                     BRANCH TO CHECK FOR ADDR OF PQE 58100001
SET1     OI    BIGPSW,STADDRE           SET BIT FOR START ADDRS EQUAL   58170001
         TM    GPSW,VERREQ              V=R SPEC?                Y02714 58220002
         BZ    VVEND                    BRANCH IF VIRTUAL        Y02714 58230002
         B     OTHREND                  BRANCH TO CHECK END ADDRS       58232002
VIRTSPEC L     RWORK3,SIZE              FREE AREA SIZE           Y02714 58234002
         SR    RWORK3,RSIZE             SUBTRACT SIZE BELOW      Y02714 58236002
*                                       REG START                Y02714 58236402
         ST    RWORK3,SIZE              REMAINING FREE AREA      Y02714 58238002
         ST    RADDR,FBQAREA            START @ OF FREE AREA IN  Y02714 58238402
*                                       PRIVATE AREA             Y02714 58238502
         ST    RADDR,PQEREGN            START @ OF VIRTUAL REGIONY02714 58238802
         L     RWORK3,PQESIZE           SIZE OF PRIVATE AREA     Y02714 58238902
         SR    RWORK3,RSIZE             SIZE-SIZE BELOW REG.STARTY02714 58239002
         ST    RWORK3,PQESIZE           EFFECTIVE VIRT. REG SIZE Y02714 58239202
         B     VVEND                    BRANCH TO FINISH ALLOC.  Y02714 58239602
         DROP  RWORK1                                                   58239902
         DROP  PQEREG                                                   58240002
         EJECT                                                          58260002
*********************************************************************** 58280002
*                           IEALIMIT                                  * 58300002
* THIS IS THE USER EXIT ROUTINE TO LIMIT THE SIZE OF REGION REQUESTS. * 58320002
* the routine PROVIDED HERE WILL RETURN ZERO IN REGISTER 1 IF INPUT   * 58324002
* register 1 iS ZERO (NO REGION SPECIFIED). IF A REGION SIZE WAS      * 58328002
* specified 64K WILL BE ADDER TO IT AND THIS VALUE WILL BECOME THE    * 58332002
* upper limit OF THE SPACE AVAILABLE IN SUBPOOLS 0-127, 251 AND 252.  * 58336002
*                                                                       58339002
*     INPUT:                                                            58342002
*                                                                       58345002
*         R1   V=V JOBS                                                 58348002
*                REGION PARM FROM JCL                                   58351002
*                OR                                                     58354002
*                DEFAULT FROM READER PROC                               58357002
*              V=R JOBS                                                 58360002
*                REGION PARM FROM JCL                                   58363002
*                OR                                                     58366002
*                DEFAULT FROM GLOBAL DATA AREA (IHAGDA)                 58369002
*         R13  ADDRESS OF 18 WORD SAVE AREA                             58372002
*         R14  RETURN ADDRESS                                           58380002
*         R15  ENTRY POINT ADDRESS                                      58385002
*                                                                       58390002
*********************************************************************** 58395002
IEALIMIT CSECT                                                          58400002
         ST    REG15,C16(REG13)         SAVE REGISTER TO USE AS BASE    58420002
         BALR  REG15,0                  GET BASE REGISTER               58426002
         USING *,REG15                                                  58432002
         LTR   REG1,REG1                WAS A REGION SIZE SPECIFIED     58438002
         BZ    LIMITRET                 BR IF NONE SPECIFIED            58444002
         A     REG1,C64K                ADD 64K TO REGION SIZE          58450002
LIMITRET L     REG15,C16(REG13)         RESTORE DESTROYED REGISTER      58460002
         BR    RRETURN                  RETURN TO IEAVPRT0              58470002
C64K     DC    F'65536'                 64K                             58490002
         EJECT                                                          58520001
IEAVPRT0 CSECT                                                          59520002
ZEROES   DC    F'0'                     TO ZERO OUT GPSW                79800001
BQELNTH  DC    X'FF000010'              SUBPOOL NUMBER,LENGTH FBQE/SPQE 79940002
QELNTH   DC    X'FF000028'              SUBPOOL NUMBER, LENGTH PQE,DPQE 80010002
MQELNTH  DC    X'FF000038'              SPID,LENGTH DPQE,PQE,FBQEY02714 80080002
SBQELNTH DC    X'F5000010'              SUBPOOL NUMBER AND LENGTH FBQE  80150001
         DS    0F                                                       80171002
DEFAULT  DC    X'80000000'              DEFAULT REGION SIZE      Y02714 80180002
LIMIT    DC    V(IEALIMIT)              ADDRESS OF USER EXIT            80560002
GETMNB   DC    V(GETMAING)              GETMAING ROUTINE                80780002
RELEASE  DC    V(MRELEASF)              MRELEASF ROUTINE                80920002
REGMAIN  DC    V(RMBRANCH)              RMBRANCH                        81060001
ERRADD   DC    V(PRT0ERTN)              @ ASYNC ERROR EXIT RTN   Y02714 81930002
FRRTN    DC    V(IEAVGPRR)              @ IEAVPRT0 FRR           Y02714 81932002
         EJECT                                                          81970001
         IKJTCB                         TCB                             82040001
         EJECT                                                          82110001
         CVT   SYS=AOS2,OPTIONS=(TSLICE),TSO=YES,DSECT=YES,PREFIX=NO    82180001
         EJECT                                                          82250001
         IHAGDA                                                  Y02714 82300002
         IHALDA                                                  Y02714 82350002
         EJECT                                                          82390001
         IHAFBQE                        FBQE                            82600001
         IHAPQE                         PQE                             82670001
         IHASPQE                        SPQE                    Y02714  82740002
         IHADQE                         DQE                             82810001
         IHAFQE                         FQE                             82860001
         IHAWPQEL                                                Y02714 82910002
         IEFTCT                                                  Y02714 82960002
         EJECT                                                          83334302
         IEZJSCB                        JOB STEP CONTROL BLOCK          83339402
         EJECT                                                          83354702
         IHAPVT                         PVT                      Y02714 83364702
         EJECT                                                          83366702
         IHAPSA                         FIXED LOW CORE AND PSA   Y02714 83370002
         EJECT                                                          83440001
         IHAFRRS                        FUNCTIONAL RECOVERY RTNS Y02714 83470002
         EJECT                                                          83480002
WORKAREA DSECT                          MAPPING OF CFAPWKAR      Y02714 83490002
SAVEAREA DS    18F                      STANDARD SAVE AREA       Y02714 83500002
VEQRWORK DS    4F                       WORK AREA FOR IEAVEQR    Y02714 83500402
RINSAVE  DS    16F                      INPUT SAVE AREA          Y02714 83502002
DRINSAV  EQU   CFAPWKAR+88       RINSAV DISPLACEMENT FROM LDA    Y02714 83502402
DRINSV15 EQU   CFAPWKAR+148             DISPLACEMENT FROM LDA    Y02714 83502802
REGSAVE  DS    6F                       REGISTER SAVE AREA       Y02714 83504002
RCSAVE   DS    H                        RETURN CODE SAVE AREA    Y02714 83506002
VRPARMS  DS    3F                       V=R PARAMETER LIST       Y02714 83508002
FRRPARMS DS    F                        @ OF PARM AREA FOR FRR   Y02714 83508102
GPSW     DS    F                        SWITCHES BYTE            Y02714 83508402
* SWITCHES BY BIT  BYTE 0                                               83508802
*        BIT0 = ADDRESS SPCE BIT BIT 4 = GETPART SPECIFIC REQUEST       83509202
*             Q PROCESSING                                              83509602
*        BIT 1 = POSTED-     BIT 5 = FREEPART REQUEST                   83509740
*                SPECIFIC REQUEST                                       83523240
*        BIT 2 = BYPASS V=R  BIT 6 = V=R REQUEST                        83526240
*                ALLOCATION                                             83533202
*        BIT 3 = CHECKING    BIT 7 = SVC 4 REQUEST                      83543202
*                OF POST Q                                              83553202
* SWITCHES BY BIT  BYTE 1                                               83555202
*        BIT 0 = UNSUCCESSFUL V=R SCAN BIT 4 = UNUSED                   83555602
*        BIT 1 = UNUSED                BIT 5 = UNUSED                   83556002
*        BIT 2 = START @S EQUAL IN GPS BIT 6 = UNUSED                   83556402
*        BIT 3 = UNUSED                BIT 7 = UNUSED                   83556502
FRPRT    EQU   X'04'                    FREEPART REQUEST       @ZA08170 83561540
DGPSW    EQU   CFAPWKAR+196             DISPLACEMENT FROM LDA    Y02714 83568102
SRREG    DS    F             SYSTEM REGION SIZE                  Y02714 83570102
ALLOCVR  DS    F             RSM V=R ALLOCATION E.P.             Y02714 83572102
RSMFREE  DS    F             RSM FREE REAL ROUTINE E.P.          Y02714 83574102
SAVE1FRR DS    F                        SAVE REG FOR FRR        YM07262 83575102
****THESE 2 ELEMENTS MUST ALWAYS BE LAST IN THE WORKAREA DSECT TO  **** 83578102
****ALLOW FOR EXPANSION OF THE SIZES TABLE.                        **** 83580102
SAVEFBQE DS    F                       SAVE AREA FOR FBQE ADDRESSY02714 83580402
SIZES    EQU   SAVEFBQE+4              FBQE SIZES TO COMPARE FOR Y02714 83592002
*                                       ALLOCATION OF V=R NON-          83602002
*                                       SPECIFIC REQUESTS               83602402
         EJECT                                                          83603602
*                                                                     * 83605602
* THIS DSECT MAPS THE SIX WORD FRR PARM AREA SUPPLIED BY THE SETFRR   * 83607602
*                                                                     * 83609602
RECOVERY DSECT                                                   Y02714 83613602
FRRFLAGS DS    BL1                 FOOTPRINTS FOR RECOVERY       Y02714 83614002
RSMDONE  EQU   X'80'               RSM ALLOCATION DONE FOR V=R   Y02714 83614402
ASDONE   EQU   X'40'               V=R REGION SUBTRACTED FROM    Y02714 83614802
*                                  ADDRESS SPACE QUEUES                 83614902
CBGFLG  EQU   X'20'               V=R CONTROL BLOCKS PROCESSING  Y02714 83615002
FPFLG    EQU   X'04'               FPCHK ENTERED                 Y02714 83621002
ZPFLG    EQU   X'02'               ZEROPTRS ENTERED              Y02714 83621402
GPFPFLG  EQU   X'01'               ON-GETPART,OFF-FREEPART       Y02714 83621502
FRRFLGS2 DS    BL1                                                      83621602
DEQFLG   EQU   X'80'               DEQUEUE IN PROCESS            Y02714 83621702
WENQFLG  EQU   X'40'               WAIT EL ENQUEUE IN PROCESS    Y02714 83625002
PENQFLG  EQU   X'20'               POST EL ENQUEUE IN PROCESS    Y02714 83627002
VEQRDONE EQU   X'10'               V=R REGION SUBTRACTED FROM    Y02714 83627102
*                                  V=R QUEUES                           83627202
         DS    BL2                                                      83627402
REGSIZE  DS    F                   REGION SIZE REQUESTED         Y02714 83627802
REGADD   DS    F                   REGION START ADDRESS          Y02714 83628202
LDAADD   DS    F                   LDA ADDRESS                   Y02714 83628302
RW1SAVE  DS    F                   SAVE AREA FOR REG 10          Y02714 83628402
PRT0BASE DS    F                   FIRST PRT0 BASE REGISTER     YM07262 83628502
         EJECT                                                          83635102
IEAVPRT0 CSECT                                                          83638402
*   REGISTER EQUATES                                                    83641402
RIN0     EQU   0                        INPUT REGISTER 0                83644402
SEGNDX   EQU   0                        SEGMENT INDEX REGISTER          83650001
RLENGTH  EQU   0                        REGISTER CONTAINING LENGTH      83720001
REG0     EQU   0                        REGISTER 0                      83790001
RIN1     EQU   1                        INPUT REGISTER 1                83860001
REG1     EQU   1                        WORK REGISTER 1                 83930002
RDQE     EQU   1                        DQE REGISTER                    84000001
ELBASE   EQU   1                        BASE FOR WAIT/POST ELS   Y02714 84120002
LIM      EQU   1                        PARM FOR USER EXIT              84125002
CTR      EQU   2                        COUNTER                  Y02714 84130002
REGSTART EQU   2                        START OF REGION          Y02714 84132002
RADDR    EQU   2                        ADDRESS REGISTER                84140001
RCVT     EQU   3                        CVT REGISTER                    84210001
RGDA     EQU   3                        GDA BASE                 Y02714 84260002
RLDA     EQU   4                        LDA BASE                 Y02714 84270002
RSPID    EQU   5                        SUBPOOL ID REGISTER             84350001
RWORK4   EQU   5                        WORK REGISTER 4                 84420001
SIZEREG  EQU   6                        SIZE REGISTER                   84490001
RWORK5   EQU   6                        WORK REGISTER            Y02714 84540002
NEXT     EQU   6                        NEXT EL ON QUEUE         Y02714 84550002
FIRSTSAV EQU   6                        @ 1ST EL ON WAIT QUEUE   Y02714 84552002
PQEREG   EQU   7                        BASE FOR PQE                    84604002
GMBASE   EQU   8                        GETMAIN BASE                    84700001
RTCB     EQU   8                        TCB BASE                 Y02714 84750002
SEGREG   EQU   9                        SEGMENT ADDRESS REGISTER        84980001
RBASE2   EQU   9                        TEMPORARY BASE REG       Y02714 85030002
RWORK1   EQU   10                       WORK REGISTER 1                 85190001
FBQEREG  EQU   10                       FBQE BASE                Y02714 85240002
RBASE    EQU   11                       GETPART BASE                    85400001
RWORK2   EQU   12                       WORK REGISTER 2                 85470001
REGEND   EQU   12                       REGION END               Y02714 85590002
REG12    EQU   12                       REGISTER 12              Y06736 85596002
REG13    EQU   13                       REGISTER 13              Y06736 85602002
RWORK3   EQU   13                       WORK REGISTER 3                 85610001
RSPQE    EQU   13                       SPQE REGISTER                   85750001
GMBASE2  EQU   13                       GETMAIN BASE 2                  85890001
RRETURN  EQU   14                       RETURN REGISTER                 85960001
REG14    EQU   14                       CFAPWKAR BASE            Y02714 86010002
REG15    EQU   15                       REGISTER 15              Y06736 86015002
RTCT     EQU   15                       TCT BASE                 Y02714 86020002
RWORK15  EQU   15                       WORK REGISTER            Y02714 86022002
RBRANCH  EQU   15                       BRANCH REGISTER                 86030001
RRETREG  EQU   15                       RETURN REGISTER                 86100001
RSIZE    EQU   15                       SIZE REGISTER                   86170001
*   GENERAL EQUATES                                                     86240001
CVTNRMBR EQU   CVTCRMN                                                  86290002
GPRETURN EQU   UNLOCK                   LABEL FOR FRR USE        Y02714 86300002
REGSAVE2 EQU   REGSAVE+4                SECOND WORD OF REGISTER SAVE    86310001
REGSAVE3 EQU   REGSAVE+8                THIRD WORD OF REGISTER SAVE     86380001
REGSAVE4 EQU   REGSAVE+12               FOURTH WORD OF INPUT SAVE       86450001
REGSAVE5 EQU   REGSAVE+16               FIFTH WORD OF REGISTER SAVE     86520001
REGSAVE6 EQU   REGSAVE+20               SIXTH WORD OR REGISTER SAVE     86590001
RINSAVE3 EQU   RINSAVE+8                THIRD WORD OF INPUT SAVE        86660001
RINSAVE4 EQU   RINSAVE+12               SAVE AREA FOR REG 1             86730001
RINSAV14 EQU   RINSAVE+56                                               86850002
RINSAV15 EQU   RINSAVE+60                                               86860002
HIBITON  EQU   DEFAULT                  FLAG HIGH BIT FOR POST PARM.    86865002
RC0      EQU   0                        RETURN CODE OF 0                86870001
RC4      EQU   4                        RETURN CODE OF 4                86940001
RC8      EQU   8                        RETURN CODE OF 8                87010001
RC12     EQU   12                       RETURN CODE OF 12        Y02714 87060002
RC16     EQU   16                       RETURN CODE OF 16               87080001
RC20     EQU   20                       RETURN CODE OF 20               87150001
SPADDR   EQU   24                       SPECIFIC ADDRESS         Y02714 87200002
RC24     EQU   24                       REG REQUEST TOO BIG             87205002
ELSIZE   EQU   20                       SIZE OF REQUEST          Y02714 87210002
FLWD     EQU   4                        LENGTH OF FULLWORD              87220001
BRENTRY  EQU   6                        DISP FOR BRANCH ENTRY OF POST   87290001
VVSPID   EQU   247                      V=V SUBPOOL ID                  87360001
SP255    EQU   X'FF'                    LSQA SUBPOOL             Y02714 87400002
SP245    EQU   X'F5'                    SQA SPID                 Y02714 87440002
VVPQE    EQU   12                       DISPLACEMENT FOR V=V PQE        87500001
C16      EQU   16                       DISPLACEMENT CONSTANT    Y06736 87530002
VRPQE    EQU   8                        DISPLACEMENT FOR V=R PQE        87570001
FSTBYTE  EQU   0                        FIRST BYTE OF A WORD            87640001
BYTES3   EQU  3                         THREE BYTES              Y02714 87690002
SNDBYTE  EQU  1                         SECOND BYTE OF A WORD    Y02714 87692002
HIGHBYTE EQU   24                       FOR SHIFT                Y02714 87700002
PARMS    EQU   24                       SIZE OF FRR PARMS        Y02714 87700402
ELEVEN   EQU   11                       FOR 2K SHIFT             Y02714 87702002
TWELVE   EQU   12                       FOR 4K SHIFT             Y02714 87704002
FSTWORD  EQU   0                        FIRST WORD AT AN ADDRESS        87710001
SNDWORD  EQU   4                        SECOND WORD AT AN ADDRESS       87780001
SVCFOUR  EQU   4                        SVC 4                           87850001
PAGERND  EQU   4095                     PAGE ROUNDING FACTOR            87990001
VRPARMS1 EQU   VRPARMS                  FIRST V=R PARAMETER             88550001
VRPARMS2 EQU   VRPARMS+4                SECOND V=R PARAMETER            88620001
VRPARMS3 EQU   VRPARMS+8                THIRD V=R PARAMETER             88690001
BIGPSW   EQU   GPSW+1                   SECOND BYTE OF GPSW             88970001
VERREQ   EQU   X'02'                    V=R INDICATOR                   89180001
SVC4SW   EQU   X'01'                    SVC 4 INDICATOR                 89250001
LASTENT  EQU   X'80'                    LAST ENTRY INDICATOR            89530002
GPSSW    EQU   X'08'                    GETPART SPECIFIC SWITCH         89670001
PSPEC    EQU   X'40'                    POSTED SPECIFIC REQUEST  Y02714 90070002
POSTCHK  EQU   X'10'                    CHECK TO POST REQUESTS   Y02714 90080002
UNCSCAN  EQU   X'80'                    UNSUCCESSFUL SCAN               90160001
BRBIT    EQU   X'04'                    BRANCH ENTRY INDICATOR          90230001
STADDRE  EQU   X'20'                    START @'S EQUAL INDICATOR       90300001
ALOCPASS EQU   X'20'                    BYPASS ALLOCATION        Y02714 90350002
BRFLG    EQU   X'80'                    INDICATE BRANCH ENTRY IN LIST   90370001
ASQFLAG  EQU   X'80'                    A.S. QUEUE PROCESSING    Y02714 90492002
VRORAS EQU     X'82'                    V=R & AS PROCESSING      Y02714 90501002
FIXDPAGE  EQU  X'A0A'                   COMPLETION CODE FOR MEMTERM     90505002
CVTADDR  EQU   CVTPTR                   LOCATION OF CVT ADDRESS         90510001
POSTCD4  EQU   4                        POST CODE                       90790001
MASK8    EQU   8                        MASK FOR HIGH BYTE OF A REG     91070001
MASK7    EQU   7                        MASK FOR LAST THREE BYTES       91140001
D20      EQU   20                       DISPLACEMENT INTO WKAR @Z30ENYG 91240003
         END                                                            91350001
